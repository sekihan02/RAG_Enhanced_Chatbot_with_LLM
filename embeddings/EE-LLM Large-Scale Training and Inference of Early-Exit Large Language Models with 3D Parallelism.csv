text,embedding,file
"EE-LLM : Large-Scale Training and Inference of Early-Exit
Large Language Models with 3D Parallelism
Yanxi Chen* 1Xuchen Pan* 1Yaliang Li1Bolin Ding1Jingren Zhou1
Abstract
We present EE-LLM , a framework for large-scale
training and inference of early-exit large language
models (LLMs). While recent works have shown
preliminary evidence for the efficacy of early ex-
iting in accelerating LLM inference, EE-LLM
makes a foundational step towards scaling up
early-exit LLMs by supporting their training and
inference with massive 3D parallelism. Built
upon Megatron-LM, EE-LLM implements a vari-
ety of algorithmic innovations and performance
optimizations tailored to early exiting, including
a lightweight method that facilitates backpropa-
gation for the early-exit training objective with
pipeline parallelism, techniques of leveraging idle
resources in the original pipeline schedule for
computation related to early-exit layers, and two
approaches of early-exit inference that are com-
patible with KV caching for autoregressive gener-
ation. Our analytical and empirical study shows
thatEE-LLM achieves great training efficiency
with negligible computational overhead compared
to standard LLM training, as well as outstanding
inference speedup without compromising output
quality. To facilitate further research and adop-
tion, we release EE-LLM athttps://github.
com/pan-x-c/EE-LLM .
1. Introduction
Large language models (LLMs) have amazed the world
with their astonishing abilities and performance in solving
a wide range of problems (Brown et al., 2020; OpenAI,
2023; Chowdhery et al., 2023; Zhang et al., 2022; Touvron
et al., 2023a;b). This is accompanied by excessive costs and
carbon emissions for training and deploying these models,
*Equal contribution1Alibaba Group. {chenyanxi.cyx, panx-
uchen.pxc, yaliang.li, bolin.ding, jingren.zhou }@alibaba-inc.com.
Correspondence to: Yaliang Li <yaliang.li@alibaba-inc.com >.
Proceedings of the 41stInternational Conference on Machine
Learning , Vienna, Austria. PMLR 235, 2024. Copyright 2024 by
the author(s).as their sizes have grown rapidly in recent years. In gen-
eral, costs for inference are dominant in the long run, as
each model will be deployed to solve many problems for
a long period of time. This has inspired researchers and
engineers to develop various approaches for accelerating
LLM inference.
The focus of this work is early exiting , which accelerates
inference by allowing a deep neural network to make predic-
tions and exit early in the network for certain inputs, without
running the forward pass through the full network. This is
achieved by augmenting a standard neural network architec-
ture (with a single exit at the end) with additional early-exit
layers that transform intermediate hidden states into early
outputs. The early-exit model architecture, as visualized in
Figure 1, not only retains the full capacity of a large model,
but is also capable of adaptively using a smaller amount
of computation for solving simpler problems. The idea of
early exiting is a natural analogue of how humans speak,
think, and make decisions: not every problem requires or
deserves the same amount of consideration, and one shall
opt for fast reaction to simple problems without overthink-
ing (Kaya et al., 2019). Early exiting has been an active
research area and widely applied in natural language pro-
cessing, computer vision, and other areas (Liu et al., 2020;
Elbayad et al., 2020; Schwartz et al., 2020; Xin et al., 2020;
Schuster et al., 2021; Teerapittayanon et al., 2016; Huang
et al., 2018; Scardapane et al., 2020; Han et al., 2022; Xu
& McAuley, 2023). More recently, it has started to gain
attention in the generative LLM domain (Schuster et al.,
2021; Corro et al., 2023; Bae et al., 2023; Varshney et al.,
2023), and is recognized as a promising direction for further
reducing the latency and costs of LLM inference (Pope et al.,
2022).
Goal and motivations. Our primary goal is to build the
","[0.025457022711634636, 0.002249795710667968, 0.05392539128661156, -0.003277975134551525, 0.0018890616483986378, 0.0327623225748539, 0.003910566680133343, 0.03797641396522522, -0.029165439307689667, 0.07985641807317734, 0.01880696788430214, -0.0423818975687027, -0.03309691697359085, 0.00860185269266367, -0.010372412391006947, -0.024704186245799065, 0.006779012735933065, -0.03259502723813057, 0.02771553210914135, 0.05197359248995781, 0.013613791204988956, -0.016966700553894043, 0.009487132541835308, 0.009459249675273895, 0.031228767707943916, -0.031870074570178986, 0.01766377128660679, 0.0217625480145216, 0.013739263638854027, -0.0405416339635849, 0.05989231541752815, -0.0437481589615345, -0.05643484368920326, -0.01571197435259819, -0.024843599647283554, 0.037809114903211594, 0.010302704758942127, 0.026990577578544617, -0.03451894223690033, 0.025164252147078514, 0.019824691116809845, -0.043803922832012177, -0.028552016243338585, 0.018569963052868843, -0.031870074570178986, 0.033041153103113174, 0.04140600189566612, 0.027548234909772873, -0.0074447151273489, 0.05289372429251671, -0.013669556938111782, -0.014080828055739403, -0.014540894888341427, 0.014178418554365635, -0.0480978786945343, -0.03633132576942444, 0.03092205710709095, 0.003677048021927476, 0.02423017844557762, -0.01930885948240757, 0.023784052580595016, -0.04065316542983055, 0.013885648921132088, 0.01056062150746584, -0.026209859177470207, 0.0015474969986826181, -0.05515223369002342, 0.016478750854730606, 0.0009445308241993189, 0.002462402218952775, -0.027910711243748665, -0.0255406703799963, 0.022152908146381378, -0.0016747124027460814, -0.02423017844557762, 0.014917313121259212, -0.01277033518999815, 0.049464136362075806, -0.02625168301165104, -0.02020110934972763, 0.013132812455296516, 0.002216684864833951, 0.02333792671561241, -0.0098496088758111, 0.006479272153228521, -0.028091950342059135, 0.024481123313307762, 0.002028475748375058, -0.03605249896645546, -0.0071798283606767654, -0.00022458746389020234, -0.009027065709233284, -0.002129551023244858, -0.00520014762878418, 0.08682712912559509, 0.04441734403371811, 0.02849625051021576, -0.05105346068739891, 0.07416832447052002, 0.061119161546230316, -0.025777675211429596, 0.016687873750925064, 0.05342349782586098, -0.04943625628948212, 0.013662585988640785, -0.02034052275121212, -0.03814370930194855, -0.02269662171602249, -0.000701427401509136, -0.03758605197072029, -0.05704826861619949, 0.019782867282629013, -0.015725914388895035, -0.02102365344762802, -0.006263180170208216, -0.04854400455951691, -0.05623966455459595, 0.013808971270918846, 0.004750536754727364, 0.013662585988640785, -0.007507451344281435, 0.02753429301083088, -0.0007097051129676402, -0.016910934820771217, 0.024313826113939285, -0.01688305288553238, 0.022571150213479996, -0.010198144242167473, 0.011355281807482243, -0.019462214782834053, 0.030615346506237984, 0.04425004869699478, 0.03602461516857147, -0.03451894223690033, -0.06479969620704651, 0.01279124803841114, -0.03990032896399498, -0.002063329331576824, -0.04327414929866791, -0.017078232020139694, 0.046871036291122437, -0.022473560646176338, -0.011940821073949337, -0.003058397676795721, -0.01859784685075283, 0.0487949512898922, 0.003826918313279748, 0.0005702909547835588, -0.016910934820771217, 0.029667329043149948, -0.007625953759998083, -0.05339561775326729, -0.027882829308509827, -0.0074307736940681934, -0.021400071680545807, -0.0009314607596024871, -0.01738494448363781, 0.02020110934972763, 0.07433561980724335, -0.04617396369576454, 0.00399770075455308, 0.03925902396440506, 0.02561037801206112, 0.04121081903576851, 0.01621386408805847, 0.0577174536883831, -0.04597878456115723, 0.008859768509864807, -0.06814563274383545, -0.029611563310027122, -0.026195917278528214, -0.010707005858421326, -0.030587462708353996, -0.016227805987000465, 0.02950003184378147, -0.03769758343696594, -0.04388757050037384, -0.023672521114349365, -0.005911159794777632, -0.0785738080739975, -0.02888661064207554, 0.038952309638261795, -0.02418835461139679, -0.021386129781603813, -0.04569995775818825, 0.009291952475905418, 0.008413643576204777, 0.02450900711119175, -0.0016128473216667771, 0.01823537051677704, -0.03159124404191971, 0.04567207396030426, 0.07991218566894531, 0.04182424396276474, 0.03853406757116318, 0.014255096204578876, 0.057550158351659775, 0.03039228357374668, 0.0276040006428957, -0.03147971257567406, 0.02647474594414234, 0.03608037903904915, 0.006914941594004631, -0.06541311740875244, 0.056128133088350296, -0.0008382275118492544, 0.007085723802447319, 0.026809340342879295, -0.02041023038327694, -0.0618441142141819, 0.02400711551308632, 0.011780494824051857, 0.03538331016898155, 0.00952895637601614, -0.00892250519245863, -0.0037084161303937435, -0.04670373722910881, 0.024341709911823273, 0.04840458929538727, 0.043162617832422256, 0.007402890827506781, -0.001775787677615881, 0.011703817173838615, 0.033682458102703094, -0.05186206102371216, 0.00411620270460844, 0.02087029628455639, -0.03937055543065071, 0.030977822840213776, 0.0010438633617013693, 0.017580123618245125, -0.03577366843819618, -0.007134518586099148, -0.02308698184788227, 0.01578168012201786, -0.044054869562387466, -0.010776713490486145, -0.00839273165911436, 0.013509230688214302, -0.0116829052567482, 0.05116499215364456, 0.027492469176650047, 0.004632034804672003, -0.02487148344516754, -0.02735305391252041, 0.02746458537876606, -0.011278604157269001, -0.06279212981462479, 0.012658803723752499, 0.004576269071549177, 0.004081348888576031, -0.010463031008839607, -0.03223254904150963, 0.0005676769651472569, -0.017231587320566177, 0.016116274520754814, -0.034072816371917725, -0.02757611684501171, -0.009347718209028244, -0.007298330310732126, -0.022822095081210136, 0.009201333858072758, 0.005060733295977116, 0.027701590210199356, 0.010762771591544151, -0.020898180082440376, -0.033041153103113174, 0.004499591421335936, 0.002251538448035717, -0.0018629215192049742, 0.022097142413258553, -0.0490180142223835, -0.00264015537686646, 0.006193473469465971, -0.03248349577188492, -0.01841660775244236, 0.050105441361665726, 0.028970258310437202, -0.013822912238538265, 0.014680309221148491, 0.004635520279407501, 0.011606227606534958, 0.057661689817905426, -0.002532109385356307, -0.01023996900767088, -0.008504263125360012, -0.02041023038327694, -0.04006762430071831, -0.030085571110248566, -0.018109897151589394, 0.0036700773052871227, -0.014164476655423641, 0.02675357460975647, -0.02721364051103592, 0.03814370930194855, -0.006413050461560488, 0.020354464650154114, -0.014903372153639793, -0.008148756809532642, 0.02718575857579708, 0.04748445749282837, 0.036638036370277405, -0.019922280684113503, 0.002091212198138237, -0.022599032148718834, 0.06892634928226471, -0.03582943603396416, 0.0019169445149600506, -0.02746458537876606, 0.025164252147078514, 0.0002936410310212523, -0.00656292075291276, 0.00024397474771831185, 0.03159124404191971, -0.04592301696538925, -0.042270369827747345, -0.015140376053750515, -0.03538331016898155, 0.008309083059430122, -0.049715083092451096, -0.01049091387540102, -0.035717904567718506, -0.025373373180627823, -0.031228767707943916, 0.022752387449145317, 0.043302033096551895, 0.03605249896645546, -0.011271633207798004, -0.03281809017062187, -0.027548234909772873, 0.03365457430481911, 0.01300036907196045, 0.00687660276889801, -0.03750240430235863, -0.006273636594414711, -0.04372027516365051, -0.07310877740383148, 0.0021121243480592966, 0.08866739273071289, 0.004914348479360342, -0.06067303568124771, 0.04653644189238548, -0.016325395554304123, 0.04873918369412422, 0.027171816676855087, 0.01784501038491726, -0.008065108209848404, 0.007723543327301741, 0.09703224152326584, 0.02333792671561241, -0.018583904951810837, -0.04210307076573372, 0.017900776118040085, -0.009556839242577553, 0.016910934820771217, 0.00479933200404048, 0.022292321547865868, -0.041378118097782135, 0.02938850037753582, 0.03516024723649025, -0.02283603698015213, -0.018458431586623192, 0.006493213586509228, 0.029472149908542633, -0.028398660942912102, 0.004942231345921755, -0.0373351089656353, 0.02735305391252041, 0.041629064828157425, -0.01596291922032833, 0.031842190772295, 0.03613614663481712, 0.0037049308884888887, 0.016450868919491768, -0.04182424396276474, 0.019671335816383362, 0.015935037285089493, 0.028454426676034927, 0.010504855774343014, 0.049993909895420074, 0.009995994158089161, 0.027868887409567833, -0.016576342284679413, -0.011961732991039753, -0.027617942541837692, 0.05540318042039871, -0.006813866086304188, -0.026265624910593033, -0.00971019547432661, 0.0024188354145735502, -0.007904781959950924, 0.023811936378479004, -0.006231812294572592, 0.027088167145848274, 0.018960323184728622, -0.020242933183908463, 0.02607044391334057, 0.021330364048480988, 0.04943625628948212, -0.0019918796606361866, -0.025944972410798073, -0.027199698612093925, -0.0006273636245168746, -0.007465627510100603, 0.020675117149949074, 0.02764582447707653, 0.0487949512898922, 0.014722133055329323, 0.02675357460975647, -0.004032554104924202, 0.03518813103437424, -0.007507451344281435, 0.03839465603232384, -0.04910166189074516, 0.008044196292757988, -0.017287353053689003, 0.019978046417236328, 0.01958768628537655, 0.01115313172340393, 0.06379590928554535, -0.01083247922360897, -0.017621947452425957, -0.01501490268856287, -0.011111306957900524, 0.004583240021020174, -0.0029974039644002914, 0.021497661247849464, -0.041907891631126404, -0.008629735559225082, -0.07812768220901489, -0.016450868919491768, 0.022612974047660828, 0.04006762430071831, -0.009772931225597858, -0.06429780274629593, -0.02423017844557762, -0.04182424396276474, 0.02703240141272545, 0.011801406741142273, -0.04963143542408943, -0.002650611335411668, 0.021971669048070908, -0.02753429301083088, 0.025805557146668434, 0.0014037261717021465, -0.014652426354587078, -0.07941029220819473, 0.02315668947994709, -0.0030618831515312195, -0.026209859177470207, 0.03014133684337139, 0.008148756809532642, 0.0639074444770813, 0.0437481589615345, 0.004321838263422251, -0.03666592016816139, 0.1046721413731575, -0.041880007833242416, 0.02910967357456684, 0.0054197246208786964, 0.02407682314515114, -0.033793989568948746, -0.015098551288247108, -0.015572560019791126, -0.012498477473855019, 0.02746458537876606, 0.028412602841854095, 0.0009689282742328942, 0.02375617064535618, -0.004970114212483168, 0.035606373101472855, -0.033152684569358826, 0.027088167145848274, -0.019002147018909454, -0.001620689406991005, 0.022389911115169525, -0.0003088894591201097, -0.05944618955254555, 0.00444382568821311, -0.032511379569768906, 0.013578937388956547, -0.009717165492475033, 0.047679636627435684, -0.021009711548686028, 0.010428178124129772, 0.03566213697195053, -0.03981667757034302, -0.014708192087709904, -0.026669925078749657, 0.04095987603068352, 0.0010700034908950329, -0.0010429921094328165, 0.04171271249651909, -0.01585138775408268, -0.015265848487615585, -0.018249310553073883, -0.029695212841033936, -0.045225948095321655, 0.01738494448363781, 0.012554243206977844, 0.020689059048891068, -0.02686510607600212, 0.008804002776741982, -0.0028667033184319735, -0.015391320921480656, 0.0011309972032904625, 0.0010098811471834779, -0.014157506637275219, 0.0023125321604311466, -0.012442712672054768, 0.0022149421274662018, 0.023059099912643433, 0.010142378509044647, 0.01995016448199749, -0.0009549868991598487, 0.04249342903494835, -0.02294756844639778, 0.02455083094537258, -0.0049979970790445805, 0.038952309638261795, 0.040848344564437866, -4.3212938180658966e-05, -0.019964104518294334, 0.004722653888165951, 0.0006874859682284296, -0.006413050461560488, -0.0341285802423954, -0.0522245392203331, -0.03147971257567406, 0.012066294439136982, 0.020828472450375557, -0.014115681871771812, 0.0040290686301887035, -0.018932441249489784, -0.043302033096551895, -0.014429363422095776, -0.01930885948240757, -0.014582719653844833, -0.06307096034288406, -0.01582350581884384, 0.02382587641477585, 0.058944299817085266, 0.04438946396112442, 0.038311004638671875, -0.020033812150359154, 0.004816758446395397, 0.014931255020201206, -0.014680309221148491, -0.004025583155453205, 0.03301326930522919, 0.041238702833652496, -0.040848344564437866, 0.005973896011710167, -0.037641819566488266, -0.0064513892866671085, 0.00908283144235611, -0.025457022711634636, 0.005715979728847742, -0.01099280547350645, 0.03223254904150963, 0.02162313275039196, -0.004848126787692308, 0.008866739459335804, -0.015154317021369934, 0.004447311162948608, -0.017287353053689003, -0.008176639676094055, -0.021999550983309746, 0.016436927020549774, 0.02611226961016655, -0.030475931242108345, -0.015363438054919243, 0.011222838424146175, -0.022557208314538002, 0.02963944710791111, -0.03602461516857147, 0.015056727454066277, 0.030838407576084137, 0.0078002214431762695, -0.000350713700754568, -0.03769758343696594, -0.003511493792757392, -0.01962951198220253, -0.030587462708353996, -0.018904557451605797, -0.00199885037727654, -0.04056951403617859, -0.007151945494115353, -0.03889654576778412, 0.023212455213069916, 0.041266586631536484, -0.039454203099012375, -0.013063104823231697, -0.03819947689771652, -0.03850618749856949, -0.012136001139879227, 0.03630344197154045, -0.02950003184378147, -0.02789676934480667, -0.015000961720943451, 0.011062512174248695, -0.0010151092428714037, 0.007214681711047888, -0.010232998058199883, 0.007207711227238178, 0.021651016548275948, -0.0469546839594841, 0.007047384977340698, 0.02535943314433098, -0.040207039564847946, -0.0013923987280577421, 0.005897218361496925, 0.01553073525428772, -0.03262291103601456, -0.019936222583055496, 0.005510344170033932, -0.011062512174248695, -0.017580123618245125, 0.034435294568538666, -0.02045205421745777, 0.013383757323026657, -0.031200885772705078, -0.007939635775983334, -0.01387867797166109, 0.027492469176650047, -0.018179604783654213, -0.02647474594414234, -0.02240385301411152, -0.0051478673703968525, 0.005607933737337589, -0.01923915185034275, 0.0009532442199997604, 0.02022899128496647, 0.0022776785772293806, 0.01763588935136795, 0.013662585988640785, -0.01638116128742695, -0.030336517840623856, -0.0015335555654019117, -0.030698994174599648, 0.014178418554365635, 0.02354704774916172, 0.012212678790092468, 0.008176639676094055, 0.001620689406991005, 0.01312584150582552, -0.005513829179108143, 0.019016088917851448, -0.004391545429825783, 0.0021975154522806406, -0.012561214156448841, -0.022473560646176338, 0.03872925043106079, 0.02732517197728157, 0.0393984355032444, -0.00792569387704134, 0.017161881551146507, 0.005451092962175608, -0.0018855762900784612, 0.015698032453656197, -0.04363662749528885, -0.0016642563277855515, -0.0148894302546978, 0.006465330719947815, 0.0031472742557525635, 0.0403185710310936, 0.02390952594578266, 0.02365857921540737, 0.010839449241757393, -0.006353799719363451, -0.009633516892790794, 0.0028318497352302074, -0.005573080386966467, -0.01688305288553238, -0.010734888724982738, -0.03479776903986931, -0.01692487671971321, -0.013460435904562473, -0.0005694196443073452, -0.013327991589903831, -0.025066662579774857, 0.03326421603560448, -0.047930583357810974, -0.02950003184378147, -0.01624174788594246, -0.011564402841031551, 0.025735851377248764, -0.010825508274137974, -0.009466220624744892, 0.017008526250720024, 0.007228623144328594, -0.004882980138063431, 0.003684018738567829, -0.029918275773525238, 0.005918130278587341, -0.017580123618245125, -0.008092991076409817, 0.043302033096551895, -0.026879046112298965, -0.020256875082850456, -0.005346532445400953, 0.018639670684933662, -0.04045798256993294, 0.036275558173656464, -0.019336741417646408, -0.013209490105509758, -0.05640696361660957, 0.016325395554304123, 0.05927889421582222, -0.029806744307279587, -0.03117300197482109, -0.005688096862286329, 0.003511493792757392, -0.012254503555595875, -0.04121081903576851, -0.003844344988465309, 0.009717165492475033, -0.01724552921950817, -0.018960323184728622, -0.028802961111068726, -0.06624960154294968, -0.013760175555944443, -0.04299532249569893, -0.0007528363494202495, 0.013690468855202198, 0.00908283144235611, -0.024244118481874466, 0.029946157708764076, 0.016325395554304123, 0.009236186742782593, 0.028342895209789276, 0.008748237043619156, 0.02753429301083088, -0.03761393576860428, 0.017008526250720024, 0.0055591389536857605, -0.04377603903412819, -0.0009898403659462929, -0.008197551593184471, -0.005952984094619751, -0.009187391959130764, -0.017803186550736427, -0.01177352387458086, 0.027729472145438194, 0.00484464131295681, -0.008092991076409817, 0.03359880670905113, 0.044054869562387466, 0.0016869110986590385, -0.02693481184542179, -0.028384719043970108, 0.013599849306046963, -0.013097958639264107, 0.017468592151999474, 0.00011643259495031089, -0.024732068181037903, 0.02682328037917614, -0.010999775491654873, 0.007855987176299095, -0.021539485082030296, 0.004938745871186256, 0.004022098146378994, -0.009173450991511345, 0.02664204314351082, 0.014959137886762619, -0.0031002219766378403, -0.014582719653844833, -0.024244118481874466, 0.03326421603560448, 0.021302480250597, -0.034992948174476624, -0.0014743045903742313, 0.03195372223854065, -0.015948977321386337, -0.015907153487205505, 0.004569298587739468, 0.028719313442707062, 0.006744158919900656, -0.006737188436090946, 0.03301326930522919, -0.006123766303062439, -0.03301326930522919, 0.01745465025305748, -0.04776328429579735, -0.008504263125360012, -0.011501667089760303, -0.03198160603642464, 0.00010810041567310691, -0.004091805312782526, -0.06017114222049713, -0.018681494519114494, -0.008490321226418018, -0.002634927397593856, -0.014861547388136387, 0.017580123618245125, 0.03376610577106476, -0.007019502110779285, -0.1005454808473587, -0.017858952283859253, 0.028398660942912102, 0.02411864697933197, 0.0028545046225190163, -0.006353799719363451, 0.0016084907110780478, 0.011020688340067863, 0.01212903019040823, -0.03903596103191376, 0.0008059880346991122, -0.02487148344516754, 0.021246714517474174, -0.0084763802587986, 0.01802624948322773, -0.07154733687639236, -0.01564226672053337, 0.010281792841851711, 0.031758543103933334, -0.008894622325897217, -0.019991988316178322, 0.009745048359036446, -0.024202294647693634, 0.02283603698015213, -0.0131119005382061, -0.024913307279348373, -0.01343255303800106, 0.013544083572924137, -0.002662810031324625, 0.014805781655013561, -0.03451894223690033, -0.020117461681365967, 0.008092991076409817, 0.010253909975290298, -0.010957951657474041, 0.000698813411872834, -0.01277033518999815, -0.05141593515872955, -0.021149124950170517, -0.006747644394636154, -0.021888019517064095, -0.045476894825696945, 0.044975001364946365, 0.0006269279983825982, 0.027269406244158745, 0.007507451344281435, 0.02888661064207554, 0.024857541546225548, 0.020298698917031288, -0.008420614525675774, -0.008629735559225082, 0.011236780323088169, -0.0015962918987497687, 0.030949939042329788, 0.004541415721178055, -0.00540578318759799, -4.1742554458323866e-05, -0.02112124301493168, 0.016827287152409554, 0.040374334901571274, -0.017120055854320526, -0.0043601770885288715, -0.019991988316178322, -0.03242772817611694, -0.038561951369047165, 0.007688689976930618, -0.0073192426934838295, 0.035634253174066544, -0.0139135317876935, -0.048181526362895966, -0.006548979319632053, 0.025247901678085327, 0.008434555493295193, 0.029806744307279587, 0.024132588878273964, 0.0019204297568649054, 0.025735851377248764, 0.07004166394472122, -0.027562176808714867, 0.027227582409977913, 0.015586500987410545, -0.025024838745594025, -0.005297737196087837, -0.010783683508634567, 0.013969297520816326, 0.019504038617014885, 0.027617942541837692, -0.010741859674453735, -0.01589321158826351, 0.034992948174476624, 0.038952309638261795, -0.010588504374027252, 0.008587910793721676, 0.013746234588325024, 0.013711380772292614, -0.004984055645763874, 0.024996954947710037, 0.018583904951810837, 0.044305816292762756, -0.028970258310437202, 0.046257611364126205, 0.040207039564847946, -0.056267548352479935, -0.008852798491716385, -0.0012834814842790365, 6.447904161177576e-05, 0.022933626547455788, -0.012798218056559563, 0.008978270925581455, -0.016227805987000465, 0.008936446160078049, 0.01617204025387764, -0.018137779086828232, 0.05386962369084358, 0.005621875170618296, 0.021609192714095116, 0.029276970773935318, 0.021720724180340767, 0.026572335511446, -0.005562624428421259, -0.03401705250144005, 0.026335330680012703, -0.02123277448117733, -0.026920871809124947, -0.02379799447953701, -0.02052176184952259, 0.026600219309329987, 0.021929845213890076, -0.036359209567308426, -0.010776713490486145, 0.004004671238362789, 0.01456877775490284, 0.022668739780783653, -0.02137218788266182, -0.032790206372737885, -0.012345122173428535, 0.0013061362551525235, 0.028579900041222572, -0.009061919525265694, 0.0565742589533329, 0.00903403665870428, -0.018793025985360146, 0.021455837413668633, -0.01200355775654316, 0.030448049306869507, 0.014861547388136387, -0.012268444523215294, -0.030866291373968124, 0.0051583233289420605, 0.006984648760408163, 0.034323763102293015, 0.006008749362081289, -0.021581308916211128, 0.004809787962585688, -0.005747348070144653, 0.021135184913873672, -0.001545754261314869, -0.02501089684665203, 0.006587318144738674, 0.006350314244627953, 0.05297737568616867, 0.043162617832422256, -0.017928658053278923, -0.002228883560746908, 0.02006169594824314, -0.01678546331822872, -0.019964104518294334, -0.015447086654603481, -0.019671335816383362, 0.010964922606945038, -0.005074674729257822, -0.02201349288225174, 0.038422536104917526, 0.014708192087709904, 0.020953945815563202, 0.003910566680133343, 0.011055541224777699, 0.02489936538040638, 0.003013088135048747, 0.02725546434521675, -0.004422913771122694, 0.01309098768979311, -0.02693481184542179, 0.04556054249405861, -0.0036805332638323307, 0.007967518642544746, 0.004482164513319731, -0.018137779086828232, 0.004562327638268471, 0.05116499215364456, 0.016687873750925064, 0.03621979430317879, 0.01387867797166109, 0.02272450551390648, 0.00648275762796402, -0.033152684569358826, -0.01164805144071579, 0.030698994174599648, -0.02414652891457081, -0.03401705250144005, -0.03284597024321556, 0.030698994174599648, -0.004105746280401945, 0.008748237043619156, -0.0471777468919754, -0.012958544306457043, 0.013822912238538265, -0.000981998397037387, -0.021358245983719826, 0.024857541546225548, -0.0015283275861293077, -0.007402890827506781, -0.012310268357396126, 0.04834882542490959, 0.004224248696118593, -0.041266586631536484, -0.01033058762550354, 0.011515608057379723, -0.028440484777092934, -0.008016313426196575, -0.00495965825393796, -0.01663210801780224, 0.005688096862286329, 0.054594580084085464, -0.011236780323088169, 0.02618197537958622, -0.0017330920090898871, 0.0008181867306120694, -0.011801406741142273, -0.0007397662848234177, -0.0010212085908278823, -0.008594881743192673, -0.009180421009659767, 0.0006652668816968799, -0.02400711551308632, -0.04464040696620941, -0.00388268381357193, -0.012944603338837624, 0.0027935109101235867, 0.008964329026639462, 0.03783699870109558, -0.0029834627639502287, -0.0235888734459877, -0.00975899025797844, 0.020465996116399765, 0.003253577509894967, 0.019364625215530396, 0.013509230688214302, -0.027799179777503014, -0.011383164674043655, 0.02301727421581745, 0.006932368036359549, 0.01227541547268629, -0.012498477473855019, 0.01958768628537655, 0.0005916387890465558, 0.03242772817611694, 0.04480770602822304, 0.023993173614144325, 0.025875264778733253, -0.034825652837753296, 0.024773893877863884, 0.010093583725392818, 0.009765960276126862, 0.005301222670823336, -0.01830507628619671, -0.011320427991449833, 0.006019205786287785, 0.013258284889161587, 0.0017043378902599216, -0.03181430697441101, 0.01678546331822872, 0.0033877636305987835, 0.014638485386967659, -0.0010761029552668333, -0.0003711901663336903, -0.001425509573891759, -0.011675934307277203, 0.018291136249899864, 0.0026715234853327274, -0.012366034090518951, -0.03463047370314598, -0.021274598315358162, 0.014610602520406246, 0.0017592322546988726, 0.01056062150746584, -0.06134222447872162, -0.001618075417354703, 0.040095508098602295, -0.03808794543147087, 0.013662585988640785, 0.0513044036924839, -0.019727101549506187, 0.017761360853910446, 0.005754318553954363, -0.004694771021604538, 0.013097958639264107, -0.008539116010069847, 0.0003424359892960638, -0.020145343616604805, 0.024676302447915077, 0.028091950342059135, -0.008587910793721676, -0.008002371527254581, -0.0017845010152086616, 0.0038652571383863688, -0.029583681374788284, -0.042298249900341034, -0.015028844587504864, 0.0029764920473098755, -0.016841229051351547, 0.038283124566078186, 0.021651016548275948, -0.004942231345921755, 0.0002714219153858721, 0.006981163285672665, -0.007723543327301741, -0.02526184171438217, 0.0076398951932787895, -0.027631882578134537, 0.01407385803759098, 0.01403900422155857, 0.00476447818800807, 0.013202519156038761, -0.015377379953861237, -0.007653836626559496, 0.0084763802587986, 0.002695920877158642, 0.015335556119680405, 0.0025164252147078514, 0.030838407576084137, 0.00043349084444344044, -0.012881866656243801, 0.02144189551472664, -0.03775335103273392, 0.0059704105369746685, -0.020215051248669624, -0.006998589728027582, -0.007388949394226074, 6.289973680395633e-05, 0.05094192922115326, 0.025052720680832863, -0.00017328742251265794, -0.0035062655806541443, -0.01942039094865322, 0.008560027927160263, -0.0060296617448329926, -0.03672168403863907, 0.014457246288657188, -0.006294548511505127, 0.07517210394144058, -0.03513236343860626, -0.008162697777152061, -0.01036544144153595, -0.023923465982079506, 0.04887859895825386, -0.0021208375692367554, -0.007674748543649912, -0.001342732459306717, 0.01756618171930313, 0.01859784685075283, 0.01685516908764839, 0.0020319612231105566, -0.009284981526434422, 0.035355426371097565, -0.01720370538532734, -0.015767740085721016, 0.022208672016859055, -0.007814162410795689, 0.03730722516775131, 0.02070300094783306, 0.01777530275285244, -0.012247532606124878, -0.007918722927570343, -0.023100923746824265, 0.012463624589145184, -0.007214681711047888, 0.020312640815973282, 0.009591693058609962, 0.029723094776272774, -0.018834849819540977, -0.02162313275039196, -0.037920646369457245, 0.041517533361911774, -0.014080828055739403, 0.020284757018089294, 0.0021957727149128914, 0.02141401171684265, -0.01444330532103777, 0.022417794913053513, 0.007556246593594551, -0.0015614384319633245, -0.024021057412028313, -0.007368037477135658, -0.010463031008839607, -0.004928289912641048, -0.0078002214431762695, 0.008964329026639462, -0.016004743054509163, 0.003764181863516569, -0.04243766516447067, -0.02173466421663761, 0.009501073509454727, 0.013467405922710896, -0.024341709911823273, -0.013997179456055164, 0.013425582088530064, 0.06580347567796707, 0.018779084086418152, 0.01567015051841736, -0.04093199223279953, 0.006548979319632053, -0.03474200516939163, 0.030308634042739868, 0.012658803723752499, -0.019504038617014885, -0.017259471118450165, -0.004722653888165951, 0.002898071426898241, 0.038952309638261795, -0.005827511195093393, 0.001986651448532939, 0.010288763791322708, 0.0007994530024006963, -0.014101740904152393, 0.019657393917441368, -0.028830844908952713, 0.00703692901879549, 0.023560989648103714, 0.02201349288225174, -0.02789676934480667, 0.007681719027459621, -0.03173065930604935, 0.02404893934726715, 0.013537113554775715, 0.033821869641542435, 0.01407385803759098, -0.012219649739563465, 0.007486539427191019, 0.01763588935136795, -0.02700451947748661, 0.025275783613324165, 0.020814532414078712, 0.0022010006941854954, -0.020926062017679214, -0.011919909156858921, -0.018514197319746017, 0.00037794304080307484, 0.005966925527900457, -0.006761585827916861, -0.022529324516654015, 0.006674452219158411, -0.00791175290942192, 0.002675008960068226, 0.016130216419696808, -0.0023874673061072826, -0.028315013274550438, 0.006228326819837093, -0.01720370538532734, 0.008908563293516636, -0.021330364048480988, -0.018054131418466568, 0.029723094776272774, -0.002817908301949501, 0.02308698184788227, 0.04572783783078194, -0.0021731180604547262, 0.005060733295977116, 0.0006709305453114212, -0.013585908338427544, 0.002063329331576824, 0.0016084907110780478, 0.03153548017144203, 0.00855305790901184, -8.103447180474177e-05, -0.017831068485975266, -0.0007833332056179643, 0.005545197520405054, 0.0020703000482171774, -0.007897811010479927, -0.016799403354525566, -0.010930068790912628, -0.006873117294162512, 0.0029799772892147303, 0.022849978879094124, 0.042270369827747345, 0.01017026137560606, -0.03555060550570488, -0.030308634042739868, 0.00026771871489472687, 0.01834690198302269, 0.0022131996229290962, 0.002131293760612607, 0.023351868614554405, 0.007716572843492031, 0.009912345558404922, 0.005834481678903103, -0.011606227606534958, 0.01521008275449276, -0.0017897291108965874, -0.022111082449555397, 0.029695212841033936, -0.0018820909317582846, 0.014401480555534363, 0.010037817992269993, 0.0008974785450845957, -0.01596291922032833, -0.020117461681365967, -0.0011362252989783883, -0.021818313747644424, 0.015809563919901848, 0.013174636289477348, -0.00908283144235611, 0.028579900041222572, 0.044696174561977386, -0.026851164177060127, -0.04171271249651909, 0.03889654576778412, -0.009968111291527748, -0.005137410946190357, 0.004070892930030823, 0.0011588800698518753, 0.0025983310770243406, -0.02119094878435135, -0.00037859653821215034, -0.023031216114759445, -0.018249310553073883, 0.008852798491716385, -0.00812087394297123, -0.025275783613324165, -0.03262291103601456, 4.147026265854947e-05, 0.05133228749036789, 0.009103743359446526, -0.03348727524280548, -0.02618197537958622, 0.0196992177516222, 0.010121466591954231, -0.010609416291117668, -0.02212502434849739, 0.0024536889977753162, 0.008176639676094055, 0.0139135317876935, 5.513938231160864e-05, -0.013551054522395134, 0.02718575857579708, -0.006604745052754879, 0.024062881246209145, 0.04748445749282837, 0.022501442581415176, 0.01596291922032833, -0.03794853016734123, -0.02700451947748661, -0.007953576743602753, 0.007821133360266685, 0.020953945815563202, 0.005144381895661354, 0.029583681374788284, -0.013746234588325024, -0.012010528706014156, 0.00395587645471096, -0.0140877990052104, 0.008302112109959126, 0.00799540150910616, 0.0036177970468997955, 0.010762771591544151, -0.02615409344434738, -0.011069483123719692, -0.05069098249077797, -0.055096469819545746, -0.01603262685239315, -0.0066117155365645885, 0.013174636289477348, 0.02728334814310074, -0.007423803210258484, 0.01905791275203228, -0.004224248696118593, 0.011250721290707588, -0.002113866852596402, 0.005928586237132549, -0.00340170506387949, -0.02743670344352722, -0.0007950962753966451, -0.009201333858072758, 0.0025965883396565914, -0.002610529772937298, 0.026572335511446, -0.01834690198302269, 0.019657393917441368, 0.023128805682063103, 0.002324730856344104, 0.011836260557174683, 0.018793025985360146, 0.0469546839594841, -0.009968111291527748, 0.0574943907558918, 0.01674363762140274, 0.040485866367816925, -0.0471777468919754, 0.008399701677262783, -0.0064409333281219006, 0.004335779696702957, 0.0073192426934838295, -0.01316069532185793, 0.01898820698261261, -0.023811936378479004, -0.014276008121669292, -0.01316069532185793, -0.007047384977340698, 0.03292962163686752, -0.0026610675267875195, -0.01179443672299385, -0.014143564738333225, 0.005437151528894901, -0.04514230042695999, 0.03538331016898155, -0.010449090041220188, 0.04645279049873352, 0.010895214974880219, 0.009807785041630268, 0.0169527605175972, 0.011745641939342022, 0.004008156713098288, -0.009145568124949932, -0.01887667551636696, -0.0007345382473431528, -0.022599032148718834, -0.011717759072780609, 0.008218463510274887, -0.034351643174886703, 0.008671559393405914, 0.014805781655013561, -0.01307704672217369, -0.029193321242928505, -0.021218832582235336, -0.003966332413256168, -0.02579161711037159, -0.011404076591134071, 0.012219649739563465, -0.011034629307687283, -0.0012721540406346321, 0.0155167942866683, 0.006981163285672665, -0.03173065930604935, 0.012979456223547459, 0.0013043935177847743, -0.020898180082440376, -0.01688305288553238, -0.011668963357806206, 0.0407646968960762, -0.043580859899520874, 0.0015710231382399797, 0.0029137555975466967, 0.043441448360681534, 0.019922280684113503, 0.0322883166372776, -0.008504263125360012, 0.01067215297371149, -0.03449105843901634, 0.0027743414975702763, -0.003115906147286296, -0.017050350084900856, -0.014847606420516968, 0.03131241723895073, 0.028384719043970108, -0.010860362090170383, -0.010637299157679081, -0.006468816194683313, 0.0006992490380071104, 0.05247548222541809, 0.0015309415757656097, -0.006820837035775185, -0.029026024043560028, 0.022849978879094124, 0.041015639901161194, -0.0262238010764122, 0.013230402022600174, 0.008106932044029236, 0.03647074103355408, 0.014387539587914944, 0.023114865645766258, -0.01339769922196865, 0.013244343921542168, -0.007270447444170713, -0.007821133360266685, 0.013920501805841923, 0.01596291922032833, 0.0016015199944376945, 0.04701044782996178, 0.0009314607596024871, -0.0012730254093185067, 0.01396232657134533, -0.02382587641477585, -0.005607933737337589, -0.012407858856022358, -0.00812087394297123, -0.010065700858831406, 0.022208672016859055, -0.030364399775862694, 0.0012338152155280113, 0.05704826861619949, 0.02632139064371586, -0.008629735559225082, -0.009445307776331902, 0.00876217894256115, 0.006873117294162512, 0.016618166118860245, -0.030866291373968124, -0.01203841157257557, 0.0022323690354824066, -0.02639109641313553, 0.0005763903609476984, 0.028161656111478806, 0.010470001958310604, 0.00783507525920868, 0.0026889501605182886, -0.03237196430563927, -0.027952535077929497, -0.015795622020959854, -0.029723094776272774, -0.0058100842870771885, 0.009905374608933926, 0.022180790081620216, 0.01582350581884384, -0.03334786370396614, -0.008950388059020042, 0.002681979676708579, 0.004869038704782724, 0.007033443544059992, 0.0037049308884888887, 0.021469777449965477, -0.025763733312487602, 0.032148901373147964, -0.0008408415596932173, -0.019824691116809845, 0.026572335511446, 0.003516721772029996, -0.0021922874730080366, 0.0308105256408453]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
"infrastructure for scaling up training and inference of early-
exit LLMs. This is motivated by the observation that sizes
of early-exit models in prior works are still relatively small.
While the largest early-exit LLM that we are aware of
has 13 billion parameters (Varshney et al., 2023), standard
LLMs at much larger scales, e.g. the 175B GPT-3 (Brown
et al., 2020), 530B Megatron-Turing NLG (Smith et al.,
2022), 540B PaLM (Chowdhery et al., 2023), or even larger
1arXiv:2312.04916v3  [cs.LG]  16 Jun 2024
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
sparsely activated models, have been well trained and de-
ployed in many applications. It is an urgent need for the
community to truly understand the efficacy of early exiting
for LLMs at larger scales, which is indispensable for mak-
ing early exiting a useful and practical option in complex
scenarios that only sufficiently large LLMs can handle.
Challenges. The first and foremost question is how to
train an early-exit LLM that is too large to fit into the mem-
ory of one single device (e.g. GPU). While state-of-the-
art frameworks like Megatron-LM (Shoeybi et al., 2019;
Narayanan et al., 2021b), DeepSpeed (Rasley et al., 2020;
Smith et al., 2022), Alpa (Zheng et al., 2022), and many
more, support training standard LLMs at large scales with
data parallelism and model parallelism (including tensor,
sequence, and pipeline parallelism), they do not provide
native support for early-exit LLMs. One particular chal-
lenge lies in pipeline parallelism (Narayanan et al., 2019;
2021a; Fan et al., 2021), which partitions the model along
the depth dimension into multiple pipeline stages, connected
by limited point-to-point communication between devices;
this seems to contradict training early-exit models, as the
training objective is typically an aggregation of losses for
multiple exits that are now located separately on different
pipeline stages. Despite the necessity of pipeline parallelism
in many scenarios, we are not aware of any implementation
that supports training early-exit LLMs with it.
Moreover, training efficiency for early-exit generative LLMs
requires special design, since each early exit contains (at
least) a large output embedding matrix that transforms hid-
den states into logits on the vocabulary, which can constitute
a non-trivial proportion of the whole model. Naive imple-
mentation of early-exit LLM training can cause large com-
putational overhead compared to standard LLM training.
Finally, with regard to autoregressive generation (where to-
kens are generated one by one, depending on previously
generated tokens via the attention mechanism), naive imple-
mentation of early-exit inference is not compatible with KV
caching, a standard technique of storing the keys and values
of previously generated tokens at each layer. Indeed, if the
current token is generated via early exiting at some layer,
then its KV caches in later layers are missing, which hinders
the generation of future tokens. Given that KV caching
is enabled by default in most cases, the efficacy of early
exiting for autoregressive generation might be questionable
if its conflict with KV caching is not well resolved.
Main contributions. We propose EE-LLM , a system for
large-scale training and inference of early-exit (EE) LLMs
with 3D parallelism, which is designed to tackle the afore-
mentioned challenges. EE-LLM is built upon Megatron-LM
(Shoeybi et al., 2019; Narayanan et al., 2021b; Smith et al.,
2022), and augments it with various functionalities for early
𝜽!𝒙!𝒐""𝜽#𝒙#𝜽""𝒙""Input𝝓!𝝓#𝝓""𝒐#𝒐!Early-exit layersFigure 1: The model architecture of an early-exit LLM.
Additional components compared to a standard LLM are
highlighted in blue. Each θirepresents a sequence of Trans-
former layers in the backbone of the LLM, with some ad-
ditional modules in θ1for input processing. Each","[0.007079603150486946, 0.02360788732767105, 0.045309461653232574, -0.03530822694301605, -0.008122549392282963, 0.027544837445020676, 0.007791017182171345, 0.018952615559101105, -0.02123190276324749, 0.07995462417602539, 0.008799429051578045, -0.035667385905981064, -0.033042751252651215, 0.017612671479582787, -0.027834927663207054, -0.03972866013646126, 0.010795531794428825, -0.021936409175395966, 0.011127064004540443, 0.05857076495885849, 0.029451148584485054, -0.021812085062265396, 0.022433709353208542, 0.0024156987201422453, 0.04113767668604851, -0.025928614661097527, 0.03494906425476074, 0.039093222469091415, 0.012294335290789604, -0.039894428104162216, 0.07680506259202957, -0.04274008423089981, -0.0637647807598114, -0.032876987010240555, -0.014504552818834782, 0.0193808451294899, 0.01370334904640913, 0.049425989389419556, -0.028125019744038582, 0.06205185875296593, 0.0326835922896862, -0.06000740826129913, -0.0468289852142334, 0.01627272740006447, -0.029174871742725372, 0.0264397282153368, 0.0284565519541502, 0.027075165882706642, -0.014794643968343735, 0.036827750504016876, 0.0060884589329361916, 0.014062509872019291, -0.013330374844372272, 0.01083697285503149, -0.0451989509165287, -0.04304398596286774, 0.0003390870988368988, 0.007949876599013805, 0.014200648292899132, -0.01974000595510006, 0.016770025715231895, -0.028677573427557945, -0.0043755401857197285, -0.016576632857322693, -0.00916549563407898, 0.014000346884131432, -0.05591850355267525, 0.02619107812643051, -0.0046034688130021095, 0.005936506204307079, -0.013910557143390179, -0.024892576038837433, -0.002576284809038043, -0.019076941534876823, -0.0076183439232409, 0.011272110044956207, 0.005788007285445929, 0.03826439380645752, -0.02152199298143387, -0.014960410073399544, 0.0290643610060215, -0.0011111523490399122, 0.008246874436736107, -0.01581686921417713, 0.011009646579623222, -0.028484178707003593, 0.007390415295958519, -0.004489504266530275, -0.03381633013486862, -0.013074818067252636, -0.012605147436261177, -0.019159823656082153, -0.016479935497045517, 0.0013088632840663195, 0.06895878911018372, 0.041717857122421265, 0.025168852880597115, -0.07050593942403793, 0.0536806583404541, 0.057576168328523636, -0.03859592601656914, 0.021287158131599426, 0.03003133088350296, -0.043983329087495804, 0.014269717037677765, -0.034976694732904434, -0.013482327573001385, -0.00019846631039399654, -0.011437876150012016, -0.040944281965494156, -0.04257431626319885, 0.002762771910056472, -0.008253781124949455, -0.00897900853306055, 0.018621083348989487, -0.03387158364057541, -0.05102839693427086, 0.036634355783462524, 0.022337011992931366, 0.015043293125927448, 0.006198969669640064, 0.02356644533574581, -0.007728854659944773, -0.015126177109777927, 0.02091418392956257, 0.015789242461323738, 0.01566491648554802, -0.011451689526438713, 0.0006859444547444582, -0.02305533178150654, 0.0230138897895813, 0.028111204504966736, 0.041994135826826096, -0.035501621663570404, -0.05619478225708008, 0.015775427222251892, -0.04221515730023384, -0.009662794880568981, -0.028042135760188103, -0.008115642704069614, 0.034728042781353, -0.01885591819882393, -0.014504552818834782, -0.004406621214002371, -0.017405463382601738, 0.040419355034828186, -0.005829448811709881, 0.008488616906106472, -0.017612671479582787, 0.005674043204635382, -0.011430969461798668, -0.04624880477786064, -0.02091418392956257, -0.02163250558078289, -0.019836703315377235, -0.009206937626004219, -0.031910017132759094, 0.04702237993478775, 0.08592221140861511, -0.034728042781353, 0.007141765672713518, 0.02765534818172455, 0.02026493288576603, 0.034120235592126846, -0.0034310175105929375, 0.06746689230203629, -0.04492267221212387, 0.0011681345058605075, -0.05956536531448364, -0.024049930274486542, -0.02009916678071022, -0.008909939788281918, -0.04702237993478775, -0.01787513494491577, 0.007048522122204304, -0.02579047717154026, -0.06404105573892593, -0.03282172977924347, -0.019353218376636505, -0.09299490600824356, -0.04246380552649498, 0.048901062458753586, -0.01694960705935955, -0.019118381664156914, -0.041911251842975616, 0.014656505547463894, 0.024188069626688957, 0.007452577352523804, -0.012439381331205368, 0.004251215606927872, -0.01642468012869358, 0.05174671858549118, 0.06486988812685013, 0.01957423985004425, 0.04290584847331047, 0.010249883867800236, 0.055365949869155884, 0.03547399118542671, 0.03367818892002106, -0.03458990529179573, 0.036717239767313004, 0.038402531296014786, 0.016687143594026566, -0.07111375033855438, 0.06437258422374725, -0.016921978443861008, -0.0025348432827740908, 0.02043069899082184, -0.0038816947489976883, -0.04649745300412178, 0.023759840056300163, 0.0031616471242159605, 0.0322968028485775, -0.005377044901251793, 0.009607539512217045, -0.002638447331264615, -0.05149807035923004, 0.030252354219555855, 0.06265966594219208, 0.03870643675327301, -0.006447619292885065, 0.020955625921487808, 0.0022810136433690786, 0.033926840871572495, -0.06271492689847946, 0.01917363703250885, 0.0019391205860301852, -0.0605599619448185, 0.022143617272377014, -0.009510842151939869, 0.009213844314217567, -0.027171863242983818, -0.010671206749975681, -0.03657910227775574, 0.00566022889688611, -0.015526778995990753, -0.008329757489264011, -0.02409137226641178, -0.0010084117529913783, -0.006109179463237524, 0.037159282714128494, 0.04865241423249245, 0.0003578652977012098, -0.024188069626688957, -0.044342491775751114, 0.02494783140718937, -0.009289820678532124, -0.046276431530714035, 0.0045792944729328156, 0.010242977179586887, -0.0027558649890124798, -0.03403735160827637, -0.02457485720515251, 5.9410391259007156e-05, -0.016369424760341644, 0.03257308155298233, -0.038927458226680756, -0.012287428602576256, -0.007210834883153439, 0.00427884329110384, -0.02043069899082184, 0.020320188254117966, -0.012245986610651016, 0.044342491775751114, 0.012508450075984001, -0.021618690341711044, -0.04536471515893936, 0.011348086409270763, 0.00984928198158741, 0.008785614743828773, 0.03273884952068329, -0.03522534295916557, -0.0062887598760426044, 0.013585931621491909, -0.042325668036937714, -0.011120157316327095, 0.05707886815071106, 0.013454699888825417, -0.010187721811234951, 0.0238150954246521, 0.010167000815272331, 0.013958905823528767, 0.059233833104372025, 0.013751697726547718, -0.006057377438992262, -0.0038920550141483545, -0.011582921259105206, -0.03011421486735344, -0.029561661183834076, -0.008530058898031712, 0.012280521914362907, -0.003822985803708434, 0.01833099126815796, -0.031578484922647476, 0.02684032917022705, -0.02369076944887638, -0.0048417579382658005, -0.0027420511469244957, -0.01787513494491577, 0.020485954359173775, 0.029119616374373436, 0.0343136265873909, -0.04099953547120094, 0.0007632157648913562, -0.025845732539892197, 0.056250039488077164, -0.028926223516464233, 0.0023051879834383726, -0.04017070308327675, 0.016079332679510117, 0.01755741611123085, -0.013938184827566147, 0.001767310663126409, 0.02478206530213356, -0.04354128614068031, -0.0327112190425396, -0.02942352183163166, -0.03776709362864494, 0.003930042963474989, -0.06293594837188721, -0.0029837938491255045, -0.04138632491230965, -0.01435260009020567, -0.049868036061525345, 0.029451148584485054, 0.03434125706553459, 0.02373221144080162, -0.006426898296922445, -0.02425713837146759, -0.026149636134505272, 0.03276647627353668, -0.012902145273983479, 0.008460989221930504, -0.024837320670485497, -0.009144775569438934, -0.05630529299378395, -0.0520782507956028, 0.006651373580098152, 0.10620095580816269, 0.012018058449029922, -0.04392807558178902, 0.04174548387527466, -0.01471176091581583, 0.04403858631849289, 0.006357829086482525, 0.009510842151939869, -0.008868497796356678, -0.011762501671910286, 0.10360395163297653, 0.024105185642838478, -0.02728237397968769, -0.012701843865215778, 0.00468289852142334, -0.0189664289355278, 0.02559708245098591, -0.017446905374526978, 0.024395275861024857, -0.0351148322224617, -0.0011405068216845393, 0.0383472740650177, -0.03398209437727928, 0.004002565983682871, 0.003325686790049076, 0.021425297483801842, -0.029920820146799088, 0.015112362802028656, -0.03320851922035217, 0.04249143227934837, 0.026826515793800354, -0.007763389497995377, 0.03141271695494652, 0.04343077540397644, -0.00379881146363914, 0.007079603150486946, -0.04287822172045708, 0.019795261323451996, 0.019394658505916595, 0.02219887264072895, 0.007328252773731947, 0.04710526391863823, 0.016369424760341644, 0.03931424394249916, -0.013461606577038765, -0.009476307779550552, -0.019878145307302475, 0.05235452950000763, -0.01944991573691368, -0.02724093198776245, -0.014780830591917038, 0.0025521107017993927, -0.0045654806308448315, 0.016521375626325607, -0.01646612025797367, 0.028870968148112297, 0.019436100497841835, -0.020817486569285393, 0.011479317210614681, 0.01253607776015997, 0.0508626326918602, 0.003557068994268775, -0.005480648949742317, -0.018275735899806023, -0.0033774888142943382, 0.0005866573774255812, 0.01993340067565441, 0.00426848279312253, 0.08868498355150223, 0.018869733437895775, 0.02255803346633911, 0.0011033820919692516, 0.0371316559612751, -0.0014996671816334128, 0.02579047717154026, -0.0605599619448185, 0.025887172669172287, 0.001568736508488655, 0.020513582974672318, 0.0012777820229530334, 0.014090137556195259, 0.06824047118425369, -0.02114901877939701, -0.044176723808050156, -0.03528060019016266, -0.017902761697769165, 0.007652878295630217, -0.005083500407636166, 0.009241471998393536, -0.026674563065171242, -0.018109969794750214, -0.0625491589307785, -0.0094832144677639, 0.013102445751428604, 0.012308149598538876, 0.013917463831603527, -0.05473051220178604, -0.007500926032662392, -0.04492267221212387, 0.011279016733169556, -0.004789955914020538, -0.025085968896746635, 0.00759762292727828, 0.018275735899806023, -0.0009272553725168109, 0.013869115151464939, -0.018703965470194817, -0.012646588496863842, -0.07713659107685089, 0.004068181850016117, 0.0007239325786940753, -0.014587435871362686, 0.008972101844847202, 0.026550238952040672, 0.0359160341322422, 0.022046919912099838, 0.010305139236152172, -0.06470412015914917, 0.12863466143608093, -0.03831964731216431, 0.028346041217446327, -0.01101655326783657, 0.02881571277976036, -0.048044603317976, 0.0007843682542443275, -0.010298232547938824, -0.005991761572659016, 0.021466737613081932, 0.0152366878464818, 0.010754089802503586, 0.02244752272963524, -0.015609662048518658, 0.022820496931672096, -0.03569501265883446, 0.02450578846037388, -0.0054737417958676815, -0.004731247201561928, 0.023027705028653145, -0.017405463382601738, -0.05718937888741493, 0.03378869965672493, -0.030141841620206833, 0.019919585436582565, -0.005763832945376635, 0.023483561351895332, -0.0187730360776186, 0.01921507902443409, 0.03845778480172157, -0.039783917367458344, -0.034120235592126846, -0.010519254021346569, 0.0427953377366066, 3.2726977224228904e-05, 0.0036364987026900053, 0.031385090202093124, -0.01581686921417713, -0.005446114111691713, -0.020154422149062157, -0.018303364515304565, -0.05768667906522751, 0.014697946608066559, 0.011790129356086254, 0.032876987010240555, -0.03613705933094025, 0.00516638346016407, 0.004907373804599047, -0.0035812431015074253, -0.013592838309705257, 0.009469401091337204, 0.0013192236656323075, -0.0048417579382658005, -0.019961027428507805, -0.010560696013271809, 0.0036503125447779894, 0.01101655326783657, 0.039618149399757385, 0.0076874131336808205, 0.03536348044872284, -0.005242359824478626, 0.03434125706553459, -0.010270604863762856, 0.03508720546960831, 0.022502778097987175, -0.0070070805959403515, -0.012204545550048351, 0.0029129977338016033, -0.02152199298143387, -0.01848294399678707, -0.03572264313697815, -0.07343447953462601, -0.03019709698855877, 0.012397939339280128, 0.030252354219555855, -0.0039334967732429504, -0.007335159461945295, -0.012156196869909763, -0.04771307110786438, -0.009959792718291283, -0.0250307135283947, -0.014117765240371227, -0.05417795851826668, -0.03831964731216431, 0.01940847374498844, 0.04928785189986229, 0.04000493884086609, 0.02356644533574581, -0.023138215765357018, -0.0015773701015859842, 0.019601866602897644, -0.02925775572657585, 0.015347198583185673, 0.047685444355010986, 0.034534648060798645, -0.023801280185580254, 0.0009436592808924615, -0.040225960314273834, -0.010595230385661125, 0.002103160135447979, -0.008419547230005264, 0.011334272101521492, 0.0058363559655845165, 0.03166136518120766, 0.020458325743675232, 0.004824490752071142, 0.018386248499155045, -0.019270334392786026, -0.0006716989446431398, 0.0046276431530714035, -0.009469401091337204, -0.020955625921487808, 0.02446434646844864, 0.026370659470558167, -0.03215866535902023, -0.009925258345901966, 0.004617282655090094, -0.03320851922035217, 0.02923012711107731, -0.027945438399910927, -0.008454082533717155, 0.025679966434836388, 0.003071857150644064, 0.015457709319889545, -0.03657910227775574, 0.0064303516410291195, -0.01166580431163311, -0.0363304503262043, -0.026619307696819305, -0.0010774810798466206, -0.05470288544893265, -0.013951998203992844, -0.035667385905981064, 0.018938802182674408, 0.03572264313697815, -0.02780730091035366, -0.001535928575322032, -0.026135822758078575, -0.034810926765203476, -0.008281408809125423, 0.03063914179801941, -0.017930390313267708, -0.028428923338651657, -0.03152322769165039, 0.02482350543141365, -0.014656505547463894, 0.005221639294177294, -0.0036434056237339973, -0.016162216663360596, 0.031219324097037315, -0.03177187964320183, 0.021162834018468857, 0.01642468012869358, -0.04025358706712723, 0.0017060117097571492, 0.0035035402979701757, 0.0029060908127576113, -0.028594689443707466, -0.02942352183163166, -0.011610548943281174, -0.003320506541058421, -0.012487729080021381, 0.027627719566226006, -0.012259800918400288, 0.013931278139352798, -0.013889836147427559, -0.010912949219346046, -0.020693162456154823, 0.016576632857322693, -0.01487752702087164, -0.015499151311814785, -0.01982288993895054, -0.003912775777280331, 0.027420511469244957, -0.021991664543747902, 0.010236070491373539, 0.012881424278020859, 0.014545994810760021, 0.010519254021346569, 0.026384472846984863, -0.011334272101521492, -0.02297244966030121, -0.009303634986281395, -0.029699798673391342, 0.005877797491848469, 0.022088361904025078, 0.02159106358885765, 0.004403167869895697, -0.007286811247467995, 0.01808234304189682, -0.02041688561439514, 0.03494906425476074, 0.021300971508026123, -0.004496411420404911, -0.003791904542595148, -0.02522410824894905, 0.0464145690202713, 0.0355292484164238, 0.034645162522792816, -0.014117765240371227, 0.018662525340914726, 0.003318779869005084, -0.0037124748341739178, 0.02022349089384079, -0.03199290111660957, -0.011175412684679031, -0.021176647394895554, -0.010394929908216, 0.004872838966548443, 0.033650562167167664, 0.0254313163459301, 0.0228066835552454, -0.00016943563241511583, -0.006651373580098152, -0.007604530081152916, -0.004997164011001587, -0.008827056735754013, -0.017101557925343513, -0.007383508142083883, -0.04464639723300934, -0.0407785139977932, -0.02091418392956257, -0.02203310653567314, -0.012881424278020859, -0.021162834018468857, 0.027558650821447372, -0.04193887859582901, -0.008523151278495789, -0.012902145273983479, -0.008309036493301392, 0.011997337453067303, -0.020803673192858696, -0.01856582798063755, 0.01384839415550232, 0.004962629172950983, -0.004233947955071926, 0.013351095840334892, -0.03135746344923973, 0.01004958339035511, 0.005577345844358206, -0.01881447806954384, 0.04061274975538254, -0.02293100766837597, -0.025403687730431557, -0.006547769531607628, 0.023870350793004036, -0.03906559571623802, 0.038568295538425446, -0.02333160862326622, -0.015775427222251892, -0.0476301908493042, 0.02333160862326622, 0.05224401876330376, -0.025776661932468414, -0.03039049170911312, 0.00015238414925988764, 0.011486224830150604, -0.004285749979317188, -0.03254545480012894, -0.024754436686635017, 0.008405733853578568, -0.005301068536937237, -0.03307038173079491, -0.009579911828041077, -0.05475814267992973, -0.006413084454834461, -0.055559344589710236, 0.003325686790049076, -0.0014659959124401212, -0.004316831007599831, -0.037076398730278015, 0.03486618399620056, 0.009248379617929459, 0.014173020608723164, 0.04367942363023758, 0.007846272550523281, 0.036385707557201385, -0.0363304503262043, 0.016397051513195038, 0.007984410971403122, -0.05089025944471359, -0.02469918131828308, 0.004309924319386482, 0.0024744076654314995, -0.0051180352456867695, -0.030528631061315536, -0.018386248499155045, 0.02207454852759838, 0.002388071035966277, 0.009738771244883537, 0.030777279287576675, 0.04807223379611969, 0.01418683398514986, -0.008454082533717155, -0.02349737659096718, 0.013192236423492432, -0.01453218050301075, 0.002897457219660282, -0.016783839091658592, -0.020693162456154823, 0.03823676332831383, -0.005214732140302658, -0.002091072965413332, -0.016203658655285835, 0.008543872274458408, -0.0034379244316369295, -0.011113250628113747, 0.023138215765357018, 0.005649868864566088, -0.012024965137243271, 0.0025037620216608047, -0.015457709319889545, 0.03660672903060913, 0.03063914179801941, -0.0343136265873909, 0.0037159284111112356, 0.026370659470558167, -0.008972101844847202, -0.008599127642810345, -0.005915785674005747, 0.03749081492424011, -0.022585660219192505, 0.011334272101521492, 0.03171662241220474, -0.0018389701144769788, -0.023221097886562347, 0.017502160742878914, -0.029976075515151024, -0.00408890238031745, -0.010595230385661125, -0.04735391214489937, 0.005995215382426977, 0.006067737936973572, -0.0661960169672966, -0.014463111758232117, -0.014863713644444942, 0.005328696686774492, -0.022613288834691048, -0.004330645315349102, 0.03983917087316513, -0.002141148317605257, -0.0867510437965393, -0.01206640712916851, 0.032794103026390076, 0.026329217478632927, -0.004354819189757109, 0.0013762058224529028, 0.00743876351043582, 0.0021912234369665384, 0.005228545982390642, -0.037684209644794464, -0.02215743064880371, -0.019367031753063202, 0.01053306832909584, -0.002097979886457324, 0.015678731724619865, -0.06663805991411209, -0.023787466809153557, 0.017308766022324562, 0.03387158364057541, -0.0012087126960977912, -0.012888330966234207, 0.008481710217893124, -0.018068529665470123, 0.014960410073399544, -0.01944991573691368, -0.030749652534723282, -0.008992822840809822, 0.003988752141594887, -0.01101655326783657, 0.019670937210321426, -0.026467354968190193, -0.013171515427529812, 0.0014556355308741331, 0.0007174573256634176, -0.003978391643613577, -0.024726809933781624, -0.011071808636188507, -0.045917268842458725, -0.000704506877809763, -0.006357829086482525, -0.013509955257177353, -0.039369501173496246, 0.035667385905981064, -0.013254398480057716, 0.03439651057124138, 0.010146279819309711, 0.03815388306975365, 0.03144034370779991, 0.015222873538732529, 0.003035595640540123, -0.0015929107321426272, 0.008868497796356678, -0.003926589619368315, 0.038927458226680756, -0.000707960338331759, -0.0029734333511441946, -0.010104838758707047, -0.013648093678057194, 0.005000617355108261, 0.05221639201045036, -0.006502874661237001, -0.0034361977595835924, -0.00619551632553339, -0.03508720546960831, -0.028870968148112297, -0.011873012408614159, -0.0048797461204230785, 0.029285382479429245, 0.0006306890281848609, -0.048044603317976, -0.0020686255302280188, 0.007314438931643963, 0.007487112190574408, -0.0018614176660776138, 0.010125559754669666, 0.003954217303544283, -0.0064303516410291195, 0.06453835219144821, -0.030528631061315536, 0.025693779811263084, 0.02150817960500717, -0.014145392924547195, 0.000922075123526156, -0.011209947057068348, 0.011251389048993587, 0.019353218376636505, 0.03776709362864494, -0.005263080820441246, 0.002303461078554392, 0.033650562167167664, 0.030970674008131027, -0.028401296585798264, 0.005114581435918808, -0.0005240633036009967, 0.007487112190574408, -0.004893559962511063, 0.021867340430617332, 0.02446434646844864, 0.05395693704485893, -0.016010263934731483, 0.039452385157346725, 0.03912085294723511, -0.061333537101745605, -0.02356644533574581, -0.010657393373548985, -0.012971214950084686, 0.02889859490096569, -0.0002840475062839687, 0.027669161558151245, 0.007418042980134487, 0.01860726997256279, 0.007742668502032757, -0.006309480406343937, 0.058957554399967194, 0.009863096289336681, 0.025887172669172287, 0.04376230761408806, -0.0007917068433016539, 0.02587335929274559, -0.0014280077302828431, -0.02853943407535553, 0.042684826999902725, -0.036551471799612045, -0.006955278571695089, -0.019228892400860786, -0.0002829682780429721, 0.02551419846713543, 0.01589975319802761, -0.028042135760188103, -0.015968821942806244, -0.0026919760275632143, 0.015402453951537609, 0.020112980157136917, -0.03920373320579529, -0.034728042781353, 0.012004244141280651, -0.0007066652760840952, 0.013440885581076145, -0.02228175662457943, 0.04572387784719467, 0.008122549392282963, -0.006033203564584255, 0.03265596553683281, -0.01304028369486332, 0.03895508497953415, 0.02329016849398613, -0.00711413798853755, -0.035584501922130585, -0.005197464954108, -0.0050075240433216095, 0.03293224051594734, 0.010070303454995155, -0.033650562167167664, 0.003118478925898671, -0.005794914439320564, 0.006499421317130327, -0.02131478674709797, -0.027517208829522133, 0.0034396511036902666, 0.011175412684679031, 0.04182836785912514, 0.05506204441189766, -0.011368806473910809, 0.0050455122254788876, 0.015844497829675674, -0.018275735899806023, -0.01974000595510006, -0.0019891958218067884, -0.026854144409298897, -0.0018424235749989748, 0.009144775569438934, -0.04265720024704933, 0.048541903495788574, -0.0020185501780360937, 0.02608056738972664, -0.0007006216910667717, -0.003083944320678711, 0.011831571348011494, -0.0006108316010795534, 0.023234913125634193, -0.009876909665763378, 0.018054714426398277, -0.031827133148908615, 0.03790523111820221, -0.00308221741579473, 0.003266977844759822, 0.017460718750953674, -0.004669084679335356, 0.015913566574454308, 0.05702361464500427, 0.021010881289839745, 0.013275119476020336, 0.012729471549391747, 0.013206049799919128, 0.007652878295630217, -0.03177187964320183, -0.0022585662081837654, 0.025196481496095657, -0.029534032568335533, -0.013503048568964005, -0.023801280185580254, 0.03583315387368202, -0.014097044244408607, -0.012688030488789082, -0.04464639723300934, -0.009006637148559093, 0.010270604863762856, 0.005066233221441507, -0.01816522516310215, 0.028760455548763275, 0.00209452654235065, -0.0039714849554002285, -0.004202866926789284, 0.03525296971201897, -0.006761884316802025, -0.024934018030762672, -0.005314882844686508, -0.0083781061694026, -0.028870968148112297, 0.0037159284111112356, -0.013309653848409653, -0.019187452271580696, 0.0008875405183061957, 0.027917811647057533, -0.005104221403598785, 0.03135746344923973, -0.01223217323422432, -0.011175412684679031, 0.002807667013257742, -0.0011940355179831386, -0.004251215606927872, -0.013233677484095097, -0.0217982716858387, 0.014794643968343735, 0.0002933286887127906, -0.04967464134097099, -0.024809692054986954, -0.013413257896900177, 0.011769408360123634, -0.00023720988247077912, 0.026494983583688736, 0.008309036493301392, -0.018745407462120056, -0.00677915196865797, 0.024022301658988, 0.01583068259060383, 0.014836085960268974, 0.010712648741900921, -0.028428923338651657, -0.019159823656082153, 0.015250501222908497, -0.0010343127651140094, 0.007162486203014851, -0.013309653848409653, 0.024768250063061714, 0.010139373131096363, 0.041469208896160126, 0.026343030855059624, 0.024892576038837433, 0.02789018303155899, -0.020858928561210632, 0.022820496931672096, 0.011624363251030445, 0.02215743064880371, 0.004679445177316666, -0.02417425438761711, -0.029202500358223915, 0.008108736015856266, 0.012708751484751701, 0.006402723956853151, -0.009883816353976727, 0.02534843236207962, -0.0017448632279410958, 0.023027705028653145, -0.01283307559788227, -0.0020375442691147327, -0.01067811343818903, -0.02696465514600277, 0.02171538770198822, 0.006634106393903494, -0.012667309492826462, -0.03575026988983154, -0.016397051513195038, 0.0038195322267711163, 0.004126890562474728, 0.026467354968190193, -0.05050347372889519, 0.01017390750348568, 0.04028121381998062, -0.02406374365091324, 0.015872124582529068, 0.04633168503642082, -0.01856582798063755, 0.0037124748341739178, 0.024961644783616066, -0.0016291721258312464, 0.010139373131096363, -0.005746565759181976, 0.015568220056593418, -0.015692545101046562, 0.006810232996940613, 0.00408890238031745, -0.006865488365292549, -0.017971832305192947, -0.0025123958475887775, 0.012529171071946621, -0.025003086775541306, -0.04972989484667778, -0.005829448811709881, 0.005314882844686508, -0.016935791820287704, 0.02721330337226391, 0.031136440113186836, -0.0052838013507425785, 0.0009617899777367711, 0.004095809534192085, -0.0007822097977623343, -0.03254545480012894, 0.012750192545354366, -0.006758430972695351, 0.01487752702087164, 0.01759885810315609, 0.006447619292885065, 0.023925606161355972, 0.008958288468420506, -0.0027023362927138805, 0.004299563821405172, -0.004720886703580618, 0.003978391643613577, 0.009738771244883537, 0.036192312836647034, -0.0022430254612118006, -0.0031996353063732386, 0.03776709362864494, -0.03132983297109604, 0.0005067960009910166, -0.019684750586748123, -0.014090137556195259, -0.002602185821160674, 0.014034882187843323, 0.03342954069375992, 0.018027087673544884, 7.230692426674068e-05, 0.004907373804599047, -0.02429858036339283, 0.02353881672024727, -0.0034154767636209726, -0.04779595509171486, 0.01654900424182415, 0.0018147958908230066, 0.07155579328536987, -0.03668961301445961, -0.013496140949428082, -0.0049039204604923725, -0.028401296585798264, 0.04387281835079193, -0.003323960117995739, -0.0027731324080377817, 0.002336269011721015, 0.003318779869005084, 0.01690816506743431, 0.023552631959319115, 0.0031599204521626234, 0.000526221701875329, 0.028318412601947784, -0.018938802182674408, -0.018275735899806023, 0.030169470235705376, 0.010871508158743382, 0.03168899565935135, 0.04017070308327675, 0.006786058656871319, -0.004448062740266323, 0.012743285857141018, -0.02398086152970791, 0.0173640213906765, -0.01132045779377222, 0.02356644533574581, 0.010132466442883015, 0.00466217752546072, -0.02837366797029972, -0.018552014604210854, -0.008944474160671234, 0.04834850877523422, -0.01715681329369545, 0.008101829327642918, 0.022709986194968224, 0.017529787495732307, -0.01087841484695673, 0.03144034370779991, -0.007791017182171345, -0.008502431213855743, -0.01743309199810028, -0.0017172354273498058, -0.012929772958159447, -0.0017086018342524767, -0.014684133231639862, 0.006616838742047548, -0.013482327573001385, 0.009766398929059505, -0.02255803346633911, -0.011486224830150604, 0.0020030096638947725, 0.003974938299506903, -0.017225883901119232, -0.01667332835495472, 0.008502431213855743, 0.0544818639755249, 0.026425914838910103, 0.004810676909983158, -0.035584501922130585, 0.008771801367402077, -0.030777279287576675, 0.034976694732904434, 0.016493748873472214, -0.02288956567645073, -0.009876909665763378, 0.008260687813162804, 0.0036054174415767193, 0.03166136518120766, -0.0020409978460520506, -0.0022827403154224157, 0.019753819331526756, -0.0036986609920859337, -0.01747453212738037, 0.02083129994571209, -0.02652261033654213, 0.007162486203014851, 0.019629495218396187, 0.046193547546863556, -0.038844574242830276, -0.007735761348158121, -0.02446434646844864, 0.009393424727022648, -0.004758874885737896, 0.038485415279865265, 0.014697946608066559, -0.004948815330862999, 0.0004640593542717397, 0.020444512367248535, -0.013931278139352798, 0.01940847374498844, 0.013254398480057716, 0.004102716222405434, -0.006720442790538073, -0.02074841782450676, -0.02123190276324749, -0.00028275244403630495, -0.02293100766837597, -0.024229509755969048, -0.017212068662047386, -0.004209773615002632, -0.006851674523204565, -0.004261575639247894, 0.004306470975279808, -0.008267595432698727, -0.03301512449979782, 0.0007614890346303582, -0.002868102630600333, 0.006830953527241945, -0.029174871742725372, -0.002776585752144456, 0.017930390313267708, 0.004648363683372736, 0.00932435505092144, 0.05274131894111633, 0.009683515876531601, 0.014476925134658813, -0.0006872395169921219, 0.007763389497995377, 0.0012613780563697219, 4.702647856902331e-05, 0.023759840056300163, 0.009856188669800758, -0.0029993343632668257, -0.010843880474567413, -0.0022412987891584635, 0.006399270612746477, -0.009683515876531601, -0.02360788732767105, -0.01683909446001053, -0.00853696558624506, 0.010754089802503586, -0.005263080820441246, 0.02692321315407753, 0.033650562167167664, 0.0011163325980305672, -0.03649621829390526, -0.03135746344923973, -0.0074111358262598515, 0.0045896549709141254, -0.006506328005343676, -0.01751597411930561, 0.030335236340761185, 0.0059883082285523415, 0.015733987092971802, 0.02253040485084057, -0.016894349828362465, 0.004869385622441769, 0.006786058656871319, -0.02700609713792801, 0.027420511469244957, -0.01105799525976181, 0.007238462567329407, 0.016687143594026566, -0.0031806412152945995, -0.018980244174599648, -0.014697946608066559, 0.018842104822397232, -0.023746024817228317, 0.01269493717700243, 0.013157702051103115, -0.008481710217893124, 0.01917363703250885, 0.044508256018161774, -0.02494783140718937, -0.03688300773501396, 0.03657910227775574, -0.009158588945865631, -0.002339722588658333, -0.001304546371102333, -0.019187452271580696, 0.011997337453067303, -0.023525003343820572, -0.008101829327642918, -0.02005772478878498, 0.006129900459200144, 0.022433709353208542, -0.007784110028296709, -0.031827133148908615, -0.048099860548973083, 0.006167888641357422, 0.03387158364057541, 0.0027161501348018646, -0.048210371285676956, -0.029009105637669563, 0.018786849454045296, 0.011838478036224842, -0.01799945905804634, -0.018013274297118187, -0.014338786713778973, -0.011948988772928715, 0.01598263531923294, 0.0032186293974518776, -0.008433361537754536, 0.019463729113340378, -0.01663188822567463, 0.01759885810315609, 0.06122302636504173, 0.01069883443415165, 0.015733987092971802, -0.04086139798164368, -0.020043911412358284, -0.013979625888168812, 0.006388910114765167, 0.02264091558754444, -0.008039666339755058, 0.02837366797029972, -0.028760455548763275, -0.006112632807344198, 0.001494486932642758, -0.01743309199810028, 0.020679349079728127, 0.015112362802028656, 0.0033930293284356594, 0.0032894255127757788, -0.014725574292242527, -0.016880536451935768, -0.05674733594059944, -0.058128722012043, -0.01888354681432247, -0.009414145722985268, 0.04141395166516304, 0.029009105637669563, 0.011658897623419762, -0.0019788353238254786, -0.014324972406029701, 0.0019322136649861932, 0.011928267776966095, 0.0045792944729328156, 0.0022015839349478483, -0.03837490454316139, -0.0029924274422228336, 0.005301068536937237, 0.003999112639576197, -0.014518367126584053, 0.03771183639764786, -0.016576632857322693, 0.008792521432042122, 0.02413281425833702, 0.007708133663982153, 0.03293224051594734, 0.010809345170855522, 0.03580552339553833, 1.8683786038309336e-05, 0.056084271520376205, 0.004713979549705982, 0.05387405306100845, -0.04735391214489937, 0.0016049979021772742, -0.0028111205901950598, 0.006824046839028597, 0.009331262670457363, -0.0177646242082119, 0.015126177109777927, -0.014297344721853733, -0.00022382769384421408, -0.029285382479429245, -0.0022309382911771536, 0.029837938025593758, -0.002517575863748789, 0.0034275639336556196, -0.007694319821894169, 0.0017854414181783795, -0.036109428852796555, 0.03522534295916557, -0.013157702051103115, 0.034009724855422974, -0.004233947955071926, 0.016217472031712532, 0.026812702417373657, 0.0017086018342524767, 0.005035151727497578, -0.003539801575243473, -0.0009082612814381719, 0.013102445751428604, -0.02255803346633911, -0.013820766471326351, 0.008005131967365742, -0.038927458226680756, 0.004195959772914648, 0.0193808451294899, -0.002379437442868948, -0.021425297483801842, -0.008550778962671757, -0.0024467799812555313, -0.018621083348989487, -0.01917363703250885, 0.02377365343272686, -0.007866993546485901, 0.006568490527570248, 0.008157084695994854, 0.006592664867639542, -0.03434125706553459, 0.011161599308252335, -0.002586645307019353, -0.018275735899806023, -0.021383855491876602, -0.0012026692274957895, 0.04787883907556534, -0.043651796877384186, 0.006250771693885326, 0.007459484506398439, 0.03972866013646126, 0.021701574325561523, 0.046276431530714035, -0.018151411786675453, 0.0011664078338071704, -0.020845115184783936, -0.007556181401014328, 0.012135475873947144, -0.021950222551822662, -0.00019522869843058288, 0.029561661183834076, 0.019947214052081108, -0.019118381664156914, -0.00972495786845684, -0.019284147769212723, 0.013109353370964527, 0.04771307110786438, 0.0003250573936384171, 0.005090407561510801, -0.03246257081627846, 0.01650756224989891, 0.06067047268152237, -0.03536348044872284, 0.000949702865909785, -0.0027731324080377817, 0.04008782282471657, 0.005694763734936714, 0.03575026988983154, -0.004209773615002632, 0.01888354681432247, -0.011348086409270763, -0.007632157765328884, 0.013627372682094574, 0.012764006853103638, -0.0008042256813496351, 0.044618766754865646, -0.003078764071688056, -0.021563434973359108, 0.008661290630698204, -0.014725574292242527, -0.012080220505595207, -0.030003704130649567, 0.0034897264558821917, -0.008702731691300869, -0.0034241105895489454, -0.046359315514564514, -0.010526161640882492, 0.05785244703292847, 0.020375443622469902, -0.01606551930308342, -0.02337305061519146, 0.0004929821006953716, -0.0067549776285886765, 0.01638323813676834, -0.024450531229376793, -0.006965639069676399, -0.003474185708910227, -0.01239103265106678, 0.009151682257652283, 0.021245716139674187, -0.004140704404562712, 0.006344015244394541, 0.007860085926949978, -0.030694397166371346, -0.027945438399910927, -0.008094921708106995, -0.012971214950084686, -0.0004098831268493086, 0.02438146248459816, 0.015471522696316242, 0.014000346884131432, -0.024243324995040894, -0.020126793533563614, -0.013074818067252636, -0.015181432478129864, 0.006799872498959303, 0.004050914663821459, 0.0173640213906765, -0.02870520018041134, 0.025652337819337845, 0.0027783126570284367, -0.034451767802238464, 0.011803943663835526, 0.009787119925022125, 0.014435484074056149, 0.03414786234498024]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" ϕirepre-
sents an early or final-exit layer that converts hidden states
xiinto output oi, e.g. logits for next-token prediction.
exiting. In addition to compatibility with existing functional-
ities of 3D parallelism provided by Megatron-LM, EE-LLM
also implements a variety of algorithmic innovations, includ-
ing a lightweight method that facilitates backpropagation for
the early-exit training objective through pipeline stages, var-
ious techniques of leveraging idle resources in the original
pipeline schedule for computation related to early-exit lay-
ers, and two approaches of early-exit inference that are com-
patible with KV caching. Implementation of EE-LLM has
been well optimized for maximum training and inference
efficiency. Our analytical and empirical study confirms that,
with negligible computational overhead caused by early-exit
layers during training with 3D parallelism, one obtains an
early-exit LLM that generates tokens with adaptive token-
wise exit selection, achieving outstanding inference speedup
without compromising output quality. With EE-LLM , it is
now possible to train and deploy early-exit LLMs that are
as large as the maximum sizes of standard LLMs allowed
by Megatron-LM, given the same amount of computational
resources. The source code for EE-LLM can be found at
https://github.com/pan-x-c/EE-LLM .
Organization. Section 2 provides a high-level overview
ofEE-LLM , while Sections 3 and 4 focus on training and in-
ference, respectively. The efficacy of EE-LLM is validated
by numerical experiments in Section 5. The appendix in-
cludes extended preliminaries and related works, additional
experiments, as well as more details about the training effi-
ciency, advanced features, and implementation of EE-LLM .
2. An overview of EE-LLM
This section provides an overview of our system for scaling
up sizes, training and inference of early-exit LLMs, with
flexible configurations and a wide range of functionalities.
Model architectures. We implement in EE-LLM an early-
exit Transformer architecture, which is built upon the gener-
ative pre-training (GPT) Transformer architecture (Radford
2
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
et al., 2018; 2019) originally implemented in Megatron-LM.
EE-LLM allows users to (1) specify arbitrary layers to add
early exits to; (2) add trainable modules to each early-exit
layer, e.g. a multi-layer perceptron (MLP) or a complete
Transformer layer, on top of the minimalistic structure (with
an output embedding matrix, plus an optional layer normal-
ization module in front of it); and (3) choose to tie (Press
& Wolf, 2017; Schuster et al., 2022; Varshney et al., 2023)
or untie the input and output embedding matrices of all
early/final-exit layers. Each option has its own pros and
cons, as will be discussed in later sections. With this in
mind, EE-LLM has been designed to cover a wide range
of configurations, so that users can easily try them out and
choose the most suitable ones for their own use cases.
Training. EE-LLM contains the essential functionalities
for training early-exit LLMs, which tackle the main chal-
lenges outlined in Section 1, i.e. how to train with 3D paral-
lelism while minimizing the computational overhead caused
by early-exit layers. In addition to substantial engineer-
ing efforts for compatibility with existing functionalities
in Megatron-LM, we design and implement a simple yet
effective algorithm that facilitates pipeline parallelism with
multiple early/final-exit training losses located on different
pipeline stages, which is not possible in standard pipeline
parallelism implemented by Megatron-LM or other frame-
works. Moreover, our analytical and empirical study shows
that training an early-exit LLM with EE-LLM is almost as
efficient as training a standard LLM, in terms of training
time and peak GPU memory. This is achieved by various
performance optimizations that we design and implement
inEE-LLM , especially the ones that leverage idle compu-
tational resources in standard pipeline parallelism. Finally,
EE-LLM contains some advanced features for fine-grained
control or optimization of the training process, including the
option of changing early-exit loss weights during training,
and a novel method of further improving resource utilization
by filling pipeline bubbles with useful computation.
Inference. We design","[0.016314713284373283, 0.016329023987054825, 0.05295126140117645, -0.032142847776412964, 0.009202070534229279, 0.024772603064775467, 0.028822660446166992, 0.04656848683953285, -0.0025885296054184437, 0.0697239339351654, 0.033173248171806335, -0.03383156284689903, -0.03116968832910061, 0.01967783272266388, -0.0183325856924057, -0.034318141639232635, 0.010010650381445885, -0.03377431631088257, 0.015842445194721222, 0.06583129614591599, 0.0327439159154892, -0.015541911125183105, 0.027577590197324753, 0.036121346056461334, 0.022969398647546768, -0.022611619904637337, 0.0384683758020401, 0.0379817970097065, -0.009073270484805107, -0.04473666101694107, 0.06920872628688812, -0.04336278885602951, -0.0419030524790287, -0.025287805125117302, -0.02139517106115818, 0.006529462989419699, 0.023384422063827515, 0.03517680987715721, -0.015241376124322414, 0.047970980405807495, 0.019978368654847145, -0.03677966073155403, -0.05421064421534538, 0.03128417581319809, -0.03866873309016228, 0.013860350474715233, 0.03689415007829666, 0.016243157908320427, 0.011584877036511898, 0.05770256370306015, 0.0037208993453532457, 0.0018407718744128942, -0.0013085759710520506, 0.013402394019067287, -0.03242906928062439, -0.03131280094385147, -0.0026511407922953367, -0.012493635527789593, -0.0022486397065222263, -0.019878190010786057, 0.018618809059262276, -0.026904964819550514, 0.013216348364949226, 0.0013613483170047402, -0.01439701858907938, 0.022225217893719673, -0.05733047425746918, 0.016314713284373283, 0.0032861982472240925, 0.012114389799535275, -0.017817383632063866, -0.009359492920339108, 0.016872847452759743, -0.024286024272441864, -0.018518630415201187, 0.005670793820172548, 0.0133809270337224, 0.046940576285123825, -0.01730218157172203, -0.011169853620231152, 0.028937147930264473, -0.013087548315525055, 0.009717271663248539, -0.02208210714161396, 0.005223570391535759, -0.04015709087252617, 0.010711897164583206, -0.024715358391404152, -0.017559783533215523, -0.0218531284481287, -0.019835256040096283, -0.026117851957678795, -0.010869319550693035, 0.03005341812968254, 0.06588853895664215, 0.04339141026139259, 0.01648644730448723, -0.06794934719800949, 0.03314462676644325, 0.06897974759340286, 0.000442080432549119, 0.019305743277072906, 0.026890654116868973, -0.04356314614415169, 0.03509094566106796, -0.03177075833082199, -0.03343085199594498, -0.015227065421640873, -0.0010509751737117767, -0.02866523712873459, -0.04290483146905899, 0.005431082099676132, -0.004490124061703682, 0.0044221458956599236, 0.029509594663977623, -0.04565257579088211, -0.040929894894361496, 0.03801041841506958, 0.023599090054631233, 0.01901951991021633, -0.018819164484739304, 0.016672492027282715, 0.014983776025474072, -0.01591400057077408, 0.02640407532453537, 0.00033877178793773055, 0.028965771198272705, -0.01541311014443636, 0.016085734590888023, -0.023971179500222206, -0.0015778044471517205, 0.03517680987715721, 0.05801741033792496, -0.03148453310132027, -0.046396754682064056, 0.009223537519574165, -0.03695139288902283, -0.01217163447290659, -0.024672426283359528, -0.0030250197742134333, 0.026833409443497658, -0.007477576844394207, -0.013166259974241257, 0.0006900658481754363, -0.029996173456311226, 0.045824307948350906, -0.018733298406004906, 0.004608191084116697, -0.0201357901096344, 0.0020608059130609035, -0.017473915591835976, -0.056843895465135574, -0.021252060309052467, -0.03231457993388176, -0.0268477201461792, 0.0067655970342457294, -0.020980147644877434, 0.029795818030834198, 0.08317641168832779, -0.03743797168135643, -0.007309420965611935, 0.03194249048829079, 0.02243988588452339, 0.03406054154038429, 0.005699416156858206, 0.0553269125521183, -0.0184184517711401, -0.014332618564367294, -0.08260396867990494, -0.020894281566143036, -0.00602857256308198, -0.02458655834197998, -0.050919078290462494, -0.0184184517711401, 0.0005031264154240489, -0.04430732503533363, -0.057759806513786316, -0.025860251858830452, -0.007527665700763464, -0.0849509984254837, -0.03915531188249588, 0.03463298827409744, -0.016414891928434372, 0.011098298244178295, -0.06176692992448807, 0.007295109797269106, -0.019176943227648735, 0.023413043469190598, -0.0028604413382709026, 0.015341554768383503, -0.021108949556946754, 0.044564925134181976, 0.07373105734586716, 0.013230659998953342, 0.014711864292621613, 0.027348611503839493, 0.05813189968466759, 0.025659894570708275, 0.013051770627498627, -0.016200223937630653, 0.029108881950378418, 0.046940576285123825, 0.03368845209479332, -0.04777062311768532, 0.07212820649147034, 0.01529862079769373, 0.004940925166010857, 0.003731632838025689, -0.014554440975189209, -0.0391266904771328, 0.02183881774544716, 0.005595660302788019, 0.02664736472070217, 0.014547285623848438, 0.004597457591444254, -0.00072226591873914, -0.0536954402923584, 0.025559717789292336, 0.06886526197195053, 0.03803903982043266, -0.004211056511849165, 0.01461884193122387, 0.014561597257852554, 0.030311020091176033, -0.07058259844779968, 0.0012370201293379068, 0.00563501613214612, -0.07184198498725891, 0.005677949637174606, 0.0004718207928817719, 0.014125106856226921, -0.013209193013608456, -0.006654685363173485, -0.01548466645181179, -0.002720907796174288, -0.03652206063270569, -0.029767194762825966, -0.03240044787526131, 0.02422877959907055, -0.0027674189768731594, 0.034661609679460526, 0.045595329254865646, -0.0004588513111229986, -0.016643868759274483, -0.05323748290538788, 0.008007089607417583, -0.012865724973380566, -0.0512339249253273, 0.0028747525066137314, 0.0013899706536903977, 0.024185845628380775, -0.03096933290362358, -0.020522192120552063, -0.017230626195669174, -0.012314746156334877, 0.0350336991250515, -0.0195633452385664, -0.00030724253156222403, -0.00955984927713871, 0.015169820748269558, -0.01797480694949627, 0.03686552867293358, -0.0018210940761491656, 0.048428937792778015, 0.014146573841571808, -0.004565257579088211, -0.03743797168135643, 0.00978882797062397, -0.0015178765170276165, -0.0011180586880072951, 0.0384683758020401, -0.030568620190024376, 0.0006274545448832214, 0.02822159044444561, -0.0407581590116024, 0.003611776977777481, 0.056271448731422424, 0.02221090719103813, 0.00048300137859769166, 0.03583512455224991, -0.004747724626213312, -0.008486513048410416, 0.04948796331882477, -0.009946250356733799, -0.014525818638503551, 0.013330837711691856, -0.026776164770126343, -0.021466728299856186, -0.007620688062161207, -0.005509793292731047, 0.020550813525915146, -0.028937147930264473, 0.04198892042040825, -0.024772603064775467, 0.034547120332717896, 0.004418568219989538, 0.018475696444511414, -0.024042734876275063, -0.015012398362159729, 0.020507879555225372, 0.038983575999736786, 0.02697652019560337, -0.03838250786066055, -0.0006864880560897291, -0.013853195123374462, 0.0639994740486145, -0.018704675137996674, -0.00870833545923233, -0.04038606956601143, 0.01899089850485325, -0.001135947648435831, -0.010010650381445885, -0.008357712998986244, 0.02286922000348568, -0.03632170334458351, -0.03677966073155403, -0.014683241955935955, -0.029881684109568596, 0.007406021002680063, -0.04539497196674347, -0.013724394142627716, -0.06136621907353401, -0.029652707278728485, -0.03984224796295166, 0.023298554122447968, 0.008887224830687046, -0.002001772401854396, -0.005041103344410658, -0.015241376124322414, -0.017702894285321236, 0.02835039235651493, -0.014203818514943123, -0.02016441337764263, -0.04914449527859688, -0.010282562114298344, -0.03285840526223183, -0.04133060574531555, 0.002774574561044574, 0.08432130515575409, 0.014797731302678585, -0.052292946726083755, 0.021824507042765617, -0.029051637277007103, 0.023642022162675858, -0.0076135327108204365, 0.02288353070616722, 0.0016815603012219071, -0.0024579402524977922, 0.10441416501998901, 0.04516599327325821, -0.03300151601433754, -0.019162632524967194, 0.002152039436623454, -0.0267618540674448, 0.031226933002471924, -0.035463035106658936, 0.02470104768872261, -0.04462217167019844, 0.007928377948701382, 0.04642537608742714, -0.027119632810354233, 0.006801374722272158, 0.024300334975123405, 0.03325911611318588, -0.051491525024175644, 0.009982028044760227, -0.03720899298787117, 0.03343085199594498, 0.013509727083146572, -0.03051137551665306, 0.04742715507745743, 0.041817184537649155, 0.027835190296173096, 0.023398732766509056, -0.03440400958061218, 0.018518630415201187, 0.006221773102879524, 0.019262809306383133, 0.005445393268018961, 0.055470023304224014, 0.02514469437301159, 0.03529129922389984, -0.03904082253575325, -0.0013568761060014367, -0.006597441155463457, 0.049316227436065674, -0.0016681436682119966, -0.04107300564646721, -0.01343101542443037, 0.023370111361145973, 0.006482951808720827, 0.019277121871709824, -0.01525568775832653, 0.006722663529217243, 0.03085484355688095, -0.015427421778440475, 0.003996388986706734, 0.01776013895869255, 0.045366350561380386, -0.005477593280375004, -0.02025027945637703, -0.010239629074931145, -0.009409582242369652, -0.023198377341032028, 0.02162414975464344, 0.012307590804994106, 0.05472584441304207, 0.009151981212198734, 0.02673323079943657, 0.012393457815051079, 0.04528048262000084, -0.026103541254997253, 0.019863879308104515, -0.050089031457901, 0.02150966040790081, -0.01820378564298153, 0.04144509509205818, -0.005273659247905016, 0.029280615970492363, 0.05575624853372574, -0.020107168704271317, -0.0250445157289505, -0.03958464413881302, -0.00819313433021307, -0.0007168992306105793, -0.014311151579022408, 0.0355202779173851, -0.02925199456512928, -0.021795883774757385, -0.07132677733898163, -0.0074489545077085495, 0.023055264726281166, 0.01525568775832653, 0.012815636582672596, -0.05747358500957489, -0.00955269392579794, -0.03723761811852455, 0.0262752752751112, -0.010819231159985065, -0.012837102636694908, 0.012944436632096767, 0.013416704721748829, -0.026375452056527138, -0.0003179759078193456, -0.03311600536108017, -0.02468673698604107, -0.05987785756587982, -0.0018980165477842093, -0.0030786865390837193, -0.00865824706852436, 0.011291498318314552, 0.008601002395153046, 0.05724460631608963, 0.03861148655414581, 0.00019018178863916546, -0.05701562762260437, 0.10578803718090057, -0.03884046524763107, 0.029051637277007103, -0.023642022162675858, 0.0038496998604387045, -0.04711231216788292, -0.017888939008116722, -0.018175162374973297, -0.01743098348379135, 0.027506032958626747, 0.032142847776412964, 0.008787047117948532, 0.014067862182855606, -0.0005411404417827725, 0.0327439159154892, -0.036006856709718704, 0.03348809480667114, -0.006261128932237625, -0.008801358751952648, 0.03866873309016228, -0.02286922000348568, -0.060736529529094696, 0.028622303158044815, -0.037266239523887634, 0.02641838602721691, -0.022897843271493912, 0.0166152473539114, -0.015327243134379387, 0.029996173456311226, 0.043649014085531235, -0.02221090719103813, -0.025430915877223015, -0.02422877959907055, 0.039899490773677826, 0.002245062030851841, -0.012858569622039795, 0.03889771178364754, -0.01728787086904049, 0.0007678827387280762, -0.04791373759508133, -0.02730567753314972, -0.06686170399188995, 0.021681394428014755, 0.014082172885537148, 0.036235835403203964, -0.01821809634566307, 0.016414891928434372, 0.01671542599797249, 0.003116253297775984, 0.0029659862630069256, 0.0024901404976844788, -0.008486513048410416, -0.006926597561687231, -0.021566905081272125, -0.009223537519574165, 0.01428252924233675, 0.008329090662300587, 0.04565257579088211, 0.01650075800716877, 0.02993892878293991, -0.003112675389274955, 0.030253775417804718, -0.006479374133050442, 0.017788762226700783, 0.037151750177145004, 0.00030701892683282495, -0.007420332171022892, 0.0068335747346282005, -0.028150035068392754, -0.0032987205777317286, -0.05509793385863304, -0.0736738070845604, -0.042389631271362305, 0.002783518983051181, 0.023026643320918083, -0.01718769408762455, -0.0028783304151147604, -0.015985555946826935, -0.05744496360421181, -0.00028577580815181136, -0.024099979549646378, -0.024529313668608665, -0.05415339767932892, -0.04393523558974266, 0.031226933002471924, 0.044221457093954086, 0.038983575999736786, 0.01625746861100197, -0.020650992169976234, -0.004622501786798239, 0.019649211317300797, -0.001264748047105968, 0.008042867295444012, 0.02501589246094227, 0.03672241419553757, -0.030768975615501404, 0.009144825860857964, -0.03311600536108017, -0.02322699874639511, 0.01741667091846466, -0.013337993063032627, 0.0014159096172079444, -0.003457932034507394, 0.024786915630102158, 0.017473915591835976, 0.01674404740333557, 0.02254006452858448, -0.009416737593710423, -0.0038604331202805042, 0.004035744816064835, 0.0001757588324835524, -0.006132328417152166, 0.010253939777612686, 0.019162632524967194, -0.01887640915811062, -0.0010143028339371085, 0.0036672325804829597, -0.03709450364112854, 0.029194749891757965, -0.019835256040096283, -0.013681461103260517, 0.028951460495591164, -0.003479398787021637, 0.006397084798663855, -0.03048275224864483, 0.00731299864128232, -0.016243157908320427, -0.026604430750012398, -0.024786915630102158, 0.003878322197124362, -0.07098331302404404, -0.022454196587204933, -0.03119831159710884, 0.052292946726083755, 0.02389962412416935, -0.04699782282114029, 0.0008242328767664731, -0.03403192013502121, -0.04155958443880081, -0.011513321660459042, 0.02900870516896248, -0.018862098455429077, -0.031913869082927704, -0.019320053979754448, 0.0043076565489172935, -0.007184198126196861, 0.006175261922180653, -0.008014244958758354, -0.0047012134455144405, 0.03471885249018669, -0.01877623051404953, 0.006547351833432913, 0.004908725153654814, -0.05667215958237648, -0.004558101762086153, -0.0063219512812793255, -0.004078678321093321, -0.020751170814037323, -0.02867954783141613, -0.005620704963803291, 0.0020625947508960962, -0.018604496493935585, 0.03411778435111046, 0.0035598990507423878, 0.012665369547903538, -0.015384487807750702, -0.002325562061741948, -0.022511441260576248, 0.03872597590088844, -0.034776099026203156, -0.013395237736403942, -0.026318207383155823, -0.011606344021856785, 0.008593847043812275, -0.028622303158044815, 0.020851347595453262, 0.00620388425886631, 0.0163719579577446, 0.008722647093236446, 0.027577590197324753, 0.0005974905798211694, -0.018261030316352844, -0.014597374945878983, -0.03039688616991043, 0.003137720050290227, 0.01154909934848547, 0.0005791544099338353, -0.005420348607003689, 0.001402492867782712, -0.0033881652634590864, 0.002023239154368639, 0.0384683758020401, 0.004851480480283499, -0.028379013761878014, -0.011448921635746956, -0.024729670956730843, 0.043191056698560715, 0.03185662254691124, 0.046597108244895935, -0.017044581472873688, 0.0063791959546506405, 0.02309819869697094, -0.005370259750634432, -0.006425707135349512, -0.03365983068943024, -0.009974872693419456, -0.016457824036478996, 0.004418568219989538, -0.0017602716106921434, 0.04367763549089432, 0.020336147397756577, 0.023470288142561913, -0.005792438518255949, 0.005223570391535759, -0.02367064543068409, 0.0030733197927474976, -0.027806567028164864, -0.016586624085903168, 0.0017611661460250616, -0.04608190804719925, -0.03821077570319176, -0.0366651713848114, -0.025574028491973877, 0.0025724295992404222, -0.02128068171441555, 0.011413143947720528, -0.0482858270406723, -0.027849500998854637, -0.018404141068458557, -0.012880036607384682, -0.0038604331202805042, -0.024042734876275063, 0.0008980247657746077, -0.0006346101290546358, 0.008157356642186642, -0.003731632838025689, 0.025574028491973877, -0.040815405547618866, 0.00017810675490181893, -0.011742300353944302, -0.012429235503077507, 0.033860184252262115, -0.01660093665122986, -0.04359176754951477, -0.0016636713407933712, 0.026003362610936165, -0.03411778435111046, 0.01959196664392948, -0.015012398362159729, -0.029996173456311226, -0.057187363505363464, 0.015613466501235962, 0.07292962819337845, -0.015341554768383503, -0.04279034212231636, -0.005448970943689346, 0.009030336514115334, -0.014325463213026524, -0.020522192120552063, 0.00645432947203517, 0.02118050493299961, 0.00044096235069446266, -0.02186743915081024, -0.016071423888206482, -0.026890654116868973, -0.011091142892837524, -0.06148070842027664, 0.008636780083179474, 0.011706521734595299, -0.004790658131241798, -0.03108382225036621, 0.045366350561380386, 0.007248598150908947, 0.0072772204875946045, 0.03843975439667702, 0.007406021002680063, 0.019148321822285652, -0.038182154297828674, 0.009695805609226227, 0.018633119761943817, -0.04213203117251396, -0.018060673028230667, -0.021996241062879562, 0.007184198126196861, -0.016329023987054825, -0.02118050493299961, 0.002166350604966283, 0.0218531284481287, -0.002295150887221098, -0.002220017369836569, 0.04015709087252617, 0.049001384526491165, 0.01568502187728882, -0.00819313433021307, -0.013058925978839397, 0.014153729192912579, -0.008715491741895676, 0.027133943513035774, -0.005141281057149172, -0.004601035267114639, 0.046969201415777206, -0.010439985431730747, 0.01856156438589096, -0.030883464962244034, 0.0033631206024438143, 0.018132228404283524, -0.015756577253341675, 0.0279926136136055, 0.009581316262483597, 0.0033005094155669212, -0.02425740286707878, -0.004690479952841997, 0.04233238846063614, 0.016758358106017113, -0.02288353070616722, 0.006261128932237625, 0.030110662803053856, -0.013581283390522003, 0.011069675907492638, 0.008558068424463272, 0.024057045578956604, -0.029065949842333794, -0.01228612381964922, 0.01651506870985031, -0.0038103440310806036, -0.02982443943619728, 0.013817417435348034, -0.04493701457977295, -0.013724394142627716, -0.013159103691577911, -0.0389549545943737, 0.010740519501268864, 0.0007450743578374386, -0.0687507763504982, -0.021552594378590584, -0.009123358875513077, 0.0022933620493859053, -0.031684890389442444, -0.011391676962375641, 0.042275141924619675, -0.0034382541198283434, -0.11139800399541855, -0.009495449252426624, 0.029452349990606308, 0.006361307110637426, 0.011563410982489586, 0.0010241417912766337, 0.011563410982489586, 0.007828200235962868, -0.0027173298876732588, -0.04087264835834503, -0.01116269826889038, -0.019291432574391365, 0.012980214320123196, -0.01650075800716877, 0.009409582242369652, -0.056156959384679794, -0.015126887708902359, 0.012815636582672596, 0.0218531284481287, -0.018847785890102386, -0.015069643035531044, 0.011563410982489586, 0.00039512195507995784, -0.002901586005464196, -0.022253841161727905, -0.012958748266100883, -0.00682641938328743, -5.1570459618233144e-06, -0.013545504771173, 0.022840598598122597, -0.02561696246266365, -0.021452415734529495, 0.004189589526504278, -0.0048908363096416, -0.001060814131051302, -0.0015295043122023344, -0.01614297926425934, -0.021681394428014755, 0.0003676177002489567, 0.0031359312124550343, 0.0035384322982281446, -0.043763503432273865, 0.02993892878293991, -0.0013622427359223366, 0.011499010026454926, 0.013388082385063171, 0.011305809952318668, 0.023184066638350487, 0.020865658298134804, -0.0033756429329514503, -0.005184214562177658, 0.011871100403368473, 0.0025116070173680782, 0.03729486092925072, -0.0015572322299703956, -0.002157406182959676, -0.012951591983437538, -0.008357712998986244, 0.008994558826088905, 0.03154177963733673, -0.022396951913833618, -0.00323074241168797, -0.020092856138944626, -0.035548899322748184, -0.0343753881752491, 0.0036386102437973022, -0.0018962275935336947, 0.0195633452385664, -0.008057177998125553, -0.05438237637281418, -0.012901503592729568, 0.015456044115126133, 0.005488326773047447, 0.005191370379179716, 0.023384422063827515, 0.004497279413044453, -0.005606393795460463, 0.06766312569379807, -0.03901220113039017, 0.013123326003551483, 0.015041020698845387, -0.02059374749660492, 0.013202037662267685, -0.00514843687415123, 0.011284342966973782, 0.02128068171441555, 0.025574028491973877, -0.019277121871709824, -0.0019498944748193026, 0.030912088230252266, 0.032257337123155594, -0.01864743046462536, 0.003971344791352749, 0.007821043953299522, 0.008257534354925156, 0.007377398665994406, 0.037724196910858154, 0.0250445157289505, 0.038182154297828674, -0.010432829149067402, 0.044793903827667236, 0.04585292935371399, -0.05953438952565193, -0.03205697983503342, -0.019162632524967194, 0.007087598089128733, 0.01830396242439747, -0.0003479398728813976, 0.014075017534196377, 0.004926613997668028, 0.008243223652243614, -0.007985622622072697, 0.005173481535166502, 0.06216764450073242, 0.004937347490340471, 0.01314479298889637, 0.03958464413881302, -0.0050947698764503, 0.035920992493629456, -0.005563460290431976, -0.01810360699892044, 0.04293345659971237, -0.03718037158250809, -0.02571713924407959, -0.02039339207112789, -0.02321268804371357, 0.0189050305634737, 0.022940775379538536, -0.03174213320016861, -0.018976587802171707, 0.006787063553929329, 0.023255622014403343, 0.025445228442549706, -0.015126887708902359, -0.02766345627605915, 0.003182442393153906, 0.008844291791319847, 0.027448788285255432, -0.003466876456514001, 0.049459341913461685, -0.0008416746277362108, 0.0006931964308023453, 0.03758108615875244, 0.018361207097768784, 0.02596042864024639, 0.015613466501235962, 0.002339873230084777, -0.004905147477984428, -0.0034454097039997578, 0.0057638161815702915, 0.03640757128596306, -0.004475812893360853, -0.026447009295225143, 0.016686802729964256, -0.006640374194830656, 0.019863879308104515, -0.014139417558908463, -0.027048077434301376, -0.0072772204875946045, 0.017502538859844208, 0.046024665236473083, 0.05043249949812889, -0.011355899274349213, 0.0034776099491864443, 0.006762019358575344, -0.018633119761943817, -0.02982443943619728, 0.0016654602950438857, -0.027921056374907494, 0.010168073698878288, -0.0016833492554724216, -0.03526267781853676, 0.04530910775065422, 0.013566971756517887, 0.020965836942195892, 0.013166259974241257, -0.002481195842847228, 0.02002130076289177, 0.0007052714354358613, 0.011212787590920925, -0.014726174995303154, 0.028836971148848534, -0.024386202916502953, 0.046396754682064056, 0.0025330737698823214, -0.00024105346528813243, 0.008286156691610813, -0.004379212390631437, 0.02149534970521927, 0.047398533672094345, 0.02378513477742672, 0.026718920096755028, 0.020550813525915146, 0.016543691977858543, 0.021252060309052467, -0.02103739231824875, 0.0031538200564682484, 0.015956934541463852, -0.03325911611318588, -0.022110728546977043, -0.021767262369394302, 0.039556022733449936, -0.005341637413948774, -0.015956934541463852, -0.04994592070579529, -0.007792422082275152, 0.001531293266452849, -0.012715457938611507, -0.020121479406952858, 0.04450768232345581, -0.006586707662791014, 0.006075083743780851, 0.002849708078429103, 0.03428952023386955, -0.01934867724776268, -0.029910307377576828, -0.008686869405210018, -0.022110728546977043, -0.030883464962244034, 0.004654702264815569, -0.019176943227648735, -0.022125041112303734, 0.02501589246094227, 0.015312932431697845, -0.006672574672847986, 0.02434326894581318, -0.017330804839730263, -0.0034114208538085222, 0.00955269392579794, 0.02218228578567505, -0.01212870143353939, -0.0009883638704195619, -0.02150966040790081, 0.007649310398846865, -0.012500790879130363, -0.041502341628074646, -0.0065366183407604694, -0.022568685933947563, 0.00904464814811945, 0.010404207743704319, 0.026704609394073486, 0.017931872978806496, -0.02721981145441532, -0.0049516586586833, 0.019878190010786057, 0.017359426245093346, 0.01201421208679676, 0.02298370935022831, -0.01731649413704872, -0.021352238953113556, 0.017831694334745407, 0.010869319550693035, -0.005205681547522545, 0.001759377191774547, 0.03217146918177605, 0.012651057913899422, 0.024629492312669754, 0.03549165651202202, 0.006565240677446127, 0.015327243134379387, -0.02912319451570511, 0.017960496246814728, 0.021695705130696297, 0.013545504771173, 0.0018175162840634584, -0.008686869405210018, -0.021667083725333214, 0.003071530954912305, 0.018933653831481934, -0.007534821517765522, -0.017774449661374092, 0.016901470720767975, -0.0009883638704195619, 0.020407702773809433, -0.00939527153968811, 0.0007021408528089523, 0.008493668399751186, -0.03116968832910061, 0.02753465622663498, -0.003788877511397004, -0.009645716287195683, -0.04980280622839928, -0.012930125929415226, 0.01582813449203968, 0.011291498318314552, 0.01206430047750473, -0.04404972493648529, -0.004386368207633495, 0.04362038895487785, -0.016529379412531853, 0.0040178559720516205, 0.03303013741970062, -0.006558085326105356, -0.0020608059130609035, 0.03308738395571709, 0.0034114208538085222, 0.008593847043812275, -0.007026775274425745, 0.014218129217624664, -0.027348611503839493, 0.0005796016193926334, 0.019606277346611023, 0.00316992006264627, -0.007370243314653635, 0.0002625201886985451, 0.0016976604238152504, -0.026232341304421425, -0.03938429057598114, -0.022912153974175453, 0.01491221971809864, -0.020679613575339317, 0.026361141353845596, 0.015069643035531044, -0.0012549090897664428, 0.0006569713004864752, 0.01934867724776268, 0.006282595451921225, -0.030539996922016144, 0.01934867724776268, 0.00044677627738565207, 0.0169444028288126, 0.01830396242439747, 0.00916629284620285, 0.029166126623749733, 0.0050947698764503, -0.018375519663095474, 0.0071197981014847755, 0.005069725681096315, 0.01080491952598095, 0.0039033666253089905, 0.015069643035531044, 0.015069643035531044, -0.010783452540636063, 0.01404639519751072, -0.03778143972158432, -0.004096567165106535, -0.021123260259628296, -0.023384422063827515, -0.012457857839763165, 0.0045867240987718105, 0.05472584441304207, 0.034318141639232635, 0.01251510251313448, -0.005731616169214249, -0.035777878016233444, 0.01695871539413929, -0.0007200298132374883, -0.04562395066022873, 0.006812108214944601, -0.011348742991685867, 0.06817832589149475, -0.025774383917450905, -0.002583162859082222, -0.015999868512153625, -0.011527632363140583, 0.05169187858700752, -0.008758424781262875, -0.00010828398808371276, 0.006325528956949711, 0.015227065421640873, 0.0034328876063227654, 0.01774582825601101, 0.017101826146245003, -0.011212787590920925, 0.04167407378554344, -0.026890654116868973, -0.026203718036413193, 0.031112443655729294, -0.006024994887411594, 0.023627711459994316, 0.020321834832429886, -0.002220017369836569, 0.002792463405057788, 0.012107234448194504, -0.01615728996694088, 0.014189506880939007, -0.010010650381445885, 0.017931872978806496, 0.007699399720877409, -0.010475763119757175, -0.0327439159154892, -0.012321901507675648, -0.01776013895869255, 0.04805684834718704, -0.021924683824181557, 0.007527665700763464, 0.018690364435315132, 0.03494783118367195, -0.010375585407018661, 0.021452415734529495, -0.013702928088605404, -0.00631837360560894, -0.016572313383221626, 0.0006838047411292791, -0.022354019805788994, -0.0005277236923575401, -0.018003428354859352, 0.012550880201160908, -0.020751170814037323, 0.013359460048377514, -0.019720766693353653, -0.007634999230504036, 0.022253841161727905, 0.016701113432645798, -0.012543724849820137, -0.010168073698878288, 0.00933087058365345, 0.0689225047826767, 0.023055264726281166, -0.016071423888206482, -0.03391743078827858, 0.004747724626213312, -0.017445294186472893, 0.03311600536108017, 0.012092922814190388, -0.011706521734595299, -0.009538382291793823, 0.009660026989877224, 0.011956967413425446, 0.00945251528173685, 0.012042834423482418, -0.004164545331150293, 0.01267968025058508, -0.01057594083249569, -0.007130531128495932, 0.016529379412531853, -0.03051137551665306, 0.013352304697036743, 0.023627711459994316, 0.015083953738212585, -0.03769557178020477, 0.01076198648661375, -0.014940842054784298, 0.009338026866316795, 0.0020125056616961956, 0.04021433740854263, 0.02948097325861454, -0.006533040665090084, -0.008722647093236446, 0.02198192849755287, -0.01970645599067211, 0.025187626481056213, 0.01579951122403145, 0.0031037309672683477, -0.02243988588452339, -0.02617509663105011, -0.021309304982423782, -0.00784966628998518, -0.004071522504091263, -0.010053584352135658, -0.01201421208679676, -0.013524038717150688, -0.006350573617964983, 0.007742333225905895, 0.006794219370931387, -0.009295092895627022, -0.029423728585243225, 0.0019427388906478882, 0.009645716287195683, 0.000842121837195009, -0.02707669883966446, 0.0009785250294953585, 0.01672973670065403, -0.00110285310074687, 0.013574127107858658, 0.03285840526223183, 0.018404141068458557, 0.02535936050117016, 0.00546685978770256, -0.004726257640868425, 0.005255770403891802, 0.006014261394739151, 0.03171351179480553, 0.011069675907492638, -8.483270903525408e-06, -0.001881916425190866, -0.018747609108686447, -0.015184132382273674, -0.002906952751800418, -0.018490007147192955, -0.015327243134379387, -0.004647546447813511, 0.019892500713467598, -0.006990997586399317, 0.010948031209409237, 0.029624084010720253, 0.0005049153114669025, -0.03394605219364166, -0.02970995008945465, 0.005105503369122744, 0.014726174995303154, -0.018919343128800392, 0.006976686418056488, 0.026933588087558746, 0.01548466645181179, 0.015856755897402763, -0.0006466851918958127, -0.013545504771173, 0.015985555946826935, 0.01252225786447525, -0.02890852652490139, 0.021767262369394302, 0.00042665121145546436, 0.019162632524967194, 0.022940775379538536, -0.007116219960153103, -0.024214468896389008, -0.01786031760275364, 0.002862230408936739, -0.007527665700763464, 0.00955269392579794, 0.0030733197927474976, -0.013051770627498627, 0.0348619669675827, 0.03832526504993439, -0.011978434398770332, -0.03151315450668335, 0.04339141026139259, -0.0081859789788723, -0.0030464865267276764, 0.006078661885112524, -0.023055264726281166, 0.007527665700763464, -0.012980214320123196, -0.012371990829706192, -0.013481104746460915, 0.0020625947508960962, 0.019191253930330276, -0.039899490773677826, -0.029423728585243225, -0.020193034783005714, 0.004314812365919352, 0.011076831258833408, -0.002497296081855893, -0.023155443370342255, -0.026475630700588226, 0.011405987665057182, 0.011677899397909641, -0.018261030316352844, -0.027148254215717316, -0.014182351529598236, -0.015456044115126133, 0.008250379003584385, 0.0028747525066137314, -0.007470421027392149, 0.02252575196325779, -0.017030270770192146, 0.03234320133924484, 0.054353754967451096, -0.0011305810185149312, 0.019291432574391365, -0.027348611503839493, -0.016887158155441284, 0.0001629011530894786, -0.0024776181671768427, 0.023570466786623, -0.009352337568998337, 0.02573144994676113, -0.03254355862736702, -0.010855008848011494, 0.0006659157807007432, -0.007878288626670837, 0.005738771986216307, 0.013359460048377514, 0.024786915630102158, 0.011241409927606583, -0.018947964534163475, -0.01982094533741474, -0.037609707564115524, -0.05392441898584366, -0.01552759949117899, -0.007298687472939491, 0.0186617411673069, 0.017574094235897064, 0.013359460048377514, 0.0030518530402332544, -0.0020303947385400534, -0.00011437740613473579, 0.0169444028288126, 0.0021144726779311895, -0.009846072643995285, -0.025788694620132446, -0.01662955805659294, 0.0020142944995313883, -0.00036314548924565315, -0.0021198394242674112, 0.03952740132808685, -0.02116619423031807, 0.0028085634112358093, 0.020808415487408638, 0.01662955805659294, 0.0033917429391294718, 0.012500790879130363, 0.03858286514878273, -0.006243240088224411, 0.0477992482483387, 0.018933653831481934, 0.0617096871137619, -0.046511244028806686, -0.0012307590804994106, -0.011720833368599415, 0.0028658080846071243, 0.009731583297252655, -0.009645716287195683, 0.02377082221210003, -0.01753116026520729, 0.0035026543773710728, -0.02596042864024639, -0.006894397549331188, 0.020078545436263084, 0.006404240615665913, -0.011520477011799812, -0.009774516336619854, -0.009574160911142826, -0.027620522305369377, 0.03677966073155403, -0.002652929862961173, 0.03583512455224991, 0.001198558951728046, 0.01684422604739666, 0.009488293901085854, -0.00423610070720315, -0.0015760156093165278, -0.002726274309679866, -0.023527532815933228, 0.010790608823299408, -0.038754597306251526, -0.005853260867297649, 0.012980214320123196, -0.035577524453401566, 0.003209275659173727, 0.016457824036478996, -0.002073328010737896, -0.02422877959907055, -0.029767194762825966, 0.00347045436501503, -0.011076831258833408, -0.013366615399718285, 0.03217146918177605, -0.011649277061223984, 0.005788860842585564, 0.004157389514148235, 0.005373837426304817, -0.04210340976715088, -0.005305859725922346, -0.011906878091394901, -0.015355865471065044, -0.0368369035422802, -0.0008640357991680503, 0.05134841054677963, -0.047742001712322235, -0.002143095014616847, -0.013903283514082432, 0.03137004375457764, 0.021938996389508247, 0.027692077681422234, -0.01830396242439747, -0.0023541843984276056, -0.017903251573443413, -0.003465087618678808, 0.0003338523383717984, -0.028736792504787445, -0.01343101542443037, 0.030368264764547348, 0.017259249463677406, -0.010103672742843628, 0.00041457617771811783, -0.013753016479313374, 0.010010650381445885, 0.04198892042040825, 0.0051448591984808445, 0.0004959708312526345, -0.029967552050948143, 0.024529313668608665, 0.04050055891275406, -0.02219659648835659, 0.025688517838716507, -0.003985655959695578, 0.0455094613134861, 0.016128668561577797, 0.03071173094213009, 0.01057594083249569, 0.013459637761116028, -0.016128668561577797, -0.011363054625689983, 0.017488228157162666, 0.01046145148575306, -0.001207503373734653, 0.046511244028806686, -0.018618809059262276, -0.027735011652112007, 0.00966718327254057, -0.00943820457905531, -0.021237749606370926, -0.03858286514878273, -0.00807148963212967, -0.014532974921166897, -0.0028192969039082527, -0.03048275224864483, -0.002751318970695138, 0.06308355927467346, 0.021452415734529495, -0.027291366830468178, -0.0189050305634737, -0.007094753440469503, -0.004146656021475792, 0.01853294111788273, -0.036121346056461334, -0.0008881858666427433, 0.005119814537465572, -0.02286922000348568, 0.010382740758359432, 0.03205697983503342, 0.007513354532420635, -0.016185913234949112, 0.007245020475238562, -0.023413043469190598, -0.03763832896947861, 0.004243256524205208, -0.02900870516896248, -0.013867505826056004, 0.019620589911937714, 0.012880036607384682, -0.0015724378172308207, -0.03220009058713913, -0.009466826915740967, -0.005216414574533701, -0.01041136309504509, 0.0053666820749640465, 0.008722647093236446, 0.0250445157289505, -0.03325911611318588, 0.015012398362159729, -0.005774549674242735, -0.012486480176448822, 0.013280748389661312, -0.0012030311627313495, 0.009974872693419456, 0.04382074624300003]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" and implement two methods to
tackle the major challenge of early-exit LLM inference for
autoregressive generation, namely the conflict between early
exiting and KV caching (as explained in Section 1). One
method is based on KV recomputation, which runs the for-
ward pass with a batch of recent tokens when generating
each token. The other method is based on a novel form of
pipeline parallelism, which parallelizes the forward pass
of the current token at a certain pipeline stage with some
KV-related computation of previous tokens at later stages.
3. Training
We first present in Section 3.1 the essentials of scaling up
early-exit LLM training with 3D parallelism, including anovel approach to executing backpropagation for the early-
exit training objective through pipeline stages. Then, we
analyze the training efficiency achieved by EE-LLM in Sec-
tion 3.2, and explore some advanced features in Section 3.3.
3.1. Backpropagation through pipeline stages
The standard objective function for training an early-exit
model is a weighted sum of losses at early and final exits.
More formally, to train an early-exit LLM with Nexits
(including the final output), we aim to solve
min L:=X
i∈[N]wiLexit
i, (1)
where [N] ={1,2, . . . , N }, and each Lexit
iis a stan-
dard loss function for LLM pre-training (e.g. negative log-
likelihood of next-token prediction), calculated with outputs
from the i-th exit. The loss weights {wi}are hyperparame-
ters specified by the user.
Our implementation for optimizing the loss function in
Eq. (1)is compatible with all types of parallelism in
Megatron-LM. Indeed, with some engineering efforts, ex-
isting functionalities in Megatron-LM for data and ten-
sor/sequence parallelism are directly applicable. The major
challenge lies in pipeline parallelism, since it is not im-
mediately clear how to calculate gradients for Eq. (1)via
backpropagation through pipeline stages. In a single-GPU
scenario with vanilla PyTorch, one simply needs to define
loss as the weighted sum of losses at all exits, and then
runloss.backward() for gradient calculation. This is
not feasible with pipeline parallelism, since losses {Lexit
i}
are now located on different GPUs, and there is only limited
P2P communication between each pair of adjacent stages.
On the other hand, Megatron-LM only supports backpropa-
gation for a single loss function defined in the last stage.
3.1.1. M ETHODOLOGY
To tackle this challenge, we propose a lightweight algorithm
that instructs each pipeline stage to calculate the desired
gradients correctly, without any additional communication
overhead between stages. To explain our method, let us
first re-write the training objective defined in Eq. (1)as
L=P
i∈[K]Li, where Krepresents the number of pipeline
stages, and each Liis itself a weighted sum of one or multi-
ple early/final-exit losses within Stage i.1Consider one data
sample xfor simplicity, and each loss function is calculated
withx, i.e.Li=Li(x); in addition, let xibe the hidden
states that Stage icalculates and sends to its next stage dur-
ing the forward step. Then, during the backward step, Stage
ireceives some gradient tensor gifrom Stage i+ 1, defines
1Obviously, the objective in Eq. (1)is a special case of this
formulation. In fact, our analysis in the following allows each Li
to be a general objective function defined locally in Stage i.
3
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
𝜽!𝒙!𝐿!𝜽""𝒙""𝐿""𝜽#𝒙#𝐿#𝜽$𝐿$InputStage 1Stage 4Stage 3Stage 2𝒈!𝒈""𝒈#forwardbackward
Figure 2: The backpropagation process for an early-exit
model partitioned into four pipeline stages.
some auxiliary loss Laux
i, and performs usual backward
computation for Laux
i. The auxiliary losses {Laux
i}i∈[K]and
gradient tensors {gi}i∈[K−1]are defined inductively:
Laux
K:=LK;fori","[0.027162060141563416, -0.0013816928258165717, 0.07678168267011642, -0.03671932965517044, -0.0062412079423666, 0.004643836058676243, 0.015515400096774101, 0.021648768335580826, -0.018669703975319862, 0.07791399955749512, 0.023643797263503075, -0.02280804142355919, -0.03159695863723755, -0.005081933923065662, -0.03968491405248642, -0.027013780549168587, 0.006086188368499279, 0.0019866046495735645, -0.0031104939989745617, 0.060605768114328384, 0.029197528958320618, -0.02487047202885151, 0.05812545865774155, 0.02693290077149868, 0.03375374525785446, -0.012280216440558434, 0.0423000231385231, 0.03229791298508644, 0.003959729336202145, -0.04650576040148735, 0.0627625584602356, -0.031435199081897736, -0.0572088249027729, -0.028712252154946327, 0.0031509336549788713, 0.02441215328872204, 0.010608704760670662, 0.06087536737322807, -0.026555463671684265, 0.04057459160685539, 0.03739332780241966, -0.05416236072778702, -0.05370404198765755, 0.02644762396812439, -0.01845402456820011, 0.043944574892520905, 0.021352209150791168, 0.0017052112380042672, 0.0009343276615254581, 0.027768656611442566, 0.006598426029086113, 0.02054341323673725, -0.015272760763764381, 0.0015164922224357724, -0.028226973488926888, -0.014652684330940247, 0.024007756263017654, -0.02260584384202957, 0.012745274230837822, -0.025652308017015457, 0.02562534809112549, -0.046883199363946915, 0.010035808198153973, -0.015609759837388992, -0.011842118576169014, 0.016310716047883034, -0.05216732993721962, 0.007932938635349274, -0.004562956281006336, 0.02360335737466812, -0.038309961557388306, 0.019384140148758888, 0.023562917485833168, -0.02311808057129383, -0.02753949724137783, -0.000529087265022099, 0.024223435670137405, 0.04192258417606354, -0.0029116650111973286, -0.016769032925367355, 0.0333763062953949, -0.008930454030632973, 0.030788160860538483, -0.02493787184357643, 0.010446946136653423, -0.07149755209684372, -0.007083703298121691, -0.039010919630527496, -0.04089810699224472, -0.02044905349612236, -0.017941787838935852, 0.000783942174166441, -0.018737103790044785, 0.005917689297348261, 0.06766925007104874, 0.045157767832279205, 0.03566789627075195, -0.07796791940927505, 0.047638073563575745, 0.045885682106018066, -0.010972663760185242, 0.01107376255095005, 0.04057459160685539, -0.05947345122694969, 0.038579560816287994, -0.04181474447250366, -0.03208223357796669, 0.03140823915600777, -0.014935762621462345, -0.0426504984498024, -0.04820423200726509, 0.004350647330284119, 0.012064537964761257, -0.0066456058993935585, 0.021473528817296028, -0.06055184826254845, -0.053030047565698624, 0.025490548461675644, 0.019505459815263748, -0.0031088090036064386, -0.016458995640277863, 0.0159063171595335, 0.002508952049538493, -0.032702311873435974, 0.025032231584191322, -0.0039462498389184475, 0.044483769685029984, -0.016984712332487106, 0.007258942350745201, -0.030761200934648514, 0.027215979993343353, -0.006167068146169186, 0.03599141538143158, -0.03205527365207672, -0.028469612821936607, 0.003642951138317585, -0.026676781475543976, -0.0008622942841611803, -0.007872279733419418, -0.005722230300307274, 0.031435199081897736, -0.0016563464887440205, -0.02726989984512329, -0.007515061181038618, -0.033160626888275146, 0.05904209613800049, -0.03167783468961716, 0.028065215796232224, -0.022241884842514992, -0.003444122150540352, 0.013796708546578884, -0.0358026959002018, -0.024830032140016556, -0.0179013479501009, -0.019411100074648857, -0.011646660044789314, -0.0390917994081974, 0.04728759452700615, 0.07737480103969574, -0.016849912703037262, -0.003700240980833769, 0.03644973039627075, 0.04502296820282936, 0.020529933273792267, -0.007326342165470123, 0.059850890189409256, -0.03938835486769676, -0.011060282588005066, -0.059635210782289505, -0.028793131932616234, -0.022430604323744774, -0.03898395970463753, -0.04486120864748955, -0.018979741260409355, 0.01814398542046547, -0.039577074348926544, -0.06152240186929703, -0.06632125377655029, -0.012610474601387978, -0.08999201655387878, -0.04898606613278389, 0.026070185005664825, 0.00979990977793932, -0.021958807483315468, -0.047179754823446274, 0.015097522176802158, 0.01614895649254322, 0.017348671332001686, -0.022471044212579727, 0.025247909128665924, -0.0012013987870886922, 0.03310671076178551, 0.04081723093986511, 0.01835966482758522, 0.012394796125590801, 0.00791945867240429, 0.06287039816379547, 0.029548007994890213, 0.016432035714387894, -0.008499096147716045, 0.05076541751623154, 0.03032984398305416, 0.02499179169535637, -0.0680466890335083, 0.07106619328260422, -0.006665825378149748, -0.016283756121993065, 0.0044382670894265175, -0.030545521527528763, -0.04947134479880333, 0.006817474961280823, 0.006915204226970673, 0.028361773118376732, 0.030922960489988327, 0.014652684330940247, -0.005263912957161665, -0.05240996927022934, 0.02987152524292469, 0.04553520306944847, 0.03898395970463753, 0.0013564180117100477, 0.010999622754752636, -0.023643797263503075, 0.025396188721060753, -0.03890307992696762, 0.01596023701131344, 0.025099629536271095, -0.07451705634593964, 0.04227306321263313, -0.01279919408261776, 0.009355071932077408, -0.010318886488676071, -0.007144363131374121, -0.01826530508697033, 0.027984336018562317, -0.04771895334124565, -0.03151607885956764, -0.036368850618600845, 0.0005215047858655453, -0.01289355382323265, 0.01327099185436964, 0.06928684562444687, -0.021999245509505272, -0.03426598384976387, -0.04313577711582184, 0.008296896703541279, -0.013574290089309216, -0.007730740122497082, -0.002898185048252344, -0.007440921384841204, -0.006901724264025688, -0.017833948135375977, -0.02690594084560871, -0.0005130798672325909, -0.045427367091178894, 0.04440288990736008, -0.009631410241127014, -0.008687814697623253, -0.036341890692710876, 0.002840895438566804, 0.0038283001631498337, -0.007973378524184227, -0.015340160578489304, 0.023010240867733955, 0.007205022964626551, -0.014935762621462345, -0.06001264974474907, 0.003450862132012844, 0.010244746692478657, 0.003939509857445955, 0.00479548517614603, -0.033645905554294586, -0.009732509963214397, 0.008943933993577957, -0.027229459956288338, 0.0015881042927503586, 0.05440500006079674, 0.010622184723615646, -0.01198365818709135, 0.013884328305721283, -0.0020405245013535023, 0.002284848131239414, 0.07705128192901611, 0.009085472673177719, 0.015946757048368454, 0.0032200184650719166, -0.026555463671684265, 0.008532796055078506, -0.019060621038079262, -0.027108140289783478, 0.0026319564785808325, -0.00024074313114397228, 0.02766081690788269, -0.006473736371845007, 0.03766292706131935, -0.007852059789001942, -0.01317663211375475, -0.009671850129961967, 0.01186233852058649, 0.02408863604068756, 0.01833270490169525, 0.0029116650111973286, -0.04033195227384567, 0.017806988209486008, -0.020799532532691956, 0.03911875933408737, -0.020314255729317665, -0.004404567182064056, -0.03205527365207672, 0.004185518249869347, 0.01375626865774393, 0.0008353344164788723, -0.006807364989072084, 0.021217409521341324, -0.009253972209990025, -0.04087114706635475, 0.0024398674722760916, -0.045912642031908035, 0.015084042213857174, -0.05232908949255943, -0.0074341814033687115, -0.05486331507563591, -0.011356841772794724, -0.03626101091504097, -0.001034584711305797, 0.002776865614578128, 0.004691015928983688, 0.006308607291430235, -0.02566578797996044, -0.010440206155180931, 0.002392687601968646, -0.03725852817296982, -0.0032334981951862574, -0.0366654098033905, -0.021096091717481613, -0.03836388140916824, -0.03768988698720932, 0.02890097163617611, 0.08341380953788757, 0.015650199726223946, -0.06529678404331207, 0.03135431930422783, -0.020866932347416878, 0.004134968854486942, 0.00924049224704504, 0.02960192784667015, 0.025975825265049934, -0.011235522106289864, 0.09403599798679352, 0.014423525892198086, -0.0305994413793087, -0.0293862484395504, 0.016674673184752464, 0.0024617721792310476, 0.04337841644883156, -0.030302884057164192, 0.01104006264358759, -0.018710143864154816, 0.010851344093680382, 0.022888921201229095, -0.0342390239238739, 0.010824384167790413, 0.008424956351518631, 0.018925821408629417, -0.03275623172521591, 0.01914150081574917, -0.02708118036389351, 0.006315347272902727, 0.010379546321928501, -0.018400104716420174, 0.025099629536271095, 0.04302793741226196, -0.0169038325548172, 0.017914827913045883, -0.06211552023887634, -0.00018871903012041003, 0.014167406596243382, 0.01724083162844181, 0.01935718022286892, 0.048339031636714935, 0.0011803364614024758, 0.02987152524292469, -0.03814820200204849, -0.00784531980752945, -0.009820129722356796, 0.03971187397837639, -0.006642235908657312, -0.02935928851366043, 0.0026049965526908636, -0.004003539215773344, -0.010649144649505615, 0.029305368661880493, -0.008276677690446377, 0.01302835252135992, 0.03825604170560837, -0.028226973488926888, 0.02071865275502205, 0.02763385698199272, 0.04925566539168358, 0.006345677189528942, -0.01346645038574934, -0.008269937708973885, -0.027849536389112473, -0.022376684471964836, 0.028793131932616234, -0.007339822128415108, 0.05462067946791649, 0.012334136292338371, 0.029251448810100555, 0.02365727722644806, 0.029494088143110275, 0.008094698190689087, 0.02287544123828411, -0.06427230685949326, 0.03086904063820839, -0.0039159199222922325, 0.03704284876585007, 0.008094698190689087, 0.014140446670353413, 0.07112011313438416, -0.023953836411237717, -0.013378830626606941, -0.04852775111794472, -0.03348414599895477, -0.02305068075656891, 0.0005417247302830219, 0.006018789019435644, -0.025773627683520317, -0.004064199049025774, -0.053515322506427765, -0.005065083969384432, 0.01125574205070734, 0.0011592740193009377, -0.0025123220402747393, -0.05141245573759079, -0.005038124043494463, -0.015825437381863594, 0.02399427630007267, -0.0057121203280985355, -0.04184170439839363, 0.00784531980752945, 0.0008387044072151184, -0.03674628958106041, 0.02814609557390213, -0.008276677690446377, -0.008094698190689087, -0.06308607757091522, -0.009638150222599506, 0.02387295663356781, -0.010730024427175522, 0.013709088787436485, 0.04041283205151558, 0.05111589655280113, 0.030949920415878296, 0.027067700400948524, -0.08228149265050888, 0.10875608026981354, -0.019397620111703873, 0.026676781475543976, 0.0024870471097528934, 0.03248663246631622, -0.02557142823934555, -0.015515400096774101, -0.024061676114797592, -0.01198365818709135, 0.021824007853865623, 0.04068243131041527, -0.01614895649254322, 0.010399766266345978, -0.005290872883051634, 0.028334813192486763, -0.018534904345870018, 0.021015211939811707, -0.021864447742700577, -0.026946380734443665, 0.02965584769845009, -0.022430604323744774, -0.043944574892520905, 0.0007502423832193017, -0.010750244371592999, 0.011976918205618858, 0.007899239659309387, 0.011329881846904755, -0.015380600467324257, 0.01908758096396923, 0.03448166325688362, -0.017577828839421272, -0.02593538537621498, -0.018494464457035065, 0.026029745116829872, 0.020287295803427696, -0.016095036640763283, 0.03299887105822563, -0.015407560393214226, -0.04046675190329552, -0.029089689254760742, -0.023616837337613106, -0.021123051643371582, 0.021608328446745872, 0.011909518390893936, 0.035856615751981735, -0.02747209742665291, -9.962511103367433e-05, 0.034158144146203995, 0.013607989996671677, -0.01139054074883461, 0.009577490389347076, 0.010972663760185242, -0.009981888346374035, 0.01186233852058649, -0.024856992065906525, 0.00540882209315896, 0.00010310040670447052, 0.006473736371845007, 0.011275961995124817, 0.02720250003039837, -0.024250395596027374, 0.024277355521917343, -0.014180886559188366, 0.037312448024749756, 0.011289441958069801, 0.004515776876360178, -0.016202876344323158, -0.008559755980968475, -0.02793041616678238, -0.03232487291097641, -0.036638449877500534, -0.10169259458780289, -0.0293862484395504, 0.006723115220665932, 0.030410723760724068, -0.004293357953429222, -0.011491640470921993, -0.004313577897846699, -0.028712252154946327, -0.02129828929901123, -0.024830032140016556, -0.024156035855412483, -0.052787408232688904, -0.01889886148273945, 0.022619323804974556, 0.027364259585738182, 0.032944951206445694, 0.0446455292403698, -0.019411100074648857, -0.022713683545589447, 0.03760900720953941, -0.01492228265851736, 0.008344076573848724, 0.03795948252081871, 0.013830408453941345, -0.027714736759662628, -0.007258942350745201, -0.039280518889427185, -0.017577828839421272, 0.0160815566778183, 0.011579260230064392, 0.0263532642275095, 0.003902439959347248, 0.02841569297015667, 0.022578883916139603, 0.018197905272245407, 0.02562534809112549, -0.031731754541397095, -0.0002679136232472956, 0.016957752406597137, 0.017577828839421272, -0.025369228795170784, 0.024466073140501976, 0.02090737223625183, -0.031030800193548203, 0.0039159199222922325, 0.00661864597350359, -0.011127682402729988, 0.025557948276400566, -0.025301828980445862, -0.002005139598622918, 0.02695986069738865, 0.009523570537567139, -0.0018416955135762691, -0.03725852817296982, -0.012098237872123718, -0.015084042213857174, -0.041949544101953506, -0.027957376092672348, -0.012623954564332962, -0.05138549581170082, -0.010669364593923092, -0.032702311873435974, 0.01814398542046547, 0.03483213856816292, -0.027404697611927986, -0.0005295085138641298, -0.013581030070781708, -0.04146426543593407, -0.010885044001042843, 0.011215302161872387, -0.0013749528443440795, -0.018184425309300423, -0.046613600105047226, 0.02884705178439617, -0.0074678813107311726, 0.004883104935288429, -0.011309661902487278, -0.008519316092133522, 0.04116770625114441, -0.022430604323744774, 0.011457940563559532, 0.022713683545589447, -0.04553520306944847, 0.010318886488676071, -0.013284471817314625, 0.0020506344735622406, -0.021460048854351044, -0.02820001356303692, -0.030734241008758545, -0.009975148364901543, -0.0023505629505962133, 0.04380977526307106, -0.0257871076464653, 0.017833948135375977, -0.006989344023168087, 0.006268167402595282, -0.041302505880594254, 0.0231450404971838, -0.012057797983288765, -0.0179013479501009, -0.014625724405050278, -0.009085472673177719, 0.029278408735990524, -0.019438060000538826, 0.01617591641843319, 0.0017911457689478993, -0.012583514675498009, 0.02863137237727642, 0.02868529222905636, -0.0076903002336621284, -0.017618268728256226, -0.01811702735722065, -0.048878226429224014, 0.023037200793623924, 0.009382031857967377, 0.017685668542981148, -0.009523570537567139, 0.00217026867903769, 0.012731794267892838, -0.0007346562342718244, 0.03839084133505821, 0.0008812504238449037, -0.03353806585073471, -0.020799532532691956, -0.026946380734443665, 0.03647669032216072, 0.031435199081897736, 0.039792753756046295, -0.010244746692478657, 0.009948188439011574, 0.005179663188755512, 0.0068815043196082115, 0.002311808057129383, -0.03696196898818016, -0.011457940563559532, -0.017955267801880836, -0.00493702432140708, -0.003363242605701089, 0.023684237152338028, -0.005644720979034901, 0.026285864412784576, -0.011956698261201382, -0.002424702513962984, 0.0026033115573227406, 0.01327099185436964, -0.005644720979034901, 0.005806480068713427, -0.01641855575144291, -0.03777076676487923, -0.03596445545554161, -0.01884494349360466, -0.016715113073587418, -0.006652345415204763, -0.02914360910654068, -0.0019529048586264253, -0.048312071710824966, -0.0047348253428936005, -0.021716168150305748, -0.0022393534891307354, -0.001711108605377376, -0.023131560534238815, 0.0020725391805171967, -0.011093982495367527, 0.008687814697623253, 0.0019933446310460567, 0.010851344093680382, -0.03310671076178551, 0.014774003997445107, -0.0027633856516331434, -0.0257871076464653, 0.0338076651096344, -0.02526138909161091, -0.05321876332163811, -0.0058031100779771805, 0.010649144649505615, -0.03504781797528267, 0.019882896915078163, -0.02989848516881466, -0.023522477596998215, -0.026973340660333633, 0.048608627170324326, 0.07144363224506378, -0.03884916007518768, -0.04839295148849487, -0.015353640541434288, 0.0029369399417191744, -0.01516492199152708, -0.05710098519921303, 0.007798139937222004, 0.01207127794623375, -0.007070223335176706, -0.021352209150791168, -0.012947472743690014, -0.035587016493082047, -0.007218502927571535, -0.04116770625114441, 0.0066456058993935585, -0.00305994413793087, -0.014396565966308117, -0.0587724968791008, 0.034185104072093964, 0.011363581754267216, 0.006086188368499279, 0.0450768880546093, 0.02039513550698757, 0.021797047927975655, -0.06189984083175659, -0.0015931592788547277, 0.012805934064090252, -0.04286617785692215, -0.01699819229543209, -0.013075532391667366, 0.017833948135375977, -0.01741606928408146, -0.03480517864227295, -0.010682844556868076, 0.044915128499269485, 0.008411476388573647, -0.0030751090962439775, 0.03626101091504097, 0.04917478561401367, 0.013062052428722382, -0.0024095375556498766, -0.007670080289244652, 0.012017358094453812, -0.019438060000538826, 0.004195628222078085, 0.006989344023168087, 0.0022983280941843987, 0.030976880341768265, -0.011350101791322231, 0.01811702735722065, -0.02253844402730465, -0.010022328235208988, 0.004252918064594269, -0.0014238175936043262, 0.02481655217707157, 0.02102869190275669, -0.0032604581210762262, 0.0010497495532035828, -0.015151442028582096, 0.042488738894462585, 0.026272384449839592, -0.012920512817800045, 0.01317663211375475, 0.02508614957332611, 0.003398627508431673, 0.016499435529112816, -0.003926029894500971, 0.03140823915600777, -0.035155657678842545, 0.003996799234300852, 0.019047141075134277, 0.021850967779755592, -0.01668815314769745, 0.011929738335311413, -0.036072295159101486, -0.00819579791277647, -0.015717599540948868, -0.026676781475543976, 0.018656224012374878, 0.00042356469202786684, -0.06691437214612961, -0.037123728543519974, -0.021999245509505272, -0.0006820002454333007, -0.031947433948516846, -0.004289987962692976, 0.036368850618600845, -0.010271706618368626, -0.11193734407424927, 0.0014339275658130646, 0.018777543678879738, 0.019289780408143997, -0.004714605864137411, -0.0024921020958572626, -0.0040507190860807896, -0.021352209150791168, -0.018885383382439613, -0.04122162610292435, -0.01666119322180748, 0.005681790877133608, 0.011943218298256397, -0.0070432634092867374, 0.003250348148867488, -0.05063061788678169, 0.0016689838375896215, 0.019505459815263748, 0.014962722547352314, -0.023441599681973457, -0.04413329064846039, -0.005553731229156256, -0.024048196151852608, 0.010379546321928501, -0.041949544101953506, -0.04203042387962341, -0.0035789215471595526, 0.001572939334437251, 0.00904503371566534, 0.03407726436853409, -0.007326342165470123, -0.019802017137408257, 0.005358272232115269, -0.004293357953429222, -0.004219218157231808, 0.0023539329413324594, -0.011404020711779594, -0.025638828054070473, -0.0011323142098262906, -0.0029116650111973286, -0.019613299518823624, -0.031704794615507126, 0.03504781797528267, -0.012448715977370739, 0.028253933414816856, 0.02202620543539524, 0.012630694545805454, 0.014787483960390091, 0.03086904063820839, 0.014113486744463444, -0.007360042072832584, -0.00886305421590805, -0.011410760693252087, 0.015272760763764381, 0.021163491532206535, 0.019896376878023148, -0.021675728261470795, -0.021850967779755592, -0.0011365265818312764, 0.03127343952655792, -0.008613675832748413, 0.012671134434640408, 0.004660686012357473, -0.030518561601638794, -0.037069808691740036, -0.011821898631751537, 0.0040810490027070045, 0.028307853266596794, -0.011383800767362118, -0.04033195227384567, 0.010972663760185242, -0.014046087861061096, 0.00889001414179802, 0.002365727676078677, 0.012752014212310314, 0.006578206084668636, -0.01364842988550663, 0.038336921483278275, -0.04114074632525444, 0.031192559748888016, 0.01796874776482582, -0.004091158974915743, -0.004175408277660608, 0.0036328411661088467, -0.022592363879084587, 0.0257871076464653, 0.03154303878545761, -0.02520746923983097, -0.020853452384471893, 0.021702688187360764, 0.013634949922561646, -0.03324150666594505, 0.014086526818573475, -0.00819579791277647, 0.01933022029697895, -0.00876869447529316, 0.032432712614536285, 0.02411559596657753, 0.0511428564786911, 0.00705000339075923, 0.032459672540426254, 0.04704495519399643, -0.06044400855898857, -0.01729475148022175, -0.022646283730864525, -0.010446946136653423, 0.01724083162844181, -0.01675555296242237, 0.007885759696364403, -0.02965584769845009, 0.00839125644415617, -0.011929738335311413, -0.024654792621731758, 0.06340958923101425, 0.0014659424778074026, 0.018548384308815002, 0.04019715264439583, 0.005028014071285725, 0.03165087476372719, -0.03356502577662468, -0.01724083162844181, 0.02559838816523552, -0.03523653745651245, -0.011168122291564941, -0.01884494349360466, -0.008087958209216595, 0.009611190296709538, 0.033187586814165115, -0.034643422812223434, -0.01675555296242237, -0.014504404738545418, -0.0022427234798669815, 0.02341463975608349, -0.02365727722644806, -0.022376684471964836, 0.019680697470903397, 0.0009966723155230284, 0.017941787838935852, -0.015097522176802158, 0.0414373055100441, 0.0057727801613509655, 0.010035808198153973, 0.04305489733815193, -0.0042731380090117455, 0.026636341586709023, 0.033672865480184555, -0.00045958138071000576, -0.016458995640277863, -0.0010430095717310905, 0.016863392665982246, 0.03720460832118988, 0.0052167330868542194, -0.03281015157699585, -0.0009831924689933658, -0.019977256655693054, 0.016890352591872215, 0.00971229001879692, -0.03086904063820839, 0.018831463530659676, 0.027310339733958244, 0.02144656889140606, 0.04893214628100395, -0.020017696544528008, 0.008458656258881092, -0.0021298290230333805, -0.010446946136653423, -0.008290156722068787, 0.0019899746403098106, -0.02884705178439617, -0.0018669703276827931, -0.014046087861061096, -0.032432712614536285, 0.03550613671541214, 0.007542021106928587, 0.040304992347955704, 0.0136956088244915, 0.01122204214334488, 0.011875818483531475, -0.0006622016080655158, 0.008640635758638382, -0.009065252728760242, 0.023212440311908722, -0.030680321156978607, 0.004812335129827261, -0.0018096806015819311, -0.019828977063298225, -0.0035418516490608454, -0.004252918064594269, 0.005358272232115269, 0.048096392303705215, 0.023926876485347748, 0.018197905272245407, -0.005732340272516012, 0.03310671076178551, 0.009483130648732185, -0.009786429814994335, -0.00039365608245134354, 0.014517884701490402, -0.02844265289604664, 0.005135853309184313, -0.01835966482758522, 0.0243582334369421, -0.017577828839421272, -0.014881842769682407, -0.04364801570773125, 0.012165636755526066, -0.005092043895274401, -0.008034038357436657, -0.011781458742916584, 0.03690804913640022, 0.003963099326938391, 0.003525001695379615, -0.005290872883051634, 0.04850079119205475, -0.020462533459067345, -0.030949920415878296, 0.01192299835383892, -0.0038283001631498337, -0.016553355380892754, -0.004094528965651989, -0.01857534423470497, -0.023940356448292732, -0.0007721472647972405, 0.03154303878545761, -0.0025948865804821253, 0.006288387347012758, 0.002943679690361023, -0.014275246299803257, 0.00123425608035177, 0.004862884990870953, -0.018764063715934753, -0.02217448502779007, -0.03990059345960617, 0.019532419741153717, -0.003700240980833769, -0.030761200934648514, -0.021487008780241013, -0.028712252154946327, 0.015111002139747143, -0.0002706517407204956, 0.02820001356303692, 0.023980796337127686, -0.029763685539364815, -0.0006643077940680087, 0.027552977204322815, 0.015434520319104195, 0.009584230370819569, 0.024735672399401665, -0.03841780126094818, -0.005941279232501984, 0.015434520319104195, 0.015515400096774101, 0.034158144146203995, -0.01845402456820011, 0.048851266503334045, 0.015946757048368454, 0.04968702420592308, 0.057909779250621796, 0.010123427957296371, 0.024883951991796494, -0.022740643471479416, 0.02127132937312126, 0.012664394453167915, -0.006500696297734976, -0.008519316092133522, -0.038768280297517776, -0.02292936109006405, 0.028793131932616234, 0.01996377669274807, 0.004586546216160059, -0.003169468604028225, 0.014019127935171127, -0.018063107505440712, 0.03186655417084694, -0.021163491532206535, -0.0063591571524739265, 0.015865877270698547, -0.03232487291097641, 0.028361773118376732, -0.009375291876494884, -0.007764440029859543, -0.04504992812871933, -0.014396565966308117, -0.0032722530886530876, 0.015501920133829117, 0.004808965139091015, -0.04483424872159958, 0.005071823950856924, 0.04841991141438484, -0.018952781334519386, -0.0002971903304569423, 0.029736725613474846, -0.01850794441998005, 0.00517292320728302, 0.03361894562840462, 0.00272631598636508, 0.009078732691705227, 0.006844434421509504, 0.0037440506275743246, -0.022565403953194618, -0.013574290089309216, 0.0009410676429979503, 0.00264712143689394, -0.005300982855260372, 0.00013553649478126317, 0.023832516744732857, -0.004000169225037098, -0.027215979993343353, -0.01583891734480858, 0.0048595150001347065, -0.006537766195833683, 0.009577490389347076, 0.009321372024714947, 0.01914150081574917, 0.005557101219892502, 0.0026353264693170786, -0.00266565615311265, -0.01675555296242237, 0.01717343181371689, -0.010096468031406403, 0.014167406596243382, 0.02032773569226265, -0.015272760763764381, 0.010730024427175522, 0.006113148294389248, -0.03396942466497421, 0.0004945449181832373, -0.00040924226050265133, 0.010008848272264004, 0.01217911671847105, 0.03130039945244789, -0.010143647901713848, 0.017982227727770805, 0.01945153996348381, -0.03140823915600777, 0.0010017273016273975, -0.008748474530875683, 0.0011483215494081378, -0.010568265803158283, 0.008350816555321217, 0.04087114706635475, 0.017065592110157013, 0.016580313444137573, 0.000606175628490746, -0.022120565176010132, 0.005493071861565113, -0.007312862202525139, -0.021716168150305748, 0.01814398542046547, -0.005307722371071577, 0.07457097619771957, -0.018521424382925034, -0.010264966636896133, -0.006665825378149748, -0.026218464598059654, 0.023670757189393044, 0.011626440100371838, -0.012812674045562744, -0.0016024267533794045, 0.0084519162774086, 0.01299465261399746, 0.027040740475058556, 0.019074101001024246, 0.007865539751946926, 0.03715068846940994, -0.01323729194700718, -0.026649821549654007, 0.036827169358730316, 0.009820129722356796, 0.029548007994890213, 0.04723367467522621, 0.009092212654650211, -0.00024327062419615686, 0.0047786352224648, -0.019491979852318764, -0.005122373346239328, -0.015731079503893852, 0.02865833230316639, 0.008296896703541279, 0.03111167997121811, -0.030464641749858856, -0.038822200149297714, -0.020637772977352142, 0.03008720465004444, -0.022336244583129883, 0.015852397307753563, 0.008620415814220905, 0.02941320836544037, -0.002274738159030676, 0.023077640682458878, 0.0016942587681114674, -0.0022376684937626123, -0.006915204226970673, -0.010008848272264004, -0.01714647188782692, 0.000375753064872697, 0.00655798614025116, 0.0084519162774086, -0.01087830401957035, 0.005752560216933489, -0.002453347435221076, 0.00345423212274909, 0.006116518285125494, 7.108556746970862e-05, -0.0022949581034481525, -0.001490374794229865, 0.004084418993443251, 0.051493335515260696, 0.01494924258440733, 0.00705000339075923, -0.0377977229654789, -0.015623238869011402, -0.012388056144118309, 0.019343700259923935, 0.01081764418631792, -0.019101060926914215, 0.0050246440805494785, 0.026407184079289436, -0.014652684330940247, 0.022578883916139603, -0.0035755515564233065, 0.0024600871838629246, -0.0030666841194033623, 0.002254518447443843, -0.006409707013517618, 0.017200391739606857, -0.02292936109006405, -0.002945364685729146, 0.0003085640200879425, 0.045670002698898315, -0.04070939123630524, 0.0009747674921527505, -0.02523442916572094, -0.0013117657508701086, 0.012637434527277946, 0.030437683686614037, 0.034131184220314026, -0.007360042072832584, -0.019653739407658577, 0.021945327520370483, -0.017348671332001686, 0.022403644397854805, 0.010669364593923092, 0.0028510051779448986, -0.014652684330940247, -0.03383462503552437, -0.011282701976597309, -0.01419436652213335, -0.027283379808068275, -0.007697040215134621, -0.02793041616678238, -0.008964153937995434, 0.0037710105534642935, 0.011639920063316822, 0.007130883168429136, -0.00523358304053545, -0.037366367876529694, 0.01578499935567379, 0.012057797983288765, 0.0032402381766587496, -0.02726989984512329, -0.011997138150036335, 0.01507056225091219, -0.005530141294002533, -0.0028493201825767756, 0.03618013486266136, 0.004704495891928673, 0.0219318475574255, -0.01529972068965435, 0.016769032925367355, -0.001920890063047409, -0.007157843094319105, 0.022983280941843987, -0.01457180455327034, 0.0007211762713268399, 0.008128398098051548, 0.0003942879557143897, 0.007744220085442066, -0.000208517667488195, -0.015178401954472065, -0.011626440100371838, 0.00663549592718482, 0.01627027615904808, -0.012657654471695423, 0.01860230416059494, 0.03518261760473251, -0.017011672258377075, -0.025894945487380028, -0.0406554713845253, 0.006079448387026787, 0.007063483353704214, -0.013776488602161407, -0.013870848342776299, 0.025557948276400566, -0.0042765079997479916, 0.02360335737466812, 0.016890352591872215, -0.02047601342201233, 0.008836094290018082, -0.009462910704314709, -0.0027920305728912354, 0.0350208580493927, -0.01090526394546032, 0.012354356236755848, 0.009253972209990025, 0.0005332997534424067, -0.021433088928461075, -0.01875058375298977, 0.02941320836544037, -0.02654198370873928, 0.025908425450325012, 0.006723115220665932, -0.0117679787799716, 0.03065336123108864, 0.054243240505456924, -0.008175577968358994, -0.045157767832279205, 0.02935928851366043, 0.010136907920241356, -0.00019514306040946394, -0.017200391739606857, -0.016647713258862495, 0.008371036499738693, -0.013473190367221832, -0.015124482102692127, -0.006773665081709623, 0.01930326037108898, 0.017456509172916412, -0.0032419231720268726, -0.019370660185813904, -0.043998491019010544, -0.0003953410778194666, 0.03348414599895477, -0.0010716544929891825, -0.0410868264734745, -0.023374199867248535, 0.01119508221745491, 0.018561864271759987, -0.019384140148758888, -0.00993470847606659, -0.014140446670353413, -0.015030122362077236, 0.032432712614536285, -0.002972324611619115, -0.012259996496140957, 0.014733564108610153, -0.022457564249634743, 0.026919420808553696, 0.0467214398086071, 0.02338767983019352, 0.02860441245138645, -0.0390917994081974, -0.019559379667043686, 0.010413246229290962, 0.0012292010942474008, 0.01581195741891861, -0.0048595150001347065, 0.008424956351518631, -0.028226973488926888, 0.0019697549287229776, -0.011087242513895035, -0.011997138150036335, 0.010480646044015884, 0.007750960066914558, 0.0023539329413324594, 0.0019781796727329493, -0.0032301282044500113, -0.014450485818088055, -0.048096392303705215, -0.05613043159246445, -0.011363581754267216, -0.018548384308815002, 0.031435199081897736, 0.021460048854351044, 0.004808965139091015, 0.004802225157618523, -0.012596994638442993, 0.009159612469375134, 0.012907033786177635, -0.004653946030884981, -0.0008597667911089957, -0.0271755401045084, 0.0034137924667447805, 0.015892837196588516, 0.015407560393214226, -0.009476390667259693, 0.014881842769682407, -0.02790345624089241, 0.004300097934901714, 0.02584102563560009, 0.0028526901733130217, 0.02081301249563694, 0.006787145044654608, 0.024641312658786774, -0.0038552600890398026, 0.044942088425159454, -0.002561186673119664, 0.04383673518896103, -0.03860652074217796, 0.013951728120446205, 0.0033430226612836123, 0.002776865614578128, 0.0007991071324795485, -0.03032984398305416, 0.015501920133829117, -0.021311769261956215, -0.0020759091712534428, -0.039792753756046295, -0.01084460411220789, 0.011687099933624268, 0.02248452417552471, 0.005533511284738779, -0.00438434723764658, -0.0027397959493100643, -0.016566835343837738, 0.04858166724443436, -0.02226884476840496, 0.026986820623278618, -0.0070432634092867374, -0.006729855202138424, 0.023643797263503075, 0.007326342165470123, 0.024250395596027374, -0.0051560732536017895, 0.006170438136905432, 0.023225920274853706, -0.02032773569226265, -0.0034323271829634905, 0.0016892037820070982, -0.04561608284711838, 0.02287544123828411, 0.010514345951378345, -0.01052782591432333, -0.012003878131508827, 0.005809850059449673, -0.020516453310847282, -0.031003840267658234, -0.015488440170884132, 0.004404567182064056, -0.01223977655172348, 0.01680947281420231, 0.011410760693252087, 0.01787438802421093, -0.02523442916572094, -0.021311769261956215, -0.020071616396307945, -0.0058671399019658566, -0.028038255870342255, 0.02023337595164776, 0.02868529222905636, -0.03777076676487923, -0.0023573029320687056, 0.02292936109006405, 0.02220144495368004, 0.03507477790117264, 0.0426504984498024, -0.0082564577460289, -0.008060998283326626, -0.024007756263017654, -0.024681752547621727, 0.0011356840841472149, -0.020219895988702774, -0.00438434723764658, 0.024641312658786774, 0.01986941695213318, -0.0020927591249346733, -0.0187236238270998, -0.013183372095227242, 0.0013623154954984784, 0.037878602743148804, 0.011990398168563843, -0.0024853621143847704, -0.03531741723418236, 0.012549814768135548, 0.03472429886460304, -0.028577452525496483, 0.015434520319104195, -0.0014937447849661112, 0.0418686643242836, -0.005230213049799204, 0.02693290077149868, 0.03065336123108864, 0.016189396381378174, -0.013560810126364231, -0.004488816950470209, 0.027822576463222504, 0.02481655217707157, -0.003398627508431673, 0.04610136151313782, -0.00901133380830288, -0.009402251802384853, 0.0006769452593289316, -0.015434520319104195, -0.023886436596512794, -0.013048572465777397, 0.006510806269943714, -0.01296769268810749, 0.0031863185577094555, -0.045427367091178894, -0.0054762219078838825, 0.042731378227472305, 0.025369228795170784, -0.038822200149297714, -0.018669703975319862, 0.01787438802421093, 0.0009621300268918276, 0.011275961995124817, -0.026825061067938805, -0.016580313444137573, -0.003481192048639059, -0.02445259317755699, 0.012185856699943542, 0.025045711547136307, -0.006237837951630354, 0.005105523858219385, -0.01072328444570303, -0.011437720619142056, -0.056453946977853775, -0.010002108290791512, -0.012536334805190563, 0.0018568603554740548, 0.020246855914592743, 0.013897808268666267, 0.032190073281526566, -0.018157465383410454, -0.010959183797240257, -0.007279162295162678, -0.024196475744247437, 0.014733564108610153, 0.0032638281118124723, 0.015286240726709366, -0.028307853266596794, 0.028550492599606514, -0.0031778935808688402, -0.01410000678151846, 0.0377977229654789, -0.006729855202138424, 0.006982604041695595, 0.03281015157699585]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
"=K−1, K−2, . . . , 1, (2a)
Laux
i:=Li+⟨gi,xi⟩,where gi:=∂Laux
i+1
∂xi.(2b)
Intuitively, the linear term ⟨gi,xi⟩, i.e. the sum of entrywise
product between giandxi, summarizes information about
the gradients of all losses located in later stages. Note
thatgiis regarded by Stage ias a constant tensor, and no
gradient is calculated with respect to it. A visualization of
this process can be found in Figure 2. It has the same P2P
communication scheme as in the case of training a standard
LLM with pipeline parallelism; the only difference is how
each gradient tensors giis defined locally in Stage i+ 1. In
the following, we prove that the proposed method leads to
correct gradient calculation for the training objective L.
3.1.2. R ATIONALE
Let us first prove the correctness of our solution under the
assumption that there is no tied/shared parameter across
pipeline stages, just for simplicity; we will see very soon that
this assumption is not essential and can be safely discarded.
Proposition 3.1. Suppose that there is no tied parameter
across pipeline stages, and consider the auxiliary losses
defined in Eq. (2). Then, for any i∈[K]and any model
parameter or activation tensor zin Stage i, it holds that
∂Laux
i
∂z=∂(PK
j=iLj)
∂z. (3)
Notice that for any model parameter zin Stage i, one has
∂Lj/∂z=0for any j < i , due to the sequential struc-
ture of early-exit LLMs (or other deep neural networks).
Combining this with L=P
i∈[K]Liand Eq. (3) yields
∂Laux
i
∂z=∂(PK
j=iLj)
∂z=∂L
∂z,
implying correctness of gradient calculation for L.
Proof of Proposition 3.1. The claim of Eq. (3)is obviously
true for the base case i=K, by definition of Laux
K=LK.Let us prove by induction for the remaining stages. Suppose
that Eq. (3)holds true for Stage i+ 1, namely ∂Laux
i+1/∂z=
∂(PK
j=i+1Lj)/∂z. To prove Eq. (3)for Stage i, first note
that by definition of gi, we have
gi=∂Laux
i+1
∂xi=∂(PK
j=i+1Lj)
∂xi.
Then, for any model parameter or activation tensor zin
Stage i, the following holds:
∂Laux
i
∂z=∂(Li+⟨gi,xi⟩)
∂z=∂Li
∂z+∂⟨gi,xi⟩
∂xi∂xi
∂z
=∂Li
∂z+gi∂xi
∂z=∂Li
∂z+∂(PK
j=i+1Lj)
∂xi∂xi
∂z
=∂Li
∂z+∂(PK
j=i+1Lj)
∂z=∂(PK
j=iLj)
∂z.
The above lines simply follow the definition of Laux
iand the
chain rule. This concludes our proof of Eq. (3)for Stage i,
and thus our proof for the proposition.
Let us move on to relax the assumption. In the broader
scenario with tied model parameters, e.g. word embedding
matrices (Press & Wolf, 2017), across pipeline stages, gra-
dient calculation via backpropagation is equivalent to the
following two-step procedure: (1) compute gradients as
ifall parameters are untied, then (2) sum up and synchro-
nize gradients for tied parameters via all-reduce operations.
Hence our proposed auxiliary-loss approach, when applied
to the first part of this two-step procedure, is still valid.
3.1.3. I NTEGRATION WITH THE 1F1B SCHEDULE
We have shown how to modify the forward and backward
steps for each microbatch, in order to execute backpropaga-
tion of the early-exit training loss through pipeline stages.
In principle, this","[0.03546072542667389, -0.009535187855362892, 0.04501452296972275, -0.0185988899320364, 0.007835355587303638, -0.033252183347940445, -0.017420174553990364, 0.031018827110528946, -0.005524453241378069, 0.02470339462161064, 0.018586480990052223, 0.0003726136637851596, -0.048141222447156906, -0.014727739617228508, 0.0018812918569892645, -0.01591886207461357, 0.027321383357048035, -0.002323310123756528, -0.028760656714439392, 0.034368861466646194, 0.01061464287340641, -0.05409683659672737, 0.042309682816267014, 0.034368861466646194, 0.013921249657869339, -0.035932209342718124, 0.029381033033132553, 0.0065077501349151134, 0.001107372110709548, -0.022060589864850044, 0.05151607096195221, -0.025931740179657936, -0.030448080971837044, -0.014715331606566906, 0.012209010310471058, 0.0223831869661808, -0.016402756795287132, 0.09439649432897568, -0.014839407056570053, 0.03270625323057175, 0.020348351448774338, -0.01009973045438528, -0.0687873512506485, 0.02779286913573742, -0.012010490521788597, 0.021328546106815338, 0.017593879252672195, 0.00945453904569149, -0.014603664167225361, 0.022470038384199142, 0.0015462886076420546, 0.01295346301048994, -0.021514659747481346, -0.029802890494465828, -0.026527302339673042, 0.018983522430062294, 0.04211116209626198, -0.02583247981965542, 0.011079925112426281, -0.02109280228614807, 0.009386297315359116, -0.028959177434444427, 0.035162944346666336, -0.033872559666633606, -0.03193698450922966, -0.0026908833533525467, -0.03742111474275589, 0.02948029339313507, 0.010726310312747955, 0.033872559666633606, -0.0648665726184845, 0.0033810522872954607, 0.029629183933138847, -0.0397040992975235, -0.03144068270921707, 0.004339533858001232, 0.017581472173333168, 0.05757094547152519, 0.05097013711929321, 0.0008499159011989832, 0.030051041394472122, 0.0012616908643394709, 0.02823954075574875, -0.048736780881881714, 0.0074817412532866, -0.08600900322198868, -0.0011011683382093906, -0.04642898216843605, -0.06893624365329742, -0.008114525116980076, -0.011383909732103348, 0.01395847275853157, -0.03059697151184082, 0.015583858825266361, 0.03278069570660591, 0.023561902344226837, 0.04737195372581482, -0.043823398649692535, 0.03233402594923973, 0.016204236075282097, 0.03166402131319046, -0.024542097002267838, 0.025261733680963516, -0.07826671004295349, 0.02555951476097107, -0.04838937148451805, -0.029207328334450722, 0.021750401705503464, -0.018673334270715714, -0.0371977798640728, -0.011092333123087883, 0.016117382794618607, 0.012463364750146866, 0.004758288152515888, 0.020323535427451134, -0.06744734197854996, -0.05995319038629532, 0.006008347030729055, -0.01610497571527958, -0.0013245039153844118, -0.020050570368766785, -0.002070506801828742, 0.002365185646340251, -0.017829623073339462, 0.02359912358224392, -0.040473368018865585, 0.047570474445819855, -0.035932209342718124, -0.025050805881619453, -0.055635370314121246, 0.0008855875348672271, -0.005170838441699743, 0.02119206264615059, -0.01179956179112196, -0.000694821763318032, -0.02555951476097107, 0.012035305611789227, 0.02684989757835865, 0.006433304864913225, -0.0149634825065732, 0.01395847275853157, -0.018412776291370392, -0.03868668153882027, -0.0021914802491664886, -0.03546072542667389, 0.059605780988931656, -0.00538486847653985, 0.03580813482403755, -0.017283691093325615, -0.012177991680800915, -0.005608204286545515, 0.02203577570617199, -0.013635876588523388, -0.0060052452608942986, -0.008784531615674496, -0.0005765624810010195, -0.03278069570660591, 0.020795023068785667, 0.05583389103412628, 0.0004059589118696749, -0.0014485792489722371, 0.051367178559303284, 0.060945793986320496, -0.01320161297917366, -0.018338331952691078, 0.023078007623553276, -0.01904555968940258, -0.03886038810014725, -0.03938150405883789, -0.03059697151184082, -0.02346264198422432, -0.019517047330737114, -0.05672723427414894, -0.01931852661073208, 0.004770695697516203, -0.03225957974791527, -0.06551176309585571, -0.04943160340189934, 0.016253866255283356, -0.058861326426267624, -0.014665701426565647, 0.014070140197873116, 0.02230874076485634, 0.010713903233408928, -0.0514664389193058, 0.024963952600955963, 0.028041020035743713, 0.015087557956576347, -0.009981858544051647, 0.029505109414458275, 0.020720576867461205, 0.029802890494465828, 0.045833420008420944, -0.013003092259168625, 0.002242661314085126, -0.020670946687459946, 0.04235931113362312, 0.032631807029247284, 0.024777838960289955, 0.000323565152939409, 0.0643206387758255, 0.015794787555933, 0.033549964427948, -0.03099401295185089, 0.021924108266830444, 0.02583247981965542, -0.010453345254063606, 0.0025792154483497143, -0.05955614894628525, -0.02868621237576008, -0.025125250220298767, 0.004978521727025509, -0.007748503237962723, 0.026031000539660454, 0.029232144355773926, 0.022718189284205437, -0.06312952190637589, 0.04211116209626198, 0.008089710026979446, 0.015000705607235432, 0.005093291401863098, -0.017420174553990364, -0.02779286913573742, 0.028338801115751266, -0.044319700449705124, 0.019107598811388016, 0.058265767991542816, -0.06620658934116364, 0.03764444962143898, -0.03558479994535446, 0.04082077741622925, 0.020670946687459946, -0.025050805881619453, -0.005121208261698484, 0.08283267915248871, -0.06695103645324707, -0.013524209149181843, -0.04154041409492493, 0.005468619521707296, -0.021527066826820374, -0.011905026622116566, 0.070474773645401, -0.03645332530140877, -0.042657092213630676, -0.02064613252878189, 0.006287516560405493, -0.012841794639825821, 0.031242163851857185, -0.020621316507458687, -0.02480265498161316, -0.01756906323134899, -0.0041999490931630135, -0.012575033120810986, -0.02497635968029499, -0.07166589796543121, 0.012500587850809097, 0.04464229568839073, -0.003219754435122013, -0.023983757942914963, -0.008139340206980705, 0.05166495963931084, -0.04295487329363823, -0.04831492528319359, -0.0004431815177667886, 0.016303496435284615, -0.00014491609181277454, -0.01952945441007614, 0.013474578969180584, 0.024877099320292473, 0.023127637803554535, -0.02774323895573616, 0.012091139331459999, -0.01157622691243887, 0.008598418906331062, -0.0056671397760510445, 0.0011539004044607282, 0.0416644886136055, 0.04077114909887314, -0.03464182838797569, 0.008170358836650848, -0.011160573922097683, -0.03389737382531166, 0.09260981529951096, 0.04719824716448784, 0.026279151439666748, -0.00595561508089304, -0.0018052958184853196, 0.02814028039574623, -0.013908842578530312, -0.035609614104032516, -0.0050002350471913815, 0.005701260641217232, 0.019876865670084953, 0.014454773627221584, 0.01842518337070942, 0.00927462987601757, -0.027098048478364944, -0.037892598658800125, 0.004761389922350645, 0.022283926606178284, -0.008288230746984482, -0.02181243896484375, -0.045833420008420944, 0.03399663418531418, -0.007413499988615513, -0.01921926625072956, 0.00355785945430398, 0.01159483753144741, -0.015372931025922298, -0.01578238047659397, 0.03769407793879509, 0.030175115913152695, -0.0042868019081652164, -0.0005145248142071068, -0.0043333303183317184, -0.04910900816321373, 0.02069576270878315, -0.03749556094408035, -0.00019987756968475878, -0.006129320245236158, -0.0016672620549798012, -0.020981134846806526, 0.004472915083169937, -0.007072292733937502, -0.011365298181772232, 0.006687659304589033, -0.027147678658366203, -0.006551176309585571, -0.02449246682226658, -0.011874007061123848, 0.007841560058295727, -0.02305319346487522, -0.03759482130408287, -0.00927462987601757, -0.035386279225349426, -0.0004629559989552945, -0.007798133417963982, 0.04369932413101196, 0.04479118809103966, -0.0013594001065939665, -0.07876300811767578, -0.0067993272095918655, -0.012333085760474205, -0.005105698946863413, 0.042260050773620605, -0.0009452987578697503, 0.07484222948551178, 0.005465517286211252, 0.07419703900814056, 0.03255736082792282, -0.026949157938361168, -0.0049599106423556805, 0.026031000539660454, 0.013809582218527794, 0.03613073006272316, -0.021663550287485123, 0.026924341917037964, -0.0349644236266613, -0.006095199845731258, 0.009535187855362892, -0.04330228269100189, -0.004820325877517462, -0.0008638743311166763, 0.03228439763188362, -0.023896904662251472, 0.00644571240991354, 0.008592215366661549, 0.007450722623616457, -0.018276292830705643, 0.0017944391584023833, 0.020720576867461205, 0.04384821653366089, -0.033872559666633606, 0.02444283664226532, -0.03886038810014725, -0.01387161947786808, 0.005341442301869392, 0.032532546669244766, 0.03555998578667641, 0.00833786092698574, -0.013747544959187508, 0.012587440200150013, -0.02368597686290741, 0.008430917747318745, 0.015149595215916634, -0.0031437582802027464, -0.026428041979670525, -0.037892598658800125, -0.004944401327520609, 0.004227866418659687, -0.005738483276218176, 0.017147207632660866, -0.015509413555264473, 0.01885944791138172, 0.02930658869445324, -0.03675110638141632, 0.05851391702890396, 0.057918354868888855, 0.06124357506632805, 0.010074915364384651, -0.04260746389627457, -0.03233402594923973, -0.0559331513941288, -0.06521398574113846, 0.030299190431833267, -0.012469569221138954, 0.0045318505726754665, 0.01527367066591978, 0.0671495571732521, 0.012419939041137695, 0.029331402853131294, 0.015286078676581383, 0.03144068270921707, -0.029778074473142624, 0.019206859171390533, -0.03724740818142891, 0.026701007038354874, 0.03019993007183075, 0.020894283428788185, 0.060052450746297836, 0.04546119272708893, 0.033078476786613464, -0.020981134846806526, -0.04168930649757385, -0.018921485170722008, 0.018387962132692337, 0.03384774550795555, -0.01467810943722725, 0.01170650590211153, -0.0514664389193058, -0.021241692826151848, 0.041937455534935, -0.029281772673130035, -0.05717390403151512, -0.022445224225521088, -0.011408724822103977, 0.012302067130804062, 0.0030351923778653145, -0.008040079846978188, -0.012233825400471687, 0.023214491084218025, -0.00942972395569086, -0.04067188873887062, 0.016601277515292168, -0.028785472735762596, 0.04479118809103966, -0.06590880453586578, -0.016067752614617348, -0.023834867402911186, 0.00480481656268239, -0.0062999241054058075, 0.04154041409492493, 0.0632287785410881, 0.012816979549825191, 0.0021356462966650724, -0.07057403773069382, 0.06129320338368416, 0.03546072542667389, -0.006017652805894613, 0.0004311616939958185, 0.0366518460214138, 0.048463817685842514, -0.01646479405462742, -0.03707370162010193, -0.036502957344055176, 0.013449763879179955, 0.04263227805495262, -0.05449387803673744, -0.01351180113852024, 0.01588164083659649, -0.008244804106652737, -0.04764492064714432, 0.013772360049188137, -0.02502598986029625, -0.046627502888441086, 0.03486516326665878, -0.02858695201575756, -0.03479071706533432, -0.005651630461215973, 0.011874007061123848, 0.011867803521454334, -0.012841794639825821, -0.018797410652041435, -0.041143372654914856, 0.04121781885623932, 0.07742299139499664, 0.022358370944857597, 0.0008584460592828691, -0.00441397912800312, -0.009777134284377098, 0.01161965262144804, -0.0349644236266613, 0.028537321835756302, -0.012512994930148125, -0.037272222340106964, -0.010496770963072777, -0.016390347853302956, -0.008399898186326027, -0.001230672001838684, 0.0039921230636537075, 0.02181243896484375, 0.015819601714611053, -0.010757329873740673, 0.021018357947468758, 0.027271753177046776, -0.008325453847646713, -0.01810258813202381, 0.022581705823540688, -0.03037363663315773, 0.01658886857330799, -0.03260699287056923, -0.015645897015929222, 0.005645426455885172, -0.03796704486012459, 0.0008010612218640745, 0.028735842555761337, -0.020981134846806526, 0.00556477764621377, 0.0027172493282705545, 0.02617989107966423, 0.0029716037679463625, 0.01878500171005726, -0.023003563284873962, -0.015993308275938034, -0.0237728301435709, -0.03536146506667137, -0.019653528928756714, -0.10779663175344467, -0.013549024239182472, -0.014094955287873745, 0.049704570323228836, -0.0019045560620725155, 0.0008165706531144679, 0.0009677874040789902, -0.008685272186994553, -0.005232876166701317, 0.012978277169167995, -0.02975326031446457, -0.022544484585523605, 0.014032918028533459, -0.006067282520234585, -0.007810540962964296, 0.029207328334450722, 0.04459266737103462, -0.010453345254063606, -0.04176374897360802, 0.0234998632222414, -0.01856166683137417, -0.0017215450061485171, 0.030299190431833267, 0.005968022625893354, -0.014479588717222214, -0.01560867391526699, -0.014132178388535976, -0.02578284963965416, -0.0042930059134960175, 0.027594348415732384, 0.04541156440973282, 0.016204236075282097, 0.027197308838367462, 0.01601812243461609, 0.015980899333953857, 0.020311128348112106, -0.043327100574970245, -0.007562390062958002, 0.023785237222909927, 0.02595655433833599, -0.037619635462760925, 0.005729177501052618, 0.013127167709171772, -0.03330181539058685, 0.007028866559267044, -0.002628845628350973, 0.0059587168507277966, 0.019244080409407616, 0.0025699099060148, 0.012035305611789227, 0.01645238697528839, 0.028065836057066917, -0.010161767713725567, -0.035038869827985764, -0.03759482130408287, -0.020708169788122177, -0.04714861884713173, -0.034145526587963104, -0.020720576867461205, -0.022767819464206696, -0.011197797022759914, -0.03426960110664368, 0.039803359657526016, 0.02493913844227791, -0.01353661622852087, -0.0227926354855299, 0.0020053673069924116, -0.01787925325334072, -0.030398450791835785, -0.010217602364718914, 0.023313751444220543, -0.007705077063292265, -0.04697491228580475, 0.025609144940972328, -0.005248385481536388, -0.014504403807222843, -0.019244080409407616, 0.0025404419284313917, 0.0075934091582894325, -0.0032941994722932577, 0.016526831313967705, 0.016663314774632454, -0.03086993843317032, 0.021961329504847527, -0.020038163289427757, -0.004956808872520924, 0.006306127645075321, -0.013759952038526535, -0.035386279225349426, -0.023847274482250214, 0.015844417735934258, 0.04486563429236412, -0.019901679828763008, 0.015956085175275803, 0.002152706729248166, 0.03799185901880264, -0.04285561293363571, 0.037222594022750854, -0.005242181941866875, -0.00856740027666092, -0.013214020989835262, -0.02600618451833725, 0.029132883995771408, -0.00854258518666029, 0.014256252907216549, 0.01610497571527958, -0.015025520697236061, 0.029778074473142624, 0.0008111423230729997, -0.014777369797229767, -0.01703554019331932, -0.008952033706009388, -0.07305554300546646, 0.021154841408133507, -0.014169400557875633, 0.035535167902708054, -0.039455950260162354, 0.0279665756970644, 0.001602122443728149, 0.0015990205574780703, 0.007084700278937817, 0.013710321858525276, -0.044667113572359085, -0.04374895617365837, -0.022581705823540688, 0.02265615202486515, 0.01493866741657257, 0.012463364750146866, -0.03429441526532173, 0.012426142580807209, 0.004488424398005009, 0.025038398802280426, -0.026155075058341026, -0.01423143781721592, -0.03883557394146919, -0.03161438927054405, 0.0043798587284982204, -0.01694868691265583, 0.007810540962964296, -0.025212103500962257, 0.009510372765362263, 0.013747544959187508, -0.007450722623616457, 0.009826764464378357, 0.05598277971148491, 0.02284226566553116, 0.022246703505516052, -0.023338565602898598, -0.03178809583187103, -0.03233402594923973, -0.029902150854468346, -0.013486986048519611, -0.01712239347398281, -0.015124780125916004, -0.008089710026979446, -0.0349644236266613, -0.0020813634619116783, -0.02171318046748638, 7.682006253162399e-05, 0.014876630157232285, -0.015993308275938034, -0.006377471145242453, -0.039009276777505875, -0.018400369212031364, 0.002810305915772915, 0.021080395206809044, -0.004683842882514, 0.04196226969361305, 0.01079455204308033, -0.017606286332011223, 0.03876112774014473, -0.017457395792007446, -0.027643978595733643, 0.008809346705675125, -0.010751125402748585, -0.029405849054455757, 0.0047520846128463745, -0.037222594022750854, -0.03394700586795807, -0.009845376014709473, 0.07107033580541611, 0.05181385204195976, -0.04392265900969505, -0.012271048501133919, 0.00044395698932930827, -0.0004517116758506745, -0.018834631890058517, -0.02583247981965542, 0.03474108874797821, 0.01787925325334072, -0.007394888438284397, -0.016787389293313026, -0.016750166192650795, -0.02885991707444191, -0.015062742866575718, -0.0363788828253746, 0.018127402290701866, -0.01743258163332939, -0.014479588717222214, -0.06695103645324707, 0.02480265498161316, 0.035609614104032516, -0.007804336957633495, 0.017916474491357803, 0.019914086908102036, 0.027222122997045517, -0.0073328507132828236, -0.017047947272658348, 0.023487456142902374, -0.029778074473142624, -0.018127402290701866, -0.0234998632222414, 0.000623866159003228, -0.03248291835188866, -0.01756906323134899, -0.027122862637043, 0.05494054779410362, 0.010081118904054165, 0.007245998363941908, 0.03675110638141632, 0.024194685742259026, 0.0009142799535766244, -0.01465329434722662, 0.0027839397080242634, 0.009578614495694637, 0.004780001472681761, 0.013834397308528423, 0.0027265548706054688, 0.0014501302503049374, 0.00693580973893404, -0.013660691678524017, 0.022370778024196625, -0.028537321835756302, -0.0030274377204477787, 0.024455243721604347, 0.005986633710563183, 0.006250293925404549, 0.002628845628350973, -0.019926495850086212, 0.007010255008935928, -0.015248855575919151, 0.05161533132195473, -0.008288230746984482, 0.016167012974619865, 0.012053916230797768, 0.05030013248324394, 0.018722964450716972, 0.011414928361773491, -0.016303496435284615, 0.004364348948001862, -0.04709898680448532, 0.0003479924635030329, -0.003182531800121069, 0.029157698154449463, 0.009262221865355968, 0.02394653484225273, -0.0017106883460655808, 0.005260793026536703, -0.006064180750399828, 0.0004307739727664739, 0.03139105439186096, -0.003545452142134309, -0.029381033033132553, -0.03603146970272064, -0.0010228458559140563, 0.008331657387316227, -0.01655164733529091, -0.001875088200904429, 0.02328893542289734, -0.01092483103275299, -0.08645568042993546, 0.033922191709280014, -0.027619164437055588, -0.004472915083169937, -0.001520698075182736, 0.001471067895181477, 0.00130744359921664, -0.003595082089304924, 0.005943207535892725, -0.02416987158358097, -0.007252201903611422, 0.021167248487472534, -0.004026243928819895, 0.008356472477316856, 0.0008514668443240225, -0.03786778450012207, 0.020981134846806526, 0.012295863591134548, 0.01387161947786808, -0.009001663886010647, -0.052558302879333496, -0.03541109338402748, 0.001991408644244075, 0.010298251174390316, -0.04429488629102707, -0.06789401173591614, 0.013784767128527164, -0.04037410765886307, 0.04005151242017746, 0.03104364313185215, 0.02622952125966549, 0.0023264121264219284, 0.03086993843317032, -0.020906690508127213, -0.0003747462178580463, 0.013797174207866192, -0.007140533998608589, 0.014913852326571941, 0.003272486384958029, -0.0028537320904433727, -0.030274376273155212, -0.016291089355945587, 0.038388900458812714, 0.010019081644713879, 0.0056268153712153435, 0.015124780125916004, 0.03697444126009941, -0.010515382513403893, 0.06427101045846939, 0.009901209734380245, -0.01945500820875168, -0.018586480990052223, -0.007853967137634754, -0.009510372765362263, 0.026874711737036705, 0.000633171817753464, -0.009249814786016941, -0.015484598465263844, 0.00039975513936951756, 0.0209687277674675, -0.019169636070728302, 0.02997659519314766, 0.024182278662919998, -0.014504403807222843, -0.024554504081606865, -0.03982817381620407, 0.02315245382487774, 0.033872559666633606, 0.0015222489601001143, -0.0327310673892498, 0.0023481252137571573, -0.003964206203818321, -0.008914811536669731, 0.015310893766582012, 0.0032569768372923136, -0.01976519636809826, -0.03689999878406525, 0.0017153412336483598, -0.02105558104813099, 0.03283032774925232, 0.01658886857330799, 0.02449246682226658, -0.012295863591134548, 0.021130025386810303, 0.004227866418659687, 0.031242163851857185, 0.013437355868518353, -0.030175115913152695, -0.025683589279651642, -0.005859456490725279, 0.031688835471868515, -0.02583247981965542, 0.023115230724215508, -0.018474813550710678, 0.013164390809834003, -0.019169636070728302, 0.01570793427526951, 0.0011345136445015669, 0.03635406494140625, 0.009349075146019459, 0.0020224275067448616, 0.016402756795287132, -0.013015500269830227, -0.017829623073339462, -0.00586566049605608, -0.017717953771352768, 0.005496536381542683, -0.022953933104872704, -0.00999426655471325, -0.04183819517493248, 0.005812928546220064, -0.02060890942811966, -0.027321383357048035, 0.03176328167319298, -0.003604387864470482, 0.000921259168535471, 0.0057539925910532475, -0.00693580973893404, 0.02150225080549717, -0.04312857985496521, 0.008970645256340504, -0.017593879252672195, -0.02846287563443184, -0.006054875440895557, -0.008219989016652107, -0.05518869683146477, 0.012202806770801544, 0.04268190637230873, -0.035262204706668854, 0.011960860341787338, -0.012326882220804691, -0.007884985767304897, -0.00732664717361331, 0.00787257868796587, -0.007041274104267359, 0.013685506768524647, -0.0225196685642004, -0.0016145299887284636, 0.008579807355999947, 0.03399663418531418, 0.015720341354608536, 0.02359912358224392, 0.026155075058341026, -0.011998082511126995, 0.0054996381513774395, 0.013859212398529053, -0.011253630742430687, 0.006997847463935614, -0.010602235794067383, 0.03449293598532677, 0.025807665660977364, 0.01622905023396015, -0.033971820026636124, 0.0035702669993042946, -0.01735813543200493, 0.020894283428788185, 0.010651865974068642, -0.007314239628612995, 0.0016579563962295651, 0.03749556094408035, 0.013189205899834633, 0.01908278279006481, -0.026651376858353615, 0.020534463226795197, -0.02122928574681282, -0.03779333829879761, 0.008089710026979446, -0.014529218897223473, -0.017556656152009964, -0.004153421148657799, -0.015372931025922298, -0.025758035480976105, 0.002624192740768194, 0.03625480458140373, 0.029505109414458275, 0.014144585467875004, 0.004221662413328886, 0.015248855575919151, 0.018276292830705643, -0.011991878971457481, -0.00011215244740014896, 0.016129789873957634, -0.00046450694208033383, -0.006312331650406122, 0.016849426552653313, -0.019430194050073624, 0.012903832830488682, -0.030919568613171577, 0.009100924246013165, 0.03104364313185215, 0.017023133113980293, 0.02841324731707573, -0.0019479823531582952, 0.03488997742533684, 0.020943911746144295, 0.0117499316111207, -0.01320161297917366, 0.019951310008764267, -0.02323930524289608, -0.0014516811352223158, -0.02028631418943405, 0.02970363013446331, -0.0014454773627221584, -0.01988927274942398, -0.04079596325755119, 0.029902150854468346, -0.0015175961889326572, -0.004699352663010359, 0.03362441062927246, 0.0074197035282850266, 0.01890907809138298, -0.015186818316578865, -0.009485557675361633, 0.05141681060194969, -0.005136718042194843, -0.037669263780117035, 0.031589575111866, -0.0037873988039791584, -0.0023217592388391495, -0.012202806770801544, -0.013214020989835262, -0.04789306968450546, -0.0011430438607931137, 0.029827704653143883, -0.017010726034641266, -0.019951310008764267, 0.008468139916658401, -0.024914322420954704, -0.010385103523731232, 0.007494148798286915, -0.004550462123006582, -0.006582195404917002, -0.05558573827147484, 0.021651141345500946, -0.015894047915935516, 6.751441833330318e-05, 0.005003336817026138, -0.029108067974448204, 0.007562390062958002, 0.006681455764919519, 0.03955521062016487, 0.04615601524710655, -0.022494854405522346, 0.011476966552436352, 0.03037363663315773, 0.004690046887844801, -0.0078973937779665, 0.05722353234887123, -0.01596849225461483, -0.01627868041396141, -0.003418274922296405, 0.04206153005361557, 0.03518775850534439, -0.008437121286988258, 0.03389737382531166, 0.00802767276763916, 0.049257900565862656, 0.051317550241947174, -0.005887373350560665, 0.010788348503410816, 0.00010274986561853439, 0.023586716502904892, 0.03099401295185089, -0.032358840107917786, -0.019380563870072365, -0.021105211228132248, 0.0018642315408214927, 0.035882581025362015, 0.0008212234824895859, 0.0201250147074461, -0.0046652317978441715, 0.0013733586529269814, -0.007822948507964611, 0.01895870827138424, 0.002510974183678627, 0.0025156268384307623, 0.054394617676734924, -0.02595655433833599, 0.016067752614617348, -0.032755881547927856, -0.010521586053073406, -0.03642851114273071, -0.03799185901880264, -0.005853252951055765, 0.0076802619732916355, -0.0070474776439368725, -0.011470763012766838, 0.0031080865301191807, 0.021465029567480087, -0.0047924090176820755, 0.007624427787959576, 0.03149031475186348, -0.009578614495694637, 0.021489843726158142, 0.02635359577834606, -0.003573369001969695, -0.017407765612006187, 0.028512505814433098, -0.016291089355945587, -0.02583247981965542, -0.006997847463935614, 0.01048436388373375, 0.012568828649818897, 0.016700537875294685, 0.01395847275853157, 0.020224275067448616, -0.0071281264536082745, 0.004243375733494759, -0.0276936087757349, -0.008443324826657772, 0.012283455580472946, -0.017941290512681007, -0.016377940773963928, 0.023226898163557053, 0.00854258518666029, -0.017147207632660866, -0.017854437232017517, -0.023661162704229355, 0.023164860904216766, -0.024628950282931328, 0.016390347853302956, 0.028264356777071953, -0.010236212983727455, 0.02689952775835991, -0.018301108852028847, -0.04498970881104469, -0.01699831709265709, -0.0075872051529586315, 0.010068711824715137, 0.028090650215744972, 0.022643744945526123, 0.025212103500962257, 0.0070536816492676735, -0.012264844961464405, -0.014132178388535976, 0.019467417150735855, -0.009256018325686455, -0.001820805249735713, -0.01583201065659523, -0.0062937201000750065, 0.03590739518404007, 0.009560002945363522, 0.017494618892669678, 0.018735371530056, -0.02898399345576763, -0.0072149792686104774, -0.004978521727025509, -0.010552605614066124, 0.006116912700235844, -0.0061665428802371025, 0.06759622693061829, 0.007816744968295097, 0.014206623658537865, 0.000903423351701349, -0.004916484002023935, 0.016886649653315544, 0.01668812893331051, -0.031142903491854668, -0.0006157237221486866, 0.011532800272107124, -0.004345737863332033, 0.053104232996702194, 0.024827469140291214, 0.024504873901605606, 0.030696231871843338, 0.014752554707229137, -0.014603664167225361, 0.037669263780117035, 0.005083986092358828, 0.03622999042272568, 0.037222594022750854, 0.013908842578530312, -0.006675251759588718, -0.007605816703289747, -0.009628243744373322, -0.0079656345769763, -0.008033876307308674, 0.019603898748755455, 0.02243281714618206, 0.02801620587706566, -0.00972750410437584, -0.014752554707229137, -0.0293562188744545, 0.016526831313967705, -0.015174410305917263, 0.024988768622279167, -0.01289142481982708, 0.023487456142902374, 5.685169526259415e-05, -0.00854258518666029, 0.007785725872963667, 0.008747309446334839, 0.0042061530984938145, -0.017990920692682266, -0.003781195031479001, 0.027544720098376274, 0.006855160929262638, 0.009845376014709473, 0.005301117897033691, -0.013027907349169254, 0.02497635968029499, 0.023301344364881516, 0.025001175701618195, -0.009895006194710732, 0.0054593137465417385, 0.01708517037332058, -0.004234069958329201, 0.01097446121275425, 0.003319014562293887, -0.005614407826215029, -0.012438549660146236, -0.02413264848291874, -0.007928412407636642, 0.0023171063512563705, 0.006309229414910078, 0.008741105906665325, 0.029008807614445686, 0.02435598336160183, -0.039406318217515945, 0.02550988458096981, -0.0013539718929678202, 0.01658886857330799, -0.016700537875294685, -0.013214020989835262, -0.012029101140797138, -0.003015030175447464, -0.03461701050400734, 0.0045380545780062675, -0.019603898748755455, 0.042756352573633194, -0.03176328167319298, 0.004016938153654337, 0.015013112686574459, -0.024653764441609383, 0.019951310008764267, -0.0015269018476828933, 0.03598184138536453, -0.033649224787950516, -0.03407108038663864, -0.0007293301750905812, -0.002824264345690608, 0.03982817381620407, 0.002970052883028984, -0.03037363663315773, -0.014603664167225361, -0.037470743060112, 0.004544258117675781, -0.03486516326665878, -0.015248855575919151, 0.03015029989182949, -0.022817449644207954, -0.004891669377684593, 0.02284226566553116, 0.013635876588523388, 0.008629437536001205, 0.013102352619171143, -0.031118087470531464, 0.018673334270715714, 0.016042938455939293, 0.01362346950918436, 0.015099965035915375, -0.01797851175069809, -0.004153421148657799, -0.03816556558012962, -0.005543064326047897, 0.016204236075282097, -0.004628009162843227, 0.0430789478123188, 0.005477924831211567, 0.004758288152515888, 0.018214255571365356, 0.03099401295185089, 0.03181290999054909, -0.009932228364050388, -0.012965870089828968, 0.008499158546328545, -0.020460018888115883, 0.0029716037679463625, -0.004994031507521868, -0.0013369114603847265, -0.0008925667498260736, 0.015856824815273285, 0.0018285599071532488, -0.010205194354057312, -0.009330463595688343, 0.011824376881122589, -0.020410388708114624, -0.007605816703289747, -0.020038163289427757, 0.010837978683412075, 0.007773318327963352, -0.02212262898683548, -0.010217602364718914, 0.038512974977493286, 0.004925789777189493, 0.010763533413410187, 0.016439978033304214, -0.03449293598532677, -0.002701740013435483, -0.02471580170094967, 0.002746717305853963, 0.022631336003541946, -0.006563583854585886, 0.01735813543200493, 0.010242416523396969, 0.0025497477035969496, -0.0074817412532866, -0.01811499521136284, 0.03426960110664368, -0.007339054718613625, 0.00927462987601757, 0.005201857537031174, -0.005834641400724649, 0.031465500593185425, 0.04039892181754112, 0.015732750296592712, -0.02948029339313507, -0.01423143781721592, -0.015559043735265732, -0.0257332194596529, -0.036502957344055176, -0.007748503237962723, 0.02127891592681408, -0.010298251174390316, -0.033252183347940445, 0.00763683533295989, 0.007971839047968388, 0.01014936063438654, -0.006451916415244341, -0.0076740579679608345, -0.007537574972957373, -0.007537574972957373, 0.03580813482403755, 0.003123596077784896, -0.040870409458875656, -0.023834867402911186, 0.0034834144171327353, 0.012481976300477982, -0.006731085479259491, -0.008586011826992035, 0.023078007623553276, -0.029108067974448204, 0.04474155604839325, -0.03948076441884041, -0.01061464287340641, -0.022221887484192848, -0.00410379096865654, 0.03149031475186348, 0.035212572664022446, 0.02413264848291874, 0.004051059018820524, -0.01717202365398407, -0.011346687562763691, 0.0032104486599564552, 0.007357665803283453, -0.008077302947640419, 0.040349289774894714, -0.02088187448680401, -0.03359959274530411, 0.009988063015043736, 0.004203051328659058, -0.009926024824380875, -0.029058437794446945, -0.0030227848328649998, 0.0032104486599564552, 0.02274300530552864, 0.010533994063735008, -0.006873772479593754, -0.012010490521788597, -0.04791788384318352, 0.02519969642162323, -0.017283691093325615, 0.008443324826657772, 0.008958237245678902, -0.0008142442093230784, 0.02047242596745491, 0.01676257513463497, 0.02702360227704048, -0.003762583713978529, 0.00032278968137688935, 0.0032941994722932577, -0.02751990407705307, 0.006687659304589033, 0.00261488719843328, 0.020137423649430275, 0.000649068970233202, -0.025857295840978622, -0.024467650800943375, -0.017010726034641266, 0.002374491188675165, 0.007978042587637901, 0.0032879956997931004, 0.028487691655755043, -0.02801620587706566, 0.006997847463935614, 0.006942013744264841, -0.0034399880096316338, 0.010050100274384022, -0.032185137271881104, 0.01730850525200367, -0.00693580973893404, -0.008530178107321262, 0.003917677793651819, -0.0065015461295843124, -0.00034372738446108997, -0.027867315337061882, 0.03640369698405266, -0.02158910408616066, 0.01646479405462742, 0.0035206370521336794, 0.006638029124587774, 0.011725116521120071, 0.0031608184799551964, -0.023090414702892303, -0.00346790486946702, 0.040026694536209106, -0.026303965598344803, 0.028835102915763855, -0.014367921277880669, -0.025485068559646606, 0.02430635318160057, 0.0029576453380286694, 0.03144068270921707, -0.01985204964876175, 0.016923872753977776, 0.03652777150273323, -0.0173457283526659, -0.012215214781463146, 0.022221887484192848, -0.017717953771352768, 0.024145055562257767, 0.002509423065930605, 0.018611297011375427, 0.005059171002358198, 0.022891895845532417, -0.020087793469429016, -0.014889037236571312, -0.015013112686574459, -0.00032763637136667967, 0.009466946125030518, 0.02315245382487774, 0.00029642367735505104, 0.007345258258283138, -0.020360758528113365, -0.03642851114273071, -0.027048418298363686, -0.007835355587303638, -0.00823239702731371, 0.02600618451833725, 0.006873772479593754, 0.0028335698880255222, -0.0050870878621935844, 0.026998788118362427, 0.015372931025922298, 0.03776852414011955, 0.02047242596745491, 0.0016951789148151875, 0.009361482225358486, -0.025882109999656677, -0.006396082229912281, 0.008294434286653996, -0.004106892738491297, -0.010658069513738155, 0.022110220044851303, 0.011272242292761803, -0.007295628543943167, -0.014702924527227879, -0.01885944791138172, 0.009256018325686455, 0.026254335418343544, 0.03141586855053902, -0.01155141182243824, -0.02372319996356964, -0.031341422349214554, 0.01980241946876049, -0.03575850650668144, 0.018437590450048447, 0.010136952623724937, 0.030125485733151436, -0.008945830166339874, 0.009572410024702549, 0.028611766174435616, 0.018524443730711937, -0.0209687277674675, -0.02029872126877308, 0.037470743060112, 0.033922191709280014, -0.0040386514738202095, 0.04235931113362312, -0.014045325107872486, -0.017010726034641266, -0.0078973937779665, -0.008865181356668472, -0.016526831313967705, -0.004783103242516518, 0.014281067997217178, 0.009460742585361004, 0.006489138584583998, -0.03595702350139618, 0.014057733118534088, 0.015000705607235432, 0.03533664718270302, -0.019901679828763008, 0.0044915261678397655, 0.019120005890727043, 0.00885277334600687, 0.020360758528113365, -0.034368861466646194, -0.023214491084218025, -0.008561196736991405, -0.05191310867667198, 0.017817214131355286, -0.0019324730383232236, 0.012804572470486164, 0.00048777105985209346, -0.006396082229912281, -0.0022907403763383627, -0.053997576236724854, -0.031589575111866, -0.0030987809877842665, 0.004534952808171511, 0.03451775014400482, 0.017854437232017517, 0.047520846128463745, -0.0035113312769681215, 0.008821754716336727, -0.012233825400471687, -0.02114243246614933, 0.04486563429236412, 0.009715097025036812, 0.00909472070634365, -0.03379811346530914, 0.008449528366327286, -0.019256487488746643, 0.03086993843317032, 0.03211069107055664, -0.018722964450716972, -0.016154605895280838, 0.010447141714394093]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" lightweight modification can be integrated
with general pipeline schedules of forward and backward
steps for multiple microbatches. The classical 1F1B (one-
forward-one-backward) schedule, also called PipeDream-
Flush (Narayanan et al., 2019; Fan et al., 2021; Narayanan
et al., 2021b), achieves a good balance of algorithmic sim-
plicity, training time, memory usage and communication
latency, in comparison to other schedules such as GPipe
(Huang et al., 2019) (larger activation memory) or inter-
leaved 1F1B (Narayanan et al., 2021b) (higher memory and
communication requirements). Hence for concreteness, we
focus on the 1F1B schedule throughout this work. Within
one iteration of this schedule, each stage goes through
awarm-up phase (forward steps of the beginning micro-
batches), a steady 1F1B phase, and a cool-down phase (back-
ward steps of the final microbatches). A visualization can
be found in Figure 3(a).
4
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
Backbone forwardExit forwardExit backwardBackbone backwardExplicit bubblesImplicit bubblesStage 1123415263456Stage 2123142536456Stage 3121324354656Stage 4111122223333444455556666Forward step11Backward step11(a) The original 1F1B pipeline scheduleStage 1123415263456Stage 2112233114422553366445566Stage 3112211332244335544665566Stage 4111122223333444455556666Forward step11Backward step11(b) Adding one early exit to each middle stage (i.e. Stages 2 and 3)Stage 1123415263456Stage 2123111422253336444555666Stage 3121113222433354446555666Stage 4111122223333444455556666Forward step1Backward step111(c) Deferring forward computation of early-exit layers to backward steps
Figure 3: One iteration of the 1F1B pipeline schedule, in a setting with P= 4pipeline stages and M= 6microbatches
per batch. At the top of this figure, “Backbone forward/backward” stands for computation of Transformer layers on the
backbone, while “Exit forward/backward” stands for computation of early-exit or final-exit layers. The number in each
block denotes the index of the corresponding microbatch. Critical paths are marked by dashed red lines. From Figure (a)
to (b), additional “Exit forward/backward” blocks are added, due to the introduction of early exits to middle stages. From
Figure (b) to (c), the order of computation is slightly adjusted for the purpose of reducing memory usage. For clarity, we
ignore computation related to the input embedding layer, and P2P communication latency between pipeline stages.
3.2. Training efficiency
At first glance, one might expect that adding early exits to
a standard LLM will incur a training overhead, in terms
of time and memory, that is (at least) proportional to the
number of additional model parameters. Fortunately, this is
not the case for training with pipeline parallelism. We dis-
cover that computation related to the additional early exits
can leverage idle resources in the original 1F1B schedule,
thus causing negligible overhead to training time and zero
overhead to peak GPU memory under mild conditions.
To explain this, let us first identify three types of idle re-
sources in the original 1F1B schedule.
•Explicit bubbles , i.e. the light gray areas in Figure 3(a),
during which GPUs are idle.
•Implicit bubbles , i.e. the dark gray areas in Figure 3(a),
caused by load imbalance across pipeline stages. In
particular, the last pipeline stage requires additional
computation for the output layer.
•Idle memory , caused by unbalanced memory usage:
earlier stages have to save the intermediate activations
for more microbatches, and the first/last stage need to
store an extra input/output layer, plus the correspond-
ing gradients and optimizer states. As a result, the first
stage is typically the bottleneck of peak memory usage.
Now, suppose that we choose kmiddle stages and add one
minimalistic early-exit layer to each of them. As shown in
Figure 3(b), by utilizing implicit bubbles, computation ofkearly exits will increase the training time per iteration by
onlyk×(fEE+bEE), where fEE(resp.","[0.02412608452141285, 0.0017108985921368003, 0.07126209884881973, -0.012563880532979965, -0.01604112796485424, -0.015025141648948193, 0.02962099388241768, 0.0413835346698761, -0.010954043827950954, 0.06897255778312683, 0.04347274452447891, -0.004865284077823162, -0.046019863337278366, 0.0028923398349434137, -0.025714457035064697, -0.017915692180395126, 0.006739849224686623, -0.011848397552967072, -0.00025712669594213367, 0.022852525115013123, 0.021092437207698822, -0.03193916007876396, 0.0207776241004467, 0.053489506244659424, 0.023882821202278137, -0.027073875069618225, 0.011068521067500114, 0.005809721536934376, -0.0038206789176911116, -0.03428594395518303, 0.03199639916419983, -0.03359907865524292, -0.04559057205915451, -0.032225351780653, 0.007512570824474096, 0.025642909109592438, 0.033570460975170135, 0.037462688982486725, -0.010911115445196629, 0.03422870486974716, 0.006739849224686623, -0.04201315715909004, -0.05016966536641121, 0.010138393379747868, -0.009980986826121807, 0.029263252392411232, 0.02322457730770111, 0.01050328928977251, -0.004060365725308657, 0.057782404124736786, 0.011855552904307842, 0.029764091596007347, -0.04207039624452591, -0.014796187169849873, -0.023310434073209763, 0.008335376158356667, 0.013279363512992859, -0.009029394946992397, 0.019947664812207222, -0.004614864941686392, 0.03405698761343956, -0.06130257993936539, 0.032654643058776855, -0.03500142693519592, -0.02336767315864563, 0.03505866602063179, -0.037233732640743256, 0.029206013306975365, 0.025843244045972824, 0.03731958940625191, -0.03528761863708496, 0.01877427287399769, 0.0037062016781419516, -0.03251154348254204, -0.0161985345184803, 0.02001921273767948, 0.04747944697737694, 0.03717649355530739, 0.0032518699299544096, -0.02236599661409855, 0.026844920590519905, -0.00237719202414155, 0.05672348663210869, -0.031338151544332504, 0.0064500789158046246, -0.04536161944270134, -0.0015141407493501902, -0.019833186641335487, -0.052058540284633636, -0.03025061823427677, 0.0073050810024142265, -0.019804568961262703, -0.028304506093263626, 0.022094113752245903, 0.05658039078116417, 0.02900567837059498, 0.019446827471256256, -0.049768995493650436, 0.03276911750435829, 0.05918474867939949, 0.040982864797115326, -0.006729117128998041, 0.021435869857668877, -0.03497280552983284, 0.03777749836444855, -0.046391915529966354, -0.03583138436079025, 0.03193916007876396, -0.03766302391886711, -0.018459459766745567, -0.03583138436079025, -0.016284391283988953, -0.01947544515132904, -0.02939203940331936, -0.0053267707116901875, -0.027703499421477318, -0.04650638997554779, 0.04427408427000046, 0.013486853800714016, 0.013408150523900986, -0.022394616156816483, -0.003185687819495797, 0.005108548328280449, -0.009007930755615234, -0.01023856084793806, -0.010746553540229797, 0.04106872156262398, -0.027760738506913185, -0.0036811598110944033, -0.028905510902404785, 0.014302504248917103, 0.001908550737425685, 0.0517723448574543, -0.020734695717692375, -0.032883595675230026, -0.0005249856039881706, -0.0184880793094635, 0.023768343031406403, -0.002717046532779932, -0.002958521945402026, 0.02831881493330002, -0.0034665148705244064, -0.007433868013322353, -0.018917368724942207, -0.010446051135659218, 0.10051104426383972, -0.025013284757733345, 0.013429614715278149, -0.025099141523241997, 0.008335376158356667, 0.024383658543229103, -0.010517599061131477, -0.020219547674059868, -0.0447319932281971, 0.009365672245621681, -0.010381657630205154, -0.03766302391886711, 0.023095790296792984, 0.07389508187770844, -0.024269182235002518, -0.020291095599532127, -0.00931558758020401, 0.026315463706851006, 0.00416053319349885, 0.0010624921415001154, 0.04893903434276581, -0.055779051035642624, -0.02162189409136772, -0.08797578513622284, -0.03594586253166199, -0.0018459460698068142, -0.03454351797699928, -0.04942556098103523, -0.03500142693519592, 0.02039126493036747, -0.0269450880587101, -0.08969294279813766, -0.07057523727416992, 0.018201885744929314, -0.06267630308866501, -0.01389467902481556, 0.049826230853796005, -0.006875791121274233, -0.005977860186249018, -0.06559547781944275, 0.015025141648948193, 0.021121056750416756, 0.03617481887340546, 0.009637555107474327, 0.01702849380671978, -0.020906411111354828, 0.04687844216823578, 0.03397113084793091, 0.035402096807956696, 0.0019013959681615233, -0.011354714632034302, 0.052487827837467194, -0.004632751923054457, 0.011233082041144371, -0.013808821327984333, 0.032339829951524734, 0.020906411111354828, 0.031023340299725533, -0.0734371691942215, 0.05034137889742851, -0.017529333010315895, -0.02635839208960533, 0.03849298134446144, -0.014839116483926773, -0.003643597010523081, 0.003945888485759497, 0.0378633588552475, 0.015840793028473854, 0.02847622148692608, 0.0050441548228263855, -0.014331123791635036, -0.04879593849182129, 0.024412278085947037, 0.04796597734093666, 0.013751582242548466, 0.015053761191666126, -0.0010929001728072762, 0.015297025442123413, 0.04435994476079941, -0.03889365494251251, 0.021822230890393257, 0.014710329473018646, -0.055034950375556946, -0.008957846090197563, 0.016012508422136307, -0.002906649373471737, 0.012256222777068615, -0.04270002245903015, -0.01986180618405342, 0.03445765748620033, -0.027903834357857704, -0.017228828743100166, -0.04905351251363754, 0.017300378531217575, -0.027216970920562744, 0.0016518712509423494, 0.05437670275568962, -0.0033073199447244406, -0.04284311830997467, -0.0496545173227787, 0.025571361184120178, -0.038521602749824524, -0.050513096153736115, -0.0033752908930182457, 0.005434093065559864, 0.01924649067223072, -0.04201315715909004, -0.04759392514824867, 0.00852140225470066, -0.05935646593570709, -0.0018531008390709758, 0.02717404253780842, -0.010460360907018185, -0.014338278211653233, -0.011504965834319592, 0.00790608674287796, 0.010395967401564121, -0.00038613719516433775, 0.02069176733493805, 0.011662372387945652, -0.0075912741012871265, -0.014488529413938522, 0.004092562478035688, 0.013708652928471565, 0.008721737191081047, 0.027918145060539246, -0.01986180618405342, -0.003360981121659279, 0.007505415938794613, -0.016627823933959007, -0.012206139042973518, 0.041726965457201004, 0.03282635658979416, -0.037605784833431244, 0.009902284480631351, -0.007283616345375776, -0.0035792035050690174, 0.06485137343406677, -0.005029845051467419, 0.0012145322980359197, -0.016928326338529587, 0.0015749568119645119, 0.020591599866747856, -0.002210842212662101, -0.04284311830997467, 0.00851424690335989, 0.023725414648652077, 0.031338151544332504, -0.008220898918807507, 0.038521602749824524, -0.0005916149821132421, 0.001906762016005814, -0.017586570233106613, -0.002928114030510187, 0.00719775864854455, 0.03130953386425972, -0.04745082929730415, -0.04221349582076073, 0.044474419206380844, 0.00828529242426157, 0.02459830418229103, -0.04513266310095787, -0.019489755854010582, -0.021178295835852623, 0.007641357835382223, -0.026716133579611778, 0.005820453632622957, -0.019518375396728516, 0.025413954630494118, -0.01642748899757862, -0.025771696120500565, -0.01961854286491871, -0.030365096405148506, 0.022351687774062157, -0.03949465975165367, -0.016012508422136307, -0.053117454051971436, -0.04533299803733826, -0.008585795760154724, 0.03588862344622612, 0.0155402896925807, 0.025685837492346764, 0.013787356205284595, -0.02970685251057148, 2.0528212189674377e-05, -0.014402671717107296, -0.031280916184186935, -0.002089210320264101, -0.042814500629901886, -0.02841898240149021, -0.03611757978796959, -0.02833312563598156, -0.008163660764694214, 0.07778730988502502, 0.01473894901573658, -0.067255400121212, -0.006804242730140686, -0.051285818219184875, 0.016012508422136307, -0.007462487090379, 0.0438447967171669, 0.03085162490606308, 0.010424586944282055, 0.08396907895803452, 0.017371926456689835, -0.031280916184186935, 0.0007409720565192401, 0.03674720600247383, -0.010539064183831215, 0.03543071448802948, -0.023925749585032463, 0.051142722368240356, -0.044102370738983154, -0.0057274410501122475, 0.025385335087776184, -0.012871538288891315, -0.027989692986011505, -0.011533585377037525, 0.00789893139153719, -0.031195057556033134, 0.027159733697772026, -0.018531007692217827, 0.016384558752179146, -0.01946113631129265, 0.013164886273443699, 0.05122857913374901, 0.060901910066604614, -0.00463990680873394, 0.007684286683797836, -0.061817727982997894, 0.0008268299861811101, -0.02054866962134838, 0.022652190178632736, 0.014882045798003674, 0.04407374933362007, -0.005716708954423666, 0.03958051651716232, -0.017987241968512535, 0.006950916722416878, -0.0017091098707169294, 0.0528312623500824, -0.013172040693461895, -0.02306717075407505, -0.0561797209084034, -0.021564656868577003, -0.014896354638040066, 0.022537712007761, 0.0021160407923161983, 0.011590823531150818, 0.005544993095099926, -0.022852525115013123, 0.019675781950354576, 0.029420658946037292, 0.03915122523903847, -0.013408150523900986, -0.026601655408740044, -0.023711105808615685, -0.031023340299725533, -0.04627743735909462, 0.027088183909654617, -0.016742300242185593, 0.08288154751062393, -0.010553373955190182, 0.0404963344335556, 0.02129277214407921, 0.035860005766153336, 0.001549020642414689, 0.0191033948212862, -0.025700148195028305, 0.008564330637454987, -0.036003101617097855, -0.005072773899883032, 0.009601781144738197, 0.01688539795577526, 0.0762418657541275, -0.0033663471695035696, -0.02687354013323784, -0.04198453947901726, -0.0011671315878629684, -0.02933480031788349, 0.029420658946037292, -0.013608485460281372, -0.009787806309759617, -0.014710329473018646, -0.0711476281285286, -0.0022716582752764225, 0.03683306276798248, 0.014152253046631813, -0.008843368850648403, -0.017615189775824547, -0.03245430812239647, -0.030794385820627213, -0.005144322291016579, -0.01917494274675846, -0.020749006420373917, -0.00829244777560234, -0.0002479595714248717, -0.01704280450940132, 0.02023385837674141, -0.0646224170923233, -0.011877017095685005, -0.06960218399763107, -0.002015873324126005, 0.019074775278568268, -0.009072324261069298, 0.012435093522071838, 0.031109198927879333, 0.01519685797393322, 0.05763930827379227, 0.0095087680965662, -0.05835479125380516, 0.10308678448200226, -0.020734695717692375, 0.012928777374327183, -0.007390938699245453, 0.018745653331279755, -0.012957395985722542, -0.009401446208357811, -0.01412363350391388, -0.018201885744929314, 0.034944187849760056, 0.045705050230026245, -0.011626597493886948, 0.015254096128046513, 0.02475571073591709, 0.012621119618415833, -0.029535137116909027, 0.05638005584478378, -0.006378530524671078, -0.02054866962134838, 0.013959072530269623, -0.016212843358516693, -0.026286844164133072, 0.002175068249925971, 0.023940060287714005, 0.03603172302246094, 0.0037240886595100164, 0.017758287489414215, -0.03213949501514435, 0.02435503900051117, 0.06399279832839966, -0.004958296660333872, -0.04118319973349571, -0.01687108725309372, -0.00782738346606493, 0.011140069924294949, -0.02230875752866268, 0.029449278488755226, -0.017529333010315895, -0.008199434727430344, -0.04533299803733826, -0.042728640139102936, -0.026315463706851006, 0.017200209200382233, -0.0025936258025467396, 0.035259000957012177, -0.02031971514225006, 0.024712780490517616, -0.0320536345243454, 0.003598879324272275, -0.037233732640743256, -0.015640458092093468, -0.02421194314956665, -0.007512570824474096, -0.03185329958796501, -0.0161985345184803, -0.010481825098395348, 0.026329772546887398, 0.022022565826773643, 0.002505979035049677, 0.006478697992861271, -0.006865059025585651, -0.005752482917159796, -0.004339403938502073, 0.007505415938794613, 0.014173717238008976, -0.005638005677610636, -0.022623570635914803, -0.0077629899606108665, -0.013773046433925629, -0.035316240042448044, -0.023482151329517365, -0.10715072602033615, -0.0052695320919156075, -0.014767568558454514, 0.037147875875234604, -0.0036543291062116623, -0.013651414774358273, 0.005770369898527861, -0.028833962976932526, -0.00890060793608427, -0.024884497746825218, -0.039437420666217804, -0.04003842547535896, 0.0024523178581148386, 0.019947664812207222, 0.03634653240442276, 0.030679909512400627, 0.03588862344622612, -0.01381597574800253, -0.007272884249687195, 0.04132629558444023, 0.0036525405012071133, 0.01625577174127102, 0.010038225911557674, 0.02009076066315174, -0.006897255778312683, 0.0020283942576497793, -0.02123553305864334, -0.016313010826706886, 0.006882946006953716, -0.00333057320676744, 0.00981642585247755, 0.012721287086606026, 0.02001921273767948, 0.02933480031788349, 0.0038958047516644, 0.0435013622045517, -0.039523277431726456, -0.010689315386116505, 0.007262152153998613, 0.00867165345698595, -0.03940879926085472, 0.017529333010315895, 0.003727666102349758, -0.029062917456030846, 0.0056702024303376675, 0.00973772257566452, -0.0461343415081501, 0.005745328031480312, -0.008764666505157948, 0.013923298567533493, 0.046477772295475006, 0.005938508547842503, -0.009451529942452908, -0.022351687774062157, -0.02618667669594288, -0.0280898604542017, -0.028447601944208145, -0.018344983458518982, 0.012091661803424358, -0.029878567904233932, -0.008507092483341694, -0.048366647213697433, 0.027517475187778473, -0.0023449952714145184, -0.024397969245910645, 0.003076576627790928, 0.0044717686250805855, -0.00393157871440053, -0.005652315448969603, 0.0154973603785038, -0.0015579641330987215, -0.019060466438531876, -0.02328181453049183, 0.012113125994801521, -0.033341504633426666, 0.021951016038656235, -0.001595526933670044, -0.023024240508675575, 0.01863117516040802, -0.03460075706243515, -0.022337377071380615, 0.02122122421860695, -0.022466164082288742, 0.016456108540296555, 0.0077486801892519, -0.012227603234350681, -0.021636204794049263, -0.029148776084184647, -0.02100657857954502, -0.0037956370506435633, -0.009730568155646324, 0.03139539062976837, -0.03193916007876396, 0.021264152601361275, 0.007498261518776417, -0.006793510634452105, -0.028390362858772278, 0.026029270142316818, -0.020892102271318436, -0.02116398513317108, -0.007058239076286554, 0.002817214000970125, 0.026243913918733597, -0.030966101214289665, 0.00875035673379898, -0.008457008749246597, -0.0020122958812862635, 0.005859805271029472, 0.02717404253780842, -0.004550471436232328, 0.023253194987773895, -0.02245185524225235, -0.05191544443368912, 0.01847377046942711, -0.008385459892451763, 0.009022239595651627, -0.04636329412460327, 0.013021789491176605, 0.005959973204880953, 0.0022305180318653584, 0.014603006653487682, 0.00877897534519434, -0.030450955033302307, -0.024698471650481224, -0.03213949501514435, 0.05225887522101402, 0.0415552482008934, 0.047765642404556274, -0.0207776241004467, 0.006632526870816946, 0.00867165345698595, 0.00966617465019226, -0.021936707198619843, -0.018359292298555374, -0.00897215586155653, -0.05500632897019386, 0.0031821103766560555, 0.02030540630221367, 0.03276911750435829, 0.004117604345083237, 0.03780611976981163, 0.013279363512992859, -0.0083639957010746, 0.00226271478459239, 0.02162189409136772, 0.018573937937617302, -0.001272665336728096, -0.023925749585032463, -0.03963775560259819, -0.02527085691690445, -0.014245265163481236, -0.009959522634744644, 0.0009605358354747295, -0.03777749836444855, 0.012492332607507706, -0.034171465784311295, -0.024884497746825218, -0.017300378531217575, -0.00767713226377964, -0.00448965560644865, -0.014130787923932076, 0.007179871201515198, -0.01572631485760212, -0.009294123388826847, 0.010102619417011738, 0.011068521067500114, -0.022938383743166924, 0.027989692986011505, -0.036003101617097855, -0.016770919784903526, 0.04086838662624359, -0.019046155735850334, -0.017085732892155647, -0.00353090837597847, -0.00877897534519434, -0.022394616156816483, 0.00719775864854455, -0.008571485988795757, -0.028290195390582085, -0.027660571038722992, 0.04132629558444023, 0.037147875875234604, -0.029420658946037292, -0.02970685251057148, -0.006160308141261339, -0.00843554362654686, -0.0023378406185656786, -0.05826893076300621, -0.00047579617239534855, -0.0024415855295956135, 0.00012487413187045604, -0.03978085145354271, -0.01286438386887312, -0.024154704064130783, -0.013765892013907433, -0.03840712457895279, 0.014781877398490906, 0.00813504122197628, -0.005223025567829609, -0.020877791568636894, 0.021035198122262955, 0.023124409839510918, 0.014302504248917103, 0.023940060287714005, 0.02590048313140869, 0.013851749710738659, -0.0447319932281971, 0.019375277683138847, 0.021779300644993782, -0.036088958382606506, -0.02176499180495739, -0.0392657034099102, 0.013336602598428726, -0.008585795760154724, -0.03980947285890579, -0.010689315386116505, 0.04252830520272255, -0.00013158179353922606, -0.026630274951457977, 0.019046155735850334, 0.04793735593557358, -5.936272646067664e-05, -0.009515923447906971, -0.019961973652243614, 0.014102169312536716, -0.0345148965716362, 0.0084069250151515, -0.008142195641994476, -0.003995972219854593, 0.034314561635255814, 0.013887523673474789, 0.000881832733284682, -0.01523978728801012, 0.004797313362360001, 0.023181647062301636, -0.012821454554796219, 0.014173717238008976, 0.005298151168972254, 0.021178295835852623, 0.0013307982590049505, -0.01755795069038868, 0.06611062586307526, 0.0050477320328354836, -0.022337377071380615, -0.009100942872464657, 0.04146939143538475, 0.00828529242426157, 0.02711680345237255, 0.008693117648363113, 0.013951917178928852, -0.03437180072069168, -0.017815524712204933, -0.0030372252222150564, -0.01103990152478218, -0.01893167942762375, 0.004897480830550194, -0.010360193438827991, -0.031023340299725533, -0.02451244555413723, -0.019961973652243614, 0.030594050884246826, 0.015139618888497353, -0.05592214688658714, -0.039752233773469925, -0.03774888068437576, -0.007376629393547773, -0.042957596480846405, -0.01977594941854477, 0.02106381766498089, 0.023253194987773895, -0.14847701787948608, -0.006689765490591526, 0.02093503065407276, 0.01687108725309372, -0.017672428861260414, 0.002876241458579898, -0.005033422727137804, -0.00214823754504323, 0.011977184563875198, -0.036918919533491135, -0.024083156138658524, 0.020047832280397415, -0.0008277243468910456, -0.019532684236764908, -0.010066845454275608, -0.04561919346451759, 0.03420008346438408, 0.018459459766745567, 0.02757471241056919, -0.026530107483267784, -0.0368044413626194, -0.010539064183831215, -0.03674720600247383, -7.965337863424793e-05, -0.04902489110827446, -0.03794921562075615, -0.005480599589645863, 0.0031141394283622503, 0.00877897534519434, 0.002903072163462639, 1.1375061149010435e-05, 0.013644259423017502, 0.019289420917630196, -0.011576513759791851, -0.00492609990760684, 0.013121956959366798, -0.020062141120433807, -0.008535712026059628, 0.027460236102342606, 0.022967003285884857, -0.040124282240867615, -0.04304345324635506, 0.04166972637176514, -0.010324418544769287, 0.006156730931252241, 0.007104745600372553, 0.01704280450940132, -0.0004433758440427482, 0.02382558211684227, 0.00046551108243875206, -0.018130337819457054, -0.034715231508016586, -0.009265503846108913, 0.010102619417011738, -0.00024840672267600894, -0.002135716611519456, -0.011011282913386822, -0.024197634309530258, 0.022051185369491577, 0.030279237776994705, -0.0064500789158046246, 0.041898682713508606, 0.014495684765279293, -0.014452755451202393, -0.016069747507572174, -0.006027943920344114, 0.01947544515132904, 0.026973707601428032, -0.0006318608648143709, -0.04487508907914162, -0.018588246777653694, 0.0101240836083889, 0.000683286227285862, 0.0009811059571802616, 0.017400545999407768, 0.01641317829489708, -0.011769694276154041, 0.015697695314884186, -0.0484238862991333, 0.010717934928834438, -0.00021307976567186415, -0.008235208690166473, 0.0013021789491176605, -0.02146448940038681, -0.006804242730140686, 0.029907187446951866, 0.0077486801892519, -0.010188477113842964, 0.00742671312764287, 0.026086509227752686, 0.034171465784311295, -0.012642583809792995, 0.0029191705398261547, -0.0083639957010746, 0.0048724389635026455, -0.00031838990980759263, 0.02100657857954502, 0.0275604035705328, 0.04441718012094498, 0.0025972030125558376, 0.03070852905511856, 0.009379981085658073, -0.0270309466868639, -0.030737146735191345, 0.003019338008016348, 0.0010320841101929545, 0.009286968968808651, -0.010209941305220127, -0.006510894745588303, -0.026673205196857452, 0.003525542328134179, -0.01627008244395256, 0.0019103394588455558, 0.06496585160493851, -0.00931558758020401, 0.0015436544781550765, 0.025084832683205605, 0.0012529895175248384, 0.016785230487585068, -0.029535137116909027, -0.012406473979353905, 0.015053761191666126, -0.030450955033302307, -0.003842143341898918, -0.01711435243487358, -0.024169014766812325, 0.030136141926050186, 0.042184874415397644, -0.03085162490606308, -0.019446827471256256, -0.020405573770403862, 0.02658734656870365, 0.011182998307049274, 0.0025489081162959337, -0.012213294394314289, -0.003557739080861211, -0.00037182754022069275, 0.009515923447906971, -0.004006704315543175, 0.03597448393702507, 0.0011778637999668717, 0.0018477346748113632, 0.04023876041173935, 0.005036999937146902, 0.02764626033604145, 0.012227603234350681, 0.00471861008554697, 0.0005853545153513551, 0.010954043827950954, 0.011555049568414688, 0.017901383340358734, -0.005008380860090256, -0.02521361969411373, 0.008077802136540413, -0.02421194314956665, 0.00117428635712713, -0.01931804046034813, -0.042270731180906296, -0.011433417908847332, 0.013873214833438396, 0.030565431341528893, 0.03076576627790928, 0.013307983055710793, 0.006092337425798178, 0.0018727766582742333, -0.00867165345698595, -0.00338781182654202, 0.011089986190199852, -0.035259000957012177, 0.013966226950287819, -0.01061776652932167, -0.031738825142383575, 0.04026738181710243, 0.015411502681672573, 0.044331323355436325, 0.008220898918807507, -0.009830735623836517, 0.027674879878759384, 0.0077629899606108665, 0.011605133302509785, -0.013200660236179829, 0.012463713064789772, 0.0035684711765497923, 0.005244490224868059, 0.00039843458216637373, -0.012993169948458672, 0.004725764971226454, 0.0018745653796941042, 0.01878858171403408, 0.019504064694046974, 0.03855022042989731, 0.0401529036462307, -0.001430071541108191, 0.040124282240867615, 0.01027433481067419, -0.009072324261069298, -0.01027433481067419, -0.0010651752818375826, -0.029649613425135612, -0.010717934928834438, 0.010667851194739342, 0.0009506979840807617, -0.0038206789176911116, -0.03231120854616165, -0.056322816759347916, 0.03268326073884964, -0.008449853397905827, -0.0015821116976439953, -0.004171265754848719, 0.027674879878759384, -0.00882190465927124, 0.015597528778016567, -0.00970194861292839, 0.03992394730448723, -0.024941734969615936, -0.03254016488790512, 0.029263252392411232, -0.009616090916097164, -0.032225351780653, -0.00748395174741745, -0.006067295558750629, -0.02215135283768177, 0.01579786278307438, 0.024154704064130783, -0.01810171827673912, 0.003699046792462468, -0.018802892416715622, 0.010481825098395348, -0.011497811414301395, 0.01627008244395256, -0.0017699259333312511, 0.0006931241368874907, -0.010381657630205154, 0.0155832190066576, -0.015139618888497353, -0.031796060502529144, 0.004021014086902142, -0.02595772221684456, -0.008084957487881184, 0.011118604801595211, 0.03800645470619202, 0.012456557713449001, -0.02887689135968685, -0.018588246777653694, 0.037233732640743256, -0.0011447727447375655, -0.010345883667469025, 0.007662822492420673, -0.0095516974106431, -0.021822230890393257, -0.0018745653796941042, 0.00920111034065485, 0.011948565021157265, -0.016713682562112808, 0.03025061823427677, 0.0034826132468879223, 0.02001921273767948, 0.03912260755896568, 0.005609386134892702, 0.005859805271029472, 0.003300165059044957, 0.00024885390303097665, 0.026744753122329712, -0.0025256548542529345, -0.01984749734401703, -0.01855962723493576, -0.024040227755904198, 0.02352507971227169, 0.024254871532320976, 0.008607259951531887, 0.002534598344936967, 0.014102169312536716, 0.020405573770403862, 0.012456557713449001, -0.0008165449253283441, 0.015697695314884186, -0.0019246491137892008, -0.017472093924880028, 0.009458684362471104, -0.04038185626268387, 0.005974282510578632, -0.05606524273753166, -0.012406473979353905, -0.02290976420044899, 0.006768468767404556, 0.012542416341602802, -0.03053681179881096, 0.0005571823567152023, 0.048452503979206085, -0.0005527105531655252, 0.018588246777653694, 0.031280916184186935, 0.00437517836689949, 0.023811273276805878, 0.02956375479698181, -0.014137943275272846, 0.024498136714100838, 0.02183653973042965, 0.002015873324126005, -0.038063693791627884, -0.0044145300053060055, 0.007526880595833063, -0.0016330898506566882, 0.010717934928834438, 0.006786355748772621, 0.025099141523241997, 0.001393403043039143, -0.027660571038722992, -0.019260801374912262, 0.024941734969615936, -0.00908663310110569, 0.030737146735191345, 0.013751582242548466, 0.010853876359760761, 0.0009283391409553587, 0.012807144783437252, 0.008714582771062851, -0.03070852905511856, 0.010217096656560898, -0.012578190304338932, 0.01627008244395256, 0.03565967082977295, -0.009351362474262714, 0.028748104348778725, -0.005756060127168894, -0.0519440621137619, 0.0007481268839910626, -0.00353090837597847, 0.005019112955778837, 0.027360068634152412, 0.05231611430644989, 0.014896354638040066, 0.008070647716522217, 0.02047712169587612, -0.03070852905511856, 0.027932453900575638, -0.016527656465768814, 0.008356841281056404, -0.011934255249798298, 0.030050283297896385, 0.04041047766804695, 0.048824556171894073, 0.003300165059044957, 0.01702849380671978, -0.01393045298755169, 0.00912956241518259, -0.023153027519583702, -0.02429780177772045, -0.012535260990262032, -0.008070647716522217, 0.06759882718324661, -0.011326095089316368, 0.014195181429386139, -0.007777299731969833, -0.031137818470597267, 0.017844144254922867, 0.024626923725008965, -0.01961854286491871, -0.011082830838859081, -0.004747229162603617, 0.004797313362360001, 0.023997297510504723, 0.009515923447906971, 0.005477021913975477, 0.04550471529364586, 0.010768018662929535, -0.015225477516651154, 0.05454842001199722, 0.01531133521348238, 0.03291221708059311, 0.05223025381565094, 0.025084832683205605, -0.011004127562046051, -0.00761989364400506, -0.029148776084184647, -0.0132078155875206, -0.009294123388826847, 0.00734800985082984, 0.014102169312536716, 0.03070852905511856, -0.039523277431726456, -0.03382803499698639, -0.006317714229226112, 0.02185084857046604, -0.01711435243487358, 0.022780977189540863, 0.002164335921406746, 0.04925384745001793, -0.016813850030303, 9.097253496292979e-06, -0.004997648298740387, -0.0005813299212604761, -0.007208490744233131, -0.005927776452153921, -0.00897215586155653, 0.015712006017565727, -0.00759842898696661, 0.00870742741972208, 0.010746553540229797, 0.014309658668935299, 0.006829284597188234, 0.011297475546598434, 0.0038600305560976267, 0.009294123388826847, 0.0063928402960300446, -0.009494458325207233, 0.009480149485170841, 0.04407374933362007, 0.017987241968512535, -0.004793735686689615, -0.0311664380133152, -0.02421194314956665, -0.01366572454571724, 0.03199639916419983, 0.031567107886075974, -0.01635594107210636, -0.0034039102029055357, 0.011404798366129398, -0.016785230487585068, 0.028046932071447372, -0.008764666505157948, 0.0068471720442175865, -0.009659020230174065, 0.005505641456693411, 0.00435371370986104, 0.01886013150215149, -0.04564781114459038, -0.0007177188526839018, 0.025142071768641472, -0.018616866320371628, -0.02597203105688095, -0.010109773837029934, -0.0031195057090371847, -0.019518375396728516, 0.017887074500322342, 0.02429780177772045, 0.029678232967853546, -0.00740524847060442, -0.03274049982428551, 0.010181322693824768, -0.003670427482575178, 0.020562980324029922, 0.014002000913023949, 0.006636104546487331, 0.007340854965150356, -0.043272409588098526, -0.013758737593889236, -0.028061240911483765, -0.0009721624664962292, -0.00021006132010370493, -0.027388688176870346, -0.004307207185775042, -0.003856453113257885, 0.019675781950354576, -0.00637495331466198, -0.00817797053605318, -0.031280916184186935, 0.021435869857668877, 0.009000775404274464, 0.01970439963042736, -0.03749130666255951, -0.005459134932607412, -0.002471993677318096, 0.0018280589720234275, 0.013794511556625366, 0.022323068231344223, 0.007033197209239006, 0.02129277214407921, -0.013680034317076206, 0.012356390245258808, 0.00511928042396903, 0.01038881205022335, 0.03039371594786644, -0.020062141120433807, -0.013658569194376469, 0.00920111034065485, -0.023725414648652077, -0.019217871129512787, -0.024612613022327423, -0.026229605078697205, 0.017672428861260414, 0.0041891527362167835, 0.0299358069896698, -0.005008380860090256, -0.006482275668531656, 0.019275110214948654, 0.0022519826889038086, 0.001573168090544641, -0.022394616156816483, 1.805476495064795e-05, 0.011089986190199852, -0.005820453632622957, 0.0007767461938783526, 0.03857884183526039, 0.010367347858846188, 0.03895089030265808, 0.01931804046034813, -0.014409827068448067, 0.02047712169587612, 0.0051049706526100636, -0.013794511556625366, 0.01000960636883974, -0.010073999874293804, 0.02268080972135067, 0.0008348791743628681, -0.012842918746173382, -0.022036874666810036, -0.035087283700704575, 0.025771696120500565, -0.01908908598124981, 0.027531784027814865, 0.012263378128409386, 0.0003664614341687411, 0.0161126758903265, 0.01771535724401474, -0.010152703151106834, -0.03457213565707207, 0.00780591880902648, -0.02122122421860695, 0.0033788683358579874, 0.009179646149277687, -0.010116929188370705, -0.002361093647778034, -0.013365221209824085, -0.005344657693058252, 0.013043254613876343, 0.0036775823682546616, 0.02259495109319687, -0.03720511496067047, -0.030508192256093025, -0.05045585706830025, 0.0029406349640339613, 0.0401529036462307, 0.01778690703213215, -0.026086509227752686, -0.022022565826773643, 0.0061853500083088875, 0.022280139848589897, 0.004539739340543747, -0.01801586151123047, -0.012213294394314289, -0.0155832190066576, 0.011197308078408241, -0.025485502555966377, -0.013715808279812336, 0.0020087184384465218, -0.013658569194376469, 0.05434808507561684, 0.048080455511808395, -0.005144322291016579, -0.005523528438061476, -0.029993046075105667, -0.014381207525730133, -0.011383334174752235, -0.029993046075105667, 0.02009076066315174, 0.0022537712939083576, -0.0028279463294893503, -0.04381617531180382, -0.0023253196850419044, -0.011669526807963848, 0.0023449952714145184, -0.0334559828042984, -0.0310805793851614, 0.0202481672167778, 0.017987241968512535, -0.03772026300430298, -0.013987692072987556, -0.03282635658979416, -0.04092562571167946, 0.0013531571021303535, -0.01408785954117775, 0.027388688176870346, 0.006439346354454756, -0.004325094632804394, 0.02092072181403637, 0.010903960093855858, 0.009465839713811874, 0.0036346532870084047, -0.023310434073209763, -0.02031971514225006, -0.03122367523610592, 0.006153153255581856, 0.002792172133922577, 0.028576388955116272, -0.009945212863385677, 0.02542826347053051, -0.004400220233947039, -0.018802892416715622, 0.02276666834950447, -0.006342756561934948, -0.007022465113550425, 0.005580767057836056, 0.006521627306938171, -0.019217871129512787, 0.0392657034099102, 0.02398298867046833, 0.020791934803128242, -0.04298621416091919, 0.024197634309530258, -0.027088183909654617, 0.0023789808619767427, 0.004024591762572527, -0.02535671554505825, 0.009172491729259491, -0.030136141926050186, 0.004825932439416647, -0.032196734100580215, 0.025986339896917343, 0.006396417506039143, 0.007877467200160027, 0.02572876773774624, 0.0012833975488319993, -0.016012508422136307, -0.022695118561387062, 0.027617642655968666, -0.010224251076579094, -0.014230956323444843, 0.007741525303572416, 0.0034933455754071474, 0.009422910399734974, 0.01818757690489292, -0.00038099466473795474, -0.008993620984256268, 0.011054211296141148, 0.028447601944208145, -0.027989692986011505, -0.011512120254337788, 0.025700148195028305, -0.017085732892155647, 0.0505417138338089, 0.013951917178928852, 0.0031964201480150223, -0.01778690703213215, -0.009601781144738197, -0.010524754412472248, -0.018430840224027634, -0.004071097820997238, 0.009422910399734974, -0.010403121821582317, 0.020505741238594055, 0.00097573985112831, 0.006825707387179136, -0.024841567501425743, 0.007094013504683971, -0.011848397552967072, -0.01535426452755928, -0.03136677294969559, 0.011433417908847332, 0.02283821627497673, -0.013651414774358273, 0.006103069521486759, -0.01462447177618742, 0.030422335490584373, 0.03511590138077736, 0.02581462450325489, -0.01750071346759796, 0.015940960496664047, -0.0033806569408625364, -0.016828158870339394, 0.0071548293344676495, 0.010481825098395348, -0.007562654558569193, -0.0002557851548772305, 0.014459910802543163, -0.00882190465927124, -0.030679909512400627, 0.010796637274324894, 0.0178727637976408, 0.05446256324648857, 0.022494783625006676, 0.00855002086609602, -0.019532684236764908, 0.018974607810378075, 0.042957596480846405, -0.02664458565413952, 0.040811147540807724, 0.002049858681857586, 0.03291221708059311, -0.01485342625528574, 0.025328096002340317, 0.02093503065407276, 0.01772966794669628, -0.024941734969615936, 0.0029942961409687996, 0.0275604035705328, 0.026744753122329712, 0.0017752920975908637, 0.04424546658992767, -0.04284311830997467, -0.014667400158941746, -0.006196082569658756, -0.019360968843102455, -0.025929102674126625, -0.01917494274675846, 0.020262477919459343, -0.00809926725924015, 0.010853876359760761, -0.0412118174135685, -0.0006600330234505236, 0.062046680599451065, 0.040524955838918686, -0.033885274082422256, -0.005065619479864836, -0.005705976393073797, -0.011490656062960625, 0.031509868800640106, -0.03282635658979416, -0.0044681909494102, -0.01741485483944416, -0.024426588788628578, 0.016756610944867134, 0.00327333458699286, -0.012656893581151962, 0.006399995181709528, 0.013064718805253506, 0.01878858171403408, -0.05031276121735573, 0.004114027135074139, -0.010939734056591988, 0.005609386134892702, 0.017371926456689835, 0.012957395985722542, 0.026329772546887398, -0.005777524784207344, -0.007491106633096933, -0.00013918378681410104, -0.00022392380924429744, 0.01515392865985632, 0.023553699254989624, 0.027531784027814865, -0.043873414397239685, 0.015139618888497353, -0.012821454554796219, 0.0061638858169317245, 0.016999874264001846, -0.03777749836444855, -0.0004820566391572356, 0.019532684236764908]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" bEE) represent the time
for one forward (resp. backward) pass of one microbatch
for one early-exit layer. Moreover, memory usage by model
parameters for each middle stage will not exceed that of the
first or last stage. Deferring forward computation of early
exits to backward steps, as shown in Figure 3(c), further
decreases the memory overhead by early-exit logits in Stage
i∈[P]from s×b×V×(P−i+ 1) tos×b×V,
where sis the sequence length, bis the microbatch size,
Vis the vocabulary size, and P−i+ 1is the number of
in-flight microbatches (Korthikanti et al., 2022) for Stage
i. Putting these together, the peak memory usage across
stages remains unchanged, as long as s×b×Vis less than
the activation memory of allbackbone Transformer layers
within one stage for one microbatch.
Due to limited space, we defer detailed and formal analysis
of training efficiency in broader settings to Appendix A.
3.3. Advanced features
EE-LLM incorporates some advanced features that can po-
tentially improve the training process. One of them is the
option of changing early-exit loss weights during training,
just like learning rate or other hyperparameters. Another
one is a novel method of improving resource utilization
by filling explicit bubbles with partial forward and back-
ward computation for additional microbatches , which is
visualized in Figure 4. One can prove formally that such
5
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
Stage 1123415263456Stage 2123142536456Stage 3121324354656Stage 4112233445566Forward step1Backward step1(a) The original 1F1B pipeline scheduleStage 11234P1P2P2P115263P34P456Stage 2123P1P11425364P35P46Stage 312132435465P36P4P3Stage 4112233445566P3P3P4P4Partial forwardP1Partial backwardP1(b) Filling explicit bubbles with additional microbatches
Figure 4: The proposed method of filling bubbles with
additional microbatches. In this example, P1 and P2 go
through the forward and backward passes for the first few
stages, while P3 and P4 go through the full forward pass,
followed by the backward pass for the last few stages.
additional computation provides useful gradient informa-
tion for optimizing the early-exit training objective, without
increasing the training time per iteration. More details of
both features can be found in Appendix C.
4. Inference
This section first explains the major challenge faced by
early-exit LLM inference for autoregressive generation, and
a few recent attempts to resolve it. Then, we introduce a
novel solution based on a new type of pipeline parallelism.
Throughout this section, we focus on the latency-oriented
setting, with a batch size of 1 during sequence generation.
Main challenge: KV caching. Accelerating inference
with early exiting is, in principle, orthogonal to and compat-
ible with many other common techniques of acceleration,
such as kernel fusion, FlashAttention (Dao et al., 2022),
quantization (Yao et al., 2022; Xiao et al., 2023), among
others (Kim et al., 2023a). For autoregressive generation,
one exception is KV caching, i.e. saving keys and values of
all attention layers for previously generated tokens, which
reduces redundant computation at the cost of higher memory
usage. This is contradictory to vanilla early-exit inference:
if the current token is generated via early exiting, then its
KV caches in later layers are missing, which hinders the
generation of future tokens that go beyond the exiting layer
of the current token. This challenge has been well recog-
nized in the literature, and several approaches have been
recently proposed to resolve it, including state propaga-
tion (Elbayad et al., 2020; Li et al., 2021; Schuster et al.,
2022), SkipDecode (Corro et al., 2023), and synchronized
parallel decoding (Bae et al., 2023; Tang et al., 2023). See
Appendix F for more discussion on these methods.
A variant of the last method, which we call KV recompu-
tation , is implemented in EE-LLM . In this approach, we
maintain a list of the most recent tokens that have","[0.029972249642014503, 0.011795049533247948, 0.061047956347465515, -0.017565825954079628, -0.02499178610742092, 0.012108192779123783, 0.035757940262556076, 0.037219271063804626, -0.012771757319569588, 0.07133693993091583, 0.035131651908159256, -0.028018835932016373, -0.04372071474790573, 0.014680437743663788, -0.03733856603503227, -0.04744860902428627, 0.00010647791350493208, -0.0033830618485808372, 0.00578196020796895, 0.0254838690161705, 0.0224568210542202, -0.039694592356681824, 0.03182128444314003, 0.037428032606840134, 0.04855206236243248, -0.03170199319720268, 0.015582587569952011, 0.03083712048828602, 0.026199623942375183, -0.06262858211994171, 0.03080729767680168, -0.037875380367040634, -0.04097698628902435, -0.042855843901634216, -0.006963701918721199, 0.022784875705838203, 0.0286302100867033, 0.018430696800351143, -0.04398912563920021, 0.015433472581207752, 0.027392549440264702, -0.05198172479867935, -0.05069933086633682, 0.022292792797088623, -0.00542408274486661, 0.05055021494626999, 0.018132466822862625, 0.0021882725413888693, -0.008044790476560593, 0.06913002580404282, 0.011146396398544312, 0.030255571007728577, -0.045331165194511414, 0.011847239919006824, -0.03238792344927788, -0.01605975814163685, 0.020354289561510086, -0.01944468356668949, 0.024976875633001328, -0.016343077644705772, 0.036145638674497604, -0.06173389032483101, 0.01749126799404621, -0.019370125606656075, -0.021248983219265938, 0.03000207431614399, -0.04321372136473656, 0.0550236850976944, 0.0055060964077711105, 0.038233257830142975, -0.024484794586896896, 0.008365388959646225, 0.012950696051120758, -0.03709997981786728, -0.013644084334373474, 0.010855620726943016, 0.028555652126669884, 0.04184185713529587, 0.004999103024601936, -0.007302940357476473, 0.025573337450623512, -0.009908736683428288, 0.023455895483493805, -0.02703467197716236, 0.014083974994719028, -0.04216991364955902, 6.52963572065346e-05, -0.010162233375012875, -0.04721002280712128, -0.02898808754980564, -0.00945393368601799, 0.008387756533920765, -0.03856131434440613, -0.003349510719999671, 0.05034145340323448, 0.06137601286172867, 0.027004849165678024, -0.06734063476324081, 0.03769644349813461, 0.0424383208155632, 0.009625417180359364, -0.003509810194373131, 0.030598536133766174, -0.04542063549160957, 0.03316332772374153, -0.03766661882400513, -0.03438607603311539, 0.02919684909284115, -0.018833309412002563, -0.032686155289411545, -0.04002264514565468, -0.01983238384127617, -0.019056983292102814, -0.014620792120695114, 0.011847239919006824, -0.06250929087400436, -0.050222158432006836, 0.023485718294978142, 0.02072707936167717, 0.03516147658228874, -0.015537853352725506, 0.0055881100706756115, -0.012555539608001709, -0.019340302795171738, 0.005263783503323793, -0.005945987533777952, 0.045599572360515594, -0.028063569217920303, 0.004283347632735968, -0.03563864529132843, 0.015746615827083588, 0.01668604463338852, 0.06274787336587906, -0.02086128294467926, -0.03283527120947838, -0.020533228293061256, -0.01178759429603815, 0.015642235055565834, -0.033133503049612045, 0.0016728914342820644, 0.034594837576150894, -0.017282506451010704, 0.005386803764849901, 0.003966476768255234, -0.03680174797773361, 0.06382150948047638, -0.01686498336493969, 0.029002998024225235, -0.009699974209070206, 0.021248983219265938, -0.00867853220552206, -0.014531322754919529, -0.016447458416223526, -0.031761638820171356, -0.007440872024744749, -0.012652465142309666, -0.05463598296046257, 0.030076632276177406, 0.05943750590085983, -0.015299268066883087, -0.013055076822638512, 0.013412955217063427, 0.053950052708387375, 0.0037073884159326553, 0.006795946974307299, 0.03847184404730797, -0.06811603903770447, 0.00480525242164731, -0.08159609884023666, -0.04246814548969269, -0.014389663003385067, -0.043780360370874405, -0.04712055251002312, -0.03191075474023819, 0.0019180004019290209, -0.037487681955099106, -0.07980670779943466, -0.04882047325372696, 0.009603049606084824, -0.07443854212760925, -0.03590705618262291, 0.04246814548969269, 0.002231143182143569, 0.002410082146525383, -0.047239843755960464, 0.01562732271850109, 0.0037353476509451866, 0.015157608315348625, -0.009886369109153748, 0.022650670260190964, -0.022799786180257797, 0.044317178428173065, 0.058602459728717804, 0.009066233411431313, 0.029256494715809822, -0.0055060964077711105, 0.05597802251577377, 0.002730680862441659, 0.011519186198711395, -0.029838046059012413, 0.02530493028461933, 0.024261120706796646, 0.0035675924737006426, -0.06519336998462677, 0.0642390325665474, -0.00013595155905932188, -0.014777363277971745, 0.042229559272527695, -0.01065431535243988, -0.031016061082482338, 0.01198144443333149, 0.01659657433629036, 0.0348035991191864, 0.0062889535911381245, 0.0106095802038908, 0.01274193450808525, -0.03736838698387146, 0.021323541179299355, 0.04163309559226036, 0.005237687844783068, 0.011258233338594437, -0.007918042130768299, -0.008894749917089939, 0.025096168741583824, -0.05672360211610794, 0.019385037943720818, 0.01216038316488266, -0.06453726440668106, 0.008574151434004307, 0.010139865800738335, 0.025021610781550407, -0.006318776868283749, -0.012369144707918167, -0.031135352328419685, 0.03438607603311539, -0.010691593401134014, -0.009588138200342655, -0.04038052633404732, 0.010467920452356339, -0.013099811971187592, 0.012466070242226124, 0.03790520504117012, -0.002488367725163698, -0.009185525588691235, -0.05493421480059624, 0.04407859221100807, -0.03617546334862709, -0.061495304107666016, 0.02649785578250885, 0.003988844342529774, 0.004354177508503199, -0.03537023812532425, -0.021860357373952866, 0.009804355911910534, -0.03542988374829292, 0.012264763936400414, -0.0041826944798231125, 0.0020410208962857723, -0.014344927854835987, 0.005192953161895275, 0.013390587642788887, 0.004700871650129557, 0.015463295392692089, 0.00967760756611824, 0.011720491573214531, -0.012331866659224033, -0.020473582670092583, 0.020339377224445343, 0.005237687844783068, -0.0216665081679821, 0.007418504916131496, -0.03900866210460663, 0.00628149788826704, 0.007977688685059547, -0.0395156554877758, -0.0044361911714077, 0.043780360370874405, 0.019429773092269897, -0.02889861725270748, 0.03647369518876076, -0.005245144013315439, 0.004067129921168089, 0.07127729058265686, -0.008566695265471935, 0.006628191564232111, 0.012600274756550789, -0.009990749880671501, 0.0032302183099091053, -0.01632816717028618, -0.042587436735630035, 0.010378451086580753, -0.024335678666830063, 0.03474395349621773, -0.027854807674884796, 0.03208969160914421, 0.0031426127534359694, -0.0047418782487511635, -0.014956302009522915, 0.021547215059399605, 0.0038993749767541885, 0.047239843755960464, -0.036235108971595764, -0.014717716723680496, 0.02090601809322834, -0.019191186875104904, 0.03918759897351265, -0.02964419685304165, 0.010341172106564045, -0.02135336399078369, 0.015522941946983337, -0.01890786737203598, -0.003944109659641981, -0.030568713322281837, 0.008618885651230812, -0.026825910434126854, -0.018743840977549553, 0.015284356661140919, -0.060958486050367355, 0.027392549440264702, -0.058781400322914124, -0.0068779606372118, -0.06119707226753235, -0.02236735075712204, -0.024887405335903168, 0.02090601809322834, -0.005662667565047741, 0.006751212291419506, 0.011884518899023533, -0.015314179472625256, -0.017864057794213295, -0.004820164293050766, -0.002542422153055668, 0.009640328586101532, -0.03173181414604187, -0.021591950207948685, -0.04542063549160957, -0.04667320474982262, -0.020935840904712677, 0.07616828382015228, 0.002646803157404065, -0.08171539008617401, 0.02445496991276741, -0.008745633997023106, 0.011258233338594437, -0.0017073744675144553, 0.025603162124753, 0.01178759429603815, 0.002577837323769927, 0.07533323764801025, 0.011034559458494186, -0.02041393518447876, -0.005923619959503412, 0.022650670260190964, -0.026736440137028694, 0.04846259579062462, -0.018714016303420067, 0.027288168668746948, -0.03372996672987938, 0.00589006906375289, 0.020205173641443253, -0.012995431199669838, -0.00883510336279869, 0.033968549221754074, 0.02973366528749466, -0.02059287391602993, 0.01796843856573105, -0.033968549221754074, -0.0032768170349299908, 0.01623869687318802, -0.0008094185031950474, 0.02250155434012413, 0.03298438712954521, -0.007041987497359514, 0.007012164685875177, -0.05970591679215431, 0.008044790476560593, 0.0005908708553761244, 0.0339089035987854, 0.009483756497502327, 0.06074972450733185, 0.005990722216665745, 0.03572811558842659, -0.0321195162832737, -0.011526641435921192, 0.007940409705042839, 0.03328261896967888, -0.016268519684672356, -0.020935840904712677, -0.04700126126408577, -0.007575076073408127, -0.03027048148214817, 0.02351554110646248, -0.011124029755592346, 0.014233090914785862, 0.01178759429603815, -0.0035526808351278305, -0.005084844306111336, 0.03205987066030502, 0.043959300965070724, 0.004842531401664019, -0.0188631322234869, -0.013509879820048809, -0.023664657026529312, -0.022740140557289124, 0.021994562819600105, 0.006516355089843273, 0.058691930025815964, 0.0006085783243179321, 0.07157552242279053, 0.007530341390520334, 0.05520262196660042, 0.004018667619675398, 0.032686155289411545, -0.03993317857384682, 0.02955472655594349, -0.015209798701107502, 0.014516410417854786, 0.0066729262471199036, 0.0258268341422081, 0.07867342978715897, -0.024440059438347816, -0.026065420359373093, -0.045599572360515594, -0.019817473366856575, -0.009550859220325947, 0.006162205245345831, 0.00883510336279869, -0.022874344140291214, -0.003925470169633627, -0.07205269485712051, -0.025856658816337585, 0.024663733318448067, 0.004480925854295492, -0.016492193564772606, -0.03644387051463127, -0.011489362455904484, -0.034028198570013046, 0.019906941801309586, -0.01877366378903389, -0.061137426644563675, -0.010676681995391846, 0.010915267281234264, -0.02631891705095768, 0.024976875633001328, -0.04419788718223572, -0.011877063661813736, -0.06173389032483101, -0.016760602593421936, 0.02454444020986557, -0.019146451726555824, 0.014039240777492523, 0.019892031326889992, 0.033401910215616226, 0.03417731076478958, 0.008589062839746475, -0.04700126126408577, 0.11314897239208221, -0.02090601809322834, 0.025334753096103668, -0.005759593099355698, 0.01258536335080862, -0.018520167097449303, -0.027094317600131035, -0.009267538785934448, 0.0030680550262331963, 0.008864927105605602, 0.04932746663689613, -0.0029860413633286953, 0.02836180105805397, 0.014054152183234692, 0.025662807747721672, -0.02232261560857296, 0.022173501551151276, -0.0007334627443924546, -0.021055134013295174, 0.021010398864746094, 0.004969279747456312, -0.0581551119685173, -0.00684440927579999, -0.019742915406823158, 0.0071836477145552635, -0.009304817765951157, 0.027929365634918213, -0.02542422153055668, 0.013144547119736671, 0.08773966133594513, -0.00034855789272114635, -0.04157344996929169, -0.0015480071306228638, 0.009796899743378162, 6.477212446043268e-05, -0.012167839333415031, 0.027675868943333626, -0.018654370680451393, -0.014956302009522915, -0.017864057794213295, -0.02333660237491131, -0.0286302100867033, 0.05138526111841202, -0.005763320717960596, 0.029882781207561493, -0.00961050484329462, 0.02063760906457901, 0.009058777242898941, 0.0011043879203498363, -0.0036440142430365086, 0.007694368716329336, 0.007739103399217129, 0.0027418644167482853, -0.015701880678534508, -0.01798335090279579, -0.0029208033811300993, -0.008305743336677551, 0.009379375725984573, 0.005722314119338989, 0.026169801130890846, -0.005073660984635353, 0.00809698086231947, -0.005517279729247093, 0.012771757319569588, 0.014434397220611572, -0.005845334380865097, -0.013741008937358856, -0.006851865444332361, -0.01805790886282921, -0.032507218420505524, -0.033222973346710205, -0.09931103885173798, -0.034952715039253235, -0.014658071100711823, 0.03355102613568306, -0.018296493217349052, -0.0077912937849760056, -0.013032710179686546, -0.03456501290202141, -0.0112284105271101, -0.03110552951693535, -0.014165989123284817, -0.04363124445080757, -0.01277921348810196, 0.026930291205644608, 0.04246814548969269, 0.028287243098020554, 0.04079804942011833, -0.016715867444872856, 0.0010186464060097933, 0.023679569363594055, -0.006576001178473234, 0.0008923641289584339, 0.03775608912110329, 0.009744709357619286, -0.021845446899533272, 0.011213499121367931, -0.049595873802900314, -0.01749126799404621, 0.005703674629330635, -0.011019648052752018, 0.005998177919536829, -0.014576056972146034, 0.008469770662486553, 0.025140902027487755, 0.01000566128641367, 0.03289491683244705, -0.03152305260300636, -0.016000112518668175, 0.012279675342142582, 0.004678504075855017, -0.045778512954711914, 0.016656219959259033, 0.016924628987908363, -0.034028198570013046, -0.00770182441920042, 0.013658995740115643, -0.020309554412961006, 0.011452083475887775, -0.013658995740115643, 0.0011146396864205599, 0.04097698628902435, -0.00367197347804904, 0.006143565755337477, -0.02921176142990589, -0.011869607493281364, -0.02800392359495163, -0.02187526971101761, -0.02534966543316841, -0.001914272434078157, -0.047418784350156784, 0.00657972926273942, -0.0444662943482399, 0.012846315279603004, 0.011996355839073658, -0.030509067699313164, 0.0006971157854422927, -0.016343077644705772, -0.02321731112897396, 0.0026002046652138233, 0.012451158836483955, -0.001280530821532011, -0.022874344140291214, -0.02303837239742279, 0.005711130332201719, -0.010885444469749928, -0.0026691704988479614, -0.01120604295283556, 0.0033047760371118784, 0.04410841688513756, -0.04825383052229881, 0.011519186198711395, 0.029838046059012413, -0.02667679451406002, 0.01775967702269554, -0.003858368145301938, -0.02023499645292759, -0.018445609137415886, -0.04002264514565468, -0.02330677956342697, -0.026244359090924263, -0.022039296105504036, 0.039694592356681824, -0.024663733318448067, 0.05329394340515137, -0.0069077834486961365, 0.003232082352042198, -0.018266670405864716, 0.022262969985604286, -0.01389012485742569, -0.024484794586896896, -0.01935521513223648, -3.1075473089003935e-05, -0.0011826737318187952, -0.03271597996354103, -0.0025498780887573957, -0.0041118646040558815, -0.0034240686800330877, 0.0024641365744173527, 0.0174017995595932, 0.0030624631326645613, 0.014807186089456081, -0.004559211898595095, -0.031314291059970856, 0.01699918694794178, -0.0016654357314109802, 0.020354289561510086, 0.007612355053424835, -0.0014054152416065335, 0.0015088642248883843, 0.011496818624436855, 0.024201473221182823, 0.005655211862176657, -0.014956302009522915, -0.0334615558385849, -0.028794236481189728, 0.05090809240937233, 0.02001132257282734, 0.04029105603694916, -0.025975950062274933, 0.021204248070716858, -0.0001198750251205638, 0.02613997831940651, -0.0193104799836874, -0.01717812567949295, -0.02126389555633068, -0.04261726140975952, -0.0197578277438879, 0.014098887331783772, 0.046762675046920776, 0.012093281373381615, 0.021547215059399605, 0.013763376511633396, -0.015463295392692089, -0.020175350829958916, 0.010482831858098507, 0.013658995740115643, -0.004201333969831467, -0.025841746479272842, -0.042676907032728195, -0.018982425332069397, -0.016715867444872856, -0.03040468506515026, -0.007530341390520334, -0.030777474865317345, 0.01664130948483944, -0.040768224745988846, -0.02742237225174904, -0.013949771411716938, -0.008022422902286053, 0.009953470900654793, -0.03089676797389984, 0.008469770662486553, -0.01699918694794178, -0.006460436619818211, 0.005133307073265314, 0.023664657026529312, -0.029584549367427826, 0.011623566970229149, 0.00231315684504807, 0.010766151361167431, 0.03602634742856026, -0.017550915479660034, -0.04052963852882385, 0.009401743300259113, 0.007146368734538555, -0.03361067175865173, 0.02005605772137642, -0.008969307877123356, -0.036592986434698105, -0.02919684909284115, 0.04911870136857033, 0.047866132110357285, -0.01939994841814041, -0.03501236066222191, 0.0043877288699150085, 0.010042940266430378, 0.0025256467051804066, -0.05952697619795799, 0.00011381720105418935, 0.007571348454803228, 0.003996300045400858, -0.027317991480231285, -0.03370014205574989, -0.04184185713529587, 0.0007055035093799233, -0.05192207917571068, -0.005595565773546696, -0.00753406947478652, -0.0014324424555525184, -0.0363842248916626, 0.030598536133766174, 0.015329090878367424, 0.01895260252058506, 0.03158269822597504, 0.02618471160531044, 0.021949827671051025, -0.04762754589319229, 0.021368276327848434, 0.0377262644469738, -0.048671357333660126, -0.0169544517993927, -0.027989011257886887, -0.01767020672559738, -0.010572301223874092, -0.036235108971595764, -0.018490344285964966, 0.048045068979263306, 0.01850525476038456, -0.006699021439999342, 0.021815622225403786, 0.03378961235284805, 0.0043355380184948444, -0.030255571007728577, -0.023426072672009468, 0.015612411312758923, -0.006449252832680941, 0.01276430208235979, 0.01598520018160343, -0.020354289561510086, 0.038770075887441635, 0.0032432659063488245, 0.012697199359536171, -0.02236735075712204, 0.00221809558570385, -0.0021677690092474222, -0.009014042094349861, 0.029495080932974815, 0.009394287131726742, -0.002738136565312743, -0.0005619797157123685, -0.028570562601089478, 0.042945314198732376, 0.01632816717028618, -0.03161252290010452, -0.0050177425146102905, 0.03990335389971733, 0.006665470544248819, 0.02716887556016445, 0.004238612949848175, 0.03155287727713585, -0.01792370341718197, -0.010624491609632969, 0.03000207431614399, -0.010184600949287415, -0.01619396172463894, -0.00041123307892121375, -0.023769037798047066, -0.014344927854835987, -0.012257308699190617, -0.023933066055178642, 0.022173501551151276, -0.010922723449766636, -0.07437890022993088, -0.00945393368601799, -0.023053282871842384, 0.0075899879448115826, -0.04470488056540489, -0.007686913013458252, 0.03367031738162041, 0.004227429162710905, -0.11380508542060852, 0.000903547799680382, 0.03378961235284805, 0.004995374940335751, -0.010296436958014965, 0.0029245312325656414, -0.004503293428570032, -0.0003420340653974563, 0.014389663003385067, -0.03891919180750847, -0.03384925797581673, 0.002965538064017892, 0.013345852494239807, -0.040201585739851, 0.004074585624039173, -0.04807489365339279, 0.006915239617228508, 0.007630994543433189, 0.016134316101670265, -0.021994562819600105, -0.024156739935278893, 0.0003557806776370853, -0.020518315955996513, -0.004104408901184797, -0.034415896981954575, -0.03364049643278122, -0.01580626145005226, 0.0064306133426725864, -0.01373355370014906, 0.00827591959387064, -0.00984909012913704, -0.005122123286128044, 0.013234016485512257, 0.00312956515699625, -0.00579314399510622, 0.010758696123957634, -0.024201473221182823, -0.010699049569666386, 0.02330677956342697, -0.007403593044728041, -0.016522016376256943, -0.04428735375404358, 0.04634515196084976, -0.00481643620878458, 0.014255458489060402, 0.026393475010991096, 0.01646237075328827, 0.0033327352721244097, 0.021114779636263847, -0.004965552128851414, -0.02014552801847458, -0.02019026316702366, -0.0009012178634293377, 0.021278806030750275, 0.004443646874278784, 0.016984274610877037, -0.013852845877408981, -0.01154155284166336, 0.01120604295283556, 0.042229559272527695, -0.003985116258263588, 0.01427036989480257, 0.012645008973777294, -0.012302042916417122, -0.013681363314390182, -0.013644084334373474, 0.030986236408352852, 0.028525829315185547, 0.011012192815542221, -0.03736838698387146, -0.01022933516651392, 0.003966476768255234, -0.006669198628515005, 0.006121198646724224, 0.008439946919679642, 0.030031897127628326, 0.010117498226463795, 0.034326426684856415, -0.0473889596760273, 0.022531379014253616, 0.026646971702575684, -0.017908792942762375, -0.003699932713061571, -0.01231695432215929, -0.011056927032768726, 0.038949012756347656, 0.018967512995004654, -0.0066729262471199036, -0.0055657424964010715, 0.03489306941628456, 0.030330128967761993, -0.02769078128039837, 0.004003755748271942, -0.004439919255673885, 0.006415701936930418, 0.010892899706959724, 0.028481094166636467, 0.028481094166636467, 0.06459691375494003, -0.0030829666648060083, 0.041126102209091187, 0.037785910069942474, -0.0348035991191864, -0.035578999668359756, 0.0021193064749240875, -0.006713933311402798, 0.011302968487143517, 0.0005675715510733426, 0.004104408901184797, -0.0224568210542202, 0.013599349185824394, -0.012249852530658245, -0.007836028933525085, 0.05997432395815849, 0.003832272719591856, 0.04160327464342117, 0.03107570670545101, 0.010288981720805168, 0.005849062465131283, -0.03110552951693535, -0.01673077791929245, 0.03453519195318222, -0.0314335823059082, -0.02187526971101761, -0.030195923522114754, -0.03205987066030502, 0.026796085759997368, 0.01623869687318802, -0.034594837576150894, -0.01922100968658924, -0.009647783823311329, 0.018028084188699722, 0.028525829315185547, -0.016298342496156693, -0.02165159583091736, 0.015582587569952011, -0.0034184767864644527, 0.019802561029791832, -0.011817417107522488, 0.05117649957537651, -0.0024548168294131756, 0.0013056941097602248, 0.019295567646622658, 0.006326232571154833, 0.011377525515854359, 0.035400062799453735, 0.0048760827630758286, 0.00510348379611969, 0.0022796059492975473, 0.023068195208907127, 0.028660032898187637, -0.0023690753150731325, -0.034147489815950394, -0.010445552878081799, 0.009461389854550362, 0.02169633097946644, -0.011377525515854359, -0.02108495682477951, 0.009617961011826992, 0.01327129453420639, 0.0521010160446167, 0.049953751266002655, -0.005021470133215189, 0.011891975067555904, 0.01000566128641367, -0.03551935404539108, -0.018311405554413795, 0.006445525214076042, -0.04219973459839821, 0.004883538465946913, -0.015284356661140919, -0.013219104148447514, 0.05227995663881302, 0.02910737879574299, 0.030419597402215004, 0.014613335952162743, 0.005535919219255447, 0.030926590785384178, 0.025379488244652748, 0.012995431199669838, -0.0018900411669164896, 0.016790425404906273, -0.004197606351226568, 0.023843595758080482, 0.0046710483729839325, 0.00394783727824688, 0.011392437852919102, 0.010080219246447086, 0.008954396471381187, 0.027064494788646698, 0.025662807747721672, 0.04175239056348801, 0.000801496731583029, 0.024126915261149406, 0.0031482046470046043, -0.024932140484452248, -0.002630027709528804, 0.0055881100706756115, -0.02836180105805397, -0.008693443611264229, -0.021636683493852615, 0.018848221749067307, 0.0006528470548801124, -0.015955377370119095, -0.05773758888244629, 0.014128710143268108, -0.0051482184790074825, -0.007686913013458252, 0.016700955107808113, 0.03483342006802559, -0.013002886436879635, 0.0017017825739458203, -0.0188631322234869, 0.046315327286720276, -0.03110552951693535, -0.017207948490977287, -0.0034818509593605995, -0.00887983851134777, -0.02578210085630417, -0.0015424152370542288, -0.024574263021349907, -0.013383131474256516, 0.002905891742557287, 0.018937690183520317, -0.018967512995004654, 0.013040165416896343, 0.0013746601762250066, 0.0045890347100794315, 0.0012469798093661666, -0.0010233062785118818, -0.01098236907273531, -0.010497743263840675, -0.019742915406823158, 0.012891050428152084, -0.015172519721090794, -0.025931214913725853, -0.012809036299586296, -0.01810264214873314, -0.016432547941803932, 0.0024119459558278322, 0.04291548952460289, 0.0026803542859852314, -0.02432076632976532, -0.00794786587357521, 0.014762451872229576, 0.0030568712390959263, -0.0003094150160904974, 0.025752276182174683, -0.021741066128015518, -0.008410124108195305, 0.0037148441188037395, 0.001854626229032874, 0.029137203469872475, -0.02308310568332672, 0.028212685137987137, 0.016208874061703682, 0.02876441366970539, 0.03790520504117012, 0.010281525552272797, 0.01602993533015251, -0.0019757826812565327, 0.00579314399510622, 0.014128710143268108, -0.0059944503009319305, -0.010087675414979458, -0.018311405554413795, -0.027183787897229195, 0.005118395667523146, 0.016850071027874947, 0.016581663861870766, -0.01040827389806509, 0.025200549513101578, 0.010318804532289505, 0.0294205229729414, -0.015776438638567924, 0.011631022207438946, 0.0001683376176515594, -0.025975950062274933, 0.021517392247915268, -0.029092468321323395, 0.0015014084056019783, -0.05290624126791954, -0.03292474150657654, -0.025797011330723763, 0.0062069399282336235, 0.02259102463722229, -0.056216608732938766, -0.0021901363506913185, 0.048581887036561966, -0.01805790886282921, 0.02414182759821415, 0.024663733318448067, -0.010512654669582844, 0.006497715599834919, 0.011459539644420147, 0.008044790476560593, 0.014218179509043694, 0.009707430377602577, 0.0007036395836621523, -0.03004680760204792, -0.005163130350410938, 0.014546234160661697, 0.013122179545462132, 0.017506180331110954, 0.00045620076707564294, 0.01213801559060812, -0.002397034550085664, -0.03793502599000931, 0.0005330885178409517, 0.009767076931893826, -0.00907368864864111, 0.033580850809812546, 0.0022292793728411198, 0.0005503300344571471, -0.000843435525894165, 0.003914286382496357, 0.022158589214086533, -0.028958264738321304, 0.018207022920250893, -0.030926590785384178, 0.010490288026630878, 0.030240658670663834, -0.012070913799107075, 0.02423129789531231, 0.00011603063467191532, -0.04479434713721275, -0.003746531205251813, -0.0038173613138496876, 0.0032954562921077013, 0.03602634742856026, 0.029748577624559402, 0.010184600949287415, -0.0032507216092199087, 0.01158628799021244, -0.032328277826309204, 0.009752165526151657, -0.018654370680451393, 0.017297418788075447, -0.019996412098407745, 0.01567205786705017, 0.039127953350543976, 0.02333660237491131, 0.010296436958014965, 0.006911511532962322, -0.02218841202557087, 0.023485718294978142, -0.01801317371428013, -0.019071895629167557, 0.009006586857140064, -0.00031687080627307296, 0.06865285336971283, -0.018699105829000473, -0.001914272434078157, -0.021547215059399605, -0.04661355912685394, 0.016089580953121185, 0.019951676949858665, -0.0029860413633286953, -0.01758073829114437, 0.0098267225548625, 0.019295567646622658, 0.022829608991742134, 0.006941334810107946, -0.009342096745967865, 0.024932140484452248, 0.0009748437441885471, -0.010087675414979458, 0.04044017195701599, 0.024469882249832153, 0.023008547723293304, 0.04082787036895752, 0.01992185413837433, -0.014210723340511322, -0.0023578915279358625, -0.020876195281744003, -0.001644932315684855, -0.008126804605126381, 0.009066233411431313, 0.019429773092269897, 0.018937690183520317, -0.02551369182765484, -0.03334226459264755, -0.02014552801847458, 0.03647369518876076, -0.01828158088028431, 0.01780441217124462, 0.003513538045808673, 0.045867979526519775, -0.005450177937746048, 0.02849600464105606, -0.004771701525896788, 0.026661882176995277, -0.020801637321710587, 0.009953470900654793, -0.00627031410112977, 0.006180844735354185, -0.008246096782386303, 0.003918014466762543, -0.010706505738198757, 0.007970232516527176, -0.002548014046624303, 0.013427866622805595, 0.00852196104824543, 0.009468845091760159, -0.015388737432658672, -0.022784875705838203, 0.0032376740127801895, 0.04616621136665344, 0.021368276327848434, -0.0033290074206888676, -0.03879989683628082, -0.006784763187170029, -0.02427603118121624, 0.01386775728315115, 0.00947630126029253, -0.030986236408352852, -0.005222776439040899, 0.010639403015375137, -0.01216038316488266, 0.01202617958188057, -0.015344003215432167, 0.000685000151861459, -0.0029934970661997795, 0.0020913472399115562, -0.014009417966008186, 0.030956413596868515, -0.041692741215229034, 0.005692490842193365, 0.024738289415836334, 0.038233257830142975, -0.036682456731796265, -0.0022125039249658585, -0.0212191604077816, -0.005767048802226782, -0.0029972251504659653, 0.035668469965457916, 0.03888936713337898, 0.006061552092432976, -0.004503293428570032, 0.025707542896270752, -0.02196473814547062, 0.012085825204849243, 0.0032768170349299908, -0.00024371093604713678, 0.004309442825615406, -0.043124254792928696, -0.010751239955425262, -0.024395324289798737, -0.0087008997797966, -0.01176522672176361, -0.018177200108766556, -0.004820164293050766, -0.02414182759821415, 0.013509879820048809, -0.003286136779934168, -0.02014552801847458, -0.05290624126791954, -0.0009137995075434446, -0.0054949126206338406, 0.02894335240125656, -0.027407461777329445, -0.01102710422128439, 0.010311349295079708, 0.004141687881201506, 0.004999103024601936, 0.02405235916376114, -0.002486503915861249, 0.023470807820558548, -0.015097961761057377, -0.013658995740115643, 0.012697199359536171, 0.023411160334944725, 0.021099867299199104, 0.0020484765991568565, -0.006751212291419506, -0.009260083548724651, -0.01202617958188057, -0.0039702048525214195, -0.022158589214086533, -0.037964850664138794, 0.003444571979343891, 0.0014566737227141857, 0.007593715563416481, 0.005457633640617132, 0.011705580167472363, 0.019638534635305405, -0.0026598507538437843, -0.010907811112701893, -0.02924158424139023, -0.013174369931221008, 0.007649634033441544, -0.012861226685345173, -0.011854696087539196, 0.04798542335629463, -0.011988900601863861, 0.015746615827083588, 0.013673907145857811, -0.015001037158071995, 0.0174017995595932, -0.0008084865403361619, -0.00018324918346479535, 0.017655296251177788, -0.014389663003385067, 0.026065420359373093, 0.009931104257702827, 0.004764245823025703, -0.01953415386378765, -0.025931214913725853, 0.021591950207948685, -0.0015414833324030042, 0.019056983292102814, 0.006028001196682453, -0.008447403088212013, 0.03882972151041031, 0.057141125202178955, -0.01780441217124462, -0.04157344996929169, 0.00967760756611824, 0.0004531718441285193, -0.007664545439183712, -0.0026523950509727, -0.012592818588018417, 0.0008355137542821467, -0.029793310910463333, -0.020428847521543503, 0.001553598907776177, 0.006520082708448172, 0.03307385742664337, -0.027631133794784546, -0.019146451726555824, -0.024529527872800827, 0.01637290045619011, 0.0487310029566288, 0.0207718126475811, -0.03528076782822609, -0.024484794586896896, 0.009819267317652702, 0.02135336399078369, -0.022262969985604286, -0.003356966655701399, 0.008439946919679642, -0.010259157977998257, 0.030374862253665924, -0.012234941124916077, -0.01805790886282921, 0.00909605622291565, -0.024827759712934494, 0.041215572506189346, 0.041215572506189346, 0.013979594223201275, -0.005308518186211586, -0.023947976529598236, -0.02542422153055668, -0.004533116705715656, -0.0020447487477213144, 0.03411766514182091, -0.010840709321200848, 0.00033620925387367606, -0.02542422153055668, -0.00785839557647705, 0.0007218130631372333, -0.0057409536093473434, 0.00021610123803839087, -0.009133335202932358, 0.022933989763259888, 0.0051482184790074825, -0.006534994579851627, -0.022740140557289124, -0.04097698628902435, -0.06328469514846802, -0.01722286082804203, -0.00847722589969635, 0.04363124445080757, 0.01731232926249504, -0.016298342496156693, 0.013651539571583271, -0.016581663861870766, 0.013666451908648014, 0.008812736719846725, -0.00963287241756916, 0.0032190345227718353, -0.03811396658420563, -0.002738136565312743, -0.015015948563814163, 0.019414860755205154, -0.0162834320217371, 0.007541525177657604, -0.019161364063620567, -0.0011537824757397175, 0.030210835859179497, -0.006658014841377735, 0.012570451013743877, -0.004406368359923363, 0.010378451086580753, 0.0001877925533335656, 0.06573019176721573, 0.010013117454946041, 0.04709073156118393, -0.044048771262168884, 0.013263839296996593, -0.01771494187414646, 0.006311320699751377, -0.014001961797475815, -0.032775625586509705, 0.0013485648669302464, -0.022755051031708717, -0.002477184170857072, -0.030926590785384178, 0.002316884696483612, 0.010967457666993141, -0.0011649661464616656, 0.017953528091311455, -0.003204123117029667, 0.005983266513794661, -0.03617546334862709, 0.030151190236210823, -0.0028481094632297754, 0.021099867299199104, -0.007452055811882019, 0.0021211705170571804, 0.005420354660600424, 0.013972138985991478, 0.002147265709936619, 0.004492109641432762, 0.005308518186211586, 0.010549933649599552, -0.004917089361697435, -0.013942315243184566, 0.017014099285006523, -0.037964850664138794, 0.043482132256031036, 0.002805238589644432, 0.012965607456862926, -0.024305853992700577, -0.012555539608001709, -0.009625417180359364, -0.025901392102241516, -0.006307593081146479, 0.00529360631480813, -0.0020484765991568565, 0.009043865837156773, 0.018609635531902313, 0.004309442825615406, -0.03671227768063545, -0.017595648765563965, -0.00852196104824543, -0.020354289561510086, -0.035131651908159256, -0.00020771347044501454, 0.03581758588552475, -0.025140902027487755, 0.005834150593727827, 0.0004443181096576154, 0.026781175285577774, 0.02645312063395977, 0.04008229449391365, -0.0235751885920763, 0.02529001794755459, -0.0027623679488897324, -0.010624491609632969, -0.002082027494907379, -0.013882669620215893, -0.0009552722913213074, 0.02086128294467926, 0.006132381968200207, -0.005207865033298731, -0.011973988264799118, -0.008603974245488644, -0.005286150611937046, 0.06626700609922409, 0.009319729171693325, 0.008074614219367504, -0.03307385742664337, 0.023843595758080482, 0.02778024971485138, -0.034863244742155075, 0.02476811408996582, 0.008425035513937473, 0.04190150275826454, 0.010147321969270706, 0.03080729767680168, 0.022919079288840294, 0.024082181975245476, -0.018162289634346962, -0.005722314119338989, 0.020070970058441162, 0.029047733172774315, -0.010594668798148632, 0.05338340997695923, -0.026557501405477524, -0.019191186875104904, 0.016402723267674446, -0.019206099212169647, -0.03933671489357948, -0.018892955034971237, 0.01258536335080862, -0.017864057794213295, -0.00754525326192379, -0.03871043026447296, -0.0006901259766891599, 0.05189225450158119, 0.03044942021369934, -0.02555842697620392, -0.011243321932852268, -0.006005633622407913, 0.004305715207010508, 0.020115705206990242, -0.020473582670092583, -0.0006836021784693003, -0.008760545402765274, -0.016357989981770515, -0.0011174356332048774, 0.02454444020986557, 0.0007726055919192731, -0.002725088968873024, 0.00016344475443474948, -0.029002998024225235, -0.046315327286720276, -0.015194887295365334, -0.02387341856956482, -0.0022982454393059015, 0.028913529589772224, 0.010900355875492096, 0.014486587606370449, -0.019728003069758415, -0.019280657172203064, -0.022218234837055206, -0.005204136949032545, 0.007217198610305786, 0.006743756588548422, 0.021681418642401695, -0.032865095883607864, 0.013368220068514347, -0.01056484505534172, -0.004033579025417566, 0.01854998990893364, -0.006564817391335964, 0.010370994918048382, 0.03781573474407196]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" missing
Stage 112345Stage 212345Stage 312345Stage 412345Stage 112345Stage 212345Stage 312345Stage 412345Main forwardKV forwardFigure 5: Standard full-model inference (top) and our
pipeline-based early-exit inference (bottom). Numbers in
the blocks denote the tokens within one generated sequence.
For simplicity of visualization, we assume here that (1) each
early exit is located at the end of some pipeline stage, and
(2) the latency for generating each token is the same (while
in practice, generating the first token via the prefilling phase
usually takes longer than generating another token during
the decoding phase).
KV caches in deep layers due to early exiting. During each
forward pass, we include these early-exit tokens in the cur-
rent forward pass, which allows for direct recomputation of
the KV caches for these tokens and thus avoids the issue
of missing KV caches. It relies on the batching effect of
GPU computation for early-exit acceleration, yet might not
achieve any acceleration on other hardware platforms, due
to its high theoretical complexity.
New solution: pipeline parallelism. We propose a novel
type of pipeline parallelism to tackle the aforementioned
challenge. The key idea is that, in the process of inference
with multiple pipeline stages, the following two processes
runin parallel whenever the model decides to do early
exiting for the current token at a certain exit:
•The generated token is sent back to the first stage, and
the forward pass for generating the next token is started
immediately;
•The full-model forward pass of the current token is
continued from the exiting layer, which fulfills its KV
caches in all later layers.
See Figure 5 for a visualization of this approach. Although
each token essentially goes through a forward pass of the
full model, the computation after the exiting layer is par-
allelized with the computation of later tokens, which is
how acceleration is achieved in this approach. It can be
checked that the inference latency for generating one to-
ken at a certain exit matches exactly the time needed for
the forward computation before returning an output at that
exit, unless the selected exit is located in the middle of the
first pipeline stage, in which case generation of the next
token has to wait until the forward pass of the first stage
for the current token is completed. Note that this is true not
just in practice but also for the theoretical time complexity,
6
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
without relying on the batching effect of GPU computation
like KV recomputation does. An implementation of this
pipeline-based inference method is provided in EE-LLM .
One potential limitation of the proposed method is that it
requires multiple devices to facilitate pipeline parallelism,
although parallelism within a single GPU or other device
might be possible with more advanced implementation.
5. Experiments
This section provides an empirical evaluation of the training
and inference efficiency achieved by EE-LLM .
5.1. Training
In the following experiments, we empirically investigate the
convergence of training early-exit models with EE-LLM ,
as well as the training efficiency of EE-LLM for early-exit
LLMs up to an unprecedented scale of 30B. This scale
is only limited by the hardware resources available to us,
namely an 8-node cluster with 8 Nvidia A100-80GB GPUs
in each node and hence 64 GPUs in total. We use a ran-
dom subset of the pre-training data provided by Data-Juicer
(Data-Juicer, 2023; Chen et al., 2023). Experiments for
models of the same size use the same subset and order of
data. In all cases, we use the Adam optimizer (Kingma
& Ba, 2014) with β1= 0.9, β2= 0.95, ϵ= 10−8, and a
cosine schedule for the learning rate, with a maximum value
of3×10−4.
Convergence of training losses. We first consider a 1.3B
GPT Transformer with 24 layers, add one minimalistic early-
exit layer without layer normalization to the 1/4 depth and
the other to the 1/2 depth, set their early-exit loss weights
to 1/4 and 1/2 respectively (while the final-exit loss has a
weight of 1), and tie all input and output embedding matrices.
A standard LLM of the same architecture is trained using
the same hyperparameters and pre-training data. We further
train a 7B early-exit model","[0.004555885214358568, 0.012623743154108524, 0.07930973917245865, -0.021901434287428856, -0.014103196561336517, 0.014269116334617138, 0.0038092455361038446, 0.05146284028887749, 0.0006373227224685252, 0.07455336302518845, 0.02364359423518181, -0.03586636483669281, -0.039461296051740646, -0.014905142597854137, -0.028704151511192322, -0.03539625555276871, 0.020739994943141937, -8.155570685630664e-05, -0.014946622774004936, 0.05198825150728226, 0.016827048733830452, -0.02750123292207718, 0.036778923124074936, 0.023588286712765694, 0.04518553614616394, -0.022758686915040016, 0.01765664853155613, 0.019938047975301743, 0.007099991198629141, -0.05373041331768036, 0.06282835453748703, -0.03412420302629471, -0.046291667968034744, -0.028206393122673035, 0.006242738105356693, 0.023823339492082596, 0.006481248419731855, 0.05533430352807045, -0.031746018677949905, 0.045655641704797745, 0.028897725045681, -0.043830521404743195, -0.05384102463722229, 0.02718321979045868, -0.01054283045232296, 0.035700444132089615, 0.02642275206744671, 0.022523634135723114, -0.030861111357808113, 0.05480889230966568, 0.005140061955899, 0.041701216250658035, -0.03578340262174606, -0.0006904689944349229, -0.009519657120108604, -0.019094621762633324, 0.005807198584079742, -0.01402023620903492, -0.0057207816280424595, -0.02033902145922184, 0.035285644233226776, -0.061058543622493744, 0.02527513913810253, -0.016218675300478935, -0.0012452638475224376, 0.015140196308493614, -0.037193723022937775, 0.027127912268042564, 0.011690443381667137, 0.03169071301817894, -0.03417951241135597, 0.013252856209874153, 0.0032700058072805405, -0.01948176883161068, -0.011794143356382847, 0.01375752966850996, 0.00020329515973571688, 0.031635403633117676, -0.008289084769785404, -0.0227863397449255, 0.03368175029754639, -0.014697742648422718, 0.03899119049310684, -0.030473964288830757, 0.02267572656273842, -0.051324572414159775, 0.004020102322101593, -0.02270338125526905, -0.04590452089905739, -0.003643325762823224, -0.006868395023047924, -0.014974275603890419, -0.007189864758402109, 0.003639868926256895, 0.05801667645573616, 0.03166305646300316, 0.046402279287576675, -0.07466398179531097, 0.04548972100019455, 0.06050547584891319, 0.0034082725178450346, 0.048974040895700455, 0.055389612913131714, -0.03199489787220955, 0.02686520665884018, -0.040207937359809875, -0.05353683978319168, 0.02653336524963379, -0.014932796359062195, -0.028925377875566483, -0.010826276615262032, -0.011925497092306614, -0.015043409541249275, -0.0267545934766531, -0.020809127017855644, -0.041258763521909714, -0.06332611292600632, 0.016771741211414337, 0.011863276362419128, 0.0056481920182704926, -0.008067857474088669, 0.008980417624115944, 0.008786844089627266, -0.010618876665830612, 0.014476516284048557, 0.021804647520184517, 0.028510579839348793, -0.014151589944958687, 0.001947831129655242, -0.036253511905670166, -0.0132182901725173, 0.023532981052994728, 0.04548972100019455, -0.011006023734807968, -0.03169071301817894, 0.0006524456548504531, -0.03135887160897255, 0.0009220655774697661, -0.01017642393708229, -0.0074940514750778675, 0.004580081906169653, -0.015347596257925034, -0.00963718444108963, 0.007418004795908928, -0.04601513594388962, 0.06481939554214478, -0.037636175751686096, 0.026851380243897438, -0.02837231196463108, 0.00042300947825424373, 0.002272757701575756, -0.026464233174920082, -0.02227475307881832, -0.03188428282737732, -0.017684301361441612, -0.003857638919726014, -0.05030139908194542, 0.04678942635655403, 0.06775064766407013, -0.027998993173241615, 0.0071760378777980804, 0.032686229795217514, 0.03116529807448387, 0.018818087875843048, -0.0008028105949051678, 0.07095843553543091, -0.06786125898361206, -0.014421209692955017, -0.06354734301567078, -0.02997620590031147, -0.012202030047774315, 0.00013135329936631024, -0.04764667898416519, -0.026519538834691048, -0.004403792321681976, -0.02281399443745613, -0.05879097059369087, -0.040484469383955, -0.014013323001563549, -0.08909901231527328, -0.07184334099292755, 0.031635403633117676, -0.014587129466235638, 0.008987330831587315, -0.057795450091362, 0.0030418657697737217, 0.020809127017855644, 0.03440073877573013, -0.007998724468052387, 0.0030297674238681793, -0.0018977094441652298, 0.029257219284772873, 0.05746361240744591, 0.027280006557703018, 0.0200071819126606, 0.009720143862068653, 0.04991425201296806, 0.011662790551781654, 0.02291078120470047, -0.00038606635644100606, 0.041258763521909714, 0.026616325601935387, 0.023629767820239067, -0.07919912785291672, 0.07007353007793427, -0.02292460761964321, -0.008821411058306694, 0.015236982144415379, -0.01872130110859871, -0.03434542939066887, 0.026796072721481323, 0.04891873151063919, 0.01637076959013939, 0.004701065365225077, 0.03727668151259422, 0.0014042704133316875, -0.05220947787165642, 0.02591116540133953, 0.06940984725952148, 0.0406503900885582, 0.007106904871761799, 0.028980685397982597, 0.00518845533952117, 0.03545156493782997, -0.05649574473500252, 0.01959238201379776, 0.0020515311043709517, -0.05190529301762581, 0.014932796359062195, 0.008849063888192177, -0.005081298761069775, -0.017642822116613388, -0.008676230907440186, -0.01584535650908947, 0.029063645750284195, -0.040512122213840485, -0.018984008580446243, -0.024058394134044647, -0.010107290931046009, -0.029063645750284195, -0.0006088052759878337, 0.05514072999358177, 0.002910512499511242, -0.021265408024191856, -0.03188428282737732, 0.026381272822618484, -0.028621193021535873, -0.04441124200820923, -0.0054165953770279884, 0.0163569413125515, -0.0054269651882350445, -0.016785569489002228, -0.045019615441560745, 0.0008935480727814138, -0.033239297568798065, 0.019620034843683243, -0.02986559271812439, 0.0009082389296963811, -0.039654869586229324, 0.008489570580422878, 0.007701451424509287, 0.025966472923755646, -0.007722191046923399, 0.012547696940600872, -0.0062254550866782665, -0.013633090071380138, -0.039461296051740646, 0.0014872304163873196, -0.013391123153269291, -0.018389461562037468, 0.014213809743523598, -0.03799566999077797, 0.0023816425818949938, -0.013778269290924072, -0.031109992414712906, -0.0003547403321135789, 0.05580441281199455, -0.0007894160225987434, -0.02642275206744671, 0.0040684957057237625, 0.0015917945420369506, -0.004137628711760044, 0.0522371307015419, 0.011814883910119534, -0.00269101420417428, 0.0037850490771234035, -0.011579830199480057, -0.004275895655155182, -0.018043795600533485, -0.036336470395326614, 0.022233273833990097, 0.008206124417483807, 0.029284872114658356, -0.01938498206436634, 0.024998607113957405, 0.005637821741402149, -0.011960063129663467, 0.018154408782720566, -0.0044590989127755165, -0.005081298761069775, 0.039323028177022934, 0.001064653042703867, -0.01883191429078579, 0.028317006304860115, -0.014587129466235638, 0.03373705595731735, -0.022316234186291695, 0.015513516031205654, -0.043415721505880356, 0.043830521404743195, -0.008952763862907887, -0.014407382346689701, -0.007901937700808048, 0.05685523897409439, -0.016674956306815147, -0.02674076519906521, -0.009008070454001427, -0.05552787706255913, 0.025510193780064583, -0.05655105039477348, 0.005890158470720053, -0.06299427896738052, -0.03448369726538658, -0.006671364884823561, 0.015582649037241936, 0.02642275206744671, 0.02398926019668579, 0.0038472688756883144, -0.02505391277372837, -0.026298312470316887, 0.01090923696756363, -0.008510311134159565, -0.0008455868810415268, -0.057850755751132965, -0.02537192590534687, -0.052403051406145096, -0.05608094483613968, 0.0003702953108586371, 0.07438744604587555, 0.012492390349507332, -0.06238590180873871, 0.022316234186291695, -0.0051608020439744, 0.02567611262202263, 0.008247604593634605, 0.051324572414159775, 0.019965700805187225, 0.007632317952811718, 0.10016034543514252, 0.011268730275332928, -0.04797852039337158, -0.010349256917834282, 0.006235824897885323, -0.014089369215071201, 0.029201911762356758, -0.028095779940485954, 0.03487084433436394, -0.015167849138379097, -0.003328769002109766, 0.020629381760954857, -0.03926772251725197, 0.0030280391220003366, 0.014352075755596161, 0.029146606102585793, -0.03368175029754639, 0.016840875148773193, -0.047480762004852295, 0.011503783985972404, 0.02129306085407734, -0.004490208812057972, 0.022108834236860275, 0.03050161898136139, -0.0027273092418909073, 0.01895635575056076, -0.048642199486494064, -0.020186927169561386, 0.014517996460199356, 0.031746018677949905, 0.028220219537615776, 0.06332611292600632, 0.012941756285727024, 0.03503676503896713, -0.032686229795217514, -0.00725208455696702, -0.0193711556494236, 0.04167356342077255, -0.0022433761041611433, -0.017103582620620728, -0.03675127029418945, 0.0036467823665589094, -0.0027445924933999777, 0.021127140149474144, 0.0024300359655171633, 0.00719677796587348, 0.02548253908753395, -0.02035284787416458, 0.0010940347565338016, 0.026049433276057243, 0.02642275206744671, 0.005357831716537476, -0.01450416911393404, -0.02567611262202263, -0.016550514847040176, -0.023602113127708435, 0.03310102969408035, 0.004137628711760044, 0.06177752837538719, 0.009823843836784363, 0.0511309988796711, 0.018776608631014824, 0.038576390594244, -0.005157345440238714, 0.02183230035007, -0.05790606513619423, 0.02054642140865326, 0.005700042005628347, 0.0273906197398901, 0.02237153984606266, -0.005696584936231375, 0.06885678321123123, -0.032907456159591675, -0.01628780923783779, -0.05298377200961113, 3.372949504409917e-05, -0.02163872681558132, -0.017573688179254532, 0.019523248076438904, -0.022330060601234436, -0.0023626310285180807, -0.046734120696783066, -0.0038057889323681593, 0.013446429744362831, 0.02956140600144863, 0.000716826063580811, -0.04203305393457413, -0.012748182751238346, -0.021790821105241776, 0.012084503658115864, -0.026160046458244324, -0.029284872114658356, 0.013370382599532604, -0.005015621893107891, -0.011469217017292976, 0.004085778724402189, -0.045545026659965515, -0.016633475199341774, -0.04631932079792023, -0.004690695554018021, 0.017850222066044807, -0.024680593982338905, 0.01692383550107479, 0.0206432081758976, 0.04363694787025452, 0.030169777572155, 0.006232368294149637, -0.07344723492860794, 0.09850114583969116, -0.019841261208057404, 0.035811055451631546, -0.00508475536480546, 0.020408153533935547, -0.021998221054673195, -0.023256447166204453, 0.001243535545654595, -0.021486634388566017, 0.038161590695381165, 0.036225855350494385, 0.011420823633670807, 0.026796072721481323, -0.004089235328137875, 0.0038368990644812584, -0.040484469383955, 0.030252737924456596, -0.00732813123613596, -0.017062101513147354, 0.01884574070572853, -0.015071062371134758, -0.02613239362835884, 0.007265911437571049, -0.018389461562037468, -0.000381745514459908, -0.0050259921699762344, 0.016674956306815147, -0.007708364631980658, 0.025662286207079887, 0.06504062563180923, -0.036004628986120224, -0.03968252241611481, -0.024583807215094566, 0.02878711186349392, 0.010155684314668179, -0.009526570327579975, 0.028123432770371437, -0.016757914796471596, -0.002417937619611621, -0.017822569236159325, -0.021970568224787712, -0.023685073480010033, 0.01851390115916729, 0.010660356841981411, 0.049084652215242386, -0.018265021964907646, 0.01090923696756363, 0.0024092961102724075, -0.004085778724402189, -0.007881198078393936, 0.011946236714720726, -0.0005176356644369662, -0.017048275098204613, -0.005150431767106056, -0.0067059313878417015, 0.0027324941474944353, -0.0005794236203655601, 0.019537074491381645, -0.0013990855077281594, 0.026256833225488663, -0.004137628711760044, 0.032907456159591675, -0.007099991198629141, 0.0473148413002491, 0.01616336964070797, -0.010079637169837952, -0.005821024999022484, 0.0009747797157615423, -0.025288965553045273, -0.00735578453168273, -0.037193723022937775, -0.12377628684043884, -0.025441059842705727, -0.0023574461229145527, 0.023173486813902855, -0.0008900914108380675, -0.012623743154108524, -0.015264635905623436, -0.04253081604838371, -0.008849063888192177, -0.012796576134860516, -0.017711956053972244, -0.04938884079456329, -0.012955582700669765, 0.024777380749583244, 0.03456665575504303, 0.025510193780064583, 0.028953032568097115, -0.012409429997205734, -0.00511240866035223, 0.050467319786548615, -0.030971724539995193, -0.0050363619811832905, 0.026837551966309547, 0.01628780923783779, -0.03299041837453842, -0.009837670251727104, -0.035285644233226776, -0.019094621762633324, 0.00797107070684433, 0.0030522358138114214, 0.0015425371238961816, -0.018140582367777824, 0.02259276807308197, 0.037304338067770004, 0.030363351106643677, 0.01863834075629711, -0.02986559271812439, -0.01872130110859871, 0.0008961405837908387, 0.006024968344718218, -0.041369374841451645, 0.018970182165503502, 0.014739222824573517, -0.04772964119911194, -0.005765718407928944, 0.0035914757754653692, -0.04391347989439964, 0.0266716331243515, -0.024556152522563934, -0.013674569316208363, 0.03467727079987526, 0.017380114644765854, 0.01455947570502758, -0.04153529554605484, 0.01081936340779066, -0.005077842157334089, -0.013722962699830532, -0.03564513847231865, -0.007238258142024279, -0.03647473827004433, -0.026049433276057243, -0.03716607019305229, 0.025302793830633163, 0.03113764524459839, -0.04584921523928642, 0.008378957398235798, -0.02462528645992279, -0.03871465474367142, -0.005575601942837238, 0.03252031281590462, -0.014573303051292896, -0.043609295040369034, -0.04363694787025452, 0.027625672519207, -0.004583538975566626, 0.016536688432097435, -0.005070928484201431, -0.01392344944179058, 0.03716607019305229, -0.04449420049786568, 0.007922678254544735, 0.02335323393344879, -0.05425582453608513, 0.009644097648561, -0.011787230148911476, -0.008911284618079662, -0.008054031059145927, -0.011358603835105896, -0.03028039261698723, -0.017711956053972244, -0.01914992742240429, 0.033654097467660904, -0.02203970029950142, 0.01332199014723301, -0.01949559524655342, -0.0039025756996124983, -0.01797466166317463, 0.009028811007738113, -0.023712726309895515, -0.025192180648446083, -0.018265021964907646, -0.01080553699284792, 0.02281399443745613, -0.026478059589862823, -0.00548572838306427, 0.002286584349349141, 0.006339524872601032, 0.018583035096526146, 0.026395099237561226, -0.006733584683388472, -0.00479439552873373, -0.02622918039560318, -0.023284099996089935, 0.01648138277232647, -0.013287423178553581, 0.012374863028526306, -0.006754324771463871, -0.015001929365098476, 0.006612601689994335, -0.0016211762558668852, 0.02375420741736889, -0.002041161060333252, -0.022772513329982758, -0.01957855559885502, -0.03116529807448387, 0.030805805698037148, 0.027653325349092484, 0.044272974133491516, -0.0150848887860775, -0.01979978196322918, -0.009892976842820644, 0.008738450706005096, 0.007625404745340347, -0.016011275351047516, 0.0069893780164420605, -0.02397543378174305, -0.005668931640684605, 0.012775836512446404, 0.04499196261167526, 0.025067739188671112, 0.03257561847567558, -0.010204076766967773, -0.00183203280903399, -0.010791710577905178, -0.007715277839452028, -0.010770970024168491, -0.006951354909688234, -0.009263863787055016, -0.02195673994719982, -0.03885292261838913, -0.021583421155810356, -0.011718097142875195, 0.002245104406028986, -0.03630881756544113, 0.018375635147094727, -0.05873566493391991, -0.021389847621321678, -0.021873781457543373, -0.001389579614624381, -0.00398207874968648, -0.02570376545190811, -0.0026253375690430403, -0.007556271273642778, 0.0008187976782210171, 0.022565113380551338, 0.025966472923755646, -0.026381272822618484, -0.017186541110277176, 0.003295930800959468, -0.011165030300617218, 0.03760852292180061, -0.018873395398259163, -0.04991425201296806, -0.013287423178553581, 0.012174376286566257, -0.03680657595396042, 0.01614954136312008, -0.022426847368478775, -0.007749844342470169, -0.027445925399661064, 0.04078865423798561, 0.054560013115406036, -0.03511972352862358, -0.02698964625597, -0.0011744021903723478, 0.0009402130963280797, -0.020394327118992805, -0.053260304033756256, -0.005316352006047964, -0.001273781294003129, 0.0021811560727655888, -0.04327745363116264, -0.022620420902967453, -0.035368602722883224, -0.008558704517781734, -0.05674462392926216, 0.018997834995388985, 0.014960449188947678, 0.01017642393708229, -0.03417951241135597, 0.030695192515850067, 0.02086443454027176, 0.0025406493805348873, 0.03470492362976074, 0.020933568477630615, 0.012520043179392815, -0.06033955514431, 0.01765664853155613, 0.01439355593174696, -0.04419001564383507, -0.028303179889917374, -0.014932796359062195, 0.0009687305428087711, -0.018555382266640663, -0.03285215049982071, -0.010853930376470089, 0.032686229795217514, -0.0050363619811832905, -0.005305981729179621, 0.021334540098905563, 0.04579390585422516, 0.008054031059145927, -0.03315633907914162, -0.004103062208741903, 0.012589176185429096, -0.015057235956192017, 0.009554224088788033, -0.010128030553460121, -0.02332558110356331, 0.03832751139998436, -0.00185968610458076, 0.009761624038219452, -0.016343114897608757, 0.00365369557403028, 0.009222384542226791, 0.0003955721913371235, 0.03899119049310684, 0.0005232527619227767, 0.006965181324630976, 0.004666498862206936, -0.005734608508646488, 0.03299041837453842, 0.021486634388566017, -0.0279436856508255, -0.01012111734598875, 0.030695192515850067, 0.007812064606696367, 0.02075382135808468, -0.016218675300478935, 0.03653004392981529, -0.007272824645042419, 0.008247604593634605, 0.03525799140334129, -0.002003137720748782, -0.019979527220129967, 0.017794914543628693, -0.05317734554409981, -0.010300863534212112, -0.006826914846897125, -0.01885956898331642, 0.026713112369179726, -0.014974275603890419, -0.06133507564663887, -0.015264635905623436, -0.018002314493060112, 0.0006083731423132122, -0.02750123292207718, 0.0017421594820916653, 0.032686229795217514, -0.009346824139356613, -0.1301918625831604, -0.005793371703475714, 0.013508649542927742, 0.011109723709523678, 0.02129306085407734, 0.011296384036540985, -0.00725208455696702, 0.001752529526129365, -0.008607097901403904, -0.03337756544351578, -0.010280123911798, -0.02452849969267845, -0.0003180132480338216, -0.01970299519598484, 0.011572916992008686, -0.039876095950603485, -0.00743874441832304, 0.008109337650239468, 0.018707474693655968, -0.022454500198364258, -0.0032233407255262136, 0.0035534524358808994, -0.015803875401616096, 0.008489570580422878, -0.025441059842705727, -0.02451467327773571, -0.008607097901403904, -0.002858662512153387, 0.003147294046357274, 0.005288698710501194, -0.012692876160144806, -0.015126368962228298, 0.007618491072207689, 0.00020016255439259112, -0.018043795600533485, -0.0032976591028273106, -0.02046346105635166, -0.03542391210794449, 0.011642049998044968, -3.38105128321331e-05, -0.009989763610064983, -0.027473580092191696, 0.04786790534853935, -0.010881584137678146, 0.0400143638253212, 0.012146723456680775, 0.017476901412010193, 0.011987716890871525, 0.02078147418797016, 0.0054165953770279884, -0.0034601225052028894, -0.005786458496004343, -0.02226092666387558, 0.022136487066745758, 0.008088598027825356, -0.003304572543129325, -0.004607735201716423, -0.012976323254406452, -0.006889134645462036, 0.03094407171010971, -0.012181290425360203, 0.01433824934065342, -0.006090645212680101, -0.027680980041623116, -0.04023559018969536, -0.011607483960688114, 0.02942313812673092, 0.03691719099879265, 0.009443610906600952, -0.06929923593997955, -0.008593270555138588, 0.007659971248358488, 0.023588286712765694, 0.0015580920735374093, -0.0029675476253032684, 0.005675845313817263, -0.0007436152081936598, 0.036889538168907166, -0.058182597160339355, 0.020103968679904938, 0.018029969185590744, -0.016426075249910355, 0.00044850236736238003, -0.015485862269997597, 0.012789662927389145, 0.042641427367925644, 0.01713123545050621, -0.015361422672867775, -0.009492004290223122, 0.02333940751850605, 0.03791271150112152, -0.03821689635515213, -0.013038543052971363, 0.004210218787193298, 0.02299373969435692, -0.00201869267039001, 0.029035992920398712, 0.02108566090464592, 0.04261377453804016, -0.006778521463274956, 0.03072284534573555, 0.03083345852792263, -0.03691719099879265, -0.0206432081758976, -0.01743542216718197, -0.0046561285853385925, 0.021154794842004776, -0.0005064015276730061, -0.0025665743742138147, -0.012423256412148476, -0.0009453980601392686, 0.010259384289383888, 0.0017542578279972076, 0.07140088826417923, 0.015790048986673355, 0.024003086611628532, 0.02867649868130684, 0.011566003784537315, 0.01852772757411003, -0.006515814922749996, -0.009263863787055016, 0.030971724539995193, -0.03393062949180603, -0.011828710325062275, -0.02740444615483284, -0.016674956306815147, 0.04612574726343155, 0.020477287471294403, -0.04142468050122261, -0.008130078203976154, -0.01765664853155613, 0.028178738430142403, 0.022136487066745758, -0.01397184282541275, -0.00974779762327671, -0.0017421594820916653, 0.010522090829908848, 0.012388690374791622, 0.008344391360878944, 0.0447707362473011, 0.0015857453690841794, 0.005606711842119694, 0.018541555851697922, 8.350008283741772e-05, 0.011856363154947758, 0.02805429883301258, -0.009312257170677185, -0.01671643555164337, 0.002723852638155222, 0.008710797876119614, 0.031303565949201584, -0.0034203706309199333, -0.030971724539995193, 0.0020809127017855644, -0.009657924063503742, 0.012513129971921444, -0.018901048228144646, -0.02192908711731434, 0.0017482086550444365, 0.040954574942588806, 0.04380286857485771, 0.05472593009471893, -0.0016108062118291855, 0.019398808479309082, 0.030556924641132355, -0.02183230035007, -0.011932410299777985, 0.007943417876958847, -0.031303565949201584, 0.012119069695472717, -0.005993858445435762, -0.008966591209173203, 0.04452185332775116, 0.007625404745340347, 0.03202255070209503, 0.004092692397534847, -0.0019253628561273217, 0.013557042926549911, -0.0010214446811005473, 0.01863834075629711, -0.014891316182911396, 0.0025907710660248995, -0.02376803383231163, 0.01011420413851738, -0.0014768604887649417, -0.012685962952673435, -0.0024507760535925627, 0.008641663938760757, 0.01648138277232647, 0.039323028177022934, 0.01967534050345421, 0.03229908272624016, 0.010992197319865227, 0.0344560444355011, 0.029727324843406677, -0.02773628570139408, -0.008060944266617298, 0.0067232148721814156, -0.032492656260728836, -0.012361036613583565, -0.002687557600438595, 0.024362580850720406, -0.008883630856871605, -0.017366288229823112, -0.04709361493587494, 0.007846631109714508, -0.000941077247262001, -0.015402902849018574, -0.0051262350752949715, 0.032382044941186905, -0.0003046186757273972, 0.004621562082320452, -0.005724238231778145, 0.03957190737128258, -0.01574856974184513, -0.02217796817421913, 0.005665475036948919, -0.004597365390509367, -0.03575574979186058, -0.005603255238384008, -0.024791207164525986, -0.005741521716117859, 0.009402130730450153, 0.030003858730196953, -0.011904756538569927, 0.014974275603890419, 0.010459870100021362, -0.005520295351743698, -0.0002752370201051235, 0.01406862959265709, -0.010210990905761719, -0.0010603321716189384, -0.027003472670912743, 0.008102424442768097, -0.003778135636821389, -0.040207937359809875, -0.017255675047636032, -0.025233659893274307, 0.008911284618079662, 0.002811997663229704, 0.046734120696783066, 0.013315076008439064, -0.013501736335456371, -0.008503397926688194, 0.02267572656273842, 0.009298430755734444, -0.011351690627634525, 0.02011779509484768, -0.02162490040063858, -0.007466398179531097, 0.01892870105803013, -0.005247218534350395, 0.008372044190764427, -0.007597751449793577, 0.036004628986120224, 0.0020601728465408087, 0.04568329453468323, 0.03755321726202965, 0.013619262725114822, 0.019951874390244484, -0.011268730275332928, 0.017822569236159325, 0.012692876160144806, 0.010874669998884201, -6.065368143026717e-05, -0.024265794083476067, -0.0045386021956801414, 0.02203970029950142, 0.022772513329982758, 0.011773403733968735, -0.013716049492359161, 0.019329674541950226, -0.012616829946637154, 0.03329460322856903, -0.018970182165503502, 0.0029502641409635544, 0.0012219313066452742, -0.019302021712064743, 0.026685459539294243, -0.009512743912637234, -0.0031593923922628164, -0.049416493624448776, -0.009996676817536354, -0.002627065870910883, 0.012298816815018654, 0.0028344658203423023, -0.04300092160701752, -0.006584948394447565, 0.05381337180733681, -0.0196062084287405, 0.021776994690299034, 0.031441830098629, -0.002960634185001254, 0.006688648369163275, 0.024970952421426773, 0.010397650301456451, 0.016633475199341774, -0.001664384501054883, 0.014988102950155735, -0.04247550666332245, 0.006730128079652786, 0.010342343710362911, 0.0038783790078014135, -0.008731537498533726, 0.010107290931046009, 0.006543468218296766, -0.006667908281087875, -0.037525564432144165, -0.01818206161260605, 0.006367178168147802, -0.006833828054368496, 0.011849449947476387, 0.019080795347690582, 0.009699404239654541, -0.004234415479004383, 0.014974275603890419, 0.02002100832760334, -0.028081951662898064, 0.012554610148072243, -0.021707860752940178, -0.008427350781857967, 0.02108566090464592, -4.609787720255554e-05, 0.013073110021650791, 0.006273848470300436, -0.02183230035007, 0.01482218224555254, -0.0067854346707463264, 0.017532208934426308, 0.00660914508625865, 0.02805429883301258, 0.0032233407255262136, 0.013840490020811558, 0.02439023368060589, -0.03285215049982071, 0.003802332328632474, -0.0025164526887238026, 0.0008952764328569174, -0.013252856209874153, 0.005696584936231375, 0.050577931106090546, 0.02140367403626442, 0.004044299013912678, 0.0012046480551362038, -0.004946488421410322, 0.024265794083476067, -0.01365382969379425, -0.018347982317209244, 0.031967245042324066, -0.008551791310310364, 0.06664451211690903, -0.025441059842705727, -0.01872130110859871, -0.013149156235158443, -0.02878711186349392, 0.03843812271952629, 0.009754710830748081, -0.012284990400075912, 0.00538202840834856, 0.01700679585337639, 0.01895635575056076, 0.012105243280529976, 0.019523248076438904, 0.01885956898331642, 0.03639177605509758, 0.0018493161769583821, -0.00709307799115777, 0.02118244767189026, 0.014435036107897758, 0.03133121877908707, 0.04034620150923729, -0.005413138307631016, -0.008344391360878944, 0.00985149759799242, -0.029257219284772873, 0.014462688937783241, -0.028510579839348793, 0.01606658287346363, 0.008385870605707169, 0.030916418880224228, -0.03824454918503761, -0.036336470395326614, -0.006139038130640984, 0.04659585282206535, -0.003309757448732853, 0.022219447419047356, 0.0071760378777980804, 0.044577162712812424, -0.013315076008439064, 0.02418283373117447, -0.001010210602544248, -0.002575215883553028, -0.01809910126030445, -0.006391374859958887, -0.03263092413544655, 0.007812064606696367, -0.003829985624179244, 0.011704269796609879, -0.004455642309039831, 0.008275257423520088, -0.016550514847040176, -0.007058511488139629, 0.003314942354336381, 0.009519657120108604, 0.006201258394867182, -0.017476901412010193, -0.014600955881178379, 0.05392398685216904, 0.01402023620903492, -0.0006165827508084476, -0.03650239109992981, -0.02387864701449871, -0.027044951915740967, 0.03680657595396042, -0.004376139026135206, -0.01883191429078579, -0.02054642140865326, 0.019122274592518806, 0.0002642188919708133, 0.016439901664853096, -0.00085293228039518, -0.007991811260581017, -0.0057276953011751175, -0.004369225353002548, -0.004911921918392181, 0.03973782807588577, -0.02324262075126171, 0.005627451930195093, 0.027763938531279564, 0.0277086328715086, -0.03583871200680733, -0.015873009338974953, -0.028704151511192322, 0.0031438374426215887, 0.025869686156511307, 0.023933952674269676, 0.0400143638253212, -0.0004437494499143213, -0.019550900906324387, 0.019537074491381645, -0.02300756797194481, 0.007632317952811718, 0.007950331084430218, 0.0012098329607397318, -0.0047632851637899876, -0.02450084686279297, -0.02172168716788292, -0.0017715411959215999, -0.01957855559885502, -0.015444382093846798, -0.016785569489002228, 0.0006364585715346038, -0.007846631109714508, -0.00693407142534852, 0.014269116334617138, -0.003142109140753746, -0.04656819999217987, 0.008413524366915226, 0.011538350023329258, 0.019550900906324387, -0.02505391277372837, 0.0021258494816720486, 0.021431326866149902, 0.004234415479004383, 0.014517996460199356, 0.057850755751132965, 0.018029969185590744, 0.02440406009554863, -0.025095393881201744, 0.011552176438272, 0.0016108062118291855, 0.0073972647078335285, 0.021279234439134598, -0.002215722808614373, 0.007549358066171408, -0.011801056563854218, 0.0026097826194018126, -0.00978927779942751, -0.0048427889123559, -0.039986707270145416, -0.0060042282566428185, 0.006197801791131496, 0.008558704517781734, -0.011012936942279339, 0.028344659134745598, 0.021223926916718483, -0.009810017421841621, -0.029284872114658356, -0.034843191504478455, 0.005198825150728226, 0.0017749977996572852, -0.01637076959013939, -0.002811997663229704, 0.027902206405997276, 0.014379729516804218, 0.026574846357107162, 0.005910898558795452, -0.0031040858011692762, 0.021763168275356293, 0.012506216764450073, -0.016661128029227257, 0.004614648874849081, -0.007846631109714508, 0.011559090577065945, 0.00732813123613596, -0.005064015276730061, -0.013716049492359161, -0.025606980547308922, 0.010425304062664509, -0.003546538995578885, 0.021652553230524063, 0.015596475452184677, -0.0003923315671272576, 0.02364359423518181, 0.04078865423798561, -0.03799566999077797, -0.031524792313575745, 0.02108566090464592, 0.011607483960688114, 0.006177061703056097, 0.00521610863506794, -0.0014889587182551622, 0.004396878648549318, -0.020905913785099983, -0.00696172472089529, -0.014587129466235638, 0.0002685397048480809, 0.0350920706987381, -0.02911895141005516, -0.023104352876544, -0.024874165654182434, -0.003871465567499399, 0.03896353766322136, 0.0015122912591323256, -0.039461296051740646, -0.03296276554465294, 0.006301501765847206, 0.01659199595451355, -0.025081565603613853, -0.028980685397982597, -0.0027532342355698347, -0.006654081400483847, 0.022012047469615936, -0.005074385087937117, -0.014199982397258282, 0.028261698782444, -0.012029197067022324, 0.03583871200680733, 0.04172886908054352, 0.02792985923588276, 0.00958879105746746, -0.025869686156511307, -0.020048661157488823, -0.0013714320957660675, -0.014013323001563549, 0.033322256058454514, 0.0003400495043024421, 0.013204462826251984, -0.027860725298523903, -0.019205234944820404, -0.006125211715698242, 0.008448091335594654, 5.596828032139456e-06, -0.0005906577571295202, -0.0016090779099613428, 0.004960315302014351, -0.01370913628488779, -0.018016140908002853, -0.05950995534658432, -0.06808248907327652, 0.0034462956245988607, 0.001694630365818739, 0.028980685397982597, 0.023062873631715775, 0.018776608631014824, 0.002338434336706996, 0.007418004795908928, 0.0036053024232387543, 0.010446043685078621, -6.565639523614664e-06, -0.004839331842958927, -0.039986707270145416, 0.004386508837342262, 0.002746321028098464, 0.0001667841279413551, -0.014199982397258282, 0.02324262075126171, -0.012326469644904137, 0.01670260913670063, 0.021002700552344322, 0.004507492296397686, 0.01149686984717846, 0.0009125597425736487, 0.043498679995536804, -0.0016738903941586614, 0.047895561903715134, 0.0018562295008450747, 0.05198825150728226, -0.037110764533281326, 0.012775836512446404, -0.009270777925848961, 0.01429676916450262, -0.00032967948936857283, -0.02322879433631897, 0.014199982397258282, -0.026837551966309547, -0.008814497850835323, -0.02194291353225708, -0.0061010150238871574, 0.0006489889929071069, 0.0042551555670797825, 0.00020902026153635234, 0.008378957398235798, -0.00062868109671399, -0.02559315226972103, 0.0374702550470829, -0.009173991158604622, 0.032907456159591675, -0.009187817573547363, 0.002366087632253766, 0.03326695039868355, -0.006228911690413952, 0.0003629499115049839, -0.010847017168998718, 0.011801056563854218, 0.017725782468914986, -0.022399194538593292, -0.012914103455841541, 0.015402902849018574, -0.04933353140950203, 0.017628995701670647, -0.0005206602509133518, 0.005575601942837238, -0.0015537712024524808, -0.008607097901403904, 0.0003201736544724554, -0.016757914796471596, -0.01691000908613205, -0.0020256061106920242, -0.005496098659932613, -0.0032924741972237825, 0.017615169286727905, 0.022454500198364258, -0.033239297568798065, -0.008164644241333008, -0.010522090829908848, -0.01070875022560358, -0.03971017524600029, 0.012063763104379177, 0.05392398685216904, -0.02997620590031147, 0.0014578488189727068, 0.0023643593303859234, 0.034096550196409225, 0.03876996412873268, 0.03542391210794449, -0.010784797370433807, 0.0033564225304871798, -0.014753049239516258, -0.007459484506398439, -0.011773403733968735, -0.01617719605565071, -0.0002261955669382587, 0.017601341009140015, 0.008468830958008766, 0.00015803443966433406, -0.020504940301179886, 0.0045489720068871975, -0.006056078244000673, 0.040429163724184036, 0.008925111033022404, 0.0032924741972237825, -0.006730128079652786, 0.009332997724413872, 0.023491499945521355, -0.030639884993433952, 0.011427736841142178, 0.007922678254544735, 0.04067804291844368, 0.011012936942279339, 0.03630881756544113, 0.008143904618918896, 0.02698964625597, -0.018237369135022163, -0.00022662764240521938, 0.01981360837817192, 0.026063259690999985, -0.004659585189074278, 0.03871465474367142, -0.009132510982453823, 0.0002815022016875446, 0.004701065365225077, -0.01616336964070797, -0.02967201918363571, -0.04120345413684845, -0.010826276615262032, -0.007321218028664589, -0.005146975163370371, -0.04164590686559677, 0.006183974910527468, 0.0535091869533062, 0.028759459033608437, -0.030031511560082436, 0.00024974410189315677, 0.013951103202998638, 0.0031870456878095865, 0.01296249683946371, -0.03202255070209503, 0.002302139298990369, -0.01086775679141283, -0.017075927928090096, 0.00974088441580534, 0.024473194032907486, -0.01332199014723301, 0.0017689487431198359, 0.004936118610203266, -0.02289695292711258, -0.05577675998210907, -0.011676616966724396, -0.03246500343084335, -0.011406997218728065, 0.013508649542927742, 0.01733863539993763, 0.03028039261698723, -0.02260659448802471, -0.004801308736205101, -0.008634750731289387, -0.024362580850720406, 0.014642436057329178, 0.009326084516942501, 0.03724902868270874, -0.02238536812365055, 0.02387864701449871, -0.009554224088788033, -0.020933568477630615, 0.012243510223925114, -0.0017179629066959023, 0.007895024493336678, 0.018665995448827744]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" with 32 layers using similar
configurations, except that early-exit loss weights are set
to 0.1 and 0.2, and all embedding matrices are untied. A
standard 7B model is trained similarly. The batch size and
sequence length are both set to 2048.
Figure 6 shows the convergence of early and final-exit train-
ing losses, i.e. negative log-likelihood of next-token predic-
tion, for both standard and early-exit LLMs. All loss curves
decay at a similar pace, and unsurprisingly, the early-exit
losses are slightly higher than the final-exit loss for each
model. Interestingly, the final-exit loss curve of each early-
exit model is close to (or even slightly below) that of the
standard model, suggesting that optimizing for early-exit
losses might not hurt the full-model output in our setting.
We also observe more spikes in the loss curves for the 7B
models than for the 1.3B models, possibly because (1) we
0 2500 5000 7500 10000 12500 15000 17500
Training iteration2345678Loss
17950 17960 17970 17980 17990 180002.22.32.42.52.6Early-exit LLM (6)
Early-exit LLM (12)
Early-exit LLM (final)
Standard LLM(a) 1.3B, 24 layers
0 2500 5000 7500 10000 12500 15000 17500
Training iteration2345678Loss
10000 10020 10040 10060 10080 101002.102.252.402.55Early-exit LLM (8)
Early-exit LLM (16)
Early-exit LLM (final)
Standard LLM
(b) 7B, 32 layers
Figure 6: Convergence of early-exit/final-exit training losses.
Each curve is annotated with the index of the Transformer
layer that the corresponding exit is connected to.
choose to untie the embedding matrices and use smaller
early-exit loss weights, both of which incur weaker regular-
ization for the training process; and (2) layer normalization,
which is known to stabilize the training of LLMs, is not in-
cluded in the minimalistic early-exit layers of our 7B model.
Empirical results for the convergence of training losses un-
der more general early-exit configurations can be found in
Appendix B.3.
Training efficiency. Starting with a standard GPT Trans-
former of size ranging from 1.3B to 30B, we increase the
number of early exits from 0 to 3. Minimalistic early exits
are added one by one to specific locations in the following
order: (1) to the 1/4 depth; (2) to the 1/2 depth; (3) to the
hidden states right before the first Transformer layer, which
is always located in the first pipeline stage. Based on the
performance optimizations proposed in Appendix A, when
an early exit is inserted into the middle of two layers located
on two consecutive pipeline stages, we always add it to the
beginning of the latter stage. We set the global batch size
to 2048, microbatch size to 2 (for 1.3B and 7B models) or
1 (for 13B and 30B models), and sequence length to 2048.
The data parallelism degree is fixed at 4, while tensor (TP)
and pipeline (PP) parallelism degrees take various values.
The empirical results illustrated in Figure 7 matches our an-
alytical study in Section 3.2. In particular, training time in-
creases with the number of added early exits, but at a slower
rate when pipeline parallelism is enabled, thanks to the
proposed utilization of implicit bubbles. Without pipeline
7
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
0 1 2 3
Number of early exits4.56.07.59.010.5Time per iter. (s)
PP=4,TP=1
PP=1,TP=4
0 1 2 3
Number of early exits15182124GPU memory (GB)
PP=4,TP=1
PP=1,TP=4
(a) 1.3B
0 1 2 3
Number of early exits16202428Time per iter. (s)
PP=4,TP=1
PP","[-0.0007214095676317811, 0.02082286961376667, 0.09110647439956665, -0.03964057192206383, -0.006709591019898653, 0.012037417851388454, 0.027146851643919945, 0.04660723730921745, -0.005719861947000027, 0.057789888232946396, -0.010584957897663116, 0.006921675987541676, -0.040180426090955734, -0.005890172440558672, -0.023162228986620903, -0.007133760489523411, 0.018830556422472, 0.01570712774991989, -0.0027490686625242233, 0.054910674691200256, 0.0017946871230378747, -0.027738118544220924, 0.008650488220155239, 0.030822986736893654, 0.03413922339677811, 0.01394618023186922, 0.023714933544397354, 0.006883115042001009, 0.029486211016774178, -0.055373407900333405, 0.059178080409765244, -0.029383381828665733, -0.036709945648908615, -0.0034062101040035486, -0.0021513751707971096, 0.004264189396053553, 0.02505171112716198, 0.05645311251282692, -0.015270103700459003, 0.03868940472602844, 0.02102852612733841, -0.025231661275029182, -0.048432450741529465, 0.03575877845287323, -0.0043862988241016865, 0.007924258708953857, 0.02018018811941147, 0.03462766110897064, -0.02453756518661976, 0.05599037930369377, 0.007056639064103365, 0.037815358489751816, -0.023766348138451576, 0.004942217841744423, -0.0037146969698369503, -0.004787974525243044, -0.0027249681297689676, -0.023072252050042152, 0.01062351930886507, -0.026684120297431946, 0.022648083046078682, -0.03516751155257225, 0.026015732437372208, -0.017930803820490837, 0.018175022676587105, 0.03149137645959854, -0.06874117255210876, 0.01921616680920124, 0.002721754601225257, 0.046735771000385284, -0.032185472548007965, -0.005292478948831558, -0.01976887136697769, -0.007808575872331858, 0.0017320256447419524, 0.047378454357385635, 0.024730369448661804, 0.04480772837996483, -0.02352212928235531, -0.06565630435943604, 0.00935101043432951, -0.017545195296406746, 0.04557894542813301, -0.01641407608985901, 0.013779083266854286, -0.023599252104759216, 0.008862572722136974, -0.0020533662755042315, -0.021812597289681435, -0.010944860056042671, 0.016915367916226387, -0.043573781847953796, -0.019498946145176888, 0.010244336910545826, 0.06020636856555939, -0.003785391803830862, 0.028149433434009552, -0.041748568415641785, 0.01607988215982914, 0.03917784243822098, -0.005035406909883022, 0.057018671184778214, 0.03866369649767876, -0.013611986301839352, -0.0008812765008769929, -0.03236542269587517, -0.03542458266019821, -0.02052723616361618, -0.04539899528026581, -0.0054467227309942245, -0.01751948706805706, 0.011182651855051517, -0.015360078774392605, 0.0010885412339121103, 0.009800887666642666, -0.03365078568458557, -0.06303416937589645, 0.034422002732753754, 0.03521892800927162, 0.014370350167155266, -0.0040135434828698635, -0.011433297768235207, -0.02179974503815174, 0.007063065655529499, 0.0020678264554589987, 0.014678836800158024, 0.035064682364463806, -0.03123430348932743, 0.01197314914315939, -0.026118561625480652, 0.0022333168890327215, 0.024010566994547844, 0.07799578458070755, -0.026272805407643318, -0.010045106522738934, -0.0010941646760329604, -0.04419075325131416, 0.028123727068305016, -0.024267639964818954, -0.02555300109088421, 0.02386917732656002, -0.005083607975393534, -0.015462907962501049, 0.024807492271065712, -0.053728144615888596, 0.0690496638417244, -0.03796960040926933, 0.030925815925002098, -0.04223700612783432, 0.02268664352595806, -0.008650488220155239, -0.014434617944061756, -0.03439629450440407, -0.028663579374551773, -0.013123548589646816, -0.03236542269587517, -0.0470699667930603, 0.059229493141174316, 0.06601620465517044, -0.02569439262151718, 0.012744367122650146, 0.008033514022827148, 0.027558166533708572, 0.01263511087745428, 0.015925638377666473, 0.06365113705396652, -0.05087463930249214, -0.004800828173756599, -0.09218618273735046, -0.06493650376796722, 0.021465549245476723, -0.02115706354379654, -0.06046343967318535, -0.030206013470888138, -0.028123727068305016, -0.009595229290425777, -0.0843711793422699, -0.053213998675346375, -0.014267520979046822, -0.059949297457933426, -0.05208287760615349, 0.021941134706139565, -0.01760946400463581, 0.02902347967028618, -0.06010353937745094, 0.007686466444283724, 0.0065424940548837185, 0.016812538728117943, 0.02233959548175335, -0.019100483506917953, 0.02069433219730854, 0.02670982852578163, 0.05974363908171654, 0.015604297630488873, 0.017468072474002838, 0.005077180918306112, 0.04228841885924339, 0.0015625185333192348, -0.0021256678737699986, 0.007230162620544434, 0.02551444061100483, 0.05830403417348862, 0.029846111312508583, -0.06781571358442307, 0.0450390949845314, -0.01798221841454506, -0.011536126025021076, 0.00017744024808052927, -0.00529890600591898, -0.012159527279436588, 0.01385620515793562, -0.003897861111909151, 0.0037789649795740843, -0.021041380241513252, 0.004987205844372511, 0.0020887136925011873, -0.04753269627690315, 0.013547718524932861, 0.0666331797838211, 0.04663294181227684, 0.02737821638584137, 0.013766230084002018, 0.008431976661086082, 0.04197993129491806, -0.05082322284579277, 0.018213583156466484, 0.014293228276073933, -0.05331682786345482, 0.0033194480929523706, -0.0008061631233431399, 0.013239230960607529, 0.003724337089806795, 0.0064814393408596516, -0.008791877888143063, 0.028329385444521904, -0.04971781373023987, -0.03498756140470505, -0.0067160180769860744, -0.002768348902463913, -0.012037417851388454, -0.008920414373278618, 0.05226283147931099, -0.006571414414793253, -0.014807373285293579, -0.019704604521393776, 0.018766289576888084, -0.021606938913464546, -0.06282851099967957, -0.013689108192920685, 0.011523272842168808, -0.005784130189567804, -0.03758399188518524, -0.01921616680920124, -0.013380621559917927, -0.026298511773347855, 0.04277685657143593, -0.025527294725179672, 0.011921735480427742, -0.031208595260977745, -0.004142079968005419, 0.013072133995592594, 0.002043725922703743, 0.019730310887098312, 0.013444889336824417, -0.012320197187364101, 0.004450567066669464, -0.03254537284374237, 0.003280887147411704, 0.005456362850964069, -0.05974363908171654, 0.024563273414969444, -0.030771572142839432, 0.009171060286462307, 0.028869235888123512, -0.01790509559214115, -0.02678694948554039, 0.05835544690489769, -0.003727550618350506, -0.04773835465312004, 0.01591278426349163, 0.004546969197690487, -0.006664603482931852, 0.03498756140470505, 0.04917795956134796, 0.0023297190200537443, -0.010925578884780407, -0.013959034346044064, 0.03820096701383591, -0.018509216606616974, -0.0077314539812505245, 0.005707008298486471, -0.013213524594902992, 0.03367649018764496, -0.014974470250308514, 0.00225420412607491, -0.002668733475729823, 0.00042537457193247974, -0.01542434748262167, -0.020925696939229965, -0.009530961513519287, 0.010758481919765472, -0.026272805407643318, -0.018393533304333687, 0.05218570679426193, 0.016979634761810303, 0.041157301515340805, -0.015000177547335625, 0.006385037209838629, -0.02442188374698162, 0.015205835923552513, -0.012120965868234634, 0.004408792592585087, -0.01646549068391323, 0.02115706354379654, -0.017043903470039368, -0.026092853397130966, -0.01487164106220007, -0.033573660999536514, -0.018830556422472, -0.041105885058641434, -0.02521880716085434, -0.056813012808561325, -0.04899800941348076, 0.012937171384692192, 0.025784367695450783, 0.03529604896903038, -0.00073908333433792, -0.003952488768845797, -0.012686525471508503, -0.022995131090283394, -0.010315032675862312, -0.0467100664973259, -0.013316352851688862, -0.026889778673648834, -0.05269985273480415, -0.035733070224523544, -0.0478154756128788, 0.035193219780921936, 0.0640624538064003, 0.03935779258608818, -0.05444794520735741, 0.012172380462288857, -0.007570783607661724, 0.023072252050042152, -0.009447412565350533, 0.04951215535402298, 0.021632647141814232, 0.0023634599056094885, 0.11496280133724213, 0.02280232682824135, -0.03282815217971802, -0.037224091589450836, 0.0062565007247030735, -0.028072312474250793, 0.03940920904278755, -0.022326743230223656, 0.04023183882236481, -0.014755958691239357, -0.00552384415641427, 0.033162347972393036, -0.029460502788424492, -0.0022188567090779543, 0.024691808968782425, 0.00168703799135983, -0.03200552240014076, 0.017288122326135635, -0.017172440886497498, 0.0328538604080677, 0.0044730608351528645, -0.03339371085166931, 0.018264997750520706, 0.054139457643032074, -0.018097901716828346, 0.011600394733250141, -0.04285397753119469, -0.015231543220579624, 0.0007270330097526312, 0.018650606274604797, 0.012288063764572144, 0.018971947953104973, 0.008297013118863106, 0.027403924614191055, -0.002122454345226288, 0.028535041958093643, -0.013547718524932861, 0.01023791078478098, 0.001144775771535933, 0.004244908690452576, -0.018971947953104973, -0.00398783665150404, 0.006121537648141384, 0.02730109542608261, -0.00313628395088017, -0.006160098593682051, 0.03437058627605438, -0.010379300452768803, 0.014293228276073933, 0.036761362105607986, 0.023689227178692818, 0.001335973385721445, -0.031080059707164764, -0.015925638377666473, -0.04133725166320801, -0.057789888232946396, 0.025617269799113274, -0.009228901006281376, 0.075682133436203, -0.005764849949628115, 0.032905273139476776, 0.01831641234457493, 0.047918304800987244, 0.00345441116951406, 0.01352201122790575, -0.025450173765420914, 0.0026092855259776115, -0.0099229970946908, 0.008804732002317905, 0.017121026292443275, 0.003280887147411704, 0.06164597347378731, -0.05336824059486389, -0.03275103121995926, -0.0507718101143837, -0.002220463240519166, -0.05005200579762459, -0.012680098414421082, -0.0003852070076391101, 0.0012170773698017001, -0.019666042178869247, -0.05840686336159706, -0.002437368268147111, 0.027609581127762794, 0.01958892121911049, -0.007622198201715946, -0.0387665256857872, -0.0034672648180276155, -0.025887196883559227, 0.002916165627539158, -0.028792114928364754, -0.010674933902919292, 0.003121823538094759, -0.007789295166730881, 0.007461527828127146, -0.0032535733189433813, -0.041157301515340805, -0.016157003119587898, -0.04583602026104927, -0.014691690914332867, 0.018843410536646843, -0.028509335592389107, 0.009081084281206131, -0.004119586199522018, 0.004640157800167799, 0.022943716496229172, -0.010816323570907116, -0.07316282391548157, 0.087507463991642, -0.019627481698989868, 0.05480784922838211, -0.021234184503555298, 0.028869235888123512, -0.03241683542728424, -0.01980743184685707, -0.0057744900695979595, -0.041362956166267395, 0.04074598476290703, 0.021684061735868454, -0.0018894824897870421, 0.017211001366376877, 0.0033515822142362595, 0.009768753312528133, -0.04421646147966385, 0.01542434748262167, -0.027069728821516037, -0.000530613586306572, 0.02730109542608261, -0.003836806397885084, 0.010180069133639336, 0.019627481698989868, -0.05326541140675545, 0.03308522328734398, -0.02023160271346569, 0.0032278660219162703, -0.0030366682913154364, 0.005591325927525759, 0.07239160686731339, -0.005077180918306112, -0.011716077104210854, -0.024743223562836647, 0.017802268266677856, 0.003370862454175949, -0.008470537140965462, 0.020552942529320717, -0.014087570831179619, 0.015411493368446827, -0.01807219348847866, -0.02458897978067398, -0.030617330223321915, 0.023213643580675125, 0.012390892021358013, 0.04439641162753105, -0.009235328063368797, 0.028766408562660217, 0.00692810257896781, -0.00910036452114582, -0.03190269321203232, -0.023959152400493622, 0.00401033041998744, -0.0058612520806491375, -0.02521880716085434, -0.003666495904326439, 0.010308605618774891, 0.0025514441076666117, 0.009216047823429108, 0.004305963404476643, 0.02915201708674431, 0.0074036866426467896, 0.029563331976532936, -0.0174423661082983, 0.035398878157138824, 0.01193458866328001, -0.011651809327304363, -0.015372932888567448, 0.00627256790176034, -0.018843410536646843, -0.02597717195749283, -0.01934470236301422, -0.1216466873884201, -0.02750675193965435, -0.004832962062209845, 0.03712126240134239, -0.023329325020313263, -0.016568319872021675, -0.0009021636215038598, -0.04650440812110901, 0.007872844114899635, -0.0036889896728098392, -0.02091284468770027, -0.04825250059366226, 0.0009005569154396653, 0.021735476329922676, 0.04946073889732361, 0.0313885472714901, 0.009704485535621643, -0.00971091166138649, -0.010462848469614983, 0.05102888122200966, -0.009106791578233242, -0.01036644633859396, 0.032776739448308945, 0.024177664890885353, -0.007609344553202391, 0.0065167867578566074, -0.01870202086865902, -0.0354502908885479, -0.007313711568713188, 0.0048522427678108215, -0.002209216356277466, 0.001640443573705852, 0.0337793193757534, 0.027275387197732925, -0.010334312915802002, 0.027532460168004036, -0.03570736572146416, -0.005189650226384401, 0.008412696421146393, 0.004408792592585087, -0.03791818767786026, 0.03704414144158363, -0.014627423137426376, -0.053933799266815186, 0.006953809875994921, 0.0017368458211421967, -0.03943491354584694, 0.012744367122650146, -0.014588861726224422, 0.0019055495504289865, 0.032134056091308594, 0.030488792806863785, -0.016979634761810303, -0.029486211016774178, 0.007827856577932835, -0.01781512051820755, -0.007416540291160345, -0.02992323413491249, -0.005931946914643049, -0.028663579374551773, -0.019460385665297508, -0.05383097380399704, 0.03498756140470505, 0.042596906423568726, -0.05336824059486389, 0.0075772106647491455, -0.03223688527941704, -0.02280232682824135, -0.0006001035217195749, -0.010539970360696316, -0.02019304223358631, -0.023200789466500282, -0.016182711347937584, 0.02420337125658989, -0.009389571845531464, 0.0075579299591481686, -0.011189078912138939, -0.0025771514046937227, 0.037815358489751816, -0.039923351258039474, 0.01352201122790575, -0.003039881819859147, -0.020977111533284187, 0.022840887308120728, -0.019794579595327377, -0.006902395281940699, 0.024216225370764732, -0.015411493368446827, 0.00042095614480786026, -0.012962878681719303, -0.027995189651846886, 0.06236577779054642, -0.006426811218261719, 0.02027016319334507, -0.00043581813224591315, -0.005674874410033226, -0.011079822666943073, 0.021144209429621696, -0.0008362888474948704, -0.02784094773232937, -0.021735476329922676, -0.00872118305414915, 0.017956510186195374, -0.03411351516842842, 0.028972065076231956, 0.007480808533728123, -0.011439723894000053, -0.00672887172549963, 0.02830367721617222, -0.016105588525533676, 0.006709591019898653, -0.0145374471321702, -0.04321387782692909, 0.014743105508387089, -0.001576978829689324, 0.003984623122960329, -0.02623424492776394, -0.023007985204458237, 0.03295668959617615, -0.00012381654232740402, 0.022480987012386322, -0.01424181368201971, -0.03195410594344139, -0.025488734245300293, -0.037763942033052444, 0.03850945457816124, 0.036761362105607986, 0.02530878409743309, -0.032982394099235535, -0.024601833894848824, 0.0063014887273311615, -0.0017866535345092416, -0.006291848141700029, -0.02979469671845436, 0.0045662494376301765, -0.02699260786175728, -0.005376027897000313, 0.014318935573101044, 0.04257119819521904, -0.010340739041566849, 0.036709945648908615, 0.01123406644910574, -0.004405579064041376, -0.044704899191856384, -0.003197338664904237, 0.004990418907254934, -0.016851099207997322, 0.008476964198052883, -0.043059635907411575, -0.036375753581523895, -0.03820096701383591, -0.006407530978322029, 0.009357437491416931, -0.0367356538772583, 0.010244336910545826, -0.04431929066777229, -0.030308842658996582, -0.017069611698389053, 0.001249211491085589, -0.01506444625556469, -0.010584957897663116, 0.00937671773135662, 0.013367767445743084, -0.0013464170042425394, 0.006144031882286072, 0.026684120297431946, -0.03858657553792, -0.01967889629304409, 0.001802720595151186, -0.03131142631173134, 0.05336824059486389, -0.013483449816703796, -0.04275114834308624, -0.014884495176374912, 0.016285540536046028, -0.02408768981695175, 0.021388428285717964, -0.025951463729143143, 0.0072687235660851, -0.030077477917075157, 0.026555584743618965, 0.050257664173841476, -0.029100602492690086, -0.04583602026104927, 0.016144150868058205, -0.011394736357033253, -0.02370207943022251, -0.03110576793551445, -0.005109315272420645, 0.01134332176297903, -0.0005085214506834745, -0.03329088166356087, -0.004797614645212889, -0.010353593155741692, -0.019923115149140358, -0.03688989579677582, 0.016092736274003983, 0.007949966005980968, -0.0007085559773258865, -0.03295668959617615, 0.0033451553899794817, 0.0037693248596042395, 0.01002582535147667, 0.04262261465191841, 0.027403924614191055, 0.019537506625056267, -0.03210834786295891, 0.03233971446752548, 0.019498946145176888, -0.04239124804735184, -0.009280315600335598, -0.01129833422601223, 0.0060765501111745834, -0.00026651183725334704, -0.030797280371189117, -0.0167097095400095, 0.02217249944806099, 0.0068702613934874535, 0.0073972600512206554, 0.02699260786175728, 0.05015483498573303, 0.02623424492776394, -0.03660711646080017, -0.010019399225711823, 0.010533544234931469, -0.023856323212385178, 0.010906298644840717, 0.009961557574570179, 0.015552883967757225, 0.048303913325071335, 0.005896599497646093, 0.021478403359651566, -0.0284322127699852, 0.009839448146522045, 0.008766170591115952, -0.009871582500636578, 0.03385644406080246, 0.0003390143101569265, -0.01036644633859396, -0.03758399188518524, -0.00290973880328238, 0.040771692991256714, 0.00928674265742302, -0.013187817297875881, -0.010610665194690228, 0.02992323413491249, 0.02322649583220482, 0.022031109780073166, -0.005083607975393534, 0.011433297768235207, -0.01997452974319458, -0.008213465102016926, -0.0054017347283661366, -0.007680039387196302, 0.005922306794673204, 0.016285540536046028, -0.007898551411926746, -0.018226437270641327, 0.0005458772648125887, -0.01879199594259262, 0.026684120297431946, -0.004794401116669178, -0.04179998114705086, -0.02302083745598793, 0.00015223509399220347, 0.0024229078553617, -0.03236542269587517, 0.006340049207210541, 0.019537506625056267, -0.013843351975083351, -0.14118419587612152, -0.014858787879347801, 0.012937171384692192, 0.016696855425834656, -0.0029916807543486357, 0.0019023361383005977, 0.011381883174180984, 0.013483449816703796, -0.015270103700459003, -0.013091415166854858, 0.006208299659192562, -0.012358758598566055, 0.0065232133492827415, -0.008888280019164085, 0.012583696283400059, -0.03413922339677811, 0.02209537662565708, 0.011369029060006142, 0.037686821073293686, -0.020810015499591827, -0.007859990000724792, 0.00027253697044216096, 0.004839389119297266, -0.002570724580436945, -0.042802564799785614, -0.03161991015076637, -0.0044987681321799755, 0.005681301467120647, 0.006651749834418297, 0.0023489994928240776, -0.024139104411005974, 0.011947442777454853, 0.01565571315586567, -0.01098342053592205, -0.006458945572376251, -0.0056877280585467815, -0.03879223391413689, -0.022956570610404015, 0.020874284207820892, 0.011947442777454853, -0.01586136966943741, -0.03704414144158363, 0.04971781373023987, -0.012416599318385124, 0.018059339374303818, 0.009852302260696888, 0.02065577171742916, -0.013599133118987083, 0.02449900470674038, -0.021606938913464546, 0.019987383857369423, 0.028535041958093643, -0.0038207394536584616, 0.015308665111660957, 0.022352449595928192, -0.012647964991629124, 0.007153041195124388, -0.02902347967028618, 0.01857348531484604, 0.027095437049865723, -0.006005855277180672, 0.017583755776286125, 0.005854825023561716, -0.024113396182656288, -0.03038596361875534, -0.009839448146522045, 0.029691869392991066, 0.02056579664349556, -0.00545957637950778, -0.06827844679355621, -0.02357354387640953, 0.0072044553235173225, 0.031002938747406006, -0.001315889647230506, -0.0015319911763072014, 0.015617151744663715, -0.008252025581896305, 0.062314361333847046, -0.03424205258488655, 0.01700534299015999, 0.020038798451423645, -0.009550241753458977, 0.023894885554909706, 0.007461527828127146, 0.015732834115624428, 0.019691750407218933, 0.030771572142839432, -0.025115977972745895, -0.015642859041690826, 0.032648202031850815, 0.04748128354549408, 0.0012508181389421225, 0.00905537698417902, 0.009659497067332268, 0.010617092251777649, -0.027738118544220924, 0.03354795649647713, 0.03151708468794823, 0.03583589941263199, 0.01925472728908062, 0.028072312474250793, 0.03331658989191055, -0.04570748284459114, -0.013611986301839352, 0.011163371615111828, 0.006857407744973898, 0.027686703950166702, -0.01320067048072815, -0.007326564751565456, -0.017121026292443275, -0.0017754066502675414, -0.008097782731056213, 0.013766230084002018, 0.05881817638874054, 0.03516751155257225, -0.0035572401247918606, 0.05074610188603401, 0.019704604521393776, 0.021555526182055473, -0.01349630393087864, -0.001135938917286694, 0.03208264335989952, -0.005208930466324091, 0.0029932872857898474, -0.04419075325131416, -0.01506444625556469, 0.033702198415994644, 0.03557882830500603, -0.027815239503979683, -0.0075772106647491455, -0.01059781201183796, 0.015077299438416958, -0.007236589677631855, -0.019666042178869247, -0.023997712880373, -0.00094795465702191, 0.013277792371809483, 0.013791937381029129, -0.007628625258803368, 0.031002938747406006, 0.0037404042668640614, 0.005356747191399336, -0.0016179498052224517, -0.013753375969827175, 0.025038857012987137, 0.016812538728117943, 0.0007908995030447841, -0.022185353562235832, 0.01193458866328001, 0.010019399225711823, 0.04840674251317978, 0.007461527828127146, -0.05357389897108078, 0.004440926481038332, 0.0016380335437133908, -0.016195565462112427, -0.02039869874715805, -0.016953928396105766, -0.007532223127782345, 0.02089999057352543, 0.018136462196707726, 0.042725443840026855, 0.02928055264055729, -0.005147875752300024, 0.02678694948554039, -0.023213643580675125, -0.01659402623772621, -0.0033226613886654377, -0.04413934051990509, 0.010199349373579025, -0.012018137611448765, -0.034422002732753754, 0.05126024782657623, 0.02091284468770027, 0.029948940500617027, -0.00744867417961359, -0.02280232682824135, 0.004437713418155909, 0.012982158921658993, 0.012628684751689434, -0.0025080631021410227, 0.0049807787872850895, -0.010713494382798672, -0.008939694613218307, -0.012500148266553879, -0.019113337621092796, 0.0007009241380728781, 0.025630123913288116, 0.02590004913508892, 0.0496663972735405, 0.006606762297451496, 0.01326493825763464, 0.017506634816527367, 0.052494194358587265, 0.014524593949317932, -0.023213643580675125, 0.019100483506917953, -0.007538649719208479, -0.020154479891061783, -0.01293074432760477, 0.013869059272110462, 0.003338728565722704, -0.01862489990890026, -0.010932005941867828, -0.04257119819521904, 0.0024261213839054108, 0.0049550714902579784, -0.012577270157635212, -0.026247097179293633, 0.02802089788019657, 0.0067224446684122086, 0.008110635913908482, 0.0040135434828698635, 0.035398878157138824, -0.04138866439461708, -0.01933184824883938, 0.0022799114231020212, -0.003991049714386463, -0.04419075325131416, 0.01032788585871458, -0.019486092031002045, -0.020771455019712448, 0.022918010130524635, 0.013611986301839352, 0.0030704091768711805, 0.021606938913464546, -0.013046426698565483, 0.011195505037903786, 0.0023104387801140547, 0.007609344553202391, 0.003269640263170004, -0.013676255010068417, -0.02001309022307396, 0.017236707732081413, 0.004219201859086752, -0.02327791042625904, 0.015899932011961937, 0.006037989165633917, 0.006645322777330875, 0.014550301246345043, 0.05547623708844185, 0.011144091375172138, -0.020810015499591827, -0.010527117177844048, 0.019576067104935646, 0.01700534299015999, -0.005192863754928112, 0.022699497640132904, 0.0013046427629888058, -0.014164692722260952, 0.0225195474922657, 0.011690369807183743, -0.007570783607661724, -0.012519428506493568, 0.020218748599290848, 0.02323934994637966, 0.03110576793551445, 0.03354795649647713, 0.012692952528595924, 0.027918068692088127, -0.018457802012562752, 0.019010508432984352, 0.012262356467545033, 0.005745569244027138, 0.010893445461988449, -0.016221271827816963, 0.0014436225173994899, 0.01773799955844879, 0.024987442418932915, 0.023085106164216995, -0.008978255093097687, 0.02280232682824135, 0.012030990794301033, 0.023560689762234688, 0.008528378792107105, -0.00994870439171791, 0.02018018811941147, -0.012281636707484722, 0.04197993129491806, -0.0032150123734027147, -0.016851099207997322, -0.03966628015041351, -0.00046875554835423827, -0.0011953868670389056, 0.017969364300370216, -0.009993691928684711, -0.04545041173696518, -0.019563212990760803, 0.030103184282779694, 0.007885697297751904, -0.0009985658107325435, 0.016696855425834656, -0.010064386762678623, 0.007660759147256613, 0.021092794835567474, 0.008252025581896305, 0.02830367721617222, 0.00903609674423933, 0.0093702906742692, -0.014576008543372154, -0.007288004271686077, -0.012962878681719303, 0.0014572794316336513, -0.03845803812146187, -0.003313021268695593, 0.018547777086496353, 0.027609581127762794, -0.03262249380350113, -0.01607988215982914, 0.016619734466075897, -0.005931946914643049, 0.0003217422345187515, -0.0010194529313594103, 0.02509027160704136, -0.012513001449406147, 0.008965401910245419, 0.023342179134488106, -0.035398878157138824, 0.007461527828127146, 0.0027892361395061016, 0.019010508432984352, 0.020938551053404808, 0.001121478620916605, 0.008470537140965462, -0.0022477773018181324, -0.039923351258039474, 0.025295929983258247, -0.03131142631173134, 0.004000690300017595, 0.015218689106404781, 0.020128773525357246, -0.006201873067766428, -0.0048683094792068005, 0.018046487122774124, -0.04329100251197815, 0.01718529313802719, -0.010372873395681381, 0.006520000286400318, -0.020707186311483383, 0.00321661913767457, 0.037815358489751816, 0.030925815925002098, -0.004354164935648441, 0.004196707624942064, -0.003083262825384736, 0.015077299438416958, -0.020450113341212273, -0.019010508432984352, 0.03136283904314041, -0.006304701790213585, 0.06431952863931656, -0.021864011883735657, -0.0024887826293706894, -0.015797102823853493, -0.01578424870967865, 0.016259832307696342, 0.006979517173022032, -0.004164573736488819, -0.025411611422896385, 0.004241695627570152, 0.017069611698389053, 0.03195410594344139, 0.020887136459350586, -0.011356175877153873, 0.041491493582725525, 0.013779083266854286, -0.0224295724183321, 0.03403639420866966, 0.03215976431965828, 0.03629862889647484, 0.030103184282779694, 0.02593861147761345, -0.012827915139496326, 0.0013110694708302617, -0.03439629450440407, 0.020411552861332893, -0.020450113341212273, 0.009106791578233242, 0.00010865327931242064, 0.0367356538772583, -0.04848386347293854, -0.041028764098882675, -0.021786890923976898, 0.044036511331796646, -0.030206013470888138, 0.0051350221037864685, -0.023984860628843307, 0.03699272498488426, -0.02623424492776394, 0.02065577171742916, -0.018097901716828346, -0.011388309299945831, 0.004341311287134886, 0.007892124354839325, -0.03483331948518753, 0.01798221841454506, -0.0009495613630861044, -0.0010700641432777047, 0.004755840636789799, 0.005128595512360334, 0.012551562860608101, -0.004630517680197954, -0.0301803071051836, -0.0064300247468054295, -0.007956392131745815, 0.006587481591850519, 0.019794579595327377, 0.04547611624002457, 0.01976887136697769, 0.004730133339762688, -0.0265812911093235, -0.017146732658147812, -0.015578590333461761, 0.04511621594429016, 0.015154421329498291, -0.0072237360291182995, -0.004974352195858955, 0.012223795056343079, -0.008457683958113194, 0.003910714760422707, 0.007191602140665054, 0.007879271171987057, 0.0023731000255793333, -0.017493780702352524, 0.0019007294904440641, 0.007647905498743057, -0.026735534891486168, 0.009878008626401424, 0.041414372622966766, 0.021349867805838585, -0.030951524153351784, -0.018432095646858215, -0.020887136459350586, -0.0018268211279064417, 0.008219892159104347, 0.012937171384692192, 0.039460621774196625, -0.010842030867934227, -0.012834342196583748, 0.010970567353069782, -0.017995072528719902, 0.009736618958413601, 0.027095437049865723, 0.013129975646734238, 0.006050842814147472, -0.004694785922765732, -0.025887196883559227, -0.023329325020313263, -0.006651749834418297, -0.02302083745598793, -0.0010411434341222048, -0.01252585556358099, -0.010449995286762714, -0.015334371477365494, -0.00402961065992713, -0.017789414152503014, -0.0313885472714901, 0.0075579299591481686, -0.0018011138308793306, 0.0031523508951067924, -0.03511609882116318, 0.007493662182241678, 0.026504170149564743, 0.00966592412441969, 0.02874070033431053, 0.028149433434009552, 0.009158206172287464, 0.03575877845287323, -0.010057959705591202, -0.002977220341563225, 0.019177604466676712, -0.0018894824897870421, 0.040643155574798584, -0.010398580692708492, -0.015732834115624428, -0.01394618023186922, -0.030154598876833916, 0.009614509530365467, -0.03025742806494236, -0.0214141346514225, -0.0003034659894183278, -0.0007121710223145783, 0.02556585520505905, -0.006205086596310139, 0.03714697062969208, 0.020090213045477867, 0.00552384415641427, -0.010527117177844048, -0.04997488483786583, 0.011510418727993965, 0.03203122690320015, 0.0011078215902671218, 0.00629506167024374, 0.027866654098033905, 0.02527022175490856, 0.015552883967757225, 0.02200540155172348, -0.028329385444521904, -0.007956392131745815, -0.012236649170517921, -0.02200540155172348, -0.03097723051905632, -0.020128773525357246, 0.008386989124119282, -0.0025659045204520226, -0.007525796070694923, 0.00772502738982439, -0.021761182695627213, 0.010893445461988449, -0.011947442777454853, 0.03149137645959854, 0.016157003119587898, 0.006780285853892565, 0.02082286961376667, 0.02920343168079853, -0.021889720112085342, -0.03822667524218559, 0.024601833894848824, 0.013419182039797306, -0.009826594963669777, 0.0072494433261454105, -0.007757161278277636, 0.00027635289006866515, -0.002286338247358799, -0.0015368112362921238, -0.006195446010679007, 0.015977052971720695, 0.03169703483581543, -0.04105447232723236, -0.02174833044409752, -0.007339418400079012, 0.005530271213501692, 0.021092794835567474, 0.01586136966943741, -0.026838364079594612, -0.029460502788424492, -0.009839448146522045, 0.009061804041266441, -0.001969817792996764, -0.031542789191007614, -0.017249561846256256, -0.024987442418932915, 0.03300810232758522, -0.009614509530365467, -0.015051592141389847, 0.04408792778849602, -0.01489734835922718, 0.04876664653420448, 0.03845803812146187, 0.0005993001395836473, 0.00772502738982439, -0.027429630979895592, -0.01030217856168747, 0.0005382454255595803, -0.01288575679063797, 0.029357673600316048, -0.007474381476640701, 0.01633695513010025, -0.021465549245476723, -0.03280244395136833, 0.016298392787575722, 0.004081025253981352, -0.02111850306391716, -0.028200848028063774, 0.010694214142858982, -0.003599014366045594, -0.010192923247814178, -0.042802564799785614, -0.04084881395101547, -0.032982394099235535, -0.008682622574269772, -0.0024871760979294777, 0.04876664653420448, 0.03401068598031998, 0.0038271662779152393, -0.004257762338966131, 0.009473119862377644, 0.010462848469614983, 0.012037417851388454, 0.00482332194224, -0.02902347967028618, -0.045733191072940826, 0.013470596633851528, -0.006426811218261719, 0.009344583377242088, -0.005829117726534605, 0.01980743184685707, -0.019871700555086136, 0.021478403359651566, 0.025630123913288116, -0.01034716609865427, -0.0057744900695979595, -0.008849719539284706, 0.026208536699414253, -0.008669768460094929, 0.04434499889612198, 0.010835603810846806, 0.03928067162632942, -0.05290551111102104, 0.007699320092797279, -0.0031844850163906813, -0.012474440969526768, 0.013791937381029129, -0.02809801883995533, 0.014576008543372154, -0.02361210435628891, -0.01293074432760477, -0.04020613059401512, -0.005241064820438623, -0.000761978852096945, -0.010976993478834629, -0.0007382799522019923, 0.03555312007665634, -0.017249561846256256, -0.008881852962076664, 0.024190517142415047, -0.018290705978870392, 0.019833140075206757, -0.012217367999255657, 0.02149125747382641, 0.011060542427003384, -0.010848457925021648, -0.0008298620232380927, -0.003438343992456794, 0.0038560868706554174, 0.03223688527941704, -0.024267639964818954, 0.002130487933754921, 0.030206013470888138, -0.030206013470888138, 0.021632647141814232, -0.008811158128082752, 0.0025401972234249115, 0.006372183561325073, -0.008470537140965462, 0.030077477917075157, -0.019177604466676712, -0.015938492491841316, 0.021054234355688095, -0.010353593155741692, -0.015809955075383186, 0.007262296974658966, 0.034756194800138474, -0.04223700612783432, 0.00593516044318676, -0.013136402703821659, -0.012577270157635212, -0.03966628015041351, 0.00033720675855875015, 0.04611879959702492, -0.016786830499768257, -0.0044730608351528645, -0.010417860932648182, 0.013611986301839352, 0.0290748942643404, 0.04886947199702263, -0.0061279647052288055, 0.016992488875985146, 0.004775120876729488, -0.00014811792061664164, -0.007615771610289812, -0.014267520979046822, -0.004180640913546085, 0.006902395281940699, 0.004678718745708466, -0.007692893035709858, -0.02204396389424801, 0.01803363300859928, 0.0005069147446192801, 0.03532175347208977, -0.010700641199946404, -0.012069552205502987, -0.03354795649647713, 0.0048265354707837105, 0.022648083046078682, -0.026259951293468475, 0.018933385610580444, 0.026298511773347855, 0.02678694948554039, 0.004087451845407486, 0.04048890992999077, 0.02652987651526928, -0.0006563381175510585, -0.013933327049016953, 0.004582316614687443, 0.005527057684957981, 0.004951857961714268, -0.000530211953446269, 0.03334229812026024, -0.027583874762058258, -0.019563212990760803, -0.01958892121911049, -0.013155682943761349, -0.01853492483496666, -0.022789472714066505, -0.0019473237916827202, -0.007943538948893547, -0.004460207186639309, -0.04251978546380997, -0.002120847813785076, 0.05712150037288666, 0.027686703950166702, -0.023637812584638596, -0.013033573515713215, 0.022275328636169434, 0.018856264650821686, 0.011600394733250141, -0.034164927899837494, -0.006658176425844431, -0.0011945836013182998, -0.019010508432984352, -0.0024229078553617, 0.02730109542608261, -0.02014162763953209, -0.00021991744870319963, 0.008406269364058971, 0.012030990794301033, -0.041542910039424896, 0.006564987823367119, -0.011921735480427742, -0.021992549300193787, 0.0224295724183321, 0.01226878259330988, 0.028329385444521904, -0.004591956734657288, 0.005610606167465448, -0.013014293275773525, -0.028200848028063774, 0.014010448940098286, 0.016941074281930923, 0.02881782129406929, -0.03295668959617615, -0.009640216827392578, -0.006237220484763384, -0.023200789466500282, 0.007332991808652878, -0.02940908819437027, 0.016555465757846832, 0.026169976219534874]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
"=1,TP=4
0 1 2 3
Number of early exits48566472GPU memory (GB)
PP=4,TP=1
PP=1,TP=4
(b) 7B
0 1 2 3
Number of early exits35404550Time per iter. (s)
PP=4,TP=2
PP=2,TP=4
0 1 2 3
Number of early exits40455055GPU memory (GB)
PP=4,TP=2
PP=2,TP=4
(c) 13B
0 1 2 3
Number of early exits8896104112Time per iter. (s)
PP=4,TP=4
0 1 2 3
Number of early exits55606570GPU memory (GB)
PP=4,TP=4
(d) 30B
Figure 7: Training time per iteration and peak GPU memory
vs. the number of added early exits. Note that wall-clock
time can be impacted by other workloads on the same GPU
cluster when our experiments were conducted, which in-
evitably causes perturbations to our numerical results.
parallelism, peak GPU memory increases with the number
of early exits; on the other hand, with the pipeline paral-
lelism degree set to 4, peak memory remains unchanged as
early exits are added to middle pipeline stages, and only
increases when the last early exit is added to the first stage.
5.2. Inference
In the experiments below, we verify the downstream perfor-
mance of the pipeline-based approach proposed in Section 4,
with the number of pipeline stages set to 4. A server with
4 Nvidia A100-40GB GPUs is used for inference. We use
the 1.3B and 7B early-exit LLMs from the previous experi-
ment on convergence of training losses in Section 5.1, which
have been pre-trained from scratch using 300B and 150B
tokens respectively, without further fine-tuning or alignment.
Since designing the decoding method or exit condition is
not our focus, we simply adopt greedy decoding and a ba-
sic confidence-based exit condition: at each early exit, if
the maximum probability of next-token prediction is above
1 2 3
Speedup0.00.20.40.6EM
BoolQ TruthfulQA
1 2 3
Speedup0.00.20.40.60.8EM
BoolQ TruthfulQA
1 2 3 4
Speedup0.00.10.20.30.4F1
NaturalQ closed-book
NaturalQ open-book
1 2 3
Speedup0.00.20.40.60.8F1
NaturalQ closed-book
NaturalQ open-book
1 2 3
Speedup0.000.050.100.150.20ROUGE-L
XSUM CNN/DailyMail(a) 1.3B
1 2 3
Speedup0.000.080.160.24ROUGE-L
XSUM CNN/DailyMail (b) 7B
Figure 8: Evaluation scores and relative speedup with our
early-exit models. For each curve, speedup increases as the
confidence threshold decreases from left to right. The right
column also includes horizontal dotted lines that represent
the performance of a 7B standard LLM trained under the
same configurations as those for our 7B early-exit model.
a pre-defined threshold, then the model chooses the most
likely token and moves on to generate the next one. The
trade-off between output quality and speed is controlled by
this threshold. When the threshold is set to 1, early-exit lay-
ers are disabled, so that the time complexity of a full-model
forward pass matches that of a standard LLM2. Inference
latency in this case is used as the baseline for calculating rel-
ative speedup. For benchmarking, we evaluate our models
with HELM (Liang et al., 2023) in six tasks: BoolQ (Clark
et al., 2019), TruthfulQA (Lin et al., 2022), NaturalQues-
tions open-book and closed-book (Kwiatkowski et al., 2019),
XSUM (Narayan et al., 2018), and CNN/DailyMail. The
first four tasks are question-answering tasks, while the last
two are summarization tasks. We use EM (ratio of exact
match with the correct answers) as the metric for BoolQ
and TruthfulQA, F1 for","[0.011094468645751476, 0.026247890666127205, 0.07167808711528778, -0.008463666774332523, 0.0038597628008574247, 0.0019298814004287124, -0.011147084645926952, 0.05006041005253792, 0.011996458284556866, 0.031389228999614716, 0.012590267695486546, 0.004682828206568956, -0.0613052099943161, -0.01135003287345171, -0.019122174009680748, -0.038905806839466095, 0.016205741092562675, -0.018821511417627335, -0.014589677564799786, 0.04173203930258751, 0.0008921238477341831, -0.004006335977464914, 0.021241849288344383, -0.009049959480762482, 0.05234544724225998, -0.008696680888533592, 0.0074602034874260426, 0.004340823739767075, 0.03749268874526024, -0.060222823172807693, 0.036771100014448166, -0.03707176074385643, -0.006731095258146524, -0.0413111113011837, -0.00042163304169662297, 0.0476851686835289, 0.00868916418403387, 0.0342755950987339, -0.004818126559257507, 0.00811790395528078, -0.013011196628212929, -0.017618859186768532, -0.0751657783985138, -0.013807953335344791, -0.025451133027672768, 0.007975089363753796, -0.003478296333923936, 0.012267054989933968, -0.011297416873276234, 0.08208102732896805, -0.0263681560754776, 0.059411030262708664, -0.04822636395692825, 0.009493437595665455, 0.013334409333765507, -0.0006732034962624311, -0.012176856398582458, 0.0025349659845232964, 0.026097558438777924, -0.040138524025678635, 0.044528208673000336, -0.06975384056568146, 0.022594833746552467, -0.01689726673066616, 0.007426378782838583, -0.005190196912735701, -0.04203270375728607, 0.0173632949590683, 0.010951654054224491, 0.020911119878292084, -0.013439641334116459, 0.026668818667531013, 0.04792569950222969, -0.024624308571219444, 0.011583046056330204, 0.021437279880046844, 0.02089608646929264, 0.047895632684230804, -0.014905373565852642, -0.039627399295568466, 0.024398811161518097, -0.0014610348735004663, 0.05309710651636124, -0.053848762065172195, 0.028352532535791397, -0.035478249192237854, 0.007343696430325508, -0.007309872191399336, -0.054239626973867416, -0.017288129776716232, -0.05006041005253792, -0.003010389395058155, -0.004701619502156973, 0.0021929615177214146, 0.020550323650240898, 0.0015831792261451483, 0.027901537716388702, -0.037041693925857544, 0.03496712073683739, 0.056705065071582794, 0.01608547754585743, 0.034185394644737244, 0.041040513664484024, -0.015100805088877678, 0.056374333798885345, -0.011049369350075722, -0.023782452568411827, 0.014627260155975819, -0.03920647129416466, -0.01413116604089737, -0.029705515131354332, -0.013589972630143166, -0.061696071177721024, -0.004709136206656694, 0.00242785457521677, -0.056043606251478195, -0.07366245985031128, -0.017633892595767975, 0.03734235838055611, -0.0052728792652487755, 0.005596092436462641, -0.01168827898800373, 0.009553570300340652, -0.009155191481113434, -0.004043919034302235, 0.005118789616972208, 0.04843682795763016, -0.06133527681231499, 0.010786289349198341, -0.05057153478264809, 0.01788945496082306, 0.010417977347970009, 0.07288073748350143, 0.010230062529444695, -0.009989531710743904, 0.006873910315334797, -0.022669998928904533, -0.016551503911614418, -0.037522755563259125, 0.019618269056081772, -0.009531021118164062, -0.012868381105363369, -0.013484740629792213, 0.030427107587456703, -0.06034308671951294, 0.02878849394619465, -0.03839467838406563, 0.0005726692616008222, -0.04164184257388115, 0.010012081824243069, 0.0008907144656404853, -0.01575474813580513, -0.04353601858019829, -0.02821723371744156, -0.01880647800862789, -0.0202195942401886, -0.05438995733857155, 0.0483466275036335, 0.022910529747605324, -0.03268207982182503, 0.001274999463930726, 0.0044235060922801495, 0.014161232858896255, -0.006261309143155813, 0.003190787276253104, 0.05192451924085617, -0.037673089653253555, 0.005885480437427759, -0.08851522207260132, -0.04022872447967529, 0.03307294100522995, 0.011402648873627186, -0.032712146639823914, -0.05276637524366379, -0.003793992567807436, -0.042904626578092575, -0.04735444113612175, -0.02436874620616436, -0.011071919463574886, -0.06187646836042404, -0.06885185092687607, 0.03764302283525467, 0.009192775003612041, 0.022143838927149773, -0.03307294100522995, 0.004442297387868166, -0.00025744279264472425, 0.05481088533997536, 0.009290490299463272, 0.0024879872798919678, -0.018926743417978287, 0.04455827176570892, 0.052796442061662674, 0.031148698180913925, 0.006607071962207556, -0.03298274427652359, 0.05051140487194061, 0.015160937793552876, -0.021166684105992317, -0.008869562298059464, 0.00875681359320879, 0.02707471325993538, 0.038094017654657364, -0.05706585943698883, 0.029540151357650757, -0.016867199912667274, -0.031479429453611374, -0.024053048342466354, -0.040860116481781006, 0.001893238048069179, 0.022203970700502396, 0.04981987923383713, 0.013259243220090866, -0.014063517563045025, -0.039807796478271484, 0.00485195079818368, -0.06139540672302246, 0.02256476692855358, 0.03373439982533455, 0.06112481281161308, 0.03093823418021202, 0.04146144539117813, 0.020099328830838203, 0.0056374333798885345, -0.05856917425990105, 0.05333763733506203, 0.017859388142824173, -0.017528658732771873, 0.014604710973799229, -0.026924381032586098, 0.03102843277156353, 0.005810314789414406, -0.03965746611356735, 0.0004042509535793215, 0.020054230466485023, -0.039236538112163544, 0.021241849288344383, -0.04392687976360321, -0.005148855969309807, -0.06963358074426651, 0.0008460847893729806, 0.0404391884803772, 0.00665217125788331, -0.02046012505888939, -0.019528068602085114, 0.02536093443632126, -0.03902607411146164, -0.07522591203451157, 0.011011786758899689, 0.000663807790260762, -0.01656653732061386, -0.03111863322556019, -0.01746852695941925, -0.013319375924766064, -0.028623128309845924, -0.006381574552506208, -0.036290038377046585, 0.0021441038697957993, -0.037101827561855316, 0.0072722891345620155, -0.002441008575260639, -0.007982606068253517, 0.0007417922606691718, -0.015198520384728909, -0.006783711723983288, 0.0027585839852690697, -0.01641620695590973, 0.0012721808161586523, -0.02650345303118229, -0.043475884944200516, -0.00025227514561265707, -0.01837051659822464, 0.039627399295568466, 0.004329548683017492, -0.034666456282138824, -0.039567265659570694, 0.013154011219739914, 0.011177151463925838, -0.02999114617705345, -0.03635017201304436, 0.002572548808529973, 0.005167647264897823, 0.04137124493718147, 0.03644036874175072, -0.0117033114656806, -0.019543102011084557, 0.003549703862518072, -0.0073812794871628284, 0.0063702999614179134, -0.017002498731017113, -0.0006943438784219325, -0.006975384429097176, 0.033343538641929626, -0.04040912166237831, 0.02999114617705345, -0.02484980598092079, 0.020775821059942245, -0.012289605103433132, -0.007204639725387096, -0.007163298781961203, 0.02483477257192135, -0.026593651622533798, -0.010831388644874096, 0.032952677458524704, 0.021046418696641922, 0.041040513664484024, -0.024443911388516426, 0.005193955264985561, -0.011861159466207027, -0.02184317447245121, -0.002414700575172901, 0.030878102406859398, -0.02032482624053955, 0.03950713202357292, -0.03026174195110798, -0.050090473145246506, 0.030667638406157494, -0.05288664251565933, 0.04281442612409592, -0.04981987923383713, -0.01528120320290327, -0.025811929255723953, -0.022083705291152, 0.006791227962821722, 0.0006887064664624631, 0.021392181515693665, 0.018911710008978844, -0.00033754133619368076, -0.04025879129767418, -0.0320807546377182, -0.004239350091665983, -0.005614883732050657, 0.03607957437634468, -0.017784222960472107, -0.03526778519153595, -0.028638161718845367, -0.038244348019361496, 0.006306408904492855, 0.029870880767703056, 0.02845776453614235, -0.08785375952720642, 0.005840381141752005, -0.026007359847426414, 0.021963439881801605, 0.02926955372095108, 0.0432954877614975, 0.02803683467209339, 0.028668228536844254, 0.1256771832704544, 0.024473978206515312, -0.023812519386410713, -0.015814879909157753, 0.04122091457247734, -0.014732493087649345, 0.0030742804519832134, -0.021347081288695335, -0.005036107264459133, -0.000455692526884377, -0.009049959480762482, 0.0327422134578228, -0.04161177575588226, -0.037913620471954346, 0.008561382070183754, 0.02960028313100338, 0.00681753596290946, 0.001363319344818592, -0.026924381032586098, 0.01694236695766449, 0.008313335478305817, -0.00951598770916462, -0.011740894988179207, 0.054089292883872986, -0.017333228141069412, -0.0029483777470886707, -0.05511154979467392, -0.028758427128195763, 0.001997530460357666, 0.04678317904472351, 0.0021365871652960777, 0.0384548120200634, 0.019212372601032257, 0.009974499233067036, -0.04515960067510605, -0.012740599922835827, 0.0076932176016271114, 0.03403506428003311, 0.03102843277156353, -0.01960323564708233, -0.044047147035598755, -0.019392771646380424, -0.015213553793728352, -0.018355483189225197, -0.017618859186768532, -0.006325200200080872, -0.006426673848181963, 0.011056886054575443, 0.013747820630669594, 0.06572495400905609, 0.033012811094522476, 0.025165501981973648, -0.011410165578126907, -0.014815174974501133, -0.05607366934418678, -0.03935680165886879, -0.013830503448843956, 0.017333228141069412, 0.03238141909241676, 0.00961370300501585, 0.03388473391532898, 0.02256476692855358, 0.021722910925745964, -0.02893882431089878, 0.036380235105752945, -0.037522755563259125, 0.005513410083949566, -0.007114441134035587, -0.005840381141752005, 0.04239349812269211, 0.0010015839943662286, 0.05135326087474823, -0.027345310896635056, -0.0432954877614975, -0.03899600729346275, 0.016160642728209496, -0.05057153478264809, -0.0167018361389637, 0.011966392397880554, -0.030968300998210907, 0.03487692028284073, -0.048527028411626816, -0.010162413120269775, 0.02478967420756817, 0.06446217000484467, -0.011199700646102428, -0.0362599715590477, -0.00702048372477293, -0.00802018865942955, 0.019873831421136856, -0.018971841782331467, -0.012244505807757378, -0.026578620076179504, -0.014033450745046139, -0.0019524310482665896, -0.014664843678474426, -0.06602562218904495, -0.011816060170531273, -0.05300690606236458, -0.0163711067289114, 0.016145609319210052, -0.02170787751674652, 0.015424017794430256, -0.01018496323376894, 0.030427107587456703, 0.03355400264263153, -0.02342165634036064, -0.08430593460798264, 0.10601381212472916, -0.0010419855825603008, 0.03008134476840496, -0.029449952766299248, -0.00012050013901898637, -0.025436099618673325, -0.023677220568060875, 0.010215029120445251, -0.012176856398582458, 0.04726424068212509, 0.02137714810669422, 0.03598937392234802, 0.05324743688106537, 0.013507290743291378, 0.00039321096846833825, -0.01680706813931465, 0.028578029945492744, -0.03469652310013771, -0.02236933633685112, 0.0004617997619789094, 0.007847307249903679, -0.0004535784828476608, 0.016626670956611633, -0.012838315218687057, -0.013950768858194351, -0.023857617750763893, 0.02531583420932293, 0.0048256427980959415, 0.01530375238507986, 0.08400527387857437, 0.02421841397881508, -0.02227913588285446, -0.008749296888709068, -0.0059343380853533745, 0.020475158467888832, -0.010936620645225048, 0.0540592297911644, -0.019347671419382095, 0.0013661379925906658, -0.005607367027550936, 0.00525784632191062, 0.012229472398757935, 0.02346675656735897, -0.030998367816209793, 0.009305523708462715, -0.012116723693907261, 0.022519666701555252, 0.000582534761633724, -0.012740599922835827, -0.0334036722779274, 0.008275751955807209, -0.02023462764918804, -0.01994899846613407, -0.005825347732752562, 0.02751067467033863, 0.008238169364631176, 0.010861455462872982, 0.018505815416574478, -0.008531316183507442, 0.0167018361389637, 0.01204155758023262, 0.024248480796813965, -0.018114952370524406, 0.03502725437283516, 0.0017504231072962284, -0.02551126480102539, 0.008786879479885101, 0.002388392575085163, 0.010899038054049015, -0.03059247136116028, -0.042183034121990204, -0.13505786657333374, -0.01068105734884739, -0.022429468110203743, 0.013552390038967133, -0.003767684567719698, -0.006261309143155813, 0.006776195019483566, -0.05093233287334442, 0.005678774788975716, -0.01619070954620838, -0.024007949978113174, -0.03436579555273056, -0.01161311287432909, -0.004322032444179058, 0.029615316540002823, 0.01579984650015831, 0.018160052597522736, 0.010252612642943859, -0.00022115181491244584, 0.01665673591196537, -0.04116078093647957, -0.01177847757935524, -0.008170519955456257, 0.0018744466360658407, -0.034004997462034225, 0.030231676995754242, -0.023331457749009132, 0.0028055626899003983, -0.0004488806298468262, 0.005197713617235422, -0.01494295708835125, -0.021016351878643036, 0.00675740372389555, 0.018535880371928215, -0.0019599476363509893, 0.00826071947813034, -0.012064107693731785, -0.009027410298585892, 0.011891226284205914, -0.01346970722079277, -0.02654855325818062, 0.02845776453614235, 0.014897857792675495, -0.043806616216897964, 0.009027410298585892, -0.0066108303144574165, -0.019678400829434395, 0.0160403773188591, -0.016160642728209496, 0.0002218564914073795, 0.026924381032586098, 0.012860864400863647, -0.0004866984090767801, -0.021121583878993988, -0.03280234709382057, 0.002053904812783003, -0.00021387012384366244, -0.04368634894490242, 0.0185659471899271, 0.0046640364453196526, -0.0017062631668522954, -0.020339859649538994, 0.02878849394619465, 0.04464847221970558, -0.021196749061346054, 0.0017804893432185054, -0.02217390388250351, -0.03316314145922661, 0.007103166077286005, 0.016055410727858543, -0.01622077450156212, -0.041100647300481796, -0.014364180155098438, 0.04287455976009369, -0.020926153287291527, 0.011357549577951431, -0.017197929322719574, -0.017859388142824173, 0.017453493550419807, -0.04897802323102951, 0.008899628184735775, 0.015920111909508705, -0.03050227276980877, 0.008914661593735218, -0.011966392397880554, -0.010102280415594578, -0.015784813091158867, 0.012101690284907818, -0.00475799385458231, -0.013026229105889797, -0.010433009825646877, 0.02841266430914402, -0.026774050667881966, 0.0007145446725189686, -0.01546911709010601, -0.0014920406974852085, 0.007189606782048941, 0.028578029945492744, -0.010673540644347668, -0.02412821538746357, -0.012748115696012974, 0.022399401292204857, 0.009966982528567314, -0.05276637524366379, -0.0007023302605375648, -0.018445681780576706, -0.026728950440883636, -0.0008301120833493769, 0.03050227276980877, -0.020956218242645264, 0.03337360545992851, -0.018956810235977173, -0.01679203473031521, 0.04221310093998909, 0.011312449350953102, -0.014439346268773079, -0.03226115182042122, 0.009057476185262203, 0.01812998577952385, -0.0072309477254748344, -0.0013567423447966576, -0.004885775502771139, -0.005216504912823439, -0.028923790901899338, -0.049038153141736984, 0.033283405005931854, 0.02256476692855358, 0.030336908996105194, -0.05003034323453903, -0.040619585663080215, 0.002042629988864064, -0.007411345839500427, -0.019618269056081772, -0.03656063601374626, 0.009974499233067036, -0.05012053996324539, -0.00031358221895061433, -0.019001908600330353, 0.056795261800289154, 0.016250841319561005, 0.047895632684230804, 0.020445091649889946, -0.016145609319210052, -0.04182223975658417, 0.0062725841999053955, 0.0234066229313612, -0.0023245017509907484, -0.013913185335695744, -0.024068081751465797, -0.013567423447966576, -0.04293469339609146, 0.01320662721991539, 0.014025934040546417, -0.05859924107789993, 0.025631530210375786, -0.06319938600063324, -0.026473388075828552, -0.005333011969923973, -0.0015023760497570038, 0.008433599956333637, -0.003374943509697914, 0.0013999625807628036, 0.022264104336500168, 0.0016310974024236202, 0.018926743417978287, 0.008380983956158161, -0.014461895450949669, -0.0173632949590683, -0.010004565119743347, -0.012244505807757378, 0.06229739636182785, -0.005378111265599728, -0.02898392453789711, -0.026052458211779594, 0.014514511451125145, -0.010320261120796204, -0.027766238898038864, -0.0182352177798748, -0.010064697824418545, -0.014882824383676052, 0.02393278479576111, 0.06289872527122498, -0.03175002336502075, -0.03232128545641899, 0.009936915710568428, -0.015484150499105453, -0.008208103477954865, -0.037913620471954346, -0.008478700183331966, -0.007967572659254074, -0.012477518990635872, -0.035628579556941986, -0.020535290241241455, -0.016160642728209496, 0.0018434406956657767, -0.05168398842215538, 0.006975384429097176, 0.005825347732752562, -0.005708840675652027, -0.02797670289874077, 0.03463638946413994, 0.0001266073522856459, 0.04530993103981018, 0.0202195942401886, 0.014837725088000298, 0.01566454768180847, -0.05448015779256821, 0.015935145318508148, 0.014379213564097881, -0.038665276020765305, -0.00522402161732316, -0.011951358988881111, -0.01201900839805603, 0.02370728738605976, -0.02641325443983078, -0.008884594775736332, 0.006678479257971048, 0.010260128416121006, -0.006930284667760134, 0.015078254975378513, 0.05742665380239487, -0.00802018865942955, -0.023737352341413498, -0.02859306149184704, 0.015604415908455849, -0.01880647800862789, 0.005017315503209829, -0.0051112729124724865, -0.026247890666127205, 0.021677810698747635, 0.002102762693539262, 0.02707471325993538, 0.006077153142541647, 0.005073689855635166, 0.00631768349558115, 0.0025218119844794273, 0.012500069104135036, -0.008997343480587006, 0.013402058742940426, -0.017303163185715675, 0.000422807497670874, 0.00605460349470377, 0.017258062958717346, -0.02283536270260811, -0.008080321364104748, 0.01529623568058014, 0.011868676170706749, 0.054329823702573776, -0.012567718513309956, 0.017934555187821388, 0.01994899846613407, 0.018250251188874245, 0.017678990960121155, -0.03887574002146721, -0.003980027977377176, -0.0007145446725189686, -0.031479429453611374, -0.0008888353477232158, -0.011598079465329647, -0.03644036874175072, 0.02788650430738926, -0.015814879909157753, -0.04146144539117813, -0.032862477004528046, -0.010395427234470844, -0.02480470761656761, -0.013311859220266342, 0.03583904355764389, 0.01685216836631298, -0.01446941215544939, -0.15213553607463837, -0.022970661520957947, 0.023105960339307785, -0.01494295708835125, -0.011590562760829926, 0.0038785540964454412, -0.011755927465856075, 0.003957478329539299, -0.029299620538949966, 0.005994470790028572, 0.005656224675476551, -0.015318785794079304, -0.024579210206866264, -0.011552980169653893, 0.0025650321040302515, -0.025872061029076576, 0.018626080825924873, -0.01168827898800373, 0.042904626578092575, -0.021572578698396683, -0.012597784399986267, -0.0032321284525096416, -0.018535880371928215, 0.008952244184911251, -0.018761377781629562, -0.026999548077583313, -0.01261281780898571, 0.03574884310364723, 0.02046012505888939, 0.008674130775034428, -0.01746852695941925, 0.01546911709010601, 0.025285767391324043, 0.012003974989056587, -0.01094413734972477, -0.002813079161569476, -0.03782342001795769, -0.031719960272312164, -0.00020999439584556967, -0.0048256427980959415, -0.017047598958015442, -0.047143977135419846, 0.01970846764743328, -0.020835954695940018, 0.020535290241241455, -0.010433009825646877, 0.01822018437087536, -0.008200586773455143, 0.020685622468590736, -0.032952677458524704, -0.001253389404155314, 0.00575769878923893, -0.02046012505888939, 0.025195568799972534, -0.011079436168074608, -0.011041852645576, -0.0061109778471291065, -0.008358434773981571, 0.005979437846690416, 0.006238759495317936, -0.02127191610634327, 0.03532791510224342, 0.023301390931010246, -0.030817968770861626, -0.027661006897687912, -0.010786289349198341, 0.024338679388165474, 0.032862477004528046, 0.02432364597916603, -0.051383327692747116, -0.0011866796994581819, 0.017152830958366394, 0.02821723371744156, 0.00908754300326109, 0.0077571081928908825, 0.01632600650191307, 0.0017457251669839025, 0.022910529747605324, -0.07191861420869827, 0.01685216836631298, 0.01617567613720894, -0.028818558901548386, 0.00809535477310419, -0.00885452888906002, 0.0009466190240345895, 0.009222840890288353, 0.01380043663084507, -0.026052458211779594, -0.001213927287608385, 0.023917751386761665, 0.05027087405323982, -0.029585249722003937, 0.023872651159763336, 0.01234973780810833, -0.004540013149380684, -0.015393951907753944, 0.0017025049310177565, 0.004096535034477711, 0.011966392397880554, 0.004318274091929197, 0.030201610177755356, 0.01946793682873249, -0.02650345303118229, -0.027495641261339188, 0.009200291708111763, 0.01628090813755989, 0.006498081609606743, -0.014740008860826492, -0.003202062100172043, -0.010726156644523144, 0.0027097263373434544, 0.008831978775560856, -0.0038184216246008873, 0.03505731746554375, 0.007572952192276716, 0.008914661593735218, 0.023451723158359528, 0.016070444136857986, 0.030382007360458374, -0.02764597348868847, -0.006614588666707277, 0.04422754421830177, -0.023722318932414055, -0.005043623968958855, -0.022925563156604767, 0.0021704118698835373, 0.03445599228143692, 0.014905373565852642, -0.016536470502614975, -0.009388205595314503, -0.016596604138612747, 0.02935975231230259, -0.02197847329080105, 0.011462781578302383, -0.006039570551365614, -0.029855847358703613, 0.008726746775209904, 0.005656224675476551, -0.004566321149468422, 0.04116078093647957, 0.005502135027199984, 0.025962259620428085, 0.01984376646578312, -0.0057464237324893475, 0.006129769142717123, 0.012432419694960117, 0.001056079170666635, -0.009343106299638748, -0.023662187159061432, 0.001283455640077591, -0.002700330689549446, -0.008696680888533592, -0.02456417679786682, -0.015965212136507034, -0.010868971236050129, 0.014228882268071175, -0.0305473729968071, -0.03803388401865959, -0.009869266301393509, 0.020520256832242012, 0.05267617851495743, 0.034816790372133255, 0.01420633215457201, 0.003733860095962882, 0.02518053539097309, -0.030397040769457817, -0.021001318469643593, 0.006261309143155813, -0.016551503911614418, 0.0259321928024292, -0.010696090757846832, -0.013657622039318085, 0.04260396212339401, 0.006539422553032637, 0.044618405401706696, 0.015724681317806244, -0.003059247275814414, 0.004622695501893759, -0.01537140179425478, 0.024955037981271744, -0.01194384228438139, 0.011868676170706749, -0.007787174545228481, 0.012176856398582458, 0.02689431607723236, -0.012297121807932854, 0.008245686069130898, 0.014138682745397091, 0.0074602034874260426, 0.0327422134578228, 0.012545168399810791, 0.036620765924453735, 0.015424017794430256, 0.09482914954423904, 0.011583046056330204, -0.02103138528764248, 0.007937505841255188, 0.002161016222089529, -0.02984081394970417, -0.036710966378450394, 0.004284449387341738, 0.009012376889586449, 0.0059230634942650795, -0.037282224744558334, -0.043806616216897964, 0.01228208839893341, 0.00951598770916462, -0.007343696430325508, -0.003824058920145035, 0.0463622510433197, -0.017678990960121155, -0.0022756438702344894, 0.000869574083480984, 0.028968891128897667, -0.019964030012488365, -0.004780543502420187, 0.019392771646380424, 0.011650695465505123, -0.03460632637143135, -0.0012045316398143768, -0.018550913780927658, -0.011222250759601593, 0.003440713509917259, 0.006133527494966984, 0.002689055632799864, 0.02907412312924862, 0.0185659471899271, -0.009673835709691048, -0.011485330760478973, 0.005438243970274925, 0.018956810235977173, -0.0012439936399459839, -0.007448928896337748, 0.0035910450387746096, 0.005032348912209272, -0.02997611276805401, 0.008847012184560299, -0.011289900168776512, -0.004731685854494572, 0.009358139708638191, 0.03592924401164055, 0.013544873334467411, -0.03382460027933121, -0.01794958859682083, 0.0113725820556283, 0.001508013461716473, 0.004791818559169769, 0.04473867267370224, 0.008704197593033314, -0.0007183029665611684, 0.02845776453614235, 0.013394542038440704, 0.0002729457337409258, -0.021151650696992874, 0.02360205538570881, 0.006107219494879246, 0.022624898701906204, 0.04801589995622635, 0.029449952766299248, 0.03454619273543358, -0.002273764694109559, 0.014852757565677166, -0.00013717754336539656, -0.0038973456248641014, 0.01599527709186077, -0.04275429621338844, -0.0006849481724202633, 0.010884004645049572, 0.013838020153343678, 0.013319375924766064, -0.019873831421136856, 0.012049074284732342, 0.013341926038265228, 0.03568871319293976, 0.0035215166863054037, 0.011402648873627186, -0.001270301640033722, 0.006573247257620096, 0.017814289778470993, -0.014356663450598717, -0.0027435508091002703, -0.04392687976360321, -0.0006074334378354251, -0.012748115696012974, 0.007321146782487631, 0.002418458927422762, -0.009733968414366245, -0.012409870512783527, 0.043235354125499725, 0.0028807285707443953, 0.026308022439479828, 0.03830448165535927, 0.0025424824561923742, 0.0173632949590683, 0.017588792368769646, -0.0013435883447527885, 0.026338089257478714, -0.002348930574953556, 0.02483477257192135, -0.01865614578127861, 0.012597784399986267, 0.010846422053873539, -0.0017598187550902367, -0.02445894479751587, 0.034155331552028656, 0.015213553793728352, 0.006385332904756069, -0.03650050237774849, -0.02432364597916603, 0.0017767311073839664, -0.016055410727858543, -0.005167647264897823, 0.014514511451125145, 0.004671553149819374, -0.004149151034653187, 0.010177446529269218, 0.020580390468239784, -0.03505731746554375, -0.008035222068428993, 0.00685136066749692, -0.007073099724948406, 0.021497413516044617, -0.006546939257532358, 0.014364180155098438, -0.0037225852720439434, 0.0006163594080135226, 0.013905668631196022, -0.016205741092562675, 0.028006769716739655, 0.025661597028374672, 0.015679581090807915, 0.009846717119216919, 0.019964030012488365, 0.017243029549717903, -0.032862477004528046, 0.02270006574690342, -0.016927333548665047, 0.014822691679000854, -0.016356073319911957, -0.0037564097438007593, 0.03211082145571709, 0.02017449587583542, -0.0010316503467038274, -0.013341926038265228, -0.008523799479007721, 0.01566454768180847, 0.0032678323332220316, -0.002059542341157794, 0.012289605103433132, -0.013086361810564995, 0.0889962837100029, -0.02540603280067444, -0.018971841782331467, 0.0028281123377382755, -0.013672655448317528, -0.0005750182317569852, -0.004915841855108738, -0.01808488555252552, 0.009463371708989143, 0.002476712455973029, -0.011891226284205914, 0.03529784828424454, -0.005524684675037861, 0.021347081288695335, 0.024233447387814522, 0.0023846342228353024, 0.008328367955982685, 0.023902717977762222, 0.0037564097438007593, 0.03193042427301407, 0.0334036722779274, 0.023045828565955162, 0.009989531710743904, 0.017438460141420364, -0.03875547647476196, 0.011605596169829369, -0.014882824383676052, -0.00023336625599768013, 0.034486059099435806, 0.0364704355597496, -0.016912300139665604, -0.021527478471398354, -0.02103138528764248, 0.034155331552028656, -9.95359368971549e-05, 0.0075842272490262985, -0.0018331054598093033, 0.052375514060258865, -0.01652143895626068, 0.001406539580784738, -0.013138977810740471, 0.010718639940023422, -0.01599527709186077, -0.012259538285434246, -0.0069490764290094376, 0.03041207417845726, -0.009779067710042, 0.007546644192188978, -0.0014056001091375947, 0.0023320182226598263, 0.007967572659254074, -0.006129769142717123, -0.023000728338956833, -0.0009057476418092847, 0.005731390789151192, 0.006937801372259855, 0.002707847161218524, 0.05297683924436569, 0.015236102975904942, 0.006539422553032637, -0.05995222553610802, -0.026533519849181175, -0.03165982663631439, 0.016581570729613304, -0.0034952086862176657, -0.03074280358850956, -0.009425788186490536, 0.006347749847918749, -0.012094173580408096, 0.01979866623878479, -0.009260423481464386, -0.0016357952263206244, -0.008959760889410973, -0.01794958859682083, 0.025586431846022606, 0.04882768914103508, -0.0023959092795848846, -0.0026345604564994574, 0.040138524025678635, 0.01430404745042324, -0.009215324185788631, -0.025045236572623253, -0.025255702435970306, -0.015454083681106567, -0.004994765855371952, 0.002655231161043048, 0.027119813486933708, -0.005118789616972208, -0.015875011682510376, 0.022489601746201515, -0.033012811094522476, -0.006219968199729919, 0.010568308643996716, 0.0057464237324893475, 0.006870151963084936, -0.020775821059942245, -0.02417331375181675, -0.0185659471899271, 0.00033965535112656653, -0.03764302283525467, -0.00904244277626276, -0.01168076228350401, -0.032952677458524704, -0.015408984385430813, -0.009298007003962994, -0.01779925636947155, -0.03698156401515007, -0.0008042738190852106, 0.020685622468590736, 0.011094468645751476, -0.00588923878967762, -5.320327909430489e-05, 0.042183034121990204, 0.007159540429711342, 0.011289900168776512, 0.02960028313100338, 0.024338679388165474, 0.007324905134737492, -0.007475236896425486, -0.008704197593033314, -0.0010091005824506283, 0.01746852695941925, 0.01999409683048725, 0.007877374067902565, -0.019062042236328125, 0.004096535034477711, -0.017633892595767975, 0.0008625272894278169, -0.016476338729262352, -0.024113181978464127, -0.0008977612596936524, 0.015033155679702759, 0.013424607925117016, -0.012221955694258213, 0.00802018865942955, 0.033283405005931854, -0.005276637617498636, -0.0028018043376505375, -0.03532791510224342, 0.006366541609168053, 0.030472205951809883, 0.013394542038440704, -0.01463477686047554, 0.014920406974852085, 0.009245391003787518, 0.012815765105187893, 0.008193070068955421, -0.010455559939146042, 0.01918230764567852, 0.022083705291152, -0.0035440665669739246, -0.013928218744695187, 0.003671848215162754, 0.010726156644523144, -0.008809429593384266, -0.021121583878993988, 0.002424096455797553, -0.03235135227441788, 0.016761967912316322, -0.005163888912647963, 0.015243619680404663, 0.012274571694433689, -0.010861455462872982, 0.02280529774725437, 0.01927250623703003, -0.018836544826626778, -0.019618269056081772, -0.005517167970538139, 0.015439051203429699, 0.002067058812826872, 0.02023462764918804, 0.011981424875557423, -0.01619070954620838, -0.026924381032586098, -0.0033016568049788475, 0.0010852059349417686, -0.029449952766299248, 0.0023639637511223555, -0.01898687519133091, -0.002783013042062521, -0.014003384858369827, 0.008012671954929829, 0.027811337262392044, 0.02070065587759018, -0.015965212136507034, -0.04212290421128273, 0.020685622468590736, 0.009267940185964108, 0.004957183264195919, -0.0014215727569535375, 0.014815174974501133, -0.019437870010733604, 0.017258062958717346, 0.005712599027901888, 0.0032809863332659006, 0.03830448165535927, -0.002243698574602604, 0.03430566191673279, 0.03355400264263153, 0.030682669952511787, 0.001743846107274294, -0.0013294947566464543, -0.020760787650942802, -0.0002663687337189913, -0.03346380591392517, 0.05072186887264252, -0.0038015092723071575, 0.0182352177798748, -0.011763444170355797, -0.013755337335169315, 0.02337655797600746, 0.006377816200256348, -0.014582160860300064, 0.010169929824769497, 0.009733968414366245, 0.0006882366724312305, -0.023436689749360085, -0.021347081288695335, -0.04440794140100479, -0.04546026140451431, -0.010132347233593464, 0.0023714802227914333, 0.009343106299638748, 0.027390409260988235, -0.025781862437725067, 0.007061825133860111, 0.005543475970625877, 0.009561087004840374, 0.005547234322875738, -0.000779844936914742, -0.015251136384904385, -0.038244348019361496, 0.0050849649123847485, 0.0041002933867275715, 0.0029371026903390884, 0.011425198055803776, 0.014785109087824821, -0.017017532140016556, 0.028713326901197433, 0.023090926930308342, -0.01632600650191307, 0.014995573088526726, -0.02322622574865818, 0.03926660120487213, -0.034185394644737244, 0.056945592164993286, 0.012379803694784641, 0.024053048342466354, -0.02197847329080105, 0.0012815765803679824, -0.019618269056081772, 0.006712303962558508, -0.01846071518957615, -0.029164321720600128, 0.04146144539117813, -0.05177418887615204, -0.0010654749348759651, -0.014191298745572567, -0.0004516993649303913, -0.025345901027321815, -0.0002891533658839762, 0.005269120912998915, 0.02023462764918804, 0.001051381346769631, 0.00011603716848185286, 0.023256292566657066, -0.025691663846373558, 0.021046418696641922, -0.02465437538921833, 0.022053640335798264, 0.0016987465787678957, 0.01817508600652218, -0.006979142781347036, -0.021046418696641922, 0.009433304890990257, 0.018866609781980515, 0.00022373563842847943, -0.004742960445582867, -0.014236398041248322, -0.02859306149184704, 0.01940780319273472, 0.01623580791056156, -0.010027115233242512, -0.00635526655241847, -0.000792998936958611, 0.02632305584847927, -0.00951598770916462, -0.004509946797043085, -0.003382459981366992, -0.0008301120833493769, -0.006475531961768866, 0.04443800821900368, 0.024143248796463013, -0.0342755950987339, 0.004882017150521278, -0.012116723693907261, -0.025962259620428085, -0.030186576768755913, -0.007681942544877529, 0.03496712073683739, 0.004746718797832727, 0.01799468696117401, 0.01619070954620838, 0.02683418244123459, 0.0377933531999588, 0.011906259693205357, 0.011334999464452267, 0.0270296148955822, 0.012928513810038567, 0.010493142530322075, -0.020625488832592964, 0.001008160994388163, 0.015266169793903828, 0.0053969030268490314, 0.006017020437866449, 0.011455264873802662, -0.023962849751114845, 0.025345901027321815, 0.003138171276077628, 0.03454619273543358, 0.005994470790028572, -0.005765215028077364, 0.0011021182872354984, -0.0017607583431527019, 0.04684331268072128, -0.021873241290450096, -0.0004162304976489395, 0.021091517060995102, 0.03893587365746498, -0.021001318469643593, 0.02836756408214569, 0.0005933398497290909, 0.01722799614071846, -0.019302571192383766, 0.021783042699098587, 0.032952677458524704, 0.021737942472100258, 0.014499478973448277, 0.04579099267721176, -0.026774050667881966, -0.024819741025567055, 0.002213632222265005, -0.017784222960472107, -0.02188827469944954, -0.013860569335520267, 0.005502135027199984, -0.022354302927851677, -0.007125715725123882, -0.03065260499715805, -0.005678774788975716, 0.04972967877984047, 0.020835954695940018, 0.01370272133499384, 0.012244505807757378, 0.03668089956045151, 0.010049664415419102, 0.02079085446894169, -0.013740303926169872, -0.0001191495030070655, -0.0021534995175898075, -0.00039415055653080344, -0.016025343909859657, 0.00718584842979908, -0.0004700210120063275, -0.008320851251482964, -0.0011011786991730332, -0.005998229142278433, -0.0426340289413929, -0.010756222531199455, -0.009440821595489979, -0.005182680673897266, 0.0014751284616068006, 0.016491372138261795, 0.030231676995754242, -0.014807658270001411, -0.0032321284525096416, -0.0028938825707882643, -0.009328072890639305, 0.011417681351304054, -0.009034927003085613, 0.03619983792304993, -0.02360205538570881, 0.024473978206515312, -0.015905078500509262, -0.006727337371557951, 0.0021628953982144594, -0.01979866623878479, 0.007674425840377808, -0.0023959092795848846]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" NaturalQuestions open-book/closed-
book, and ROUGE-L (a measure of similarity to the refer-
ence summaries) for XSUM and CNN/DailyMail.
Figure 8 demonstrates the scores and speedup for pipeline-
based inference with varying confidence thresholds. En-
couragingly, in many cases, inference with early exiting
achieves 2×or higher speedup compared to full-model in-
2We observed empirically that the actual wall-clock latency be-
tween these two cases might differ by up to 2%, which is negligible
compared to the early-exit speedup.
8
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
ference, with comparable or even better evaluation scores.
Table 3 provides example texts generated by our 7B early-
exit model, showing that speedup can be achieved with
minor or no impact on the resulting sequence. Table 4
further demonstrates the confidence at each exit for each
token, confirming the existence of easy tokens that can be
predicted correctly with high confidence at early exits. See
also Appendix B.1 for an empirical comparison between the
pipeline-based method and KV recomputation, which are
shown to perform similarly in our setting. It is worth noting
that performance of early-exit inference might be improved
in many ways, e.g. using early exits of different structures,
other decoding mechanisms and exit conditions, or simply
more extensive and sufficient pre-training. We also conjec-
ture that early exiting can, in principle, bring higher speedup
for larger LLMs, as expressivity of early exits grows with
the model capacity, which allows them to make confident
and accurate predictions for a larger proportion of tokens.
6. Conclusions
We have introduced EE-LLM , a system for large-scale train-
ing and inference of early-exit LLMs with 3D parallelism.
For training, we have presented how to execute backprop-
agation of the early-exit training objective across pipeline
stages, performance optimizations for minimizing the com-
putational overhead compared to training standard LLMs,
and advanced features for fine-grained control and opti-
mization of the training process. For inference, we have
introduced our design and implementation of two inference
methods, one based on KV recomputation and the other
based on a new type of pipeline parallelism, both of which
are compatible with KV caching for autoregressive genera-
tion. Along the way, we have discovered some interesting
chemical reactions between early exiting and pipeline par-
allelism, which is likely because it is both along the depth
dimension that an early-exit model executes forward com-
putation selectively and gets partitioned into pipeline stages.
We hope that EE-LLM will be a helpful tool for future study
and applications of early-exit LLMs at scales as large as
those of standard LLMs. It is worth noting that many ideas
presented in this work can be extended to more general
neural network architectures, deep learning frameworks,
hardware platforms, or other broader settings. It would be
exciting to see further developments in these aspects.
Acknowledgements
We would like to thank the reviewers for their constructive
and valuable feedback that helps improve this work.Impact Statement
This paper presents work whose goal is to advance tech-
niques for training and inference of early-exit large language
models. Therefore, it bears potential societal consequences
similar to those of prior literature on the technical aspects
of LLM training and inference, e.g. misuse of the resulting
pre-trained LLMs. Other than that, we see nothing that we
feel must be specifically highlighted here.
References
Ba, J., Kiros, J. R., and Hinton, G. E. Layer normalization.
ArXiv , abs/1607.06450, 2016.
Bae, S., Ko, J., Song, H., and Yun, S.-Y . Fast and ro-
bust early-exiting framework for autoregressive language
models with synchronized parallel decoding. In EMNLP ,
2023.
Bahdanau, D., Cho, K., and Bengio, Y . Neural machine
translation by jointly learning to align and translate. In
ICLR , 2015.
Bengio, E., Bacon, P.-L., Pineau, J., and Precup, D. Condi-
tional computation in neural networks for faster models.
ArXiv , abs/1511.06297, 2015.
Bengio, Y ., L ´eonard, N., and Courville, A. C. Estimating
or propagating gradients through stochastic neurons for
conditional computation. ArXiv , abs/1308.","[0.01873132772743702, 0.027042007073760033, 0.04044818505644798, -0.012056945823132992, -0.0006481505697593093, 0.017339037731289864, -0.0004611064214259386, 0.016951492056250572, -0.03608471900224686, 0.057012129575014114, 0.007829838432371616, -0.020999182015657425, -0.033328842371702194, 0.01576015166938305, -0.027888864278793335, -0.025305233895778656, 0.0026643697638064623, 0.004259403329342604, 0.02246323972940445, 0.04360595718026161, 0.0024311253800988197, -0.027042007073760033, 0.01850167103111744, 0.026295624673366547, 0.03169254586100578, -0.037060756236314774, 0.03574023395776749, 0.015372605994343758, 0.004345524590462446, -0.056179627776145935, 0.04116585850715637, -0.04056301340460777, -0.0489741675555706, -0.03663014993071556, -0.02672623097896576, 0.032266683876514435, 0.01351382676512003, 0.011669401079416275, -0.020381979644298553, 0.023554105311632156, 0.016578301787376404, -0.05787334218621254, -0.02863524667918682, 0.0315203033387661, -0.02985529601573944, 0.042055778205394745, 0.02428613416850567, 0.003249275265261531, -0.01277462113648653, 0.05919386446475983, -0.015487434342503548, 0.012071299366652966, -0.04986408352851868, 0.013111929409205914, -0.029826588928699493, -0.018530378118157387, -0.003582994220778346, -0.004496236331760883, 0.008159969002008438, -0.05167262628674507, 0.025692777708172798, -0.062466464936733246, 0.0006041929591447115, -0.0030375609640032053, -0.028506064787507057, 0.01052829809486866, -0.0513281412422657, 0.011870350688695908, -0.0046469480730593204, 0.009186244569718838, -0.0033443672582507133, 0.005310797598212957, 0.016851017251610756, -0.027587441727519035, -0.016592655330896378, 0.009229305200278759, -0.017310330644249916, 0.07894428819417953, -0.02688411995768547, -0.008238913491368294, 0.007130104582756758, -0.00038552624755539, 0.030630385503172874, -0.03975921496748924, -0.007686302997171879, -0.04489777237176895, 0.009430254809558392, -0.003242098493501544, -0.03174996003508568, 0.0003328219463583082, -0.01001157145947218, 0.00822455994784832, -0.010262757539749146, 0.011805759742856026, 0.0852024182677269, 0.04435233771800995, 0.05178745463490486, -0.06372956931591034, 0.06952839344739914, 0.05942352116107941, -0.027745328843593597, 0.017597399652004242, 0.05241901054978371, -0.0484287329018116, 0.04954830929636955, -0.02870701439678669, -0.030659092590212822, -8.01217247499153e-05, -0.0048622507601976395, -0.03229539096355438, -0.05764368548989296, 0.0021799388341605663, -0.015817565843462944, -0.024702386930584908, -0.0053933304734528065, -0.060629215091466904, -0.06705958396196365, 0.0054507446475327015, 0.0326685830950737, 0.027443906292319298, -0.00925083551555872, -0.0030626796651631594, -0.013499473221600056, -0.017310330644249916, 0.0036045245360583067, -0.016118988394737244, 0.03487902134656906, -0.019707364961504936, 0.019133225083351135, -0.04033335670828819, 0.012415783479809761, 0.025592302903532982, 0.035539284348487854, -0.037146877497434616, -0.060169901698827744, 0.005881349556148052, -0.03545316308736801, -0.01640605926513672, -0.02585066668689251, -0.0055763376876711845, 0.0215876754373312, -0.02467367984354496, -0.007923136465251446, -0.003940037917345762, -0.05971059203147888, 0.0414242222905159, -0.02002314291894436, 0.014784112572669983, -0.00858339760452509, 0.006667204201221466, 0.013822427950799465, -0.023066086694598198, -0.02790321782231331, -0.011906234547495842, -0.04085008054971695, -0.015961099416017532, -0.02425742708146572, 0.04010370001196861, 0.07142305374145508, -0.026396099478006363, 6.526360084535554e-05, 0.049060288816690445, 0.03350108489394188, 0.01705196686089039, 0.010549827478826046, 0.03863964229822159, -0.06499268114566803, -0.0026500162202864885, -0.05856230854988098, -0.02824770286679268, -0.007980549708008766, 0.0022301762364804745, -0.04036206379532814, -0.005239030346274376, 0.009710147976875305, -0.03815162181854248, -0.043921731412410736, -0.06080145761370659, -0.0049304296262562275, -0.08434120565652847, -0.02147284708917141, 0.048141662031412125, 0.015243425033986568, -0.003713970072567463, -0.043806903064250946, -0.01143974531441927, -0.0008773581357672811, 0.036457907408475876, -0.006085887085646391, 0.016922784969210625, -0.011525866575539112, 0.03935731574892998, 0.05201711133122444, 0.02866395376622677, 0.010198166593909264, 0.0033371904864907265, 0.06568165123462677, 0.012961217202246189, -0.0019269583281129599, -0.026941534131765366, 0.03783584386110306, 0.03487902134656906, -0.024070831015706062, -0.06723182648420334, 0.03861093521118164, -0.014827173203229904, -0.014202795922756195, -0.0027271665167063475, -0.03011365793645382, -0.03640049323439598, 0.01854473166167736, 0.02147284708917141, 0.03235280513763428, 0.014647753909230232, 0.00161118118558079, -0.0166357159614563, -0.043835610151290894, 0.028233349323272705, 0.03975921496748924, 0.02547747641801834, 0.02128625102341175, 0.00040683223051019013, 0.02048245444893837, 0.02181733213365078, -0.06217939406633377, 0.011511513032019138, 0.016851017251610756, -0.050352104008197784, 0.019635597243905067, -0.004011805169284344, 0.05207452550530434, -0.03080262616276741, -0.020769525319337845, -0.03780713677406311, 0.020080557093024254, -0.03975921496748924, 0.0015582526102662086, -0.017181148752570152, -0.011138321831822395, -0.025147344917058945, 0.0350225567817688, 0.034017812460660934, 0.015128596685826778, 0.0077293636277318, -0.01649218052625656, 0.05750015005469322, -0.03789325803518295, -0.05376823991537094, 0.014654930680990219, 0.01557355560362339, -0.0024329195730388165, -0.023310095071792603, -0.020123617723584175, 0.013025808148086071, -0.02239147201180458, 0.017224209383130074, -0.03384556993842125, -0.03330013528466225, -0.02455885149538517, 0.012961217202246189, -0.0259654950350523, -0.00630118977278471, 0.0016883312491700053, 0.009243658743798733, 0.006975804455578327, 0.000790788559243083, -0.014131028205156326, 0.01896098256111145, 0.0022032633423805237, -0.023654580116271973, 0.016118988394737244, -0.050007618963718414, 0.0007051160209812224, -0.004402938298881054, -0.031434182077646255, -0.025836313143372536, 0.03777842968702316, 0.02718554250895977, -0.029108913615345955, 0.00477971788495779, 0.016391705721616745, 0.03232409805059433, 0.047079503536224365, 0.010650302283465862, -0.006753324996680021, -0.010090515948832035, -0.03608471900224686, -0.018185893073678017, -0.023066086694598198, -0.03723299875855446, 0.01606157422065735, -0.0033425730653107166, 0.027587441727519035, -0.040074992924928665, 0.05884937942028046, -0.011131145060062408, 0.01587498001754284, -0.008267620578408241, -0.007148046512156725, -0.0019072223221883178, 0.03700334206223488, 7.171146717155352e-05, -0.009042710065841675, 0.031807370483875275, 0.0012074888218194246, 0.06516492366790771, -0.04306052252650261, 0.00915753748267889, -0.020166678354144096, 0.019549477845430374, 0.008454215712845325, 0.014418098144233227, -0.0071444581262767315, 0.028118520975112915, -0.03602730482816696, -0.02737213857471943, -0.0017008905997499824, -0.07848497480154037, 0.011052200570702553, -0.03858222812414169, -0.0016515504103153944, -0.028233349323272705, -0.01739645004272461, -0.005841877311468124, 0.015157303772866726, 0.04974925518035889, 0.03835257142782211, -0.012853565625846386, -0.01743951067328453, -0.022018279880285263, 0.0016362998867407441, 0.0015116037102416158, 0.025707131251692772, -0.030084950849413872, -0.022262290120124817, -0.05592126399278641, -0.06349992007017136, 0.025563595816493034, 0.0735473707318306, 0.0008979912963695824, -0.05813170596957207, 0.03373074159026146, -0.023812469094991684, 0.0425725020468235, 0.040821373462677, 0.015013768337666988, 0.009150360710918903, 0.016879724338650703, 0.09381452202796936, 0.025721484795212746, -0.013377469033002853, -0.025520535185933113, 0.02052551507949829, -0.011741168797016144, 0.039730507880449295, 0.0066707925871014595, -0.0009006825857795775, -0.0031147110275924206, 0.01317651942372322, 0.0344197116792202, -0.03246763348579407, -0.013456413522362709, 0.018343782052397728, 0.03114711120724678, -0.016305584460496902, 0.0006674380856566131, -0.03559669852256775, 0.025290880352258682, 0.022032633423805237, -0.0029460573568940163, -0.00936566386371851, 0.048715803772211075, -0.02974046766757965, 0.007700656540691853, -0.06315543502569199, 0.00502731604501605, -0.0007131898892112076, 0.020884353667497635, 0.015774505212903023, 0.05471557006239891, 0.01815718598663807, 0.04564415290951729, -0.02909456007182598, -0.02889361046254635, -0.01315498910844326, 0.03665885701775551, -0.0013061692006886005, -0.030888747423887253, -0.0011626341147348285, 0.024573205038905144, -0.025606656447052956, -0.00179867388214916, -0.018028005957603455, 0.025262173265218735, 0.01957818493247032, 0.002463420620188117, 0.01946335658431053, 0.01911887153983116, 0.05566290020942688, 0.016004160046577454, -0.01427456270903349, -0.021157069131731987, -0.0154587272554636, -0.0175112783908844, 0.028692660853266716, 0.020080557093024254, 0.05086883157491684, 0.02341056987643242, 0.03838127851486206, 0.026625756174325943, 0.0384673997759819, -0.023310095071792603, 0.03921378031373024, -0.06321284919977188, 0.023740701377391815, -0.019291114062070847, 0.030429435893893242, 0.04222801700234413, 0.010399116203188896, 0.07572910189628601, 0.0014811025466769934, -0.01762610673904419, -0.05494522675871849, -0.019635597243905067, -0.00258004292845726, 0.0007706039468757808, 0.01052829809486866, -0.053624704480171204, 0.017468217760324478, -0.053280219435691833, -0.028951024636626244, 0.00989674311131239, 0.0076647731475532055, -0.01820024661719799, -0.028721367940306664, -0.020855646580457687, -0.011073730885982513, 0.036831099539995193, -0.0262669175863266, -0.038323864340782166, -0.003039355156943202, -0.013470767065882683, -0.04199836403131485, 0.025821959599852562, -0.0175112783908844, -0.012516258284449577, -0.05976800620555878, -0.002458038041368127, -0.002391653135418892, -0.043950438499450684, 0.053509876132011414, -0.003204420441761613, 0.038438692688941956, 0.034850314259529114, -0.01587498001754284, -0.05847618728876114, 0.10564181208610535, -0.018257660791277885, 0.06229422241449356, 0.006150478031486273, 0.020654696971178055, -0.016477826982736588, -0.014224326238036156, 0.005999766290187836, -0.0031147110275924206, 0.05284961313009262, 0.004248638171702623, 0.020812585949897766, 0.030974868685007095, -0.01584627293050289, 0.01564532332122326, -0.028965378180146217, 0.03769231215119362, -0.0355679914355278, -0.02531958743929863, -0.0035255802795290947, -0.0026948710437864065, -0.05075400322675705, 0.0052713253535330296, -0.008805876597762108, 0.0023234740365296602, -0.004105103202164173, 0.036802392452955246, 0.02165944315493107, 0.028262056410312653, 0.0332714319229126, -0.02322397567331791, -0.02612338401377201, -0.006419606041163206, 0.03045814298093319, 0.03220926970243454, -0.013987492769956589, 0.038094207644462585, -0.017339037731289864, -0.02264983393251896, -0.013032984919846058, -0.018028005957603455, -0.01690843142569065, 0.03140547499060631, -0.0183581355959177, 0.020267153158783913, -0.037290412932634354, 0.014080790802836418, -0.007535591255873442, -0.028951024636626244, -0.006128947716206312, 0.028764428570866585, 0.0004449587140697986, -0.013980315998196602, -0.009114476852118969, -0.0021332900505512953, 0.013255463913083076, 0.011389507912099361, 0.018932275474071503, 0.0045572384260594845, 0.018989689648151398, -0.007671949919313192, 0.02965434640645981, -0.02974046766757965, 0.04294569417834282, 0.01709502749145031, -0.011848820373415947, -0.013829604722559452, -0.003353338222950697, -0.0058669960126280785, -0.01967865787446499, -0.03278341144323349, -0.06947097927331924, -0.016779249534010887, -0.004316817503422499, 0.014102321118116379, -0.0010720276040956378, -0.003753442084416747, -0.02988400310277939, -0.04779718071222305, -0.021214483305811882, -0.015659676864743233, -0.03525221347808838, -0.04469682276248932, -0.0006970422109588981, 0.00567322364076972, 0.0367162711918354, 0.05049563944339752, 0.03243892639875412, -0.014475512318313122, 0.00784419197589159, 0.03361591324210167, -0.026439160108566284, -0.011540220119059086, 0.030659092590212822, 0.021573321893811226, -0.031434182077646255, 0.01260237954556942, -0.03103228285908699, -0.0045572384260594845, -0.0015510758385062218, -0.0038072678726166487, 0.0003548007516656071, -0.009049886837601662, 0.0064877853728830814, 0.01766916736960411, -0.017410803586244583, 0.007571475114673376, -0.01891792193055153, -0.009681440889835358, -0.006462666671723127, 0.00967426411807537, -0.051643919199705124, 0.017697874456644058, 0.01937723532319069, -0.039845336228609085, 0.004420880228281021, 0.005239030346274376, -0.035654112696647644, 0.03410393372178078, -0.04633312299847603, -0.018286367878317833, 0.02988400310277939, 0.011741168797016144, 0.0045823571272194386, -0.02810416743159294, -0.0009401547140441835, 0.0038431514985859394, -0.013449236750602722, -0.02928115427494049, 0.001143795088864863, -0.019592538475990295, -0.01891792193055153, -0.021616382524371147, 0.0244870837777853, 0.04188353568315506, -0.046132173389196396, -0.011798582971096039, -0.03022848628461361, -0.051615212112665176, 0.013104752637445927, 0.03921378031373024, -0.02684105932712555, -0.042285431176424026, -0.009035533294081688, 0.016549594700336456, -0.030084950849413872, -0.0018498082645237446, -0.009509198367595673, 0.008296327665448189, 0.027917571365833282, -0.04716562479734421, -0.0014263797784224153, 0.015544848516583443, -0.05181616172194481, 0.0008935058140195906, -0.009078592993319035, -0.006233010441064835, -0.02550618350505829, -0.022420179098844528, -0.009868036024272442, -0.013018631376326084, -0.03200832009315491, 0.021257543936371803, -0.044524580240249634, 0.007772424258291721, -0.01679360307753086, 0.0020525516010820866, -0.016420412808656693, 0.01649218052625656, -0.02513299137353897, -0.00631195493042469, -0.025176052004098892, 0.005669635254889727, -0.006642085500061512, -0.019520770758390427, 0.006078710313886404, 0.004977078642696142, -0.004657713230699301, 0.01649218052625656, 0.022606773301959038, -0.012437313795089722, -0.02006620354950428, -0.006742560304701328, -0.02257806621491909, 0.012344016693532467, -0.0026984594296664, 0.015487434342503548, 0.01134644728153944, -0.0011007345747202635, -0.00269307685084641, -0.0172098558396101, 0.03806550055742264, 0.007212637457996607, 0.0008953000069595873, -0.019477710127830505, -0.02775968238711357, 0.031060989946126938, 0.019161932170391083, 0.029941417276859283, -0.011131145060062408, 0.003904154058545828, -0.004654124844819307, 0.0007042189827188849, -0.019477710127830505, -0.03462066128849983, -0.009329780004918575, -0.032151855528354645, 0.002533394144847989, -0.0020220503211021423, 0.031922198832035065, 0.03427617624402046, 0.03835257142782211, 0.007980549708008766, -0.009437430649995804, -0.02965434640645981, -0.0029137618839740753, 0.013305701315402985, -0.022592419758439064, -0.003347955644130707, -0.0242143664509058, -0.02352539822459221, -0.022305350750684738, 0.011339270509779453, -0.0012424754677340388, -0.037060756236314774, 0.03734782710671425, -0.047998130321502686, -0.03829515725374222, 0.002468803199008107, -0.001971813151612878, 0.020812585949897766, -0.0021512319799512625, 0.002985529601573944, -0.012049769051373005, 0.00360273034311831, 0.01014793012291193, 0.0075499447993934155, -0.01670748181641102, -0.002214028500020504, -0.011332093738019466, -0.011540220119059086, 0.0321231484413147, -0.017238562926650047, -0.05994024500250816, -0.009394370950758457, 0.006896860431879759, -0.03464936837553978, 0.00733823049813509, -0.021960865706205368, -0.01877438835799694, -0.019362881779670715, 0.015717091038823128, 0.06556682288646698, -0.0396730937063694, -0.03384556993842125, -0.00360273034311831, -0.002678723307326436, -0.0052713253535330296, -0.06367215514183044, -0.006218656897544861, 0.00938719417899847, -0.0008885718416422606, -0.011884704232215881, -0.0332140177488327, -0.05109848454594612, -0.01716679520905018, -0.04366336762905121, -0.0071695768274366856, 0.007237756159156561, 0.002581837121397257, -0.0425725020468235, 0.0309174545109272, 0.009466137737035751, 0.01376501377671957, 0.021831683814525604, 0.006164831575006247, 0.010765130631625652, -0.048945460468530655, 0.020425040274858475, 0.009796269237995148, -0.054198842495679855, -0.0019431060645729303, -0.020267153158783913, -0.008791523054242134, -0.012745914980769157, -0.035166092216968536, 0.012265072204172611, 0.03373074159026146, -0.0028958201874047518, -0.011418214999139309, 0.026109030470252037, 0.04880192503333092, 0.001391393132507801, -0.015214717946946621, -0.022204875946044922, 0.01405208371579647, -0.008942235261201859, 0.014023376628756523, 0.020913060754537582, -0.027888864278793335, 0.02299431897699833, 0.006233010441064835, 0.012501904740929604, -0.01964995078742504, -0.0063227200880646706, 0.007743717171251774, 0.0017053760820999742, 0.03904154151678085, 0.013226756826043129, -0.0062078917399048805, 0.010119223035871983, -0.015386959537863731, 0.014604694209992886, 0.040189821273088455, -0.02239147201180458, -0.0041409870609641075, 0.03200832009315491, 9.980172762880102e-05, 0.027171188965439796, 0.006875330116599798, 0.013018631376326084, 0.009049886837601662, -0.0044244686141610146, 0.024429669603705406, -0.025750191882252693, -0.012013886123895645, 0.009688617661595345, -0.03783584386110306, -0.0023755053989589214, -0.010348878800868988, -0.02612338401377201, -0.00037498539313673973, -0.002815081737935543, -0.06499268114566803, -0.0321231484413147, -0.012875095941126347, 0.002678723307326436, -0.025821959599852562, 0.011123968288302422, 0.033673327416181564, -0.012544965371489525, -0.10627336800098419, -0.001939517678692937, 0.015157303772866726, 0.022262290120124817, 0.0047043622471392155, -0.01640605926513672, -0.011425391770899296, 0.007266463246196508, -0.0032708055805414915, -0.031003575772047043, -0.004880192689597607, -0.017109381034970284, 0.017755288630723953, -0.0020453748293220997, 0.001008333871141076, -0.05089753866195679, 0.010312994942069054, -0.0058347005397081375, 0.06573906540870667, -0.001905428129248321, -0.017468217760324478, 0.007241344545036554, -0.018932275474071503, 0.020740818232297897, -0.02033892087638378, -0.012135890312492847, -0.005231853574514389, 0.01709502749145031, -0.0052785021252930164, 0.012164597399532795, -0.024357901886105537, -0.02029586024582386, -0.0028671131003648043, 0.003462783759459853, -0.014827173203229904, 0.012903803028166294, -0.020094910636544228, -0.050926245748996735, -0.010155106894671917, -0.0029191444627940655, -0.0023396217729896307, -0.05405530706048012, 0.042170602828264236, -0.0011150881182402372, 0.03433359041810036, 0.016592655330896378, 0.02912326715886593, 0.021874744445085526, 0.034017812460660934, 0.001467646099627018, 0.001398569904267788, 0.001002951292321086, -0.01186317391693592, 0.031663838773965836, -0.0019431060645729303, -0.013305701315402985, 0.0015241630608215928, -0.0035058441571891308, 0.016348645091056824, 0.03881188482046127, -0.011827290058135986, -0.004995020572096109, 0.00579881714656949, -0.010650302283465862, -0.02308044023811817, -0.014152558520436287, 0.01591803878545761, 0.030314607545733452, -0.003204420441761613, -0.05988283455371857, -0.01831507496535778, 0.029941417276859283, 0.020798232406377792, 0.016047220677137375, 0.01286791916936636, 0.009853682480752468, 0.01117420569062233, 0.03688851371407509, -0.06045697256922722, 0.014231503009796143, 0.029797881841659546, -0.01919063925743103, -0.010872782208025455, -0.010226873680949211, 0.0013833192642778158, 0.029223740100860596, 0.007244932930916548, -0.008073847740888596, -0.03444841876626015, 0.04128068685531616, 0.05029468983411789, -0.04122327268123627, 0.016664421185851097, -0.007600182201713324, 0.0016057986067607999, -0.0054615093395113945, 0.03269729018211365, 0.02142978645861149, 0.042658623307943344, -0.013793720863759518, 0.04458199441432953, 0.04271603748202324, -0.05506005510687828, -0.021759917959570885, 0.0069183907471597195, 0.010377585887908936, 0.015272132121026516, -0.007266463246196508, 0.008425508625805378, -0.0024652148131281137, 0.012344016693532467, 0.0026213093660771847, -0.0009154846193268895, 0.03823774307966232, -6.907625356689095e-05, 0.01716679520905018, 0.037290412932634354, 0.018372489139437675, 0.009975687600672245, -0.001351921004243195, -0.018114127218723297, 0.016248170286417007, -0.022190522402524948, -0.022219229489564896, -0.015315192751586437, -0.02953951805830002, 0.040534306317567825, 0.00438858475536108, -0.053481169044971466, -0.03137676790356636, -0.011583280749619007, 0.0006849314086139202, 0.025061223655939102, -0.006491373758763075, -0.02315220795571804, 0.004356289282441139, 0.0036780862137675285, 0.014073614031076431, -0.024185659363865852, 0.057241786271333694, 0.004349112510681152, -0.005009374115616083, 0.018860509619116783, 0.0014389391290023923, 0.01277462113648653, 0.023884236812591553, -0.010671832598745823, -0.028692660853266716, 0.00915753748267889, 0.010671832598745823, 0.02276466228067875, 0.002526217373088002, -0.025219112634658813, 0.01441092137247324, -0.0049555483274161816, 0.014741051942110062, -0.01728162355720997, -0.039271194487810135, -0.0012164597865194082, 0.03849610686302185, 0.05480169132351875, 0.04443845897912979, -0.013643008656799793, -0.0034358708653599024, 0.02310914732515812, -0.034017812460660934, -0.02432919479906559, -0.008418331854045391, -0.025348294526338577, 0.02269289456307888, -0.018946629017591476, -0.02322397567331791, 0.04481165111064911, 0.02504687011241913, 0.0073920562863349915, 0.027960631996393204, 0.0027253723237663507, 0.005195969715714455, 0.00540768401697278, 0.021228836849331856, -0.0005718975444324315, 0.0006660924409516156, -0.0215876754373312, 0.008346564136445522, -0.0001844649959821254, -0.015831919386982918, 0.005224676802754402, -0.0046469480730593204, 0.012997101061046124, 0.06080145761370659, 0.010348878800868988, 0.020381979644298553, 0.014755405485630035, 0.05750015005469322, 0.003563258098438382, -0.02642480656504631, -0.0004911590949632227, 0.021257543936371803, -0.02974046766757965, -0.02725731022655964, -0.0195351243019104, 0.023697640746831894, -0.00707269087433815, -0.002129701664671302, -0.057012129575014114, 0.028563478961586952, 0.00243650795891881, -0.019592538475990295, 0.00322236237116158, 0.020123617723584175, -0.00167038943618536, 0.0029711760580539703, -0.007786777801811695, 0.037606190890073776, 0.011985179036855698, -0.011188559234142303, -0.005526100285351276, 0.015788858756422997, -0.042428966611623764, -0.00206152256578207, 0.00013871319242753088, -0.004765364341437817, -0.0017923942068591714, 0.03660144284367561, 0.004632594529539347, 0.02117142267525196, -0.0033784566912800074, 0.005945940501987934, -0.005536865442991257, -0.010399116203188896, 0.0003399987181182951, 0.00719469552859664, -0.014159735292196274, 0.003191861091181636, 0.006193538662046194, -0.04512742534279823, 0.0073346421122550964, -0.0332714319229126, 0.0039256843738257885, 0.01656394824385643, 0.04179741442203522, 0.00978909246623516, -0.014375037513673306, -0.008518806658685207, 0.013678892515599728, 0.004729480482637882, -0.0011106026358902454, 0.03220926970243454, -0.01195647194981575, -0.013348761945962906, 0.007255698088556528, 0.003188272938132286, 0.008174322545528412, -0.011468452401459217, 0.03341496363282204, 0.0121071832254529, 0.03439100459218025, 0.051758747547864914, 0.018559085205197334, 0.03157771751284599, -0.015444373711943626, 0.01946335658431053, 0.00808820128440857, 0.010801014490425587, 0.007779601030051708, -0.02501816302537918, -0.00944460742175579, 0.0107938377186656, 0.012918156571686268, 0.020094910636544228, -0.02810416743159294, 0.02193215861916542, 0.00837527122348547, 0.027156835421919823, -0.007686302997171879, -0.007915959693491459, -0.009071416221559048, -0.013994669541716576, 0.011052200570702553, -0.014238678850233555, 0.0006337970844469965, -0.04412268102169037, -0.015860626474022865, -0.005228265188634396, -0.009946980513632298, 0.013599948026239872, -0.036457907408475876, -0.0028276408556848764, 0.05098365992307663, -0.01725291647017002, 0.009049886837601662, 0.0606866292655468, -0.011224443092942238, 0.0042414613999426365, 0.008805876597762108, -0.00039203016785904765, 0.021759917959570885, 0.005716284271329641, -0.001970018958672881, -0.028850549831986427, 0.014913294464349747, 0.028305117040872574, 0.008360917679965496, 0.011267503723502159, 0.030544264242053032, 0.011999532580375671, -0.008899174630641937, -0.04811295494437218, -0.023467984050512314, 0.010190989822149277, -0.007198283914476633, 0.0201092641800642, 0.017941884696483612, -0.007244932930916548, 0.00965273380279541, -0.0008280179463326931, 0.008425508625805378, -0.021975219249725342, 0.004876604303717613, -0.016434766352176666, 0.021602028980851173, 0.014626223593950272, -0.0009688617428764701, 0.03881188482046127, 0.0025226289872080088, -0.019319821149110794, 0.016018513590097427, -0.0105067677795887, 0.013657362200319767, 0.01598980650305748, 0.028046753257513046, 0.00877716951072216, 0.010707716457545757, 0.02619515173137188, -0.02672623097896576, 0.031089697033166885, -0.011590457521378994, 0.016248170286417007, -0.0006427679909393191, 0.008418331854045391, 0.05795946344733238, -0.0023342391941696405, 0.014726698398590088, 0.0016174608608707786, -0.02319526858627796, 0.006785620469599962, 0.01900404319167137, -0.0007531105657108128, 0.015860626474022865, -0.01690843142569065, 0.08365224301815033, -0.02900843881070614, -0.0034825196489691734, -0.013657362200319767, -0.017611753195524216, 0.022190522402524948, -0.0020579341799020767, -0.012451667338609695, -0.010018748231232166, 0.011970825493335724, 0.02504687011241913, 0.0350225567817688, 0.0148845873773098, -0.003904154058545828, 0.035309627652168274, -0.008540336973965168, 0.007377702742815018, 0.008884821087121964, -0.0056086331605911255, 0.051299434155225754, 0.03568281978368759, 0.03315660357475281, 0.001952077029272914, 0.005156497471034527, -0.009494844824075699, 0.013750660233199596, -0.0029245270416140556, 0.00605359161272645, 0.013721953146159649, 0.04306052252650261, -0.02562100999057293, -0.017353391274809837, -0.016894077882170677, 0.05293573439121246, -0.025032516568899155, 0.026754938066005707, -0.0010101280640810728, 0.039386022835969925, -0.01789882406592369, 0.014087967574596405, 0.007420763373374939, -0.0006701293750666082, -0.021831683814525604, -0.0038682701997458935, -0.009114476852118969, 0.0063298968598246574, -0.012824858538806438, 0.016205109655857086, -0.016047220677137375, -0.004959136713296175, -0.009164714254438877, -0.01614769548177719, 0.014367860741913319, 0.003896977286785841, -0.010513944551348686, -0.004571591969579458, 0.0077078333124518394, 0.057356614619493484, 0.021070949733257294, 0.00513855554163456, -0.05692601203918457, -0.0087556391954422, -0.025377001613378525, 0.01774093508720398, -0.0021189365070313215, -0.021228836849331856, -0.02264983393251896, 0.0005297341267578304, -0.0003989826363977045, 0.019362881779670715, -0.007237756159156561, 0.016592655330896378, -0.00917906779795885, -0.007535591255873442, 0.007557121571153402, 0.040074992924928665, -0.032037027180194855, 0.0070188650861382484, 0.022090047597885132, 0.035280920565128326, -0.040649134665727615, -0.001250549335964024, -0.04400785267353058, -0.0004691802605520934, 0.022104401141405106, 0.018817448988556862, 0.02875007502734661, -0.012114359997212887, -0.015300839208066463, 0.014554456807672977, -0.03209444135427475, 0.013219580054283142, 0.018329428508877754, 0.01329134777188301, 0.007151634898036718, -0.02889361046254635, -0.014044906944036484, -0.013772190548479557, -0.005332327913492918, -0.027817096561193466, -0.014741051942110062, -0.012265072204172611, -0.0175112783908844, -0.006921979133039713, 0.013492297381162643, 0.0004996814532205462, -0.03220926970243454, -0.0012532406253740191, 0.0024400963447988033, 0.018874861299991608, -0.017525631934404373, -0.00967426411807537, 0.0455293245613575, 0.024573205038905144, 0.007022453472018242, 0.042543794959783554, 0.005895703099668026, 0.015961099416017532, 0.002201469149440527, -0.008597751148045063, 0.009990041144192219, 0.000649944762699306, 0.0201092641800642, 0.009502021595835686, -0.008834583684802055, -0.020123617723584175, 0.02059728279709816, -0.0029639992862939835, -0.015831919386982918, -0.02395600453019142, -0.01300427783280611, -0.023467984050512314, 0.008210206404328346, -0.0033443672582507133, 0.02333880215883255, 0.03536704182624817, -0.011899057775735855, -0.012745914980769157, -0.03444841876626015, -0.017841409891843796, 0.018745681270956993, -0.014360683970153332, -0.008217383176088333, 0.03955826535820961, 0.0148845873773098, 0.01362865511327982, 0.011303386650979519, -0.011253150179982185, 0.026166444644331932, -0.0014317623572424054, -0.017123734578490257, 0.022018279880285263, -0.020152324810624123, 0.0033353962935507298, -0.0020094909705221653, -0.020999182015657425, -0.015157303772866726, -0.04641924425959587, 0.005217500030994415, -0.02098482847213745, 0.011870350688695908, 0.020209738984704018, -0.006484196987003088, 0.016779249534010887, 0.028922317549586296, -0.031663838773965836, -0.043577250093221664, 0.005845465697348118, 0.0040512774139642715, -0.0013151401653885841, -0.0013824221678078175, -0.0032438926864415407, -0.00014532926434185356, -0.009545082226395607, 0.0020812584552913904, -0.014260209165513515, -0.020381979644298553, 0.007377702742815018, -0.01838684268295765, -0.010470883920788765, -0.02870701439678669, -0.0049304296262562275, 0.045070014894008636, 0.0049878438003361225, -0.04208448529243469, -0.030716504901647568, 0.022750308737158775, 0.01690843142569065, -0.0069183907471597195, -0.0215876754373312, -0.00953790545463562, 0.0034358708653599024, 0.016965845599770546, 0.017453864216804504, -0.011339270509779453, 0.037261705845594406, 0.006089475471526384, 0.03384556993842125, 0.039845336228609085, 0.03258246183395386, 0.004277345258742571, -0.015315192751586437, -0.02025279961526394, -0.011475629173219204, -0.009903919883072376, 0.03651532158255577, -0.0011698108864948153, 0.02718554250895977, -0.029252447187900543, -0.007435116916894913, 0.002219411078840494, -0.011504336260259151, 3.907966674887575e-05, -0.012989924289286137, 0.0015726061537861824, 0.002901202766224742, -0.019635597243905067, -0.013018631376326084, -0.05448591336607933, -0.043921731412410736, -0.02455885149538517, -0.0020471690222620964, 0.02790321782231331, 0.026367392390966415, 0.0008356432663276792, 0.027400845661759377, -0.011690931394696236, 0.005073965061455965, -0.018028005957603455, 0.0037426771596074104, -0.0024436847306787968, -0.021200129762291908, 0.004578768741339445, 0.01288944948464632, 0.008124085143208504, -0.013219580054283142, 0.016693128272891045, -0.01155457366257906, 0.014195619150996208, 0.025305233895778656, -0.00015463661111425608, 0.02646786719560623, -0.02142978645861149, 0.03444841876626015, -0.019707364961504936, 0.05787334218621254, 0.007736540399491787, 0.02142978645861149, -0.03243892639875412, 0.02402777224779129, 0.001336670364253223, 0.009702971205115318, -0.011690931394696236, -0.028965378180146217, 0.013183696195483208, -0.0384673997759819, -0.02635303884744644, -0.013212403282523155, 0.005163674242794514, 0.008719755336642265, -0.012035415507853031, -0.006394487340003252, 0.0026625755708664656, 0.004097926430404186, -0.028807489201426506, 0.03978792205452919, -0.0042665801011025906, 0.035424456000328064, -0.011030670255422592, 0.002940674778074026, 0.01999443583190441, 0.024874627590179443, 0.00167038943618536, -0.01617640256881714, 0.009401547722518444, 0.014619046822190285, -0.0022911785636097193, -0.010973256081342697, 0.021157069131731987, -0.03407522663474083, 0.01427456270903349, -0.007980549708008766, -0.008432685397565365, -0.00824609026312828, -0.01212871354073286, -0.0010711305076256394, -0.018028005957603455, -0.014475512318313122, 0.010485237464308739, 0.011188559234142303, -0.008683872409164906, 0.011303386650979519, 0.0097675621509552, -0.031003575772047043, -0.009437430649995804, -0.00500578572973609, -0.02428613416850567, -0.01367171574383974, -0.009925450198352337, 0.04702208936214447, -0.03892671316862106, -0.004657713230699301, 0.01052829809486866, 0.02953951805830002, 0.026367392390966415, 0.05293573439121246, 0.009810621850192547, 0.01212871354073286, -0.024888981133699417, -0.002298355335369706, -0.011073730885982513, -0.019621243700385094, 0.0007602873374707997, 0.02043939381837845, 0.005899291485548019, 0.0008733212016522884, -0.021558968350291252, 0.006419606041163206, -0.0012514464324340224, 0.03987404331564903, 0.004571591969579458, -0.004302463959902525, -0.010571357794106007, 0.0012980953324586153, 0.03419005498290062, -0.033788155764341354, -0.003681674599647522, 0.025104284286499023, 0.04010370001196861, 0.0019018397433683276, 0.032266683876514435, 0.0013725541066378355, 0.01891792193055153, -0.0100546320900321, -0.0080164335668087, -0.0037426771596074104, 0.028491711243987083, 0.011016316711902618, 0.05181616172194481, 0.0027809920720756054, -0.013521003536880016, 0.0017278034938499331, -0.013442059978842735, -0.027171188965439796, -0.02142978645861149, 0.0035578757524490356, -0.01576015166938305, 0.007079867646098137, -0.02308044023811817, 0.00839680153876543, 0.053021855652332306, 0.018142832443118095, -0.008640811778604984, 0.0054184491746127605, 0.025348294526338577, 0.00877716951072216, 0.008927881717681885, -0.035424456000328064, -0.008403978310525417, 0.00720546068623662, -0.029453396797180176, -0.0026625755708664656, 0.014288916252553463, 0.002653604606166482, -0.005432802718132734, -0.0007347201462835073, -0.008303504437208176, -0.04581639543175697, -0.019391588866710663, -0.02875007502734661, -0.016133341938257217, 0.0032205681782215834, 0.02135801874101162, 0.022664187476038933, -0.030084950849413872, -0.010937372222542763, -6.545984433614649e-06, -0.008102554827928543, -0.006057179998606443, -0.007413586601614952, 0.0414242222905159, -0.02882184274494648, 0.03875447064638138, -0.01637735217809677, -0.012853565625846386, 0.021042242646217346, 0.0037247352302074432, 0.005974647589027882, 0.013355938717722893]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
"3432, 2013.
Bommasani, R., Hudson, D. A., Adeli, E., Altman, R.,
Arora, S., von Arx, S., Bernstein, M. S., Bohg, J., Bosse-
lut, A., Brunskill, E., Brynjolfsson, E., Buch, S., Card, D.,
Castellon, R., Chatterji, N. S., Chen, A. S., Creel, K. A.,
Davis, J., Demszky, D., Donahue, C., Doumbouya, M.,
Durmus, E., Ermon, S., Etchemendy, J., Ethayarajh, K.,
Fei-Fei, L., Finn, C., Gale, T., Gillespie, L., Goel, K.,
Goodman, N. D., Grossman, S., Guha, N., Hashimoto,
T., Henderson, P., Hewitt, J., Ho, D. E., Hong, J., Hsu,
K., Huang, J., Icard, T. F., Jain, S., Jurafsky, D., Kalluri,
P., Karamcheti, S., Keeling, G., Khani, F., Khattab, O.,
Koh, P. W., Krass, M. S., Krishna, R., Kuditipudi, R.,
Kumar, A., Ladhak, F., Lee, M., Lee, T., Leskovec, J.,
Levent, I., Li, X. L., Li, X., Ma, T., Malik, A., Man-
ning, C. D., Mirchandani, S., Mitchell, E., Munyikwa,
Z., Nair, S., Narayan, A., Narayanan, D., Newman, B.,
Nie, A., Niebles, J. C., Nilforoshan, H., Nyarko, J. F.,
Ogut, G., Orr, L. J., Papadimitriou, I., Park, J. S., Piech,
C., Portelance, E., Potts, C., Raghunathan, A., Reich, R.,
Ren, H., Rong, F., Roohani, Y . H., Ruiz, C., Ryan, J.,
R’e, C., Sadigh, D., Sagawa, S., Santhanam, K., Shih, A.,
Srinivasan, K. P., Tamkin, A., Taori, R., Thomas, A. W.,
Tram `er, F., Wang, R. E., Wang, W., Wu, B., Wu, J., Wu,
Y ., Xie, S. M., Yasunaga, M., You, J., Zaharia, M. A.,
9
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
Zhang, M., Zhang, T., Zhang, X., Zhang, Y ., Zheng, L.,
Zhou, K., and Liang, P. On the opportunities and risks of
foundation models. ArXiv , abs/2108.07258, 2021.
Brown, T. B., Mann, B., Ryder, N., Subbiah, M., Kaplan,
J., Dhariwal, P., Neelakantan, A., Shyam, P., Sastry, G.,
Askell, A., Agarwal, S., Herbert-V oss, A., Krueger, G.,
Henighan, T., Child, R., Ramesh, A., Ziegler, D. M., Wu,
J., Winter, C., Hesse, C., Chen, M., Sigler, E., Litwin, M.,
Gray, S., Chess, B., Clark, J., Berner, C., McCandlish,
S., Radford, A., Sutskever, I., and Amodei, D. Language
models are few-shot learners. In NeurIPS , 2020.
Chen, D., Huang, Y ., Ma, Z., Chen, H., Pan, X., Ge, C., Gao,
D., Xie, Y ., Liu, Z., Gao, J., Li, Y ., Ding, B., and Zhou, J.
Data-juicer: A one-stop data processing system for large
language models. ArXiv , abs/2309.02033, 2023.
Chen, T., Xu, B., Zhang, C., and Guestrin, C. Training deep
nets with sublinear memory cost. ArXiv ,","[-0.013361185789108276, 0.03415249288082123, 0.054956838488578796, -0.008192688226699829, 0.017923541367053986, 0.009763441979885101, -0.002758595859631896, 0.03660313040018082, -0.0658022090792656, 0.03759381175041199, 0.01637233980000019, -0.03717668354511261, -0.011216877959668636, 0.019370460882782936, -0.02205573208630085, -0.0010860036127269268, 0.02779126539826393, -0.008557676337659359, 0.021834133192896843, 0.04319899529218674, -0.0027651137206703424, -0.04020087420940399, -0.004956673830747604, -0.00102734484244138, 0.05725105106830597, 0.0026608312036842108, 0.012403090484440327, 0.020087402313947678, 0.010343512520194054, -0.02964227832853794, 0.028755879029631615, -0.03670741245150566, -0.03454355150461197, -0.004057237878441811, -0.013778314925730228, 0.026370417326688766, 0.03110223263502121, 0.023124627768993378, -0.014078127220273018, 0.00505443848669529, 0.020752202719449997, -0.05610394477844238, -0.011972925625741482, 0.04627532511949539, -0.01940956525504589, 0.03170185536146164, 0.007658240385353565, -0.011660078540444374, -0.02316373400390148, 0.05412257835268974, -0.02239464968442917, 0.01900547184050083, -0.03407428041100502, -0.03454355150461197, -0.03941875696182251, -0.014469185844063759, 0.0021149779204279184, 0.0225250031799078, 0.02086951956152916, -0.011151701211929321, 0.005432462319731712, -0.06387298554182053, -0.004891497548669577, 0.024154415354132652, -0.03967946022748947, -0.047500643879175186, -0.03994016721844673, 0.0032311256509274244, -0.014638645574450493, 0.019644200801849365, -0.006745769176632166, -0.022160014137625694, 0.021964484825730324, -0.030554749071598053, -0.0025793605018407106, 0.003332149237394333, -0.006305827759206295, 0.07487478107213974, -0.02655291184782982, -0.029798701405525208, 0.0004108157299924642, 0.030476538464426994, 0.013322079554200172, -0.04356398060917854, -0.039001625031232834, -0.04095692187547684, 0.002968790242448449, 0.027035217732191086, -0.04898666962981224, 0.023411404341459274, -0.025640441104769707, -0.02740020677447319, -0.02257714420557022, -0.0053314389660954475, 0.0728934109210968, 0.04424181953072548, 0.027504488825798035, -0.011275537312030792, 0.041686899960041046, 0.026057571172714233, -0.03522138670086861, 0.0019650720059871674, 0.02595328725874424, -0.01967027224600315, 0.008016711100935936, -0.02153431996703148, -0.022824814543128014, -0.01624198816716671, 0.010741089470684528, 0.014443115331232548, -0.10589879751205444, 0.016489658504724503, -0.0021084602922201157, -0.036472778767347336, -0.004695967771112919, -0.042547229677438736, -0.04241687431931496, -0.003330519888550043, -0.01755855232477188, 0.03264039754867554, 0.005412909667938948, 0.0313107967376709, 0.02343747392296791, -0.002706454833969474, 0.024675827473402023, -0.035429954528808594, 0.030476538464426994, -0.052271563559770584, -0.01973544806241989, -0.015929140150547028, -0.005129391793161631, 0.0005821077502332628, 0.03394392877817154, -0.025314558297395706, -0.028808020055294037, -0.016554834321141243, -0.011855607852339745, 0.011731772683560848, -0.03313573822379112, -0.014078127220273018, 0.07424908876419067, 0.007058616727590561, -0.02620095945894718, 0.026044534519314766, -0.03282289206981659, 0.023528721183538437, -0.028443031013011932, -0.003134990343824029, -0.027478419244289398, 0.031727928668260574, -0.008010193705558777, 0.0034119905903935432, 0.011040901765227318, -0.003252308117225766, -0.046640314161777496, -0.03811522573232651, -0.01396080944687128, 0.05573895573616028, 0.032927174121141434, -0.07508334517478943, 0.026031499728560448, 0.05881528556346893, 0.015042739920318127, 0.029955126345157623, 0.043277204036712646, 0.04932558536529541, -0.03777630627155304, -0.008688028901815414, -0.048621680587530136, -0.07070348411798477, 0.009880759753286839, 0.017193565145134926, 0.0004199811664875597, -0.02693093568086624, -0.0038747438229620457, -0.025301523506641388, -0.04455466568470001, -0.03162364289164543, -0.023789428174495697, -0.051202669739723206, 0.015355587005615234, 0.035951364785432816, -0.03576887026429176, 0.021364862099289894, -0.055426109582185745, -0.009972007013857365, 0.032718610018491745, 0.039262332022190094, 0.006514392793178558, 0.03347465768456459, -0.001198433106765151, 0.04132191091775894, 0.0616830512881279, 0.03973160311579704, 0.019852766767144203, -0.030606891959905624, 0.060066673904657364, -0.008968288078904152, 0.020973801612854004, 0.0035260494332760572, 0.022942133247852325, 0.05234977602958679, -0.041374050080776215, -0.05521754175424576, 0.03321395069360733, -0.041895464062690735, 0.012559514492750168, 0.0006753916386514902, -0.05871100351214409, -0.025249382480978966, 0.02171681448817253, 0.02985084429383278, 0.053653307259082794, 0.00477092107757926, -0.03188434988260269, 0.006006015930324793, -0.04906487837433815, 0.0039953202940523624, 0.020700061693787575, 0.027843406423926353, 0.0015821598935872316, 0.021703779697418213, 0.04257329925894737, 0.029694419354200363, -0.027217712253332138, 0.01227925531566143, 0.014234550297260284, -0.027374135330319405, 0.06418582797050476, 0.0032930434681475163, 0.07357124984264374, -0.010193606838583946, -0.017610693350434303, -0.029929054901003838, -0.028938371688127518, -0.025040816515684128, -0.003913849592208862, -0.03089366853237152, 0.00382260256446898, -0.032718610018491745, 0.029537996277213097, 0.016228951513767242, 0.01179043110460043, 0.017141424119472504, 0.014729891903698444, 0.06105735898017883, -0.02594025246798992, -0.05044662207365036, 0.03389178588986397, -0.008081887848675251, 0.023997992277145386, -0.010747606866061687, -0.024793146178126335, -0.012096760794520378, -0.027478419244289398, -0.03540388122200966, -0.029094796627759933, -0.0019797366112470627, -0.0342046357691288, -0.023854603990912437, -0.045779984444379807, 0.04111334681510925, -0.006276498548686504, 0.022146979346871376, 0.0002189523511333391, -0.011314642615616322, -0.03566458821296692, 0.03618600219488144, 0.007058616727590561, -0.01913582533597946, 0.022746603935956955, -0.013478503562510014, 0.02488439343869686, -0.0026347606908529997, -0.05073339864611626, -0.026578983291983604, 0.01880994252860546, 0.03712454438209534, -0.03639456629753113, 0.013230832293629646, 0.025040816515684128, 0.040253013372421265, 0.06319514662027359, 0.02899051271378994, 0.013328596949577332, 0.031024020165205002, 0.00788635853677988, -0.024180486798286438, -0.05777246132493019, -0.028182324022054672, 0.0380370132625103, -0.021834133192896843, 0.006224357057362795, -0.050342340022325516, 0.03295324742794037, -0.00521412119269371, 0.0370984710752964, 0.005259744822978973, -0.015512010082602501, -0.040904778987169266, 0.04160868749022484, -0.012598619796335697, -0.01224666740745306, 0.012820220552384853, -0.02080434374511242, 0.04257329925894737, -0.034830328077077866, 0.003930144011974335, 0.02912086620926857, -0.013198244385421276, -0.024128345772624016, -0.009861206635832787, -0.008701064623892307, 0.004484144039452076, -0.043407559394836426, -0.03756774216890335, 0.0006269165896810591, -0.028416959568858147, 0.019122788682579994, -0.032249338924884796, -0.03214505687355995, -0.014586503617465496, -0.02541884034872055, -0.004660120699554682, -0.010056735947728157, 0.034830328077077866, 0.005983204115182161, -0.007834216579794884, -0.007834216579794884, -0.04656210169196129, 0.015277374535799026, 0.021351825445890427, 0.0339178591966629, -0.017063211649656296, -0.0030274491291493177, -0.049482010304927826, -0.04549320787191391, 0.03558637574315071, 0.05300154164433479, -0.004083308391273022, -0.07581332325935364, 0.0071498635224998, -0.02706128917634487, 0.01604645699262619, -0.008642406202852726, 0.008564193733036518, -0.018392812460660934, 0.022798744961619377, 0.040904778987169266, 0.00345109635964036, -0.001420033280737698, -0.05073339864611626, 0.0326143279671669, -0.0003279193479102105, 0.016476623713970184, 0.026852723211050034, -0.003578190691769123, -0.018066929653286934, 0.02099987305700779, 0.0038291201926767826, -0.021247543394565582, 0.020439354702830315, 0.02140396647155285, -0.0042234379798173904, 0.006967369467020035, -0.01763676479458809, -0.048178479075431824, 0.015277374535799026, 0.006664298474788666, -0.013296009041368961, -0.002968790242448449, 0.03600350767374039, -0.031206514686346054, -0.002294213278219104, -0.05782460421323776, 0.003568414133042097, -0.014065091498196125, 0.020491495728492737, 0.0024457487743347883, 0.039314474910497665, 0.02324194461107254, 0.001385000883601606, 0.015929140150547028, -0.003539084689691663, -0.02389371022582054, 0.01900547184050083, -0.014417044818401337, 0.003073072759434581, 0.010356548242270947, -0.005419427063316107, -0.016867682337760925, 0.018171211704611778, -0.0431729219853878, 0.030528679490089417, 0.019448671489953995, 0.014729891903698444, 0.0178974699229002, 0.026435595005750656, 0.00563125079497695, 0.028573384508490562, -0.021508250385522842, -0.011308125220239162, -0.01632019877433777, -0.0022714014630764723, 0.02878194861114025, 0.021482178941369057, 0.06267373263835907, 0.047578856348991394, 0.0032979315146803856, 0.005031626671552658, 0.02543187513947487, -0.0335528701543808, 0.015133986249566078, -0.004344014450907707, -0.010473866015672684, -0.017858365550637245, -0.00546179199591279, 0.019292248412966728, 0.010486900806427002, 0.06126592308282852, 0.012605138123035431, -0.03433498740196228, -0.03876699134707451, -0.04966450482606888, -0.04914309084415436, -0.002142678014934063, 0.02509295754134655, -0.044007182121276855, 0.01643751747906208, -0.06590649485588074, -0.03548209369182587, 0.013869562186300755, 0.03712454438209534, 0.0047644032165408134, -0.010167536325752735, -0.05096803233027458, 0.024923499673604965, 0.014651680365204811, 0.02159949764609337, -0.03566458821296692, -0.010532524436712265, 0.010584665462374687, -0.02792161889374256, 0.016854645684361458, 0.005843074526637793, -0.015955211594700813, -0.041634757071733475, 0.03394392877817154, 0.009059535339474678, -0.06481152772903442, 0.04695316031575203, -0.004383120685815811, 0.030267972499132156, 0.016398411244153976, -0.003812826005741954, -0.023085521534085274, 0.08441662043333054, -0.024519404396414757, 0.055113259702920914, 0.015876999124884605, 0.0402790866792202, 0.03462176397442818, -0.05002949386835098, -0.009782995097339153, -0.004924085456877947, 0.04742243140935898, -0.001549571636132896, 0.012070690281689167, 0.03696811944246292, -0.018066929653286934, 0.006837016437202692, -0.007853769697248936, -0.023789428174495697, -0.06731430441141129, 0.0027439312543720007, -0.005738792009651661, -0.004161520395427942, -0.026592018082737923, -0.03342251479625702, -0.013204761780798435, 0.0225250031799078, -0.014899350702762604, 0.01591610535979271, 0.0063384161330759525, 0.029955126345157623, 0.010226194746792316, -0.0018705659313127398, -0.027087358757853508, 0.007430122699588537, 0.020413285121321678, 0.020687025040388107, 6.252872117329389e-05, 0.06726216524839401, -0.013856527395546436, 0.009372382424771786, 0.007971087470650673, -0.02945978380739689, -0.043668266385793686, -0.0008187799830920994, -0.03902769833803177, 0.0004912680014967918, -0.017454270273447037, 0.011040901765227318, -0.01637233980000019, -0.02753056026995182, -0.023802462965250015, 0.013087444007396698, 0.014912386424839497, 0.00673273392021656, 0.051333021372556686, 0.005178274121135473, 0.012357466854155064, 0.014729891903698444, 0.039053767919540405, 0.014560433104634285, 0.040982991456985474, -0.026722371578216553, 0.0285994540899992, -0.012742008082568645, 0.053444743156433105, 0.012572549283504486, -0.009013911709189415, -0.013569749891757965, -0.03446533903479576, 0.011842573061585426, -0.014560433104634285, 0.014977563172578812, -0.024271734058856964, -0.0003089774108957499, -0.0035977435763925314, 0.025066887959837914, -0.009822100400924683, 0.013843491673469543, -0.029173007234930992, -0.04721386730670929, 0.0053216624073684216, 0.0007202004780992866, -0.014273656532168388, -0.05480041354894638, -0.0019895131699740887, -0.0035651554353535175, 0.05782460421323776, -0.0019015248399227858, 0.010832336731255054, 0.0011014831252396107, -0.009978524409234524, 0.029016584157943726, -0.043277204036712646, -0.01512095145881176, 0.019435636699199677, 0.05453970655798912, -0.02904265560209751, 0.0031268433667719364, -0.043146852403879166, -0.003073072759434581, -0.01346546784043312, 0.002007436705753207, -0.0018265717662870884, -0.01060421857982874, -0.0007584916893392801, 0.022029662504792213, -0.014638645574450493, -0.0006460621953010559, 0.005644286051392555, -0.0246236864477396, -0.017910506576299667, 0.004252767655998468, -0.04950807988643646, 0.033578939735889435, 0.010969207622110844, -0.042025815695524216, -0.0342046357691288, 0.0060646748170256615, -0.006071192212402821, 0.012396573089063168, -0.02483225241303444, -0.003988802898675203, 0.014104197733104229, 0.0026054312475025654, -0.0014110715128481388, -0.044737160205841064, -0.01310699712485075, -0.0008717358577996492, -0.0008945476729422808, -0.03824557736515999, 0.020439354702830315, 0.0027944431640207767, 0.016815541312098503, -0.030789384618401527, 0.004337497055530548, 0.05740747228264809, -0.04398111253976822, -0.015538080595433712, -0.06053594499826431, -0.0319625623524189, -0.009509253315627575, 0.043616123497486115, -0.02972049079835415, -0.029929054901003838, 0.01512095145881176, 0.006247168872505426, -0.012461749836802483, -0.018523165956139565, -0.0031626904383301735, 0.004252767655998468, -0.00032079065567813814, -0.03801094368100166, 0.01874476484954357, -0.009228994138538837, -0.005090285558253527, -0.002090536756440997, -0.001512909890152514, 0.010161018930375576, -0.032066844403743744, -0.011145183816552162, 0.0022958426270633936, -0.01749337650835514, -0.03144115209579468, 0.061839476227760315, -0.024532439187169075, 0.0019552954472601414, -0.03717668354511261, 0.008635887876152992, 0.021938415244221687, 0.00538032129406929, 0.015042739920318127, -0.028338748961687088, -0.01363492663949728, -0.04306863993406296, -0.006612157449126244, -0.028755879029631615, -0.01914886012673378, 0.04257329925894737, 0.0018510130466893315, 0.01609859988093376, 0.007990640588104725, -0.013895632699131966, -0.012852808460593224, 0.00016620011592749506, -0.04760492593050003, 0.003144766902551055, 0.009691747836768627, 0.014377939514815807, 0.0017516188090667129, 0.026957007125020027, -0.011575348675251007, -0.020778272300958633, 0.011836054734885693, -0.01755855232477188, -0.008160099387168884, -0.012728973291814327, -0.03592529520392418, 0.023984957486391068, 0.016606975346803665, 0.0235026516020298, -0.018796905875205994, 0.008525088429450989, -0.035560306161642075, 0.008577229455113411, -0.007260663900524378, -0.04213009774684906, 0.0276609119027853, -0.0038714848924428225, 0.014065091498196125, -0.008707582019269466, 0.043146852403879166, 0.03037225641310215, 0.0351431779563427, 0.02060881443321705, -0.015525045804679394, 0.008877040818333626, 0.008062334731221199, 0.029433714225888252, 0.003910590894520283, -0.003172466764226556, -0.038793060928583145, 0.021742885932326317, -0.012012031860649586, 0.016033422201871872, 0.013054856099188328, -0.054904695600271225, 0.03949696943163872, -0.05579109489917755, -0.01796264760196209, 0.018927259370684624, -0.028234466910362244, 0.007430122699588537, 0.00739753432571888, 0.011321160942316055, 0.0060548982582986355, 0.015199162997305393, -0.009255064651370049, -0.006048380397260189, -0.01449525635689497, -0.002002548426389694, -0.013869562186300755, -0.02239464968442917, 0.03704633191227913, -0.004396155942231417, -0.09750406444072723, -0.010219677351415157, 0.0149514926597476, -0.02475403994321823, 0.007208522409200668, -0.02773912437260151, 0.002478336915373802, -0.04113941639661789, 0.025171170011162758, 0.060066673904657364, -0.030163690447807312, -0.02265535667538643, -0.0018607894890010357, -0.00017954093345906585, 0.017141424119472504, -0.027765195816755295, -0.0030274491291493177, 0.039783746004104614, 0.0042234379798173904, -0.022811779752373695, -0.02839088998734951, -0.07680400460958481, -0.007690828759223223, -0.006960851605981588, -0.017349988222122192, -0.00027862959541380405, -0.0032360139302909374, -0.019891873002052307, 0.006331898272037506, 0.0015634216833859682, -0.011692666448652744, 0.002942719729617238, 0.014729891903698444, 0.015876999124884605, -0.01974848471581936, 0.005852851085364819, -0.002616837155073881, -0.04458073526620865, 0.01801478862762451, -0.02483225241303444, 0.009633088484406471, -0.005624733399599791, -0.028573384508490562, 0.003130102064460516, 0.03394392877817154, 0.011184290051460266, -0.0033794022165238857, 0.02805197238922119, 0.00956791266798973, 0.0061102984473109245, -0.006765322294086218, -0.05845029652118683, 0.011106077581644058, -0.01934438943862915, -0.00505443848669529, -0.001844495302066207, -0.05407043546438217, 0.008772758767008781, 0.007169416639953852, -0.0292512197047472, -0.002856360748410225, 0.009587464854121208, 0.008609817363321781, 0.003346814075484872, 0.028104113414883614, 0.022264298051595688, -0.011823019944131374, -0.009385418146848679, -0.01755855232477188, -0.029955126345157623, 0.03563851863145828, -0.025796864181756973, -0.004122414626181126, 0.021482178941369057, 0.017532482743263245, 0.03219719976186752, -0.002170377876609564, 0.016202881932258606, 0.03488247096538544, -0.005399874411523342, 0.0005254856660030782, -0.002294213278219104, -0.005073991604149342, 0.05263655260205269, -0.018836012110114098, -0.020895591005682945, -0.027582701295614243, -0.04014873132109642, -0.02667023055255413, 0.0023903485853224993, -0.062048040330410004, -0.042234379798173904, -0.013647962361574173, 0.008173135109245777, 0.011184290051460266, 0.01445615105330944, 0.017871400341391563, 0.018901189789175987, -0.07503120601177216, -0.03532567247748375, 0.029016584157943726, 0.012989679351449013, -0.00590825080871582, -0.03957517817616463, 0.009841653518378735, 0.03123258613049984, 0.01624198816716671, -0.020700061693787575, 0.019057612866163254, 0.0016090451972559094, -0.003340296447277069, 0.022733567282557487, 0.030033336952328682, -0.055373966693878174, 0.0016978482017293572, -0.02106504887342453, 0.03827165067195892, 0.006442698650062084, -0.02872980758547783, -0.0005173385725356638, -0.0019878835882991552, 0.031858280301094055, -0.008987841196358204, -0.012331396341323853, 0.002810737118124962, 0.017245706170797348, 0.0033598493319004774, 0.006517651490867138, -0.03386571630835533, -0.02713949978351593, 0.004399414639919996, 0.048621680587530136, -0.03850628435611725, 0.023359263315796852, -0.02179502695798874, -0.025105994194746017, -0.019526883959770203, -0.032457903027534485, -0.015407728031277657, -0.04703137278556824, 0.03321395069360733, -0.036342423409223557, 0.02904265560209751, 0.00041875909664668143, 0.027113430202007294, -0.0027977018617093563, 0.011132149025797844, -0.0438246876001358, 0.010200124233961105, 0.019057612866163254, -0.013491538353264332, 0.034439269453287125, -0.000539742992259562, -0.018457988277077675, 0.018053894862532616, -0.010350030846893787, 0.03928840160369873, 0.031024020165205002, -0.023606933653354645, 0.02007436566054821, -0.022225191816687584, -0.0031219550874084234, -0.02977263182401657, -0.008609817363321781, 0.0015894921962171793, 0.04575391486287117, -0.018171211704611778, -0.06324728578329086, -0.025444911792874336, 0.06199590116739273, 0.00894221756607294, 0.021742885932326317, 0.019657237455248833, -0.002556548686698079, 0.019435636699199677, 0.04963843151926994, -0.028834089636802673, 0.014065091498196125, 0.017806224524974823, -0.015147021971642971, -0.002535366453230381, -0.02364603988826275, -0.023072486743330956, 0.034491412341594696, 0.009998077526688576, 0.006436180789023638, -0.0014069980243220925, 0.025379734113812447, 0.050472691655159, -0.01697196438908577, 0.015133986249566078, -0.0033956964034587145, 0.022277332842350006, -0.005324921105057001, 0.018171211704611778, 0.022538037970662117, 0.033109668642282486, 0.015133986249566078, 0.03889734297990799, 0.04575391486287117, -0.035091035068035126, 0.02133879065513611, 0.01561629306524992, -0.004386379383504391, 0.006856569088995457, -0.010682431049644947, 0.0011479213135316968, 0.0015715686604380608, 0.018001753836870193, 0.020309001207351685, -0.02693093568086624, -0.0005348547711037099, -0.011444996111094952, 0.011223395355045795, 0.020973801612854004, 0.024141380563378334, -0.003522790502756834, 0.012592102400958538, -0.013061373494565487, 0.03063296154141426, -0.018314599990844727, -0.00632212171331048, -0.019826695322990417, -0.014573468826711178, 0.03735917806625366, 0.027973759919404984, -0.033578939735889435, -0.012012031860649586, 0.01794961281120777, -0.004894756246358156, 0.003289784537628293, -0.00944407656788826, -0.007677793502807617, 0.01716749370098114, -0.0009116564760915935, 0.039314474910497665, -0.02397192269563675, 0.035821013152599335, 0.012337913736701012, -0.008459911681711674, 0.008674994111061096, -0.025653475895524025, 0.019253142178058624, -0.014012950472533703, -0.018079964444041252, -0.041165485978126526, 0.012735490687191486, -0.020491495728492737, 0.025914182886481285, -0.011106077581644058, -0.032327551394701004, 0.018992437049746513, -0.009782995097339153, -0.011197324842214584, -0.01900547184050083, -0.0329011045396328, -0.02574472315609455, 0.04033122584223747, 0.011536243371665478, 0.049221303313970566, -0.01294405572116375, -0.019891873002052307, 0.030085479840636253, -0.03462176397442818, -0.019904907792806625, -0.02060881443321705, -0.055165402591228485, 0.013178691267967224, -0.025197239592671394, -0.021299684420228004, 0.032457903027534485, 0.02773912437260151, 0.009580947458744049, 0.023228909820318222, 0.0009906829800456762, -0.029616208747029305, 0.00624065101146698, 0.022472862154245377, 0.03699418902397156, -0.025770794600248337, -0.01841888204216957, -0.011647042818367481, -0.0016408187802881002, -0.009307206608355045, -0.0013043449725955725, -0.018523165956139565, 0.0017728011589497328, 0.05876314640045166, 0.003956214524805546, -0.0039855437353253365, 0.012533443979918957, 0.04880417510867119, 0.024323875084519386, -0.05057697370648384, -0.01841888204216957, 0.014390974305570126, -0.021286649629473686, -0.018184248358011246, 0.0037476494908332825, 0.025040816515684128, -0.015342551283538342, 0.0014795068418607116, -0.03889734297990799, 0.018053894862532616, -0.011647042818367481, -0.01178391370922327, -0.013843491673469543, 0.020387213677167892, -0.022199120372533798, 0.01900547184050083, -0.021169330924749374, 0.027217712253332138, -0.0021459367126226425, 0.00024543030303902924, 0.023737287148833275, 0.026305241510272026, -0.03248397633433342, -0.01695892959833145, -0.014899350702762604, -0.016411446034908295, -0.023541757836937904, 0.03876699134707451, -0.005800709594041109, 0.010741089470684528, 0.013113514520227909, -0.01244871411472559, 0.004106120206415653, -0.002002548426389694, -0.007632169872522354, 0.014377939514815807, 0.01723266951739788, -0.019031541422009468, 0.004477626644074917, -0.012957091443240643, -0.003926884848624468, -0.0020432837773114443, -0.0005006371065974236, 0.005536744836717844, 0.03313573822379112, 0.013973844237625599, -0.015407728031277657, -0.022629285231232643, 0.0037769789341837168, 0.00987424235790968, 0.023346226662397385, 0.015042739920318127, -0.014469185844063759, -0.011242948472499847, 0.022003591060638428, -0.003372884588316083, 0.02416745200753212, -0.012735490687191486, 0.010532524436712265, -0.003299561096355319, -0.004383120685815811, 0.029564067721366882, 0.029798701405525208, 0.05075946822762489, -0.023450510576367378, 0.04153047502040863, 0.0002774075255729258, -0.003196907928213477, 0.029303360730409622, -0.017050176858901978, -0.003923626150935888, 0.010669395327568054, -0.004917568061500788, 0.013315562158823013, -0.04239080473780632, 0.019917942583560944, 0.0021035720128566027, 0.019187966361641884, 0.004451556131243706, -0.010578148066997528, 0.0031219550874084234, -0.004487403202801943, 0.0034282845444977283, 0.013361185789108276, -0.031258657574653625, -0.02145610935986042, -0.0028710253536701202, -0.0073128049261868, 0.01980062574148178, -0.0021964486222714186, -0.03928840160369873, -0.030606891959905624, 0.044476453214883804, -0.02376335673034191, 0.0031578021589666605, 0.039444826543331146, -0.03816736862063408, 0.011744807474315166, -0.022551074624061584, 0.006608898751437664, 0.013739209622144699, 0.020647918805480003, 0.01940956525504589, -0.03235362097620964, 0.029094796627759933, 0.012057655490934849, 0.015498975291848183, 0.004145226441323757, 0.001999289495870471, 0.0071498635224998, 0.0121489018201828, -0.0450500063598156, -0.000872550590429455, 0.000934468291234225, -0.018171211704611778, 0.022485896944999695, 0.03670741245150566, -0.004053979180753231, -0.0019243365386500955, 0.002339836908504367, -7.994307088665664e-05, -0.026722371578216553, 0.0167764350771904, -0.011686149053275585, -0.003296302165836096, 0.006648004520684481, 0.029694419354200363, -0.020178649574518204, -0.008864006027579308, -0.018145142123103142, 0.017858365550637245, -0.022485896944999695, 0.03368322178721428, 0.022146979346871376, 0.0339178591966629, -0.0063481926918029785, -0.0030225608497858047, 0.033370375633239746, -0.01561629306524992, 0.018510129302740097, -0.026135781779885292, 0.00353256706148386, -0.008642406202852726, -0.014208479784429073, 0.044346101582050323, 0.01570753939449787, -0.00488823838531971, -0.00842080544680357, -0.00993290077894926, -0.0037313555367290974, -0.0063123456202447414, 0.030554749071598053, 0.004816544242203236, -0.021286649629473686, 0.06913924962282181, -0.02034810744225979, -0.009646124206483364, 0.0010395654244348407, -0.023619968444108963, 0.04173903912305832, -0.013556715101003647, 0.011972925625741482, -0.035612449049949646, 0.004233214538544416, 0.0031056609004735947, 0.029407642781734467, -0.03170185536146164, -0.0060646748170256615, 0.028886230662465096, -0.014417044818401337, -0.005836556665599346, 0.009815583005547523, -0.00349020236171782, 0.03162364289164543, 0.021234508603811264, 0.03191042318940163, -0.009222476743161678, -0.03889734297990799, -0.014195444993674755, 0.01179043110460043, 0.018653517588973045, 0.007697346154600382, 0.0185492355376482, 0.07487478107213974, -0.028938371688127518, -0.026904864236712456, -0.040122661739587784, 0.008544640615582466, -0.01499059796333313, 0.02680058218538761, -0.0409308522939682, 0.014847209677100182, -0.015538080595433712, -0.02119540236890316, 0.007260663900524378, 0.009782995097339153, -0.018783871084451675, -0.011484101414680481, -0.011438478715717793, -0.01023923046886921, -0.011210360564291477, 0.002525589894503355, 0.0024864841252565384, 0.0002721119381021708, -0.012227114289999008, -0.026592018082737923, -0.001028159516863525, -0.005530227441340685, -0.02740020677447319, -0.0012970126699656248, -0.006915227975696325, 0.06001453474164009, 0.005080509465187788, 0.023802462965250015, -0.03412642329931259, 0.0009287653374485672, -0.016815541312098503, 0.018653517588973045, 0.009535323828458786, -0.03715061396360397, -0.01815817691385746, -0.023984957486391068, 0.026774512603878975, 0.04113941639661789, -0.014143303968012333, 0.0149514926597476, 0.004282096866518259, -0.002090536756440997, 0.012846291065216064, 0.027217712253332138, -0.00014420303341466933, 0.0026608312036842108, 0.023802462965250015, 0.03178006783127785, -0.015824858099222183, -0.008147064596414566, -0.024610651656985283, 0.02773912437260151, 0.026644159108400345, -0.013569749891757965, 0.028182324022054672, -0.009965488687157631, -0.012318361550569534, 0.012957091443240643, -0.012689867056906223, 0.010512971319258213, 0.029824772849678993, 0.040383368730545044, -0.008010193705558777, -0.002418048679828644, -0.009919865056872368, -0.00480350898578763, 0.01856227219104767, 0.007182451896369457, -0.007625652011483908, -0.004972968250513077, -0.01788443513214588, 0.0027977018617093563, -0.01274852640926838, 0.0040963441133499146, -0.039914097636938095, 0.012865844182670116, 0.0003495090641081333, 0.016554834321141243, -0.0094375591725111, -0.00990683026611805, 0.06043166294693947, 0.016268057748675346, 0.007716899272054434, 0.017714977264404297, -0.0235026516020298, -0.010949654504656792, -0.01570753939449787, -0.045936405658721924, 0.0246236864477396, 0.01026530098170042, 0.028286607936024666, -0.0012668685521930456, -0.00987424235790968, -0.009763441979885101, 0.027478419244289398, -0.02713949978351593, -0.0004083715903107077, -0.016124669462442398, -0.014782033860683441, -0.016984999179840088, 0.0026820136699825525, -0.008818382397294044, 0.01585092768073082, 0.020100437104701996, 0.016672153025865555, -0.023424439132213593, -0.010812783613801003, -0.01095617190003395, 0.0017793187871575356, 0.02040024846792221, -0.014899350702762604, 0.04197367653250694, 0.017050176858901978, -0.028286607936024666, 0.011132149025797844, -0.02204269729554653, 0.0020742425695061684, 0.0037639436777681112, -0.014560433104634285, -0.003340296447277069, -0.0219123438000679, -0.002540254732593894, 0.0019895131699740887, 0.005719239357858896, 0.02442815713584423, -0.019644200801849365, -0.011353748850524426, -0.023007309064269066, 0.007677793502807617, 0.022694462910294533, -0.0028384372126311064, -0.004285356029868126, 0.020191684365272522, -0.035091035068035126, -0.03871484845876694, 0.017011070623993874, -0.00993290077894926, 0.015251304022967815, -0.007866805419325829, 0.017193565145134926, 0.002349613234400749, -0.015433798544108868, -0.004070273134857416, -0.025053851306438446, -0.01040217187255621, 0.0055237095803022385, 0.01783229410648346, 0.011634008027613163, -0.032588258385658264, -0.01651572808623314, 0.04481537267565727, 0.005556297954171896, -0.031649716198444366, 0.00477092107757926, 0.018040860071778297, 0.0167764350771904, -0.023541757836937904, -0.03761988505721092, 0.0009703153627924621, 0.013973844237625599, 0.018079964444041252, 0.010877960361540318, -0.0020367661491036415, 0.02225126139819622, 0.007169416639953852, 0.04199974611401558, 0.03829772025346756, -0.004272320307791233, -0.019070647656917572, -0.03386571630835533, 0.002830290235579014, -0.008577229455113411, 0.0036564024630934, 0.0194877777248621, 0.010799748823046684, 0.029225148260593414, -0.004089826252311468, -0.014390974305570126, -0.002535366453230381, -0.017284812405705452, 0.007012993097305298, -0.0039953202940523624, 0.009261582978069782, -0.008642406202852726, 0.007006475236266851, 0.010519489645957947, -0.03511710464954376, -0.03110223263502121, -6.986107473494485e-05, -0.0018917482811957598, 0.01578575186431408, 0.013700103387236595, -0.015668433159589767, 0.028286607936024666, 0.017871400341391563, -0.012728973291814327, 0.0078016286715865135, 0.043277204036712646, 0.001301900832913816, 0.002732525346800685, 0.007417087443172932, -0.02092166058719158, 0.009620053693652153, -0.016854645684361458, -0.0011324419174343348, -0.008153581991791725, 0.022538037970662117, 0.003004637314006686, -0.023098556324839592, 0.025379734113812447, 0.02192537859082222, 0.03923626244068146, -0.05010770261287689, 0.06893067806959152, 0.04194760322570801, 0.040826570242643356, -0.03063296154141426, 0.032666467130184174, -0.020947732031345367, 0.0238285344094038, -0.007332358043640852, -0.033370375633239746, 0.025536159053444862, -0.04812633991241455, -0.025405805557966232, 0.006305827759206295, 0.002691789995878935, 0.004164779093116522, -0.005471568554639816, -0.018966365605592728, 0.0065665338188409805, 0.008557676337659359, -0.033578939735889435, 0.035690657794475555, -0.002644537016749382, 0.023593898862600327, -0.013361185789108276, -0.019187966361641884, 0.006168956868350506, 0.02561436966061592, 0.001605786383152008, -0.017532482743263245, 0.0089487349614501, 0.0242978036403656, 0.011040901765227318, 0.01128857210278511, 0.03722882643342018, -0.02899051271378994, 0.013621891848742962, -0.025105994194746017, -0.002421307610347867, -0.010187089443206787, 0.022303402423858643, 0.005292332731187344, -0.008342593908309937, -0.0036433672066777945, 0.006928263697773218, 0.02475403994321823, -0.017454270273447037, 0.023724250495433807, 0.03227540850639343, -0.03675955533981323, 0.0023365779779851437, 0.015107915736734867, 0.003832379123196006, -0.016411446034908295, -0.005240191705524921, 0.021234508603811264, -0.025862039998173714, -0.031050091609358788, 0.018314599990844727, 0.029485855251550674, 0.009535323828458786, 0.06413368880748749, 0.01248130202293396, 0.023541757836937904, -0.022212155163288116, 0.012201043777167797, -0.011744807474315166, 0.006999957840889692, -0.0058626276440918446, 0.0005091915372759104, 0.005377062596380711, 0.014847209677100182, 0.004663379397243261, 0.03175399824976921, -0.005083768162876368, 0.03923626244068146, 0.009965488687157631, -0.00645573390647769, 0.009796029888093472, 0.0010159389348700643, 0.010721536353230476, -0.010578148066997528, -0.020309001207351685, 0.05845029652118683, 0.020243825390934944, 0.01531648077070713, 0.03428284823894501, -0.0215864609926939, 0.004643826745450497, 0.010499936528503895, -0.0027537078130990267, -0.005155462305992842, 0.013856527395546436, 0.017415164038538933, 0.040565863251686096, -0.020126506686210632, -0.01947474293410778, -0.0034348024055361748, 0.00030938477721065283, -0.010174053721129894, -0.007971087470650673, 0.012742008082568645, -0.0027390429750084877, 0.016750363633036613, -0.023346226662397385, 0.004725297447293997, 0.04343362897634506, 0.03204077482223511, 0.02106504887342453, -0.011933819390833378, 0.017089281231164932, 0.036420635879039764, 0.02073916606605053, -0.02595328725874424, -0.03748952969908714, 0.0022714014630764723, -0.03347465768456459, -0.005729015450924635, 0.022942133247852325, 0.016268057748675346, 0.018132105469703674, 0.01010887697339058, 0.006517651490867138, -0.018666554242372513, -0.017871400341391563, -0.03438713029026985, -0.009450594894587994, -0.0006904636975377798, -0.0029264255426824093, 0.04270365089178085, -0.03287503495812416, -0.00974388886243105, -0.011314642615616322, -0.005390097852796316, 0.004200626164674759, -0.014338833279907703, 0.010532524436712265, -0.009307206608355045, 0.0225250031799078, -0.02244679071009159, -0.017584623768925667, 0.026435595005750656, -0.0035879670176655054, 0.007971087470650673, -0.012018549256026745]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" abs/1604.06174,
2016.
Chowdhery, A., Narang, S., Devlin, J., Bosma, M., Mishra,
G., Roberts, A., Barham, P., Chung, H. W., Sutton,
C., Gehrmann, S., Schuh, P., Shi, K., Tsvyashchenko,
S., Maynez, J., Rao, A., Barnes, P., Tay, Y ., Shazeer,
N., Prabhakaran, V ., Reif, E., Du, N., Hutchinson, B.,
Pope, R., Bradbury, J., Austin, J., Isard, M., Gur-Ari,
G., Yin, P., Duke, T., Levskaya, A., Ghemawat, S., Dev,
S., Michalewski, H., Garcia, X., Misra, V ., Robinson,
K., Fedus, L., Zhou, D., Ippolito, D., Luan, D., Lim,
H., Zoph, B., Spiridonov, A., Sepassi, R., Dohan, D.,
Agrawal, S., Omernick, M., Dai, A. M., Pillai, T. S., Pel-
lat, M., Lewkowycz, A., Moreira, E., Child, R., Polozov,
O., Lee, K., Zhou, Z., Wang, X., Saeta, B., Diaz, M.,
Firat, O., Catasta, M., Wei, J., Meier-Hellstern, K., Eck,
D., Dean, J., Petrov, S., and Fiedel, N. Palm: Scaling
language modeling with pathways. J. Mach. Learn. Res. ,
24:240:1–240:113, 2023.
Clark, C., Lee, K., Chang, M., Kwiatkowski, T., Collins,
M., and Toutanova, K. Boolq: Exploring the surprising
difficulty of natural yes/no questions. In NAACL , 2019.
Corro, L. D., Giorno, A. D., Agarwal, S., Yu, T., Awadallah,
A. H., and Mukherjee, S. Skipdecode: Autoregressive
skip decoding with batching and caching for efficient llm
inference. ArXiv , abs/2307.02628, 2023.
Dai, Y ., Pan, R., Iyer, A., Li, K., and Netravali, R. Appa-
rate: Rethinking early exits to tame latency-throughput
tensions in ml serving. ArXiv , abs/2312.05385, 2023.
Dao, T., Fu, D. Y ., Ermon, S., Rudra, A., and Re, C. Flashat-
tention: Fast and memory-efficient exact attention with
IO-awareness. In NeurIPS , 2022.Data-Juicer. Refined open source dataset by data-
juicer. https://github.com/alibaba/
data-juicer/blob/main/configs/data_
juicer_recipes/README.md , 2023.
Devlin, J., Chang, M., Lee, K., and Toutanova, K. BERT:
pre-training of deep bidirectional transformers for lan-
guage understanding. In NAACL-HLT , pp. 4171–4186,
2019.
Din, A. Y ., Karidi, T., Choshen, L., and Geva, M. Jump
to conclusions: Short-cutting transformers with linear
transformations. ArXiv , abs/2303.09435, 2023.
Duggal, R., Freitas, S., Dhamnani, S., Chau, D. H., and
Sun, J. Elf: An early-exiting framework for long-tailed
classification. ArXiv , abs/2006.11979, 2020.
Elbayad, M., Gu, J., Grave, E., and Auli, M. Depth-adaptive
transformer. In ICLR , 2020.
Fan, S., Rong, Y ., Meng, C., Cao, Z., Wang, S., Zheng, Z.,
Wu, C., Long, G., Yang, J., Xia, L., Diao, L., Liu, X., and
Lin, W. DAPPLE: a pipelined data parallel approach for
training large models. In PPoPP , pp. 431–445, 2021.
Fedus, W., Zoph, B., and Shazeer, N. M. Switch","[-0.02012668177485466, 0.023310059681534767, 0.015544998459517956, 0.0050986106507480145, 0.014935098588466644, 0.00852371659129858, -0.025972791016101837, 0.05599174648523331, -0.05042827129364014, 0.022804290056228638, 0.036623720079660416, -0.03585018590092659, -0.008308020420372486, 0.016735045239329338, 0.00868734810501337, -0.003841622732579708, 0.05512896180152893, -0.006307252682745457, 0.006671704817563295, 0.058580100536346436, -0.022015882655978203, -0.04426977410912514, -0.01434751320630312, 0.019397778436541557, 0.026909954845905304, 0.0017283583292737603, 0.00625890726223588, 0.04177067428827286, 0.021182850003242493, -0.05099354311823845, 0.025348016992211342, -0.04061037674546242, -0.014897909946739674, -0.014964849688112736, -0.00227596634067595, 0.028992537409067154, 0.022164639085531235, 0.006392787676304579, -0.030420593917369843, 0.009706326760351658, -0.004529619123786688, -0.0643220767378807, -0.02003742754459381, 0.043436743319034576, -0.0275347288697958, 0.027415724471211433, 0.015500371344387531, -0.0032596150413155556, 0.011870726011693478, 0.05298687517642975, -0.025719907134771347, 0.025675280019640923, -0.04114589840173721, 0.021420858800411224, -0.04218719154596329, 0.006366755347698927, -0.010903812013566494, 0.048702701926231384, 0.03192302957177162, -0.030301589518785477, -0.02353319339454174, -0.04623335227370262, -0.004336236510425806, 0.031238753348588943, -0.04465654119849205, -0.006768396589905024, -0.055842988193035126, 0.0344221293926239, -0.003328414633870125, 0.03653446584939957, 0.0020639889407902956, 0.010926125571131706, 0.006165934726595879, -0.0505472756922245, 0.035136159509420395, -0.010717866942286491, -0.01686892658472061, 0.09127666056156158, -0.007430360186845064, -0.03019746020436287, 0.011060005985200405, 0.01497228816151619, 0.028174379840493202, -0.05004150792956352, -0.03950958326458931, -0.03814103081822395, -0.019338276237249374, 0.0111418217420578, -0.052600108087062836, -0.0020993186626583338, -0.0065378244034945965, -0.014578084461390972, -0.057419802993535995, -0.004682093858718872, 0.050844788551330566, 0.033053576946258545, 0.017731711268424988, -0.013283907435834408, 0.011788910254836082, 0.03150651231408119, -0.014667337760329247, -0.012078984640538692, 0.022967921569943428, -0.019442403689026833, 0.033559344708919525, -0.022328270599246025, -0.028129752725362778, -0.029230546206235886, -0.014421890489757061, 0.025600900873541832, -0.08794452250003815, -0.036058444529771805, -0.022551404312253, 0.014533457346260548, 0.03111974708735943, -0.03977734595537186, -0.014630149118602276, -0.010874060913920403, -7.246042514452711e-05, 0.006813023239374161, -0.016333404928445816, 0.015678878873586655, 0.0324288010597229, 0.0055895051918923855, 0.007400609087198973, -0.021986130625009537, 0.024262098595499992, -0.059829648584127426, -0.002257371786981821, -0.03400561213493347, 0.0012356042861938477, -0.002778017660602927, 0.05387941002845764, -0.030584225431084633, -0.007802250329405069, -0.03320233151316643, -0.033708103001117706, 0.009750953875482082, -0.043615248054265976, -0.009386501275002956, 0.031000742688775063, -0.004046162124723196, -0.021257227286696434, 0.0364154614508152, -0.038379039615392685, 0.0068650878965854645, -0.015664003789424896, -0.0020584105513989925, -0.012012043967843056, 0.033648598939180374, -0.011164135299623013, -0.001481981249526143, -0.017359821125864983, -0.00847909040749073, -0.027832241728901863, -0.0303462166339159, -0.011082319542765617, 0.06128745898604393, 0.03817078098654747, -0.07098634541034698, -0.00596511410549283, 0.02229851856827736, -0.015931764617562294, -0.0014838407514616847, 0.011283139698207378, 0.022819165140390396, -0.02670169621706009, 0.007965882308781147, -0.07747210562229156, -0.040878139436244965, -0.02095971629023552, -0.026627317070961, 0.003739353036507964, -0.03468989208340645, -0.004830849822610617, -0.02079608291387558, -0.039390578866004944, -0.0429309718310833, -0.017761461436748505, -0.0692012757062912, 0.009944336488842964, 0.028248757123947144, -0.03927157446742058, 0.00727416668087244, -0.02643393538892269, -0.03826003521680832, 0.026999207213521004, 0.032964322715997696, 0.011655029840767384, 0.05721154436469078, 0.002562321489676833, 0.05295712500810623, 0.04447803273797035, 0.00710681639611721, 0.005031670443713665, -0.029557809233665466, 0.07122435420751572, -0.010122843086719513, 0.017895342782139778, -0.019933300092816353, -0.005991146434098482, 0.04224669560790062, -0.013871493749320507, -0.039390578866004944, 0.01905563846230507, -0.019606035202741623, -0.006429976783692837, -0.021182850003242493, -0.02610667236149311, -0.05789582058787346, 0.053433142602443695, 0.009803017601370811, 0.023577820509672165, 0.022759662941098213, -0.03165527060627937, -0.03326183184981346, -0.02810000255703926, 0.017835840582847595, 0.019011011347174644, 0.03213128820061684, 0.025154633447527885, 0.03103049471974373, 0.03501715511083603, 0.013335972093045712, -0.030405718833208084, 0.013916120864450932, 0.0061324648559093475, -0.022670408710837364, 0.04739364981651306, -0.0050614215433597565, 0.04706638678908348, 0.005645288620144129, -0.009237745776772499, -0.025392642244696617, -0.005511408671736717, -0.040193863213062286, 0.02728184312582016, -0.04974399507045746, 0.022670408710837364, -0.030420593917369843, -0.002796612214297056, 0.0045110248029232025, 0.002606948371976614, 0.012607067823410034, -0.003479030216112733, 0.06301302462816238, -0.03474939242005348, -0.08056622743606567, 0.033886607736349106, 0.02161424234509468, 0.029290050268173218, -0.01564912684261799, 0.00042395450873300433, -0.015872260555624962, -0.023845581337809563, -0.04114589840173721, 0.006206842605024576, -0.0023261713795363903, -0.01994817517697811, 0.030256962403655052, -0.04340698942542076, 0.03358909860253334, 0.01497228816151619, 0.022834040224552155, 0.01176659669727087, 0.005998584441840649, -0.01880275458097458, 0.035641927272081375, -0.007616305258125067, -0.007359701208770275, 0.020320065319538116, 0.014362388290464878, 0.03632620722055435, 0.020156433805823326, -0.07080783694982529, -0.022581154480576515, 0.038468293845653534, 0.020439069718122482, -0.05087453871965408, 0.002843098482117057, 0.010673240758478642, 0.012986395508050919, 0.0465606153011322, 0.00403128657490015, 0.013388036750257015, 0.03186352923512459, 0.008263394236564636, -0.03129825368523598, -0.024187719449400902, -0.009825331158936024, 0.010702991858124733, -0.0025790564250200987, 0.0036091916263103485, -0.07253340631723404, 0.054028164595365524, 0.013120275922119617, 0.03519565984606743, 0.013826866634190083, 0.014072313904762268, -0.04548957571387291, 0.05355214700102806, -0.0272669680416584, 0.024321600794792175, 0.008315457962453365, 0.013231842778623104, 0.0285313930362463, -0.03873605281114578, -0.007690683472901583, 0.03936082869768143, -0.00026055536000058055, -0.023101801052689552, -0.014578084461390972, -0.012235177680850029, 0.008917920291423798, -0.048940710723400116, -0.04623335227370262, 0.027311595156788826, -0.039807096123695374, 0.023890208452939987, -0.045876339077949524, -0.04602509364485741, -0.028070250526070595, -0.03085198625922203, 0.0069357468746602535, -0.010316225700080395, 0.02810000255703926, -0.014087189920246601, 0.007389452308416367, -0.009572446346282959, -0.04069963097572327, 0.014987163245677948, 0.015530122444033623, 0.030137958005070686, -0.01114925928413868, -0.05405791848897934, -0.021420858800411224, -0.029304925352334976, 0.042216941714286804, 0.029245423153042793, 0.041621919721364975, -0.06438158452510834, -0.005957676563411951, -0.053522396832704544, -0.01330622099339962, -0.002969540888443589, 0.023414188995957375, -0.010442668572068214, 0.010836872272193432, 0.014756591990590096, 0.0447457954287529, -0.016422659158706665, -0.008427025750279427, 0.03233954682946205, -0.010911249555647373, -0.004410614259541035, 0.018847379833459854, -0.023756327107548714, -0.04242520034313202, -0.01963578723371029, -0.0022015883587300777, -0.0003725872084032744, 0.028129752725362778, 0.01483840774744749, 0.016095396131277084, -0.0012625661911442876, -0.0012885985197499394, -0.04209793731570244, -0.004142853431403637, 0.010636051185429096, -0.02868014946579933, 0.015931764617562294, 0.02778761461377144, -0.039212070405483246, -0.033975861966609955, -0.020275438204407692, 0.004213512875139713, -0.025675280019640923, 0.03885505720973015, 0.009304685518145561, 0.07068883627653122, -0.002052832394838333, 0.0306139774620533, -0.008226204663515091, -0.005675040185451508, -0.0005071648629382253, 0.01488303393125534, 0.004726720973849297, 0.003949470818042755, -0.017835840582847595, 0.011684780940413475, -0.015165670774877071, 0.0069952490739524364, -0.04920847341418266, 0.004938697908073664, -0.01439213939011097, 0.01630365289747715, 0.003216847777366638, 0.0026218239217996597, 0.024172844365239143, 0.024395978078246117, -0.011245951056480408, -0.00989227183163166, 0.0039457520470023155, -0.021108470857143402, -0.0007419203757308424, 0.051767077296972275, 0.05132080614566803, 0.03781376779079437, 0.01889200694859028, -0.012800450436770916, 0.01996305026113987, -0.05004150792956352, 0.018430864438414574, -0.010591425001621246, 0.0005968832992948592, -0.04233594611287117, -0.00927493441849947, 0.01597638987004757, -0.0010784807382151484, 0.06048417463898659, 0.011179010383784771, -0.02695458009839058, -0.06604764610528946, -0.042127687484025955, -0.07045082747936249, 0.03308332711458206, 0.041800424456596375, -0.05248110368847847, 0.04733414947986603, -0.044359028339385986, -0.016154898330569267, -0.003841622732579708, 0.03275606408715248, -0.013960747048258781, -0.016392907127738, -0.04641186073422432, 0.019501907750964165, 0.042216941714286804, 0.019323399290442467, -0.03483864665031433, -0.02054319903254509, 0.0014968569157645106, -0.007296480238437653, 0.01596151478588581, -0.06078168749809265, -0.01484584528952837, -0.023726576939225197, -0.005905611906200647, -0.006701456382870674, -0.05756855756044388, 0.021435733884572983, -0.009721201844513416, 0.0364154614508152, 0.00976582895964384, -0.01796972006559372, -0.018594495952129364, 0.06979630142450333, -0.023994337767362595, 0.05730079859495163, -0.008181578479707241, 0.04388301074504852, 0.020409317687153816, -0.036623720079660416, 0.004838287830352783, 0.008196453563869, 0.041116148233413696, 0.01646728441119194, 0.015381366945803165, 0.04498380422592163, 0.00329494453035295, 0.0006071102689020336, -0.0017209205543622375, -0.034719642251729965, -0.03486839681863785, -0.00278731482103467, 0.010747618041932583, 0.017835840582847595, -0.03599894419312477, -0.03126850351691246, -0.01905563846230507, 0.035731181502342224, -0.02820413000881672, 0.025972791016101837, -0.0038155904039740562, 0.039212070405483246, 0.05920487269759178, -0.0007210015901364386, 0.0039085629396140575, -0.00255860248580575, 0.0029509463347494602, 0.010546797886490822, -0.019159767776727676, 0.0653931200504303, -0.018415987491607666, 0.0072816042229533195, 0.016928428784012794, -0.025467021390795708, -0.028233882039785385, -0.010331101715564728, -0.02851651795208454, 0.028724776580929756, -0.01962091214954853, 0.027475226670503616, -0.020424194633960724, -0.00698409229516983, -0.011967417784035206, 0.027475226670503616, 0.000641974969767034, -0.0022555124014616013, 0.011223637498915195, 0.009260058403015137, -0.014897909946739674, 0.025080256164073944, 0.025660403072834015, 0.006734926253557205, 0.053938914090394974, -0.023473691195249557, 0.017672209069132805, -0.006548981182277203, 0.047542404383420944, -0.017508577555418015, -0.03111974708735943, -0.01712181232869625, -0.011498835869133472, 0.008635283447802067, -0.010933563113212585, -0.023399313911795616, -0.10139206796884537, -0.02826363407075405, -0.01695818081498146, 0.02552652359008789, 0.0022796851117163897, 0.006813023239374161, -0.0011928369058296084, -0.04679862782359123, 0.0007289042114280164, 0.0039011251647025347, -0.023161303251981735, -0.055099207907915115, -0.008419587276875973, 0.01375992689281702, 0.02778761461377144, 0.005533721763640642, 0.020483696833252907, -0.003518078476190567, -0.010888936929404736, 0.019115140661597252, -0.030911488458514214, -0.025348016992211342, 0.015217735432088375, 0.06301302462816238, -0.03843853995203972, 0.023235682398080826, -0.021569615229964256, 0.01804409921169281, -0.00021418534743133932, 0.04302022606134415, -0.02793636918067932, 0.0019031466217711568, -0.026329806074500084, 0.030420593917369843, -0.010167470201849937, -0.001672574901022017, 0.009051800705492496, -0.009304685518145561, -0.021167973056435585, 0.00029472276219166815, -0.04278221353888512, 0.004801098722964525, -0.0112757021561265, -0.005165550857782364, -0.02827850915491581, 0.008114637807011604, -0.023473691195249557, 0.00534777669236064, -0.021896878257393837, -0.012607067823410034, 0.009155930019915104, -0.014957412146031857, -0.007579116150736809, -0.06048417463898659, -0.02387533150613308, -0.04358549788594246, 0.014897909946739674, -0.03686172887682915, 0.019234146922826767, 0.02869502641260624, 0.007757623679935932, -0.040193863213062286, 0.0062998151406645775, 0.03335108608007431, -0.024559609591960907, -0.011788910254836082, -0.04789942130446434, -0.02412821725010872, -0.00409450801089406, 0.024425730109214783, -0.0272669680416584, -0.043615248054265976, 0.01811847649514675, -0.007876628078520298, -0.02502075396478176, -0.01780608855187893, -0.01688380166888237, -0.012882266193628311, -0.005991146434098482, -0.017850715667009354, 0.010926125571131706, 0.005820076912641525, -0.007575397379696369, 0.01396818459033966, -0.002606948371976614, -0.024143092334270477, -0.04081863537430763, -0.012562441639602184, -0.011610402725636959, -0.037129487842321396, -0.02894791029393673, 0.031893279403448105, -0.021405983716249466, -0.004890352487564087, -0.042216941714286804, -0.0032391611021012068, 0.007787374779582024, 0.002138366922736168, 0.017776338383555412, 0.00020814214076381177, -0.025303389877080917, -0.018401112407445908, -0.013953309506177902, -0.023919958621263504, -0.015842510387301445, 0.0306139774620533, 0.024574484676122665, 0.01439213939011097, -0.0006066454225219786, -0.009743515402078629, -0.0009948054794222116, 0.013112838380038738, -0.019070515409111977, -0.012666570022702217, 0.012183113023638725, 0.014444204047322273, -0.011201323941349983, 0.029542934149503708, -0.007181194145232439, -0.01771683618426323, 0.0063370042480528355, -0.004905228037387133, -0.005247366614639759, -0.024514982476830482, -0.04072938486933708, 0.04608459770679474, -0.0036593966651707888, 0.03266680985689163, -0.0182969830930233, -0.008880730718374252, -0.026062045246362686, -0.011707094497978687, 0.004778785165399313, -0.03379735350608826, 0.010903812013566494, 9.099681483348832e-05, -0.015195421874523163, -0.002359641483053565, 0.052362099289894104, 0.042544204741716385, 0.03861704841256142, 0.03769475966691971, -0.001112880534492433, 0.0017701960168778896, 0.002906319685280323, 0.041205402463674545, 0.0027315313927829266, 0.0035720025189220905, -0.05631900951266289, 0.020558074116706848, -0.005782888270914555, 0.010450106114149094, 0.0425739586353302, -0.06699968874454498, 0.038944311439991, -0.08360084891319275, -0.007757623679935932, 0.015678878873586655, -0.025407519191503525, 0.021063843742012978, 0.00015607754176016897, 0.011372393928468227, -0.008575781248509884, -0.001444792258553207, -0.005455624777823687, 0.009624511003494263, -0.017106935381889343, -0.015002039261162281, 0.005849828477948904, 0.006675424054265022, 0.03974759206175804, -0.037635259330272675, -0.09758391231298447, -0.009951774030923843, -0.0029286330100148916, -0.015187984332442284, -0.008910481818020344, -0.02860577218234539, -0.004157728981226683, -0.020007677376270294, 0.0203795675188303, 0.057509057223796844, -0.04432927817106247, -0.026642194017767906, 0.01234674546867609, -0.015827635303139687, 0.02679094858467579, -0.045608580112457275, 0.016110271215438843, 0.008464214392006397, 0.02461911179125309, 0.00046951102558523417, -0.03820053115487099, -0.03927157446742058, 0.004116821102797985, -0.018505241721868515, -0.005399841349571943, 0.017166437581181526, -0.02393483556807041, -0.013202091678977013, -0.002288982504978776, 0.0002468419261276722, 0.0018743250984698534, 0.0024284410756081343, 0.02104896865785122, 0.01945728063583374, -0.0423954501748085, -0.011283139698207378, 0.009326999075710773, -0.04358549788594246, 0.0034753112122416496, -0.013127713464200497, -0.005083735100924969, -0.02302742376923561, -0.017568079754710197, 0.018430864438414574, 0.023562945425510406, -0.012324431911110878, -0.005158112850040197, 0.004284171853214502, 0.014154129661619663, -0.007943568751215935, 0.003904844168573618, -0.01971016451716423, 0.015411118045449257, -0.004049881361424923, -0.0026385588571429253, -0.02668681927025318, -0.030494973063468933, 0.004124259110540152, -0.0007461041095666587, -0.01005590334534645, 0.02969169057905674, 0.017166437581181526, 0.020840710029006004, -0.011126945726573467, 0.03701048344373703, -0.0001421316701453179, -0.005756855942308903, 0.007385733537375927, -0.030554475262761116, -0.03593944013118744, 0.04974399507045746, -0.016392907127738, -0.012093859724700451, 0.021986130625009537, 0.012949206866323948, 0.05521821230649948, -0.008724537678062916, -0.0031685021240264177, 0.0364154614508152, -0.007240696344524622, 0.01300870906561613, -0.02072170563042164, -0.0028207849245518446, 0.012428561225533485, -0.020751457661390305, -0.04099714383482933, -0.03793277218937874, -0.038974061608314514, -0.006980373524129391, -0.013105400837957859, -0.04465654119849205, -0.03052472323179245, -0.0018464333843439817, 0.012190551497042179, 0.0038974061608314514, 0.01996305026113987, 0.02454473450779915, 0.00625518849119544, -0.09805992990732193, -0.025660403072834015, 0.020096931606531143, 0.006705175153911114, 0.011164135299623013, -0.03826003521680832, 0.023220805451273918, 0.036474961787462234, 0.003313539084047079, -0.028546269983053207, 0.027504978701472282, -0.011052568443119526, 0.01005590334534645, 0.015098730102181435, 0.02170349471271038, -0.05819333344697952, 0.037724513560533524, -0.026002543047070503, 0.06331054121255875, -0.00041372753912582994, -0.027460351586341858, 0.004942417144775391, 0.023994337767362595, 0.029557809233665466, -0.020900212228298187, 0.00973607785999775, 0.009631948545575142, -0.00046137592289596796, 0.009721201844513416, 0.013722737319767475, -0.030316464602947235, -0.02554139867424965, 0.0009659840143285692, 0.04947623237967491, -0.032547805458307266, 0.018282108008861542, -0.018267232924699783, -0.010256723500788212, 0.003428824944421649, -0.01426569651812315, -0.010717866942286491, -0.055515725165605545, 0.033380839973688126, -0.017196189612150192, 0.027147963643074036, 0.026255426928400993, 0.002112334594130516, -0.02519926056265831, 0.020082054659724236, 0.013365723192691803, 0.017315194010734558, -0.01085174735635519, -0.008739412762224674, 0.024083590134978294, 0.00020395837782416493, -0.018148228526115417, 0.019650662317872047, -0.0007805039640516043, 0.031804025173187256, 0.017672209069132805, -0.01364092156291008, 0.03781376779079437, 0.009096426889300346, -0.022685283794999123, 0.010107968002557755, -0.015872260555624962, -0.0142210703343153, 0.016021016985177994, -0.007913817651569843, -0.04757215827703476, -0.038379039615392685, 0.039212070405483246, 0.02072170563042164, 0.0069357468746602535, -0.002809628378599882, 0.0010961454827338457, 0.030405718833208084, 0.02528851479291916, -0.02719259075820446, -0.022655533626675606, 0.06283451616764069, -0.025571150705218315, -0.019070515409111977, -0.013410350307822227, -0.008159264922142029, 0.012272367253899574, 0.00013039390614721924, -0.004168885760009289, 0.010442668572068214, 0.03349984437227249, 0.052689362317323685, -0.002856114413589239, 0.0007154232007451355, -0.01804409921169281, 0.01954653300344944, 3.2540367101319134e-05, -0.0016865207580849528, 0.03968809172511101, 0.029156168922781944, 0.007951006293296814, 0.022224141284823418, 0.04290122166275978, -0.05971064418554306, -0.00547050079330802, -0.026463685557246208, 0.027891743928194046, 0.015210296958684921, 0.010531921871006489, -0.013983060605823994, -0.01126826461404562, 0.006162215955555439, -0.0006898557767271996, -0.014979725703597069, 0.01564912684261799, 0.017939969897270203, 0.019189519807696342, 0.021227475255727768, 0.01945728063583374, -0.0011807504342868924, 0.006121308077126741, 0.010234409943223, 0.021227475255727768, -0.021078720688819885, 0.01297152042388916, -0.044537536799907684, -0.03111974708735943, 0.0463821105659008, -0.005318025592714548, -0.016779672354459763, -0.014734278433024883, 0.02668681927025318, 0.008077449165284634, -0.021093595772981644, 0.006764677353203297, 0.03076273389160633, 0.016854051500558853, 0.03692122921347618, 0.03965834155678749, -0.02985532209277153, 0.04010460898280144, -0.0018594495486468077, -0.010085654444992542, 0.016095396131277084, -0.007311355788260698, 0.012294680811464787, -0.007809688337147236, -0.028650399297475815, -0.014860720373690128, -0.01405000127851963, -0.012577316723763943, 0.013826866634190083, 0.005544878542423248, -0.02978094480931759, 0.015262361615896225, -0.008955108933150768, 0.02594304084777832, -0.019323399290442467, -0.03784351795911789, 0.004860600922256708, 0.0492679737508297, 0.026969457045197487, 0.02402408793568611, 0.009825331158936024, -0.02894791029393673, 0.012197989039123058, -0.032220542430877686, -0.03611794859170914, -0.009141054004430771, -0.03352959454059601, 0.025928163900971413, -0.008583218790590763, 0.018103601410984993, 0.03665347024798393, 0.027891743928194046, 0.010204658843576908, 0.03085198625922203, 0.010457544587552547, 0.0008311739657074213, 0.015381366945803165, 0.026746321469545364, 0.024232346564531326, -0.007512176409363747, -0.019174644723534584, -0.016526788473129272, 0.03228004276752472, 0.022075384855270386, 0.014920223504304886, -0.009713764302432537, -0.0006982233026064932, 0.024812495335936546, -0.007058470509946346, 0.01938290148973465, 0.0006559208268299699, 0.035552676767110825, -0.004760190844535828, -0.02569015510380268, 0.0064076632261276245, 0.02926029823720455, -0.016199525445699692, -0.022239016368985176, 0.02878427878022194, 0.02710333652794361, 0.009535257704555988, 0.006232874933630228, -0.044716041535139084, 0.030331341549754143, 0.011610402725636959, -0.02194150537252426, 0.00028333361842669547, 0.05170757323503494, -0.014124378561973572, 0.004042443353682756, -0.016110271215438843, 0.032785814255476, -0.011989730410277843, 0.004890352487564087, 0.018996136263012886, 0.008055135607719421, -0.031744521111249924, -0.012584754265844822, -0.027222340926527977, -0.03793277218937874, -0.014354950748383999, -0.011833537369966507, -0.014711964875459671, 0.002586494432762265, 0.02121260017156601, -0.01706230826675892, -0.0029992922209203243, -0.001463386812247336, -0.017984597012400627, 0.013164903037250042, -0.007192350924015045, 0.01375992689281702, 0.01663091592490673, -0.013670672662556171, 0.003542251419275999, 0.008419587276875973, -0.006307252682745457, -0.007497300393879414, 0.03418412059545517, 0.011454209685325623, 0.018341610208153725, -0.0024061277508735657, 0.005020513664931059, 0.0064076632261276245, 0.021911753341555595, 0.01744907535612583, -0.006548981182277203, -0.020007677376270294, 0.003923438489437103, -0.00911130290478468, 0.03501715511083603, 0.015574749559164047, 0.0035794402938336134, 0.0002531175850890577, 0.003174080280587077, 0.05673552304506302, 0.026389308273792267, 0.05286787077784538, -0.00642253877595067, 0.01728544384241104, -0.0036482401192188263, -0.020096931606531143, 0.003923438489437103, -0.014235945418477058, -0.005053984001278877, -0.009044362232089043, -0.014012811705470085, 0.009795580059289932, -0.03742700070142746, 0.03692122921347618, -0.0001880368363345042, 0.0192043948918581, 0.015902012586593628, -0.018415987491607666, -0.010160032659769058, -0.011744283139705658, -0.00042627879884094, -5.226796565693803e-05, -0.009594759903848171, -0.03108999691903591, 0.005332901142537594, 0.010323664173483849, 0.011647592298686504, -0.007698121014982462, -0.04197893291711807, -0.01239880919456482, 0.023235682398080826, -0.03769475966691971, 0.009832769632339478, 0.015321864746510983, -0.028843780979514122, -0.006169653497636318, -0.029453681781888008, 0.004072194453328848, -0.0027129368390887976, 0.005849828477948904, 0.03382710739970207, -0.02543726935982704, 0.016392907127738, 0.032726313918828964, 0.025481896474957466, 0.004667218308895826, 0.02612154744565487, -0.00036654400173574686, 0.00363708334043622, -0.05423642322421074, 0.003726336872205138, 0.008367522619664669, -0.01392355840653181, 0.003255896270275116, 0.006731207482516766, -0.006872525438666344, 0.013588856905698776, 0.012830201536417007, -0.005849828477948904, -0.028233882039785385, 0.008427025750279427, -0.00688368221744895, -0.0039011251647025347, 0.021346481516957283, 0.03540391847491264, 0.013388036750257015, -0.0272669680416584, -0.010829433798789978, 0.014570646919310093, -0.01314258947968483, 0.03468989208340645, 0.0212869793176651, 0.0091038653627038, -0.0018947790376842022, -0.01838623732328415, 0.03519565984606743, -0.016259027644991875, 0.009832769632339478, -0.01712181232869625, 0.011402145028114319, -0.0014643165050074458, -0.014109503477811813, 0.010561673901975155, 0.006496916525065899, 0.0028263633139431477, -0.004737877286970615, 0.016080519184470177, -0.009631948545575142, 0.006165934726595879, 0.006277501583099365, 0.009126177988946438, -0.0262703038752079, 0.07455649226903915, 0.004284171853214502, 0.001559148426167667, -0.0008660386083647609, -0.02570503018796444, 0.016690419986844063, -0.032547805458307266, -0.0018408551113680005, -0.023577820509672165, 0.0006331425975076854, -0.0022796851117163897, 0.04185992851853371, -0.029304925352334976, -0.005764293484389782, 0.035552676767110825, -0.01097819022834301, -0.030822236090898514, 0.011647592298686504, -0.01422850787639618, 0.021926628425717354, 0.03201228380203247, 0.03236929699778557, -0.008218767121434212, -0.024767868220806122, -0.003122015856206417, 0.011907914653420448, 0.004789941944181919, -0.0016019158065319061, 0.010018713772296906, 0.05977014824748039, -0.00864272192120552, -0.02760910615324974, -0.0296173132956028, 0.020736580714583397, -0.011126945726573467, 0.03195277974009514, -0.019353151321411133, 0.02751985378563404, -0.018163103610277176, -0.010777370072901249, 0.005251085385680199, 0.004447803366929293, -0.003302382305264473, 0.00926749687641859, 0.0013443820644170046, 0.01018234621733427, -0.00943856593221426, 0.00227596634067595, -0.007021281402558088, 0.004206074867397547, 0.010368290357291698, -0.007054751738905907, 0.009817893616855145, -0.02894791029393673, -0.028814030811190605, -0.023057173937559128, 0.008828666061162949, 0.07384245842695236, 0.035731181502342224, 0.01854986883699894, -0.04090788960456848, 0.020260563120245934, -0.003994097467511892, 0.0008711520931683481, -0.017939969897270203, -0.04507305845618248, -0.02336956188082695, -0.03852779418230057, 0.02014155685901642, 0.0202010590583086, -0.018356485292315483, 0.014429328963160515, 0.011446771211922169, -0.026731446385383606, 0.014615273103117943, 0.02460423670709133, 0.0011435614433139563, 0.01713668741285801, 0.04888121038675308, 0.04376400634646416, -0.030316464602947235, -0.004734158515930176, -0.009356750175356865, 0.027400849387049675, 0.03085198625922203, 0.0034753112122416496, 0.007430360186845064, -0.01945728063583374, -0.023592695593833923, 0.017002806067466736, 0.007266728673130274, 0.00130998226813972, 0.026240551844239235, 0.04424002394080162, -0.014020249247550964, -0.012934330850839615, -0.031476762145757675, -0.006567575968801975, 0.029052039608359337, 0.010777370072901249, -0.009304685518145561, -0.0008386117406189442, -0.03590968996286392, -0.017255691811442375, -0.012026919983327389, 0.0033934954553842545, -0.047780416905879974, -0.017939969897270203, 0.01471940241754055, 0.00021953126997686923, -0.0047155641950666904, -0.00802538450807333, 0.02987019717693329, 0.022596031427383423, 0.015678878873586655, 0.0137673644348979, -0.00108034024015069, 0.010271599516272545, -0.01962091214954853, -0.04557882621884346, 0.029126416891813278, 0.030911488458514214, 0.027653733268380165, -0.005132080987095833, -0.01872837543487549, -0.009431128390133381, 0.030732981860637665, -0.024485232308506966, -0.010955876670777798, -0.011283139698207378, -0.01889200694859028, -0.01953165791928768, 0.018847379833459854, -0.010323664173483849, 0.006247750483453274, 0.036058444529771805, -0.006891120225191116, -0.01606564410030842, -0.019189519807696342, 0.00494613591581583, 0.01646728441119194, 0.04138391092419624, 0.012339306995272636, 0.03947983309626579, 0.023399313911795616, -0.03965834155678749, -0.015544998459517956, -0.026151297613978386, 0.021673744544386864, 0.01396818459033966, -0.00386765506118536, -0.009631948545575142, 0.01239137165248394, 0.012859953567385674, 0.010241848416626453, -0.012986395508050919, 0.017820963636040688, -0.02069195546209812, 0.005693634506314993, -0.0232803076505661, -0.01176659669727087, 0.011171572841703892, -0.007039876189082861, 0.008114637807011604, 0.005135799758136272, -0.04028311371803284, -0.03320233151316643, 0.006876244675368071, 0.012272367253899574, 0.02479761838912964, -0.005745699163526297, 0.0284421406686306, -0.013507041148841381, -0.01795484498143196, -0.013053336180746555, -0.0146747762337327, -0.010859185829758644, -0.013611170463263988, -0.006786990910768509, 0.005016794893890619, -0.013097962364554405, -0.006098994519561529, 0.023324934765696526, 0.009022049605846405, -0.01936802640557289, 0.02469349093735218, 9.12292452994734e-05, -0.0021922909654676914, -0.016526788473129272, -0.01297152042388916, 0.00043673822074197233, -0.019487030804157257, 0.033975861966609955, 0.012874828651547432, 0.0027445475570857525, 0.03373785316944122, -0.012502938508987427, 0.0306139774620533, 0.027742987498641014, 0.02203075774013996, -0.009557570330798626, -0.006887400988489389, -0.008731975220143795, -0.01018234621733427, -0.017330069094896317, 0.0074638305231928825, 0.005548597313463688, 0.0013285767054185271, -0.004544494673609734, -0.010249285958707333, -0.02412821725010872, -0.004905228037387133, 0.005604380741715431, 0.013350848108530045, 0.03751625493168831, -0.008270831778645515, 0.00011813315359177068, 0.019323399290442467, -0.04766141250729561, -0.023072050884366035, -0.000154334309627302, 0.01007077842950821, 0.020230811089277267, 0.00517298886552453, -0.0035664241295307875, 0.03775426372885704, 0.02220926620066166, -0.01938290148973465, 0.008612969890236855, 0.026314930990338326, 0.005258523393422365, 0.005983708892017603, -0.0007488933042623103, -0.01722593978047371, 0.009572446346282959, -0.01271863467991352, 0.002982557052746415, 0.00688368221744895, 0.00898486003279686, 0.005548597313463688, -0.025824034586548805, 0.01805897429585457, -0.009914585389196873, 0.017687084153294563, -0.05828258767724037, 0.07384245842695236, 0.032547805458307266, 0.028397513553500175, -0.027906619012355804, 0.034481633454561234, -0.03317258134484291, 0.0194721557199955, -0.002054691780358553, -0.0342436246573925, 0.00898486003279686, -0.046858128160238266, -0.011610402725636959, -0.004842006601393223, 0.0032744905911386013, -0.004864320158958435, -0.011067443527281284, -0.03778401389718056, 0.0026181049179285765, 0.004529619123786688, -0.04540032148361206, 0.03778401389718056, -0.01704743318259716, 0.016259027644991875, -0.001017118920572102, -0.0112757021561265, -0.01409462746232748, 0.023919958621263504, -0.014540895819664001, 0.002175556030124426, 0.003337712027132511, 0.022432399913668633, 0.02452985942363739, 0.011179010383784771, 0.01779121346771717, -0.015530122444033623, 0.028323136270046234, 0.003003010991960764, -0.014109503477811813, 0.005132080987095833, 0.019323399290442467, 0.006217999383807182, -0.01346985250711441, -0.01728544384241104, 0.012726073153316975, 0.022506777197122574, -0.012458312325179577, 0.03811127692461014, 0.01863912306725979, -0.03308332711458206, 0.004046162124723196, 0.009408814832568169, -0.0019617192447185516, -0.01068067830055952, -0.02145061083137989, 0.0262703038752079, -1.1512607670738362e-05, -0.01695818081498146, 0.004537057131528854, 0.022105136886239052, 0.015292112715542316, 0.045370567589998245, -0.01364092156291008, 0.023324934765696526, -0.011751721613109112, 0.0070435949601233006, 0.0037988554686307907, 0.03269656002521515, 0.0022610905580222607, 0.016095396131277084, 0.015210296958684921, 0.029721440747380257, 0.0026032293681055307, 0.03245855122804642, -0.000534126884303987, 0.029721440747380257, -0.0021997287403792143, -0.00031261995900422335, 0.017984597012400627, -0.00065499113406986, -0.0069952490739524364, -0.01697305589914322, -0.032071784138679504, 0.05527771636843681, 0.029007412493228912, -0.016021016985177994, 0.02052832394838333, 0.011870726011693478, 0.0234588161110878, -0.0012653553858399391, -0.0015042946906760335, 0.008412149734795094, 0.006846493110060692, 0.0324288010597229, 0.037962522357702255, -0.03415437042713165, -0.03284531831741333, 0.0020063461270183325, -0.016601165756583214, -0.01747882552444935, -0.008003070950508118, 0.007021281402558088, 0.009654262103140354, 0.014131817035377026, -0.012547565624117851, -0.0034994841553270817, 0.04233594611287117, 0.015738381072878838, 0.026671944186091423, -0.013581419363617897, 0.0043287985026836395, 0.026151297613978386, 0.03358909860253334, -0.022848915308713913, -0.013395474292337894, 0.01410206500440836, -0.03739725053310394, 0.005730823613703251, 0.0059502385556697845, 0.015061541460454464, -0.0007386663346551359, 0.036802224814891815, 0.0032986635342240334, -0.006913433317095041, -0.03611794859170914, -0.02903716452419758, -0.022090259939432144, 0.006139902397990227, 0.023637322708964348, 0.028412388637661934, -0.034987401217222214, -0.000903227599337697, -0.02787686698138714, -0.0021922909654676914, 0.03317258134484291, -0.022491902112960815, 0.03153626620769501, -0.014161568135023117, 0.011818661354482174, -0.013365723192691803, 0.0014661760069429874, 0.013997936621308327, -0.015292112715542316, 0.02095971629023552, -0.012279804795980453]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" transform-
ers: Scaling to trillion parameter models with simple and
efficient sparsity. J. Mach. Learn. Res. , 23:120:1–120:39,
2021.
Gera, A., Friedman, R., Arviv, O., Gunasekara, C., Sznajder,
B., Slonim, N., and Shnarch, E. The benefits of bad
advice: Autocontrastive decoding across model layers. In
ACL, 2023.
Graves, A. Adaptive computation time for recurrent neural
networks. ArXiv , abs/1603.08983, 2016.
Han, Y ., Huang, G., Song, S., Yang, L., Wang, H., and
Wang, Y . Dynamic neural networks: A survey. IEEE
Trans. Pattern Anal. Mach. Intell. , 44(11):7436–7456,
2022.
Hou, L., Huang, Z., Shang, L., Jiang, X., Chen, X., and Liu,
Q. Dynabert: Dynamic BERT with adaptive width and
depth. In NeurIPS , 2020.
Hu, B., Zhu, Y ., Li, J., and Tang, S. Smartbert: A promotion
of dynamic early exiting mechanism for accelerating bert
inference. In IJCAI , 2023.
Huang, G., Chen, D., Li, T., Wu, F., van der Maaten, L.,
and Weinberger, K. Q. Multi-scale dense networks for
resource efficient image classification. In ICLR , 2018.
Huang, Y ., Cheng, Y ., Bapna, A., Firat, O., Chen, D., Chen,
M. X., Lee, H., Ngiam, J., Le, Q. V ., Wu, Y ., and Chen, Z.
Gpipe: Efficient training of giant neural networks using
pipeline parallelism. In NeurIPS , pp. 103–112, 2019.
10
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
Ilhan, F., Su, G., and Liu, L. Scalefl: Resource-adaptive
federated learning with heterogeneous clients. In CVPR ,
pp. 24532–24541, 2023.
Jacobs, R. A., Jordan, M. I., Nowlan, S. J., and Hinton, G. E.
Adaptive mixtures of local experts. Neural Computation ,
3:79–87, 1991.
Kaya, Y ., Hong, S., and Dumitras, T. Shallow-deep net-
works: Understanding and mitigating network overthink-
ing. In ICML , volume 97, pp. 3301–3310, 2019.
Kim, S., Hooper, C., Wattanawong, T., Kang, M., Yan,
R., Gen c ¸, H., Dinh, G., Huang, Q., Keutzer, K., Ma-
honey, M. W., Shao, Y . S., and Gholami, A. Full stack
optimization of transformer inference: a survey. ArXiv ,
abs/2302.14017, 2023a.
Kim, S., Mangalam, K., Moon, S., Malik, J., Mahoney,
M. W., Gholami, A., and Keutzer, K. Speculative decod-
ing with big little decoder. In NeurIPS , 2023b.
Kim, Y ., Denton, C., Hoang, L., and Rush, A. M. Structured
attention networks. In ICLR , 2017.
Kingma, D. P. and Ba, J. Adam: A method for stochastic
optimization. In ICLR , 2014.
Korthikanti, V . A., Casper, J., Lym, S., McAfee, L. C.,
Andersch, M., Shoeybi, M., and Catanzaro, B. Reduc-
ing activation recomputation in large transformer models.
ArXiv , abs/2205.05198, 2022.
Kwiatkowski, T., Palomaki, J., Redfield, O., Collins, M.,
Parikh, A. P., Alberti, C., Epstein, D., Polosukhin, I.,
Devlin, J., Lee, K., Toutanova, K., Jones, L., Kelcey,
M., Chang, M., Dai, A. M., Uszkoreit, J., Le, Q., and
","[-0.004509544465690851, 0.019031105563044548, 0.0015324866399168968, 0.004868101328611374, 0.014976652339100838, 0.0035545416176319122, -0.01583167351782322, 0.0483776219189167, -0.07309047877788544, 0.042833779007196426, 0.024464624002575874, -0.007653813809156418, -0.020437752828001976, 0.022589094936847687, -0.009915481321513653, 0.0011894440976902843, 0.025361016392707825, -0.0003163231594953686, 0.025154156610369682, 0.03607635572552681, -0.03715202584862709, -0.04153745621442795, 0.014107841067016125, 0.0358281247317791, 0.04705371707677841, 0.011701371520757675, 0.01945861615240574, 0.022492559626698494, 0.04857068881392479, -0.04095824807882309, 0.021830609068274498, -0.03320790082216263, -0.04597804695367813, -0.03585570678114891, -0.015624812804162502, 0.02940167859196663, 0.01988612674176693, 0.03301483020186424, -0.02344411425292492, 0.035193752497434616, 0.006719497032463551, -0.05830689147114754, -0.03618668019771576, 0.03262869268655777, -0.018369153141975403, 0.02333378978073597, 0.011866859160363674, -0.012059928849339485, 0.01643846184015274, 0.07717251032590866, -0.029925722628831863, 0.012549497187137604, -0.048294875770807266, 0.007057368289679289, -0.051025427877902985, 0.011135954409837723, -0.0024599081370979548, 0.006395416799932718, 0.02096179686486721, -0.00033140668529085815, -0.012266788631677628, -0.0559900626540184, -0.000151912696310319, 0.030891070142388344, -0.04266829043626785, -0.022051258012652397, -0.06509189307689667, 0.03869657963514328, -0.02125140093266964, 0.029015539214015007, -0.01912763901054859, 0.004616422113031149, 0.029236190021038055, -0.05025314912199974, -0.006616067141294479, 0.027402034029364586, -0.019362080842256546, 0.09658975154161453, -0.0149490712210536, -0.025292063131928444, 0.005526605527848005, -0.008191649802029133, 0.025292063131928444, -0.05394904688000679, -0.034007757902145386, -0.02472664602100849, -0.0184794794768095, -0.03345613181591034, -0.0425579659640789, 0.000734352448489517, 0.011804801411926746, 0.010846351273357868, -0.03618668019771576, -0.0023633737582713366, 0.03298724815249443, 0.03535924106836319, 0.04774324968457222, 0.005605901591479778, 0.03977225348353386, 0.06558836251497269, 0.010515375062823296, 0.019582731649279594, 0.025388598442077637, -0.03527649864554405, 0.006081679370254278, -0.04167536273598671, -0.027705427259206772, -0.021196238696575165, -0.019444825127720833, 0.030642837285995483, -0.10563642531633377, -0.00987410917878151, -0.014687048271298409, -0.011211803182959557, 0.003087382996454835, -0.06558836251497269, -0.03420082479715347, 0.00999822560697794, -0.0020013689063489437, 0.012997693382203579, -0.005112885497510433, -0.010584328323602676, 0.03629700466990471, 0.03144269436597824, 0.010529166087508202, -0.02904312126338482, 0.01921038329601288, -0.03097381256520748, -0.01827261969447136, -0.02035500854253769, -0.02013435773551464, 0.0012601212365552783, 0.03820011764764786, -0.042833779007196426, -0.011984080076217651, -0.03552472963929176, -0.0396343432366848, 0.025567876175045967, -0.018300199881196022, -0.01119801215827465, 0.039579182863235474, 0.002003092784434557, -0.024616321548819542, 0.0034149112179875374, -0.06503673642873764, 0.04368879646062851, 0.007771034725010395, 0.011908231303095818, -0.035055845975875854, 0.018313990905880928, -0.020837681367993355, 0.006160975433886051, -0.04195117577910423, -0.015748929232358932, -0.04870859533548355, -0.04189601168036461, -0.027374451979994774, 0.06376799196004868, 0.04004806652665138, -0.06757421046495438, 0.010915304534137249, 0.04906715452671051, -0.0011635866248980165, 0.03260111063718796, 0.02236844412982464, 0.05814140662550926, -0.03764849156141281, -0.005137019325047731, -0.05990660935640335, -0.0333733856678009, 0.005199077073484659, -0.028519077226519585, -0.005950667895376682, -0.008557101711630821, 0.011329024098813534, 0.0017772708088159561, -0.04666757956147194, -0.05179770290851593, -0.009425912983715534, -0.05298370122909546, -0.0010627424344420433, 0.016466043889522552, -0.032932087779045105, 0.013204553164541721, -0.045316096395254135, -0.029677491635084152, -0.01744518056511879, 0.029263772070407867, 0.02315451204776764, 0.049011990427970886, -0.01053606066852808, 0.045784976333379745, 0.05634862184524536, 0.024023322388529778, 0.009881004691123962, -0.007757244165986776, 0.0564313642680645, -0.038531091064214706, 0.01751413382589817, -0.015238674357533455, 0.006340254098176956, 0.029429258778691292, 0.0016867696540430188, -0.05521778762340546, 0.03715202584862709, -0.028850052505731583, -0.003937232308089733, 0.0033390624448657036, -0.016672903671860695, -0.02570578269660473, 0.04468172416090965, 0.02149963192641735, 0.036379750818014145, 0.00322528975084424, -0.022313281893730164, -0.018176084384322166, -0.05273546651005745, 0.005316297989338636, 0.01330108754336834, 0.029208609834313393, 0.01345968060195446, -0.0008972545620054007, -0.011266965419054031, -0.0016962506342679262, -0.03557989373803139, 0.01791406236588955, 0.021375516429543495, -0.03392501175403595, 0.04175810515880585, 0.007122873794287443, 0.04526093229651451, -0.004830177407711744, -0.0054576522670686245, -0.01154277939349413, -0.0018065759213641286, -0.03822769969701767, 0.03083590604364872, -0.0342559888958931, 0.024175019934773445, -0.052680306136608124, 0.02451978623867035, 0.015528278425335884, -0.019072476774454117, 0.005047379992902279, -0.023499278351664543, 0.06112018600106239, -0.03166334703564644, -0.051025427877902985, -0.006933252327144146, 0.03646249324083328, -0.013480366207659245, -0.011004943400621414, -0.0059748017229139805, -0.002565061906352639, -0.022409815341234207, -0.010156817734241486, 0.01834157295525074, -0.002387507352977991, -0.01737622730433941, 0.000936902710236609, -0.02445083297789097, 0.04145471006631851, 0.02400953136384487, -0.003330443287268281, 0.0009627601830288768, -0.0032787283416837454, -0.04071001708507538, 0.014149213209748268, -0.012135777622461319, -0.02125140093266964, 0.023251045495271683, -0.016176439821720123, 0.002185818972066045, 0.007398686837404966, -0.061616651713848114, -0.020589448511600494, 0.02519552782177925, 0.039937738329172134, -0.062223438173532486, 0.00302877277135849, 0.01092909462749958, 0.01758308708667755, 0.07005653530359268, 0.0097430981695652, 0.021016959100961685, 0.018865616992115974, -0.014549141749739647, -0.026933150365948677, -0.05452825501561165, -0.03557989373803139, 0.01412163209170103, -0.008102010004222393, -0.004985322244465351, -0.042695872485637665, 0.025871271267533302, 0.01567997597157955, 0.000688670901581645, 0.02286490797996521, 0.01849326863884926, -0.04967394098639488, 0.015128349885344505, -0.008460567332804203, 0.0005438689840957522, 0.007764139212667942, -0.009467285126447678, 0.04308201000094414, -0.033290643244981766, -0.0003917408175766468, 0.03342854976654053, -0.010708444751799107, -0.009212157689034939, -0.005561082158237696, -0.01921038329601288, 0.011942707933485508, -0.04644693061709404, -0.02200988680124283, 0.022299490869045258, -0.05703815445303917, 0.029263772070407867, -0.047688089311122894, -0.057203639298677444, -0.057589780539274216, -0.03524891659617424, -0.010087864473462105, 0.026340153068304062, 0.03213222697377205, -0.010522270575165749, 0.01823124662041664, 0.016245393082499504, -0.013990620151162148, 0.008412299677729607, 0.026409106329083443, 0.04705371707677841, -0.006440236233174801, -0.037234771996736526, -0.043275076895952225, -0.02907070331275463, 0.033400967717170715, 0.03083590604364872, 0.002489213366061449, -0.0685119777917862, -0.0014342282665893435, -0.024864552542567253, -0.022451188415288925, 0.00923973973840475, 0.04584014043211937, 0.009267320856451988, -0.004361295141279697, 0.06106502562761307, 0.03991016000509262, -0.0023737165611237288, -0.01834157295525074, 0.004054452758282423, -0.03480761498212814, 0.017679620534181595, 0.012956321239471436, 0.0007946865516714752, -0.019762009382247925, -0.0075572794303298, 0.009198367595672607, -0.013887190259993076, 0.023182092234492302, 0.04771566763520241, -0.01639709062874317, -0.023126929998397827, 0.021168656647205353, -0.027622682973742485, 0.04504028335213661, 0.017679620534181595, -0.028960376977920532, 0.003380434587597847, 0.06812583655118942, -0.020396379753947258, -0.023637184873223305, -0.029787816107273102, -0.001727279624901712, -0.008605369366705418, 0.028119146823883057, 0.014549141749739647, 0.05990660935640335, 0.015376580879092216, 0.017776155844330788, 0.0027512358501553535, -0.009701726026833057, -0.013108018785715103, 0.021347936242818832, -0.0036786573473364115, -0.007019443903118372, -0.03309757262468338, 0.010908409021794796, 0.0069780717603862286, -0.013887190259993076, -0.04581255838274956, 0.017114203423261642, 0.02189956232905388, 0.0033597485162317753, -0.011260070838034153, 0.00044862728100270033, 0.042226988822221756, 0.038779325783252716, -0.005095647182315588, -3.989055039710365e-05, -0.03356645628809929, -0.009812051430344582, 0.03640733286738396, 0.04010322690010071, 0.05797591805458069, 0.040544528514146805, 0.02118244767189026, 0.008860496804118156, 0.04694339260458946, -0.041482292115688324, 0.022134002298116684, -0.02100316807627678, -0.0008834638865664601, -0.02915344573557377, 0.008246812038123608, 0.0034424925688654184, 0.008205439895391464, 0.055548761039972305, -0.010129236616194248, -0.005636930465698242, -0.05742429196834564, -0.050915103405714035, -0.05968596041202545, 0.013735493645071983, 0.023347580805420876, -0.058748193085193634, 0.030063629150390625, -0.04799148440361023, -0.02024468220770359, 0.013790655881166458, 0.012604659423232079, -0.020520495250821114, 0.0002824929542839527, -0.025250690057873726, 0.02480939030647278, 0.04415768012404442, 0.02376130037009716, -0.04801906272768974, -0.014962861314415932, 0.0005274926079437137, -0.031111719086766243, 0.01733485423028469, -0.011935812421143055, -0.0033614723943173885, -0.019431034103035927, -0.0028701801784336567, -0.012252997606992722, -0.022768372669816017, 0.05378355830907822, -0.016645321622490883, 0.030560093000531197, 0.018534641712903976, -0.00684706075116992, -0.04393703117966652, 0.08831536024808884, -0.009618982672691345, 0.0786067396402359, -0.007791720796376467, 0.023457905277609825, 0.009398331865668297, -0.03764849156141281, -0.034586966037750244, 0.014466398395597935, 0.021844398230314255, 0.007991685532033443, -0.007240094244480133, 0.04214424267411232, 0.0019082820508629084, 0.0260919202119112, -0.018548432737588882, -0.005857581272721291, -0.0244094617664814, 0.013183866627514362, 0.00259781489148736, 0.020148148760199547, -0.01290115900337696, -0.012321950867772102, -0.02929135225713253, 0.03334580734372139, -0.03944127634167671, 0.019444825127720833, -0.023678556084632874, 0.02725033648312092, 0.03640733286738396, -0.015666184946894646, 0.012459857389330864, -0.0021289323922246695, 0.01337004080414772, 0.008108905516564846, -0.014493979513645172, 0.06669161468744278, -0.015707556158304214, -0.004678479861468077, -0.020754937082529068, -0.033152736723423004, -0.03251836821436882, -0.0078055113554000854, -0.019431034103035927, 0.00967414490878582, -0.03072558157145977, -0.021637538447976112, -0.007398686837404966, -0.0013747559860348701, -0.017210738733410835, 0.043054427951574326, 0.02584368921816349, -0.019017314538359642, 0.013342459686100483, -0.012535706162452698, 0.015514488331973553, -0.0037820874713361263, 0.04586772248148918, 0.00530250696465373, 0.05028073117136955, -0.010935990139842033, 0.01161173265427351, -0.002258219989016652, 0.0396343432366848, 0.006609171628952026, -0.038862068206071854, -0.018962152302265167, 0.001223058789037168, 0.029098283499479294, -0.009749993681907654, -0.00279605551622808, -0.08092357218265533, -0.0198171716183424, 0.0006378178368322551, 0.0071090832352638245, -0.026478059589862823, 0.009625878185033798, 0.002990848384797573, -0.05742429196834564, -0.014038887806236744, -0.013983724638819695, -0.018176084384322166, -0.04228214919567108, 0.01974821835756302, -0.0004066088586114347, 0.03930336982011795, 0.010039597749710083, 0.034724872559309006, -0.01970684714615345, -0.01812092214822769, 0.018189875409007072, -0.026188455522060394, -0.014176794327795506, 0.02702968567609787, 0.06625030934810638, -0.04443349316716194, 0.01154277939349413, -0.019679265096783638, -0.016093695536255836, -0.014714629389345646, 0.026974523440003395, 0.00633680634200573, 0.025760944932699203, 0.005564529448747635, 0.011997871100902557, -0.023430325090885162, -0.008908763527870178, -0.0006731564062647521, -0.026615966111421585, -0.02674008160829544, 0.011232488788664341, -0.02645047754049301, 0.0057955230586230755, -0.007660709321498871, -0.00848814845085144, -0.02257530391216278, 0.03265627473592758, -0.006564352195709944, 0.009881004691123962, -0.013245925307273865, -0.003999290056526661, 0.025898851454257965, 0.0020237788558006287, 0.012983902357518673, -0.061395999044179916, -0.026036757975816727, -0.010991152375936508, -0.0034649022854864597, -0.03284934163093567, 0.009225948713719845, -0.018010595813393593, 0.004154434893280268, -0.027705427259206772, 0.005674854852259159, 0.051852867007255554, -0.0159006267786026, -0.006012726109474897, -0.04790873825550079, -0.04561949148774147, -0.007736558094620705, 0.01845189742743969, -0.03632458671927452, -0.026547012850642204, 0.02409227564930916, 0.002251324476674199, -0.020437752828001976, -0.01870013028383255, -0.01726590096950531, -0.009094937704503536, -0.005647273734211922, -0.04247521981596947, 0.008446776308119297, 0.0013239029794931412, -0.0169073436409235, 0.002711587818339467, -0.0031184121035039425, 0.0013256267411634326, -0.018782872706651688, -0.03238046169281006, -0.00815027765929699, -0.04203391820192337, -0.007302152458578348, 0.03836560621857643, -0.007495221681892872, 0.010184399783611298, -0.03535924106836319, 0.008343346416950226, 0.017390016466379166, -0.0032046036794781685, 0.0255265049636364, -0.006205795332789421, -0.01286668237298727, -0.017169367522001266, -0.011377290822565556, -0.031387533992528915, 0.006019621156156063, 0.05006008222699165, 0.021706491708755493, 0.011735848151147366, -0.007577965501695871, -0.021416889503598213, -0.02951200306415558, 0.008839810267090797, -0.03770365193486214, -0.01101873442530632, -0.0010480898199602962, 0.0008709661196917295, -0.01118422206491232, -0.0005430071032606065, -0.012287474237382412, -0.012446067295968533, 0.012728775851428509, -0.006709154229611158, 0.0009334550122730434, -0.017169367522001266, -0.044488657265901566, 0.03428357094526291, 0.019803382456302643, 0.012639136053621769, 0.003947575110942125, 0.0032925191335380077, -0.02617466449737549, -0.005764494184404612, -0.011391081847250462, -0.060899537056684494, 0.015431744046509266, -0.012521915137767792, -0.0004770705127157271, 0.0006360940169543028, 0.018906990066170692, 0.0358281247317791, 0.02373371832072735, 0.02236844412982464, -0.0027495119720697403, 0.01033609639853239, 0.019320709630846977, 0.03373194485902786, -0.000610236544162035, -0.004812939092516899, -0.052459653466939926, 0.023430325090885162, -0.02340274304151535, 0.0118116969242692, 0.012308160774409771, -0.03279418125748634, 0.05287337303161621, -0.06051339954137802, -0.015707556158304214, 0.01596958003938198, 0.00255816662684083, 0.007012548390775919, -0.009315588511526585, 0.018258828669786453, -0.007371105719357729, -0.012583973817527294, -0.005695540923625231, -0.0018858722178265452, -0.03301483020186424, -0.014094050042331219, 0.0033597485162317753, 0.008481252938508987, 0.04200633615255356, -0.01636950857937336, -0.10729130357503891, 0.0009041498997248709, 0.023857833817601204, -0.040682435035705566, 0.008832914754748344, -0.022230537608265877, -0.001841052551753819, -0.02228569984436035, 0.017321063205599785, 0.05392146483063698, -0.0503910556435585, -0.02232707105576992, -0.0029391334392130375, -0.0013109742430970073, 0.001595406560227275, -0.028960376977920532, 0.009481076151132584, 0.03229771554470062, 0.023788880556821823, -0.008495043963193893, -0.03640733286738396, -0.06779486685991287, -0.01191512681543827, -0.023416534066200256, 0.007812406402081251, 0.019334498792886734, -0.008763961493968964, -0.018217455595731735, -0.0011179050197824836, -0.009294901974499226, 0.023554440587759018, 0.0035545416176319122, 0.02940167859196663, 0.032104648649692535, -0.0452333502471447, -0.002234086161479354, -0.00114203873090446, -0.04945329204201698, -0.010915304534137249, -0.022658048197627068, -0.013432098552584648, -0.030091211199760437, -0.00338388211093843, -0.00845367182046175, 0.04592288285493851, -0.007853778079152107, -0.00025641999673098326, 0.0004490582214202732, 0.016066113486886024, -0.0018203665968030691, -0.012694299221038818, -0.029732653871178627, 0.013025274500250816, -0.006940147373825312, -0.0056231399066746235, -0.030449768528342247, -0.009039774537086487, 0.038144953548908234, 0.0013618272496387362, 0.00979826133698225, -0.001643673749640584, 0.014687048271298409, 0.020741146057844162, -0.013735493645071983, 0.028987959027290344, 0.02064461261034012, -0.01892077922821045, -0.012997693382203579, -0.018658757209777832, -0.02264425717294216, 0.03748300299048424, -0.006688468158245087, -0.029925722628831863, 0.021306563168764114, 0.01349415723234415, 0.029567167162895203, -0.020589448511600494, -0.0069987578317523, 0.01349415723234415, 0.006236824207007885, 0.019072476774454117, -0.028160519897937775, 0.006267853081226349, 0.023306207731366158, -0.009094937704503536, -0.03535924106836319, -0.027305498719215393, -0.04655725508928299, -0.020382588729262352, 0.008584683761000633, -0.04021355137228966, -0.03188399598002434, 0.005081856623291969, 0.015624812804162502, -0.009598296135663986, 0.004140644334256649, 0.03822769969701767, -0.002434050664305687, -0.08941861242055893, -0.022175375372171402, 0.019913706928491592, -0.007302152458578348, 0.0073297335766255856, -0.024781808257102966, 0.011397977359592915, 0.022961441427469254, 0.0064919511787593365, -0.020148148760199547, 0.02445083297789097, 0.010777398012578487, 0.014466398395597935, 0.01423195656388998, 0.027650265023112297, -0.04741227626800537, 0.012825310230255127, -0.03306999430060387, 0.03047734871506691, 0.0033614723943173885, -0.015252465382218361, -0.004302684683352709, 0.0017160747665911913, 0.017720993608236313, -0.020685983821749687, -0.003795878030359745, 0.008950135670602322, -0.009929272346198559, 0.009425912983715534, 0.011666894890367985, -0.02835358865559101, -0.0279950313270092, 0.0010489517590031028, 0.038641419261693954, -0.031028976663947105, 0.01267361268401146, -0.016093695536255836, -0.012335741892457008, 0.0053473268635571, -0.00456815492361784, -0.03571780025959015, -0.06691226363182068, 0.017969224601984024, -0.018975943326950073, 0.027015894651412964, 0.030670419335365295, 0.015307627618312836, -0.03574537858366966, 0.021485842764377594, 0.011887545697391033, 0.03083590604364872, -0.012818414717912674, -0.01988612674176693, 0.014031992293894291, 0.003051182720810175, -0.018672548234462738, -0.002744340570643544, -0.006912566255778074, 0.02964990958571434, 0.03657281771302223, -0.0022530483547598124, 0.022878699004650116, 0.03011879324913025, -0.004950845614075661, -0.009770679287612438, -0.019155221059918404, 0.002699520904570818, 0.01966547593474388, -0.0040579005144536495, -0.04989459365606308, -0.026367733255028725, 0.042806196957826614, 0.014507769607007504, -0.00874327588826418, -0.00901219341903925, -0.01035678293555975, 0.025292063131928444, 0.036021191626787186, -0.02595401369035244, 0.0004542297392617911, 0.044461075216531754, -0.024106066673994064, -0.010225770995020866, -0.00759175606071949, 0.004061348270624876, 0.028491495177149773, 0.009570715017616749, 0.0001978097134269774, 0.001279083313420415, 0.050418637692928314, 0.03323547914624214, -0.010349887423217297, 0.005995487794280052, -0.02365097403526306, 0.03668314591050148, 0.004678479861468077, 0.007412477396428585, 0.03295966610312462, 0.034724872559309006, -0.0013988896971568465, 0.05974112078547478, 0.047936320304870605, -0.04037903994321823, -0.019541358575224876, -0.024864552542567253, -4.239549161866307e-05, 0.011735848151147366, 0.00452333502471447, 0.007012548390775919, -0.005309402476996183, 0.014135422185063362, 0.0053714606910943985, 0.002263391390442848, 0.013073542155325413, -0.00024478413979522884, 0.00910183321684599, 0.02555408515036106, 0.0298981424421072, -0.0024961086455732584, -0.0005809313734062016, -0.0008097700774669647, -0.010377468541264534, -0.017114203423261642, -0.0014135421952232718, -0.041427131742239, -0.030642837285995483, 0.030422186478972435, 0.022837325930595398, -0.042447637766599655, -0.015348999761044979, -0.00267366343177855, 0.009419018402695656, 0.0014385378453880548, 0.0005205972702242434, 0.004119958262890577, 0.01827261969447136, -0.008177858777344227, 0.045647069811820984, -0.04570223391056061, 0.042116664350032806, -0.0103016197681427, -0.018865616992115974, 0.004595736041665077, -0.00014835728507023305, 0.014645676128566265, -0.0073228380642831326, -0.022602884098887444, -0.035386823117733, -0.00645402679219842, 0.003497655037790537, 0.03083590604364872, 0.0023461354430764914, -0.0302291177213192, 0.011956498958170414, 0.007219408173114061, 0.02340274304151535, -0.022630466148257256, -0.023540649563074112, -0.011784115806221962, 0.04275103285908699, 0.02409227564930916, 0.05190802738070488, 0.004388876259326935, -0.038282860070466995, 0.006722944788634777, -0.0544179268181324, -0.03966192528605461, -0.01780373603105545, -0.03847593069076538, 0.0076331282034516335, -0.019899915903806686, -0.02125140093266964, 0.03808979317545891, 0.04167536273598671, 0.024781808257102966, 0.024533577263355255, 0.010618804953992367, 0.010784292593598366, 0.027305498719215393, 0.02588506042957306, 0.020548077300190926, 0.013707911595702171, -0.0029649909120053053, -0.005147362127900124, 0.02096179686486721, 0.022740792483091354, -0.016493624076247215, 0.008136486634612083, -8.748446998652071e-05, 0.0242991354316473, -0.00048655158025212586, 0.014576722867786884, -0.0001609628088772297, 0.03599361330270767, -0.0006412654765881598, -0.018465688452124596, -0.00511633325368166, 0.020948005840182304, -0.009501761756837368, -0.019017314538359642, 0.0026322915218770504, 0.004978426732122898, -0.004133749287575483, -0.016286764293909073, -0.05634862184524536, 0.031497858464717865, 0.017569296061992645, -0.020810099318623543, -0.015431744046509266, 0.031580600887537, -0.007357314694672823, 0.0003258042561355978, 0.0003671762242447585, 0.05836205556988716, 0.004902577959001064, 0.005247344728559256, 0.03298724815249443, 0.004561259411275387, -0.03831044211983681, -0.00972930807620287, -0.036048773676157, -0.03428357094526291, -0.011859963648021221, -0.01639709062874317, -0.018369153141975403, 0.008605369366705418, 0.0009334550122730434, 0.009522448293864727, -0.013170076534152031, 0.009915481321513653, -0.02595401369035244, 0.014369863085448742, -0.005640378221869469, -0.009315588511526585, 0.01023266650736332, -0.01636950857937336, 0.018300199881196022, -0.005130123812705278, 0.0045819454826414585, 0.004812939092516899, 0.026188455522060394, -0.0078055113554000854, 0.004006185568869114, -0.011508302763104439, 0.004692270886152983, 0.0008894972852431238, -0.005488681141287088, 0.014549141749739647, -0.014300909824669361, -0.009681040421128273, -0.013004588894546032, 0.0025460999459028244, 0.0180243868380785, -0.001390270539559424, -0.0008955307421274483, -0.009625878185033798, 0.01614885777235031, 0.0342559888958931, 0.010260247625410557, 0.04572981595993042, -0.014204375445842743, 0.026974523440003395, 0.014480188488960266, -0.0188104547560215, 0.01567997597157955, -0.023844044655561447, -0.0025460999459028244, -0.013618272729218006, -0.0127632524818182, 0.006971176713705063, -0.04606078937649727, 0.018369153141975403, -0.002418536227196455, 0.009970644488930702, -0.005702436435967684, -0.019541358575224876, -0.014687048271298409, -0.0038993079215288162, 0.014149213209748268, -0.0024754228070378304, -0.013832028023898602, -0.0298981424421072, -0.009322483092546463, -0.025498922914266586, 0.02243739739060402, -0.011784115806221962, -0.05243207514286041, -0.02002403326332569, 0.05108058825135231, -0.020258473232388496, -0.006895327940583229, 0.01607990451157093, -0.020079195499420166, 0.005030141677707434, -0.01988612674176693, 0.004874996840953827, -0.00014016908244229853, 0.006109260488301516, 0.0217202827334404, -0.02398195117712021, 0.011225594207644463, 0.01182548701763153, 0.017293483018875122, -0.005516262259334326, 0.01042573619633913, 0.010880827903747559, 0.00920526310801506, -0.058527544140815735, -0.014852536842226982, 0.0017858899664133787, -0.017500342801213264, 0.01921038329601288, 0.012363323010504246, 0.016245393082499504, 0.019251756370067596, 0.00578862801194191, 0.014962861314415932, -0.03353887423872948, 0.01274256594479084, 0.0040510050021111965, 0.0014824954560026526, 0.023526858538389206, 0.031497858464717865, 0.009225948713719845, -0.01791406236588955, -0.021265191957354546, 0.004133749287575483, -0.03524891659617424, 0.026657337322831154, 0.03654523938894272, -0.006909118499606848, 0.008446776308119297, -0.020630821585655212, 0.04181326925754547, -0.026147084310650826, 0.028091566637158394, -0.00696428120136261, 0.004878444597125053, 0.011584150604903698, -0.012783938087522984, 0.024740437045693398, 0.0079503133893013, 0.010122341103851795, -0.0022047811653465033, -0.009356959722936153, -0.004140644334256649, -0.002494385000318289, 0.004657794255763292, 0.009632772766053677, -0.002711587818339467, 0.06950490921735764, -0.015735138207674026, 0.011708267033100128, -0.01286668237298727, -0.01548690628260374, 0.04504028335213661, -0.030284279957413673, 0.008343346416950226, -0.026836616918444633, -0.0099085858091712, 6.582883361261338e-05, 0.027222754433751106, -0.01966547593474388, -0.016948716714978218, 0.044957537204027176, -0.011480720713734627, -0.05610038712620735, -0.0008304560324177146, -0.014369863085448742, 0.03855867311358452, 0.027112429961562157, 0.03916546329855919, -0.0019858544692397118, -0.03676588833332062, 0.0016548787243664265, 0.016934925690293312, 0.009460389614105225, 0.007391791790723801, 0.021940933540463448, 0.04835003986954689, -0.01039125956594944, -0.040903083980083466, -0.04415768012404442, 0.01632813736796379, 0.0014100945554673672, 0.032545946538448334, -0.05466616153717041, 0.023554440587759018, -0.024643901735544205, 0.010922199115157127, -0.0004895682795904577, -0.01326661091297865, -0.009253529831767082, 0.00908114667981863, -0.02272700145840645, 0.004702613689005375, -0.017817527055740356, 0.0005731741548515856, -0.009315588511526585, -0.0074538495391607285, -0.0012997692683711648, -0.00015320556121878326, 0.006826374679803848, -0.012432276271283627, -0.005461099557578564, -0.016948716714978218, 0.0054507567547261715, 0.05165979638695717, 0.016603950411081314, 0.013218343257904053, -0.014783583581447601, 0.020217102020978928, -0.0014928384916856885, 0.010549851693212986, -0.014300909824669361, -0.03679347038269043, -0.026836616918444633, -0.01823124662041664, 0.017293483018875122, 0.018713919445872307, -0.01035678293555975, 0.00987410917878151, 0.0209342148154974, -0.006888432428240776, 0.016452252864837646, 0.005992040038108826, -0.027898496016860008, 0.01548690628260374, 0.013294192031025887, 0.03480761498212814, -0.038531091064214706, -0.005133571568876505, -0.01984475366771221, 0.026147084310650826, 0.029842980206012726, -0.001846224069595337, 0.03502826765179634, -0.018107131123542786, -0.024175019934773445, 0.014935280196368694, -0.007653813809156418, 0.0056162443943321705, 0.03831044211983681, 0.020658401772379875, 0.00979826133698225, -0.02085147239267826, -0.02268562838435173, -0.012887367978692055, 0.03693137690424919, 0.0003544629435054958, -0.003999290056526661, 0.005643825978040695, -0.026119502261281013, -0.004106167703866959, 0.008619160391390324, 0.027415823191404343, -0.02376130037009716, -0.0085088349878788, 0.018962152302265167, 0.005781732499599457, -0.007729662582278252, -0.01751413382589817, 0.017031459137797356, 0.012949425727128983, -0.005767941940575838, 0.01279772911220789, 0.017748573794960976, 0.016493624076247215, -0.004213045351207256, -0.05334225669503212, 0.03535924106836319, 0.014149213209748268, 0.014411235228180885, -0.013556214980781078, -0.005926534533500671, -0.01082566473633051, 0.015983371064066887, -0.01092909462749958, -0.020617030560970306, -0.011135954409837723, -0.0027408928144723177, -0.006853955797851086, 0.003270109184086323, -0.01118422206491232, 0.013466575182974339, 0.028877632692456245, 0.03072558157145977, -0.009570715017616749, -0.02358202077448368, 0.0016902172937989235, 0.022533930838108063, 0.03751058503985405, 0.0011351433349773288, 0.02691936120390892, 0.02835358865559101, -0.012521915137767792, 0.012073718942701817, -0.011942707933485508, 0.010398154146969318, -0.009343169629573822, -0.016590159386396408, -0.014259538613259792, -0.02573336474597454, 0.014659467153251171, 0.00259781489148736, -0.026905570179224014, 0.008295079693198204, -0.024919714778661728, 0.025788526982069016, -0.03500068560242653, 0.005792075302451849, 0.00028637159266509116, -0.020368799567222595, 0.003251147223636508, 0.03417324647307396, -0.04390944913029671, -0.032463204115629196, -0.00617476599290967, 0.022851116955280304, 0.002003092784434557, 0.0014100945554673672, 0.036517657339572906, 0.0024599081370979548, -0.0056300354190170765, 0.0010437802411615849, -0.014769792556762695, -0.012914949096739292, -0.0022013334091752768, 0.0034373209346085787, 0.0071090832352638245, -0.019072476774454117, -0.002175475936383009, 0.012252997606992722, -0.00531285023316741, -0.021803027018904686, 0.026409106329083443, -0.012852891348302364, 0.014604304917156696, -0.018286408856511116, -0.021775444969534874, -0.00983273796737194, 0.0009618982439860702, 0.034835197031497955, 0.008108905516564846, -0.0003152457647956908, 0.024671483784914017, -0.023885415866971016, 0.04716404154896736, 0.006550561636686325, 0.016934925690293312, 0.008915659040212631, -0.018644966185092926, -0.001557482173666358, -0.03933095186948776, -0.0106946537271142, 0.003358024638146162, 0.009225948713719845, 0.0236233938485384, 0.017969224601984024, -0.021734073758125305, -0.014114736579358578, -0.03119446337223053, 0.01686597242951393, 0.004985322244465351, 0.001149795949459076, -0.008143382146954536, -0.004006185568869114, 0.020299846306443214, -0.06415413320064545, -0.023030394688248634, -0.0071642459370195866, 0.011418662965297699, 0.018548432737588882, 0.007522802799940109, -0.009846528060734272, 0.020272264257073402, 0.012604659423232079, -0.008832914754748344, 0.019017314538359642, 0.019899915903806686, -0.0033993967808783054, 0.007350419647991657, 0.0141630033031106, -0.013501051813364029, -0.015252465382218361, -0.010287829674780369, 0.01112905889749527, 0.0012471925001591444, 0.008370928466320038, 0.012790833599865437, -0.025402387604117393, 0.008350241929292679, 0.0038406976964324713, 0.01927933655679226, -0.034586966037750244, 0.059575632214546204, 0.026078131049871445, 0.03491793945431709, -0.0418684296309948, 0.049701523035764694, -0.03500068560242653, 0.03522133454680443, -0.0023685451596975327, -0.011694476008415222, -0.013804446905851364, -0.03811737149953842, 0.00010542310337768868, -0.01267361268401146, 0.02056186832487583, -0.000693842361215502, -0.011377290822565556, -0.014369863085448742, 0.018782872706651688, 0.002116865711286664, -0.0483776219189167, 0.054583415389060974, -0.009515552781522274, 0.027222754433751106, 0.0052714780904352665, -0.02570578269660473, 0.006616067141294479, 0.00801926665008068, -0.022134002298116684, 0.015100767835974693, 0.0006011864170432091, 0.04057211056351662, -0.0036372854374349117, 0.0006132532143965364, 0.025181736797094345, -0.020010242238640785, 0.030311862006783485, -0.008888077922165394, -0.012225416488945484, -0.013039065524935722, 0.017390016466379166, 0.0194861963391304, -0.0057955230586230755, -0.023030394688248634, -0.005119781009852886, 0.018755292519927025, -0.007260780315846205, 0.031028976663947105, 0.02192714251577854, -0.043026845902204514, -0.010018911212682724, -0.01214956771582365, -0.01898973248898983, -0.014004411175847054, 0.002499556401744485, 0.029456840828061104, -0.0199274979531765, -0.020148148760199547, -0.0022823535837233067, 0.01780373603105545, 0.017210738733410835, 0.050915103405714035, -0.01755550503730774, 0.043164752423763275, -0.004785357508808374, 0.013735493645071983, -0.0026788348332047462, 0.026119502261281013, 0.004337161313742399, 0.006940147373825312, -0.005764494184404612, 0.024202601984143257, 0.006698810961097479, 0.034586966037750244, -0.002590919379144907, 0.05110817030072212, 0.022533930838108063, -0.002770198043435812, 0.003988947253674269, 0.016631530597805977, 0.007867569103837013, -0.002585747977718711, -0.013707911595702171, 0.04192359372973442, 0.05165979638695717, 0.00996374897658825, 0.03527649864554405, -0.00014113874931354076, 0.02185818925499916, 0.00022733033983968198, -0.008136486634612083, -0.0013842370826750994, 0.010908409021794796, 0.025747153908014297, 0.04021355137228966, -0.0244094617664814, -0.03944127634167671, -0.0008593302336521447, 0.0007472811848856509, -0.030642837285995483, -0.005440413951873779, 0.004626764915883541, 0.007384896278381348, 0.006760869175195694, -0.0141630033031106, 0.015128349885344505, 0.04592288285493851, 0.017638249322772026, 0.021113494411110878, -0.014976652339100838, 0.01856222376227379, 0.047081299126148224, 0.035386823117733, -0.023788880556821823, -0.02476801723241806, -0.008226126432418823, -0.028381170704960823, -0.009294901974499226, 0.01809334009885788, -0.014342281967401505, 0.019155221059918404, 0.02154100500047207, 0.01798301562666893, -0.02228569984436035, -0.042199406772851944, -0.019513778388500214, -0.023499278351664543, 0.02752614952623844, -0.004226835910230875, 0.030780743807554245, -0.024147437885403633, -0.010487793944776058, -0.016341926530003548, -0.012914949096739292, 0.0030098105780780315, -0.0007412477280013263, 0.02727791666984558, -0.02577473595738411, 0.0151145588606596, -0.010798083618283272, -0.015431744046509266, 0.030146373435854912, -0.013742388226091862, -0.0013333840761333704, 0.002456460613757372]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
"Petrov, S. Natural questions: a benchmark for question
answering research. Trans. Assoc. Comput. Linguistics ,
7:452–466, 2019.
Langedijk, A., Mohebbi, H., Sarti, G., Zuidema, W. H.,
and Jumelet, J. Decoderlens: Layerwise interpretation of
encoder-decoder transformers. ArXiv , abs/2310.03686,
2023.
Laskaridis, S., Kouris, A., and Lane, N. D. Adaptive infer-
ence through early-exit networks: Design, challenges and
directions. In International Workshop on Embedded and
Mobile Deep Learning , 2021.
Lee, C.-Y ., Xie, S., Gallagher, P. W., Zhang, Z., and Tu, Z.
Deeply-supervised nets. In AISTATS , 2014.
Leviathan, Y ., Kalman, M., and Matias, Y . Fast inference
from transformers via speculative decoding. In ICML ,
2022.Li, S. and Hoefler, T. Chimera: efficiently training large-
scale neural networks with bidirectional pipelines. In SC,
pp. 27, 2021.
Li, X., Shao, Y ., Sun, T., Yan, H., Qiu, X., and Huang,
X. Accelerating bert inference for sequence labeling via
early-exit. In ACL, 2021.
Liang, P., Bommasani, R., Lee, T., Tsipras, D., Soylu, D.,
Yasunaga, M., Zhang, Y ., Narayanan, D., Wu, Y ., Kumar,
A., Newman, B., Yuan, B., Yan, B., Zhang, C., Cosgrove,
C., Manning, C. D., R’e, C., Acosta-Navas, D., Hudson,
D. A., Zelikman, E., Durmus, E., Ladhak, F., Rong, F.,
Ren, H., Yao, H., Wang, J., Santhanam, K., Orr, L. J.,
Zheng, L., Yuksekgonul, M., Suzgun, M., Kim, N. S.,
Guha, N., Chatterji, N. S., Khattab, O., Henderson, P.,
Huang, Q., Chi, R., Xie, S. M., Santurkar, S., Ganguli,
S., Hashimoto, T., Icard, T. F., Zhang, T., Chaudhary, V .,
Wang, W., Li, X., Mai, Y ., Zhang, Y ., and Koreeda, Y .
Holistic evaluation of language models. Annals of the
New York Academy of Sciences , 1525:140 – 146, 2023.
Lin, S., Hilton, J., and Evans, O. Truthfulqa: Measuring how
models mimic human falsehoods. In ACL, pp. 3214–3252,
2022.
Liu, D., Kan, M., Shan, S., and Chen, X. A simple ro-
mance between multi-exit vision transformer and token
reduction. In ICLR , 2024.
Liu, W., Zhou, P., Wang, Z., Zhao, Z., Deng, H., and Ju, Q.
Fastbert: a self-distilling BERT with adaptive inference
time. In ACL, pp. 6035–6044, 2020.
Narayan, S., Cohen, S. B., and Lapata, M. Don’t give me
the details, just the summary! topic-aware convolutional
neural networks for extreme summarization. In EMNLP ,
pp. 1797–1807, 2018.
Narayanan, D., Harlap, A., Phanishayee, A., Seshadri, V .,
Devanur, N. R., Ganger, G. R., Gibbons, P. B., and Za-
haria, M. Pipedream: generalized pipeline parallelism for
DNN training. In SOSP , pp. 1–15, 2019.
Narayanan, D., Phanishayee, A., Shi, K., Chen, X., and
Zaharia, M. Memory-efficient pipeline-parallel DNN
training. In ICML , volume 139, pp. 7937–7947, 2021a.
Narayanan, D., Shoeybi, M., Casper, J., LeGresley, P., Pat-
wary","[-0.018634067848324776, 0.01941545493900776, 0.00878728087991476, 0.012435955926775932, 0.019335990771651268, 0.009694483131170273, -0.012601504102349281, 0.047730762511491776, -0.04661828279495239, 0.04513497278094292, 0.02689821831882, -0.029692666605114937, -0.013170989230275154, 0.00874754972755909, -0.012912734411656857, -0.016846152022480965, 0.03925471007823944, 0.01798512041568756, 0.02635522186756134, 0.05604788661003113, -0.013958997093141079, -0.02005115896463394, -0.0012374703073874116, 0.02320319041609764, 0.04343976080417633, 0.0070854490622878075, 0.017587805166840553, 0.02826233208179474, 0.03904281184077263, -0.02560032345354557, 0.01255515031516552, -0.03499019891023636, -0.04346625134348869, -0.01818377897143364, 0.008052248507738113, 0.07040420174598694, 0.0340101532638073, 0.006304062902927399, -0.020342523232102394, 0.03676487132906914, 0.0075357393361628056, -0.05615383759140968, -0.03875144571065903, 0.0418505035340786, -0.012866380624473095, 0.023031020537018776, 0.009780568070709705, 0.011502265930175781, 0.0033258567564189434, 0.06653700023889542, -0.03999636694788933, 0.010840075090527534, -0.026527391746640205, 0.018342703580856323, -0.05731929466128349, -0.0007064755773171782, -0.011581729166209698, 0.005873638670891523, 0.011972421780228615, -0.034831274300813675, -0.03292416036128998, -0.07888025045394897, -0.02855369634926319, 0.026712805032730103, -0.03541400283575058, -0.0016149195143952966, -0.04990275204181671, 0.019600868225097656, -0.004867107607424259, 0.019534649327397346, 0.0019534649327397346, 0.03128192573785782, 0.019945207983255386, -0.020978227257728577, 0.020885519683361053, 0.001946842996403575, 0.006747731473296881, 0.11177792400121689, -0.01598530262708664, -0.04534687474370003, 0.015190673060715199, -0.010833452455699444, 0.03485776111483574, -0.03896334767341614, -0.049161095172166824, -0.009317033924162388, -0.029904568567872047, -0.025573834776878357, -0.031387876719236374, -0.0019104224629700184, 0.002685186453163624, 0.006522586103528738, -0.03636755794286728, -0.014528481289744377, 0.0613454207777977, 0.03665892034769058, 0.027626629918813705, -0.008515782654285431, 0.04211537912487984, 0.03814223036170006, -0.01369411963969469, 0.003966527059674263, 0.018885701894760132, 0.0015462171286344528, 0.015058234333992004, -0.023905113339424133, -0.01866055652499199, 0.002749750157818198, -0.018024852499365807, -0.008138333447277546, -0.08661464601755142, -0.0358378030359745, -0.01064141746610403, -0.0023540908005088568, 0.013144501484930515, -0.06616617739200592, -0.04283054545521736, 0.00792643241584301, 0.004519456997513771, 0.03059324622154236, -0.008846878074109554, -0.016700468957424164, 0.027361752465367317, 0.029904568567872047, -0.01885921321809292, -0.023706454783678055, 0.020130621269345284, -0.033930692821741104, -0.0024666632525622845, -0.023163458332419395, 0.01235649362206459, 0.007668177597224712, 0.04990275204181671, -0.018276484683156013, -0.02435540221631527, -0.021931782364845276, -0.03504317253828049, -0.00936338771134615, -0.018210265785455704, -0.0007412406266666949, 0.014952284283936024, 0.00147917028516531, -0.03218250721693039, -0.002695119474083185, -0.03152031451463699, 0.04810158908367157, 0.0067046890035271645, -0.002655387856066227, 0.013045172207057476, 0.00494325952604413, 0.003910240717232227, -0.006625225767493248, -0.026262514293193817, -0.019402211531996727, -0.03536102548241615, -0.05716037005186081, -0.025308959186077118, 0.06139839440584183, 0.04129426181316376, -0.05965020880103111, 0.015932327136397362, 0.04071153327822685, -0.01406494714319706, 0.027282290160655975, -0.00250473921187222, 0.04137372598052025, -0.05210122838616371, 0.007416544947773218, -0.062404926866292953, -0.06839113682508469, -0.021243102848529816, -0.016846152022480965, -0.009548800997436047, -0.023507798090577126, 0.009217705577611923, -0.025785736739635468, -0.029798617586493492, -0.039625540375709534, 0.002367334673181176, -0.055835988372564316, -0.014303335919976234, 0.023242920637130737, -0.026103587821125984, -0.0015404229052364826, -0.0314408503472805, -0.03178519010543823, 0.004873729310929775, 0.055624086409807205, -0.003738071070984006, 0.04240674152970314, -0.022355584427714348, 0.04908163473010063, 0.03353337571024895, 0.01785268262028694, -0.01269421074539423, -0.033321477472782135, 0.05896152928471565, -0.031679242849349976, 0.026792267337441444, -0.052127715200185776, 0.025904931128025055, 0.024951376020908356, 0.010548710823059082, -0.046485841274261475, 0.02842125855386257, -0.004175117239356041, 0.007317216135561466, -0.0194949172437191, -0.02752067893743515, -0.03202357888221741, 0.05186283960938454, 0.04034070670604706, 0.040049340575933456, 0.010952646844089031, -0.02256748639047146, -0.03273874893784523, -0.05011465400457382, 0.01948167383670807, 0.023799162358045578, -0.011780386790633202, 0.012171079404652119, 0.01956113614141941, 0.025136789306998253, 0.007601958233863115, -0.03183816745877266, 0.04277757182717323, 0.0034169082064181566, -0.030487297102808952, 0.026447927579283714, 0.011780386790633202, 0.03732111304998398, 0.005913369823247194, -0.01975979469716549, -0.016647493466734886, -0.004251269157975912, -0.02113715186715126, 0.024275939911603928, -0.04232728108763695, -0.00368840666487813, -0.03800979256629944, -0.0009030636283569038, 0.04137372598052025, 0.003132165875285864, 0.018581094220280647, 0.0012300206581130624, 0.03967851400375366, -0.023931600153446198, -0.08359505236148834, 0.032897673547267914, 0.0032960581593215466, -0.011442668735980988, 0.005684914067387581, -0.005373683758080006, -0.021719880402088165, -0.02860667183995247, -0.02573276124894619, -0.019031383097171783, -0.03122895024716854, -0.032420895993709564, 0.010747367516160011, -0.005449836142361164, 0.032765235751867294, 0.019865745678544044, 0.001454338082112372, 0.01995845139026642, -0.018898945301771164, -0.04836646839976311, 0.04802212864160538, 0.018488386645913124, -0.01701832190155983, 0.023044263944029808, -0.01969357579946518, 0.004764467943459749, 0.008356857113540173, -0.0823766216635704, -0.01770700141787529, 0.021428516134619713, 0.02236882783472538, -0.0653715431690216, -0.010581820271909237, 0.014303335919976234, 0.000535961240530014, 0.054670531302690506, 0.011442668735980988, 0.0033970423974096775, 0.011482400819659233, -0.012906111776828766, -0.021640418097376823, -0.028394771739840508, -0.008370100520551205, 0.022329097613692284, -0.011336718685925007, -0.01138969324529171, -0.046909645199775696, 0.03628809377551079, 0.008913097903132439, 0.021441761404275894, 0.021084176376461983, 0.04296298325061798, -0.0428040586411953, 0.03032837063074112, -0.039493098855018616, 0.019640600308775902, 0.034751810133457184, 0.008641598746180534, 0.03329498693346977, -0.056100863963365555, -0.00662191491574049, 0.030275395140051842, -0.01444901805371046, -0.006509342230856419, -0.02860667183995247, -0.026540635153651237, 0.007125180680304766, -0.02786501869559288, -0.030725685879588127, 0.024898400530219078, -0.07448329776525497, 0.03059324622154236, -0.04105587303638458, -0.02993105538189411, -0.030169444158673286, -0.03059324622154236, 0.005876949522644281, -0.01550852507352829, 0.022196657955646515, -0.023918356746435165, 0.004827375989407301, -0.014329823665320873, 0.012389603070914745, -0.00037579366471618414, -0.00813171174377203, 0.026169808581471443, -0.021640418097376823, -0.07183453440666199, -0.03702974691987038, -0.023150214925408363, 0.027970967814326286, 0.03734759986400604, 0.023441579192876816, -0.08211174607276917, 0.010071932338178158, -0.043413273990154266, -0.02051469311118126, -0.013078281655907631, 0.04688315838575363, 0.007999273017048836, 0.035572927445173264, 0.035784829407930374, 0.023521041497588158, -0.0005405137781053782, -0.023441579192876816, 0.016276666894555092, -0.03536102548241615, 0.011979044415056705, 0.03986392915248871, -0.02443486638367176, -0.006194801535457373, -0.00960839819163084, 0.005165093578398228, -0.03888388350605965, -0.007972785271704197, 0.04373112693428993, 0.0026454550679773092, -0.03610267862677574, -0.0044366829097270966, 0.0034897492732852697, 0.025216251611709595, 0.007449654396623373, -0.013137878850102425, 0.00388706405647099, 0.04886973276734352, -0.03408961743116379, -0.01791890151798725, -0.03191763162612915, 0.01688588224351406, -0.03636755794286728, 0.03175870329141617, -0.019812770187854767, 0.043068934231996536, 0.003085812320932746, -0.005638560745865107, -0.0187267754226923, -0.018130803480744362, 0.0010090143186971545, 0.03403664380311966, -0.009396497160196304, -0.004903527908027172, -0.011197658255696297, 0.028977500274777412, -0.0021372230257838964, -0.0185413621366024, -0.05011465400457382, 0.02231585420668125, 0.017269954085350037, 0.013627900741994381, -0.01255515031516552, -0.01009179838001728, 0.028580185025930405, 0.03883090987801552, -0.0227926317602396, -0.0013260385021567345, -0.013435865752398968, -0.03800979256629944, 0.03424854576587677, 0.04343976080417633, 0.0579020231962204, 0.025507615879178047, 0.02093849517405033, 0.0012035330291837454, 0.030513783916831017, -0.04802212864160538, 0.0032728814985603094, -0.015058234333992004, -0.001337626832537353, -0.04028772935271263, 0.028659647330641747, 0.016568031162023544, 0.00240209954790771, 0.06934469193220139, 0.006721243727952242, -0.01142280362546444, -0.059597235172986984, -0.02881857380270958, -0.05379643663764, 0.022938312962651253, 0.02977212890982628, -0.043890051543712616, 0.04012880474328995, -0.04240674152970314, -0.021600686013698578, 0.008833634667098522, 0.014462262392044067, -0.015256891958415508, 0.007284106221050024, -0.04426087811589241, 0.04426087811589241, 0.037771403789520264, -0.007204643450677395, -0.033453915268182755, -0.010542088188230991, -0.04116182401776314, -0.025719517841935158, -0.004105587489902973, -0.028447747230529785, -0.024342158809304237, -0.01874001882970333, -0.015429061837494373, 0.0014303335919976234, -0.06219302490353584, 0.043201372027397156, -0.008985938504338264, 0.048154566437006, 0.012939222157001495, -0.022872094064950943, -0.02868613600730896, 0.08269447088241577, -0.007145046256482601, 0.05077684298157692, 0.008654843084514141, 0.026130076497793198, 0.006999364122748375, -0.014806602150201797, -0.025441396981477737, 0.02456730417907238, 0.01934923604130745, 0.00549287861213088, -0.016991833224892616, 0.03944012522697449, -0.016091253608465195, -0.014356311410665512, -0.032553333789110184, 0.010992378927767277, -0.0386984720826149, -0.0077476403675973415, -0.002378922887146473, 0.013415999710559845, -0.01605152152478695, -0.01585286483168602, -0.03350688889622688, 0.03234143182635307, -0.0198260135948658, -0.0006998536409810185, -4.899182385997847e-05, 0.0569484680891037, 0.024554060772061348, -0.012674345634877682, 0.0003329581522848457, -0.016700468957424164, -0.0024352092295885086, 0.004939948674291372, -0.02120337076485157, 0.052180688828229904, -0.014396043494343758, -0.008343612775206566, -0.002877222141250968, -0.010098420083522797, -0.022607218474149704, -0.014237117022275925, -0.02277938649058342, 0.013853046111762524, -0.02477920614182949, 0.0035990108735859394, 0.003844021586701274, -0.015005258843302727, -0.046697743237018585, 0.05037952959537506, 0.03212952986359596, -0.026037368923425674, 0.022540997713804245, -0.014184141531586647, -0.0015834653750061989, 0.011826739646494389, 0.02765311673283577, 0.004658516962081194, 0.033665817230939865, -0.015018503181636333, -0.0019733307417482138, -0.009250815026462078, 0.041214797645807266, 0.012786917388439178, -0.03088461048901081, 0.01983925700187683, -0.006029253359884024, 0.02313697151839733, 0.0006265987176448107, -0.014766870066523552, -0.05859070271253586, -0.008575379848480225, -0.012277030386030674, 0.012548528611660004, -0.021044446155428886, 0.008853500708937645, -0.007065583020448685, -0.06468286365270615, 0.007125180680304766, -0.005423348397016525, -0.00703247357159853, -0.04802212864160538, 0.013369645923376083, -0.015349598601460457, 0.02284560725092888, 0.01757456175982952, 0.02093849517405033, -0.01365438848733902, -0.03141436353325844, 0.018912188708782196, -0.031732216477394104, -0.01174065563827753, 0.028050431981682777, 0.029719153419137, -0.033109575510025024, 1.8287866623722948e-05, -0.0038738201837986708, 0.004833997692912817, -0.01125725544989109, 0.030964074656367302, -0.006913279183208942, 0.025163276121020317, -0.0056716701947152615, -0.006661646533757448, -0.02044847421348095, -0.008416454307734966, -0.014263604767620564, -0.01668722555041313, -0.02546788565814495, 0.015442305244505405, -0.040049340575933456, 0.022607218474149704, -0.007906566374003887, -0.02593141980469227, -0.02937481552362442, 0.01077385526150465, -0.031599778681993484, 0.024249453097581863, -0.02181258797645569, 0.00026942917611449957, 0.034142594784498215, -0.02271316759288311, -0.007952920161187649, -0.05072386935353279, -0.02402430772781372, -0.01900489628314972, 0.007343703880906105, -0.02100471407175064, 0.010787099599838257, 0.009588533081114292, -0.014223873615264893, -0.02112390846014023, -0.014833089895546436, 0.03922822326421738, -0.02942778915166855, -0.03032837063074112, -0.030487297102808952, -0.03247386962175369, -0.009171351790428162, 0.026024125516414642, -0.028659647330641747, -0.03700326010584831, 0.006727865431457758, 0.018024852499365807, -0.020143864676356316, -0.029401302337646484, -0.00823766179382801, -0.022819118574261665, -0.023441579192876816, -0.0374535508453846, 0.007522495463490486, -0.00799265131354332, -0.014104679226875305, 0.005638560745865107, -0.005304154008626938, 0.012084994465112686, -0.049372997134923935, -0.0019004895584657788, -0.015190673060715199, -0.05331965908408165, -0.005645182449370623, 0.026341978460550308, -0.011912824586033821, 0.00470155943185091, -0.03313606232404709, -0.0026702871546149254, 0.020474961027503014, 0.005549164488911629, -0.0016786553896963596, -0.0005864533595740795, -0.016846152022480965, -0.027759067714214325, -0.021945025771856308, -0.042645134031772614, 0.006482854951173067, 0.03408961743116379, 0.00348312733694911, -0.0032695704139769077, 0.004900217056274414, -0.02696443721652031, -0.002877222141250968, 0.009111754596233368, -0.01757456175982952, -0.003890375141054392, -0.002908676164224744, 4.337871723691933e-05, -0.0015826376620680094, 0.005896815098822117, -0.0031437540892511606, -0.019574381411075592, 0.012945843860507011, -0.013051793910562992, -0.012303518131375313, -0.05120064690709114, -0.04325434938073158, 0.029798617586493492, 0.003022904274985194, 0.027017412707209587, 0.006764286197721958, -0.026818756014108658, -0.022289365530014038, -0.004314177669584751, -0.004204915836453438, -0.044234391301870346, -0.00915810838341713, -0.015283379703760147, 0.01468740776181221, -0.02491164393723011, 0.0358378030359745, 0.044366829097270966, 0.03816871717572212, 0.023295896127820015, -0.015627719461917877, -0.01348884031176567, 0.013945752754807472, 0.0289510115981102, -0.008502538315951824, -0.0016645839205011725, -0.046353403478860855, 0.03769193962216377, -0.005549164488911629, 0.01852811872959137, 0.03329498693346977, -0.0348842479288578, 0.059120457619428635, -0.04696262255311012, -0.007039095740765333, 0.020700106397271156, -0.0065391408279538155, 0.0020577600225806236, -0.0021173572167754173, 0.01183336228132248, 0.011820117942988873, -0.010144773870706558, 0.004132074769586325, -0.0021123909391462803, -0.03382474184036255, 0.001337626832537353, 0.0070920707657933235, 0.007390057202428579, 0.056312765926122665, -0.012714076787233353, -0.07247024029493332, -0.0279974564909935, -0.005648493301123381, -0.049161095172166824, -0.010071932338178158, -0.03199709206819534, -0.02305750735104084, -0.016779933124780655, 0.02052793651819229, 0.05482945591211319, -0.05784904956817627, -0.033718790858983994, -0.007608580403029919, -0.020210083574056625, -0.01611774042248726, -0.04953192546963692, 0.004387018736451864, 0.01365438848733902, 0.02924237586557865, -0.001941876602359116, -0.029083451256155968, -0.04153265058994293, -0.0014982082648202777, -0.039016321301460266, 0.01358816958963871, 0.016846152022480965, -0.036817848682403564, -0.03665892034769058, 0.0012432645307853818, -0.007760884240269661, 0.01791890151798725, -0.01057519856840372, 0.006972876377403736, 0.004132074769586325, -0.03538751229643822, -0.014581456780433655, -0.004297622945159674, -0.04328083619475365, -0.012925977818667889, -0.007045717444270849, -0.03920173645019531, -0.03170572966337204, -0.015892595052719116, 0.013866289518773556, 0.0374535508453846, 0.015150940977036953, 0.0071913995780050755, 0.003410286270081997, 0.02140202932059765, 0.011363206431269646, -0.015733670443296432, -0.03189114108681679, 0.011455913074314594, -0.023309141397476196, -0.013786827214062214, -0.02558708004653454, -0.0345928817987442, 0.040049340575933456, -0.01756131835281849, 0.012886246666312218, 0.01207837276160717, 0.0257989801466465, 0.012647857889533043, -0.015561500564217567, 0.035440489649772644, 0.031175974756479263, -0.012978953309357166, 0.009866653010249138, 0.014740382321178913, -0.016091253608465195, 0.03922822326421738, -0.013250451534986496, -0.031175974756479263, 0.008634977042675018, 0.002092525130137801, 0.04158562421798706, -0.015005258843302727, -0.014872821047902107, 0.03247386962175369, -0.01032356545329094, 0.030248908326029778, -0.03718867525458336, 0.008343612775206566, 0.02881857380270958, -0.03369230404496193, -0.03175870329141617, -0.013561681844294071, -0.06738460808992386, 0.0016869328683242202, -0.007151667959988117, -0.03477829694747925, -0.04688315838575363, 0.007356947287917137, 0.0113234743475914, -0.01826324127614498, 0.011853227391839027, 0.03861900791525841, -0.006866925861686468, -0.09673293679952621, -0.02442162297666073, -0.0005177509738132358, -0.008827012963593006, 0.00792643241584301, -0.02607710100710392, 0.02100471407175064, 0.01070763636380434, -0.01936247944831848, -0.03726813569664955, 0.02148149162530899, 0.0165282990783453, -0.005446524824947119, -0.0015131075633689761, 0.025693029165267944, -0.05742524564266205, 0.029480764642357826, -0.02463352307677269, 0.054511602967977524, -0.017111027613282204, -0.020143864676356316, -0.0037016505375504494, 0.004092343617230654, 0.014104679226875305, -0.04534687474370003, 0.013707363978028297, -0.000568656949326396, 0.016303153708577156, 0.0005479634855873883, 0.005612073000520468, -0.01605152152478695, -0.029692666605114937, -0.014462262392044067, 0.028315307572484016, -0.02107093296945095, -0.004045989830046892, -0.008866744115948677, -0.012932599522173405, 0.003180174622684717, -0.0010156362550333142, -0.013356402516365051, -0.057743098586797714, 0.03326850011944771, -0.03218250721693039, 0.04129426181316376, 0.032156020402908325, 0.028924524784088135, -0.03848657011985779, 0.008144955150783062, -0.0011555241653695703, 0.015429061837494373, -0.00596965616568923, -0.03300362452864647, 0.021998001262545586, 0.002304426394402981, -0.00823766179382801, 0.014025215990841389, -0.005237934645265341, 0.02635522186756134, 0.031732216477394104, -0.018567848950624466, 0.04407546669244766, 0.0110122449696064, -0.0029964165296405554, -0.007039095740765333, -0.0076416898518800735, -0.0008666430949233472, -0.00799265131354332, 0.019455185160040855, -0.04412844032049179, -0.04343976080417633, 0.03920173645019531, 0.003930106293410063, -0.0005583101883530617, 0.0005160954897291958, 0.006459678057581186, 0.029692666605114937, 0.020607398822903633, -0.023163458332419395, 0.015031746588647366, 0.03655296936631203, -0.025918174535036087, -0.009356766007840633, 0.011621460318565369, -0.018210265785455704, 0.012224054895341396, 0.006777530070394278, -0.007330460008233786, -0.021521223708987236, 0.050353042781353, 0.03067271038889885, -0.024646766483783722, 0.006214667111635208, -0.013157744891941547, 0.012210811488330364, -0.0023888559080660343, 0.0020378942135721445, 0.0020378942135721445, 0.030142957344651222, 0.0053968606516718864, 0.023521041497588158, 0.03782437741756439, -0.07405949383974075, -0.006092161871492863, -0.0069794985465705395, 0.025653298944234848, 0.00858200155198574, 0.014713894575834274, -0.002125634578987956, 0.004661828279495239, 0.01885921321809292, 0.0077410186640918255, -0.007337081711739302, -0.028633160516619682, 0.012608125805854797, 0.023772675544023514, 0.020501447841525078, 0.019455185160040855, 0.011171170510351658, 0.007111936807632446, 0.0020097512751817703, 0.013892777264118195, -0.040870457887649536, 0.0049101500771939754, -0.027414727956056595, -0.01520391646772623, 0.02236882783472538, -0.004403573460876942, -0.0428040586411953, -0.026037368923425674, -0.01942869834601879, -0.005075697787106037, -0.026527391746640205, 0.004410195164382458, -0.005075697787106037, 0.026341978460550308, 0.003312612883746624, 0.04431385546922684, -0.035096149891614914, 0.05207473784685135, -0.014025215990841389, -0.0034235299099236727, 0.010270589962601662, -0.005873638670891523, -0.005115429405122995, -0.011316852644085884, -0.013005441054701805, -0.025679785758256912, -0.00576437683776021, -0.010906293988227844, 0.02778555452823639, 0.017031565308570862, -0.022739656269550323, 0.01674020104110241, 0.007111936807632446, 0.022938312962651253, -0.01119103655219078, -0.04947894811630249, -0.026659829542040825, 0.03906929865479469, 0.011032110080122948, 0.05927938222885132, -0.004145318642258644, -0.014369555748999119, 0.020845787599682808, -0.03438098356127739, -0.03856603428721428, -0.01328356098383665, -0.03607619181275368, 0.012005532160401344, -0.028368283063173294, -0.009118377231061459, 0.04192996397614479, 0.03205006942152977, 0.008350234478712082, 0.0144755057990551, 0.014939039945602417, 0.03236791864037514, 0.03162626549601555, 0.011972421780228615, 0.025706274434924126, -0.004731358028948307, -0.010542088188230991, -0.004820754285901785, 0.02141527272760868, 0.013892777264118195, -0.01668722555041313, 0.010032201185822487, 0.01324382983148098, 0.03273874893784523, -0.00017475646745879203, -0.0008583657327108085, -0.001794538926333189, 0.05906748026609421, -0.00981367751955986, -0.004373774863779545, 0.0019915408920496702, 0.0016852773260325193, -0.012515419162809849, -0.03300362452864647, -0.0015395951922982931, 0.020700106397271156, 0.01403845939785242, -0.022699924185872078, -0.06775543093681335, 0.013098147697746754, 0.012210811488330364, -0.022686680778861046, 0.012581638060510159, 0.03967851400375366, -0.0015329732559621334, -0.0028424570336937904, -0.007542361039668322, 0.03080514818429947, -0.007767506409436464, 0.012634613551199436, 0.05331965908408165, 0.013561681844294071, -0.032553333789110184, 0.02367996796965599, -0.03575833886861801, -0.03218250721693039, -0.007840347476303577, 7.558295328635722e-05, -0.017322929576039314, 0.0022067532408982515, 0.0209252517670393, 0.004387018736451864, -0.011316852644085884, 0.0024335538037121296, -0.02415674552321434, 0.019097601994872093, -0.019852500408887863, 0.010098420083522797, 0.023997819051146507, -0.006078917998820543, 0.011853227391839027, -0.014766870066523552, 0.019402211531996727, -0.010204371064901352, 0.034275032579898834, -0.003635431407019496, -0.01248893141746521, -0.009012426249682903, -0.0005897643277421594, 0.01791890151798725, -0.002198475645855069, 0.027229314669966698, -0.015482037328183651, -0.013747095130383968, -0.0018938676221296191, -0.0027944480534642935, 0.025772493332624435, 0.0033059909474104643, 0.027494190260767937, -0.01885921321809292, 0.02031603455543518, 0.04894919693470001, 0.0279974564909935, 0.049452461302280426, 0.00867470819503069, 0.02730877697467804, 0.0014982082648202777, -0.024236207827925682, 0.019680330529808998, -0.023070750758051872, 0.005496189463883638, -0.005476323422044516, 0.013455730862915516, 0.02277938649058342, -0.045320384204387665, 0.0077476403675973415, 0.0068801697343587875, 0.013217342086136341, -0.005261111538857222, -0.00601932080462575, -0.01111819501966238, 0.005092252511531115, 0.023706454783678055, -0.012826649472117424, -0.003332478692755103, -0.04373112693428993, -0.0070854490622878075, -0.014978772029280663, -0.0026471104938536882, 0.0006501892930828035, -0.039281200617551804, -0.0008674708660691977, 0.032076556235551834, -0.02146824821829796, -0.008628355339169502, 0.012780295684933662, -0.023083996027708054, -0.017243467271327972, -0.007562227081507444, 0.016289910301566124, 0.005118740256875753, 0.013906021602451801, 0.022050976753234863, -0.03549346327781677, 0.00947596039623022, 0.017786463722586632, -0.0008500883122906089, -0.019388966262340546, 0.0227926317602396, 0.005896815098822117, 0.018647313117980957, -0.04508199542760849, -0.006807328667491674, -0.008939584717154503, -0.023242920637130737, 0.0009576944285072386, 0.010376540943980217, -0.0018359259702265263, 0.01077385526150465, 0.016978589817881584, 0.008012517355382442, -0.03657945990562439, 0.0030378035735338926, 0.0014452328905463219, -0.0030907788313925266, 0.018991652876138687, 0.022011244669556618, 0.009383253753185272, -0.031732216477394104, -0.017468610778450966, 0.013157744891941547, -0.03130841255187988, 0.04582365229725838, 0.03385122865438461, -0.0194949172437191, 0.006449745036661625, -0.001275546383112669, 0.046485841274261475, -0.017137516289949417, 0.0024401757400482893, -0.021719880402088165, 0.013853046111762524, -0.018144046887755394, -0.01688588224351406, 0.03589078038930893, 0.006247776560485363, 0.015733670443296432, -0.009317033924162388, 0.0061186496168375015, -0.0017763286596164107, 3.585792910598684e-06, 0.01811756007373333, 0.012257164344191551, -0.006522586103528738, 0.06616617739200592, -0.0010528845014050603, -0.006340483669191599, -0.005645182449370623, -0.028527209535241127, 0.03046080842614174, -0.025904931128025055, 0.0004912632866762578, -0.007939675822854042, 0.0013012062991037965, 0.012330005876719952, 0.033665817230939865, -0.03991690278053284, 0.006787462625652552, 0.0358378030359745, -0.00525117851793766, -0.029189400374889374, 0.013276939280331135, 0.0018806238658726215, 0.039837438613176346, 0.03838061913847923, 0.03713569790124893, 0.0011936001246795058, -0.024964619427919388, -0.020739838480949402, 0.015111209824681282, 0.0009022359154187143, 0.028792086988687515, 0.003615565598011017, 0.05456458032131195, -0.015137697570025921, -0.05120064690709114, -0.03925471007823944, 0.0301959328353405, -0.015389330685138702, 0.028103407472372055, -0.026037368923425674, 0.051015231758356094, -0.028023943305015564, -0.005115429405122995, 0.023176701739430428, -0.00864822044968605, -0.004873729310929775, 0.0008240145398303866, -0.0029649625066667795, 0.007052339613437653, -0.026500903069972992, 0.02126959152519703, -0.0004850552650168538, 0.0045393225736916065, 0.0003571695415303111, 0.00012933427933603525, 0.003006349317729473, -0.0040559228509664536, -0.010628173127770424, -0.0031420986633747816, 0.007337081711739302, 0.02977212890982628, 0.023626992478966713, 0.02140202932059765, -0.034407470375299454, 0.012177701108157635, -0.006724554579705, 0.006251087877899408, -0.003920173738151789, -0.0446317084133625, -0.0226469486951828, -0.03676487132906914, 0.006370282266288996, 0.0177732203155756, 0.016091253608465195, 0.005108807235956192, 0.009045535698533058, -0.009177974425256252, 0.012581638060510159, 0.0330565981566906, -0.00033626912045292556, 0.014674163423478603, 0.02222314663231373, 0.018276484683156013, -0.02942778915166855, -0.014607944525778294, -0.048551879823207855, 0.003738071070984006, 0.042035914957523346, 0.0018855902599170804, 0.019534649327397346, -0.012614747509360313, -0.02291182614862919, 0.023163458332419395, -0.01646208018064499, 0.002877222141250968, 0.045187946408987045, 0.018144046887755394, -0.0017067985609173775, -0.024991106241941452, -0.01434306800365448, 0.0014634431572631001, 0.028394771739840508, -0.0037347599864006042, -0.013058416545391083, -0.013826558366417885, -0.038804423063993454, -0.011780386790633202, 0.0050889416597783566, 0.027891505509614944, -0.034963712096214294, 0.003896996844559908, 0.02511030063033104, 0.014329823665320873, 0.00860848929733038, -0.004350597970187664, 0.03197060525417328, 0.01803809590637684, -0.013270317576825619, 0.003916862886399031, 0.02162717469036579, 0.016726957634091377, -0.01907111518085003, -0.006592116318643093, 0.01901813969016075, 0.011343340389430523, 0.01941545493900776, 0.0011207590578123927, 0.008250906132161617, -0.014952284283936024, 0.008833634667098522, -0.024898400530219078, -0.014197385869920254, -0.02778555452823639, -0.0011042043333873153, 0.0039830817840993404, -0.009661373682320118, -0.004330732394009829, 0.012859758920967579, 0.01728319749236107, 0.007899944670498371, -0.002852389821782708, -0.05673656612634659, 0.003635431407019496, 0.02552085928618908, 0.03689730912446976, -0.003453328739851713, 0.03109651245176792, 0.03814223036170006, -0.015455549582839012, -0.0012846514582633972, -0.012733942829072475, 0.02333562821149826, -0.004665139131247997, -0.0022382072638720274, -0.009595154784619808, 0.009727592580020428, 0.009760702960193157, -0.0028739110566675663, -0.02525598369538784, 0.006946388632059097, -0.02717633917927742, 0.0025477816816419363, -0.03422205522656441, 0.011641326360404491, 0.022752899676561356, -0.029401302337646484, 0.005095563363283873, 0.027070388197898865, -0.044366829097270966, -0.030566759407520294, 0.011263877153396606, 0.0032000404316931963, 0.025163276121020317, -0.00545645784586668, 0.029533740133047104, 0.011608216911554337, -0.01166781410574913, 0.004062545020133257, -0.0017796396277844906, -0.004171806387603283, -0.014607944525778294, -0.012502175755798817, 0.0014104678994044662, -0.007409922778606415, 0.00471480330452323, 0.003128854790702462, -0.005370372906327248, -0.04097640886902809, 0.0014286781661212444, -0.008634977042675018, 0.008012517355382442, -0.01859433762729168, -0.01681966334581375, -0.012310139834880829, -0.007780750282108784, 0.022276122123003006, 0.025441396981477737, -0.021587442606687546, 0.04312191158533096, -0.022342341020703316, 0.053849413990974426, 0.015243648551404476, 0.028659647330641747, 0.0007412406266666949, -0.016091253608465195, -0.026461172848939896, -0.025150032714009285, -0.02312372624874115, -0.0012449199566617608, 0.006953010801225901, 0.009860031306743622, -0.011111573316156864, -0.017190491780638695, -0.015376086346805096, -0.006489476654678583, 0.000394624745240435, 0.005976278334856033, 0.017124272882938385, -0.014104679226875305, -0.006668268237262964, 0.00560876214876771, -0.06547749787569046, -0.017733488231897354, -0.003906929865479469, 0.00887998752295971, -0.0073635694570839405, 0.014422530308365822, -0.007542361039668322, 0.006290819030255079, 0.028845060616731644, -0.014210629276931286, -0.0058438400737941265, 0.011224146001040936, -0.002673598239198327, 0.0006050774827599525, 0.0205941554158926, -0.00826414953917265, -0.005138605833053589, -0.010833452455699444, 0.0165282990783453, -0.007098692934960127, 0.007952920161187649, 0.013482218608260155, -0.025004351511597633, 0.01757456175982952, -0.003284469712525606, 0.05133308470249176, -0.053558047860860825, 0.05482945591211319, 0.012634613551199436, 0.026858486235141754, -0.03032837063074112, 0.03059324622154236, -0.026063857600092888, 0.04097640886902809, 0.0008074597571976483, -0.03416908159852028, -0.009370009414851665, -0.059332359582185745, -0.002738161711022258, -0.006178246811032295, 0.002575924852862954, -0.013045172207057476, -0.025851955637335777, -0.022289365530014038, -0.0001816887961467728, 0.005032655317336321, -0.02655387856066227, 0.03604970499873161, -0.02203773334622383, 0.02512354589998722, 0.01002557948231697, -0.007522495463490486, -0.0025461262557655573, 0.009701105765998363, -0.010674526914954185, -0.016289910301566124, 0.02545464038848877, 0.03281820937991142, -0.0008641598979011178, 0.012641235254704952, 0.012515419162809849, -0.015945570543408394, 0.02903047576546669, 0.008317125029861927, -0.005373683758080006, -0.002029616851359606, 0.021931782364845276, -0.003810912137851119, -0.017812950536608696, -0.026090344414114952, 0.017269954085350037, 0.03075217269361019, -0.012303518131375313, 0.031334903091192245, 0.031202463433146477, -0.035572927445173264, -0.00044490990694612265, 0.003953283187001944, -0.013065038248896599, -0.016713714227080345, -0.015084722079336643, 0.03467234596610069, -0.017336172983050346, -0.005744511261582375, 0.014833089895546436, 0.020567668601870537, 0.02511030063033104, 0.053637512028217316, -0.02120337076485157, 0.03793032839894295, -0.00014578559785149992, 0.007562227081507444, 3.098849265370518e-05, 0.03631458058953285, 0.005966345313936472, 0.004463170655071735, 0.005062453914433718, 0.01818377897143364, 0.0034996820613741875, 0.02553410455584526, -0.0019302881555631757, 0.016011789441108704, 0.014078191481530666, 0.013475596904754639, 0.02291182614862919, 0.01403845939785242, 0.019190309569239616, -0.008105223998427391, -0.007052339613437653, 0.04010231792926788, 0.0358378030359745, -0.018475143238902092, 0.03652648255228996, -0.005751132965087891, 0.01152875367552042, 0.0038506435230374336, 0.009330278262495995, 0.0032960581593215466, 0.0348842479288578, 0.013389511965215206, 0.03281820937991142, -0.019044626504182816, -0.014806602150201797, 0.0020130621269345284, -0.012237299233675003, -0.005770999006927013, -0.004963125102221966, -0.0025163276586681604, 0.007343703880906105, 0.008588623255491257, -0.02115039713680744, 0.015415818430483341, 0.05440565198659897, 0.018647313117980957, 0.020421985536813736, -0.010674526914954185, -0.0005160954897291958, 0.0518893264234066, 0.030911099165678024, -0.0257989801466465, -0.017269954085350037, 0.01550852507352829, -0.03189114108681679, -0.025401664897799492, -0.000884025648701936, -0.0042645130306482315, 0.009754080325365067, 0.017799707129597664, 0.015349598601460457, -0.019177066162228584, -0.047386422753334045, -0.013204098679125309, -0.021706636995077133, 0.027573654428124428, -0.01279354002326727, 0.036817848682403564, -0.03234143182635307, -0.011204279959201813, -0.012257164344191551, -0.029136424884200096, 0.018779750913381577, -0.015031746588647366, 0.030142957344651222, -0.02313697151839733, 0.017826195806264877, -0.031944118440151215, 0.01647532358765602, -0.000983354402706027, -0.008052248507738113, 0.013641145080327988, -0.0007764195324853063]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
", M., Korthikanti, V ., Vainbrand, D., Kashinkunti, P.,
Bernauer, J., Catanzaro, B., Phanishayee, A., and Zaharia,
M. Efficient large-scale language model training on GPU
clusters using megatron-lm. In SC, pp. 58, 2021b.
OpenAI. Gpt-4 technical report. ArXiv , abs/2303.08774,
2023.
11
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
Osawa, K., Li, S., and Hoefler, T. Pipefisher: Efficient
training of large language models using pipelining and
fisher information matrices. In MLSys , 2023.
Parikh, A., T ¨ackstr ¨om, O., Das, D., and Uszkoreit, J. A
decomposable attention model for natural language infer-
ence. In EMNLP , pp. 2249–2255, 2016.
Pope, R., Douglas, S., Chowdhery, A., Devlin, J., Bradbury,
J., Levskaya, A., Heek, J., Xiao, K., Agrawal, S., and
Dean, J. Efficiently scaling transformer inference. ArXiv ,
abs/2211.05102, 2022.
Press, O. and Wolf, L. Using the output embedding to
improve language models. In EACL , pp. 157–163, 2017.
Radford, A., Narasimhan, K., Salimans, T., and Sutskever,
I. Improving language understanding by generative pre-
training, 2018.
Radford, A., Wu, J., Child, R., Luan, D., Amodei, D., and
Sutskever, I. Language models are unsupervised multitask
learners, 2019.
Rajbhandari, S., Rasley, J., Ruwase, O., and He, Y . Zero:
Memory optimizations toward training trillion parameter
models. In SC, 2019.
Rasley, J., Rajbhandari, S., Ruwase, O., and He, Y . Deep-
speed: System optimizations enable training deep learn-
ing models with over 100 billion parameters. In KDD , pp.
3505–3506, 2020.
Santilli, A., Severino, S., Postolache, E., Maiorca, V ., Man-
cusi, M., Marin, R., and Rodol `a, E. Accelerating trans-
former inference for translation via parallel decoding. In
ACL, 2023.
Scardapane, S., Scarpiniti, M., Baccarelli, E., and Uncini,
A. Why should we add early exits to neural networks?
Cognitive Computation , 12:954 – 966, 2020.
Schuster, T., Fisch, A., Jaakkola, T. S., and Barzilay, R.
Consistent accelerated inference via confident adaptive
transformers. In EMNLP , pp. 4962–4979, 2021.
Schuster, T., Fisch, A., Gupta, J., Dehghani, M., Bahri, D.,
Tran, V ., Tay, Y ., and Metzler, D. Confident adaptive
language modeling. In NeurIPS , 2022.
Schwartz, R., Stanovsky, G., Swayamdipta, S., Dodge, J.,
and Smith, N. A. The right tool for the job: Matching
model and instance complexities. In ACL, pp. 6640–6651,
2020.
Shazeer, N., Cheng, Y ., Parmar, N., Tran, D., Vaswani, A.,
Koanantakool, P., Hawkins, P., Lee, H., Hong, M., Young,
C., Sepassi, R., and Hechtman, B. Mesh-tensorflow:
Deep learning for supercomputers. In NIPS , pp. 10435–
10444, 2018.Shazeer, N. M., Mirhoseini, A., Maziarz, K., Davis, A., Le,
Q. V ., Hinton, G. E., and Dean, J. Outrageously large
neural networks: The sparsely-gated mixture-of-experts
layer. In ICLR , 2017.
Shoeybi, M.,","[-0.008398200385272503, 0.0045424229465425014, 0.035837605595588684, -0.005278585944324732, 0.02280454710125923, 0.0013089176500216126, -0.005238971672952175, 0.040564894676208496, -0.0652841255068779, 0.026343412697315216, 0.0315856859087944, -0.006437300238758326, -0.030053937807679176, 0.0171661339700222, -0.01471005566418171, -0.031004678457975388, 0.025683175772428513, -0.021761374548077583, 0.014525189995765686, 0.044975269585847855, -0.021893423050642014, -0.02240840718150139, -0.003740236395969987, 0.020110785961151123, 0.041198719292879105, 0.01426109578460455, 0.008074684999883175, 0.030053937807679176, 0.014525189995765686, -0.023411964997649193, 0.043258655816316605, -0.03491327539086342, -0.03876905143260956, -0.02000514790415764, -0.007995456457138062, 0.0264490507543087, 0.013838544487953186, 0.017918802797794342, -0.025854837149381638, 0.03113672509789467, 0.016334235668182373, -0.03795035928487778, -0.03251001611351967, 0.044288624078035355, -0.014300709590315819, 0.032668471336364746, 0.01731138490140438, -0.025379467755556107, 0.0038458742201328278, 0.058787405490875244, -0.002558414125815034, 0.013422596268355846, -0.07294286042451859, -0.00285221915692091, -0.027782727032899857, -0.0007274974486790597, 0.014155457727611065, 0.007599315140396357, 0.013006647117435932, -0.008299165405333042, -0.01006199512630701, -0.05794230103492737, -0.0017463240073993802, 0.017496250569820404, -0.04011593386530876, -0.012722745537757874, -0.044077347964048386, 0.026290593668818474, -0.01711331494152546, 0.015621181577444077, -0.01683601550757885, -0.005608703941106796, 0.04769544303417206, -0.056727468967437744, -0.02419104427099228, 0.008081287145614624, -0.03744858130812645, 0.08984490483999252, -0.016387054696679115, -0.007645531557500362, -0.012458651326596737, -0.015647590160369873, 0.015647590160369873, -0.0322723314166069, -0.046559836715459824, -0.019252479076385498, -0.01657192036509514, -0.023808106780052185, -0.037210896611213684, -0.019688233733177185, 0.002107803011313081, -0.006001544184982777, -0.03559992089867592, -0.0029958204831928015, 0.048540543764829636, 0.027597861364483833, 0.03620733693242073, -0.02205187827348709, 0.039270833134651184, 0.05551263317465782, -0.010306281968951225, 0.019160045310854912, 0.035071730613708496, -0.03486045449972153, 0.008068082854151726, -0.019635416567325592, -0.02502294071018696, -0.02968420647084713, 0.0022381998132914305, 0.020572951063513756, -0.09248584508895874, -0.007044717203825712, -0.004978178534656763, -0.01298683974891901, -0.026066113263368607, -0.06575949490070343, -0.036180928349494934, 0.029525749385356903, -0.015594772063195705, 0.035573508590459824, -0.0010390462120994925, 0.012247376143932343, 0.028548600152134895, 0.006793827284127474, 0.01622859761118889, -0.01902799867093563, 0.02046731300652027, -0.046480607241392136, -0.002347138710319996, -0.025683175772428513, -0.015066583640873432, -0.018737494945526123, 0.031427230685949326, -0.03248360753059387, -0.018790313974022865, -0.02749222330749035, -0.029525749385356903, 0.016505897045135498, -0.015964504331350327, -0.0027333765756338835, 0.01601732335984707, 0.010312885046005249, -0.027994001284241676, 0.022923391312360764, -0.03771267458796501, 0.01588527485728264, 0.0005570740322582424, 0.0029941697139292955, -0.029974710196256638, 0.02404579147696495, -0.00924330297857523, 0.0007501930231228471, -0.01003558561205864, -0.006496721412986517, -0.037976767867803574, -0.04310020059347153, -0.016387054696679115, 0.06655178219079971, 0.0618508979678154, -0.0748971626162529, 0.010207246989011765, 0.04745775833725929, 0.019622210413217545, 0.031717732548713684, 0.03787112981081009, 0.05931559205055237, -0.023610034957528114, -0.010880687274038792, -0.059209953993558884, -0.07024910300970078, -0.003179035848006606, -0.006387782283127308, -0.027096081525087357, -0.04589959979057312, 0.022830957546830177, -0.02314786985516548, -0.036867573857307434, -0.04436785355210304, -0.012220966629683971, -0.05984378233551979, -0.03010675683617592, 0.018473399803042412, -0.055354177951812744, 0.04317942634224892, -0.05472034960985184, 0.004222208634018898, 0.004169389605522156, 0.04663906246423721, 0.015489134006202221, 0.04885745793581009, -0.020440902560949326, 0.04294174164533615, 0.05894586071372032, 0.018262125551700592, 0.017126519232988358, -0.011732392013072968, 0.06982655078172684, -0.020163604989647865, 0.012029497884213924, -0.030555717647075653, 0.02823168784379959, 0.042096640914678574, -0.015291063115000725, -0.057202838361263275, 0.038716234266757965, -0.052396319806575775, -0.018024440854787827, -0.0015424761222675443, -0.023266712203621864, -0.0053281038999557495, 0.030766993761062622, 0.04677111282944679, 0.0405384860932827, -0.016888834536075592, -0.017496250569820404, -0.012531277723610401, -0.06264318525791168, -0.009771491400897503, 0.010953313671052456, 0.02685839682817459, -0.003928403835743666, 0.02907678857445717, 0.020044762641191483, 0.012220966629683971, -0.03264206275343895, 0.027650680392980576, 0.031374409794807434, -0.0285221915692091, 0.05126071348786354, 0.0014632478123530746, 0.054456256330013275, -0.0046414583921432495, -0.005304995458573103, -0.04088180512189865, -0.003456335049122572, -0.02081063576042652, 0.02555112913250923, -0.03628656640648842, -0.0030684464145451784, -0.05413934215903282, 0.018777109682559967, 0.01157393492758274, 0.014762874692678452, -0.002206838456913829, -0.009263109415769577, 0.04624292254447937, -0.0350189134478569, -0.061322711408138275, 0.04352274909615517, 0.01863185688853264, -0.015766432508826256, -0.03874264284968376, -0.02287057228386402, -0.017298180609941483, -0.02831091545522213, -0.010451534762978554, -0.019595801830291748, -0.011316443793475628, -0.01765470765531063, 0.011184396222233772, -0.01835455745458603, 0.04835567623376846, -0.004555627703666687, 0.01752266101539135, 0.004004330839961767, -0.01047794334590435, -0.03470199927687645, 0.02335914596915245, -0.00013524519454222172, -0.01000257395207882, 0.041462816298007965, 0.0022398503497242928, -0.005291790701448917, 0.00539412721991539, -0.07996777445077896, -0.012755757197737694, 0.03462276980280876, 0.03676193580031395, -0.05963250622153282, 0.02123318612575531, 0.004067053087055683, 0.01828853413462639, 0.05374320223927498, 0.03224592283368111, 0.007546496111899614, 0.02178778499364853, 0.00537762138992548, -0.03277410939335823, -0.044077347964048386, -0.02942011132836342, 0.03818804398179054, -0.0043179430067539215, 0.002883580280467868, -0.023477988317608833, 0.029156018048524857, -0.002198585541918874, 0.010114814154803753, 0.026026498526334763, 0.006308554206043482, -0.050125110894441605, 0.03800318017601967, -0.022368792444467545, 0.00188992521725595, -0.004743794910609722, -0.0013831942342221737, 0.03388330712914467, -0.06074170395731926, 0.004776806570589542, 0.029974710196256638, 0.0029892181046307087, -0.003446431364864111, -0.008820751681923866, -0.021074729040265083, 0.028126049786806107, -0.012022895738482475, -0.019556187093257904, 0.017641503363847733, -0.039614152163267136, 0.026911215856671333, -0.04851413518190384, -0.02321389503777027, -0.006526432000100613, -0.037210896611213684, -0.01003558561205864, 0.012346411123871803, 0.019344910979270935, -0.0004237889079377055, -0.001411254284903407, -0.02193303592503071, -0.02151048555970192, 0.01897517964243889, 0.01703408546745777, 0.02617175132036209, -0.023887334391474724, -0.01943734474480152, -0.029604976996779442, -0.04864618182182312, 0.0223291777074337, 0.05868176743388176, 0.004770204424858093, -0.08144669979810715, 0.018116872757673264, -0.04550345987081528, 0.021338824182748795, 0.007130547892302275, 0.03311743214726448, -0.009956357069313526, 0.02246122620999813, 0.06364674121141434, 0.016373850405216217, 0.02672634832561016, -0.024904098361730576, 0.02137843891978264, -0.01663794554769993, 0.011461695656180382, 0.02288377657532692, -0.010246860794723034, -0.01566079631447792, -0.014947740361094475, 0.0009812755743041635, -0.023623241111636162, 0.030318032950162888, 0.0250757597386837, -0.005331404972821474, -0.01357445027679205, 0.01964862085878849, -0.025128578767180443, 0.050600480288267136, -0.014947740361094475, -0.021180367097258568, 0.012445447035133839, 0.06465029716491699, -0.00866229459643364, -0.005605402868241072, -0.03932365030050278, -0.011494707316160202, -0.006945681758224964, 0.014102638699114323, -0.0019377924036234617, 0.06422774493694305, 0.030001118779182434, 0.019278887659311295, -0.0008034245693124831, -0.0051564425230026245, -0.030053937807679176, 0.028971150517463684, -0.012676529586315155, -0.007361630443483591, -0.009949754923582077, -0.008530247956514359, -0.00818032305687666, 0.0038161634001880884, -0.04199100285768509, 0.041198719292879105, 0.031031087040901184, -0.0035652739461511374, 0.023596830666065216, 0.005295091774314642, 0.04001029580831528, 0.017747141420841217, -0.013891363516449928, 0.0013047911925241351, -0.006985296029597521, -0.015449520200490952, 0.03673552721738815, 0.029023969545960426, 0.05641055479645729, 0.05028356611728668, 0.021457666531205177, 0.022791342809796333, 0.04233432561159134, -0.04294174164533615, 0.028416553512215614, -0.0199259202927351, 0.0010010827099904418, -0.045529868453741074, 0.01294722594320774, 0.006767417769879103, 0.006717900279909372, 0.06781943142414093, -0.0033259382471442223, -0.009566818363964558, -0.04156845062971115, -0.040380027145147324, -0.023860925808548927, -0.005054106004536152, 0.027439404278993607, -0.07954522222280502, 0.006315156351774931, -0.0285221915692091, -0.017813164740800858, -0.010933506302535534, 0.03235156089067459, 0.005819979589432478, -0.018724290654063225, -0.02391374483704567, 0.020176809281110764, 0.039006736129522324, 0.03451713174581528, -0.04563550651073456, -0.004416977986693382, 0.004529218189418316, -0.03427944704890251, -0.004456592258065939, -0.02129920944571495, -0.022844161838293076, -0.037422168999910355, 0.028680646792054176, 0.01037890836596489, -0.027228128165006638, 0.05884022265672684, 0.002819207264110446, 0.04426221549510956, 0.024719232693314552, 0.008127504028379917, -0.04413016885519028, 0.07737964391708374, -0.012445447035133839, 0.06903426349163055, -0.0021045019384473562, 0.048963095992803574, 0.0034167207777500153, -0.05313578620553017, -0.041462816298007965, 0.011118372902274132, 0.03829368203878403, 0.039614152163267136, 0.0017727334052324295, 0.041542042046785355, 0.006886260583996773, 0.017232157289981842, -0.02322709932923317, -0.005423837807029486, -0.04138358682394028, 0.009434770792722702, -0.020916273817420006, 0.00680042989552021, -0.03684116154909134, 0.0010250161867588758, -0.016941653564572334, 0.031506456434726715, -0.04143640398979187, 0.0008430387242697179, 0.016783196479082108, 0.015383496880531311, 0.018856337293982506, -0.010576979257166386, -0.015819251537322998, 0.006008146796375513, 0.02720171958208084, 0.01072223111987114, -0.010643002577126026, 0.05709720030426979, -0.014683646149933338, -0.005262080114334822, -0.00865569245070219, -0.036260154098272324, -0.056991562247276306, -0.01325753703713417, -0.029314473271369934, 0.040089525282382965, -0.04558268561959267, -0.007341823074966669, -0.005747353658080101, -0.02680557779967785, -0.02788836508989334, 0.04513372480869293, 0.00899901520460844, -0.011263624764978886, 0.020308855921030045, 0.00268881069496274, 0.009177278727293015, 0.013851748779416084, 0.03657706826925278, 0.01766791194677353, 0.04317942634224892, -0.017126519232988358, 0.033434346318244934, 0.0018156487494707108, 0.0432850643992424, 0.020440902560949326, -0.02013719454407692, -0.01071562897413969, -0.021312415599822998, 0.013957386836409569, -0.009811105206608772, -0.006235928274691105, -0.04803876578807831, -0.01079485658556223, 0.013746111653745174, 0.02246122620999813, -0.01295382808893919, -0.007790783420205116, -0.015225039795041084, -0.0542978011071682, -0.014881717041134834, -0.0032070958986878395, -0.030397260561585426, -0.05667464807629585, 0.022315973415970802, -0.008114298805594444, 0.04714084416627884, 0.008767932653427124, 0.03427944704890251, -0.011448490433394909, -0.01634743995964527, 0.024996530264616013, -0.018526218831539154, -0.0073286183178424835, 0.011224010027945042, 0.031427230685949326, -0.03346075490117073, 0.006325060036033392, -0.02349119260907173, -0.0020087677985429764, -0.00783039815723896, 0.0230158232152462, 0.012042703106999397, 0.003938307054340839, -0.0012371169868856668, 0.021391643211245537, -0.030555717647075653, -0.015964504331350327, -0.0057341489009559155, -0.029023969545960426, -0.01191725768148899, -0.004116571042686701, -0.05310937762260437, 0.026145340874791145, -0.007381437346339226, -0.019490163773298264, -0.01703408546745777, 0.013468812219798565, -0.0016778245335444808, 0.007658736314624548, -0.020361674949526787, -0.01772073097527027, 0.015502339228987694, -0.00250889640301466, 0.026092521846294403, -0.03818804398179054, -0.003997728228569031, 0.0025881247129291296, 0.008774534799158573, -0.03248360753059387, 0.00821333471685648, -0.02494371309876442, 0.015647590160369873, -0.03311743214726448, 0.01250486820936203, 0.07104138284921646, -0.02873346582055092, -0.0063283611088991165, -0.050257157534360886, -0.035626329481601715, -0.013693292625248432, 0.022778138518333435, -0.03615451604127884, -0.03293256834149361, 0.018050849437713623, 0.0017248663352802396, -0.03800318017601967, -0.00892638973891735, -0.02267250046133995, -0.015317472629249096, -0.013957386836409569, -0.021404847502708435, 0.021114343777298927, 0.00588930444791913, -0.02308184653520584, 0.005443645175546408, -0.013402788899838924, -0.002355391625314951, -0.04608446732163429, -0.03306461498141289, -0.011422080919146538, -0.011956872418522835, -0.00467447005212307, 0.04082898795604706, -0.006493419874459505, 0.006707996595650911, -0.04798594489693642, 0.007262594997882843, 0.015370291657745838, 0.0074210516177117825, 0.01209552213549614, -0.014115843921899796, -0.007262594997882843, -0.039059557020664215, -0.005460151005536318, -0.027122490108013153, -0.014657236635684967, 0.0343322679400444, 0.012240773998200893, -0.00010708200716180727, 0.007090933620929718, -0.01251147035509348, -0.0060675679706037045, 0.0018288533901795745, -0.029789844527840614, 0.016928449273109436, -0.010081802494823933, 0.023742083460092545, 0.005205960012972355, 0.021418051794171333, 0.010893892496824265, -0.014010205864906311, 0.014313913881778717, 0.0006515703280456364, 3.314074638183229e-05, -0.02349119260907173, -0.03045007959008217, 0.025749200955033302, 0.02500973641872406, 0.03615451604127884, -0.0029066884890198708, 0.011283431202173233, -0.04516013711690903, -0.01188424602150917, -0.010385510511696339, -0.0577310286462307, 0.04225509613752365, -0.006826839409768581, 0.020388085395097733, -0.018328148871660233, 0.024996530264616013, 0.03861059620976448, 0.031849779188632965, 0.014445961453020573, -0.0230290275067091, 0.008378393948078156, 0.013521631248295307, 0.04027438908815384, -0.002908339025452733, 0.0024263670202344656, -0.030344441533088684, 0.017892392352223396, -0.0038029588758945465, 0.027016853913664818, 0.0058860029093921185, -0.04774826020002365, 0.049174368381500244, -0.05820639804005623, -0.018050849437713623, 0.012689733877778053, 0.006093977484852076, 0.013838544487953186, 0.012973635457456112, 0.016796400770545006, -0.003783151740208268, -0.011791813187301159, -0.0035817797761410475, -0.0037798504345119, -0.023108256980776787, -0.0075597008690238, -0.021536894142627716, -0.018182896077632904, 0.044843222945928574, -0.026356616988778114, -0.08715113997459412, -0.018671471625566483, 0.02261968143284321, -0.051155079156160355, -0.010530762374401093, -0.029156018048524857, -0.01766791194677353, -0.03739576041698456, 0.030344441533088684, 0.04988742619752884, -0.029789844527840614, -0.033091023564338684, -0.0037765493616461754, 0.008464224636554718, 0.0075002796947956085, -0.024243861436843872, 0.0016167527064681053, 0.0309254489839077, 0.01663794554769993, -0.005420536734163761, -0.02775631658732891, -0.054244980216026306, -0.024692822247743607, -0.010702423751354218, 0.010550569742918015, 0.007922830991446972, -0.026831986382603645, -0.018777109682559967, 0.0018849734915420413, 0.0020483818370848894, 0.011745596304535866, 0.018948771059513092, 0.015858866274356842, 0.02308184653520584, -0.03578478470444679, 0.006625467445701361, -0.004251919221132994, -0.038320090621709824, -0.016743581742048264, -0.03813522681593895, -0.01501376461237669, -0.01930529810488224, -0.0216425321996212, -0.006311855278909206, 0.04983460530638695, 0.00969226285815239, -0.015159016475081444, 0.026277389377355576, 0.018499810248613358, 0.03937646746635437, -0.018156487494707108, -0.05725565552711487, 0.011025939136743546, 0.010814663954079151, 0.0015523796901106834, -0.008946196176111698, -0.02762426994740963, 0.0223423819988966, 0.007170161698013544, -0.0020995500963181257, -0.02219713106751442, 0.0178659837692976, 0.007724760100245476, -0.004476399626582861, 0.03874264284968376, 0.01285479310899973, -0.017152927815914154, -0.005331404972821474, -0.023345941677689552, -0.02227635867893696, 0.04777466878294945, -0.024270271882414818, -0.016373850405216217, 0.017549069598317146, 0.014802488498389721, 0.014947740361094475, -0.00771155534312129, 0.0028208578005433083, 0.02886551432311535, 0.009929947555065155, 0.024640003219246864, -0.02817886881530285, -0.006879657972604036, 0.027228128165006638, -0.01587207056581974, -0.03179696202278137, -0.02473243698477745, -0.051155079156160355, -0.017694322392344475, 0.008186925202608109, -0.050547659397125244, -0.04280969500541687, 0.01657192036509514, 0.006846646312624216, -0.00534460972994566, -0.010075199417769909, 0.040168751031160355, 0.010497750714421272, -0.06987936794757843, -0.03594324365258217, 0.03409458324313164, 0.011765403673052788, 0.005559186451137066, -0.021668942645192146, 0.013072670437395573, 0.028680646792054176, 0.010768447071313858, -0.039746202528476715, 0.03303820267319679, -0.0029859167989343405, 0.0007605092250742018, 0.012597301043570042, 0.008378393948078156, -0.06031915172934532, 0.0012346411822363734, -0.020110785961151123, 0.03015957586467266, -0.004935263190418482, -0.031031087040901184, 0.004397171083837748, 0.010530762374401093, 0.027175309136509895, -0.03324947878718376, -0.0025138482451438904, 0.0057341489009559155, 0.017430227249860764, -0.01364047359675169, 0.018169691786170006, -0.035626329481601715, -0.04096103459596634, 0.005262080114334822, 0.030740583315491676, -0.046005237847566605, 0.0055525838397443295, -0.024930506944656372, -0.0185526292771101, -0.0045523266308009624, -0.02226315438747406, -0.041066672652959824, -0.0597909614443779, 0.04114590212702751, -0.03338152542710304, 0.04148922488093376, 0.031242363154888153, 0.03538864478468895, -0.010946711525321007, 0.016730377450585365, -0.002517149318009615, 0.007341823074966669, 0.004238714464008808, -0.006846646312624216, 0.03187618777155876, 0.0073286183178424835, -0.025788813829421997, 0.010253463871777058, -0.00014535506488755345, 0.047035206109285355, 0.04825003817677498, -0.001809046370908618, 0.0026095823850482702, -0.0032153488136827946, -0.0363922044634819, -0.01868467591702938, -0.017152927815914154, -0.0048131197690963745, 0.03214028477668762, -0.001629132078960538, -0.04832926765084267, -0.007724760100245476, 0.04294174164533615, 0.01360085979104042, 0.01814328320324421, 0.021761374548077583, -0.007222980726510286, 0.026079317554831505, 0.024904098361730576, -0.022236745804548264, 0.017364203929901123, 0.02246122620999813, -0.010134621523320675, -0.007698350585997105, -0.010966517962515354, -0.0031608794815838337, 0.01902799867093563, -0.0057341489009559155, 0.021272800862789154, 0.0028736768290400505, 0.05678028613328934, 0.03602246940135956, -0.01642666943371296, 0.02720171958208084, -0.005922316107898951, 0.03203464671969414, 0.01773393712937832, 0.004585338290780783, 0.025735994800925255, 0.034807637333869934, -0.003585080849006772, 0.05519572272896767, 0.06158680468797684, -0.04164768010377884, -0.02275172993540764, 0.010332691483199596, 0.003472840879112482, 0.002038478385657072, -0.00115871406160295, 0.010299679823219776, 0.0005640890449285507, 0.00412317318841815, 0.024441933259367943, -0.002224995056167245, 0.024217452853918076, 0.0029215437825769186, 0.0002591426018625498, 0.021325619891285896, 0.021999061107635498, 0.005829882808029652, -0.0008682102197781205, -0.004545724019408226, -0.00043245451524853706, -0.012557687237858772, -0.002198585541918874, -0.025656767189502716, -0.015172220766544342, 0.04006311297416687, 0.02741299383342266, -0.027861954644322395, -0.0048956493847072124, 0.013006647117435932, -0.0032648665364831686, 0.011494707316160202, -0.011527718976140022, -0.01257089152932167, 0.01588527485728264, 0.009487589821219444, 0.0316120944917202, -0.02136523462831974, 0.03398894518613815, 0.008675499819219112, -0.007341823074966669, 0.011290034279227257, -0.011659765616059303, 0.024441933259367943, 0.0013089176500216126, -0.0077445670031011105, -0.04764262214303017, 0.0002942176361102611, 0.0027564847841858864, 0.027333766222000122, -0.02048051729798317, -0.01507978793233633, 0.025868043303489685, 0.0014756271848455071, 0.007170161698013544, -0.02947293035686016, -0.030265213921666145, -0.028944741934537888, 0.036603476852178574, 0.01794521138072014, 0.042017411440610886, -0.01930529810488224, -0.015277858823537827, 0.014063024893403053, -0.01840737648308277, -0.023411964997649193, -0.006595756858587265, -0.02981625311076641, 0.025339853018522263, -0.012874600477516651, -0.008715113624930382, 0.03396253287792206, 0.02170855551958084, 0.0020978995598852634, 0.022698910906910896, -0.012485060840845108, -0.004278328735381365, 0.010385510511696339, 0.021893423050642014, 0.027677088975906372, -0.0034101183991879225, -0.0038029588758945465, 0.0023504397831857204, 0.016796400770545006, 0.0022282961290329695, 0.002607931848615408, 0.015291063115000725, -0.002569968346506357, 0.04745775833725929, -0.005192755255848169, 0.015753228217363358, -0.0005467578303068876, 0.05503726378083229, 0.025802018120884895, -0.056727468967437744, 0.013957386836409569, 0.02046731300652027, -0.029367292299866676, -0.03269487991929054, -0.013798930682241917, 0.020969092845916748, -0.0032037945929914713, -0.019424140453338623, -0.06053042784333229, 0.02741299383342266, -0.01113817933946848, -0.03449072316288948, -0.007929433137178421, 0.009745081886649132, 0.0020500323735177517, 0.0012519722804427147, 0.002933098003268242, 0.04732570797204971, -0.004436785355210304, -0.019965533167123795, 0.027914773672819138, -0.0011702681658789515, -0.05456189438700676, -0.0028060025069862604, -0.036946799606084824, -0.015647590160369873, -0.008761330507695675, -0.0071767643094062805, -0.014063024893403053, 0.0309254489839077, -0.00568793248385191, 0.00376334460452199, -0.009322530589997768, 0.00793603528290987, 0.013316958211362362, 0.004747095983475447, 0.0057242452166974545, -0.001711661578156054, 0.022038673982024193, -0.02652827836573124, -0.003951511811465025, -0.010108212009072304, 0.008530247956514359, 0.010907096788287163, 0.0264622550457716, 0.015000559389591217, 0.012762360274791718, -0.008715113624930382, 0.0023834516759961843, 0.012617108412086964, 0.009540408849716187, 0.01772073097527027, -0.005506367422640324, -0.019265683367848396, 0.018711084499955177, -0.0040472461842000484, 0.007718157488852739, -0.012643517926335335, 0.017073700204491615, 0.006196314003318548, 0.013323560357093811, 0.051920950412750244, 0.012993442825973034, 0.03697321191430092, -0.0033639019820839167, 0.023385556414723396, 0.007797386031597853, -0.0063910833559930325, 0.03317025303840637, -0.02103511616587639, -0.007658736314624548, -0.0033143842592835426, 0.005222465842962265, 0.024956917390227318, -0.043601978570222855, 0.008477428928017616, 0.010676014237105846, 0.02157650887966156, 0.0023207291960716248, -0.006093977484852076, -0.014564803801476955, -0.005304995458573103, 0.0033028300385922194, 0.008186925202608109, -0.025868043303489685, -0.016453078016638756, -0.007797386031597853, -0.01917325146496296, 0.006232626736164093, -0.005691233556717634, -0.050336383283138275, -0.003839271841570735, 0.03921801224350929, -0.027175309136509895, 0.0031740840058773756, 0.024230657145380974, -0.03058212623000145, 0.0013551341835409403, -0.01876390352845192, 0.021048320457339287, 0.006453806068748236, 0.007810590788722038, 0.03211387246847153, -0.03319666162133217, 0.00958662573248148, 0.014578009024262428, 0.0007782530738040805, -0.007209775969386101, 0.014102638699114323, 0.010431727394461632, -0.00019053995492868125, -0.0467447005212307, -0.008068082854151726, 0.02252724952995777, -0.026277389377355576, 0.030212394893169403, 0.027782727032899857, 0.008259550668299198, 0.010893892496824265, 0.005120129324495792, 0.013587654568254948, -0.03264206275343895, 0.019595801830291748, 0.0018305040430277586, 0.007645531557500362, -0.00484283035621047, 0.01807725802063942, 0.002012068871408701, -0.019754258915781975, -0.00866229459643364, 0.019688233733177185, -0.020863454788923264, 0.02330632694065571, 0.034464314579963684, 0.03190260007977486, 0.0072493902407586575, -0.025920862331986427, 0.03417380899190903, -0.03496609255671501, 0.009362145327031612, -0.013376379385590553, -0.008543452247977257, 0.0036709115374833345, -0.013125489465892315, 0.039138782769441605, 0.018130077049136162, -0.007493677549064159, 0.002348789246752858, -0.008338779211044312, -0.008906582370400429, -0.015106197446584702, 0.013217922300100327, 0.021906627342104912, -0.012478458695113659, 0.0707244724035263, -0.013204718008637428, 0.002631040057167411, -0.010299679823219776, -0.030740583315491676, 0.044631946831941605, -0.020599359646439552, 0.013422596268355846, -0.007698350585997105, 0.0071767643094062805, -0.0011809970019385219, 0.030872629955410957, -0.027465812861919403, -0.01143528614193201, 0.0453450009226799, -0.017918802797794342, -0.01608334667980671, 0.00767854368314147, -0.01426109578460455, 0.029314473271369934, 0.026026498526334763, 0.044975269585847855, -0.012003088369965553, -0.031215952709317207, -0.00714375264942646, 0.01398379635065794, 0.0012024546740576625, 0.012082316912710667, 0.030608536675572395, 0.06972090899944305, -0.01882992871105671, -0.0377919040620327, -0.020506927743554115, 0.029050379991531372, -0.0008079636609181762, 0.040723349899053574, -0.03744858130812645, 0.022896980866789818, -0.04088180512189865, 0.0027597860898822546, 0.0139177730306983, -0.003977921325713396, -0.012874600477516651, 0.00376334460452199, -0.022091493010520935, 5.008508378523402e-05, -0.02736017480492592, -0.004324545152485371, 0.0006160826305858791, -0.008781137876212597, -0.025313444435596466, -0.006978693418204784, 0.0023685963824391365, -0.019226068630814552, -0.01793200708925724, 0.012623710557818413, 0.004119872115552425, 0.061798080801963806, 0.01889595203101635, 0.02685839682817459, -0.02582842856645584, -0.00684004370123148, -0.01542311068624258, 0.016611535102128983, -0.019120432436466217, -0.031083906069397926, -0.03148004785180092, -0.014908126555383205, 0.014578009024262428, 0.0285221915692091, -0.004694277420639992, -0.01010160893201828, 0.004119872115552425, -0.004007631912827492, 0.021312415599822998, 0.024996530264616013, -0.010504352860152721, 0.022038673982024193, 0.020374879240989685, 0.03251001611351967, -0.03589042276144028, -0.004364159423857927, -0.028707057237625122, 0.031849779188632965, 0.0185526292771101, -0.005083816591650248, 0.01910722628235817, -0.01676999218761921, -0.015594772063195705, -0.0025039445608854294, -0.006866453215479851, -0.010326089337468147, 0.022566862404346466, 0.015766432508826256, -0.011679572984576225, -0.017152927815914154, -0.012524674646556377, 0.0005888479063287377, 0.025445491075515747, -0.0025336553808301687, -0.028337324038147926, -5.436630090116523e-05, -0.01896197535097599, -0.011468297801911831, -0.0020714900456368923, 0.035494282841682434, -0.021127548068761826, -0.011270226910710335, 0.011382467113435268, 0.007850204594433308, -0.01144188828766346, -0.011580538004636765, 0.02809963934123516, 0.016862424090504646, 0.015779638662934303, 0.023200688883662224, 0.0029116403311491013, 0.018169691786170006, -0.005938821937888861, -0.03406817093491554, 0.026330208405852318, -0.002467631595209241, 0.025788813829421997, -0.001914684078656137, -0.022857366129755974, -0.01819610223174095, 0.017575480043888092, -0.015594772063195705, -0.02494371309876442, -0.011468297801911831, -0.002895134501159191, -0.01250486820936203, 0.0049847811460494995, -0.0064009870402514935, 0.024019382894039154, 0.04722006991505623, 0.026488663628697395, -0.008193527348339558, -0.003925102297216654, 0.002363644540309906, 0.004496206529438496, 0.029710615053772926, 0.00045597541611641645, 0.03195541724562645, 0.016888834536075592, -0.019278887659311295, 0.002038478385657072, -0.018169691786170006, 0.016202189028263092, -0.0031658310908824205, -0.00783039815723896, -0.004387267399579287, -0.008318972773849964, -6.751943874405697e-05, 0.007229583337903023, -0.015277858823537827, -0.010550569742918015, -0.02355721779167652, 0.0057341489009559155, -0.03396253287792206, -0.01574002392590046, 0.018301738426089287, 0.000660235877148807, 0.008748125284910202, 0.03525659814476967, -0.04494886100292206, -0.03628656640648842, 0.020850250497460365, 0.0034530337434262037, 0.008761330507695675, 0.0063910833559930325, 0.025986885651946068, -0.013759315945208073, -0.011025939136743546, 0.0017941910773515701, -0.030291622504591942, -0.011184396222233772, -0.0023537410888820887, -0.011415478773415089, -0.002485788194462657, -0.018050849437713623, -0.0024923905730247498, 0.023794902488589287, 0.01106555387377739, -0.036101698875427246, -0.0048857457004487514, -0.0006635370664298534, 0.014696851372718811, -0.02239520102739334, -0.0089329918846488, -0.034253038465976715, -0.005549282766878605, 0.007922830991446972, -0.007388039492070675, -0.0016439873725175858, 0.025643562898039818, -0.004024137742817402, 0.054033707827329636, 0.03454354405403137, 0.007137150038033724, -0.004436785355210304, -0.015277858823537827, 0.0011603645980358124, -0.03483404591679573, -0.01000257395207882, 0.02844296209514141, 0.0030354345217347145, 0.00855665747076273, -0.0003963478666264564, -0.03586401417851448, -0.00285221915692091, -0.023200688883662224, 0.0022398503497242928, -0.004747095983475447, 0.016743581742048264, -0.022078288719058037, 0.003022229764610529, 0.007460665889084339, -0.048276450484991074, -0.03657706826925278, -0.0016687462339177728, 0.002639292972162366, 0.022012265399098396, 0.01394418254494667, -0.01750945672392845, 0.023055437952280045, 0.009421566501259804, -0.017218952998518944, 0.013026454485952854, 0.03657706826925278, 0.002891833195462823, 0.008682101964950562, 0.026132136583328247, -0.0031641805544495583, -0.013211320154368877, -0.01834135316312313, 0.013310356065630913, 0.01819610223174095, 0.01669076271355152, 0.013997000642120838, -0.01116458885371685, 0.018724290654063225, 0.005331404972821474, 0.048487722873687744, -0.024970121681690216, 0.06829480081796646, 0.03834650292992592, 0.039006736129522324, -0.02762426994740963, 0.037633445113897324, -0.011045746505260468, 0.02610572800040245, -0.006711298134177923, -0.02088986337184906, 0.010352498851716518, -0.040776170790195465, -0.0158060472458601, -0.025669971480965614, 0.012174749746918678, 0.01075524277985096, 0.004456592258065939, -0.01079485658556223, 0.017905598506331444, 0.005810075905174017, -0.035969652235507965, 0.04233432561159134, -0.019212864339351654, 0.02968420647084713, -0.003717128187417984, -0.019675029441714287, 0.011257021687924862, -0.0012362917186692357, -0.0014071277109906077, -0.01945054903626442, -0.004397171083837748, 0.026752758771181107, 0.0006429047207348049, -0.008853763341903687, 0.024956917390227318, -0.03361921384930611, 0.0004984781262464821, -0.013482017442584038, -0.014723260886967182, -0.011190998367965221, 0.025603948161005974, 0.013864954002201557, -0.0185526292771101, -0.010299679823219776, 0.01037890836596489, 0.01799803040921688, -0.009447976015508175, 0.01794521138072014, 0.03546787425875664, -0.03010675683617592, 0.002436270471662283, 0.011897451244294643, -0.003025531070306897, -0.024507956579327583, 0.008675499819219112, 0.03153286501765251, -0.015040174126625061, -0.02541908249258995, 0.008820751681923866, 0.027386585250496864, 0.008708511479198933, 0.053215011954307556, 0.00018280281801708043, 0.024204248562455177, -0.01177860889583826, 0.007394642103463411, 0.001034919754602015, 0.005793570075184107, -0.022857366129755974, 0.004733891226351261, -0.012524674646556377, -0.0007873313152231276, 0.00010718517296481878, 0.032325148582458496, -0.00427502766251564, 0.037131667137145996, 0.014749670401215553, -0.002175477333366871, 0.00889998022466898, 0.01807725802063942, 0.012993442825973034, -0.009157472290098667, -0.0062392293475568295, 0.03979901969432831, 0.031374409794807434, -0.0016274815425276756, 0.029631387442350388, -0.003380407812073827, 0.026567893102765083, 0.011534321121871471, 0.0008657342987135053, 0.007308811414986849, 0.01191725768148899, 0.03155927732586861, 0.0432850643992424, -0.027518631890416145, -0.03340793773531914, 0.01951657235622406, -0.006925874389708042, -0.028627827763557434, -0.012874600477516651, -0.0020021654199808836, 0.0056516192853450775, -0.005126731935888529, -0.02912960760295391, 0.006183109246194363, 0.041198719292879105, 0.021114343777298927, 0.02149728126823902, 0.00277299084700644, 0.01758868433535099, 0.040300797671079636, 0.0192392747849226, -0.036656297743320465, -0.027333766222000122, -0.00606426689773798, -0.031031087040901184, 0.00048527339822612703, 0.03491327539086342, 0.004119872115552425, 0.01834135316312313, 0.017681118100881577, 0.007975650019943714, -0.012346411123871803, -0.024996530264616013, -0.029103199020028114, -0.017298180609941483, 0.015819251537322998, 0.01535708736628294, 0.03269487991929054, -0.038240864872932434, -0.0043905689381062984, -0.012795371934771538, -0.02522101067006588, -0.008939594030380249, -0.00554598169401288, 0.021748170256614685, -0.02873346582055092, 0.012980237603187561, -0.025379467755556107, -0.003545466810464859, 0.014168662019073963, -0.0058232806622982025, 0.008748125284910202, -0.006793827284127474]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" Patwary, M., Puri, R., LeGresley, P., Casper,
J., and Catanzaro, B. Megatron-lm: Training multi-
billion parameter language models using model paral-
lelism. ArXiv , abs/1909.08053, 2019.
Smith, S., Patwary, M., Norick, B., LeGresley, P., Rajbhan-
dari, S., Casper, J., Liu, Z., Prabhumoye, S., Zerveas,
G., Korthikanti, V . A., Zhang, E., Child, R., Aminabadi,
R. Y ., Bernauer, J., Song, X., Shoeybi, M., He, Y ., Hous-
ton, M., Tiwary, S., and Catanzaro, B. Using deepspeed
and megatron to train megatron-turing nlg 530b, a large-
scale generative language model. ArXiv , abs/2201.11990,
2022.
Szegedy, C., Liu, W., Jia, Y ., Sermanet, P., Reed, S. E.,
Anguelov, D., Erhan, D., Vanhoucke, V ., and Rabinovich,
A. Going deeper with convolutions. In CVPR , 2015.
Tang, P., Zhu, P., Li, T., Appalaraju, S., Mahadevan, V ., and
Manmatha, R. Deed: Dynamic early exit on decoder for
accelerating encoder-decoder transformer models. ArXiv ,
abs/2311.08623, 2023.
Tay, Y ., Dehghani, M., Bahri, D., and Metzler, D. Efficient
transformers: A survey. ACM Comput. Surv. , 55(6), 2022.
doi: 10.1145/3530811.
Team, I. Internlm: A multilingual language
model with progressively enhanced capabilities.
https://github.com/InternLM/InternLM, 2023.
Teerapittayanon, S., McDanel, B., and Kung, H. T.
Branchynet: Fast inference via early exiting from deep
neural networks. In ICPR , pp. 2464–2469, 2016.
Touvron, H., Lavril, T., Izacard, G., Martinet, X., Lachaux,
M.-A., Lacroix, T., Rozi `ere, B., Goyal, N., Hambro, E.,
Azhar, F., Rodriguez, A., Joulin, A., Grave, E., and Lam-
ple, G. Llama: Open and efficient foundation language
models. ArXiv , abs/2302.13971, 2023a.
Touvron, H., Martin, L., Stone, K. R., Albert, P., Almahairi,
A., Babaei, Y ., Bashlykov, N., Batra, S., Bhargava, P.,
Bhosale, S., Bikel, D. M., Blecher, L., Ferrer, C. C.,
Chen, M., Cucurull, G., Esiobu, D., Fernandes, J., Fu,
J., Fu, W., Fuller, B., Gao, C., Goswami, V ., Goyal, N.,
Hartshorn, A. S., Hosseini, S., Hou, R., Inan, H., Kardas,
M., Kerkez, V ., Khabsa, M., Kloumann, I. M., Korenev,
A. V ., Koura, P. S., Lachaux, M.-A., Lavril, T., Lee, J.,
Liskovich, D., Lu, Y ., Mao, Y ., Martinet, X., Mihaylov, T.,
Mishra, P., Molybog, I., Nie, Y ., Poulton, A., Reizenstein,
J., Rungta, R., Saladi, K., Schelten, A., Silva, R., Smith,
12
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
E. M., Subramanian, R., Tan, X., Tang, B., Taylor, R.,
Williams, A., Kuan, J. X., Xu, P., Yan, Z., Zarov, I.,
Zhang, Y ., Fan, A.,","[-0.0156077416613698, 0.028454216197133064, 0.02184031903743744, -0.025429969653487206, -0.009841950610280037, 0.025982223451137543, -0.0014061102410778403, 0.03813180327415466, -0.047967180609703064, 0.0408930741250515, 0.017961394041776657, -0.045284803956747055, -0.022418871521949768, 0.014805659651756287, -0.013076579198241234, 0.0013272168580442667, 0.02619260549545288, -0.01647556945681572, 0.007718403358012438, 0.050202492624521255, 0.010788670741021633, -0.016515016555786133, -0.02326040156185627, 0.028717193752527237, 0.05306895449757576, 0.016804290935397148, -0.010584862902760506, 0.04147162288427353, 0.015463104471564293, -0.02884868159890175, 0.07284489274024963, -0.02887498028576374, -0.02853310853242874, -0.010427076369524002, -0.01672539860010147, 0.021551044657826424, 0.04573186859488487, 0.02803345024585724, -0.027270814403891563, 0.03271446004509926, 0.004868379328399897, -0.06227318197488785, -0.01045994833111763, 0.0525955930352211, -0.00736338272690773, 0.027034133672714233, 0.030689528211951256, 0.0050097303465008736, 0.0009352153865620494, 0.054857201874256134, -0.024956608191132545, 0.011110818944871426, -0.027165623381733894, -0.001645255833864212, -0.05049176886677742, -0.03297743573784828, -0.003445011330768466, 0.024391205981373787, 0.0025459553580731153, -0.018408456817269325, -0.02771787717938423, -0.04441697895526886, -0.00027633231366053224, 0.03421343117952347, -0.034660495817661285, -0.011656498536467552, -0.03526534512639046, 0.014687319286167622, -0.01964445412158966, 0.011912901885807514, -0.011676221154630184, -0.009421185590326786, 0.011590753681957722, -0.03213590756058693, -0.019775941967964172, 0.017737863585352898, -0.017093567177653313, 0.08746647089719772, -0.025324778631329536, -0.04065639153122902, 0.009237101301550865, -0.004536369815468788, 0.009789355099201202, -0.034187134355306625, -0.03253037482500076, -0.01683058962225914, -0.020144112408161163, -0.01232051756232977, -0.02022300474345684, -0.004960421938449144, -0.010335033759474754, -0.024614736437797546, -0.021906064823269844, -0.0017816757317632437, 0.08094462007284164, 0.03003208339214325, 0.01232051756232977, -0.021209172904491425, 0.043312471359968185, 0.05422605574131012, -0.013326408341526985, 0.023299846798181534, 0.02571924403309822, -0.024614736437797546, 0.021814022213220596, -0.03355598822236061, 0.003247777931392193, -0.048098668456077576, -0.015305317007005215, 0.02874349057674408, -0.11444801092147827, -0.014555830508470535, 0.010387629270553589, -0.002399673918262124, 0.021919213235378265, -0.07300268113613129, -0.022497763857245445, 0.03216220438480377, -0.007475148420780897, -0.00830352958291769, -0.0035896492190659046, 0.021248620003461838, 0.044232893735170364, -0.0027809918392449617, 0.016081102192401886, -0.004901251755654812, 0.0035469152498990297, -0.028612002730369568, 0.03702729567885399, -0.014621574431657791, 0.006364066619426012, -0.011965497396886349, 0.027796771377325058, -0.022392572835087776, -0.025456266477704048, -0.01988113485276699, -0.03334560617804527, -0.010768947191536427, -0.02874349057674408, 0.0014126847963780165, 0.03423973172903061, -0.009513228200376034, -0.03752695396542549, 0.02115657739341259, -0.050912532955408096, 0.017961394041776657, -0.009072739630937576, 0.0015449955826625228, -0.03731657192111015, 0.005183952860534191, -0.012905643321573734, -0.03171514347195625, -0.027270814403891563, 0.012346815317869186, -0.04870351776480675, -0.05036028102040291, -0.022392572835087776, 0.06542892009019852, 0.060484930872917175, -0.05738179013133049, 0.020499132573604584, 0.06569189578294754, -0.017225056886672974, 0.032793350517749786, 0.04686267301440239, 0.04604744166135788, -0.025692947208881378, 0.0007034660666249692, -0.05853889510035515, -0.05596170946955681, -0.006189843639731407, -0.022142743691802025, -0.02640298753976822, -0.03915742039680481, -0.009085888974368572, -0.03707989305257797, -0.045389994978904724, -0.033845264464616776, -0.029506128281354904, -0.05806553363800049, -0.013819491490721703, 0.03481828048825264, -0.02921685203909874, 0.017803607508540154, -0.05985378473997116, -0.009881396777927876, -0.005052464082837105, 0.03881554678082466, 0.009717036038637161, 0.050097301602363586, -0.012662389315664768, 0.04368063807487488, 0.08062904328107834, 0.021695682778954506, 0.019210539758205414, -0.009283121675252914, 0.05330563336610794, -0.013635407201945782, 0.021182874217629433, -0.02700783684849739, 0.024141376838088036, 0.048098668456077576, -0.0069491928443312645, -0.05049176886677742, 0.025614053010940552, 0.00013960432261228561, -0.0035469152498990297, -0.0005415702471509576, -0.024719929322600365, -0.023299846798181534, 0.04112975299358368, 0.028690895065665245, 0.015081786550581455, -0.0007186694419942796, -0.022024404257535934, 0.002863172674551606, -0.06442960351705551, -0.002593620214611292, -0.001753734308294952, 0.025298479944467545, 0.0036751169245690107, 0.022155893966555595, 0.008007679134607315, 0.009059591218829155, -0.03544943034648895, 0.020420238375663757, 0.004385157488286495, -0.04268132150173187, 0.04044600948691368, -0.0023980303667485714, 0.04930836707353592, -0.013635407201945782, -0.009546100161969662, -0.03308262676000595, -0.016383526846766472, -0.030689528211951256, 0.0170541200786829, -0.023694314062595367, 0.0009606913663446903, -0.03016357310116291, 0.012064114212989807, 0.027323409914970398, -0.002863172674551606, 0.005345026962459087, -0.00035604750155471265, 0.042707622051239014, -0.017685268074274063, -0.04607373848557472, 0.030663229525089264, 0.020262451842427254, 0.009269973263144493, -0.0170541200786829, -0.017619524151086807, -0.009454057551920414, -0.012524325400590897, 0.016672803089022636, -0.030715826898813248, -0.019815389066934586, -0.034897174686193466, -0.005354888737201691, -0.031268078833818436, 0.05774996057152748, -0.0016403250629082322, 0.025101246312260628, 0.004109030589461327, 0.0060484930872917175, -0.061431653797626495, 0.03660653159022331, 0.005315442103892565, -0.004312838427722454, 0.02583758533000946, -0.015712933614850044, 0.007231893949210644, 0.001236818265169859, -0.07037290185689926, -0.014766212552785873, 0.03589649125933647, 0.03179403394460678, -0.04126124083995819, 0.036396149545907974, 0.017435438930988312, 0.031136590987443924, 0.04076158255338669, 0.01868458464741707, 0.0006788118625991046, 0.023312997072935104, -0.0007445563678629696, -0.015476252883672714, -0.028322726488113403, -0.008836059831082821, 0.04675748199224472, 0.016304634511470795, 0.007291064132004976, -0.03742176294326782, 0.022379424422979355, -7.375710265478119e-05, 0.02969021163880825, 0.019683901220560074, 0.029663914814591408, -0.05051806569099426, 0.04173460230231285, -0.0055685583502054214, -0.006087939720600843, 0.0006463504978455603, -0.006472545210272074, 0.06637563556432724, -0.042129069566726685, -0.0240887813270092, 0.02385210059583187, 0.005818387493491173, 0.0059433020651340485, -0.021708831191062927, -0.01693578064441681, 0.009769631549715996, -0.033135224133729935, -0.026850050315260887, 0.013530216179788113, -0.03684321418404579, 0.0322410985827446, -0.040156733244657516, -0.034318625926971436, -0.025101246312260628, -0.016804290935397148, -0.0033891284838318825, 0.007659233175218105, 0.03413454070687294, -0.010315310209989548, -0.009302845224738121, -0.024562140926718712, -0.02535107545554638, 0.030242465436458588, 0.008974122814834118, 0.03807920962572098, -0.013411875814199448, -0.01600220985710621, -0.02769158035516739, -0.05438384413719177, 0.04183979332447052, 0.04310208931565285, 0.0011628556530922651, -0.07321306318044662, 0.03836848586797714, -0.03339819982647896, 0.012780728749930859, -0.006650055292993784, 0.03268815949559212, 0.0008760453201830387, 0.021472150459885597, 0.07484352588653564, 0.020407089963555336, 0.013503918424248695, -0.05107032135128975, 0.030821017920970917, 0.011669646948575974, -0.006028770003467798, 0.017803607508540154, -0.022708147764205933, -0.006416662130504847, 0.009427759796380997, 0.015029190108180046, -0.032425183802843094, 0.029243148863315582, 0.020380791276693344, -0.0034515857696533203, -0.038052912801504135, 0.016041655093431473, -0.009841950610280037, 0.03305632993578911, -0.0008974123047664762, -0.03129437938332558, 0.01634407974779606, 0.040261924266815186, -0.008573081344366074, 0.02419397234916687, -0.022142743691802025, -0.0040367115288972855, 0.0005017126677557826, 0.005285857245326042, -0.009914268739521503, 0.03642244637012482, 0.03176773712038994, 0.008198337629437447, -0.004404881037771702, -0.002028217539191246, -0.02840162068605423, 0.02795455791056156, -0.002619917970150709, -0.0015260940417647362, 0.027428600937128067, 0.00940803624689579, -0.0009976726723834872, -0.013405301608145237, -0.05338452756404877, 0.03216220438480377, 0.02887498028576374, 0.0016781281447038054, 0.005358175840228796, 0.0040268502198159695, 0.028086045756936073, 0.022471467033028603, -0.0003359132679179311, -0.0002305166271980852, -0.01425340585410595, -0.02301057241857052, 0.024154525250196457, 0.04507442191243172, 0.04638931155204773, 0.06795350462198257, 0.013753747567534447, 0.01834271289408207, 0.04815126582980156, -0.038631461560726166, 0.019118497148156166, -0.020025771111249924, 0.009532950818538666, -0.04381212964653969, 0.00771182868629694, 0.002830300247296691, 0.03445011377334595, 0.05575132742524147, -0.033030033111572266, -0.026495030149817467, -0.04404880851507187, -0.06043233722448349, -0.029190553352236748, -0.005940014496445656, 0.020854152739048004, -0.05270078405737877, 0.012576920911669731, -0.02795455791056156, -0.010374480858445168, -0.0017800320638343692, 0.03166254609823227, -0.00041912111919373274, -0.019420921802520752, -0.04780939221382141, 0.019894283264875412, 0.043549150228500366, 0.026718560606241226, -0.032661862671375275, -0.00031660081003792584, -0.011294903233647346, -0.030794719234108925, 0.0005259559256955981, -0.0030965656042099, -0.009973439387977123, -0.030452847480773926, 0.020841004326939583, 0.003622521413490176, -0.045652974396944046, 0.04055120050907135, -5.19792374689132e-05, 0.05548835173249245, 0.010433650575578213, -0.006459396332502365, -0.02853310853242874, 0.08641456067562103, -0.010315310209989548, 0.07179298251867294, -0.012287645600736141, 0.025863882154226303, 0.016436122357845306, -0.046573396772146225, -0.041550517082214355, 0.01811918243765831, 0.04031452164053917, 0.03074212372303009, 0.004750039428472519, 0.040735285729169846, -0.0018901540897786617, -0.001691277022473514, -0.01052569318562746, -0.03387156128883362, -0.03660653159022331, 0.02792825922369957, 0.01973649673163891, 0.009769631549715996, -0.048440542072057724, -0.00834954995661974, -0.03253037482500076, 0.02958502061665058, -0.051228106021881104, 0.003885499434545636, -0.004704018123447895, 0.005068900063633919, 0.0145032349973917, -0.018894966691732407, 0.0010362975299358368, -0.01810603216290474, 0.015726082026958466, 0.0028401620220392942, -0.017264503985643387, 0.04544259235262871, -0.014398043043911457, 0.015002892352640629, -0.015121232718229294, -0.037000998854637146, -0.06353547424077988, 0.0027464760933071375, -0.03892073780298233, 0.0023750197142362595, -0.03731657192111015, 0.006784831639379263, 0.02335244230926037, 0.0012146295048296452, -0.014529532752931118, 0.03644874691963196, 0.0028385184705257416, -0.00894125085324049, 0.03355598822236061, -0.014292852021753788, -0.008836059831082821, 0.019775941967964172, 0.03329300880432129, 0.019723346456885338, 0.03842107951641083, -0.042260557413101196, 0.02945353090763092, -0.0042602429166436195, 0.033135224133729935, 0.010137800127267838, -0.03563351556658745, 0.009901120327413082, -0.034660495817661285, 0.02255035936832428, -0.008757166564464569, -0.007323936093598604, -0.051385894417762756, -0.03213590756058693, 0.022721296176314354, 0.02081470564007759, 0.01285962201654911, 0.012945090420544147, -0.03305632993578911, -0.05199074372649193, -0.00725161749869585, -0.008776889182627201, -0.007646084297448397, -0.06826908141374588, -0.013858938589692116, 0.00598603580147028, 0.051359597593545914, 0.002067664172500372, 0.015857571735978127, -0.011853731237351894, -0.005992610473185778, 0.026008520275354385, -0.02884868159890175, 0.013254089280962944, 0.03061063401401043, 0.04780939221382141, -0.04549518600106239, -0.014739914797246456, -0.031478460878133774, 0.013162046670913696, -0.026850050315260887, 0.02336559258401394, 0.008264082483947277, 0.008632251992821693, -0.003073554951697588, 0.02349708043038845, -0.01765896938741207, 0.003767159301787615, -0.011906327679753304, -0.00824435893446207, -0.005384473595768213, -0.004243806935846806, -0.022300532087683678, 0.01566033810377121, 0.009736758656799793, -0.006577736232429743, -0.04588965326547623, 0.012885919772088528, 0.010867564007639885, 0.008296954445540905, -0.03889444097876549, -0.006314758211374283, 0.021432703360915184, -0.011360648088157177, 0.0006952479598112404, -0.04678377881646156, -0.008974122814834118, -0.004598827101290226, -0.006413375027477741, -0.022392572835087776, 0.0128530478104949, -0.02795455791056156, 0.008730868808925152, -0.03615947067737579, 1.1158585948578548e-05, 0.07074107229709625, -0.030110977590084076, -0.033371903002262115, -0.056277282536029816, -0.04773050174117088, -0.008987272158265114, 0.02583758533000946, -0.03718508407473564, -0.044837743043899536, 0.004838794469833374, 0.002753050532191992, -0.008388997055590153, -0.007376532070338726, -0.014674169942736626, -0.006903171539306641, -0.01694892905652523, -0.020643770694732666, 0.024825120344758034, -0.023326145485043526, -0.012728133238852024, -0.011123967356979847, -0.00372442533262074, 0.009894546121358871, -0.035344239324331284, -0.010131225921213627, 0.0027185347862541676, -0.030531741678714752, -0.012701835483312607, 0.040603797882795334, 0.0017800320638343692, 0.006212854292243719, -0.022418871521949768, 0.009795929305255413, 0.007402829825878143, 0.015870720148086548, 0.025153841823339462, 0.0005132179358042777, -0.017225056886672974, -0.03402934968471527, -0.0030291774310171604, -0.043891020119190216, -0.011498711071908474, 0.03355598822236061, 0.010900436900556087, -0.003504181280732155, 0.016541313380002975, -0.010144375264644623, -0.01542365737259388, 0.0008222170290537179, -0.04851943254470825, -0.008750591427087784, 0.010907011106610298, 0.005719770677387714, -0.023286698386073112, 0.003777021076530218, -0.002230381825938821, -0.00727134058251977, 0.021761426702141762, 0.0007975628250278533, -0.012734707444906235, -0.018908115103840828, -0.03587019443511963, 0.03132067620754242, 0.028086045756936073, 0.0285068117082119, -0.007790721952915192, 0.016396675258874893, -0.025219585746526718, -0.02336559258401394, 0.0008752235444262624, -0.05927523225545883, 0.023115763440728188, 0.009710460901260376, 0.013398727402091026, -0.02453584410250187, 0.04628412052989006, 0.017935097217559814, 0.04289170727133751, 0.0018359149107709527, -0.0257060956209898, 0.0030784858390688896, 0.002682375255972147, 0.013010834343731403, -0.010045758448541164, 0.0028270131442695856, -0.027297113090753555, 0.022655552253127098, -0.017198758199810982, 0.020748961716890335, 0.01589701697230339, -0.04909798502922058, 0.032083310186862946, -0.0661652535200119, -0.01308972854167223, 0.008816336281597614, 0.011354073882102966, 0.009664440527558327, 0.0134907690808177, 0.019079051911830902, 0.0003708400181494653, 0.0013157116482034326, -0.009835375472903252, -0.0033102352172136307, -0.022418871521949768, -0.006226003170013428, -0.018763476982712746, -0.012228474952280521, 0.05443643778562546, -0.021196024492383003, -0.11308052390813828, -0.009546100161969662, 0.010223268531262875, -0.051122914999723434, 0.0063410559669137, -0.02979540266096592, -0.007212170399725437, -0.03287224471569061, 0.020025771111249924, 0.04339136555790901, -0.03318781778216362, -0.03097880445420742, 0.0033036605454981327, -0.00385591434314847, 0.014292852021753788, -0.02982170134782791, 0.00876374077051878, 0.02700783684849739, 0.0011382014490664005, -0.010775522328913212, -0.029663914814591408, -0.05180665850639343, 0.005361463408917189, -0.00852706003934145, -0.003684978699311614, 0.006791405845433474, -0.026100562885403633, -0.02055172808468342, 0.015699785202741623, -0.0003482403408270329, 0.00429640244692564, 0.0044180299155414104, 0.015581443905830383, 0.015962762758135796, -0.0357913002371788, -0.013530216179788113, 0.005249697715044022, -0.048913899809122086, -0.011216009967029095, -0.03602797910571098, -0.011288329027593136, -0.015726082026958466, -0.013701152056455612, -0.015923315659165382, 0.037947721779346466, 0.001385565148666501, -0.0010971111478284001, 0.02466733194887638, 0.01821122318506241, 0.008053700439631939, 0.009145058691501617, -0.04010413959622383, 0.011216009967029095, 0.0089478250592947, 0.004753326531499624, -0.012576920911669731, -0.030452847480773926, 0.0278230682015419, -0.008494188077747822, -0.014818808063864708, 0.009421185590326786, 0.017356544733047485, -0.016081102192401886, -0.007632935419678688, 0.02068321593105793, 0.001559788011945784, -0.012458580546081066, -0.0004339136357884854, -0.011386945843696594, -0.02102508768439293, 0.05304265394806862, -0.0089478250592947, -0.008829484693706036, 0.009631567634642124, -0.015200125984847546, 0.011820859275758266, -0.0010962893720716238, -0.0017192184459418058, 0.04147162288427353, 0.008895229548215866, 0.0063114711083471775, -0.0269815381616354, -0.0006545686046592891, 0.0228133387863636, -0.019355177879333496, -0.027533791959285736, -0.03544943034648895, -0.05469941720366478, -0.006035344209522009, 0.00823121052235365, -0.03602797910571098, -0.04194498434662819, -0.00130831531714648, 0.020604323595762253, 0.009033293463289738, 0.015042339451611042, 0.043417662382125854, 0.001742228982038796, -0.08951769769191742, -0.04031452164053917, 0.007120128255337477, 0.015989059582352638, 0.00461526308208704, -0.0247725248336792, 0.021209172904491425, 0.012721559032797813, -0.0017488034209236503, -0.029137957841157913, 0.03084731474518776, 0.0017175747780129313, 0.004986719693988562, 0.008342975750565529, 0.021419554948806763, -0.07305527478456497, 0.02394414320588112, -0.035843897610902786, 0.059222638607025146, -0.01168937049806118, -0.03295113891363144, 0.018513647839426994, 0.0038098932709544897, 0.018382159993052483, -0.03468679264187813, -0.005604717880487442, 0.001250788918696344, 0.035239048302173615, -0.023891547694802284, 0.02803345024585724, -0.045994844287633896, -0.03857886791229248, -0.004648135509341955, 0.03807920962572098, -0.026955241337418556, 0.01087413914501667, -0.007810445502400398, -0.021787723526358604, -0.008191763423383236, -0.018053436651825905, -0.01836901158094406, -0.06122126802802086, 0.013392153196036816, -0.017488034442067146, 0.03865776211023331, 0.02093304507434368, 0.016870036721229553, 0.0016362160677090287, 0.0060715037398040295, -0.014976594597101212, 0.002031504875048995, 0.014950296841561794, -0.0009327499428763986, 0.03671172261238098, 0.01355651393532753, -0.011643349193036556, 0.003934807609766722, -0.021524745970964432, 0.03239888325333595, 0.045284803956747055, -0.004450901877135038, -0.0053055803291499615, -0.016567612066864967, -0.021288065239787102, -0.021892914548516273, -0.012004943564534187, -0.02278704009950161, 0.03026876412332058, -0.013431599363684654, -0.0519118495285511, -0.021524745970964432, 0.042576130479574203, 0.008967548608779907, -0.0067092254757881165, 0.013411875814199448, -0.002619917970150709, 0.008461316116154194, 0.04031452164053917, -0.01903960481286049, 9.932297871273477e-06, 0.011991795152425766, -0.025443118065595627, -0.015410508960485458, -0.00044213171349838376, -0.012583495117723942, 0.015108084306120872, -0.0009508297080174088, -0.0029946614522486925, -0.0037638721987605095, 0.052674487233161926, 0.031609952449798584, -0.0048026349395513535, 0.017921948805451393, -0.009486930444836617, 0.009624993428587914, 0.008362699300050735, 0.0027892100624740124, 0.022234786301851273, 0.028822384774684906, -0.013247515074908733, 0.04712565243244171, 0.06032714620232582, -0.07105664908885956, -0.017816757783293724, 0.01868458464741707, 0.011571030132472515, -0.0016666228184476495, -0.0018687871051952243, 0.010821542702615261, -0.004707305692136288, 0.011774837970733643, 0.008842634037137032, -0.013898385688662529, 0.013056855648756027, -0.0030242465436458588, 0.01222190074622631, 0.042602431029081345, 0.03187292814254761, 0.022879082709550858, 0.01074264943599701, -0.016515016555786133, 0.032451480627059937, -0.03037395514547825, -0.014398043043911457, -0.041760899126529694, -0.02301057241857052, -4.5122291339794174e-05, 0.016159996390342712, -0.03600168228149414, -0.017343396320939064, 0.020170409232378006, -0.0062062800861895084, -0.003635670291259885, -0.02360227145254612, -0.01731709949672222, 0.020065218210220337, -0.004013701342046261, 0.024404354393482208, -0.027638982981443405, 0.02955872379243374, 0.014240256510674953, -0.003162309993058443, 0.022524062544107437, -0.0007392145926132798, 0.02475937455892563, -0.012182453647255898, 0.003402277361601591, -0.045048125088214874, -0.008145742118358612, -0.01513438206166029, 0.03352969139814377, 0.011571030132472515, -0.03284594789147377, 0.027402304112911224, -0.001753734308294952, -0.014003576710820198, -0.016791142523288727, -0.041787199676036835, -0.018395308405160904, 0.03763214498758316, 0.02805974893271923, 0.04428548738360405, 0.000156348614837043, -0.028112344443798065, 0.02067006751894951, -0.026100562885403633, -0.016094250604510307, -0.022405723109841347, -0.03871035575866699, 0.00852706003934145, -0.003239559708163142, -0.020052069798111916, 0.04415399953722954, 0.022024404257535934, 0.0027497634291648865, 0.02289223112165928, 0.013937831856310368, -0.00230763154104352, 0.021445853635668755, 0.025272183120250702, 0.036054279655218124, 0.0069491928443312645, -0.030242465436458588, 0.006281886249780655, 0.011827433481812477, -0.002611699979752302, 0.001830984023399651, 0.0019641167018562555, 0.003382554044947028, 0.04659969359636307, 0.005252984818071127, 0.0128530478104949, -0.004717167001217604, 0.048677220940589905, -0.002590332878753543, -0.04604744166135788, 0.018053436651825905, 0.024575291201472282, -0.005953163839876652, -0.01754062995314598, 0.003282293677330017, 0.030768422409892082, -0.00922395195811987, 0.00572305778041482, -0.04765160754323006, 0.0024407641030848026, 0.010361331515014172, -0.021814022213220596, -0.006909745745360851, 0.034423816949129105, 0.008461316116154194, -0.003773733740672469, -0.023299846798181534, 0.031741440296173096, -0.014135065488517284, -0.02360227145254612, 0.02081470564007759, 0.001108616474084556, -0.02266870066523552, -0.008822910487651825, -0.030321359634399414, -0.021196024492383003, 0.010709777474403381, 0.011597327888011932, 0.0019378188299015164, 0.008014253340661526, -0.004838794469833374, -0.0001770992239471525, -0.015371061861515045, -0.007330510765314102, -0.012622942216694355, -0.003244490595534444, -8.063972927629948e-05, 0.004099168814718723, 0.010078630410134792, -0.015279019251465797, 0.01126860547810793, -0.004404881037771702, -0.009828801266849041, -0.0024128227960318327, 0.021340660750865936, 0.00438187038525939, 0.013260663487017155, 0.005535685922950506, 0.0031524482183158398, 0.01800084114074707, 0.022129595279693604, 0.020183559507131577, -0.006584310904145241, -0.009013569913804531, 0.013595961034297943, -0.007047809194773436, 0.01391153410077095, -0.005299006123095751, 0.031057696789503098, 0.006732235662639141, 0.018763476982712746, 0.05611949786543846, 0.019552411511540413, 0.05501499027013779, -0.024246567860245705, 0.033030033111572266, 0.018040288239717484, -0.014621574431657791, 0.00018942631140816957, -0.01548940222710371, -0.017225056886672974, -0.001942749717272818, 0.019894283264875412, 0.004470625426620245, -0.050071004778146744, 0.014674169942736626, 0.009355440735816956, 0.028559407219290733, 0.0025886893272399902, -0.025285331532359123, -0.00027468870393931866, -0.007429127581417561, 0.02080155722796917, 0.024733077734708786, -0.029164256528019905, -0.032767053693532944, 0.004973570816218853, -0.011012202128767967, 0.013832640834152699, 0.0074685742147266865, -0.04591595381498337, -0.021682532504200935, 0.03755325451493263, -0.03729027509689331, -0.01116998866200447, 0.011807710863649845, -0.012780728749930859, -0.006298322230577469, -0.017225056886672974, 0.0058249616995453835, 0.0012203820515424013, -0.00011916188668692484, 0.030005784705281258, -0.027638982981443405, 0.018290117383003235, 0.030479146167635918, 0.006232577841728926, -0.029032766819000244, 0.0050491769798099995, 0.003259283024817705, 0.0015795114450156689, -0.04615263268351555, -0.007922210730612278, 0.010893861763179302, -0.025863882154226303, 0.03868405893445015, 0.01576552912592888, -0.00021901133004575968, -0.00028352311346679926, 0.0021120416931807995, -0.010045758448541164, -0.03668542578816414, 0.008178615011274815, 0.012478304095566273, 0.0065744491294026375, 0.011301478371024132, 0.010394204407930374, -0.007488297298550606, -0.001325573306530714, 0.0005243123159743845, 0.010854415595531464, -0.023286698386073112, 0.03350339084863663, 0.018276968970894814, 0.017382843419909477, -0.00840872060507536, -0.005739494226872921, 0.021432703360915184, -0.0182375218719244, 0.008106295950710773, -0.021248620003461838, -0.0002282566565554589, 0.014490085653960705, -0.017829906195402145, 0.050886236131191254, 0.01425340585410595, -0.012261347845196724, 0.008033976890146732, -0.017093567177653313, 0.0018901540897786617, -0.01988113485276699, -0.0009294627234339714, 0.01309630274772644, -0.017093567177653313, 0.06979434937238693, -0.0185793936252594, -0.003655393607914448, 0.006600746884942055, -0.018329564481973648, 0.04988691955804825, -0.02232682891190052, 0.01566033810377121, -0.020985640585422516, 0.020380791276693344, 0.0036586809437721968, 0.029243148863315582, -0.02653447724878788, -0.02441750466823578, 0.03713248670101166, -0.018513647839426994, -0.015555146150290966, 0.002248461591079831, 0.004960421938449144, 0.01940777339041233, 0.034318625926971436, 0.043654341250658035, -0.011985220946371555, -0.012235050089657307, -0.013582811690866947, 0.012912217527627945, 0.008224635384976864, 0.009421185590326786, 0.027428600937128067, 0.06053752824664116, -0.013714300468564034, -0.030295060947537422, -0.04999211058020592, 0.0010247922036796808, -0.011551306582987309, 0.023418188095092773, -0.018855519592761993, 0.023168358951807022, -0.0285068117082119, -0.003165597328916192, 0.002159706549718976, -0.021945510059595108, -0.018382159993052483, 0.009795929305255413, -0.01437174528837204, -0.00024099464644677937, -0.023904696106910706, 0.0014266554499045014, -0.006784831639379263, -0.013221217319369316, -0.015739230439066887, -0.008691421709954739, -0.004766475409269333, -0.009250249713659286, -0.007764424197375774, -0.010249566286802292, 0.001174360979348421, 0.05448903515934944, 0.02594277635216713, 0.026573922485113144, -0.029847998172044754, 0.008783464320003986, -0.024838268756866455, 0.00869799591600895, -0.006623757537454367, -0.03673802316188812, -0.031978119164705276, -0.011853731237351894, 0.011130542494356632, 0.05146478861570358, 0.0012770866742357612, 0.007751275319606066, 0.005095197819173336, -0.010650607757270336, 0.004447614774107933, -0.0007383928168565035, 0.003816467709839344, 0.010913585312664509, 0.02444380149245262, 0.05669805034995079, -0.03694840520620346, 0.01374059822410345, -0.03271446004509926, 0.03807920962572098, 0.018079735338687897, -0.005032740533351898, 0.012997685931622982, -0.024259716272354126, -0.006015620660036802, 0.009342292323708534, -0.0007963301613926888, -0.0013551582815125585, 0.03521274775266647, 0.024259716272354126, -0.008632251992821693, -0.00981565285474062, -0.010361331515014172, -0.009434334002435207, 0.018500499427318573, -0.001325573306530714, -0.015502550639212132, -0.01637037843465805, -0.022116446867585182, -0.002988087013363838, -0.01151186041533947, 0.003777021076530218, -0.035370536148548126, -0.014003576710820198, 0.001742228982038796, 0.020144112408161163, 0.000936858996283263, -0.010242992080748081, 0.04404880851507187, 0.008158891461789608, 0.019683901220560074, 0.008540209382772446, 0.0031458737794309855, 0.005384473595768213, -0.003642244730144739, -0.02663966827094555, 0.026600221171975136, -0.010085204616189003, 0.03589649125933647, 0.0037901699542999268, -0.011071371845901012, -0.018789775669574738, 0.015357913449406624, -0.015555146150290966, 0.00034803489688783884, -0.0023322857450693846, -0.01800084114074707, -0.02232682891190052, 0.0028467364609241486, -0.006758533418178558, 0.032083310186862946, 0.03602797910571098, 0.01801398955285549, -0.022497763857245445, -0.026218902319669724, 0.0006118346937000751, 0.019223688170313835, 0.030084678903222084, 0.012064114212989807, 0.04744122549891472, 0.01893441379070282, -0.02244516834616661, -0.0021383394487202168, -0.021130278706550598, -0.005203676410019398, -0.020709514617919922, -0.018040288239717484, 0.011058223433792591, -0.007475148420780897, -0.0007926319958642125, 0.01214958168566227, -0.02220848947763443, -0.007521169725805521, -0.021906064823269844, 0.0022090149577707052, -0.01425340585410595, 0.008402145467698574, 0.018881818279623985, 0.0034713090863078833, 0.026245201006531715, 0.031978119164705276, -0.027402304112911224, -0.04678377881646156, 0.03182033449411392, 0.021366959437727928, -0.0019213827326893806, -0.009953715838491917, 0.011544732376933098, -0.011531583964824677, -0.018408456817269325, -0.01472676545381546, -0.0145032349973917, 0.0006964806816540658, -0.0028368746861815453, -0.0006192309083417058, -0.01408246997743845, -0.005206963513046503, 0.002268184907734394, 0.010137800127267838, -0.0012088768417015672, -0.03923631086945534, -0.002593620214611292, 0.0025607480201870203, 0.0042668175883591175, -0.01684373803436756, -0.019789092242717743, -0.001776744844391942, -0.009026718325912952, 0.019105348736047745, 0.013530216179788113, 0.0023848814889788628, 0.019828537479043007, -0.00022106585674919188, 0.03132067620754242, 0.05985378473997116, 0.009657865390181541, 0.012070688419044018, -0.030321359634399414, 0.006025482434779406, 0.003747435985133052, -0.008224635384976864, 0.029059065505862236, 0.010196970775723457, 0.018040288239717484, -0.013194919563829899, -0.025561457499861717, -0.005861121229827404, -0.04052490368485451, 0.007330510765314102, -0.012077262625098228, 0.01513438206166029, -0.02210329845547676, -0.010381055064499378, 0.003928233403712511, -0.048440542072057724, -0.024391205981373787, -0.008882081136107445, 0.015449955128133297, 0.01986798457801342, 0.005088623613119125, -0.017606373876333237, 0.01825067028403282, -0.00020072615006938577, -0.016041655093431473, 0.008882081136107445, 0.04220796376466751, -0.009572397917509079, 0.00912533514201641, 0.017856203019618988, -0.004115605261176825, -0.002633066847920418, -0.01496344618499279, 0.01821122318506241, 0.004023562651127577, 0.022694997489452362, 0.02666596509516239, -0.0033431074116379023, 0.018750328570604324, 0.016870036721229553, 0.04899279400706291, -0.04865092411637306, 0.07252932339906693, 0.03899963200092316, 0.039578184485435486, -0.05146478861570358, 0.023694314062595367, -0.009375164285302162, 0.019960027188062668, 0.012379687279462814, -0.024128228425979614, -0.002128477906808257, -0.04333876818418503, -0.014398043043911457, -0.021643085405230522, 0.001967403804883361, 0.004894677549600601, 0.0019953453447669744, -0.017711564898490906, 0.01134092453867197, 0.007843317463994026, -0.04507442191243172, 0.05062325671315193, -0.01197864580899477, 0.028953874483704567, -0.005299006123095751, -0.011018776334822178, 0.00830352958291769, -0.01116341445595026, -0.001745516201481223, -0.014108767732977867, -0.00034680217504501343, 0.03694840520620346, -0.007770998869091272, -0.008744017221033573, 0.015634039416909218, -0.03281965106725693, 0.020893599838018417, 0.007968232035636902, -0.019144795835018158, -0.009526376612484455, 0.012583495117723942, -0.001622245297767222, -0.016751695424318314, -0.024719929322600365, 0.021366959437727928, 0.015094934962689877, -0.015726082026958466, 0.003441723994910717, 0.02874349057674408, -0.04018303379416466, 0.01309630274772644, 0.0015647188993170857, -0.009131909348070621, -0.024259716272354126, 0.009342292323708534, 0.047625310719013214, -0.031057696789503098, -0.02453584410250187, 0.0032658574637025595, 0.029295744374394417, 0.010026034899055958, 0.04199758172035217, -0.00870457012206316, 0.016883185133337975, -0.0265476256608963, 0.00865854974836111, -0.01623888872563839, 0.015410508960485458, -0.017856203019618988, 0.014384894631803036, 0.012971388176083565, 0.007501446176320314, -0.0038033188320696354, 0.022142743691802025, -0.00043268094304949045, 0.03658023476600647, 0.00044459712808020413, -0.004079445730894804, 0.0054337820038199425, 0.015712933614850044, 0.017159312963485718, 0.0007860575569793582, -0.01669909991323948, 0.03739546611905098, 0.04725714027881622, 0.008027402684092522, 0.029164256528019905, -0.0029042628593742847, 0.005594856105744839, 0.009697312489151955, -0.009427759796380997, -0.0033431074116379023, 0.0035403408110141754, 0.0048026349395513535, 0.04801977425813675, -0.025771839544177055, -0.03892073780298233, 0.0037572975270450115, 0.007606637664139271, -0.013858938589692116, -0.012307368218898773, -0.02268184907734394, -0.00115381577052176, 0.007028086110949516, -0.01973649673163891, 0.004286540672183037, 0.04815126582980156, 0.023076316341757774, 0.02805974893271923, -0.022274233400821686, 0.007126702927052975, 0.0247725248336792, 0.008507337421178818, -0.029532425105571747, -0.039788566529750824, -0.006508704740554094, -0.030689528211951256, -0.018631989136338234, 0.02210329845547676, 0.0123862624168396, 0.0185793936252594, 0.02958502061665058, -0.008027402684092522, -0.01976279355585575, -0.019578710198402405, -0.01928943395614624, -0.022366276010870934, 0.01988113485276699, 0.011426392011344433, 0.003767159301787615, -0.0341082401573658, -0.019105348736047745, -0.013004260137677193, -0.023668017238378525, -0.008323252201080322, -0.0011949060717597604, 0.020472833886742592, -0.014463787898421288, 0.025153841823339462, -0.0157786775380373, -0.008441592566668987, 0.026100562885403633, 0.009105611592531204, 0.015463104471564293, -0.003242847044020891]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" Kambadur, M., Narang, S., Rodriguez,
A., Stojnic, R., Edunov, S., and Scialom, T. Llama 2:
Open foundation and fine-tuned chat models. ArXiv ,
abs/2307.09288, 2023b.
Varshney, N., Chatterjee, A., Parmar, M., and Baral, C.
Accelerating llama inference by enabling intermediate
layer decoding via instruction tuning with lite. ArXiv ,
abs/2310.18581, 2023.
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones,
L., Gomez, A. N., Kaiser, L., and Polosukhin, I. Attention
is all you need. In NeurIPS , pp. 5998–6008, 2017.
Wang, H., Wang, Y ., Liu, T., Zhao, T., and Gao, J. Hadskip:
Homotopic and adaptive layer skipping of pre-trained
language models for efficient inference. In EMNLP , pp.
4283–4294, 2023.
Wang, J., Chen, K., Chen, G., Shou, L., and McAuley, J.
Skipbert: Efficient inference with shallow layer skipping.
InACL, 2022.
Xiao, G., Lin, J., Seznec, M., Wu, H., Demouth, J., and Han,
S. SmoothQuant: Accurate and efficient post-training
quantization for large language models. In ICML , volume
202, pp. 38087–38099, 2023.
Xin, J., Tang, R., Lee, J., Yu, Y ., and Lin, J. Deebert:
Dynamic early exiting for accelerating BERT inference.
InACL, pp. 2246–2251, 2020.
Xin, J., Tang, R., Yu, Y ., and Lin, J. Berxit: Early exiting for
BERT with better fine-tuning and extension to regression.
InEACL , pp. 91–104, 2021.
Xu, C. and McAuley, J. J. A survey on dynamic neural
networks for natural language processing. In EACL , pp.
2325–2336, 2023.
Yang, F., Peng, S., Sun, N., Wang, F., Tan, K., Wu, F.,
Qiu, J., and Pan, A. Holmes: Towards distributed train-
ing across clusters with heterogeneous nic environment.
ArXiv , abs/2312.03549, 2023.
Yao, Z., Aminabadi, R. Y ., Zhang, M., Wu, X., Li, C., and
He, Y . Zeroquant: Efficient and affordable post-training
quantization for large-scale transformers. In NeurIPS ,
2022.
Yuan, B., He, Y ., Davis, J., Zhang, T., Dao, T., Chen, B.,
Liang, P., R ´e, C., and Zhang, C. Decentralized training
of foundation models in heterogeneous environments. In
NeurIPS , 2022.Zeng, D., Du, N., Wang, T., Xu, Y ., Lei, T., Chen, Z., and
Cui, C. Learning to skip for language modeling. ArXiv ,
abs/2311.15436, 2023.
Zhang, B. and Sennrich, R. Root mean square layer normal-
ization. In NeurIPS , pp. 12360–12371, 2019.
Zhang, S., Roller, S., Goyal, N., Artetxe, M., Chen, M.,
Chen, S., Dewan, C., Diab, M. T., Li, X., Lin, X. V .,
Mihaylov, T., Ott, M., Shleifer, S., Shuster, K., Simig,
D., Koura, P. S., Sridhar, A., Wang, T., and Zettlemoyer,
L. Opt: Open pre-trained transformer language models.
ArXiv , abs/2205.01068, 2022.
Zhao, W. X., Zhou, K., Li, J., Tang, T., Wang, X., Hou, Y .,
Min, Y ., Zhang, B., Zhang, J., Dong, Z., Du, Y ., Yang,
C., Chen, Y ., Chen, Z., Jiang, J., Ren, R., Li, Y ., Tang,
X., Liu","[-0.01682651787996292, 0.032154422253370285, 0.018732646480202675, -0.009031107649207115, 0.020927980542182922, 0.01762840524315834, -0.021743014454841614, 0.059103142470121384, -0.06062804535031319, 0.017773007974028587, 0.02889428474009037, -0.0021821889095008373, -0.05092650651931763, 0.025791896507143974, 0.0005077532841823995, 0.010766342282295227, 0.01800963096320629, -0.008110906928777695, 0.01578800566494465, 0.05431810021400452, -0.01485465932637453, -0.022978711873292923, -0.021966492757201195, 0.011515648104250431, 0.052582867443561554, 0.006651732604950666, 0.004867201671004295, 0.016616186127066612, 0.012547586113214493, -0.035440851002931595, 0.021874472498893738, -0.03252250328660011, -0.03638734295964241, -0.033547867089509964, -0.02529235929250717, 0.023083878681063652, -0.00030317308846861124, -9.628210682421923e-05, -0.03483615070581436, -0.010122201405465603, -0.0005780007340945303, -0.07214369624853134, -0.019113872200250626, 0.02420126460492611, -0.0036150719970464706, 0.022176824510097504, 0.010766342282295227, 0.015341050922870636, 0.013645254075527191, 0.07761231064796448, -0.02776375412940979, 0.008038605563342571, -0.04456397891044617, -0.0227026529610157, -0.0446428544819355, 0.003779393620789051, 0.007295872550457716, 0.010220794938504696, 0.025897061452269554, -0.01983688585460186, -0.006395391188561916, -0.054949093610048294, -0.0042822170071303844, 0.029630444943904877, -0.00800574105232954, -0.03120793029665947, -0.05568525567650795, 0.007243289612233639, -0.0022429879754781723, 0.007006667088717222, -0.017746716737747192, 0.011561657302081585, -0.005314155947417021, -0.024017224088311195, -0.0029216355178505182, 0.027264216914772987, -0.007368173915892839, 0.11557713896036148, -0.0010582301765680313, -0.03444177657365799, 0.010536291636526585, 0.012376692146062851, 0.01682651787996292, -0.054423265159130096, -0.043696362525224686, -0.03757045790553093, -0.021282915025949478, 0.025791896507143974, -0.03357416018843651, -0.00897852424532175, -0.007499631494283676, -0.01323773618787527, -0.03757045790553093, -0.013605816289782524, 0.07345826178789139, 0.019429368898272514, 0.037754498422145844, -0.019797449931502342, 0.0444062314927578, 0.014184228144586086, -0.012094059027731419, 0.020007779821753502, 0.024990007281303406, -0.03693946450948715, 0.006539993919432163, -0.03588780760765076, -0.021440664306282997, -0.018719499930739403, -0.024621926248073578, 0.021756161004304886, -0.08665656298398972, -0.0023826612159609795, -0.010411407798528671, -0.023649144917726517, -0.004775181412696838, -0.06267877668142319, -0.030787268653512, -0.01907443441450596, -0.016721351072192192, 0.017102576792240143, -0.011975747533142567, 0.006707601714879274, 0.04009443521499634, 0.030156273394823074, 0.013697836548089981, -0.033074621111154556, 0.007473339792340994, -0.04301278293132782, -0.01940307766199112, -0.01698426529765129, -0.007755972910672426, 0.0004272357909940183, 0.05368710681796074, -0.038622114807367325, -0.0202706940472126, -0.03843807429075241, -0.016050919890403748, 0.016484728083014488, -0.04679875075817108, -0.02797408401966095, 0.03883244842290878, -0.02178245224058628, -0.030419187620282173, 0.006556426174938679, -0.05810406804084778, 0.011883728206157684, -0.007986023090779781, 0.0008618660503998399, -0.039857812225818634, 0.022558050230145454, -0.009031107649207115, -0.010687467642128468, -0.03583522513508797, 0.0016826516948640347, -0.05087392404675484, -0.018732646480202675, -0.020454734563827515, 0.040672846138477325, 0.05416035279631615, -0.046115174889564514, 0.013066842220723629, 0.052845779806375504, 0.0125081492587924, 0.0036939464043825865, 0.0472194142639637, 0.022071657702326775, -0.03854323923587799, -0.001068911049515009, -0.05421293526887894, -0.07093428820371628, -0.003825403517112136, -0.01961340941488743, 0.00011861955135827884, -0.02484540455043316, -0.0023908771108835936, -0.017562678083777428, -0.013750419951975346, -0.059208307415246964, -0.019389931112527847, -0.03428402915596962, -0.0009119840688072145, 0.022899838164448738, -0.03218071535229683, 0.015603965148329735, -0.045037224888801575, -0.0041639055125415325, -0.0015626971144229174, 0.03736012801527977, 0.027895210310816765, 0.063625268638134, -0.026107393205165863, 0.03241733834147453, 0.07556157559156418, 0.02054675482213497, 0.021690431982278824, -0.014618037268519402, 0.052425116300582886, -0.028552496805787086, 0.014236810617148876, -0.034099988639354706, -0.005172839388251305, 0.046167757362127304, 0.008557861670851707, -0.06183744966983795, 0.01973172090947628, -0.019284766167402267, 0.005922145210206509, -0.012790782377123833, -0.0377282053232193, -0.0444062314927578, 0.036676548421382904, 0.0538974367082119, 0.056579165160655975, 0.00251247501000762, -0.03693946450948715, 0.0078085558488965034, -0.05721015855669975, 0.005761110223829746, -0.00668459665030241, 0.02119089476764202, 0.015117574483156204, -0.007098686881363392, 0.02215053327381611, 0.025318650528788567, -0.03173375874757767, 0.017588969320058823, 0.019534535706043243, -0.02715905010700226, 0.043959274888038635, 0.0005841627717018127, 0.05983930081129074, -0.011620813049376011, -0.00953721720725298, -0.02392520383000374, 0.004969080910086632, -0.013842439278960228, 0.030708393082022667, -0.028710244223475456, -0.0028559069614857435, -0.05810406804084778, -0.0022331285290420055, 0.018101651221513748, 0.011706260964274406, 0.009563508443534374, 0.026015372946858406, 0.040935762226581573, -0.03331124410033226, -0.085184246301651, 0.04351232200860977, 0.001973500708118081, -0.003293002024292946, 0.0006572858546860516, -0.01622181385755539, -0.00790057610720396, -0.020822815597057343, -0.010996391996741295, -0.020349569618701935, -0.02328106388449669, -0.03843807429075241, 0.010181357152760029, -0.03099760040640831, 0.015235885046422482, 0.006500557065010071, 0.010924090631306171, 0.005777542479336262, -0.03617701306939125, -0.0497959740459919, 0.03725495934486389, 0.0077494001016020775, -0.030524354428052902, 0.022137386724352837, -0.011219869367778301, -0.0038155443035066128, -0.0012332325568422675, -0.06162711977958679, 0.005744677968323231, 0.02673838660120964, 0.034362904727458954, -0.05568525567650795, 0.0014871092280372977, 0.002652148250490427, 0.02920978143811226, 0.058682478964328766, 0.02275523543357849, -0.00557707017287612, 8.529310434823856e-05, -0.008952233009040356, -0.020927980542182922, -0.04048880562186241, -0.008176635950803757, 0.02991965040564537, 0.006934365723282099, 0.004548417869955301, -0.030629519373178482, 0.037070922553539276, 0.014657474122941494, 0.03586151450872421, -0.0104574179276824, 0.02543696202337742, -0.039962977170944214, 0.04448510333895683, 0.0012406270252540708, 0.010720332153141499, 0.01267247088253498, 0.010017036460340023, 0.03951602429151535, -0.022991858422756195, 0.020020926371216774, 0.016997411847114563, -0.008202927187085152, -0.0008421474485658109, 0.005419321823865175, -0.024595635011792183, 0.02378060109913349, -0.023478249087929726, -0.009346604347229004, 0.012034903280436993, -0.04222404211759567, 0.03270654380321503, -0.030682101845741272, -0.02807925082743168, -0.01800963096320629, -0.0356774739921093, 0.008939087390899658, -0.002464821795001626, 0.03578263893723488, -0.0035526298452168703, -0.007946585305035114, 0.008860212750732899, -0.03094501607120037, 0.017155159264802933, 0.023267919197678566, 0.023898912593722343, -0.0014994333032518625, -0.025515835732221603, -0.014355122111737728, -0.046325504779815674, 0.02884170226752758, 0.042986493557691574, -0.001973500708118081, -0.0621003657579422, 0.008603871800005436, -0.0049427892081439495, 0.0037991120480000973, -0.0058136931620538235, 0.0035263383761048317, -0.0013778354041278362, 0.01449972577393055, 0.04416960850358009, 0.026869844645261765, 0.013342902064323425, -0.04716683179140091, 0.02786891907453537, -0.028920575976371765, 0.02905203402042389, 0.038569532334804535, 0.013428349047899246, -0.023386230692267418, -0.012600169517099857, 0.005534346681088209, -0.0029216355178505182, 0.005215562880039215, 0.029551571235060692, -0.0016448578098788857, -0.0029528564773499966, -0.008557861670851707, 0.005212276708334684, 0.01085836160928011, -0.014407705515623093, -0.02760600484907627, 0.012823646888136864, 0.053397901356220245, -0.021624702960252762, -0.02545010671019554, -0.019915761426091194, -0.0005512984935194254, -0.010404834523797035, 0.02668580412864685, 0.013737273402512074, 0.05271432176232338, 0.025042589753866196, -0.008689318783581257, 0.026541201397776604, -0.02420126460492611, -0.021374935284256935, 0.020941127091646194, 0.00030892432550899684, 0.0016021342016756535, -0.022071657702326775, 0.012817073613405228, -0.017273470759391785, -0.005120256450027227, -0.03922681882977486, 0.017983339726924896, 0.03367932513356209, -0.004653583746403456, -0.0053470199927687645, 0.00790057610720396, 0.024280138313770294, 0.03480985760688782, -0.006257361266762018, 0.005928718019276857, -0.01967913843691349, -0.019429368898272514, 0.010398262180387974, 0.029262365773320198, 0.04443252086639404, 0.048481401056051254, -0.0012849938357248902, 0.016353271901607513, 0.021913910284638405, -0.03649250790476799, 0.010286523029208183, -0.021769307553768158, -0.013987042009830475, -0.03791224583983421, 0.0033981676679104567, -0.011206723749637604, 0.02479282207787037, 0.07997854053974152, 0.017207743600010872, -0.0179570484906435, -0.02070450410246849, -0.048218488693237305, -0.03699204698204994, 0.01935049518942833, 0.02991965040564537, -0.06220553070306778, 0.023057587444782257, -0.0646769255399704, -0.033337537199258804, -0.009800131432712078, 0.03375820070505142, -0.005337161011993885, -0.007098686881363392, -0.05092650651931763, -0.0056986683048307896, 0.04064655676484108, 0.023373084142804146, -0.03885873779654503, -0.031891509890556335, 0.0037432427052408457, -0.029446404427289963, 0.004693020600825548, -0.004679874982684851, -0.001552016125060618, -0.03378449007868767, 0.005747964605689049, -0.008051751181483269, -0.041908543556928635, 0.04656212776899338, -0.011929737403988838, 0.052740614861249924, 0.036150719970464706, 0.0027688166592270136, -0.054791346192359924, 0.09869804233312607, -0.022978711873292923, 0.06562341749668121, -0.0009004815947264433, 0.03509906306862831, 0.03714979439973831, -0.029078325256705284, -0.009576654061675072, -0.011811425909399986, 0.0466935858130455, 0.01196260191500187, -0.0035460570361465216, 0.05600075423717499, -0.0012217300245538354, 0.015919461846351624, -0.00676347129046917, -0.00957008171826601, -0.05505426228046417, -0.0033472280483692884, -0.0015487297205254436, 0.03126051276922226, -0.013073415495455265, -0.011765416711568832, -0.04214516654610634, 0.028920575976371765, -0.02592335268855095, 0.028289582580327988, 0.01428939402103424, 0.04532643035054207, 0.04706166684627533, 0.00408503133803606, 0.009287448599934578, 0.008419831283390522, 0.012849938124418259, -0.008906222879886627, -0.0014575313543900847, 0.05579042062163353, -0.014394559897482395, -0.0017878174548968673, -0.008669599890708923, -0.037333834916353226, -0.01256073173135519, 0.00607989402487874, -0.02694871835410595, -0.012646179646253586, -0.012876229360699654, 0.030103690922260284, 0.005889281164854765, -0.00787428393959999, -0.010818924754858017, 0.01352694258093834, 0.02894686721265316, 0.0015290111768990755, 0.029236074537038803, -0.00045393803156912327, 0.0008914439240470529, 0.010733477771282196, 0.025042589753866196, 0.011305316351354122, 0.06788448244333267, -0.0037169514689594507, 0.031286805868148804, -0.013178580440580845, 0.04098834469914436, -0.0037531021516770124, -0.025147756561636925, -0.004798186477273703, -0.01698426529765129, 0.028657661750912666, 0.018022777512669563, -0.014512871392071247, -0.05642141401767731, -0.014407705515623093, 0.009004815481603146, 0.03633476048707962, -0.034257736057043076, -0.008124052546918392, -0.024608781561255455, -0.054633598774671555, -0.015511945821344852, -0.013342902064323425, -0.01768098957836628, -0.0579989030957222, 0.015511945821344852, -0.004531985614448786, 0.05836698040366173, 0.015393634326756, 0.01681337133049965, -0.002565057948231697, -0.001942279632203281, 0.013296891935169697, -0.0263045784085989, -0.014065916649997234, 0.02161155827343464, 0.050479549914598465, -0.030629519373178482, 0.012994540855288506, -0.015367343090474606, 0.0020260836463421583, -0.010332533158361912, -0.0037826800253242254, 0.005185985006392002, -0.0019225610885769129, 0.0023021437227725983, 0.02910461649298668, -0.006286939140409231, -0.0054127490147948265, -0.017115723341703415, -0.03899019584059715, -0.025686729699373245, 0.0025782035663723946, -0.03034031391143799, 0.019100725650787354, 0.002857550047338009, -0.03018256463110447, -0.04432735592126846, 0.015196448192000389, -0.011581376194953918, 0.009096835739910603, -0.015038699842989445, 0.025476397946476936, 0.00884049478918314, 0.008268655277788639, 0.006954084150493145, -0.06215294823050499, -0.009819850325584412, -0.00817006267607212, -0.012679043225944042, -0.03809628635644913, 0.008768192492425442, 0.013566379435360432, 0.003914136905223131, -0.05978671833872795, -0.002384304301813245, 0.04222404211759567, -0.03375820070505142, -0.008262082934379578, -0.03202296420931816, -0.03126051276922226, -0.01881152018904686, 0.028289582580327988, -0.046010006219148636, -0.02054675482213497, 0.0037925392389297485, 0.0012102274922654033, -0.009182282723486423, -0.002888771239668131, -0.004150759894400835, 0.011002964340150356, 0.0006001841393299401, -0.03331124410033226, -0.0006646803230978549, -0.005761110223829746, -0.008209500461816788, 0.008281801827251911, -0.012817073613405228, 0.016313834115862846, -0.02435901202261448, 0.004150759894400835, -0.01169968768954277, -0.02506888099014759, -0.02059933729469776, 0.04019960016012192, -0.011693115346133709, 0.0065367077477276325, -0.0369657538831234, -0.028000377118587494, 0.023162752389907837, 0.006135763134807348, 0.016852809116244316, -0.016037773340940475, -0.031812634319067, -0.019205892458558083, -0.005889281164854765, -0.03325866162776947, -0.013342902064323425, 0.03423144668340683, 0.019771156832575798, 0.004587855190038681, -0.007558787241578102, -0.023898912593722343, -0.008124052546918392, 0.004923070780932903, -0.03551972657442093, 0.004814618732780218, 0.003970006480813026, 0.008998243138194084, -0.025042589753866196, 0.02496371604502201, -0.01272505335509777, 0.0072564356960356236, 0.006842345464974642, -0.012994540855288506, -0.0009054112015292048, -0.009819850325584412, -0.02802666835486889, 0.030261440202593803, 0.016957974061369896, 0.029025742784142494, -0.010043327696621418, 0.007032958324998617, -0.019744865596294403, -0.0009448484051972628, 0.0012192651629447937, -0.04443252086639404, 0.007545641157776117, -0.009957880713045597, 0.007986023090779781, -0.013421776704490185, 0.04198741912841797, 0.017483802512288094, 0.020152384415268898, 0.02409609779715538, -0.010713758878409863, -0.0003923174808733165, 0.01886410266160965, 0.033889658749103546, -0.003026801161468029, 0.006201491691172123, -0.04193483665585518, 0.0343891941010952, -0.00270144478417933, 0.020835960283875465, 0.031286805868148804, -0.056947242468595505, 0.04422219097614288, -0.060890957713127136, -0.013415203429758549, 0.0026472187601029873, -0.011969175189733505, 0.022452883422374725, 0.005011804401874542, 0.007677098270505667, -0.028552496805787086, 0.006319803185760975, -0.007197279948741198, 0.013566379435360432, -0.017654696479439735, -0.016616186127066612, 0.01907443441450596, -0.004926357418298721, 0.06020738184452057, -0.01794390380382538, -0.0846584141254425, -0.010654603131115437, -0.010707186535000801, -0.040567681193351746, 0.013375766575336456, -0.05103167146444321, -0.004709452856332064, -0.019495097920298576, 0.028237000107765198, 0.056474000215530396, -0.02597593516111374, -0.01595889963209629, -0.010825498029589653, -0.0026587212923914194, -0.010207649320363998, -0.04545788839459419, 0.010759769007563591, 0.027895210310816765, 0.020402152091264725, -0.004702880047261715, -0.05416035279631615, -0.05147862434387207, -0.018956122919917107, -0.024385305121541023, -0.005264859646558762, 0.026646368205547333, -0.006816054228693247, -0.01919274590909481, 0.004808045923709869, 0.0008396826451644301, 0.018995560705661774, 0.006822627037763596, 0.029525279998779297, 0.015222739428281784, -0.02857878804206848, -0.009944734163582325, 0.01988946832716465, -0.02920978143811226, 0.002622570376843214, -0.0219402015209198, -0.03249621018767357, -0.010772914625704288, -0.013349475339055061, 0.0026800830382853746, 0.026764679700136185, 0.010818924754858017, 0.0019504956435412169, 0.0216772872954607, 0.004446538630872965, 0.013158862479031086, -0.021637849509716034, -0.024595635011792183, 0.01102268323302269, 0.002210123697295785, -0.004725885111838579, 0.006822627037763596, -0.015275322832167149, 0.022176824510097504, -0.028210707008838654, 0.003542770631611347, -0.010371970012784004, 0.011969175189733505, 0.0006490697269327939, -0.001874907873570919, 0.05400260537862778, -0.005925431847572327, -0.010910945013165474, 0.012015185318887234, 0.0042000566609203815, -0.01573542319238186, 0.04742974415421486, -0.020139237865805626, -0.030208855867385864, 0.012008612044155598, 0.020796524360775948, 0.037649333477020264, -0.0179570484906435, 0.019587118178606033, 0.015985190868377686, 0.0085972985252738, -0.00025161722442135215, -0.0239909328520298, -0.00485076941549778, 0.008741901256144047, -0.03649250790476799, -0.021046292036771774, -0.015275322832167149, -0.04756120219826698, -0.004377523437142372, 0.010187930427491665, -0.046010006219148636, -0.039700064808130264, -0.017825592309236526, 0.0069672297686338425, -0.012830219231545925, 0.0006186703103594482, 0.04635179787874222, 0.0002711304114200175, -0.08502649515867233, -0.027185341343283653, 0.011456492356956005, 0.011541939340531826, 0.005399602930992842, -0.030866142362356186, -0.01110155787318945, 0.011285597458481789, -0.0023120029363781214, -0.03320607915520668, 0.016024628654122353, 0.0019948624540120363, -0.0016793652903288603, 0.0015602322528138757, 0.029078325256705284, -0.0682525634765625, 0.0077165355905890465, -0.00932688545435667, 0.06068062782287598, -0.005077532958239317, -0.0302877314388752, 7.728243508609012e-05, -0.012166360393166542, 0.04469543695449829, -0.0161692313849926, 0.00350990635342896, 0.008538142777979374, 0.009747548960149288, 0.00778883695602417, 0.0023629425559192896, -0.0377282053232193, -0.013211444951593876, -0.008774765767157078, 0.058472149074077606, -0.048928357660770416, 0.015380488708615303, -0.021322352811694145, -0.012961676344275475, -0.002565057948231697, -0.020665066316723824, 0.001114099519327283, -0.058524731546640396, 0.0219402015209198, -0.011219869367778301, 0.023635998368263245, 0.020559901371598244, 0.009583227336406708, -0.01892983168363571, 0.00867617316544056, -0.026882991194725037, 0.037596751004457474, -0.004936216399073601, -0.0011288884561508894, 0.03099760040640831, 0.0061850594356656075, -0.021256623789668083, 0.010503427125513554, -0.0076902443543076515, 0.03699204698204994, 0.05308240279555321, -0.008886503987014294, 0.02216367796063423, -0.01681337133049965, -0.008478987030684948, -0.022347718477249146, -0.008091188967227936, -0.00778883695602417, 0.016997411847114563, 0.00978041347116232, -0.059050559997558594, -0.046930208802223206, 0.058892808854579926, 0.014026479795575142, -0.00010013338760472834, 0.004311794880777597, -0.006789762526750565, 0.03417886421084404, 0.040015559643507004, -0.023688580840826035, 0.002019510604441166, 0.01309970673173666, -0.015538237057626247, -0.006464405916631222, 0.0003728042938746512, -0.0010615165811032057, 0.020849106833338737, 0.009063971228897572, 0.007946585305035114, -0.01628754287958145, 0.0444062314927578, 0.061101291328668594, 0.008189781568944454, 0.00676347129046917, 0.002484540455043316, 0.03281170874834061, 0.0046897344291210175, -0.010286523029208183, 0.025410670787096024, 0.04737716168165207, -0.0021476815454661846, 0.04382782056927681, 0.0507950484752655, -0.029630444943904877, -0.021427517756819725, 0.019797449931502342, 0.018180526793003082, -0.0023005004040896893, 0.026804115623235703, 0.01164710521697998, -0.010437699034810066, 0.033074621111154556, 0.019692283123731613, -0.020783377811312675, 0.019665991887450218, -0.003291358705610037, 0.014105353504419327, 0.013125997968018055, 0.02997223287820816, 0.01194288395345211, 0.001490395632572472, 0.008459269069135189, -0.00668459665030241, -0.019587118178606033, -0.021585267037153244, -0.044932059943675995, -0.045194972306489944, 0.033074621111154556, 0.020257549360394478, -0.041750796139240265, -0.024451032280921936, 0.021743014454841614, -0.0025798468850553036, -0.009964453056454659, 0.003350514452904463, -0.004423533566296101, 0.016918538138270378, -0.006270506884902716, 0.03607184812426567, -0.039489731192588806, 0.043039076030254364, -0.0004136792558711022, -0.01649787463247776, 0.02107258327305317, -0.003749815747141838, -0.012665897607803345, -0.0017812446458265185, -0.0010245442390441895, -0.05515942722558975, 0.004242780152708292, -0.011679968796670437, 0.04193483665585518, -0.0023284349590539932, -0.026120539754629135, 0.017615260556340218, 0.0071841343306005, 0.004052167292684317, -0.004364377819001675, -0.022847255691885948, -0.02226884476840496, 0.05705241113901138, 0.0216772872954607, 0.045799676328897476, 0.01601148210465908, -0.020415298640727997, 0.026173122227191925, -0.026173122227191925, -0.04351232200860977, -0.0171945970505476, -0.023649144917726517, 0.021440664306282997, -0.01988946832716465, -0.001756596378982067, 0.04332828149199486, 0.04856027662754059, 0.006701028905808926, 0.022820964455604553, -0.00014912172628100961, 0.0064446874894201756, 0.033337537199258804, 0.03018256463110447, 0.028342165052890778, -0.018456585705280304, -0.02059933729469776, 0.002090168884024024, 0.014105353504419327, 0.0300248172134161, -1.762604370014742e-05, 0.02367543615400791, 0.008492132648825645, 0.042828746140003204, -0.007736254017800093, 0.012580450624227524, 0.00089308712631464, 0.05373968929052353, 0.002003078581765294, -0.054896511137485504, 0.0008232505060732365, 0.01449972577393055, -0.01434197649359703, -0.03252250328660011, -0.0029906504787504673, 0.009839569218456745, -0.006280365865677595, -0.001985003240406513, -0.05983930081129074, 0.006960656959563494, -0.003324222983792424, -0.01054286491125822, 0.013474359177052975, 0.02663322165608406, -0.015656547620892525, -0.0058136931620538235, -0.025147756561636925, 0.03034031391143799, 0.005396316759288311, -0.030524354428052902, 0.012435847893357277, 0.016681915149092674, -0.051399752497673035, 0.0006026489427313209, -0.040567681193351746, -0.020612483844161034, -0.0021411085035651922, 0.015419925563037395, -0.007092114072293043, 0.00446297088637948, 0.01029309630393982, 0.00047981864190660417, -0.009760694578289986, 0.006421682424843311, -0.01552509143948555, 0.03252250328660011, -0.01059544738382101, -0.008012314327061176, -0.007847992703318596, -0.011982320807874203, 0.012501576915383339, -0.013178580440580845, -0.02032327838242054, 0.008334384299814701, 0.033022038638591766, 0.018193671479821205, 0.006122617516666651, 0.0045385584235191345, -0.0038319763261824846, 0.008498705923557281, 0.021309206262230873, 0.013816148042678833, -0.018259400501847267, -0.021769307553768158, 0.009642383083701134, -0.013382339850068092, 0.024608781561255455, -0.005639512557536364, 0.0011075265938416123, -0.0022988570854067802, 0.02124347724020481, 0.04403815045952797, 0.03483615070581436, 0.05218849331140518, -0.0151438657194376, 0.03922681882977486, 0.02807925082743168, -0.003363660303875804, 0.0036643685307353735, -0.023097023367881775, -0.004867201671004295, 0.007894002832472324, 0.002325148554518819, 0.021361788734793663, -0.0466935858130455, 0.02382003888487816, 0.020389005541801453, 0.03089243359863758, 0.002801680937409401, -0.010187930427491665, 0.013881877064704895, -0.004992085974663496, 0.006053602322936058, -0.002101671416312456, -0.02360970713198185, -0.01256073173135519, -0.013073415495455265, 0.005166266579180956, 0.02329421043395996, -0.0057249595411121845, -0.04188225418329239, -0.026817262172698975, 0.043591197580099106, -0.021808743476867676, 0.007624515797942877, 0.030156273394823074, -0.011673396453261375, 0.014394559897482395, -0.009602946229279041, 0.02366228960454464, 0.00727615412324667, 0.013428349047899246, 0.024122389033436775, -0.037281252443790436, 0.014683765359222889, 0.026278287172317505, 0.008794484660029411, 0.005294437520205975, 0.011384190991520882, 0.022137386724352837, 0.0026472187601029873, -0.04795557260513306, -0.02124347724020481, -0.0036150719970464706, -0.011633959598839283, 0.03920052573084831, 0.01186400931328535, -0.003263424150645733, 0.01247528474777937, -0.005113683640956879, 0.00010793865658342838, -0.048060741275548935, 0.00889307726174593, -0.01275134552270174, -0.004114609211683273, 0.0073418826796114445, 0.009938161820173264, -0.00813719816505909, -0.034099988639354706, -0.02802666835486889, -0.007861138321459293, -0.025857623666524887, 0.04348602890968323, 0.027448255568742752, 0.018154233694076538, 0.010496854782104492, -0.0026373593136668205, 0.03268025070428848, -0.033390119671821594, 0.02430642955005169, -0.0072564356960356236, 0.004699593875557184, -0.006862063892185688, -0.022387154400348663, 0.02409609779715538, 0.0028854848351329565, -0.0025091886054724455, 0.0022544905077666044, -0.019797449931502342, -0.026422889903187752, 0.0014912171754986048, 0.0035230519715696573, 0.0405413880944252, -0.025358086451888084, 0.06783189624547958, -0.0077756913378834724, 0.004518839996308088, -0.0017286617076024413, -0.04114609211683273, 0.03304833173751831, -0.027632296085357666, 0.01309970673173666, -0.020993709564208984, 0.018877249211072922, 0.006855491083115339, 0.022492321208119392, -0.024161826819181442, -0.025108318775892258, 0.012790782377123833, -0.021808743476867676, -0.026383453980088234, 0.011035828851163387, -0.005767683032900095, 0.03360045328736305, 0.009550362825393677, 0.03551972657442093, -0.00846584141254425, -0.025305503979325294, -0.011048974469304085, 0.012685616500675678, -0.015498800203204155, 0.013895022682845592, 0.024621926248073578, 0.045589346438646317, -0.020073508843779564, -0.028210707008838654, -0.043538615107536316, 0.021861325949430466, -0.010017036460340023, 0.02237400971353054, -0.04666729271411896, 0.019823741167783737, -0.018640626221895218, -0.0014928604941815138, 0.034310318529605865, 0.00023374726879410446, -0.011121275834739208, -0.0009119840688072145, -0.03983152285218239, 0.009366323240101337, -0.017010556533932686, 0.006553139537572861, 0.0014279534807428718, 0.008478987030684948, 0.012593596242368221, -0.0050348094664514065, 0.020191820338368416, -0.0065629989840090275, -0.014802076853811741, -0.023622851818799973, -0.00047078097122721374, 0.07519350200891495, 0.024805966764688492, 0.01357952505350113, -0.01946880668401718, 0.006346094887703657, -0.0250162985175848, 0.019113872200250626, -0.015249031595885754, -0.0364399254322052, -0.01323773618787527, -0.029288657009601593, 0.011660250835120678, 0.02690928243100643, -0.0065038432367146015, 0.004078458528965712, 0.007762545719742775, -0.008222646079957485, -0.0025009724777191877, 0.016721351072192192, -0.017641551792621613, 0.0202706940472126, 0.02571302093565464, 0.05515942722558975, -0.013125997968018055, 0.01800963096320629, -0.05234624445438385, 0.023951495066285133, 0.0397789366543293, 0.011969175189733505, 0.03315349668264389, -0.027264216914772987, -0.015104427933692932, 0.014447142370045185, -0.015590819530189037, 0.00872875563800335, 0.03594039008021355, 0.03483615070581436, -0.007131551392376423, -0.010516573674976826, 0.0009777126833796501, -0.005159693770110607, 0.029314948245882988, -0.0009727830183692276, -0.013434922322630882, -0.014618037268519402, -0.01390816830098629, -0.0025962789077311754, -0.001607063808478415, 0.007164415437728167, -0.0356774739921093, -0.023688580840826035, 0.014447142370045185, 0.029840776696801186, -0.005830125417560339, -0.014696910977363586, 0.03089243359863758, 0.0011510718613862991, -0.006947511341422796, 0.022137386724352837, -0.0038089712616056204, 0.011259306222200394, -0.012363546527922153, -0.035914096981287, 0.018732646480202675, 0.0005344555247575045, 0.03633476048707962, 0.0004251817590557039, -0.0008955519297160208, -0.01585373468697071, 0.01409220788627863, -0.026975009590387344, -0.023622851818799973, 0.0024500328581780195, -0.01779930107295513, -0.011509074829518795, -0.004423533566296101, -0.0003161134081892669, 0.01978430338203907, 0.02221626043319702, 0.019744865596294403, -0.008551288396120071, -0.025647293776273727, -0.0023333646822720766, 0.020612483844161034, 0.02792150154709816, 0.01875893771648407, 0.03899019584059715, 0.026028519496321678, -0.015498800203204155, 0.003010369138792157, -0.019928906112909317, 0.018877249211072922, -0.01051000040024519, -0.013934459537267685, -0.002162470482289791, -0.004614146426320076, 0.010260231792926788, -0.0032420624047517776, -0.018404003232717514, -0.007243289612233639, -0.020730795338749886, -0.006378958933055401, -0.0002417579380562529, -0.006431541871279478, 0.006405250169336796, -0.025318650528788567, -0.0011379261268302798, 0.03767562285065651, -0.04372265189886093, -0.02393835037946701, 0.013697836548089981, 0.0023990932386368513, -0.0022528471890836954, -0.009366323240101337, 0.045142389833927155, -0.015130720101296902, -0.012810500338673592, -0.005389743950217962, -0.01729976385831833, -0.0250162985175848, 0.000588681607041508, 0.0073747471906244755, -0.004150759894400835, -0.0080846156924963, -0.011035828851163387, 0.012429274618625641, -0.004045594483613968, -0.0216772872954607, -0.0022742089349776506, -0.006418396253138781, 0.013881877064704895, -0.016957974061369896, -0.0260416641831398, 0.0045977141708135605, -0.005248427391052246, 0.029683027416467667, 0.01611664891242981, -0.0005258286837488413, 0.03289058431982994, 0.003401454072445631, 0.046325504779815674, 0.019928906112909317, 0.0171945970505476, 0.004712739493697882, -0.03767562285065651, 0.007407611235976219, -0.03249621018767357, 0.006290225312113762, 0.012015185318887234, 0.004739030729979277, 0.024779675528407097, -0.002078666351735592, -0.020139237865805626, -0.00374652910977602, -0.025252921506762505, 0.0060404567047953606, 0.001796033582650125, 0.03299574926495552, -0.02059933729469776, -0.00727615412324667, 0.014841513708233833, -0.057473074644804, -0.026015372946858406, 0.011568230576813221, 0.013415203429758549, 0.01903499849140644, 2.6471159799257293e-05, -0.008209500461816788, 0.020204966887831688, 0.011469637975096703, 0.000771900056861341, -0.013513796962797642, 0.018877249211072922, -0.01698426529765129, 0.0010779487201943994, 0.016944829374551773, -0.014013334177434444, 0.003158258507028222, -0.02070450410246849, 0.015919461846351624, -0.025029445067048073, 0.01135132648050785, -0.0013540087966248393, -0.009254584088921547, 0.032207004725933075, 0.010063045658171177, 0.03599297255277634, -0.037491582334041595, 0.06041771173477173, 0.04437993839383125, 0.025568418204784393, -0.04742974415421486, 0.02392520383000374, 0.0042559257708489895, 0.020415298640727997, 0.004400528501719236, -0.04017331078648567, 0.0019077721517533064, -0.05631624907255173, -0.013921313919126987, -0.005583642981946468, -0.003048163140192628, 0.009852714836597443, -0.023530833423137665, -0.022663215175271034, 0.01331661082804203, 0.014433996751904488, -0.04863915219902992, 0.047245703637599945, -0.0057282461784780025, 0.045904841274023056, 0.01135132648050785, -0.012258380651473999, -0.007486485410481691, 0.01058887504041195, -0.010063045658171177, -0.013375766575336456, 0.006240929011255503, 0.0459311343729496, 0.012284671887755394, 0.007854565978050232, 0.024188118055462837, -0.011975747533142567, 0.03228588029742241, -0.01267247088253498, -0.02484540455043316, -0.009602946229279041, 0.008472414687275887, 0.01352694258093834, -0.017615260556340218, -0.008124052546918392, -0.005360166076570749, 0.01552509143948555, -0.014749494381248951, 0.022505465894937515, 0.0232284814119339, -0.034152571111917496, -0.0006601614295504987, 0.0026094247587025166, -0.0057578240521252155, -0.007769118528813124, -0.00501509103924036, 0.022676361724734306, -0.021466955542564392, -0.028158124536275864, -0.013132571242749691, 0.02388576790690422, 0.014591745100915432, 0.05983930081129074, -0.002584776608273387, 0.03331124410033226, -0.019008705392479897, 0.037701915949583054, -0.01956082694232464, 0.01498611643910408, -0.0030596654396504164, -0.0003315185313113034, -0.007999168708920479, 0.012015185318887234, 0.008866786025464535, 0.020204966887831688, 0.003667654935270548, 0.028736537322402, -0.002456605900079012, 0.0003730097087100148, 0.01105554774403572, 0.007545641157776117, 0.01344806794077158, -0.002395806834101677, -0.021335497498512268, 0.05087392404675484, 0.03502018749713898, 0.015617111697793007, 0.018745791167020798, -0.005705241113901138, 0.010503427125513554, -0.0018091792007908225, -0.012817073613405228, 0.005251713562756777, 0.024227555841207504, 0.02420126460492611, 0.032101839780807495, -0.029472695663571358, -0.03817516192793846, -0.014131645672023296, -0.0004983048420399427, -0.029604153707623482, -0.0017779581248760223, 0.00501509103924036, -0.011384190991520882, 0.02215053327381611, -0.012948530726134777, 0.014381414279341698, 0.04969080910086632, 0.015078136697411537, 0.020573046058416367, -0.022886693477630615, 0.012613315135240555, 0.050269220024347305, 0.010549437254667282, -0.017339199781417847, -0.02226884476840496, -0.005583642981946468, -0.03909536078572273, -0.003923996351659298, 0.02178245224058628, 0.0008059967658482492, 0.006934365723282099, 0.01110155787318945, -0.015235885046422482, -0.012468712404370308, -0.029604153707623482, -0.02700130268931389, -0.02878911979496479, 0.02150639146566391, 0.020520463585853577, 0.027185341343283653, -0.035177938640117645, -0.013086561113595963, -0.009859287180006504, -0.019705429673194885, -0.012606741860508919, -0.013474359177052975, 0.012941958382725716, -0.014223664999008179, 0.019639700651168823, -0.017273470759391785, -0.0028937009628862143, 0.021545829251408577, -0.011344753205776215, -0.011417054571211338, 0.0007143875118345022]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
", Z., Liu, P., Nie, J., and rong Wen, J. A survey of
large language models. ArXiv , abs/2303.18223, 2023a.
Zhao, Y ., Xie, Z., Zhuang, C., and Gu, J. Lookahead: An in-
ference acceleration framework for large language model
with lossless generation accuracy. ArXiv , abs/2312.12728,
2023b.
Zheng, L., Li, Z., Zhang, H., Zhuang, Y ., Chen, Z., Huang,
Y ., Wang, Y ., Xu, Y ., Zhuo, D., Xing, E. P., Gonzalez,
J. E., and Stoica, I. Alpa: Automating inter- and Intra-
Operator parallelism for distributed deep learning. In
OSDI , pp. 559–578, 2022.
Zhong, Z., Wang, J., Bao, W., Zhou, J., Zhu, X., and Zhang,
X. Semi-hfl: semi-supervised federated learning for het-
erogeneous devices. Complex & Intelligent Systems , 9:
1995–2017, 2022.
Zhou, W., Xu, C., Ge, T., McAuley, J. J., Xu, K., and Wei,
F. BERT loses patience: Fast and robust inference with
early exit. In NeurIPS , 2020.
13
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
Structure of the appendix
This appendix is organized as follows. Appendix A supplements a detailed and formal analysis of training efficiency, while
Appendix B provides additional experiments and empirical results. Appendices C and D include details about advanced
features and implementation of EE-LLM . Extended preliminaries and related works can be found in Appendices E and F.
A. Training efficiency
This section is an extended version of Section 3.2. In the following, we analyze the training time and peak GPU memory of
training an early-exit model with pipeline parallelism, and propose some performance optimizations. We refer readers to the
literature (e.g. the Megatron-LM series (Shoeybi et al., 2019; Narayanan et al., 2021b; Korthikanti et al., 2022)) for thorough
study of training efficiency with 3D parallelism for standard LLMs without early exits; we will use that as a baseline, and
focus on the additional computational overhead caused by early exits.
Let us first identify the major sources of low resource utilization in the original 1F1B pipeline schedule for training a
standard LLM, which lays the foundation for our analysis later.
•Explicit bubbles, i.e. light gray areas in Figure 3(a), during which GPUs are idle. This is the most notable and well
recognized source of low resource utilization in pipeline parallelism.
•Implicit bubbles, i.e. dark gray areas in Figure 3(a). This is caused by load imbalance across pipeline stages, even
though Transformer layers are evenly divided into stages in Megatron-LM3. In particular, the first stage has the
additional computation for the input embedding layer, and more importantly, the last pipeline stage has the additional
computation for the output logits (via the output embedding layer) as well as the training loss. For LLMs, these
additional computational costs are not negligible, primarily due to large vocabulary sizes.
•Idle memory. Memory usage is also unbalanced across pipeline stages: earlier stages in the 1F1B schedule have
to save the intermediate activations for more microbatches, and the first/last stage has to save an extra input/output
embedding layer, plus the corresponding gradients and optimizer states. As a result, the first stage is typically the
bottleneck of peak memory usage, while later stages have idle memory (Korthikanti et al., 2022).
Remark A.1.In our analysis, we assume no activation recomputation (Chen et al., 2016; Korthikanti et al., 2022) for
simplicity. For clarity, we also ignore the P2P communication latency between pipeline stages, which is generally not the
major concern for the efficiency of pipeline parallelism.
A.1. Utilization of idle resources
At first glance, one might expect that adding early exits to an LLM will incur a training overhead, in terms of time and
memory, that is (at least) proportional to the number of additional model parameters. Fortunately, this is not the case for
training with pipeline parallelism, based on the above analysis of idle resources in the ","[0.0141793517395854, 0.037919946014881134, 0.06408470869064331, -0.007983502931892872, -0.002060204278677702, 0.00919558759778738, 0.022819682955741882, 0.02382185310125351, -0.0014761693309992552, 0.05785500630736351, 0.020842427387833595, -0.01191769726574421, -0.03751366212964058, 0.02453962340950966, -0.0269231628626585, -0.029712986201047897, 0.013976208865642548, -0.011464012786746025, 0.013563152402639389, 0.06229705736041069, 0.02054448612034321, -0.01137598417699337, -0.005065021570771933, 0.050433527678251266, 0.01390849519520998, -0.0197319146245718, 0.029279615730047226, 0.015574264340102673, -0.004780621733516455, -0.044935137033462524, 0.04718324914574623, -0.03271949663758278, -0.04095354303717613, -0.025650136172771454, -0.016210777685046196, 0.05937180295586586, 0.028954587876796722, 0.03247572481632233, -0.016048263758420944, 0.022291511297225952, -0.0011164377210661769, -0.04574770852923393, -0.06760584563016891, 0.01787654682993889, -0.027681561186909676, 0.034967608749866486, 0.04674987867474556, 0.004411579575389624, -0.017917174845933914, 0.051598213613033295, 0.009358101524412632, 0.015614892356097698, -0.02773573249578476, -0.0019806399941444397, -0.0313110426068306, 0.002312439726665616, -0.001277258968912065, -0.008457502350211143, 0.025040708482265472, -0.02089659869670868, 0.02843995951116085, -0.02533864974975586, 0.017903631553053856, -0.012967268005013466, -0.04455593600869179, -0.0056846062652766705, -0.044312167912721634, 0.02345619536936283, -0.0015125657664611936, 0.01635974831879139, -0.018905801698565483, -0.008173102512955666, 0.03588852286338806, -0.006307576783001423, -0.0007740578730590641, 0.015628434717655182, 0.02550116367638111, 0.04566644877195358, -0.004584250506013632, -0.00031804508762434125, 0.015614892356097698, -0.005935148801654577, 0.02541990764439106, -0.02054448612034321, 0.010651442222297192, -0.026462705805897713, -0.0036193234845995903, -0.01298081036657095, -0.00799704622477293, -0.012472953647375107, -0.014084551483392715, -0.012154697440564632, -0.011802583932876587, 0.011518184095621109, 0.062080372124910355, 0.049918901175260544, 0.009920128621160984, -0.042524512857198715, 0.037892863154411316, 0.08017360419034958, 0.0044792937114834785, 0.015967005863785744, 0.029008759185671806, -0.024038538336753845, 0.021817512810230255, -0.04371628165245056, -0.02781699039041996, -0.021925855427980423, -0.027410704642534256, -0.01690146140754223, -0.04544976353645325, 0.03485926613211632, -0.03838040307164192, -0.01759214699268341, 0.01625140570104122, -0.04352668300271034, -0.07529818266630173, 0.05235661193728447, 0.02613767795264721, 0.02871081791818142, -0.013231352902948856, -0.001640376285649836, 0.013610552065074444, 0.00584034901112318, 0.010956156067550182, -0.02487819455564022, 0.028223274275660515, -0.03957217186689377, 0.01759214699268341, -0.023131167516112328, 0.022061282768845558, 0.011768726631999016, 0.038163717836141586, -0.021302884444594383, -0.05100232735276222, -0.012743811123073101, -0.039680514484643936, 0.014504379592835903, -0.02382185310125351, -0.004086551256477833, 0.03735114634037018, -0.007313132751733065, 0.005681220442056656, 0.007286047097295523, -0.009886272251605988, 0.06462642550468445, -0.018824545666575432, 0.009398729540407658, -0.01927145943045616, 0.0057861777022480965, 0.0004435279406607151, -0.03699903562664986, -0.002703489037230611, -0.03074224293231964, -0.019501687958836555, -0.008078303188085556, -0.02631373517215252, 0.0301192719489336, 0.0695018470287323, -0.048564616590738297, 0.0010224842699244618, 0.022440483793616295, 0.012743811123073101, 0.024133337661623955, 0.01004201453179121, 0.06175534054636955, -0.053548380732536316, -0.033450812101364136, -0.07946937531232834, -0.054604724049568176, 0.01133535522967577, -0.024214595556259155, -0.03201526775956154, -0.06885179132223129, 0.015411749482154846, -0.0506502166390419, -0.08093199878931046, -0.04301205277442932, 0.014775236137211323, -0.07226458191871643, -0.02666584774851799, 0.037730347365140915, -0.018011974170804024, 0.003079302841797471, -0.07177704572677612, -0.0026442392263561487, 0.0017944261198863387, 0.04739993438124657, -0.00435740826651454, 0.04054725915193558, -0.005640591960400343, 0.027437789365649223, 0.07156036049127579, 0.014951293356716633, 0.008640331216156483, -0.0008819773211143911, 0.041982799768447876, 0.01971837319433689, 0.013745980337262154, -0.024593794718384743, 0.027586761862039566, 0.04428508132696152, 0.02898167446255684, -0.0952332392334938, 0.04490805044770241, 0.0015159514732658863, -0.023930195719003677, 0.010861355811357498, -0.02310408279299736, -0.020639285445213318, 0.0035922378301620483, 0.03285492584109306, 0.04940427467226982, 0.010014928877353668, 0.015709692612290382, -0.007963188923895359, -0.05785500630736351, 0.029712986201047897, 0.047129075974226, 0.024783393368124962, 0.011321812868118286, 0.02871081791818142, 0.004689207766205072, 0.028142018243670464, -0.03317995369434357, 0.039409659802913666, 0.017131689935922623, -0.05590483546257019, 0.010089414194226265, -0.001484633656218648, 0.03456132486462593, 0.0031419384758919477, -0.024647966027259827, -0.020056942477822304, 0.029902586713433266, -0.040736857801675797, -0.010285785421729088, -0.026002248749136925, 0.0066529191099107265, -0.0283587034791708, 0.03607812151312828, 0.033098697662353516, 0.01573677733540535, -0.005285092629492283, -0.023131167516112328, 0.024322938174009323, -0.03502177819609642, -0.06668493896722794, 0.013563152402639389, -0.003832623129710555, 0.00874867383390665, -0.035942692309617996, -0.030823498964309692, 0.01075301319360733, -0.04935010150074959, 0.03726989030838013, -0.010813956148922443, -0.006828976329416037, -0.016942091286182404, -0.0010411057155579329, -0.032394468784332275, 0.04916050285100937, 0.0014330015983432531, 0.027004418894648552, 0.012655782513320446, 0.006063805893063545, -0.016495177522301674, 0.009168501012027264, -0.0067544905468821526, -0.007049047388136387, 0.0345071516931057, -0.02506779320538044, 0.01813386008143425, 0.015574264340102673, -0.03575309365987778, -0.01213438343256712, 0.04539559409022331, 0.028304532170295715, -0.033288296312093735, 0.017822375521063805, -0.0006272026803344488, 0.01642746292054653, 0.06560150533914566, 0.03236738219857216, 0.011565583758056164, -0.010400899685919285, -0.01212761178612709, -0.0090263020247221, -0.02898167446255684, -0.021641455590724945, 0.006886533461511135, 0.008220503106713295, 0.03867834433913231, -0.019623572006821632, 0.038272060453891754, 0.007556903641670942, 0.008308530785143375, -0.029387958347797394, -0.01600763387978077, 0.012337525375187397, 0.04268702492117882, -0.0026696319691836834, -0.02151956968009472, 0.02204774133861065, 0.008775759488344193, 0.04924175888299942, -0.038082461804151535, -0.016589976847171783, -0.03242155537009239, 0.02193939872086048, -0.021898768842220306, -0.004855107516050339, -0.02187168411910534, 0.02843995951116085, -0.03317995369434357, -0.02755967527627945, -0.019772544503211975, -0.02639499120414257, 0.0028033675625920296, -0.05297958478331566, -0.015682606026530266, -0.045097652822732925, -0.026449162513017654, -0.0230092816054821, 0.028764989227056503, 0.008802845142781734, 0.012662554159760475, -0.009750843979418278, -0.03884086012840271, -0.0037547519896179438, 0.0099065862596035, -0.009012758731842041, 0.017185861244797707, -0.040655601769685745, -0.01910894550383091, -0.039951372891664505, -0.04880838841199875, 0.017185861244797707, 0.07448560744524002, 0.004706136416643858, -0.0754065215587616, 0.02026008628308773, -0.034263379871845245, 0.03954508900642395, -0.010834270156919956, 0.03158189728856087, 0.005447606556117535, 0.012276582419872284, 0.07887349277734756, 0.012500039301812649, -0.017984889447689056, -0.017565060406923294, 0.03217778354883194, -0.00977115798741579, 0.025121964514255524, 0.005041321739554405, 0.03047138638794422, -0.04894381761550903, 0.007841303013265133, 0.009012758731842041, -0.008288216777145863, -0.0117822689935565, 0.015411749482154846, 0.009669586084783077, -0.027762819081544876, 0.030958928167819977, -0.012188554741442204, 0.026246020570397377, 0.027925333008170128, -0.00919558759778738, 0.0429849699139595, 0.05644654855132103, -0.0007220025872811675, 0.004154265392571688, -0.037378232926130295, 0.012621925212442875, -0.001973868580535054, 0.04070977121591568, -0.006480248179286718, 0.048672959208488464, 0.0020178828854113817, 0.014287694357335567, -0.01883808709681034, -0.014517922885715961, 0.005447606556117535, 0.053629640489816666, -0.020490314811468124, -0.02968590147793293, -0.02409270964562893, 0.0022667325101792812, -0.01891934499144554, 0.017551518976688385, -0.012364611029624939, 0.012852153740823269, 0.009486758150160313, -0.01400329452008009, 0.010123271495103836, 0.019257916137576103, 0.03670109063386917, -0.011660384014248848, -0.022792596369981766, -0.0301192719489336, -0.02426876686513424, -0.009039844386279583, 0.03548223525285721, -0.009107558988034725, 0.0691768154501915, 0.009094015695154667, 0.04710199311375618, 0.02142477035522461, 0.0442579947412014, -0.020368428900837898, 0.026706477627158165, -0.04379753768444061, 0.01311623863875866, -0.03022761456668377, -0.002649317728355527, 0.013745980337262154, 0.025013621896505356, 0.06570985168218613, -0.01080041378736496, -0.029902586713433266, -0.032746583223342896, -0.01705043390393257, -0.029631730169057846, -0.008003816939890385, 0.01266932487487793, -0.02249465510249138, -0.005562720820307732, -0.07990274578332901, -0.0012671018484979868, 0.012005725875496864, 0.01920374482870102, 0.009209129959344864, -0.06224288418889046, -0.029279615730047226, -0.02407916635274887, 0.026164762675762177, -0.011389526538550854, -0.03672817721962929, 0.017971346154808998, 0.017822375521063805, -0.015804491937160492, 0.010475385002791882, -0.026015792042016983, -0.011938012205064297, -0.020205914974212646, 0.01191769726574421, 0.013637637719511986, -0.03074224293231964, 0.028927503153681755, 0.020666372030973434, 0.06365133821964264, 0.04845627397298813, 0.008559073321521282, -0.053196270018815994, 0.08591576665639877, -0.027248190715909004, 0.013265210203826427, -0.0016505334060639143, 0.025108421221375465, -0.007360532414168119, -0.03401960805058479, -0.0236457958817482, -0.011524955742061138, 0.03691777586936951, 0.04371628165245056, -0.006517490837723017, 0.013075610622763634, 0.012005725875496864, 0.005823420360684395, -0.03066098503768444, 0.04561227932572365, -0.015493007376790047, 0.008166331797838211, 0.02114037051796913, -0.018824545666575432, -0.040303487330675125, 0.017930718138813972, -0.02027362957596779, 0.03992428630590439, -0.03285492584109306, 0.040384743362665176, -0.025799106806516647, 0.02862956002354622, 0.04650610685348511, -0.012899553403258324, -0.011795812286436558, -0.012141154147684574, 0.009757614694535732, 0.011023870669305325, -0.015763863921165466, 0.043607939034700394, -0.015032550320029259, -0.013299067504703999, -0.033125780522823334, -0.046966563910245895, -0.049106329679489136, 0.028764989227056503, -0.001914618769660592, 0.010475385002791882, -0.03832623362541199, 0.011118669994175434, -0.01133535522967577, 0.007800674997270107, -0.042659942060709, -0.006859447341412306, -0.015411749482154846, -0.015019007958471775, -0.007143847178667784, -0.012418782338500023, 0.008491359651088715, 0.021817512810230255, 0.040493085980415344, 0.00839655939489603, 0.024729222059249878, -0.008098617196083069, 0.013847552239894867, 0.0010360270971432328, 0.0206121988594532, 0.039788857102394104, -0.009452900849282742, -0.008789301849901676, -0.017456717789173126, -0.013989752158522606, -0.02114037051796913, -0.025365736335515976, -0.07508149743080139, -0.01573677733540535, 0.011362440884113312, 0.016820205375552177, -0.0067206332460045815, -0.005833577364683151, -0.0332341231405735, -0.024580251425504684, -0.008694502525031567, -0.021898768842220306, -0.027261734008789062, -0.0784401223063469, -0.03299035504460335, 0.021451855078339577, 0.04989181458950043, 0.02789824642241001, 0.024241680279374123, -0.009094015695154667, -0.009507072158157825, 0.034182123839855194, -0.014192894101142883, 0.014016837812960148, 0.012872467748820782, 0.03366749733686447, -0.0428224541246891, 0.009100787341594696, -0.02648979239165783, -0.028602473437786102, -0.0007677096291445196, -0.0027610461693257093, 0.008200188167393208, -0.005115807056427002, 0.005112421233206987, 0.017443176358938217, -2.824951479851734e-05, 0.026015792042016983, -0.02550116367638111, -0.008355931378901005, 0.005356192588806152, 0.005471306852996349, -0.027437789365649223, 0.025094879791140556, 0.023686423897743225, -0.035590577870607376, 0.012364611029624939, 0.014423122629523277, -0.03331538289785385, 0.020327800884842873, -0.02808784693479538, 0.01004878617823124, 0.03832623362541199, 0.006395605392754078, 0.0033975595142692327, -0.02925253100693226, -0.013143324293196201, -0.02941504493355751, -0.029442129656672478, -0.020151743665337563, 0.015709692612290382, -0.03561766445636749, -0.0004177119117230177, -0.04496222361922264, 0.028142018243670464, 0.040574342012405396, -0.0378657765686512, -0.004411579575389624, -0.042795367538928986, -0.019664201885461807, -0.012682868167757988, 0.025365736335515976, -0.030417215079069138, -0.0301192719489336, -0.022237339988350868, -0.0006365134031511843, -0.015398207120597363, 0.006940704770386219, -0.00782776065170765, -0.008680959232151508, 0.03645731881260872, -0.05590483546257019, -0.005217378493398428, 0.008816387504339218, -0.03326120972633362, 0.008511673659086227, 0.010394128039479256, -0.012466182932257652, -0.03396543860435486, -0.029279615730047226, -0.003507595043629408, -0.0032045741099864244, -0.010028471238911152, 0.03190692514181137, -0.018513059243559837, 0.028683731332421303, -0.022196711972355843, -0.02470213733613491, -0.015682606026530266, 0.009446129202842712, -0.011518184095621109, -0.0333966389298439, -0.012615153566002846, -0.012168239802122116, 0.020558027550578117, -0.04317456856369972, -0.003957894630730152, 0.010468614287674427, 0.012235954403877258, 0.01164006907492876, 0.03152772784233093, -0.010739470832049847, -0.0037242805119603872, -0.010441528633236885, -0.03469675034284592, 0.012764125131070614, 0.013102696277201176, 0.004174579866230488, -0.019312087446451187, -0.0027982890605926514, -0.0050447070971131325, -0.0025866820942610502, 0.022887395694851875, 0.010502470657229424, -0.01687437668442726, -0.021465398371219635, -0.03713446110486984, 0.04520599544048309, 0.0506502166390419, 0.03721572086215019, -0.025311565026640892, 0.0028795460239052773, -0.003235045587643981, -0.010637899860739708, -0.004821250215172768, -0.03829914703965187, -0.006368519738316536, -0.01990797184407711, -0.006879761815071106, 0.01209375448524952, 0.02949630096554756, 0.024417737498879433, 0.03537389263510704, 0.011084812693297863, -0.02445836551487446, -0.006889918819069862, 0.0026560891419649124, 0.020679913461208344, -0.027871161699295044, -0.006842519156634808, -0.03783868998289108, -0.006961018778383732, -0.014802321791648865, -0.02196648344397545, 0.0038630946073681116, -0.04255159944295883, 0.025636592879891396, -0.04290371015667915, -0.012175011448562145, -0.01449083723127842, 0.004381108097732067, 0.022738425061106682, 0.004289694130420685, 0.006595362443476915, -0.0073469895869493484, -0.010190986096858978, 0.007773589342832565, 0.009073701687157154, -0.01386786624789238, 0.003306145314127207, -0.025270937010645866, -0.005312178283929825, 0.04788747429847717, -0.021709170192480087, -0.02016528695821762, 0.001191769726574421, 0.012445867992937565, -0.012913096696138382, 0.008017360232770443, -0.0038664801977574825, -0.03634897619485855, -0.03469675034284592, 0.012933410704135895, 0.05731328949332237, -0.012547439895570278, -0.02053094282746315, -0.004665507934987545, 0.0008079149411059916, 0.0019670971669256687, -0.03911171853542328, -0.013366781175136566, 0.004259222652763128, 0.002933717332780361, -0.03049847111105919, -0.00812570285052061, -0.04295788332819939, -0.028602473437786102, -0.03832623362541199, 0.007793903350830078, 0.0022972039878368378, -0.00537989242002368, -0.024905279278755188, 0.03878668695688248, 0.0141387227922678, -0.0014372337609529495, 0.033207040280103683, 0.01554717868566513, 0.017091061919927597, -0.05509226769208908, 0.018878716975450516, 0.010712385177612305, -0.05005433037877083, -0.010116499848663807, -0.03783868998289108, 0.00422197999432683, -0.0029303315095603466, -0.02462087944149971, -0.004618107806891203, 0.021546656265854836, 0.009981071576476097, -0.008450730703771114, 0.01821511797606945, 0.027695104479789734, 0.020910141989588737, 0.0009073701803572476, -0.037649091333150864, 0.012750581838190556, -0.005254621151834726, 0.01537112146615982, -0.009168501012027264, -0.024282308295369148, 0.03385709598660469, 0.011606212705373764, -0.005166593007743359, -0.010901984758675098, 0.012466182932257652, 0.0007152311154641211, -0.003306145314127207, 0.01946105808019638, 0.0070896758697927, 0.004946521483361721, -0.02898167446255684, -0.02363225258886814, 0.046993646770715714, -0.004814479034394026, -0.01564197801053524, -0.00325366691686213, 0.046262335032224655, 0.018364088609814644, 0.015276321209967136, 0.006510719656944275, 0.026625219732522964, -0.02995675802230835, -0.0118228979408741, -0.006246634293347597, -0.016468090936541557, -0.01346158143132925, 0.014084551483392715, -0.02800658904016018, -0.010983241721987724, -0.021180998533964157, -0.030904756858944893, 0.01733483374118805, 0.018350545316934586, -0.06332631409168243, -0.04593730717897415, -0.019704829901456833, -0.0039037230890244246, -0.03215069696307182, 0.0024410965852439404, 0.0348321795463562, 0.01812031678855419, -0.13185307383537292, -0.0348321795463562, 0.017104605212807655, 0.01359700970351696, -0.006591976620256901, -0.0028609244618564844, 0.008491359651088715, 0.009398729540407658, -0.00017933679919224232, -0.030877670273184776, -0.011829669587314129, 0.003421259578317404, 0.001753797521814704, -0.020246542990207672, 0.004838178865611553, -0.060563571751117706, 0.001048723584972322, 0.014125180430710316, 0.045016393065452576, -0.02871081791818142, -0.030146358534693718, 0.002369996625930071, -0.025446992367506027, -0.003802151884883642, -0.011315041221678257, -0.0364302359521389, -0.01226981170475483, 0.01634620502591133, -0.007969960570335388, 0.01035350002348423, -0.01866203173995018, -0.0019129258580505848, 0.019528772681951523, -0.005681220442056656, -0.03456132486462593, 0.00010818400187417865, -0.021099742501974106, -0.024945907294750214, -0.002493574982509017, 0.006554733496159315, -0.029848415404558182, -0.0602385438978672, 0.04168485477566719, -0.008464273996651173, 0.04203696921467781, 0.016603520140051842, 0.0067544905468821526, -0.010130043141543865, 0.018594317138195038, -0.01652226224541664, -0.0004714600509032607, -0.009588329121470451, -0.0008582773734815419, 0.028846245259046555, -0.0018333616899326444, -0.007624617777764797, 5.004501872463152e-05, -0.015005464665591717, 0.008281445130705833, 0.04203696921467781, -0.017443176358938217, 0.016319120302796364, -0.008308530785143375, -0.024647966027259827, -0.023239510133862495, 0.0026967176236212254, -0.000758398964535445, 0.02898167446255684, -0.0014219980221241713, -0.03645731881260872, -0.021980026736855507, 0.028764989227056503, 0.028114931657910347, 0.003927423153072596, 0.016752490773797035, 0.02160082757472992, -0.011538498103618622, 0.03954508900642395, -0.054523468017578125, 0.01581803523004055, 0.005870820488780737, -0.02168208360671997, -0.001530340756289661, -0.01642746292054653, 0.002937102923169732, 0.028412874788045883, 0.01891934499144554, -0.013414180837571621, -0.02613767795264721, 0.04317456856369972, 0.037026118487119675, -0.01982671581208706, 0.018377631902694702, -0.005576263647526503, 0.019230829551815987, -0.007198018487542868, 0.02016528695821762, 0.02204774133861065, 0.05295249819755554, -0.0014727836241945624, 0.026422077789902687, 0.03448006510734558, -0.043960053473711014, -0.03456132486462593, 0.011721326038241386, -0.002490189392119646, 0.01725357584655285, -0.008924730122089386, 0.0039680516347289085, -0.0118228979408741, -0.008254359476268291, 0.013129781931638718, -0.014409580267965794, 0.047860391438007355, 0.019880887120962143, 0.015262778848409653, 0.03047138638794422, 0.004425122402608395, 0.02532510831952095, -0.005061635747551918, -0.029225444421172142, 0.017903631553053856, -0.02445836551487446, -0.017294203862547874, -0.02773573249578476, -0.024742765352129936, 0.02417396567761898, 0.03732406347990036, -0.048645876348018646, -4.3676977838913444e-06, -0.004821250215172768, 0.03136521205306053, 0.006473476532846689, -0.017673403024673462, -0.025270937010645866, 0.0034364950843155384, 0.003575309179723263, 0.015357578173279762, 0.0029117101803421974, 0.0410618856549263, 0.01287923939526081, -0.0009505379712209105, 0.024905279278755188, 0.012195325456559658, 0.0343446359038353, 0.010319642722606659, 0.013095924630761147, -0.02435002289712429, 0.01287923939526081, -0.003262131242081523, 0.03228612616658211, -0.0074824183247983456, -0.021126827225089073, 0.018242202699184418, -0.01992151513695717, 0.001210391172207892, -0.019772544503211975, -0.052573297172784805, -0.019853800535202026, 0.020111115649342537, 0.024390650913119316, 0.044935137033462524, -0.0002829183649737388, 0.011017099022865295, 0.01927145943045616, -0.01572323590517044, -0.026069963350892067, 0.002595146419480443, -0.0476166196167469, 0.011619755066931248, 0.004526693839579821, -0.05449638143181801, 0.03957217186689377, 0.027180476114153862, 0.011741640977561474, 0.016129519790410995, -0.00874867383390665, 0.022169625386595726, 0.01493775099515915, 0.021438313648104668, -0.012412011623382568, 0.010773328132927418, -0.02416042424738407, 0.019217288121581078, -0.013197495602071285, 0.005081950221210718, -0.0067544905468821526, 0.0023462967947125435, 0.02338848076760769, 0.03074224293231964, 0.026774190366268158, 0.04152234271168709, -0.004242294002324343, 0.05457763746380806, 0.021289341151714325, -0.02311762422323227, -0.0011409841245040298, 0.017294203862547874, -0.03128395602107048, -0.02764093317091465, -0.016481634229421616, 0.023144710808992386, 0.003805537475273013, -0.02417396567761898, -0.05509226769208908, 0.008701273240149021, 0.005897906143218279, -0.009947214275598526, -0.01760569028556347, 0.011166069656610489, 0.009371643885970116, 0.008768987841904163, -0.010130043141543865, 0.028304532170295715, 0.00035084414412267506, -0.04339125379920006, 0.01342772413045168, -0.0037242805119603872, -0.029550472274422646, -0.011673926375806332, -0.026422077789902687, -0.01488357875496149, 0.024918822571635246, 0.022250883281230927, -0.013434495776891708, 0.013976208865642548, -0.018973516300320625, 0.011491098441183567, -0.00888410210609436, 0.010123271495103836, -0.012154697440564632, 0.0025223535485565662, 0.002745810430496931, 0.009182044304907322, -0.028467046096920967, -0.03919297456741333, 0.016305577009916306, -0.02294156886637211, -0.009920128621160984, 0.010881670750677586, 0.04303913936018944, -0.0003464003966655582, -0.013197495602071285, -0.013055295683443546, 0.02949630096554756, 0.001559965661726892, 0.02719401940703392, 0.012330754660069942, 0.000890441588126123, -0.012946953065693378, 0.009188815951347351, -0.0034432667307555676, 0.010075871832668781, -0.012858924455940723, 0.04079102724790573, 0.007726189214736223, 0.020381972193717957, 0.03545514866709709, 0.016766034066677094, 0.01813386008143425, -0.03832623362541199, 0.0259616207331419, 0.026151221245527267, 0.00287785311229527, -0.00885024480521679, -0.010996785014867783, -0.025094879791140556, 0.014084551483392715, 0.027315905317664146, 0.002490189392119646, -0.011111898347735405, -0.002513889456167817, 0.0055017778649926186, 0.02177688293159008, -0.011761954985558987, -0.0010664984583854675, 0.0014296158915385604, 0.0002522353606764227, 0.027072133496403694, 0.008775759488344193, -0.007204790133982897, -0.05449638143181801, -0.0094258151948452, -0.017822375521063805, 0.002595146419480443, 0.008017360232770443, -0.054360952228307724, -0.00393080897629261, 0.04379753768444061, -0.011470784433186054, -0.0010343343019485474, 0.059859346598386765, 0.0003480932500679046, 0.013244896195828915, 0.01435540895909071, -0.01488357875496149, -0.00324350968003273, 0.007841303013265133, 0.018242202699184418, -0.015303406864404678, 0.005373121239244938, 0.024106252938508987, 0.004486065357923508, -0.024675050750374794, -0.004073008429259062, 0.025013621896505356, -0.004018837120383978, -0.032204870134592056, -0.014260608702898026, 0.011362440884113312, -0.025189679116010666, 0.05157112702727318, 0.005782791879028082, 0.004414965398609638, 0.0018011975334957242, 0.015709692612290382, -0.007130304351449013, -0.04593730717897415, 0.015709692612290382, -0.005992705933749676, 0.013007896021008492, 0.022630082443356514, -0.002717031864449382, 0.001331430277787149, -0.0044183507561683655, -0.027871161699295044, 0.004106865730136633, 0.0022464182693511248, 0.024729222059249878, 0.012642239220440388, 0.032204870134592056, -0.0026323890779167414, -0.01652226224541664, 0.03618646413087845, -0.053981754928827286, 0.013197495602071285, -0.023429110646247864, 0.004611336626112461, 0.007049047388136387, 0.02346973866224289, 0.054360952228307724, 0.04336416721343994, 0.005694763269275427, 0.01302143931388855, -0.03553640842437744, 0.018282830715179443, -0.01329229585826397, -0.021126827225089073, -0.014707522466778755, 0.0015963620971888304, 0.07118115574121475, -0.020395513623952866, 0.005979163106530905, -0.0002325559180462733, -0.022873854264616966, 0.035942692309617996, -0.0016310656210407615, -0.01474815048277378, -0.013651181012392044, 0.005359578412026167, 0.008220503106713295, 0.01644100621342659, 0.010427985340356827, -0.004452208057045937, 0.04005971550941467, -0.021668540313839912, -0.01280475314706564, 0.039409659802913666, 0.00530879246070981, 0.048293761909008026, 0.04975638911128044, -6.369366019498557e-05, -0.014788779430091381, -0.005386664066463709, -0.024241680279374123, 0.007909017615020275, 0.00033793612965382636, 0.004509765189141035, 0.020950770005583763, 0.04141400009393692, -0.03263824060559273, -0.025135507807135582, -0.024864651262760162, 0.012777667492628098, -0.03317995369434357, 0.02302282489836216, 0.013989752158522606, 0.040303487330675125, -0.01714523322880268, 0.00786161795258522, 0.014815865084528923, -0.003927423153072596, -0.01875683106482029, 0.0015388049650937319, -0.01734837517142296, -0.009825329296290874, -0.01912248693406582, 0.016021177172660828, 0.008680959232151508, 0.011606212705373764, -0.012919867411255836, 0.00479755038395524, 0.0117822689935565, 0.007475646678358316, -0.015709692612290382, -0.001240016077645123, 0.02302282489836216, 0.05463181063532829, 0.00442173657938838, -0.002525739371776581, -0.035509321838617325, -0.01107127033174038, -0.029794244095683098, 0.03342372551560402, 0.02995675802230835, -0.012987582013010979, -0.0180526040494442, -0.0038630946073681116, 0.0010817341972142458, 0.03821789100766182, -0.01519506424665451, 0.012994353659451008, -0.015628434717655182, 0.00582003453746438, -0.014423122629523277, 0.0030809957534074783, -0.03109435737133026, -0.007211561314761639, 0.03206944093108177, 0.002329368144273758, -0.012249496765434742, -0.006818818859755993, -0.0056981490924954414, 0.012371382676064968, 0.007340218406170607, 0.025650136172771454, 0.01554717868566513, -0.008118931204080582, -0.012777667492628098, 0.010786870494484901, -0.0019840258173644543, 0.007922559976577759, 0.025365736335515976, 0.02176334150135517, -0.020422600209712982, -0.03591560572385788, -0.01523569319397211, -0.014585636556148529, 0.023564537987113, 0.000453261862276122, -0.02265716902911663, 0.007157390005886555, -0.006988104432821274, 0.008017360232770443, 0.0012738732621073723, -0.0006153527065180242, -0.03485926613211632, 0.007015190087258816, -0.00435740826651454, -0.0035143664572387934, -0.02650333382189274, -0.0044183507561683655, 0.017930718138813972, 0.004347251262515783, 0.012608381919562817, 0.02746487595140934, 0.014219979755580425, 0.02283322438597679, -0.0061281342059373856, -0.013881409540772438, 0.022602997720241547, 0.005478078033775091, 0.03529263660311699, 0.011111898347735405, -0.007502732332795858, -0.01435540895909071, -0.019488144665956497, -0.016928547993302345, -0.01240523997694254, -0.015208607539534569, -0.007082904223352671, -0.01690146140754223, 0.022643625736236572, -0.014125180430710316, 0.015398207120597363, 0.04024931415915489, 0.0050717927515506744, -0.013949123211205006, -0.02283322438597679, 0.0047366078943014145, 0.01725357584655285, 0.020070485770702362, 0.00038724052137695253, 0.044583022594451904, 0.004073008429259062, 0.013082381337881088, 0.0099065862596035, -0.024553164839744568, 0.030065100640058517, -0.007238646969199181, -0.02054448612034321, 0.01075978484004736, -0.0008709738031029701, 0.0047501507215201855, -0.006172148510813713, -0.005437449552118778, -0.016644148156046867, -0.023307224735617638, 0.006791733205318451, -0.01377306692302227, 0.01634620502591133, 0.01035350002348423, -0.00273226760327816, 0.034182123839855194, 0.03250281140208244, -0.037026118487119675, -0.031229784712195396, 0.0282774455845356, -0.005677835084497929, 0.018634945154190063, 0.007177704479545355, -0.005918220151215792, 0.0015752014005556703, -0.02436356619000435, -0.006988104432821274, -0.008511673659086227, -0.004299851134419441, 0.002681481884792447, -0.0317985825240612, -0.030986014753580093, -0.05067729949951172, -0.002796596148982644, 0.03448006510734558, 0.008315302431583405, -0.024607336148619652, -0.02498653717339039, 0.018106775358319283, 0.0009293772745877504, -0.0012577910674735904, -0.012208868749439716, -0.011599441058933735, -0.021560197696089745, 0.016481634229421616, -0.018540145829319954, -0.015140892937779427, 0.009432586841285229, -0.01004878617823124, 0.041386913508176804, 0.05752997845411301, 0.017646318301558495, 0.011572355404496193, -0.028142018243670464, -0.019176658242940903, -0.010841041803359985, -0.02329368144273758, 0.027613846585154533, 0.004079780075699091, 0.03513012081384659, -0.03829914703965187, -0.02382185310125351, 0.0035109808668494225, -0.009073701687157154, 0.0029134030919522047, -0.006788347847759724, 0.013265210203826427, -0.0007334293331950903, -0.021654998883605003, 0.001078348490409553, -0.0456935353577137, -0.03726989030838013, -0.005010850261896849, -0.007922559976577759, 0.02035488560795784, -0.007326675578951836, -0.005254621151834726, 0.021803969517350197, 0.0045199221931397915, -0.009886272251605988, 0.014653351157903671, -0.0010935842292383313, -0.012588067911565304, -0.030688071623444557, 0.004716293420642614, -0.0026459319051355124, 0.018783915787935257, 0.0028947817627340555, 0.019880887120962143, -0.0036938090343028307, 0.01866203173995018, 0.03190692514181137, -0.017361918464303017, 0.017389005050063133, 0.024959450587630272, 0.029848415404558182, -0.03047138638794422, 0.035238463431596756, 0.03992428630590439, 0.0330716110765934, -0.04970221593976021, 0.012066668830811977, -0.024512536823749542, -0.008471045643091202, -0.0009886272018775344, -0.032123614102602005, 0.033992525190114975, -0.027979504317045212, -0.0024157038424164057, -0.037026118487119675, 0.007644932251423597, 0.022264426574110985, -0.003319688141345978, 1.891236206574831e-05, 0.00024165501235984266, 0.006676619406789541, -0.017822375521063805, 0.04406839609146118, -0.010414442978799343, 0.012852153740823269, 0.012506810948252678, 0.00303359585814178, 0.011938012205064297, -0.002896474441513419, -0.006615676451474428, -0.00973052904009819, -0.008200188167393208, 0.021113283932209015, -0.026530420407652855, -0.016102435067296028, 0.02141122706234455, -0.020476771518588066, 0.030552642419934273, 0.015926377847790718, -0.01786300353705883, -0.012500039301812649, -0.019596487283706665, -0.00397482281550765, -0.012797982431948185, -0.016237862408161163, 0.014409580267965794, -0.0021346898283809423, 0.001895997324027121, 0.008911187760531902, -0.003343388205394149, -0.04739993438124657, 0.00977115798741579, 0.004303236957639456, -0.018716203048825264, -0.009209129959344864, -0.004167808685451746, 0.04471845179796219, -0.04000554233789444, -0.017754660919308662, -0.012926639057695866, 0.03596977889537811, 0.011260869912803173, 0.025257393717765808, -0.024675050750374794, 0.02275196835398674, -0.017036890611052513, -0.00537989242002368, -0.010400899685919285, -0.006531033664941788, -0.02072054333984852, 0.020991399884223938, 0.027315905317664146, -0.021208085119724274, -0.011721326038241386, 0.01151141244918108, 0.0221289973706007, 0.04880838841199875, 0.011436927132308483, 0.0013119624927639961, -0.014910665340721607, 0.024471908807754517, 0.062080372124910355, -0.01618369109928608, 0.03561766445636749, 0.011741640977561474, 0.025636592879891396, 0.008836701512336731, 0.03672817721962929, 0.009676357731223106, 0.018770374357700348, -0.013712123967707157, -0.014517922885715961, 0.027762819081544876, 0.018011974170804024, 0.0029641888104379177, 0.045124735683202744, -0.03120269998908043, -0.016292033717036247, 0.00963572971522808, -0.006327891256660223, -0.033911265432834625, -0.021018484607338905, 0.001473630079999566, 0.0037852232344448566, 0.0038224661257117987, -0.04195571318268776, 0.005752320401370525, 0.07762754708528519, 0.032042354345321655, -0.020016314461827278, -0.004875421989709139, -0.00036459858529269695, 0.0066935475915670395, 0.03431755304336548, -0.04203696921467781, -0.01195832621306181, -0.006740947719663382, -0.03380292281508446, 0.018011974170804024, 0.02105911262333393, 0.007888703607022762, -0.003047138685360551, 0.008112160488963127, -0.0018164331559091806, -0.023212425410747528, 0.0014372337609529495, -0.03938257321715355, -0.01550654973834753, 0.015398207120597363, 0.010062328539788723, 0.04358085244894028, -0.02479693666100502, -0.017890090122818947, -0.001708090421743691, -0.01572323590517044, 0.011172841303050518, 0.007489189505577087, 0.021113283932209015, -0.02141122706234455, 0.020490314811468124, -0.008518445305526257, -0.01021807175129652, 0.026950247585773468, -0.009256529621779919, 0.010055557824671268, 0.019813172519207]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
"1F1B pipeline schedule. Indeed,
adding one minimalistic early-exit layer (which has the same structure as the final output layer) to some middle (i.e. not the
first or last) stage will only make its model size and theoretical forward/backward time match exactly those of the last stage.
Therefore, the aforementioned implicit bubbles and some of the idle memory can be automatically utilized for computation
related to the early-exit layers, leading to more balanced load across pipeline stages.
More specifically, the overhead to training time caused by additional early exits can be negligible. If we choose kmiddle
stages and add one minimalistic early-exit layer to each of them, then the training time per iteration, i.e. time for processing
one data batch, will (in theory) increase only by k×(fEE+bEE), where fEEandbEErepresent the time needed for one
forward and backward pass of one microbatch for one minimalistic early-exit layer, respectively. To see this, first notice
that the computation of early-exit layers in the steady 1F1B phase can perfectly fit into the implicit bubbles. Therefore, the
critical path remains the same as in the case without early exits, which consists of (1) the forward steps on all stages for the
first microbatch, (2) the 1F1B steady phase on the last stage, and (3) the backward steps on all stages for the last microbatch.
The early-exit layers, located separately on kmiddle stages, will cause a k×fEEoverhead to the first part of the critical
path, and a k×bEEoverhead to the third part, leading to the aforementioned claim on the overhead to training time. See
Figures 3(a) and (b) for a visualization.
3For simplicity, we do not consider other flexible ways of dividing an LLM into pipeline stages, as dividing Transformer layers evenly
remains one of the most practical and robust options in practice. We also do not consider the case where the input/output embedding
matrix occupies a separate pipeline stage, although our techniques for training an early-exit LLM can be generalized to this case in
principle.
14
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
A.2. Further performance optimizations
Reducing activation memory overhead. So far, we have analyzed training time and memory usage by model parameters.
Another major component of memory usage, namely the memory for gradients and optimizer states, can be bounded by the
memory for model parameters multiplied by a universal constant. One remaining issue that we have not addressed is the
activation memory overhead due to early-exit computation. Most notably, the early-exit logits for one microbatch have size
s×b×V, where sis the maximum sequence length, bis the microbatch size, and Vis the vocabulary size. If the i-th stage
has one early exit, then a vanilla implementation of training with early exits using the 1F1B pipeline schedule (as shown in
Figure 3(b)) will cause a significant memory overhead of size s×b×V×(P−i+ 1) , where P−i+ 1is the number of
in-flight microbatches (Korthikanti et al., 2022) for Stage i.
Our solution for resolving this issue is simple: deferring the forward computation of each early-exit layer for each microbatch
from the forward step to the corresponding backward step. Note that this is feasible, because forward computation of the
next stage only requires as input the hidden states returned by the current stage, while the results of early-exit forward
computation are optional. By adjusting the order of computation in this way, it is guaranteed that the early-exit logits
for each microbatch are generated, used, and discarded immediately, within the same backward step; consequently, the
activation memory overhead due to early-exit logits is reduced from s×b×V×(P−i+ 1) tos×b×V. As long as this
amount of memory usage is less than the activation memory of allTransformer layers within one stage for one microbatch
(and no early exit is added to the first stage), the peak memory across all pipeline stages will stay unchanged, since the first
stage remains the bottleneck of memory usage.
Remark A.2.One can check that, with the above adjustment, our analysis in Section A.1 about the training time overhead
caused by early exits remains valid after minor modifications. More specifically, the time overhead of one training iteration
is still k×(fEE+bEE); the only difference is that this whole overhead comes from the backward steps of the last microbatch,
i.e. the third","[0.00954506266862154, 0.005267607048153877, 0.05576534569263458, -0.024040883406996727, -0.014575033448636532, -0.010013733990490437, 0.04359307885169983, 0.045150917023420334, -0.011637583374977112, 0.06104615330696106, 0.03638477623462677, -0.01557838637381792, -0.05423390865325928, -0.008046632632613182, -0.02936129830777645, -0.01312281098216772, 0.010515411384403706, 0.0006031673983670771, -0.007894809357821941, 0.01549917459487915, 0.028463561087846756, -0.024608571082353592, 0.030602289363741875, 0.05172552540898323, 0.04853063449263573, -0.01893169991672039, 0.01666095294058323, -0.014258184470236301, 0.008746339939534664, -0.04066222906112671, 0.04000212997198105, -0.031447216868400574, -0.05433952435851097, -0.02382965013384819, 0.027354590594768524, 0.034166835248470306, 0.025598721578717232, 0.03775778412818909, -0.0054986425675451756, 0.037124086171388626, 0.008389885537326336, -0.029123662039637566, -0.06263039261102676, 0.026998136192560196, 0.0008738088654354215, 0.024423742666840553, 0.010244769975543022, 0.014588234946131706, -0.01600085198879242, 0.06273601204156876, 0.01844322495162487, 0.027143359184265137, -0.03017982468008995, -0.0010825658682733774, -0.0053105135448277, 0.010759648866951466, 0.011406547389924526, -0.007399733643978834, 0.02711695432662964, -0.0019605003762990236, 0.0538642518222332, -0.06664381176233292, 0.02401447854936123, -0.028014691546559334, -0.01092467363923788, 0.047896940261125565, -0.03725610673427582, 0.05304572731256485, 0.023473195731639862, 0.040371786803007126, -0.038101036101579666, 0.006858450826257467, -0.007043279241770506, -0.020925205200910568, -0.008257864974439144, 0.022588660940527916, 0.04662954434752464, 0.03857630863785744, 0.014601437374949455, -0.03213372454047203, 0.022443437948822975, -0.017690710723400116, 0.07081565260887146, -0.021651316434144974, 0.008317274041473866, -0.029994996264576912, -0.00922821369022131, -0.02690572291612625, -0.041243117302656174, -0.031579237431287766, 0.0026404045056551695, -0.021176043897867203, -0.04171839356422424, 0.011294330470263958, 0.04932275786995888, 0.04108469560742378, 0.012759755365550518, -0.07308639585971832, 0.030127014964818954, 0.048873886466026306, 0.025664731860160828, 0.006584508810192347, 0.03643758222460747, -0.023103538900613785, 0.005455736070871353, -0.03622635081410408, -0.012376896105706692, 0.014178972691297531, -0.03952685743570328, -0.011888421140611172, -0.003331860527396202, -0.02186254970729351, -0.010799254290759563, -0.009723289869725704, -0.007941016927361488, -0.03350673243403435, -0.050695765763521194, 0.04449081793427467, 0.009987330064177513, 0.026073994114995003, -0.023697631433606148, -0.013690497726202011, -0.00015780542162247002, -0.009690284729003906, 0.00673303147777915, 0.002638754202052951, 0.04552057385444641, -0.01086526457220316, 0.0070036728866398335, -0.05433952435851097, 0.02315634861588478, 0.003331860527396202, 0.06907298415899277, -0.033876389265060425, -0.024740589782595634, -0.01679297350347042, -0.005538248457014561, 0.030892733484506607, 0.0028961936477571726, -0.002982006873935461, 0.04198243096470833, -0.010383390821516514, -0.0060399253852665424, -0.018509235233068466, -0.014403406530618668, 0.09362874180078506, -0.03245057165622711, 0.01743987202644348, -0.00971668865531683, -0.002130476525053382, 0.01453542709350586, -0.008422890678048134, -0.017255043610930443, -0.044332392513751984, 0.028278732672333717, 0.00024093691899906844, -0.01841682195663452, 0.029493318870663643, 0.09220292419195175, -0.01845642738044262, -0.019010912626981735, -0.0018169283866882324, 0.022483045235276222, -0.004828639794141054, 0.02709055133163929, 0.05951471999287605, -0.06933702528476715, -0.03654319792985916, -0.07651892304420471, -0.05993718281388283, -0.011663987301290035, -0.047870535403490067, -0.039421238005161285, -0.04589023068547249, -0.008053233847022057, -0.03902518004179001, -0.10677795857191086, -0.06247197091579437, 0.024080488830804825, -0.04356667399406433, -0.02970455028116703, 0.037308916449546814, -0.0005322065553627908, 0.013406653888523579, -0.06717189401388168, 0.027380995452404022, 0.022575458511710167, 0.02188895456492901, 0.012396699748933315, 0.024278519675135612, -0.016066862270236015, 0.03627915680408478, 0.042035240679979324, -0.000353154115146026, 0.017532285302877426, 0.0014225179329514503, 0.039077986031770706, -0.02463497407734394, 0.005297311581671238, -0.010574820451438427, 0.034510087221860886, 0.015248335897922516, 0.03601511940360069, -0.07372009754180908, 0.04866265505552292, -0.012475911527872086, -0.028120309114456177, 0.049533989280462265, -0.023935267701745033, 0.001424168236553669, -0.0002731168351601809, 0.0015207079704850912, 0.008759542368352413, 0.02200777269899845, 0.0016205483116209507, 0.014852275140583515, -0.05729677900671959, 0.02691892348229885, 0.041216716170310974, 0.0015561884501948953, 0.028199519962072372, 0.008535107597708702, 0.01749267987906933, 0.02287910506129265, -0.07588522881269455, 0.02578354999423027, 0.01862805336713791, -0.04721043258905411, -0.009162203408777714, 0.028674792498350143, -0.012112855911254883, 0.014812669716775417, -0.03741453215479851, -0.019156135618686676, 0.051144637167453766, -0.010812456719577312, -0.02546670101583004, -0.04066222906112671, 0.00521809933707118, -0.035830289125442505, -0.00815224926918745, 0.05146148428320885, -0.014575033448636532, -0.014878679998219013, -0.048240192234516144, 0.02625882253050804, -0.022073781117796898, -0.06769996881484985, 0.012555123306810856, 0.010581421665847301, 0.033216290175914764, -0.04673516005277634, -0.02743380330502987, 0.0021271759178489447, -0.0636337473988533, 0.016264891251921654, 0.03683364391326904, 0.00043154112063348293, 0.005696672946214676, 0.006221453193575144, 0.005119084380567074, 0.016858983784914017, 0.010812456719577312, 0.006435986142605543, -0.0009769496973603964, -0.009604471735656261, -0.013136012479662895, 0.011479158885776997, 0.01973702386021614, 0.01035698689520359, 0.03282022848725319, -0.03928922116756439, 0.010317380540072918, 0.01557838637381792, -0.0302062276750803, 0.004831940401345491, 0.047078412026166916, 0.020001064985990524, -0.05029970780014992, 0.010139153338968754, -0.018020760267972946, 0.01502390205860138, 0.05349459499120712, 0.0029803565703332424, 0.0068452488631010056, -0.012555123306810856, 0.0024605270009487867, 0.020595155656337738, -0.012205270119011402, -0.045467767864465714, 0.010931274853646755, 0.0026569070760160685, 0.040556613355875015, -0.014667447656393051, 0.0375201478600502, 0.0005747005343437195, -0.018047165125608444, -0.024859407916665077, 0.022747084498405457, 0.01190162356942892, 0.02920287474989891, -0.05080138519406319, -0.011122704483568668, 0.0538906566798687, -0.0036140538286417723, 0.03345392644405365, -0.029334895312786102, 0.011142507195472717, -0.041401542723178864, 0.014456215314567089, -0.02301112562417984, 0.005099281203001738, -0.0179679524153471, 0.03820665553212166, -0.014139366336166859, -0.005416129715740681, -0.010462602600455284, -0.04826659336686134, 0.008132445625960827, -0.016449719667434692, -0.011155709624290466, -0.05529006943106651, -0.02397487312555313, -0.018047165125608444, 0.03382358327507973, 0.014654245227575302, 0.009340430609881878, 0.03303145989775658, -0.024212509393692017, -0.0031915889121592045, -0.02496502548456192, -0.024278519675135612, -0.016066862270236015, -0.04747447371482849, -0.02352600358426571, -0.025044236332178116, -0.04346105828881264, -0.019380569458007812, 0.05935629457235336, 0.03250338137149811, -0.05824732407927513, 0.0006448362837545574, -0.034668512642383575, 0.017703913152217865, -0.010073143057525158, 0.04303859546780586, 0.029176469892263412, 0.001914293272420764, 0.08216939121484756, 0.014654245227575302, -0.02743380330502987, -0.007333723828196526, 0.016119670122861862, -0.033374711871147156, 0.03115677274763584, -0.018218791112303734, 0.03561905771493912, -0.04340825229883194, -0.014390205033123493, 0.02204737812280655, -0.013301038183271885, -0.019869044423103333, 0.02169092372059822, 0.013980941846966743, -0.027539419010281563, 0.028437156230211258, -0.014812669716775417, 0.021968165412545204, -0.01663454808294773, 0.009399840608239174, 0.03464210778474808, 0.04950758442282677, -0.0031090762931853533, -0.0058517963625490665, -0.04261612892150879, -0.026021186262369156, -0.00778919318690896, 0.0261003989726305, 0.011663987301290035, 0.03461570292711258, -0.00012871972285211086, 0.03775778412818909, -0.019380569458007812, 0.019142933189868927, 0.013809315860271454, 0.028463561087846756, 0.0030859727412462234, -0.017136225476861, -0.05370583012700081, -0.008680329658091068, -0.005396327003836632, 0.025506308302283287, -0.012799360789358616, 0.006056427955627441, 0.005280809011310339, -0.01549917459487915, 0.03398200497031212, 0.027856267988681793, 0.048213787376880646, -0.008059835061430931, -0.024067288264632225, -0.019842639565467834, -0.034351661801338196, -0.05518445372581482, 0.04280095919966698, -0.03247697651386261, 0.07530433684587479, -0.0244765505194664, 0.04063582420349121, 0.002683311002328992, 0.04718402773141861, 0.005561352241784334, 0.022496245801448822, -0.01035698689520359, 0.007894809357821941, -0.020146286115050316, 0.00024506254703737795, 0.021756934002041817, 0.010238168761134148, 0.06733031570911407, -0.03282022848725319, -0.014297790825366974, -0.04053020849823952, -0.0085681127384305, -0.050510939210653305, 0.02334117703139782, 0.013994144275784492, 0.002503433497622609, -0.010858663357794285, -0.06838648021221161, -0.025347882881760597, 0.019803034141659737, -0.011512164026498795, -0.007366728503257036, -0.02415970154106617, -0.03382358327507973, -0.028437156230211258, 0.001691509154625237, -0.032080914825201035, -0.0034226244315505028, 0.003465530928224325, -0.001023156801238656, -0.007749587297439575, 0.008931168355047703, -0.0635281354188919, 0.0023549108300358057, -0.05629342421889305, -0.014654245227575302, 0.004716422408819199, -0.005957412533462048, 0.01924854889512062, 0.016449719667434692, 0.029493318870663643, 0.04306499660015106, 0.011835613287985325, -0.0636337473988533, 0.08950971066951752, 0.002381314756348729, 0.007729784119874239, -0.004795634653419256, 0.019842639565467834, -0.008581315167248249, -0.00751195102930069, -0.007049879990518093, -0.027169762179255486, 0.01749267987906933, 0.042668938636779785, -0.017677508294582367, 0.005729678086936474, 0.015076709911227226, -0.0015751663595438004, -0.026219217106699944, 0.05238562449812889, 0.0004220521659590304, -0.006432685535401106, 0.008304072543978691, -0.030100611969828606, -0.03899877518415451, -0.0017129624029621482, -0.010310779325664043, 0.01043619867414236, -0.012297684326767921, -0.001985254231840372, -0.04776491969823837, 0.017162630334496498, 0.07203023880720139, 0.02151929773390293, -0.042985785752534866, -0.005772584583610296, -0.01565759815275669, 0.016924992203712463, -0.02546670101583004, 0.025347882881760597, -0.01453542709350586, -0.006016822066158056, -0.035170190036296844, -0.03186968341469765, -0.03292584419250488, 0.01841682195663452, -0.013664093799889088, 0.030153419822454453, 0.010838860645890236, 0.0220341756939888, -0.01960500329732895, -0.0030727707780897617, -0.02252265065908432, -0.01944657973945141, -0.011617779731750488, -0.019525792449712753, -0.030443863943219185, -0.016687355935573578, -0.00018338434165343642, 0.017703913152217865, 0.030575884506106377, 0.005261005833745003, 0.0056405640207231045, 0.007254511583596468, 0.012832365930080414, -0.008574713952839375, 0.011234921403229237, 0.015182326547801495, -0.02085919678211212, -0.01565759815275669, -0.0032972050830721855, -0.027328187599778175, -0.027697844430804253, -0.03575107827782631, -0.08961533010005951, -0.017096620053052902, -0.002001756802201271, 0.041216716170310974, -0.006719829514622688, -0.013545275665819645, -0.009413042105734348, -0.01664775051176548, -0.007505349814891815, -0.013281234540045261, -0.026892520487308502, -0.038417886942625046, 0.014020548202097416, 0.018865689635276794, 0.038417886942625046, 0.028463561087846756, 0.04538855329155922, -0.010891668498516083, 0.00035934254992753267, 0.022641468793153763, 0.00746574392542243, 0.017756721004843712, 0.00798722356557846, -0.0025133350864052773, -0.004059622064232826, 0.006571306847035885, -0.03002139925956726, -0.03303145989775658, 0.002978706266731024, 0.005818791687488556, 0.01858844794332981, -0.003043066244572401, 0.011162309907376766, 0.027697844430804253, 3.1715797376818955e-05, 0.03118317760527134, -0.03627915680408478, -0.019024115055799484, 0.006997072137892246, 0.0012979238526895642, -0.04884748533368111, 0.016555337235331535, 0.011855415999889374, -0.033876389265060425, -0.008178653195500374, 0.017703913152217865, -0.03971168398857117, -0.0029077455401420593, 0.00027951158699579537, 0.02429172210395336, 0.04388352483510971, -0.006508597172796726, -0.011855415999889374, -0.025704339146614075, -6.745408609276637e-05, -0.04427958279848099, -0.037282511591911316, -0.01387532614171505, 0.003699866821989417, -0.049718815833330154, -0.014073356054723263, -0.047923341393470764, 0.01989544741809368, 0.012337290681898594, -0.03229214623570442, 0.014773063361644745, 0.0001389306562487036, -0.002026510424911976, -0.002681660931557417, 0.0030843226704746485, -0.0011716794688254595, -0.010198562406003475, -0.023882459849119186, 0.0122382752597332, -0.021677721291780472, 0.020001064985990524, -0.0041718389838933945, -0.010667234659194946, 0.004851743578910828, -0.04253691807389259, -0.010363588109612465, 0.005726377479732037, -0.012759755365550518, 0.020674368366599083, 0.00832387525588274, -0.019697418436408043, -0.00045381952077150345, -0.033691562712192535, -0.03118317760527134, -0.004485387355089188, -0.02299792319536209, 0.029255682602524757, -0.01427138689905405, 0.016198880970478058, -0.006132339593023062, -0.00396390724927187, -0.024740589782595634, 0.015393558889627457, -0.018575245514512062, -0.018086770549416542, -0.013928133994340897, 0.016264891251921654, 0.022641468793153763, -0.03722970560193062, 0.02352600358426571, 0.0010553366737440228, -0.003726270981132984, -0.000896087265573442, 0.0056570665910840034, -0.008693532086908817, 0.039077986031770706, -0.022799892351031303, -0.03770497813820839, 0.018311206251382828, -0.02382965013384819, 0.011228320188820362, -0.028833217918872833, 6.013108941260725e-05, 0.010251370258629322, 0.0021007717587053776, 0.00888496171683073, 0.008970774710178375, -0.03638477623462677, -0.030417460948228836, -0.02727537974715233, 0.05095980688929558, 0.030734308063983917, 0.04050380736589432, -0.020212296396493912, -0.009597870521247387, -0.0014340697089210153, 0.023446792736649513, -0.02825232781469822, -0.00873313844203949, -0.011096300557255745, -0.04501889646053314, -0.014324194751679897, 0.0326618030667305, 0.03546063229441643, -0.0026288528461009264, 0.03561905771493912, 0.017505882307887077, -0.015934841707348824, -0.012211871333420277, 0.007082885131239891, 0.001137849292717874, 0.005039872135967016, -0.016396911814808846, -0.03881394863128662, -0.021426882594823837, -0.02009347826242447, -0.017690710723400116, 0.005237902514636517, -0.03651679307222366, -0.012786159291863441, -0.01825839653611183, -0.034272450953722, -0.036147139966487885, 1.8062533854390495e-05, -0.00913579948246479, -0.03184327855706215, 0.0007921213400550187, -0.030127014964818954, -0.014561831019818783, 0.009980728849768639, 0.02529507502913475, -0.026575671508908272, 0.012746552936732769, -0.025730742141604424, -0.025730742141604424, 0.03659600764513016, -0.01502390205860138, -0.05111823230981827, -0.002151929773390293, -0.004472185391932726, -0.026007983833551407, 0.005350119899958372, 0.0019423476187512279, -0.038602713495492935, -0.027328187599778175, 0.046603139489889145, 0.05072217062115669, -0.01778312399983406, -0.04211445152759552, -0.00030117115238681436, 0.010007132776081562, -0.00034366516047157347, -0.049692414700984955, -0.0006468991050496697, 0.013109608553349972, 0.019710619002580643, -0.05341538414359093, -0.005614160094410181, -0.029150066897273064, -0.011003886349499226, -0.04956039413809776, 0.015525578521192074, 0.018033962696790695, -0.009479052387177944, -0.03070790506899357, 0.027803460136055946, 0.02087239734828472, 0.014733457006514072, 0.029783762991428375, 0.026720894500613213, 0.013624487444758415, -0.03553984686732292, 0.028938833624124527, 0.032688207924366, -0.039579663425683975, -0.02103082276880741, -0.030391056090593338, -0.011776204220950603, -0.026483258232474327, -0.030285440385341644, -0.01582922600209713, 0.06548203527927399, -0.02315634861588478, -0.0019274953519925475, 0.015076709911227226, 0.03773137927055359, 0.005716475658118725, -0.01646292209625244, -0.020951610058546066, 0.011696992442011833, -0.027618631720542908, 0.025532711297273636, 0.00840308703482151, 0.008119244128465652, 0.06067649647593498, 0.013809315860271454, 0.010106148198246956, -0.020001064985990524, -0.0009686984121799469, 0.005109182558953762, -0.019855841994285583, 0.00403981888666749, 0.0013061751378700137, 0.008587915450334549, 6.998103344812989e-05, -0.007261112332344055, 0.06791120767593384, 0.0004298908752389252, -0.01664775051176548, -0.01557838637381792, 0.03857630863785744, 0.01093787606805563, 0.023763641715049744, 0.010819057933986187, 0.015631195157766342, -0.05048453435301781, -0.020027467980980873, 0.0009695235639810562, -0.004191642161458731, -0.011928027495741844, 0.02434452995657921, -0.016568537801504135, -0.02334117703139782, -0.013716901652514935, -0.012746552936732769, 0.038444291800260544, 0.0034391270019114017, -0.06405621767044067, -0.013036997057497501, -0.026549268513917923, -0.0041883415542542934, -0.04288017004728317, -0.030628692358732224, 0.02336758002638817, 0.013281234540045261, -0.12768995761871338, 0.0023268566001206636, 0.023908862844109535, 0.013347244821488857, -0.022760286927223206, 0.01646292209625244, 0.002442374126985669, -0.0010198563104495406, 0.0067396326921880245, -0.019948257133364677, -0.02951972186565399, 0.017136225476861, -0.010726643726229668, -0.01939377188682556, 0.006237955763936043, -0.046286292374134064, 0.032397761940956116, 0.02005387283861637, 0.023433590307831764, -0.022086983546614647, -0.03804823011159897, 0.0030810220632702112, -0.029994996264576912, -0.005478839389979839, -0.056082192808389664, -0.03379717841744423, -0.015763215720653534, -0.008931168355047703, 0.010482406243681908, -0.0031173275783658028, -0.007822198793292046, 0.016740165650844574, 0.02592877298593521, -0.007307319436222315, -0.006270960904657841, 0.017664305865764618, -0.016291296109557152, 0.007063081953674555, 0.018073569983243942, 0.021294862031936646, -0.03282022848725319, -0.04678796976804733, 0.041375137865543365, -0.0030199626926332712, 0.0015825924929231405, 0.02190215513110161, 0.01157817430794239, -0.004343465436249971, 0.037467341870069504, -0.007155496161431074, -0.009049986489117146, -0.027856267988681793, -0.011096300557255745, 0.015050305984914303, -0.00640958221629262, -0.008125845342874527, -0.018337609246373177, 0.0004340164887253195, 0.02299792319536209, 0.028991641476750374, -0.020119883120059967, 0.043170616030693054, 0.003392919898033142, -0.013056800700724125, -0.010092946700751781, -0.007340324576944113, 0.04097907990217209, 0.042668938636779785, 0.006171945482492447, -0.04478126019239426, -0.009241416119039059, -0.006805642507970333, 0.0019340963335707784, -0.004336864687502384, 0.004534894600510597, 0.023790044710040092, 0.0004195767978671938, 0.029915783554315567, -0.035487037152051926, 0.0064953952096402645, 0.01281916443258524, -0.001245940919034183, 0.004789033904671669, -0.020001064985990524, -0.012759755365550518, 0.035196591168642044, 0.010059941560029984, -0.004653713200241327, 0.017373861744999886, 0.022733883932232857, 0.037124086171388626, -0.005818791687488556, 0.006237955763936043, 0.00962427444756031, 0.003115677274763584, 0.014720255509018898, 0.025044236332178116, 0.027301782742142677, 0.04993005096912384, 0.01077285036444664, 0.01699100248515606, 0.023222357034683228, -0.017690710723400116, -0.0269321259111166, 0.001504205516539514, -0.008409688249230385, -0.01110950205475092, -0.00889156199991703, -0.007287516724318266, -0.023090338334441185, 0.013413255102932453, -0.018548842519521713, 0.01239009853452444, 0.0538378469645977, 0.015776416286826134, 0.008898163214325905, 0.01729464903473854, 0.02103082276880741, 0.005135586950927973, -0.02643045037984848, -0.02169092372059822, 0.026219217106699944, -0.03313707560300827, 0.007313920650631189, -0.028173116967082024, -0.03683364391326904, 0.00964407715946436, 0.025189459323883057, -0.04351386800408363, -0.012779558077454567, -0.008211658336222172, 0.020634761080145836, 0.02381644956767559, -0.012548523023724556, -0.012766355648636818, 0.01794154942035675, 0.013195421546697617, 0.005429331678897142, 0.014007345773279667, 0.04126952216029167, -0.006138940341770649, 0.008442693389952183, 0.008191854692995548, 0.0089641734957695, 0.017215438187122345, 0.015710407868027687, 0.019222145900130272, 0.01240990124642849, 0.005914506036788225, 0.007280915509909391, 0.026562469080090523, -0.00518839480355382, -0.01827159896492958, 0.005158690270036459, -0.007802395615726709, 0.0009422943694517016, -0.02856917679309845, -0.04010774567723274, -0.032556187361478806, 0.031077561900019646, 0.03168485313653946, 0.03234495595097542, 0.010350385680794716, 0.013598083518445492, 0.014178972691297531, -0.02951972186565399, -0.02233782224357128, 0.010106148198246956, -0.028041096404194832, 0.029414106160402298, -0.01444301288574934, -0.01989544741809368, 0.04977162554860115, 0.01404695212841034, 0.03400840982794762, 0.003348363097757101, -0.0277506522834301, 0.025743944570422173, 0.01231748703867197, 0.003944104071706533, -0.01404695212841034, 0.005435932893306017, 0.009848709218204021, 0.005099281203001738, -0.0010413095587864518, -0.0027740751393139362, -0.0016898588510230184, -0.005607559345662594, 0.021136438474059105, 0.016383709385991096, 0.03234495595097542, 0.035645462572574615, 0.004683417733758688, 0.030575884506106377, 0.01651572994887829, -0.014707053080201149, -0.02545350044965744, 0.003100825008004904, -0.020304711535573006, -0.01663454808294773, 0.014878679998219013, 0.0008342028013430536, 0.00636667525395751, -0.03522299602627754, -0.06220792979001999, 0.0375729575753212, -0.0018119775922968984, -0.019538993015885353, -0.0014811019646003842, 0.023063933476805687, 0.004221346694976091, 0.01060122437775135, -0.016845781356096268, 0.03279382362961769, -0.029150066897273064, -0.014957891777157784, 0.021281661465764046, -0.010970881208777428, -0.017070215195417404, -0.0027245674282312393, -0.018364014104008675, -0.015433164313435555, 0.018667660653591156, 0.021572105586528778, -0.0020941707771271467, 0.003627255791798234, -0.0041685388423502445, 0.017334256321191788, 0.010106148198246956, 0.01501069962978363, -0.009386638179421425, -0.005855096969753504, -0.00848890095949173, 0.00945264846086502, -0.005861698184162378, -0.007313920650631189, 0.0017146127065643668, -0.025413893163204193, -0.008482299745082855, 0.02023870125412941, 0.05365302041172981, 0.01322182547301054, -0.026694489642977715, -0.00996092613786459, 0.03667521849274635, 0.009076390415430069, -0.008343677967786789, 0.01809997297823429, -0.0027839764952659607, -0.017083417624235153, -0.012502315454185009, 0.01926175132393837, 0.007888208143413067, -0.015551982447504997, 0.046418312937021255, 0.01564439758658409, 0.02660207636654377, 0.038761138916015625, 0.012502315454185009, 0.010812456719577312, 0.005709874909371138, -0.005881500896066427, 0.022258609533309937, -0.005940910428762436, -0.020357519388198853, -0.011809209361672401, -0.023565610870718956, 0.004591003526002169, 0.020964812487363815, 0.023288367316126823, -0.00599701888859272, 0.019024115055799484, 0.006010220851749182, 0.009690284729003906, -0.004251051228493452, 0.02382965013384819, -0.007947617210447788, -0.016291296109557152, 0.010660633444786072, -0.03493255376815796, -0.009274421259760857, -0.05428671836853027, -0.012964386492967606, -0.02415970154106617, 0.005861698184162378, 0.006997072137892246, -0.032714612782001495, -0.004719723016023636, 0.055870961397886276, -0.003482033498585224, 0.008924567140638828, 0.02579675242304802, 0.009809102863073349, 0.01944657973945141, 0.0375201478600502, 0.003338461508974433, 0.01928815431892872, 0.016278093680739403, -0.004072824027389288, -0.029334895312786102, -0.009769496507942677, 0.019974660128355026, 0.011215118691325188, 0.005861698184162378, -0.004495288711041212, 0.02026510424911976, 0.001863135490566492, -0.02448975294828415, -0.01493148785084486, 0.014759860932826996, -0.002109023043885827, 0.030074207112193108, 0.011729997582733631, 0.019855841994285583, -0.008007027208805084, 0.012555123306810856, 0.02005387283861637, -0.021162843331694603, 0.030787117779254913, -0.02299792319536209, 0.02759222686290741, 0.02202097326517105, -0.01746627688407898, 0.029255682602524757, -0.003175086574628949, -0.05029970780014992, -0.00308267236687243, -0.010574820451438427, -0.0005128160701133311, 0.035196591168642044, 0.03379717841744423, 0.021347669884562492, -0.00326585047878325, 0.01699100248515606, -0.03503816947340965, 0.0130700021982193, -0.0017212136881425977, 0.001991855213418603, -0.018522437661886215, 0.033348310738801956, 0.031130369752645493, 0.04942837357521057, -0.00265525677241385, 0.012442906387150288, -0.006056427955627441, 0.008997178636491299, -0.023103538900613785, -0.03184327855706215, -0.007261112332344055, 0.0020545648876577616, 0.057666435837745667, -0.01502390205860138, 0.021611711010336876, -0.008059835061430931, -0.020304711535573006, 0.010574820451438427, 0.03847069293260574, -0.010944477282464504, -0.013334043323993683, 0.002118924632668495, 0.002414319897070527, 0.03017982468008995, 0.01597444713115692, 0.0034424273762851954, 0.034219641238451004, 0.030259035527706146, -0.009584668092429638, 0.045784614980220795, 0.01502390205860138, 0.03823305666446686, 0.04831940308213234, 0.003054617904126644, -0.025717539712786674, -0.005323715507984161, -0.02417290396988392, -0.008092840202152729, 0.0005837769131176174, -0.004990364424884319, 0.02136087231338024, 0.009809102863073349, -0.02644365094602108, -0.03054947964847088, 0.003594250651076436, 0.02006707526743412, -0.017083417624235153, 0.01745307445526123, -0.005716475658118725, 0.050035666674375534, -0.025057438760995865, 0.016291296109557152, -0.01825839653611183, 0.01794154942035675, -0.021110033616423607, 0.0002918884565588087, -0.012528719380497932, 0.011736597865819931, -0.00324274692684412, 0.0038021826185286045, 0.006792440544813871, 0.016264891251921654, 0.003071120474487543, 0.012297684326767921, -5.337536640581675e-05, 0.0055151451379060745, 0.0019605003762990236, -0.016410114243626595, 0.020212296396493912, 0.017334256321191788, 0.016370508819818497, -0.0022657972294837236, -0.02643045037984848, -0.025427095592021942, -0.008284268900752068, 0.024516155943274498, 0.024542560800909996, -0.020027467980980873, -0.014707053080201149, 0.016581740230321884, -0.007941016927361488, 0.010667234659194946, 0.0061191376298666, 0.002440724056214094, -0.000673303147777915, -0.0072149052284657955, -0.004716422408819199, 0.01435059867799282, -0.051672715693712234, 0.011452754959464073, 0.029308490455150604, 0.0003100412432104349, -0.04678796976804733, -0.0054095289669930935, -0.0024159702006727457, 0.0005846020649187267, 0.015063507482409477, 0.024225711822509766, 0.037308916449546814, -0.00448208674788475, -0.025981580838561058, 0.0022624966222792864, -0.0068782540038228035, 0.015380356460809708, 0.014297790825366974, 0.016581740230321884, 0.009710087440907955, -0.027961883693933487, -0.017505882307887077, -0.04116390645503998, 0.01493148785084486, -0.0071092890575528145, -0.01975022628903389, -0.010271173901855946, -0.0072149052284657955, 0.013254830613732338, -0.011848815716803074, -0.016080062836408615, -0.0587754063308239, 0.003927601967006922, 0.010891668498516083, 0.02200777269899845, -0.04227287694811821, 0.00460420548915863, -0.008211658336222172, 0.016291296109557152, 0.011624380946159363, 0.004343465436249971, 0.02433132752776146, 0.03947404772043228, -0.02121565118432045, -0.0002995208778884262, 0.018179185688495636, 0.009109395556151867, 0.0261400043964386, -0.003455629339441657, -0.02026510424911976, 0.006294064223766327, -0.021136438474059105, -0.007749587297439575, -0.011591375805437565, -0.04066222906112671, 0.016581740230321884, 0.008785946294665337, 0.02417290396988392, -0.020634761080145836, -0.008317274041473866, 0.01012595184147358, 0.009967527352273464, -0.004013414960354567, -0.02629842981696129, -0.007808996364474297, 0.01378291193395853, -0.001382086775265634, 0.007914613001048565, 0.029625339433550835, 0.017387064173817635, 0.0359623096883297, 0.018047165125608444, -0.020687568932771683, 0.0022113388404250145, -0.003633856773376465, -0.004680117126554251, 0.005967314355075359, -0.02430492453277111, 0.031235985457897186, 0.007478945888578892, -0.013076603412628174, -0.020040670409798622, -0.03115677274763584, 0.024529358372092247, -0.01355847716331482, 0.03279382362961769, 0.01510311383754015, 0.0007970721344463527, 0.015921639278531075, 0.037625763565301895, -0.011736597865819931, -0.021268459036946297, 0.012436305172741413, -0.009426244534552097, -0.0008148123160935938, -0.0003170548297930509, -0.021096833050251007, -0.0026453554164618254, -0.024212509393692017, -0.02348639816045761, 0.015604791231453419, 0.020436730235815048, 0.01939377188682556, -0.04911152273416519, -0.02547990344464779, -0.018324406817555428, 0.005719776265323162, 0.03944764286279678, 0.015433164313435555, -0.018324406817555428, -0.009076390415430069, 0.010739845223724842, 0.02332797460258007, -0.009096194058656693, -0.014746659435331821, -0.008409688249230385, -0.013796113431453705, 0.016542134806513786, -0.04113750159740448, -0.011763001792132854, 0.0011700292816385627, -0.02250944823026657, 0.060465265065431595, 0.03847069293260574, -0.023869257420301437, 0.003706467803567648, -0.010383390821516514, -0.021321266889572144, -0.018694063648581505, -0.020529145374894142, 0.012205270119011402, -0.006964066997170448, 0.007974022068083286, -0.04177119955420494, -0.01565759815275669, 0.006181847304105759, 0.0049210540018975735, -0.02936129830777645, -0.028780410066246986, 0.023116741329431534, 0.016264891251921654, -0.01679297350347042, -0.021466488018631935, -0.03638477623462677, -0.048873886466026306, -0.015961244702339172, -0.01697780191898346, 0.04177119955420494, 0.004472185391932726, -0.0020182591397315264, 0.011465956456959248, 0.004805536475032568, 0.004491988103836775, 0.018390417098999023, -0.027671439573168755, -0.0030694701708853245, -0.02809390425682068, 0.007980622351169586, 0.007188501302152872, 0.021149640902876854, -0.0138621237128973, 0.009505456313490868, -0.010825658217072487, -0.009967527352273464, 0.026522863656282425, -0.006683523766696453, -0.009254617616534233, -0.007762789260596037, -0.005964013747870922, -0.019367367029190063, 0.028199519962072372, 0.01780952885746956, 0.027024541050195694, -0.036173541098833084, 0.023539206013083458, -0.03905158489942551, -0.017057012766599655, -0.004924354609102011, -0.014482619240880013, 0.00778919318690896, -0.03297865390777588, 0.003947404678910971, -0.03234495595097542, 0.02155890315771103, -0.010634229518473148, -0.01541996281594038, 0.025202661752700806, -0.004036518279463053, -0.015380356460809708, -0.013848922215402126, 0.01960500329732895, -0.019024115055799484, 0.0006464865291491151, -0.001029757782816887, 0.004105829168111086, 0.004178440198302269, 0.0010990684386342764, -0.0029737555887550116, 0.0023961670231074095, 0.00283843488432467, 0.021585308015346527, -0.017083417624235153, -0.01158477459102869, 0.018377216532826424, -0.029308490455150604, 0.05465637519955635, 0.017096620053052902, 0.016251690685749054, -0.023037530481815338, -0.0007661298732273281, 0.011446153745055199, -0.005231301300227642, 0.007888208143413067, -0.00481873843818903, 0.0003121040645055473, 0.01280596200376749, -0.007155496161431074, 0.020647963508963585, -0.03118317760527134, -0.0006613388541154563, -0.01240990124642849, -0.02091200463473797, -0.02351280301809311, 0.008271067403256893, 0.013096406124532223, -0.013426457531750202, 0.008073036558926105, -0.00889156199991703, 0.01829800382256508, 0.02809390425682068, 0.02922927774488926, -0.019803034141659737, 0.025889165699481964, 0.01743987202644348, -0.0075977640226483345, -0.017360659316182137, -0.0006827921024523675, -0.0077363853342831135, 0.0110170878469944, 0.0007809821399860084, -0.015565184876322746, -0.0036470587365329266, 0.010317380540072918, 0.01809997297823429, 0.059989992529153824, 0.03231855109333992, -0.0027905774768441916, -0.023750439286231995, 0.027143359184265137, 0.0277506522834301, -0.037097685039043427, 0.0489266961812973, 0.005145488306879997, 0.026364440098404884, -0.006680223625153303, 0.02711695432662964, 0.01663454808294773, 0.021981367841362953, -0.03004780411720276, -0.004571200348436832, 0.011855415999889374, 0.03606792539358139, -0.011221718974411488, 0.036490391939878464, -0.03836507722735405, -0.017268246039748192, -0.013155815191566944, -0.02904444932937622, -0.022984720766544342, -0.013980941846966743, 0.020832791924476624, -0.0042741550132632256, -0.003293904708698392, -0.04148075357079506, -0.002303753048181534, 0.04604865610599518, 0.05257045477628708, -0.038259461522102356, -0.008521906100213528, -0.02154570072889328, 0.005587756168097258, 0.027196167036890984, -0.04470204934477806, 0.0015776416985318065, -0.01989544741809368, -0.020212296396493912, 0.01858844794332981, 0.010878467001020908, -0.007069683168083429, -0.0015099813463166356, -0.0043104602955281734, 0.013327442109584808, -0.040398187935352325, -0.00016884149226825684, -0.031051157042384148, -0.008838754147291183, 0.02190215513110161, 0.010442799888551235, 0.030760712921619415, 0.0025793451350182295, -0.0009175405721180141, 0.0019538993947207928, -0.004686717875301838, 0.016093265265226364, 0.0187864787876606, 0.035302210599184036, -0.02740739844739437, 0.004307159688323736, -0.014654245227575302, -0.0005920281982980669, 0.02105722576379776, -0.01942017488181591, 0.016370508819818497, 0.0424577035009861]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" part of the critical path in Figure 3(c). One can further reduce this overhead to k×bEEby moving the forward
pass of the early-exit layer on each stage for each cool-down microbatch to the explicit bubble in front of the corresponding
backward step (i.e. before communication with the next stage). With that said, our implementation does not include this
modification, as it brings limited gains at the cost of complicating our codebase.
Some rules of thumb. Below are some tips for maximizing training efficiency.
•If possible, add early exits to the middle stages rather than to the first or last one. For example, adding one early exit to
the end of the first stage leads to the same model architecture as adding to the beginning of the second stage, but the
latter has higher training efficiency due to more balanced load across stages.
•Avoid adding too many early exits to the LLM. Despite higher flexibility during inference, the gain of adding many
early exits (e.g. one per layer) might be marginal, and comes at the cost of excessive overhead for training and inference,
which is especially the case for LLMs due to large vocabulary sizes. Similar observations and advice have been made
recently by the authors of (Bae et al., 2023) as well.
•If there are multiple exits within the same pipeline stage, one might use the same output embedding matrix for all exits;
similarly, if early exits are added to the first/last stage, one might reuse the original input/output embedding matrix for
early exits. These choices reduce the memory usage by model parameters, at the cost of lower expressivity of early
exits.
Remark A.3.Recall from Section 2 that, with EE-LLM , users can choose more expressive and powerful early-exit layers
beyond the minimalistic structure. Similarly, more than one early exit can be added to each pipeline stage, which provides
more flexible choices of exits during inference. These benefits, of course, come at the cost of a higher overhead for training,
and potentially for inference as well4; with EE-LLM , users can conveniently choose the most suitable configurations for
their own use cases. A formal analysis of training efficiency in these general cases will soon be presented in Appendix A.3.
Numerical examples. We complement previous analytical study with a few numerical examples. Figure 9 illustrates load
imbalance in the original 1F1B pipeline schedule for a standard 7B GPT Transformer, as well as the impacts of adding one
minimalistic early-exit layer to each middle stage (with all performance optimizations applied). Table 1 takes a close look at
4There is no clear answer to whether additional modules at early-exit layers will improve or hurt the overall inference speed. There
is certainly a higher overhead for the computation of each early-exit layer; on the other hand, higher flexibility and adaptivity of the
early exits can potentially enable them to produce better outputs and get selected more often during inference, leading to overall faster
generation of a complete sequence. For similar reasons, there is no clear positive or negative correlation between the number of early exits
and the overall speed of generating a sequence.
15
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
1 2 3 4
Pipeline stage5.05.25.45.65.86.0Forward time (s)
Standard LLM
Early-exit LLM
1 2 3 4
Pipeline stage10.010.410.811.2Backward time (s)
Standard LLM
Early-exit LLM
1 2 3 4
Pipeline stage40485664GPU memory (GB)
Standard LLM
Early-exit LLM
Figure 9: The forward time, backward time, and peak GPU memory of each pipeline stage for a standard 7B GPT
Transformer, as well as its early-exit version that has one minimalistic early-exit layer (without layer normalization) added
to each middle stage. Degrees of pipeline, tensor and data parallelism are 4, 1, and 1, respectively; the microbatch size is 2,
the global batch size is 128, and the sequence length is 2048. Note that the forward computation of early-exit layers has
been deferred to the backward steps, hence not included in “forward time” of the first plot, but in “backward time” of the
second plot.
Table 1: Training efficiency and impacts of performance optimizations, with the same setting as in Figure 9. For the
“Early-exit” row, the early exit at 1/4 depth is added to the end of Stage 1, and the exit at 1/","[0.0010118043283000588, 0.007154171820729971, 0.07527551054954529, -0.025305327028036118, -0.004111945163458586, 0.005352001637220383, 0.020590387284755707, 0.04366088658571243, 0.004023369867354631, 0.06350179016590118, 0.023915374651551247, -0.020031681284308434, -0.050065573304891586, -0.006656786426901817, -0.023070499300956726, -0.028480416163802147, 0.015016946941614151, -0.018696235492825508, 0.006741954945027828, 0.05483502149581909, 0.02290697582066059, -0.026613518595695496, 0.020753910765051842, 0.04205290228128433, 0.033767689019441605, -0.0011753281578421593, 0.0332498662173748, 0.010710816830396652, 0.002963871229439974, -0.04371539503335953, 0.055543627589941025, -0.03518489748239517, -0.033113595098257065, -0.023683715611696243, -0.013265877962112427, 0.015248605981469154, 0.03281380236148834, 0.04022688418626785, -0.015562026761472225, 0.03995434567332268, 0.02158515714108944, -0.023751849308609962, -0.06377433240413666, -0.001672713435254991, -0.009341304190456867, 0.01518047135323286, 0.03379494324326515, 0.02038598246872425, 0.006104893051087856, 0.06028582155704498, 0.015957210212945938, 0.046331778168678284, -0.034939613193273544, -0.00489549757912755, -0.008142128586769104, -0.007283627986907959, -0.00659205811098218, -0.03071524389088154, 0.027567408978939056, -0.005120343063026667, 0.04799427092075348, -0.06628169864416122, 0.021121840924024582, -0.022184746339917183, 0.0025720950216054916, 0.023642834275960922, -0.04139880836009979, 0.0343400239944458, 0.0032483346294611692, 0.030224671587347984, -0.04336109384894371, 0.0027305088005959988, -0.0018106867792084813, -0.0333043709397316, -0.001322670024819672, 0.014131192117929459, 0.04096274450421333, 0.04586846008896828, 0.024392317980527878, -0.03619329631328583, 0.015480265021324158, -0.0028855158016085625, 0.041262537240982056, -0.02699507400393486, 0.013340827077627182, -0.04368814080953598, 0.004101725295186043, -0.01492155808955431, -0.044069696217775345, -0.03834636136889458, 0.009784181602299213, -0.04022688418626785, -0.030306434258818626, 0.014362851157784462, 0.04532337933778763, 0.023574698716402054, 0.03218695893883705, -0.05096495524048805, 0.023438429459929466, 0.056306738406419754, 0.01550751831382513, 0.022457284852862358, 0.03711993247270584, -0.03602977097034454, 0.028589433059096336, -0.05374486371874809, -0.02447408065199852, 0.01059498731046915, -0.037828534841537476, -0.03218695893883705, -0.02195308730006218, -0.0001787478249752894, -0.01721089333295822, -0.006404687184840441, 0.011535249650478363, -0.02758103422820568, -0.04521436616778374, 0.03480334207415581, 0.026313723996281624, 0.03551194444298744, -0.006360399071127176, -0.005764218512922525, 0.011351285502314568, 0.004462840501219034, -0.010451904498040676, 0.0004122165555600077, 0.03335887938737869, -0.019241314381361008, 0.007419898174703121, -0.0402541384100914, 0.01497606560587883, 0.028916480019688606, 0.06998823583126068, -0.03401297703385353, -0.015902701765298843, -0.007964977994561195, -0.026531755924224854, -0.007528914138674736, -0.010513225570321083, -0.016788456588983536, 0.02681792341172695, -0.010336074978113174, 0.0003008584608323872, -0.0026180860586464405, -0.03232323005795479, 0.08759431540966034, -0.046222761273384094, 0.028616687282919884, -0.029434306547045708, 0.02260718308389187, -0.006544363684952259, -0.01026112586259842, -0.031505610793828964, -0.05246392637491226, 0.019350331276655197, 0.003587306011468172, -0.0472039058804512, 0.017197266221046448, 0.08181647211313248, -0.028071606531739235, 0.007501659914851189, 0.000528045988176018, 0.02260718308389187, 0.024160658940672874, 0.012059889733791351, 0.07124192267656326, -0.05761492997407913, -0.00911645870655775, -0.08546850085258484, -0.04197113960981369, 0.013047846034169197, -0.036220550537109375, -0.04747644439339638, -0.03938201069831848, 0.0001449997362215072, -0.031287577003240585, -0.09135536849498749, -0.04205290228128433, -0.010560920462012291, -0.06464646011590958, -0.045078095048666, 0.03346789628267288, -0.025891287252306938, 0.009981772862374783, -0.06987922638654709, 0.016570424661040306, -0.009450320154428482, 0.029870370402932167, 0.010233872570097446, 0.016502289101481438, -0.0007286182953976095, 0.04338834807276726, 0.04071745648980141, 0.0028718889225274324, -0.0003809170448221266, 0.014499121345579624, 0.04851209744811058, -0.008550938218832016, 0.006534143351018429, -0.01541212946176529, 0.02480112761259079, 0.0359480082988739, 0.04300679266452789, -0.08181647211313248, 0.05761492997407913, -0.010097602382302284, -0.03630230948328972, 0.018641727045178413, -0.015793684870004654, -0.01150799635797739, 0.0072018662467598915, 0.008046739734709263, 0.012809374369680882, 0.005801692605018616, 0.01454000174999237, 0.01110599935054779, -0.052218638360500336, 0.01028156653046608, 0.0601222962141037, 0.019227687269449234, -0.000661335012409836, -0.00024571173707954586, 0.01706099510192871, 0.011896365322172642, -0.06949766725301743, 0.024882890284061432, 0.007235933560878038, -0.0698247179389, 0.005352001637220383, 0.012461885809898376, -0.0017800260102376342, -0.002360876649618149, -0.024896517395973206, -0.0327320396900177, 0.03112405352294445, -0.032486751675605774, -0.02121722884476185, -0.035348422825336456, -0.009423065930604935, -0.03384945169091225, -0.0019367365166544914, 0.04818505048751831, -0.005617727991193533, -0.023656461387872696, -0.03551194444298744, 0.015098708681762218, -0.026872431859374046, -0.07696525752544403, -0.007760572712868452, 0.0201270692050457, 0.009218661114573479, -0.042134664952754974, -0.030115656554698944, -0.013763263821601868, -0.03908221796154976, 0.017006488516926765, 0.006469415035098791, -0.010172550566494465, -0.017197266221046448, 0.0041426061652600765, 0.0016846370417624712, 0.014022176153957844, 0.022702571004629135, 0.01324543822556734, -0.0006783687858842313, 0.012352869845926762, -0.02501915954053402, 0.012679917737841606, -0.006793056149035692, -0.03060622699558735, 0.04022688418626785, -0.03908221796154976, 0.009906824678182602, 0.018614472821354866, -0.030333688482642174, -0.01651591621339321, 0.052327655255794525, 0.023029619827866554, -0.05246392637491226, 0.0028327112086117268, -0.016270630061626434, -0.000572333752643317, 0.05766943842172623, 0.02371096983551979, -0.0057574049569666386, -0.020535878837108612, -0.002427308354526758, 0.024337811395525932, -0.009504827670753002, -0.04466928541660309, 0.005048801191151142, 0.007665183860808611, 0.03314084932208061, -0.020222458988428116, 0.031178561970591545, -0.004483280703425407, 0.00660227844491601, -0.027499273419380188, 0.0005271942936815321, 0.006469415035098791, 0.02465123124420643, -0.0279080830514431, -0.025659628212451935, 0.03949102759361267, 0.011828230693936348, 0.03025192581117153, -0.03466707095503807, -0.0012238743947818875, -0.03466707095503807, 0.018423695117235184, -0.020208831876516342, 0.01366106141358614, -0.0033505370374768972, 0.035784486681222916, -0.027349377050995827, -0.013354454189538956, -0.011221828870475292, -0.03747423365712166, 0.007317695766687393, -0.03930024802684784, -0.013143235817551613, -0.058432549238204956, -0.02853492461144924, -0.007678810972720385, 0.027390256524086, 0.03463981673121452, 0.0075834221206605434, 0.012897949665784836, -0.013906346634030342, -0.02056313306093216, 4.559187436825596e-05, -0.039463773369789124, -0.01203944906592369, -0.04216191917657852, -0.02732212282717228, -0.020535878837108612, -0.056633785367012024, 0.013122795149683952, 0.06704480946063995, 0.02973409928381443, -0.06208458170294762, 0.0088575454428792, -0.02447408065199852, 0.02279796078801155, -0.00865995418280363, 0.03469432517886162, 0.022947857156395912, -0.0003655866894405335, 0.09822337329387665, 0.021121840924024582, -0.017592448741197586, -0.031178561970591545, 0.022048475220799446, -0.013034219853579998, 0.03156011551618576, -0.007215492893010378, 0.041262537240982056, -0.027853574603796005, -0.014281089417636395, 0.025945795699954033, -0.013831398449838161, -0.014798915013670921, 0.01349753700196743, 0.02133987285196781, -0.03245949745178223, 0.031614623963832855, -0.016420526430010796, 0.03649308905005455, -0.002091743517667055, -0.00465702498331666, 0.04066294804215431, 0.06268417090177536, 0.0007814228883944452, -0.007024715188890696, -0.0558161661028862, -0.024555843323469162, -0.013449843041598797, 0.02319314330816269, 0.019704632461071014, 0.04161683842539787, -0.017442552372813225, 0.038373615592718124, -0.001418058993294835, 0.008217076770961285, -0.004329977091401815, 0.028916480019688606, -0.004929564893245697, -0.012802560813724995, -0.03352240473031998, 0.006551177240908146, -0.001564549165777862, 0.02188495174050331, -0.01691109873354435, 0.01077895238995552, 0.015207724645733833, -0.016229748725891113, 0.011909992434084415, 0.03682013601064682, 0.03608427941799164, -0.01344302948564291, -0.024174286052584648, -0.012782120145857334, -0.027962591499090195, -0.03889143839478493, 0.009068763814866543, -0.029134511947631836, 0.05832353234291077, -0.0026538569945842028, 0.038264598697423935, 0.016502289101481438, 0.04815779626369476, -0.0021479548886418343, 0.014676271937787533, -0.04232544079422951, 0.00035153384669683874, -0.043088555335998535, 0.006186655256897211, 0.019745513796806335, 0.007017901632934809, 0.0633382648229599, -0.02001805417239666, -0.0152894863858819, -0.03930024802684784, 0.00020248860528226942, -0.021925833076238632, -0.0010467234533280134, -0.003280698787420988, -0.010308820754289627, -0.032268721610307693, -0.058541566133499146, -0.008257958106696606, 0.0343400239944458, 0.016052598133683205, -0.0007682217401452363, -0.04785799980163574, -0.03126032277941704, -0.04592296853661537, 0.01470352616161108, -0.02005893550813198, -0.004299316555261612, 0.012100770138204098, -0.004616144113242626, -0.023329412564635277, 0.0048069218173623085, -0.06448293477296829, -0.01749705895781517, -0.03082425892353058, -0.004350417759269476, 0.009150526486337185, -0.013524791225790977, 0.015766432508826256, 0.028316892683506012, 0.0190641637891531, 0.052000608295202255, -0.0025976456236094236, -0.06720833480358124, 0.09849590808153152, -0.020154323428869247, 0.016488661989569664, -0.008005858398973942, 0.027526527643203735, -0.035266660153865814, -0.021353498101234436, 0.0027373223565518856, -0.04987479746341705, 0.039436519145965576, 0.0381283275783062, -0.004820548929274082, 0.023847239091992378, 0.01550751831382513, 0.007249560672789812, -0.031941674649715424, 0.05826902389526367, -0.015166844241321087, -0.018600845709443092, 0.02910725772380829, -0.02736300230026245, -0.022879721596837044, 0.00043223120155744255, -0.026695281267166138, 0.03251400589942932, -0.015030574053525925, 0.012577715329825878, -0.024678485468029976, 0.015153217129409313, 0.06306573003530502, 0.004462840501219034, -0.03213245049118996, -0.011358099058270454, -0.0011864001862704754, 0.009157340042293072, -0.015575653873383999, 0.03883693367242813, -0.01571192406117916, -0.006500076036900282, -0.029543321579694748, -0.03673837333917618, -0.019663751125335693, 0.009170967154204845, 0.007781013380736113, 0.027049582451581955, -0.01563016138970852, 0.022375524044036865, -0.0177150908857584, -0.00927998311817646, -0.019677378237247467, 0.0007175463833846152, -0.018764371052384377, -0.0015168547397479415, -0.02381998486816883, -0.037310708314180374, -0.0001425511291017756, 0.007235933560878038, 0.030633481219410896, 0.005709710530936718, 0.027785440906882286, -0.002682814374566078, 0.03513038903474808, -0.00953208189457655, 0.021271737292408943, 0.02501915954053402, -0.0228252150118351, -0.004960225895047188, -0.014458240009844303, -0.01895514875650406, -0.01535762194544077, -0.03414924442768097, -0.09577050805091858, -0.015466637909412384, -0.00045309754204936326, 0.026436368003487587, -0.018164781853556633, -0.026749787852168083, -0.007603862322866917, -0.044069696217775345, 0.0027764998376369476, -0.007917283102869987, -0.02512817643582821, -0.05551637336611748, 0.004394705407321453, 0.018287425860762596, 0.051237497478723526, 0.03455805405974388, 0.023656461387872696, -0.017633330076932907, -0.014649017713963985, 0.03177814930677414, 0.011351285502314568, 0.00316827604547143, 0.0034271888434886932, 0.021544277667999268, -0.026109319180250168, 0.020508624613285065, -0.01727902702987194, -0.039109472185373306, 0.0075834221206605434, 0.009593403898179531, 0.0088575454428792, -0.008380601182579994, 0.02338392101228237, 0.0381283275783062, -0.005546186584979296, 0.025332581251859665, -0.036111533641815186, -0.009136899374425411, 0.0053077139891684055, 0.008353346958756447, -0.050283607095479965, 0.030224671587347984, 0.0016505696112290025, -0.03126032277941704, 0.007535727694630623, 0.014131192117929459, -0.036765627562999725, 0.007603862322866917, -0.015589280985295773, 0.011065118946135044, 0.04447850584983826, 0.0158209390938282, -0.007181425578892231, -0.015112335793673992, -0.004118758719414473, -0.013824584893882275, -0.028207877650856972, -0.03668386861681938, -0.007971791550517082, -0.025632375851273537, -0.014253835193812847, -0.047285668551921844, 0.02093106135725975, 0.018709862604737282, -0.03360416740179062, 0.016338765621185303, -0.015085081569850445, -0.0295160673558712, -0.0026044591795653105, -0.0016556797781959176, -0.006687446963042021, -0.018001258373260498, -0.025291699916124344, 0.017742345109581947, -0.02180318906903267, 0.02462397702038288, -0.0008823478128761053, -0.016120733693242073, 0.028480416163802147, -0.034721579402685165, 0.006837344262748957, 0.014144819229841232, -0.03185991197824478, 0.017156384885311127, -0.003941608127206564, -0.016747575253248215, -0.0022876316215842962, -0.029870370402932167, -0.020113442093133926, -0.014294716529548168, -0.01110599935054779, 0.03581174090504646, -0.00909601803869009, 0.023547444492578506, -0.004118758719414473, -0.005794879049062729, -0.02786720171570778, 0.01695198006927967, -0.01695198006927967, -0.03142384812235832, -0.009436693042516708, -0.0028156775515526533, 0.015766432508826256, -0.030006639659404755, 0.03090602159500122, -0.0005987360491417348, -0.002829304663464427, 0.017306281253695488, 0.018832504749298096, -0.012325615622103214, 0.027485646307468414, -0.030006639659404755, -0.02888922579586506, 0.020031681284308434, -0.007263187784701586, 0.00439129862934351, -0.03237773850560188, -0.030987784266471863, 0.01170558761805296, 0.007188239134848118, 0.016202494502067566, 0.00035472767194733024, -0.03717443719506264, -0.027485646307468414, -0.023438429459929466, 0.05020184442400932, 0.037419725209474564, 0.03384945169091225, -0.025073667988181114, -0.004057437181472778, -0.0026930347084999084, 0.00021164424833841622, -0.023765476420521736, -0.02121722884476185, -0.008121687918901443, -0.05074692517518997, -0.007242747116833925, 0.03090602159500122, 0.0504198782145977, 0.0009683682583272457, 0.03616604208946228, 0.004680872429162264, -0.02338392101228237, -0.03071524389088154, 0.011235455982387066, 0.01255046110600233, -0.007746946066617966, -0.02067214995622635, -0.040526680648326874, -0.020413236692547798, -0.037201691418886185, -0.01812390238046646, 0.003187013091519475, -0.041807617992162704, 0.012155278585851192, -0.027308495715260506, -0.022634437307715416, -0.021176347509026527, -0.002720288699492812, -0.006466008257120848, -0.021094586700201035, 0.0029229901265352964, -0.013299945741891861, 0.008598633110523224, 0.01269354484975338, 0.01899602822959423, -0.021421633660793304, -0.002601052401587367, -0.013034219853579998, -0.028480416163802147, 0.047394685447216034, -0.015003319829702377, -0.04796701669692993, 0.007637930102646351, 0.021939460188150406, -0.02899824269115925, 0.02155790477991104, -0.008557751774787903, -0.015398502349853516, -0.0424344576895237, 0.04259798303246498, 0.05706984922289848, -0.029270783066749573, -0.0424344576895237, 0.003556645242497325, -0.0032091569155454636, -0.02177593670785427, -0.050719670951366425, -0.017374416813254356, 0.007079223170876503, 0.003822371596470475, -0.03308634087443352, -0.0018583812052384019, -0.031505610793828964, -0.01801488548517227, -0.04483281075954437, 0.016052598133683205, 0.010806205682456493, -0.0038700662553310394, -0.038155581802129745, 0.023588325828313828, 0.029924878850579262, 0.00977055449038744, 0.046004731208086014, 0.027894455939531326, 0.01778322644531727, -0.050283607095479965, 0.01858721859753132, 0.023533817380666733, -0.037719517946243286, -0.0211899746209383, -0.017960377037525177, -0.0007384127238765359, -0.007808267138898373, -0.024964652955532074, -0.02257992886006832, 0.03502137213945389, -0.008864358998835087, -0.010901594534516335, 0.010254312306642532, 0.03733796253800392, 0.0142129547894001, -0.013524791225790977, -0.023370293900370598, 0.012632222846150398, -0.026586264371871948, 0.015248605981469154, -0.0012988228118047118, 0.0014393512392416596, 0.0461137481033802, -0.00016746297478675842, 0.01892789453268051, -0.01782410778105259, 0.006885038688778877, 0.021312618628144264, -0.01541212946176529, 0.022702571004629135, -0.014730780385434628, 0.0026862211525440216, -0.011174134910106659, -0.008612260222434998, 0.04690411314368248, 0.008455549366772175, -0.01778322644531727, -0.0152894863858819, 0.03502137213945389, 0.0015236681792885065, 0.03240498900413513, 0.007167798466980457, 0.022143865004181862, -0.03447629511356354, -0.00281227077357471, -0.00538947619497776, -0.01921406015753746, -0.015698296949267387, 0.017142757773399353, -0.02506004087626934, -0.01680208370089531, -0.005726743955165148, -0.015875447541475296, 0.029052751138806343, 0.011889551766216755, -0.07227757573127747, -0.021489769220352173, -0.02484200894832611, -0.0058085061609745026, -0.03488510474562645, -0.00957296323031187, 0.013763263821601868, 0.0016548280837014318, -0.1417207270860672, -0.0042448085732758045, 0.020467745140194893, 0.006418313831090927, -0.0028787024784833193, 0.010397396050393581, 0.003846219042316079, 0.010274752974510193, -0.005907301791012287, -0.03327711671590805, -0.025904914364218712, 0.0021019638516008854, 0.00807399395853281, -0.02301599271595478, 0.01778322644531727, -0.030197417363524437, 0.02823513001203537, 0.016488661989569664, 0.037555992603302, -0.017742345109581947, -0.024174286052584648, 0.004823955707252026, -0.01888701319694519, -0.0055359662510454655, -0.03799205645918846, -0.043960683047771454, -0.009382185526192188, -0.004333383869379759, 0.022811587899923325, 0.009198220446705818, -0.02169417403638363, 0.021108213812112808, 0.019268568605184555, -0.012202972546219826, -0.01640690118074417, 0.014253835193812847, -0.028098860755562782, -0.019009655341506004, 0.019718259572982788, 0.011078746058046818, -0.020181577652692795, -0.04515985772013664, 0.03218695893883705, 0.005733557511121035, 0.018505457788705826, -0.00689525855705142, 0.020835673436522484, -0.009920451790094376, 0.021571530029177666, -0.015562026761472225, 0.001616502064280212, -0.022988738492131233, -0.008435108698904514, 0.011017424054443836, 0.0076856245286762714, -0.0035089508164674044, -0.0070996638387441635, -0.02005893550813198, 0.01764695718884468, 0.027989845722913742, -0.012332429178059101, 0.02640911377966404, 0.013906346634030342, -0.014935185201466084, -0.006029944866895676, -0.004432179499417543, 0.034394532442092896, 0.036220550537109375, 0.01075851172208786, -0.056960832327604294, -0.0039382013492286205, 0.014689899049699306, 0.000340461905580014, -0.0073313224129378796, 0.011596571654081345, 0.03616604208946228, -0.007467592600733042, 0.037937551736831665, -0.05289999023079872, 0.008557751774787903, -0.00331987626850605, -0.01573917828500271, 0.003204046981409192, -0.003897320246323943, 0.01199856773018837, 0.03393121436238289, 0.02129899151623249, -0.016556797549128532, -0.004503721371293068, 0.02473299391567707, 0.03431276977062225, 0.004016556311398745, -0.0020116849336773157, 0.008966561406850815, 0.008339719846844673, -0.0014964141882956028, 0.025918541476130486, 0.03112405352294445, 0.0547260046005249, 0.010942475870251656, 0.03657485172152519, 0.03728345409035683, -0.0386461541056633, -0.03679288178682327, -0.00011519068357301876, 2.0214261894579977e-05, 0.008183009922504425, -0.011950873769819736, 0.0004479874041862786, -0.012012194842100143, 0.014935185201466084, -0.005219138693064451, 0.0012996745062991977, 0.08148942142724991, 0.01535762194544077, -0.009457133710384369, 0.03679288178682327, 0.009245915338397026, 0.01965012401342392, -0.015221351757645607, -0.006932733114808798, 0.019377585500478745, -0.02867119386792183, 0.004381078295409679, -0.03744697943329811, -0.028589433059096336, 0.03259576857089996, 0.04992930591106415, -0.03722894564270973, -0.01899602822959423, -0.024269675835967064, 0.028262384235858917, 0.017292654141783714, -0.01148755569010973, -0.029652338474988937, -0.01194406021386385, 0.015602908097207546, -0.00021643498621415347, -0.017483433708548546, 0.03810107335448265, 0.0026657807175070047, 0.009089204482734203, 0.017851362004876137, -0.005573440343141556, 0.0185190849006176, 0.020631268620491028, 0.013926787301898003, -0.00911645870655775, 0.007549354340881109, 0.0152894863858819, 0.019527481868863106, -0.009763740934431553, -0.020045308396220207, 0.0206448957324028, -0.013531604781746864, -0.001202582148835063, -0.023029619827866554, -0.02644999511539936, -0.016461407765746117, 0.013565672561526299, 0.03889143839478493, 0.03829185292124748, 0.014158446341753006, 0.008462362922728062, 0.013817771337926388, -0.02133987285196781, -0.019309449940919876, 0.018273798748850822, -0.021966714411973953, 0.015534772537648678, -0.00589026790112257, -0.024855636060237885, 0.03960004448890686, 0.011596571654081345, 0.03357691317796707, 0.00981143582612276, -0.006288857664912939, 0.04267974570393562, 0.009109645150601864, 0.024228794500231743, -0.027240360155701637, 0.008435108698904514, -0.01231198851019144, 0.027499273419380188, 0.0007673701038584113, -0.004139199387282133, 0.004353824537247419, 0.0030371162574738264, 0.022089356556534767, 0.026327351108193398, 0.019091418012976646, 0.029434306547045708, 0.012400563806295395, 0.050174590200185776, 0.0083260927349329, -0.023547444492578506, 0.014131192117929459, -0.005498492158949375, -0.02864394150674343, -0.01231198851019144, 0.0019452533451840281, 0.019336704164743423, 0.0018089833902195096, -0.025073667988181114, -0.04971127212047577, 0.02710409089922905, 0.0024034609086811543, -0.026613518595695496, -0.01150799635797739, 0.026681654155254364, 0.005934555549174547, 0.013347640633583069, -0.010417836718261242, 0.022007593885064125, -0.03605702519416809, -0.022920602932572365, -0.00208663335070014, -0.015439383685588837, -0.03202343359589577, -0.005031767301261425, -0.02608206495642662, -0.0046263644471764565, 0.023370293900370598, 0.03401297703385353, -0.0008546680328436196, 0.007501659914851189, -0.014022176153957844, 0.0022535640746355057, -0.0034987307153642178, 0.0026351199485361576, 0.0014802322257310152, 0.0007852555136196315, -0.012795747257769108, 0.012795747257769108, -0.01518047135323286, -0.041180774569511414, 0.00710647739470005, -0.013674688525497913, -0.007160985376685858, 0.014935185201466084, 0.04785799980163574, 0.024010762572288513, -0.027935337275266647, -0.003098437562584877, 0.023901747539639473, 0.001049278536811471, 0.006503482814878225, 0.016120733693242073, -0.007215492893010378, -0.02736300230026245, 0.007195052690804005, 0.006902072113007307, 0.011296777985990047, -0.018532712012529373, 0.03984532877802849, 0.0185190849006176, 0.028507670387625694, 0.03581174090504646, 0.00904151052236557, 0.020631268620491028, -0.003720169188454747, 0.017619702965021133, 0.019486600533127785, -3.9656679291510954e-05, -0.011869111098349094, -0.014430985786020756, -0.002863371977582574, 0.023915374651551247, 0.023424802348017693, 0.017224520444869995, -0.015984464436769485, 0.023874493315815926, 0.014376478269696236, 0.023506563156843185, 0.005454204045236111, 0.013177302666008472, 0.0054099163971841335, -0.026027558371424675, 0.03270478546619415, -0.01584819331765175, -0.0005808505811728537, -0.04466928541660309, -0.01119457557797432, -0.006595464888960123, 0.009143712930381298, 0.008578192442655563, -0.04862111434340477, -0.005866420920938253, 0.03829185292124748, -0.0032585549633949995, 0.008905240334570408, 0.03207794204354286, 0.0056892698630690575, 0.016284257173538208, 0.016570424661040306, 0.008516871370375156, 0.029979385435581207, 0.012516393326222897, 0.013592925854027271, -0.0316963866353035, -0.014580883085727692, 0.010404209606349468, 0.015343994833528996, -0.01618886925280094, 0.0034425193443894386, 0.025904914364218712, 0.004425366409122944, -0.03104229085147381, -0.02786720171570778, 0.009545709006488323, -0.0033283932134509087, 0.023138634860515594, 0.0023506563156843185, 0.010349702090024948, -5.8553487178869545e-05, 0.013511164113879204, 0.025032786652445793, -0.04303404688835144, 0.0195819903165102, -0.004871650133281946, 0.029979385435581207, 0.02330215834081173, -0.009641097858548164, 0.02586403302848339, -0.016052598133683205, -0.04447850584983826, 0.00759704876691103, -0.010138483718037605, 0.007746946066617966, 0.016270630061626434, 0.03889143839478493, 0.007849148474633694, -0.007195052690804005, 0.012857068330049515, -0.029815861955285072, 0.032050687819719315, -0.011371726170182228, 0.007256374228745699, -0.014608137309551239, 0.016597678884863853, 0.038700662553310394, 0.041153520345687866, -0.0037814907263964415, 0.01132403127849102, -0.011555690318346024, 0.018968775868415833, -0.028371401131153107, -0.03112405352294445, 0.009457133710384369, -0.0006532440311275423, 0.0643739178776741, -0.010990170761942863, -0.0013218183303251863, -0.010622241534292698, -0.0265590101480484, 0.028943734243512154, 0.014689899049699306, -0.005450797267258167, -0.0006647417903877795, 0.020440490916371346, 0.009027883410453796, 0.01921406015753746, 0.029761353507637978, 0.003059260081499815, 0.02910725772380829, 0.01673394814133644, -0.0083124665543437, 0.04486006125807762, 0.02078116498887539, 0.037637755274772644, 0.03453080356121063, 0.019159553572535515, -0.011582944542169571, 0.006632938981056213, -0.021135468035936356, 0.010179364122450352, -0.01541212946176529, 0.004834176041185856, 0.006503482814878225, 0.015343994833528996, -0.03425826132297516, -0.030769752338528633, -0.004329977091401815, 0.03861889988183975, -0.02929803542792797, 0.02367008849978447, 0.0047796680592000484, 0.03834636136889458, -0.02853492461144924, 0.019936291500926018, -0.012543647550046444, -0.003682695096358657, -0.009981772862374783, -0.00902106985449791, -0.01712913066148758, 0.019077790901064873, -0.003846219042316079, 0.0033539438154548407, 0.002144548110663891, 0.012386937625706196, 0.00711329048499465, 0.0023813170846551657, -0.012271108105778694, 0.0037099490873515606, 0.0003741035470739007, -0.012441445142030716, 0.01247551292181015, 0.0396818071603775, 0.005784658715128899, 0.006850970908999443, -0.04763996973633766, -0.017360789701342583, -0.01207351591438055, 0.04183487221598625, 0.0013371487148106098, -0.017360789701342583, -0.005314527545124292, 0.006009504199028015, -0.01573917828500271, 0.01146711502224207, 0.005355408415198326, 0.012121210806071758, -0.01077895238995552, 0.0017493653576821089, 0.0008789410931058228, 0.026572637259960175, -0.040526680648326874, -0.0001946105039678514, 0.03270478546619415, 0.009170967154204845, -0.03701091557741165, -0.007576608564704657, -0.026695281267166138, -0.012059889733791351, 0.0054337638430297375, 0.028943734243512154, 0.03853713721036911, -0.00807399395853281, -0.011889551766216755, 0.009934077970683575, -0.0132795050740242, 0.00814894214272499, 0.008694021962583065, 0.008196637034416199, 0.01267310418188572, -0.02615020051598549, -0.022198373451828957, -0.02465123124420643, -0.010676749050617218, -0.0005054763169027865, -0.005924335680902004, -0.01584819331765175, -0.0038325919304043055, 0.011092373169958591, 0.00022527124383486807, -0.017810480669140816, -0.034203752875328064, -0.0023302158806473017, 0.0063706194050610065, 0.012380124069750309, -0.05036536976695061, 0.005968623328953981, 0.01980002224445343, -0.0006374877993948758, 0.012925203889608383, 0.032895561307668686, 0.018914267420768738, 0.04409695044159889, -0.002785016782581806, 0.002360876649618149, 0.009327677078545094, 0.0075834221206605434, 0.043633632361888885, -0.002493739826604724, -0.0047558206133544445, -0.005355408415198326, -0.023860866203904152, -0.011255896650254726, -0.02510092221200466, -0.03722894564270973, 0.007760572712868452, -0.006810090038925409, 0.021380752325057983, -0.007869589142501354, 0.011569317430257797, 0.01994991861283779, 7.244663720484823e-05, -0.007154171820729971, -0.04006336256861687, 0.002796940505504608, 0.0026691872626543045, 0.0012707171263173223, -0.0003095882711932063, 0.031178561970591545, 0.01658405177295208, 0.04039040952920914, 0.007160985376685858, -0.01563016138970852, 0.01899602822959423, -0.007195052690804005, -0.0195819903165102, 0.0003059685986954719, -0.021053705364465714, 0.016352392733097076, 0.0012553867418318987, -0.01008397527039051, -0.01895514875650406, -0.03265027701854706, 0.009961332194507122, -0.01255046110600233, 0.029352543875575066, 0.016420526430010796, 0.0027185853105038404, 0.02188495174050331, 0.04284326732158661, -0.016488661989569664, -0.03502137213945389, 0.01775597222149372, -0.019786395132541656, 0.006714701186865568, 0.02173505537211895, -0.01606622524559498, 0.0011404090328142047, -0.016638558357954025, -0.009763740934431553, 0.01004309393465519, 0.012352869845926762, 0.01847820356488228, -0.031614623963832855, -0.024228794500231743, -0.025700509548187256, 0.016938352957367897, 0.03788304328918457, 0.018314680084586143, -0.015153217129409313, -0.0295160673558712, 0.010826646350324154, 0.022525420412421227, 0.007665183860808611, -0.026109319180250168, -0.0054610176011919975, -0.01375645026564598, 0.019772768020629883, -0.03232323005795479, -0.013313572853803635, 0.023683715611696243, -0.02823513001203537, 0.05957721546292305, 0.038264598697423935, 0.004360638093203306, 0.005041987635195255, -0.030006639659404755, -0.012230226770043373, -0.015957210212945938, -0.03134208545088768, 0.018382813781499863, -0.012393750250339508, 0.011058305390179157, -0.02086292766034603, -0.012829814106225967, 0.0006451529916375875, 0.0039041335694491863, -0.023751849308609962, -0.028289638459682465, 0.022620810195803642, 0.0062922644428908825, -0.020958315581083298, -0.025727763772010803, -0.04284326732158661, -0.05344506725668907, -0.003301139222458005, -0.021121840924024582, 0.03701091557741165, 0.010370141826570034, -0.000565946102142334, 0.014567255973815918, 0.0016420527826994658, 0.014158446341753006, 0.01216209214180708, -0.021680546924471855, -0.020113442093133926, -0.0381283275783062, 0.00882347859442234, 0.006002690643072128, 0.011378539726138115, -0.0033675706945359707, 0.015616534277796745, -0.020753910765051842, 0.0005685011274181306, 0.016243375837802887, -0.003965455107390881, 0.0048989043571054935, 0.0016250190092250705, 0.014376478269696236, -0.012325615622103214, 0.054153673350811005, 0.014867049641907215, 0.03532116860151291, -0.039354756474494934, 0.018682608380913734, -0.018682608380913734, 0.0001478741760365665, 0.012754865922033787, -0.02089018188416958, 0.012202972546219826, -0.03992709144949913, 0.006006097421050072, -0.03889143839478493, 0.007045155856758356, -0.0050862752832472324, 0.0026248996146023273, 0.011766908690333366, -0.00564498221501708, -0.015493892133235931, -0.018205663189291954, 0.026899686083197594, -0.00982506200671196, 0.0037440164014697075, 0.0034322990104556084, 0.013606552965939045, 0.012639036402106285, -0.001889041974209249, 0.004098318517208099, -0.013000152073800564, 0.012271108105778694, 0.02856217883527279, -0.031069545075297356, -0.013136422261595726, 0.013436215929687023, -0.02425604872405529, 0.04521436616778374, 0.0030354128684848547, 0.010928848758339882, -0.029025496914982796, -0.010724443942308426, 0.010458718053996563, -0.016420526430010796, 0.00268451776355505, 0.004711532965302467, -0.005471237935125828, 0.0027424325235188007, 0.005835759919136763, 0.023438429459929466, -0.03275929391384125, -0.0024187914095818996, 0.0010927146067842841, -0.01695198006927967, -0.04022688418626785, 0.00907557737082243, 0.029488814994692802, -0.018219290301203728, 0.0049840728752315044, -0.020372355356812477, 0.01599808968603611, 0.03314084932208061, 0.044369492679834366, -0.00807399395853281, 0.019895410165190697, 0.0033164694905281067, -0.01695198006927967, -0.00781508069485426, -0.0020951502956449986, -0.004527568817138672, 0.0047967019490897655, 0.0058596073649823666, -0.01075851172208786, -0.026681654155254364, 0.008789410814642906, 0.008884799666702747, 0.054780513048172, 0.001444461289793253, -0.008039926178753376, -0.031178561970591545, 0.0142129547894001, 0.04071745648980141, -0.027158597484230995, 0.03695640712976456, 0.0038121514953672886, 0.013865466229617596, -0.003479993436485529, 0.03156011551618576, 0.009218661114573479, 0.01523497886955738, -0.018777996301651, 0.0038019311614334583, 0.021026451140642166, 0.015875447541475296, 0.005215731915086508, 0.05001106485724449, -0.0260139312595129, -0.020590387284755707, -0.006040164735168219, -0.014553628861904144, -0.02786720171570778, -0.025482477620244026, 0.017796853557229042, -0.013524791225790977, -0.006667006760835648, -0.032568514347076416, 0.00024656340247020125, 0.056088704615831375, 0.03404023125767708, -0.02407889813184738, -0.013729196041822433, 0.0005267684464342892, -0.0027509492356330156, 0.025618748739361763, -0.03673837333917618, 0.004030183423310518, 0.002468189224600792, -0.01986815594136715, 0.019404839724302292, 0.019609244540333748, 0.0016744168242439628, 0.0004765189369209111, 0.008666767738759518, 0.008203450590372086, -0.05766943842172623, 0.005856200587004423, -0.025114549323916435, -0.02180318906903267, 0.03295006975531578, 0.014580883085727692, 0.022089356556534767, -0.009157340042293072, 0.009893197566270828, -0.004217554349452257, -0.008721276186406612, 0.0166249331086874, 0.023792730644345284, 0.02465123124420643, -0.03752874210476875, 0.002270597731694579, -0.010676749050617218, 0.005702896974980831, 0.020372355356812477, -0.01706099510192871, 0.007447151932865381, 0.052654702216386795]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
"2 depth is added to the end of
Stage 2. The last three rows are annotated with the performance optimization(s) adopted, where Optimization 1 stands for
deferring forward computation of early-exit layers to backward steps, and Optimization 2 stands for moving every early
exit from the end of some pipeline stage to the beginning of the next stage, in order to achieve more balanced load across
stages. Stage 1 is the bottleneck of peak memory in most cases, except for the numbers marked by *, for which Stage 2 is
the bottleneck.
Setup1.3B 7B
Time per iteration (s) Peak memory (GB) Time per iteration (s) Peak memory (GB)
Standard 5.23 19 .85 17 .75 62 .27
Early-exit 5.31 24 .05 17 .93 67 .42
Early-exit (1) 5.29 22 .56 17 .91 65 .79
Early-exit (2) 5.28 20 .23* 17.81 62 .27
Early-exit (1&2) 5.24 19 .85 17 .79 62 .27
the impacts of each performance optimization; unsurprisingly, the best training efficiency is achieved with all the proposed
optimizations applied.
A.3. Theoretical analysis for general cases
In the following, we derive formulas for the training time per iteration and peak GPU memory usage across pipeline stages
under general configurations of early exits, in terms of the quantities listed in Table 2. Some of these quantities, especially
{fo, bo, mo, m†
o}, can be further calculated analytically with lower-level quantities such as sequence length, microbatch
size, hidden size, vocabulary size and others (Rajbhandari et al., 2019; Narayanan et al., 2021b; Korthikanti et al., 2022), or
estimated empirically by profiling in practice.
It is assumed that all pipeline stages have the same number of Transformer layers on the backbone, and all early-exit layers
follow the same structure. We also assume that input and output embedding matrices are untied, although it is not hard to
extend our analysis to more general cases. For simplicity, we ignore the point-to-point communication latency between
pipeline stages in our analysis, since it typically takes a minor proportion of the overall training time, and can often be
overlapped with computation.
A.3.1. T RAINING TIME PER ITERATION
Let us analyze the training time per iteration step by step.
Step 1: simplified analysis without early exits. We start by recalling the simplified analysis in prior works for the
standard 1F1B pipeline schedule (Narayanan et al., 2021b), which assumes that all stages have the same forward time fand
backward time bfor one microbatch. Recall from Figure 3 that the critical path of one training iteration consists of three
16
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
Table 2: A list of notation for theoretical analysis. The following abbreviations are used: IN—input processing layer; EE—
early-e xit layer; FE— final-e xit layer; BB— Transformer b ackb one on one pipeline stage.
Notation Definition
P Number of pipeline stages
Ni Number of early exits in Stage i∈[P]
M Number of microbatches for one training iteration
fo, bo Forward and backward time of one o∈ {IN,EE,FE,BB}for one microbatch
mo Memory usage for storing the model parameters of one o∈ {IN,EE,FE,BB}
m†
o Activation memory of one o∈ {IN,EE,FE,BB}for one microbatch
1(·) The indicator function, 1(E) = 1 if the event Eholds true, and 0otherwise
parts:
• Part 1: forward steps of the first microbatch on all stages except the last one, which takes time (P−1)×f;
• Part 2: the steady 1F1B phase with all Mmicrobatches on the last stage, which takes time M×(f+b);
• Part 3: backward steps of the last microbatch on all stages except the last one, which takes time (P−1)×b.
Taking the sum of these three parts, we have
time per iteration = (P−1)×f+M×(f+b) + (P−1)×b= (P−1)×(f+b)| {z }
Parts ","[0.020433688536286354, 0.0033076705876737833, 0.06266681104898453, -0.04512220621109009, -0.013460495509207249, -0.01940937712788582, 0.04604145884513855, 0.03506295010447502, -0.007813652977347374, 0.060092903673648834, 0.045463643968105316, 0.014064576476812363, -0.05415715277194977, -0.02949490025639534, -0.009895105846226215, -0.008785435929894447, 0.0014346918324008584, -0.019580096006393433, 0.0021372640039771795, 0.03645496070384979, 0.04107749089598656, -0.055102672427892685, 0.020761992782354355, 0.047197092324495316, 0.05972520262002945, -0.02124788425862789, 0.027341220527887344, 0.019763946533203125, 0.02299446612596512, -0.06597612798213959, 0.04375645890831947, -0.031202085316181183, -0.060880836099386215, -0.03535185754299164, 0.025607772171497345, -0.0027528353966772556, -0.0032600662671029568, 0.04183916002511978, -0.023217713460326195, 0.013710007071495056, -0.004556870087981224, -0.02332277037203312, -0.07874061167240143, 0.014760581776499748, 0.0004263858136255294, 0.009185967035591602, -0.006641605403274298, 0.004799815826117992, -0.002179943723604083, 0.07579900324344635, 0.0023326054215431213, 0.04908812791109085, -0.0414714589715004, -0.006076921243220568, 0.0056172944605350494, 0.007498480845242739, 0.004123507998883724, -0.011457836255431175, 0.031596049666404724, -0.02219340205192566, 0.05208226665854454, -0.05552290007472038, 0.021234752610325813, -0.023073259741067886, -0.0007378649315796793, 0.032173868268728256, -0.04233818128705025, 0.028654439374804497, 0.02988886646926403, 0.025476450100541115, -0.02098524011671543, 0.04365140199661255, 0.014038311317563057, -0.020761992782354355, 0.0171506404876709, 0.02137920632958412, 0.020171044394373894, 0.06093336269259453, 0.018962882459163666, -0.03984306752681732, 0.03821467608213425, -0.013998915441334248, 0.05893727019429207, -0.012830150313675404, 0.019882136955857277, -0.041681572794914246, -0.020643804222345352, -0.029048405587673187, -0.014300955459475517, -0.04233818128705025, -0.02550271339714527, -0.010203711688518524, -0.01602127216756344, 0.02656642161309719, 0.05526025965809822, 0.01265286561101675, 0.0028907235246151686, -0.05399956926703453, 0.007807087153196335, 0.05048014223575592, 0.04462318494915962, 0.009461743757128716, 0.018043629825115204, -0.02862817607820034, 0.008043467067182064, -0.01431408803910017, -0.04422921687364578, 0.01854265294969082, -0.051451921463012695, -0.03656001761555672, -0.014799978584051132, 0.011608856730163097, 0.004658644553273916, -0.0013731346698477864, 0.02166811376810074, -0.01548285223543644, -0.02936357818543911, 0.04588387534022331, 0.0013928329572081566, 0.0045732855796813965, -0.011077002622187138, -0.012593770399689674, -0.019041676074266434, 0.014826242811977863, -0.009153136983513832, -0.007472216617316008, 0.026789668947458267, -0.015837421640753746, -0.00829954445362091, -0.04149772226810455, 0.020446820184588432, -0.008043467067182064, 0.05308031290769577, -0.028523117303848267, -0.00883796438574791, -0.03619231656193733, 0.002380209509283304, 0.043677665293216705, 0.002114282688125968, 0.023887455463409424, 0.013998915441334248, 0.001882827840745449, -0.0193305853754282, -0.0013673893408849835, -0.017439549788832664, 0.08378337323665619, -0.038503583520650864, 0.025542110204696655, -0.01613946259021759, -0.01734762452542782, 0.012068483047187328, 0.005794579163193703, -0.019750814884901047, -0.0297575443983078, 0.04950835928320885, -0.012849848717451096, -0.04485956206917763, 0.033644672483205795, 0.08178728073835373, -0.004776834510266781, -0.016441501677036285, 0.005870089400559664, 0.031517256051301956, 0.007826785556972027, 0.02915346249938011, 0.04556870087981224, -0.07269980758428574, -0.018634578213095665, -0.07590406388044357, -0.04499088600277901, 0.014799978584051132, -0.028575647622346878, -0.0469081848859787, -0.044807035475969315, 0.019960930570960045, -0.038030825555324554, -0.09103234857320786, -0.04874669015407562, -0.020486216992139816, -0.03474777564406395, -0.041891686618328094, 0.032646626234054565, -0.02902214042842388, 0.025752225890755653, -0.022876275703310966, 0.03036162443459034, 0.023152051493525505, 0.02936357818543911, 0.03009898029267788, 0.014865639619529247, 0.0004776834393851459, 0.016441501677036285, 0.03682266175746918, -0.010584545321762562, 0.008778869174420834, -0.04270588234066963, 0.05347428098320961, -0.0421280674636364, 0.018214348703622818, 0.015706099569797516, 0.04349381476640701, 0.024347081780433655, 0.04921945184469223, -0.0410512275993824, 0.03395984321832657, -0.01893661916255951, -0.03109702654182911, 0.016638485714793205, -0.030808119103312492, -0.00145767314825207, 0.002848043804988265, 0.024885501712560654, 0.012665998190641403, -0.0019419227028265595, -0.02105090208351612, 0.01461612805724144, -0.08404602110385895, 0.025936076417565346, 0.025686563923954964, 0.01787291094660759, 0.02332277037203312, 0.018056761473417282, 0.003946223296225071, 0.0227974820882082, -0.04577881470322609, 0.031727373600006104, 0.009080910123884678, -0.03015150874853134, 0.006602208595722914, -0.012580638751387596, -0.013998915441334248, 0.03335576504468918, -0.029862601310014725, -0.011937160976231098, 0.07017842680215836, -0.004901590291410685, -0.024675386026501656, -0.03944909945130348, -0.020945843309164047, -0.029521163552999496, -0.006815606728196144, 0.055050142109394073, -0.0160738006234169, -0.018818428739905357, -0.036244846880435944, 0.025226937606930733, -0.01787291094660759, -0.07879314571619034, 0.013302909210324287, 0.00996076688170433, 0.009258193895220757, -0.05092663690447807, -0.050979163497686386, -0.015167680568993092, -0.045279793441295624, 0.009547102265059948, 0.04664554074406624, 0.012606902979314327, -0.014261558651924133, 0.01082749105989933, 0.0038608640898019075, 0.009061211720108986, -0.006168846506625414, -0.009652160108089447, -0.0208539180457592, -0.0006315762875601649, -0.017689060419797897, -0.003699994646012783, 0.03146472945809364, -0.020105384290218353, 0.01741328462958336, -0.016572823747992516, 0.010420393198728561, 0.009790048003196716, -0.0421280674636364, -0.009717821143567562, 0.04136640205979347, 0.028444325551390648, -0.04987606033682823, -0.006713832262903452, -0.006185261532664299, 0.023821793496608734, 0.0716492310166359, -0.016717279329895973, 0.010597677901387215, -0.022403517737984657, 0.023821793496608734, 0.04270588234066963, -0.01573236472904682, -0.029573693871498108, 0.0077085960656404495, 0.009074343368411064, 0.035509444773197174, -0.020433688536286354, 0.018555784597992897, -0.03049294650554657, -0.001585711957886815, -0.031596049666404724, 0.019041676074266434, 0.006543113850057125, -0.004113658796995878, -0.0694955512881279, 0.014130237512290478, 0.05426220968365669, -0.017754722386598587, 0.013959518633782864, -0.039764273911714554, -0.00969812273979187, -0.029731279239058495, 0.0023752849083393812, -0.013099360279738903, 0.017373887822031975, -0.017176905646920204, 0.00499679846689105, -0.017032451927661896, -0.007780822925269604, 0.018437596037983894, -0.021287281066179276, 0.015417192131280899, -0.038766227662563324, -0.0010858679888769984, -0.08063165098428726, -0.040683526545763016, 0.006362546235322952, 0.03374972939491272, 0.02763012982904911, 0.010604243725538254, 0.03658628463745117, -0.010111786425113678, -0.02132667787373066, -0.017360756173729897, -0.038293465971946716, -0.0009520837920717895, -0.03913392871618271, -0.035509444773197174, -0.013040265068411827, -0.023559149354696274, 0.014077708125114441, 0.054577384144067764, 0.03529932722449303, -0.08740785717964172, -0.02470165118575096, -0.058832213282585144, 0.022495443001389503, -0.015719231218099594, 0.03340829163789749, 0.02870696783065796, -0.01648089848458767, 0.06928543746471405, 0.02158932201564312, -0.014090840704739094, -0.017833514139056206, 0.04283720627427101, -0.0196588896214962, 0.007800521329045296, -0.009094041772186756, 0.05355307459831238, -0.025936076417565346, -0.027393748983740807, 0.02689472585916519, -0.005512237083166838, -0.023467224091291428, 0.01967202126979828, 0.013696874491870403, -0.039422836154699326, 0.03466898202896118, -0.02392685040831566, 0.026119926944375038, -0.008424300700426102, -0.0067762103863060474, 0.025594638660550117, 0.05313284322619438, -0.014103972353041172, -0.011411873623728752, -0.05108422040939331, -0.020315498113632202, 0.006602208595722914, 0.0244390070438385, -0.0008921682019717991, 0.05578554421663284, -0.005705936811864376, 0.04204927384853363, 0.006855003535747528, 0.017176905646920204, 0.007905579172074795, 0.03839852660894394, -0.00278074131347239, 0.0037032777909189463, -0.02564716897904873, -0.012337693013250828, -0.0014978904509916902, 0.017715325579047203, -0.010072390548884869, 0.028418060392141342, -0.00561072863638401, -0.005105139221996069, 0.034774038940668106, 0.06623876839876175, 0.0423644483089447, -0.010210278443992138, -0.00910060852766037, -0.032252661883831024, -0.04782743752002716, -0.04139266535639763, 0.015719231218099594, -0.0031057631131261587, 0.06455785036087036, -0.014445409178733826, 0.04948209226131439, 0.02186509780585766, 0.016664749011397362, 0.0014445409178733826, 0.022232798859477043, -0.014944433234632015, 0.024031909182667732, -0.03674386814236641, -0.015246473252773285, 0.02784024365246296, -0.007990937680006027, 0.07847797125577927, -0.04404536634683609, -0.021431734785437584, -0.04774864390492439, 0.013815064914524555, -0.07033601403236389, 0.046934448182582855, 0.010072390548884869, -0.00916626863181591, -0.020079119130969048, -0.028995877131819725, -0.002981007331982255, 0.022219667211174965, 0.00814195815473795, -0.0014158142730593681, -0.04840525612235069, -0.03595593944191933, -0.015246473252773285, 0.013447362929582596, -0.007432819809764624, 0.005558199714869261, -0.01573236472904682, -0.0020354895386844873, -0.01741328462958336, 0.009941068477928638, -0.0725422203540802, 0.015325266867876053, -0.03414369374513626, -0.02211460843682289, 0.03414369374513626, -0.03319817781448364, 0.014235294423997402, 0.051845889538526535, 0.016691014170646667, 0.032777946442365646, 0.019317451864480972, -0.07406555116176605, 0.07112394273281097, -0.002672400791198015, 0.009245062246918678, 0.0037328251637518406, 0.019475039094686508, -0.008207619190216064, 0.0030975553672760725, -0.040158238261938095, -0.03774191439151764, 0.022416649386286736, 0.028286738321185112, -0.0045732855796813965, 0.0017432982567697763, 0.0007144732517190278, 0.0068024746142327785, -0.013815064914524555, 0.033644672483205795, -0.03262036293745041, -0.004776834510266781, 0.024544063955545425, -0.02306012623012066, -0.02405817247927189, -0.009927935898303986, -0.0005741229397244751, 0.034774038940668106, -0.02237725257873535, 0.0019468473037704825, -0.04181289300322533, 0.0042416974902153015, 0.08068417757749557, 0.016979921609163284, -0.015338398516178131, 0.009796613827347755, -0.03196375072002411, 0.023414695635437965, -0.024084437638521194, 0.056363362818956375, -0.014261558651924133, -0.01348675973713398, -0.012639733031392097, -0.019777078181505203, -0.0021471132058650255, -0.005636992864310741, -0.0104269590228796, 0.01222606934607029, -0.009343553334474564, 0.02915346249938011, -0.02252170629799366, -0.005449858959764242, -0.04152398556470871, 0.003156650345772505, -0.017190037295222282, -0.029389843344688416, -0.007203006651252508, -0.03805708885192871, 0.012482146732509136, 0.009790048003196716, 0.015128283761441708, -0.006809040904045105, 0.0036770133301615715, 0.0038575809448957443, -0.0011572742369025946, -0.004822797141969204, 0.008470263332128525, 0.008680378086864948, -0.01268569566309452, -0.013368570245802402, -0.008529357612133026, -0.019908400252461433, -0.03792576491832733, -0.040683526545763016, -0.10652832686901093, -0.007432819809764624, -0.022416649386286736, 0.03235771879553795, -0.00725553510710597, -0.02689472585916519, -0.014497938565909863, -0.035036683082580566, 0.0011777933686971664, -0.010518884286284447, -0.019895268604159355, -0.052712611854076385, 0.0007280157878994942, 0.007531311362981796, 0.02576535753905773, 0.016165725886821747, 0.017190037295222282, -0.0024245306849479675, -0.0017515058862045407, 0.020433688536286354, 0.011109833605587482, 0.012698828242719173, -0.01378879975527525, 0.0025460035540163517, -0.006306734401732683, 0.01898914761841297, -0.020958976820111275, -0.029337313026189804, 0.007892446592450142, 0.010072390548884869, 0.00996076688170433, 0.0048359292559325695, -0.002092942828312516, 0.01880529709160328, 0.004888457711786032, 0.02285001240670681, -0.03548317775130272, -0.019251791760325432, 0.03128087893128395, 0.0050788745284080505, -0.08289038389921188, 0.021142827346920967, 0.006372395437210798, -0.012232635170221329, -0.0036244846414774656, 0.005331669468432665, -0.015377795323729515, -0.02119535580277443, -0.017373887822031975, 0.030781853944063187, 0.043021056801080704, -0.007944975048303604, -0.018043629825115204, -0.02131354622542858, -0.005732201039791107, -0.02152366004884243, -0.03871369734406471, -0.009461743757128716, 0.015968743711709976, -0.015653571113944054, -0.0025525696109980345, -0.04914065822958946, 0.01281701773405075, 0.03579835221171379, -0.033986110240221024, 0.024544063955545425, -0.002381850965321064, 0.004704607184976339, -0.021011505275964737, -0.012075048871338367, -0.006638322491198778, -0.015784893184900284, -0.009842576459050179, 0.018752768635749817, -0.018503256142139435, 0.014642392285168171, -0.008752604946494102, -0.02636943943798542, 0.005417028442025185, -0.029573693871498108, -0.005462991073727608, 0.016717279329895973, -0.012843281961977482, 0.01262003555893898, -0.003176348516717553, -0.014156501740217209, 0.011011341586709023, -0.02484610490500927, -0.030808119103312492, 0.011576025746762753, -0.024005644023418427, 0.033986110240221024, -0.003535842290148139, 0.02198328636586666, -0.014392880722880363, 0.010952247306704521, -0.023138919845223427, 0.027603864669799805, -0.02166811376810074, -0.0332244411110878, 0.011457836255431175, 0.008352072909474373, 0.026737140491604805, -0.02525320276618004, 0.03262036293745041, -0.006293602287769318, -0.009442045353353024, -0.010177447460591793, 0.019238660112023354, -0.0051182713359594345, 0.01866084337234497, -0.03466898202896118, -0.037636857479810715, 0.04601519554853439, -0.016428370028734207, 0.010604243725538254, -0.02569969743490219, 0.006920664571225643, 0.01866084337234497, 0.002628079615533352, 0.018621446564793587, -0.02669774368405342, -0.048983070999383926, -0.03170110657811165, -0.025463318452239037, 0.03309312090277672, 0.01785977929830551, 0.03241024538874626, -0.028785761445760727, -0.01733449101448059, -0.01613946259021759, -0.004159621428698301, -0.023742999881505966, -0.012803886085748672, -0.005627143662422895, -0.057098764926195145, 0.000132040077005513, 0.02576535753905773, 0.0397380068898201, -0.0019763947930186987, 0.03535185754299164, 0.017373887822031975, -0.02091958001255989, -0.007577273994684219, 0.010925982147455215, 0.006894399877637625, 0.021773172542452812, -0.027945302426815033, -0.040683526545763016, -0.021773172542452812, -0.04612025246024132, -0.011109833605587482, 0.013434231281280518, -0.04457065463066101, -0.010118353180587292, -0.013473627157509327, -0.004842495080083609, -0.01374940387904644, -0.015548513270914555, -0.0035653896629810333, -0.01806989498436451, -0.0010530375875532627, -0.02689472585916519, -0.012547807767987251, 0.020827654749155045, 0.012862980365753174, -0.021418603137135506, -0.0025427204091101885, -0.0275775995105505, -0.027131104841828346, 0.047669850289821625, -0.029705015942454338, -0.055312786251306534, 0.00980318058282137, -0.008260147646069527, -0.04743347316980362, -0.006336282007396221, -0.008627849631011486, -0.019488170742988586, -0.02338843233883381, 0.05673106387257576, 0.06413761526346207, -0.024596592411398888, -0.055050142109394073, -0.00038760481402277946, -0.012035652995109558, 0.0028759497217833996, -0.05389450863003731, 0.00491800531744957, 0.014786846935749054, -0.00015984338824637234, -0.035588234663009644, -0.010479488410055637, -0.03088691271841526, 0.0157454963773489, -0.029915129765868187, 0.011411873623728752, 0.01960636116564274, -0.02299446612596512, -0.034248754382133484, 0.030545474961400032, 0.03122834861278534, 0.02378239668905735, 0.05615324527025223, 0.0475647933781147, 0.012377089820802212, -0.04244323819875717, 0.03335576504468918, 0.024425875395536423, -0.03571955859661102, -0.010302203707396984, -0.01168764941394329, -0.001117877778597176, 0.0007271950598806143, -0.04239071160554886, -0.03380225971341133, 0.029652485623955727, -0.013762535527348518, -0.01594247855246067, -0.00200265902094543, 0.04307358339428902, 0.005870089400559664, -0.0028299870900809765, -0.005206913687288761, 0.011773008853197098, -0.04830019548535347, -0.0001659990957705304, 0.009658725932240486, -0.006093336269259453, 0.03740048035979271, -0.001831940608099103, 0.017492078244686127, -0.012331127189099789, 0.014550467021763325, 0.005958731286227703, -0.011582592502236366, 0.012140709906816483, 0.005587747320532799, 0.02664521522819996, 0.028654439374804497, -0.010118353180587292, 0.06198393926024437, 0.012764489278197289, -0.021300412714481354, -0.0067565119825303555, 0.02610679529607296, 0.0013624647399410605, 0.05846451222896576, 0.008542490191757679, 0.010446657426655293, -0.02936357818543911, -0.012580638751387596, 0.003942940384149551, -0.016901129856705666, -0.010788094252347946, 0.01139217521995306, -0.0018614879809319973, -0.024767311289906502, -0.009875407442450523, -0.005860240198671818, 0.02424202300608158, -0.006809040904045105, -0.07375038415193558, -0.015798024833202362, -0.04031582549214363, -0.008923323825001717, -0.028575647622346878, -0.0048162308521568775, -0.004852344281971455, -0.007327762432396412, -0.10363924503326416, -0.004162904340773821, 0.019435642287135124, 0.014708053320646286, -0.01686173304915428, -0.001877903239801526, -0.008877361193299294, -0.017649663612246513, 0.0022538122721016407, -0.02418949455022812, 0.0011425005504861474, 0.007248969282954931, -0.018174951896071434, -0.0036343338433653116, 0.006067072041332722, -0.029442371800541878, 0.031858693808317184, 0.0275775995105505, 0.008588452823460102, -0.0253057312220335, -0.023703603073954582, -0.0006594822043552995, -0.018621446564793587, 0.016769807785749435, -0.057886697351932526, -0.008811700157821178, -0.0005683776107616723, -0.020972108468413353, 0.022955069318413734, 0.005535218399018049, -0.01993466541171074, 0.013447362929582596, 0.019081072881817818, 0.0012130860704928637, -0.007262101396918297, 0.013828196562826633, -0.041681572794914246, 0.0056928046979010105, 0.041629042476415634, 0.006067072041332722, -0.015325266867876053, -0.04270588234066963, 0.053500544279813766, -0.001543853199109435, 0.04485956206917763, 0.004963967949151993, 0.0035424083471298218, -0.018437596037983894, 0.021352941170334816, -0.0008384083048440516, 0.0016562975943088531, -0.017912307754158974, -0.0006135195144452155, -0.0006360904662869871, 0.01667788252234459, -0.005321820266544819, -0.019146732985973358, -0.021957023069262505, 0.022350989282131195, 0.014117104932665825, 0.0005018959054723382, 0.058569569140672684, 0.03141219913959503, -0.011004775762557983, -0.011188626289367676, -0.010039559565484524, 0.025791622698307037, 0.02231159247457981, 0.011109833605587482, -0.028129152953624725, -0.01501009427011013, -0.009842576459050179, -0.002688816050067544, -0.026146192103624344, 0.003017120761796832, 0.022626765072345734, -0.01208818145096302, 0.01887095719575882, -0.04963967949151993, -0.0003906826605089009, 0.004809665028005838, 0.008233883418142796, 0.013473627157509327, -0.010998209938406944, -0.01557477843016386, 0.026330042630434036, -0.00830611027777195, -0.017767854034900665, 0.008943022228777409, 0.003161574946716428, 0.023086391389369965, -0.007636368740350008, 0.011976557783782482, 0.0013362003955990076, 0.007800521329045296, -0.0035030117724090815, 0.009218798018991947, 0.027341220527887344, 0.048878014087677, 0.027472542598843575, 0.005377632100135088, 0.03075559064745903, -0.008476829156279564, -0.021563056856393814, -0.027525071054697037, -0.0023834926541894674, -0.004277810920029879, -0.006332999095320702, -0.017925439402461052, -0.032252661883831024, 0.02418949455022812, 0.00010028684482676908, -0.009461743757128716, 0.03608725965023041, 0.007583840284496546, 0.0050887237302958965, 0.03548317775130272, 0.014379749074578285, 0.012048784643411636, -0.043887779116630554, -0.01873963512480259, 0.011700781993567944, -0.028575647622346878, 0.0032321603503078222, -0.04564749449491501, -0.03382852301001549, 0.005906202830374241, 0.03130714222788811, -0.041024964302778244, -0.008489960804581642, -0.023401563987135887, 0.014012047089636326, 0.020381160080432892, 0.007465650327503681, -0.0021356225479394197, 0.008214185014367104, 0.009041513316333294, 0.003350350074470043, -0.0012434542877599597, 0.016520295292139053, -0.009126872755587101, 0.03304059058427811, 0.02418949455022812, 0.004425548017024994, 0.004185885656625032, 0.018371934071183205, -0.014392880722880363, -0.001052216743119061, 0.014261558651924133, 0.016638485714793205, 0.012436184100806713, -0.023401563987135887, -0.0031188952270895243, -0.004550304263830185, -0.00926476065069437, -0.029652485623955727, -0.040158238261938095, -0.034248754382133484, -0.03847732022404671, 0.018568918108940125, 0.02430768497288227, 0.035588234663009644, 0.02325711026787758, 0.003873996203765273, 0.02677653729915619, -0.02206207998096943, -0.015955612063407898, 0.01338170189410448, -0.017623400315642357, 0.005679672583937645, -0.0045732855796813965, 0.013112491928040981, 0.022902540862560272, 0.010315335355699062, 0.045542437583208084, 0.014799978584051132, -0.015955612063407898, 0.026408834382891655, -0.007931843400001526, -0.00043131038546562195, -0.006717115640640259, -0.012140709906816483, 0.01653342880308628, 0.005029628984630108, -0.008923323825001717, -0.02896961197257042, -0.008916757069528103, -0.004386151675134897, 0.011201758868992329, 0.025226937606930733, 0.026408834382891655, 0.027314957231283188, 0.005220045801252127, 0.05050640553236008, 0.017780985683202744, -0.022626765072345734, -0.014957564882934093, -0.004881891887634993, -0.012679129838943481, -0.012751356698572636, 0.017360756173729897, 0.006664586719125509, 0.008746039122343063, -0.03992186114192009, -0.04391404613852501, 0.045463643968105316, 0.001483116764575243, -0.01833253726363182, -0.013014000840485096, 0.043152377009391785, 0.012679129838943481, 0.016310181468725204, -0.014865639619529247, 0.04231191799044609, -0.03679639846086502, -0.03227892518043518, 0.012567506171762943, 0.007577273994684219, -0.005981712602078915, 0.0025312297511845827, -0.0244390070438385, -0.010702735744416714, -0.00221769860945642, 0.015522249042987823, -0.007564141880720854, -0.003166499547660351, 0.016822336241602898, 0.006326432805508375, -0.006907532457262278, 0.010814358480274677, -0.02098524011671543, -0.024872368201613426, -0.01701931841671467, -0.0031993298325687647, 0.015522249042987823, 0.002457361202687025, 0.004734154790639877, -0.02505621872842312, -0.004665210843086243, 0.007636368740350008, 0.04748599976301193, 0.00986227486282587, -0.02317831665277481, 0.011182060465216637, 0.02643509954214096, -0.0013074737507849932, 0.02191762626171112, 0.03141219913959503, 0.008765737526118755, -0.019356848672032356, -0.0024261721409857273, 0.029311049729585648, 0.013644346036016941, -0.03023030236363411, 0.03892381116747856, 0.02099837362766266, 0.018568918108940125, 0.03314564749598503, 0.008260147646069527, 0.016796071082353592, 0.008883927017450333, 0.017255699262022972, 0.013421098701655865, -0.0001567655272083357, 0.001914016786031425, -0.02271869033575058, -0.018253745511174202, 0.011569459922611713, 0.024465270340442657, 0.03472151234745979, -0.01039412897080183, 0.018385067582130432, 0.009586499072611332, 0.02312578819692135, -0.004396000877022743, 0.003120536683127284, -0.0014962489949539304, -0.033644672483205795, 0.025817885994911194, -0.021077165380120277, -0.028207944706082344, -0.02910093404352665, 0.003762372536584735, -0.020893314853310585, -0.006152431480586529, 0.01972454972565174, -0.011589158326387405, -0.015640439465641975, 0.030860647559165955, -0.010157749056816101, 0.0012295013293623924, 0.013197851367294788, -0.012134144082665443, 0.024097569286823273, 0.034169960767030716, -0.003017120761796832, 0.017846647650003433, 0.010190580040216446, 0.012409919872879982, -0.015115151181817055, -0.01880529709160328, 0.00626405468210578, 0.01873963512480259, 0.0010891510173678398, 0.005929184146225452, 0.02870696783065796, 0.010170881636440754, -0.02392685040831566, -0.0397380068898201, -0.0071045150980353355, -0.017767854034900665, 0.0191204696893692, 0.007314630318433046, 0.042154330760240555, -0.010919416323304176, 0.017951704561710358, 0.026067398488521576, -0.02463598921895027, 0.023703603073954582, -0.007327762432396412, 0.022285327315330505, 0.008765737526118755, -0.0007259639096446335, 0.029468635097146034, -0.005916052032262087, -0.05704623460769653, -0.018345670774579048, -0.006723681464791298, 0.0037886369973421097, 0.03128087893128395, 0.018976015970110893, 0.0017712041735649109, 0.0008913474157452583, 0.02304699458181858, -0.016428370028734207, 0.023467224091291428, 0.00652669882401824, 0.009757217951118946, -0.0104269590228796, 0.029731279239058495, 0.029599957168102264, 0.05415715277194977, -0.022810615599155426, -0.007675765547901392, -0.006868135649710894, 0.016572823747992516, -0.012968038208782673, -0.023729868233203888, -0.004307358525693417, 0.0014724468346685171, 0.06618624180555344, 0.007944975048303604, 0.006815606728196144, -0.0002646957291290164, -0.02576535753905773, 0.013230682350695133, 0.013499892316758633, 0.00034759266418404877, -0.02011851593852043, 0.0111295310780406, 0.007432819809764624, 0.03645496070384979, 0.005522086285054684, 0.012613468803465366, 0.01766279712319374, 0.029993923380970955, -0.011805838905274868, 0.0438615158200264, 0.023493489250540733, 0.041891686618328094, 0.028680704534053802, 0.02749880775809288, -0.013296343386173248, -0.004560153000056744, -0.022219667211174965, -0.01813555508852005, 0.008411168120801449, -0.010768395848572254, 0.01880529709160328, 0.023033862933516502, -0.03592967242002487, -0.042548298835754395, -0.004415699280798435, 0.020512482151389122, -0.021024636924266815, 0.020840786397457123, -0.010801226831972599, 0.04717082902789116, -0.035588234663009644, 0.002503323834389448, -0.004501058254390955, -0.0006984684150665998, 0.014589863829314709, 0.005512237083166838, 0.003434067824855447, 0.030545474961400032, 0.005105139221996069, 0.01967202126979828, 0.01859518140554428, 0.02191762626171112, -0.00970468856394291, 0.015351531095802784, 0.012337693013250828, 0.004422265104949474, -0.004176036454737186, -0.009776915423572063, 0.004793249536305666, 0.037374213337898254, 0.02896961197257042, 0.0016858449671417475, -0.03981680050492287, -0.015023225918412209, -0.022876275703310966, 0.02105090208351612, -0.0010842265328392386, -0.02836553193628788, -0.023086391389369965, 0.0018171669216826558, -0.019343717023730278, 0.004418982192873955, 0.016651617363095284, 0.007157044019550085, -0.019475039094686508, -0.02345409244298935, 0.01707184687256813, 0.026920991018414497, -0.026067398488521576, 0.015824289992451668, 0.01262660138309002, -0.005863523110747337, -0.03661254793405533, -0.015430323779582977, -0.01753147505223751, -0.019146732985973358, 0.013867593370378017, -0.006234507542103529, 0.034511398524045944, -0.018188083544373512, -0.016966789960861206, 0.015469720587134361, 0.00028952377033419907, 0.030466681346297264, 0.022350989282131195, 0.009606197476387024, 0.012015954591333866, -0.040630996227264404, -0.017886044457554817, -0.037505537271499634, 0.009048079140484333, -0.010919416323304176, -0.014090840704739094, -0.002688816050067544, 0.016178859397768974, 0.0038608640898019075, -0.004757136106491089, -0.021878229454159737, -0.0408148467540741, 0.0016907695680856705, 0.013427664525806904, 0.025528978556394577, -0.029941394925117493, 0.016848601400852203, 0.002053546253591776, -0.0042515466921031475, 0.015771761536598206, 0.017032451927661896, 0.003207537578418851, 0.047591060400009155, -0.018188083544373512, 0.008332374505698681, 0.018779031932353973, -0.0105320168659091, 0.029915129765868187, 0.010380996391177177, -0.02445213869214058, 0.0031599332578480244, -0.011168927885591984, -0.0062673380598425865, -0.02983633615076542, -0.019566964358091354, 0.023624811321496964, 0.009422346949577332, 0.01985587179660797, -0.038503583520650864, 0.012731659226119518, 0.02405817247927189, 0.0067762103863060474, 0.003982336726039648, -0.0328042134642601, 0.0022439630702137947, -0.02212774194777012, 0.00687470193952322, -0.00021155137801542878, 0.02271869033575058, 0.02697351947426796, 0.01759713515639305, 0.009415780194103718, -0.03818840906023979, 0.005367782898247242, 0.0006951853283680975, -0.0062180920504033566, -0.007281799800693989, -0.02889081835746765, 0.026001736521720886, -0.0052134795114398, -0.03613978996872902, -0.015824289992451668, -0.024662254378199577, 0.012298296205699444, 0.007977806031703949, 0.03474777564406395, 0.019960930570960045, -0.0012344259303063154, 0.02218027040362358, 0.03167484328150749, -0.004934420809149742, -0.024622857570648193, -0.0166122205555439, -0.0005839720834046602, -0.005814277566969395, 0.010249674320220947, -0.007702029775828123, 0.017767854034900665, -0.010052692145109177, -0.015627305954694748, 0.01733449101448059, 0.017387019470334053, 0.009652160108089447, -0.03230518847703934, -0.011884632520377636, -0.03269915282726288, 0.016520295292139053, 0.03532559424638748, 0.026119926944375038, -0.008680378086864948, -0.00639209384098649, -0.0016054102452471852, 0.01335543766617775, -0.0022653029300272465, -0.012600337155163288, -0.004336906131356955, -0.030676797032356262, 0.011740178801119328, -0.023953115567564964, -0.014064576476812363, -0.02126101590692997, -0.012042218819260597, 0.02776145003736019, 0.01335543766617775, -0.006441339384764433, 0.020079119130969048, -0.02569969743490219, -0.025266334414482117, -0.013210983946919441, -0.02172064408659935, 0.02404504083096981, -0.009008682332932949, 0.004340189043432474, -0.02836553193628788, -0.0014699845341965556, -0.0104269590228796, -0.002677325392141938, -0.029993923380970955, -0.03180616721510887, 0.016691014170646667, 0.00973095279186964, -0.019619492813944817, -0.003417652565985918, -0.02875949814915657, -0.06019796058535576, 0.011431572027504444, -0.013723138719797134, 0.048930540680885315, -0.005866806022822857, 0.004993515554815531, 0.016559692099690437, 0.0008347148541361094, -0.00036339234793558717, 0.005758465733379126, -0.014195897616446018, 0.006461037788540125, -0.02345409244298935, 0.0001906219549709931, 0.016428370028734207, 0.05139939486980438, -0.007537877187132835, 0.011812405660748482, 0.006684285122901201, -0.005295556038618088, 0.041944216936826706, -0.017636531963944435, 0.004629096947610378, -0.01686173304915428, 0.003058158792555332, -0.009304157458245754, 0.02910093404352665, 0.01772845722734928, 0.024793576449155807, -0.03858237713575363, 0.008233883418142796, -0.024215759709477425, -0.015535381622612476, -0.010577979497611523, -0.0382409393787384, 0.001790902460925281, -0.013499892316758633, 0.015784893184900284, -0.04630410298705101, 0.013145322911441326, 0.008076297119259834, -0.0067368135787546635, 0.0258441511541605, -0.008975852280855179, -0.02763012982904911, -0.00873290654271841, 0.0037229759618639946, -0.00943547859787941, -0.007150477729737759, -0.012285164557397366, 0.01992153376340866, 0.008378337137401104, 0.0009241779334843159, 0.009041513316333294, -0.01613946259021759, 0.010840623639523983, 0.02351975254714489, -0.024898633360862732, -0.013460495509207249, 0.010472921654582024, -0.026277514174580574, 0.04457065463066101, 0.004986949265003204, -0.0036835793871432543, -0.021812569350004196, 0.005538501311093569, -0.004031582735478878, -0.019514435902237892, 0.007958107627928257, -0.007754558697342873, 0.014090840704739094, 0.01992153376340866, 0.021484263241291046, 0.013644346036016941, -0.035509444773197174, 0.008746039122343063, -0.008975852280855179, -0.004379585385322571, -0.021287281066179276, 0.00814195815473795, 0.015338398516178131, -0.003995468840003014, 0.00221769860945642, -0.016520295292139053, 0.007275233510881662, 0.02936357818543911, 0.0349578894674778, 2.5623161491239443e-05, 0.008286411873996258, 0.0028611759189516306, -0.012777621857821941, -0.010604243725538254, 0.010899717919528484, -0.007505047135055065, -0.0022653029300272465, -0.0027117973659187555, -0.02351975254714489, -0.031517256051301956, 0.014799978584051132, 0.01012491900473833, 0.055627960711717606, 0.02545018494129181, 0.008897058665752411, -0.009849143214523792, 0.012068483047187328, 0.046540483832359314, -0.02166811376810074, 0.029783807694911957, 0.0048457784578204155, 0.020354894921183586, -0.022902540862560272, 0.011510364711284637, 0.02039429172873497, 0.007892446592450142, -0.024530932307243347, 0.006428207270801067, 0.025213805958628654, 0.014209030196070671, 0.005545067600905895, 0.027472542598843575, -0.030991969630122185, -0.0007403272320516407, -0.023756133392453194, -0.0030253285076469183, -0.02059127390384674, -0.017767854034900665, 0.027603864669799805, -0.008765737526118755, 0.0054104626178741455, -0.02317831665277481, 0.018424462527036667, 0.02504308708012104, 0.04265335574746132, -0.04060473293066025, -0.016323313117027283, 0.00617541279643774, 0.0005109242629259825, 0.030545474961400032, -0.027813980355858803, 7.289391942322254e-05, 0.00034759266418404877, -0.02983633615076542, 0.015167680568993092, 0.014760581776499748, 0.0013509740820154548, -0.0014149935450404882, -0.01767592877149582, 0.01600814051926136, -0.04270588234066963, 0.0033437840174883604, -0.024924898520112038, -0.014406013302505016, 0.01898914761841297, 0.004665210843086243, 0.032173868268728256, 0.008956153877079487, 0.0009208948467858136, -0.0256340354681015, 0.014130237512290478, -0.0004998440272174776, 0.0328042134642601, 0.018122423440217972, -0.0362711101770401, 0.0015282586682587862, -0.0028775911778211594, 0.0001740015286486596, 0.020433688536286354, -0.026947254315018654, 0.029074670746922493, 0.03805708885192871]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
"1 and 3+M×(f+b)|{z}
Part 2.
Step 2: fine-grained analysis without early exits. We provide a more fine-grained analysis, by considering the computa-
tion related to the input processing layer ( IN) and final-exit layer ( FE) separately from the Transformer backbone ( BB). It
is reasonable to assume that fIN< f FEandbIN< b FE, which implies that the last stage is the bottleneck of forward and
backward time. In this setting, Parts 1 and 3 of the critical path takes time fIN+ (P−1)×fBBandbIN+ (P−1)×bBB,
respectively. Similarly, Part 2 now takes time M×(fBB+bBB+fFE+bFE). Taking the sum, we arrive at
time per iteration =fIN+bIN+ (P−1)×(fBB+bBB)| {z }
Parts 1 and 3+M×(fBB+bBB+fFE+bFE)| {z }
Part 2.
Step 3: fine-grained analysis with early exits. Finally, we are ready for our analysis in the setting with early exits ( EE).
First, it can be checked that early-exit layers incur a total overhead of
X
i∈[P−1]Ni×(fEE+bEE)
to Parts 1 and 3. In addition, the sum of forward and backward time of one microbatch for Stage ibecomes
fBB+bBB+ 1(i= 1)×(fIN+bIN) + 1(i=P)×(fFE+bFE) +Ni×(fEE+bEE).
Note that Part 2, namely the steady 1F1B phase on the last stage, is now bottlenecked by the maximum forward and backward
time across all stages. Putting things together, we have the following upper bound:
time per iteration
≤fIN+bIN+ (P−1)×(fBB+bBB) +X
i∈[P−1]Ni×(fEE+bEE)
+M×max
i∈[P]n
fBB+bBB+ 1(i= 1)×(fIN+bIN) + 1(i=P)×(fFE+bFE) +Ni×(fEE+bEE)o
.
The overhead caused by early-exit layers has been highlighted. The first term corresponds to Parts 1 and 3 of the critical
path, and the second term corresponds to Part 2. It is worth mentioning that the second term of the overhead might not take
effect due to the maximum operator, in which case the early-exit overhead to one training iteration is independent of the
number of microbatches.
17
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
A.3.2. P EAK GPU MEMORY
Consider the GPU memory for one specific pipeline stage, say Stage i. Recall that GPU memory usage during training is
mainly composed of memory for model parameters, gradients, optimizer states, and intermediate activations (Rajbhandari
et al., 2019; Korthikanti et al., 2022). Among them, the memory for gradients and optimizer states (for many common
optimizers, such as SGD with momentum or Adam) is proportional to the number of model parameters. Therefore, we
assume that
memory (model parameters, gradients, optimizer states ) =α×memory (model parameters )
for some universal constant α > 1, whose concrete value depends on the choice of optimizer and numerical precisions.
Under this assumption, we have
total memory ≈α×memory (model parameters ) +memory (activations ). (4)
Now it boils down to deriving the memory for model parameters and activations. Model parameters in Stage i∈[P]include
the Transformer backbone ( BB), the input processing layer ( IN) ifi= 1, the final-exit layer ( FE) ifi=P, and the early
exits ( EE). In other words, we have
memory (model parameters ) =mBB+ 1(i= 1)×mIN+ 1(i=P)×mFE+Ni×mEE. (5)
The memory for intermediate activations can be similarly divided into components corresponding to BB,IN,FEandEE.
Note that according to Section A.2, the peak memory usage by activations within one early-exit layer is only m†
EEregardless
of the number of in-flight microbatches P+ 1−i. Thus one has
memory (activations ) = (P+ 1−i)×","[0.03464432433247566, -0.001920665381476283, 0.07187939435243607, -0.03423090651631355, -0.012402502819895744, -0.015820080414414406, 0.054984427988529205, 0.028332827612757683, -0.012574759311974049, 0.04373949393630028, 0.04164484888315201, -0.00015363169950433075, -0.05567345768213272, -0.017528871074318886, -0.023358047008514404, -0.025094397366046906, 0.0075999777764081955, -0.015737397596240044, 0.007193451281636953, 0.036077503114938736, 0.03409310057759285, -0.020105835050344467, 0.030565278604626656, 0.03905410319566727, 0.04517266899347305, -0.0214838907122612, 0.019554613158106804, 0.0030523936729878187, 0.0405699647963047, -0.04875561594963074, 0.030262107029557228, -0.030069177970290184, -0.0580437108874321, -0.029269905760884285, 0.014800319448113441, 0.024115977808833122, -0.006597442552447319, 0.029242344200611115, -0.0219524297863245, 0.032659921795129776, 0.015723617747426033, -0.028360389173030853, -0.07954138517379761, 0.004754292778670788, -0.003355565946549177, 0.009908221662044525, 0.00642518512904644, 0.014896783977746964, -0.006125458050519228, 0.05446076765656471, 0.022889507934451103, 0.03111650049686432, -0.023041093721985817, 0.010921092703938484, 0.0002247953525511548, 0.008302786387503147, 0.00970840360969305, 0.0020464130211621523, 0.03395529463887215, -0.019154977053403854, 0.0515117272734642, -0.06366617977619171, 0.014579830691218376, -0.016247278079390526, -0.012257806956768036, 0.022999752312898636, -0.04836976155638695, 0.03999118134379387, 0.030041616410017014, 0.033128462731838226, -0.034782130271196365, 0.01852107048034668, 0.008688641712069511, -0.03842019662261009, -0.0025201195385307074, 0.029269905760884285, 0.028002094477415085, 0.04980293661355972, 0.02145632915198803, -0.014455805532634258, 0.025066835805773735, -0.019954249262809753, 0.045338038355112076, -0.00693162064999342, 0.004030813463032246, -0.02993137203156948, -0.025783425197005272, -0.0206846185028553, -0.0515117272734642, -0.02700989507138729, -0.020312543958425522, -0.015075931325554848, -0.0214838907122612, 0.016660695895552635, 0.0412314310669899, 0.02403329312801361, 0.002123928628861904, -0.04621999338269234, 0.0021601025946438313, 0.05727200210094452, 0.0168811846524477, 0.02483256533741951, 0.02954551763832569, -0.02612793818116188, 0.018782900646328926, -0.03795165941119194, -0.023509632796049118, 0.01386324129998684, -0.034671884030103683, -0.020822424441576004, -0.022048894315958023, 0.013332690112292767, -0.002127373591065407, 0.0053468565456569195, -0.008075406774878502, -0.02276548184454441, -0.049444641917943954, 0.04260948672890663, -0.0018896590918302536, 0.024763664230704308, -0.015131053514778614, 0.0012617823667824268, -0.007448391988873482, -0.009439682587981224, -0.0029455942567437887, -0.005429539829492569, 0.03450651839375496, -0.01849350892007351, -0.0019275556551292539, -0.038613125681877136, 0.03378992900252342, 0.00888156984001398, 0.06647741049528122, -0.059201277792453766, -0.005188380368053913, -0.016343742609024048, -0.0020360774360597134, 0.03486481308937073, -0.020877545699477196, 0.007730893325060606, 0.033982858061790466, 0.005129812750965357, -0.01850729063153267, -0.0001496482582297176, -0.02098779007792473, 0.07314720749855042, -0.03618774563074112, 0.019513269886374474, -0.0021290963049978018, -0.007627538871020079, 0.005546674598008394, -0.004768073093146086, -0.020960228517651558, -0.03544359654188156, 0.028939172625541687, -0.009591268375515938, -0.022627677768468857, 0.0437670536339283, 0.07518672943115234, -0.012023537419736385, -0.012340489774942398, -0.02069839835166931, 0.04186533764004707, 0.00904693640768528, 0.04379461333155632, 0.08207700401544571, -0.05487418174743652, -0.01808009296655655, -0.07000523805618286, -0.05655541270971298, -0.009040046483278275, -0.022806823253631592, -0.06449301540851593, -0.04258192703127861, 0.014690075069665909, -0.04288509860634804, -0.08791996538639069, -0.05214563384652138, -0.01648154854774475, -0.048700492829084396, -0.03593969717621803, 0.0273544080555439, -0.0014581553405150771, 0.0184797290712595, -0.05016123130917549, 0.052834659814834595, 0.03274260833859444, 0.03624286875128746, 0.019719978794455528, 0.029132099822163582, 0.008654190227389336, 0.023495852947235107, 0.040184106677770615, -0.01431800052523613, 0.016977647319436073, -0.026348426938056946, 0.06344568729400635, -0.031833089888095856, 0.012285367585718632, 0.015310199931263924, 0.0256180576980114, 0.03582945093512535, 0.03955020383000374, -0.055838823318481445, 0.04754292592406273, -0.026348426938056946, -0.016178375110030174, 0.02949039451777935, -0.006170244887471199, -0.0010232065105810761, 0.008068516850471497, -0.00465438375249505, 0.0206846185028553, -0.024529393762350082, -0.022861946374177933, 0.007255463860929012, -0.08488824218511581, 0.03541603684425354, 0.02282060496509075, 0.022861946374177933, 0.03781385347247124, 0.020491689443588257, 0.01393903512507677, 0.024543173611164093, -0.052834659814834595, 0.03464432433247566, 0.021759502589702606, -0.038530442863702774, 0.0062081413343548775, 0.004189289640635252, 0.0038792272098362446, 0.013194885104894638, -0.03197089582681656, -0.04164484888315201, 0.04007386416196823, 0.0037035250570625067, -0.021621696650981903, -0.03230162709951401, 0.008254554122686386, -0.05820908024907112, 0.0070108589716255665, 0.0589807890355587, -0.01605435088276863, -0.020505471155047417, -0.03439627215266228, 0.02443292923271656, -0.003092012833803892, -0.0656505823135376, 0.018231678754091263, 0.01161012053489685, 0.026624038815498352, -0.054543450474739075, -0.022172918543219566, 0.0010361257009208202, -0.05947688966989517, 0.019044730812311172, 0.02480500563979149, 0.0015373935457319021, 0.0033262823708355427, -0.015820080414414406, -0.005784389562904835, 0.015764959156513214, -0.017487527802586555, -3.2325100619345903e-05, -0.015062150545418262, -0.008385470137000084, -0.005946311168372631, 0.010280296206474304, 0.019072292372584343, -0.010032246820628643, 0.03150235489010811, -0.030537717044353485, 0.017170576378703117, 0.015420445241034031, -0.035994820296764374, -0.008564617484807968, 0.05018879473209381, 0.020105835050344467, -0.042692169547080994, -0.002332359552383423, -0.022655237466096878, 0.030868450179696083, 0.06746961176395416, -0.00019335845718160272, 0.008743763901293278, -0.01475897803902626, 0.04497974365949631, 0.026761844754219055, -0.03591213375329971, -0.0353609137237072, 0.028856489807367325, -0.0062529281713068485, 0.05005098879337311, -0.022172918543219566, 0.035112861543893814, -0.015682276338338852, -0.017790701240301132, -0.03872336819767952, 0.009522365406155586, 0.0038551113102585077, 0.03158504143357277, -0.04759804904460907, -0.011706584133207798, 0.045668769627809525, -0.03332139179110527, 0.03924702852964401, -0.02356475405395031, 0.008571507409214973, -0.040652647614479065, 0.01054901722818613, -0.004723286256194115, -0.005960091482847929, 0.003195367055013776, 0.01431800052523613, -0.03274260833859444, -0.007786015514284372, 0.002229005331173539, -0.04117630794644356, 0.010376760736107826, -0.026196841150522232, 0.005067800171673298, -0.0555080883204937, -0.033018216490745544, -0.009060717187821865, 0.03910922631621361, 0.021153157576918602, 0.0030868451576679945, 0.03186064958572388, -0.03329382836818695, -0.010624810121953487, -0.002606248017400503, -0.01435934193432331, -0.015365323051810265, -0.04933439940214157, -0.012471405789256096, -0.01729460060596466, -0.0489761047065258, 0.009763525798916817, 0.05732712149620056, 0.016578011214733124, -0.06322520226240158, -0.00923986453562975, -0.03326626867055893, 0.020450348034501076, -0.017087891697883606, 0.025025494396686554, 0.02155279368162155, -0.001254892093129456, 0.09933026134967804, 0.028098559007048607, -0.006914395373314619, -0.022035112604498863, 0.028498195111751556, -0.03621530905365944, 0.01682606153190136, -0.025025494396686554, 0.04602706432342529, -0.02858087792992592, -0.02060193568468094, 0.012815919704735279, -0.014276658184826374, -0.003951575141400099, 0.03323870524764061, -0.0007480259519070387, -0.0321638248860836, 0.02610037848353386, -0.04586169868707657, 0.013980376534163952, -0.016164595261216164, 0.0006291686440818012, 0.027988314628601074, 0.038558002561330795, -0.02645867131650448, -0.013980376534163952, -0.046550724655389786, -0.0219524297863245, 0.005949756130576134, 0.024777444079518318, 0.001145508955232799, 0.03235675022006035, 0.004940330050885677, 0.024680979549884796, 0.00590152433142066, 0.022972190752625465, 0.024088416248559952, 0.033431634306907654, 0.004389107692986727, -0.02361987717449665, -0.037676047533750534, 0.0017742469208315015, -0.0016657250234857202, 0.007744673639535904, -0.016729597002267838, 0.021001571789383888, -0.005949756130576134, -0.0056190225295722485, 0.046137310564517975, 0.04765317216515541, 0.04371193051338196, 0.010149381123483181, -0.022048894315958023, -0.025397568941116333, -0.02312377654016018, -0.058815423399209976, 0.037703607231378555, -0.003291830886155367, 0.06190226972103119, -0.013318909332156181, 0.04508998617529869, 0.0005365805118344724, 0.049003664404153824, -0.006053110118955374, 0.0134429344907403, -0.006001433357596397, 0.014455805532634258, -0.034368712455034256, -0.0010645481524989009, 0.02151145227253437, 0.01492434460669756, 0.06967450678348541, -0.014869222417473793, -0.008089187555015087, -0.032577238976955414, 0.020794862881302834, -0.04495218023657799, 0.010404321365058422, 0.033872611820697784, -0.007524184882640839, -0.01156877912580967, -0.046909019351005554, -0.03128186613321304, 0.02993137203156948, 0.011623901315033436, 0.018782900646328926, -0.06068957969546318, -0.02109803445637226, -0.022806823253631592, 0.005164264235645533, -0.01410440169274807, -0.025879887863993645, 0.009749745018780231, -0.006328721530735493, -0.014249097555875778, 0.01637130416929722, -0.04999586567282677, 0.025769643485546112, -0.05220075696706772, -0.0181489959359169, 0.03337651118636131, -0.007400159724056721, 0.0038861173670738935, 0.03073064610362053, 0.02651379443705082, 0.04809414967894554, 0.012781468220055103, -0.05396466702222824, 0.08852630853652954, 0.026748063042759895, 0.0016863958444446325, -0.0021824960131198168, 0.02316511794924736, -0.00473362160846591, -0.0018448722548782825, -0.043574124574661255, -0.017887163907289505, 0.01639886386692524, 0.04164484888315201, -0.012554088607430458, -0.0018948267679661512, 0.022434748709201813, 0.012974395416676998, -0.015668494626879692, 0.047405119985342026, -0.01730838045477867, -0.00987377017736435, -0.006762809120118618, -0.04379461333155632, -0.02910454012453556, -0.0033262823708355427, -0.011844390071928501, 0.004175509326159954, -0.022007551044225693, -0.011809938587248325, -0.05338588356971741, -0.006786924786865711, 0.10952787846326828, 0.003786208340898156, -0.029352588579058647, 0.0094741340726614, -0.012161342427134514, 0.007848028093576431, -0.015888983383774757, 0.03759336471557617, -0.01642642542719841, -0.0012032149825245142, -0.02447427250444889, -0.03197089582681656, -0.03337651118636131, 0.017143014818429947, -0.011293167248368263, 0.03480968996882439, -0.014345561154186726, 0.000807454576715827, -0.01728082075715065, -0.0227517019957304, -0.042719729244709015, -0.0031212964095175266, -0.014428244903683662, -0.02910454012453556, -0.006449301261454821, -0.03525066748261452, 0.023330485448241234, -0.01287793181836605, 0.032191384583711624, -0.0026183060836046934, 0.019196318462491035, 0.021704379469156265, 0.015737397596240044, -0.006921285297721624, 0.019210098311305046, 0.011968415230512619, -0.019981808960437775, -0.020078273490071297, -0.02951795607805252, -0.009570597670972347, -0.04222363233566284, -0.025066835805773735, -0.09668439626693726, -0.01606813073158264, -0.0073312572203576565, 0.037648484110832214, -0.013263787142932415, -0.02565939910709858, -0.008068516850471497, -0.024584516882896423, -0.0032522117253392935, -0.010445663705468178, -0.031805530190467834, -0.05341344326734543, -0.007551745977252722, 0.023909268900752068, 0.035553839057683945, 0.017349723726511, 0.017515089362859726, -0.004954110831022263, -0.0029921038076281548, 0.027588678523898125, 0.012678113766014576, 0.01351183746010065, -0.005412314087152481, -0.004833530634641647, -0.010797067545354366, 0.014455805532634258, -0.04429071396589279, -0.02525976300239563, 0.001544283819384873, 0.006332166492938995, 0.0028904720675200224, 0.0059359753504395485, 0.012051098048686981, 0.02866356074810028, -0.00444078492000699, 0.02654135599732399, -0.03117162361741066, -0.03425846993923187, 0.021166937425732613, 0.00027324262191541493, -0.06465838104486465, 0.031392112374305725, -0.004957555793225765, -0.02447427250444889, -0.006356282625347376, 0.0011868505971506238, -0.022806823253631592, -0.008688641712069511, -0.012802138924598694, 0.04539315775036812, 0.04508998617529869, -0.021787062287330627, -0.013408483006060123, -0.03147479519248009, -0.0018741559470072389, -0.01934790425002575, -0.03271504491567612, -0.00558457151055336, 0.0018328143050894141, -0.04186533764004707, -0.017377283424139023, -0.045255355536937714, 0.01597166806459427, 0.03274260833859444, -0.03875093162059784, 0.01602678932249546, -0.0042134057730436325, -0.005494997836649418, -0.002015406731516123, 0.008302786387503147, 0.01518617570400238, -0.0005550981150008738, -0.008151200599968433, 0.007441501598805189, -0.02111181616783142, 0.006287379655987024, -0.004172063898295164, -0.017997410148382187, 0.006122013088315725, -0.028911611065268517, 0.001145508955232799, 0.008323457092046738, -0.01243006344884634, -0.007214122451841831, 0.01158255897462368, -0.025094397366046906, -0.0009353553759865463, -0.03591213375329971, -0.0232202410697937, 0.006228812504559755, -0.020974010229110718, 0.043601687997579575, -0.010390540584921837, 0.026210622861981392, 0.004395998083055019, 0.02155279368162155, -0.02071218006312847, 0.021690599620342255, -0.010032246820628643, -0.02487390860915184, 0.002659647725522518, 0.010617920197546482, 0.019251439720392227, -0.0337623693048954, 0.010280296206474304, 0.014042388647794724, -0.01072127465158701, 0.002172160428017378, 0.024749882519245148, -0.019279001280665398, 0.024667199701070786, -0.029187222942709923, -0.04343631863594055, 0.03759336471557617, -0.016977647319436073, 0.01678472012281418, -0.03679409250617027, 0.0014848551945760846, 0.042361438274383545, -0.010996885597705841, 0.026210622861981392, -0.011603230610489845, -0.027960753068327904, -0.028773805126547813, -0.024240002036094666, 0.03070308454334736, 0.018713997676968575, 0.04338119924068451, -0.025604277849197388, -0.008240774273872375, -0.00946724321693182, -0.006235702894628048, -0.03243943303823471, -0.02772648259997368, -0.011679023504257202, -0.04423559084534645, -0.005129812750965357, 0.011975305154919624, 0.04205826297402382, 0.014883003197610378, 0.027133919298648834, 0.012567869387567043, -0.027175260707736015, 0.003713860409334302, 0.0329630970954895, -0.001246279221959412, 0.016205936670303345, -0.0032367086969316006, -0.02534244768321514, -0.02145632915198803, -0.025631839409470558, -0.02237962745130062, 0.004609596915543079, -0.02352341264486313, -0.0077102226205170155, -0.03197089582681656, -0.021194498986005783, -0.02098779007792473, -0.006011768709868193, -0.012581650167703629, -0.03503017872571945, 0.0025769644416868687, -0.035195544362068176, -0.01689496450126171, 0.010135600343346596, 0.013001956976950169, -0.027974532917141914, 0.009405231103301048, -0.03627042844891548, -0.03031722828745842, 0.03833751380443573, -0.013360251672565937, -0.053330760449171066, -0.0019137749914079905, -0.010859079658985138, -0.047846097499132156, -0.010872860439121723, -0.016743378713726997, -0.04010142385959625, -0.03238431364297867, 0.0665876567363739, 0.05473637953400612, -0.03359699994325638, -0.03591213375329971, -0.0015511740930378437, 0.0006149574182927608, -0.0032935533672571182, -0.05007854849100113, -0.004327095113694668, 0.017473747953772545, 0.023454509675502777, -0.056279800832271576, -0.010459443554282188, -0.03412066400051117, -0.0010955544421449304, -0.03833751380443573, 0.021249620243906975, 0.013628972694277763, -0.02016095630824566, -0.04134167358279228, 0.01944436877965927, 0.019458148628473282, 0.012113111093640327, 0.04933439940214157, 0.02524598315358162, 0.007813576608896255, -0.010018466040492058, 0.005036794114857912, 0.024612076580524445, -0.02984868921339512, -0.02827770635485649, -0.039467521011829376, 0.0026820411439985037, -0.0028818591963499784, -0.03657360374927521, -0.03464432433247566, 0.04395998269319534, -0.007345037534832954, -0.015020808205008507, 0.01433178037405014, 0.02197999134659767, 0.007951382547616959, -0.026224402710795403, -0.03205357864499092, 0.012912383303046227, -0.024722320958971977, 0.00399636197835207, 0.012760797515511513, -0.0007096987683326006, 0.04597194120287895, 0.01309153065085411, 0.01307085994631052, -0.025204641744494438, 0.01010114885866642, 0.0069075049832463264, -0.006835157051682472, 0.017184356227517128, 0.0016037124441936612, 0.002986936131492257, 0.0014409295981749892, -0.01762533374130726, 0.04605462774634361, 0.005071245599538088, -0.03031722828745842, -0.0032711599487811327, 0.04999586567282677, 0.004885207861661911, 0.030896011739969254, -0.0007032391149550676, 0.02359231561422348, -0.03784141317009926, -0.020574374124407768, 0.005846401676535606, -0.009301876649260521, -0.005305515136569738, 0.03395529463887215, -0.01496568601578474, -0.025383789092302322, 0.0036415124777704477, -0.019030950963497162, 0.02309621497988701, 7.606222061440349e-05, -0.05727200210094452, -0.0017096505034714937, -0.03580189123749733, 0.004516577813774347, -0.030151862651109695, -0.017005208879709244, 0.019981808960437775, 0.015007028356194496, -0.12667089700698853, -0.00945346336811781, 0.044097788631916046, 0.012788358144462109, -0.022930849343538284, -0.00881266687065363, 0.011761706322431564, -0.0036828541196882725, 0.009543037042021751, -0.023688780143857002, -0.0008569784695282578, 0.01602678932249546, -0.003927459008991718, -0.0030678967013955116, 0.007951382547616959, -0.03406554087996483, 0.010817738249897957, 0.01471763662993908, 0.009811757132411003, -0.034837253391742706, -0.029242344200611115, -0.01282969955354929, -0.01726703904569149, -0.0004259053966961801, -0.06454813480377197, -0.030620399862527847, -0.012299148365855217, -0.014634952880442142, 0.011933963745832443, 0.0010455998126417398, -0.01978888176381588, 0.012002866715192795, 0.00714521948248148, 0.005257282871752977, -0.01773557811975479, 0.01853485032916069, -0.02695477195084095, -0.008592178113758564, 0.01857619360089302, -0.0028008983936160803, -0.026651600375771523, -0.036077503114938736, 0.0464404821395874, -0.01139652170240879, 0.0041066063567996025, 0.027974532917141914, 0.0194168072193861, -0.015310199931263924, 0.036821652203798294, -0.00629771500825882, -0.027685141190886497, -0.018824242055416107, 0.010576578788459301, 0.009935782290995121, 0.007303696125745773, -0.009481023997068405, -0.026431111618876457, 0.00045992614468559623, 0.030206983909010887, 0.041920457035303116, -0.013318909332156181, 0.04649560526013374, -0.015572031028568745, -0.02827770635485649, -0.023261582478880882, -0.010190722532570362, 0.03990849852561951, 0.020960228517651558, 0.00013285319437272847, -0.03073064610362053, -0.024184880778193474, 0.0031040706671774387, 0.003415855811908841, -0.018024969846010208, 0.001488300273194909, 0.025879887863993645, -0.014648733660578728, 0.03538847342133522, -0.03822726756334305, 0.004030813463032246, 0.0082063227891922, 0.000648978166282177, 0.01813521422445774, -0.0361601859331131, -0.010431882925331593, 0.04599950462579727, 0.009191632270812988, -0.027933191508054733, 0.017377283424139023, 0.02192486822605133, 0.036463357508182526, -0.010962434113025665, 0.02155279368162155, 0.012071768753230572, -0.0005637109861709177, 0.024322684854269028, 0.028553316369652748, 0.01639886386692524, 0.040266793221235275, 0.009997795335948467, 0.0024322685785591602, 0.03618774563074112, -0.011554998345673084, -0.048231955617666245, -0.017404844984412193, -0.00883333757519722, -0.011933963745832443, -0.014262878336012363, 0.004823195282369852, -0.016605572775006294, 0.024984152987599373, -0.0001941120863193646, -0.010604139417409897, 0.05360637232661247, 0.01535154227167368, 0.00819943193346262, 0.02437780797481537, 0.010424992069602013, 0.00839236006140709, -0.05018879473209381, -0.03246699646115303, 0.016660695895552635, -0.015792520716786385, -0.0030954580288380384, -0.027685141190886497, -0.02352341264486313, -0.00033783901017159224, 0.0453655980527401, -0.015668494626879692, 0.000777309644035995, -0.017818262800574303, 0.012678113766014576, 0.02315133810043335, -0.005147038493305445, -0.004595816135406494, 0.0039033431094139814, 0.00629771500825882, 0.00905382726341486, 0.018204117193818092, 0.029821127653121948, -0.003768982831388712, 0.020464129745960236, 0.03654604032635689, 0.004189289640635252, 0.011927072890102863, 0.011224265210330486, 0.002981768222525716, -0.0027492213994264603, 0.01220268476754427, -0.004437339957803488, 0.02778160572052002, -0.009322547353804111, 0.0011300058104097843, -0.021290963515639305, -0.012299148365855217, -0.011506766080856323, -0.04252680391073227, -0.023661218583583832, -0.04423559084534645, 0.01719813607633114, 0.039770692586898804, 0.03966044634580612, 0.008743763901293278, 0.0009620552300475538, 0.008268334902822971, -0.017018988728523254, -0.015530689619481564, 0.007345037534832954, -0.03108893893659115, 0.015516908839344978, -0.003381404560059309, -0.0337623693048954, 0.04423559084534645, 0.014883003197610378, 0.04434583708643913, 0.015833862125873566, -0.01937546581029892, 0.024171099066734314, 0.0007437195163220167, 0.01602678932249546, 0.009653281420469284, -0.0048645371571183205, -0.00801339466124773, 0.013139761984348297, -0.007565526757389307, -0.014249097555875778, -0.014469586312770844, 0.01134828943759203, 0.02774026431143284, 0.032274067401885986, 0.038916297256946564, 0.03290797397494316, 0.015241297893226147, 0.030179422348737717, 0.011086459271609783, -0.04580657556653023, -0.015434225089848042, 0.029600638896226883, -0.00945346336811781, -0.021180719137191772, 0.010907311923801899, 0.014607392251491547, 0.007469062693417072, -0.03593969717621803, -0.0512361153960228, 0.0248187854886055, -0.009487914852797985, -0.014028608798980713, -0.007007414009422064, 0.01938924565911293, 0.014166413806378841, 0.011603230610489845, -0.011761706322431564, 0.04594438150525093, -0.035967256873846054, -0.023330485448241234, 0.016950087621808052, 0.008971143513917923, 0.00558457151055336, 0.016591792926192284, -0.007572416681796312, -0.015296420082449913, 0.016205936670303345, 0.026375988498330116, -0.0023564754519611597, 0.007131439168006182, -0.015323980711400509, 0.01900338940322399, 0.002709602238610387, 0.0063218311406672, -0.006600887514650822, -0.007951382547616959, -0.016619352623820305, 0.0009198522893711925, -0.005129812750965357, -0.01455227006226778, -0.00651131384074688, -0.006490643136203289, 0.013415373861789703, 0.02028498239815235, 0.033045779913663864, 0.022186698392033577, -0.036408234387636185, 0.0023375272285193205, 0.03591213375329971, -0.022489871829748154, 0.004706060513854027, 0.03254967927932739, -0.013477385975420475, -0.02236584573984146, 0.007978943176567554, 0.02359231561422348, 0.017515089362859726, -0.027657581493258476, 0.03034478984773159, 0.0006498394650407135, 0.0134429344907403, 0.019719978794455528, 0.0052262768149375916, 0.009556816890835762, -0.008895350620150566, 0.011382740922272205, 0.005653474014252424, 0.009653281420469284, 0.0028387950733304024, -0.018796682357788086, -0.0328252911567688, 0.006986743304878473, 0.01943058706820011, 0.0320260189473629, -0.015613372437655926, 0.02309621497988701, 0.005760273430496454, 0.01096932403743267, 0.015875203534960747, 0.003882672404870391, 0.004041148815304041, -0.015888983383774757, 0.014979466795921326, -0.02360609732568264, -0.0453655980527401, -0.020808642730116844, -0.010066698305308819, -0.02611415833234787, 0.007689551450312138, 0.013408483006060123, -0.030951134860515594, -0.011458534747362137, 0.04641292244195938, -0.012843480333685875, 0.006356282625347376, 0.011410302482545376, -0.010879751294851303, 0.0168811846524477, 0.03886117413640022, 0.004471790976822376, 0.031006256118416786, 0.016619352623820305, -0.0029455942567437887, -0.03323870524764061, -0.021180719137191772, 0.008557726629078388, 0.007916931062936783, 0.005401978734880686, 0.005808505229651928, 0.008943581953644753, 0.012326709926128387, -0.029269905760884285, -0.028884049504995346, -0.0007041004137136042, -0.011479205451905727, 0.031447235494852066, 0.0039412397891283035, 0.02107047289609909, 0.004464901052415371, 0.017528871074318886, 0.019871564581990242, -0.011217374354600906, 0.02486012689769268, -0.0031505802180618048, 0.017983628436923027, 0.01597166806459427, -0.006945401430130005, 0.024584516882896423, -0.0018414270598441362, -0.05942176654934883, -0.002535622799769044, -0.001865543075837195, 0.0007742951274849474, 0.04032191261649132, 0.036408234387636185, 0.0033297273330390453, 0.005915304645895958, 0.007758454419672489, -0.04892098158597946, 0.013243116438388824, -0.005718931555747986, -0.005856737494468689, -0.0252873245626688, 0.02780916728079319, 0.03924702852964401, 0.0512361153960228, -0.0012480018194764853, 0.009398341178894043, -0.00515737384557724, 0.02357853576540947, -0.03425846993923187, -0.02141498774290085, -0.01478653959929943, -0.0020016261842101812, 0.06537497043609619, -0.006049665156751871, 0.003291830886155367, 0.013291348703205585, -0.030399911105632782, 0.028553316369652748, 0.02309621497988701, -0.0014004491968080401, -0.014138853177428246, 0.007420830894261599, 0.002924923552200198, 0.03412066400051117, -0.006115122698247433, -0.009040046483278275, 0.04084557667374611, 0.022655237466096878, -0.027257945388555527, 0.02731306664645672, 0.010989995673298836, 0.035112861543893814, 0.03340407460927963, 0.028884049504995346, -0.014138853177428246, -0.014566049911081791, -0.017928507179021835, -0.016329960897564888, 0.009136510081589222, -0.012071768753230572, 0.017501309514045715, 0.03147479519248009, -0.040625087916851044, -0.027161480858922005, -0.00038499434594996274, 0.026265744119882584, -0.00034106880775652826, 0.03238431364297867, 0.002060193568468094, 0.04845244437456131, -0.04511754959821701, 0.007606868166476488, 0.0038964529521763325, 0.008337237872183323, -0.005522558931261301, 0.009522365406155586, -0.014152633026242256, 0.016688255593180656, 0.0037552020512521267, 0.02364743873476982, -0.00839236006140709, 0.009164071641862392, -0.013057079166173935, 0.005023013334721327, -0.003992917016148567, -0.001259198528714478, 7.918437768239528e-05, -0.011003775522112846, 0.0012109666131436825, 0.05013367161154747, 0.027643799781799316, 0.010170051828026772, -0.03971556946635246, -0.018314361572265625, -0.010817738249897957, 0.025907449424266815, 0.01635752245783806, -0.02061571553349495, -0.013897692784667015, 0.002254843944683671, -0.011038227006793022, 0.005636248271912336, 0.008764435537159443, -0.00484042102470994, 0.0030334454495459795, -0.00860595889389515, 0.005019568372517824, 0.021194498986005783, -0.03503017872571945, 0.029766006395220757, 0.023344265297055244, 0.008323457092046738, -0.02571452222764492, -0.017101673409342766, -0.0014168136985972524, -0.005977317225188017, -0.0050746905617415905, 0.004289198666810989, 0.04349144175648689, -0.011837499216198921, -0.010865970514714718, 0.022903287783265114, -0.010356090031564236, 0.022104015573859215, 0.00139614287763834, 0.0071176583878695965, 0.012864151038229465, -0.03547115623950958, -0.011520546860992908, -0.040294352918863297, 0.02819502167403698, -0.008509494364261627, -0.02570074051618576, -0.00420996081084013, 0.0004633712815120816, -0.0023185790050774813, -0.004957555793225765, -0.0017673566471785307, -0.04464900866150856, 0.0074346112087368965, -0.01220268476754427, 0.01604056917130947, -0.03241187334060669, 0.0010852189734578133, 0.010059807449579239, -0.0016433316050097346, 0.010535236448049545, 0.010376760736107826, -0.0013978653587400913, 0.028360389173030853, -0.009267425164580345, -0.020367665216326714, 0.034782130271196365, 0.0015244742389768362, 0.020105835050344467, 0.011093349196016788, -0.03150235489010811, 0.00883333757519722, -0.014745197258889675, -8.402911043958738e-05, -0.022434748709201813, -0.019692417234182358, 0.001113641425035894, 0.020491689443588257, 0.01161012053489685, -0.03588457405567169, 0.003036890644580126, 0.015682276338338852, 0.0024701650254428387, -0.012616101652383804, -0.016646914184093475, -0.01649532839655876, -0.008826447650790215, 0.006349392235279083, 0.010686823166906834, 0.02437780797481537, 0.016329960897564888, 0.00991511158645153, 0.007159000262618065, -0.030647961422801018, -0.008323457092046738, 0.0026665381155908108, -0.0032539344392716885, 0.0024684425443410873, -0.03252211958169937, 0.02491525001823902, -0.008936692029237747, -0.014745197258889675, -0.019499490037560463, -0.031033817678689957, 0.016192156821489334, -0.009963343851268291, 0.045255355536937714, 0.014772758819162846, -0.0047577377408742905, 0.0159441065043211, 0.054488327354192734, -0.012788358144462109, -0.022090235725045204, 0.007124548777937889, -0.005412314087152481, -0.003751757089048624, 0.0021549349185079336, -0.011548107489943504, 0.0006438104901462793, -0.023275362327694893, -0.01897582970559597, -0.006518204230815172, 0.005085025914013386, 0.007255463860929012, -0.03370724618434906, -0.017101673409342766, -0.02695477195084095, 0.0041066063567996025, 0.043160710483789444, 0.021690599620342255, -0.014249097555875778, -0.01849350892007351, 0.011679023504257202, 0.01243006344884634, -0.007124548777937889, -0.02268279902637005, -0.0031574703752994537, -0.022131577134132385, 0.006793815176934004, -0.031777966767549515, -0.011527436785399914, -0.005112587008625269, -0.020946448668837547, 0.049499765038490295, 0.03238431364297867, -0.000651131384074688, -0.0041686189360916615, -0.024281343445181847, -0.02446049079298973, -0.012120001018047333, -0.017501309514045715, 0.013746106997132301, -0.0008182206656783819, 0.009825537912547588, -0.027519775554537773, -0.025921231135725975, 0.006180580239742994, -0.0018862138967961073, -0.03119918331503868, -0.019513269886374474, 0.012333599850535393, 0.01518617570400238, -0.008736873976886272, -0.0030248325783759356, -0.0372350700199604, -0.0691232830286026, -0.012498966418206692, -0.011334509588778019, 0.04373949393630028, 0.00818565208464861, -0.003124741604551673, 0.005656919442117214, 0.003576054936274886, 0.002180773299187422, 0.014497147873044014, -0.01976132020354271, 0.0065733264200389385, -0.030868450179696083, -0.0017105118604376912, -0.008158090524375439, 0.03210870176553726, -0.015778739005327225, -0.005343411583453417, -0.009377669543027878, -0.007923820987343788, 0.03326626867055893, -0.005023013334721327, -0.002595912665128708, -0.005601796787232161, 0.00797205325216055, -0.01805253140628338, 0.026706721633672714, 0.01116914302110672, 0.01937546581029892, -0.041837774217128754, 0.020050711929798126, -0.030840890482068062, -0.0011851279996335506, 0.004761182703077793, -0.028525756672024727, 0.008964253589510918, -0.015282639302313328, 0.0001820540928747505, -0.03613262251019478, 0.021718159317970276, 0.004974781535565853, -0.018645094707608223, 0.009598159231245518, 0.002351307775825262, -0.02486012689769268, -0.013601411134004593, 0.019513269886374474, -0.010783286765217781, 0.008295896463096142, -0.0017277374863624573, 0.004085935652256012, -0.0010180387180298567, 0.007916931062936783, -0.002888749586418271, -0.01116225216537714, -0.00044916008482687175, 0.012974395416676998, -0.0320260189473629, -0.010190722532570362, 0.024570735171437263, -0.01769423671066761, 0.03591213375329971, 0.0031798637937754393, 0.004719841293990612, -0.026706721633672714, 0.006625003647059202, 0.0019706198945641518, -0.007186561357229948, -0.0008289866964332759, -0.017005208879709244, -0.001312598236836493, 0.017418626695871353, 0.007717112544924021, 0.0062081413343548775, -0.02785050868988037, 0.02056059241294861, -0.007441501598805189, -0.004888653289526701, -0.031364552676677704, 0.015820080414414406, 0.014510927721858025, -0.001165318419225514, 0.002835349878296256, 0.0049713365733623505, 0.008047846145927906, 0.02827770635485649, 0.025549154728651047, 0.003593280678614974, 0.005457100924104452, 0.011679023504257202, -0.00859906803816557, -0.011541217565536499, 0.002497726120054722, -0.0049231043085455894, 0.0026010803412646055, -0.006352837197482586, -0.03425846993923187, -0.014400683343410492, 0.006917840335518122, 0.009012484923005104, 0.05264173448085785, 0.02527354471385479, 0.006507868878543377, -0.022903287783265114, 0.016536669805645943, 0.05782322213053703, -0.023385606706142426, 0.04586169868707657, 0.010211394168436527, 0.017542650923132896, -0.014262878336012363, 0.006060000509023666, 0.0009181296918541193, 0.01593032479286194, -0.032191384583711624, -0.0043339855037629604, 0.012581650167703629, 0.019899126142263412, 0.012726346030831337, 0.019210098311305046, -0.034727007150650024, -0.014869222417473793, -0.008909131400287151, -0.016578011214733124, -0.024115977808833122, -0.009129620157182217, 0.03031722828745842, -0.013353360816836357, 0.002545958152040839, -0.04244412109255791, -0.0024753327015787363, 0.03651848062872887, 0.042333874851465225, -0.045338038355112076, -0.009618829935789108, -3.846175241051242e-05, 0.01565471477806568, 0.018176555633544922, -0.03412066400051117, -0.012781468220055103, -0.01642642542719841, -0.027244163677096367, 0.004799079615622759, 0.0248187854886055, -0.00452346820384264, 0.0017759695183485746, -0.005715486593544483, 0.022903287783265114, -0.027685141190886497, -0.0036552930250763893, -0.03464432433247566, -0.01285037025809288, 0.015764959156513214, 0.01765289530158043, 0.04092825949192047, -0.012395611964166164, -0.004961001221090555, -0.006897169630974531, -0.020781081169843674, -0.002237618202343583, 0.02943527325987816, 0.01938924565911293, -0.04167240858078003, 0.005925639998167753, -0.023371826857328415, 0.0015218904009088874, 0.010094258934259415, -0.006411404814571142, 0.017583992332220078, 0.04511754959821701]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
"m†
BB+ 1(i= 1)×P×m†
IN+ 1(i=P)×m†
FE+Ni×m†
EE. (6)
Combining Eq. (5) and (6) with Eq. (4), we arrive at an estimate of memory usage for Stage i:
total memory ≈α×
mBB+ 1(i= 1)×mIN+ 1(i=P)×mFE+Ni×mEE
+
(P+ 1−i)×m†
BB+ 1(i= 1)×P×m†
IN+ 1(i=P)×m†
FE+Ni×m†
EE
.
The memory overhead caused by early-exit layers has been highlighted in red. Finally, taking the maximum over i∈[P]
gives the peak GPU memory across all pipeline stages.
B. Additional experiments
B.1. A comparison between two inference methods
Since both pipeline-based method and KV recomputation generate the same output for the same prompt, here we only
compare the inference latency of both methods. Given that the pipeline-based method uses 4 GPUs for a pipeline parallelism
(PP) degree of 4, we allow KV recomputation to use a tensor parallelism (TP) degree of 1 or 4 for a fair comparison. The
empirical results on XSUM and CNN/DailyMail tasks are shown in Figure 10. We first notice that the pipeline-based
approach outperforms KV recomputation with TP= 1for confidence thresholds smaller than 1 (i.e. when early exiting
actually happens), despite the point-to-point communication overhead. Moreover, KV recomputation with TP= 4is faster
than the pipeline-based approach; it is worth noting, however, that the small speedup from TP= 1 toTP= 4 for KV
recomputation is only possible with high-end hardware like A100 GPUs connected by high-bandwidth communication. In
many use cases of LLM inference, such hardware is not available, and pipeline parallelism is the only option for partitioning
a model that is too large to fit into the memory of one single device. In sum, the proposed pipeline-based approach is a more
practical option for LLM inference with model partitioning in a wide range of scenarios.
B.2. Examples of generated texts
Example texts generated by our early-exit models are presented in Tables 3 and 4.
18
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
0.00 0.25 0.50 0.75 1.00
Threshold01234Average inference time (s)
KV recomputation [TP=4]
KV recomputation [TP=1]
Pipeline-based [PP=4]
(a) XSUM
0.00 0.25 0.50 0.75 1.00
Threshold0246Average inference time (s)
KV recomputation [TP=4]
KV recomputation [TP=1]
Pipeline-based [PP=4] (b) CNN/DailyMail
Figure 10: Inference latencies of the pipeline-based method and KV recomputation for our 7B early-exit model.
Table 3: Sequences generated by our 7B early-exit model for the same prompt, with varying confidence thresholds and
inference latencies. Differences from the result of full-model inference are highlighted in red.
Prompt Artificial General Intelligence is
Full model
(Time: 1.42 s)a branch of computer science that studies the development of computer systems that can perform
tasks that normally require human intelligence.
The term ”artificial intelligence” was coined by John McCarthy in 1956.
Threshold = 0.8
(Time: 1.17 s)a branch of computer science that studies the development of computer systems that can perform
tasks that normally require human intelligence.
The term ”artificial intelligence” was coined by John McCarthy in 1956.
Threshold = 0.4
(Time: 0.89 s)a branch of computer science that studies the development of computer systems that can perform
tasks that normally require human intelligence.
The term artificial general intelligence was coined by John McCarthy in 1965.
Threshold = 0.2
(Time: 0.58 s)a branch of computer science that deals with the development of computer programs that can be
used to perform tasks such as problem solving, decision making, and learning.
Artificial General Intelligence is a branch of computer science that
Table 4: The predicted token and confidence at each exit of our 32-layer 7B early-exit model for generating each token
within one sequence. The prompt is","[0.027478495612740517, 0.01189844124019146, 0.05566956102848053, 0.008305898867547512, -0.01093350164592266, -0.006695192772895098, 0.01886826939880848, 0.033728331327438354, -0.006765707395970821, 0.05887613072991371, 0.001632045954465866, -0.02067938633263111, -0.027508186176419258, -0.004646552726626396, -0.015884382650256157, -0.02992795594036579, -0.003993363119661808, 0.0003727541188709438, -0.027478495612740517, 0.030239706858992577, -0.002028227783739567, -0.019328471273183823, -0.0021952365059405565, 0.015854692086577415, 0.04604986310005188, -0.032600097358226776, -0.006706326734274626, 0.0014307077508419752, 0.013056367635726929, -0.05050342530012131, 0.04037898778915405, -0.03366895020008087, -0.029200540855526924, -0.05118630826473236, 0.011119067668914795, 0.04619831219315529, -0.0073966290801763535, 0.049998689442873, -0.014102955348789692, 0.025132952257990837, 0.02283194288611412, -0.009077849797904491, -0.0622311495244503, 0.012729773297905922, -0.022193599492311478, 0.04254639148712158, -0.0010233920766040683, -0.010451032780110836, -0.0047207786701619625, 0.06567523628473282, -0.012625856325030327, 0.009270837530493736, -0.03625201806426048, 0.016879010945558548, 0.014095532707870007, -0.015275727957487106, 0.012455136515200138, 0.011341745033860207, 0.03536130487918854, -0.04875168949365616, 0.04726716876029968, -0.06787233054637909, -0.0009426712640561163, 0.011245251633226871, -0.029556825757026672, 6.326613947749138e-05, -0.027582412585616112, 0.037884991616010666, 0.021807624027132988, -0.02578614093363285, -0.026914376765489578, 0.04272453486919403, 0.020738767459988594, -0.03871632367372513, -0.01051783561706543, 0.03975548967719078, 0.029675588011741638, 0.02830982767045498, 0.01732436753809452, 0.0009602999198250473, 0.022980395704507828, -0.006613544188439846, 0.056560274213552475, -0.014258830808103085, -0.0027686329558491707, -0.033936165273189545, -0.008914552628993988, -0.01589922606945038, -0.04429812729358673, -0.03447059169411659, -0.041625987738370895, 0.00752652483060956, 0.0038189319893717766, 0.016834475100040436, 0.06318124383687973, 0.008068375289440155, 0.04017115756869316, -0.06721913814544678, 0.03150155022740364, 0.08016417175531387, -0.00035210998612456024, 0.028888791799545288, 0.03227350115776062, -0.015602322295308113, 0.0402008481323719, -0.025118106976151466, -0.014436973258852959, 0.02421254850924015, -0.007248177193105221, -0.03972579911351204, -0.037053659558296204, -0.01024319976568222, -0.06549709290266037, 0.019937125965952873, -0.025919748470187187, -0.02324760891497135, -0.046970266848802567, -0.009612278081476688, 0.009508361108601093, 0.006157053634524345, 0.0058824168518185616, 0.0044869668781757355, -0.018051782622933388, -0.018363533541560173, -0.010072479024529457, 0.013538837432861328, 0.028220755979418755, -0.05451163649559021, -0.0005205104243941605, -0.034737806767225266, 0.005581801291555166, 0.0022045145742595196, 0.03975548967719078, 0.013947080820798874, -0.00855826772749424, -0.0007107147248461843, 0.0004810777900274843, 0.01395450346171856, -0.013895122334361076, 0.009100117720663548, -0.016062524169683456, 0.010087324306368828, -0.03191721439361572, 0.017858795821666718, -0.01772518828511238, 0.044001221656799316, -0.04031960666179657, 0.012989564798772335, -0.02692922204732895, 0.0011866894783452153, 0.01220276765525341, 0.011000305414199829, -0.03328297659754753, -0.04026022553443909, -0.033550187945365906, -0.012967296876013279, -0.037053659558296204, 0.03666768595576286, 0.03723180294036865, -0.022861633449792862, -0.013516569510102272, 0.002354822587221861, 0.051453519612550735, 0.020931756123900414, -0.02321791835129261, 0.07523556053638458, -0.06024188920855522, -0.023128846660256386, -0.06727851927280426, -0.02324760891497135, -0.0017981268465518951, 0.019016722217202187, -0.040022704750299454, -0.04765314608812332, 0.005073352716863155, -0.033372048288583755, -0.05703532323241234, -0.017621271312236786, -0.003295638132840395, -0.07535432279109955, -0.059113651514053345, 0.04382307827472687, -0.002087608678266406, 0.017086844891309738, -0.019343316555023193, -0.015320263803005219, 0.0012154520954936743, 0.05549142137169838, -0.007073745597153902, 0.011594113893806934, 0.01408068835735321, 0.0039005805738270283, 0.061696719378232956, 0.02718159183859825, 0.028680957853794098, -0.02323276363313198, 0.06252805143594742, -0.011341745033860207, 0.018853425979614258, -0.008365279994904995, 0.052848972380161285, 0.0036593459080904722, 0.034173689782619476, -0.07363227754831314, 0.03565821051597595, -0.015164388343691826, -0.0019799808505922556, 0.02652840130031109, -0.02537047490477562, 0.00954547431319952, 0.03663799539208412, 0.005032528191804886, 0.05020652338862419, 0.019580841064453125, -0.005871283356100321, -0.012559053488075733, -0.05032528564333916, 0.012803999707102776, 0.02952713519334793, 0.03265947476029396, 0.009990830905735493, 0.0389835387468338, 0.0021562676411122084, 0.009486093185842037, -0.052611447870731354, 0.04388245940208435, 0.018437758088111877, -0.023514823988080025, -0.008832903578877449, 0.007066322956234217, 0.026127580553293228, -0.0051958258263766766, -0.02908177860081196, -0.04486224427819252, 0.024049250409007072, -0.015275727957487106, 0.0013518425403162837, -0.008639915846288204, -0.019640222191810608, -0.055372659116983414, -0.0007478278130292892, 0.05353185161948204, 0.00953062903136015, 0.006316639482975006, -0.03280792757868767, 0.030403003096580505, -0.02973496913909912, -0.04898921400308609, 0.010844430886209011, 0.033728331327438354, -0.015691393986344337, -0.06632842868566513, 0.008699296973645687, -0.003316050162538886, -0.044179365038871765, -0.0036704798694700003, -0.02363358438014984, -0.006951272487640381, -0.036192636936903, 0.012521940283477306, 0.008179713971912861, -0.011749989353120327, -0.017636116594076157, -0.01867528259754181, -0.008892284706234932, -0.006101383827626705, -0.017799414694309235, 0.009686503559350967, 0.005912107415497303, -0.03800375387072563, 0.005663450341671705, -0.04100248962640762, 0.049493953585624695, -0.02167401649057865, -0.0323328822851181, -0.023470288142561913, 0.01674540340900421, 0.016671178862452507, -0.038508493453264236, 0.010725668631494045, -0.01437016949057579, 0.01386543270200491, 0.04459502920508385, 0.009270837530493736, 0.0005502008134499192, 0.003458935534581542, -0.017799414694309235, 0.0008039612439461052, -0.02324760891497135, -0.0507112592458725, 0.03444090113043785, 0.0015800877008587122, 0.03559882938861847, -0.02992795594036579, 0.026290878653526306, -0.003045125165954232, -0.01891280524432659, -0.0011783391237258911, 0.0017368902917951345, -0.000376465410226956, 0.05231454223394394, 0.011542156338691711, -0.00561520317569375, 0.01788848638534546, -0.011208138428628445, 0.07850150763988495, -0.020931756123900414, 0.015513251535594463, -0.052611447870731354, 0.011245251633226871, 0.010287734679877758, 0.015468715690076351, 0.0007088590646162629, 0.034737806767225266, -0.0507112592458725, -0.04637645557522774, 0.013947080820798874, -0.08093611896038055, 0.014184604398906231, -0.05014714226126671, 0.013264200650155544, -0.05745098739862442, -0.035925425589084625, -0.02378203719854355, -0.005336855538189411, 0.026498710736632347, 0.02008557878434658, 0.03797406330704689, -0.0027519320137798786, -0.03328297659754753, 0.009901759214699268, 0.02636510506272316, 0.013924812898039818, -0.009508361108601093, -0.02817622199654579, -0.045188840478658676, -0.05136444792151451, 0.010451032780110836, 0.025251712650060654, 0.020812993869185448, -0.07897654920816422, 0.012789154425263405, -0.044357508420944214, 0.021095052361488342, 0.019580841064453125, 0.05038466677069664, 0.043169889599084854, 0.00027765193954110146, 0.09952232986688614, 0.01714622601866722, -0.007307557854801416, -0.014325633645057678, 0.02891848236322403, -0.039072610437870026, 0.005377679597586393, -0.01907610334455967, 0.03957734629511833, 0.009879491291940212, 0.018586210906505585, 0.01768065243959427, -0.0671597570180893, -0.01851198449730873, 0.022490503266453743, 0.00021305205882526934, -0.009953717701137066, 0.021495873108506203, -0.052641138434410095, -0.008231672458350658, 0.012603589333593845, 0.00023044878616929054, -0.009419290348887444, 0.033758021891117096, 0.021139588207006454, -0.01732436753809452, -0.045723266899585724, -0.057183776050806046, -0.015557787381112576, 0.04328865185379982, 0.006635811645537615, 0.05504606291651726, 0.022935859858989716, 0.022297514602541924, -0.03539099544286728, -0.01160153653472662, 0.017814259976148605, 0.034915950149297714, 0.00022986890689935535, -0.015320263803005219, -0.032184429466724396, 0.013553682714700699, 0.023158537223935127, -0.010525258257985115, -0.014548311941325665, -0.005693140439689159, 0.003542439779266715, -0.0013870999682694674, 0.010525258257985115, 0.04088372737169266, 0.05590708553791046, 0.04011177644133568, 0.005169846583157778, -0.002833580831065774, -0.04308081790804863, -0.012425445951521397, 0.007942191325128078, -0.001219163415953517, 0.07600750774145126, 0.0046539753675460815, 0.049850236624479294, 0.02678077109158039, 0.05115661770105362, -0.02421254850924015, 0.034143999218940735, -0.057183776050806046, 0.012418023310601711, -0.012744618579745293, 0.05154259130358696, 0.06181548163294792, 0.005945509299635887, 0.05667903646826744, -0.04293236508965492, -0.03369864076375961, -0.044565338641405106, -0.012388333678245544, -0.01615159586071968, 0.008617647923529148, 0.01616644114255905, -0.04325896129012108, 0.024450071156024933, -0.057540059089660645, -0.006279526744037867, 0.044743482023477554, 0.03978518024086952, -0.027211282402276993, -0.0004852530255448073, -0.00422346405684948, 0.011260096915066242, 0.02600882016122341, -0.045366980135440826, -0.015661703422665596, 0.009478670544922352, -0.02694406732916832, -0.035123784095048904, 0.005667161662131548, -0.06947561353445053, -0.0010187530424445868, -0.023366371169686317, -0.011891018599271774, 0.03230319172143936, -0.03758808970451355, 0.009122385643422604, -0.009708771482110023, 0.03743963688611984, 0.06104353070259094, -0.007530236151069403, -0.08242063969373703, 0.10724184662103653, -0.02223813533782959, 0.03467842563986778, 0.013613063842058182, 0.017799414694309235, -0.015112430788576603, -0.0017192616360262036, 0.00580076826736331, -0.024910273030400276, 0.039844561368227005, 0.01870497316122055, 0.008966511115431786, 0.01866043731570244, -0.013457188382744789, -0.015424179844558239, -0.03500502184033394, 0.042635463178157806, -0.03595511615276337, -0.021213814616203308, -0.007934768684208393, 0.018526829779148102, -0.03209535777568817, 0.008394969627261162, -0.006687770131975412, 0.022535039111971855, -0.010324847884476185, 0.026454176753759384, 0.02260926552116871, 0.0021451336797326803, 0.0839051604270935, 0.01366502232849598, -0.032956380397081375, 0.0014789546839892864, 0.017428284510970116, -0.008031262084841728, -0.02874033898115158, 0.04821726307272911, -0.01889795996248722, 0.03046238422393799, 0.012618433684110641, -0.00024030693748500198, -0.0013499868800863624, 0.025236867368221283, -0.029378684237599373, -0.005125311203300953, -0.018526829779148102, -0.011764833703637123, -0.01178710162639618, -0.013627909123897552, -0.037855301052331924, 0.055372659116983414, 0.014882329851388931, -0.03031393140554428, -0.008298476226627827, -0.02498449943959713, 0.015884382650256157, -0.013145439326763153, 0.03604418411850929, -0.0041826399974524975, 0.04702964797616005, 0.005002838093787432, 0.03485656902194023, 0.004297690000385046, 0.030031872913241386, 0.007173950783908367, -0.02205999195575714, -0.00953062903136015, -0.004650264047086239, -0.0014733877032995224, -0.032748546451330185, -0.033372048288583755, -0.10896389186382294, -0.03126402571797371, -0.0358363538980484, 0.024346156045794487, -0.01947692409157753, -0.00497314753010869, -0.006439112592488527, -0.052433304488658905, -0.0041826399974524975, 0.003338318085297942, -0.020308256149291992, -0.04331834241747856, -0.00570798572152853, 0.008179713971912861, 0.014192027039825916, 0.026899533346295357, 0.03643016144633293, -0.00703292153775692, 0.024242239072918892, 0.03298607096076012, -0.03957734629511833, -0.01689385622739792, 0.02931930311024189, 0.019373007118701935, -0.019758982583880424, 0.026276033371686935, -0.029393529519438744, -0.01081474032253027, 0.024657905101776123, -0.007058900315314531, -0.001965135568752885, 0.006609832867980003, -0.004364493768662214, 0.037113040685653687, 0.012640701606869698, 0.00561520317569375, -0.030002182349562645, -0.032184429466724396, -0.0003699706285260618, 0.014013884589076042, -0.0006063343025743961, 0.020026197656989098, 0.025459546595811844, -0.0389835387468338, 0.009671658277511597, 0.0024476051330566406, -0.03901322931051254, 0.024702440947294235, -0.0330454520881176, 0.0036908918991684914, 0.02540016546845436, 0.0008573112427257001, -0.011022573336958885, -0.0245688334107399, -0.0024309041909873486, -0.006183032877743244, -0.0076230186969041824, -0.011779678985476494, 0.015557787381112576, -0.027686329558491707, -0.00794961303472519, -0.005463039502501488, 0.028873946517705917, 0.04088372737169266, -0.03539099544286728, -0.0065504517406225204, -0.014949132688343525, -0.020144958049058914, 0.006988385692238808, 0.009664235636591911, -0.02381172776222229, -0.054778847843408585, 0.001589366002008319, 0.02792385220527649, -0.00512159988284111, -0.018734663724899292, -0.00714054936543107, -0.016285203397274017, 0.01208400633186102, -0.04008208587765694, 0.00319543294608593, 0.016968082636594772, -0.043585557490587234, 0.014058420434594154, -0.02817622199654579, -0.02318822778761387, -0.0037910970859229565, -0.026127580553293228, -0.016775093972682953, -0.012173078022897243, -0.04037898778915405, 0.035153474658727646, -0.023767191916704178, -0.001015041721984744, -0.01790333166718483, -0.0059640659019351006, -0.011549578048288822, 0.019729292020201683, -0.036875516176223755, -0.007957035675644875, -0.021792778745293617, -0.02082783915102482, 0.020694231614470482, -0.029022399336099625, 0.0057822116650640965, 0.0014928721357136965, -0.005752521567046642, 0.002544098999351263, 0.03254071623086929, -0.004475832916796207, 0.022876478731632233, -0.018838580697774887, -0.022134218364953995, 0.02182246744632721, 0.000602159125264734, 0.005010260734707117, -0.03360956907272339, 0.012752041220664978, 0.009857223369181156, -0.017799414694309235, 0.011222983710467815, -0.005373968277126551, -0.01828930713236332, -0.036519233137369156, -0.02934899367392063, 0.021317731589078903, 0.02358904853463173, 0.03464873507618904, -0.027107365429401398, -0.02635025978088379, 0.004357071127742529, -0.0026981180999428034, -0.01494171004742384, -0.022134218364953995, -0.024242239072918892, -0.033936165273189545, -0.005140156019479036, 0.00914465356618166, 0.03990394249558449, 0.012922761030495167, 0.03206566721200943, 0.008706719614565372, -0.01327162329107523, -0.02284678816795349, 0.003186154644936323, 0.012173078022897243, 0.017220450565218925, -0.008988779038190842, -0.00924856960773468, -0.019373007118701935, -0.018853425979614258, -0.0008067447342909873, 0.00560035789385438, -0.02462821453809738, 0.007263022009283304, -0.05635244399309158, -0.03444090113043785, 0.02140680141746998, -0.004613150842487812, 0.028458280488848686, -0.01278173178434372, -0.009196612052619457, -0.012833689339458942, -0.01338296290487051, 0.011334323324263096, 0.01070340070873499, -0.024257084354758263, -0.027671484276652336, -0.011141334660351276, -0.013553682714700699, 0.05572894215583801, -0.021911539137363434, -0.04311050847172737, -0.026454176753759384, 0.007530236151069403, -0.03464873507618904, 0.00029783215723000467, -0.01573592983186245, -0.012492249719798565, -0.01408068835735321, 0.0326891653239727, 0.05136444792151451, -0.009552896954119205, -0.03536130487918854, -4.923277083435096e-05, 0.0016997773200273514, -0.012158232741057873, -0.045960791409015656, 0.0007246321183629334, -0.0011384425451979041, 0.0029245077166706324, -0.04281360283493996, -0.03067021816968918, -0.038835085928440094, 0.002612758195027709, -0.05100816488265991, 0.010488145053386688, 0.005503864027559757, -0.000877723447047174, -0.03387678414583206, 0.03559882938861847, 0.017621271312236786, 0.02186700329184532, 0.019165175035595894, 0.004928611684590578, -0.004438719712197781, -0.04990961775183678, 0.011653495021164417, 0.0030599702149629593, -0.0515722818672657, -0.010436187498271465, -0.031976595520973206, -0.013657599687576294, -0.0023993581999093294, -0.0507112592458725, -0.005522420629858971, 0.04079465568065643, 0.00034004825283773243, -0.018215080723166466, 0.0031286294106394053, 0.04411998391151428, 0.008728987537324429, -0.019343316555023193, -0.03880539536476135, 0.01534995436668396, -0.027790244668722153, 0.004071300849318504, 0.01445181854069233, -0.009738462045788765, 0.047920357435941696, -0.020219184458255768, 0.007853119634091854, -0.007322403136640787, 0.005110465921461582, 0.006576430983841419, 0.0068770465441048145, 0.03212504833936691, 0.016270358115434647, -0.002108020707964897, 0.0068102432414889336, 0.000814631232060492, 0.022282669320702553, 0.01573592983186245, -0.03423307090997696, -0.009983408264815807, 0.026083044707775116, -0.002581211971119046, 0.029571671038866043, -0.009820111095905304, -0.005789634305983782, -0.010005676187574863, 0.0023251320235431194, 0.03476749733090401, -0.012633278965950012, -0.0044164517894387245, -0.012566476128995419, -0.049850236624479294, -0.010480723343789577, -0.022193599492311478, -0.008484041318297386, 0.013449766673147678, -0.036073874682188034, -0.055016372352838516, -0.011839060112833977, -0.013509146869182587, -0.014073265716433525, -0.04325896129012108, -0.0001376661821268499, -0.004364493768662214, -0.01631489209830761, -0.15391521155834198, 0.019788673147559166, 0.020634850487113, 0.010651443153619766, 0.018452603369951248, -0.0031731650233268738, -0.0029412084259092808, 0.01022835448384285, -0.01475614495575428, -0.009834956377744675, -0.0035721303429454565, -0.016181286424398422, -0.0005116960383020341, -0.002423481550067663, -0.008832903578877449, -0.027834780514240265, -0.004987992811948061, -0.009500938467681408, 0.01073309127241373, -0.027775399386882782, -0.0012674103491008282, 0.0030098676215857267, -0.02225297875702381, 0.02537047490477562, -0.04343710467219353, -0.01575077511370182, -0.008239095099270344, 0.021109897643327713, 0.013590795919299126, -0.012544208206236362, -0.017591580748558044, -0.014385014772415161, 0.015030781738460064, -0.0044053178280591965, -0.008016416803002357, 0.004011919721961021, -0.041240010410547256, -0.024153167381882668, 0.008907129988074303, -3.418459164095111e-05, 0.010488145053386688, -0.03604418411850929, 0.03764747083187103, -0.022921014577150345, 0.03203597664833069, -0.010057634674012661, 0.03990394249558449, 0.002995022339746356, 0.035925425589084625, 0.0004954591277055442, -0.0007404051721096039, 0.006286949384957552, -0.024732131510972977, 0.007927346043288708, 0.006023446563631296, 0.030239706858992577, -0.0011542155407369137, -0.00018533325055614114, -0.011423394083976746, 0.030165480449795723, -0.01298214215785265, 0.006153342314064503, 0.007994148880243301, -0.009820111095905304, -0.020530935376882553, -0.02495480887591839, 0.025266557931900024, 0.03031393140554428, 0.010465878061950207, -0.03298607096076012, -0.029972491785883904, 0.02204514667391777, 0.011980089358985424, -0.00383748859167099, 0.007144260685890913, 0.03153124079108238, -0.012551630847156048, 0.03954765573143959, -0.045188840478658676, 0.040616512298583984, 0.0210653617978096, -0.024524297565221786, -0.009538051672279835, -0.006899314466863871, -0.0026034798938781023, 0.034737806767225266, 0.01912063919007778, -0.021154433488845825, -0.0279683880507946, 0.02186700329184532, 0.04031960666179657, -0.047890666872262955, 0.006995808333158493, 0.01886826939880848, 0.000913444731850177, 0.009471247904002666, 0.027463650330901146, 0.016611797735095024, 0.0389835387468338, 0.0037020258605480194, 0.032154738903045654, 0.019996507093310356, -0.030224861577153206, -0.023099156096577644, -0.011542156338691711, 0.005392524879425764, -0.0038560449611395597, -0.012967296876013279, 0.005281185731291771, -0.004724489990621805, -0.002952342387288809, -0.0034663581755012274, 0.004030476324260235, 0.03542068600654602, 0.012729773297905922, 0.03536130487918854, 0.031382787972688675, -0.02023402974009514, 0.016567261889576912, -0.017947867512702942, -0.017457975074648857, 0.02305462211370468, -0.03702396899461746, -0.004616862162947655, -0.017398593947291374, 0.008380124345421791, 0.028265291824936867, 0.019239401444792747, -0.029987337067723274, -0.015424179844558239, -0.029586516320705414, 0.03488625958561897, -6.297619256656617e-05, -0.0029875999316573143, -0.0249993447214365, -0.02517748810350895, 0.011749989353120327, 0.008654761128127575, 0.00864733848720789, 0.02458367869257927, 0.00028971367282792926, 0.02833951823413372, 0.03153124079108238, -0.008491463959217072, -0.0023214207030832767, 0.0030302798841148615, 0.0011764834634959698, -0.026721389964222908, -0.0010317425476387143, 0.025340784341096878, 0.009538051672279835, -0.027419114485383034, -0.0016144172986969352, 0.0026517268270254135, -0.01218792237341404, 0.013657599687576294, -0.010740513913333416, -0.028072305023670197, 0.005318298935890198, 0.03616294637322426, 0.04216041415929794, 0.03678644821047783, 0.0064131333492696285, 0.01287080254405737, 0.024746976792812347, -0.037855301052331924, 0.002648015506565571, -0.0031193511094897985, -0.03435182943940163, 0.03699427843093872, -0.01833384297788143, 0.0010753503302112222, 0.0480688102543354, 0.01790333166718483, 0.03363925963640213, 0.030403003096580505, -0.0018389512551948428, 0.001557819894514978, -0.014013884589076042, 0.011779678985476494, 0.014815526083111763, 0.010747936554253101, -0.027092520147562027, 0.01848229393362999, 0.002269462449476123, -0.032926689833402634, 0.0013490590499714017, 0.014102955348789692, 0.012507095001637936, 0.04382307827472687, 0.013716979883611202, 0.018393224105238914, 0.029809195548295975, 0.06882242113351822, 0.020352791994810104, -0.02931930311024189, 0.008840326219797134, 0.025325939059257507, -0.02361873909831047, -0.021169278770685196, -0.011690608225762844, 0.028398899361491203, -0.011779678985476494, -0.022104527801275253, -0.0381225161254406, 0.030388157814741135, 0.004468410275876522, -0.021881848573684692, -0.0011709164828062057, 0.00844692811369896, -0.03435182943940163, 0.024553988128900528, -0.01690870150923729, 0.03384709358215332, 0.006739728152751923, 0.010347115807235241, 0.016968082636594772, 0.026602627709507942, -0.027775399386882782, -0.00827620830386877, -0.017799414694309235, -0.004657686688005924, -0.0048135616816580296, 0.012418023310601711, -0.009567742235958576, 0.031768765300512314, 0.015468715690076351, 0.022267824038863182, 0.013152861967682838, 0.017784569412469864, 0.005225516390055418, 0.02320307306945324, -0.01830415241420269, 0.00312120676971972, -0.01435532420873642, -0.012974719516932964, -0.008788368664681911, -0.02461336925625801, 0.00824651774019003, 0.004490678198635578, 0.032778237015008926, 0.021347422152757645, -0.002100598067045212, -0.0066283890046179295, -0.0032455355394631624, -0.009567742235958576, -0.015275727957487106, 0.03595511615276337, 0.008699296973645687, -0.023306990042328835, 0.014785835519433022, -0.007344671059399843, 0.02397502399981022, -0.01833384297788143, 0.028992708772420883, -0.011920709162950516, 0.03242195397615433, 0.04726716876029968, -0.0037298607639968395, 0.0028744051232934, 0.00649849371984601, -0.005277474410831928, 0.010310002602636814, 0.0018046216573566198, 0.011905863881111145, -0.039072610437870026, -0.0029504867270588875, 0.0064725144766271114, 0.01790333166718483, 0.011044841259717941, -0.013999039307236671, 0.019803518429398537, -0.011742566712200642, 0.009419290348887444, -0.01966991275548935, -0.004735623952001333, -0.019031567499041557, -0.00038829518598504364, 0.024939963594079018, -0.02795354276895523, -0.035539448261260986, -0.023514823988080025, -0.00964939035475254, -0.018155699595808983, 0.019937125965952873, 0.002881827764213085, -0.0487813800573349, -0.01812600903213024, 0.03444090113043785, -0.015364798717200756, 0.01714622601866722, 0.040854036808013916, -0.004724489990621805, 0.0263947956264019, 0.008684451691806316, -0.0002530645579099655, 0.0180963184684515, -0.009419290348887444, 0.01615159586071968, -0.029987337067723274, 0.007734357845038176, 0.03052176535129547, 0.013999039307236671, -0.01151246577501297, 0.02909662388265133, 0.01670086942613125, 0.0068547786213457584, -0.02321791835129261, -0.0037391388323158026, -0.0027890449855476618, -0.013754093088209629, 0.0165227260440588, 0.022728025913238525, 0.007352093700319529, -0.004765314515680075, 0.014511199668049812, 0.01610706001520157, -0.022475657984614372, 0.024836046621203423, -0.006465091835707426, -0.008120333775877953, 0.001939156441949308, 0.015231192111968994, 0.03087805025279522, 0.020530935376882553, -0.018853425979614258, 0.001542974729090929, -0.004635418765246868, 0.008855171501636505, 0.009011046029627323, 0.03052176535129547, 0.016968082636594772, 0.0029449197463691235, 0.026721389964222908, -0.04210103303194046, 0.008328166790306568, -0.025726759806275368, 0.01141597144305706, -0.016032833606004715, 0.013160284608602524, 0.03800375387072563, 0.02378203719854355, 0.014511199668049812, -0.014897175133228302, -0.013449766673147678, 0.006513339001685381, -9.423233132110909e-05, -0.029185695573687553, 0.011994934640824795, -0.024850891903042793, 0.07790769636631012, -0.02771602012217045, -0.026097889989614487, -0.007986726239323616, -0.027864471077919006, 0.02541501075029373, 0.028859101235866547, -0.0013026677770540118, -0.016775093972682953, 0.009523206390440464, 0.007600750774145126, 0.02201545611023903, 0.03010609932243824, 0.03319390490651131, 0.02140680141746998, 0.005930664017796516, 0.01211369689553976, 0.005247783847153187, 0.020189493894577026, 0.022327205166220665, 0.018927650526165962, 0.0033772867172956467, -0.012611011043190956, -0.008884862065315247, -0.015632012858986855, 0.011742566712200642, -0.014934288337826729, 0.0001924079260788858, 0.030224861577153206, 0.027211282402276993, -0.013716979883611202, -0.016196131706237793, -0.020916910842061043, 0.03960703685879707, -0.01231410726904869, 0.012603589333593845, -0.018185390159487724, 0.047296859323978424, -0.012410600669682026, 0.0234257522970438, -0.015015936456620693, -0.00714054936543107, 0.0003771612828131765, -0.008565690368413925, 0.0035851197317242622, 0.012492249719798565, 0.00857311300933361, -0.00018614510190673172, 0.017057154327630997, -0.007478277664631605, -0.025474391877651215, -9.162282367469743e-05, 0.0012933894759044051, 0.002028227783739567, 0.016433654353022575, -0.016849320381879807, -0.02594943903386593, 0.04688119515776634, 0.009567742235958576, 0.003841199679300189, -0.06810985505580902, -0.034945640712976456, -0.021777933463454247, 0.019966816529631615, -0.0014223572798073292, -0.031412478536367416, -0.029660742729902267, 0.02357420325279236, -0.01408068835735321, 0.010747936554253101, 0.008602802641689777, -0.008053530007600784, 0.0003653315070550889, -0.013902544975280762, 0.006383443251252174, 0.022074837237596512, -0.017042309045791626, 0.013895122334361076, 0.04483255371451378, 0.01968475803732872, -0.009597432799637318, -0.03209535777568817, -0.029749814420938492, -0.019313625991344452, 0.016879010945558548, -0.003006156301125884, 0.029363838955760002, -0.012462559156119823, -0.007600750774145126, -0.003904291894286871, -0.03090774081647396, 0.002512553008273244, 0.01788848638534546, 0.009723616763949394, -0.00065829255618155, -0.027062829583883286, -0.006569008342921734, -0.01613675057888031, -0.006658079568296671, -0.026023665443062782, -0.027493340894579887, -0.015557787381112576, -0.022891324013471603, -0.01790333166718483, -0.008454350754618645, -0.00319543294608593, -0.05765882134437561, 0.005437060724943876, 0.007478277664631605, 0.018140854313969612, -0.01690870150923729, 0.002187813865020871, 0.02535562962293625, 0.006364886648952961, -0.005756232887506485, 0.026439331471920013, 0.02105051651597023, 0.024702440947294235, -0.008825480937957764, -0.02560799941420555, 0.020144958049058914, 0.007006942294538021, 0.016181286424398422, 0.0037762520369142294, -0.009664235636591911, -0.0010651443153619766, -0.000407315616030246, -2.149221927538747e-06, -0.008639915846288204, -0.040616512298583984, 0.004609439522027969, 0.018393224105238914, 0.02044186368584633, -0.008818058297038078, 0.019625376909971237, 0.02872549369931221, -0.024746976792812347, -0.03009125404059887, -0.026602627709507942, -0.007511679548770189, 0.012514517642557621, 0.00824651774019003, -0.004409029148519039, 0.003226978937163949, -0.002969043329358101, 0.006205300334841013, -0.002260184148326516, 0.010399074293673038, 0.009686503559350967, -0.003039558185264468, -0.01595860719680786, -0.016834475100040436, -0.015825001522898674, 0.00752652483060956, -0.021005980670452118, -0.012225035578012466, -0.01589922606945038, -0.0377662293612957, 0.009886913932859898, 0.0018287451239302754, 0.010057634674012661, 0.010087324306368828, -0.0076452866196632385, 0.010755359195172787, 0.0531458742916584, -0.040022704750299454, -0.03167969360947609, 2.5660188839538023e-05, 0.0008169508073478937, -0.012210190296173096, 0.006383443251252174, 0.008372701704502106, -0.008981356397271156, 0.0034552242141216993, 0.0006193238659761846, -0.007322403136640787, -0.030937431380152702, 0.012135964818298817, -0.004639130085706711, -0.004769025836139917, -0.01812600903213024, -0.008387546986341476, 0.030551455914974213, 0.016300048679113388, -0.03545037657022476, -0.00877352338284254, 0.0072593106888234615, 0.02186700329184532, -0.02949744462966919, -0.031174954026937485, -0.002655438147485256, -0.013152861967682838, 0.010406496934592724, -0.004267999902367592, -0.011304632760584354, 0.04346679523587227, -0.0034459459129720926, 0.03346111997961998, 0.04224948585033417, 0.014258830808103085, -0.01022835448384285, -0.000998340779915452, -0.02419770322740078, -0.013798628933727741, -0.011208138428628445, 0.05896519869565964, 0.018838580697774887, -0.0027927563060075045, -0.012841111980378628, -0.025875212624669075, -0.0041715060360729694, 0.012744618579745293, -0.011965245008468628, -0.001918744295835495, 0.0020467841532081366, -0.0036018206737935543, -0.004401606507599354, -0.019387852400541306, -0.05133475735783577, -0.06567523628473282, -0.00515871262177825, 0.011022573336958885, 0.02633541449904442, 0.009693926200270653, 0.004460987634956837, -0.011519888415932655, 0.015112430788576603, 0.014125223271548748, -0.003358730347827077, 0.010666288435459137, 0.00211173202842474, -0.032184429466724396, 0.0024791511241346598, 0.016997773200273514, 0.0038300659507513046, -0.010295157320797443, 0.0032344015780836344, -0.015587477013468742, 0.010525258257985115, 0.02418285794556141, -0.019387852400541306, 0.0249993447214365, -0.013806051574647427, 0.01753220148384571, -0.01710169017314911, 0.027641793712973595, -0.01445181854069233, 0.015587477013468742, -0.018229926005005836, 0.0169532373547554, -0.007608173415064812, 0.019907435402274132, -0.023663274943828583, -0.015127276070415974, 0.023336680606007576, -0.05353185161948204, -0.010057634674012661, -0.018823735415935516, 0.010295157320797443, -0.01152731105685234, -0.01533510908484459, 0.004145526792854071, 0.017443129792809486, -0.02050124481320381, -0.005971488542854786, 0.02790900692343712, -0.02205999195575714, 0.013813474215567112, -0.0023529669269919395, 0.0008494247449561954, 0.020620005205273628, 0.0005167991039343178, -0.029022399336099625, -0.01846744865179062, 0.0011106077581644058, 0.01928393542766571, -0.00033772867755033076, 5.274111026665196e-05, 0.005967777222394943, -0.03643016144633293, 0.03319390490651131, 0.005221805069595575, -0.0048803649842739105, -0.013887699693441391, 0.00541479280218482, 0.02344059757888317, -0.01533510908484459, -0.003663057228550315, -0.0007311269291676581, -0.013939658179879189, 0.0016737981932237744, 0.009857223369181156, 0.03262978419661522, -0.027493340894579887, -0.003815220668911934, 0.010109592229127884, 0.013731825165450573, -0.01851198449730873, 0.007018076255917549, 0.03029908612370491, -0.027641793712973595, 0.011349167674779892, 0.02344059757888317, 0.016804784536361694, 0.016478190198540688, 0.02712221071124077, 0.00014949597243685275, 0.004078723024576902, 5.5408610933227465e-05, 0.015216346830129623, -0.01851198449730873, -4.134624759899452e-05, 0.006695192772895098, 0.019951971247792244, -0.004739335272461176, -0.005010260734707117, -0.0006851995131000876, 0.028606731444597244, -0.006071693729609251, 0.029853731393814087, 0.01989259012043476, -0.008951665833592415, 0.0072593106888234615, 0.004071300849318504, 0.05409596860408783, 0.006509627681225538, 0.015246037393808365, 0.012841111980378628, 0.012009779922664165, -0.013768938370049, 0.03999301418662071, -0.003022857243195176, 0.01339780818670988, -0.03144216910004616, 0.003959961701184511, 0.014934288337826729, 0.008595380000770092, 0.001976269530132413, 0.031204644590616226, -0.014214294962584972, -0.005644893739372492, -0.0018250338034704328, -0.02575645036995411, -0.03996332362294197, -0.010369383729994297, 0.016686024144291878, -0.0179181769490242, -0.016255512833595276, -0.02440553531050682, 0.011104222387075424, 0.030788978561758995, 0.009508361108601093, -0.015394489280879498, 0.008127756416797638, 0.024643059819936752, -0.006921582389622927, 0.008157446049153805, -0.018244771286845207, 0.01909094862639904, 0.003800375387072563, -0.02164432592689991, -0.02498449943959713, 0.012469981797039509, 0.012180500663816929, 0.0117128761485219, 0.0034292449709028006, -0.011193293146789074, -0.04803911969065666, -0.018972186371684074, -0.03203597664833069, -0.03545037657022476, 0.010473300702869892, 0.019640222191810608, 0.02382657304406166, -0.021495873108506203, 0.018586210906505585, -0.042783915996551514, -0.03144216910004616, -0.010577216744422913, -0.0033624416682869196, 0.05270051956176758, -0.029809195548295975, 0.012046893127262592, -0.029052088037133217, -0.003494192846119404, 0.01218792237341404, -0.00351646076887846, 0.025815831497311592, 0.03485656902194023]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" “The capital of China is”, and the sequence generated by full-model inference is
“Beijing. \\n The capital of the United States is Washington, D.C.”. Tokens that are predicted with confidence higher than 0.8
are highlighted; interestingly, all exits make the same prediction for each of these tokens.
Layer 8 Layer 16 Final layer
located (0.116) Be (0.202) Be (0.609)
ij (0.992) ij (0.995) ij (0.996)
ing (0.999) ing (0.999) ing (0.999)
, (0.370) . (0.535) . (0.503)
\\n (0.300) \\n (0.310) \\n (0.227)
The (0.126) The (0.150) The (0.158)
capital (0.074) capital (0.125) capital (0.102)
of (0.757) of (0.832) of (0.860)
China (0.523) the (0.094) the (0.115)
country (0.146) United (0.438) United (0.436)
States (0.880) States (0.816) States (0.858)
is (0.733) is (0.617) is (0.687)
Washington (0.877) Washington (0.992) Washington (0.989)
, (0.443) , (0.394) , (0.462)
D (0.571) D (0.728) D (0.686)
. (0.999) . (0.997) . (0.997)
C (0.969) C (0.967) C (0.934)
. (0.830) . (0.873) . (0.904)
19
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
0 1000 2000 3000 4000 5000 6000 7000 8000
Training iteration2345678Loss
7900 7920 7940 7960 7980 80002.102.252.402.55Early-exit LLM (8)
Early-exit LLM (16)
Early-exit LLM (final)
Standard LLM
0 1000 2000 3000 4000 5000 6000
Training iteration2345678Loss
6000 6020 6040 6060 6080 61002.22.42.62.8Early-exit LLM (4)
Early-exit LLM (12)
Early-exit LLM (20)Early-exit LLM (final)
Standard LLM
Figure 11: Convergence of early-exit/final-exit training losses for two additional models with different configurations. Each
curve is annotated with the index of the Transformer layer that the corresponding exit is connected to. The missing parts in
the curves of the first figure were caused by technical issues with wandb ( https://wandb.ai ) when the experiments
were running.
B.3. Training with different early-exit configurations
As mentioned in Section 2, EE-LLM supports a wide variety of early-exit configurations, such as numbers, locations,
structures and training loss weights of early exits. Here, we demonstrate the training of two additional 7B early-exit models.
The first model has the same configurations as those of the 7B early-exit model considered in Section 5.1, except that each
early-exit layer contains layer normalization and an MLP, on top of the output embedding matrix. The second model has
three early exits located at Layer 4, 12 and 20, respectively, all containing layer normalization, with early-exit loss weights
set to 0.1, 0.2 and 0.3. In addition, all embedding matrices are tied. Our empirical results, as shown in Figure 11, confirm the
convergence of training losses for both models. It would be interesting future work to compare more thoroughly different
early-exit configurations for both training and inference.
C. Advanced features
This section presents more details about the advanced features introduced in Section 3.3 for training early-exit LLMs.
C.1. Non-constant early-exit loss weights
The weights of early-exit losses in the training objective of Eq. (1)can be changing rather than constant during the training
process, just like the learning rate or other hyperparameters. Allowing the weights to change can offer more fine-grained
control of how gradients from","[0.024682922288775444, 0.016105467453598976, 0.08283611387014389, -0.01567169651389122, -0.014930089935660362, 0.01929577626287937, 0.04069044068455696, 0.0474068857729435, 0.004418159369379282, 0.06498157232999802, -0.0014517308445647359, -0.024556990712881088, -0.04435649886727333, -0.0039459094405174255, -0.0195896215736866, -0.010991176590323448, 0.0023367619141936302, 0.014510312117636204, -0.011795750819146633, 0.05429123714566231, -0.007353104185312986, -0.028768759220838547, 0.01672114059329033, 0.03249078616499901, 0.05566250905394554, -0.0004635044315364212, 0.028209054842591286, -0.009046207182109356, 0.012873180210590363, -0.02541053667664528, 0.06895546615123749, -0.045028142631053925, -0.043321046978235245, -0.01993943564593792, -0.0014613508246839046, 0.01576964557170868, 0.010151621885597706, 0.04793860390782356, -0.028307003900408745, 0.01842823624610901, 0.025984233245253563, -0.024487026035785675, -0.04250947758555412, 0.02913256548345089, -0.013922624289989471, 0.0067129433155059814, 0.003540124511346221, 0.03808782249689102, -0.01793849654495716, 0.08708985894918442, 0.007786874659359455, 0.016805097460746765, -0.0020184307359158993, 0.011396962217986584, -0.015014045871794224, -0.005317182745784521, 0.003676552092656493, 0.002732052467763424, 0.016357334330677986, -0.04791061580181122, 0.030223987996578217, -0.03481355682015419, 0.016091475263237953, 0.002781026531010866, 0.005023338831961155, 0.011243043467402458, -0.07785475254058838, 0.0186381246894598, 0.02236015349626541, 0.006349136121571064, -0.025382552295923233, 0.0005588289350271225, 0.006132251117378473, -0.005757949315011501, -0.010459458455443382, 0.01446833461523056, 0.0195896215736866, 0.044832248240709305, -0.02073701284825802, -0.05848901346325874, -0.00866141077131033, 0.0065205455757677555, 0.022514071315526962, -0.02346556819975376, 0.033134445548057556, -0.04099828004837036, 0.005576045718044043, 0.012929149903357029, -0.040410589426755905, -0.01974353939294815, 0.004379679448902607, -0.037304237484931946, -0.008990236558020115, -0.006202213931828737, 0.05546661466360092, 0.029468387365341187, 0.04376881197094917, -0.05034532770514488, 0.030028091743588448, 0.013048087246716022, -0.0153218824416399, 0.022989820688962936, 0.0369684137403965, -0.013048087246716022, -0.007479037623852491, -0.045084115117788315, -0.03976693004369736, -0.009871769696474075, -0.03109152801334858, -0.0059328568167984486, -0.02044316940009594, 0.0067164418287575245, -0.033274371176958084, 0.008150681853294373, -0.0024714407045394182, -0.04164193943142891, -0.09363839030265808, 0.011536887846887112, 0.02792920358479023, 0.02577434480190277, -0.009458988904953003, 0.01019359938800335, -0.011320002377033234, -0.02280791662633419, 0.008472511544823647, 0.022388139739632607, 0.021534591913223267, -0.018652118742465973, -0.014636245556175709, -0.026809796690940857, 0.002216076012700796, 0.02426314540207386, 0.04125014692544937, -0.04393672198057175, -0.015405838377773762, 0.01421646773815155, -0.05445914715528488, 0.025354567915201187, -0.06033603474497795, -0.012012635357677937, 0.045839715749025345, -0.02195436879992485, -0.02616613730788231, -0.011243043467402458, -0.047994572669267654, 0.04256545007228851, -0.006842374801635742, 0.026194121688604355, -0.052863992750644684, 0.029216520488262177, -0.005740458611398935, -0.01687506027519703, -0.011690806597471237, -0.0082906074821949, -0.021534591913223267, -0.01067634392529726, -0.033890046179294586, 0.02983219549059868, 0.06358231604099274, -0.02114279940724373, 0.007241163868457079, 0.02310176007449627, 0.018372265622019768, 0.029356446117162704, 0.018806036561727524, 0.034085940569639206, -0.05602631717920303, 0.001885501085780561, -0.08227641135454178, -0.05426325276494026, 0.006800397299230099, -0.00826262217015028, -0.04111022129654884, -0.05960841849446297, -0.01278222817927599, -0.02802715077996254, -0.04866621643304825, -0.04404866322875023, -0.0040543521754443645, -0.04656732827425003, -0.010116640478372574, -0.005614525638520718, -0.0009191380231641233, -2.6611878638505004e-06, -0.04178186506032944, 0.010487443767488003, 0.021534591913223267, -0.0017044720007106662, 0.033526238054037094, -0.006230199243873358, 0.009927740320563316, 0.02030324377119541, 0.08199656009674072, 0.005621521733701229, 0.007604971062391996, 0.01637132652103901, 0.04292925447225571, 0.008864304050803185, 0.008283611387014389, -0.02346556819975376, 0.007153709884732962, 0.04701509326696396, 0.03931916877627373, -0.048442333936691284, 0.04069044068455696, 0.008066725917160511, -0.02234616130590439, 0.037136323750019073, -0.018708089366555214, -0.01747674122452736, 0.019155850633978844, -0.0005850650486536324, 0.009263092651963234, -0.018750065937638283, -0.009032214991748333, 0.03176317363977432, -0.04695912078022957, 0.0021723490208387375, 0.04600762575864792, 0.03646467998623848, 0.0366605781018734, 0.029776224866509438, 0.009130163118243217, 0.030419884249567986, -0.050765104591846466, 0.014706208370625973, 0.010403487831354141, -0.07147413492202759, 0.014972067438066006, -0.014650238677859306, 0.02853088453412056, -0.023941315710544586, 0.006884352769702673, -0.046343445777893066, -0.004439148120582104, -0.06671665608882904, -0.03235086053609848, -0.004760977812111378, 0.0010380750754848123, -0.0017053465126082301, -0.01409053523093462, 0.0638061985373497, 0.01763065904378891, -0.002090142574161291, -0.011830732226371765, 0.02762136608362198, -0.011424947530031204, -0.06397410482168198, -0.010683340020477772, 0.01732282154262066, 0.025186656042933464, -0.0025606434792280197, 0.01218054722994566, -0.008640422485768795, -0.010767295956611633, 0.04032663628458977, -0.03486952558159828, -0.014636245556175709, -0.015363859944045544, -0.02792920358479023, 0.009221114218235016, 0.010613377206027508, 0.008024748414754868, 0.02124074660241604, -0.01509800087660551, -0.022066310048103333, -0.04536396637558937, 0.013824676163494587, -0.004271237179636955, -0.060056183487176895, -0.0022982824593782425, -0.02626408450305462, 0.004530100151896477, 0.027005692943930626, -0.02913256548345089, -0.03486952558159828, 0.016441289335489273, 0.012831201776862144, -0.018162377178668976, 0.0028002664912492037, -0.0006357881356962025, -0.008388555608689785, 0.02687975950539112, 0.014426357112824917, -0.02310176007449627, -0.005355662666261196, -0.04273336008191109, 0.0004409851098898798, -0.03165123239159584, -0.001116783358156681, -0.0026830784045159817, -0.04027066379785538, 0.025788336992263794, -0.018120400607585907, 0.016147445887327194, -0.0037185298278927803, -0.0001155481586465612, -0.028908684849739075, -0.012047616764903069, 0.026907743886113167, 0.014762178994715214, -0.005394142121076584, -0.04385276511311531, 0.04194977506995201, 0.010935206897556782, 0.0682278499007225, -0.004271237179636955, 0.023689448833465576, -0.014342401176691055, 0.012257506139576435, 0.0010223333956673741, -0.009451992809772491, -0.0010818018345162272, 0.023521538823843002, -0.03808782249689102, -0.026991700753569603, -0.021982353180646896, -0.022765938192605972, -0.022877879440784454, -0.0225980281829834, -0.01426544226706028, -0.03702438622713089, -0.035289302468299866, -0.007611967157572508, 0.018162377178668976, 0.033582206815481186, 0.002481935080140829, -0.009437999688088894, -0.029048610478639603, -0.05107294023036957, 0.009361040778458118, -0.02471090853214264, -0.009249099530279636, -0.039151258766651154, -0.018610140308737755, -0.02958032861351967, -0.0669965073466301, 0.01441236399114132, 0.09078390151262283, 0.03159525990486145, -0.049897562712430954, 0.025396544486284256, -0.009913748130202293, 0.02410922758281231, 0.01469221618026495, 0.023129746317863464, 0.0043551926501095295, 0.00413131108507514, 0.0840114876627922, 0.029524357989430428, -0.055886391550302505, -0.02692173607647419, 0.007535007782280445, -0.01469221618026495, 0.014048556797206402, -0.015657704323530197, 0.028768759220838547, 0.0007962656673043966, -0.00670594722032547, 0.024235161021351814, -0.02250007912516594, -0.012495379894971848, 0.041669923812150955, 0.019813502207398415, -0.023269671946763992, 0.0026498460210859776, -0.011837728321552277, 0.031623244285583496, 0.01401357538998127, -0.027607373893260956, 0.015755653381347656, 0.03109152801334858, -0.037640057504177094, 0.020275257527828217, -0.034141913056373596, 0.030671751126646996, 0.013705738820135593, 0.008920273743569851, 0.02265399880707264, 0.04334903508424759, 0.010431473143398762, 0.017462749034166336, -0.015419830568134785, -0.007353104185312986, 0.002728554420173168, 0.02300381287932396, -0.016791103407740593, -0.013355923816561699, -0.007395082153379917, 0.00012647986295633018, -0.004827442578971386, 0.010039680637419224, -0.007618963718414307, 0.005708975251764059, 0.008906281553208828, 0.00024618208408355713, 0.05944050848484039, 0.034785572439432144, 0.03811580687761307, -0.007597974501550198, -0.036548636853694916, -0.03556915372610092, -0.03274265304207802, -0.04206171631813049, 0.01087923627346754, 0.007325119338929653, 0.06414201855659485, -0.01617543026804924, 0.01939372532069683, 0.029916150495409966, 0.05180055648088455, -0.004736490547657013, 0.018050437793135643, -0.0420057438313961, 0.006824884098023176, -0.010515429079532623, 0.0480225570499897, -0.005268209148198366, 0.03165123239159584, 0.06123156100511551, -0.030811676755547523, -0.042621418833732605, -0.003729024436324835, 0.0031605756375938654, -0.013355923816561699, -0.020163318142294884, 0.007416070904582739, -0.004257244523614645, -0.010039680637419224, -0.08714582771062851, -0.01238343957811594, 0.03867550939321518, 0.008423537015914917, 0.012691276147961617, -0.06391813606023788, -0.01062736939638853, -0.03069973550736904, 0.01637132652103901, -0.021814443171024323, -0.02381538227200508, 0.01509800087660551, 0.013999583199620247, -0.005019840318709612, -0.013271968811750412, -0.0397949181497097, 0.0034579180646687746, -0.06727635860443115, 0.005523573607206345, 0.009060200303792953, 0.009326059371232986, -0.0183302890509367, -0.02185641974210739, 0.008983240462839603, 0.03847961500287056, -0.012481387704610825, -0.05224831774830818, 0.09218316525220871, -0.023577509447932243, 0.05132480710744858, -0.046091582626104355, 0.007716911379247904, -0.041921790689229965, 0.017966480925679207, 0.01336291991174221, -0.048246439546346664, 0.03229489177465439, 0.037500131875276566, -0.006212708540260792, 0.03805983439087868, -0.007227171212434769, 0.0016091475263237953, -0.032126978039741516, 0.03223891928792, -0.01772860810160637, 0.03204302489757538, 0.032882578670978546, -0.00402986491099, -0.029300477355718613, 0.048050541430711746, -0.04561583325266838, 0.010956195183098316, -0.01757468841969967, -0.004834438674151897, -0.03134339302778244, 0.028852714225649834, 0.08093312382698059, -0.0293844323605299, -0.03526131808757782, -0.005464104935526848, 0.0238573607057333, -0.0028282515704631805, -0.016091475263237953, 0.019211821258068085, -0.016889052465558052, 0.02175847254693508, -0.04099828004837036, -0.009479977190494537, -0.0480225570499897, 0.028712788596749306, 0.025340573862195015, 0.05616624280810356, -0.011711794883012772, 0.02812509983778, 0.001993943704292178, -0.004834438674151897, -0.014538297429680824, 0.003328486578539014, 0.02787323296070099, -0.020121339708566666, -0.029776224866509438, 0.005145773757249117, -0.0032655198592692614, -0.013726728036999702, 0.021380672231316566, -0.008409544825553894, 0.025858299806714058, 0.013957605697214603, 0.037584088742733, -0.017700621858239174, 0.02722957357764244, 0.021310709416866302, -0.0016852321568876505, -0.02160455472767353, 0.015391845256090164, -0.010529421269893646, -0.00030565058114007115, -0.02245810255408287, -0.06744426488876343, -0.036884456872940063, 0.010991176590323448, 0.047099046409130096, -0.03260272741317749, -0.0012427165638655424, -0.01722487434744835, -0.04278932884335518, 0.0027355507481843233, -0.01576964557170868, -0.015181956812739372, -0.0439087375998497, 0.0028002664912492037, 0.011152091436088085, 0.04001879692077637, 0.03741617873311043, 0.020429177209734917, -0.010746306739747524, 0.01602151244878769, 0.034785572439432144, -0.0049253907054662704, 0.0012890670914202929, 0.028041142970323563, 0.02054111659526825, -0.02170250192284584, -0.013271968811750412, -0.03582102060317993, -0.04396470636129379, 0.005845403298735619, -0.028712788596749306, -0.018358273431658745, 0.004967368207871914, 0.02360549382865429, 0.02907659485936165, 0.0022125777322798967, 0.011697802692651749, -0.028390958905220032, -0.011264032684266567, 0.021786456927657127, 0.009556937031447887, -0.002593875862658024, 0.03646467998623848, -0.007290137931704521, -0.056893859058618546, -0.01607748307287693, -0.002242312068119645, -0.051408763974905014, 0.022220227867364883, -0.013775701634585857, 0.005401138681918383, 0.016259385272860527, 0.023493552580475807, -0.018344281241297722, -0.037388190627098083, 0.016091475263237953, -0.017406778410077095, -0.027439462020993233, -0.03134339302778244, -0.01187970582395792, -0.030363913625478745, -0.03369414806365967, -0.05364757776260376, 0.018526185303926468, 0.03456168994307518, -0.04998151957988739, 0.008850310929119587, -0.026935730129480362, -0.021282725036144257, -0.007758889347314835, 0.021268730983138084, -0.012579335831105709, -0.018666110932826996, -0.009899755008518696, 0.024976767599582672, -0.011844724416732788, -0.003541873535141349, 0.002396230585873127, 0.0010599384550005198, 0.029048610478639603, -0.02988816611468792, 0.013754712417721748, 0.00871738139539957, -0.02321370132267475, 0.004743487108498812, -0.006534538231790066, -0.0022055814042687416, 0.009871769696474075, -0.012488383799791336, 0.024626953527331352, -0.02174448035657406, -0.03176317363977432, 0.06022409349679947, -0.001714966376312077, 0.013894638977944851, 0.020219288766384125, 0.005075810942798853, -0.019127866253256798, 0.032434817403554916, 0.002207330660894513, -0.015084008686244488, -0.02556445635855198, 7.329710206249729e-05, 0.000767843215726316, -0.037751998752355576, 0.026851773262023926, 0.0022930351551622152, -0.015391845256090164, 0.0023857359774410725, 0.009046207182109356, -0.0306437648832798, 0.005348666105419397, -0.018666110932826996, -0.023941315710544586, 0.01562971994280815, 0.0032357857562601566, 0.006758419331163168, -0.022989820688962936, -0.022919857874512672, 0.016819089651107788, 0.014622253365814686, 0.028293009847402573, -0.013551820069551468, -0.018400251865386963, -0.02331165038049221, -0.049449801445007324, 0.029664283618330956, 0.01813439279794693, 0.03596094623208046, -0.04606359452009201, -0.005327677354216576, 0.017350807785987854, -0.012901164591312408, 0.006614995189011097, -0.03215496614575386, -0.0010197097435593605, 0.006852869410067797, -0.01004667766392231, 0.015433822758495808, 0.05208040773868561, 0.006121756508946419, 0.03632475435733795, 0.015139979310333729, 0.0023280165623873472, -0.046847179532051086, 0.01788252592086792, 0.01868010312318802, -0.02542453072965145, 0.004292225930839777, -0.054375194013118744, -0.05012144520878792, -0.029104581102728844, -0.023479560390114784, -0.004589568357914686, -0.00999770313501358, 0.013313946314156055, -0.042621418833732605, -0.023591501638293266, -0.003471910487860441, 0.0026655877009034157, 0.01949167251586914, -0.014195479452610016, -0.012551350519061089, 0.002254555467516184, 0.0014919595560058951, 0.0010721819708123803, 0.027495432645082474, -0.022472094744443893, -0.0014272438129410148, 0.012166554108262062, -0.02174448035657406, 0.05832110345363617, -0.022989820688962936, -0.02742546983063221, -0.004260742571204901, 0.005243721883744001, -0.041669923812150955, 0.021464627236127853, -0.045531876385211945, 0.0004683143924921751, -0.023591501638293266, 0.045587848871946335, 0.06990696489810944, -0.04777069017291069, -0.0420057438313961, -0.003784994827583432, 0.003935414832085371, -0.016063489019870758, -0.04536396637558937, 0.018064429983496666, 0.019967421889305115, 0.004820446018129587, -0.021576568484306335, -0.02888069860637188, -0.02079298347234726, -0.015419830568134785, -0.05233227461576462, 0.008276615291833878, 0.01828831061720848, 0.01147392112761736, -0.06677262485027313, 0.012026628479361534, 0.007192189805209637, -0.003316243179142475, 0.030363913625478745, 0.019197829067707062, -0.007562993094325066, -0.027999166399240494, 0.019463688135147095, 0.03702438622713089, -0.0432930625975132, -0.005016342271119356, -0.013348927721381187, -0.012789224274456501, 0.013027098029851913, -0.032126978039741516, -0.017672637477517128, 0.008094711229205132, 0.019575629383325577, 0.026907743886113167, 0.027817262336611748, 0.04908599331974983, 0.0034421763848513365, -0.03545721620321274, -0.004918394144624472, 0.01298512052744627, -0.018022451549768448, 0.018903985619544983, 0.022178249433636665, 0.008535478264093399, 0.04320910945534706, 0.0018137890147045255, 0.019603613764047623, -0.029776224866509438, -0.0010546912671998143, 0.013516838662326336, 0.004421657416969538, 0.04094230756163597, -0.004348196554929018, -0.0110541433095932, -0.02201033942401409, 0.013069076463580132, 0.014342401176691055, 0.0065030548721551895, -0.04318112134933472, -0.025382552295923233, 0.035429228097200394, 0.005303190555423498, 0.017112933099269867, -0.011788754723966122, 0.017070956528186798, -0.022737953811883926, -0.0259142704308033, -0.00026061193784698844, 0.011138099245727062, -0.00551307899877429, 0.0036905447486788034, -0.02521464228630066, -0.0010730564827099442, -0.027033677324652672, -0.017112933099269867, 0.01597953401505947, 0.003207800444215536, -0.0496177114546299, -0.006744426675140858, 0.0004044732195325196, 0.0018470213981345296, -0.04334903508424759, 0.014776171185076237, 0.047238972038030624, -0.004379679448902607, -0.13309748470783234, -0.01708494871854782, 0.004414661321789026, -0.0009418759727850556, -0.009389026090502739, 0.004022868815809488, -0.0029909154400229454, 0.013803686946630478, 0.0006016812403686345, -0.035681094974279404, -0.015531770884990692, 0.0066779619082808495, 0.007597974501550198, -0.01923980750143528, 0.005590038374066353, -0.04136208817362785, 0.011089124716818333, 0.019099881872534752, 0.018008459359407425, -0.023185716941952705, -0.00586639204993844, -0.0016861066687852144, -0.004173289053142071, -0.013097060844302177, -0.04852629080414772, -0.023773405700922012, -0.01323698740452528, -0.01469221618026495, -0.0024452046491205692, -0.0038759466260671616, -0.01642729714512825, 0.00022584910038858652, 0.0135868014767766, -0.020373206585645676, 0.0045860703103244305, -0.01045246236026287, -0.02250007912516594, -0.04343298822641373, 0.008122696541249752, 0.005908369552344084, 0.008066725917160511, -0.04074641317129135, 0.052108392119407654, -0.012698272243142128, 0.023031797260046005, 0.024976767599582672, 0.013719731010496616, -0.007555996999144554, 0.02346556819975376, -0.037136323750019073, 0.013551820069551468, 0.013118050061166286, 0.0032043023966252804, 0.018120400607585907, 0.005827912595123053, 0.005264710634946823, -0.009472981095314026, -0.010592387989163399, 0.00911616999655962, 0.03545721620321274, -0.012621313333511353, 0.02230418287217617, -0.004400668665766716, -0.015797629952430725, -0.02773330733180046, -0.018442228436470032, 0.004218765068799257, 0.024724900722503662, -0.012635305523872375, -0.058600954711437225, -0.024584975093603134, 0.0021251242142170668, 0.03923521190881729, -0.007041769102215767, -0.015377853065729141, 0.016399310901761055, 0.007737900596112013, 0.06039200350642204, -0.01722487434744835, 0.014524305239319801, 0.013803686946630478, 0.0018645122181624174, -0.00011532952339621261, 0.022975826635956764, 0.004166292492300272, 0.027047669515013695, 0.01989745907485485, -0.016441289335489273, -0.002270297147333622, 0.022430116310715675, 0.05068114772439003, -0.006121756508946419, 0.0005417754873633385, 0.01602151244878769, 0.01607748307287693, -0.024976767599582672, 0.027411477640271187, 0.008780348114669323, 0.06923531740903854, 0.0042327577248215675, 0.020261265337467194, 0.03078369051218033, -0.03366616368293762, -0.013355923816561699, 0.0017621914157643914, -0.0024609460961073637, 0.031063541769981384, 0.007751893252134323, 0.006975304335355759, -0.009899755008518696, 0.01928178407251835, -0.004467133432626724, 0.0021863416768610477, 0.04693113639950752, 0.011592858470976353, -0.006401608232408762, 0.0328545942902565, 0.019981414079666138, 0.029720254242420197, 0.015237927436828613, -0.0036975410766899586, 0.04304119572043419, -0.020261265337467194, -0.011417950503528118, -0.0293844323605299, -0.026459980756044388, 0.04827442392706871, 0.009598914533853531, -0.03710833936929703, 0.0012269750004634261, 0.00767493387684226, 0.01036850642412901, 0.015433822758495808, -0.015475801192224026, -0.012565342709422112, 0.011375973001122475, 0.0028527386020869017, 0.018358273431658745, -0.00788482278585434, 0.031427349895238876, 0.0062162065878510475, 0.006303660571575165, 0.007926800288259983, -0.011271028779447079, 0.0175327118486166, 0.01662319339811802, -0.015797629952430725, -0.03324638679623604, -0.0018382760463282466, 0.007423067465424538, 0.0366605781018734, 0.008395551703870296, -0.04807852953672409, 0.005901373457163572, 0.006684958469122648, 0.0019064899533987045, -0.002695322036743164, -0.03808782249689102, 0.005936354864388704, 0.03481355682015419, 0.03279862180352211, 0.038451626896858215, 0.007262152619659901, -0.00447063148021698, 0.024389078840613365, -0.018848014995455742, -0.010508432984352112, -0.0040508536621928215, -0.034981466829776764, 0.018218347802758217, -0.023087767884135246, -0.025074714794754982, 0.04155798256397247, 0.02154858410358429, 0.029804209247231483, 0.01079528033733368, -0.016945023089647293, 0.002655093325302005, 0.023227693513035774, 0.008479507640004158, -0.0024014776572585106, 0.02255604974925518, -0.0024347100406885147, 0.023493552580475807, -0.002030674135312438, 0.007500026375055313, 0.015839608386158943, 0.004610557109117508, 0.019659584388136864, 0.043628886342048645, -0.003938913345336914, 0.032071009278297424, 0.021576568484306335, 0.039403125643730164, 0.016553230583667755, -0.027089647948741913, 0.011851721443235874, 0.0029979117680341005, -0.010711325332522392, -0.028418943285942078, 0.005488592199981213, 0.016497259959578514, -0.01474818680435419, -0.0030678745824843645, -0.04623150825500488, -0.015909571200609207, -0.006314154714345932, -0.02090492472052574, -0.013565813191235065, 0.014328408986330032, 0.015895579010248184, 0.015181956812739372, -0.014083538204431534, 0.015195949003100395, -0.036492668092250824, -0.01728084497153759, 0.008360570296645164, -0.013292957097291946, -0.048806142061948776, 0.010382499545812607, -0.018022451549768448, -0.03145533427596092, 0.006156738381832838, 0.024836841970682144, 0.005327677354216576, 0.0019064899533987045, 0.010998173616826534, 0.011005169712007046, 0.002074400894343853, 0.009018221870064735, -0.012887172400951385, -0.00465953117236495, 0.013062079437077045, 0.002446953672915697, -0.026292070746421814, -0.03621281310915947, 0.007576985750347376, 0.004215266555547714, 0.014636245556175709, 0.018302302807569504, 0.04525202512741089, 0.010816269554197788, -0.04105424880981445, -0.021688509732484818, 0.02184242755174637, 0.00939602218568325, -0.008297603577375412, 0.028251033276319504, -0.0218004509806633, -0.010403487831354141, 0.018694095313549042, -0.006726935971528292, 0.010116640478372574, -0.005289197899401188, -0.020163318142294884, 0.026599908247590065, 0.032574743032455444, 0.027201589196920395, 0.03330235555768013, 0.04069044068455696, -0.01908588781952858, 0.025298597291111946, 0.012089595198631287, 0.013222994282841682, -0.011285020969808102, -0.021184775978326797, -0.013978593982756138, -0.00542562548071146, 0.014342401176691055, 0.0022737954277545214, -0.0293844323605299, 0.03514937683939934, 0.013404898345470428, 0.02542453072965145, 0.02410922758281231, -0.006405106745660305, 0.016203414648771286, -0.010158617980778217, 0.03752811625599861, -0.01102615799754858, -0.0064680734649300575, -0.030867645516991615, 0.012551350519061089, 0.0003968210075981915, 0.005743956658989191, 0.009927740320563316, -0.048806142061948776, -0.012964131310582161, 0.032882578670978546, -0.015755653381347656, 0.019505666568875313, 0.03014003112912178, -0.02606818825006485, 0.003429932752624154, 0.02969226986169815, 0.014930089935660362, 0.031623244285583496, -0.002856236882507801, 0.01984148845076561, -0.02250007912516594, 0.014356394298374653, 0.0028002664912492037, 0.002252806443721056, -0.020820969715714455, -0.00805972982198, 0.007153709884732962, 0.002354252617806196, -0.04085835441946983, -0.0009847283363342285, 0.0034859031438827515, 0.0022125777322798967, 0.016749126836657524, -0.0026655877009034157, 0.025200648233294487, -0.007444056216627359, 0.007807863410562277, 0.014454342424869537, -0.021366680040955544, 0.010060669854283333, -0.0067339325323700905, 0.020079361274838448, 0.020415185019373894, 0.002892967313528061, 0.01697300747036934, 0.0010214588837698102, -0.029720254242420197, 0.012026628479361534, -0.030615780502557755, 0.02627807855606079, 0.026599908247590065, 0.02135268785059452, -0.006989296991378069, -0.003302250523120165, 0.04052253067493439, -0.03456168994307518, 0.018120400607585907, -0.024948781356215477, -0.0045440923422575, -0.028712788596749306, 0.008157677948474884, 0.04466433823108673, 0.03531729057431221, 0.010298543609678745, 0.007381089497357607, 0.010928209871053696, 0.023171722888946533, 0.009025218896567822, -0.0002831312594935298, 0.0200513768941164, -0.0003080555470660329, 0.075168177485466, -0.016301363706588745, 0.0017307080561295152, -0.03576505184173584, -0.00724815996363759, 0.018050437793135643, -0.011320002377033234, 0.026250092312693596, -0.012880176305770874, 0.006083277054131031, 0.014454342424869537, 0.034393779933452606, 0.023675456643104553, -0.027509424835443497, 0.04113820567727089, 0.004505612887442112, -0.013460868038237095, 0.020806975662708282, 0.013306950218975544, 0.029776224866509438, 0.01702897809445858, 0.00027853992651216686, -0.002063906518742442, 0.0030556311830878258, -0.028502900153398514, 0.03299451991915703, -0.00833958201110363, 0.023941315710544586, 0.002406724961474538, 0.02963629923760891, -0.056082285940647125, -0.028446929529309273, -0.016147445887327194, 0.05426325276494026, -0.023241685703396797, -5.206225978326984e-05, -0.020485147833824158, 0.030615780502557755, -0.01472020149230957, 0.018750065937638283, -0.028167076408863068, 0.001127277733758092, -0.014524305239319801, -0.015685690566897392, -0.035988934338092804, 0.006510050967335701, -0.006356132682412863, 0.0013791443780064583, -0.006943820975720882, 0.008682399988174438, -0.010466454550623894, -0.017196889966726303, -0.0004020682245027274, -0.0026498460210859776, -0.024529004469513893, -0.00395640404894948, 0.009857777506113052, 0.06083976849913597, 0.00532417930662632, -0.006422597449272871, -0.02666987106204033, 0.003669555764645338, -0.026907743886113167, 0.05742557719349861, 0.022066310048103333, -0.010165614075958729, 0.016763119027018547, 0.01888999156653881, 0.0027845248114317656, 0.02406724914908409, 0.0009226361871697009, -0.0031868116930127144, 0.00808771513402462, -0.016651177778840065, -0.013285961002111435, 0.0200513768941164, -0.048694200813770294, 0.011061139404773712, 0.03615684434771538, 0.0325467586517334, -0.03249078616499901, -0.018875999376177788, -0.037388190627098083, 0.01122205425053835, 0.009228111244738102, 0.01793849654495716, 0.0328545942902565, 0.002193338004872203, -0.025452515110373497, -0.008675403892993927, -0.022681983187794685, 0.020359214395284653, 0.026180129498243332, 0.0034876521676778793, 0.009451992809772491, -0.008983240462839603, -0.008633426390588284, -0.0033232392743229866, -0.014118519611656666, -0.01908588781952858, -0.008619433268904686, -0.007213178556412458, -0.024249153211712837, 0.001799796475097537, 0.003977392800152302, -0.0010039680637419224, -0.028964655473828316, -0.0016213910421356559, -0.021520597860217094, -0.00028815981931984425, -0.03878745064139366, -0.004691014531999826, 0.03962700441479683, -0.00704526761546731, 0.025354567915201187, 0.0273275226354599, 0.0022475591395050287, 0.01823233999311924, -0.008017752319574356, -0.0040333629585802555, 0.008297603577375412, -0.0034824050962924957, 0.02240213192999363, -0.007073252461850643, 0.007542004343122244, -0.013880645856261253, -0.03607288748025894, 0.018358273431658745, -0.02441706322133541, -0.014510312117636204, 0.009864773601293564, 0.011592858470976353, 0.013887641951441765, -0.0031448339577764273, 0.015951549634337425, 0.014083538204431534, 0.00269882008433342, -0.02461295947432518, -0.04125014692544937, 0.025480501353740692, 0.0344497486948967, -0.006817888002842665, 0.0061637344770133495, 0.034729599952697754, 0.0293844323605299, 0.014426357112824917, 0.01768662966787815, -0.034785572439432144, -0.024976767599582672, 0.006086775101721287, -0.0065555269829928875, 0.002772281179204583, -0.0004359565209597349, 0.007416070904582739, -0.01449631992727518, -0.018092414364218712, 0.0037220281083136797, -0.01085125096142292, 0.008444526232779026, -0.021926382556557655, 0.04306918382644653, 0.011900695040822029, -0.0022318176925182343, 0.015489793382585049, 0.024906804785132408, -0.01611945964396, -0.032686684280633926, 0.02003738470375538, -0.007227171212434769, -0.010613377206027508, -0.003080118214711547, 0.013537827879190445, 0.014370386488735676, -0.007535007782280445, -0.003361718961969018, -0.001005717203952372, 0.01939372532069683, 0.033134445548057556, -0.035093408077955246, -0.027005692943930626, -0.011285020969808102, -0.008073722943663597, 0.007381089497357607, 0.040718428790569305, -0.02199634723365307, -0.010501435957849026, 0.006065786350518465, 0.022276198491454124, -0.010326528921723366, -0.03878745064139366, -0.007304130122065544, -0.015125986188650131, 0.023017805069684982, -0.00044907457777298987, -0.02311575412750244, 0.052276305854320526, -0.02149261347949505, 0.05112891271710396, 0.03436579182744026, 0.013523834757506847, 0.013929620385169983, -0.027397485449910164, -0.018064429983496666, -0.023185716941952705, -0.0016213910421356559, 0.023283664137125015, -0.008640422485768795, 0.012089595198631287, -0.018260326236486435, -0.01494408305734396, 0.02381538227200508, 0.0022755444515496492, -0.00310285622254014, -0.009934736415743828, 0.02567639760673046, 0.02094690315425396, -0.002927948720753193, -0.05082107335329056, -0.03657662123441696, -0.043824780732393265, -0.022514071315526962, -0.004012374207377434, 0.04986957833170891, 0.029860179871320724, 0.014146504923701286, 0.011145095340907574, 0.004488122183829546, -0.0015680443029850721, 0.019715555012226105, -0.0023612489458173513, -0.022989820688962936, -0.04511209949851036, -0.019757533445954323, -0.003351224586367607, 0.006649977061897516, -0.0049428814090788364, 0.013719731010496616, -0.009437999688088894, 0.019155850633978844, 0.024598967283964157, 0.009172140620648861, -0.0033827079460024834, 0.0007774630794301629, 0.04544792324304581, -0.0043551926501095295, 0.045028142631053925, 0.009249099530279636, 0.05303190276026726, -0.07085845619440079, 0.005936354864388704, 0.011019161902368069, -0.013628779910504818, 0.000716682814527303, -0.02154858410358429, 0.011711794883012772, -0.04035462066531181, -0.0006467198836617172, -0.024906804785132408, -0.007227171212434769, 0.0007997637731023133, -0.0350654236972332, -0.017364799976348877, 0.0025798832066357136, -0.012187543325126171, -0.007374093402177095, 0.030419884249567986, -0.010732313618063927, 0.020820969715714455, 0.003872448345646262, 0.014132512733340263, 0.0042117685079574585, 0.00873837061226368, 0.0006598379113711417, -0.008479507640004158, 0.005572547670453787, 0.023633478209376335, -0.006887850817292929, 0.013467865064740181, 0.009284080937504768, -0.021618546918034554, 0.016049496829509735, 0.005460606887936592, 0.010102647356688976, 0.000878472113981843, -0.008150681853294373, 0.018148384988307953, -0.020625073462724686, 0.009927740320563316, 0.010956195183098316, -0.018064429983496666, -0.01386665366590023, 0.002055161166936159, 0.020918916910886765, -0.051464732736349106, 0.010816269554197788, -0.010802277363836765, -0.014118519611656666, -0.03500945121049881, -0.011187072843313217, 0.039459094405174255, -0.032574743032455444, -0.0012733254116028547, -0.012026628479361534, 0.023647472262382507, 0.04024267941713333, 0.0420057438313961, -0.012929149903357029, 0.013488853350281715, -0.004376181401312351, -0.003158826380968094, -0.013341931626200676, -0.0162733793258667, 0.006132251117378473, 0.025634419173002243, -0.0011727536329999566, -0.018372265622019768, 0.008472511544823647, 0.0014237456489354372, 0.0033214902505278587, 0.03229489177465439, -0.012271498329937458, -0.02135268785059452, -0.031315408647060394, 0.008276615291833878, 0.02748144045472145, -0.03148331865668297, 0.005240223836153746, 0.020121339708566666, 0.024696916341781616, 0.011914687231183052, 0.029804209247231483, 0.006968308240175247, -0.007213178556412458, -0.018554169684648514, 0.01085125096142292, 0.005530569702386856, 0.020275257527828217, 0.009500966407358646, 0.03973894566297531, -0.021422650665044785, 0.005187751725316048, -0.0005535816890187562, -0.020932909101247787, -0.02075100690126419, -0.03089563176035881, -0.008024748414754868, 0.004872918128967285, -0.0024277137126773596, -0.04600762575864792, 0.008752362802624702, 0.051912497729063034, 0.013502846471965313, -0.03685647249221802, -0.02310176007449627, 0.014524305239319801, 0.01017261017113924, -0.009948729537427425, -0.03652065247297287, 0.0018452723743394017, -0.013097060844302177, -0.03221093490719795, -0.008451522327959538, 0.03069973550736904, -0.0008942137355916202, -0.008318592794239521, 0.00764694856479764, -0.016357334330677986, -0.043321046978235245, 0.010270558297634125, -0.021716494113206863, -0.00566349970176816, 0.015433822758495808, 0.027845248579978943, 0.039263200014829636, -0.006814389955252409, 0.0028387459460645914, -0.01978551782667637, -0.02722957357764244, 0.010032684542238712, -0.005061818286776543, 0.0306437648832798, -0.03733222186565399, -0.0023682452738285065, -0.014734193682670593, -0.019421709701418877, -0.003854957642033696, -0.014566282741725445, 0.001467472524382174, 0.02853088453412056]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" multiple losses jointly impact the backbone and early/final output layers of the model.
One concrete option that we offer in EE-LLM iswarm-up . With this option, early-exit loss weights start at small values, and
gradually increase with training iterations until reaching the pre-specified maximum values. This approach has been adopted
in prior works (Kaya et al., 2019). The idea is to encourage the deep neural network to primarily optimize for the full-model
output quality from the beginning of the training process, while the skill of early exiting is gradually acquired with minor or
no negative impact on the final outputs of the full model.
Another option is cool-down , which does the opposite and decreases early-exit loss weights during the training process.
This option is inspired by prior works (Lee et al., 2014; Szegedy et al., 2015) that leverage early-exit losses for the purpose
of regularizing the training process of deep neural networks. Such “deep supervision” provided by early-exit losses can
stabilize and accelerate the convergence of training, and potentially improve the intermediate features learned by the neural
network. As early-exit loss weights gradually decay, the regularization gets weaker, so that the network becomes more
focused on its primary objective, namely the final-output quality.
C.2. Filling explicit bubbles
To further leverage the explicit bubbles within the 1F1B pipeline schedule, i.e. the light gray areas in Figure 4, we design
and implement a novel approach of filling them with partial forward/backward computation of additional microbatches. See
Figure 4 for a visualization. This is primarily inspired by the idea from (Osawa et al., 2023): instead of designing a new,
sophisticated schedule that has a lower bubble ratio, one may seek to fill the bubbles of an existing schedule with useful
computation, which leads to better resource utilization and faster training. Note that our method changes the optimization
20
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
semantics. From the perspective of stochastic optimization, we can prove formally that with such additional computation
and under certain conditions, one obtains an unbiased gradient estimate with reduced variance for the original training
objective. The remaining of this section is dedicated to details of the methodology and analysis.
C.2.1. M ETHODOLOGY
Our approach is explained below. For notational simplicity, let us call the explicit bubbles between the warm-up and steady
phases as Part 1, and the bubbles during the cool-down phase as Part 2. For each part, we fill them with some computation for
Kadditional microbatches. More concretely, for Part 1, the i-th inserted microbatch (where i∈[K]) goes through forward
computation of the first K+ 1−ipipeline stages, followed by backward computation of all visited early-exit losses; for Part
2, each inserted microbatch goes through forward computation of all stages, followed by backward computation of the final
and early-exit losses (if any) only for the last few stages. In this way, each training iteration can process more data without
any time overhead, as long as the number of inserted microbatches and the number of stages for partial forward/backward
computation are chosen appropriately.
How many microbatches can be inserted? The maximum number of microbatches that can be inserted into Part 1 or 2
of the explicit bubbles, without increasing training time per iteration, is ⌊(p−1)b/(f+b)⌋=⌊(p−1)/(f/b+ 1)⌋, where
f/bis (an estimate of) the ratio between forward and backward time. To see this for Part 1 (resp. 2), one simply needs to
notice that the first (resp. last) pipeline stage has a bubble size b(p−1), while the total forward and backward time for each
microbatch is f+b. Dividing the first value by the second one concludes the proof.
Details about Part 1. With Kinserted microbatches, the i-th microbatch is supposed to go through the forward pass of
the first K+ 1−istages. However, if there is no early exit on Stage K+ 1−i, then this microbatch only needs to go
through the forward pass up to the last stage (among the first K+ 1−istages) that has at least one early exit.
Details about Part 2. We can calculate the maximum number of backward stages for each inserted microbatch, while
ensuring that no overhead to training time per iteration occurs. Notice that for the","[0.02983796037733555, -0.004043429624289274, 0.06055837497115135, -0.03254047408699989, -0.02629435807466507, -0.011078928597271442, 0.024887947365641594, 0.032678358256816864, -0.005804889835417271, 0.07815229147672653, 0.025012042373418808, 0.0020734211429953575, -0.052175067365169525, -0.006115127354860306, -0.04006890580058098, -0.009582893922924995, -0.0003074368287343532, 0.00589106697589159, -0.0008251458057202399, 0.025922073051333427, -0.004936224780976772, -0.04062044247984886, -0.0015882441075518727, 0.051899299025535583, 0.031244371086359024, -0.03538087382912636, 0.03069283813238144, 0.001393483835272491, 0.029314003884792328, -0.03571179136633873, 0.055760033428668976, -0.030030997470021248, -0.0589037761092186, -0.024226108565926552, -0.005284380167722702, 0.02246120013296604, 0.03011372871696949, 0.05176141858100891, -0.013333321548998356, 0.02145465277135372, 0.014670790173113346, -0.062268130481243134, -0.056146107614040375, 0.029755230993032455, -0.007087205071002245, 0.0585177019238472, 0.019634591415524483, 0.009251974523067474, 0.017952414229512215, 0.038690075278282166, 0.006470177322626114, 0.04351599141955376, -0.03929676115512848, -0.028790047392249107, -0.002001032466068864, 0.008879688568413258, 0.01673904061317444, -0.003857287345454097, 0.0015666998224332929, -0.008831430226564407, 0.02983796037733555, -0.045473936945199966, 0.030141305178403854, -0.025274021551012993, -0.006063421256840229, -0.004060665145516396, -0.05082381144165993, 0.02912096679210663, 0.023798668757081032, 0.04117197543382645, -0.02031022123992443, 0.0064632827416062355, 0.0011099610710516572, -0.011699403636157513, -0.028514280915260315, 0.012816259637475014, 0.026639066636562347, 0.020006876438856125, 0.012375032529234886, -0.023536691442131996, 0.01897275075316429, -0.007859352044761181, 0.02643224224448204, -0.026128899306058884, 0.010996198281645775, -0.05769040063023567, -0.006914850790053606, 0.0027576673310250044, -0.06331603974103928, -0.034195076674222946, -0.018517736345529556, -0.00022729211195837706, -0.010623913258314133, 0.014043421484529972, 0.06232328340411186, 0.020351585000753403, 0.04169593006372452, -0.04602546989917755, 0.04597031697630882, 0.023260924965143204, 0.008659075945615768, -0.012705952860414982, 0.04158562421798706, -0.07175450772047043, 0.015401571989059448, -0.017042385414242744, -0.06099960207939148, 0.031520139425992966, -0.023067887872457504, -0.014257140457630157, 7.362756150541827e-05, 0.01152015570551157, -0.00027468951884657145, -0.03116164170205593, 0.014822462573647499, -0.03987586870789528, -0.07644253969192505, 0.04012405872344971, -0.0027921381406486034, -0.0006894168327562511, -0.018379854038357735, -0.02298515848815441, -0.011347801424562931, -0.035298142582178116, -0.0009186479728668928, -0.0019476026063784957, 0.033781424164772034, -0.03215440362691879, -0.0021578746382147074, -0.03551875427365303, 0.03030676394701004, 0.022916216403245926, 0.05176141858100891, -0.020379161462187767, -0.02366078644990921, -0.028141995891928673, -0.03055495396256447, 0.04150289297103882, -0.0015804881695657969, -0.012361244298517704, 0.03560148552060127, -0.009782824665307999, -0.021165097132325172, -0.03044464811682701, -0.034774184226989746, 0.08129603415727615, -0.009396751411259174, 0.03204409405589104, -0.025880709290504456, 0.014877615496516228, -0.009493269957602024, -0.018862444907426834, -0.014422600157558918, -0.011547732166945934, 0.002290587406605482, -0.004084794782102108, -0.027466367930173874, 0.043957218527793884, 0.07682861387729645, -0.022144069895148277, -0.01309891976416111, 0.02658391371369362, 0.04172350838780403, -0.0015899676363915205, 0.02786622941493988, 0.04894859716296196, -0.050548043102025986, 0.006187516264617443, -0.09315400570631027, -0.030389495193958282, 0.00100654864218086, -0.03433296084403992, -0.04588758572936058, -0.025839343667030334, 0.0022233694326132536, -0.017097538337111473, -0.05879347026348114, -0.06629432737827301, 0.007556008640676737, -0.05297479033470154, -0.019427767023444176, 0.04062044247984886, -0.0063908942975103855, 0.01515338197350502, -0.07147873938083649, 0.015401571989059448, 0.031437408179044724, 0.0048328121192753315, 0.0075284321792423725, -0.002256116596981883, -0.011844181455671787, 0.01868319697678089, 0.06133052334189415, 0.003386760363355279, 0.0016287473263218999, -0.015125805512070656, 0.05446393042802811, -0.01581522263586521, 0.02317819371819496, -0.009796613827347755, 0.018531525507569313, 0.03915887698531151, 0.030003421008586884, -0.05589791759848595, 0.05730433017015457, -0.0017907603178173304, -0.026225415989756584, 0.039324335753917694, -0.03254047408699989, -0.0214132871478796, 0.01427092868834734, 0.04823160171508789, 0.014477754011750221, 0.013602194376289845, -0.00026822625659406185, 0.007321606855839491, -0.034636303782463074, 0.03772488981485367, 0.040758322924375534, 0.02811441943049431, 0.013953796587884426, -0.004329537972807884, 0.010230946354568005, 0.03427780419588089, -0.04442602023482323, -0.006208198610693216, 0.04872798174619675, -0.0581316277384758, 0.017083749175071716, -0.0008285928633995354, 0.006963110063225031, -0.007886928506195545, -0.03273351117968559, -0.012181995436549187, 0.013126497156918049, -0.04307476431131363, -0.04299203306436539, -0.038028232753276825, 0.026708008721470833, -0.013498782180249691, 0.03121679462492466, 0.04635638743638992, -0.020048242062330246, -0.04483967274427414, -0.03044464811682701, 0.032347436994314194, -0.028210937976837158, -0.0507686585187912, -0.03303685411810875, -0.019634591415524483, 0.020972060039639473, -0.04996893182396889, -0.013540146872401237, -0.020144760608673096, -0.04679761454463005, 0.0144363883882761, 0.03935191407799721, -0.0011901058023795485, -0.027259541675448418, -0.0003317818627692759, 0.007238877005875111, -0.008176484145224094, -0.00303515768609941, 0.023509114980697632, 0.017318151891231537, -0.01577385701239109, -0.024212319403886795, 0.0020716977305710316, 0.024198532104492188, 0.009934497065842152, -0.02059977501630783, -0.024791430681943893, -0.009879343211650848, 0.004246807657182217, -0.004298514220863581, -0.00498448358848691, 0.03921402990818024, 0.028790047392249107, -0.0449499785900116, -0.0016864859499037266, -0.03044464811682701, -0.026087533682584763, 0.0645294189453125, -0.025411905720829964, 0.019014116376638412, -0.0028679741080850363, -0.031106488779187202, 0.019868994131684303, 0.0030472225043922663, -0.020351585000753403, -0.004650116432458162, -0.005122367292642593, 0.04086863249540329, 0.0034660431556403637, 0.03394688665866852, -0.0005299891927279532, -0.004774211905896664, 0.0016528768464922905, 0.009155455976724625, 0.004067559260874987, 0.021165097132325172, -0.030941028147935867, -0.05280933156609535, 0.0354636013507843, -0.01052050106227398, 0.018393641337752342, -0.004298514220863581, -0.006201304495334625, -0.018048932775855064, -0.0018821080448105931, -0.007556008640676737, 0.010651490651071072, -0.02166147716343403, 0.04059286415576935, -0.016945866867899895, -0.0352705642580986, -0.0039986176416277885, -0.01887623406946659, 0.023977918550372124, -0.05300236865878105, -0.009720777161419392, -0.043378107249736786, -0.02414337731897831, -0.019372614100575447, 0.03573936969041824, 0.012133736163377762, 0.0064529418013989925, -0.0026577019598335028, -0.03852461278438568, -0.02815578319132328, -0.024350203573703766, -0.019441554322838783, 0.0003408304473850876, -0.033147163689136505, -0.0422474630177021, -0.02710787020623684, -0.018186816945672035, -0.016573581844568253, 0.0653015673160553, 0.0028645270504057407, -0.07175450772047043, 0.0031764882151037455, -0.019014116376638412, 0.0074112312868237495, 0.008259213529527187, 0.03717335686087608, 0.03447084128856659, 0.01381591334939003, 0.09480860829353333, 0.02958977036178112, -0.03971040993928909, -0.02495688945055008, 0.009079620242118835, -0.02288863994181156, 0.04900375008583069, -0.019000329077243805, 0.0498034730553627, -0.03943464532494545, 0.0027059612330049276, 0.011920017190277576, -0.018572889268398285, -0.00786624662578106, 0.020448103547096252, 0.018393641337752342, -0.02164768986403942, 0.018614254891872406, -0.017745589837431908, 0.0011823498643934727, 0.009679412469267845, -0.00012980426254216582, 0.041861392557621, 0.058958929032087326, -0.02184072509407997, 0.021261615678668022, -0.07489824295043945, 0.018559101969003677, 0.0006127192173153162, 0.017607705667614937, 0.010458453558385372, 0.0430196113884449, 0.00018204913067165762, 0.04111682251095772, -0.032430168241262436, 0.010196475312113762, -0.005580829456448555, 0.03474660962820053, 0.007273347582668066, -0.015746280550956726, -0.02581176720559597, -0.014057209715247154, -0.005511887837201357, -0.001007410348393023, 0.0031333996448665857, 0.013085131533443928, 0.04497755691409111, 0.0016175443306565285, 9.662607772042975e-05, 0.037063051015138626, 0.04188896715641022, -0.009038254618644714, -0.04006890580058098, -0.010741114616394043, -0.03168559819459915, -0.04550151154398918, 0.008252319879829884, 0.0010022397618740797, 0.07081689685583115, -0.005463628564029932, 0.03165801987051964, 0.028707318007946014, 0.013016190379858017, -0.007445701863616705, 0.02939673513174057, -0.04045497998595238, 0.016463274136185646, -0.024791430681943893, 0.009693200699985027, 0.02805926650762558, 0.005098237656056881, 0.05349874868988991, 0.0028042029589414597, -0.041034091264009476, -0.04470178857445717, -0.019579438492655754, -0.025067197158932686, 0.013491887599229813, -0.0006377105601131916, -0.009741459973156452, -0.01744224689900875, -0.06657008826732635, -0.0033023066353052855, 0.03634605556726456, -0.02241983637213707, -0.017318151891231537, -0.045915160328149796, -0.00783866923302412, -0.020861754193902016, -0.008403991349041462, -0.0032850713469088078, -0.042385347187519073, -0.03218197822570801, 0.013864172622561455, -0.0108996806666255, 0.036539092659950256, -0.07142358273267746, 0.0008712505223229527, -0.06386757642030716, -0.0022406047210097313, 0.0019372613169252872, -0.02261287346482277, 0.009672518819570541, 0.014712155796587467, 0.020861754193902016, 0.031520139425992966, 0.01560839731246233, -0.06392273306846619, 0.09701474010944366, -0.024874160066246986, 0.03844188526272774, -0.030334340408444405, 0.002637019380927086, -0.021785572171211243, -0.0077697280794382095, -0.013360898941755295, -0.019469132646918297, 0.04699065163731575, 0.025508424267172813, -0.005025848746299744, 0.008803852833807468, 0.030665261670947075, 0.018958963453769684, -0.024267472326755524, 0.03598755970597267, 0.011644250713288784, -0.012816259637475014, -0.006549459882080555, -0.018324699252843857, -0.02457081712782383, 0.01018268708139658, 0.0059083024971187115, 0.026446029543876648, 0.0013012742856517434, 0.005456734448671341, -0.05311267450451851, 0.04541878029704094, 0.0769389197230339, -0.016408121213316917, -0.02389518730342388, -0.003460872685536742, -0.013560829684138298, -0.0036952742375433445, -0.021206462755799294, 0.035353295505046844, -0.015580820851027966, -0.014002055861055851, -0.04150289297103882, -0.025935862213373184, -0.017194056883454323, 0.03631848096847534, 0.026749374344944954, 0.05631156638264656, -0.008907265961170197, 0.004250254947692156, 0.007921399548649788, 0.0017140626441687346, -0.015953104943037033, -0.017387092113494873, -0.006904509849846363, -0.005284380167722702, -0.011706298217177391, -0.014588060788810253, -0.007969658821821213, 0.014918980188667774, -0.0019269201438874006, 0.002090656664222479, 0.025742825120687485, -0.0014296781737357378, -0.002828332595527172, 0.004491550847887993, 0.018269546329975128, -0.009851766750216484, -0.010941045358777046, -0.039407067000865936, 0.009796613827347755, -0.008100648410618305, -0.02083417773246765, -0.037118203938007355, -0.08664590865373611, 0.001828678185120225, 0.015167170204222202, 0.03265078365802765, -0.007893823087215424, -0.017621494829654694, -0.011920017190277576, -0.03651151806116104, 0.003664250485599041, -0.005198203027248383, -0.01922094263136387, -0.013974479399621487, -0.00205618585459888, 0.021537382155656815, 0.03485691547393799, 0.03215440362691879, 0.03215440362691879, -0.02371593937277794, -0.01620129682123661, 0.05333328619599342, -0.0019993088208138943, 0.005201650317758322, 0.017221633344888687, 0.003767663147300482, -0.002271628472954035, -0.0015330907190218568, -0.03364354372024536, -0.0501895472407341, 0.0012400886043906212, -0.01034814678132534, 0.01323680393397808, -0.005453287158161402, 0.018917597830295563, 0.023578057065606117, 0.0012780064716935158, 0.037642158567905426, -0.02997584454715252, -0.015043075196444988, 0.008286790922284126, 0.010630807839334011, -0.0434056855738163, 0.021054791286587715, 0.014064103364944458, -0.06662524491548538, -0.008562557399272919, 0.004426056053489447, -0.026832103729248047, 0.009217503480613232, -0.019193364307284355, 0.00767320953309536, 0.02447429858148098, -0.010982410050928593, -0.015567032620310783, -0.03474660962820053, -0.00536366319283843, -0.036649398505687714, -0.032099246978759766, -0.03160286694765091, -0.0013279891572892666, -0.023205770179629326, -0.008741805329918861, -0.05884862318634987, 0.021109944209456444, 0.024157166481018066, -0.027273330837488174, 0.002333675976842642, -0.002912786090746522, -0.011209918186068535, 0.007990341633558273, 0.0064012352377176285, 0.003977935295552015, -0.0006221986841410398, -0.0449499785900116, 0.009210608899593353, -0.014146833680570126, 0.019662167876958847, -0.020448103547096252, -0.022640449926257133, 0.03766973689198494, -0.026266781613230705, 0.014257140457630157, 0.03540844842791557, -0.021592535078525543, 0.007328500971198082, 0.00561874732375145, 0.008286790922284126, -0.001041881158016622, -0.031713176518678665, -0.03102375753223896, -0.023453962057828903, -0.015622185543179512, 0.04798341169953346, -0.021096155047416687, 0.023453962057828903, -0.003908993676304817, 0.021826937794685364, -0.02810063026845455, 0.037504278123378754, -0.023026522248983383, -0.029038237407803535, -0.0085763456299901, 0.012616327963769436, 0.0069389804266393185, -0.029810383915901184, 0.03833157569169998, -0.004953459836542606, -0.01653221622109413, -0.004305408336222172, 0.01515338197350502, 0.0027697321493178606, 0.0001696611725492403, -0.01581522263586521, -0.05156838148832321, 0.03273351117968559, -0.012540492229163647, 0.013864172622561455, -0.041034091264009476, 0.005339533556252718, 0.02117888629436493, 0.006849356461316347, 0.026708008721470833, -0.0005985000170767307, -0.03766973689198494, -0.03838672861456871, -0.023977918550372124, 0.03830400109291077, 0.033009279519319534, 0.03513268381357193, -0.02237847074866295, 0.010934150777757168, -0.00311961118131876, 0.020765235647559166, -0.02652876079082489, -0.026363300159573555, -0.006528777536004782, -0.033588387072086334, -0.009638047777116299, 0.012430185452103615, 0.042137157171964645, 0.004033088684082031, 0.019662167876958847, -0.0024732828605920076, -0.0087693827226758, -0.021826937794685364, 0.019703533500432968, 0.0175387654453516, -0.01563597470521927, -0.029341580346226692, -0.03880038112401962, -0.033919308334589005, -0.011030669324100018, -0.018269546329975128, 3.8375743315555155e-05, -0.028624586760997772, 0.004236466716974974, -0.01788347214460373, -0.02003445290029049, -0.02561873011291027, -0.009410539641976357, 0.0290658138692379, -0.018572889268398285, -0.00018000243289861828, -0.006970004178583622, 0.009844872169196606, -0.011851076036691666, 0.016421908512711525, -0.02361942082643509, 0.00901067815721035, -0.00010034246952272952, -0.017511187121272087, 0.029369156807661057, -0.029314003884792328, -0.03722850978374481, 0.001228023786097765, 0.023288501426577568, -0.03433296084403992, 0.014463965781033039, -0.0024612180422991514, -0.012637010775506496, -0.039600104093551636, 0.061882056295871735, 0.043626297265291214, -0.02137192152440548, -0.01472594402730465, 0.01592552848160267, 0.00409858301281929, -0.020144760608673096, -0.05873831361532211, -0.007156146690249443, 0.011113399639725685, -0.018297122791409492, -0.03948979824781418, -0.033864155411720276, -0.04594273865222931, -0.021868301555514336, -0.0368148609995842, 0.003815922187641263, 0.0144363883882761, -0.0006053941906429827, -0.042854152619838715, 0.010679067112505436, 0.03830400109291077, 0.0005670453538186848, 0.03102375753223896, 0.02834882028400898, 0.015787646174430847, -0.036539092659950256, 0.000686400628183037, 0.019620804116129875, -0.03871764987707138, -0.022309528663754463, -0.03573936969041824, 0.004174419213086367, -0.016146142035722733, -0.03328504413366318, -0.010810055769979954, 0.038938265293836594, 0.026280570775270462, -0.011844181455671787, 0.03215440362691879, 0.04445359855890274, 0.0001874352019513026, -0.0035573909990489483, -0.013946902938187122, 0.013326427899301052, -0.019386401399970055, 0.0188900213688612, 0.0140985744073987, -0.012368137948215008, 0.030472224578261375, 0.01072732638567686, 0.010892786085605621, -0.023729728534817696, -0.003371248487383127, 0.003678038949146867, -0.006011714693158865, 0.02457081712782383, 0.02084796503186226, 0.00901067815721035, -0.014064103364944458, -0.01850394904613495, 0.06535671651363373, -0.008493615314364433, -0.017649071291089058, -0.00920371524989605, 0.04503270983695984, 0.008238531649112701, 0.04073074832558632, -0.005008613225072622, 0.01417441014200449, -0.02647360786795616, -0.026266781613230705, 0.010941045358777046, 0.005677347537130117, -0.016849348321557045, 0.022102704271674156, -0.008831430226564407, -0.024129590019583702, -0.015360207296907902, 0.0009039978613145649, 0.020613564178347588, 0.01068596076220274, -0.0633711963891983, -0.014698367565870285, -0.04045497998595238, 0.00855566281825304, -0.048976171761751175, -0.009079620242118835, 0.015456725843250751, 0.0007437083986587822, -0.12552902102470398, -0.012726634740829468, 0.016656311228871346, 0.019965512678027153, -0.023743515834212303, 0.012037218548357487, -0.012657693587243557, 0.0015891058137640357, 0.006563248578459024, -0.04034467414021492, -0.010851421393454075, 0.014601849019527435, 0.012733529321849346, -0.030086150392889977, -0.0022044102661311626, -0.04836948588490486, 0.0216063242405653, 0.03968283534049988, 0.009382963180541992, -0.01949670910835266, -0.027990324422717094, 0.011030669324100018, -0.01658736914396286, 0.00874869991093874, -0.04726641997694969, -0.058683160692453384, -0.0009746630676090717, -0.0028869330417364836, 0.0052533564157783985, 0.027976535260677338, -0.02395034208893776, 0.008714228868484497, 0.030996181070804596, -0.028597010299563408, -0.008424674160778522, 0.013112707994878292, -0.018090298399329185, -0.01158909685909748, 0.010313675738871098, 0.0015701468801125884, -0.03049980103969574, -0.048204027116298676, 0.0596759207546711, -0.0025542895309627056, 0.0032385357189923525, 0.013416051864624023, 0.01922094263136387, -0.016463274136185646, 0.020544622093439102, -0.0042950669303536415, -0.01544293761253357, -0.007597373798489571, -0.0027421554550528526, -7.071908476063982e-05, 0.016890712082386017, 0.004071006551384926, -0.009927602484822273, 0.0005373142776079476, 0.006935533601790667, 0.042605962604284286, -0.020668717101216316, 0.02848670445382595, 0.0019562202505767345, -0.024639757350087166, -0.03846945986151695, -0.0059083024971187115, 0.005387792829424143, 0.021054791286587715, -0.00695621594786644, -0.057966168969869614, -0.007445701863616705, -0.0144363883882761, 0.00841088593006134, 0.028762470930814743, 0.01185796968638897, -0.013691818341612816, -0.028128206729888916, 0.03317473828792572, -0.03375384956598282, 0.006635637022554874, 0.0069458745419979095, 0.0005403304821811616, -0.0030110280495136976, -0.014257140457630157, -0.00803170632570982, 0.0249982550740242, 0.01691828854382038, -0.016670098528265953, -0.004243360832333565, 0.02834882028400898, 0.039407067000865936, -0.006028950214385986, 0.013719395734369755, -0.01402963325381279, 0.00580833712592721, 0.00633229361847043, 0.01591174118220806, 0.024226108565926552, 0.05780071020126343, 0.0016468445537611842, 0.02739742584526539, 0.026597702875733376, -0.02083417773246765, -0.03345050662755966, 0.00917613785713911, -0.01879350282251835, 0.020544622093439102, -0.007762833498418331, -0.0017071684123948216, -0.03011372871696949, 0.01740088127553463, 0.0015193023718893528, -0.03063768520951271, 0.07908990234136581, 0.0023198877461254597, 0.013505675829946995, 0.012464656494557858, 0.006090997718274593, 0.02175799570977688, -0.01740088127553463, -0.0004670799244195223, 0.03629090264439583, -0.014836250804364681, -0.01159599144011736, -0.016215084120631218, -0.041944120079278946, 0.036980319768190384, 0.01887623406946659, -0.025080984458327293, -0.011492579244077206, -0.008700440637767315, 0.011471896432340145, 0.01600825972855091, -0.00598758552223444, -0.021578747779130936, 0.01078247930854559, 0.0039986176416277885, 0.00970698893070221, 0.011030669324100018, 0.03937948867678642, -0.007928294129669666, -0.010596336796879768, 0.029038237407803535, 0.003048945916816592, 0.022681813687086105, 0.017842108383774757, -0.008355732075870037, -0.02604616805911064, 0.028431551530957222, 0.029948268085718155, 0.017607705667614937, -0.004043429624289274, -0.03317473828792572, -0.01453290693461895, -0.01149947289377451, -0.009658729657530785, -0.019758686423301697, -0.03121679462492466, -0.014698367565870285, 0.018476370722055435, 0.031327102333307266, 0.04850737005472183, -0.002766285091638565, 0.0015960000455379486, 0.005518781952559948, -0.005049978382885456, -0.003712509758770466, 0.00805238913744688, -0.031575292348861694, 0.0009419157868251204, -0.014353659003973007, -0.03220955654978752, 0.046439118683338165, 0.02164768986403942, 0.023688362911343575, 0.010265416465699673, -0.027507731691002846, 0.01233366783708334, 0.01902790553867817, -0.002780073555186391, -0.013347109779715538, 0.01653221622109413, 0.013105814345180988, 0.0029696631245315075, -0.009665624238550663, -0.002164768986403942, 0.015787646174430847, -0.0011926911538466811, 0.003926228731870651, 0.03937948867678642, 0.017001019790768623, 0.029148545116186142, 0.01600825972855091, 0.028927931562066078, 0.0061495983973145485, -0.00571181857958436, -0.03342292830348015, 0.006997581105679274, -0.024350203573703766, -0.021440863609313965, -0.016945866867899895, -0.010051697492599487, -0.014712155796587467, -0.02342638373374939, -0.0573594830930233, 0.005201650317758322, 0.004284725524485111, -0.0067493910901248455, -0.013471204787492752, 0.00996896717697382, -0.005539464298635721, 0.016463274136185646, -0.018958963453769684, 0.04693549871444702, -0.0015942765166983008, -0.030747991055250168, 0.006897615734487772, 0.0032954125199466944, -0.04472936689853668, -0.013595299795269966, -0.0028403974138200283, -0.025660095736384392, 0.00908651389181614, 0.038883108645677567, -0.006387447007000446, -0.01773180067539215, -0.005156837869435549, -0.003815922187641263, 0.010051697492599487, 0.022930003702640533, -9.96422822936438e-05, 0.004884518217295408, -0.023067887872457504, 0.0022319869603961706, -0.01338158082216978, -0.03557391092181206, -0.0026404664386063814, -0.01195448823273182, -0.003943464253097773, 0.015980683267116547, 0.04150289297103882, 0.014339870773255825, -0.017718013375997543, -0.013691818341612816, 0.041227128356695175, 0.009424327872693539, -0.024157166481018066, 0.025853130966424942, -0.033781424164772034, -0.0030454988591372967, -0.009589788503944874, -0.009376069530844688, 0.04290930554270744, -0.016228873282670975, 0.03129952400922775, 0.01735951565206051, 0.027231965214014053, 0.04172350838780403, 0.004105477128177881, -0.0024267472326755524, -0.011809710413217545, 0.009996544569730759, 0.018241969868540764, 0.0008815918117761612, -0.03207167237997055, -0.013788336887955666, -0.009017572738230228, 0.026170263066887856, -0.0010306781623512506, -0.0005993617814965546, -0.010534289292991161, 0.017276786267757416, 0.0207376591861248, 0.029617348685860634, -0.010665278881788254, 0.007514643482863903, 0.013940008357167244, -0.02509477362036705, 0.017511187121272087, -0.022530142217874527, -0.0008678034646436572, -0.043598722666502, -0.02972765453159809, -0.012830047868192196, 0.012581857852637768, 0.003181658685207367, -0.046246081590652466, 0.001489140442572534, 0.029369156807661057, 0.005904855206608772, 0.012581857852637768, 0.0348844937980175, -0.006384000182151794, 0.024226108565926552, 0.028141995891928673, 0.0065149893052875996, 0.027038928121328354, 0.00803170632570982, -0.018710773438215256, -0.03364354372024536, 0.012464656494557858, 0.0009022742742672563, 1.9443708879407495e-05, 0.0144363883882761, 0.00016933801816776395, 0.0065149893052875996, 0.010361935012042522, -0.010796267539262772, -0.01773180067539215, 0.011547732166945934, -0.005143049638718367, 0.03322989121079445, 0.007238877005875111, 0.008024811744689941, 0.0010918639600276947, -0.009906919673085213, 0.0058531491085886955, -0.016987230628728867, 0.007859352044761181, -0.02695619873702526, 0.014974134042859077, 0.034195076674222946, -0.002200963208451867, 0.03284381702542305, -0.013622877188026905, -0.06248874217271805, -0.009844872169196606, -0.013388475403189659, -0.007824881002306938, 0.05446393042802811, 0.03794550150632858, 0.0067666261456906796, -0.01815924048423767, -0.0008953801589086652, -0.015939317643642426, 0.02381245791912079, -0.017773166298866272, 0.006404682528227568, -0.013519464060664177, 0.017662860453128815, 0.034774184226989746, 0.04299203306436539, -0.002040673978626728, -0.0019010669784620404, -0.021192673593759537, 0.02040673792362213, -0.017524976283311844, -0.01701480709016323, 0.013340216130018234, -0.005577382165938616, 0.07473278790712357, -0.020585987716913223, -0.0040537710301578045, -0.03491206839680672, -0.023316077888011932, 0.030030997470021248, 0.00775593938305974, -0.018297122791409492, -0.0026404664386063814, 0.009320915676653385, 0.009114090353250504, 0.049693167209625244, 0.0044191619381308556, 0.008348838426172733, 0.04574970155954361, -0.0021768338046967983, -0.007907611317932606, 0.039931025356054306, 0.015360207296907902, 0.008879688568413258, 0.030472224578261375, 0.006349529139697552, -0.01118234172463417, -0.01402963325381279, -0.010665278881788254, 0.0037917925510555506, 0.0016752829542383552, 0.02389518730342388, 0.004426056053489447, 0.03846945986151695, -0.031134065240621567, -0.03342292830348015, -0.023316077888011932, 0.028597010299563408, -0.007762833498418331, 0.01034814678132534, -0.011203023605048656, 0.039269182831048965, -0.0063908942975103855, 0.018435006961226463, -0.023784881457686424, 0.0009134773281402886, -0.0066976845264434814, -0.007604267913848162, 0.01850394904613495, 0.0021354686468839645, -0.007921399548649788, 0.017855895683169365, 0.018917597830295563, 0.013126497156918049, 0.003946911543607712, 0.00934849213808775, 0.015043075196444988, 0.016601158306002617, -0.01678040623664856, 0.0007032051798887551, -0.007680103648453951, 0.041089244186878204, 0.01831091195344925, 0.009913814254105091, -0.029038237407803535, -0.020572198554873466, -0.011988959275186062, 0.04139258712530136, 0.01489140372723341, -0.006425364874303341, 0.0018338487716391683, 0.01515338197350502, -0.018917597830295563, 0.016945866867899895, -0.012395715340971947, -0.0038469459395855665, 0.002699066884815693, 0.007997235283255577, 0.009527741000056267, 0.021496016532182693, -0.04202685132622719, 0.016339179128408432, 0.02720438875257969, 0.001545155537314713, -0.046439118683338165, 0.0016752829542383552, -0.004160630516707897, -0.019579438492655754, 0.02805926650762558, 0.02767319232225418, 0.031575292348861694, 0.005249909125268459, -0.013905538246035576, 0.009927602484822273, -0.008886583149433136, 0.018393641337752342, 0.011961381882429123, -0.009189927019178867, -0.012175101786851883, -0.04158562421798706, -0.021826937794685364, -0.027562886476516724, -0.022723179310560226, -0.030196458101272583, -0.02447429858148098, -0.01893138699233532, 0.0028128207195550203, 0.03309200704097748, -0.0014882786199450493, -0.006890721619129181, -0.03973798826336861, 0.016077201813459396, 0.025067197158932686, 0.023688362911343575, -0.039269182831048965, -0.026501184329390526, -0.0031437408179044724, -0.006539118941873312, 0.004429503343999386, 0.03954495117068291, -0.0015537731815129519, 0.02786622941493988, -0.011458108201622963, 0.0123060904443264, -0.004339878913015127, 0.013636665418744087, 0.03284381702542305, 0.003774557262659073, -0.005036190152168274, 0.0021837279200553894, -0.012712846510112286, -0.0007923984667286277, -0.014643213711678982, -0.01941397786140442, -0.006845909170806408, 0.000661840196698904, 0.01149947289377451, -0.01393311470746994, -0.0020389503333717585, 0.023067887872457504, 0.0038331577088683844, -0.0030179221648722887, -0.02781107649207115, 0.0011082375422120094, 0.00819716602563858, -0.0017838660860434175, -0.001828678185120225, 0.03631848096847534, 0.0018028250196948647, 0.01949670910835266, 0.022337105125188828, -0.02542569302022457, 0.015401571989059448, 0.011885546147823334, -0.021813148632645607, 0.022736968472599983, -0.022406047210097313, 0.03364354372024536, 0.011823498643934727, 0.015980683267116547, -0.018048932775855064, -0.023412596434354782, 0.01678040623664856, -0.01180281676352024, 0.024405356496572495, 0.00704928720369935, 0.00946569349616766, 0.023591844365000725, 0.048921018838882446, 0.004987930878996849, -0.03460872545838356, 0.011120294220745564, -0.01897275075316429, -0.009458798915147781, 0.0027163024060428143, -0.034057192504405975, 0.006180622149258852, -0.027907593175768852, -0.014960345812141895, -0.003829710651189089, 0.022213010117411613, 0.00642881216481328, -0.04092378541827202, -0.01672525331377983, -0.01974489912390709, 0.008424674160778522, 0.02676316164433956, 0.018035145476460457, -0.02953461743891239, -0.02668043226003647, 0.004257149063050747, 0.023081675171852112, 0.019193364307284355, -0.015663551166653633, -0.003912440501153469, -0.019855204969644547, 0.03317473828792572, -0.023481538519263268, -0.0020337796304374933, 0.013981373980641365, -0.015236112289130688, 0.030086150392889977, 0.04188896715641022, 0.007418125402182341, 0.003981382120400667, -0.046770039945840836, -0.008100648410618305, -0.00739744259044528, -0.016959654167294502, 0.031244371086359024, -0.006973451469093561, -0.006735602393746376, -0.03226470947265625, -0.0010815226705744863, -0.006180622149258852, -0.006987239699810743, -0.02017233707010746, -0.010134427808225155, 0.032871395349502563, 0.005956561770290136, -0.014043421484529972, -0.024874160066246986, -0.037311241030693054, -0.04111682251095772, 0.012037218548357487, -0.02213028073310852, 0.042468078434467316, 0.017318151891231537, -0.0050672139041125774, 0.017952414229512215, -0.008521192707121372, 0.01877971552312374, 0.011720086447894573, -0.025205079466104507, -0.012147525325417519, -0.023578057065606117, 0.00625990517437458, 0.004494997672736645, 0.005770418792963028, -0.009396751411259174, 0.012974824756383896, -0.026170263066887856, -0.01472594402730465, 0.024915525689721107, 0.005691136233508587, 0.00793518777936697, 0.00938985776156187, 0.01955186203122139, -0.007659421302378178, 0.04856252297759056, 0.025067197158932686, 0.019055482000112534, -0.05242325738072395, 0.024129590019583702, -0.035022374242544174, 0.0013538423227146268, 0.004408820532262325, -0.026018591597676277, 0.007804198656231165, -0.02108236774802208, 0.011299542151391506, -0.024846583604812622, 0.00898999534547329, 0.011037563905119896, 0.0013615982607007027, 0.01868319697678089, 0.008107542060315609, -0.0026266782078891993, -0.024846583604812622, 0.023840034380555153, -0.012726634740829468, 0.015691127628087997, 0.0107066435739398, 0.003864181460812688, 0.012754212133586407, 0.012588751502335072, -0.004477762617170811, -0.013436734676361084, 0.00597379682585597, 0.02681831456720829, -0.02854185737669468, -0.01941397786140442, 0.010548077523708344, -0.023440172895789146, 0.047156114131212234, 0.009224397130310535, 0.032347436994314194, -0.006683896295726299, -0.016435697674751282, -0.010203368961811066, -0.023357443511486053, -0.0087693827226758, -0.009596682153642178, 0.0024112353567034006, 0.009479481726884842, -0.0002766285033430904, 0.010230946354568005, -0.013871067203581333, -0.007445701863616705, -0.011768345721065998, -0.01744224689900875, -0.029617348685860634, 0.00033307450939901173, 0.01682177186012268, -0.008217848837375641, -0.009279550984501839, -0.015470514073967934, 0.017745589837431908, 0.03885553404688835, 0.03962767869234085, -0.016766617074608803, 0.012981719337403774, -0.0039365701377391815, -0.01274042297154665, -0.0243226271122694, 0.0057911016047000885, -0.006122021470218897, 0.004960354417562485, 0.015291266143321991, -0.0036608034279197454, -0.023784881457686424, -0.008693546056747437, -0.012002747505903244, 0.03350565955042839, 0.0015779028180986643, -0.003219576785340905, -0.03455357253551483, 0.007845563814043999, 0.03601513430476189, -0.054519083350896835, 0.010292993858456612, -0.008638393133878708, 0.013464311137795448, 0.014739732258021832, 0.021854514256119728, 0.012864517979323864, 0.010479136370122433, -0.011809710413217545, 0.01964838057756424, 0.04274384304881096, 0.0140985744073987, 0.00254050106741488, 0.03722850978374481, -0.026459818705916405, -0.002261287299916148, -0.0068734860979020596, -0.013340216130018234, -0.03298170119524002, -0.01673904061317444, 0.023550478741526604, -0.004877624101936817, 0.01551187876611948, -0.03722850978374481, 0.0006019470747560263, 0.04177866131067276, 0.03174075111746788, -0.032430168241262436, -0.017607705667614937, -0.009941390715539455, -0.008472933433949947, 0.04373660311102867, -0.032237131148576736, -0.004677693359553814, -0.012181995436549187, -0.03389173373579979, 0.02557736448943615, 0.01658736914396286, 0.014684578403830528, 0.0032316413708031178, 0.0009944838238880038, -0.01606341265141964, -0.06287481635808945, -0.005960008595138788, -0.015401571989059448, 0.004381244070827961, 0.012375032529234886, 0.008217848837375641, 0.03185105696320534, -0.007280241698026657, 0.004663905128836632, -0.010527395643293858, 0.01367113646119833, 0.0216063242405653, 0.030030997470021248, 0.01610477827489376, -0.04335053265094757, 0.013160967268049717, -0.010527395643293858, 0.008983101695775986, 0.04241292551159859, -0.03193378821015358, -0.0032902418170124292, 0.017028596252202988]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" i-th microbatch, the remaining bubble size
after its forward computation at the last stage is (p−1)b−f−(i−1)(f+b) =pb−i(f+b). Dividing this value by b
gives the number of backward stages ⌊(pb−i(f+b))/b⌋=⌊p−i(f/b+ 1)⌋.
Some remarks. (1) There are some limitations to the proposed approach. For example, it requires that there is no
tied/shared model parameter across pipeline stages; otherwise, the gradients from partial forward/backward passes might
(in theory) be harmful rather than beneficial for training the model. Another concern is that inserting microbatches into
Part 1 of the explicit bubbles can cause additional overhead of activation memory in early stages. (2) While Part 1 of this
approach requires the existence of early exits, Part 2 is actually applicable to training standard models without early exits
as well. (3) One might raise concerns about the inefficiency of data usage, as some microbatches only undergo partial
forward/backward passes. In general, this is not an issue for LLM pre-training, since training data is usually abundant, and
the complete training process might not even go through one epoch of the data.
A different perspective. The actual implementation of this method in EE-LLM takes a different perspective. Instead of
inserting additional microbatches into the original schedule, we keep the number of microbatches per training iteration
unchanged, and do the following: (1) we replace the full forward/backward computation of a few microbatches with partial
forward/backward computation, which can be placed in the bubble between the warm-up and steady phases; (2) we truncate
the backward computation of the last few microbatches. These two steps correspond exactly to Parts 1 and 2 introduced
earlier, and the visualization in Figure 4(b) remains valid. Such an implementation reduces the training time per iteration, at
the cost of lower data utilization.
C.2.2. A NALYSIS
We argue that such partial forward/backward computation offers useful gradient information for training, under the assump-
tion that there is no tied model parameter across pipeline stages. For a theoretical justification, let us take the perspective of
stochastic optimization, and assume that each microbatch is sampled independently from some data distribution.
Claim C.1 (Informal) .Under the above assumptions, the accumulated gradient of one training iteration, with extra updates
from additional microbatches inserted into Part 2, remains (after some appropriate entrywise scaling) an unbiased estimate,
but with reduced variance , of the gradient for the targeted population risk. A similar claim holds true for Part 1 as well,
21
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
𝜽!𝐿!𝜽""𝐿""𝜽#𝐿#𝜽$𝐿$InputStage 1Stage 4Stage 3Stage 2ForwardBackwardPart 1: partial forward and backwardForwardBackwardPart 2: full forward and partial backward
Figure 12: An illustration of the partial forward/backward passes when filling pipeline bubbles with additional microbatches.
except for certain extreme (and unlikely) situations where gradients of different early/final losses have a strong negative
correlation.
In the remaining of this section, we provide an informal proof for this claim, in a concrete example with four pipeline stages
and one additional microbatch inserted into either Part 1 or Part 2; a visualization can be found in Figure 12. Recall that the
training objective is defined as L=P
i∈[4]Li, where each Liis a weighted sum of all losses on Stage i. We denote the
model parameters as θ= [θ1,θ2,θ3,θ4], with correspondence to how the model is partitioned into four pipeline stages.
One key observation that will be useful is that ∂Li/∂θj=0for any 1≤i < j≤4, due to the sequential nature of the
model.
Analysis of Part 2. We start with an analysis for Part 2, which is slightly simpler. Suppose that an additional microbatch
goes through the full forward pass, followed by a partial backward pass covering only the last two stages, namely θ4andθ3.
Then, the gradient from this microbatch is
gradient =
0,0,∂(L3+L4)
∂θ3,∂(L3+L4)
∂θ4
=","[0.01951809599995613, -0.012511944398283958, 0.05685298889875412, -0.023751260712742805, -0.02898912876844406, -0.004430755507200956, 0.011534029617905617, 0.029230259358882904, -0.020053939893841743, 0.05733524635434151, 0.03244531899690628, -0.0020244834013283253, -0.04919042810797691, 0.008600287139415741, -0.032954372465610504, -0.015968134626746178, 0.005924419034272432, -0.015378706157207489, -0.00227733445353806, 0.03407964110374451, 0.02008073218166828, -0.025372186675667763, 0.03560679405927658, 0.026055386289954185, 0.020281674340367317, -0.054629236459732056, 0.037428662180900574, 0.003981986548751593, 0.012679395265877247, -0.0256802961230278, 0.04265313595533371, -0.025305205956101418, -0.04994060844182968, -0.02783706597983837, 0.011741668917238712, 0.03174872323870659, 0.02008073218166828, 0.051896434277296066, -0.01314156036823988, 0.04613611847162247, 0.023952201008796692, -0.04977985471487045, -0.07362488657236099, 0.02597500942647457, 0.0008782808436080813, 0.03820563480257988, 0.025090867653489113, 0.00825198832899332, 0.03346342220902443, 0.03804488480091095, 0.01795075461268425, 0.03158796951174736, -0.018406221643090248, -0.014012305997312069, 0.0035030764993280172, -0.015445686876773834, -0.0036839235108345747, -0.0012709535658359528, 0.012612414546310902, -0.022358067333698273, 0.01753547601401806, -0.05878202244639397, 0.02513105608522892, -0.026818962767720222, -0.00017530034529045224, -0.025532938539981842, -0.04994060844182968, 0.033784929662942886, 0.030784204602241516, 0.043456900864839554, -0.0370267815887928, -0.0063966307789087296, 0.006587524898350239, -0.007763031404465437, -0.028024611994624138, 0.032525695860385895, 0.01595473848283291, 0.010248005390167236, 0.01866074651479721, 0.008821322582662106, 0.03699998930096626, 0.009216506965458393, 0.03729470074176788, -0.044287458062171936, 0.011969402432441711, -0.0803765133023262, 0.011453652754426003, -0.0077697294764220715, -0.07737579196691513, -0.05345038324594498, -0.009464334696531296, -0.014173058792948723, -0.027234241366386414, 0.004233162850141525, 0.04584140330553055, 0.007722843438386917, 0.0221303328871727, -0.04367123916745186, 0.03659810498356819, 0.014628525823354721, 0.010857527144253254, -0.022947493940591812, 0.02628312073647976, -0.07399997860193253, 0.036410558968782425, -0.020214693620800972, -0.03764300048351288, 0.04833307862281799, -0.04409991204738617, -0.017749814316630363, 0.0011277829762548208, 0.006855446845293045, 0.01882150024175644, -0.015124180354177952, 0.010314986109733582, -0.025452563539147377, -0.057656753808259964, 0.03158796951174736, -0.0029253701213747263, -0.010435550473630428, -0.024354083463549614, -0.016838880255818367, -0.00826538447290659, -0.0364641435444355, 0.006011493504047394, 0.004434104543179274, 0.044716134667396545, -0.04265313595533371, -0.0010875946609303355, -0.029658934101462364, 0.028935544192790985, 0.02730122208595276, 0.02309485152363777, -0.023577110841870308, -0.011011582799255848, -0.024166539311408997, 0.00011480863759061322, 0.015526062808930874, -0.008412742055952549, -0.01736132614314556, 0.02756914496421814, -0.0014518008101731539, -0.03649093583226204, -0.025104263797402382, -0.021433737128973007, 0.06467629969120026, -0.020911289379000664, 0.03260607272386551, 0.00628276402130723, 0.006687995977699757, -0.0009829377522692084, 0.002734476001933217, -0.019879791885614395, -0.026912735775113106, 0.011071864515542984, -0.0036504333838820457, -0.018714331090450287, 0.03507095202803612, 0.07303545624017715, -0.02426031045615673, -0.00574022252112627, 0.013081277720630169, 0.0517088919878006, -0.007093227468430996, 0.008787832222878933, 0.052057188004255295, -0.05275378376245499, -0.004266653209924698, -0.07726862281560898, -0.06644458323717117, -0.023322585970163345, -0.01470890175551176, -0.04750252142548561, -0.03978637605905533, 0.004524528048932552, -0.03464227914810181, -0.05540620908141136, -0.09146847575902939, 0.011179033666849136, -0.055513378232717514, -0.017870377749204636, 0.03541925176978111, -0.0012994202552363276, -0.024729173630475998, -0.05211077257990837, 0.02885516919195652, 0.014333811588585377, 0.01796415075659752, -0.011212524026632309, 0.015311725437641144, -0.004072410054504871, 0.037696585059165955, 0.059800125658512115, -0.0011487143347039819, -0.00018764985725283623, -0.02009412832558155, 0.07014190405607224, 0.01793735846877098, 0.027917442843317986, 0.01592794619500637, 0.04455538094043732, 0.04551989957690239, 0.02756914496421814, -0.04913684353232384, 0.04351048544049263, -0.009511221200227737, 0.0008025092538446188, 0.024005785584449768, -0.021889204159379005, -0.024474648758769035, 0.00803765095770359, 0.03268644958734512, 0.011179033666849136, 0.004216418135911226, -0.027328014373779297, 0.019062628969550133, -0.0727139562368393, 0.03306153789162636, 0.037428662180900574, 0.04519839212298393, 0.012866940349340439, -0.0007648327737115324, 0.01580738089978695, 0.026604626327753067, -0.05337000638246536, 0.004986692685633898, 0.056209973990917206, -0.046564795076847076, 0.02815857157111168, -0.007495109923183918, 0.018620559945702553, 0.007655862718820572, -0.03474944457411766, -0.012947317212820053, 0.031078917905688286, -0.04476971924304962, -0.028346117585897446, -0.039839956909418106, 0.009651879779994488, -0.03174872323870659, 0.03198985382914543, 0.07255320250988007, -0.012753073126077652, -0.039973918348550797, -0.01911621354520321, 0.020429030060768127, -0.00961169134825468, -0.025626711547374725, -0.00391165679320693, -0.003724111709743738, 0.007917086593806744, -0.025385582819581032, -0.02815857157111168, -0.00797067116945982, -0.07228527963161469, 0.02455502562224865, 0.019156401976943016, 0.012793261557817459, -0.04032221809029579, -0.002089789370074868, 0.015619835816323757, -0.01566002331674099, -0.01765604130923748, 0.02669839933514595, -0.004367123823612928, -0.013583631254732609, -0.012471755966544151, 0.0005220287130214274, 0.025157848373055458, 0.02783706597983837, -0.01951809599995613, -0.006781768519431353, -0.024005785584449768, 0.004306841641664505, -0.020013751462101936, -0.03134683892130852, 0.04522518441081047, 0.0379377156496048, -0.024059370160102844, 0.013690799474716187, -0.012793261557817459, 0.005365132354199886, 0.0731426253914833, -0.011755065061151981, 0.025948217138648033, -0.005904324818402529, 0.009008867666125298, -0.00020952314662281424, -0.0013077928451821208, -0.03930411487817764, 0.010107346810400486, -0.009497825056314468, 0.05184284970164299, -0.010797245427966118, 0.033784929662942886, 0.0008301386842504144, 0.018325844779610634, -0.026885943487286568, 0.03657131269574165, -0.009330373257398605, 0.007863502018153667, -0.019585076719522476, -0.04878854379057884, 0.0290159210562706, 0.004045617766678333, 6.164292426547036e-05, -0.022612592205405235, 0.0038111864123493433, -0.02898912876844406, -0.0062894620932638645, -0.017843585461378098, 0.02712707407772541, -0.037107158452272415, 0.01449456438422203, -0.003523170482367277, -0.028881961479783058, 0.0010381966130807996, -0.03373134508728981, 0.021353360265493393, -0.020268278196454048, -0.0014518008101731539, -0.03370455279946327, -0.020991666242480278, -0.03148080036044121, 0.005689987447112799, 0.0052345204167068005, -0.021299775689840317, 0.009852821007370949, -0.023148436099290848, -0.01868753880262375, -0.013181747868657112, -0.027207449078559875, -0.013730987906455994, -0.042840681970119476, -0.03073062002658844, -0.024769362062215805, -0.03099854290485382, 0.0041427393443882465, 0.04624328762292862, 0.024313895031809807, -0.0740535631775856, -0.0044876886531710625, -0.012947317212820053, 0.016316432505846024, -0.00898207537829876, 0.004738865420222282, 0.01911621354520321, 0.014735694043338299, 0.06156840920448303, 0.016303036361932755, -0.04059014096856117, -0.025184640660881996, 0.02483634278178215, -0.009959989227354527, 0.04206370934844017, 0.00875434186309576, 0.02786385826766491, -0.05567413195967674, 0.004360425751656294, 0.017870377749204636, -0.02211693674325943, -0.016316432505846024, 0.006771721411496401, 0.01262581069022417, -0.010174326598644257, 0.032364942133426666, -0.021165816113352776, -0.014521356672048569, -0.012746375054121017, -0.010917809791862965, 0.03973279148340225, 0.0312664620578289, -0.02742178738117218, 0.013824759982526302, -0.06628382951021194, -0.0009854495292529464, -0.0020931384060531855, 0.0062593212351202965, 0.013309011235833168, 0.02298768237233162, -0.029551764950156212, 0.028667623177170753, -0.009531314484775066, 0.015619835816323757, -0.020295070484280586, 0.046323664486408234, 0.010649887844920158, -0.022465236485004425, -0.02471577748656273, -0.004243209958076477, -0.010529323481023312, 0.006363140884786844, -0.000595288525801152, 0.018607163801789284, 0.009296883828938007, -0.011326390318572521, 0.013175049796700478, 0.024876531213521957, 0.047047052532434464, 0.01529833022505045, -0.05529903993010521, -0.031105710193514824, -0.0468595065176487, -0.06628382951021194, 0.012016288936138153, 0.004470943473279476, 0.03708036616444588, 0.0007627396262250841, 0.034829821437597275, 0.00768265500664711, 0.009893009439110756, -0.005954559892416, 0.02253221534192562, -0.025599919259548187, 0.026912735775113106, -0.014360603876411915, 0.0118555361405015, 0.03721432760357857, 0.02123279497027397, 0.0792512446641922, 0.013389387167990208, -0.03665168955922127, -0.004018825478851795, -0.022599196061491966, -0.01507059670984745, 0.012665999121963978, 0.011507237330079079, 0.0064904033206403255, -0.016008323058485985, -0.05387905612587929, -0.01624945178627968, 0.04160824045538902, -0.028238948434591293, -0.029391011223196983, -0.05138738453388214, -0.03689282014966011, -0.008024255745112896, 0.0031011938117444515, -0.011386672966182232, -0.032793618738651276, 0.007401337381452322, -0.014146266505122185, -0.04683271422982216, 0.032525695860385895, -0.058353349566459656, 0.010201118886470795, -0.0684272050857544, -0.01513757649809122, 0.005894277710467577, -0.03174872323870659, -0.008620381355285645, 0.04777044057846069, 0.03316870704293251, 0.029551764950156212, -0.004661837592720985, -0.07073133438825607, 0.10223892331123352, -0.018285656347870827, 0.017629249021410942, -0.023590506985783577, 0.033972471952438354, 0.014454375952482224, -0.016745107248425484, -0.008660569787025452, -0.017160385847091675, 0.03027515299618244, 0.0213935486972332, -0.020991666242480278, 0.009986781515181065, 0.03314191475510597, 0.01607530191540718, -0.03407964110374451, 0.0349905751645565, -0.006463611498475075, -0.029685726389288902, 0.010522625409066677, -0.019719038158655167, -0.03359738364815712, -0.0012182064820080996, 0.009477730840444565, 0.03426718711853027, 0.012190437875688076, 0.0010415456490591168, -0.06156840920448303, 0.027622727677226067, 0.06188991665840149, -0.012605716474354267, -0.013697497546672821, 0.0015137576265260577, -0.02069695293903351, -0.002622283762320876, -0.031212879344820976, 0.028748000040650368, -0.015405498445034027, -0.01219713594764471, -0.023081455379724503, -0.010495833121240139, 0.00023694326227996498, 0.010844131000339985, 0.020321862772107124, 0.0338653028011322, -0.011205825954675674, 0.003958543296903372, 0.012659301050007343, 0.011734970845282078, -0.020629972219467163, -0.021286379545927048, 0.0024447855539619923, -0.019410928711295128, 0.007166905794292688, -0.010402060113847256, 0.003821233520284295, 0.01063649170100689, -0.0006091032410040498, -0.0038513746112585068, 0.02152751013636589, -0.004186276812106371, -0.0012207182589918375, 0.010134139098227024, 0.02669839933514595, 0.00044667572365142405, 0.0021098835859447718, -0.027368202805519104, -0.01486965548247099, -0.015445686876773834, -0.022880515083670616, -0.031052125617861748, -0.07298187166452408, 0.003687272546812892, 0.005951210856437683, 0.04878854379057884, 0.001754887169227004, -0.013878344558179379, -0.014976823702454567, -0.031078917905688286, -0.0060081444680690765, 0.0011755065061151981, -0.03241852670907974, -0.038982607424259186, 0.008600287139415741, 0.028480077162384987, 0.029230259358882904, 0.02569369226694107, 0.03732149302959442, -0.021500717848539352, -0.031186087056994438, 0.04720780625939369, 0.006406677886843681, 0.016718314960598946, 0.03831280395388603, 0.01063649170100689, 0.005308198742568493, 0.018191885203123093, -0.03177551552653313, -0.045305561274290085, -0.011761763133108616, 0.00746831763535738, 0.03314191475510597, 0.003827931359410286, 0.012290908955037594, 0.021648073568940163, 0.006423423066735268, 0.030516283586621284, -0.03579434007406235, -0.015539458952844143, 0.014749090187251568, 0.015968134626746178, -0.044153496623039246, 0.021567698568105698, 0.030944958329200745, -0.0347762368619442, 0.007930482737720013, 0.023778051137924194, -0.029658934101462364, 0.001519618439488113, -0.02053619921207428, 0.029176674783229828, 0.020308466628193855, -0.00783670973032713, -0.023027870804071426, -0.03316870704293251, -0.0279978197067976, -0.02786385826766491, -0.03416001796722412, -0.0014091007178649306, -0.002374456264078617, -0.006781768519431353, -0.011594312265515327, -0.05010135844349861, 0.004179578740149736, 0.02656443789601326, -0.018272260203957558, -0.01823207177221775, 0.017843585461378098, -0.01708000898361206, -0.004296794533729553, 0.009946594014763832, 0.014990219846367836, 0.00811132974922657, -0.03528529033064842, 0.023510130122303963, -0.021192606538534164, 0.015204557217657566, 0.00904235802590847, -0.022344671189785004, 0.022344671189785004, -0.03016798570752144, 0.026202743873000145, 0.019786018878221512, -0.014347207732498646, 0.006229179911315441, 0.014440980739891529, -0.014199851080775261, -0.009511221200227737, -0.02783706597983837, -0.04664517194032669, -0.020897893235087395, -0.01472229789942503, 0.05417377129197121, -0.016704918816685677, 0.020897893235087395, 0.0031430565286427736, 0.0321773961186409, -0.030837789177894592, 0.03268644958734512, -0.018982253968715668, -0.03027515299618244, 0.0017800048226490617, 0.027810273692011833, 0.010395362041890621, -0.021915996447205544, 0.02396559715270996, 0.009263393469154835, -0.02644387260079384, 0.010603001341223717, 0.0038346294313669205, -0.013429575599730015, 0.0076089766807854176, -0.04155465587973595, -0.05315566807985306, 0.04008108749985695, 0.004055664874613285, 0.015097388066351414, -0.04835987091064453, 0.010435550473630428, 0.014106078073382378, -0.005110606551170349, 0.015030408278107643, -0.014963427558541298, -0.044850096106529236, -0.018017735332250595, -0.036812443286180496, 0.043456900864839554, 0.01939753256738186, 0.019009046256542206, -0.014092681929469109, 0.016410205513238907, -0.007883596234023571, 0.026671607047319412, -0.036115847527980804, -0.037107158452272415, -0.009531314484775066, -0.037107158452272415, -0.012103362940251827, 0.00434033153578639, 0.032525695860385895, 0.006845399737358093, 0.012150249443948269, -0.009028961881995201, -0.017562268301844597, -0.022358067333698273, 0.02482294663786888, 0.025372186675667763, 0.007247282192111015, -0.02683235891163349, -0.03405284881591797, -0.040402594953775406, -0.017013028264045715, -0.022867118939757347, -0.013121466152369976, -0.016972839832305908, 0.0001533223839942366, -0.006637760438024998, -0.014534752815961838, -0.02700650878250599, -0.01098479051142931, 0.016704918816685677, -0.035258498042821884, -0.009872915223240852, -0.02170165814459324, 0.016771899536252022, 0.007434827741235495, 0.024434460327029228, -0.03089137375354767, 0.024635400623083115, -0.010797245427966118, -0.022224105894565582, 0.029980439692735672, -0.018915273249149323, -0.04182257875800133, -0.0045010847970843315, -0.005401971749961376, -0.026309913024306297, -0.000331553106661886, -0.01821867562830448, -0.017468495294451714, -0.026189347729086876, 0.07576826214790344, 0.04747572913765907, -0.032793618738651276, -0.02455502562224865, -0.002305801259353757, 0.02140694484114647, -0.009162922389805317, -0.0528341606259346, 0.005689987447112799, 0.015231349505484104, -0.01470890175551176, -0.03622301667928696, -0.022612592205405235, -0.051173046231269836, -0.023644091561436653, -0.022639384493231773, 0.009008867666125298, 0.01608869805932045, -0.015727004036307335, -0.04310860484838486, 0.014628525823354721, 0.0427870973944664, -0.014173058792948723, 0.03327587619423866, 0.020482614636421204, 0.006065077614039183, -0.03102533519268036, 0.006483705248683691, 0.03772337734699249, -0.031534384936094284, -0.00157990085426718, -0.030328737571835518, 0.00998008344322443, -0.01753547601401806, -0.05211077257990837, -0.015311725437641144, 0.04152786359190941, 0.019410928711295128, -0.01592794619500637, 0.011098656803369522, 0.030944958329200745, -0.005324943922460079, 0.007816615514457226, -0.014842863194644451, 0.011607708409428596, -0.02227769047021866, 0.014307019300758839, 0.004336982499808073, 0.0010323358001187444, 0.004417359363287687, -0.010475738905370235, 0.005110606551170349, -0.03303474560379982, 0.022599196061491966, -0.004765657242387533, -0.006252623163163662, 0.01695944368839264, 0.0061822934076189995, 0.00795727502554655, 0.006266018841415644, -0.025666899979114532, 0.06146124005317688, -0.01868753880262375, -0.02254561148583889, -0.0014400791842490435, 0.04868137463927269, 0.003117938991636038, 0.06462271511554718, 0.0024146444629877806, 0.02944459579885006, -0.030221568420529366, -0.01249854825437069, 0.005659846123307943, 0.0037676491774618626, -0.012719583697617054, 0.03659810498356819, -0.008874907158315182, -0.015164368785917759, -0.0010566163109615445, -0.0063028582371771336, 0.022344671189785004, -0.015874361619353294, -0.05872843787074089, -0.020321862772107124, -0.03515132889151573, 0.004913014359772205, -0.043858785182237625, 0.0025737229734659195, 0.012103362940251827, 0.014883050695061684, -0.12474434822797775, 0.003476284211501479, 0.027073489502072334, 0.00373415881767869, -0.013811363838613033, 0.017428306862711906, -0.012217230163514614, -0.0020228088833391666, 0.01363721489906311, -0.03287399560213089, -0.011848838068544865, -0.0014986870810389519, -0.010870923288166523, -0.009350467473268509, 0.00315980170853436, -0.03472265228629112, 0.0145079605281353, 0.016852276399731636, 0.0195314921438694, -0.017897170037031174, -0.03917015343904495, -0.003921703901141882, -0.022291086614131927, -0.009296883828938007, -0.07105284184217453, -0.037401869893074036, -0.012619112618267536, -0.0008054396603256464, 0.025050679221749306, 0.005582818761467934, -0.008272082544863224, 0.014601733535528183, 0.023590506985783577, -0.015258141793310642, -0.010951300151646137, 0.01470890175551176, -0.012833449989557266, -0.011714876629412174, -0.005237869452685118, 0.026336703449487686, -0.024072766304016113, -0.03148080036044121, 0.03461548686027527, 0.008546702563762665, 0.005207728128880262, -0.0031581271905452013, 0.010294891893863678, -0.01549927145242691, 0.02727442979812622, 0.004521179012954235, -0.025586523115634918, -0.025613315403461456, -0.009939895942807198, -0.01811150833964348, 0.01681208796799183, -0.01594134233891964, -0.023188624531030655, -0.008848114870488644, 0.005418716464191675, 0.049592308700084686, -0.018165092915296555, 0.039866749197244644, 0.01357023511081934, -0.017026424407958984, -0.03399926424026489, -0.020335257053375244, 0.014039097353816032, 0.019330551847815514, -0.015097388066351414, -0.03649093583226204, -0.018124904483556747, -0.01557964738458395, -0.006965964566916227, 0.010402060113847256, -0.007294168695807457, 0.0007279935525730252, -0.018607163801789284, 0.02715386636555195, -0.04367123916745186, 0.002347663976252079, 0.017053216695785522, -0.0017297695158049464, -0.008352459408342838, -0.029551764950156212, -0.01721397042274475, 0.0253989789634943, 0.00982602871954441, -0.023818239569664, 0.0009050730150192976, 0.013918532989919186, 0.021045250818133354, -0.0063832346349954605, 0.014963427558541298, -0.0216748658567667, -0.006393281742930412, 0.010502531193196774, 0.010187722742557526, 0.02355031855404377, 0.04977985471487045, 0.013369293883442879, 0.015445686876773834, 0.023938804864883423, -0.030677035450935364, -0.038821857422590256, -0.0033808371517807245, -0.016986235976219177, 0.012244022451341152, -0.019022442400455475, 0.00599139928817749, -0.044582173228263855, 0.018138300627470016, -0.004069061018526554, -0.028828376904129982, 0.051173046231269836, -0.0013429576065391302, 0.02385842800140381, 0.021152419969439507, 0.03673206642270088, 0.015378706157207489, -0.02842649444937706, 0.005050324369221926, 0.012471755966544151, -0.026028594002127647, 0.014588337391614914, -0.019719038158655167, -0.04160824045538902, 0.01667812652885914, 0.03244531899690628, -0.014561545103788376, -0.01386494841426611, -0.019611869007349014, 0.007361148949712515, 0.011667990125715733, 0.007635768968611956, -0.0006111963884904981, 0.009671973995864391, 0.0011889026500284672, 0.00206299708224833, -0.010730264708399773, 0.036544520407915115, 0.006108615081757307, 0.0010909436969086528, 0.04380520060658455, 0.020763931795954704, 0.0059813521802425385, 0.02152751013636589, -0.023295793682336807, -0.020589783787727356, 0.034508317708969116, 0.03244531899690628, 0.0256802961230278, 0.012203834019601345, -0.03858072683215141, -0.003613593988120556, -0.02484973892569542, -0.006590873934328556, -0.000746831763535738, -0.040992021560668945, -0.014816070906817913, 0.013302313163876534, 0.011962704360485077, 0.05093191936612129, -0.013891740702092648, -0.014387396164238453, -0.005268010776489973, -0.0192501749843359, -0.003523170482367277, 0.0029890015721321106, -0.054763197898864746, 0.02484973892569542, -0.027622727677226067, -0.02084430865943432, 0.03504415974020958, 0.019558284431695938, 0.031052125617861748, 0.022652780637145042, -0.015981530770659447, 0.03659810498356819, 0.011118751019239426, -0.0032267821952700615, -0.013509952463209629, 0.013483160175383091, -0.007454921491444111, -0.004176229704171419, -0.0021785383578389883, -0.010428852401673794, 0.005850740242749453, -0.004427406471222639, 0.02154090628027916, 0.03362417593598366, 0.019035838544368744, 0.028372909873723984, 0.0011219221632927656, 0.03073062002658844, 0.024032577872276306, -0.004357076715677977, -0.016745107248425484, 0.018566975370049477, -0.02140694484114647, -0.009049056097865105, -0.008017557673156261, 0.013744384050369263, -0.006801862269639969, -0.010643189772963524, -0.06810569763183594, 0.015526062808930874, -0.008546702563762665, -0.010803943499922752, -0.0097657460719347, 0.022465236485004425, 0.016128886491060257, 0.014106078073382378, -0.026591230183839798, 0.04217087849974632, -0.01464192196726799, -0.05942503735423088, 0.008225196972489357, 0.01849999465048313, -0.016731711104512215, -0.011513935402035713, -0.0059143719263374805, -0.025171244516968727, -0.0036504333838820457, 0.048467036336660385, -0.011467048898339272, -0.012016288936138153, -0.0022471933625638485, -0.010576209984719753, 0.004249908030033112, 0.0025636758655309677, -0.010475738905370235, 0.006734882015734911, -0.037267908453941345, -0.0012634183513000607, -0.02614915929734707, -0.033972471952438354, -0.024059370160102844, -0.035097744315862656, -0.01579398475587368, 0.011179033666849136, 0.036839235574007034, 0.019571680575609207, -0.018553579226136208, -0.002136675640940666, 0.0422244630753994, 0.008667267858982086, -0.0005228659720160067, 0.01198279857635498, -0.042144086211919785, -0.004712073132395744, -0.01385155227035284, 0.023603903129696846, 0.03188268467783928, -0.010870923288166523, 0.051896434277296066, 0.020067336037755013, 0.013014297001063824, 0.03935769945383072, 0.013409481383860111, 0.007937180809676647, -0.002726103411987424, 0.007984067313373089, 0.020268278196454048, -0.01551266759634018, -0.027756689116358757, -0.0301411934196949, -0.01156751997768879, 0.037830546498298645, 0.008071141317486763, 0.012505246326327324, -0.00825198832899332, 0.01528493408113718, 0.018901877105236053, 0.029069505631923676, -0.012511944398283958, 0.014253434725105762, 0.031052125617861748, -0.03917015343904495, 0.021915996447205544, -0.015887757763266563, 0.0007932994631119072, -0.029685726389288902, -0.039866749197244644, -0.03820563480257988, 0.020268278196454048, 0.016142282634973526, -0.04994060844182968, 0.01793735846877098, 0.04854741320014, -0.013958721421658993, 0.019290363416075706, 0.02180882729589939, -0.009169620461761951, 0.01766943745315075, 0.013824759982526302, 0.0009017240372486413, 0.022063352167606354, 0.034106433391571045, -0.022049956023693085, -0.019745830446481705, -0.0055426303297281265, -0.004839336033910513, 0.013429575599730015, 0.01256552804261446, 0.0012843497097492218, 0.013838156126439571, 0.01781679317355156, -0.014400792308151722, -0.03718753531575203, -0.0009829377522692084, -0.0019206637516617775, 0.027649519965052605, 0.004544622264802456, 0.017414910718798637, 0.0016987911658361554, 0.0025050679687410593, -0.004266653209924698, -0.023295793682336807, 0.020991666242480278, -0.03434756398200989, 0.016731711104512215, 0.03627660125494003, -0.002407946391031146, 0.0235369224101305, -0.01343627367168665, -0.05872843787074089, -0.0256802961230278, -0.00890839658677578, -0.00373415881767869, 0.04225125536322594, 0.04683271422982216, 0.005733524449169636, -0.003168174298480153, 0.0013195144711062312, -0.02885516919195652, 0.006249274127185345, -0.009819330647587776, 0.012592320330440998, -0.024032577872276306, 0.011761763133108616, 0.03649093583226204, 0.028801584616303444, -0.00016849764506332576, 0.008513212203979492, -0.021192606538534164, 0.017682833597064018, -0.005756967701017857, -0.010509229265153408, 0.0012893732637166977, -0.018633954226970673, 0.07024907320737839, -0.0011068516178056598, 0.004658488556742668, -0.01305448543280363, -0.03190947696566582, 0.018915273249149323, 0.028399702161550522, -0.017133593559265137, -0.003126311581581831, 0.012237324379384518, 0.0023208719212561846, 0.0439123697578907, -0.022344671189785004, 0.012002892792224884, 0.04814553260803223, 0.00245985621586442, -0.014012305997312069, 0.05181605741381645, 0.013838156126439571, 0.02195618487894535, 0.02526501752436161, 0.017696229740977287, -0.010690076276659966, -0.019410928711295128, -0.00818500854074955, -0.0033255782909691334, 0.007294168695807457, 0.010087252594530582, 0.014601733535528183, 0.03860751911997795, -0.03764300048351288, -0.02239825576543808, -0.018325844779610634, 0.027515560388565063, -0.014909842982888222, 0.02223750203847885, -0.0027746642008423805, 0.039143361151218414, -0.013918532989919186, 0.013061183504760265, 0.004785751458257437, 0.008486419916152954, -0.021433737128973007, -0.020482614636421204, 0.0030040722340345383, 0.008821322582662106, 0.012049779295921326, 0.030623450875282288, 0.006828654557466507, 0.010093950666487217, -0.00035436832695268095, 0.014521356672048569, 0.03531208261847496, 0.007984067313373089, -0.0008673965348862112, -0.020281674340367317, -0.0011629477376118302, 0.049592308700084686, 0.03445473313331604, 0.004353727679699659, -0.027917442843317986, -0.0013094673631712794, -0.01793735846877098, 0.014414188452064991, 0.007508506067097187, -0.021487321704626083, 0.015191161073744297, 0.01126610767096281, -0.028346117585897446, 0.013014297001063824, -0.009437542408704758, 0.013483160175383091, -0.0029856525361537933, 0.0010457319440320134, 0.0009042357560247183, 0.013523348607122898, -0.008834718726575375, 0.013476462103426456, 0.01343627367168665, 0.011326390318572521, -0.036383770406246185, -0.00495655182749033, 0.002052950207144022, -0.025037284940481186, 0.02668500319123268, 0.007917086593806744, 0.02644387260079384, -0.022183917462825775, -0.016289640218019485, -0.009946594014763832, -0.005787109024822712, 0.026671607047319412, 0.005907673854380846, -0.013275520876049995, 0.0013797967694699764, -0.0416618250310421, -0.021634677425026894, -0.031534384936094284, -0.005556026473641396, 0.0036805744748562574, -0.02211693674325943, -0.014802674762904644, 0.015847569331526756, 0.016919255256652832, 0.000483096344396472, -0.001433381112292409, -0.05529903993010521, 0.009866217151284218, 0.02610897086560726, 0.0268725473433733, -0.029471388086676598, -0.020027147606015205, -0.0009762397385202348, -0.003921703901141882, 0.004852732177823782, 0.0116278026252985, -0.009069150313735008, 0.039545245468616486, -0.003995382692664862, 0.0020981619600206614, 0.009604993276298046, 0.011507237330079079, 0.031212879344820976, 0.007495109923183918, -0.007026246748864651, 0.02052280306816101, -0.013690799474716187, 0.005351736210286617, -0.03456190228462219, -0.012860242277383804, -0.013195144012570381, 0.0009310279274359345, 0.02239825576543808, -0.017481891438364983, -0.006108615081757307, 0.02313503995537758, 0.000856512226164341, -0.014159662649035454, -0.03271324187517166, 0.013094673864543438, 0.0033490213099867105, -0.027247637510299683, 0.00020743001368828118, 0.034508317708969116, 0.0056230067275464535, 0.028962336480617523, 0.023751260712742805, -0.028480077162384987, 0.01464192196726799, 0.014775882475078106, -0.0016954421298578382, 0.03973279148340225, -0.032793618738651276, 0.03665168955922127, 0.0034528409596532583, 0.023014474660158157, -0.02369767613708973, -0.02614915929734707, 0.026765378192067146, -0.009658577851951122, 0.026805566623806953, 0.00889500044286251, 0.00032401783391833305, 0.022451840341091156, 0.062372174113988876, 0.02253221534192562, -0.034963782876729965, 0.012860242277383804, -0.006413375958800316, -0.018620559945702553, -0.02069695293903351, -0.03501736745238304, 0.005522536113858223, -0.017414910718798637, -0.024635400623083115, -0.005897626746445894, 0.014909842982888222, 0.01464192196726799, -0.031400423496961594, -0.013838156126439571, -0.016048511490225792, 0.006118662189692259, 0.025532938539981842, 0.008218498900532722, -0.03520491346716881, -0.02050940692424774, 0.03148080036044121, 0.019183194264769554, -0.0070999255403876305, -0.00876773800700903, 0.008010859601199627, -0.02542577125132084, 0.0290159210562706, -0.018299052491784096, 0.010824036784470081, 0.006714787799865007, -0.020053939893841743, 0.025894634425640106, 0.04059014096856117, -0.002695962321013212, 0.005043626297265291, -0.029900062829256058, -0.003112915437668562, 0.01594134233891964, -0.00998008344322443, 0.024313895031809807, -0.005368481390178204, -0.011667990125715733, -0.022344671189785004, 0.00912273395806551, -0.006815258413553238, -0.001376447849906981, -0.01911621354520321, -0.009430844336748123, 0.026336703449487686, 0.0031062173657119274, -0.023215416818857193, -0.003915005829185247, -0.03220418840646744, -0.049351178109645844, 0.01926357112824917, -0.02715386636555195, 0.034508317708969116, 0.026738587766885757, -0.00037739286199212074, 0.015619835816323757, 0.0047020260244607925, 0.009986781515181065, 0.01149384118616581, -0.010562813840806484, -0.00703964289277792, -0.041259944438934326, 0.001162110478617251, 0.006771721411496401, 0.027676312252879143, -0.00918301660567522, 0.015887757763266563, -0.013509952463209629, -0.016329828649759293, 0.006758325267583132, 0.007066435180604458, 0.02010752446949482, 0.015901153907179832, 0.00610526604577899, -0.005689987447112799, 0.04383199289441109, 0.003369115525856614, 0.015552855096757412, -0.036812443286180496, 0.03177551552653313, -0.0312664620578289, 0.0010356848360970616, 0.00875434186309576, -0.04088485240936279, 0.006192340515553951, -0.018875084817409515, 0.011024978011846542, -0.030114401131868362, 0.031105710193514824, 0.015566251240670681, -0.010703472420573235, 0.019759226590394974, 0.0005086326273158193, -0.013429575599730015, -0.006517195608466864, 0.02912309020757675, -0.011882327497005463, -0.0037542530335485935, 0.013188445940613747, -0.0017883774125948548, 0.012813355773687363, 0.021500717848539352, 0.013918532989919186, -0.02267957292497158, 0.0029186720494180918, 0.025050679221749306, -0.03158796951174736, -0.028828376904129982, 0.014333811588585377, -0.009189714677631855, 0.051735684275627136, 0.015459083020687103, 0.029792893677949905, -0.0074884118512272835, 0.006791815627366304, -0.014628525823354721, -0.03086458146572113, -0.01779000088572502, -0.009558106772601604, 0.002416318980976939, 0.001992667792364955, -0.009993479587137699, 0.016289640218019485, -0.030971750617027283, 0.009457636624574661, -0.012505246326327324, -0.00927009154111147, -0.0321773961186409, 0.00846632570028305, 0.018607163801789284, -0.01709340512752533, -0.008814624510705471, -0.0192501749843359, 0.019732434302568436, 0.04361765459179878, 0.026805566623806953, 0.004470943473279476, 0.016316432505846024, -0.00991310365498066, -0.03089137375354767, -0.009189714677631855, 0.0047522615641355515, 0.0016862322809174657, 0.012974108569324017, 0.001950804959051311, 0.0017984245205298066, -0.027783481404185295, -0.02050940692424774, 0.008205102756619453, 0.03576754778623581, 0.0070061529986560345, 0.023898616433143616, -0.022009769454598427, 0.0063832346349954605, 0.03978637605905533, -0.028614038601517677, 0.02368427999317646, 0.0010507554979994893, 0.010455644689500332, -0.009792538359761238, 0.006466960534453392, 0.00434033153578639, 0.006326301489025354, -0.0192501749843359, 0.001389006618410349, 0.050181735306978226, 0.027247637510299683, 0.014842863194644451, 0.05028890445828438, -0.023362772539258003, -0.009524616412818432, -0.021339964121580124, -0.017723022028803825, -0.04533235356211662, -0.010750358924269676, 0.043001435697078705, -0.01449456438422203, 0.02009412832558155, -0.04292105883359909, 0.013409481383860111, 0.04712742939591408, 0.035258498042821884, -0.028801584616303444, -0.019759226590394974, -0.004028872586786747, 0.010227911174297333, 0.03713395074009895, -0.031936269253492355, -0.01706661283969879, -0.024809550493955612, -0.026510853320360184, 0.017334535717964172, 0.006624364294111729, 0.00783670973032713, -0.0012165320804342628, -0.0007284121820703149, 0.0007225513691082597, -0.04854741320014, -0.008164914324879646, -0.017615852877497673, 0.0038949118461459875, 0.02170165814459324, 0.0049398066475987434, 0.024903323501348495, -0.007843407802283764, 0.005110606551170349, -0.002640703460201621, -0.0041125984862446785, 0.024380875751376152, 0.01839282549917698, 0.011574218049645424, -0.03630339354276657, 0.022585799917578697, -0.01515097264200449, 0.003901609918102622, 0.025800861418247223, -0.029096297919750214, 0.005040277261286974, 0.035231705754995346]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
"
0,0,∂L
∂θ3,∂L
∂θ4
;
here, the first equality is due to Proposition 3.1 and the partial backward pass, while the second equality follows from the
observation that ∂Li/∂θj=0for any i < j .
Now, suppose that a total of Bmicrobatches was originally used for one training iteration, and we let L(k)denote the loss
of the k-th microbatch. Then, with the additional (B+ 1) -th microbatch inserted into Part 2 of the explicit bubbles, the
accumulated gradient of one training iteration (normalized by 1/B) becomes:
accumulated gradient =1
B X
k∈[B]∂L(k)
∂θ+
0,0,∂L(B+1)
∂θ3,∂L(B+1)
∂θ4!
=1
BX
k∈[B]∂L(k)
∂θ1,1
BX
k∈[B]∂L(k)
∂θ2,1
BX
k∈[B+1]∂L(k)
∂θ3,1
BX
k∈[B+1]∂L(k)
∂θ4
Taking the expectation over the data distribution, we realize that the additional microbatch essentially scales up gradients
forθ3andθ4by a factor of (B+ 1)/B. Or, with a simple entrywise scaling on the gradients for θ3andθ4by a factor of
B/(B+ 1) , we recover an unbiased estimate of the gradient for the targeted population risk, with reduced variance:
accumulated gradient =1
BX
k∈[B]∂L(k)
∂θ1,1
BX
k∈[B]∂L(k)
∂θ2,1
B+ 1X
k∈[B+1]∂L(k)
∂θ3,1
B+ 1X
k∈[B+1]∂L(k)
∂θ4
.
22
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
Analysis of Part 1. Suppose that an additional microbatch goes through the forward and backward computation only for
the first two stages, corresponding to model parameters θ1andθ2. Then, the gradient from this microbatch is
gradient =∂(L1+L2)
∂θ1,∂(L1+L2)
∂θ2,0,0
=∂(L1+L2)
∂θ;
here, the first equality is due to the partial forward and backward passes, and the second equality follows again from the
observation that ∂Li/∂θj=0for any i < j .
Now, suppose that a total of Bmicrobatches was originally used for one training iteration. We denote the loss of the k-th
microbatch as L(k)=P
i∈[4]L(k)
i. Then, with the additional (B+ 1) -th microbatch inserted into Part 1 of the explicit
bubbles, the accumulated gradient of one training iteration (normalized by 1/B) becomes:
accumulated gradient =1
BX
k∈[B]∂L(k)
∂θ+∂(L(B+1)
1 +L(B+1)
2 )
∂θ
=1
BX
k∈[B]∂(L(k)
1+L(k)
2+L(k)
3+L(k)
4)
∂θ+∂(L(B+1)
1 +L(B+1)
2 )
∂θ
=1
BX
k∈[B+1]∂(L(k)
1+L(k)
2)
∂θ+X
k∈[B]∂(L(k)
3+L(k)
4)
∂θ
.
Taking the expectation over the data distribution, we see that the additional microbatch essentially scales up the weights of
L1andL2in the gradient by a factor of (B+ 1)/B. Or, if the weights of L1andL2are manually scaled by a factor of
B/(B+ 1) during training, then we recover an unbiased gradient estimate for the original risk L=P
i∈[4]Li:
accumulated","[0.019145997241139412, -0.021480198949575424, 0.05427015200257301, 0.0003523443592712283, -0.013900995254516602, -0.006960918195545673, 0.017506500706076622, -0.0012365703005343676, -0.028316069394350052, 0.03923679143190384, -0.011802993714809418, 0.016200460493564606, -0.03095593862235546, 0.01443591620773077, -0.020354779437184334, -0.019910169765353203, 0.019437773153185844, -0.021799761801958084, -0.0056722452864050865, 0.03456839174032211, -0.012664424255490303, -0.02698224037885666, 0.06774737685918808, 0.03962582349777222, 0.0007741589797660708, -0.05429793894290924, 0.02819102257490158, -0.019590606912970543, 0.04221011698246002, -0.014283081516623497, 0.0537421777844429, -0.029316440224647522, -0.04151541367173195, -0.030455753207206726, 0.005442993249744177, 0.02446741797029972, 0.01649223454296589, 0.07775109261274338, -0.0020788968540728092, 0.02562062442302704, 0.019840700551867485, -0.04993520677089691, -0.06624682247638702, 0.01906263455748558, -0.012581060640513897, -0.0007984735420905054, 0.019368302077054977, -0.004327995702624321, 0.02423121966421604, 0.045989297330379486, 0.005304052960127592, 0.015686379745602608, -0.015589121729135513, 0.0030219554901123047, -0.00637736776843667, -0.008405898697674274, -0.005033118650317192, 0.016756221652030945, 0.02089664712548256, -0.04129311069846153, 0.041543204337358475, -0.03770844638347626, 0.02682940661907196, -0.023717138916254044, -0.0036055054515600204, -0.04357173293828964, -0.048712532967329025, 0.03256765007972717, 0.023717138916254044, 0.03467954322695732, -0.022230476140975952, -0.039014484733343124, 0.03762508183717728, -0.011136079207062721, -0.026857195422053337, 0.03359580785036087, 0.017353665083646774, 0.012546325102448463, 0.0059258113615214825, 0.001520529855042696, 0.0425991490483284, -0.0030011143535375595, 0.04351615905761719, -0.02434237115085125, 0.020841071382164955, -0.08380889892578125, 0.028177129104733467, 0.006884500849992037, -0.057354629039764404, -0.04296039789915085, -0.007933501154184341, -0.019271044060587883, -0.02606523409485817, 0.02198038436472416, 0.04712861031293869, 0.030205659568309784, 0.02110505849123001, -0.028288280591368675, 0.03495742380619049, 0.005057433620095253, 0.010920722037553787, -0.0020580559503287077, 0.049796268343925476, -0.05076885223388672, -0.0006973075214773417, -0.033012256026268005, -0.04101523011922836, 0.015755850821733475, -0.022591721266508102, -0.009725833311676979, -0.01929883286356926, 0.024314584210515022, 0.0050886948592960835, -0.00914923008531332, 0.029316440224647522, -0.02895519509911537, -0.06391262263059616, 0.023842185735702515, -0.03423493355512619, -0.012108663097023964, -0.015102829784154892, -0.021494092419743538, -0.0049810162745416164, -0.04379403963685036, 0.018228990957140923, -0.0044565158896148205, 0.05338093265891075, -0.05696559697389603, -0.018048368394374847, -0.019757336005568504, 0.043738462030887604, 0.03106709197163582, -0.0057660299353301525, -0.04512786865234375, -0.014936101622879505, -0.00013883193605579436, 0.014491491951048374, 0.06557990610599518, -0.009434058330953121, -0.02498149871826172, 0.01829846017062664, 0.01281031221151352, -0.04026494920253754, -0.02834385819733143, -0.03668028488755226, 0.053714390844106674, -0.008169700391590595, 0.02614859864115715, -0.009135336615145206, 0.016186565160751343, -0.020590979605913162, 0.008642097935080528, -0.05032424256205559, -0.002662446815520525, -0.010351065546274185, -0.02859394997358322, 0.00019603632972575724, 0.05276959389448166, 0.07047060877084732, -0.003127897623926401, -0.02118842303752899, 0.02487034536898136, 0.0544646680355072, -0.0014588750200346112, 0.016950737684965134, 0.04673957824707031, -0.058632880449295044, -0.012636636383831501, -0.08886633068323135, -0.08041875064373016, -0.01706189103424549, 0.024092279374599457, -0.04696188122034073, -0.054075635969638824, -0.00846842210739851, -0.009788356721401215, -0.038291994482278824, -0.08886633068323135, 0.0008054205682128668, -0.049796268343925476, 0.010559475980699062, 0.03751393035054207, 0.03587443009018898, 0.013720372691750526, -0.03392926603555679, 0.028399433940649033, 0.019243257120251656, 0.00842673983424902, -0.0017958056414499879, 0.010566423647105694, 0.007447209674865007, 0.03948688507080078, 0.06319013237953186, -0.002122315810993314, -9.345918078906834e-05, -0.015741955488920212, 0.08258622139692307, 0.00719711696729064, 0.019771229475736618, 0.03976476565003395, 0.05040760710835457, 0.03948688507080078, 0.022855708375573158, -0.04865695536136627, 0.014380339533090591, -0.021799761801958084, -0.005772976670414209, 0.02193870209157467, -0.03751393035054207, -0.030566904693841934, 0.003186947200447321, -0.007058176212012768, -0.015867002308368683, 0.017478711903095245, -0.04996299743652344, 0.040542833507061005, -0.0608559288084507, 0.024995392188429832, 0.004668400157243013, 0.04804561659693718, 0.006644828245043755, -0.001065499847754836, 0.014588749967515469, 0.03231755644083023, -0.05193595215678215, 0.01243517268449068, 0.08264179527759552, -0.01617267169058323, 0.04376625269651413, -0.01770101673901081, 0.04860137775540352, -0.012289285659790039, -0.008857455104589462, -0.02898298390209675, 0.0623009093105793, -0.034818485379219055, -0.021049482747912407, -0.009267330169677734, 0.02202206663787365, -0.04729533940553665, 0.015380711294710636, 0.07708417624235153, -0.016728432849049568, -0.025731775909662247, -0.023078013211488724, 0.0032095250207930803, -0.021132847294211388, -0.026287538930773735, -0.023480940610170364, 0.00924648903310299, -0.013164610601961613, -0.030816998332738876, -0.01838182471692562, 0.004039694555103779, -0.05746578052639961, 0.048073407262563705, 0.011059662327170372, 0.005092168692499399, -0.03412378206849098, 0.005838973447680473, 0.015992049127817154, -0.0379585400223732, -0.024759193882346153, 0.010100972838699818, -0.007238798774778843, -0.012796417810022831, -0.005484675522893667, 0.007176275830715895, 0.007780666928738356, 0.030761422589421272, 0.01171268243342638, -0.013748160563409328, -0.00882966723293066, 0.030289024114608765, -0.016269929707050323, -0.0586884580552578, 0.026676572859287262, 0.03840314969420433, -0.04315491393208504, -0.004432201385498047, -0.013310497626662254, 0.0005383943789638579, 0.048795897513628006, -0.001554396585561335, 0.029649898409843445, -0.03676364943385124, -0.010621999390423298, 0.0136161670088768, -0.022647298872470856, -0.055603981018066406, 0.007054702844470739, -0.033456865698099136, 0.07035946100950241, -0.008100230246782303, 0.015714168548583984, 0.011525113135576248, 0.010608105920255184, -0.02838554047048092, 0.015255664475262165, 0.007461103610694408, 0.025134332478046417, 0.004352310672402382, -0.04893483594059944, 0.04132089763879776, -0.002811807906255126, 0.026412585750222206, -0.01435255166143179, 0.02142462134361267, -0.021549668163061142, 0.013032617047429085, -0.0223833117634058, 0.03512415289878845, -0.023758821189403534, 0.013643954880535603, -0.03712489455938339, -0.025731775909662247, 0.013900995254516602, -0.02606523409485817, 0.009725833311676979, -0.0372360497713089, -0.00046241129166446626, -0.030011143535375595, -0.016547810286283493, -0.01293535903096199, -0.0006725587300024927, -0.01443591620773077, -0.03876439481973648, -0.010740099474787712, -0.011740470305085182, -0.03995928168296814, 0.010837357491254807, -0.006186324637383223, -0.021855337545275688, -0.037736233323812485, -0.017145255580544472, -0.027204545214772224, -0.03123381920158863, 0.010323277674615383, 0.03776402398943901, -0.011024926789104939, -0.08186373114585876, -0.0004558984364848584, -0.0011957564856857061, 0.00035516658681444824, 0.03495742380619049, -0.011684894561767578, 0.03451281413435936, 0.010879039764404297, 0.08147469907999039, 0.028413327410817146, -0.030400177463889122, -0.03367917239665985, 0.01419277023524046, 0.007808454800397158, 0.04159877821803093, 0.0040640090592205524, 0.013769001699984074, -0.030261237174272537, -0.0018635392189025879, 0.013546696864068508, -0.0401260107755661, -0.024217326194047928, 0.026523737236857414, 0.004692714661359787, -0.034651756286621094, 0.023689351975917816, 0.006575358100235462, 0.019965747371315956, 0.001095892977900803, -0.011802993714809418, -0.0035412453580647707, 0.036902591586112976, -0.02906634844839573, 0.017548182979226112, -0.06774737685918808, 0.0021483672317117453, 0.01439423393458128, 0.016408869996666908, 0.0027180230244994164, 0.007447209674865007, -0.019757336005568504, 0.025203803554177284, -0.01285199448466301, -0.008579574525356293, 0.0019347461638972163, 0.03484627231955528, 0.0058181327767670155, -0.03240092098712921, -0.012053086422383785, -0.00989256240427494, 0.004532933235168457, 0.018451295793056488, 0.022452780976891518, 0.02061876654624939, 0.014026041142642498, -0.02261951006948948, 0.03859766572713852, 0.03995928168296814, 0.04596151039004326, 0.030483542010188103, -0.05991113558411598, -0.04968511685729027, -0.038542088121175766, -0.05729905515909195, 0.019159892573952675, -0.009996767155826092, 0.02121621184051037, 0.013678690418601036, 0.02221658267080784, 0.03270658850669861, 0.02482866309583187, 0.01099019218236208, 0.030622482299804688, -0.05574291944503784, 0.021910913288593292, -0.01706189103424549, -0.000932637951336801, 0.03415156900882721, 0.03676364943385124, 0.07647284120321274, -0.00878798495978117, -0.03487405925989151, -0.010427483357489109, -0.018117837607860565, -0.024481313303112984, 0.019548924639821053, 0.009663309901952744, 0.016367187723517418, -0.009253435768187046, -0.06530202180147171, -0.007808454800397158, 0.030038932338356972, -0.021591350436210632, -0.010552529245615005, -0.06146726757287979, 0.005144271068274975, 0.002499191788956523, 0.0007585281855426729, 0.0066969310864806175, -0.015714168548583984, 0.013914888724684715, -0.004244631621986628, -0.018993163481354713, 0.031289394944906235, -0.02670435979962349, 0.019632289186120033, -0.07758436352014542, 0.007148487493395805, 0.005623615812510252, -0.03520751744508743, -0.022633403539657593, 0.01547796931117773, 0.02391165681183338, 0.028413327410817146, -0.01239349041134119, -0.057076748460531235, 0.0724157765507698, -0.01974344253540039, 0.005901496857404709, -0.028177129104733467, 0.045350171625614166, 0.026815513148903847, -0.028649527579545975, -0.04712861031293869, -0.010302436538040638, 0.03740277513861656, 0.025578942149877548, -0.0307892095297575, 0.00919091235846281, 0.012574112974107265, 0.01601983793079853, -0.047184187918901443, 0.02302243746817112, -0.025037074461579323, -0.017047997564077377, -0.008843561634421349, -0.01409551128745079, -0.027412956580519676, -0.01543628703802824, 0.010149601846933365, 0.025648413226008415, -0.0010681049898266792, -0.008760197088122368, -0.0601334385573864, 0.02766305021941662, 0.0988144651055336, 0.0077737197279930115, -0.017603758722543716, -0.005255423486232758, -0.025967976078391075, -0.01966007798910141, -0.01413719356060028, 0.038375359028577805, -0.016506128013134003, 0.0032894157338887453, 0.009948138147592545, -0.020966118201613426, -0.010656734928488731, 0.0062245335429906845, -0.00013221055269241333, 0.0659133642911911, -0.014130246825516224, -0.008093282580375671, 0.03015008382499218, 0.00767646124586463, -0.0329011045396328, -0.015200088731944561, 0.0027683889493346214, -0.027135076001286507, 0.011413960717618465, -0.00871156807988882, 0.0034300931729376316, -1.4789562555961311e-05, 0.01693684421479702, -0.0054395198822021484, 0.02727401629090309, -0.01802057959139347, 0.008718514814972878, 0.007103331852704287, 0.031178243458271027, 0.0001374208222841844, -0.009239542298018932, -0.051991526037454605, -0.03504078835248947, 0.002895172219723463, -0.03381811082363129, -0.02110505849123001, -0.05791039019823074, 0.007794560864567757, -0.012039192952215672, 0.041181959211826324, -0.013338286429643631, -0.01125417836010456, -0.021243998780846596, -0.02498149871826172, 0.012060033157467842, 0.0020997379906475544, -0.026607101783156395, -0.04457210749387741, 0.018090050667524338, 0.0026554998476058245, 0.022855708375573158, 0.027079500257968903, 0.02530106157064438, -0.019187679514288902, -0.024578571319580078, 0.05151912942528725, -0.018131732940673828, 0.009857826866209507, 0.04279366880655289, 0.01425529271364212, -0.00015413708752021194, -0.006832398008555174, -0.026176385581493378, -0.05157470703125, -0.016547810286283493, 0.0009552157716825604, 0.039264578372240067, 0.02078549563884735, 0.019437773153185844, 0.013518908992409706, 0.003219945589080453, 0.02282792143523693, -0.0329011045396328, -0.030844787135720253, 0.01203224528580904, 0.0009239541832357645, -0.026398690417408943, 0.04268251359462738, 0.027315698564052582, -0.04123753309249878, 0.004817761015146971, 0.008933872915804386, -0.012581060640513897, 0.0026468161959201097, -0.007211010903120041, 0.04284924268722534, -0.006401682738214731, 0.0027093393728137016, -0.021174529567360878, -0.05051875859498978, -0.011066609062254429, 0.005436046048998833, -0.036180101335048676, -0.02534274384379387, -0.006745560094714165, -0.011163867078721523, -0.011615424416959286, -0.03923679143190384, 0.00385907175950706, 0.04248799756169319, -0.02657931298017502, -0.00027397324447520077, 0.0042168437503278255, -0.01617267169058323, 0.006259268615394831, -0.006127275060862303, 0.010406642220914364, 0.017603758722543716, -0.0164505522698164, 0.024078385904431343, 0.0016429711831733584, 0.016950737684965134, -0.02823270484805107, -0.021730290725827217, -0.0018687493866309524, -0.0362078882753849, 0.02555115334689617, -0.0020181103609502316, 0.0010984981199726462, 0.0007224904838949442, 0.0007007810636423528, -0.007738984655588865, -0.011608476750552654, -0.010455271229147911, -0.014588749967515469, -0.006801136303693056, -0.015589121729135513, 0.05565955489873886, -0.029927778989076614, 0.002077160170301795, -0.00437315134331584, 0.043071549385786057, -0.01981291174888611, 0.021091165021061897, 0.0004663189756684005, -0.009559105150401592, -0.002749284729361534, 0.02751021459698677, 0.003862545359879732, -0.025162121281027794, 0.028135446831583977, 0.00973278097808361, -0.02682940661907196, 0.024800876155495644, 0.007565309293568134, -0.015950366854667664, 0.004098744131624699, -0.026884982362389565, -0.05074106156826019, 0.042988184839487076, 0.01471379678696394, 0.015686379745602608, -0.057076748460531235, 0.02670435979962349, 0.022313840687274933, -0.013782895170152187, 0.009253435768187046, -0.011934987269341946, -0.044822197407484055, -0.012615795247256756, -0.04004264622926712, 0.016867375001311302, 0.02606523409485817, 0.03248428553342819, -0.010142655111849308, -0.004824708215892315, -0.017951110377907753, 0.020035216584801674, -0.036374617367982864, -0.02138293907046318, -0.0004374454147182405, -0.017909428104758263, -0.01881254091858864, 0.0050748009234666824, 0.021118951961398125, -0.01309514045715332, 0.018159519881010056, 0.009204806759953499, -0.018090050667524338, 0.017645440995693207, 0.04537796229124069, 0.02402280829846859, 0.00955215748399496, -0.033734750002622604, -0.00650588795542717, -0.05382554233074188, -0.019451666623353958, -0.015867002308368683, -0.01175436470657587, -0.009156177751719952, 0.0020007428247481585, -0.01143480185419321, -0.013247974216938019, -0.018826434388756752, 0.0016221300465986133, 0.03879218176007271, -0.028816254809498787, -0.009475740604102612, -0.006200219038873911, 0.002294254722073674, -0.000752015330363065, 0.015880897641181946, -0.023161377757787704, 0.014310869388282299, -0.007884872145950794, -0.031372759491205215, 0.04070955887436867, -0.010100972838699818, -0.01293535903096199, 0.002912539755925536, 0.00022230476315598935, -0.02859394997358322, -0.004487777594476938, -0.044349800795316696, -0.017409242689609528, -0.03126160800457001, 0.0731382668018341, 0.04671178758144379, -0.055715132504701614, -0.018715282902121544, 0.0035273514222353697, 0.009941191412508488, -0.008371164090931416, -0.030205659568309784, 0.009684151038527489, 0.013178504072129726, -0.021549668163061142, -0.03159506618976593, -0.018882011994719505, -0.03595779463648796, -0.03298446908593178, -0.024522993713617325, 0.001945166732184589, 0.010434430092573166, -0.010274648666381836, -0.056604351848363876, -0.0009065866470336914, 0.02587071806192398, -0.012178133241832256, 0.009239542298018932, 0.020688237622380257, 0.004564194940030575, -0.02546779066324234, 0.0037270784378051758, 0.018590236082673073, -0.031178243458271027, -0.0037479193415492773, -0.03262322396039963, -0.002091054106131196, -0.010003714822232723, -0.05529830977320671, -0.025523366406559944, 0.04701745882630348, 0.011976669542491436, 0.011802993714809418, 0.03087257407605648, 0.04304375872015953, -0.016825692728161812, -0.00735689839348197, -0.017603758722543716, 0.012671371921896935, -0.003810442751273513, 0.011066609062254429, 0.024717511609196663, -0.010205178521573544, 0.015019466169178486, -0.008489263243973255, -0.01337302103638649, -0.02998335473239422, 0.02518990822136402, -0.005665298085659742, 0.000351258902810514, 0.002992430469021201, 0.01265053078532219, -0.009559105150401592, -0.024092279374599457, -0.018437402322888374, 0.04515565559267998, -0.011747417040169239, -0.005804238375276327, 0.009989820420742035, 0.05841057747602463, 0.013067351654171944, 0.047350917011499405, 0.004571141675114632, 0.011747417040169239, -0.0325954370200634, 0.0061585367657244205, -0.01041358895599842, -0.009468793869018555, -0.0058980234898626804, 0.05004636198282242, -0.021035589277744293, -0.019590606912970543, 0.0005978782428428531, -0.0051060626283288, -0.00020797652541659772, 0.0028725943993777037, -0.04459989443421364, -0.01499167736619711, -0.01227539125829935, 0.01281031221151352, -0.014658220112323761, 0.012039192952215672, 0.03965361416339874, -0.0004611087206285447, -0.12115609645843506, -0.009364588186144829, 0.01746481843292713, 0.010587264783680439, -0.038819968700408936, 0.011705735698342323, 0.017687123268842697, 6.947023939574137e-05, -0.009093654341995716, -0.010615052655339241, 0.005866761785000563, -0.002516559325158596, -0.005717400927096605, 0.009183965623378754, -0.00109328783582896, -0.043377216905355453, -0.0028343857266008854, 0.02606523409485817, 0.009079759940505028, -0.005998755339533091, -0.04885147139430046, -0.0034405135083943605, -0.012928411364555359, 0.0054395198822021484, -0.07135982811450958, -0.04729533940553665, 0.010726205073297024, -0.0032807320822030306, 0.02006300538778305, 0.008801879361271858, 0.006530202459543943, 0.02074381336569786, 0.03267880156636238, 0.002681551268324256, -0.031011514365673065, 0.004341890104115009, -0.00712764635682106, -0.0057139270938932896, -0.009017237462103367, -0.005370049737393856, -0.025634517893195152, -0.04143204912543297, 0.02887183241546154, -0.00010230578482151031, -0.0003677580680232495, 0.00359855848364532, 0.029733262956142426, -0.008836614899337292, 0.027010029181838036, -0.018506871536374092, -0.012963146902620792, -0.0062106396071612835, -0.012046139687299728, -0.010621999390423298, 0.024092279374599457, -0.021243998780846596, -0.019284939393401146, 0.0074541568756103516, 0.01211560983210802, 0.05504821613430977, -0.024370159953832626, 0.016561705619096756, -0.0043766251765191555, -0.03015008382499218, -0.0223833117634058, -0.03292889520525932, -0.011365330778062344, 0.015144512057304382, -0.005717400927096605, -0.016367187723517418, -0.004578088875859976, 0.0012374386424198747, 0.006620513740926981, 0.01677011512219906, 0.003782654646784067, 0.0062384274788200855, -0.023717138916254044, 0.03312341123819351, -0.022161006927490234, 0.004991436842828989, 0.03342907875776291, -0.009628575295209885, 0.0007541863014921546, -0.0048629166558384895, 0.00030284683452919126, 0.01733977161347866, 0.013025670312345028, -0.02061876654624939, -0.023272531107068062, 0.031650640070438385, 0.041459839791059494, -0.005144271068274975, 0.022688981145620346, 1.8554795815362013e-06, 0.016561705619096756, -0.0150333596393466, 0.01677011512219906, 0.02995556779205799, 0.031483910977840424, 0.005804238375276327, 0.0020042164251208305, 0.0058737085200846195, -0.015964260324835777, 0.0003608110419008881, 0.0017219935543835163, -0.01397741213440895, 0.016547810286283493, -0.020813284441828728, 0.02393944375216961, -0.061244964599609375, 0.00637736776843667, 0.005505516659468412, -0.016839586198329926, 0.03531866893172264, 0.01239349041134119, 0.03834757208824158, 0.01878475211560726, 0.029177499935030937, -0.0006608356488868594, -0.03704153001308441, 0.025787353515625, 0.01713136024773121, -0.011837729252874851, 0.015839215368032455, -0.009135336615145206, -0.05757693573832512, 0.007857084274291992, 0.012685265392065048, -0.02182754874229431, -0.010080131702125072, -0.003306783502921462, -0.010135708376765251, 0.015839215368032455, -0.006651775445789099, -0.005759082734584808, 0.01373426616191864, -0.0002629014488775283, 0.004029273986816406, -0.0011818624334409833, 0.05996670946478844, 0.005022698547691107, 0.008954714052379131, 0.03298446908593178, -0.0068428185768425465, -0.000425939419073984, 0.02462025359272957, -0.0119141461327672, -0.03304004669189453, 0.01033022440969944, 0.036735862493515015, 0.06141168996691704, -0.006349579896777868, -0.02323084883391857, 0.015283452346920967, -0.02353651635348797, -0.00969109870493412, -0.000932637951336801, -0.050713274627923965, -0.018326248973608017, 0.03270658850669861, 0.0013859312748536468, 0.04026494920253754, -0.000449385610409081, -0.00739858066663146, -0.0040917969308793545, -0.00871156807988882, -0.012358755804598331, -0.012212867848575115, -0.03140054643154144, 0.015380711294710636, -0.0023671984672546387, -0.04451652988791466, 0.030983727425336838, 0.017437029629945755, 0.028010400012135506, 0.02342536486685276, -0.011330596171319485, 0.007530573755502701, 0.004772605374455452, -0.008086335845291615, -0.0014484544517472386, 0.012372649274766445, -0.00903113093227148, 0.009698045440018177, -0.00830864068120718, -0.009093654341995716, 0.015783637762069702, -0.009253435768187046, 0.0300667192786932, 0.03998706862330437, 0.029927778989076614, 0.019187679514288902, -0.0002926433808170259, 0.023369789123535156, 0.04704524576663971, -0.026773830875754356, -0.020716024562716484, 0.025412213057279587, -0.005116483196616173, -0.01674232818186283, -0.006360000465065241, 0.0006964391795918345, -0.01865970715880394, -0.014366445131599903, -0.05113009735941887, 0.014477597549557686, -0.014019094407558441, -0.007870977744460106, 0.008183593861758709, 0.003612452419474721, -0.002973326249048114, 0.019007056951522827, -0.03376253694295883, 0.03251207247376442, -0.0067907157354056835, -0.05240834876894951, -0.0009743201080709696, 0.025884611532092094, -0.021869231015443802, -0.01443591620773077, 0.003027165774255991, -0.03556876257061958, 0.022286053746938705, 0.04493335261940956, -0.024495206773281097, -0.01419277023524046, 0.012761683203279972, -0.026537630707025528, 0.002782283117994666, 0.006339159328490496, -0.005099115427583456, 0.014852737076580524, -0.022994648665189743, -0.003155685728415847, -0.029649898409843445, -0.01393572986125946, -0.018756965175271034, -0.020549297332763672, -0.008009918965399265, 0.01439423393458128, 0.0447666235268116, 0.023633776232600212, -0.0321786142885685, -0.0033884108997881413, 0.024120066314935684, 0.00919091235846281, -0.016269929707050323, 0.022522252053022385, -0.04112638160586357, -0.024120066314935684, 0.003647187491878867, 0.01989627629518509, 0.03634683042764664, -0.019243257120251656, 0.019604502245783806, 0.020799389109015465, 0.018909798935055733, 0.037291623651981354, 0.021160634234547615, 0.018284566700458527, -0.01175436470657587, 0.0046301912516355515, 0.01593647338449955, -0.016325505450367928, -0.01770101673901081, -0.03695816919207573, -0.02542610839009285, 0.02178586646914482, 0.003006324637681246, 0.024592464789748192, -0.017548182979226112, 0.01543628703802824, 0.003365833079442382, 0.021327363327145576, 0.012421279214322567, 0.008294746279716492, 0.035013001412153244, -0.022202689200639725, 0.02174418419599533, 0.00016835678252391517, -0.02523159049451351, -0.02498149871826172, -0.051074519753456116, -0.019354408606886864, 0.023050226271152496, -0.0028830149676650763, -0.01949334889650345, 0.01511672418564558, 0.03787517547607422, -0.005852867849171162, 0.017895532771945, 0.03887554630637169, -0.0052415295504033566, 0.03212304040789604, 0.020479826256632805, -0.004130005836486816, 0.017867745831608772, 0.03998706862330437, -0.01906263455748558, -0.01024685986340046, 0.018756965175271034, -0.0054395198822021484, 0.004317575599998236, -0.002172681735828519, -0.006186324637383223, 0.016436658799648285, 0.013109033927321434, -0.011545953340828419, -0.03190073370933533, -0.008155805990099907, 0.008086335845291615, 0.02570398896932602, 0.009079759940505028, 0.014699902385473251, -0.0054395198822021484, 0.0004532933235168457, -0.00969109870493412, -0.0066309343092143536, 0.010226019658148289, -0.023647669702768326, 0.02242499403655529, 0.021327363327145576, -0.0066309343092143536, 0.01507504191249609, -0.015200088731944561, -0.05138018727302551, -0.014894419349730015, -0.02698224037885666, -0.004251578822731972, 0.03834757208824158, 0.03278995305299759, 0.017548182979226112, -0.00024553388357162476, -0.012122556567192078, -0.038375359028577805, 0.02438405342400074, -0.006349579896777868, 0.003044533310458064, -0.011518165469169617, 0.0019364829640835524, 0.03495742380619049, 0.03126160800457001, 0.011490377597510815, -0.015325134620070457, -0.02378660999238491, 0.0005579328862950206, 0.0005522884312085807, 0.0076000443659722805, -0.009663309901952744, -0.018159519881010056, 0.08936651796102524, -0.02070213109254837, -0.015061147511005402, 0.004123058635741472, -0.002370671834796667, 0.008697673678398132, 0.014866631478071213, -0.017714910209178925, -0.02270287461578846, 0.015741955488920212, -0.015144512057304382, 0.03520751744508743, -0.004477357026189566, 0.008301693946123123, 0.05674329027533531, 0.0007893556030467153, -0.002943801460787654, 0.030122295022010803, 0.02257782779633999, 0.02029920369386673, 0.023800503462553024, 0.008906085044145584, -0.009538264013826847, -0.013449437916278839, -0.023286424577236176, -0.015408499166369438, 0.00343356654047966, 0.014422021806240082, 0.015464074909687042, 0.05757693573832512, -0.04037610441446304, -0.0036367669235914946, -0.015741955488920212, 0.01674232818186283, 0.0007728564087301493, 0.020799389109015465, -0.030566904693841934, 0.0265098437666893, -0.002236941596493125, 0.001028159516863525, -0.009496581740677357, 0.010177389718592167, -0.02110505849123001, -0.0026746043004095554, -0.014213611371815205, 0.003216471988707781, 0.016047624871134758, 0.020313097164034843, -0.021271787583827972, -0.0007081622607074678, -0.008822720497846603, 0.024356266483664513, 0.019562819972634315, -0.004268946126103401, -0.014866631478071213, 0.0025391371455043554, -0.01649223454296589, 0.009718886576592922, 0.011823834851384163, 0.015491863712668419, -0.023953339084982872, 0.004439148120582104, -0.018187308683991432, 0.020952224731445312, 0.018048368394374847, -0.015339029021561146, 0.01881254091858864, 0.024245113134384155, -0.0329011045396328, 0.026607101783156395, -0.015450181439518929, 0.007655620574951172, -0.011288913898169994, -0.012629689648747444, -0.006509361322969198, 0.015880897641181946, -0.013268815353512764, 0.011441748589277267, 0.003695816732943058, 0.03292889520525932, -0.03203967586159706, -0.0014623485039919615, 0.00964941643178463, -0.0028083345387130976, 0.012921464629471302, -0.007586149964481592, 0.01377594843506813, -0.019396090880036354, -0.02851058542728424, 0.0004344061017036438, -0.012657477520406246, 0.02770473062992096, 0.02121621184051037, -0.02570398896932602, 0.00490459892898798, -0.03351244330406189, -0.00303758610971272, -0.026690466329455376, -0.009315959177911282, 0.014977783896028996, -0.004654506221413612, -0.01479716133326292, -0.006721245590597391, 0.006637881509959698, 0.0009430585196241736, 0.009593839757144451, -0.041626568883657455, 0.021243998780846596, 0.009385429322719574, 0.012171185575425625, -0.013755107298493385, -0.029010772705078125, 0.02270287461578846, -0.018006686121225357, 0.003793074982240796, 0.021730290725827217, 0.0005110404454171658, 0.028052082285284996, 0.023842185735702515, -0.0189792700111866, 0.01957671344280243, 0.02391165681183338, 0.022244371473789215, 0.01325492188334465, -0.010962403379380703, 0.009072813205420971, 0.0019052213756367564, 0.04143204912543297, -0.020854966714978218, 0.002601660555228591, -0.003338044974952936, -0.006679563317447901, 0.02261951006948948, -0.01429697498679161, 3.449088762863539e-05, 0.02670435979962349, 0.0076000443659722805, -0.021049482747912407, -0.023078013211488724, -0.0029854835011065006, 0.009864773601293564, -0.021160634234547615, 0.011045767925679684, 0.042988184839487076, 0.009823092259466648, 0.013866259716451168, 0.020813284441828728, -0.021674714982509613, -0.0017445713747292757, -0.01439423393458128, 0.008489263243973255, 0.027760308235883713, -0.043821826577186584, 0.010073184967041016, -0.00018865511810872704, 0.021605243906378746, 0.004348836839199066, -0.01925715059041977, 0.014824949204921722, -0.016839586198329926, 0.035457611083984375, 0.0048629166558384895, 0.014852737076580524, 0.013109033927321434, 0.06708046048879623, 0.009079759940505028, -0.02763526141643524, 0.005109535995870829, -0.005998755339533091, -0.008454527705907822, -0.03042796440422535, -0.009503528475761414, -0.005203321110457182, -0.019284939393401146, -0.007565309293568134, -0.017186937853693962, -0.012358755804598331, 0.00846842210739851, -0.015102829784154892, 0.003629819955676794, -0.029816627502441406, -0.008260011672973633, -0.004393992479890585, 0.018909798935055733, -0.035902220755815506, -0.021521879360079765, 0.014811054803431034, 0.027676943689584732, -0.004824708215892315, -0.007176275830715895, 0.01053168810904026, -0.030928149819374084, 0.04768437147140503, -0.030094508081674576, 0.008454527705907822, 0.00798907782882452, -0.0028569635469466448, 0.020604873076081276, 0.03687480464577675, 0.005717400927096605, -0.0006938340375199914, -0.017589865252375603, -0.00020059531379956752, 0.025995763018727303, 0.0028361226432025433, 0.0029003825038671494, 0.0018096996936947107, -0.0033970947843044996, -0.00536657590419054, 0.008176647126674652, 0.037263836711645126, -0.008371164090931416, -0.030816998332738876, 0.005821606144309044, 0.014741584658622742, 0.011059662327170372, -0.02142462134361267, -0.017409242689609528, -0.008933872915804386, -0.03670807555317879, 0.012136450968682766, -0.003254680661484599, 0.02698224037885666, 0.02518990822136402, -0.014164981432259083, 0.032651010900735855, -0.0035273514222353697, 0.014310869388282299, 0.0008636019192636013, 0.0035256147384643555, -0.010156548582017422, -0.044988926500082016, -0.008051600307226181, -0.01024685986340046, 0.0038034955505281687, -0.0008909557946026325, -0.0019225889118388295, -0.01942387968301773, 0.0033467288594692945, 0.009781409986317158, -0.0013468542601913214, 0.02418953739106655, -0.000587891903705895, -0.024689722806215286, -3.294409179943614e-05, 0.024912027642130852, 0.03203967586159706, 0.018034474924206734, -0.03520751744508743, 0.03676364943385124, -0.021313469856977463, -0.0031800002325326204, 0.017006315290927887, -0.02898298390209675, 0.019090421497821808, -0.015992049127817154, 0.015491863712668419, -0.024481313303112984, 0.03153948858380318, 0.007551414892077446, -0.025842929258942604, 0.016033731400966644, 0.024120066314935684, -0.034457240253686905, -0.0265098437666893, 0.03334571421146393, -0.013498067855834961, 0.011747417040169239, -0.006123801693320274, -0.005970967002213001, 0.0014996888348832726, 0.006339159328490496, 0.017367560416460037, -0.012990934774279594, 0.016964633017778397, 0.0171730425208807, -0.03315119817852974, -0.01309514045715332, 0.017228620126843452, -0.029177499935030937, 0.02970547415316105, 0.010316330939531326, 0.011400066316127777, -0.023480940610170364, 0.006745560094714165, -0.0007055571186356246, -0.02274455688893795, -0.007006073836237192, -0.008774091489613056, 0.0019399564480409026, 0.0006686510751023889, -0.0010272911749780178, 0.012782524339854717, -0.032373130321502686, -0.006491994019597769, 0.0037687604781240225, 0.005033118650317192, -0.012428225949406624, 0.0011575478129088879, 0.02859394997358322, -0.0281076580286026, 0.0009335063514299691, -0.011288913898169994, 0.008023812435567379, 0.030650269240140915, 0.03923679143190384, 0.0038069691509008408, 0.00830864068120718, -0.041265323758125305, 0.012678318656980991, 0.00490459892898798, -0.002309885574504733, -0.01906263455748558, 0.029010772705078125, -0.011295860633254051, -0.01857634261250496, -0.022633403539657593, -0.014477597549557686, -0.0013016986194998026, 0.03876439481973648, 0.004345363471657038, -0.016228247433900833, -0.012997881509363651, -0.011802993714809418, 0.03859766572713852, -0.044183071702718735, 0.013303550891578197, 0.01135143730789423, -0.0014093774370849133, -0.012185079976916313, 0.00454335380345583, -0.007322163321077824, 0.02221658267080784, -0.03170621767640114, 0.01265053078532219, 0.04632275551557541, 0.014922207221388817, -0.0037236048374325037, 0.03406820446252823, -0.025884611532092094, 0.00023467915889341384, -0.007019967772066593, -0.025050967931747437, -0.04168214276432991, -0.01938219740986824, 0.03915342688560486, 0.006620513740926981, 0.014164981432259083, -0.031178243458271027, 0.0017619389109313488, 0.010608105920255184, 0.024536889046430588, -0.036180101335048676, -0.02353651635348797, 0.028844043612480164, 0.011782152578234673, 0.037263836711645126, -0.026968346908688545, -0.025565048679709435, -0.024397948756814003, -0.02923307754099369, 0.03567991405725479, -0.0022473621647804976, 0.001960797468200326, 0.0036680286284536123, 0.031178243458271027, 0.007120699621737003, -0.05774366483092308, -0.014449809677898884, -0.013900995254516602, 0.01249074935913086, 0.02293907292187214, -0.0016976789338514209, 0.0579659678041935, 0.02289739064872265, 0.004161267541348934, 0.011122185736894608, -0.0006261005182750523, 0.027315698564052582, 0.007190169766545296, 0.015797533094882965, -0.040542833507061005, 0.020813284441828728, -0.03095593862235546, 0.01253243163228035, 0.022161006927490234, -0.019076528027653694, -0.002549557713791728, 0.013942677527666092]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" gradient =1
B+ 1X
k∈[B+1]∂(L(k)
1+L(k)
2)
∂θ+1
BX
k∈[B]∂(L(k)
3+L(k)
4)
∂θ
We claim that this leads to reduced gradient variance, unless gradients of early and later losses have a strong negative
correlation. In the formal analysis of variance below, we consider scalars for notational simplicity, though it can be easily
generalized to vectors or tensors by replacing scalar multiplication with inner product.
Proposition C.2. Consider two distributions AandBwith means a⋆andb⋆, respectively. Let a1, . . . , a N, aN+1be
independent and identically distributed (i.i.d.) samples of A, and b1, . . . , b Nbe i.i.d. samples of B, but for each i,aican be
correlated with bi. Consider two estimates of a⋆+b⋆, defined as follows:
be:=baN+bbN,be+:=baN+1+bbN,where
bak:=1
kX
i∈[k]ai,bbk:=1
kX
i∈[k]bi, k∈ {N, N + 1}.
Then it holds that
E[be] =E[be+] =a⋆+b⋆,var(be)−var(be+) =1
N(N+ 1)var(a1) +2
N(N+ 1)cov(a1, b1).
In this proposition, baN,baN+1andbbNcorrespond to1
BP
k∈[B]∂(L(k)
1+L(k)
2)
∂θ,1
B+1P
k∈[B+1]∂(L(k)
1+L(k)
2)
∂θand
1
BP
k∈[B]∂(L(k)
3+L(k)
4)
∂θin our previous analysis of accumulated gradients, respectively. Hence our claim on gradient
variance follows immediately from the conclusion of this proposition.
Proof of Proposition C.2. First, unbiasedness is obvious. As for variance, we have the following elementary calculation:
var(be) =E
(baN+bbN−a⋆−b⋆)2
=E
(baN−a⋆)2
+E
(bbN−b⋆)2
+ 2E
(baN−a⋆)(bbN−b⋆)
,
var(be+) =E
(baN+1+bbN−a⋆−b⋆)2
=E
(baN+1−a⋆)2
+E
(bbN−b⋆)2
+ 2E
(baN+1−a⋆)(bbN−b⋆)
.
23
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
Moreover,
E
(baN−a⋆)2
=1
Nvar(a1),E
(baN+1−a⋆)2
=1
N+ 1var(a1),
and
E
(baN−a⋆)(bbN−b⋆)
=1
N2X
i∈[N]E
(ai−a⋆)(bi−b⋆)
=1
Ncov(a1, b1),
E
(baN+1−a⋆)(bbN−b⋆)
=1
N(N+ 1)X
i∈[N]E
(ai−a⋆)(bi−b⋆)
=1
N+ 1cov(a1, b1).
Putting things together,
var(be)−var(be+) =E
(baN−a⋆)2
−E
(baN+1−a⋆)2
+ 2
E
(baN−a⋆)(bbN−b⋆)
−E
(baN+1−a⋆)(bbN−b⋆)
=1
N(N+ 1)var(a1)","[0.009187611751258373, -0.012591703794896603, 0.06266281008720398, 0.002537596272304654, -0.006368060130625963, 0.014565389603376389, 0.017343679443001747, -0.03980381414294243, -0.019296735525131226, 0.05292504280805588, 0.01860903948545456, -0.011264451779425144, -0.032926857471466064, 0.023615462705492973, -0.0066706459037959576, -0.014826714061200619, 0.022185055539011955, 0.0051336465403437614, -0.020823419094085693, 0.03394464775919914, -0.015803242102265358, -0.025884857401251793, 0.05908679589629173, 0.040188923478126526, 0.006790992803871632, -0.04695584625005722, 0.020232001319527626, -0.00931139662861824, 0.0541628934442997, -0.05985701456665993, 0.053200121968984604, -0.024578236043453217, -0.007901621051132679, -0.03776823356747627, -0.007846605032682419, 0.059416886419057846, 0.01716487854719162, 0.043902479112148285, -0.0032785881776362658, -0.013733278028666973, 0.009730890393257141, -0.023973064497113228, -0.05410787835717201, -0.0026579429395496845, 0.006271782796829939, 0.008933164179325104, 0.017618758603930473, -0.0055703334510326385, -0.011766469106078148, 0.055180683732032776, -0.036337826400995255, 0.000651161652058363, -0.0167660154402256, -0.012254733592271805, -0.012894289568066597, 0.005157716106623411, -0.010171015746891499, 0.007399603258818388, 0.006863200571388006, -0.062002621591091156, 0.02108474262058735, -0.02057584747672081, 0.03311941400170326, 0.0015172280836850405, -0.0006838271510787308, -0.03650287538766861, -0.04340733587741852, 0.0071726636961102486, 0.03735561668872833, -0.0007379832095466554, -0.014331573620438576, 0.009462689980864525, 0.07630668580532074, 0.005577210336923599, -0.0240830946713686, 0.03565013408660889, 0.02358795516192913, 0.04970662668347359, 0.016518445685505867, -0.009166980162262917, 0.03248673304915428, 0.009937199763953686, 0.06392817199230194, 0.005474055651575327, -0.0008931444608606398, -0.07438114285469055, 0.03534754738211632, 0.03413720428943634, -0.0357876718044281, 0.008046036586165428, -0.0018705317052081227, -0.0056631723418831825, -0.023202845826745033, 0.0027026431635022163, 0.08400887995958328, 0.05804149806499481, 0.0337245836853981, -0.027645356953144073, 0.005625349003821611, 0.016889801248908043, -0.008266099728643894, 0.009600228630006313, 0.04134425148367882, -0.00976527575403452, 0.03188156336545944, -0.03702552244067192, -0.04888139292597771, -0.020438309758901596, -0.013788294047117233, 0.01695857010781765, -0.009799660183489323, 0.023010289296507835, 0.01955805905163288, 0.030478663742542267, -0.011395113542675972, -0.030946295708417892, -0.06975983083248138, 0.02411060221493244, -0.005498125217854977, -0.0177975594997406, 0.010879342444241047, -0.035512592643499374, 0.004559420980513096, -0.026407506316900253, -0.007165786810219288, -0.010693664662539959, 0.02690264582633972, -0.04329730570316315, -0.006770361680537462, -0.03350452333688736, 0.037603188306093216, 0.010411709547042847, 0.01871906965970993, -0.02657255344092846, -0.0359802283346653, -0.005566894542425871, -0.01830645278096199, 0.01777005009353161, -0.0011931515764445066, 0.01396709494292736, 0.009675875306129456, 0.025816088542342186, -0.02781040407717228, -0.011326344683766365, -0.024660758674144745, 0.048771362751722336, -0.004040210973471403, 0.014978007413446903, -0.006828816141933203, -0.03515499085187912, -0.02130480483174324, 0.012165333144366741, -0.0395287349820137, -0.0066603305749595165, 0.006034527905285358, -0.029543397948145866, 0.012213471345603466, 0.034082185477018356, 0.06964979320764542, -0.029763460159301758, 0.01065240241587162, 0.023134075105190277, 0.03565013408660889, -0.008266099728643894, 0.02173117734491825, 0.02357420139014721, -0.060957327485084534, -0.0052436781115829945, -0.06788929551839828, -0.08213834464550018, 0.002723274054005742, 0.028168005868792534, -0.05897676199674606, -0.05160466581583023, 0.03512748330831528, -0.007874113507568836, -0.014978007413446903, -0.0944618508219719, 0.019695598632097244, -0.053420182317495346, -0.007406480144709349, 0.06156249716877937, 0.03917113319039345, 0.03009355254471302, -0.036365337669849396, 0.04632316529750824, 0.016105826944112778, 0.005838534329086542, -0.0023192530497908592, -0.009228873066604137, 0.009242626838386059, 0.02793418988585472, 0.0573262944817543, 0.016394659876823425, 0.029240811243653297, -0.034384772181510925, 0.037905775010585785, 0.04522285237908363, -0.0125573193654418, 0.009840922430157661, 0.04547042399644852, 0.02811299078166485, 0.020754648372530937, -0.03498994559049606, 0.0014286873629316688, -0.03383461758494377, 0.012392272241413593, 0.0171511247754097, -0.029543397948145866, -0.032431717962026596, -0.001653047977015376, -0.0554557628929615, 0.0007259485428221524, 0.01257107313722372, -0.028690654784440994, 0.023725492879748344, -0.0436549074947834, 0.05881171673536301, -0.0015103511977940798, 0.033972155302762985, 0.00785348191857338, -0.007798466365784407, 0.008231714367866516, 0.02948838099837303, -0.05204479396343231, 0.008802501484751701, 0.09072078764438629, -0.038098327815532684, 0.03413720428943634, -0.02771412767469883, 0.05705121532082558, -0.01065240241587162, 0.009228873066604137, -0.012082809582352638, 0.06068224832415581, -0.03306439891457558, -0.007433988153934479, -0.005546263884752989, -0.0036894860677421093, -0.02625621296465397, 0.010948111303150654, 0.0618375763297081, 0.011759592220187187, -0.015404378063976765, -0.02833305299282074, 0.012426656670868397, -0.022611426189541817, -0.019159195944666862, -0.030671218410134315, 0.019915660843253136, -0.012935551814734936, -0.0015739629743620753, -0.0046488214284181595, -0.004518159199506044, -0.06282785534858704, 0.029323333874344826, -0.01973685994744301, -0.008754363283514977, -0.013581985607743263, -0.0037513787392526865, -0.01594078168272972, -0.013822678476572037, -0.024949591606855392, 0.0070420014671981335, 0.002057928591966629, -0.014964253641664982, 0.01562444120645523, -0.011601422913372517, 0.024468204006552696, 0.010817449539899826, 0.011099404655396938, -0.015514410100877285, -0.016587214544415474, 0.01727491058409214, -0.004497528541833162, -0.03061620146036148, 0.012454165145754814, 0.033669568598270416, -0.010342939756810665, -0.025403469800949097, -0.005154277663677931, 0.03465985134243965, 0.05086195468902588, -0.0022642372641712427, 0.035925209522247314, -0.04448014125227928, -0.0357876718044281, 0.023409154266119003, -0.038620978593826294, -0.050091736018657684, 0.012075932696461678, -0.03102882020175457, 0.0288557019084692, -0.009187611751258373, 0.01643592119216919, -0.007117648143321276, 0.025375962257385254, -0.027136463671922684, -0.013313784264028072, 0.009648367762565613, 0.018595285713672638, -0.00047493967576883733, 0.0054603018797934055, 0.060352154076099396, -0.026613814756274223, 0.029515888541936874, -0.003189187729731202, 0.04767104983329773, -0.025073377415537834, 0.02710895426571369, 0.02356044575572014, 0.04547042399644852, -0.06216767057776451, 0.013169367797672749, -0.05853663757443428, -0.028800686821341515, 0.014757944270968437, -0.0341096967458725, -0.02006695419549942, -0.023092813789844513, -0.029213303700089455, -0.06161751225590706, -0.02317533642053604, -0.010686787776648998, -0.008706224150955677, 0.025307193398475647, -0.022308841347694397, -0.010528617538511753, -0.015349362976849079, -0.01788008213043213, -0.014022110030055046, -0.022927766665816307, -0.012804889120161533, 0.00018600013572722673, -0.02866314724087715, -0.0599670447409153, -0.014400343410670757, 0.055400747805833817, 0.0341096967458725, -0.012110317125916481, -0.06909964233636856, -0.02008070796728134, -0.0009404235170222819, -0.006034527905285358, 0.03133140504360199, -0.03493493050336838, 0.03754817321896553, 0.040106400847435, 0.09473692625761032, 0.0622226856648922, -0.011608299799263477, -0.0651935264468193, 0.01922796480357647, 8.209364750655368e-05, 0.02637999877333641, -0.020947203040122986, -0.0024155303835868835, -0.01903541013598442, 0.010067861527204514, -0.007076386362314224, 0.0032287302892655134, -0.029735952615737915, 0.05386031046509743, 0.02100221998989582, -0.03576016426086426, 0.005030492320656776, 0.021648652851581573, 0.018801594153046608, 0.024069340899586678, -0.02325786091387272, -0.025417223572731018, 0.026930155232548714, -0.07141029834747314, -0.004002387635409832, -0.04426008090376854, -0.016986077651381493, -0.0024464766029268503, 0.025389716029167175, 0.019296735525131226, 0.012165333144366741, -0.05003672093153, 0.013410061597824097, -0.02761784940958023, -0.01276362780481577, 0.029213303700089455, 0.03587019443511963, -0.012351010926067829, -0.04274715110659599, -0.0023398837074637413, 0.016903555020689964, -0.0004977195640094578, -0.012130947783589363, -0.013568231835961342, 0.05531822144985199, 0.00648840656504035, -0.00558752566576004, 0.0318540520966053, 0.05325513705611229, 0.030863773077726364, 0.05592339485883713, -0.021263543516397476, -0.020218245685100555, -0.029020749032497406, -0.041921913623809814, -0.006117051001638174, 0.009462689980864525, 0.01236476469784975, 0.01594078168272972, 0.041949424892663956, 0.0361727811396122, 0.0297909677028656, 0.014194034039974213, 0.0337245836853981, -0.07141029834747314, 0.022817734628915787, -0.018237683922052383, 0.008568685501813889, 0.04299471899867058, 0.06535857915878296, 0.08978551626205444, -0.0007581842364743352, -0.00910508818924427, -0.011945270001888275, -0.04467269778251648, -0.039968859404325485, 0.01622961275279522, -0.00013087704428471625, 0.025018360465765, -0.019791875034570694, -0.07509634643793106, -0.017811313271522522, 0.029845982789993286, 0.0016616442007943988, 0.008912533521652222, -0.04437011107802391, 0.014950498938560486, 0.012798012234270573, 0.0056562949903309345, -0.0020665249321609735, -0.01893913373351097, 0.014455358497798443, -0.008554931730031967, -0.03413720428943634, 0.03834589943289757, 0.009490197524428368, 0.05295255035161972, -0.05515317618846893, 0.0003580314514692873, 0.0077572050504386425, 0.009992214851081371, 0.0022057832684367895, 0.023092813789844513, 0.022267578169703484, 0.01737118698656559, -0.01735743321478367, -0.031386420130729675, 0.05328264459967613, 0.023821771144866943, 0.009579597972333431, -0.01697232387959957, 0.06073726341128349, 0.012014039792120457, -0.0361727811396122, -0.05077943205833435, 0.02490833029150963, 0.0058488501235842705, 0.007103893905878067, -0.024798298254609108, -0.009400797076523304, 0.0020682441536337137, -0.004074595402926207, -0.0519072525203228, 0.0382358692586422, -0.0461031049489975, 0.004005826078355312, 0.003199503058567643, 0.004356550984084606, -0.05270497873425484, 0.003221853170543909, -0.0033903387375175953, 0.033559538424015045, 0.008211083710193634, 0.008706224150955677, -0.007825974375009537, 0.023299122229218483, 0.06728412210941315, 0.01257107313722372, -0.0208921879529953, -0.020809665322303772, -0.010122877545654774, 0.01090684998780489, -0.0515221431851387, 0.010638648644089699, -0.016270874068140984, 0.003455669619143009, 0.02057584747672081, 0.0027765703853219748, 0.002816112944856286, 0.029515888541936874, -0.005202416330575943, 0.06513851135969162, -0.03647536784410477, 0.005958881229162216, 0.02471577562391758, -0.020039446651935577, -0.048771362751722336, 0.004466582089662552, -0.008706224150955677, -0.02710895426571369, 0.02028701640665531, -0.02855311520397663, 0.019076671451330185, -0.004745098762214184, 0.020603356882929802, -0.015665702521800995, 0.02636624313890934, -0.018251437693834305, 0.014441604726016521, -0.009201365523040295, 0.014537882059812546, -0.0073308334685862064, -0.02190997824072838, -0.02926831878721714, -0.02825053036212921, -0.027631603181362152, -0.03939119726419449, -0.01964058168232441, -0.06882455945014954, -0.03812583535909653, -0.028388068079948425, 0.04764354228973389, -0.021593637764453888, -0.016174597665667534, -0.025362208485603333, -0.01178022287786007, -0.022914012894034386, 0.004349673632532358, -0.018031375482678413, -0.0171511247754097, 0.016931062564253807, -0.010019723325967789, 0.006106735672801733, 0.045773010700941086, 0.029103271663188934, -0.0036654167342931032, -0.02295527420938015, 0.027961697429418564, 0.003744501853361726, -0.004470020532608032, 0.04051901772618294, 0.006870077457278967, -0.01737118698656559, -0.012295994907617569, -0.01003347709774971, -0.04293970391154289, 0.008912533521652222, 0.029708443209528923, 0.01716487854719162, 0.006839131470769644, 0.024138111621141434, 0.02668258361518383, 0.008472408168017864, 0.03141392767429352, -0.030451154336333275, -0.024138111621141434, 0.016793522983789444, 0.001245588413439691, -0.021758684888482094, 0.044617682695388794, 0.04051901772618294, -0.030643709003925323, 0.02346416935324669, 0.0049651614390313625, -0.026297474279999733, 0.018664054572582245, -0.00625802855938673, 0.051852237433195114, -0.013581985607743263, -0.00197884370572865, -0.035320039838552475, -0.03278931975364685, -0.004225888755172491, -0.008802501484751701, -0.03188156336545944, -0.024688266217708588, 0.0015069126384332776, -0.01602330431342125, -0.018581531941890717, -0.039666272699832916, -0.003710116958245635, 0.04901893436908722, -0.03556760773062706, -0.0040436494164168835, 0.0037960789632052183, -0.012591703794896603, -0.0001295876136282459, 0.001303182914853096, 0.00017428782302886248, -0.004346235189586878, 0.016903555020689964, 0.017247403040528297, -0.014964253641664982, -0.0008948637405410409, -0.017948850989341736, -0.021070988848805428, -0.011553283780813217, -0.024234388023614883, -0.012179086916148663, -0.009957830421626568, -0.01882910169661045, 0.004373743198812008, -0.009882183745503426, 0.005773203447461128, -0.01797635853290558, -0.014139018952846527, -0.029020749032497406, -0.017536234110593796, -0.022982781752943993, 0.05251242592930794, -0.04852379113435745, 0.011030634865164757, -0.0011922919657081366, 0.03278931975364685, -0.013403184711933136, 0.017412448301911354, 0.011690822429955006, 0.006089543458074331, -0.005955442786216736, 0.040601540356874466, -0.009235749952495098, -0.017123617231845856, 0.015514410100877285, 0.015211823396384716, -0.02604990452528, 0.024839559569954872, 0.02090594172477722, -0.0413992665708065, 0.005893550347536802, -0.01687604747712612, -0.04293970391154289, 0.037383124232292175, -0.00019986148981843144, 0.009277012199163437, -0.03421972692012787, -0.007991021499037743, -0.012674227356910706, -0.004153680521994829, 0.009091334417462349, -0.014345327392220497, -0.03653038293123245, -0.026187444105744362, -0.03339449316263199, 0.013251891359686852, 0.012660473585128784, 0.03793328255414963, -0.039446212351322174, 0.003512404626235366, -0.02119477465748787, -0.010927480645477772, -0.018223930150270462, 0.005205854773521423, -0.00014420114166568965, -0.017632512375712395, -0.012185963802039623, -0.002499772934243083, 2.119498822139576e-05, 0.01416652649641037, 0.02987349033355713, 0.0021903100423514843, -0.019984429702162743, 0.0007014493457973003, 0.050531864166259766, -0.01613333635032177, 0.026036150753498077, -0.03009355254471302, 0.011917762458324432, -0.0378507599234581, -0.012804889120161533, -0.00018879389972425997, 0.02036953903734684, -0.014276557601988316, 0.024468204006552696, -0.010673034004867077, -0.00857556238770485, -0.02449571155011654, 0.010604264214634895, 0.02398681826889515, -0.012295994907617569, -0.004133049864321947, -0.01045297086238861, -0.015225577168166637, 0.016050811856985092, 0.023436661809682846, -0.020837172865867615, 0.0038682869635522366, -0.005718187894672155, -0.037273094058036804, 0.02533470094203949, -0.005694118328392506, -0.06205764040350914, -0.01303182914853096, 0.02708144672214985, -0.02687513828277588, 0.0053571476601064205, -0.04654322937130928, -0.01994316838681698, -0.011457006447017193, 0.034494806081056595, 0.05174220725893974, -0.049183979630470276, -0.017247403040528297, 0.001466510584577918, -0.018278945237398148, 0.004050526302307844, -0.014812960289418697, -0.015335609205067158, 0.009634613059461117, 0.0008755222661420703, -0.010060984641313553, 0.0023450416047126055, -0.019255472347140312, -0.020548339933156967, -0.06161751225590706, 0.005522194784134626, 0.030121061950922012, -0.0005183504545129836, -0.054768066853284836, 0.014744190499186516, -0.006244274787604809, -0.009675875306129456, 0.022515149787068367, 0.010377324186265469, 0.019599320366978645, -0.00209403270855546, -0.0018103582551702857, 0.009648367762565613, -0.021772438660264015, 0.021332312375307083, -0.0395287349820137, 0.004325604531913996, -0.002384583931416273, -0.05446548014879227, -0.016683492809534073, -0.009270134381949902, -0.02152486890554428, 0.01324501447379589, 0.0200532004237175, 0.03721807897090912, 0.0026579429395496845, 0.01111315842717886, -0.0083830077201128, 0.012165333144366741, -0.022707704454660416, 0.007310202810913324, 0.029708443209528923, -0.012853028252720833, 0.02576107159256935, -0.01975061371922493, -0.010060984641313553, 0.0012395710218697786, 0.025100884959101677, 0.012488549575209618, -0.005518755875527859, 0.01205530110746622, 0.011525776237249374, -0.02573356404900551, -0.0023639530409127474, -0.02130480483174324, 0.017825067043304443, 0.017962604761123657, -0.022583918645977974, 0.0016160843661054969, 0.014978007413446903, 0.0077572050504386425, 0.05127457529306412, 0.02149735949933529, 0.006553737912327051, -0.044507648795843124, 0.01091372687369585, -0.003947372082620859, 0.005360586103051901, 0.014606651850044727, 0.038318391889333725, -0.0033198499586433172, -0.018650300800800323, 0.005470617208629847, -0.01705484837293625, -0.018774086609482765, -0.0064540221355855465, -0.045030299574136734, -0.010563001967966557, -0.00718641746789217, -0.02411060221493244, -0.006784115917980671, 0.015321854501962662, 0.045140329748392105, -0.012000286020338535, -0.1135522723197937, 0.01123006734997034, 0.008534301072359085, 0.014647913165390491, -0.0076815583743155, 0.003754817182198167, 0.02874566987156868, 0.0024258457124233246, -0.017935097217559814, 0.0180863905698061, -0.009620859287679195, 0.007303325925022364, 0.006412760354578495, 0.012440411373972893, -0.003562262514606118, -0.0522923618555069, -0.021689914166927338, 0.026297474279999733, 0.01788008213043213, 0.004122734069824219, -0.027480309829115868, 0.007805343717336655, -0.019791875034570694, -0.016092073172330856, -0.0393361821770668, -0.041014157235622406, 0.01799011416733265, -0.0311113428324461, 0.005374339874833822, -0.004009264521300793, -0.005508440546691418, -0.002303779823705554, 0.0322391614317894, 0.009806537069380283, 0.0017948851455003023, -0.01209656335413456, -0.011051266454160213, -0.010783065110445023, -0.0015911554219201207, 0.001849900814704597, 0.0020201054867357016, -0.05677613615989685, 0.01881534792482853, -0.01515680830925703, -0.001198309357278049, -0.00971713662147522, 0.04324229061603546, -0.015541917644441128, 0.056611090898513794, -0.009806537069380283, 0.00017461017705500126, -0.003747940296307206, -0.02100221998989582, -0.019516797736287117, 0.004050526302307844, -0.031496454030275345, -0.039446212351322174, 0.015651948750019073, 0.01230974867939949, 0.04879887029528618, -0.014510374516248703, -0.0016839943127706647, -0.006086105015128851, -0.013079967349767685, -0.02296902798116207, -0.03829088434576988, 0.010803695768117905, 0.02750781923532486, -0.007791589479893446, -0.051357097923755646, -0.021277297288179398, 0.025100884959101677, -0.004511282313615084, -0.024647004902362823, -0.011656438000500202, 0.0209884662181139, -0.004559420980513096, 0.036035243421792984, -0.03999636694788933, 0.0063543058931827545, 0.024014325812458992, -0.014469112269580364, 0.01369889359921217, 0.012522934004664421, -0.009710259735584259, 0.031689006835222244, 0.03928116336464882, -0.0397212915122509, -0.04915647208690643, 0.04651572182774544, 0.04538790136575699, -0.017921343445777893, 0.013011198490858078, -0.008197329938411713, 0.0031221373938024044, -0.00116392457857728, 0.018333960324525833, 0.0115739144384861, 0.0208921879529953, 0.00360696273855865, -0.007234556134790182, 0.04470020532608032, 0.0007035984308458865, 0.018746579065918922, -0.020121969282627106, -0.011814608238637447, 0.008885025046765804, -0.05457551032304764, -0.0013633562484756112, -0.010143508203327656, 0.0007237994577735662, 0.024468204006552696, -0.04712089151144028, 0.021469851955771446, 0.016821030527353287, 0.016367152333259583, 0.008431145921349525, 0.00997158419340849, -0.005687241442501545, -0.02336789108812809, 0.0256647951900959, 0.010473601520061493, -0.008685593493282795, -0.004923899658024311, 0.00047150120371952653, -0.022487642243504524, 0.0017828504787757993, -0.010858711786568165, -0.030891280621290207, 0.002941617276519537, -0.012454165145754814, -0.01851276122033596, -0.002979440614581108, 0.0007302465965040028, 0.013430692255496979, 0.01840273104608059, -0.029185796156525612, -0.02545848675072193, 0.021662406623363495, 0.04076658561825752, 0.02273521199822426, 0.010356693528592587, 0.01726115681231022, 0.0035794549621641636, 0.0046694520860910416, 0.022707704454660416, -0.03589770197868347, -0.04522285237908363, 0.006787554360926151, 0.01973685994744301, 0.05110952630639076, -0.013361922465264797, -0.015170562081038952, -0.0093664126470685, -0.014097756706178188, 0.005467178765684366, -0.01457914337515831, -0.04673578217625618, -0.03606275096535683, 0.04833123832941055, 0.0037513787392526865, 0.046405691653490067, 0.00863057840615511, -0.01994316838681698, 0.009393920190632343, -0.015528163872659206, -0.011766469106078148, -0.031496454030275345, -0.016092073172330856, 0.025678548961877823, -0.0093664126470685, -0.08907031267881393, 0.012839274480938911, 0.03259676322340965, 0.01973685994744301, 0.008857517503201962, -0.02720523253083229, -0.015184315852820873, 0.022405117750167847, -0.0030860332772135735, 0.025265932083129883, -0.01932424306869507, -0.03845592960715294, 0.0036104011815041304, -0.0028676900546997786, 0.0028814440593123436, 0.00858243927359581, -0.008885025046765804, 0.03496243804693222, 0.04511282220482826, 0.01891162432730198, 0.02534845471382141, 0.0074477419257164, 0.03454982116818428, 0.05892174690961838, -0.02078215777873993, -0.0026218390557914972, 0.03295436501502991, 0.010150385089218616, -0.017123617231845856, 0.011601422913372517, -0.004318727646023035, -0.020410802215337753, 0.0032545188441872597, -0.03875851631164551, 0.007702189031988382, -0.022487642243504524, -0.0032545188441872597, 0.0024241264909505844, -0.02193748578429222, 0.012275364249944687, 0.011106281541287899, -0.03763069584965706, -0.009634613059461117, -0.0007113349856808782, -0.020204491913318634, 0.0069491625763475895, 0.039638765156269073, -0.023931801319122314, 0.01653219945728779, 0.0030877527315169573, -0.027879174798727036, 0.005408724769949913, 0.021332312375307083, -0.010404832661151886, 0.008362377062439919, -0.0025788580533117056, 0.0013100598007440567, -0.003864848520606756, -0.026297474279999733, -0.010741802863776684, 0.005491248331964016, -0.03545757755637169, 0.014757944270968437, -0.017233647406101227, -0.018320206552743912, -0.017096109688282013, -0.001932424260303378, -0.012687981128692627, 0.011615176685154438, 0.03020358458161354, 0.012798012234270573, -0.04106917232275009, -0.01892537996172905, -0.007234556134790182, -0.010425463318824768, -0.01738494075834751, 0.05650106072425842, -0.013506338931620121, -0.01811389811336994, 0.011814608238637447, 0.01964058168232441, 0.019296735525131226, 0.005023615434765816, 0.026930155232548714, 0.01123006734997034, 0.027672864496707916, 0.02825053036212921, 0.03133140504360199, 0.00951082818210125, -0.03215663880109787, 0.0014338450273498893, 0.01975061371922493, -0.013650755397975445, -0.030066045001149178, -0.05509816110134125, -0.011291959322988987, 0.002265956485643983, 0.022253824397921562, 0.030148569494485855, -0.03950122743844986, 0.021662406623363495, 0.004177750088274479, 0.020823419094085693, -0.006106735672801733, -0.02193748578429222, 0.0343022495508194, -0.014180280268192291, 0.02335413731634617, -0.007024809252470732, -0.011360729113221169, -0.03565013408660889, -0.027384033426642418, -0.007592157926410437, -3.2907303193496773e-07, -0.004700398538261652, -0.017935097217559814, 0.008341746404767036, 0.024688266217708588, 0.007385849487036467, -0.0024739843793213367, 0.05710623040795326, 0.006770361680537462, 0.048248711973428726, 0.020438309758901596, -0.016600968316197395, 0.006993862800300121, 0.04238954931497574, -0.004686644766479731, 0.00651247613132, -0.005271185655146837, 0.02306530624628067, 0.02801671251654625, -0.02450946718454361, -0.006656892132014036, 0.031909070909023285, 0.017728788778185844, -0.007310202810913324, -0.04822120442986488, -0.004968599881976843, 0.001932424260303378, 0.006784115917980671, 0.015651948750019073, 0.001827550702728331, 0.009744645096361637, 0.005006422754377127, -0.0231478288769722, -0.03091878816485405, 0.009387043304741383, 0.023436661809682846, 0.01592702604830265, 0.010899973101913929, 0.003734186291694641, 0.009146349504590034, 0.0009481601300649345, -0.04725843295454979, -0.0065468610264360905, -0.029323333874344826, 0.0034230041783303022, 0.015995796769857407, 0.02720523253083229, 0.023024044930934906, 0.02243262529373169, 0.0034797389525920153, -0.04706587642431259, 0.038015805184841156, -0.018045129254460335, 0.002174836816266179, 0.0013126387493684888, 0.012488549575209618, 0.04574550315737724, 0.0125573193654418, 0.005876357667148113, -0.008004775270819664, -0.02666882984340191, -0.01283239759504795, 0.02419312670826912, -0.0005952863721176982, -0.025582270696759224, 0.0167660154402256, 0.09281138330698013, -0.02214379422366619, -0.019681844860315323, 0.020452063530683517, 0.0048448145389556885, 0.016587214544415474, -0.028828194364905357, -0.026861384510993958, -0.020410802215337753, 0.024853313341736794, -0.004686644766479731, 0.05149463564157486, 0.01986064575612545, 0.009359534829854965, 0.046075597405433655, 0.009586474858224392, -0.006306167226284742, 0.01914544217288494, 0.009730890393257141, 0.02607741206884384, 0.024041833356022835, 0.013121229596436024, -9.541774488752708e-05, -0.016518445685505867, 0.0011854150798171759, -0.00465225987136364, -0.0017003270331770182, 0.008885025046765804, 0.032019101083278656, 0.047946128994226456, -0.009902814403176308, 0.0237942636013031, -0.031799037009477615, 0.02358795516192913, -0.010879342444241047, 0.011333221569657326, -0.025884857401251793, 0.03152396157383919, -0.009785906411707401, -0.008974425494670868, 0.007695312146097422, -0.013306907378137112, -0.022075023502111435, 0.008341746404767036, 0.0049376534298062325, -0.020947203040122986, -0.011491390876471996, 0.03350452333688736, -0.004542228300124407, -0.029405858367681503, -0.005608156323432922, 0.03295436501502991, 0.0051439618691802025, -0.0036963631864637136, -0.02812674455344677, -0.021263543516397476, 0.014620405621826649, -0.00015677307965233922, -0.0005402707611210644, 0.01903541013598442, -0.012612334452569485, 0.014854221604764462, -0.004511282313615084, 0.020644618198275566, 0.006395567674189806, -0.021181020885705948, 0.00465225987136364, 0.007599034812301397, -0.029020749032497406, 0.01810014434158802, -0.023010289296507835, 0.009387043304741383, -0.004803552757948637, -0.029185796156525612, -0.02668258361518383, 0.030863773077726364, -0.038620978593826294, 0.007475249469280243, 0.009737768210470676, 0.022047515958547592, -0.02833305299282074, -0.01463415939360857, 0.012859905138611794, -0.0006460039294324815, 0.0014209507498890162, -0.011264451779425144, 0.018168913200497627, -0.013540723361074924, -0.042252007871866226, -0.006457460578531027, -0.028099237009882927, 0.02162114530801773, 0.014647913165390491, -0.008032282814383507, 0.006842569913715124, -0.03174402192234993, 0.02593987248837948, -0.0019393012626096606, 0.015404378063976765, 0.0028281474951654673, 0.0007607631268911064, 0.01236476469784975, -0.017233647406101227, 0.0020304208155721426, 0.024839559569954872, 0.01076243445277214, -0.043902479112148285, 0.003758255625143647, 0.010975619778037071, 0.0034006540663540363, 0.00581446522846818, -0.013320661149919033, 0.022501396015286446, -0.02615993469953537, -0.0065571763552725315, 0.036777954548597336, 0.020644618198275566, 0.00602765055373311, 0.008211083710193634, -0.0030739987269043922, 0.020603356882929802, 0.003968002740293741, 0.007894744165241718, 0.01986064575612545, -0.024578236043453217, -0.008919410407543182, -0.0033920579589903355, 0.0200532004237175, -0.013802047818899155, -0.008128560148179531, -0.010122877545654774, 0.0043703047558665276, 0.02636624313890934, -0.0018189544789493084, 0.017811313271522522, 0.011202558875083923, 0.0008639174047857523, -8.666037319926545e-05, -0.03226667270064354, -0.009668998420238495, 0.01581699587404728, -0.016105826944112778, 0.023863032460212708, 0.03441227972507477, 0.0029725637286901474, -0.011209435760974884, 0.0025547887198626995, -0.005302132107317448, 0.016312137246131897, -0.022914012894034386, 0.0026957662776112556, 0.030286109074950218, -0.032431717962026596, -0.012660473585128784, -0.008740609511733055, -0.02090594172477722, 0.0009215119061991572, -0.02948838099837303, 0.020245755091309547, -0.019791875034570694, 0.0459105484187603, 0.01697232387959957, 0.006529668346047401, 0.005828219000250101, 0.07019995152950287, -0.01602330431342125, -0.03548508509993553, -0.001058191410265863, -0.007550896145403385, -0.016078319400548935, -0.02514214627444744, -0.017096109688282013, 0.016188351437449455, 0.0043531120754778385, -0.020121969282627106, -0.018554024398326874, 0.00816294550895691, -0.0134925851598382, -0.0008879867382347584, 0.00028474890859797597, -0.010294800624251366, -0.023450415581464767, 0.0044459509663283825, -0.0023794262669980526, -0.0297909677028656, -0.019626827910542488, 0.0311113428324461, 0.0010212277993559837, -0.012990566901862621, -0.003754817182198167, 0.0259536262601614, -0.03155146911740303, 0.040271446108818054, -0.009882183745503426, -0.003675732295960188, 0.0335320308804512, 0.014537882059812546, 0.010219154879450798, 0.02844308502972126, 0.014482866041362286, 0.012846151366829872, 0.006161751225590706, -0.0019908782560378313, 0.005522194784134626, 0.013059336692094803, 2.071145354420878e-05, 0.009950953535735607, 0.016380906105041504, -0.003036175388842821, 0.0007272379589267075, 0.043379828333854675, 0.002780008828267455, -0.015665702521800995, 0.009111965075135231, -0.0076746814884245396, -0.0031118220649659634, -0.019406765699386597, -0.0057560112327337265, -0.009084456600248814, -0.029625920578837395, 0.009187611751258373, 0.005137084983289242, 0.010205401107668877, 0.02452322095632553, -0.015198069624602795, 0.012158455327153206, 0.004507843870669603, 0.009613982401788235, -0.015638194978237152, 0.01891162432730198, -0.00858931615948677, -0.018443992361426353, -0.0026562237180769444, -0.028883209452033043, -0.00444938987493515, 0.00012023925228277221, -0.02461949735879898, -0.019007902592420578, -0.014510374516248703, 0.01800386793911457, -0.00081491912715137, 0.013430692255496979, -0.0024946152698248625, -0.02441318891942501, 0.0005694978171959519, 0.03339449316263199, -0.012316625565290451, -0.005082069430500269, -0.03039613924920559, 0.023519184440374374, -0.01064552552998066, 0.0062683443538844585, -0.007949759252369404, -0.007076386362314224, -0.004112418740987778, -0.017109863460063934, 0.0038820409681648016, -0.031166357919573784, 0.02357420139014721, 0.02522466890513897, -0.027837911620736122, -0.008410515263676643, 0.016821030527353287, -0.03675044700503349, -0.03347701579332352, 0.033559538424015045, -0.0048448145389556885, 0.012495426461100578, -0.03424723446369171, -0.021566130220890045, -0.0022470448166131973, 0.015074284747242928, 0.013802047818899155, -0.027947943657636642, 0.018787840381264687, 0.005188662093132734, 0.0072139254771173, 0.004827622324228287, -0.00462819030508399, -0.020025691017508507, 0.038951072841882706, -0.015445640310645103, -0.0256647951900959, -0.01277738157659769, 0.02317533642053604, 0.0035278776194900274, -0.020644618198275566, -0.015088038519024849, 0.011807731352746487, 0.027892928570508957, 0.0012000285787507892, 0.0060448432341217995, 0.012632966041564941, -0.022267578169703484, -0.013836432248353958, 0.008527424186468124, 0.0053571476601064205, -0.008087298832833767, 0.007062632590532303, 0.03691549226641655, -0.02771412767469883, 0.005298693664371967, 0.0071726636961102486, 0.005429355893284082, 0.01329315360635519, 0.027260247617959976, 0.010755556635558605, 0.029295826330780983, -0.03721807897090912, 0.02657255344092846, 0.01210344024002552, -0.00977902952581644, -0.024990852922201157, 0.04511282220482826, -0.016490936279296875, -0.021387329325079918, -0.006319921463727951, -0.005205854773521423, 0.016931062564253807, 0.01860903948545456, -0.019214211031794548, -0.007770958822220564, -0.00904319528490305, -0.02534845471382141, 0.02628372050821781, -0.038098327815532684, 0.005608156323432922, -0.003280307399109006, 0.0083830077201128, -0.002152486704289913, 5.474700446939096e-05, -0.01788008213043213, 0.04406752437353134, -0.03394464775919914, -0.005408724769949913, 0.011312589980661869, 0.017302418127655983, -0.0016040496993809938, 0.01849900744855404, -0.012639842927455902, 0.0051336465403437614, -0.007200171705335379, -0.009847799316048622, -0.02803046628832817, -0.008389884606003761, 0.02606365829706192, 0.03906110301613808, 0.0062614670023322105, -0.0191179346293211, 0.0098340455442667, 0.0134444460272789, 0.0171511247754097, -0.039446212351322174, -0.010975619778037071, 0.009153226390480995, 0.014524128288030624, 0.0024275649338960648, -0.026957662776112556, -0.020603356882929802, -0.01675226166844368, -0.026242459192872047, 0.027672864496707916, -0.009345781058073044, -0.011133789084851742, 0.007103893905878067, 0.008417392149567604, 0.011340098455548286, -0.031166357919573784, -0.02294152043759823, -0.004263712093234062, 0.01716487854719162, 0.009469566866755486, 0.0029983522836118937, 0.05088946595788002, 0.0017037654761224985, -0.006237397901713848, 0.0005909882602281868, 0.005697556771337986, 0.02896573208272457, 0.0033078151755034924, 0.01819642260670662, -0.054135385900735855, 0.01395334117114544, -0.03317442908883095, -0.0027525010518729687, 0.02573356404900551, -0.006010458339005709, -0.0017673773691058159, 0.011821485124528408]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" +2
N(N+ 1)cov(a1, b1),
which concludes our proof.
D. Implementations
The implementation of EE-LLM is based on Megatron-LM (Narayanan et al., 2021b), primarily extending Megatron-LM’s
model architectures, pipeline scheduling, and inference service to support the training and inference of early-exit LLMs. We
introduce each of these aspects in more detail below.
D.1. Model architectures
We have introduced a new class of models called EarlyExitGPTModel , which is the early-exit counterpart of
GPTModel in the original model library of Megatron-LM. The model is constructed with a few other classes,
including EarlyExitTransformerLayer ,EarlyExitTransformer , and EarlyExitLanguageModel .
EarlyExitTransformerLayer is a replacement for the original ParallelTransformerLayer in Megatron-
LM. It adds an early-exit structure on top of the standard Transformer layer, which allows it to generate outputs for both the
main network backbone and the early exit; for the latter, it returns a lazy loss function during training, or tokens during
inference. This module supports various customizations of the early-exit structure; besides the minimalistic structure with an
output embedding matrix and an optional output normalization layer, one might add e.g. a MLP or a complete Transformer
layer. These additional structures can be combined in any desired manner and can be placed before or after the backbone
part of this layer. On the other hand, EarlyExitTransformer andEarlyExitLanguageModel are mainly used
to propagate the early-exit outputs to the top-level model. They are capable of stopping the forward computation at the
early-exit layer and returning the intermediate outputs, which facilitates accelerated inference.
D.2. Pipeline scheduling
We have adjusted the existing 1F1B schedule for early-exit LLMs, as shown in Figure 3. To fill implicit bubbles and reduce
GPU memory overhead, lazy loss functions of early-exit layers are returned together with outputs of the backbone network
during forward steps. These lazy functions are not actually called until their corresponding auxiliary losses (cf. Section 3.1.1)
are calculated in the backward steps. For the method of filling explicit bubbles proposed in Section 3.3, we have inserted
partial forward/backward computation of additional microbatches into warm-up and cool-down phases of the 1F1B schedule.
The number of inserted microbatches and partial forward/backward stages can be automatically calculated through the
user-specified (estimate of) ratio between backward and forward time.
D.3. Inference service
To support inference of early-exit LLMs, we have refactored the text-generation module of Megatron-LM.
For inference with pipeline parallelism, i.e. the pipeline-based approach proposed in Section 4, we have re-implemented
the forward process. With our implementation, the first pipeline stage will wait for an exit signal from the early/final exits
24
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
of all subsequent stages after its forward computation is completed. Each subsequent stage will send an exit signal and
the output token to the first stage, if there is an exit within the stage that satisfies the exit condition. Upon receiving the
signal and generated token, the first stage will immediately start the forward pass for generating the next token. With this
implementation, regardless of the early-exit layers’ positions in subsequent stages, the inference service can immediately
generate a token whenever early exiting happens on some stage, without waiting for the completion of the entire stage
(except for the first stage).
For inference without pipeline parallelism, we have implemented a mechanism of KV recomputation , which is a variant of
synchronized parallel decoding proposed recently in (Bae et al., 2023). In this approach, we maintain a list of the most
recent tokens that have missing KV caches in deep layers due to early exiting. During each forward pass, we include these
early-exit tokens in the current forward pass, which allows for direct recomputation of the KV caches for these tokens and
thus avoids the issue of missing KV caches. Acceleration of sequence generation is still achieved, thanks to the batching
effects of GPU computation. To avoid the endless accumulation of early-exit tokens, we enforce a full-model forward pass
whenever the number of early-exit tokens reaches a pre-specified value.
E. Preliminaries
Transformers. The Transformer architecture (Vaswani et al., 2017; Tay et al., 2022) has been playing a dominant role
in natural language processing (NLP) and large language models (LLMs) (Bommasani et al","[0.01442007813602686, 0.029943184927105904, 0.06268429756164551, -0.023728562518954277, -0.006113736424595118, 0.02561178058385849, 0.013512097299098969, 0.049878403544425964, -0.0049838051199913025, 0.0854981541633606, 0.028786350041627884, -0.04011256992816925, -0.019464414566755295, -0.0011223650071769953, -0.04342165216803551, -0.039359282702207565, 0.030454345047473907, -0.01144055649638176, 0.003914405591785908, 0.06289952248334885, 0.030454345047473907, -0.0127857131883502, 0.010203012265264988, 0.02707800082862377, 0.01801164634525776, -0.006372679024934769, -0.0007637967355549335, 0.041430823504924774, -0.004899732768535614, -0.04148462787270546, 0.05784173309803009, -0.031584277749061584, -0.04226481914520264, -0.018859095871448517, -0.02290801703929901, 0.027373936027288437, 0.03268730267882347, 0.054882388561964035, -0.016518522053956985, 0.036104001104831696, 0.006914104800671339, -0.04350236430764198, -0.05773412063717842, 0.02550416812300682, -0.024858493357896805, 0.06327616423368454, 0.03317156061530113, 0.0064096711575984955, -0.019841060042381287, 0.040139470249414444, 0.003783252788707614, -0.010398060083389282, -0.010041593573987484, -0.002774385502561927, -0.032149240374565125, -0.032848723232746124, 0.003119081724435091, -0.008044036105275154, -0.001699100830592215, -0.04821041226387024, 0.00284164329059422, -0.04471300542354584, 0.032041627913713455, -0.0043952991254627705, -0.016693392768502235, 0.005928777623921633, -0.05762650817632675, 0.02897467277944088, -0.002190923783928156, 0.016935521736741066, -0.017244907096028328, -0.009348837658762932, -0.001588125480338931, -0.03104621358215809, -0.02536965347826481, 0.017392873764038086, 0.021253474056720734, 0.06682737916707993, -0.00679640332236886, -0.018549708649516106, 0.01895325630903244, -0.015025398693978786, 0.021078603342175484, -0.013384307734668255, 0.011763393878936768, -0.0166395865380764, 0.013525549322366714, -0.009638046845793724, -0.038659799844026566, -0.02364785224199295, -0.0028080143965780735, -0.011743216775357723, -0.022679340094327927, 0.020338766276836395, 0.07220800220966339, 0.034705039113759995, 0.017756067216396332, -0.07102426886558533, 0.04756473749876022, 0.06435228884220123, -0.0056126657873392105, 0.02452220395207405, 0.04035469517111778, -0.0451972596347332, 0.03486645966768265, -0.032525885850191116, -0.03306394815444946, -0.009295031428337097, -0.037260837852954865, -0.03131524473428726, -0.04331403970718384, -0.01829412952065468, 0.0034217420034110546, -0.0075463284738361835, 0.006258341018110514, -0.040731340646743774, -0.05264942720532417, 0.03368271887302399, 0.022410308942198753, 0.01888599805533886, -0.0009828050388023257, -0.0009828050388023257, -0.004600435495376587, -0.023701658472418785, 0.012758810073137283, 0.018052000552415848, 0.024656720459461212, -0.01976034976541996, 0.02399759367108345, -0.02508717030286789, 0.0013216163497418165, 0.011588524095714092, 0.03978973254561424, -0.01242252066731453, -0.04498203471302986, 0.01231490820646286, -0.0353776179254055, -0.012066054157912731, -0.025813553482294083, 0.010250093415379524, 0.022235438227653503, -0.010767978616058826, -0.019814155995845795, 0.008844404481351376, -0.05751889571547508, 0.038067929446697235, -0.022396856918931007, 0.011803749017417431, -0.040865857154130936, 0.00568328658118844, -0.009570788592100143, -0.04256075248122215, -0.02532929740846157, -0.027952352538704872, -0.026109488680958748, -0.025974974036216736, -0.044443972408771515, 0.03906334564089775, 0.08797323703765869, -0.03755677118897438, 0.0026163295842707157, 0.02757570892572403, 0.019464414566755295, 0.029405122622847557, 0.0063693164847791195, 0.047699250280857086, -0.032875627279281616, 0.0017840139335021377, -0.07414502650499344, -0.036561354994773865, -0.00041006258106790483, -0.011978618800640106, -0.06085488200187683, -0.017581196501851082, -0.009099984541535378, -0.03683038800954819, -0.08404538035392761, -0.05332200601696968, -0.023957237601280212, -0.09356909245252609, -0.03849837929010391, 0.02742774225771427, -0.02624400518834591, -0.0009777606464922428, -0.056496575474739075, -0.00700826570391655, 0.007351280655711889, 0.025490716099739075, 0.0051855784840881824, 0.016626134514808655, -0.01459494885057211, 0.05100833624601364, 0.056980833411216736, 0.034705039113759995, 0.008716614916920662, 0.008730066008865833, 0.05176162347197533, 0.001045018550939858, 0.028113771229982376, -0.023203950375318527, 0.04952866584062576, 0.040408503264188766, 0.025114072486758232, -0.04810279980301857, 0.05515141785144806, -0.004886281210929155, -0.004751765634864569, 0.024428043514490128, -0.016478167846798897, -0.0444977805018425, 0.02953963726758957, -0.008111294358968735, 0.017016230151057243, 0.010969751514494419, 0.0008537540561519563, 0.017392873764038086, -0.04377139359712601, 0.017648454755544662, 0.06924866139888763, 0.0283828042447567, 0.013162356801331043, 0.02932441234588623, 0.0001929458958329633, 0.02358059398829937, -0.052541814744472504, 0.03637303411960602, -0.006376042030751705, -0.05724986270070076, 0.019114675000309944, 0.008252535946667194, 0.01731216534972191, -0.01768880896270275, -0.02792545035481453, -0.032848723232746124, 0.003423423506319523, -0.025665586814284325, -0.006238163448870182, -0.022396856918931007, 0.012187118642032146, -0.010821784846484661, 0.010223190300166607, 0.04140391945838928, 0.019464414566755295, -0.028544222936034203, -0.021253474056720734, 0.014662206172943115, -0.010337527841329575, -0.0539676807820797, 0.007405086886137724, 0.021535957232117653, -0.0044289277866482735, -0.03545832633972168, -0.029055381193757057, -0.004075824283063412, -0.03941308706998825, 0.04105417802929878, -0.028813254088163376, -0.0029660703148692846, -0.032606594264507294, 0.018415194004774094, -0.006433211266994476, 0.026122940704226494, -0.003194746794179082, 0.021872244775295258, 0.007115878164768219, -0.024360785260796547, -0.03177259862422943, -0.011669233441352844, 0.012288005091249943, -0.005626117344945669, 0.023150144144892693, -0.041888173669576645, -0.0061608171090483665, 0.028006158769130707, -0.041430823504924774, -0.012146763503551483, 0.04070443660020828, 0.011803749017417431, -0.009786013513803482, 0.03338678553700447, 0.010411512106657028, -0.01049222145229578, 0.048613958060741425, 0.02672826126217842, -0.00791624654084444, 0.0021572948899120092, -0.025302395224571228, -0.010129028931260109, -0.02956654131412506, -0.008171825669705868, 0.0294320248067379, -0.011628878302872181, 0.029270606115460396, -0.03664206340909004, 0.04342165216803551, -0.0035680278670042753, 0.020190799608826637, -0.0044356537982821465, 0.011521265842020512, 0.0056059397757053375, 0.03578116372227669, 0.013081647455692291, -0.0427490770816803, -0.0010946211405098438, -0.017406325787305832, 0.058110762387514114, -0.027024194598197937, -0.003351121209561825, -0.03527000546455383, 0.02462981641292572, -0.0037496238946914673, -0.04140391945838928, -0.011245508678257465, 0.01779642142355442, -0.026149842888116837, -0.029028479009866714, -0.010983203537762165, -0.0406506322324276, 0.003739535342901945, -0.036104001104831696, -0.011568346060812473, -0.05490928888320923, -0.02631126157939434, -0.024051399901509285, 0.012288005091249943, 0.037260837852954865, 0.015751782804727554, -0.014473884366452694, -0.02565213479101658, -0.0027962441090494394, 0.028086869046092033, -0.0004968672292307019, 0.01184410322457552, -0.035054780542850494, -0.019572027027606964, -0.02501991204917431, -0.0497438907623291, 0.018052000552415848, 0.07694295793771744, 0.020715411752462387, -0.044309455901384354, 0.02087683044373989, -0.026445778086781502, 0.023082885891199112, 0.0020496821962296963, 0.03731464222073555, 0.004317952785640955, 0.029620347544550896, 0.11396166682243347, 0.024360785260796547, -0.03220304846763611, -0.028893962502479553, 0.009779288433492184, -0.00846103485673666, 0.016693392768502235, -0.016410909593105316, 0.024858493357896805, -0.025598328560590744, 0.010115576907992363, 0.021482151001691818, -0.04242623969912529, -0.004220428876578808, 0.018347935751080513, 0.019450964406132698, -0.03058885969221592, 0.013599532656371593, -0.025813553482294083, 0.03527000546455383, 0.0034604151733219624, -0.01600736379623413, 0.03938618302345276, 0.04823731258511543, 0.011413653381168842, 0.03787960857152939, -0.03405936434864998, -0.0017520664259791374, 0.007418538443744183, 0.006507195066660643, 0.007371457759290934, 0.03591568022966385, 0.012651197612285614, 0.03462433069944382, -0.02624400518834591, 0.0035478505305945873, -0.026849325746297836, 0.04952866584062576, -0.005313368514180183, -0.02393033541738987, 0.009698579087853432, 0.009099984541535378, -0.014837076887488365, 0.0005330182611942291, -0.0325796902179718, 0.013882015831768513, 0.0229483712464571, -0.010646914131939411, 0.015321332961320877, 0.017258359119296074, 0.05264942720532417, 0.0112993149086833, -0.010411512106657028, -0.020258057862520218, -0.00835342239588499, -0.010007964447140694, 0.021051699295639992, -0.0006406308384612203, 0.06747305393218994, 0.03201472759246826, 0.02932441234588623, 0.02284075878560543, 0.05563567578792572, 0.0005552974180318415, 0.029970088973641396, -0.06268429756164551, 0.02554452233016491, -0.019316447898745537, 0.035081684589385986, 0.01881873980164528, 0.03325226902961731, 0.06612789630889893, -0.023351917043328285, -0.03171879053115845, -0.030561957508325577, -0.011393476277589798, -0.011871006339788437, -0.013720597140491009, 0.01768880896270275, -0.021065151318907738, -0.012765536084771156, -0.05286465212702751, -0.01976034976541996, 0.014299014583230019, 0.021078603342175484, -0.007014991249889135, -0.03661516308784485, -0.015845945104956627, -0.01329687237739563, 0.031126921996474266, -0.023674756288528442, -0.019598931074142456, 0.016343651339411736, -0.002475087996572256, -0.012832793407142162, 0.02238340489566326, -0.0229483712464571, -0.026849325746297836, -0.05259562283754349, -0.01336413063108921, 0.006850209552794695, -0.020123541355133057, 0.017917485907673836, 0.021280376240611076, 0.06047824025154114, 0.017110390588641167, -0.021468698978424072, -0.0683339536190033, 0.08991026133298874, -0.03376343101263046, 0.033090852200984955, -0.011454008519649506, 0.016975875943899155, -0.029243703931570053, -0.012469600886106491, -0.034731943160295486, -0.019424060359597206, 0.02017734758555889, 0.01937025412917137, -0.004412113688886166, 0.028893962502479553, 0.015025398693978786, 0.008265987038612366, -0.017742615193128586, 0.03930547460913658, -0.01158179808408022, 0.009960884228348732, 0.032633498311042786, -0.0011711269617080688, -0.056496575474739075, 0.028705641627311707, -0.029055381193757057, 0.017635002732276917, -0.022168179973959923, 0.019424060359597206, -0.00024107727222144604, 0.025181330740451813, 0.061715781688690186, -0.027508452534675598, -0.022195084020495415, -0.012852970510721207, 0.021778084337711334, 0.008030585013329983, -0.008313067257404327, 0.020379122346639633, -0.015321332961320877, 0.006493743509054184, -0.026365067809820175, -0.023984141647815704, -0.04812970012426376, 0.008844404481351376, 0.0029442114755511284, 0.01499849557876587, -0.014769818633794785, 0.014581496827304363, 0.014689109288156033, 0.0033057222608476877, -0.005320094060152769, 0.00459707248955965, 0.002839961787685752, -0.017123842611908913, -0.018455548211932182, -0.0047820317558944225, -0.01126568578183651, -0.016034265980124474, 0.02045983076095581, 0.01709694042801857, 0.03742225468158722, -0.014917786233127117, 0.02840970642864704, -0.008339970372617245, 0.03061576373875141, 0.02428007498383522, -0.0014729464892297983, -0.02140144072473049, -0.010512398555874825, -0.01170286163687706, -0.007270571310073137, -0.03674967586994171, -0.08947981148958206, -0.03728773817420006, 0.010808332823216915, 0.02945892885327339, 0.006766137667000294, 0.0018378201639279723, -0.02497955784201622, -0.047699250280857086, -0.005999398417770863, -0.01971999555826187, -0.02340572327375412, -0.06596647948026657, -0.04046230763196945, 0.01150781475007534, 0.04452468082308769, 0.045842934399843216, 0.015388591215014458, -0.012220747768878937, 0.003601656761020422, 0.017594648525118828, -0.012657923623919487, -0.0006410511559806764, 0.04947485774755478, 0.028328998014330864, -0.023042531684041023, 0.002384290099143982, -0.0294320248067379, -0.02805996499955654, 0.008091116324067116, 0.016101524233818054, 0.007317651528865099, -0.005014071241021156, 0.010102125816047192, 0.018590062856674194, 0.010263544507324696, 0.005363811738789082, -0.02663409896194935, -0.007808633614331484, 0.012059328146278858, 0.003413334721699357, -0.01499849557876587, 0.03341368958353996, 0.0009878493146970868, -0.026082586497068405, -0.005996035411953926, 0.002327120862901211, -0.035189297050237656, 0.016841359436511993, -0.026580292731523514, -0.012583939358592033, 0.023661304265260696, 0.0010988247813656926, 0.003251916030421853, -0.02663409896194935, -0.005172126926481724, -0.023526787757873535, -0.02884015627205372, -0.021414892747998238, 0.003191384021192789, -0.06957149505615234, -0.022047115489840508, -0.03839076682925224, 0.03462433069944382, 0.03629232570528984, -0.056873220950365067, -0.0055655851028859615, -0.020029380917549133, -0.04161914438009262, -0.004549992270767689, 0.014554593712091446, -0.028705641627311707, -0.04632719233632088, -0.025450361892580986, 0.010377882979810238, -0.0042742351070046425, 0.006029664073139429, 0.017285261303186417, -0.0026146480813622475, 0.030158409848809242, -0.028571125119924545, 0.009395918808877468, 0.006661887746304274, -0.035404521971940994, 0.009570788592100143, 0.002084992593154311, 0.0037698012311011553, -0.02263898402452469, -0.02340572327375412, -0.007532876916229725, -0.02687622793018818, -0.013707145117223263, 0.028678737580776215, -0.008528292179107666, 0.01350537221878767, 0.0012795801740139723, -0.010949574410915375, -0.0280330628156662, 0.018590062856674194, -0.015617267228662968, -0.011978618800640106, -0.011184976436197758, -0.005027522798627615, 0.020365670323371887, -0.021643569692969322, 0.0036487372126430273, 0.016760651022195816, 0.01731216534972191, 0.006147365551441908, 0.041672948747873306, -0.00724366819486022, -0.009631320834159851, -0.008360148407518864, -0.038202445954084396, -0.004052284173667431, 0.0012442697770893574, 0.009032726287841797, -0.004022018052637577, -0.013303598389029503, 0.011306040920317173, -0.0007936423644423485, 0.03454362228512764, 0.009106709621846676, -0.014446981251239777, -0.036077097058296204, -0.038767412304878235, 0.03825625404715538, 0.02582700550556183, 0.04221101105213165, -0.02458946220576763, 0.01499849557876587, -0.0004188901511952281, 0.014151046983897686, 0.0014990088529884815, -0.03825625404715538, -0.008904936723411083, -0.02126692607998848, 0.007808633614331484, -0.012361988425254822, 0.05410219728946686, 0.034113168716430664, 0.028355900198221207, -0.004802208859473467, -0.014258659444749355, -0.027199065312743187, -0.015576913021504879, -0.00721003906801343, -0.03368271887302399, -0.0037967043463140726, -0.037718191742897034, -0.03072337619960308, -0.03723393380641937, -0.0020059647504240274, -0.005215844605118036, -0.03174569457769394, 0.009026000276207924, -0.04923272877931595, -0.015106108039617538, -0.019921768456697464, -0.015644170343875885, 0.0031476663425564766, -0.023271208629012108, 0.004442379344254732, 0.005982583854347467, -0.002172427950426936, -0.0035478505305945873, 0.03268730267882347, -0.0353776179254055, 3.4522181522333995e-05, -0.028248287737369537, -0.012214021757245064, 0.056980833411216736, -0.02487194538116455, -0.0595635324716568, -0.032956335693597794, 0.02635161764919758, -0.029970088973641396, 0.029055381193757057, -0.017218003049492836, -0.010620011016726494, -0.04067753255367279, 0.030319828540086746, 0.053725551813840866, -0.043744489550590515, -0.04452468082308769, -0.011541442945599556, 0.026889679953455925, -0.0008802367956377566, -0.03301014378666878, 0.0002925715525634587, 0.017957840114831924, -0.005397440865635872, -0.011353121139109135, -0.027790933847427368, -0.040838953107595444, -0.004529814701527357, -0.038310058414936066, 0.0119113614782691, -0.003927857149392366, -0.006819943897426128, -0.03384413942694664, 0.04056992009282112, -0.004129630513489246, 0.0006801447598263621, 0.021495601162314415, 0.01696242392063141, 0.0162898451089859, -0.051277369260787964, 0.008380325511097908, 0.012852970510721207, -0.036077097058296204, -0.03664206340909004, -0.02683587372303009, -0.00601621251553297, -0.01419140212237835, -0.019787253811955452, -0.022275792434811592, 0.04156533628702164, -0.002369157038629055, 0.0054848757572472095, 0.025181330740451813, 0.04124249890446663, 0.007398360874503851, -0.013935822062194347, -0.009530434384942055, 0.012005521915853024, 0.004963627550750971, 0.006941007915884256, -0.005706826690584421, -0.010505672544240952, 0.038875024765729904, -0.009247951209545135, 0.003295633476227522, -0.03002389520406723, -0.003272093366831541, -0.004701321944594383, -0.006769500207155943, 0.02648613229393959, 0.0035209471825510263, -0.008440857753157616, -0.012974034994840622, -0.015415494330227375, 0.03615780919790268, 0.0378258042037487, -0.030884794890880585, -0.003941308706998825, 0.03209543600678444, -0.014514239504933357, 0.004586983937770128, -0.0042338804341852665, 0.027387388050556183, -0.0004024960508104414, 0.001440158230252564, 0.027347031980752945, -0.00958424061536789, -0.016626134514808655, 0.012113134376704693, -0.04917892441153526, -0.024750880897045135, -0.008387051522731781, -0.03107311576604843, 0.02109205536544323, -0.0001855895679909736, -0.0627380982041359, -0.009752385318279266, -0.006782951764762402, 0.01902051456272602, -0.036426838487386703, -0.003702543443068862, 0.05205756053328514, 0.0049434504471719265, -0.13225579261779785, -0.018791837617754936, 0.019531672820448875, 0.017715711146593094, 0.009456451050937176, -0.011494362726807594, 0.009624594822525978, 0.0035007698461413383, -0.0035545763093978167, -0.046784546226263046, -0.00032031541923061013, -0.023661304265260696, 0.010411512106657028, -0.0080574881285429, -0.008474485948681831, -0.053375814110040665, -0.009099984541535378, 0.0029896104242652655, 0.04253385215997696, -0.013552452437579632, -0.015993911772966385, 0.0027020832058042288, -0.028544222936034203, 0.009449725039303303, -0.03266040235757828, -0.03360201045870781, 0.004005203489214182, 0.018173065036535263, -0.020244605839252472, 0.024777783080935478, -0.032956335693597794, -0.010445140302181244, 0.006947733461856842, -0.0007440397166647017, -0.009725482203066349, -0.0016923750517889857, -0.0004134254704695195, -0.036077097058296204, -0.002212782623246312, 0.015092656947672367, -0.0017671994864940643, -0.04597745090723038, 0.044578488916158676, -0.015106108039617538, 0.02964724972844124, 0.011339670047163963, 0.02175118215382099, 0.00799022987484932, 0.022450663149356842, -0.004321315325796604, -0.017809873446822166, -0.0006595470476895571, -0.004795483313500881, 0.041188694536685944, 0.0035545763093978167, -0.0008659445447847247, -0.003292270703241229, -0.014299014583230019, 0.006843484006822109, 0.04350236430764198, -0.003682366106659174, 0.00544788409024477, -0.006695516873151064, -0.030158409848809242, -0.03683038800954819, -0.0024734067264944315, 0.01326324325054884, 0.03142285719513893, -0.013115276582539082, -0.05375245586037636, -0.011797023005783558, 0.02196640707552433, 0.0004661808197852224, -0.002824828727170825, 0.011258960701525211, 0.015993911772966385, 0.008467760868370533, 0.05854121223092079, -0.03927857056260109, 0.010122302919626236, 0.008151648566126823, -0.016384007409214973, -0.013451565988361835, -0.0029189896304160357, 0.006251615006476641, 0.014285562559962273, 0.021643569692969322, -0.019356802105903625, -0.003642011433839798, 0.03868670389056206, 0.046999771147966385, -0.010767978616058826, -0.0003137997991871089, 0.009200870990753174, 0.019881414249539375, -0.012738632969558239, 0.02354023978114128, 0.02711835689842701, 0.04950176179409027, -0.02375546470284462, 0.043071914464235306, 0.04576222598552704, -0.07947184890508652, -0.023916883394122124, -0.022504469379782677, 0.009207597002387047, 0.01737942360341549, -0.001861360389739275, 0.006268429569900036, -0.005837979260832071, 0.019114675000309944, -0.0020009204745292664, -0.0038740509189665318, 0.05913308262825012, 0.009389192797243595, 0.014917786233127117, 0.032498981803655624, 0.008205454796552658, 0.032498981803655624, -0.003907679580152035, -0.030454345047473907, 0.03301014378666878, -0.03185330703854561, -0.011057186871767044, -0.03161117807030678, -0.03002389520406723, 0.012469600886106491, 0.02918989770114422, -0.04533177614212036, -0.017702260985970497, 0.005114957690238953, 0.0008886440773494542, 0.024952653795480728, -0.03906334564089775, -0.025584878399968147, 0.01119170244783163, -0.0034385565668344498, 0.02617674693465233, -0.019249189645051956, 0.030319828540086746, 0.011776845902204514, -0.0083197932690382, 0.01136657316237688, 0.0019689728505909443, 0.009557337500154972, 0.003968211822211742, -0.001227455330081284, -0.02589426375925541, -0.008434131741523743, 0.0027357120998203754, 0.05143878608942032, 0.00944299902766943, -0.03674967586994171, -0.006527372170239687, -0.01565762236714363, 0.0014359545893967152, -0.023876529186964035, -0.027266323566436768, -0.018442096188664436, 0.03440910577774048, 0.04565461352467537, 0.05216517299413681, -0.01902051456272602, 0.007606860250234604, 0.022692790254950523, -0.013491920195519924, -0.021778084337711334, 0.006789677776396275, -0.046407900750637054, 0.01499849557876587, -0.00436166999861598, -0.01678755320608616, 0.05068549886345863, 0.021078603342175484, 0.023082885891199112, 0.0032182871364057064, 0.005303279962390661, 0.02133418247103691, 0.005195667035877705, 0.01238216646015644, -0.010546027682721615, 0.02771022543311119, -0.03532380983233452, 0.019249189645051956, -0.019625835120677948, -0.011857555247843266, -0.00011896228534169495, 0.003388113109394908, 0.019491318613290787, 0.0574650876224041, 0.024293527007102966, 0.03171879053115845, 0.021710826084017754, 0.028544222936034203, 0.00764721492305398, -0.02157631143927574, 0.017877129837870598, 0.010653640143573284, -0.022396856918931007, -0.034597426652908325, -0.015200269408524036, 0.03548523038625717, -0.002799607114866376, -0.010532575659453869, -0.04673073813319206, -0.0037529869005084038, 0.007142781279981136, -0.01161542721092701, -0.01107063889503479, 0.025800103321671486, 0.017850227653980255, -0.004866103641688824, -0.018522806465625763, 0.03136904910206795, -0.0203253161162138, -0.03026602230966091, -0.0014687428483739495, -0.013048018328845501, -0.034839555621147156, 0.005676560569554567, -0.026338165625929832, -0.02168392390012741, 0.020258057862520218, 0.02056744322180748, 0.0008339970954693854, 0.036426838487386703, -0.013041293248534203, 0.006207897327840328, 0.0037496238946914673, 0.007768278941512108, -0.00362183409743011, -0.010236641392111778, -0.007405086886137724, 0.018442096188664436, -0.012402343563735485, -0.03825625404715538, 0.0051923044957220554, -0.015778686851263046, 0.008003681898117065, 0.01776951737701893, 0.03548523038625717, 0.011790296994149685, -0.011050460860133171, -0.0015393635258078575, 0.034005556255578995, 0.016653038561344147, 0.022585177794098854, 0.03373652696609497, -0.014124143868684769, -0.014662206172943115, 0.0199755746871233, 0.004112815950065851, 0.00248685828410089, -0.0018529531080275774, 0.03685728833079338, 0.010835235938429832, 0.04543938860297203, 0.04928653687238693, 0.014635303057730198, 0.01772916316986084, -0.011749942786991596, 0.014299014583230019, 0.021482151001691818, 0.008010406978428364, -0.0007852351409383118, -0.0283828042447567, -0.01692206971347332, 0.001156834652647376, 0.01478327065706253, -0.0029845661483705044, -0.040166374295949936, 0.020163897424936295, 0.004546629264950752, 0.018280677497386932, -0.004048921167850494, -0.02452220395207405, 0.001673879218287766, -0.015536557883024216, 0.022047115489840508, -0.0031022673938423395, -0.023594046011567116, -0.0423993356525898, -0.02501991204917431, -0.0024212817661464214, 0.02301562950015068, 0.0006717375363223255, -0.03847147896885872, -0.004156533628702164, 0.034462910145521164, -0.017877129837870598, 0.009651497937738895, 0.05415600165724754, -0.0052259331569075584, -0.0024582736659795046, 0.01420485321432352, 0.007358006201684475, 0.01635710336267948, 0.008225631900131702, 0.00329731497913599, -0.026889679953455925, 0.00595568073913455, 0.027548806741833687, 0.00042288360418751836, -0.014500787481665611, 0.00721003906801343, 0.0008760332129895687, -0.020944086834788322, -0.03984353691339493, -0.013686968013644218, 0.014245208352804184, -0.02045983076095581, 0.025140976533293724, 0.004506274592131376, 0.006029664073139429, 0.010398060083389282, 0.00653409818187356, 0.0013972814194858074, -0.040623728185892105, 0.015213720500469208, -0.0011744898511096835, 0.024952653795480728, 0.010848687961697578, 0.0017402962548658252, 0.02098444290459156, 0.004240605980157852, 0.0010315669933333993, 0.025974974036216736, -0.0009819642873480916, 0.006231437902897596, 0.01271845493465662, 0.03500097244977951, 0.012772261165082455, 0.0010895768646150827, 0.009564063511788845, -0.03688419237732887, 0.00599267240613699, -0.026916582137346268, -0.0044356537982821465, -0.00528310239315033, 0.010256818495690823, 0.04175366088747978, 0.035027876496315, -0.008736792020499706, 0.0031829767394810915, -0.021845342591404915, 0.015025398693978786, -0.0029089010786265135, -0.03664206340909004, 0.02467017062008381, -0.0009516982827335596, 0.0627380982041359, -0.027454644441604614, -0.008501389063894749, -0.012516682036221027, -0.01849590241909027, 0.03833696246147156, -0.005871608387678862, -0.00860227644443512, -0.004048921167850494, 0.009133612737059593, 0.00781535916030407, 0.0211996678262949, -0.005757269915193319, -0.016343651339411736, 0.043179526925086975, -0.009866723790764809, -0.019962122663855553, 0.010841961950063705, 0.005787536036223173, 0.02582700550556183, 0.03368271887302399, 0.012772261165082455, -0.01667994074523449, 0.019625835120677948, -0.023109789937734604, 0.0075463284738361835, -0.018415194004774094, 0.017675356939435005, 0.012799164280295372, 0.009564063511788845, -0.036695871502161026, -0.02378236874938011, -0.035996388643980026, 0.04266836494207382, -0.02087683044373989, 0.016410909593105316, 0.014796721749007702, 0.029862476512789726, -0.01072089746594429, 0.031476665288209915, 0.005663109011948109, -0.006043115630745888, -0.030346732586622238, -0.00642984826117754, -0.01220729574561119, -0.004220428876578808, -0.01681445725262165, 0.0009710348676890135, -0.03061576373875141, -0.0033965203911066055, -0.008763695135712624, -0.010996654629707336, 0.0077481018379330635, 0.006954459473490715, 0.002024460583925247, -0.033090852200984955, 0.01583249308168888, 0.04091966152191162, 0.02526204101741314, 0.015845945104956627, -0.04285668954253197, -0.004038832616060972, -0.017177648842334747, 0.013828209601342678, 0.010714172385632992, -0.02235650271177292, -0.015455848537385464, 0.020069735124707222, 0.01635710336267948, 0.02263898402452469, 0.003763075452297926, -0.00977256242185831, 0.0027104904875159264, 0.0037563496734946966, -0.009153790771961212, 0.01594010554254055, -0.008205454796552658, -0.00768084404990077, 0.032956335693597794, 0.02945892885327339, -0.026190198957920074, -0.0017789695411920547, -0.014164499007165432, 0.007344554644078016, 0.0008735110168345273, 0.03360201045870781, 0.026391971856355667, -0.017648454755544662, -0.018482450395822525, 0.011622152291238308, -0.0075396024622023106, 0.020930636674165726, 0.006480291951447725, 0.004206977318972349, -0.006244889460504055, -0.019773801788687706, -0.025759747251868248, 0.006207897327840328, -0.005269650835543871, -0.014917786233127117, -0.011823926120996475, -0.013633161783218384, -0.018280677497386932, 0.009537160396575928, 0.008454308845102787, 0.000438857328845188, -0.04498203471302986, 0.015348236076533794, 0.006920830346643925, 0.010001239366829395, -0.026096036657691002, -0.014393175020813942, 0.01657232828438282, 0.003971574828028679, 0.012261101976037025, 0.04753783345222473, 0.007721198722720146, 0.01748703606426716, 0.005535319447517395, 0.012557036243379116, 0.008891484700143337, 0.0003390214988030493, 0.029701055958867073, 0.016128426417708397, 0.006527372170239687, -0.021213119849562645, 0.0013199348468333483, -0.01420485321432352, 0.001490601571276784, -0.025302395224571228, -0.01951822079718113, 0.004879555199295282, 0.007559780031442642, -0.00863590557128191, 0.037045612931251526, 0.029862476512789726, -0.006547549739480019, -0.027172163128852844, -0.03403246030211449, -0.0012787394225597382, 0.01731216534972191, -0.005942229181528091, -0.0008659445447847247, 0.02875944785773754, 0.016101524233818054, 0.02165701985359192, 0.0009020956349559128, -0.01072089746594429, 0.007983503863215446, 0.006379405036568642, -0.0161149762570858, 0.014473884366452694, -0.003541124751791358, 0.019572027027606964, 0.01958547905087471, -0.008965468034148216, -0.018630418926477432, -0.018590062856674194, 0.016168782487511635, -0.016653038561344147, 0.0034873182885348797, 0.01459494885057211, -0.009530434384942055, 0.03779890015721321, 0.034462910145521164, -0.025463813915848732, -0.02740083821117878, 0.04439016804099083, -0.0011433830950409174, -0.002253137296065688, -0.004882918205112219, -0.010135754942893982, -0.013061470352113247, -0.01482362486422062, 0.006729145534336567, -0.01696242392063141, 0.012429246678948402, 0.014554593712091446, -0.032983239740133286, -0.036803483963012695, -0.0066047185100615025, 0.0009928937070071697, 0.029701055958867073, -0.007869166322052479, -0.04565461352467537, -0.02323085442185402, 0.002856776351109147, 0.018590062856674194, -0.02011009119451046, -0.014675658196210861, -0.006352501921355724, -0.016034265980124474, 0.0008445060811936855, 0.0018680861685425043, -0.01864386908710003, 0.026149842888116837, -0.01674719899892807, 0.021643569692969322, 0.06419087201356888, 0.006170905660837889, 0.024643268436193466, -0.03561974689364433, -0.00670224241912365, 0.004893006756901741, -0.014796721749007702, 0.029593443498015404, -0.005040974356234074, 0.014541142620146275, -0.02011009119451046, -0.009564063511788845, 0.0022094196174293756, -0.012772261165082455, -0.002253137296065688, -0.02137453854084015, 0.019921768456697464, 0.00395812327042222, -0.006725782994180918, -0.01460839994251728, -0.03023912012577057, -0.05213826894760132, -0.01569797657430172, -0.008669533766806126, 0.01941060833632946, 0.03163808211684227, -0.007553054019808769, 0.004513000138103962, -0.006715693976730108, -0.007452167104929686, 0.00918069388717413, 0.01045859232544899, -0.0014023256953805685, -0.044928230345249176, 0.007169684395194054, 0.015550009906291962, 0.01028372161090374, -0.006147365551441908, 0.03370962291955948, -0.021764632314443588, 0.004082550294697285, 0.025948069989681244, 0.00029845660901628435, 0.0246970746666193, 0.004112815950065851, 0.048048991709947586, -0.010875591076910496, 0.047107383608818054, 0.013639887794852257, 0.03812173753976822, -0.053133685141801834, 0.0030669569969177246, 0.008279439061880112, 0.005420980975031853, 0.008447582833468914, -0.018805287778377533, 0.025463813915848732, -0.020244605839252472, 0.0025490715634077787, -0.02273314632475376, 0.012321634218096733, 0.01362643577158451, -0.005619391333311796, -0.003914405591785908, -0.011891184374690056, -0.007970052771270275, -0.02102479711174965, 0.046058159321546555, -0.007431990001350641, 0.02792545035481453, 0.0140165314078331, 0.01836138777434826, 0.018724579364061356, -0.007391635328531265, -0.002212782623246312, -0.012705003842711449, -0.006561001297086477, 0.031691890209913254, -0.02484504133462906, -0.01702968217432499, 0.020015928894281387, -0.019989026710391045, 0.007250393740832806, 0.003937945701181889, 0.013317049480974674, -0.0038740509189665318, 0.006059930194169283, 0.006581178400665522, -0.014621851965785027, -0.027266323566436768, 0.021347634494304657, -0.009274854324758053, -0.022087471559643745, 0.005542044993489981, 0.005383989308029413, -0.0430988147854805, -0.0012879874557256699, -0.004576895385980606, -0.02760261297225952, -0.030400538817048073, 0.004859378095716238, 0.05633515492081642, -0.04161914438009262, 0.01115807332098484, 0.008508115075528622, 0.028248287737369537, 0.0301315076649189, 0.04331403970718384, -0.019437512382864952, 0.01035097986459732, -0.014985044486820698, -0.007088975049555302, -0.009436273016035557, -0.011359847150743008, -0.004950175993144512, 0.021051699295639992, 0.021804988384246826, -0.02196640707552433, -0.010081948712468147, -0.007902794517576694, -0.0037496238946914673, 0.03048124723136425, 0.004647515714168549, 0.001962247071787715, -0.03787960857152939, 0.018065452575683594, 0.026930034160614014, -0.02999699115753174, 0.009321934543550014, 0.007922972552478313, 0.042587656527757645, 0.015200269408524036, 0.02421281859278679, 0.01242252066731453, 0.011689410544931889, -0.012005521915853024, -0.006056567188352346, 0.011763393878936768, 0.014366271905601025, 0.0019050779519602656, 0.03849837929010391, -0.017285261303186417, -0.021804988384246826, 0.008911661803722382, -0.02406485006213188, -0.019289545714855194, -0.020863378420472145, -0.00916051585227251, -0.011151348240673542, -0.013048018328845501, -0.025800103321671486, -0.015778686851263046, 0.06187720224261284, 0.027414290234446526, -0.01902051456272602, -0.018347935751080513, 0.006988088134676218, 0.006049841642379761, 0.005471424199640751, -0.0420495942234993, -0.005619391333311796, -0.0026802243664860725, -0.02063470147550106, -0.0028685464058071375, 0.04196888580918312, -0.00020334984583314508, 0.0091941449791193, 0.0016410909593105316, -0.0268089696764946, -0.03392484784126282, -0.003056868212297559, -0.02648613229393959, -0.015334784984588623, 0.01881873980164528, 0.004893006756901741, 0.020432928577065468, -0.023177048191428185, 0.002621373860165477, -0.008703162893652916, -0.03185330703854561, 0.012429246678948402, 0.01201897393912077, 0.03809483349323273, -0.030185313895344734, 0.025584878399968147, -0.00530664250254631, -0.01776951737701893, 0.019276093691587448, 0.002459955168887973, 0.012294731102883816, 0.03179950267076492]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
"., 2021; Zhao et al., 2023a).
It is typically composed of an input embedding layer, a stack of Transformer layers, and finally an output layer. Each
Transformer layer consists of cross-attention and/or self-attention modules (Bahdanau et al., 2015; Kim et al., 2017; Parikh
et al., 2016), a multi-layer perceptron (MLP), and layer normalization (LayerNorm (Ba et al., 2016) or RMSNorm (Zhang
& Sennrich, 2019)). Transformers can be categorized into three types: encoder-only, encoder-decoder, and decoder-only.
For the latter two, there is an output embedding matrix in the output layer, which transforms hidden states into logits on a
(typically large) vocabulary that can be used for generating tokens. An LLM can be learned by unsupervised pre-training,
e.g. minimizing the negative log-likelihood of next-token prediction on a large corpus (Radford et al., 2018; 2019). In this
work, we focus on the decoder-only generative pre-training (GPT) Transformer architecture (Radford et al., 2018; 2019),
though many of our ideas are widely applicable to other Transformer architectures or generic deep neural networks.
Early-exit LLMs. An early-exit neural network can be obtained by adding to a standard neural network some early-exit
layers that turn intermediate hidden states into early outputs (Xin et al., 2020; Schwartz et al., 2020). During inference
for a given input, the model starts a forward pass and decides (at each early exit) whether to return an output or continue
forwarding via certain rules, e.g. to return an output whenever the confidence of prediction is above a pre-defined threshold
(Schwartz et al., 2020; Schuster et al., 2022).
The standard way of training an early-exit model is to minimize a weighted sum of early-exit and final-exit training losses
(Schwartz et al., 2020; Schuster et al., 2022). Note that early-exit layers bring additional computational overhead to training.
This is especially the case for LLMs, primarily due to the large output embedding matrix of size h×Vwithin each early-exit
layer, where his the hidden dimension and Vis the vocabulary size. We call an early-exit layer minimalistic if it has the
same structure as the final output layer of the GPT model architecture (Radford et al., 2018; 2019), which includes an output
embedding matrix, plus an optional LayerNorm/RMSNorm in front of it. Additional modules can be added to early-exit
layers for increased expressivity and adaptivity of early exits.
3D parallelism. 3D parallelism refers to the combination of data, tensor, sequence and pipeline parallelism, and has been
implemented in state-of-the-art LLM frameworks such as Megatron-LM (Shoeybi et al., 2019; Narayanan et al., 2021b;
Korthikanti et al., 2022; Smith et al., 2022), DeepSpeed (Rasley et al., 2020; Smith et al., 2022), Mesh-TensorFlow (Shazeer
et al., 2018), Alpa (Zheng et al., 2022), InternLM (Team, 2023), among others. With data parallelism , each GPU handles
the forward and backward computation for one part of the data batch, and then the results are aggregated at the end of the
training iteration. When the model is too large to fit in a single GPU, model partitioning becomes necessary and can be
used in conjunction with data parallelism. With tensor (and sequence) parallelism , each large module (e.g. a linear layer) is
divided into multiple pieces that are assigned to different GPUs, so that each computational task related to it (e.g. large
matrix multiplication) can be divided into smaller tasks and solved in parallel. One major limitation of tensor (and sequence)
parallelism is that it requires expensive collective communication such as all-reduce operations, and thus is only viable for
high-end GPUs within the same computing node, with high-bandwidth communication among them.
Pipeline parallelism (Narayanan et al., 2019; 2021a; Fan et al., 2021; Li & Hoefler, 2021), on the other hand, partitions a
25
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
deep model along the depth dimension into multiple pipeline stages. Moreover, each","[-0.014322660863399506, 0.009081580676138401, 0.05455286055803299, -0.04109209403395653, 0.034526485949754715, 0.00015061371959745884, 0.007135980762541294, 0.0386585108935833, -0.009588577784597874, 0.06656868755817413, 0.0045407903380692005, -0.006457872223109007, -0.02526111900806427, -0.000572351913433522, -0.03931760415434837, -0.04897589609026909, 0.025565316900610924, -0.02143329195678234, 0.041142795234918594, 0.06819107383489609, 0.010735657997429371, -0.011084218509495258, -0.007091618608683348, 0.021547365933656693, 0.018594110384583473, 0.016160525381565094, 0.0035901714581996202, 0.04215678945183754, 0.009981500916182995, -0.017428016290068626, 0.048266101628541946, -0.03351249173283577, -0.03936830535531044, -0.004613671451807022, 0.0028581947553902864, 0.034374386072158813, 0.0388106107711792, 0.06261411309242249, -0.010355411097407341, 0.04917869344353676, 0.03485603258013725, -0.03652912378311157, -0.05232207477092743, 0.03148450329899788, -0.011248992756009102, 0.02821437455713749, 0.0023131731431931257, -0.006007912568747997, -0.038785260170698166, 0.058355338871479034, 0.000904672488104552, 0.016591472551226616, -0.027327129617333412, 0.020343249663710594, -0.04314543306827545, -0.010767345316708088, -0.020748846232891083, -0.018860282376408577, 0.00684445770457387, -0.005494578275829554, 0.011578540317714214, -0.02418375015258789, 0.0179350133985281, -0.0042936294339597225, -0.008061249740421772, 0.005928694270551205, -0.0581018403172493, 0.021737489849328995, -0.02589486353099346, 0.05414726212620735, -0.0194053053855896, -0.006527584511786699, -0.002343276049941778, -0.00785211380571127, -0.0110398568212986, 0.029355118051171303, 0.009316067211329937, 0.06342530995607376, -0.004036962520331144, -0.007028243970125914, 0.03024236299097538, -0.026439886540174484, 0.025286467745900154, -0.02119246870279312, 0.0006495896959677339, -0.017073119059205055, 0.0005204639746807516, -0.01368891540914774, -0.039748553186655045, -0.035084180533885956, 0.01849270984530449, -0.03475463390350342, -0.0418272390961647, 0.03663052245974541, 0.040306251496076584, 0.04132024198770523, 0.0035109531600028276, -0.050623636692762375, 0.015678877010941505, 0.0721963495016098, -0.009829401038587093, 0.024754121899604797, 0.03475463390350342, -0.04238493740558624, 0.007661989890038967, -0.04314543306827545, -0.019025057554244995, -0.02036859840154648, -0.02605963870882988, -0.008714008145034313, -0.031129606068134308, -0.010672283358871937, 0.0037169207353144884, 0.0020992837380617857, 0.03483068570494652, -0.05318396911025047, -0.029988864436745644, 0.01920250616967678, 0.0022672265768051147, 0.023879552260041237, -0.0066606709733605385, -0.01137574203312397, 0.01147714164108038, 0.008618946187198162, 0.005266429856419563, -0.001809344976209104, 0.015425379388034344, -0.0291269700974226, 0.03630097582936287, 0.007383141666650772, -0.016680195927619934, 0.02593288943171501, 0.043525680899620056, -0.03630097582936287, -0.02940581738948822, -0.011489816009998322, -0.059267930686473846, 0.01602110080420971, -0.021572716534137726, -0.009201993234455585, 0.034729283303022385, -0.011160268448293209, 0.01761814020574093, 0.022814858704805374, -0.02697223238646984, 0.05178972706198692, -0.02801157534122467, 0.030774708837270737, -0.061346620321273804, 0.016781596466898918, -0.0264905858784914, -0.022447286173701286, -0.0165407732129097, 0.002401897683739662, -0.03168730437755585, -0.00675573293119669, -0.031231006607413292, 0.0669235810637474, 0.07681002467870712, -0.04547761753201485, -0.0031322899740189314, 0.01159755326807499, 0.027479229494929314, 0.02327115647494793, -0.002512803068384528, 0.06236061453819275, -0.03024236299097538, -0.0021278024651110172, -0.07493413239717484, -0.058355338871479034, -0.009607590734958649, -0.027073631063103676, -0.06540259718894958, -0.01494373194873333, 0.025438567623496056, -0.027605978772044182, -0.059470731765031815, -0.03992600366473198, -0.013055169023573399, -0.08852165192365646, -0.05566825345158577, 0.030419811606407166, -0.017757564783096313, 0.01059623435139656, -0.06256341189146042, 0.022054363042116165, 0.008815407752990723, 0.02258671075105667, 0.0026252930983901024, 0.04570576548576355, -0.004724577069282532, 0.03744171932339668, 0.04157374054193497, 0.037112168967723846, 0.015387354418635368, 0.010336398147046566, 0.05206857621669769, -0.0010892510181292892, 0.01840398646891117, -0.03171265497803688, 0.05308257043361664, 0.024513298645615578, -0.0053076231852173805, -0.083198182284832, 0.0474042072892189, 0.00750989094376564, -0.020140450447797775, 0.007890138775110245, -0.00442354753613472, -0.028265073895454407, 0.006052274722605944, 0.009848413988947868, 0.022979632019996643, -0.0021087899804115295, 0.005225236527621746, -0.023930251598358154, -0.06327320635318756, 0.0167689211666584, 0.04499597102403641, 0.021585391834378242, 0.01665484718978405, 0.037669867277145386, -0.0013237370876595378, 0.01877155900001526, -0.07321034371852875, 0.020622096955776215, 0.01728859357535839, -0.06484489887952805, 0.027783427387475967, 0.013219943270087242, 0.010913107544183731, -0.017909664660692215, -0.012738295830786228, -0.03726426884531975, 0.005573796574026346, -0.03475463390350342, 0.0005850268644280732, -0.01428463589400053, 0.016781596466898918, -0.03957110270857811, 0.008783720433712006, 0.02139526791870594, 0.008092937059700489, -0.013397391885519028, -0.020153125748038292, 0.02813832461833954, 0.0024098195135593414, -0.0579497404396534, 0.02948186732828617, 0.010894094593822956, 0.009005531668663025, -0.0334617905318737, -0.0360981747508049, 0.0004067857516929507, -0.03701077029109001, 0.053133271634578705, -0.031180307269096375, -0.01448743510991335, -0.04043300077319145, -0.009747014380991459, -0.006226554978638887, 0.05059828609228134, 0.027276430279016495, 0.03239709883928299, 0.017478715628385544, -0.00920832995325327, -0.03693472221493721, -0.005824126303195953, 0.012478459626436234, -0.014348010532557964, 0.03845570981502533, -0.040306251496076584, -0.008219686336815357, 0.020115099847316742, -0.054096564650535583, -0.019177155569195747, 0.06175221502780914, 0.008162649348378181, 0.0030055406969040632, 0.041016045957803726, -0.010425122454762459, -0.006093468517065048, 0.04917869344353676, 0.03044516034424305, 0.0022767328191548586, 0.002138892887160182, -0.0276566781103611, 0.0074275038205087185, -0.03457718715071678, -0.032777346670627594, 0.03295479714870453, -0.0034570847637951374, 0.0117179648950696, -0.021344566717743874, 0.04436222463846207, 0.009214667603373528, -0.009290717542171478, 0.034095536917448044, -0.008118286728858948, -0.0022767328191548586, -0.0029770222026854753, -0.028797421604394913, -0.012890394777059555, -0.0025745932944118977, -0.020812220871448517, 0.04963499307632446, -0.038151513785123825, -0.001532873255200684, -0.00775071419775486, 0.00675573293119669, -0.012453109957277775, -0.01477895863354206, 0.0117179648950696, 0.02553996630012989, -0.008340097963809967, 0.005662520881742239, -0.001986793940886855, -0.05293047055602074, 0.0001143713598139584, -0.05739204213023186, -0.01574225164949894, -0.03713751956820488, -0.019063081592321396, -0.024487948045134544, 0.020064400508999825, 0.00259519019164145, -0.017402667552232742, -0.022776832804083824, -0.03303084522485733, -0.010051212273538113, 0.029177669435739517, -0.028062276542186737, -0.002389222616329789, -0.012693934142589569, -0.011730639263987541, -0.025882190093398094, -0.04266378656029701, 0.024766797199845314, 0.05435006320476532, -0.011306029744446278, -0.0695599690079689, 0.030293062329292297, -0.03439973667263985, 0.037112168967723846, -0.03318294510245323, 0.07473133504390717, 0.003941900562494993, 0.01773221418261528, 0.08147439360618591, 0.010773682966828346, -0.014918382279574871, -0.038835957646369934, 0.011407429352402687, -0.024766797199845314, 0.02016579918563366, -0.0002738971379585564, 0.03189010173082352, -0.01901238225400448, 0.0165407732129097, 0.011065206490457058, -0.0471000075340271, 0.011001831851899624, 0.01979822665452957, 0.01334669254720211, -0.05176438018679619, 0.03493208438158035, -0.016882995143532753, 0.046719759702682495, 0.010995494201779366, -0.01745336689054966, 0.04350033029913902, 0.04780980199575424, 0.010887757875025272, 0.022447286173701286, -0.013714265078306198, 0.015057806856930256, -0.0024700253270566463, 0.019253205507993698, -0.0055294344201684, 0.03318294510245323, 0.02016579918563366, 0.036072827875614166, 0.0016002088086679578, 0.0022181111853569746, -0.021534690633416176, 0.05105458199977875, 0.003992600366473198, -0.040509048849344254, -0.02697223238646984, 0.007820426486432552, -0.0022450454998761415, -0.013017144054174423, -0.024133050814270973, 0.023892227560281754, 0.01901238225400448, -0.02581881545484066, 0.02131921797990799, 0.011077880859375, 0.031459156423807144, 0.0010124093387275934, -0.02932976745069027, -0.029912814497947693, -0.018822258338332176, -0.025197744369506836, 0.057442743331193924, -0.0035172905772924423, 0.0641351044178009, 0.011806689202785492, 0.03952040523290634, 0.02111641876399517, 0.06555469334125519, -0.013359366916120052, 0.01446208544075489, -0.03622492402791977, 0.02414572425186634, -0.012567184865474701, 0.01884760893881321, -0.0048703383654356, 0.016832295805215836, 0.05262627452611923, -0.011293355375528336, -0.006584621500223875, -0.036605171859264374, -0.03115495666861534, -0.013752290047705173, -0.003034059191122651, 0.03191545233130455, -0.02382885292172432, -0.027986226603388786, -0.05115598067641258, -0.01358751580119133, 0.008118286728858948, 0.012345373630523682, -0.014195911586284637, -0.03972320258617401, -0.010646933689713478, -0.036123525351285934, 0.041421644389629364, -0.015678877010941505, -0.024830171838402748, 0.028265073895454407, 0.02035592310130596, -0.021648766472935677, -0.02131921797990799, -0.03561652824282646, -0.008390798233449459, -0.05749344453215599, 0.00012179807526990771, -0.020305223762989044, -0.03333504498004913, 0.02358802780508995, 0.02204168774187565, 0.06388160586357117, 0.017263242974877357, -0.0005062046693637967, -0.06748127937316895, 0.08705136179924011, -0.002420909935608506, 0.04327218234539032, -0.01873353309929371, 0.041066743433475494, -0.03802476450800896, -0.014018462970852852, -0.05450216308236122, -0.009816726669669151, 0.005342479329556227, 0.04798725247383118, -0.016439372673630714, 0.020938970148563385, 0.01185738854110241, 0.009423804469406605, -0.015754926949739456, 0.043652430176734924, -0.006787420250475407, -0.006521246861666441, 0.02382885292172432, 0.018239211291074753, -0.03016631305217743, 0.019950326532125473, -0.018429335206747055, 0.04220748692750931, -0.030293062329292297, -0.01294743176549673, -0.025882190093398094, 0.01932925544679165, 0.07224705070257187, -0.018670158460736275, -0.015412704087793827, -0.007883801124989986, -0.002937413053587079, 0.01769419014453888, -0.009221005253493786, 0.024133050814270973, -0.013321341946721077, -0.0025983587838709354, -0.00948084145784378, -0.046364862471818924, -0.054451461881399155, -0.014905707910656929, 0.003596508875489235, 0.04689721018075943, -0.02370210364460945, 0.006318448111414909, 0.02458934672176838, 0.02382885292172432, -0.012972782365977764, 0.033208295702934265, 0.010266685858368874, -0.01706044375896454, -0.0033968789502978325, -0.007566927932202816, 0.0017016081837937236, -0.0031465492211282253, 0.026363836601376534, 0.006140999495983124, 0.034323688596487045, -0.027783427387475967, 0.02598358877003193, -0.00431264191865921, 0.03031841106712818, 0.016287274658679962, 0.01018429920077324, -0.033132243901491165, 0.005000256467610598, -0.005130174569785595, -0.011261668056249619, -0.016870319843292236, -0.05211927741765976, -0.029988864436745644, -0.0009086334030143917, 0.013764964416623116, -0.0031402118038386106, -0.016959045082330704, -0.005076305940747261, -0.06220851466059685, -0.009639278054237366, -0.01897435635328293, -0.032168950885534286, -0.07990270107984543, -0.029659315943717957, 0.0007525734836235642, 0.03401948884129524, 0.03366459161043167, 0.04007809981703758, -0.012497472576797009, 0.003400047542527318, 0.00908791832625866, -0.01261154655367136, 0.0030768371652811766, 0.03769521787762642, 0.026161037385463715, -0.026084987446665764, 0.005488241091370583, -0.031535204499959946, -0.040585096925497055, 0.004458403680473566, 0.014335336163640022, 0.011990475468337536, -0.015463404357433319, 0.010330060496926308, 0.012865045107901096, -0.00016101110668387264, 0.023600703105330467, -0.03183940425515175, -0.00237654778175056, 0.02044464834034443, -0.002823338843882084, -0.035286981612443924, 0.010196974501013756, -0.0018489541253075004, -0.02605963870882988, -0.012972782365977764, 0.02068547159433365, -0.023651402443647385, -0.013055169023573399, -0.01741534285247326, -0.01237072329968214, 0.026110338047146797, 0.006055443547666073, 0.01685764454305172, -0.04570576548576355, -0.017922338098287582, -0.0024351691827178, -0.02490621991455555, -0.02533716708421707, 0.013473441824316978, -0.0774691179394722, -0.00850487221032381, -0.04905194416642189, 0.03485603258013725, 0.04208073765039444, -0.03969785198569298, -0.0047499267384409904, -0.04857029765844345, -0.03303084522485733, -0.022181112319231033, 0.004471078515052795, -0.01574225164949894, -0.03232105076313019, -0.012396072968840599, 0.018910981714725494, -0.007985200732946396, -0.000531158410012722, -0.018518060445785522, -0.000454712804639712, 0.0030625779181718826, -0.029735365882515907, 0.01765616610646248, 0.009772364050149918, -0.023740127682685852, -0.005180873908102512, -0.007135980762541294, -0.0007478203624486923, -0.03462788462638855, -0.01892365701496601, 0.002161074196919799, -0.01059623435139656, 0.003097433829680085, 0.04555366560816765, 0.008130962029099464, 0.020710822194814682, -0.00928437989205122, -0.013105868361890316, 0.0002661733597051352, 0.02055872231721878, -0.019975675269961357, -0.010691296309232712, -0.02128119207918644, -0.037188220769166946, 0.018670158460736275, -0.03741636872291565, 0.009201993234455585, 0.03957110270857811, 0.030774708837270737, 0.013967763632535934, 0.02697223238646984, -0.029836764559149742, -0.0025207248982042074, -0.0022830702364444733, -0.03908945620059967, -0.032295700162649155, 0.012554509565234184, 0.00562766520306468, -0.012890394777059555, -0.006876145023852587, 0.022345885634422302, -0.014816982671618462, 0.01621122471988201, -0.0010044875089079142, -0.018898308277130127, -0.02131921797990799, -0.03161125257611275, 0.05673294886946678, 0.0360981747508049, 0.01976020261645317, -0.003732764394953847, -0.002539737382903695, -0.028062276542186737, -0.007763389497995377, -0.002403481863439083, -0.041599091142416, -0.02401897683739662, -0.022561360150575638, 0.006983881816267967, 0.0009815142257139087, 0.04955894127488136, 0.03168730437755585, 0.022383911535143852, -0.0003148925898130983, -0.01665484718978405, -0.03574327751994133, 0.013790314085781574, 0.008764708414673805, -0.006251905113458633, 0.0020359093323349953, -0.03637702390551567, -0.009113267995417118, -0.042131438851356506, 0.011648252606391907, 0.013853688724339008, -0.02546391636133194, 0.008872444741427898, -0.053336068987846375, 0.0045661404728889465, -0.006831782404333353, 0.013410067185759544, -0.012453109957277775, -0.0067240456119179726, 0.01438603550195694, 0.01424661185592413, -0.019037730991840363, -0.005687871016561985, 0.011819364503026009, -0.04314543306827545, 0.015970401465892792, -0.013143893331289291, -0.01996300183236599, 0.07326104491949081, -0.0032067550346255302, -0.011743314564228058, -0.011109568178653717, 0.020469997078180313, -0.03678262233734131, 0.02251066081225872, -0.013980438001453876, -0.01470290869474411, -0.03827826306223869, 0.024411898106336594, 0.04689721018075943, -0.029025569558143616, -0.04547761753201485, 0.003254286013543606, 0.015146531164646149, -0.001627143006771803, -0.019899627193808556, -0.010627921670675278, 0.009728002361953259, -0.00936042983084917, -0.03242244943976402, -0.007744377013295889, -0.03749241679906845, -0.011591215617954731, -0.03493208438158035, 0.005488241091370583, 0.0006404796149581671, -0.01560282800346613, -0.053538866341114044, 0.028949519619345665, -0.00896750669926405, 0.013625540770590305, 0.028873471543192863, 0.0032701296731829643, 0.010247673839330673, -0.03784731402993202, -0.004803795367479324, -0.002726692473515868, -0.024057000875473022, -0.021623415872454643, -0.02104036882519722, -0.01047582272440195, -0.01404381264001131, -0.01268759649246931, -0.007091618608683348, 0.02195296436548233, 0.033563192933797836, 0.011483478359878063, 0.03716287016868591, 0.033056195825338364, 0.0234359297901392, -0.01422126218676567, -0.028163675218820572, 0.009785039350390434, 0.00695219449698925, 0.010456809774041176, -0.024373874068260193, -0.0003608391562011093, 0.03642772510647774, -0.005247417371720076, 0.007820426486432552, -0.04426082596182823, 0.02012777514755726, -0.005576965399086475, -0.010133599862456322, 0.0386585108935833, 0.00597622524946928, -0.019950326532125473, -0.04271448403596878, -0.00862528383731842, 0.018112462013959885, 0.019456004723906517, -0.009037218987941742, -0.007940838113427162, 0.03642772510647774, 0.007338779512792826, 0.010894094593822956, 0.002517556305974722, 0.015907026827335358, 0.005881163291633129, 0.004822807386517525, 0.007693677209317684, -0.017364641651511192, -0.01351146586239338, 0.022700784727931023, -0.016844971105456352, -0.02251066081225872, -0.018632134422659874, -0.04552831873297691, 0.009905450977385044, 0.005985731724649668, -0.05176438018679619, -0.02955791726708412, 0.004233423620462418, 0.016071800142526627, -0.029177669435739517, -0.01470290869474411, 0.05769624188542366, 0.005066799931228161, -0.1106267124414444, -0.01968415267765522, 0.015374680049717426, 0.0018125138012692332, 0.0165407732129097, 0.00498124398291111, 0.027276430279016495, 0.007528903428465128, 0.012301011011004448, -0.04882379621267319, -0.0025096344761550426, -0.006483222357928753, 0.010450473055243492, 0.0059508755803108215, 0.02171214111149311, -0.05713854357600212, 0.008352773264050484, -0.018378635868430138, 0.027428530156612396, -0.019709503278136253, -0.006388160400092602, -0.014893032610416412, -0.0008571415673941374, -0.003720089327543974, -0.035008132457733154, -0.015032456256449223, -0.003390541533008218, -0.010133599862456322, -0.01988695189356804, 0.017922338098287582, -0.023093705996870995, -0.014652209356427193, 0.003133874386548996, 0.012364385649561882, -0.027276430279016495, -0.00607762485742569, -0.013448091223835945, -0.028112975880503654, 0.010811707936227322, 0.008498534560203552, -0.011096893809735775, -0.04312008246779442, 0.03597142547369003, -0.010634259320795536, 0.019189830869436264, 0.012484797276556492, 0.013993113301694393, 0.0005359115311875939, 0.024538647383451462, -0.0007117760251276195, 0.00850487221032381, -0.013802989386022091, 0.0048608323559165, 0.028873471543192863, 0.006388160400092602, -0.0054628909565508366, -0.0031132774893194437, 0.004562971647828817, 0.009290717542171478, 0.05021803826093674, -0.013448091223835945, 0.005662520881742239, -0.0018838101532310247, -0.02702293172478676, -0.027276430279016495, 0.00775071419775486, 0.019151806831359863, 0.013650890439748764, -0.01071664597839117, -0.06535189598798752, -0.008390798233449459, 0.015767602249979973, 0.017554765567183495, 0.0006369148031808436, 0.011654590256512165, 0.017504066228866577, -0.004667539615184069, 0.06555469334125519, -0.01626192405819893, 0.0010195389622822404, 0.001772904652170837, -0.008555571548640728, -0.0046897209249436855, -0.004097168333828449, 0.02566671557724476, 0.003289142157882452, 0.028062276542186737, -0.02932976745069027, -0.022105062380433083, 0.06018052622675896, 0.039951350539922714, -0.017795588821172714, 0.007744377013295889, 0.007769726682454348, 0.016794269904494286, -0.002767886035144329, 0.015805626288056374, 0.03386738896369934, 0.03825291246175766, -0.014994432218372822, 0.054806359112262726, 0.04606066271662712, -0.09739409387111664, -0.038075461983680725, -0.007364129181951284, 0.0030800059903413057, 0.012066525407135487, 0.00930339191108942, 0.013676240108907223, -0.020799545571208, 0.008992856368422508, -0.0037707891315221786, 0.006359641905874014, 0.046035315841436386, 0.008479522541165352, 0.024082351475954056, 0.04646626114845276, 0.003501446917653084, 0.040585096925497055, -0.007604952901601791, -0.004952725488692522, 0.02529914304614067, -0.029228368774056435, 0.015729578211903572, -0.03957110270857811, -0.016236573457717896, 0.021496666595339775, 0.038709208369255066, -0.022003663703799248, -0.002148399129509926, -0.020343249663710594, -0.0024636879097670317, 0.014842333272099495, -0.03171265497803688, -0.024373874068260193, 0.019709503278136253, -0.006869807373732328, 0.04892519488930702, -0.03805011510848999, 0.03825291246175766, 0.010672283358871937, -0.010152611881494522, 0.018137812614440918, -0.020710822194814682, 0.019101105630397797, 0.0074591911397874355, 0.017592791467905045, -0.02107839472591877, -0.010894094593822956, 0.0008001044043339789, 0.05384306609630585, 0.005675196181982756, -0.011033519171178341, 0.015869000926613808, -0.00014011729217600077, 0.012288336642086506, -0.017478715628385544, -0.01932925544679165, -0.005488241091370583, 0.030293062329292297, 0.03485603258013725, 0.041624441742897034, -0.009005531668663025, 0.008200674317777157, 0.004464740864932537, -0.01313121896237135, -0.0021262180525809526, -0.0039545753970742226, -0.03853176161646843, 0.008777382783591747, -0.0010337983258068562, -0.04471712186932564, 0.03419693931937218, 0.016008425503969193, 0.023892227560281754, -0.008853432722389698, -0.02219378761947155, 0.02267543412744999, -0.0029263223987072706, 0.01749139092862606, -0.009392117150127888, 0.022890908643603325, -0.020381273701786995, 0.026642683893442154, -0.004946387838572264, 0.00034816423431038857, 0.0025333999656140804, 0.004629515111446381, 0.00928437989205122, 0.030064912512898445, 0.014652209356427193, 0.0330815464258194, 0.011312367394566536, 0.029988864436745644, -0.0020359093323349953, -0.024437248706817627, 0.019810901954770088, 0.01817583665251732, -0.02717503160238266, -0.03510953113436699, -0.030850758776068687, 0.04585786536335945, -0.0055864714086055756, -0.015526778995990753, -0.05303186923265457, 0.0034982783254235983, 0.011077880859375, -0.005139680579304695, -0.02960861660540104, 0.03721356764435768, 0.0036788959987461567, -0.011895413510501385, 0.0021230492275208235, 0.028341123834252357, -0.0021214650478214025, -0.018277237191796303, 0.02024184912443161, -0.02072349563241005, -0.014753608033061028, 0.012085537426173687, -0.036757271736860275, -0.025831488892436028, 0.028163675218820572, -0.010684958659112453, 0.0046263462863862514, 0.02135724201798439, -0.018074437975883484, 0.023461278527975082, -0.013295992277562618, 0.002194345695897937, 0.01637599803507328, 0.013055169023573399, -0.0009617096511647105, 0.028417173773050308, -0.015552128665149212, -0.021268518641591072, -0.001763398409821093, 0.0017332955030724406, 0.022700784727931023, 0.009550552815198898, 0.03120565600693226, 0.006090299692004919, -0.016844971105456352, -0.0018251886358484626, 0.01725056767463684, 0.025844164192676544, 0.027352480217814445, 0.015919702127575874, -0.011977801099419594, -0.019532054662704468, 0.023321855813264847, 0.005931863095611334, 0.0005612613749690354, -0.00787112582474947, 0.027301780879497528, 0.009221005253493786, 0.03358853980898857, 0.039469704031944275, 0.021927613765001297, 0.024513298645615578, -0.016781596466898918, 0.033563192933797836, 0.02267543412744999, 0.0023416916374117136, 0.0028170011937618256, -0.011439116671681404, -0.029912814497947693, -0.0006365187000483274, 0.02403165027499199, 0.014740933664143085, -0.025869514793157578, 0.010374423116445541, -0.003476097248494625, 0.017199868336319923, 0.016477398574352264, -0.005830463953316212, 0.00012714530748780817, -0.00441404152661562, 0.033132243901491165, 0.020102424547076225, -0.028163675218820572, -0.041421644389629364, -0.015450729057192802, -0.017782915383577347, 0.01438603550195694, -0.005031943786889315, -0.036275625228881836, 0.006153674330562353, 0.0388106107711792, -0.006698695942759514, -0.004357004072517157, 0.012560847215354443, 0.010963806882500648, -0.0010068640112876892, 0.018594110384583473, 0.00396408187225461, 0.009981500916182995, 0.00684445770457387, 0.02542589232325554, -0.038354311138391495, 0.005174536723643541, 0.002558749634772539, 0.005906513426452875, -0.04040765017271042, 0.00618536164984107, 0.001174014643765986, -0.011052531190216541, -0.054603561758995056, -0.023207781836390495, 0.005706883501261473, -0.02175016514956951, 0.013701589778065681, 0.006584621500223875, 0.012903070077300072, 0.019494028761982918, 0.02849322371184826, -6.797917012590915e-05, -0.04124419391155243, 0.011223643086850643, 0.011363066732883453, 0.003926056902855635, 0.014031138271093369, -0.010627921670675278, 0.0042302547954022884, -0.00991812627762556, -0.013473441824316978, 0.035996776074171066, -0.004217579960823059, 0.0192912295460701, 0.018543409183621407, 0.03211824968457222, -0.006248736288398504, -0.008802732452750206, 0.009449154138565063, -0.03734031692147255, -0.006609971635043621, -0.013600190170109272, -0.0007779232691973448, 0.011851051822304726, -0.007719026878476143, 0.03427298739552498, 0.024196425452828407, -0.004128855653107166, 0.007059931289404631, -0.007535240612924099, 0.007655652705579996, -0.021699465811252594, -0.032777346670627594, 0.03457718715071678, -0.004455234855413437, 0.04669440910220146, -0.028239725157618523, -0.0013102700468152761, -0.01709846965968609, -0.02286555804312229, 0.04033159837126732, -0.018910981714725494, -0.00024181373009923846, -0.010368085466325283, 0.006451535038650036, 0.008029562421143055, 0.017478715628385544, -0.02199098840355873, -0.029735365882515907, 0.053488168865442276, -0.013841014355421066, -0.0165787972509861, 0.015526778995990753, 0.011008169502019882, 0.023955602198839188, 0.028619972988963127, 0.023689428344368935, -0.005507253110408783, -0.0006436483236029744, -0.018302585929632187, -7.981239468790591e-05, -0.018087113276124, 0.02171214111149311, 0.013853688724339008, 0.013410067185759544, -0.026870833709836006, -0.04258773475885391, -0.017187193036079407, 0.036960069090127945, -0.026287786662578583, 0.025603340938687325, 0.022890908643603325, 0.02422177419066429, -0.03503348305821419, 0.015564803034067154, 0.012535497546195984, -0.01836596056818962, -0.012091875076293945, -0.0020311560947448015, -0.024563997983932495, 0.009734340012073517, -0.01448743510991335, -0.0046580336056649685, -0.0011336132884025574, -0.004921038169413805, -0.0033683604560792446, 0.00476260157302022, 0.010748333297669888, 0.010944794863462448, 0.0249822698533535, -0.022928932681679726, 0.009747014380991459, 0.04522411897778511, 0.009379441849887371, 0.001336412038654089, -0.038354311138391495, -0.0025270625483244658, -0.025248443707823753, 0.03505883365869522, 0.012941095046699047, -0.027986226603388786, -0.015349329449236393, 0.0010448888642713428, -0.02003904990851879, 0.021053044125437737, 0.01897435635328293, -0.011325041763484478, 0.01268759649246931, -0.009278042241930962, -0.01181302685290575, 0.015349329449236393, -0.003929225727915764, -0.008314748294651508, 0.012193274684250355, 0.02968466654419899, -0.02553996630012989, 0.003577496623620391, -0.008650633506476879, 0.019823577255010605, -0.0064451973885297775, 0.01773221418261528, 0.013929738663136959, -0.020533371716737747, -0.009886438958346844, 0.009081580676138401, -0.0018362791743129492, 0.026794783771038055, 0.03267594799399376, 0.012662246823310852, -0.008764708414673805, -0.020976994186639786, -0.0357179269194603, -5.094724110676907e-05, 0.014208586886525154, 0.004623177461326122, -3.0177205189829692e-05, -0.0022909920662641525, -0.02180086448788643, 0.006705033592879772, -0.0024288317654281855, 0.010583559051156044, -0.03189010173082352, 0.014107187278568745, 0.004718239419162273, -0.00964561477303505, -0.027048282325267792, -0.02104036882519722, 0.019557403400540352, -0.01979822665452957, 0.03652912378311157, 0.03505883365869522, 0.010209648869931698, 0.0467958077788353, -0.00375494547188282, -0.009949813596904278, 0.03526163101196289, -0.004927375819534063, 0.04631416127085686, 0.009290717542171478, -0.0036028462927788496, -0.021724814549088478, -0.0035521467216312885, -0.024792145937681198, -0.00719301775097847, -0.022409260272979736, -0.004021118860691786, -0.0054565537720918655, 0.025793464854359627, -0.014931057579815388, 0.030343761667609215, 0.019544728100299835, 0.010292036458849907, -0.029076268896460533, -0.0015970401000231504, 0.015133855864405632, 0.0276566781103611, 0.019417978823184967, 0.012922082096338272, 0.02434852346777916, 0.027479229494929314, -0.0004511479928623885, 0.0002796404587570578, -0.006679683458060026, 0.0028090793639421463, -0.013080518692731857, -0.02271345816552639, 0.0027520423755049706, -0.011071544140577316, 0.009899113327264786, -0.004477416165173054, -0.024158399552106857, -0.021737489849328995, -0.020622096955776215, 0.009905450977385044, -0.005196717567741871, 0.018987031653523445, 0.009892775677144527, -0.018074437975883484, 0.022776832804083824, 0.03262524679303169, -0.01697172038257122, -0.027631329372525215, 0.03031841106712818, -0.0030055406969040632, 0.005098487250506878, 0.006749395746737719, -0.004217579960823059, -0.00408449349924922, -0.018670158460736275, -0.005165030248463154, -0.02793552726507187, 0.006090299692004919, 0.017630815505981445, -0.021015020087361336, -0.015590153634548187, -0.014107187278568745, 0.007776064332574606, 0.012554509565234184, -0.004480584524571896, -0.03189010173082352, -0.007262730039656162, -0.015450729057192802, 0.01251014694571495, -0.016274599358439445, -0.02148399129509926, -0.004258773755282164, -0.029355118051171303, 0.00763030257076025, -0.008460509590804577, -0.019582754001021385, 0.026389185339212418, -0.007921826094388962, 0.05156157910823822, 0.04555366560816765, 0.009892775677144527, 0.028797421604394913, -0.025197744369506836, -0.012598872184753418, 0.002954841125756502, -0.02092629484832287, 0.01752941682934761, 0.0041953991167247295, 0.010811707936227322, 0.004021118860691786, -0.028873471543192863, 0.0012064940528944135, -0.02953256666660309, -0.0035743277985602617, -0.017668839544057846, 0.025958238169550896, 0.007294417358934879, -0.0055547840893268585, -0.0016477397875860333, -0.032092899084091187, -0.048747748136520386, 0.008612609468400478, 0.003932394552975893, 0.0035838340409100056, 0.01984892599284649, -0.01151516567915678, -0.005947706755250692, -0.004550296813249588, 0.0006357265519909561, 0.02613568864762783, 0.025096343830227852, -0.020571397617459297, -0.03206755220890045, 0.01327064260840416, 0.007161330431699753, -0.004395029041916132, 0.0004499597125686705, 0.02526111900806427, -0.01697172038257122, 0.00507947476580739, 0.022447286173701286, 0.0054248664528131485, 0.02553996630012989, 0.02358802780508995, 0.031332407146692276, -0.0035743277985602617, 0.0471760556101799, 0.026642683893442154, 0.04684650897979736, -0.036123525351285934, 0.018023738637566566, 0.0021468147169798613, 0.018302585929632187, 0.017960363999009132, -0.01013993751257658, 0.024525972083210945, -0.01169261522591114, -0.010425122454762459, -0.025400541722774506, 0.01629994809627533, 0.017085794359445572, -0.0036218587774783373, -0.011908088810741901, 0.00797252543270588, -0.017504066228866577, -0.021167118102312088, 0.043855227530002594, -0.02793552726507187, 0.018163161352276802, -0.006163180340081453, 0.005345648154616356, 0.004249267280101776, -0.011724302545189857, -0.001722204964607954, -0.02295428328216076, -0.004404535051435232, 0.022168437018990517, -0.0387345589697361, 0.014018462970852852, 0.02884812094271183, -0.023245805874466896, -0.005741739179939032, 0.015881676226854324, -0.01777024008333683, -0.010044875554740429, 0.0021087899804115295, -0.004708733409643173, -0.0077000148594379425, -0.006083962041884661, 0.021458642557263374, -0.003038812428712845, -0.011946113780140877, 0.01008289959281683, 0.02399362623691559, -0.03214360028505325, -0.012801670469343662, 0.0021594897843897343, -0.014690233394503593, -0.03756846860051155, -0.007288079708814621, 0.07270334661006927, -0.03374063968658447, -0.0025730091147124767, 0.009157630614936352, 0.04362707957625389, 0.02960861660540104, 0.03645307198166847, -0.0390387587249279, 0.007560590747743845, -0.014233936555683613, -0.008675984106957912, 0.007370466832071543, -0.01828991062939167, -0.011147593148052692, -0.0033239980693906546, 0.010805370286107063, -0.028112975880503654, 0.0011122243013232946, -0.008447835221886635, 0.007560590747743845, 0.05184042826294899, -0.005459722597151995, -0.008916807360947132, -0.017478715628385544, 0.022257162258028984, 0.051460180431604385, -0.012763645499944687, 0.02752992883324623, 0.009658290073275566, 0.026744084432721138, 0.007598615251481533, 0.04220748692750931, 0.026718733832240105, 0.009119605645537376, -0.002927906811237335, -0.0026110338512808084, 0.01200948841869831, 0.017035095021128654, 0.013498791493475437, 0.04235958680510521, -0.028315775096416473, -0.02474144659936428, -0.005459722597151995, -0.011248992756009102, -0.008999194018542767, -0.016882995143532753, -0.01027936115860939, -0.00894215703010559, -0.019316580146551132, -0.04195398837327957, 0.0004618424572981894, 0.057037144899368286, 0.03495743125677109, -0.014348010532557964, -0.012028500437736511, 0.0004883805522695184, 0.010894094593822956, 0.024373874068260193, -0.025755440816283226, -0.03219430148601532, -0.012991794385015965, -0.02646523527801037, -0.005342479329556227, 0.03830361366271973, -0.008739357814192772, -0.013143893331289291, -0.0020359093323349953, 0.01737731695175171, -0.04659301042556763, 0.0020913619082421064, -0.014512784779071808, -0.023283829912543297, 0.023055681958794594, 0.019341930747032166, 0.02836647443473339, -0.025070995092391968, -0.01422126218676567, -0.014981756918132305, -0.03447578474879265, 0.01006388757377863, 0.006527584511786699, 0.018936332315206528, -0.025527290999889374, 0.0022767328191548586, -0.005272767506539822, -0.008473184891045094, -0.0038309949450194836, -0.0020042220130562782, 0.0040147812105715275, 0.043525680899620056]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" data batch is divided into multiple
microbatches, and their forward/backward computational tasks are scheduled among those multiple pipeline stages. More
specifically, each stage performs the forward computation for each microbatch and sends the resulting hidden states to
another stage; later on, it performs the backward computation for the same microbatch after receiving the gradients of
the training objective with respect to the sent hidden states. Pipeline parallelism only requires sparse and inexpensive
point-to-point (P2P) communication between pipeline stages, which makes it applicable and oftentimes must-have in
much broader scenarios when tensor (and sequence) parallelism is infeasible or insufficient, whether in GPU clusters or in
decentralized settings (Yuan et al., 2022; Yang et al., 2023). The main concern with pipeline parallelism is its low utilization
rate of computational resources, due to pipeline bubbles and load imbalance across pipeline stages (Narayanan et al., 2021b).
F. Related works
Early exiting. As introduced in Section 1, early exiting has been widely applied for accelerating inference of deep neural
networks in the literature (Graves, 2016; Liu et al., 2020; Hou et al., 2020; Zhou et al., 2020; Elbayad et al., 2020; Schwartz
et al., 2020; Xin et al., 2020; Schuster et al., 2021; Xin et al., 2021; Li et al., 2021; Hu et al., 2023; Teerapittayanon et al.,
2016; Huang et al., 2018; Kaya et al., 2019; Laskaridis et al., 2021; Scardapane et al., 2020; Han et al., 2022; Xu & McAuley,
2023; Dai et al., 2023). In terms of early-exit Transformers in the NLP domain, the majority of prior works are focused
on BERT (Devlin et al., 2019) or other encoder-only models for classification tasks (Liu et al., 2020; Hou et al., 2020;
Zhou et al., 2020; Elbayad et al., 2020; Schwartz et al., 2020; Xin et al., 2020; Schuster et al., 2021; Xin et al., 2021; Li
et al., 2021; Hu et al., 2023). Recent works have begun to study token-wise early exiting for accelerating inference of
encoder-decoder or decoder-only LLMs in autoregressive sequence generation (Schuster et al., 2021; Corro et al., 2023; Bae
et al., 2023; Varshney et al., 2023). While they are largely focused on designing inference mechanisms, the lack of support
in prior works for training early-exit models with massive 3D parallelism inevitably poses an obstacle to truly scaling up
early-exit LLMs. Our work on EE-LLM is one important step towards eliminating this obstacle, and we also contribute a
novel pipeline-based inference mechanism along the way.
Early-exit inference with KV caching. Several approaches have been recently proposed to resolve the conflict between
early exiting and KV caching in autoregressive generation. One approach (Elbayad et al., 2020; Li et al., 2021; Schuster
et al., 2022) is to copy the hidden states of the current token at the exiting layer to all later layers, which will be used to
compute the keys and values at later attention layers. Despite its efficiency, this method causes a deviation from the inference
process that the model is trained to excel at, which can harm the output quality. Another solution (Corro et al., 2023) is to
pre-specify the exiting layer for each token, while ensuring that KV missing in previous tokens will not hinder generation of
later tokens; with this approach, the ability of token-wise adaptive selection of exits is inevitably lost. The third method
(Bae et al., 2023; Tang et al., 2023) is to store the hidden states of recent tokens that were generated with early exiting,
and whenever KV missing happens, run a batch forward pass with the current and recent tokens to fulfill the KV caches.
Acceleration by this method relies on the batching effect of GPU computation. In comparison, our proposed pipeline-based
method achieves early-exit acceleration in theoretical time complexity.
Other applications of early-exit models. Interestingly, early exiting has been used for many other purposes in the
literature, besides accelerating inference. For example, early-exit losses can provide deep supervision and regularization","[-0.009683101437985897, -0.0009301972459070385, 0.04786556586623192, -0.014138301834464073, -0.005130442325025797, 0.016874073073267937, 3.447994822636247e-05, 0.05426991730928421, -0.007963672280311584, 0.05112343281507492, 0.016400707885622978, -0.030796576291322708, -0.026271764189004898, -0.007211856544017792, -0.033970907330513, -0.04419002681970596, 0.0027270703576505184, 0.014869233593344688, -0.00039983689202927053, 0.036922477185726166, 0.004604868125170469, -0.01104750670492649, 0.023640410974621773, 0.015704583376646042, 0.019352279603481293, -0.036282043904066086, 0.020981213077902794, 0.02854113094508648, 0.005067791324108839, -0.07256408780813217, 0.027552634477615356, -0.04332682862877846, -0.051318347454071045, -0.02700965665280819, 0.0003970088728237897, 0.044607698917388916, 0.007852291688323021, 0.03146485611796379, -0.040430948138237, 0.020201552659273148, 0.0380084328353405, -0.05474328249692917, -0.06398782134056091, 0.033608924597501755, -0.0065992665477097034, 0.05702657252550125, 0.021245740354061127, -0.017751190811395645, -0.02694004401564598, 0.06504593789577484, -0.0051687294617295265, 0.016623469069600105, -0.03931714966893196, -0.026146460324525833, -0.03324693813920021, -0.01949150487780571, 0.010240000672638416, -0.035474538803100586, 0.009174929931759834, -0.03706170246005058, 0.04048663750290871, -0.052543528378009796, 0.018057486042380333, -0.0015401769196614623, -0.0117297088727355, 0.04513675719499588, -0.030434591695666313, 0.03630988672375679, -0.026814742013812065, 0.027705781161785126, -0.011834127828478813, 0.016887996345758438, 0.014340178109705448, -0.015119838528335094, -0.011646173894405365, 0.010316574946045876, 0.016707003116607666, 0.05343456566333771, -0.006856832653284073, -0.010420993901789188, 0.03953991085290909, -0.012871353887021542, 0.04018034413456917, -0.016400707885622978, 0.003315296024084091, -0.03188253194093704, 0.01422879844903946, -0.0040479679591953754, -0.039512064307928085, -0.008409191854298115, -0.015871653333306313, 0.021022979170084, -0.008242121897637844, -0.005440217908471823, 0.06760767847299576, 0.06899992376565933, 0.02756655588746071, -0.08353501558303833, 0.04421786963939667, 0.04480261355638504, -0.010448838584125042, 0.010574141517281532, 0.03669971972703934, -0.03447211906313896, 0.0267033614218235, -0.03976266831159592, -0.05594061687588692, 0.01634501852095127, -0.008123780600726604, -0.04229656606912613, -0.029237257316708565, -0.036838945001363754, -0.027037501335144043, -0.005408892408013344, -0.005213977303355932, -0.05925417318940163, -0.05265490710735321, 0.019366202875971794, 0.01844731718301773, 0.020507847890257835, 0.006174630019813776, 0.011952469125390053, 0.00022341267322190106, -0.015579281374812126, -0.009195812977850437, 0.0005194834084250033, 0.02411377616226673, -0.03193822130560875, 0.00861106812953949, -0.03937283903360367, -0.00398531649261713, 0.03447211906313896, 0.042909156531095505, -0.014493325725197792, -0.028499364852905273, -0.0075181517750024796, -0.02912587672472, -0.0028019037563353777, -0.026717282831668854, -0.009794481098651886, 0.029654931277036667, -0.0283183716237545, 0.005885738413780928, 0.003313555847853422, -0.04402295500040054, 0.05847451463341713, -0.007998477667570114, 0.015913421288132668, -0.008437036536633968, 0.015579281374812126, -0.011416452936828136, -0.019686419516801834, -0.01658170111477375, -0.02288859523832798, -0.027204571291804314, 0.014702163636684418, -0.048533845692873, 0.04833893105387688, 0.06376506388187408, -0.031659770756959915, -0.02093944512307644, 0.027775393798947334, 0.01731959357857704, 0.014743930660188198, -2.731475433392916e-05, 0.034416429698467255, -0.08030499517917633, -0.0021719106007367373, -0.04700237140059471, -0.03138132393360138, -0.020688839256763458, -0.031910378485918045, -0.06164884567260742, -0.004900720901787281, 0.02241523005068302, -0.021148283034563065, -0.06137039512395859, -0.019630730152130127, 0.012711245566606522, -0.08347932994365692, -0.051151275634765625, 0.03678325191140175, 0.0002688783570192754, -0.0035954865161329508, -0.037006013095378876, -0.003219578880816698, -0.004462162498384714, 0.0380362793803215, -0.03976266831159592, 0.027998153120279312, -0.014381946064531803, 0.04828324168920517, 0.03188253194093704, 0.03405444324016571, 0.007041305769234896, 0.006909042131155729, 0.032216671854257584, 0.012049926444888115, 0.009188852272927761, -0.05343456566333771, 0.04964764788746834, 0.007810524199157953, -0.001802964136004448, -0.05644182860851288, 0.07323236763477325, 0.01091524213552475, -0.00586485443636775, 0.018809301778674126, -0.007747873198240995, -0.04811616986989975, 0.003807804547250271, 0.026995733380317688, 0.00994762871414423, 0.02199755422770977, 0.02984984777867794, -0.01358836330473423, -0.021496344357728958, 0.03931714966893196, 0.045665811747312546, 0.010685521177947521, -0.002446879865601659, 0.003804323961958289, -0.016707003116607666, 0.032328054308891296, -0.045303825289011, 0.015802040696144104, -0.0028715163934975863, -0.07178442925214767, 0.011820205487310886, -0.011548716574907303, -0.0021910539362579584, -0.007156166713684797, -0.007455500308424234, -0.017751190811395645, 0.024698520079255104, -0.04942488670349121, -0.03355323150753975, -0.03135347738862038, 0.011061429046094418, -0.02142673172056675, 0.012126500718295574, 0.044357094913721085, -0.012502407655119896, -0.004897240549325943, -0.038370419293642044, 0.04360527917742729, -0.029571397230029106, -0.053016893565654755, -0.01843339391052723, 0.026466678828001022, 0.010880435816943645, -0.027385564520955086, -0.030267521739006042, 0.01294096652418375, -0.033998753875494, 0.0012286609271541238, 0.004883318208158016, -0.018335936591029167, -0.024559294804930687, 0.009335038252174854, 0.0049216048792004585, 0.0016950647113844752, 0.019407968968153, 0.018252402544021606, 0.019797800108790398, -0.02013194002211094, -0.041683975607156754, 7.608430314576253e-05, -0.0020709724631160498, -0.015899498015642166, 0.03898300975561142, -0.04755927249789238, 0.0023911900352686644, -0.00638694828376174, -0.03096364624798298, 0.006961251609027386, 0.04246363416314125, -0.001341781229712069, -0.017834726721048355, 0.004503929987549782, 0.014354100450873375, -0.006609708536416292, 0.07217425853013992, -0.003602447686716914, 0.0053740860894322395, -0.005837009288370609, -0.020925521850585938, 0.009432495571672916, -0.02451752871274948, -0.024559294804930687, -0.002330278977751732, -0.013456099666655064, 0.029989071190357208, -0.026508446782827377, 0.06783043593168259, -0.008304772898554802, -0.0009658736526034772, -0.008583223447203636, 0.002077933633700013, -0.005910102743655443, 0.054548367857933044, -0.005377566907554865, -0.023250579833984375, 0.04249148070812225, -0.0030420669354498386, 0.01811317726969719, -0.03422151133418083, -0.008631952106952667, -0.027872851118445396, 0.026021158322691917, -0.0011625289916992188, -0.013024501502513885, -0.018642231822013855, 0.026591980829834938, -0.024935202673077583, -0.03252296894788742, -0.011701864190399647, -0.06755198538303375, 0.02063314989209175, -0.07434616982936859, -0.022178547456860542, -0.055522941052913666, -0.0246567539870739, -0.012168267741799355, 0.01427056547254324, 0.0073789265006780624, 0.016539933159947395, 0.005276628769934177, -0.041934579610824585, -0.0003099932218901813, -0.00313430349342525, -0.023640410974621773, -0.002215418266132474, -0.030128296464681625, -0.042045958340168, -0.03455565124750137, -0.04483046010136604, -0.020187629386782646, 0.07373357564210892, -0.019366202875971794, -0.0639321357011795, 0.03104718215763569, 0.0002392930182395503, 0.02870820090174675, -0.004194153938442469, 0.052933357656002045, 0.02224816009402275, 0.019032061100006104, 0.06343092769384384, 0.014911000616848469, -0.037897054105997086, -0.017263904213905334, 0.022303849458694458, -0.018405549228191376, 0.031826842576265335, 0.0034962885547429323, -0.004646635614335537, -0.026967888697981834, 0.021134359762072563, 0.011778437532484531, -0.02330627106130123, -0.024155542254447937, 0.005774358287453651, 0.03358107805252075, -0.016205793246626854, 0.009474263526499271, -0.030935801565647125, -0.012578981928527355, 0.03065735287964344, 0.008562339469790459, 0.022832905873656273, 0.04438494145870209, -0.005384528078138828, 0.002060530474409461, -0.036838945001363754, 0.006641034036874771, 0.004134983289986849, 0.02497697062790394, 0.04661254212260246, 0.06576990336179733, 0.0018429913325235248, 0.04215734079480171, -0.051067743450403214, -0.038453955203294754, -0.0039052620995789766, 0.05129050090909004, -0.023891014978289604, -0.045972105115652084, -0.039901893585920334, 0.02613253891468048, -0.006560979411005974, 0.010400109924376011, -0.0027653572615236044, 0.014869233593344688, 0.03550238162279129, -0.015161605551838875, -0.016108335927128792, 0.018099253997206688, 0.041851043701171875, -0.012446718290448189, -0.0133447190746665, -0.03121425211429596, -0.033998753875494, -0.008116818964481354, 0.032077446579933167, -0.0057778386399149895, 0.05594061687588692, 0.0006735011120326817, 0.0655471459031105, 0.02297213114798069, 0.06237281486392021, -0.008931285701692104, 0.024155542254447937, -0.07000234723091125, 0.03001691773533821, -0.006978654768317938, 0.024044163525104523, 0.018739689141511917, 0.007149205543100834, 0.06944544613361359, -0.00238596904091537, -0.030183987691998482, -0.049285661429166794, -0.0009702244424261153, -0.017096834257245064, 0.011117118410766125, 0.016052646562457085, -0.032801415771245956, 0.0011703604832291603, -0.057861924171447754, -0.009495147503912449, 0.00946730189025402, 0.016762694343924522, -0.010831707157194614, -0.025506025180220604, -0.013999076560139656, -0.02053569257259369, 0.032244518399238586, -0.022999975830316544, -0.05045515298843384, -0.021941864863038063, -0.004006200470030308, -0.029014496132731438, 0.0210369024425745, -0.05841882526874542, -0.01532867643982172, -0.06409920752048492, -0.012620748952031136, 0.004615309648215771, -0.023487262427806854, 0.028109533712267876, 0.016372863203287125, 0.060200903564691544, 0.012453678995370865, 6.0639027651632205e-05, -0.06443334370851517, 0.1059780940413475, -0.02774754911661148, 0.027065346017479897, -0.008478804491460323, 0.015036303550004959, -0.032328054308891296, -0.025074427947402, -0.006808103993535042, 0.016679158434271812, 0.01722213625907898, 0.04594426229596138, 0.014897078275680542, 0.017987873405218124, 0.016971532255411148, 0.028847426176071167, -0.002530414843931794, 0.03341400623321533, -0.005012101028114557, -0.02904234081506729, 0.026633748784661293, 0.00728146918118, -0.030044762417674065, 0.0036337734200060368, -0.018057486042380333, -0.0006208566483110189, -0.011910701170563698, 0.009216696955263615, -0.006950809620320797, 0.025770554319024086, 0.05491035431623459, -0.010657676495611668, -0.03566945344209671, -0.010240000672638416, 0.014994535595178604, 0.012732129544019699, 0.005102597642689943, 0.025060506537556648, -0.01576027274131775, -0.02564525045454502, -0.009070510976016521, -0.02845759689807892, -0.0040201228111982346, 0.051736023277044296, 0.01674877107143402, 0.03249512240290642, -0.02085590921342373, 0.00479282159358263, -0.000565601687412709, -0.007427655626088381, -0.024461837485432625, 0.011235459707677364, 0.0015688920393586159, -0.003995758481323719, -0.018071409314870834, -0.024782055988907814, 0.0006574032013304532, 0.004845031071454287, 0.013574440963566303, -0.008040245622396469, 0.041767507791519165, -0.014124379493296146, 0.02201147750020027, -0.01658170111477375, 0.01140253059566021, 0.015732428058981895, -0.004740612115710974, 0.004883318208158016, 0.02209501340985298, -0.01145125925540924, -0.012599864974617958, -0.05109558627009392, -0.09155438095331192, -0.03168761730194092, -0.005363644566386938, 0.03135347738862038, -0.006334738805890083, -0.0032439432106912136, -0.005349721759557724, -0.024601062759757042, -0.013894658535718918, -0.03413797914981842, -0.013254223391413689, -0.04870091751217842, -0.01374847162514925, 0.009307193569839, 0.029460016638040543, 0.028903117403388023, 0.05677596852183342, -0.029098032042384148, 0.0026417949702590704, 0.035585917532444, -0.02330627106130123, -0.008687642402946949, 0.027705781161785126, 0.010880435816943645, -0.02934863604605198, -0.0065714213997125626, -0.050844982266426086, -0.025617405772209167, 0.02774754911661148, 0.007044786587357521, 0.002405112376436591, -0.020229397341609, 0.021969709545373917, 0.019714264199137688, 0.011945507489144802, 0.025603482499718666, -0.030601661652326584, -0.0074694231152534485, 0.006059769541025162, 0.010574141517281532, -0.037980590015649796, 0.004027083981782198, 0.004535255488008261, -0.035391002893447876, -0.010365303605794907, 0.015746351331472397, -0.05321180820465088, 0.024364380165934563, -0.02895880676805973, -0.014026922173798084, 0.03202175721526146, 0.011486065573990345, 0.00010882394417421892, -0.048311084508895874, -0.0002342896186746657, -0.027079269289970398, -0.007706105709075928, -0.017570199444890022, -0.010295690968632698, -0.02765009179711342, -0.007371965330094099, -0.03419366851449013, 0.01127722766250372, 0.013950347900390625, -0.04836677759885788, -0.013435215689241886, -0.011952469125390053, -0.024322612211108208, 0.014688241295516491, 0.0246567539870739, -0.0032056563068181276, -0.044440630823373795, -0.03419366851449013, 0.015119838528335094, -0.0041419449262320995, 0.016539933159947395, -0.020828064531087875, -0.0034092729911208153, 0.03202175721526146, -0.04778202995657921, 0.015913421288132668, 0.03188253194093704, -0.03945637494325638, 0.02532503381371498, -0.025617405772209167, 0.009919783100485802, -0.026062926277518272, -0.005287070758640766, -0.004695364274084568, -0.02475421130657196, -0.015662815421819687, 0.026313530281186104, -0.03129778802394867, 0.05078929290175438, -0.011388607323169708, -0.009174929931759834, -0.020312931388616562, 0.01965857483446598, -0.03383168205618858, -0.011994236148893833, -0.029905537143349648, 7.227736932691187e-05, 0.00820731557905674, -0.004326418042182922, -0.00918189063668251, -0.006181591656059027, 0.02336196042597294, 0.004939008038491011, 0.01237014401704073, -0.015913421288132668, -0.0038565334398299456, -0.008645874448120594, -0.010448838584125042, -0.0097039844840765, -0.0026766012888401747, 0.009028743021190166, 0.004281169734895229, -0.013309912756085396, 0.005328838247805834, -0.006909042131155729, 0.047197286039590836, 0.0027201089542359114, 0.0058230869472026825, -0.03605928272008896, -0.03143701329827309, 0.05477112904191017, 0.015356521122157574, 0.045331671833992004, -0.028248758986592293, 0.007810524199157953, -0.007810524199157953, 0.013804161921143532, 0.0001430319680366665, -0.008938247337937355, -0.03973482549190521, -0.031826842576265335, -0.0030072606168687344, 0.003978355322033167, 0.04054233059287071, 0.03266219422221184, 0.025687018409371376, 0.005523753352463245, -0.010887397453188896, -0.043243296444416046, -0.00010403808119008318, 0.007497267797589302, -0.011068389751017094, -0.018614387139678, -0.020326854661107063, -0.01548182312399149, -0.02425300143659115, -0.005287070758640766, -0.0010476683964952826, -0.04327113926410675, 0.023751789703965187, -0.04098784923553467, -0.016887996345758438, -0.011785399168729782, 0.00029650580836459994, 0.00780356302857399, -0.011896778829395771, -0.0017307412344962358, -0.00845095980912447, -0.0052487836219370365, 0.020841987803578377, 0.024155542254447937, -0.020577460527420044, 0.003947029821574688, 0.025046583265066147, -0.00045813736505806446, 0.039428528398275375, -0.034416429698467255, -0.001594996778294444, -0.0059449090622365475, 0.026424910873174667, -0.03544669225811958, 0.019867412745952606, -0.029014496132731438, -0.019032061100006104, -0.011479103937745094, 0.029961226508021355, 0.04984256252646446, -0.027719704434275627, -0.036031439900398254, -0.002022243570536375, 0.006735011003911495, -0.016038723289966583, -0.07189580798149109, -0.011980313807725906, -0.018322013318538666, -0.0018290688749402761, -0.031659770756959915, -0.04020819067955017, -0.02556171640753746, -0.019992714747786522, -0.051067743450403214, -0.004270727746188641, 0.006661918014287949, -0.0073789265006780624, -0.04527597874403, 0.03193822130560875, 0.012119539082050323, 0.019686419516801834, 0.03249512240290642, 0.00517569063231349, 0.0101146986708045, -0.06114763393998146, 0.020605305209755898, 0.01289919950067997, -0.03987405076622963, -0.01584380865097046, -0.00563861383125186, -0.007121360395103693, -0.010191272012889385, -0.036755409091711044, 0.007880136370658875, 0.032133135944604874, 0.014096534810960293, 0.01585773192346096, 0.033441852778196335, 0.04057017341256142, 0.007358042988926172, -0.03784136474132538, -0.002930687041953206, 0.013651014305651188, -0.007956710644066334, 0.027789317071437836, -0.006105017848312855, -0.02159380167722702, 0.03589221462607384, -0.006700204685330391, 0.010414032265543938, -0.018391625955700874, -0.005976234562695026, -0.0037973627913743258, -0.012502407655119896, 0.04257501661777496, 0.008833828382194042, -0.0077200280502438545, -0.010135582648217678, -0.0073441206477582455, 0.02457321807742119, 0.021134359762072563, -0.014284488745033741, 0.0035049901343882084, 0.030462436378002167, -0.005300993099808693, 0.021078670397400856, 0.01225180272012949, 0.03656049445271492, -0.004664038773626089, 0.01965857483446598, 0.04357743635773659, -0.005207016132771969, -0.020201552659273148, 0.005763916298747063, -0.03831472992897034, -0.014451558701694012, -0.014855311252176762, -0.02433653548359871, 0.01569066196680069, -0.006919484119862318, -0.06259557604789734, -0.019602883607149124, -0.030044762417674065, 0.001594996778294444, -0.034750569611787796, 0.000997199327684939, 0.02805384434759617, -0.014465481042861938, -0.11188123375177383, 0.008409191854298115, 0.024239078164100647, 0.017166446894407272, 0.008339579217135906, 0.007573841605335474, -0.007914942689239979, -0.0052801091223955154, -0.007184011861681938, -0.027803238481283188, -0.02093944512307644, -0.008471842855215073, 0.011813243851065636, -0.03770213946700096, 0.021217895671725273, -0.04212949424982071, -9.745752322487533e-05, 0.0004898980841971934, 0.020521769300103188, -0.01900421641767025, -0.0054193343967199326, -0.009884977713227272, -0.016887996345758438, -0.008743331767618656, -0.04229656606912613, -0.028930962085723877, -0.019296590238809586, -0.005266186781227589, -0.013664936646819115, 0.010887397453188896, -0.021538112312555313, -0.02620215155184269, -0.011903740465641022, -0.012746051885187626, 0.0010363563196733594, 0.023389805108308792, -0.007295391522347927, -0.027483021840453148, 0.026327453553676605, 0.00511651998385787, -0.028652511537075043, -0.037479378283023834, 0.03976266831159592, -0.012404950335621834, 0.034750569611787796, 0.024392224848270416, 0.014152224175632, 0.021969709545373917, 0.01479962095618248, 0.0073928493075072765, 0.013602285645902157, -0.017611967399716377, -0.014743930660188198, 0.03185468912124634, 0.0035345754586160183, 0.010246962308883667, -0.00953691452741623, -0.02063314989209175, 0.0004633583012036979, 0.038537487387657166, -0.014702163636684418, 0.00491116289049387, -0.0007561659440398216, -0.02532503381371498, -0.016957608982920647, -0.009321115911006927, 0.024489684030413628, 0.028847426176071167, 0.021454578265547752, -0.05151326209306717, -0.00792190432548523, 0.015509668737649918, 0.019268743693828583, -0.0027932021766901016, 0.006359103135764599, 0.001983956666663289, 0.004695364274084568, 0.032884951680898666, -0.051318347454071045, 0.014354100450873375, 0.0299333818256855, -0.009655255824327469, -0.006835949141532183, -0.010574141517281532, -0.0008061999687924981, 0.02128750830888748, 0.005906621925532818, -0.010497567243874073, -0.016539933159947395, 0.03204960376024246, 0.03753506764769554, -0.030128296464681625, 0.003155187238007784, -0.011896778829395771, 0.018697921186685562, -0.004695364274084568, 0.03163192793726921, 0.024239078164100647, 0.055996306240558624, -0.015133760869503021, 0.044691234827041626, 0.040876470506191254, -0.060869183391332626, -0.006056288722902536, -0.007406771648675203, 0.004893759731203318, 0.02774754911661148, 0.0039052620995789766, 0.0051234811544418335, -0.02038254402577877, 0.007121360395103693, 0.0034249357413500547, -0.0019769954960793257, 0.055355872958898544, 0.012843509204685688, 0.00861106812953949, 0.02862466685473919, 0.009369844570755959, 0.018739689141511917, -0.001054629567079246, -0.012042965739965439, 0.03260650113224983, -0.0460834838449955, 0.0025391164235770702, -0.027872851118445396, -0.019115597009658813, 0.039428528398275375, 0.007949749007821083, -0.03291279822587967, -0.012509369291365147, -0.012140423059463501, 0.004611829295754433, 0.025700941681861877, -0.017779037356376648, -0.03447211906313896, 0.007013461086899042, -0.0076712993904948235, 0.01844731718301773, 0.000901482068002224, 0.06153746321797371, 0.004573542159050703, -0.023083509877324104, 0.013811123557388783, 0.009390728548169136, 0.011694902554154396, 0.02063314989209175, 0.006359103135764599, -0.011952469125390053, -0.005335799418389797, 0.0075459969229996204, 0.031102871522307396, 0.013518750667572021, -0.037200927734375, 0.00994066707789898, -0.019115597009658813, 0.035780832171440125, -0.009098355658352375, -0.023417649790644646, 0.012794780544936657, 0.03099149279296398, 0.057305023074150085, 0.048394620418548584, -0.0013913802104070783, 0.002979415701702237, -0.0008140313439071178, -0.021022979170084, 0.00897305365651846, 0.010191272012889385, -0.024127697572112083, 0.005394970066845417, -0.005770877469331026, -0.03580867871642113, 0.03525177761912346, 0.03204960376024246, 0.027705781161785126, 0.0071770502254366875, -0.006536615081131458, 0.022178547456860542, 0.012300531379878521, 0.02870820090174675, -0.006111979018896818, 0.01762588880956173, -0.002231081249192357, 0.01901813969016075, 0.005328838247805834, 0.01145125925540924, 0.005391489248722792, 0.006139823701232672, 0.01335168071091175, 0.026745129376649857, 0.016164027154445648, 0.04483046010136604, 0.005189612973481417, 0.041294146329164505, 0.003995758481323719, -0.0010807343060150743, -0.009230619296431541, 0.0016550375148653984, -0.027148881927132607, -0.006947329267859459, -0.037729982286691666, 0.013128920458257198, 0.0016106596449390054, -0.023013897240161896, -0.06164884567260742, 0.006233800668269396, 0.010615908540785313, -0.011235459707677364, 0.011395568959414959, 0.03669971972703934, -0.017249980941414833, -0.007030864246189594, -0.011388607323169708, 0.041628286242485046, -0.02451752871274948, -0.020493924617767334, -0.0027845005970448256, -0.023807480931282043, -0.041127074509859085, 0.010246962308883667, -0.03923361375927925, -0.018558695912361145, 0.0008414412732236087, 0.00572562962770462, -0.025812320411205292, 0.011701864190399647, 0.012565059587359428, 0.006961251609027386, -0.01601087860763073, -0.001705506700091064, -0.013525712303817272, -0.003992277663201094, -0.01804356463253498, 0.02613253891468048, -0.01804356463253498, -0.041127074509859085, -0.007998477667570114, -0.01763981208205223, 0.004204595927149057, 0.00402360362932086, 0.04680745676159859, 0.01289919950067997, -0.0186004638671875, -0.020020559430122375, 0.008276928216218948, -0.0012260504299774766, -0.0020500884857028723, 0.030852267518639565, -0.006011040881276131, -0.014507248066365719, 0.015008458867669106, -0.005537675693631172, 0.02159380167722702, -0.00713528273627162, 0.02362648770213127, 0.0023755270522087812, 0.04580503702163696, 0.05349025875329971, 0.014326255768537521, 0.01022607833147049, -0.004583984147757292, 0.010936126112937927, 0.022624067962169647, 0.0034057924058288336, -0.00994762871414423, -0.021148283034563065, -0.028986651450395584, 0.01883714646100998, 0.02095336653292179, 0.0033466217573732138, -0.0025460778269916773, 0.020967289805412292, 0.00925846491008997, 0.028903117403388023, -0.018001796677708626, 0.014590783044695854, -0.011479103937745094, -0.00572562962770462, 0.025074427947402, -0.028193069621920586, 0.01690191961824894, -0.043800193816423416, -0.03469487652182579, 0.0015445277094841003, 0.008116818964481354, 0.008548417128622532, -0.04229656606912613, -0.0007122230599634349, 0.03527962416410446, -0.028652511537075043, 0.029989071190357208, 0.04725297540426254, -0.011799321509897709, -0.004180231597274542, -0.005005139857530594, 0.00011420803639339283, 0.019547194242477417, 0.005513311363756657, 0.001350482809357345, -0.041600439697504044, -0.001705506700091064, 0.006216397508978844, 0.005711706820875406, 0.003766037058085203, 0.02352903038263321, -0.004528294317424297, -0.027942463755607605, -0.030852267518639565, -0.009975473396480083, -0.00043072743574157357, -0.016999376937747, 0.019435813650488853, 0.009550836868584156, 0.026828663423657417, 0.008318695239722729, 0.014096534810960293, 0.015634970739483833, -0.03795274347066879, 0.017514508217573166, -0.026800818741321564, -0.014221836812794209, 0.03179899603128433, -0.014521170407533646, 0.03915007784962654, 0.006787220481783152, -0.02028508670628071, 0.01933835633099079, -0.0045491778291761875, 0.009348960593342781, 0.02305566519498825, 0.019059907644987106, -0.0005503739812411368, 0.005749993957579136, 0.022624067962169647, -0.02822091430425644, 0.006926445290446281, -0.002203236101195216, 0.024935202673077583, -0.010407071560621262, 0.013804161921143532, 0.04107138514518738, 0.009697023779153824, 0.007009980268776417, 0.0019126038532704115, 0.007093515247106552, 0.00925846491008997, -0.019199131056666374, -0.01201512012630701, 0.02054961398243904, 0.004134983289986849, 0.06627111881971359, -0.025199729949235916, -0.005088674835860729, -0.025171885266900063, -0.028652511537075043, 0.021176127716898918, 0.0018482123268768191, -0.024406148120760918, -0.011987275443971157, -0.0013208974851295352, 0.009509069845080376, 0.015899498015642166, 0.027858929708600044, 0.0019021619809791446, 0.014507248066365719, -0.02376571297645569, -0.0012869613710790873, 0.04012465476989746, -0.0012199593475088477, 0.040625862777233124, 0.03241158649325371, 0.019783876836299896, -0.008597145788371563, -0.004503929987549782, -0.034583497792482376, 0.005356682930141687, -0.006038885563611984, 0.020229397341609, 0.011548716574907303, 0.011144964024424553, -0.015022381208837032, -0.043159760534763336, -0.011548716574907303, 0.03363676741719246, -0.01674877107143402, 0.027942463755607605, 0.02336196042597294, 0.04051448404788971, -0.013776317238807678, 0.017486663535237312, 0.007330197840929031, -0.002942869206890464, -0.024949125945568085, -0.01893460378050804, -0.0017377024050801992, 0.015342598780989647, 0.0016167507274076343, 0.0046744802966713905, -0.0010729029309004545, 0.009460341185331345, -0.018781457096338272, 0.024782055988907814, 0.003623331431299448, 0.011186731047928333, -0.004886798560619354, -0.02036862261593342, -0.002245003590360284, 0.04708590731024742, 0.019756032153964043, -0.012989695183932781, -0.04419002681970596, -0.017681578174233437, -0.03210529312491417, 0.03269003704190254, 0.007866214029490948, -0.02435045875608921, -0.027315951883792877, -0.0036094088573008776, -0.0010172128677368164, 0.02394670620560646, -0.003029884770512581, 0.00184995261952281, -0.01666523702442646, -0.004517852328717709, -0.005889218766242266, 0.0348062589764595, -0.04377235099673271, 0.015133760869503021, 0.027552634477615356, 0.01875361241400242, -0.018628308549523354, -0.011291150003671646, -0.03906654566526413, 0.002175391186028719, 0.018711844459176064, 0.033775992691516876, 0.036671873182058334, -0.00047771589015610516, 0.007072631735354662, 0.013908580876886845, -0.018628308549523354, 0.004845031071454287, -0.0039052620995789766, -0.011632251553237438, -0.0001037661568261683, -0.031102871522307396, -0.025297189131379128, -0.007852291688323021, -0.019950946792960167, -0.016456399112939835, -0.021858330816030502, -0.0009110537939704955, -0.02628568559885025, -0.005603807512670755, 0.010817784816026688, -0.0022084570955485106, -0.04029172286391258, 0.00592402508482337, 0.012808702886104584, 0.01811317726969719, -0.007365004159510136, -0.010483644902706146, 0.01080386247485876, 0.004681441932916641, 0.004155867267400026, 0.054882507771253586, 0.012161306105554104, 0.005662978161126375, -0.012509369291365147, 0.01601087860763073, 0.015788119286298752, 0.005910102743655443, 0.031019337475299835, -0.0010520191863179207, -0.005217458121478558, -0.018308091908693314, -0.0002999864227604121, -0.013664936646819115, -0.014054766856133938, -0.04329898580908775, -0.02036862261593342, -0.004845031071454287, 0.009348960593342781, -0.005220938473939896, 0.01745881885290146, 0.02579839900135994, -0.009474263526499271, -0.027858929708600044, -0.012697323225438595, -0.0006865534232929349, 0.011082313023507595, -0.014019960537552834, -0.00523486128076911, 0.02571486309170723, -0.0080889742821455, 0.01804356463253498, 0.001648076344281435, -0.003710346994921565, 0.03015614114701748, 0.0015784638235345483, -0.013602285645902157, 0.030935801565647125, -0.001305234618484974, 0.021050825715065002, -0.007358042988926172, -0.01116584800183773, -0.005394970066845417, -0.03363676741719246, 0.012391027994453907, -0.01964465156197548, 0.023891014978289604, 0.013149804435670376, -0.00890344101935625, 0.025269342586398125, 0.02653629146516323, -0.038286883383989334, -0.037813518196344376, 0.02791461907327175, 0.0029289466328918934, 0.020354699343442917, -0.0029741947073489428, -0.0010659416439011693, 0.006686282344162464, -0.020326854661107063, -0.0008623250178061426, 0.0013217676896601915, 0.0017751191044226289, 0.017361361533403397, -0.018168866634368896, -0.020521769300103188, -0.02887527085840702, 0.009195812977850437, 0.04335467517375946, 0.014354100450873375, -0.03681109845638275, -0.025102272629737854, 0.011653135530650616, 0.016400707885622978, -0.02119004912674427, -0.010817784816026688, -0.0035885251127183437, -0.014938846230506897, 0.021705182269215584, -0.0035345754586160183, -0.013087153434753418, 0.034332893788814545, -0.004737131763249636, 0.026578059419989586, 0.0315483920276165, 0.032383743673563004, 0.007030864246189594, -0.011096235364675522, -0.035947903990745544, -0.014207914471626282, -0.010455800220370293, 0.025673095136880875, 0.0032944122795015574, 0.0024294767063111067, -0.031409166753292084, 0.005857893265783787, -0.010845630429685116, -0.0013678859686478972, 0.016317173838615417, -0.0065679410472512245, 0.014326255768537521, 0.008228199556469917, -0.017444897443056107, -0.022986052557826042, -0.047754187136888504, -0.07395634055137634, -0.005311435088515282, -0.0009945888305082917, 0.016874073073267937, 0.02645275555551052, 0.008840789087116718, -0.0009667437989264727, -0.010504528880119324, 0.025130119174718857, 0.009105317294597626, -0.01754235476255417, -0.024782055988907814, -0.03767429292201996, 0.017779037356376648, -0.016386786475777626, -0.0039713941514492035, 0.0009615228627808392, 0.019226977601647377, -0.02119004912674427, 0.022763293236494064, 0.018558695912361145, 0.016999376937747, 0.02004840411245823, -0.00768522173166275, 0.030545972287654877, 0.0071770502254366875, 0.051791712641716, 0.00571866799145937, 0.03486194834113121, -0.04246363416314125, 0.013664936646819115, -0.0031360439024865627, 0.02142673172056675, -0.0075181517750024796, -0.027677936479449272, -0.0015210334677249193, -0.01794610731303692, -0.012008159421384335, -0.028513286262750626, -0.009690062142908573, 0.012592904269695282, -0.002645275555551052, 0.00329615268856287, -0.00837438553571701, 0.020257242023944855, -0.04302053526043892, 0.04132198914885521, -0.006491367239505053, 0.04132198914885521, -0.010748172178864479, 0.002175391186028719, 0.02240130677819252, 0.019937025383114815, 0.007824447005987167, -0.0032630867790430784, 0.011395568959414959, 0.016456399112939835, -0.019394047558307648, -0.0015654114540666342, 0.0028697759844362736, -0.033608924597501755, 0.018962448462843895, 0.010267846286296844, -0.0016985454130917788, -0.01745881885290146, -0.017249980941414833, -0.026466678828001022, -0.02564525045454502, -0.013671898283064365, 0.009564760141074657, 0.0015045005129650235, 0.0014366282848641276, 0.03592005744576454, 0.00620943633839488, -0.019533272832632065, -0.024879513308405876, -0.009112277999520302, -0.02401631884276867, -0.04263070598244667, 0.0010642013512551785, 0.04480261355638504, -0.02661982551217079, 0.005241822451353073, -0.005095636006444693, 0.028903117403388023, 0.021009057760238647, 0.03533531352877617, -0.030462436378002167, 0.01492492388933897, -0.027134958654642105, -0.012230918742716312, -0.0041419449262320995, -0.011228499002754688, -0.0012147383531555533, 0.025909777730703354, 0.014897078275680542, -0.007295391522347927, -0.018725767731666565, -0.00485199224203825, 0.0022502245847135782, 0.030601661652326584, 0.005917063914239407, 0.003230020636692643, -0.01982564479112625, 0.008109858259558678, 0.030518127605319023, -0.036114972084760666, 0.015286908484995365, -0.003184772562235594, 0.036031439900398254, 0.01957503892481327, 0.04221303015947342, 0.004782380070537329, 0.01398515421897173, -0.01624756120145321, 0.017110755667090416, -0.0032091368921101093, 0.028513286262750626, -0.010365303605794907, 0.03202175721526146, -0.007873175665736198, -0.008200353942811489, 0.015022381208837032, -0.01917128637433052, -0.02862466685473919, -0.017820803448557854, 0.00013019716425333172, -0.0062720878049731255, 0.005032985005527735, -0.05134619027376175, 0.005513311363756657, 0.05440914258360863, 0.015286908484995365, -0.026731206104159355, 0.0029167644679546356, -0.002713147783651948, 0.0028488922398537397, 0.03338616341352463, -0.028193069621920586, 0.021788718178868294, -0.004075812641531229, -0.02677297405898571, 0.008172509260475636, 0.0035032499581575394, -0.014340178109705448, -0.012676439248025417, -0.009070510976016521, -0.04382804036140442, -0.04413433372974396, -0.01184805016964674, -0.037897054105997086, 0.010998777113854885, 0.004535255488008261, 0.015662815421819687, 0.01883714646100998, -0.041043538600206375, -0.026550212875008583, -0.0065992665477097034, -0.015453978441655636, 0.008478804491460323, -0.006355622783303261, 0.02675905078649521, -0.03656049445271492, 0.031743306666612625, -0.004664038773626089, -0.01796002872288227, 0.00958564318716526, -0.00792886596173048, 0.009627411141991615, 0.01907382905483246]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
" for
training deep networks with enhanced stability of convergence (Szegedy et al., 2015; Lee et al., 2014), which motivates
our implementation of the cool-down option for non-constant early-exit loss weights, as explained in Appendix C.1. Other
works use early exits for interpreting the intermediate features learned by each layer of a Transformer (Langedijk et al.,
2023), for improving outputs of the final exit (Gera et al., 2023), or as the draft models in speculative decoding (Kim et al.,
2023b). Early exiting has also found applications in long-tailed classification (Duggal et al., 2020), federated learning with
heterogeneous clients (Ilhan et al., 2023; Zhong et al., 2022), token reduction (Liu et al., 2024), layer-wise training of deep
networks (Scardapane et al., 2020), among others. We believe that our progress in this work can be beneficial for these
various purposes.
Other methods of accelerating LLM inference. It is worth mentioning that there are other types of dynamic neural
networks (Han et al., 2022; Xu & McAuley, 2023) that facilitate conditional computation and elastic inference, such as layer
skipping (Bengio et al., 2013; 2015; Wang et al., 2022; Corro et al., 2023; Din et al., 2023; Zeng et al., 2023; Wang et al.,
2023) and mixtures of experts (Jacobs et al., 1991; Shazeer et al., 2017; Fedus et al., 2021). Another line of work aims
to accelerate LLM inference by designing new decoding methods rather than model architectures (Leviathan et al., 2022;
26
EE-LLM : Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism
Santilli et al., 2023; Zhao et al., 2023b). Each of these approaches has its own pros and cons, and some of them can be
complemented by early exiting. A detailed comparison between these methods is beyond the scope of the current work.
27
","[0.0059609548188745975, 0.02153770625591278, 0.02178928256034851, -0.042236827313899994, 0.017191030085086823, 0.025409182533621788, -0.005080438684672117, 0.06015463173389435, -0.0014832505257800221, 0.05537468567490578, 0.001790732378140092, 0.0036827940493822098, -0.06350897997617722, 0.005988908000290394, 0.0007014430011622608, -0.04995182529091835, 0.024291066452860832, -0.0019794143736362457, -0.0025996193289756775, 0.06183180585503578, -0.036143094301223755, -0.021970976144075394, 0.023256808519363403, 0.032844651490449905, 0.03670215234160423, -0.015388068743050098, 0.014912869781255722, 0.028204472735524178, 0.041454143822193146, -0.047072675079107285, 0.041454143822193146, -0.035388365387916565, -0.05475972220301628, -0.004182451870292425, 0.01856072247028351, 0.04799512401223183, 0.015374092385172844, 0.0266251340508461, -0.03519269451498985, 0.004074134398251772, 0.018826276063919067, -0.042488399893045425, -0.05626918002963066, 0.018323123455047607, -0.023773938417434692, 0.051069941371679306, 0.02485012449324131, 0.017624299973249435, -0.020922742784023285, 0.05305459722876549, -0.014130189083516598, 0.00419293437153101, -0.038379326462745667, 0.007428482174873352, -0.05674437806010246, -0.02508772350847721, 0.00938518438488245, -0.03270488977432251, -0.0014011389575898647, -0.01306099072098732, 0.007435470353811979, -0.03779231384396553, 0.03253716975450516, -0.0041335346177220345, 0.0010508542181923985, 0.017065243795514107, -0.06926727294921875, 0.050371117889881134, -0.01575145684182644, 0.03270488977432251, -0.001764526590704918, -0.027729272842407227, 0.01904989778995514, -0.03499702736735344, -0.01113922894001007, 0.015485904179513454, 0.004248840268701315, 0.04970024898648262, -0.006998706143349409, -0.02462650090456009, 0.011174170300364494, -0.010740900412201881, 0.032313548028469086, -0.022222552448511124, 0.012075651437044144, -0.022502081468701363, -0.013165813870728016, 0.013773789629340172, -0.036897823214530945, -0.015919174998998642, 0.014493576250970364, 0.009608807973563671, 0.0010263953590765595, -0.009392173029482365, 0.048078980296850204, 0.04178958013653755, 0.04260021448135376, -0.04497620835900307, 0.019483167678117752, 0.03566789627075195, -0.014395741745829582, 0.02206881158053875, 0.047072675079107285, -0.039217911660671234, 0.02107648365199566, -0.02334066852927208, -0.039217911660671234, -0.02304716221988201, -0.02433299645781517, -0.0048288628458976746, -0.025716664269566536, -0.016785714775323868, -0.03499702736735344, 0.0027690837159752846, 0.006582906935364008, -0.07888307422399521, -0.06417985260486603, 0.01671583205461502, 0.01536011602729559, 0.013431366533041, 0.008490691892802715, -0.016352444887161255, 0.016170749440789223, 0.01127899345010519, -0.00018191221170127392, -0.008274056948721409, 0.016086891293525696, -0.01851879432797432, 0.018393006175756454, -0.01723296009004116, -0.011320922523736954, 0.03566789627075195, 0.052383728325366974, -0.04631794989109039, -0.02004222571849823, -0.00898685585707426, -0.05965147912502289, 0.01598905585706234, -0.023494409397244453, -0.025548946112394333, 0.03175448998808861, -0.0205733310431242, -0.0036618292797356844, 0.0075682466849684715, -0.04111871123313904, 0.04942071810364723, 0.02079695463180542, 0.023172950372099876, -0.04134233295917511, 0.03432615473866463, -0.01650618575513363, -0.015457951463758945, -0.0334596149623394, -0.01622665673494339, -0.037177350372076035, 0.004259322304278612, -0.034633636474609375, 0.04061555862426758, 0.0634530708193779, -0.053865231573581696, -0.0009233190794475377, 0.04768763855099678, 0.0034399533178657293, 0.029993457719683647, 0.03348756954073906, 0.034605685621500015, -0.03552813082933426, 0.016813667491078377, -0.05523492395877838, -0.013990424573421478, -0.0030800597742199898, -0.040196266025304794, -0.02259991690516472, -0.01255085039883852, -0.00038282363675534725, -0.0013286360772326589, -0.052355773746967316, -0.0516849048435688, -0.00010187520092586055, -0.05243963375687599, -0.038882479071617126, 0.0314190536737442, -0.007145458832383156, 0.008665397763252258, -0.07010586559772491, -0.012166498228907585, -0.005220203194767237, 0.009035773575305939, 0.016100868582725525, 0.014549482613801956, -0.03874271363019943, 0.03351552039384842, 0.03787617385387421, 0.010684994049370289, 0.010803794488310814, 0.022921374067664146, 0.035108838230371475, 0.011272004805505276, 0.008784197270870209, -0.03949744254350662, 0.023270785808563232, 0.0266251340508461, 0.020223919302225113, -0.057471152395009995, 0.06054597347974777, 0.013857647776603699, -0.012194450944662094, 0.034885212779045105, -0.013864636421203613, -0.0425722599029541, 0.0073655880987644196, 0.01357811875641346, -0.00405316986143589, -0.0097765251994133, -0.004203416872769594, 0.008176222443580627, -0.02791096642613411, 0.014549482613801956, 0.030077315866947174, 0.0289032943546772, 0.03874271363019943, -0.01878434605896473, 0.003892440814524889, 0.02791096642613411, -0.046262044459581375, 0.009364220313727856, 0.008819138631224632, -0.07530510425567627, 0.02433299645781517, 0.003944852389395237, 0.023158974945545197, -0.04159390926361084, -0.016590043902397156, -0.004989591892808676, 0.015234327875077724, -0.03594742342829704, -0.0004341434105299413, -0.03474545106291771, 0.030804092064499855, -0.03427024930715561, 0.015052634291350842, 0.028959199786186218, 0.006097225472331047, -0.020908765494823456, -0.038882479071617126, 0.03930177167057991, -0.011565511114895344, -0.06982633471488953, -0.021621564403176308, 0.015905197709798813, 0.003078312613070011, -0.008274056948721409, 0.008441774174571037, -0.03751278668642044, -0.030328892171382904, 0.02940644696354866, -0.003679299959912896, -0.031838349997997284, -0.027030451223254204, -0.0007298326236195862, -0.011914921924471855, -0.006292895879596472, 0.040923040360212326, 0.021383965387940407, 0.019581003114581108, -0.024808194488286972, -0.033823005855083466, 0.023019209504127502, 0.01269061490893364, -0.023242833092808723, 0.022627869620919228, -0.05903651565313339, -0.020237896591424942, 0.02282353863120079, -0.019119780510663986, -0.026177886873483658, 0.055179014801979065, 0.04771559312939644, -0.02835821360349655, 0.01777804270386696, -0.009392173029482365, -0.020643213763833046, 0.05355774983763695, 0.0019916438031941652, -0.022474128752946854, 0.010712947696447372, -0.03728916496038437, -0.007701023016124964, -0.028232425451278687, -0.009210479445755482, -0.024039490148425102, -0.024892054498195648, 0.016352444887161255, -0.026024146005511284, 0.04514392837882042, 0.010845723561942577, 0.0004987844731658697, 0.012061674147844315, -0.01280941441655159, -0.0012543861521407962, 0.01406030636280775, 0.01229228638112545, -0.03519269451498985, 0.010866688564419746, -0.007512340787798166, 0.02564678154885769, -0.005359967704862356, 0.00015494202671106905, 0.00914758536964655, 0.02844207175076008, -0.009224455803632736, -0.004067146219313145, -0.010552218183875084, 0.041426192969083786, -0.04631794989109039, -0.03566789627075195, 0.0004164544807281345, -0.05987510457634926, 0.009077702648937702, -0.04109075665473938, -0.028819436207413673, -0.026764897629618645, -0.025562923401594162, -0.0014028860023245215, 0.04293564707040787, 0.02635958045721054, 0.019888484850525856, -0.025045795366168022, -0.040419887751340866, -0.02152372896671295, 0.002805772004649043, -0.010964523069560528, 0.013054002076387405, -0.01368993055075407, -0.04598251357674599, -0.026806827634572983, -0.037904128432273865, 0.014675270766019821, 0.05344593524932861, 0.0003732148325070739, -0.06009872630238533, 0.03169858455657959, -0.005999390501528978, 0.03686986863613129, 0.028539907187223434, 0.03580765798687935, 0.008923961780965328, -0.009902313351631165, 0.07765314728021622, 0.031111573800444603, -0.04254430904984474, -0.03902224078774452, 0.004643674939870834, -0.043746281415224075, 0.01752646639943123, 0.018169382587075233, 0.0014002653770148754, -0.017107171937823296, 0.01320075523108244, 0.027323955669999123, -0.031614724546670914, -0.021956998854875565, 0.02785506099462509, 0.016338467597961426, -0.027547579258680344, 0.016072915866971016, -0.0065200128592550755, 0.013634025119245052, 0.03877066820859909, -0.03399072214961052, 0.032369453459978104, 0.04545141011476517, -0.02078297734260559, 0.03443796932697296, -0.03522064909338951, 0.03807184472680092, 0.01650618575513363, 0.019636908546090126, 0.0329844169318676, 0.0430474579334259, 0.008378880098462105, 0.048833709210157394, -0.03222968801856041, 0.006327836774289608, -0.009909301996231079, 0.05657666176557541, -0.01622665673494339, -0.023676102980971336, -0.03167062997817993, 0.023480432108044624, -7.99278132035397e-05, -0.031027713790535927, -0.03396276757121086, 0.010810782201588154, 0.02082490734755993, 0.004968627355992794, -0.009874360635876656, 0.0289032943546772, 0.04975615441799164, -0.002983971731737256, -0.011523581109941006, -0.008798173628747463, -0.03670215234160423, -0.036394670605659485, 0.030859997496008873, 0.03619899973273277, 0.06183180585503578, 0.007372576277703047, 0.039721064269542694, 0.018630605190992355, 0.05425656959414482, -0.019371356815099716, 0.03879861906170845, -0.054116807878017426, 0.024472760036587715, -0.041174616664648056, 0.020992625504732132, 0.013648001477122307, 0.012627720832824707, 0.04690495878458023, -0.01594712771475315, -0.021761329844594002, -0.013354496099054813, -0.03745688125491142, -0.00809935200959444, 0.0026432957965880632, 0.02457059547305107, -0.04078327491879463, 0.01014690101146698, -0.08408231288194656, 0.0029822245705872774, 0.028302306309342384, -0.014353811740875244, -0.004042687360197306, -0.024906029924750328, 0.007966575212776661, -0.04089508578181267, 0.035388365387916565, 0.011265017092227936, -0.05909242108464241, -0.03633876517415047, 0.026331627741456032, -0.017079219222068787, 0.007638128940016031, -0.010852712206542492, 0.015485904179513454, -0.08564767241477966, 0.017302842810750008, -0.025311347097158432, -0.01624063216149807, 0.019329426810145378, -0.026038123294711113, 0.04011240601539612, 0.021901093423366547, -0.014158141799271107, -0.05573807284235954, 0.09325086325407028, -0.022390268743038177, 0.0700499564409256, -0.014549482613801956, 0.0026922132819890976, -0.04081122949719429, -0.02990959770977497, -0.029238728806376457, 0.010056054219603539, 0.015527833253145218, 0.059763289988040924, 0.0035849588457494974, 0.03273284062743187, 0.003020659787580371, 0.03351552039384842, -0.019077850505709648, 0.0049826037138700485, 0.021677469834685326, -0.00404967600479722, 0.02612198144197464, 0.036143094301223755, -0.03703758865594864, 0.03779231384396553, -0.04260021448135376, 0.011803110130131245, -0.014095247723162174, 0.025800522416830063, -0.03228559345006943, 0.02740781381726265, 0.07469014078378677, -0.022166647017002106, 0.014717199839651585, -0.026834780350327492, 0.005622026044875383, 0.037680502980947495, -0.027743248268961906, 0.043243128806352615, -0.016408350318670273, -0.015807362273335457, -0.04268407076597214, -0.03429820388555527, -0.02844207175076008, 0.03678601235151291, 0.017875876277685165, 0.05492744222283363, 0.004937180317938328, -0.005919025745242834, 0.003317659255117178, 0.010740900412201881, -0.007889704778790474, -0.00976953748613596, -0.005174779798835516, -0.010223771445453167, -0.0139415068551898, -0.023466456681489944, 0.008965891785919666, -0.011824075132608414, -0.005527684930711985, -0.019734743982553482, 0.03471749648451805, -0.011097299866378307, 0.027044426649808884, -0.011663345620036125, 0.025576898828148842, 0.00671917712315917, -0.029322586953639984, -0.019832579419016838, 0.012914237566292286, 0.02559087611734867, 0.010859699919819832, -0.039189960807561874, -0.07960984855890274, -0.029043057933449745, 0.027952896431088448, 0.015485904179513454, -0.03125133737921715, 0.010922593995928764, 0.002774324966594577, -0.0452277846634388, -0.020433567464351654, -0.024766266345977783, -0.01601700857281685, -0.05042702332139015, -0.0227816104888916, 0.02183121256530285, 0.042013201862573624, 0.04696086421608925, 0.024514690041542053, -0.020727071911096573, -0.001687656040303409, 0.017177054658532143, -0.009021797217428684, -0.014940822497010231, 0.00012404097651597112, 0.013431366533041, -0.014423694461584091, -0.0022257494274526834, -0.03044070303440094, -0.02715623751282692, -0.0034993530716747046, -0.00430824002251029, -0.007435470353811979, -0.014395741745829582, 0.017372725531458855, 0.005412379279732704, -0.02687670849263668, 0.0048812744207680225, 0.00014948248281143606, -0.004549333825707436, -0.00576877873390913, -0.005520696751773357, -0.02862376533448696, 0.007903681136667728, 0.007379564456641674, -0.03253716975450516, -0.0325092189013958, 0.0067960480228066444, -0.02665308676660061, 0.02431901916861534, -0.019846556708216667, 0.004514392465353012, 0.022907398641109467, 0.03505293279886246, 0.0032530182506889105, -0.03726121038198471, -0.020936718210577965, -0.03642262518405914, -0.02609402872622013, -0.025269417092204094, 0.001364450785331428, -0.04181753098964691, -0.005391414742916822, -0.055905792862176895, -0.005090921185910702, 0.027729272842407227, -0.02842809446156025, -0.020950695499777794, -0.021425895392894745, -0.02765939012169838, -0.0031813890673220158, -0.006058790255337954, 0.006429166067391634, -0.021132389083504677, -0.00030879213591106236, 0.011104287579655647, -0.01431188266724348, 0.00481838034465909, -0.0195530503988266, 0.013431366533041, 0.01255783811211586, -0.045786842703819275, 0.015374092385172844, 0.01804359443485737, -0.009070714935660362, 0.01745658367872238, -0.025311347097158432, 0.0003596751485019922, -0.00813429243862629, -0.01976269669830799, -0.0034836295526474714, -0.03731711581349373, 0.006991717964410782, 0.05598964914679527, -0.011747204698622227, 0.03072023205459118, -0.003153436118736863, 0.002818001201376319, -0.008567562326788902, 0.04243249446153641, -0.01626858487725258, -0.021467823535203934, -0.013410401530563831, -0.0013504743110388517, -0.01776406541466713, -0.02940644696354866, 0.028763530775904655, 0.005939990282058716, 0.009175538085401058, -0.0015374092618003488, 0.003113253740593791, -0.018323123455047607, -0.015262281522154808, -0.003251271089538932, -0.037400975823402405, -0.023200903087854385, 0.010615112259984016, 0.009301326237618923, -0.003501100232824683, -0.006383742671459913, 0.014479599893093109, 0.00590504938736558, 0.011621416546404362, 0.007162929512560368, 0.0019409791566431522, -0.028092660009860992, -0.0301611740142107, 0.05330617353320122, 0.048330556601285934, 0.028008801862597466, -0.013249672949314117, 0.015038657933473587, -0.010153889656066895, 0.010503300465643406, -0.0029892127495259047, -0.03647853061556816, -0.028288330882787704, -0.005978425499051809, 0.018071547150611877, -0.01572350412607193, 0.06445937603712082, 0.028232425451278687, 0.03748483210802078, 0.0102866655215621, -0.024738313630223274, -0.058477457612752914, 0.011348876170814037, 0.007068588398396969, -0.022152669727802277, -0.005045497789978981, -0.043215177953243256, -0.009434102103114128, -0.018183358013629913, -0.00888902135193348, -0.00437462842091918, -0.03365528583526611, 0.04612227901816368, -0.03832342103123665, -0.052383728325366974, -0.020685143768787384, 0.01000014878809452, 0.010118948295712471, 0.01178913377225399, -0.002959512872621417, 0.03225764259696007, -0.005300567951053381, -0.0013207743177190423, 0.01728886552155018, -0.039637207984924316, -0.010999464429914951, 0.008253092877566814, -0.00040204127435572445, 0.050315212458372116, -0.019846556708216667, -0.008902997709810734, 0.00889600906521082, 0.026457415893673897, -0.035863567143678665, 0.017596347257494926, -0.021216247230768204, -0.017121149227023125, -0.02226448245346546, 0.02328476309776306, 0.04517187923192978, -0.042963601648807526, -0.019832579419016838, 0.007826810702681541, 0.013158826157450676, -0.03647853061556816, -0.0486939437687397, 0.00627542519941926, 0.008001516573131084, -0.02180325798690319, -0.021984953433275223, -0.04536755010485649, -0.042208872735500336, -0.028330260887742043, -0.041957296431064606, 0.025730641558766365, 0.03594742342829704, 0.0016177739016711712, -0.0329844169318676, 0.019930414855480194, 0.00463319243863225, 0.00823911651968956, 0.003948346711695194, 0.003333382774144411, 0.024025514721870422, -0.05065064877271652, 0.009538925252854824, 0.024165278300642967, -0.025520993396639824, -0.026177886873483658, -0.0006123431376181543, -0.032313548028469086, 0.006254460662603378, -0.030524563044309616, -0.026331627741456032, 0.01779201813042164, 0.03617104887962341, 0.018085524439811707, 0.0482187457382679, 0.02234834060072899, 0.008909985423088074, -0.044501010328531265, -0.02813459001481533, 0.013466307893395424, 0.0008132545626722276, 0.01601700857281685, -0.005978425499051809, -0.010090995579957962, 0.03273284062743187, 0.0016291297506541014, 0.00887504406273365, -0.05196443200111389, 0.0076730698347091675, -0.0009809719631448388, 0.016352444887161255, 0.036143094301223755, 0.020978648215532303, 0.007463423069566488, -0.01798768900334835, -0.014032353647053242, 0.02635958045721054, 0.027030451223254204, -0.00539840292185545, -0.014773105271160603, 0.01569555141031742, -0.008022481575608253, 0.0066178482957184315, -0.022404246032238007, 0.012173485942184925, 0.0011722745839506388, 0.0005136344698257744, 0.028819436207413673, -0.0037596644833683968, -0.005478767678141594, 0.01178214605897665, -0.017372725531458855, -0.014619364403188229, -0.009224455803632736, -0.040196266025304794, 0.005447320640087128, -0.0065689305774867535, -0.04335493966937065, -0.020335732027888298, -0.005454308819025755, 0.0025489546824246645, -0.034354109317064285, 0.006572424434125423, 0.03580765798687935, -0.009343255311250687, -0.12165100127458572, -0.01190793327987194, 0.005978425499051809, 0.006167107727378607, -0.013920541852712631, -0.004944168496876955, -0.0065444717183709145, 0.016939455643296242, 0.0005538167315535247, -0.03471749648451805, -0.022446176037192345, 0.0005271741538308561, 0.013990424573421478, -0.015276257880032063, 0.031866300851106644, -0.029993457719683647, 0.011439722962677479, -0.012473979964852333, 0.02130010724067688, -0.0036862881388515234, -0.005097909364849329, -0.01671583205461502, -0.012795438058674335, 0.011313934810459614, -0.02279558591544628, -0.03167062997817993, -0.005167791619896889, -0.0061636134050786495, -0.02030777931213379, 0.0314190536737442, -0.021104436367750168, -0.019455214962363243, -0.0029140894766896963, -0.017414653673768044, -0.003087047953158617, 0.0025140135549008846, -0.01700933650135994, -0.027952896431088448, 0.004486439749598503, 0.003969311248511076, -0.003923887852579355, -0.03527655452489853, 0.045507315546274185, -0.00924541987478733, 0.007742952089756727, 0.013997412286698818, 0.01065005362033844, -0.011467675678431988, 0.02559087611734867, -0.014325859025120735, 0.02740781381726265, 0.0033298886846750975, -0.009643749333918095, -0.001491985865868628, 0.001408127136528492, 0.019371356815099716, -0.008518644608557224, 0.006907859351485968, -0.00297523639164865, 0.037428926676511765, -0.010070030577480793, 0.011502617038786411, -0.0063662719912827015, -0.016827642917633057, -0.03650648146867752, 0.012271321378648281, 0.02760348469018936, 0.0066702598705887794, 0.0016265091253444552, -0.05830974131822586, 0.01670185476541519, 0.0012596274027600884, 0.024277089163661003, 0.013047014363110065, 0.002866918919607997, -0.005216709338128567, -0.007061600219458342, 0.04307541251182556, -0.01823926530778408, 0.019888484850525856, 0.03292851150035858, -0.022767633199691772, -0.009140596725046635, 0.004227875731885433, 0.025954263284802437, 0.01795973628759384, 0.0008045192807912827, -0.011747204698622227, -0.018169382587075233, 0.048526227474212646, 0.04030807688832283, 0.015290234237909317, 0.010936570353806019, 0.005220203194767237, -0.002774324966594577, -0.014130189083516598, 0.018197335302829742, 0.01904989778995514, 0.03519269451498985, -0.0175124891102314, 0.038630902767181396, 0.055933743715286255, -0.052327822893857956, -0.023676102980971336, 0.0021820729598402977, 0.01484298799186945, -0.002356778597459197, 0.015038657933473587, 0.0014229770749807358, 0.0016649443423375487, 0.019594980403780937, -0.015374092385172844, -0.017596347257494926, 0.0637885108590126, 0.022404246032238007, -4.7170513425953686e-05, 0.028581835329532623, 0.02208278700709343, 0.027701320126652718, -0.006610859651118517, -0.0018134440761059523, 0.02687670849263668, -0.032816700637340546, -0.005796731915324926, -0.024668430909514427, -0.030887950211763382, 0.04285179078578949, -0.018351076170802116, -0.028581835329532623, -0.016296537593007088, -0.012816403061151505, -0.00016946443065535277, 0.010321606881916523, -0.008302009664475918, -0.018393006175756454, 0.02258593961596489, 0.00022471508418675512, 0.041705720126628876, -0.012117580510675907, 0.06239086389541626, -0.00456331018358469, 0.003350853454321623, 0.007372576277703047, -0.01977667398750782, 0.02153770625591278, 0.010915606282651424, -0.0009643749217502773, -0.02712828479707241, -0.0024633489083498716, 0.015527833253145218, 0.03569584712386131, 0.0019130263244733214, -0.03762459754943848, -0.0004861183406319469, 0.009622784331440926, 0.04777149856090546, -0.0020492966286838055, -0.019874509423971176, 0.0015933150425553322, 0.016030985862016678, 0.04975615441799164, 0.05227191373705864, -0.01881229877471924, -0.019636908546090126, 0.025660758838057518, -0.01027967780828476, -0.036897823214530945, -0.011125252582132816, -0.029043057933449745, -0.00020091143960598856, -0.02178928256034851, -0.0301611740142107, 0.03097180835902691, 0.0177500881254673, 0.04061555862426758, 0.012068662792444229, -0.004070640541613102, 0.0507345050573349, 0.015318186953663826, 0.020755024626851082, 0.019734743982553482, 0.02963007055222988, 0.0020580319687724113, 0.042516354471445084, 0.02408142015337944, 0.005730343516916037, 0.015304210595786572, 0.016058938577771187, 0.0002581275184638798, 0.049308907240629196, 0.003123736009001732, 0.03600332885980606, 0.005534673575311899, 0.029713928699493408, -0.005870108027011156, -0.011285982094705105, -0.023955632001161575, 0.00949699617922306, -0.007051118183881044, -0.0364505760371685, -0.05294278636574745, 0.006949788890779018, -0.0037352056242525578, -0.0018274205503985286, -0.038882479071617126, 0.009357231669127941, 0.007575234863907099, -0.008665397763252258, -0.007812834344804287, 0.030328892171382904, 0.02082490734755993, -0.00886805634945631, 0.004318722523748875, 0.035891517996788025, -0.0006774209323339164, 0.007093047257512808, 0.008462739177048206, -0.013480284251272678, -0.04265611991286278, 0.003749182214960456, -0.03480135649442673, -0.04204115644097328, 0.03164267912507057, 0.010307630524039268, -0.016044963151216507, 0.009818454273045063, -0.0002806208794936538, 0.013040025718510151, -0.005744319874793291, -0.013144848868250847, -0.01696740835905075, 0.019189663231372833, -0.0014946063747629523, 0.013081955723464489, -0.02786903642117977, -0.043522659689188004, 0.007477399427443743, 0.012501932680606842, 0.01051028911024332, 0.03547222539782524, 0.04204115644097328, -0.011495628394186497, -0.016590043902397156, -0.019692815840244293, 0.004846333526074886, 0.014367788098752499, -0.0028442072216421366, 0.018351076170802116, -0.04452896490693092, -0.0061391545459628105, 0.001522559323348105, -0.003703758819028735, 0.014116212725639343, 0.01770815998315811, -0.00901480857282877, 0.018351076170802116, 0.03728916496038437, 0.03686986863613129, 0.028022777289152145, 0.029797786846756935, -0.008777209557592869, 0.020237896591424942, 0.02641548588871956, -0.003857499687001109, -0.00939916167408228, 0.000680915080010891, -0.016436303034424782, -0.005080438684672117, 0.021607588976621628, 0.017428630962967873, -0.024388901889324188, 0.03401867300271988, 0.02740781381726265, 0.04111871123313904, -0.00690087117254734, -0.00938518438488245, -0.0014535505324602127, -0.004227875731885433, 0.0024790724273771048, -0.01874241605401039, -0.008847091346979141, -0.050594743341207504, -0.008490691892802715, 0.009678689762949944, 0.019902462139725685, 0.002264184644445777, -0.06513024866580963, -0.014912869781255722, 0.021146366372704506, -0.012795438058674335, 0.003997263964265585, 0.0208109300583601, -0.03239740803837776, -0.011446710675954819, -0.012606755830347538, -0.0154719278216362, 0.011313934810459614, -0.0037352056242525578, -0.00024131211102940142, -0.02714226208627224, 0.01266266219317913, 0.028218448162078857, 0.005230685696005821, -0.007309682201594114, -0.007096541579812765, -0.0015740974340587854, -0.026024146005511284, -0.03902224078774452, -0.013585107401013374, -0.012012757360935211, -0.011097299866378307, 0.028008801862597466, -0.0030171656981110573, 0.04640180617570877, 0.01951112039387226, 0.004266310948878527, 0.003843523096293211, -0.022194599732756615, 0.014465623535215855, -0.014773105271160603, 0.021174319088459015, 0.014787081629037857, 0.00448993407189846, 0.027002496644854546, -0.023787913843989372, -0.03508088365197182, 0.0029892127495259047, -0.03603128343820572, 0.02712828479707241, 0.020741049200296402, 0.008406833745539188, -0.007127988617867231, -0.01723296009004116, 0.013648001477122307, -0.018868204206228256, 0.014773105271160603, -0.018966039642691612, 0.0010901628993451595, -0.019119780510663986, -0.001984655624255538, 0.031111573800444603, 0.01345233153551817, -0.0009704895783215761, -0.004395592957735062, -0.029462352395057678, 0.010049066506326199, -0.01218746230006218, -0.023899726569652557, 0.028036754578351974, 0.003254765411838889, 0.06798144429922104, -0.023759961128234863, -0.0005245535867288709, -0.042516354471445084, -0.02918282337486744, 0.03390686213970184, -0.04355061054229736, -0.0034120003692805767, -0.021146366372704506, 0.023662125691771507, 0.005321532487869263, 0.03728916496038437, 0.010195818729698658, -0.029098965227603912, 0.02634560503065586, -0.016799690201878548, -0.02736588567495346, 0.025409182533621788, -0.0016448532696813345, 0.03823956102132797, 0.012222403660416603, 0.016114844009280205, -0.012641697190701962, 7.949104474391788e-05, -0.016044963151216507, 0.01747055910527706, -0.007176905870437622, 0.03195016086101532, -0.004011240787804127, 0.013095932081341743, -0.0072397999465465546, -0.03673010692000389, -0.019720768555998802, 0.03320803865790367, -0.025772569701075554, 0.0061391545459628105, 0.006656283512711525, 0.03798798471689224, -0.021984953433275223, 0.03809979557991028, -0.004137028474360704, -0.015206375159323215, -0.019357379525899887, -0.015541810542345047, -0.010265701450407505, 0.01702331379055977, -0.020419590175151825, -0.006174095906317234, 0.0008516897796653211, 0.01902194507420063, -0.013843671418726444, -0.0177500881254673, 0.00030136716668494046, 0.00393786421045661, -0.004039193503558636, -0.010433418676257133, 0.009951231069862843, 0.03351552039384842, 0.011320922523736954, -0.00784777570515871, -0.023144997656345367, -0.004280287306755781, -0.030272986739873886, 0.051852621138095856, 0.011285982094705105, -0.0034644119441509247, 0.0107968058437109, -0.0017173560336232185, -0.0069707534275949, 0.0033788064029067755, -0.00469958083704114, -0.0029472834430634975, 0.01102741714566946, -0.009797490201890469, -0.003990275785326958, 0.01849083974957466, -0.0516849048435688, -0.0008765853708609939, 0.008784197270870209, 0.010817770846188068, -0.03952539339661598, 0.004916215781122446, -0.026066076010465622, 0.012166498228907585, 0.007980551570653915, 0.014409718103706837, 0.020223919302225113, -0.006537483539432287, -0.0018483852036297321, 0.018868204206228256, -0.017442606389522552, 0.026457415893673897, 0.009678689762949944, -0.005366955883800983, -0.00040378831909038126, -0.022991256788372993, -0.01561169233173132, -0.018826276063919067, 0.00874925684183836, -0.011439722962677479, -0.01292821392416954, -0.0052900854498147964, -0.01847686432301998, -0.013389437459409237, 0.022404246032238007, 0.004468969069421291, -0.020419590175151825, -0.02233436331152916, -0.014179106801748276, 0.010803794488310814, -0.01953907497227192, -0.020866837352514267, 0.01875639334321022, -0.010950546711683273, 0.01572350412607193, 0.044277388602495193, 0.010859699919819832, 0.020880812779068947, -0.01065005362033844, -0.025786546990275383, 0.009979183785617352, 0.001742688356898725, 0.028497977182269096, -0.0013015567092224956, 0.009902313351631165, -0.0271003320813179, -0.026163911446928978, 0.014437670819461346, -0.0027271544095128775, -0.019133757799863815, -0.009112644009292126, -0.002721913158893585, -0.013235696591436863, -0.0034207357093691826, -0.0009495249250903726, 0.025451112538576126, 0.017135124653577805, -0.020629236474633217, -0.021495776250958443, 0.008378880098462105, 0.02357826754450798, 0.009951231069862843, -0.000566482893191278, 0.011635392904281616, 0.016114844009280205, 0.019175685942173004, 0.0038470171857625246, -0.018155405297875404, -0.012124568223953247, 0.0027446248568594456, -0.029015105217695236, 0.0175124891102314, -0.0025541959330439568, 0.02127215452492237, 0.0014954799553379416, -0.03807184472680092, 0.00023759961186442524, -0.04438919946551323, 0.02791096642613411, -0.011775157414376736, 0.013780777342617512, 0.010321606881916523, -0.012788449414074421, 0.03675805777311325, 0.041957296431064606, -0.029825739562511444, -0.026317652314901352, 0.02181723527610302, 0.01927352137863636, -0.022767633199691772, 0.009657725691795349, 0.011984803713858128, 0.02536725252866745, -0.011223088018596172, -0.008714315481483936, -0.019706791266798973, -0.016869572922587395, 0.006397719029337168, -0.015164446085691452, 0.0018518794095143676, -0.004164981655776501, 0.011754192411899567, 0.0364505760371685, 0.018155405297875404, -0.0314190536737442, -0.02614993415772915, -0.014493576250970364, 0.003163918387144804, 0.011362852528691292, -0.023732008412480354, 0.0032285593915730715, -0.009070714935660362, 0.026806827634572983, -0.006589895114302635, -0.019343404099345207, 0.04950457811355591, -0.01647823303937912, 0.04243249446153641, 0.037065539509058, 0.020195966586470604, 0.010321606881916523, -0.012627720832824707, -0.014787081629037857, -0.027058403939008713, -0.02051742561161518, 0.023256808519363403, 0.019413286820054054, 0.007183894049376249, -0.0008403339306823909, -0.03197811171412468, 0.0025838958099484444, -0.006404707208275795, 0.01405331864953041, -0.005230685696005821, 0.04914119094610214, 0.0024773254990577698, -0.018700487911701202, -0.02279558591544628, -0.05148923397064209, -0.057974305003881454, -0.01624063216149807, -0.010328594595193863, 0.0003094472922384739, 0.03326394781470299, 0.0015933150425553322, 0.021677469834685326, -0.010153889656066895, 0.02157963626086712, 0.02131408266723156, -0.012872308492660522, -0.00785476341843605, -0.03804389014840126, -0.0051852623000741005, -0.015933150425553322, -0.0033456122037023306, 0.0025908839888870716, 0.00863744504749775, -0.004325710702687502, 0.038938384503126144, 0.017163077369332314, 0.006872918456792831, -0.0030066834297031164, 0.0019881497137248516, 0.04696086421608925, -0.008001516573131084, 0.07368383556604385, 0.017065243795514107, 0.03253716975450516, -0.05347388982772827, 0.006306872237473726, 0.008700339123606682, 0.0027114308904856443, 0.011481652036309242, 0.00030791861354373395, 0.005747814197093248, -0.026792850345373154, -0.01127899345010519, -0.02638753317296505, -0.001968932105228305, 0.01795973628759384, -0.018434934318065643, -0.0033543475437909365, -0.00514333276078105, 0.01723296009004116, -0.04656952619552612, 0.042991552501916885, -0.013466307893395424, 0.033124182373285294, -0.006048307754099369, 0.005552143789827824, -0.002127914223819971, -0.0018850733758881688, 0.0030818067025393248, 0.00019435997819527984, 0.00897986814379692, 0.008993844501674175, -0.016044963151216507, -0.002723660320043564, 0.014039342291653156, -0.018840251490473747, 0.015136493369936943, 0.019161710515618324, -0.020489472895860672, -0.009650737047195435, -0.01204071007668972, -0.002281655091792345, -0.028302306309342384, -0.011104287579655647, 0.005939990282058716, 0.014870940707623959, -0.012578803114593029, 0.040755320340394974, 0.021174319088459015, -0.0329844169318676, -0.012788449414074421, -0.02000029757618904, -0.03566789627075195, -0.030524563044309616, -0.008008504286408424, 0.04944867268204689, -0.023913701996207237, 0.008113328367471695, 0.01456345897167921, 0.03530450910329819, 0.025534970685839653, 0.04438919946551323, -0.020657189190387726, 0.03169858455657959, -0.01153056975454092, 0.008295021951198578, -0.009545913897454739, -0.004720545373857021, 0.010377512313425541, 0.016296537593007088, -0.003536041360348463, -0.0024301549419760704, 0.008595515042543411, 0.005524191074073315, 0.0026240781880915165, 0.048554178327322006, -0.003990275785326958, -0.011866004206240177, -0.026080051437020302, 0.007973563857376575, 0.02227845788002014, -0.02761746197938919, -0.005454308819025755, 0.012858332134783268, 0.030832044780254364, 0.036674197763204575, 0.0325092189013958, 0.0026363073848187923, -0.013137861154973507, -0.001683288486674428, 0.012166498228907585, 0.020209943875670433, 0.020475495606660843, 0.022124717012047768, 0.04684905335307121, -0.02640151046216488, -0.030776137486100197, 0.01879832334816456, -0.03301237151026726, -0.02640151046216488, -0.020894790068268776, -0.008420810103416443, -0.019608955830335617, 0.013130872510373592, -0.03924586623907089, 0.0010281424038112164, 0.04740811139345169, 0.005300567951053381, -0.016436303034424782, -0.016673902049660683, 0.01569555141031742, 0.006921835709363222, 0.03608718886971474, -0.02610800415277481, -0.008490691892802715, -0.0054158736020326614, -0.01306797843426466, 0.010021112859249115, 0.028316283598542213, 0.0005472652846947312, -0.012285297736525536, -0.010831747204065323, -0.01723296009004116, -0.0457029864192009, -0.020699119195342064, -0.0164922084659338, -0.005454308819025755, 0.012390120886266232, 0.007435470353811979, 0.013040025718510151, -0.02004222571849823, -0.001984655624255538, -0.010845723561942577, 0.0021506259217858315, 0.010111959651112556, 0.006219519302248955, 0.005192250479012728, -0.029266681522130966, 0.02845604717731476, -0.007421493995934725, -0.011481652036309242, -0.002797036664560437, -0.013193766586482525, -0.002398707903921604, 0.024724336341023445]",EE-LLM: Large-Scale Training and Inference of Early-Exit Large Language Models with 3D Parallelism.pdf
