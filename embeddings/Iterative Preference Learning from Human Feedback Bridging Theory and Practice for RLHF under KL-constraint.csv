text,embedding,file
"Iterative Preference Learning from Human Feedback: Bridging
Theory and Practice for RLHF under KL-constraint
Wei Xiong1∗Hanze Dong2Chenlu Ye3Ziqi Wang1Han Zhong4
Heng Ji1Nan Jiang1Tong Zhang1
Abstract
This paper studies the alignment process of generative models with Reinforcement Learning from Hu-
man Feedback (RLHF). We first identify the primary challenges of existing popular methods like offline
PPO and offline DPO as lacking in strategical exploration of the environment. Then, to understand the
mathematical principle of RLHF, we consider a standard mathematical formulation, the reverse-KL reg-
ularized contextual bandit for RLHF. Despite its widespread practical application, a rigorous theoretical
analysis of this formulation remains open. We investigate its behavior in three distinct settings—offline,
online, and hybrid—and propose efficient algorithms with finite-sample theoretical guarantees.
Moving towards practical applications, our framework, with a robust approximation of the information-
theoretical policy improvement oracle, naturally gives rise to several novel RLHF algorithms. This in-
cludes an iterative version of the Direct Preference Optimization (DPO) algorithm for online settings,
and a multi-step rejection sampling strategy for offline scenarios. Our empirical evaluations on real-world
alignment experiment of large language model demonstrate that these proposed methods significantly
surpass existing strong baselines, such as DPO and Rejection Sampling Optimization (RSO), showcasing
the connections between solid theoretical foundations and their potent practical implementations.
Contents
1 Introduction 3
1.1 Related Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
2 Formulation and Existing Approaches 6
2.1 Formulation of RLHF . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
2.2 The Insufficiency of Classic Frameworks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
2.3 Preliminary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
3 Offline Learning with Pessimism 11
3.1 Setup . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
∗The first three authors contribute equally to this work.
1University of Illinois Urbana-Champaign.2Salesforce AI Research.3The Hong Kong University of Science and Technology.4
Work done during an internship at The Hong Kong University of Science and Technology. Correspondence to wx13@illinois.edu,
tongzhang@tongzhang-ml.org
1arXiv:2312.11456v4  [cs.LG]  1 May 2024
3.2 Algorithms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
3.3 Main Results: Pessimism is Provably Efficient . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
4 Online Iterative Learning with Batch Exploration 13
4.1 Setup: Batch Hybrid Learning . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
4.2 Algorithms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
4.3 Main Results: RLHF Benefits from Online Exploration . . . . . . . . . . . . . . . . . . . . . . 14
5 Implementations of GSHF 16
5.1 Direct Preference Learning with Pessimism . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
5.2 Enhancer Explo","[-0.010749402455985546, 0.00235210033133626, 0.04502337425947189, 0.01864561252295971, 0.023952549323439598, 0.0014756354503333569, -0.017276080325245857, 0.04764831066131592, -0.021156420931220055, 0.04736299440264702, 0.034323904663324356, -0.05018765479326248, -0.012204530648887157, 0.0013998474460095167, 0.021070824936032295, -0.02028619684278965, 0.03189868852496147, -0.02844632789492607, 0.012461317703127861, 0.03900313749909401, -0.01191921066492796, -0.03169896826148033, 0.010250093415379524, 0.04770537465810776, -0.011669556610286236, -0.042712289839982986, 0.05364001542329788, 0.009950508363544941, 0.000717310409527272, -0.049617014825344086, 0.028075411915779114, -0.031242456287145615, -0.027576103806495667, 0.008602375164628029, -0.014237429946660995, 0.03988762944936752, -0.00722570950165391, 0.04844720661640167, -0.026163773611187935, 0.006847661454230547, 0.02525075152516365, -0.06682176142930984, -0.014323025941848755, 0.0369773730635643, -0.03515132889151573, 0.04065798968076706, 0.0027319316286593676, 0.023938283324241638, 0.014907930046319962, 0.009736518375575542, -0.061857208609580994, 0.04020148143172264, -0.017704058438539505, -0.020785506814718246, -0.007532427553087473, 0.001631669350899756, -0.001997234532609582, -0.0013151433086022735, 0.052983783185482025, 0.0007306847255676985, 0.011113184504210949, -0.014836600050330162, 0.02341044321656227, 0.014693940058350563, -0.03161337226629257, 0.0066693369299173355, -0.0703597217798233, -0.007810614071786404, -0.003554007736966014, 0.023082325235009193, 0.010135965421795845, -0.014765270054340363, 0.04724886640906334, 0.000950469693634659, -0.0402870774269104, 0.022397559136152267, 0.044994842261075974, 0.07195751368999481, -0.0027729463763535023, -0.02349603921175003, -0.007774949073791504, -0.0070117199793457985, 0.016277462244033813, -0.05589403957128525, 0.0004010072734672576, -0.037947457283735275, -0.0628843605518341, -0.014922196045517921, -0.06716414541006088, 0.0013820150634273887, -0.0012741286773234606, -0.013174615800380707, 0.01084926351904869, -0.006366185378283262, 0.01691943034529686, -0.012447051703929901, -0.024123741313815117, 0.009101683273911476, 0.06636525690555573, 0.014194631949067116, 0.023267783224582672, -0.020585782825946808, 0.020814038813114166, -0.017276080325245857, 0.03537958487868309, 0.02526501752436161, -0.0020418157801032066, 0.04679235443472862, 0.0008216302376240492, -0.01831749454140663, -0.09563900530338287, -0.010357088409364223, -0.08148717135190964, 0.01673397235572338, -0.029359349980950356, -0.03737682104110718, -0.08091653138399124, -0.007461098022758961, -0.03706296905875206, 0.01701929233968258, -0.009337072260677814, -0.00502875167876482, 0.03161337226629257, 0.005232041236013174, 0.016191866248846054, 0.004144262056797743, 0.05569431558251381, -0.04716327041387558, -0.039545245468616486, -0.01087779551744461, 0.014087636955082417, 0.03363913670182228, -0.03398152068257332, -0.04362531006336212, -0.07720738649368286, 0.017204750329256058, 0.014936462044715881, 0.01700502634048462, -0.03763360530138016, -0.05081535503268242, -0.02710532769560814, -0.041114501655101776, -0.054467443376779556, 0.008238593116402626, -0.041257161647081375, 0.0300726480782032, -0.014101902954280376, -0.01878827065229416, -0.002262938069179654, 0.05235607922077179, -0.0020649980287998915, 0.00020674499683082104, -0.04062945768237114, 0.034780412912368774, -0.017818186432123184, -0.04773390665650368, -0.01837455853819847, 0.05030177906155586, 0.011170247569680214, -0.011505497619509697, 0.023310581222176552, 0.0507868230342865, 0.011669556610286236, 0.003238373203203082, 0.03663498908281326, -0.00999330636113882, -0.008973290212452412, -0.000398109492380172, -0.034780412912368774, -0.02362443320453167, 0.019772622734308243, -0.005435331258922815, -0.03358207270503044, 0.003983769565820694, -0.008074534125626087, 0.026021113619208336, 0.009929109364748001, 0.02848912589251995, -0.024038145318627357, -0.03386739268898964, 0.029701732099056244, 0.03729122504591942, -0.009686588309705257, -0.025935517624020576, -0.021356144919991493, 0.002624936867505312, -0.008124465122818947, -0.036207009106874466, 0.014558413997292519, 0.03420977666974068, 0.004950288683176041, 0.03201281651854515, 0.030700350180268288, -0.0020649980287998915, 0.0013623993145301938, -0.0050679827108979225, 0.06094418838620186, 0.034866008907556534, -0.008295657113194466, -0.011569694615900517, 0.006073733326047659, 0.03757654130458832, -0.011334306560456753, -0.06379737704992294, 0.037833329290151596, -0.026006847620010376, 0.019729824736714363, 0.04830454662442207, -0.014208897948265076, -0.0010521146468818188, 0.03318262845277786, 0.0003249964502174407, 0.04037266969680786, 0.018189100548624992, -0.02004367671906948, -0.006537376902997494, -0.03729122504591942, 0.02549327351152897, 0.0018884566379711032, 0.05752035602927208, -0.005859743803739548, -0.003962371032685041, -0.003461278975009918, 0.025664465501904488, -0.00626275734975934, -0.0037662137765437365, 0.022782741114497185, -0.036264073103666306, 0.029074029996991158, -0.07503895461559296, 0.06008823215961456, 0.02205517701804638, -0.006027368828654289, -0.005927507299929857, 0.0023414010647684336, -0.025949783623218536, -0.016049206256866455, 0.001275020302273333, 0.04559401422739029, -0.056493207812309265, 0.01828896254301071, 0.02383842132985592, 0.01850295253098011, -0.0073541030287742615, 0.007404034025967121, 0.013873647898435593, -0.021213484928011894, -0.02838926389813423, 0.023125123232603073, -0.01864561252295971, 0.04162807762622833, -0.020685644820332527, -0.024337731301784515, -0.014622610993683338, -0.012133200652897358, -0.0039445385336875916, 0.01100618951022625, -0.0009531445684842765, -0.012447051703929901, -0.01358832884579897, -0.05030177906155586, -0.015721090137958527, 0.02028619684278965, 0.010107433423399925, -0.01001470535993576, -0.00855244416743517, -0.029987052083015442, 0.016420122236013412, -0.025678731501102448, -0.01679103635251522, -0.002847842639312148, 0.012625375762581825, -0.02189825102686882, 0.022411825135350227, -0.05101507902145386, -0.03167043626308441, 0.029116827994585037, 0.03937405347824097, -0.051500122994184494, 0.008017470128834248, -0.03401005268096924, 0.019287580624222755, 0.051443058997392654, 0.00017364350787829608, 0.03846103325486183, 0.014693940058350563, -0.0021505937911570072, -0.04713473841547966, -0.03537958487868309, -0.00624492485076189, 0.008630907163023949, -0.025735795497894287, 0.044595398008823395, -0.031385116279125214, 0.03575050085783005, 0.03252639248967171, 0.03249786049127579, -0.044795118272304535, 0.006990321446210146, 0.005485262256115675, 0.04784803465008736, 0.01336720585823059, -0.029787328094244003, 0.017532866448163986, 0.044680990278720856, 0.01002897135913372, 0.005738483276218176, 0.003277604700997472, 0.02341044321656227, 0.024623049423098564, 0.006494578905403614, 0.0013864731881767511, -0.007083049975335598, 0.0366920530796051, -0.015778154134750366, -0.02025766484439373, 0.051756907254457474, 0.004796929657459259, -0.01005750335752964, -0.029273753985762596, -0.0645962730050087, -0.04605052247643471, 0.01864561252295971, -0.018973728641867638, 0.04901784285902977, -0.017361674457788467, 0.03886048123240471, -0.012853631749749184, -0.030814476311206818, -0.013766652904450893, 0.018945196643471718, -0.027718763798475266, 0.01707635633647442, -0.029587604105472565, 0.010549678467214108, -0.02536487951874733, -0.02536487951874733, 0.039659373462200165, 0.031299520283937454, -0.009237210266292095, -0.05774861201643944, -0.009508263319730759, -0.03215547651052475, -0.016206132248044014, -0.0469064824283123, 0.0015710389707237482, 0.017604196444153786, -0.005478129256516695, 0.01441575400531292, 0.05760595202445984, -0.014936462044715881, -0.019387442618608475, 0.03680618107318878, 0.020970962941646576, -0.036549393087625504, 0.005613655783236027, 0.013909312896430492, -0.037776265293359756, -0.013681056909263134, -0.0008586325566284359, -0.007325571496039629, 0.027419177815318108, -0.008823497220873833, -0.013167482800781727, 0.022497421130537987, 0.02878871001303196, -0.024380529299378395, 0.00018590330728329718, -0.02352457121014595, -0.008930492214858532, 0.025935517624020576, 0.038118649274110794, -0.04667822644114494, 0.014893664047122002, -0.06773478537797928, -0.013909312896430492, 0.06060180440545082, 0.013895046897232533, 0.011455567553639412, 0.027376379817724228, -0.04208458587527275, -0.013181748799979687, -0.03144218027591705, -0.027433443814516068, 0.006854794453829527, 0.00011970033665420488, -0.059631720185279846, -0.022354761138558388, -0.06568048894405365, 0.007375502027571201, 0.017290346324443817, -0.005392533726990223, -0.011184513568878174, 0.023053793236613274, 0.018231898546218872, -0.01880253665149212, -0.025692997500300407, 0.039716437458992004, 0.05946052819490433, 0.043311458081007004, -0.02699119970202446, -0.012960625812411308, -0.06008823215961456, 0.014287360943853855, -0.04068652167916298, -0.0015157584566622972, -0.03723416104912758, 0.031099796295166016, 0.007104448974132538, 0.04251256585121155, 0.021256282925605774, -0.025821391493082047, 0.017604196444153786, -0.039573777467012405, 0.0052177757024765015, -0.027547571808099747, -0.013245945796370506, -0.020799772813916206, 0.05612229183316231, 0.06111538037657738, 0.01355266384780407, -0.03420977666974068, 0.0018902398878708482, -0.020842570811510086, -0.04194192588329315, 0.012268726713955402, 0.02348177321255207, -0.027561837807297707, 0.022868337109684944, -0.048276014626026154, -0.036092884838581085, 0.06665056943893433, 0.033039968460798264, -0.01701929233968258, -0.08816364407539368, 0.02726225182414055, 0.012354322709143162, 0.014123301953077316, 0.030757414177060127, -0.03369620069861412, 0.0634550005197525, 0.002573222853243351, -0.04165660962462425, -0.004928889684379101, 0.005528060253709555, 0.003495160723105073, -0.023981081321835518, 0.007832013070583344, -0.02556460350751877, -0.00844544917345047, -0.02843206189572811, -0.001291069551371038, 0.0841691717505455, 0.012482716701924801, 0.006519544404000044, -0.04097184166312218, 0.07463951408863068, -0.024394795298576355, 0.015264579094946384, 0.012882163748145103, -0.006412549875676632, -0.021256282925605774, -0.022811273112893105, -0.02731931582093239, 0.011391370557248592, 0.024294933304190636, 0.004172793589532375, 0.00027662591310217977, -0.027519039809703827, 0.016505718231201172, 0.0013695323141291738, -0.029644668102264404, 0.010763668455183506, -0.03569343686103821, -0.044709522277116776, 0.03055769018828869, 0.03052915818989277, 0.010606742464005947, 0.014166099950671196, -0.006120097357779741, 0.0025250751059502363, -0.0375480093061924, 0.013866514898836613, 0.01090632751584053, 0.02361016720533371, 0.046421438455581665, 0.006466046907007694, 0.011512630619108677, -0.015778154134750366, -0.005121480207890272, 0.005114347208291292, -0.010592476464807987, 0.044966310262680054, -0.01677677035331726, -0.021313346922397614, -0.025935517624020576, 0.017618462443351746, 0.011755152605473995, 0.009807848371565342, -0.022369027137756348, 0.044595398008823395, -0.014722472056746483, 0.006655070930719376, 0.03169896826148033, 0.007653688546270132, 0.034266840666532516, 0.01864561252295971, -0.03871782124042511, -0.022283433005213737, 0.008959024213254452, -0.03218400850892067, 0.004500911105424166, -0.006466046907007694, 0.019002260640263557, -0.000959385943133384, 0.031213924288749695, -0.03261198848485947, -0.02888857200741768, -0.007068783976137638, 0.02027193084359169, -0.005442464258521795, -0.00939413532614708, -0.053126439452171326, 0.015507100149989128, -0.00839551817625761, 0.043282926082611084, -0.041114501655101776, -0.09512542933225632, -0.03055769018828869, -0.019430240616202354, 0.01664837636053562, 0.0093870023265481, 0.03383886069059372, 0.033011436462402344, -0.030101178213953972, -0.018217632547020912, -0.0170478243380785, -0.041143033653497696, -0.03195575252175331, -0.029273753985762596, 0.007368369027972221, -0.0039552380330860615, 0.01853148452937603, 0.02343897521495819, 0.0018438755068928003, -0.04353971406817436, 0.026477625593543053, -0.009123082272708416, 0.013809450902044773, 0.04587933421134949, 0.013716721907258034, -0.06413976103067398, -0.03024383820593357, -0.03577903285622597, -0.030871540307998657, 0.005631488282233477, -0.011227311566472054, 0.007143680471926928, 0.024066677317023277, 0.002621370367705822, 0.00014812080189585686, -0.02037179283797741, -0.024894103407859802, 0.03306850045919418, -0.03375326469540596, 0.018046442419290543, 0.01187641266733408, -0.00470063416287303, 0.02895990200340748, 0.030101178213953972, -0.026563219726085663, -0.0002521062851883471, 0.04154248163104057, -0.01360259484499693, 0.0372626930475235, 0.006205693352967501, 0.019144920632243156, 0.011712354607880116, 0.03894607350230217, 0.03709150105714798, -0.021270548924803734, -0.04082918167114258, -0.024009613320231438, 0.0023610165808349848, -0.0410003736615181, -0.01865987852215767, -0.006408983375877142, 0.03335381671786308, -0.03580756485462189, 0.004946722183376551, 0.03760507330298424, -0.006455347873270512, 0.005784847307950258, -0.002266504568979144, -0.034666288644075394, -0.0035094264894723892, 0.011526896618306637, -0.011291508562862873, 0.011698088608682156, -0.04236990585923195, 0.005132179707288742, 0.02338191121816635, 0.018902398645877838, -0.048047758638858795, -0.02507956139743328, 0.03589316084980965, 0.009180146269500256, -0.026078177616000175, 0.019073590636253357, -0.0200008787214756, -0.014622610993683338, 0.014151833951473236, 0.015806686133146286, -0.017375940456986427, -0.05706384778022766, -0.025578869506716728, 0.0036770515143871307, 0.018103504553437233, 0.06334087252616882, -0.024879837408661842, 0.003812578273937106, 0.0010280408896505833, 0.02499396540224552, -0.015278845094144344, 0.015464302152395248, -0.00841691717505455, 0.0002509917540010065, -0.03535105288028717, 0.013916445896029472, 0.004115730058401823, -0.004265522584319115, -0.03720562905073166, -0.008923359215259552, -0.03232666850090027, -0.022640081122517586, 0.009772183373570442, 0.010250093415379524, -0.019159186631441116, 0.01094199251383543, -0.034837476909160614, 0.010257226414978504, 0.016191866248846054, 0.020785506814718246, -0.0398590974509716, 0.04194192588329315, 0.01653425022959709, 0.010307157412171364, -0.0007217684760689735, 0.000638401776086539, -0.027975549921393394, -0.029387880116701126, -0.027362113818526268, 0.014558413997292519, -0.002644552616402507, 0.02886004000902176, 0.021527336910367012, -0.0020810470450669527, 0.01850295253098011, 0.021384676918387413, -0.021284814924001694, -0.029173891991376877, -0.00840265117585659, -0.004878958687186241, 0.024237869307398796, 0.005438897758722305, 0.02867458201944828, 0.009700854308903217, 0.06083006039261818, 0.024680113419890404, -0.006041634827852249, 0.0012883946765214205, -0.008145864121615887, 0.04399622604250908, -0.013652524910867214, -0.0030315169133245945, -0.019815420731902122, 0.0014114385703578591, -0.02500823140144348, -0.022925401106476784, 0.009044619277119637, -0.01696222834289074, 0.009080284275114536, -0.05164278298616409, -0.031385116279125214, 0.005221341736614704, -0.015250313095748425, 0.026434827595949173, -0.03560784086585045, 0.007867678068578243, -0.002598188351839781, -0.007675087545067072, -0.007953274063766003, 0.017404472455382347, -0.02693413570523262, -0.003566490486264229, 0.024237869307398796, 0.024779975414276123, 0.024851305410265923, -0.03526545688509941, -0.0814301073551178, 0.00720431050285697, 0.026606017723679543, 0.015093387104570866, -0.001316034933552146, -0.043111737817525864, -0.030643286183476448, -0.02512235939502716, 0.04936022683978081, 0.049759674817323685, -0.03058622218668461, -0.016277462244033813, -0.022768475115299225, -0.01089919451624155, 0.024066677317023277, 0.0047362991608679295, -0.0013615076895803213, 0.03831837326288223, 0.003933839034289122, 0.024865571409463882, -0.027761561796069145, -0.018902398645877838, -0.018146302551031113, -0.002578572602942586, 0.002860325388610363, 0.0032972204498946667, -0.008944758214056492, -0.04519456624984741, 0.012575444765388966, -0.015906548127532005, -0.022697145119309425, 0.0026623851153999567, 0.01350273285061121, 0.0016566348494961858, 0.016519984230399132, -0.006879759952425957, 0.024951167404651642, -0.04371090605854988, -0.00852391216903925, -0.00849538017064333, 0.011990540660917759, 0.004240557085722685, -0.004786230158060789, -0.000571975891944021, 0.03663498908281326, -0.013823716901242733, -0.015935078263282776, 0.039488181471824646, 0.018888132646679878, -0.01709062233567238, -0.01100618951022625, -0.009836380369961262, 0.013980642892420292, 0.00020418157509993762, -0.0033685502130538225, 0.03692030906677246, -0.010250093415379524, 0.0010788633953779936, -0.022411825135350227, -0.008288524113595486, -0.005367568228393793, 0.0220837090164423, 0.034666288644075394, -0.051728375256061554, -0.020571516826748848, 0.011790817603468895, -0.017775388434529305, -0.04031560942530632, -0.029387880116701126, 0.022882603108882904, -0.0007159729721024632, 0.005495961755514145, -0.0003675714251585305, 0.0036734850145876408, 0.02192678302526474, 0.044880714267492294, -0.013866514898836613, 0.023110857233405113, 0.0013739904388785362, -0.003933839034289122, -0.0036592192482203245, 0.019401708617806435, -0.034866008907556534, 0.011198779568076134, -0.04003028944134712, -0.009008955210447311, -0.015136185102164745, -0.016120536252856255, -0.0006820912822149694, -0.004365384113043547, -0.024851305410265923, -0.01686236634850502, 0.02353883720934391, 0.004319020081311464, -0.019801154732704163, -0.02555033750832081, 0.06568048894405365, -0.03894607350230217, -0.10397032648324966, 0.004775530658662319, 0.024152273312211037, 0.02851765789091587, 0.017304612323641777, -0.005567291751503944, -0.0002329364069737494, 0.027447709813714027, -0.0030582654289901257, -0.044823650270700455, 0.03181309625506401, 0.004490211606025696, 0.0217270590364933, 0.001755604869686067, -0.005799113307148218, -0.024223603308200836, 0.020785506814718246, -0.009144481271505356, 0.02694840170443058, -0.018089238554239273, -0.00832418818026781, -0.01093485951423645, 0.03734828904271126, 0.014101902954280376, -0.01693369634449482, -0.00501805217936635, 0.006052334327250719, -0.001945520518347621, -0.004618605133146048, 0.017946580424904823, -0.01870267651975155, -0.031014200299978256, -0.015250313095748425, 0.0003822831786237657, -0.05187103524804115, -0.02376709133386612, -0.0014069804456084967, 0.004450980108231306, -0.022340495139360428, 0.004261956084519625, 0.016363058239221573, 0.001323167933151126, 0.037918925285339355, -0.024095209315419197, 0.032726116478443146, -0.011534029617905617, 0.0201435387134552, 0.012011939659714699, 0.04770537465810776, 0.03329675272107124, 0.036035820841789246, 0.005631488282233477, 0.006783464923501015, -0.018274696543812752, -0.002564306603744626, 0.02856045588850975, 0.029416412115097046, 0.0200008787214756, -0.03155630826950073, 0.01861708052456379, -0.014258828945457935, 0.03383886069059372, 0.017918048426508904, 0.009158747270703316, -0.036264073103666306, -0.0020578650292009115, -0.01094912551343441, 0.02050018683075905, -0.03677764907479286, -0.03529398888349533, -0.009921976365149021, -0.011220178566873074, 0.002558956854045391, 0.024437591433525085, 0.012946359813213348, 0.004875392187386751, 0.034723348915576935, 0.031328052282333374, -0.01433729100972414, 0.03575050085783005, 0.04767684265971184, -0.025964049622416496, 0.002309302566573024, 0.01680530235171318, -0.0026980501133948565, 0.030985668301582336, 0.021142154932022095, -0.006744233425706625, -0.000977218383923173, 0.03241226449608803, 0.02893137000501156, -0.015492834150791168, 0.017532866448163986, -0.027918487787246704, 0.009715120308101177, -0.048247482627630234, -0.011819349601864815, 0.0005207075737416744, 0.029045497998595238, -0.024523187428712845, 0.03911726549267769, 0.019344644621014595, -0.016006408259272575, -0.000568409392144531, 0.005342602729797363, -0.008673704229295254, 0.006116530857980251, -0.005852610804140568, 0.019087856635451317, -0.010464082472026348, -0.013245945796370506, 0.04062945768237114, 0.003869642037898302, 0.01670544035732746, 0.0023663663305342197, 0.043225862085819244, 0.02500823140144348, 0.002635636366903782, 0.0010699471458792686, 0.015806686133146286, 0.017618462443351746, 0.007703619077801704, -0.019515834748744965, -0.00595960533246398, -0.002557173604145646, -0.037975989282131195, 0.01710488833487034, 0.024537453427910805, 0.004408182110637426, 0.012183131650090218, 0.05555165559053421, -0.0013722071889787912, 0.024822773411870003, 0.013003423810005188, -0.018074972555041313, 0.04017294943332672, 0.01188354566693306, -0.00854531116783619, -0.05734916403889656, 0.03361060470342636, 0.026606017723679543, 0.0013454585568979383, -0.032811712473630905, 0.0166911743581295, -0.031099796295166016, 0.012261593714356422, 0.0028763744048774242, -0.03503720089793205, -0.030985668301582336, 0.006797730922698975, 0.031356584280729294, -0.0021452440414577723, -0.009636657312512398, -0.0005777714541181922, 0.036064352840185165, 0.009108816273510456, 0.03346794471144676, -0.014586945995688438, -0.007689353544265032, -0.004151395056396723, 0.0007471797289326787, 0.033011436462402344, -0.008081667125225067, -0.034266840666532516, 0.034466564655303955, -0.027733029797673225, 0.004411748610436916, 0.010250093415379524, 0.005424631759524345, -0.03015824221074581, -0.034609224647283554, -0.03164190426468849, 0.0002005036367336288, 0.023253517225384712, 0.013360072858631611, 0.042826417833566666, 0.012461317703127861, 0.034780412912368774, -0.009936242364346981, 0.08428329974412918, 0.023239251226186752, 0.03854662925004959, 0.01854575052857399, -0.013217413797974586, 0.037833329290151596, -0.012746636755764484, -0.0012268726713955402, 0.006045201327651739, -0.002006150782108307, 0.032840244472026825, 0.03500866889953613, 0.021028026938438416, -0.014009173959493637, 0.01093485951423645, -0.01248984970152378, -0.02346750721335411, 0.012118934653699398, 0.004575807135552168, -0.00939413532614708, -0.0576915480196476, -0.017204750329256058, 0.07361236214637756, 0.0030529156792908907, -0.012839365750551224, -0.02157013490796089, 0.0168338343501091, 0.005488828755915165, -0.04231284186244011, 0.004005168564617634, 0.030985668301582336, -0.0053105042316019535, 0.014501350000500679, -0.031099796295166016, 0.024851305410265923, 0.0005568183260038495, 0.01443002000451088, 0.003122462425380945, 0.00751102901995182, -0.007689353544265032, -0.0030457829125225544, -0.017832452431321144, -0.03572196885943413, -0.006633672397583723, 0.010157364420592785, -0.02362443320453167, -0.012725237756967545, 0.013845115900039673, -0.011605359613895416, 0.010592476464807987, 0.01706209033727646, -0.013331540860235691, -0.0016753588570281863, -0.018174834549427032, 0.007603757549077272, -0.015193249098956585, -0.032640520483255386, -0.006815562956035137, -0.007981805130839348, -0.010399886406958103, 0.017147686332464218, 0.03583609685301781, 0.020742708817124367, 0.009222944267094135, -0.012768035754561424, 0.027690231800079346, -0.010742269456386566, 0.024508921429514885, 0.02342470921576023, -0.020642846822738647, -0.01663411222398281, -0.011612492613494396, -0.0024305633269250393, 0.013959243893623352, 0.0020953130442649126, 0.004500911105424166, -0.0075966245494782925, -0.02385268732905388, 0.024095209315419197, 0.03860369324684143, -0.0024073810782283545, -0.017361674457788467, 0.017133420333266258, 0.008980423212051392, -0.015136185102164745, 0.0024644448421895504, -0.029245221987366676, -0.005356868728995323, 0.014865132048726082, 0.014237429946660995, 7.868569809943438e-05, -0.021470272913575172, 0.00017509238386992365, -0.014601211994886398, 0.024508921429514885, -0.025921251624822617, -0.017789654433727264, 0.021127888932824135, -0.01434442400932312, 0.027404911816120148, 0.0034470129758119583, -0.028317933902144432, 0.0072471085004508495, -0.017361674457788467, -0.014751004055142403, 0.005492395255714655, -0.027704497799277306, 0.016305994242429733, 0.004080065060406923, 0.015307377092540264, 0.011106051504611969, 0.061686016619205475, 0.0401444174349308, -0.006398283876478672, 0.0054174987599253654, 0.001877757254987955, -0.023224985226988792, -0.008217194117605686, 0.019216250628232956, 0.011106051504611969, -0.0030903639271855354, 0.04707767441868782, 0.01689089834690094, 0.0033489344641566277, 0.006744233425706625, 0.019629962742328644, 0.0100361043587327, -0.00720074400305748, -0.06899019330739975, -0.022597283124923706, -0.03058622218668461, -0.006180727854371071, 0.015849484130740166, 0.017704058438539505, -0.0015425070887431502, 0.0013962809462100267, 0.00625562435016036, -0.010692338459193707, -0.02553607150912285, -0.009493997320532799, -0.02184118703007698, -0.010307157412171364, 0.006016669329255819, -0.01100618951022625, 0.03672058507800102, -0.029787328094244003, -0.04165660962462425, -0.006123663857579231, 0.001920555136166513, -0.001663767732679844, -9.774413047125563e-05, -0.013681056909263134, 0.009529662318527699, -0.005809812806546688, -0.00835985317826271, -0.0400017574429512, -0.013060487806797028, -0.05923227220773697, 0.010257226414978504, 0.0015665809623897076, 0.01102758850902319, 0.013210280798375607, 0.014073370955884457, 0.025621667504310608, -0.01686236634850502, -0.0054067992605268955, 0.011120317503809929, -0.009479731321334839, 0.003591455752030015, -0.01088492851704359, -0.015150451101362705, 0.09449773281812668, -0.028146741911768913, -0.012368588708341122, 0.010107433423399925, -0.023110857233405113, 0.023296315222978592, 0.003919573035091162, -0.0031492109410464764, -0.021242016926407814, 0.016092004254460335, 0.008787832222878933, 0.013196014799177647, 8.297662861878052e-05, 0.015293111093342304, 0.0066764699295163155, -0.011241577565670013, -0.022468889132142067, 0.032783180475234985, 0.01440148800611496, 0.02700546570122242, 0.0033168361987918615, 0.028360731899738312, -0.008017470128834248, -0.012475583702325821, 0.0010298241395503283, 0.009650923311710358, 0.0012090402888134122, 0.024637315422296524, 0.0016905164811760187, 0.01885960064828396, 0.01443002000451088, -0.029673200100660324, -0.04930316284298897, 0.02376709133386612, -0.04924609884619713, 0.0014132218202576041, -0.01841735653579235, 0.03717709705233574, 0.01700502634048462, 1.7623477788220043e-06, 0.019644228741526604, 0.01355266384780407, -0.00020563046564348042, 0.023139389231801033, 0.006170028354972601, 0.011205912567675114, 0.004533009137958288, 0.022583017125725746, 0.016206132248044014, 0.0063376533798873425, -0.017732590436935425, -0.009237210266292095, 0.025721529498696327, -0.007100882474333048, 0.0063233873806893826, -0.0169051643460989, -0.012960625812411308, 0.04425301402807236, 0.004807629156857729, 0.01836029253900051, -0.019558632746338844, 0.015207515098154545, -0.026648815721273422, -0.006562342401593924, 0.02847485989332199, -0.0269056037068367, 0.007696486543864012, 0.03703443706035614, -0.05081535503268242, 0.04094330966472626, -0.02847485989332199, -0.006455347873270512, -0.02178412303328514, 0.010720870457589626, 0.002847842639312148, 0.019872484728693962, -0.032954372465610504, 0.027362113818526268, 0.001009316765703261, 0.010756535455584526, 0.004401049111038446, -0.01844588853418827, -0.008780699223279953, -0.00062413583509624, -0.017290346324443817, 0.012076136656105518, 0.02359590120613575, -0.01254691369831562, -0.034694816917181015, 0.048047758638858795, -0.019629962742328644, 0.03563637286424637, 0.04256962984800339, 0.019244782626628876, -0.006958222948014736, -0.011369971558451653, 0.0033507177140563726, 0.017704058438539505, 0.0027622468769550323, 0.0033614172134548426, -0.009372737258672714, 0.015307377092540264, 0.031213924288749695, -0.013010556809604168, -0.018902398645877838, 0.015692558139562607, -0.03537958487868309, -0.0047327326610684395, -0.004950288683176041, 0.008716502226889133, 0.01657704822719097, -0.0010137748904526234, -0.0033489344641566277, 0.020828304812312126, -0.00941553432494402, 0.010613875463604927, 0.005474562756717205, 0.019187718629837036, 0.03692030906677246, -0.010521146468818188, 0.029031231999397278, 0.002252238802611828, 0.004140695556998253, 0.005588690284639597, -0.027604635804891586, -0.002903123153373599, 0.01867414452135563, -0.01654851622879505, 0.0052035097032785416, 0.006601573899388313, -0.026120975613594055, 0.017518600448966026, 0.005185677204281092, 0.0046293046325445175, 0.00593107333406806, 0.01099905651062727, -0.006826262455433607, -0.029616136103868484, -0.017646994441747665, -0.015107653103768826, 0.016077738255262375, -0.0020400325302034616, -0.012989157810807228, 0.03398152068257332, -0.029730264097452164, -0.01687663234770298, 0.015892282128334045, -0.019415974617004395, 0.037861861288547516, 0.01710488833487034, -0.004315453581511974, 0.029102561995387077, 0.012461317703127861, 0.02353883720934391, -0.01098479051142931, -0.007717885076999664, 0.009251476265490055, 0.003252639202401042, 0.01851721853017807, -0.0026748678646981716, 0.034466564655303955, -0.027604635804891586, -0.0013338674325495958, 0.009565327316522598, 0.034780412912368774, 0.009351338259875774, -0.003812578273937106, -0.00498595368117094, 0.025678731501102448, 0.005724217277020216, 0.006430382374674082, -0.0004081402439624071, 0.01001470535993576, -0.005235607735812664, 0.011997673660516739, 0.0008260883623734117, -0.024494655430316925, -0.0013490250566974282, -0.016377324238419533, 0.01341713685542345, -0.018246164545416832, -0.03027237020432949, 0.03178456425666809, 0.004315453581511974, 0.004511610604822636, 0.007361236028373241, 0.030928604304790497, 0.001947303768247366, 0.021113622933626175, -0.004204892087727785, -0.0065766084007918835, -0.00722214300185442, 0.04165660962462425, 0.03509426489472389, 0.022854071110486984, 0.03329675272107124, 0.0074967630207538605, -0.007660821545869112, 0.034780412912368774, 0.019287580624222755, -0.010506880469620228, -0.011484099552035332, 0.0019901017658412457, 0.01880253665149212, -0.009073151275515556, -0.008730768226087093, 0.019415974617004395, 0.0007329137879423797, 0.009365604259073734, 0.016234664246439934, -0.0013401088071987033, 0.0003896390844602138, 0.03555077686905861, -0.0033721167128533125, 0.007532427553087473, 0.017675526440143585, -0.004343985114246607, 0.006983188446611166, -0.019259048625826836, -0.008138731122016907, 0.0017502551199868321, -0.0016343442257493734, 0.001908072386868298, 0.01356692984700203, 0.015963610261678696, 0.03155630826950073, 0.011341439560055733, 0.014679674990475178, 0.0005608306382782757, 0.031299520283937454, 0.007439699023962021, -0.05167131498456001, 0.018189100548624992, -0.00470776716247201, 0.002933438401669264, 0.008638040162622929, -0.00721144350245595, 0.019687026739120483, 0.008160130120813847, 0.002591055352240801, -0.015820952132344246, 0.02027193084359169, 0.02362443320453167, -0.0024715778417885303, -0.004668536130338907, 0.06442508101463318, 0.007760683074593544, 0.03041503019630909, -0.049816738814115524, 0.006712134927511215, 0.00048013878404162824, 0.024537453427910805, -0.006469613406807184, -0.04408182203769684, 0.030957136303186417, -0.03315409645438194, -0.011320040561258793, -0.010820731520652771, -0.018103504553437233, 0.054695695638656616, -0.02017207071185112, -0.02838926389813423, -0.003869642037898302, 0.01700502634048462, -0.05204222723841667, 0.018074972555041313, -0.026691613718867302, 0.01097765751183033, 0.006772765424102545, -0.022854071110486984, 0.007625156547874212, 0.02214077301323414, -0.007332704495638609, -0.012810833752155304, 0.012418519705533981, 0.003816144773736596, 0.01439435500651598, 0.0040479665622115135, 0.016519984230399132, -0.017718324437737465, 0.043225862085819244, -0.02342470921576023, -0.020828304812312126, 0.008816364221274853, 0.01108465250581503, 0.0028121776413172483, -0.009137348271906376, -0.027733029797673225, 0.007746417075395584, 0.006551642902195454, -0.02673441171646118, 0.022725677117705345, 0.015321643091738224, -0.012126067653298378, 0.007560959551483393, 0.004782663658261299, 0.024223603308200836, -0.015478568151593208, -0.024651581421494484, 0.0201435387134552, -0.014936462044715881, -0.003475544974207878, -0.010171630419790745, 0.03529398888349533, 0.03689177706837654, 0.018003644421696663, -0.008852029219269753, 0.041485417634248734, 0.002616020618006587, 0.03526545688509941, 0.002248672302812338, 0.0034487962257117033, -0.0007498546037822962, 0.03141364827752113, 0.03509426489472389, 0.01102758850902319, -0.0033489344641566277, 0.009351338259875774, -0.024894103407859802, 0.021456006914377213, -0.02021486684679985, -0.0029922854155302048, -0.00844544917345047, 0.002020416781306267, 0.029387880116701126, 0.0034184809774160385, 0.0069082919508218765, 0.007832013070583344, 0.025650199502706528, -0.009465465322136879, 0.02536487951874733, 0.0011412769090384245, 0.03492307290434837, 0.01102045550942421, 0.0054103657603263855, 0.006751366425305605, 0.01343853585422039, -0.006212826352566481, 0.015706824138760567, -0.008274258114397526, -0.0010503313969820738, 0.0024573118425905704, 0.009372737258672714, 0.012846498750150204, -0.01686236634850502, -0.0015398322138935328, 0.002498326590284705, 0.019373176619410515, 0.00044358224840834737, -0.010114566422998905, 0.036092884838581085, 0.05957465618848801, -0.022640081122517586, -0.01447995100170374, 0.006155762355774641, -0.0024394793435931206, -0.00041304418118670583, -0.014265961945056915, -0.03925992548465729, 0.006212826352566481, -0.04944582283496857, -0.02547900751233101, -0.003177742939442396, 0.010742269456386566, -0.020542984828352928, 0.002015067031607032, -0.02854618988931179, -0.009572460316121578, 0.02192678302526474, -0.03004411607980728, 0.04268375784158707, 0.025778593495488167, -0.00027439685072749853, 0.016334526240825653, -0.0540965273976326, -0.029530540108680725, -0.005574424751102924, -0.01337433885782957, 0.02547900751233101, -0.017704058438539505, -0.006940390449017286, -0.049788206815719604, 0.0056493207812309265, -0.004582940135151148, -0.01350273285061121, -0.0059952703304588795, -0.010214428417384624, 0.005663586780428886, -0.010364221408963203]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"res with Variants of Main Agent Policy . . . . . . . . . . . . . . . . . . . . . . 17
5.3 Offline Learning with Pseudo-Labeling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
6 Experiments 19
6.1 Experiments Setup . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
Comment 6.1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
6.2 Main Results: RLHF Benefits from Online and/or Pseudo Labelling Data . . . . . . . . . . . 21
6.2.1 Online Exploration Improves Model Performance . . . . . . . . . . . . . . . . . . . . . 21
6.2.2 RLHF Benefits from Pseudo Labelling and Iterative Learning . . . . . . . . . . . . . . 22
6.2.3 Robustness to Sampling Temperature and Length Bias . . . . . . . . . . . . . . . . . . 23
6.3 Scaling-up Experiments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
7 Conclusion 25
8 Acknowledgement 25
A Notation Table, Backgrounds, and Organization of Appendix 32
A.1 Rejection Sampling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
A.2 Organization of the Appendix . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
B Proof of Online Learning 33
B.1 Batch Online Learning . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
B.2 Sequential Online Setting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
B.3 Construction of the Confidence Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
2
C Proof of the Offline Learning 38
C.1 Proof of Theorem 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
C.2 Proof of the Direct Preference Learning with Pessimism . . . . . . . . . . . . . . . . . . . . . 39
D Proof of the Hybrid Learning 40
D.1 More Discussions on α(mT,Doff) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
D.2 Sequential Hybrid Setting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
D.3 Proof of Theorem 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
E Discussion on the Coverage Condition for Vanilla RLHF 43
F Technical Lemma Proofs 45
G Technical Lemmas 45
H More Experiment Details 47
H.1 Implementation Details . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
H.2 Examples . . . . . . . . .","[0.007258877623826265, -0.003923348151147366, 0.044756244868040085, 0.0054304879158735275, 0.05279432237148285, 0.020231900736689568, -0.027217373251914978, 0.006141338497400284, -0.039069440215826035, 0.05249357968568802, 0.050880495458841324, -0.052110813558101654, -0.005533014424145222, 0.0018847791943699121, -0.00646258844062686, -0.008817280642688274, 0.06075038015842438, 0.005286951083689928, 0.01729280687868595, 0.013123394921422005, 0.005881604738533497, -0.017347486689686775, 0.00863273348659277, 0.05448942631483078, 0.026424501091241837, -0.036800187081098557, 0.05068911239504814, 0.010984008200466633, 0.004808493889868259, -0.06332037597894669, 0.03220699727535248, -0.03972560912370682, -0.04133869335055351, 0.004360794555395842, -0.0021821060217916965, 0.04636932909488678, 0.015214935876429081, 0.018113018944859505, -0.02933625504374504, 0.03264444321393967, -0.007422919850796461, -0.06419527530670166, -0.05768825486302376, 0.035706568509340286, -0.022938599810004234, 0.05577442795038223, -0.013116559945046902, 0.025905033573508263, 0.01466812752187252, 0.012781639583408833, -0.04024507850408554, 0.012597091495990753, -0.0254129059612751, -0.033054549247026443, -0.013178075663745403, -0.007682654075324535, -0.013451479375362396, -0.0036636143922805786, 0.050907835364341736, -0.06561697274446487, 0.006879529450088739, 0.00013627482985612005, 0.0041694119572639465, 0.023745141923427582, 0.012699618004262447, 0.008646403439342976, -0.045685816556215286, 0.012070789001882076, -0.031550828367471695, 0.013376293703913689, -0.006127668544650078, -0.018454773351550102, 0.04079188406467438, 0.0038960077799856663, -0.03351933881640434, 0.028625404462218285, 0.0180993489921093, 0.0550088956952095, -0.017484189942479134, -0.029390936717391014, 0.008735259994864464, -0.00393360061571002, 0.018304402008652687, -0.04508432745933533, 0.029719021171331406, -0.05900059640407562, -0.06414058804512024, -0.013629192486405373, -0.05405198037624359, 0.009835710749030113, 0.0004609421594068408, -0.004552177619189024, -0.0008142314618453383, 0.024606365710496902, 0.040764544159173965, -0.009808370843529701, -0.014804829843342304, 0.008434515446424484, 0.021803973242640495, 0.00848236121237278, 0.017279136925935745, -0.039233483374118805, 0.01932966709136963, -0.02265152521431446, 0.05025166645646095, -0.01606248877942562, -0.0048529221676290035, 0.03781178221106529, 0.0024691803846508265, -0.03857731074094772, -0.11193162202835083, -0.032453060150146484, -0.06397654861211777, 0.050142303109169006, 0.013499325141310692, -0.017279136925935745, -0.05539166182279587, 0.0024162083864212036, -0.024770407006144524, -0.012316852807998657, -0.0032039538491517305, -0.0027784686535596848, 0.006903452333062887, -0.011961427517235279, 0.03157816827297211, 0.00994507223367691, 0.014340043067932129, -0.06282825022935867, -0.010614912025630474, 0.01213913969695568, 0.010710603557527065, 0.01932966709136963, -0.026629554107785225, -0.03535114601254463, -0.05038836598396301, 0.04956815391778946, 0.007286217994987965, -0.015570361167192459, -0.03942486643791199, -0.02185865491628647, -0.013875255361199379, -0.04631464555859566, -0.021694611757993698, 0.016417913138866425, -0.0219270046800375, 0.0385226309299469, -0.03748369589447975, 0.013923101127147675, 0.019452698528766632, 0.024838758632540703, -0.027982905507087708, 0.019644081592559814, -0.044100072234869, 0.0043026963248848915, -0.036007314920425415, -0.05921931937336922, -0.027955563738942146, 0.03865933418273926, 0.020710356533527374, -0.00390967819839716, 0.030320510268211365, 0.055801767855882645, 0.033109232783317566, -0.005150248762220144, -0.002132551511749625, 0.018236050382256508, -0.014175999909639359, -0.014080308377742767, -0.05246623978018761, -0.02179030328989029, 0.021434877067804337, 0.009869886562228203, 0.008256802335381508, -0.017060412093997, -0.020614665001630783, -0.007976563647389412, 0.008933477103710175, -0.009493955411016941, 0.04371730983257294, -0.04893932491540909, 0.0229796115309, 0.034175507724285126, -0.0009389720507897437, -0.031140722334384918, -0.03127742558717728, -0.037073589861392975, -0.011503475718200207, -0.047818370163440704, 0.015392648056149483, 0.01148980576545, 0.021161474287509918, 0.029117532074451447, 0.0254129059612751, -0.02148955874145031, -0.028461361303925514, -0.030019765719771385, 0.028488703072071075, 0.03067593462765217, -0.03565188869833946, 0.021270835772156715, -0.0020949586760252714, 0.02295226976275444, 0.010539726354181767, -0.014791158959269524, 0.016144508495926857, -0.00863273348659277, -0.006066152360290289, 0.022227749228477478, -0.015597701072692871, -0.0215852502733469, 0.0285433828830719, 0.00532112643122673, 0.032289016991853714, 0.0021240077912807465, -0.031113380566239357, 0.010416694916784763, -0.05921931937336922, 0.008229462429881096, 0.0021530569065362215, 0.0494314543902874, -0.0006010617362335324, 0.015009882859885693, 0.00943243969231844, 0.009213716723024845, -0.012446719221770763, 0.0179899875074625, 0.013683873228728771, -0.04729890078306198, -0.0015114117413759232, -0.06419527530670166, 0.09000461548566818, 0.0038105689454823732, -0.008687414228916168, -0.02415524795651436, 0.013642862439155579, -0.030211148783564568, 0.0010970337316393852, -0.010286827571690083, 0.01963041163980961, -0.0322616770863533, 0.03037519007921219, 0.034284867346286774, 0.01139411423355341, 0.0028980830684304237, 0.020737698301672935, 0.008721589110791683, -0.01179055031388998, -0.03857731074094772, 0.025330886244773865, -0.029746361076831818, 0.022774558514356613, -0.019015252590179443, -0.007853531278669834, -0.03956156596541405, -0.027490777894854546, 0.01689637079834938, 0.021202484145760536, -0.0026981562841683626, -0.022706206887960434, -0.000989380874671042, -0.05131794139742851, 0.005409982521086931, 0.010150125250220299, -0.002265836112201214, -0.005300621036440134, 0.005946538411080837, 0.007874037139117718, 0.009951907210052013, 0.007299888413399458, -0.04448283836245537, 0.00994507223367691, 0.011619672179222107, -0.020532645285129547, 0.04533039405941963, -0.03559720888733864, -0.013130229897797108, 0.017142433673143387, 0.07234271615743637, -0.05900059640407562, 0.001419992302544415, -0.00493152579292655, 0.03409348428249359, 0.0517553873360157, 0.016021477058529854, 0.037839122116565704, -0.008284143172204494, -0.014394723810255527, -0.03398412466049194, -0.04448283836245537, -0.0024913945235311985, 0.0028775776736438274, -0.01313706487417221, 0.05730548873543739, -0.034941039979457855, 0.015283286571502686, 0.011667517945170403, 0.04683411493897438, -0.03606199473142624, 0.006418160162866116, -0.014230680651962757, 0.036636143922805786, 0.020710356533527374, -0.038467951118946075, 0.017812274396419525, 0.02281556837260723, 0.023444397374987602, 0.010341508314013481, 0.004647869151085615, 0.018017327412962914, 0.018933231011033058, -0.03975294902920723, 0.020081527531147003, -0.015474669635295868, 0.02568631060421467, -0.010703768581151962, -0.021462218835949898, 0.02358110062777996, -0.020382272079586983, -0.009835710749030113, -0.011414619162678719, -0.04852921888232231, -0.03611667454242706, 0.016650306060910225, 0.0018147194059565663, 0.02740875631570816, -0.008619062602519989, -0.01319174561649561, 0.006971803493797779, -0.024920780211687088, -0.00874892994761467, 0.002173562301322818, -0.03622603788971901, 0.043197840452194214, -0.01922030560672283, 0.013082384131848812, -0.04347124323248863, -0.0350503996014595, 0.060258254408836365, -0.017511529847979546, 0.013759058900177479, -0.0617346353828907, 0.0023751978296786547, -0.03395678475499153, 0.02740875631570816, -0.03901476040482521, -0.017689242959022522, 0.04924007132649422, 0.040764544159173965, 0.03010178729891777, 0.03360135853290558, -0.03958890587091446, -0.0059875487349927425, 0.025453917682170868, 0.023936524987220764, -0.06255485117435455, -0.00110386882442981, -0.012426214292645454, -0.06714803725481033, -0.01511924434453249, -0.019644081592559814, -0.02930891513824463, 0.038467951118946075, -0.0033423646818846464, -0.021011101081967354, 0.000770657672546804, 0.05921931937336922, -0.0350503996014595, 0.006609543226659298, 0.008113265037536621, 0.002011228585615754, 0.007272548042237759, 0.033245932310819626, -0.02005418762564659, 0.009159035980701447, -0.07830291986465454, -0.027436096221208572, 0.011291587725281715, 0.003960941452533007, 0.0007945805555209517, 0.03562454879283905, -0.006267787888646126, -0.012521905824542046, -0.013540335930883884, -0.036636143922805786, 0.057469531893730164, -0.013348952867090702, -0.05123592168092728, -0.006332721561193466, -0.0366634838283062, -0.005457828287035227, 0.009986083023250103, -0.027203703299164772, -0.024661045521497726, 0.0004408640379551798, 0.013143899850547314, -0.006339556537568569, -0.005844011437147856, 0.032289016991853714, 0.05910995602607727, 0.046424008905887604, -0.02757279947400093, -0.01789429597556591, -0.04240496829152107, 0.014312702231109142, -0.026561204344034195, 0.03917879983782768, 0.0010081774089485407, 0.035378485918045044, 0.019671421498060226, 0.05506357550621033, -0.004371047485619783, -0.024141578003764153, 0.012829485349357128, -0.03756571561098099, -0.012036613188683987, -0.024524344131350517, -0.02697131037712097, 0.008325153030455112, 0.05681336298584938, 0.04546709358692169, 0.013813739642500877, -0.03289050608873367, -0.004890515003353357, 0.01719711534678936, -0.03258976340293884, 0.004446233622729778, -0.0016028312966227531, -0.004073720425367355, -0.017607221379876137, -0.038467951118946075, -0.04194018244743347, 0.03442157059907913, 0.011517145670950413, 0.005625288467854261, -0.06113314628601074, -0.007744169794023037, 0.026861948892474174, 0.015160255134105682, -0.02478407695889473, -0.002587085822597146, 0.053368471562862396, 0.009111190214753151, -0.01779860444366932, -0.010778955183923244, -0.03865933418273926, -0.025166843086481094, -0.045193690806627274, -0.048884645104408264, 0.02671157568693161, 0.010881481692194939, -0.01796264573931694, -0.020997431129217148, 0.025371896103024483, 0.015337967313826084, -0.01541998889297247, -0.04866592213511467, 0.0828414261341095, 0.001443060813471675, 0.028324659913778305, 0.019534720107913017, -0.01912461407482624, -0.01148980576545, -0.03146880492568016, 0.010936162434518337, 0.02295226976275444, 0.009254727512598038, 0.0005015255883336067, 0.0032500906381756067, 0.004224092699587345, 0.004200169816613197, -0.02900817058980465, -0.026766257360577583, 0.024907110258936882, -0.05637591704726219, -0.0028604899998754263, -0.008947147987782955, 0.006517269182950258, -0.006510434206575155, 0.042459648102521896, -0.022897589951753616, 0.018946900963783264, -0.01626754179596901, 0.010758449323475361, -0.010444034822285175, 0.013260096311569214, 0.028297320008277893, 0.0233213659375906, -0.010081774555146694, -0.003280848730355501, -0.017320146784186363, -0.008789940737187862, -0.024059556424617767, 0.0461779460310936, -0.01536530815064907, 0.0017685825005173683, -0.036608804017305374, 0.013895761221647263, -0.018249720335006714, 0.015160255134105682, -0.011223236098885536, 0.03357401862740517, -0.0313321053981781, -0.0010671302443370223, 0.01905626244843006, -0.017511529847979546, 0.026520192623138428, 0.014627116732299328, -0.013943606987595558, -0.03144146502017975, 0.0742565393447876, -0.030949339270591736, 0.034448910504579544, -0.00691028730943799, -0.010382519103586674, -0.026656895875930786, -0.00672915717586875, -0.03007444553077221, -0.029910404235124588, -0.008755764923989773, 0.021639930084347725, 0.005208347458392382, -0.01629488170146942, -0.036007314920425415, 0.03152348846197128, 0.010765284299850464, 0.02358110062777996, -0.02950029820203781, -0.05785229802131653, -0.03007444553077221, -0.010464539751410484, 0.006021724082529545, 0.001378981745801866, 0.03745635598897934, -0.005635540932416916, -0.023034291341900826, -0.005150248762220144, -0.0008548148907721043, -0.015789084136486053, -0.018605146557092667, -0.01786695420742035, 0.010033928789198399, -0.008926642127335072, 0.027818862348794937, 0.003000609576702118, 0.016144508495926857, -0.04390869289636612, 0.02824263833463192, -0.027367746457457542, -0.005420235451310873, 0.03915145993232727, 0.007224702276289463, -0.03565188869833946, 0.00775100477039814, 0.005334796383976936, -0.03289050608873367, -0.015296956524252892, 0.002501646988093853, -0.0017737088492140174, 0.004511166829615831, 0.001833515940234065, 0.014709138311445713, -0.0389874167740345, -0.014722808264195919, 0.03595263138413429, -0.02694397047162056, 0.053969960659742355, 0.030320510268211365, -0.007074330002069473, 0.02744976617395878, 0.03587061166763306, -0.056102510541677475, 0.026356151327490807, 0.017716582864522934, 0.013567675836384296, 0.02724471315741539, 0.0015951418317854404, 0.034913696348667145, 0.006517269182950258, 0.015009882859885693, 0.028898809105157852, -0.010587572120130062, -0.04855655878782272, -0.03442157059907913, 0.004623946268111467, -0.013253261335194111, -0.014230680651962757, 0.01570706255733967, 0.03578859195113182, -0.04325252026319504, 0.01742950826883316, 0.016089828684926033, -0.018441103398799896, -0.02487976849079132, -0.02738141641020775, -0.014408393763005733, 0.011189061217010021, 0.031222743913531303, -0.0007266566972248256, -0.012385203503072262, -0.03450359031558037, 0.02548125758767128, -0.01629488170146942, 0.02325301431119442, -0.024538014084100723, -0.0450296476483345, 0.047681666910648346, -0.012952516786754131, -0.001650676946155727, 0.02262418530881405, -0.016978392377495766, -0.010765284299850464, 0.005714144557714462, 0.023239344358444214, -0.012501399964094162, -0.02055998519062996, 0.01213913969695568, 0.008557546883821487, 0.0067975083366036415, 0.0654529333114624, -0.02235078066587448, 0.004856339655816555, -8.426398562733084e-05, 0.029363594949245453, -0.01304137334227562, 0.006975220981985331, 0.007573292125016451, 0.010710603557527065, -0.029554978013038635, 0.008372998796403408, -0.002117172582075, -0.03917879983782768, -0.02062833681702614, 0.020737698301672935, -0.012214326299726963, -0.0025101909413933754, -0.0019685092847794294, -0.01603514701128006, -0.0035576701629906893, 0.006968386005610228, -0.04667007178068161, 0.012549245730042458, -0.0017788350814953446, 0.00450774934142828, -0.019835464656352997, 0.03258976340293884, 0.017484189942479134, 0.020477963611483574, -0.0005882459226995707, -0.012494564987719059, -0.0348043367266655, -0.037975821644067764, -0.047654327005147934, -0.0008945438894443214, -0.0025426577776670456, 0.025221524760127068, -0.014025627635419369, 0.01710142381489277, -0.004060050006955862, 0.02258317545056343, -0.03157816827297211, -0.027285724878311157, -0.03141412511467934, 0.006250699982047081, 0.004326619207859039, -0.036308057606220245, 0.017675573006272316, 0.010833635926246643, 0.07272547483444214, 0.020177219063043594, -0.02580934204161167, -0.03264444321393967, -0.01886487938463688, 0.03931550309062004, -0.0011884532868862152, 0.00279384758323431, -0.0361986979842186, -0.003851579502224922, -0.03116806223988533, -0.029664339497685432, 0.03543316572904587, -0.033109232783317566, 0.004152324050664902, -0.04669741168618202, -0.012159645557403564, 0.011441959999501705, -0.003513242118060589, 0.023170992732048035, -0.006859024055302143, -0.009473450481891632, 0.012617597356438637, 0.001258513075299561, -0.013677038252353668, 0.01066275779157877, 0.002505064709112048, -0.015611371956765652, 0.008707919158041477, 0.003132185200229287, 0.021380197256803513, -0.013916266150772572, -0.1520126610994339, 0.0076211378909647465, 0.02155791036784649, 0.01313706487417221, -0.0006809469778090715, -0.04814645275473595, -0.026588544249534607, -0.021544240415096283, 0.04098326712846756, 0.04341656342148781, -0.06698399037122726, -0.02624678984284401, 0.014299032278358936, -0.046779435127973557, 0.025658970698714256, 0.016910040751099586, 0.010765284299850464, 0.030347850173711777, -0.007915046997368336, 0.028680086135864258, -0.02694397047162056, -0.005020381882786751, -0.022637855261564255, -0.014408393763005733, 0.02887146733701229, 0.020942751318216324, 0.007156351115554571, -0.046888794749975204, 0.016540944576263428, -0.043197840452194214, -0.02118881419301033, -0.007627973333001137, 0.009603317826986313, 0.009630657732486725, 0.028926149010658264, -0.006014889106154442, 0.030976679176092148, -0.030047105625271797, 0.01217331551015377, -0.010238981805741787, -0.021530568599700928, -0.00381740415468812, -0.020546315237879753, 0.00032637608819641173, 0.011072863824665546, -0.0006753934430889785, 0.025467587634921074, 0.024866098538041115, 0.0059431204572319984, -0.016322221606969833, 0.017224455252289772, -0.00844818539917469, 0.012453555129468441, -0.014312702231109142, -0.0026930300518870354, 0.03485901653766632, -0.0049896240234375, 0.017415838316082954, -0.004702549893409014, -0.02764114923775196, 0.026137428358197212, 0.015023552812635899, 0.019439028576016426, -0.005755155347287655, -0.00748443603515625, 0.021134132519364357, -0.018810199573636055, -0.009685338474810123, -0.033847421407699585, 0.020778708159923553, 0.021243495866656303, -0.0029168794862926006, 0.01094299741089344, 0.005457828287035227, 0.016581956297159195, 0.05235687643289566, 0.009138530120253563, 0.014927861280739307, -0.01466812752187252, -0.018318071961402893, -0.010478210635483265, -0.02295226976275444, -0.01926131546497345, 0.0081816166639328, -0.03420284762978554, -0.013608686625957489, 0.0084140095859766, -0.008789940737187862, 0.009391428902745247, -0.020341262221336365, -0.046287305653095245, -0.00943243969231844, -0.025973385199904442, 0.0029527638107538223, -0.030129127204418182, 0.00901549868285656, 0.04423677548766136, -0.004921272862702608, -0.10897885262966156, 0.01220749132335186, 0.012050284072756767, -0.005611618049442768, 0.05249357968568802, -0.02281556837260723, 0.04021773487329483, -0.00012089585652574897, -0.018454773351550102, -0.06321101635694504, 0.015625040978193283, 0.020614665001630783, 0.010984008200466633, -0.013567675836384296, -0.006831683684140444, -0.022542163729667664, 0.021079452708363533, -0.021298175677657127, 0.04773634672164917, -0.006452335510402918, -0.00793555285781622, -0.00775100477039814, 0.010587572120130062, -0.009384593926370144, -0.02527620457112789, -0.029828382655978203, 0.0021940674632787704, -0.007327228784561157, -0.002041986444965005, 0.011503475718200207, -0.010874646715819836, -0.016417913138866425, -0.00023474301269743592, -0.014804829843342304, -0.03704624995589256, -0.010204805992543697, -0.007258877623826265, -0.027299394831061363, -0.02448333241045475, -0.013178075663745403, 0.02485242858529091, -0.015748074278235435, 0.021011101081967354, -0.01689637079834938, 0.0357339084148407, -0.022528493776917458, 0.005967043340206146, 0.0058542643673717976, 0.03253508359193802, 6.322468834696338e-05, 0.03212497755885124, 0.017374828457832336, -0.00015699373034294695, -0.000557915132958442, -0.006243865005671978, 0.007443425245583057, 0.01217331551015377, 0.02351274900138378, -0.006698399316519499, -0.0005587695632129908, 0.00034859016886912286, 0.02005418762564659, 0.02947295643389225, -0.009111190214753151, -0.028379341587424278, -0.00042334909085184336, -0.0011124127777293324, 0.052876345813274384, -0.016513604670763016, -0.027955563738942146, 8.710749170859344e-07, -0.0035679228603839874, 0.0016908332472667098, 0.005908945109695196, -0.004391552414745092, 0.02673891745507717, 0.015132914297282696, 0.012269007042050362, -0.056868042796850204, 0.025002799928188324, 0.05774293467402458, -0.024100568145513535, 0.005310873966664076, 0.008195286616683006, -0.02088806964457035, 0.01370437815785408, 0.026520192623138428, -0.016144508495926857, -0.008140605874359608, 0.034148167818784714, 0.038905397057533264, -0.0016370067605748773, 0.009336748160421848, -0.020683016628026962, -0.0045487601310014725, -0.046424008905887604, -0.04636932909488678, -0.004641033709049225, 0.017702912911772728, -0.033081889152526855, 0.042322948575019836, 0.04180347919464111, -0.004634198732674122, -0.0033833752386271954, 0.009377758949995041, 0.022938599810004234, -0.01096350234001875, -0.0422409251332283, 0.020642006769776344, -0.000839435902889818, -0.002528987592086196, 0.02794189378619194, 0.013396798633038998, -0.0020949586760252714, 0.0002535395324230194, 0.02571365050971508, 0.04467422142624855, 0.008277308195829391, -0.011578661389648914, 0.009999752976000309, 0.000995361595414579, 0.03641742095351219, -0.0019121195655316114, -0.0019155371701344848, -0.006640301086008549, -0.046888794749975204, 0.0034534349106252193, -0.010238981805741787, -0.006889782380312681, 0.005386060103774071, 0.04054582118988037, 0.005225434899330139, -0.002684486098587513, 0.030511893332004547, -0.013266931287944317, 0.03879603371024132, -0.0008488341700285673, -0.019876474514603615, -0.0357339084148407, 0.005092150531709194, 0.01606248877942562, 0.011496640741825104, -0.03379274159669876, 0.01550200954079628, -0.021940674632787704, 0.03141412511467934, -0.017757592722773552, -0.014654457569122314, -0.02474306710064411, 0.007566457148641348, -0.00279384758323431, -0.009603317826986313, -0.005673134233802557, -0.012036613188683987, 0.019616741687059402, 0.0185641348361969, 0.03196093440055847, -0.03510507941246033, -0.012959351763129234, 0.019903814420104027, -0.0029510550666600466, 0.04008103534579277, -0.02441498264670372, -0.06014889106154442, 0.04910336807370186, -0.028133276849985123, -0.003299645148217678, -0.00387550238519907, -0.002117172582075, -0.009992917999625206, -0.02694397047162056, -0.0480370931327343, 0.01016379613429308, 0.04049114137887955, 0.004330036696046591, 0.0452483706176281, -0.002696447540074587, 0.05022432655096054, 0.011838395148515701, 0.04379932954907417, 0.017456848174333572, 0.01926131546497345, -0.0023324782960116863, -0.0035029894206672907, 0.03792114183306694, -0.027053331956267357, 0.013663367368280888, 0.011578661389648914, -0.009343583136796951, 0.05112655833363533, 0.03532380238175392, 0.002891247859224677, -0.0004086109111085534, 0.012460390105843544, 0.010464539751410484, -0.006524104159325361, -0.025207852944731712, 4.058341437485069e-05, 0.009124860167503357, -0.06353910267353058, 0.020710356533527374, 0.04051848128437996, -0.0007873182184994221, -0.01786695420742035, -0.007074330002069473, 0.04032709822058678, -0.012227996252477169, -0.005341631826013327, -0.007826191373169422, 0.046287305653095245, 0.012849990278482437, 0.0023000116925686598, -0.017921635881066322, 0.030921999365091324, -0.007552787195891142, 0.026793597266077995, 0.0017326981760561466, 0.020901739597320557, -0.023526418954133987, 0.002863907488062978, -0.031140722334384918, -0.028953488916158676, -4.386746877571568e-05, 0.026889288797974586, -0.029226893559098244, -0.00831831805408001, 0.006999143864959478, -0.011763209477066994, 0.005792748183012009, -0.011264246888458729, -0.014052968472242355, -0.00015945009363349527, -0.018646156415343285, -0.016445253044366837, -0.021311845630407333, -0.04188550263643265, 0.007682654075324535, 0.0005305747617967427, -0.0020847059786319733, -0.005146831274032593, 0.03885071724653244, -0.015037222765386105, -0.022432802245020866, 0.008222626522183418, 0.04079188406467438, 0.005157084204256535, 0.04166677966713905, 0.045221030712127686, -0.04068252444267273, -0.008434515446424484, -0.03357401862740517, 0.0030569990631192923, 0.03283582627773285, -0.001499450416304171, 0.005761990323662758, 0.011934086680412292, 0.004805076401680708, 0.03641742095351219, 0.004459903575479984, 0.021216154098510742, -0.028051255270838737, 0.025330886244773865, 0.019069932401180267, -0.014299032278358936, -0.0008693394483998418, -0.058891233056783676, -0.0008142314618453383, 0.010649087838828564, 0.007552787195891142, 0.008646403439342976, -0.03196093440055847, 0.026219448074698448, 0.011004513129591942, 0.035843271762132645, -0.033245932310819626, -0.008338823914527893, 0.021598920226097107, -0.03649944067001343, 0.01882386952638626, -0.008366163820028305, -0.03395678475499153, -0.0008368727285414934, -0.030457211658358574, -0.042924437671899796, 0.006766750477254391, -0.023676790297031403, 0.008434515446424484, -0.01759355142712593, 0.011482969857752323, 0.011127544566988945, 0.038303907960653305, 0.03578859195113182, 0.010020258836448193, -0.004818746354430914, 0.01090882159769535, -0.02464737556874752, 0.015488339588046074, 0.012576586566865444, -0.007163186091929674, 0.01205711904913187, 0.03701891005039215, 0.012829485349357128, 0.019999505952000618, -0.0028724514413625, 0.04770900681614876, 0.03264444321393967, 0.0016677647363394499, -0.05298570543527603, -0.011968262493610382, -0.023129982873797417, 0.01726546697318554, 0.008386669680476189, -0.005057975184172392, -0.01879652962088585, 0.003270596032962203, 0.006623213179409504, -0.0001377700100420043, 0.00025076279416680336, -0.012911506928503513, -0.013697543181478977, 0.008236297406256199, 0.002925423439592123, 0.0037114599253982306, 0.04267837107181549, -0.025932375341653824, -0.051208578050136566, -0.018386423587799072, -0.011346268467605114, 0.014531425200402737, 0.004934943281114101, -0.019001582637429237, 0.011975097469985485, -0.018769187852740288, 0.005638958420604467, -0.03931550309062004, 0.01979445293545723, -0.039370182901620865, 0.017183445394039154, -0.014285361394286156, 0.022104717791080475, 0.02202269621193409, 0.0033098978456109762, 0.038467951118946075, -0.0008859999943524599, -0.022569505497813225, 0.016951050609350204, -0.02218673937022686, -0.0021701445803046227, -0.021571580320596695, -0.0034226770512759686, 0.09503524750471115, -0.018072007223963737, -0.028215298429131508, -0.016021477058529854, -1.2475395124056377e-05, 0.02840668149292469, 1.1814579465863062e-06, 0.005618453491479158, -0.045357733964920044, 0.018208710476756096, -0.0013883799547329545, 0.021038442850112915, 5.873915142728947e-05, -0.0024862680584192276, -0.016773339360952377, 0.01886487938463688, -0.028816787526011467, -0.0022555834148079157, 0.012016108259558678, 0.045494433492422104, 0.015078233554959297, 0.05498155578970909, -0.018673496320843697, 0.006476258393377066, 0.028816787526011467, -0.011086534708738327, 0.007716829422861338, -0.0069376276805996895, -0.0038652499206364155, 0.042924437671899796, 0.016417913138866425, -0.013895761221647263, -0.036007314920425415, 0.014791158959269524, -0.048884645104408264, -0.0037695583887398243, 0.0022897589951753616, 0.039069440215826035, 0.027559129521250725, 0.01982179470360279, 0.01039618905633688, 0.012275842018425465, -0.0035850107669830322, 0.006732574664056301, 0.00270328251644969, 0.005215182434767485, -0.02258317545056343, 0.0022914677392691374, 0.0115444865077734, 0.0029732692055404186, -0.0018830704502761364, -0.015748074278235435, 0.004661539103835821, -0.008646403439342976, -0.009179540909826756, -0.031113380566239357, -0.008154275827109814, 0.01982179470360279, -0.014381052926182747, 0.01986280456185341, -0.02218673937022686, 0.0011474426137283444, -0.011284752748906612, -0.0025836683344095945, -0.0005109238554723561, -0.007675818633288145, 0.0009005246101878583, 0.034312207251787186, -0.02385450340807438, 0.013731718994677067, -0.01082680094987154, -0.015187595039606094, -0.015529350377619267, -0.009247892536222935, -0.017921635881066322, 0.016281211748719215, -0.01710142381489277, -0.003328694263473153, 0.016923710703849792, 0.017456848174333572, -0.0030552903190255165, -0.04117465019226074, -0.0165956262499094, -0.026820937171578407, -0.010854140855371952, -0.006257535424083471, 0.020806048065423965, 0.0037968987599015236, -0.026957640424370766, 0.011852066032588482, 0.005902110133320093, 0.03190625458955765, 0.03835858777165413, 0.010485045611858368, 0.004193334840238094, -0.0020283162593841553, 0.006151591427624226, 0.004870009608566761, 0.012651772238314152, 0.001983888214454055, -0.001961674075573683, -0.010218476876616478, 0.02950029820203781, -0.015160255134105682, -0.026438172906637192, 0.02239179238677025, -0.03625337779521942, -0.04254167154431343, 0.012603926472365856, 0.009787864983081818, -0.005806418601423502, 0.010888316668570042, -0.02694397047162056, 0.012480895034968853, -0.0163632333278656, -0.02427827939391136, -0.014941531233489513, 0.042158905416727066, 0.02933625504374504, -0.01849578507244587, 0.02574099227786064, 0.0026451842859387398, 0.003564505372196436, 0.015857435762882233, -0.0022470394615083933, -0.0034175505861639977, -0.005710727069526911, 0.005912362597882748, -0.0045555951073765755, -0.003109971061348915, -0.003708042437210679, 0.011277916841208935, 0.011995603330433369, -0.017757592722773552, 0.0063668969087302685, 0.030457211658358574, -0.008940313011407852, 0.0002781031944323331, -0.05003294348716736, -0.014312702231109142, 0.023731471970677376, 0.007238372229039669, 0.00848236121237278, 0.01812668889760971, -0.020204558968544006, -0.010840470902621746, 0.018782857805490494, -0.016458924859762192, 0.01829073205590248, -0.0001817709708120674, -0.021571580320596695, 0.035241782665252686, 0.008099595084786415, 0.04839251935482025, -0.0021530569065362215, -0.006971803493797779, 0.005194677039980888, 0.004767483100295067, 0.0447835847735405, -0.01699206233024597, 0.02554960921406746, -0.017470519989728928, -0.005919197574257851, 0.029254233464598656, 0.03745635598897934, 0.01550200954079628, 0.013465149328112602, -0.005823506508022547, 0.0071085053496062756, -0.019138284027576447, 0.020013175904750824, -0.011127544566988945, 0.029254233464598656, -0.012918341904878616, -0.021503228694200516, -0.008420844562351704, -0.00017525626753922552, -0.018413763493299484, -0.0375930592417717, 0.0024401312693953514, -0.0003430366632528603, -0.03026582859456539, 0.026506522670388222, 0.015406318008899689, 0.010737944394350052, -0.026233119890093803, 0.03652678057551384, -0.0031082623172551394, 0.02687561884522438, -0.019548390060663223, 0.002633222844451666, 0.009350419044494629, 0.04008103534579277, 0.020272910594940186, 0.014203340746462345, 0.039233483374118805, 0.007853531278669834, -0.004077137913554907, 0.05470815300941467, 0.020669346675276756, -0.0031014273408800364, -0.014736478216946125, -0.008755764923989773, -0.0014054677449166775, -0.009514461271464825, 0.005905527621507645, 0.018468443304300308, 0.009671668522059917, -0.00646258844062686, 0.009938237257301807, 0.006315633654594421, 0.010765284299850464, 0.007723664399236441, -0.016390573233366013, -0.0005019527743570507, 0.012145974673330784, 0.02112046256661415, -0.02664322592318058, -0.007723664399236441, -0.0018847791943699121, -0.011271081864833832, -0.008516536094248295, -0.0051263258792459965, -0.0031287677120417356, 0.007477601058781147, 0.009787864983081818, 0.025235194712877274, -0.004248015582561493, 0.013512995094060898, 0.018646156415343285, 0.01766190119087696, -0.039206139743328094, -0.002764798467978835, -0.0010414986172690988, 0.015460999682545662, 0.014052968472242355, -0.02408689633011818, 0.03699157014489174, 0.023731471970677376, 0.03379274159669876, -0.029554978013038635, 0.010143290273845196, 0.010936162434518337, 0.02328035607933998, -0.014586105942726135, 0.0213528573513031, 0.0011448794975876808, 0.026397161185741425, -0.033382635563611984, -0.009206881746649742, 0.01081313006579876, 0.00025204435223713517, -0.01640424318611622, -0.03622603788971901, 0.04024507850408554, -0.03885071724653244, 0.023690462112426758, -0.011086534708738327, -0.010758449323475361, 0.021038442850112915, -0.018700838088989258, -0.024168917909264565, 0.002202611416578293, 0.0038549972232431173, -0.00844818539917469, 0.010020258836448193, -0.027299394831061363, 0.007696324028074741, -0.041037946939468384, -0.01217331551015377, 0.0071085053496062756, 0.031714871525764465, -0.01228951197117567, -0.011824725195765495, -0.011729033663868904, 0.015884775668382645, 0.0028041002806276083, -0.02271987684071064, -0.013273767195641994, -0.009008663706481457, 0.02708067186176777, -0.038932736963033676, 0.0005322835058905184, -0.003046746365725994, 0.017415838316082954, 0.017060412093997, -0.010457704775035381, -0.022897589951753616, 0.02631513960659504, 0.04079188406467438, -0.047517623752355576, 0.012063954025506973, 0.021571580320596695, -0.04625996574759483, 0.0034585613757371902, 0.00015891611110419035, -0.003311606589704752, 0.002074453281238675, -0.009992917999625206, 0.028789447620511055, -0.01673232764005661, -0.018509455025196075, 0.002229951787739992, 0.024469662457704544, 0.022692536935210228, 0.012145974673330784, -0.0033987541683018208, 0.03915145993232727, -0.005150248762220144, 0.00673599261790514, -0.0040908083319664, 0.0003782801504712552, -0.0016489682020619512, 0.02262418530881405, 0.011612837202847004, 0.010922491550445557, 0.012918341904878616, 0.014162329956889153, -0.009063344448804855, 0.02239179238677025, -0.03250774368643761, -0.019069932401180267, -0.013964111916720867, -0.020600995048880577, 0.035706568509340286, 0.004165994469076395, -0.010177466087043285, 0.027149023488163948, 0.0254129059612751, -0.0043026963248848915, 0.030019765719771385, 0.020272910594940186, 0.0675308033823967, 0.0021821060217916965, -0.0009663124801591039, 0.025768332183361053, -0.010293662548065186, 0.0008766017272137105, 0.024305621162056923, -0.017743922770023346, -0.02139386720955372, 0.014791158959269524, -0.002236786996945739, 0.008502866141498089, 0.009999752976000309, 0.0012670569121837616, 0.025795672088861465, -0.006401072256267071, -0.005806418601423502, 0.00129952363204211, 0.03622603788971901, 0.039534226059913635, -0.039206139743328094, -0.002098376164212823, -0.00021466490579769015, 0.012337357737123966, -0.006787255872040987, -0.024469662457704544, -0.029855722561478615, -0.014873180538415909, -0.0345856137573719, -0.007340898737311363, 0.006763332989066839, 0.019042592495679855, -0.020847059786319733, 0.0028980830684304237, -0.009767360053956509, -0.016923710703849792, 0.00914536602795124, -0.03373806178569794, 0.02042328380048275, 0.014832169748842716, 0.00982887577265501, 0.03485901653766632, -0.031714871525764465, -0.02761380933225155, -0.031195402145385742, -0.008120100013911724, 0.03258976340293884, -0.018782857805490494, -0.012310017831623554, -0.07075697183609009, 0.004316366743296385, -0.01589844562113285, 0.011079699732363224, -0.002293176483362913, 0.004545342177152634, -0.00899499375373125, -0.003224459011107683]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
Comment H.1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
Comment H.2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
Comment H.3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
1 Introduction
Reinforcement Learning from Human Feedback (RLHF) (Christiano et al., 2017; Ziegler et al., 2019) has
emerged as a powerful paradigm to align modern generative models like Large Language Models (LLMs)
and diffusion models with human values and preferences. This approach has shown significant effectiveness
in applications such as ChatGPT (OpenAI, 2023), Claude (Anthropic, 2023), Bard (Google, 2023), and
LLaMA2 (Touvron et al., 2023), by making the built AI system helpful, harmless, honest and controllable
(Ouyang et al., 2022; Bai et al., 2022).
Despite its effectiveness, RLHF’s implementation often involves ad-hoc practices and extensive algorithmic
tuning in the entire pipeline, including preference data collection (it is hard to select representative hu-
mans (Bai et al., 2022), larger language models (Wang et al., 2024) or program compiler (Wang et al.,
2023b)), preference/reward modeling (reward misspecification and misgeneralization (Hong et al., 2022; Gao
et al., 2023)), and model optimization (instability of training (Choshen et al., 2019) and distribution shift is-
sue (Michaud et al., 2020; Tien et al., 2022)). Meanwhile, the resulting models of RLHF typically suffer from
issues like performance degeneration if we impose strong optimization pressure toward an imperfect reward
function (Michaud et al., 2020; Tien et al., 2022; Gao et al., 2023), which contains bias and approximation
error from the data collection and preference modeling (Gao et al., 2023; Wang et al., 2023d). Casper et al.
(2023) also discussed many other challenges of RLHF. Thus, it is important to understand the mathematical
3
principle of the RLHF process, as well as the connections among its different steps, which should be able to
motivate future algorithmic design in principle.
In current RLHF theory, the agent’s objective is to maximize an observed reward function, with the optimal
policy typically being deterministic and reward-greedy (Agarwal et al., 2019). However, in practical RLHF
applications, merely maximizing the reward function is often insufficient and probably results in overfitting,
as the generative model must simultaneously ensure both diversity and high fidelity in its outputs. A
deterministic maximizer of the reward tends to compromise on these aspects significantly. For example, the
maximizer of the “safety reward” tends to avoid providing answers all the time, which contradicts the LLM’s
training objective. The situation worsens due to bias and approximation errors in reward modeling, leading
to the critical problem of reward hacking, where the model often repeats superfluous, pleasing yet irrelevant
words to appease the reward model (Michaud et al., 2020; Tien et al., 2022; Casper et al., 2023). Thus, it is
important to model diversity and high fidelity in the theoretical framework beyond the reward. Notably, the
most widely used mathematical objective function for this goal can be regarded as a reverse-KL regularized
contextual bandit problem (Ziegler et al., 2019; Wu et al., 2021a; Ouyang et al., 2022; Rafailov et al., 2023;
Liu et al., 2023a). The KL regularized contextual bandit additionally imposes a constraint that the optimal
policy cannot move too far away from the original policy (i.e. the starting checkpoint of the LLM). A major
difference","[-0.004958207253366709, -0.006453773472458124, 0.06324108690023422, 0.005017145536839962, 0.02821684069931507, -0.000855530146509409, -0.02395852841436863, 0.0416695699095726, -0.027082271873950958, 0.04361454024910927, 0.008921826258301735, -0.04644359275698662, -0.03135531768202782, 0.006682160310447216, 0.009327028878033161, -0.04502906650304794, 0.025741420686244965, -0.03612934425473213, 0.030206017196178436, 0.020731640979647636, -0.024459505453705788, -0.00963645614683628, -0.00859766360372305, 0.03444959223270416, -0.011890856549143791, -0.033860206604003906, 0.004888217430561781, 0.03450853377580643, -0.00834717508405447, -0.0070984140038490295, 0.03450853377580643, -0.029189325869083405, -0.0512765571475029, -0.008884989656507969, -0.03117850236594677, 0.033329762518405914, 0.01150775607675314, 0.028334716334939003, -0.0031697899103164673, 0.02966083586215973, -0.020024379715323448, -0.06365365535020828, -0.0016373870894312859, 0.043172501027584076, -0.01025531068444252, 0.028437860310077667, 0.023943793028593063, 0.013504299335181713, -0.02580035850405693, 0.036040935665369034, -0.07296594977378845, 0.0274359043687582, -0.009953251108527184, -0.020319072529673576, -0.01029951497912407, -0.002711174078285694, 0.023369142785668373, -0.023855386301875114, 0.029484018683433533, 0.01927291229367256, 0.010166903026401997, -0.0416695699095726, -0.016930103302001953, 0.040431857109069824, -0.0246510561555624, -0.03117850236594677, -0.083692766726017, -0.011890856549143791, -0.005315522197633982, 0.06247488409280777, -0.02042221464216709, -0.03819219395518303, 0.03551048785448074, -0.006354314275085926, -0.02079058066010475, -0.012340262532234192, 0.024179548025131226, 0.04146328195929527, -0.0014891198370605707, -0.004269362427294254, 0.0041514853946864605, -0.03109009563922882, 0.015721863135695457, -0.04069708287715912, -0.0066121709533035755, -0.041492752730846405, -0.03854582458734512, -0.02154204621911049, -0.045471105724573135, -0.04340825602412224, 0.013025423511862755, -0.015898678451776505, -0.024430036544799805, 0.033241353929042816, 0.03524526581168175, 0.007367321290075779, -0.0010848380625247955, 0.01575133204460144, 0.06153186783194542, 0.021188415586948395, 0.0012957275612279773, -0.043054625391960144, 0.03795643895864487, -0.02736223116517067, 0.029646100476384163, 0.011890856549143791, -0.018757199868559837, 0.006416936870664358, -0.016060760244727135, -0.012531813234090805, -0.07102097570896149, -0.02580035850405693, -0.06972432881593704, 0.009511211887001991, -0.011566693894565105, -0.06188549846410751, -0.06942963600158691, 0.0190371572971344, 0.00865660235285759, 0.0025509349070489407, -0.03822166100144386, 0.010984675958752632, 0.026065582409501076, -0.028157901018857956, 0.0004708178748842329, -0.010940471664071083, 0.04119805991649628, -0.04700350761413574, -0.015353497117757797, -0.009069172665476799, 0.016222842037677765, 0.04765183478593826, -0.01116149127483368, -0.043997641652822495, -0.04936105012893677, 0.009010233916342258, -0.004335668403655291, -0.006365365348756313, -0.033329762518405914, -0.03347710892558098, -0.005993315950036049, -0.02588876709342003, -0.06223912909626961, 0.014675703831017017, -0.01878666877746582, 0.02490154467523098, -0.011861386708915234, 0.018683526664972305, -0.028747286647558212, 0.033035069704055786, 0.017976263538002968, -0.014690438285470009, -0.03612934425473213, 0.03117850236594677, -0.020039113238453865, -0.05254373326897621, -0.0070431591011583805, 0.024783669039607048, 0.023737508803606033, -0.02904197946190834, 0.014285235665738583, 0.07526455074548721, -0.016635410487651825, 0.016016555950045586, 0.029587162658572197, 0.011360409669578075, -0.03306453675031662, 0.009754333645105362, -0.04941999167203903, 0.005717041436582804, -0.011743510141968727, -0.0034460644237697124, -0.061472926288843155, -0.010822595097124577, 0.006019101478159428, -0.008730275556445122, -0.011073083616793156, -0.006741099059581757, 0.0146830715239048, -0.06760253757238388, -0.012133978307247162, 0.010004822164773941, -0.02669917233288288, -0.007735687308013439, -0.012104508467018604, 0.022794492542743683, -0.02798108570277691, -0.03076593391597271, -0.0020296969451010227, 0.018757199868559837, 0.003959935158491135, 0.056964125484228134, 0.08852573484182358, 0.002578562358394265, 0.025608807802200317, 0.0010894426377490163, 0.056787312030792236, 0.02805475890636444, 0.011986631900072098, -0.024474240839481354, 0.02432689443230629, 0.010564738884568214, 0.013740054331719875, -0.07019583880901337, 0.023560693487524986, 0.02384065091609955, -0.010712085291743279, 0.01887507736682892, -0.03757333755493164, -0.028541002422571182, 0.007161036133766174, 0.0009623563382774591, 0.044115517288446426, 0.037190236151218414, -0.021880943328142166, 0.014314704574644566, -0.010638412088155746, 0.03680713474750519, -0.014042113907635212, 0.06683633476495743, -0.0050760842859745026, 0.03138478845357895, 0.027995821088552475, 0.003156897146254778, -0.07190505415201187, -0.02079058066010475, 0.04785811901092529, -0.03763227537274361, 0.029469285160303116, -0.008538724854588509, 0.062003374099731445, 0.0015756858047097921, -0.04361454024910927, -0.051335494965314865, 0.0021438903640955687, -0.032504621893167496, 0.0061627640388906, 0.0036320893559604883, 0.040137164294719696, -0.019950706511735916, -0.013091729953885078, 0.022750288248062134, 0.011109920218586922, -0.00834717508405447, 0.007787258364260197, 0.036365095525979996, -0.0118761220946908, -0.031561605632305145, 0.014329439960420132, 0.009385967627167702, 0.0340370237827301, -0.034272778779268265, -0.0012782302219420671, -0.015766067430377007, -0.04152222350239754, 0.03639456629753113, -0.0035050029400736094, 0.011478286236524582, -0.022293513640761375, -0.04617837071418762, -0.03757333755493164, -0.002062849933281541, 0.005440766457468271, 0.023266000673174858, 0.004221475217491388, -0.014358908869326115, -0.05652208626270294, -0.013194872066378593, -0.002398062963038683, 0.008487153798341751, 0.02055482566356659, -0.02338387817144394, -0.04614889994263649, 0.0028677298687398434, -0.03462640941143036, -0.02998499758541584, 0.07726846635341644, 0.040048759430646896, -0.025402523577213287, 0.014322072267532349, -0.03138478845357895, 0.021630454808473587, 0.06607013940811157, 0.017696306109428406, 0.009820639155805111, 0.0048919012770056725, -0.017711039632558823, -0.0022194054909050465, -0.04010769724845886, -0.03766174614429474, -0.012089774012565613, -0.015589251182973385, 0.028894633054733276, -0.038251131772994995, 0.024267956614494324, 0.00902496837079525, 0.03253408893942833, -0.00048163862084038556, -0.007816728204488754, 0.00449038203805685, 0.016841696575284004, 0.02292710356414318, -0.042524177581071854, 0.017622632905840874, 0.0025564604438841343, 0.01809414103627205, 0.02641921304166317, 0.008501888252794743, -0.01029951497912407, 0.025991909205913544, 0.027376964688301086, 0.04016663506627083, -0.004048342816531658, 0.01862458698451519, -0.0530741810798645, -0.038869988173246384, 0.05086398497223854, 0.0013334851246327162, 0.0323278047144413, -0.029837651178240776, -0.036571383476257324, -0.020230663940310478, 0.019759155809879303, -0.005919642746448517, 0.02653709053993225, -0.011050981469452381, 0.04502906650304794, -0.00032853646553121507, -0.04402711242437363, 0.0004459531628526747, 0.012995954602956772, 0.0022378237918019295, 0.04417445883154869, -0.008420848287642002, -0.0033723912201821804, -0.02637501060962677, -0.05142390355467796, 0.040225572884082794, 0.03436118736863136, -0.015103008598089218, -0.05964583158493042, -0.00939333438873291, -0.016959574073553085, 0.0023814865853637457, -0.059793177992105484, 0.024636322632431984, 0.019258176907896996, -0.018889810889959335, 0.038575295358896255, 0.03942990303039551, -0.006288008764386177, -0.030500710010528564, 0.0006672030431218445, 0.011397246271371841, -0.033329762518405914, 0.045471105724573135, 0.0045456369407474995, -0.05360462889075279, -0.010866798460483551, -0.004026241134852171, -0.012207651510834694, 0.018197283148765564, 0.0063027432188391685, -0.008862887509167194, 0.005348674952983856, 0.018816137686371803, -0.005065033212304115, 0.0029100917745381594, 0.01206030510365963, -0.016311248764395714, -0.002915617311373353, 0.012008733116090298, -0.03910573944449425, -0.003377916757017374, -0.04785811901092529, 0.009511211887001991, 0.0380743145942688, 0.020201195031404495, 0.007698850706219673, -0.008892356418073177, -0.027008598670363426, 0.03067752532660961, 0.004125699866563082, -0.032917190343141556, 0.03285825252532959, 0.037396520376205444, -0.019832829013466835, -0.039695125073194504, -0.04968521371483803, 0.00675951736047864, 0.040137164294719696, 0.03244568407535553, -0.01722479611635208, 0.04063814505934715, 0.035009510815143585, -0.018079405650496483, -0.0027166996151208878, 0.044203925877809525, 0.07791678607463837, 0.03088380955159664, -0.03179735690355301, -0.03462640941143036, -0.02419428341090679, 0.011979264207184315, 0.007779891137033701, 0.017740508541464806, 0.0013261177809908986, 0.06188549846410751, 0.005996999330818653, 0.02575615420937538, 0.049125298857688904, 0.008767112158238888, 0.032917190343141556, -0.06076566502451897, 0.030736463144421577, -0.0360114648938179, 0.02683178335428238, -0.0063211615197360516, 0.043054625391960144, 0.04606049135327339, 0.0294987540692091, -0.026507621631026268, -0.022617675364017487, -0.016399657353758812, 0.01171404030174017, 0.03418437018990517, 0.035746242851018906, -0.003177157137542963, -0.029189325869083405, -0.03524526581168175, -0.02440056763589382, 0.06076566502451897, 0.033860206604003906, -0.03892892599105835, -0.05077557638287544, 0.02308918535709381, 0.034272778779268265, 0.005636000540107489, -0.01919923909008503, -0.0648324266076088, 0.05599164217710495, 0.01793205924332142, -0.03769121691584587, 0.024297425523400307, -0.012377099134027958, 0.053516220301389694, -0.014233664609491825, 0.012089774012565613, 0.007551504299044609, -0.013040158897638321, -0.0361882820725441, -0.00045239957398734987, 0.06919387727975845, 0.020540092140436172, -0.005061349831521511, -0.024046937003731728, 0.09960617870092392, -0.029071450233459473, 0.02678757905960083, 0.02342808060348034, 0.004914003424346447, -0.008118787780404091, 0.02522570826113224, -0.01866879127919674, 0.030736463144421577, 0.024061670526862144, 0.0399603508412838, -0.0024367414880543947, -0.057494573295116425, 0.0036689259577542543, -0.00364129850640893, -0.039606720209121704, 0.015898678451776505, -0.004291464574635029, -0.009128110483288765, -0.010159536264836788, 0.023575427010655403, -0.009982720017433167, 0.029307203367352486, -0.0045898412354290485, 0.0015324028208851814, 0.010778390802443027, 0.01214134506881237, -0.03795643895864487, 0.02333967387676239, 0.060117341578006744, 0.0455300435423851, -0.02818736992776394, -0.023118654265999794, -0.014823050238192081, 0.006439038552343845, -0.04134540632367134, 0.020127521827816963, -0.017711039632558823, 0.008398746140301228, 0.0027222251519560814, 0.0019155035261064768, -0.029145123437047005, -0.007477831095457077, -0.00508713535964489, 0.029351407662034035, -0.005492337979376316, -0.024872075766324997, 0.03220992907881737, 0.0015627930406481028, 0.026021378114819527, 0.04146328195929527, -0.01883087307214737, -0.01220028381794691, 0.0455300435423851, -0.05071663856506348, -0.007149985060095787, -0.017003776505589485, 0.029587162658572197, 0.004483014810830355, 0.02485734224319458, -0.029690304771065712, -0.015692394226789474, -0.012480242177844048, 0.015456640161573887, 0.009717497043311596, -0.02580035850405693, -0.03757333755493164, 0.012362364679574966, -0.003416595282033086, 0.025034157559275627, -0.021586250513792038, -0.06076566502451897, -0.040962304919958115, -0.015530313365161419, 0.034479063004255295, -0.001633703475818038, 0.006788986269384623, 0.028570471331477165, -0.04320197179913521, -0.02805475890636444, -0.01604602485895157, -0.02752431109547615, -0.03388967737555504, -0.03294666111469269, 0.0027627453673630953, 0.0009872210212051868, 0.020289601758122444, 0.0343906544148922, -0.01788785494863987, -0.02428269013762474, -0.0022009871900081635, -0.02674337662756443, 0.03350657597184181, 0.025004688650369644, 0.037514399737119675, -0.02543199248611927, -0.03179735690355301, -0.018197283148765564, -0.01906662806868553, -0.0137179521843791, -0.022735552862286568, 0.01177297905087471, -0.0005313680157996714, 0.022706083953380585, -0.02014225535094738, -0.005661786533892155, -0.011684571392834187, 0.022470328956842422, -0.040667612105607986, 0.007897768169641495, 0.002188094425946474, 0.012583384290337563, 0.01718059368431568, 0.0019947022665292025, -0.03663032129406929, 0.010645778849720955, 0.04712138697504997, -0.042730461806058884, 0.0038567925803363323, 0.004177270922809839, 0.001055368804372847, -0.00828823633491993, 0.04779918119311333, 0.03067752532660961, -0.0322393961250782, -0.036689259111881256, -0.033005598932504654, -0.02420901693403721, -0.0265812948346138, 0.009967985562980175, -0.00315321353264153, 0.01566292531788349, -0.06518606096506119, 0.003263723338022828, 0.05051035434007645, -0.028246309608221054, -0.023973263800144196, -0.0015618720790371299, -0.048182278871536255, 0.0033097690902650356, -0.008133522234857082, 0.032268866896629333, 0.0038125887513160706, 0.006553232204169035, 0.017121654003858566, 0.005613898858428001, 0.00444986205548048, -0.043290380388498306, -0.032710906118154526, 0.007544137071818113, -0.008280868642032146, -0.001114307320676744, 0.03795643895864487, -0.02269134856760502, -0.01919923909008503, -0.0028437860310077667, 0.017121654003858566, -0.032681435346603394, -0.03990141302347183, -0.021807270124554634, 0.02773059718310833, 0.006405885796993971, 0.061472926288843155, -0.0010903634829446673, -0.03568730503320694, -0.01653226837515831, 0.01628177985548973, -0.03833954036235809, 0.009717497043311596, 0.0025914551224559546, -0.021792536601424217, -0.021424170583486557, 0.001467017806135118, -0.00682950671762228, -0.02957242727279663, -0.0028437860310077667, -0.0009991929400712252, -0.015972351655364037, 0.01164773479104042, 0.008118787780404091, 0.00029538353555835783, -0.028040023520588875, 0.009850108064711094, -0.04868325963616371, 0.020171726122498512, 0.03565783426165581, -0.011610898189246655, -0.04102124273777008, 0.020613765344023705, 0.007440994493663311, 0.015574516728520393, -0.005554960109293461, -0.013298015110194683, -0.027259089052677155, -0.015736598521471024, -0.043260909616947174, 0.022455595433712006, -0.006509028375148773, 0.029233530163764954, 0.012568649835884571, -0.006807404570281506, 0.005216063465923071, 0.02818736992776394, -0.0053044711239635944, -0.04803493246436119, -0.01041739247739315, -0.01544190477579832, 0.03471481800079346, 0.017092185094952583, 0.037514399737119675, 0.0011299628531560302, 0.042642053216695786, -0.002372277434915304, -0.011272001080214977, -0.03872264176607132, 0.013143301010131836, 0.009798537008464336, -0.003361340379342437, -0.02945454977452755, -0.027494842186570168, 0.012207651510834694, -0.04240630194544792, -0.019346585497260094, 0.01738687790930271, -0.012421303428709507, 0.007713585160672665, -0.05360462889075279, -0.053309936076402664, 0.0022709767799824476, 0.008023012429475784, 0.043172501027584076, -0.031149033457040787, 0.0002188324579037726, 0.016547003760933876, -0.024091139435768127, -0.00386047619394958, -0.006383783649653196, -0.011124654673039913, 0.014955662190914154, 0.034272778779268265, -0.01710692048072815, 0.044528089463710785, -0.030500710010528564, -0.04623730853199959, -0.0066490075550973415, 0.0493905209004879, -0.00022286146122496575, -0.006730047985911369, -0.025122564285993576, -0.01947919651865959, -0.009363865479826927, 0.034154899418354034, 0.04664987698197365, -0.007124199531972408, -0.019656013697385788, -0.011426715180277824, 0.0025932970456779003, 0.01486725453287363, -0.0033355546183884144, -0.0013095412869006395, 0.04497012868523598, 0.009872210212051868, 0.016547003760933876, -0.012163447216153145, -0.05546119436621666, 0.017504755407571793, -0.031207973137497902, -0.013813727535307407, -0.011949795298278332, 0.0009315056959167123, -0.0341254323720932, 0.031207973137497902, -0.017917325720191002, 0.001428339397534728, 0.028983041644096375, -0.0054149809293448925, -0.00842821504920721, -0.009054437279701233, -2.5684899810585193e-05, 0.01353376917541027, -0.0237522441893816, -0.019788624718785286, -0.010336351580917835, 0.026772845536470413, 0.018477240577340126, -0.01242867112159729, -0.03733758255839348, 0.02219037152826786, 0.025608807802200317, 0.005230797920376062, 0.06047097221016884, 0.025505665689706802, -0.006288008764386177, 0.0035584161523729563, -0.007639911957085133, 0.015589251182973385, -0.009489109739661217, 0.014756744727492332, 0.037101827561855316, -0.00865660235285759, 0.036365095525979996, -0.013158035464584827, 0.00028686507721431553, -0.0137179521843791, 0.01637018844485283, 0.02230824902653694, -0.014852519147098064, -0.002339124446734786, -0.004689299967139959, -0.024017466232180595, -0.014823050238192081, 0.014911457896232605, 0.017033247277140617, -0.012237120419740677, 0.013342218473553658, -0.011087818071246147, 0.0029690305236727, 0.017828917130827904, 0.038781579583883286, -0.013423259370028973, 0.018919281661510468, 7.91411439422518e-05, 0.003678135108202696, 0.017092185094952583, -0.01201610080897808, -0.031119564548134804, 0.039930880069732666, -0.02818736992776394, -0.0022212474141269922, -0.0128633426502347, -0.014292603358626366, -0.02547619678080082, 0.0054886541329324245, -0.027760066092014313, -0.03318241611123085, 0.011242532171308994, -0.009658558294177055, -0.015883944928646088, -0.0046193101443350315, 0.056669432669878006, -0.007912502624094486, -0.09665925055742264, -0.006663742009550333, 0.03875210881233215, -2.4073297026916407e-05, 0.0021383650600910187, -0.012030835263431072, 0.023118654265999794, 0.014469418674707413, 0.001503854407928884, -0.05537278577685356, 0.018506711348891258, -0.007470463868230581, 0.014572561718523502, 0.011861386708915234, 0.018934015184640884, -0.03716076910495758, 0.0146830715239048, -0.01579553633928299, 0.03462640941143036, 0.0014780687633901834, -0.03433171659708023, -0.01438101101666689, -0.005930693354457617, 0.024017466232180595, -0.021527312695980072, -0.011551959440112114, 0.011942427605390549, 0.01421156246215105, 0.006998955272138119, -0.004781391471624374, -0.0023078133817762136, -0.026758110150694847, 0.0019578656647354364, 0.02793688140809536, -0.05272055044770241, -0.005529174581170082, 0.0007068023551255465, -0.026153990998864174, -0.015132477506995201, 0.011846652254462242, -0.002447792561724782, -0.03580518066883087, 0.04491119086742401, -0.03763227537274361, 0.026758110150694847, -0.037838563323020935, 0.002007595030590892, -0.006656374782323837, -0.015007233247160912, -0.015854476019740105, 0.019714951515197754, 0.0066600581631064415, -0.009128110483288765, -0.034154899418354034, 0.014734642580151558, 0.040048759430646896, -0.0074925655499100685, 0.02736223116517067, -0.012273957021534443, 0.033742330968379974, -0.015559782274067402, 0.020525356754660606, 0.010240576229989529, -0.017858386039733887, -0.020584294572472572, -0.031443726271390915, -0.01255391538143158, 0.029601896181702614, -0.032593030482530594, -0.0416695699095726, -0.012531813234090805, -0.014852519147098064, -0.017504755407571793, 0.056256864219903946, 0.023442815989255905, -0.005050298757851124, 0.0162081066519022, 0.06020575016736984, 0.005153441336005926, 0.023560693487524986, 0.024105874821543694, -0.05042194575071335, -0.01365901343524456, -0.0008854598854668438, -0.0032545141875743866, 0.024253221228718758, 0.055844295769929886, 0.0010682615684345365, -0.03842794895172119, 0.02079058066010475, 0.012804403901100159, -0.018639322370290756, 0.03209204971790314, -0.022470328956842422, 0.013121198862791061, -0.01715112291276455, -0.021807270124554634, -0.00019097478070762008, 0.035539958626031876, -0.03150266408920288, 0.031237442046403885, 0.01066788099706173, -0.044115517288446426, -0.005013462156057358, 0.01341589167714119, -0.006328528746962547, 0.00902496837079525, -0.016237575560808182, 0.04709191620349884, 0.007757788989692926, 0.015603986568748951, 0.053634099662303925, -0.014977764338254929, 0.023693304508924484, -0.020540092140436172, 0.017210062593221664, 0.04532375931739807, 0.020245399326086044, 0.013445361517369747, 0.024827871471643448, 0.008759744465351105, 0.0099458834156394, -0.024503709748387337, 0.014049481600522995, -0.022411391139030457, -0.022544002160429955, -0.0032950344029814005, 0.012178181670606136, -0.016915369778871536, -0.004195689223706722, 0.0274359043687582, -0.023531224578619003, 0.014985131099820137, 0.009408068843185902, -0.04261258617043495, 0.029262999072670937, 0.028202105313539505, 0.011574061587452888, -0.029542958363890648, 0.010247943922877312, 0.024091139435768127, 0.004799809772521257, 0.010557371191680431, -0.01390950195491314, -0.01772577501833439, 0.01177297905087471, 0.01919923909008503, -0.022219840437173843, -0.020127521827816963, -0.0005654419073835015, 0.04435127228498459, -9.92286077234894e-05, 0.012826506048440933, 0.03621774911880493, 0.013666381128132343, 0.012583384290337563, 0.02784847468137741, -0.023487020283937454, 0.0018455139361321926, 0.014012644998729229, 0.008384011685848236, 0.04049079865217209, -0.027553781867027283, 0.0046266778372228146, 0.009290192276239395, -0.017976263538002968, 0.008023012429475784, -0.000815930834505707, -0.006291692145168781, 0.008730275556445122, -0.021969351917505264, -0.07072628289461136, 0.010800492949783802, -0.006066989153623581, 0.008096685633063316, 0.022868165746331215, -0.003363182069733739, 0.008988131769001484, 0.018639322370290756, 0.06188549846410751, -0.0030574381817132235, 0.0380743145942688, -0.01080785971134901, -0.008384011685848236, 0.033005598932504654, 0.007219974882900715, 0.0057980818673968315, -0.0010783916804939508, -0.007488882169127464, 0.023000776767730713, 0.01738687790930271, 0.012458140030503273, 0.016060760244727135, 0.013629544526338577, 0.014351541176438332, -0.02862940914928913, 0.005197645165026188, 0.0457068607211113, -0.021144211292266846, -0.0510997399687767, -0.06718996912240982, 0.061060357838869095, 0.002808791119605303, -0.0070247408002614975, -0.046001553535461426, 0.02871781773865223, 0.020156990736722946, -0.01735740900039673, 0.011493020690977573, 0.03565783426165581, 0.005680204834789038, -0.011640367098152637, -0.027141211554408073, 0.014130521565675735, 0.004018873907625675, -0.04031398147344589, 0.0013970283325761557, -0.017666835337877274, -0.029896588996052742, 0.0011281210463494062, -0.0323278047144413, -0.0415811613202095, -0.004129383713006973, -0.0007390343816950917, -0.012657057493925095, 0.008251399733126163, 0.0013841354520991445, 0.011574061587452888, -0.0025564604438841343, -0.014049481600522995, 0.010211107321083546, -0.007669381331652403, 0.00896602962166071, -0.01846250705420971, -0.02014225535094738, -0.025859298184514046, 0.014005277305841446, 0.014086318202316761, 0.008951295167207718, 0.028688348829746246, 0.03167948126792908, 0.011537224985659122, -0.0162081066519022, -0.009584885090589523, 0.008457684889435768, 0.0008767112158238888, 0.011132022365927696, 0.04057920351624489, -0.037720683962106705, -0.012340262532234192, -0.009776434861123562, 0.005775979720056057, 0.023781713098287582, -0.009290192276239395, 0.013894767500460148, -0.03450853377580643, 0.016885900869965553, 0.03833954036235809, 0.035215795040130615, -0.0032692488748580217, -0.02789267711341381, 0.01768157072365284, 0.009010233916342258, -0.021748332306742668, -0.017696306109428406, -0.03047124110162258, -0.007787258364260197, 0.029380876570940018, 0.012539180926978588, -0.017666835337877274, 0.001524114515632391, 0.010594207793474197, -0.000985379214398563, 0.01715112291276455, -0.021925147622823715, 0.013570605777204037, 0.020156990736722946, 0.0028806226328015327, 0.012701261788606644, 0.015780802816152573, -0.014874621294438839, 0.00805984903126955, -0.04520588368177414, -0.03436118736863136, 0.004063077736645937, -0.009047070518136024, 0.024459505453705788, -0.014543091878294945, 0.017946794629096985, 0.014513622969388962, 0.03318241611123085, 0.0510997399687767, 0.011102553457021713, 0.005875438451766968, 0.0018897178815677762, -0.01183191780000925, 0.012237120419740677, 0.0025306749157607555, 0.006114876363426447, -0.008487153798341751, 0.03188576549291611, 0.004751922097057104, 0.011736142449080944, -0.010829961858689785, -0.012723363935947418, 0.007054210174828768, -0.0037462827749550343, -0.03253408893942833, -0.012296059168875217, -0.028275778517127037, -0.021600985899567604, -0.016547003760933876, 0.016959574073553085, 0.005849652923643589, 0.020775845274329185, -0.022057758644223213, -0.016841696575284004, -0.01919923909008503, 0.00013226643204689026, -0.02260294184088707, 0.008450317196547985, 0.0010139276273548603, -0.012494976632297039, 0.011198327876627445, -0.04915476590394974, -0.011294103227555752, 0.010277412831783295, 0.013430626131594181, 0.0037020789459347725, 0.019552869722247124, -0.0007717268890701234, 0.021836739033460617, -0.001224817126058042, -0.004446178209036589, -0.00530078774318099, 0.003116376930847764, -0.036571383476257324, -0.01544190477579832, -0.007610442582517862, -0.020201195031404495, 0.017902590334415436, -0.0065384977497160435, 0.021969351917505264, 0.004936105106025934, 0.005676520988345146, -0.010063760913908482, -0.022499799728393555, -0.007385739590972662, -0.0013353269314393401, -0.008862887509167194, 0.05725881829857826, -0.020378010347485542, -0.008737643249332905, -0.020039113238453865, -0.03881104663014412, 0.02457738295197487, -0.018138345330953598, 0.006240121088922024, -0.022426126524806023, 0.010748921893537045, 0.005919642746448517, 0.029233530163764954, -0.007120515685528517, 0.004556688014417887, -0.000536893552634865, -0.021394699811935425, -0.007743054535239935, 0.032180458307266235, 0.014454684220254421, 0.016620676964521408, 0.00920915137976408, 0.020068582147359848, 0.0006257618661038578, -0.022101962938904762, 0.025653012096881866, 0.004343035630881786, 0.00023045901616569608, 0.022617675364017487, 0.01150775607675314, 0.013401157222688198, 0.006394834723323584, -0.02154204621911049, -0.04455756023526192, 0.029749242588877678, -0.02117368020117283, 0.003042703727260232, 0.012421303428709507, 0.004125699866563082, -0.01698904298245907, 0.004917686805129051, 0.007986175827682018, 0.011338307522237301, -0.01035845372825861, 0.011426715180277824, 0.005967529956251383, 0.009982720017433167, 0.00816299207508564, -0.0006533893174491823, 0.02913038805127144, 0.030161812901496887, -0.02080531418323517, -0.03524526581168175, 0.018020467832684517, 0.026713905856013298, 0.017740508541464806, 0.002840102417394519, -0.020451683551073074, 0.038663700222969055, 0.004991360008716583, 0.037926968187093735, -0.00612224405631423, 0.016723819077014923, -0.044203925877809525, -0.005182910244911909, 0.007647279184311628, -0.03692501410841942, -0.010608942247927189, 0.03836900740861893, -0.03235727548599243, 0.04782864823937416, -0.025299381464719772, 0.002322548069059849, -0.0033944931346923113, 0.010962573811411858, 0.008207195438444614, 0.024872075766324997, -0.015103008598089218, 0.014204194769263268, -0.018285691738128662, 0.011109920218586922, -0.007507300470024347, 0.011109920218586922, -0.024105874821543694, 0.00029377194005064666, -0.0030758564826101065, 0.025284646078944206, 0.0274359043687582, -0.01171404030174017, -0.019508667290210724, 0.04199372977018356, -0.017401613295078278, 0.030618587508797646, 0.05157124996185303, 0.03338870033621788, -0.021321026608347893, -0.004976625554263592, 0.0069694858975708485, 0.00945227313786745, 0.014852519147098064, 0.033653922379016876, -0.005617582239210606, -0.0004995964700356126, 0.007824094966053963, -0.0137179521843791, -0.03795643895864487, 0.011883488856256008, -0.027288557961583138, 0.0004438810865394771, 0.003934149630367756, 0.004777707625180483, 0.008921826258301735, -0.03203311190009117, 0.019508667290210724, 0.008884989656507969, 0.00494347233325243, 0.014454684220254421, -0.012730730697512627, 0.011927693150937557, 0.01544190477579832, -0.03047124110162258, 0.005319206044077873, -0.027097007259726524, 0.028658879920840263, 0.011028879322111607, -0.003749966388568282, 0.013180137611925602, -0.007779891137033701, -0.01347483042627573, 0.022131433710455894, -0.007256811484694481, -0.02235245332121849, 0.001130883814767003, -0.005352358799427748, -0.009378599934279919, 0.004645096138119698, -0.007072628475725651, -0.00019822698959615082, -0.04706244915723801, 0.0019504983210936189, -0.014056848362088203, 0.024724729359149933, 0.015942882746458054, 0.013511667028069496, 0.00999008771032095, -0.03203311190009117, -0.03256355971097946, 0.018433038145303726, -0.010859431698918343, 0.0022341401781886816, -0.0008251399849541485, -0.019670747220516205, 0.054370831698179245, -0.015250355005264282, 0.029218796640634537, -0.005941744428128004, 0.0008398746140301228, 0.004530902486294508, -0.019656013697385788, 0.001187059679068625, -0.011183593422174454, 0.04523535072803497, -0.0065569160506129265, -0.0038310070522129536, 0.02071690745651722, 0.04228842258453369, 0.0014568878104910254, -0.015044069848954678, 0.010631044395267963, -0.019228707998991013, 0.009901680052280426, 0.008266134187579155, 0.0025546185206621885, 0.019700216129422188, 0.004645096138119698, 0.009223885834217072, -0.0294987540692091, -0.014314704574644566, -0.004471963737159967, -0.005429715849459171, 0.013261178508400917, -0.012752832844853401, 0.0023649102076888084, 0.02915985696017742, -0.012539180926978588, -0.002261767629534006, 0.006335895974189043, 0.005282369442284107, 0.012377099134027958, 0.012354997918009758, -0.018845608457922935, 0.0017598688136786222, -0.02407640591263771, 0.03306453675031662, 0.018698260188102722, 0.00524184899404645, 0.027494842186570168, -0.006884761620312929, 0.01449888851493597, 0.026566559448838234, 0.038251131772994995, 0.01103624701499939, -0.004457229282706976, 0.0066232215613126755, 0.031650010496377945, -0.03117850236594677, -0.009658558294177055, 0.010292147286236286, 0.021954616531729698, -0.0008039589156396687, 0.013246443122625351, 0.005676520988345146, -0.015648189932107925, 0.012715996243059635, 0.03191523626446724, 0.01390950195491314, 0.019007688388228416, 0.004803493618965149, 0.005647051613777876, -0.01347483042627573, -0.03418437018990517, -0.009467007592320442, 0.0003527105145622045, -0.006884761620312929, 0.0024183231871575117, -0.012465507723391056, 0.030206017196178436, 0.02580035850405693, 0.00349211017601192, 0.005013462156057358, 0.0095185786485672, -0.006637956481426954, -0.03539261221885681, 0.004217791371047497, 0.02711174264550209, -0.005407613702118397, 0.005683888215571642, -0.04691510275006294, 0.00630642706528306, -0.010579473339021206, 0.011132022365927696, -0.026551825925707817, 0.05663996562361717, 0.03109009563922882, -0.000732587999664247, -0.013511667028069496, 0.06783829629421234, 0.009496477432549, 0.023619631305336952, -0.02805475890636444, 0.02510783076286316, 0.003604461904615164, 0.01078575849533081, -0.01887507736682892, -0.022661879658699036, 0.020702172070741653, -0.05460658296942711, 0.0034663246478885412, -0.008332440629601479, -0.023324938490986824, 0.021438904106616974, -0.018359364941716194, -0.005367093253880739, 0.008310338482260704, -0.0010351085802540183, -0.0027701128274202347, 0.02605084702372551, -0.027656923979520798, 0.02292710356414318, -0.004343035630881786, -0.004184638615697622, 0.004486698657274246, 0.01915503479540348, 0.009643823839724064, -0.013172769919037819, 0.013437993824481964, 0.01747528649866581, 0.0008223772165365517, -0.0015499001601710916, 0.007514667697250843, -0.022750288248062134, 0.0255940742790699, 0.010947839356958866, -0.014344174414873123, -0.026713905856013298, -0.00029607422766275704, -0.009606987237930298, -0.0023814865853637457, -0.008516623638570309, 0.0002983765152748674, 0.0070247408002614975, -0.04261258617043495, 0.017298469319939613, 0.01637018844485283, -0.01887507736682892, -0.012502344325184822, 0.026522357016801834, 0.0137179521843791, -0.0008062612032517791, -0.007794625591486692, 0.040756020694971085, -0.03209204971790314, -0.012472874484956264, 0.016517534852027893, 0.03515685722231865, 0.04281887039542198, 0.022411391139030457, -0.005179226864129305, 0.05451817810535431, -0.01866879127919674, 0.05142390355467796, -0.006877394393086433, -0.0050576659850776196, 0.0009899837896227837, 0.023899590596556664, 0.01505143754184246, 0.017077449709177017, 0.0010424759238958359, 0.0007031187415122986, -0.019994908943772316, 0.03642403706908226, 0.0012699420331045985, -0.028364187106490135, -0.011227797716856003, 0.012178181670606136, 0.0321509912610054, -0.018595118075609207, -0.028614675626158714, 0.0019928603433072567, 0.023324938490986824, -0.02170412801206112, 0.007639911957085133, -0.010446861386299133, 0.03651244193315506, 0.020201195031404495, -0.012075039558112621, 0.005168175790458918, -0.0022672931663691998, 0.009223885834217072, 0.038044847548007965, 0.004549320787191391, -0.029808182269334793, 0.013356952928006649, -0.014454684220254421, -0.004925054032355547, -0.011596163734793663, -0.0029782396741211414, -0.002165992511436343, 0.007385739590972662, -0.00840611383318901, 0.02202828973531723, 0.03179735690355301, 0.03442012518644333, -0.008302970789372921, -0.010940471664071083, 0.0007772523676976562, -0.0010986517881974578, 0.01171404030174017, -0.02193988300859928, -0.028364187106490135, 0.0023833285085856915, -0.05242585763335228, -0.0035344723146408796, 0.008943927474319935, 0.0031237441580742598, 0.03194470331072807, 0.005672837141901255, -0.014859886839985847, -0.022706083953380585, -0.0025509349070489407, -0.0016217315569519997, 0.038663700222969055, 0.061590805649757385, 0.006534813903272152, -0.0009319661185145378, -0.02518150396645069, -0.0070247408002614975, -0.017327940091490746, -0.03742599114775658, 0.013710584491491318, -0.025446727871894836, -0.011397246271371841, -0.04838856682181358, 0.027995821088552475, -0.03409596160054207, -0.019744420424103737, -0.023649100214242935, -0.018698260188102722, 0.02276502177119255, 0.018727730959653854]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" between this objective function from traditional contextual bandit (Langford and Zhang, 2007)
is that the optimal policy is stochastic, which is closer to the practical generative models. See an intuitive
illustration why such a target is appealing in Figure 1. Despite numerous proposed procedures for this
formulation, a rigorous theoretical analysis remains open. This paper provides a theoretical analysis of the
regularized contextual bandit problem in both offline and online settings, aiming to inform and motivate
practical algorithmic designs. We summarize the contributions and take-away messages of this work as
follows:
•We identify the challenges of existing RLHF methods in Section 2: they require a preference dataset
with uniform coverage over the entire prompt-response space to converge to the optimal policy, which
is extremely hard to satisfy in practice due to the exponentially large response space;
•To understand the mathematical principle of RLHF, we first formally formulate the RLHF process
as a reverse-KL regularized contextual bandit problem in RLHF theory in Section 2, which more
accurately reflects real-world alignment practices (Ouyang et al., 2022; Bai et al., 2022; Rafailov et al.,
2023) compared to existing theoretical frameworks. Meanwhile, we deliver a comprehensive theoretical
analysis in offline, online, and hybrid settings for the formulated framework, where the three settings
are complementary to each other and hold their own values in practical applications.
–For offline learning from a fixed dataset, we show that RLHF with pessimism (a conservative
reward estimation) is sample efficient in Section 3. Moreover, we derive the way of implementing
the pessimism with both the PPO and DPO;
–For the online/hybrid learning, we discuss how to strategically explore and continuously enhance
the policy by online interactions with the humans in Section 4. Specifically, by establishing the
theoretical guarantee of the proposed algorithms, we show that the RLHF can benefit from online
exploration.
•Moving towards practical applications, in Section 5, we demonstrate that the proposed frameworks can
be practically implemented when combined with existing planning algorithms like offline PPO, offline
DPO, and InfoNCA, that optimize against a fixed reward function. In other words, our framework can
be viewed as built on the top of existing methods, and serve as to boost their performance;
•In Section 6, we demonstrate that the proposed algorithms empirically outperform existing strong
baselines like DPO (Rafailov et al., 2023) and RSO (Liu et al., 2023a) in real-world LLM experiments.
In particular, with the Zephyr-SFT-7B as the initial model, the resulting aligned policy enjoys an
impressive win-rate 34 .79% in the AlpacaEval2 benchmark that beats many larger LLMs.
4
1.1 Related Work
There is a rich literature in RLHF and we refer the interested readers to the survey papers like Casper et al.
(2023) for a more comprehensive review. We focus on the papers that are most related to our work here.
RLHF has attracted considerable attention in the past few years, especially after its tremendous success
in ChatGPT (OpenAI, 2023). We refer interested readers to Wirth et al. (2017); Casper et al. (2023) for a
detailed survey but focus on the most related works here. The standard RLHF was popularized by Christiano
et al. (2017), which served to direct the attention of the RL community to the preference-based feedback. The
most popular and standard RLHF framework is outlined in the InstructGPT paper (Ouyang et al., 2022),
Claude (Bai et al., 2022) and the LLaMA2 report (Touvron et al., 2023) in detail, which typically consists
of three steps starting from the pretrained model: supervised finetuning, reward modeling, and reward
optimization. The effectiveness of this framework has been showcased by many recent generative models,
like ChatGPT (OpenAI, 2023), Bard (Google, 2023), Claude (Anthropic, 2023), and LLaMA2 (Touvron
et al., 2023). However, it is also noteworthy to indicate that the RLHF process often leads to degeneration
in the performance of generation, commonly referred to as the “alignment tax” in the literature (Askell
et al., 2021). This is usually because of the imperfection of the reward model and the model can make use
of these imperfections to chase for a high reward. This phenomenon is referred to as the reward hacking
(Michaud et al., 202","[-0.0380522795021534, 0.013532779179513454, 0.053751762956380844, -0.022017212584614754, 0.01838415302336216, 0.0023709721863269806, -0.05036674439907074, 0.04625219479203224, -0.005865420214831829, 0.040678586810827255, 0.02964809350669384, -0.02918119542300701, -0.022148527204990387, 0.001978849759325385, 0.034025274217128754, -0.02925414778292179, 0.019332541152834892, -0.06192249432206154, -0.0002042683627223596, 0.01487511396408081, 0.007109268568456173, -0.015699483454227448, -0.011606819927692413, 0.03212849423289299, -0.022338204085826874, -0.04003660008311272, 0.006613188423216343, 0.040007419884204865, 0.0012648224364966154, -0.028816429898142815, 0.028451664373278618, -0.01997452788054943, -0.048645053058862686, -0.02146276831626892, -0.021375225856900215, 0.014335261657834053, 0.011125330813229084, 0.017304448410868645, 0.010125874541699886, 0.038023095577955246, -2.563328598625958e-05, -0.03545515239238739, -0.020076662302017212, 0.015495214611291885, -0.026905061677098274, 0.024701882153749466, 0.014969953335821629, 0.023563815280795097, 0.001154481084086001, 0.025343867018818855, -0.07341988384723663, 0.05561935901641846, -0.04686499759554863, -0.05290550738573074, -0.0025332923978567123, 0.015188812278211117, 0.012577095068991184, -0.022221479564905167, 0.03659321740269661, 0.0030001916456967592, 0.009644385427236557, -0.00532921589910984, 0.019361723214387894, 0.002529644872993231, -0.03361673653125763, -0.01287620235234499, -0.09472215920686722, -0.009469297714531422, -0.0014754742151126266, 0.05433538556098938, 0.014590597711503506, -0.022060982882976532, 0.023228231817483902, -0.029939906671643257, -0.040824491530656815, 0.013394168578088284, 0.04324652999639511, 0.06851744651794434, -0.005044699180871248, -0.01477297954261303, -0.0023053144104778767, -0.04356752336025238, 0.0012867082841694355, -0.03580532595515251, 0.008586566895246506, -0.03796473518013954, -0.036826666444540024, -0.03344164788722992, -0.03609713912010193, -0.00860845297574997, -0.002896233694627881, -0.005172366742044687, -0.021068822592496872, 0.005168719217181206, 0.0028670523315668106, -0.007805969566106796, -0.01600588485598564, -0.00234179082326591, 0.06437371671199799, 0.019507629796862602, 0.02316986955702305, -0.03379182517528534, 0.030260900035500526, -0.033704280853271484, 0.046135470271110535, 0.003545515239238739, 0.006584007292985916, 0.028524618595838547, -0.011395256966352463, -0.02093750797212124, -0.07826396822929382, -0.02436629869043827, -0.08036500960588455, 0.0330914743244648, -0.01990157552063465, -0.034696441143751144, -0.06700002402067184, 0.0037041879259049892, -0.002236009109765291, 0.018690556287765503, -0.014524939469993114, 0.0032117553055286407, 0.027153102681040764, 0.012256101705133915, 0.0013095061294734478, -0.0046544005163013935, 0.02061651460826397, -0.06746692210435867, -0.0024822254199534655, -0.028349531814455986, 0.02823280543088913, 0.049958206713199615, -0.03099042922258377, -0.04969557374715805, -0.08999480307102203, 0.005938373040407896, 0.00038277520798146725, -0.017129361629486084, -0.039365433156490326, -0.04129138961434364, -0.03723520413041115, -0.040328413248062134, -0.05354749411344528, 0.012234215624630451, -0.05483146384358406, 0.029166605323553085, -0.013897543773055077, -0.00832393579185009, -0.02575240470468998, 0.034229543060064316, -0.01731903851032257, -0.003206283785402775, -0.039686426520347595, 0.02143358811736107, -0.01009669341146946, -0.056728243827819824, -0.012226920574903488, 0.03662240132689476, 0.021448178216814995, -0.04044513776898384, 0.013394168578088284, 0.05912110209465027, -0.02220688946545124, 0.0028214568737894297, 0.04558102786540985, 0.0024804016575217247, -0.01962435431778431, 0.01533471792936325, -0.05917946249246597, 0.003651296952739358, -0.01625392585992813, 0.005424054805189371, -0.06501570343971252, -0.007718426175415516, -0.010074807330965996, -0.0037278977688401937, -0.01374434307217598, 0.02635061927139759, 0.0157286636531353, -0.052438609302043915, -0.014028859324753284, 0.013890248723328114, -0.030056631192564964, 0.00206821714527905, -0.03457971662282944, 0.02441006898880005, -0.012971040792763233, -0.038023095577955246, -0.0061754705384373665, 0.022469520568847656, 0.017129361629486084, 0.05273041874170303, 0.048265695571899414, 0.011592229828238487, 0.009410935454070568, -0.007922694087028503, 0.0629146546125412, 0.04598956182599068, -0.003144273767247796, -0.03904443979263306, 0.012701115570962429, 0.013700570911169052, -0.013087766245007515, -0.07201918959617615, 0.0012000766582787037, -0.009848653338849545, 0.010855404660105705, 0.024380888789892197, -0.02128768153488636, -0.01915745437145233, 0.0016669757897034287, -0.0019697307143360376, 0.06052180007100105, 0.027357369661331177, -0.029764818027615547, -0.023432498797774315, -0.029385464265942574, 0.05448129028081894, 0.01092835795134306, 0.055911168456077576, 0.016837550327181816, 0.006022268906235695, 0.00970274768769741, 0.01014776062220335, -0.046456463634967804, 0.008812720887362957, 0.015772435814142227, -0.02277592197060585, 0.028043128550052643, -0.04987066239118576, 0.055940352380275726, 0.017552489414811134, -0.026467343792319298, -0.03096124716103077, 0.01333580631762743, -0.021667037159204483, 0.018150703981518745, -0.01771298609673977, 0.03373346105217934, -0.04806142672896385, 0.00619006110355258, 0.016560327261686325, 0.021915078163146973, -0.014145583845674992, 0.013540074229240417, 0.019493037834763527, -0.022557063028216362, -0.036534857004880905, 0.03282884508371353, 0.01420394703745842, 0.0339377298951149, -0.032887205481529236, -0.018369562923908234, -0.018792688846588135, -0.022250661626458168, 0.023009372875094414, -0.010213417932391167, -0.007944580167531967, -0.030727798119187355, -0.02833493985235691, -0.03262457624077797, 0.019580582156777382, 0.0037789647467434406, 0.026832109317183495, 0.022907238453626633, -0.03341246768832207, -0.045318394899368286, 0.002469458617269993, 0.003837327240034938, 0.004887850023806095, 0.002775861183181405, 0.014984543435275555, -0.02411825768649578, 0.008105076849460602, -0.0662996768951416, -0.026540296152234077, 0.06875089555978775, 0.0447639524936676, -0.041495658457279205, -0.014196651056408882, -0.019843213260173798, 0.0339377298951149, 0.06700002402067184, 0.015042905695736408, 0.01823824644088745, -0.008630338124930859, -0.009907015599310398, -0.030581891536712646, -0.03793555498123169, 0.0033357753418385983, 0.014634368941187859, -0.007448500022292137, 0.030873704701662064, -0.04969557374715805, 0.03878180682659149, -0.010753270238637924, 0.03986151143908501, -0.014999134466052055, 0.022323613986372948, 0.01927417889237404, 0.003392313839867711, 0.018121521919965744, -0.036009594798088074, 0.023053143173456192, 0.03347083181142807, 0.011030491441488266, 0.0007153952610678971, -0.008542794734239578, 0.014794865623116493, 0.030114993453025818, -0.007047258783131838, 0.04969557374715805, 0.0012930916855111718, 0.021754581481218338, -0.03443381190299988, -0.010862699709832668, 0.045960381627082825, -0.028933154419064522, 0.002544235438108444, -0.018004797399044037, -0.048645053058862686, -0.0356302373111248, 0.01607883907854557, 0.009447411634027958, 0.043304894119501114, -0.020456017926335335, 0.0413789339363575, -0.010001854971051216, -0.03872344642877579, 0.024453841149806976, 0.008805425837635994, -0.00997267384082079, 0.016779188066720963, -0.004307874012738466, 0.013138833455741405, -0.010512525215744972, -0.03758537769317627, 0.030406804755330086, 0.057399410754442215, -0.0331498384475708, -0.0463980995118618, 0.00481854472309351, -0.020922916010022163, 0.013138833455741405, -0.04400524124503136, 0.022090164944529533, -0.0008499022806063294, -0.0011061496334150434, 0.028203625231981277, 0.030377624556422234, -0.01060736458748579, 0.006332319229841232, 0.007346366066485643, -0.016662461683154106, -0.04070776700973511, 0.03755619749426842, 0.0009821295971050858, -0.036534857004880905, -0.005931077990680933, -0.018938595429062843, -0.02051438018679619, 0.0273135993629694, -0.0014855052577331662, -0.007397432811558247, 0.012387417256832123, 0.047944702208042145, -0.0016232039779424667, -0.00860845297574997, -0.0040379478596150875, -0.03907361999154091, 0.012540618889033794, 0.020674876868724823, -0.03796473518013954, 0.010476049035787582, -0.07079357653856277, 0.00111344491597265, 0.03396691009402275, -0.00066615198738873, -0.004650752991437912, 0.024745654314756393, -0.032887205481529236, 0.0173628106713295, -0.02136063389480114, -0.05217597633600235, 0.019989117980003357, 0.048265695571899414, -0.04102876037359238, -0.04604792594909668, -0.08007320016622543, 0.0023983295541256666, 0.008484432473778725, -0.01870514638721943, -0.05153398960828781, 0.020572742447257042, 0.007193164434283972, -0.015422261320054531, -0.022221479564905167, 0.037030935287475586, 0.08199916034936905, 0.029020698741078377, -0.03367510065436363, -0.01639983244240284, -0.04187501594424248, -0.009534955024719238, -0.012766772881150246, 0.023753492161631584, -0.013437940739095211, 0.045464303344488144, 0.004800306633114815, 0.036213863641023636, 0.020762421190738678, -0.029779409989714622, 0.019069910049438477, -0.04908277094364166, 0.019784850999712944, -0.028072308748960495, -0.006722617894411087, -0.01204453781247139, 0.056582335382699966, 0.08468382805585861, 0.02967727556824684, -0.05381012335419655, 0.014400919899344444, -0.005467826500535011, -0.009841358289122581, 0.015859980136156082, 0.02932710014283657, -0.02734277956187725, -0.02535845898091793, -0.03425872325897217, -0.01686673052608967, 0.06151396036148071, 0.013350396417081356, -0.05486064776778221, -0.07266117632389069, 0.02245493046939373, 0.02064569480717182, 0.04158320277929306, -0.003749783616513014, -0.01877809874713421, 0.06046343594789505, 0.013598436489701271, -0.04814897105097771, -0.005664799362421036, -0.006120755802839994, 0.015115858986973763, -0.010366619564592838, -0.0004915207391604781, -0.010038331151008606, -0.025314686819911003, -0.03017335571348667, 0.010767861269414425, 0.10785369575023651, -0.011978880502283573, -0.00915560033172369, -0.01845710538327694, 0.08007320016622543, -0.01835497096180916, 0.023315774276852608, 0.018821870908141136, 0.005726809613406658, -0.01100131031125784, -0.005683037918061018, -0.013678684830665588, 0.027371961623430252, 0.007211402989923954, 0.012423893436789513, 0.021594084799289703, -0.03446299210190773, -0.0042312731966376305, 0.005931077990680933, -0.020076662302017212, 0.006201004143804312, -0.003093206789344549, -0.01895318552851677, 0.009622499346733093, 0.034025274217128754, -0.016020476818084717, 0.03262457624077797, -0.011439028196036816, 0.01940549537539482, -0.026875881478190422, 0.043976061046123505, 0.0004484328965190798, 0.03250785171985626, 0.013554665260016918, -0.002589831128716469, -0.005847182124853134, -0.015393080189824104, 0.009432821534574032, 0.013131537474691868, -0.027547048404812813, 0.019668124616146088, -0.018150703981518745, -0.004844078328460455, -0.048469964414834976, -0.0007308977656066418, 0.008112371899187565, -0.015320127829909325, 0.003512686351314187, 0.04625219479203224, -0.01704181730747223, -0.01032284740358591, 0.04362588748335838, 0.004793011117726564, 0.027678363025188446, 0.007645472884178162, -0.013394168578088284, -0.01731903851032257, 0.0219296682626009, -0.033558376133441925, -0.003656768472865224, -0.022717559710144997, 0.020485198125243187, 0.010476049035787582, 0.0261025782674551, -0.04193337634205818, -0.018646784126758575, -0.008564680814743042, 0.021054232493042946, 0.004355293232947588, -0.009848653338849545, -0.030844522640109062, 0.008404184132814407, -0.002546059200540185, 0.03939461335539818, -0.03921952471137047, -0.06343992054462433, -0.021944258362054825, -0.02235279604792595, 0.035834506154060364, 0.013955906964838505, 0.01400697324424982, 0.027926404029130936, -0.03743947297334671, -0.008499023504555225, -0.0190261397510767, -0.03656403720378876, -0.025591908022761345, -0.03463807702064514, -0.002513230312615633, -0.009994558990001678, 0.0022268898319453, 0.037381112575531006, -0.020777011290192604, -0.042837996035814285, 0.023928580805659294, -0.006237480323761702, 0.024628927931189537, 0.029239557683467865, 0.0447055920958519, -0.05097954720258713, -0.038023095577955246, -0.020105842500925064, -0.0356302373111248, -0.0012192268623039126, 0.0194492656737566, -0.026875881478190422, 0.01478757057338953, 0.008710586465895176, -0.010913766920566559, -0.024234982207417488, -0.029035288840532303, 0.037322748452425, -0.03247867152094841, 0.03212849423289299, -0.005624675191938877, 0.02227984182536602, 0.018092341721057892, 0.01337228249758482, -0.011723545379936695, 0.011293122544884682, 0.05585280805826187, -0.052613694220781326, 0.03166159614920616, -0.014466577209532261, 0.002617188496515155, -0.0007664622971788049, 0.04508494585752487, 0.053605854511260986, -0.023607587441802025, -0.03525088354945183, -0.024979103356599808, -0.02230902388691902, -0.023403318598866463, 0.0063031380996108055, 0.006372443400323391, 0.03350001201033592, -0.04426787421107292, -0.0035327484365552664, 0.03492989018559456, -0.020631104707717896, -0.023782674223184586, -0.008849197067320347, -0.052613694220781326, 0.0029217670671641827, -0.010760565288364887, 0.0024548680521547794, 0.00034675467759370804, -0.02277592197060585, 0.024249572306871414, 0.005617380142211914, -0.00032897238270379603, -0.012898088432848454, -0.0330914743244648, 0.03627222403883934, 0.0023673244286328554, 0.004296930972486734, 0.019244998693466187, -0.009498478844761848, 0.0012575271539390087, -0.013022108003497124, 0.013379577547311783, -0.021798351779580116, -0.04768207296729088, -0.03131142258644104, 0.015320127829909325, -0.0029928963631391525, 0.0472443550825119, -0.0015183340292423964, -0.022119345143437386, -0.016779188066720963, 0.01888023316860199, -0.01823824644088745, 0.011584934778511524, -0.001498271944001317, -0.015115858986973763, -0.02490614913403988, -0.007255174685269594, -0.0016086134128272533, -0.014014269225299358, -0.0065438831225037575, 0.0007874363218434155, 0.0032409364357590675, -0.007689245045185089, -0.0021356986835598946, 0.016531147062778473, -0.013664094731211662, 0.02128768153488636, -0.04458886757493019, 0.030581891536712646, 0.020091252401471138, 0.0025077590253204107, -0.040999580174684525, 0.008586566895246506, 0.008944036439061165, 0.013022108003497124, -0.011315008625388145, -0.012526027858257294, -0.033558376133441925, -0.020747829228639603, -0.0356302373111248, 0.020426835864782333, -0.00960061326622963, 0.028568390756845474, 0.007320832461118698, 0.010220713913440704, 0.01721690595149994, 0.025518955662846565, -0.00400147121399641, -0.02575240470468998, -0.002682846039533615, -0.02220688946545124, 0.013007517904043198, -0.00864492915570736, 0.0381106398999691, 0.00874706357717514, 0.05430620536208153, -0.008396889083087444, -0.035542696714401245, -0.04359670355916023, -0.0049680983647704124, 0.02227984182536602, -0.012905383482575417, -0.019857803359627724, -0.021798351779580116, -9.99683907139115e-05, -0.03166159614920616, -0.009170190431177616, 0.014400919899344444, -0.01420394703745842, 0.0033011226914823055, -0.04409278556704521, -0.011417142115533352, -0.006014973856508732, 0.011446324177086353, 0.02295101061463356, -0.025139600038528442, -0.003623939584940672, 0.003859213087707758, -0.010191532783210278, 0.0037260737735778093, 0.0006096134311519563, -0.014306080527603626, 0.015932932496070862, 0.013664094731211662, 0.003155216807499528, 0.038198184221982956, -0.024731062352657318, -0.0711437538266182, -0.0066642556339502335, 0.032537031918764114, 0.007937285117805004, -0.013853772543370724, -0.006500111427158117, -0.030844522640109062, 0.004650752991437912, 0.03755619749426842, 0.04345079883933067, 0.0029363578651100397, -0.02101046033203602, -0.024307934567332268, -0.015363899059593678, 0.020601924508810043, 0.010665726847946644, 0.03813982009887695, 0.05427702143788338, -0.008885674178600311, 0.006058745551854372, -0.017975615337491035, -0.035221703350543976, -0.0025478831958025694, -0.024468431249260902, 0.006988896057009697, -0.004293283447623253, -0.0053365109488368034, -0.053576674312353134, 0.02312609739601612, -0.012350941076874733, -0.0023563813883811235, 0.027707545086741447, 0.004643457476049662, 0.005938373040407896, -0.007441204506903887, 0.014298785477876663, 0.027153102681040764, -0.02511041797697544, -0.02769295498728752, 0.015188812278211117, 0.028378712013363838, 0.020280931144952774, -0.000927870802115649, -0.04003660008311272, 0.007981057278811932, -0.00022022683697286993, -0.027795087546110153, 0.049462124705314636, 0.02004748024046421, 0.011577638797461987, 0.002073688665404916, -0.00691594323143363, 0.01473650336265564, -0.010125874541699886, -0.0023454385809600353, 0.03218685835599899, -0.0063213761895895, 0.010797042399644852, -0.004942564759403467, -0.021477360278367996, -0.016939682886004448, 0.014218537136912346, 0.00951306987553835, -0.00523437699303031, -0.013233671896159649, 0.007740311790257692, -0.009265029802918434, -0.028247397392988205, -0.005839886609464884, 0.017931845039129257, -0.003742488333955407, 0.004198444541543722, -0.01241659838706255, -0.0015274531906470656, 0.01972648873925209, 0.057078417390584946, -0.006784627679735422, 0.04178747162222862, 0.011439028196036816, 0.004070776514708996, -2.265532202727627e-06, -0.006084279157221317, -0.020251749083399773, 0.007047258783131838, -0.007689245045185089, -0.006970657967031002, -0.01650196500122547, 7.221206033136696e-05, -0.019244998693466187, 0.009892425499856472, -0.023709721863269806, -0.01831120066344738, 0.009286914952099323, -0.007200459949672222, -0.014532235451042652, 0.012868907302618027, 0.0728362649679184, -0.025066645815968513, -0.09022825211286545, 0.002215947024524212, 0.02868511527776718, 0.011358779855072498, 0.00041902370867319405, -0.013401463627815247, 0.01997452788054943, 0.037001755088567734, -0.004606981296092272, -0.04733189940452576, 0.03665158152580261, -0.002737560775130987, 0.010220713913440704, 0.006536587607115507, 0.004260454326868057, -0.039015259593725204, -0.0026299552991986275, -0.025022875517606735, 0.04441377893090248, -0.0034652668982744217, -0.016429012641310692, -0.007284355815500021, 0.026584068313241005, 0.008922150358557701, -0.02376808412373066, -0.016706233844161034, 0.016020476818084717, -0.004785716067999601, -0.0008143377490341663, -0.0005694892606697977, -0.0111909881234169, -0.027970176190137863, -0.010600069537758827, -0.00823639240115881, -0.06489897519350052, -0.005387578159570694, -0.000578608363866806, 0.017917253077030182, -0.008849197067320347, 0.031048791483044624, 0.014050745405256748, -0.022936418652534485, 0.04111630469560623, -0.012868907302618027, 0.04245863854885101, -0.0037789647467434406, 0.01667705364525318, -0.0105562973767519, -0.0029819533228874207, 0.020762421190738678, 0.036855850368738174, 0.003100502071902156, -0.00029568758327513933, -0.022644607350230217, -0.014707322232425213, 0.012496846728026867, -0.007623587269335985, 0.007262469734996557, -0.01342334970831871, 0.03490070998668671, -0.03294556960463524, 0.037848010659217834, 0.02369512990117073, -0.013109652325510979, -0.027605410665273666, -0.016312288120388985, -0.022163117304444313, 0.009819472208619118, -0.03198258951306343, -0.056232161819934845, -0.023826446384191513, -0.018223656341433525, 0.01796102523803711, 0.025197962298989296, 0.010476049035787582, 0.006780980154871941, 0.03163241595029831, 0.03492989018559456, -0.0051431856118142605, 0.015451442450284958, 0.06174740940332413, -0.06740856170654297, -0.0004443292855285108, 0.009644385427236557, 0.007131154648959637, 0.03227440267801285, 0.04823651537299156, -0.014182060956954956, -0.03347083181142807, 0.027955584228038788, 0.01672082394361496, -0.010921061970293522, 0.031749140471220016, -0.028130672872066498, 0.013992383144795895, -0.02553354576230049, -0.018719736486673355, 0.01009669341146946, 0.035834506154060364, -0.04327571392059326, 0.02468729019165039, 0.006211946718394756, -0.05737023055553436, -0.014087221585214138, 0.02213393710553646, -0.0005963906878605485, -0.008367707952857018, 0.020981280133128166, 0.038519177585840225, -0.021127184852957726, 0.006905000191181898, 0.04041595384478569, -0.0030804399866610765, 0.010745975188910961, -0.0032445841934531927, 0.04207928478717804, 0.037030935287475586, 0.027050968259572983, -0.0052635581232607365, 0.02818903513252735, 0.010293666273355484, 0.009272324852645397, -0.013554665260016918, 0.02012043446302414, -0.017844300717115402, -0.020835373550653458, 0.0033084179740399122, 0.03989069536328316, 0.006821104325354099, -0.003654944710433483, 0.010228008963167667, -0.02929791994392872, 0.01955140009522438, 0.011905927211046219, -0.018894823268055916, 0.02515419013798237, 0.025373049080371857, 0.023636767640709877, -0.05652397498488426, 0.021170957013964653, 0.0306694358587265, -0.007929990068078041, 0.00032441283110529184, -0.0011636001290753484, -0.02071864902973175, 0.010826223529875278, 0.018748918548226357, -0.03431708365678787, -0.03116551600396633, 0.009761109948158264, 0.027882631868124008, -0.025343867018818855, 3.416821709834039e-05, 0.013219081796705723, 0.007616291753947735, 0.004234920721501112, 0.03347083181142807, -0.02014961466193199, -0.015086677856743336, -0.009520364925265312, -0.005030108615756035, 0.04832405969500542, -0.007908103987574577, -0.00509211840108037, 0.03411281853914261, -0.025737814605236053, 0.0035710488446056843, 0.018121521919965744, -0.00229801912792027, -0.00028474463033489883, -0.031019609421491623, -0.06530751287937164, 0.041524842381477356, 0.009462002664804459, 0.011409847065806389, 0.025139600038528442, 0.006252070888876915, 0.010388505645096302, 0.017902662977576256, 0.0777970626950264, -0.00672991294413805, 0.040328413248062134, -0.008484432473778725, -0.008922150358557701, 0.02079160138964653, -0.006613188423216343, -0.0034214952029287815, 0.009753814898431301, 0.017596259713172913, 0.016516556963324547, 0.001980673521757126, 0.03166159614920616, 0.002000735606998205, 0.029910724610090256, -0.012817840091884136, -0.028947746381163597, 0.02079160138964653, 0.03361673653125763, -0.04047431796789169, -0.05599871277809143, -0.0761629194021225, 0.06991814076900482, 0.00860845297574997, 0.0009848653571680188, -0.02907906100153923, 0.0273135993629694, 0.015261764638125896, -0.027853449806571007, -0.01154845766723156, 0.02458515763282776, 0.011811088770627975, -0.01796102523803711, -0.03986151143908501, 0.013963202014565468, 0.0013523660600185394, -0.014211242087185383, -0.008717882446944714, -0.009527659974992275, -0.01607883907854557, -0.014138288795948029, -0.05197170749306679, -0.031895045191049576, -0.00578152434900403, -0.012263396754860878, -0.010417686775326729, 0.006270309444516897, -0.0055663129314780235, 0.0074010808020830154, -0.0018457105616107583, -0.01287620235234499, -0.003939461428672075, -0.014802161604166031, -0.014364443719387054, 0.012350941076874733, -0.02681751735508442, -0.025300096720457077, 0.006441748701035976, 0.007441204506903887, -0.004577800165861845, 0.026365209370851517, 0.048615869134664536, 0.011030491441488266, 0.007477681152522564, 0.004745591897517443, 0.014678141102194786, -0.015538986772298813, 0.0264965258538723, 0.038986075669527054, -0.021871306002140045, -0.006091574672609568, -0.015714073553681374, 0.011198283173143864, 0.010621954686939716, 0.004953507799655199, 0.005172366742044687, -0.012051833793520927, 0.005121299531310797, 0.02805771864950657, 0.02815985307097435, -0.014349852688610554, -0.03014417365193367, 0.006084279157221317, -0.0017399287316948175, -0.0010331966914236546, 0.009440116584300995, -0.027444913983345032, -0.013547370210289955, 0.0264965258538723, 0.032216038554906845, 0.005734104663133621, -0.0035856394097208977, 0.0091045331209898, -0.0007350013474933803, 0.022440338507294655, -0.01597670465707779, -0.005792467389255762, 0.010782451368868351, -0.00336860422976315, 0.004519437439739704, 0.019317951053380966, -0.029137423262000084, 0.007674654480069876, -0.05666987970471382, -0.013379577547311783, 0.006113460287451744, -0.015086677856743336, 0.016239335760474205, -0.01855923980474472, 0.018719736486673355, 0.023607587441802025, 0.04455968365073204, 0.03379182517528534, 0.014670846052467823, 0.006051450502127409, 0.004260454326868057, -0.009505773894488811, 0.017727576196193695, 0.015670301392674446, 0.010541706345975399, 0.01724608615040779, 0.02600044570863247, 0.014554120600223541, -0.0014836813788861036, -0.007740311790257692, 0.006098869722336531, 0.02004748024046421, -0.025139600038528442, -0.05719514191150665, -0.02508123777806759, -0.018515467643737793, -0.02458515763282776, 0.004059833940118551, -0.002732089487835765, 0.007415671367198229, 0.02203180268406868, -0.03755619749426842, -0.006131698377430439, -0.02160867489874363, 0.003496272023767233, -0.02582535706460476, 0.0011344189988449216, 0.011738135479390621, -0.007900808937847614, 0.031019609421491623, -0.02249870076775551, -0.020572742447257042, -0.0006132610724307597, 0.01032284740358591, 0.0033521896693855524, 0.004227625671774149, -0.005051994230598211, 0.006467282306402922, -0.01927417889237404, -0.018194474279880524, -0.02379726432263851, -0.005310977343469858, -0.040678586810827255, -0.008258278481662273, 0.011730840429663658, -0.009731928817927837, 0.014408214949071407, -0.003228169633075595, 0.015101268887519836, -0.005624675191938877, 0.012584390118718147, 0.008280163630843163, -0.01524717453867197, -0.014721913263201714, 0.009454707615077496, -0.00043247442226856947, 0.0778554305434227, -0.021623264998197556, -0.01731903851032257, 0.0021192843560129404, -0.034550536423921585, 0.0488785021007061, -0.012591686099767685, -0.00046872295206412673, -0.02907906100153923, 0.000933342264033854, 0.0015247174305841327, 0.01434255763888359, -0.012715705670416355, 0.009119123220443726, -0.008725177496671677, -0.009031579829752445, -0.02419121004641056, 0.05267205834388733, 0.0381106398999691, 0.017771348357200623, 0.01845710538327694, 0.03312065452337265, -0.009359868243336678, -0.022717559710144997, 0.007291651330888271, 0.0018110579112544656, 0.012336350046098232, 0.016239335760474205, 0.01195699442178011, 0.013751638121902943, 0.015918342396616936, -0.015743255615234375, -0.0438593365252018, 0.016341468319296837, -0.04642727971076965, 0.01562652923166752, 0.009928901679813862, 0.021200139075517654, -0.01831120066344738, 0.014495758339762688, 0.017610851675271988, 0.020995870232582092, 0.007171278819441795, 0.0025424116756767035, 0.0012794130016118288, 0.03277048096060753, -0.000914192118216306, 0.019142864271998405, 0.016239335760474205, 0.00883460696786642, -0.002589831128716469, -0.01400697324424982, 0.02818903513252735, 0.0089075593277812, 0.016706233844161034, -0.004559561610221863, -0.0082874596118927, 0.03545515239238739, 0.01009669341146946, 0.024555975571274757, -0.022323613986372948, 0.02086455374956131, -0.041816651821136475, -0.01291267853230238, -0.004216682631522417, -0.021302271634340286, 0.007251527160406113, 0.02677374705672264, -0.037527017295360565, 0.021331453695893288, -0.03277048096060753, -0.004468370694667101, -0.012803249061107635, 0.01232905499637127, -0.016370650380849838, 0.014430101029574871, -0.02535845898091793, 0.020076662302017212, -0.001659680507145822, 0.03201176971197128, 0.002150289248675108, 0.006244775839149952, -0.03163241595029831, -0.0060003832913935184, -0.02295101061463356, 0.027824269607663155, 0.048615869134664536, -0.006624131463468075, -0.03513415902853012, 0.033879365772008896, -0.0014782098587602377, 0.023651357740163803, 0.05001656711101532, 0.04304226115345955, -0.0261025782674551, -0.0015438676346093416, -0.02441006898880005, 0.0068466379307210445, 0.0089075593277812, 0.00334671838209033, -0.007871627807617188, 0.0007126595010049641, 0.02309691533446312, -0.009235848672688007, -0.024570565670728683, 0.010228008963167667, -0.04654400795698166, 0.001891306252218783, -0.0005790643626824021, 0.008105076849460602, 0.014984543435275555, -0.00391392782330513, 0.014488463290035725, 0.013729752041399479, -0.0018593892455101013, 0.006474577821791172, 0.011679773218929768, 0.024176619946956635, 0.02635061927139759, -0.014656255021691322, 0.028393302112817764, 0.001659680507145822, 0.020339293405413628, 0.014641664922237396, -0.019682716578245163, 0.008535499684512615, 0.01324826292693615, -0.028364121913909912, 0.0211125947535038, 0.007010782137513161, -0.0248623788356781, 0.01342334970831871, 0.017552489414811134, -0.005238024517893791, 0.01238012220710516, -0.002381914993748069, -0.00011045538121834397, -0.02044142782688141, -0.014218537136912346, 0.003682302078232169, 0.023155277594923973, 0.011796497739851475, -0.02047060802578926, 0.001514686387963593, -0.03577614575624466, -0.015174221247434616, 0.006069688592106104, -0.012847021222114563, 0.018106931820511818, 0.004377179313451052, -0.01749412715435028, 0.031223878264427185, -0.0008070424082688987, 0.04438459873199463, -0.009462002664804459, -0.00011843461834359914, 0.009885129518806934, -0.02188589610159397, 0.019099092110991478, -0.007083734963089228, 0.019288770854473114, -0.02284887619316578, 0.0028506380040198565, 0.00982676725834608, 0.04047431796789169, 0.004256806802004576, -0.016429012641310692, 0.008309345692396164, 0.005755990743637085, 0.00031643357942812145, 0.02416202984750271, -0.01241659838706255, 0.007320832461118698, -0.014590597711503506, 0.004121843725442886, -0.009542251005768776, -0.012533322907984257, 0.011519276537001133, -0.004617924336344004, 0.015320127829909325, -0.015816207975149155, -0.010745975188910961, 0.028203625231981277, -0.001561193959787488, 0.002485872944816947, 0.006346909794956446, 0.022396566346287727, 0.016370650380849838, 0.014670846052467823, -0.022046392783522606, -0.013613027520477772, -0.03577614575624466, 0.018894823268055916, 0.02185671590268612, 0.00982676725834608, 0.03361673653125763, 0.01019882783293724, -0.004439189098775387, 0.020485198125243187, 0.015699483454227448, 0.002919943304732442, -0.0029637152329087257, -0.001149009563960135, 0.0142914904281497, -0.0323035828769207, -0.014065336436033249, 0.010330143384635448, 0.010906471870839596, 0.02079160138964653, 0.010089398361742496, -0.002060921862721443, -0.010031036101281643, 0.021273091435432434, 0.01565571129322052, 0.01115451194345951, -0.009483888745307922, -0.0026190122589468956, 0.011672478169202805, -0.005766933783888817, -0.008790834806859493, -0.0012730296002700925, 0.007236936595290899, 0.0031369784846901894, 0.025022875517606735, 0.005526188760995865, 0.0165457371622324, 0.019741078838706017, 0.009936196729540825, -0.011840269900858402, 0.012817840091884136, 0.014284195378422737, -0.05264287441968918, 0.006682493723928928, 0.02146276831626892, -0.0026226600166410208, 0.02086455374956131, -0.020499790087342262, -0.0038628606125712395, -0.016443602740764618, 0.013160718604922295, -0.02195884846150875, 0.0488785021007061, 0.030085811391472816, 0.008929445408284664, -0.014167469926178455, 0.0761045590043068, 0.006996191572397947, 0.009060760959982872, -0.04668991267681122, 0.007080087438225746, 0.011366075836122036, 0.017231496050953865, -0.013897543773055077, -0.044647227972745895, 0.023184459656476974, -0.04409278556704521, 0.0032172268256545067, -0.02376808412373066, -0.013547370210289955, 0.04289635643362999, -0.03265375643968582, -0.023928580805659294, 0.003481681225821376, 0.014408214949071407, -0.024424660950899124, 0.019755668938159943, -0.037993915379047394, 0.0023235527332872152, -0.010862699709832668, -0.0021977087017148733, 0.009454707615077496, 0.01192051824182272, -0.007346366066485643, -0.014393624849617481, 0.014605187810957432, 0.02490614913403988, 3.565007500583306e-05, -0.0012830606428906322, 0.00668614124879241, -0.006394329480826855, 0.03656403720378876, -0.0022396566346287727, -0.009782996028661728, 0.001121652196161449, 0.01607883907854557, -0.00450849486514926, -0.013022108003497124, -0.022192299365997314, 0.007054553832858801, 0.013722456991672516, -0.048294879496097565, 0.02093750797212124, -0.007415671367198229, -0.024993693456053734, 0.00311691639944911, 0.007900808937847614, 0.011490095406770706, -0.0142768993973732, -0.02131686359643936, 0.027868041768670082, -0.019332541152834892, -0.012372827157378197, 0.01880728080868721, 0.029239557683467865, 0.04377179220318794, 0.0082728685811162, -0.01296374574303627, 0.03910280019044876, -0.002978305798023939, 0.03265375643968582, 0.01142443809658289, -0.017552489414811134, -0.0016478255856782198, 0.019916165620088577, 0.038023095577955246, 0.010891880840063095, 0.009462002664804459, 0.001717131002806127, -0.011854860931634903, 0.005117652006447315, -0.011541162617504597, -0.008914855308830738, -0.00927961990237236, 0.014306080527603626, 0.03113633580505848, -0.0027029081247746944, -0.011942404322326183, 0.013364987447857857, 0.019989117980003357, -0.012256101705133915, 0.010891880840063095, 0.0006976129370741546, 0.024979103356599808, 0.02709474042057991, -0.01278865896165371, 0.018500877544283867, -0.0022578949574381113, 0.008353116922080517, 0.031398966908454895, -0.01023530401289463, -0.026554888114333153, 0.013554665260016918, -0.007594406139105558, 0.011978880502283573, -0.009352573193609715, -0.00692323874682188, 0.0005010958411730826, 0.010921061970293522, -0.01292726956307888, -0.010629250667989254, 0.026190122589468956, 0.040007419884204865, -0.008776244707405567, -0.007820560596883297, -0.0011307713575661182, 0.005289091728627682, -0.006500111427158117, -0.011716249398887157, -0.022250661626458168, -0.0004566401185002178, -0.0472443550825119, 0.0010933829471468925, -0.014262309297919273, 0.008674110285937786, -0.015320127829909325, 0.004898793064057827, -0.007616291753947735, -0.0067262654192745686, 0.021725399419665337, -0.017771348357200623, 0.027547048404812813, 0.04701090604066849, 0.00481854472309351, 0.01229257881641388, -0.043158985674381256, -0.0330914743244648, -0.030231717973947525, -0.026087988168001175, 0.034783985465765, -0.01890941523015499, -0.02724064514040947, -0.02674456499516964, 0.010381210595369339, -0.029910724610090256, -0.013766229152679443, -0.015889160335063934, -0.008185325190424919, 0.019916165620088577, -0.0045267329551279545]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"0; Tien et al., 2022). It is also possible to apply RLHF to general generative models, like
the diffusion model (Hao et al., 2022; Wu et al., 2023; Lee et al., 2023; Dong et al., 2023). In this work, we
use the terminology and analysis of LLMs for better illustration, and defer the study of general generative
models to future work.
RLHF algorithms. Proximal Policy Optimization (PPO) (Schulman et al., 2017) is the most well-known
algorithm in LLM alignment literature. However, its instability, inefficiency, and sensitivity to hyperpa-
rameters (Choshen et al., 2019) and code-level optimizations (Engstrom et al., 2020) present significant
challenges in tuning for optimal performance and its tremendous success in Chat-GPT4 (OpenAI, 2023) has
not been widely reproduced so far. Additionally, it often necessitates incorporating an extra reward model,
a value network (known as a critic), and a reference model, potentially as large as the aligned LLM (Ouyang
et al., 2022; Touvron et al., 2023). This imposes a significant demand on GPU memory resources. Thus,
researchers have attempted to design alternative approaches for LLM alignment to resolve the aforemen-
tioned issues. Dong et al. (2023); Yuan et al. (2023); Touvron et al. (2023); Gulcehre et al. (2023) propose
reward ranked finetuning (RAFT) (also known as the iterative finetuning, rejection sampling finetuning) by
iteratively learning from the best-of-n policy (Nakano et al., 2021) to maximize the reward, which is a stable
baseline with minimal hyper-parameter configuration and was applied to the alignment of LLaMA2 project.
There is also a line of work focusing on deriving an algorithm from the KL-regularized formulation (Rafailov
et al., 2023; Zhu et al., 2023b; Wang et al., 2023a; Liu et al., 2023a; Li et al., 2023b). Among them, Direct
Preference Optimization (DPO) (Rafailov et al., 2023) has emerged as an attractive alternative approach
to PPO with notable stability and competitive performance. The innovative idea of DPO is to train the
LLMs directly as a reward model based on the offline preference dataset and bypassing the reward modeling.
Similar to DPO, there are also other works aiming to optimize the LLMs directly from the preference data,
including (Zhao et al., 2023; Azar et al., 2023), and has sparked considerable debate on whether reward
modeling, as well as RL, is necessary for alignment. However, while these algorithms are partly inspired by
mathematical principles and intuitions, a comprehensive theoretical analysis remains open.
Theoretical study of RLHF. The theoretical understanding of RLHF can be traced back to research on
dueling bandits (e.g., Yue et al., 2012; Saha, 2021; Bengs et al., 2021), a simplified setting within the RLHF
framework. Recently, many works have focused on the more challenging RLHF problem (also known as
the preference-based RL). Xu et al. (2020); Novoseller et al. (2020); Pacchiano et al. (2021) delve into the
study of tabular online RLHF, where the state space is finite and small. Moving beyond the tabular setting,
Chen et al. (2022) provides the first results for online RLHF with general function approximation, capturing
real-world problems with large state spaces. Wang et al. (2023c) presents a reduction-based framework,
5
which transforms some sample-efficient algorithms for standard reward-based RL to efficient algorithms for
online RLHF. Further advancements in algorithm designs are introduced by Zhan et al. (2023b); Wu and Sun
(2023), encompassing the development of reward-free learning type algorithms and posterior sampling-based
algorithms tailored for online RLHF. Initiating exploration into offline RLHF, Zhu et al. (2023a) presents a
pessimistic algorithm that is provably efficient for offline RLHF. Additionally, Zhan et al. (2023a) and Li et al.
(2023c) extend these investigations into the broader scope of general function approximation settings within
offline RLHF. In comparison to these existing studies, our work introduces a new theoretical formulation and
goal for RLHF, as","[-0.04571598023176193, -0.022885266691446304, 0.037260159850120544, -0.012649633921682835, 0.03205028548836708, -0.007153350859880447, -0.05793600529432297, 0.03540533408522606, -0.021616894751787186, 0.031041041016578674, 0.016666147857904434, -0.024917392060160637, 0.0006763803539797664, 0.007807994727045298, 0.016666147857904434, -0.055371981114149094, 0.020894058048725128, -0.06453699618577957, 0.03957869112491608, 0.04241548478603363, -0.01601150445640087, -0.025503844022750854, -0.003078873036429286, 0.030577335506677628, 1.951199556060601e-05, -0.03715105354785919, 0.01974843069911003, 0.03123197890818119, -0.008605842478573322, -0.04383387789130211, 0.04105164110660553, -0.02029396779835224, -0.030931934714317322, 0.006355503108352423, -0.02431730180978775, 0.04724348336458206, -0.0011243171757087111, 0.02542201243340969, -0.011142588220536709, 0.01368615310639143, 0.014361254870891571, -0.05586296319961548, -0.022830713540315628, 0.017034385353326797, -0.02831335738301277, 0.03526895120739937, 0.025231074541807175, 0.013522492721676826, -0.01617516577243805, 0.015615989454090595, -0.053162556141614914, 0.03412332385778427, -0.049125585705041885, -0.04773446545004845, 0.0003392556682229042, 0.020130306482315063, 0.015138644725084305, -0.005199647508561611, 0.06688280403614044, -0.004575689788907766, 0.0010262910509482026, -0.010883458890020847, 0.010037876665592194, 0.015288667753338814, -0.024630984291434288, -0.010556136257946491, -0.08624935895204544, 0.003445405513048172, 0.0010092429583892226, 0.03505073860287666, -0.01755264587700367, -0.03843306377530098, 0.06862852722406387, -0.025899358093738556, -0.02225789986550808, -0.0017849281430244446, 0.04323378950357437, 0.06617361307144165, 0.0008907592273317277, 0.0007782423053868115, 0.0069794608280062675, -0.013883911073207855, 0.02128957211971283, -0.035023462027311325, 0.0077466219663619995, -0.036141809076070786, -0.031586579978466034, -0.014238509349524975, -0.030440950766205788, -0.0013987903948873281, -0.006611223798245192, -0.01553415972739458, -0.018070904538035393, -0.0003595002053771168, 0.011735859327018261, 0.0025486794766038656, -0.003314135828986764, 0.015847843140363693, 0.06235485151410103, 0.022735245525836945, -0.009376413188874722, -0.04877098649740219, 0.037096500396728516, -0.04244276136159897, 0.05613573268055916, 0.020689481869339943, -0.0031453603878617287, 0.01920289359986782, 0.011019842699170113, -0.008496735244989395, -0.058099664747714996, -0.014293063431978226, -0.07430210709571838, 0.020525820553302765, -0.01492043025791645, -0.05212603881955147, -0.07053790241479874, 0.013515673577785492, -0.029049832373857498, 0.030359121039509773, -0.014197594486176968, 0.006853305734694004, 0.04173356294631958, 0.007835271768271923, 0.011947255581617355, -0.012601898983120918, 0.025517482310533524, -0.057990558445453644, -0.008387628011405468, -0.005540607962757349, 0.019380193203687668, 0.06300949305295944, -0.03791480511426926, -0.053817201405763626, -0.08614025264978409, -0.0020201909355819225, 0.006774884648621082, -0.00863311905413866, -0.03652368485927582, -0.044843122363090515, -0.0077807181514799595, -0.03055005893111229, -0.03897860273718834, -0.0029322600457817316, -0.04631607234477997, 0.024003617465496063, -0.01382253784686327, -0.026990432292222977, -0.011053938418626785, 0.010869819670915604, -0.016243357211351395, -0.009151379577815533, -0.008462638594210148, 0.02861340343952179, -0.023949064314365387, -0.050816748291254044, -0.029104385524988174, 0.028013313189148903, 0.036169085651636124, -0.02292618155479431, 0.01139489933848381, 0.07190174609422684, -0.011149407364428043, 0.031722962856292725, 0.045552320778369904, 0.014006656594574451, -0.01918925531208515, 0.003065234748646617, -0.04086070507764816, -0.013979380019009113, 0.010133345611393452, -0.008789961226284504, -0.02956809289753437, -0.015138644725084305, 0.0006448415224440396, -0.0076170568354427814, -0.008939983323216438, 0.013529311865568161, 0.012281396426260471, -0.045006781816482544, 0.019843900576233864, 0.011463090777397156, -0.007923921570181847, -0.010665243491530418, -0.02779509872198105, 0.03597814962267876, 0.010058334097266197, -0.027876928448677063, 0.004817771725356579, 0.031041041016578674, 0.008142136037349701, 0.04451579973101616, 0.04148807004094124, 0.006658958271145821, -0.009976503439247608, 0.011831328272819519, 0.04699799045920372, 0.050353042781353, 0.0036210003308951855, -0.026499448344111443, 0.006410057190805674, 0.004296102095395327, -0.0134133854880929, -0.05586296319961548, 0.016202442348003387, 0.010794809088110924, 0.0042722346261143684, 0.043479278683662415, -0.011633571237325668, -0.006860124878585339, -0.002920326543971896, 0.02748141437768936, 0.07217451184988022, 0.01702074706554413, -0.019652962684631348, 0.0004008416726719588, -0.032132115215063095, 0.027590522542595863, 0.027290476486086845, 0.06557352095842361, 0.011517644859850407, -0.005765641573816538, 0.0050155287608504295, 0.04285191372036934, -0.03976963087916374, 0.0037130597047507763, 9.189950651489198e-05, -0.03095921128988266, 0.022066961973905563, -0.037123776972293854, 0.05657216161489487, 0.0024276385083794594, -0.03175023943185806, -0.030740996822714806, 0.007235181517899036, -0.010931192897260189, -0.001914493041113019, -0.01991209201514721, 0.05013483017683029, -0.07042879611253738, 0.011626752093434334, 0.006921497639268637, 0.01403393317013979, -0.03305952623486519, 0.007910283282399178, 0.024685539305210114, -0.014824961312115192, -0.03783297538757324, 0.021371401846408844, -0.021207742393016815, 0.014293063431978226, -0.03164113312959671, -0.027863290160894394, -0.00704424362629652, -0.03791480511426926, 0.023539911955595016, -0.00746703427284956, -0.00361077138222754, -0.0030328433495014906, -0.035078015178442, -0.03537805750966072, -0.00017559464322403073, 0.030931934714317322, 0.03205028548836708, 0.028777064755558968, -0.025353820994496346, -0.03963324427604675, 0.035869043320417404, -0.017184408381581306, 0.0037437460850924253, 0.014265785925090313, 0.031177425757050514, -0.01783905178308487, 0.003961960785090923, -0.04658883810043335, -0.030195459723472595, 0.06393691152334213, 0.04135168716311455, -0.03207756206393242, -0.026158487424254417, -0.013692973181605339, 0.026335787028074265, 0.05995449051260948, -0.0009691801387816668, 0.006485068239271641, 0.014211232773959637, -0.02236700803041458, -0.04309740290045738, -0.03832395747303963, -0.009294582530856133, 0.009308220818638802, -0.019257448613643646, 0.03153202310204506, -0.050516705960035324, 0.044297583401203156, 0.016638871282339096, 0.0118722440674901, -0.03300497308373451, 0.04116074740886688, 0.021316848695278168, 0.03646913170814514, 0.015656905248761177, -0.03477796912193298, 0.02720864675939083, 0.027044985443353653, -0.00042406958527863026, 0.014156678691506386, 0.00667259655892849, 0.0135565884411335, 0.04274280369281769, 0.0036039522383362055, 0.04116074740886688, 0.006474839523434639, 0.029922692105174065, -0.023471718654036522, -0.03000452183187008, 0.04487039893865585, -0.022885266691446304, -0.008442181162536144, -0.03425971046090126, -0.04274280369281769, -0.04350655525922775, 0.028940726071596146, 0.0013118453789502382, 0.06568262726068497, -0.03548716753721237, 0.049261968582868576, -0.021494148299098015, -0.052153315395116806, 0.00040041544707491994, 0.022012408822774887, -0.0012129668612033129, 0.022176070138812065, -0.012322311289608479, 0.005612209439277649, -0.02154870145022869, -0.03687828406691551, 0.023294419050216675, 0.05310800299048424, 0.0020764493383467197, -0.05583568662405014, 0.014824961312115192, -0.014702215790748596, 0.006423695478588343, -0.05608117952942848, 0.01554779801517725, 0.022148791700601578, -0.0010484535014256835, 0.020675843581557274, 0.04107891768217087, -0.022994374856352806, 0.0024054760579019785, 0.02364901825785637, -0.012526887468993664, -0.023662656545639038, 0.02844974212348461, 0.006989690009504557, -0.06382779777050018, -0.014974984340369701, -0.004705254454165697, -0.014620385132730007, 0.02847701869904995, -0.026894962415099144, -0.009526435285806656, 0.02088041976094246, 0.02806786634027958, 0.0005864520207978785, 0.0022384056355804205, 0.012042723596096039, -0.018125459551811218, 0.023458080366253853, 0.024808283895254135, -0.03499618172645569, 0.018084542825818062, -0.03936047852039337, -0.002102021360769868, 0.04034244269132614, 0.009703734889626503, 0.014415808953344822, 0.0499984435737133, -0.027276838198304176, 0.023035289719700813, -0.02224426157772541, -0.04211543872952461, 0.02709953859448433, 0.035841766744852066, -0.039060432463884354, -0.038105741143226624, -0.07228361815214157, -0.0012803066056221724, 0.011640390381217003, -0.0026458532083779573, -0.030877381563186646, -0.006157746072858572, -0.01044020988047123, -0.011558559723198414, -0.02613121084868908, 0.03570538014173508, 0.06650093197822571, 0.019298363476991653, -0.03657824173569679, -0.016679786145687103, -0.016106972470879555, -0.0016758207930251956, -0.009717373177409172, 0.03993329033255577, -0.006703283172100782, 0.03892404958605766, 0.00966963917016983, 0.04781629890203476, 0.012397322803735733, -0.02737230621278286, 0.015084091573953629, -0.03477796912193298, 0.03636002540588379, -0.02472645416855812, -0.005393994972109795, -0.015861481428146362, 0.050789471715688705, 0.07550229132175446, 0.024685539305210114, -0.036278195679187775, 0.010815266519784927, -0.008660396561026573, 0.0037642037495970726, 0.021862385794520378, 0.03704194724559784, -0.029186217114329338, -0.0030345481354743242, -0.059081632643938065, -0.021876024082303047, 0.04151534661650658, 0.026185763999819756, -0.02844974212348461, -0.07064700871706009, 0.01891648769378662, 0.011490368284285069, 0.02945898473262787, -0.015697820112109184, -0.031995732337236404, 0.06164565309882164, 0.03524167463183403, -0.03597814962267876, -0.0016579203074797988, -0.01632518693804741, 0.00815577432513237, -0.03671462461352348, 0.008510373532772064, -0.009860577061772346, 0.009703734889626503, -0.01798907481133938, 0.022639775648713112, 0.0999968871474266, -0.004033562261611223, 0.01258826069533825, -0.037123776972293854, 0.08499462902545929, -0.03401421755552292, -0.001024586264975369, 0.02697679214179516, -0.0061986614018678665, -0.02060765214264393, -0.013870271854102612, -0.026785854250192642, 0.01702074706554413, 0.012861029244959354, 0.03376872465014458, 0.006478249095380306, -0.02348535694181919, 0.00404720101505518, -0.0034334720112383366, -0.028531571850180626, 0.011428995057940483, -0.007351107895374298, -0.015043176710605621, 0.0036073618102818727, 0.014879515394568443, -0.019816622138023376, 0.05433546006679535, -0.006522573996335268, -0.01153810229152441, -0.04312467947602272, 0.030031798407435417, -0.017634475603699684, 0.04481584578752518, 0.019530216231942177, 0.007910283282399178, -0.0005740922060795128, -0.0003230600559618324, 0.0013877091696485877, -0.005806556902825832, -0.006570308469235897, 0.023839956149458885, -0.015438690781593323, -0.01824820414185524, -0.02502649836242199, -0.007057881914079189, 0.008046667091548443, -0.009328678250312805, 0.008619480766355991, 0.028095142915844917, -0.02143959514796734, -0.002804399933665991, 0.010685700923204422, 0.01451127789914608, 0.03025001287460327, 0.02555839717388153, -0.007603418547660112, -0.029649922624230385, 0.03660551831126213, -0.027263199910521507, 2.582509296189528e-05, -0.018984679132699966, 0.003213552525267005, 0.01375434547662735, 0.031859345734119415, -0.024235470220446587, -0.02434457838535309, 0.0022486343514174223, 0.025094691663980484, 0.008776322938501835, -0.0025878900196403265, -0.02600846439599991, 0.012438238598406315, 0.0031641132663935423, 0.053544431924819946, -0.045279551297426224, -0.07053790241479874, -0.03248671442270279, -0.03000452183187008, 0.022353369742631912, 0.009301401674747467, 0.01891648769378662, 0.03747837617993355, -0.02945898473262787, -0.027263199910521507, -0.03183206915855408, -0.031722962856292725, -0.015097729861736298, -0.043724771589040756, 0.017593560740351677, -0.007242000661790371, 0.00020265838247723877, 0.04459762945771217, -0.0027413221541792154, -0.04386115446686745, 0.03068644367158413, -0.007051062770187855, 0.015711458399891853, 0.029349878430366516, 0.028640680015087128, -0.04495222866535187, -0.0298408605158329, -0.010467486456036568, -0.04126985743641853, -0.00044239620910957456, 0.013570226728916168, -0.011422175914049149, -0.00011283660569461063, 0.002074744552373886, -0.013706611469388008, -0.010024238377809525, -0.024549154564738274, 0.03936047852039337, -0.02679949440062046, 0.02032124437391758, -0.002620281185954809, -0.012076820246875286, -0.0026935876812785864, 0.023117119446396828, -0.028858894482254982, 0.01507045328617096, 0.06339137256145477, -0.08013935387134552, 0.02501286007463932, 0.009430966340005398, 0.00843536201864481, -0.013522492721676826, 0.0461251325905323, 0.05291706696152687, -0.03341412544250488, -0.050243936479091644, -0.03425971046090126, -0.012479153461754322, -0.01752536930143833, 0.0036210003308951855, -0.010262910276651382, 0.03275948390364647, -0.042088162153959274, 0.016379741951823235, 0.025599312037229538, -0.004930288530886173, -0.012090458534657955, -0.01906651072204113, -0.05490827560424805, -0.0028896399307996035, -0.004337017424404621, -0.0031283122953027487, -0.0022418152075260878, -0.018861932680010796, 0.02307620458304882, 0.011353983543813229, 0.019993921741843224, -0.016638871282339096, -0.01727987639605999, 0.010733435861766338, 0.011415356770157814, 0.002166803926229477, 0.019680239260196686, -0.017061661928892136, -0.009853757917881012, -0.00035332029801793396, 0.018480058759450912, -0.023117119446396828, -0.024781007319688797, -0.019530216231942177, 0.00031624085386283696, 0.0077125257812440395, 0.05043487250804901, -0.0071328929625451565, -0.01408848725259304, -0.0035084832925349474, 0.04219726845622063, -0.006355503108352423, 0.008217147551476955, -0.010972107760608196, -0.024562792852520943, -0.013167893514037132, 0.0052644298411905766, 0.009308220818638802, -0.03106831945478916, -0.015793289989233017, -0.005349670071154833, -0.006614633370190859, 0.00260664289817214, -0.002819743240252137, 0.01547960564494133, -0.01132670696824789, 0.029186217114329338, -0.03854217380285263, 0.019366554915905, 0.005731545388698578, 0.0039517320692539215, -0.03856945037841797, 0.011729040183126926, 0.01492043025791645, 0.008830876089632511, -0.011667667888104916, -0.01125851459801197, -0.026022104546427727, -0.018984679132699966, -0.016966193914413452, 0.03990601375699043, 0.000608188274782151, 0.024276385083794594, -0.00470184488222003, 0.04135168716311455, 0.02888617105782032, 0.014593108557164669, -0.018875572830438614, -0.025899358093738556, -0.019652962684631348, -0.024371854960918427, 0.012813294306397438, -0.009860577061772346, 0.04058793559670448, 0.02349899522960186, 0.06213663890957832, 0.010535678826272488, -0.021180463954806328, -0.04255186766386032, -0.015725096687674522, 0.02472645416855812, -0.003798299701884389, -0.022489752620458603, -0.04004239663481712, 0.0036210003308951855, -0.02310348115861416, -0.03237760812044144, 0.015984227880835533, -0.008851333521306515, -0.009410508908331394, -0.043888431042432785, -0.02626759558916092, 0.002882820786908269, 0.010685700923204422, 0.027563244104385376, -0.03286859020590782, 0.0006597585161216557, -0.0012922402238473296, -0.008005752228200436, -0.0013578750658780336, 0.014115763828158379, -0.015261391177773476, 0.01098574697971344, 0.03663279488682747, 0.012990593910217285, 0.05389903113245964, -0.034505199640989304, -0.07364746183156967, 0.013624780811369419, 0.0364418551325798, 0.009444605559110641, -0.005315573886036873, -0.033523235470056534, -0.026349425315856934, -0.007269277237355709, 0.030768273398280144, 0.044433970004320145, -0.001081697060726583, 0.002015076344832778, -0.029677199199795723, -0.0002482618438079953, 0.013392927125096321, 0.010447029024362564, 0.02831335738301277, 0.061700206249952316, -0.009171837009489536, -0.0012368340976536274, -0.03175023943185806, -0.03636002540588379, 0.0034692727494984865, -0.010392474941909313, 0.011933616362512112, 0.005349670071154833, 0.005199647508561611, -0.04424303025007248, 0.022435199469327927, -0.019871177151799202, 0.0018599394243210554, 0.01541141327470541, 0.00027426009182818234, -0.0005480939871631563, -0.011933616362512112, 0.009410508908331394, 0.019148340448737144, -0.013945283368229866, -0.029268046841025352, 0.0017542416462674737, 0.013863452710211277, 0.01835731230676174, -0.016079695895314217, -0.018152736127376556, 0.004309740383177996, 0.005445139016956091, -5.4979875130811706e-05, 0.05130773410201073, 0.01576601155102253, 0.004589328076690435, 0.01334519311785698, -0.016256995499134064, 0.01284057181328535, 0.013911187648773193, 0.011831328272819519, 0.009608265943825245, -0.01591603457927704, -0.0017832232406362891, -0.01119714230298996, -0.014347616583108902, -0.015793289989233017, 0.004817771725356579, 0.0034437007270753384, -0.011156226508319378, -0.016816170886158943, 0.004262005910277367, -0.03374144807457924, -0.02251702919602394, -0.012008627876639366, 0.025258352980017662, -0.0190801490098238, 0.0014959641266614199, 0.0017917472869157791, 0.012581441551446915, 0.03554172068834305, 0.05062581226229668, -0.0021207742393016815, 0.050516705960035324, 0.021207742393016815, -0.01658431813120842, -0.00521328579634428, -0.014688577502965927, -0.03936047852039337, 0.02694951556622982, -0.03630547225475311, -0.0059838565066456795, -0.009219571016728878, 0.013181531801819801, -0.01617516577243805, 0.004023333545774221, -0.03385055437684059, -0.021057719364762306, 0.01687072403728962, 0.007071520201861858, -0.010631147772073746, 0.0006614633020944893, 0.081775963306427, -0.013215628452599049, -0.08243060857057571, 0.0072829159907996655, 0.034205153584480286, 0.008073943667113781, 0.01408848725259304, -0.005165551323443651, 0.003334593493491411, 0.01989845372736454, 0.010106068104505539, -0.05324438959360123, 0.011449452489614487, -0.018029989674687386, 0.008449000306427479, -0.00018901996372733265, 0.01838458888232708, -0.039196815341711044, 0.020143944770097733, -0.029158940538764, 0.03663279488682747, -0.0005510773626156151, -0.005717907100915909, -0.003370394231751561, 0.025462929159402847, 0.010774350725114346, -0.01498862262815237, -0.00704424362629652, 0.009008175693452358, -0.006723740603774786, -0.012867848388850689, 0.011122130788862705, -0.00397900864481926, -0.02392178773880005, -0.005240562371909618, 0.0023781992495059967, -0.049562014639377594, -0.005854291375726461, 0.0020116667728871107, 0.015206837095320225, -0.007869367487728596, 0.02847701869904995, 0.003788070986047387, -0.0364418551325798, 0.04383387789130211, -0.008585385046899319, 0.020975887775421143, -0.021357763558626175, 0.016120610758662224, -0.014252147637307644, 0.0194756630808115, 0.0011703468626365066, 0.03575993329286575, 0.003283449448645115, 0.004493859130889177, -0.0033414126373827457, -0.01878010295331478, 0.01767539046704769, 0.00966963917016983, 0.017579922452569008, -0.02542201243340969, 0.005646305624395609, -0.026854047551751137, 0.047216206789016724, 0.010903916321694851, -0.012670091353356838, -0.020689481869339943, -0.004302921239286661, -0.01893012598156929, 0.03690556064248085, -0.03630547225475311, -0.06350047886371613, -0.013733888044953346, -0.006133879069238901, -0.0006836257525719702, 0.04855277016758919, 0.0233489740639925, -0.007773899007588625, 0.02956809289753437, 0.03251399099826813, -0.0276177991181612, 0.014974984340369701, 0.05084402486681938, -0.06655548512935638, 0.005114407278597355, -0.006781703792512417, -0.003288563806563616, 0.019366554915905, 0.0478435754776001, 0.006024771835654974, -0.019993921741843224, 0.014620385132730007, 0.012560984119772911, 0.0032800398766994476, 0.031968455761671066, -0.018466418609023094, 0.016420656815171242, -0.04743442311882973, -0.029104385524988174, 9.184623195324093e-05, 0.037669312208890915, -0.040015120059251785, 0.023812679573893547, 0.01202908530831337, -0.035568997263908386, -0.0213032104074955, 0.017579922452569008, -0.01573873497545719, 0.004708664026111364, 0.004221090581268072, 0.021630533039569855, -0.024426408112049103, 0.008694492280483246, 0.04176083952188492, -0.018684634938836098, 0.015711458399891853, 0.001151593984104693, 0.043479278683662415, 0.02694951556622982, 0.014538554474711418, -0.00884451437741518, 0.025926634669303894, 0.005625847727060318, 0.02254430763423443, -0.02806786634027958, 0.018139097839593887, -0.008789961226284504, -0.033223189413547516, -0.0018786921864375472, 0.03993329033255577, -0.004088116344064474, 0.006420285906642675, 0.03734199330210686, -0.01865735650062561, 0.0178254134953022, 0.006014542654156685, -0.017511731013655663, 0.03191389888525009, 0.035732656717300415, 0.011224418878555298, -0.043042849749326706, 0.032268498092889786, 0.024958306923508644, 0.0023304647766053677, -0.008919525891542435, 0.018548250198364258, 0.0052030570805072784, 0.01727987639605999, 0.025121968239545822, -0.03180479258298874, -0.023717211559414864, 0.015984227880835533, 0.034914351999759674, -0.035023462027311325, -0.0010603871196508408, 0.018289120867848396, -0.01864371821284294, 0.02748141437768936, 0.052998896688222885, -0.020662205293774605, -0.01740262284874916, 0.01001741923391819, 0.012172289192676544, 0.036687348037958145, -0.012820114381611347, -0.009867396205663681, 0.013631599955260754, -0.026704024523496628, -0.0077807181514799595, -0.00022886971419211477, 0.009642362594604492, -0.006328226532787085, -0.02888617105782032, -0.06797388195991516, 0.010256091132760048, 0.020266691222786903, 0.014579470269382, 0.01794815994799137, -0.008462638594210148, 0.0050393957644701, 0.0027805326972156763, 0.07342924922704697, 0.008680853992700577, 0.026431256905198097, 0.011994989588856697, -0.013713430613279343, 0.022694328799843788, 0.0027788279112428427, -0.0016792303649708629, 0.002760075032711029, 0.026308510452508926, 0.017784498631954193, 0.0126428147777915, 0.041133470833301544, -0.005022347904741764, 0.015861481428146362, 0.008967260830104351, -0.02254430763423443, -0.009935588575899601, 0.03245943784713745, -0.03535078093409538, -0.07626604288816452, -0.06988325715065002, 0.07702979445457458, 0.014674939215183258, 0.0010126526467502117, -0.03205028548836708, 0.003788070986047387, 0.017620837315917015, -0.024153640493750572, 0.006338455248624086, 0.04192449897527695, -0.0038562628906220198, -0.002298073610290885, -0.036550961434841156, 0.03483252227306366, 0.031722962856292725, -0.028122419491410255, -0.0003413866797927767, -0.01933927834033966, -0.011374441906809807, -0.011360802687704563, -0.04301557317376137, -0.03480524569749832, -3.271089735790156e-05, -0.0006921497406437993, -0.020784949883818626, -0.007903464138507843, 0.015711458399891853, 0.0030362531542778015, -0.003361870301887393, -0.000573239813093096, -0.005806556902825832, 0.00023824613890610635, -0.012281396426260471, 0.011640390381217003, -0.054499123245477676, -0.008892249315977097, 0.010774350725114346, 0.0025572036392986774, -0.005816785618662834, 0.012942859902977943, 0.04489767551422119, 0.013597504235804081, 0.0041665369644761086, 0.00898089911788702, 0.022216985002160072, -0.0029407842084765434, 0.029513539746403694, 0.010883458890020847, -0.028422465547919273, -0.008414904586970806, -0.004111983347684145, 0.0046507008373737335, 0.0059497603215277195, 0.017443537712097168, -0.012881486676633358, -0.013720249757170677, 1.5689509382355027e-05, 0.02667674794793129, 0.03886949270963669, -0.008408085443079472, -0.02888617105782032, 0.016243357211351395, 0.0032118477392941713, 0.005441729445010424, -0.0014337388565763831, -0.02502649836242199, -0.01044020988047123, 0.015111368149518967, 0.031286533921957016, 0.010194717906415462, 0.003781251609325409, -0.0061986614018678665, -0.007855729199945927, 0.030768273398280144, -0.003706240328028798, 0.009996960870921612, 0.026458533480763435, -0.0013442366616800427, 0.020007560029625893, 0.015997866168618202, -0.030931934714317322, -0.0004166110884398222, -0.041815392673015594, -0.005165551323443651, 0.00618161354213953, -0.023608103394508362, 0.020689481869339943, -0.011013023555278778, 0.011381261050701141, 0.03477796912193298, 0.060172706842422485, 0.03445064648985863, 0.012342769652605057, 0.009226390160620213, -0.018698273226618767, -0.013242905028164387, 0.006058867555111647, -0.008483096957206726, 0.010760712437331676, -0.003266401356086135, 0.04547049105167389, 0.02073039673268795, 0.0027788279112428427, 0.00829215906560421, 0.008605842478573322, 0.006140698213130236, -0.015152283944189548, -0.031150149181485176, -0.0041665369644761086, -0.022639775648713112, -0.010617509484291077, -0.01119714230298996, -0.005131455138325691, -0.010119707323610783, 0.006331636104732752, -0.00924684852361679, -0.018180012702941895, -0.020839504897594452, -0.0006282196845859289, -0.021616894751787186, -0.01839822717010975, -0.007071520201861858, -0.02375812642276287, 0.03728743642568588, -0.029322601854801178, -0.006618042942136526, 0.010808447375893593, 0.009526435285806656, -0.0010706159519031644, 0.008544469252228737, -0.005908844992518425, 0.014293063431978226, -0.027986036613583565, -0.02611757256090641, -0.04086070507764816, -0.01056977454572916, -0.02364901825785637, 0.004817771725356579, -0.0017627656925469637, -0.011667667888104916, 0.026854047551751137, 0.019284725189208984, 0.023471718654036522, 0.004398390185087919, -0.0024395722430199385, 0.013993018306791782, -0.017225323244929314, -0.006897630635648966, 0.0016340530710294843, -0.019407469779253006, 0.06622816622257233, -0.02156233973801136, -0.0022008998785167933, -0.0158887580037117, -0.021998770534992218, 0.04743442311882973, -0.016625232994556427, -0.0048859636299312115, -0.016216080635786057, 0.010903916321694851, -0.006570308469235897, 0.025912996381521225, -0.006212299689650536, 0.0009819661499932408, 0.005301935598254204, -0.008544469252228737, -0.014388532377779484, 0.050216659903526306, 0.01009242981672287, 0.04004239663481712, 0.010501583106815815, 0.02019849792122841, -0.003927864599972963, -0.028149696066975594, 0.015602351166307926, -0.003801709273830056, -0.007392023224383593, 0.03824212774634361, -0.0034658631775528193, 0.004988251719623804, 0.013283819891512394, -0.020894058048725128, -0.04244276136159897, 0.011797232553362846, -0.040997087955474854, -0.0024259337224066257, 0.0004897044855169952, 0.028831617906689644, -0.004326788242906332, 0.023812679573893547, 0.021453233435750008, 0.01798907481133938, -0.00494733639061451, 0.017048023641109467, 0.01188588235527277, 0.019966645166277885, 0.009731012396514416, 0.021480510011315346, 0.024371854960918427, 0.03914226219058037, -0.01646157167851925, -0.022748883813619614, 0.032295774668455124, -0.0005881568067707121, 0.002315121702849865, 0.02100316621363163, -0.002328759990632534, 0.04004239663481712, -0.0014073143247514963, 0.01658431813120842, -0.023989979177713394, 0.0030072713270783424, -0.034341540187597275, -0.012670091353356838, 0.00042705298983491957, -0.01361114252358675, 0.01629791036248207, 0.01839822717010975, -0.03000452183187008, 0.03513256832957268, -0.03540533408522606, -0.01767539046704769, -0.020675843581557274, 0.015029537491500378, 9.123356790041726e-07, 0.010965288616716862, -0.038760386407375336, 0.02973175421357155, -0.009717373177409172, 0.019557492807507515, 0.0118722440674901, 0.009546893648803234, -0.010835723951458931, 0.012465515173971653, -0.0096832774579525, 0.025953911244869232, 0.03202300891280174, 0.007951198145747185, -0.03914226219058037, 0.043615665286779404, -0.017443537712097168, 0.037778422236442566, 0.04765263572335243, 0.02074403502047062, -0.024085447192192078, -0.002855543978512287, -0.008217147551476955, 0.006945365108549595, 0.019380193203687668, -0.0006192694418132305, -0.013201989233493805, -0.0012180813355371356, 0.030659165233373642, -0.0031470651738345623, -0.022162431851029396, 0.007951198145747185, -0.02321258932352066, -0.011176684871315956, -0.0008464343845844269, 0.0048518674448132515, 0.023458080366253853, -0.0023168264888226986, 0.021916938945651054, 0.01498862262815237, 0.0027140453457832336, 0.015043176710605621, 0.0027583702467381954, 0.02720864675939083, 0.03052278235554695, -0.01576601155102253, 0.01770266704261303, -0.0028112190775573254, 0.02614484913647175, 0.011797232553362846, -0.02694951556622982, -0.002473668195307255, -0.010535678826272488, -0.009512796998023987, 0.007126073818653822, 0.001264111022464931, -0.012206384912133217, 0.011040300130844116, 0.009921950288116932, -0.0010271434439346194, -0.0023048927541822195, 0.008258062414824963, -0.007623876444995403, -0.028968002647161484, -0.006171384826302528, 0.010331102646887302, 0.018902849406003952, 0.012629176490008831, -0.007889825850725174, 0.022448837757110596, -0.03799663484096527, -0.01783905178308487, 0.011319887824356556, -0.014061209745705128, 0.041406240314245224, 0.013352012261748314, -0.017443537712097168, 0.04642517864704132, 0.010481124743819237, 0.034232430160045624, 0.0036721443757414818, -0.019448386505246162, 0.00663850037381053, -0.005690630525350571, 0.027304114773869514, 0.014074848033487797, 0.025612950325012207, -0.035596273839473724, 0.011374441906809807, 0.018302759155631065, 0.037396546453237534, 0.0045313648879528046, -0.024153640493750572, 0.006311178207397461, -0.006140698213130236, 0.010501583106815815, 0.007235181517899036, -0.0036516867112368345, -0.006641909945756197, -0.013590684160590172, -0.00487573491409421, -0.01699347048997879, -0.030059074983000755, -0.006423695478588343, -0.024140002205967903, -0.003090806771069765, -0.02696315385401249, -0.02434457838535309, 0.019271086901426315, 0.0005557655822485685, 0.013106520287692547, 0.010201537050306797, 0.028913447633385658, 0.009280944243073463, 0.02086678147315979, -0.0035562177654355764, 0.015356860123574734, -0.03125925734639168, 0.028422465547919273, 0.03147746995091438, 0.008639938198029995, 0.027454137802124023, 0.01699347048997879, 0.016270633786916733, 0.0364418551325798, 0.019161978736519814, 0.01895740255713463, 0.010815266519784927, -0.007201085332781076, 0.01643429510295391, -0.014006656594574451, -0.004098345059901476, 0.011558559723198414, 0.02213515341281891, -0.0007910283165983856, 0.013031509704887867, -0.008183051832020283, -0.015356860123574734, 0.016938917338848114, 0.030331844463944435, 0.016761617735028267, 0.0259675495326519, -0.01781177520751953, 0.018998317420482635, -0.020525820553302765, -0.018889211118221283, 0.00911046378314495, 0.008551288396120071, -0.0010399294551461935, 0.021903300657868385, -0.004197223577648401, 0.0024020664859563112, 0.01978934556245804, 0.018616441637277603, -0.006788522936403751, 0.008967260830104351, -0.0025930043775588274, -0.059627167880535126, -0.006086144596338272, 0.009287763386964798, 0.008428542874753475, 0.025817526504397392, -0.006430514622479677, 0.021316848695278168, 0.0032254860270768404, 0.01492043025791645, -0.0042006331495940685, 0.02834063395857811, 0.026908600702881813, 0.006856715306639671, -0.01893012598156929, 0.06480976939201355, 0.029377155005931854, 0.026431256905198097, -0.03788752853870392, 0.007985294796526432, -0.0010586823336780071, 0.019271086901426315, -0.015138644725084305, -0.039851460605859756, 0.04958929121494293, -0.03395966440439224, 0.011906339786946774, -0.017238961532711983, 0.004415438044816256, 0.032950419932603836, -0.015943311154842377, -0.01104711927473545, -0.019107425585389137, 0.008837695233523846, -0.029349878430366516, 0.014183956198394299, -0.048007234930992126, 0.03161385655403137, -0.010672062635421753, -0.009076368063688278, 0.0056531247682869434, 0.021794194355607033, 0.008046667091548443, -0.013795261271297932, -0.009253667667508125, -0.014347616583108902, 0.002494125859811902, -0.01098574697971344, 0.014361254870891571, -0.017470814287662506, 0.02183510921895504, -0.010221995413303375, -0.006580537185072899, 0.001923017087392509, -0.008162593469023705, 0.005803147330880165, -0.02253066748380661, -0.016829809173941612, 0.005523559637367725, 0.01685708574950695, -0.03756020590662956, 0.02362174168229103, -0.002802695147693157, -0.02637670189142227, -0.00362781947478652, 0.009649181738495827, 0.0054519581608474255, -0.01590239629149437, -0.010740255005657673, 0.029649922624230385, -0.008285339921712875, -0.005615619011223316, 0.012274577282369137, 0.03535078093409538, 0.04296102002263069, 0.007064701057970524, -0.017048023641109467, 0.0400969535112381, -0.002127593383193016, 0.02651308663189411, 0.01375434547662735, -0.012901944108307362, -0.01021517626941204, 0.030059074983000755, 0.03505073860287666, 0.012970136478543282, 0.0016050714766606688, 0.0030822826083749533, -0.006887401454150677, 0.027535967528820038, 0.003992647398263216, -0.009199113585054874, 0.014306701719760895, 0.015997866168618202, 0.029186217114329338, -0.005796328186988831, 0.0021361173130571842, 0.013147436082363129, 0.007091978099197149, -0.0015104549238458276, 0.018070904538035393, 0.009096825495362282, 0.01672070100903511, 0.026772215962409973, -0.015588712878525257, 0.04080614820122719, 0.0022162431851029396, 0.007473853882402182, 0.02362174168229103, -0.013208809308707714, -0.008626299910247326, 0.015725096687674522, -0.028667956590652466, 0.005711087957024574, -0.020253052935004234, -0.005312164314091206, -0.001709064352326095, 0.01339974720031023, -0.02419455535709858, 0.004545003175735474, 0.03993329033255577, 0.04489767551422119, -0.009928769432008266, -0.007883005775511265, 0.0015070453519001603, 0.012751922011375427, -0.0003756958176381886, -0.02254430763423443, -0.013004232197999954, -0.008373989723622799, -0.04737986624240875, 0.002669720444828272, -0.00815577432513237, 0.024971945211291313, -0.02474009245634079, -0.020948611199855804, -0.0279042050242424, 0.002096907002851367, 0.01631154865026474, -0.025940272957086563, 0.034232430160045624, 0.04075159505009651, 0.01111531164497137, 0.016747979447245598, -0.05027121305465698, -0.030577335506677628, -0.025244712829589844, -0.0014397056074813008, 0.03300497308373451, 0.005008709616959095, -0.037396546453237534, -0.022435199469327927, 0.013781622052192688, -0.02487647719681263, -0.014579470269382, -0.010297005996108055, -0.011544921435415745, 0.016475209966301918, 0.0012300149537622929]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" well as novel problem settings, such as hybrid RLHF. The new mathematical formulation
allows our framework to align more closely with recent advancements in LLMs, and we discuss the connections
between our theoretical findings and practical algorithmic designs in Section 5. We mention in passing that
Tiapkin et al. (2023) also considers the KL constraint in offline RL but mainly focuses on the scenario where
an expert policy is available for imitation learning, thus differing from ours.
Finally, concurrent to this work, Hoang Tran (2024) and Yuan et al. (2024) consider variants of iterative
DPO that may share similar insights with us in terms of algorithmic design. We comment on the similarities
and differences between our work and theirs as follows. Hoang Tran (2024) focus on the batch online setting,
which will be thoroughly developed in Section 4. One notable difference is that they set the reference
policy as the one from last iteration, while we always use the π0as the reference policy. From a theoretical
perspective, their algorithmic design resembles the classic policy gradient algorithm (Cai et al., 2020; Zhong
and Zhang, 2023) that optimizes the non-regularized reward, while we optimize the KL-regularized one as
most of the Instruct-GPT (Ouyang et al., 2022) and Claude (Bai et al., 2022) did. Yuan et al. (2024) also
consider iterative DPO-type training. However, both our algorithm and Hoang Tran (2024) leverage the
reward signal from the external model or human, while Yuan et al. (2024) adopts a clever idea by using the
LLM itself as the reward model to provide preference signal, hence the name “self-rewarding”. We remark
that the primary goal of this project is to formally formulate the RLHF as a KL-regularized contextual
bandit problem and establish its mathematical foundation. The online iterative DPO is a natural corollary
of the established framework but the framework can also be implemented by combining it with other oracle
algorithms. See Section 5 for details. Finally, we expect that the techniques presented in this paper also
extend to analyze the general preference learning like Azar et al. (2023) beyond the reward-based learning.
2 Formulation and Existing Approaches
In this section, we present the mathematical framework for the RLHF process, inspired by the standard
LLM alignment workflow (Ouyang et al., 2022; Touvron et al., 2023).
2.1 Formulation of RLHF
Specifically, the LLM can take a prompt, denoted by x∈ X, and produce a response, denoted by a=
[w1, w2, . . .], where wiis the i-th token generated by the model. Accordingly, we can take Xas the state
space of the contextual bandit and the Aas the action space. Following Ouyang et al. (2022); Zhu et al.
(2023a); Rafailov et al. (2023); Liu et al. (2023a), we assume that there exists a ground-truth reward function
r∗(x, a) :X × A → [0,1] and the preference satisfies the Bradley-Terry model (Bradley and Terry, 1952):
P(a1≻a2|x, a1, a2) =exp(r∗(x, a1))
exp(r∗(x, a1)) + exp( r∗(x, a2))=σ 
r∗(x, a1)−r∗(x, a2)
, (1)
where a1≻a2means that a1is preferred to a2, and σ(z) = 1 /(1 + exp( −z)) is the sigmoid function. We
denote an LLM by a policy πthat maps xto a distribution over A.
6
2
 0 22
02
Pretrained data
2
 0 22
02
0
r
2
 0 2 42
02
0
r
0 52
02
0
r
(a) Pretrained π0 (b) Preferred πr(η−1= 0.5) (c) Preferred πr(η−1= 1.0) (d) Preferred πr(η−1= 10)
Figure 1: A two-dimensional illustrating example of human preference in generative modeling. We consider
a scenario where the initial data distribution π0, referred to as “pretrained”, is represented by a multi-modal
G","[-0.036939386278390884, -0.0222184918820858, 0.02574523724615574, -0.0190444216132164, 0.03646915405988693, 0.014015545137226582, -0.01908360794186592, 0.04226868972182274, -0.025810547173023224, 0.046239543706178665, 0.02647670917212963, -0.027404112741351128, -0.00372267491184175, -0.008842986077070236, 0.018117018043994904, -0.044071245938539505, 0.027639228850603104, -0.03490171208977699, 0.005959545727819204, 0.038114968687295914, -0.0085882768034935, -0.03704388067126274, -0.002689142944291234, 0.03552868589758873, -0.002374021802097559, -0.03592054918408394, 0.02582360804080963, 0.007948237471282482, -0.023119771853089333, -0.020298374816775322, 0.030147137120366096, -0.025928104296326637, -0.04177233204245567, -0.026881631463766098, -0.009287094697356224, 0.03194969519972801, -0.009594052098691463, 0.04974016174674034, -0.014707831665873528, 0.04057062789797783, -0.005897501017898321, -0.05930155888199806, -0.03158395737409592, 0.021722136065363884, -0.03717450052499771, 0.039107680320739746, 0.005084390286356211, 0.044672101736068726, 0.007719652261584997, 0.02244054526090622, -0.05397225543856621, 0.05250931158661842, -0.026803260669112206, -0.012167269363999367, 0.006439574528485537, -0.0017764343647286296, 0.026071786880493164, -0.011488044634461403, 0.059771791100502014, -0.009789981879293919, 0.01250035036355257, -0.026620391756296158, 0.014538025483489037, 0.023759810253977776, -0.01687612757086754, -0.01604015752673149, -0.08025303483009338, 0.014002482406795025, 0.0005612585810013115, 0.053554270416498184, 0.01730717346072197, -0.015896474942564964, 0.04830333963036537, -0.003833702066913247, -0.026555081829428673, 0.02217930555343628, 0.02278015948832035, 0.05658465996384621, 0.0007551478920504451, -0.01311426516622305, 0.010168780572712421, -0.05465148016810417, 0.04477659612894058, -0.030538996681571007, 0.0077719003893435, -0.05300566554069519, -0.04396675154566765, -0.028240082785487175, -0.022897716611623764, -0.03257667273283005, -0.0009527109214104712, -0.0019364440813660622, -0.02722124382853508, -5.694223364116624e-05, 0.021931126713752747, 0.017124304547905922, -0.01384573895484209, 0.00811151321977377, 0.04062287509441376, 0.012017056345939636, 0.009136881679296494, -0.04621341824531555, 0.011507637798786163, -0.006080368999391794, 0.030669616535305977, 0.015935661271214485, 0.007086144294589758, 0.056898146867752075, -0.02509213611483574, -0.023276515305042267, -0.0670342743396759, -0.016993684694170952, -0.04890419542789459, 0.04255605489015579, -0.0064199818298220634, -0.039290547370910645, -0.0729905515909195, 0.01223911065608263, 0.0018858287949115038, -0.021160468459129333, -0.0367826409637928, -0.024804770946502686, 0.01734635978937149, -0.009855291806161404, -0.006380795501172543, -0.0003430820652283728, 0.011011281050741673, -0.07555071264505386, -0.009136881679296494, -0.005172559060156345, 0.016810815781354904, 0.04605667293071747, -0.028553569689393044, -0.0756029561161995, -0.07053489238023758, 0.01869174651801586, 0.018704809248447418, -0.002200949937105179, -0.02348550781607628, -0.03226318210363388, -0.020363684743642807, -0.054024506360292435, -0.06614605337381363, -0.012487288564443588, -0.0569503977894783, 0.05117698386311531, -0.03803659602999687, -0.0014907027361914515, -0.007654342334717512, 0.0014286581426858902, -0.0015502981841564178, -0.015491552650928497, -0.008503373712301254, 0.024713337421417236, -0.017411669716238976, -0.05117698386311531, -0.0235246941447258, 0.03226318210363388, 0.04344427213072777, -0.00617506867274642, -0.004663140047341585, 0.06395164132118225, -0.011533761397004128, 0.00875808298587799, 0.02556236833333969, 0.016797754913568497, -0.019279537722468376, 0.017725158482789993, -0.04579543322324753, -0.034457601606845856, -0.014342095702886581, 0.019553840160369873, -0.05232644081115723, -0.018156204372644424, 0.003980649635195732, -0.012630971148610115, 0.010103470645844936, -0.015387056395411491, 0.021238841116428375, -0.04600442573428154, -0.0024850487243384123, 0.021891942247748375, -0.029023803770542145, -0.02244054526090622, -0.015726668760180473, 0.040936361998319626, -0.012173800729215145, -0.0395779125392437, -0.0010580234229564667, 0.0328640379011631, 0.018665622919797897, 0.059197064489126205, 0.039107680320739746, -0.011390079744160175, 0.0031838668510317802, -0.008313974365592003, 0.050105899572372437, 0.05653241276741028, 0.016014033928513527, -0.007961299270391464, 0.02294996567070484, 0.0198803897947073, -0.021278027445077896, -0.060033030807971954, 0.00813110638409853, 0.0064918226562440395, 0.00824213307350874, 0.027377989143133163, -0.03683488816022873, -0.020402871072292328, 0.005642791744321585, -0.007660873234272003, 0.06029427424073219, 0.00963323749601841, -0.03983915224671364, 0.0017356155440211296, -0.02925891987979412, 0.018717871978878975, 0.011977870017290115, 0.0431307815015316, 0.002723430749028921, 0.013101203367114067, -0.003634506370872259, 0.012774652801454067, -0.06525783985853195, -0.003435310674831271, -0.0004955402691848576, -0.017894964665174484, 0.014511901885271072, -0.0461089201271534, 0.05057613179087639, 0.027665352448821068, -0.00994019489735365, -0.029624655842781067, 0.02126496471464634, -0.023185081779956818, -0.019488530233502388, -0.011886435560882092, 0.044071245938539505, -0.07116187363862991, 0.009097695350646973, 0.026293842121958733, 0.018979111686348915, -0.008026610128581524, 0.018678685650229454, 0.018796242773532867, -0.007334322668612003, -0.0013143655378371477, 0.007517191115766764, -0.004908053204417229, 0.021251901984214783, -0.0266073290258646, -0.03816721588373184, -0.025797484442591667, -0.04566481336951256, 0.04104086011648178, -0.03048674948513508, 0.010547579266130924, -0.04057062789797783, -0.02991202101111412, -0.034196361899375916, 0.013571436516940594, 0.02839682623744011, 0.024726398289203644, 0.014773141592741013, -0.02847519889473915, -0.04370551183819771, 0.006844497285783291, 0.011703567579388618, 0.0008735224255360663, -0.011919091455638409, -0.0009739366942085326, -0.04012651741504669, 0.025118259713053703, -0.06943768262863159, -0.06436961889266968, 0.06170497089624405, 0.0461089201271534, -0.028422949835658073, -8.224989142036065e-05, -0.028161710128188133, 0.018378257751464844, 0.07069163769483566, 0.002186255296692252, 0.0190444216132164, -0.013989420607686043, -0.02826620638370514, -0.02065104991197586, -0.05313628911972046, -0.03004264086484909, -0.005962810944765806, -0.022336050868034363, 0.04441085830330849, -0.038506828248500824, 0.021199654787778854, 0.013355912640690804, -0.008980137296020985, -0.031636208295822144, 0.016980621963739395, 0.02308058552443981, 0.024504344910383224, 0.012101959437131882, -0.05039326474070549, 0.019593026489019394, -0.00507785938680172, 0.017228800803422928, 0.017189614474773407, -0.017633723095059395, 0.01443352922797203, 0.011324768885970116, 0.01630139723420143, 0.025026826187968254, 0.0018923598108813167, 0.006423247046768665, -0.014185351319611073, -0.021212715655565262, 0.06269768625497818, -0.004137394018471241, -0.00572769483551383, -0.031636208295822144, -0.051725588738918304, -0.0379059761762619, 0.0063481405377388, -0.01156641636043787, 0.04783310741186142, -0.01622302643954754, 0.009300156496465206, -0.009463431313633919, -0.03774923086166382, -0.017725158482789993, 0.023903492838144302, -0.009920602664351463, 0.03291628509759903, -0.0006971851689741015, 0.04083186760544777, -0.018730932846665382, -0.026189345866441727, 0.037723105400800705, 0.04665752500295639, 0.01721573993563652, -0.07366977632045746, -0.01047573797404766, -0.02970302850008011, 0.007334322668612003, -0.05318853631615639, 0.022767096757888794, -0.0013298767153173685, -0.00036716513568535447, 0.020337561145424843, 0.03200194239616394, -0.0408841148018837, -0.024230042472481728, 0.015138878487050533, 0.004437820520251989, -0.041197601705789566, 0.003670427016913891, 0.018456630408763885, -0.052901171147823334, -0.0315578356385231, 0.007523722015321255, -0.030643492937088013, 0.015582987107336521, 0.0048460084944963455, -0.011768877506256104, -0.030382253229618073, 0.030382253229618073, -0.003139782464131713, -0.013623684644699097, 0.009855291806161404, -0.012552598491311073, 0.01669325865805149, 0.01265709474682808, -0.040936361998319626, 0.009352404624223709, -0.039290547370910645, -0.03699163347482681, 0.04890419542789459, 0.0003189989656675607, 0.013636746443808079, 0.004712122958153486, -0.03900318592786789, 0.004927645903080702, 0.006482026074081659, -0.0266987644135952, 0.019057484343647957, 0.024948453530669212, -0.038977060467004776, -0.01777740567922592, -0.04454147815704346, 0.0014294745633378625, 0.034980084747076035, 0.005538295488804579, 0.00982916820794344, 0.03142721578478813, -0.024099422618746758, -0.010227560065686703, -0.019945701584219933, 0.04718000814318657, 0.07142311334609985, 0.017581475898623466, -0.032890159636735916, -0.02057267725467682, -0.0379059761762619, 0.00969854835420847, -0.033412639051675797, 0.006113024428486824, -0.003530010348185897, 0.032367680221796036, 0.010808819904923439, 0.0507851243019104, 0.018117018043994904, -0.042294811457395554, 0.0036965508479624987, -0.05122923105955124, 0.02634608931839466, -0.009985912591218948, 0.0064330436289310455, -0.028109461069107056, 0.0472322553396225, 0.06854946911334991, 0.015360932797193527, -0.023798996582627296, -0.011736222542822361, -0.011540292762219906, 0.0005694223218597472, 0.014564150013029575, 0.019619150087237358, -0.02899767830967903, -0.029154423624277115, -0.042425431311130524, -0.009189128875732422, 0.04456760361790657, 0.03273341432213783, -0.03649527579545975, -0.057368382811546326, 0.006916338112205267, 0.01251994352787733, 0.016497328877449036, 0.0030352864414453506, -0.05023651942610741, 0.055121712386608124, 0.007686997298151255, -0.020860042423009872, 0.008222539909183979, -0.014159226790070534, 0.015217250213027, -0.0048460084944963455, 0.0007718835840933025, -0.002328304573893547, -0.014603335410356522, -0.03017326071858406, 0.021878879517316818, 0.09639769047498703, 0.01829988695681095, -0.002969976281747222, -0.047075510025024414, 0.09498699009418488, 0.00428434181958437, -0.019331786781549454, 0.01738554611802101, -0.01413310319185257, -0.019501592963933945, -0.004375775810331106, -0.01891380175948143, 0.0021454363595694304, 0.005936686880886555, -0.002181357005611062, 0.007686997298151255, -0.019384033977985382, 0.018064770847558975, -0.00019858348241541535, -0.03121822141110897, 0.021513143554329872, -0.012036649510264397, -0.023838182911276817, 0.01271587423980236, 0.03767085820436478, -0.014825389720499516, 0.06060776114463806, 0.0033928591292351484, 0.028553569689393044, -0.01336897537112236, 0.015857288613915443, -0.01282690092921257, 0.03349101170897484, 0.03973465785384178, 0.02270178683102131, -0.02217930555343628, -0.012957521714270115, 0.0023936147335916758, -0.013819614425301552, -0.018639499321579933, 0.02369450032711029, -0.014315971173346043, -0.0005355427274480462, -0.030016515403985977, 0.006050979718565941, -0.018796242773532867, -0.01410697866231203, -0.006517946720123291, 0.03764473274350166, -0.031740702688694, 0.01626221276819706, 0.020193878561258316, 0.012193392962217331, 0.03338651731610298, 0.014524963684380054, -0.023472445085644722, -0.0017307173693552613, 0.03035612963140011, -0.023028336465358734, -0.0003473680408205837, -0.025706050917506218, 0.031636208295822144, 0.0032295838464051485, 0.014446591027081013, -0.03639078140258789, -0.03626016154885292, -0.014067793264985085, 0.03735737130045891, -0.009274032898247242, 0.007647811435163021, -0.049975279718637466, 0.008627462200820446, 0.015008257701992989, 0.04731062799692154, -0.022767096757888794, -0.09566621482372284, -0.022336050868034363, -0.039499539881944656, 0.030852485448122025, 0.022662600502371788, 0.015021320432424545, 0.03712225332856178, -0.0044345548376441, -0.005234603304415941, -0.027508608996868134, -0.038114968687295914, -0.011272520758211613, -0.03466659411787987, 0.005492578260600567, 0.00016776529082562774, 0.0041178008541464806, 0.04848621040582657, -0.006994710303843021, -0.0421903170645237, 0.016941437497735023, -0.011115777306258678, 0.019945701584219933, 0.051203109323978424, 0.033151399344205856, -0.0328640379011631, -0.04738900065422058, -0.013440815731883049, -0.038977060467004776, 0.0033063231967389584, -0.009718140587210655, -0.001444169320166111, -0.006994710303843021, -0.0004175763751845807, -0.026333026587963104, -0.0010465941159054637, -0.032942406833171844, 0.02535337582230568, -0.022793220356106758, 0.036286283284425735, 0.01348000206053257, 0.003879419295117259, 0.028240082785487175, 0.0098487613722682, -0.025706050917506218, 0.01476007979363203, 0.06029427424073219, -0.044854968786239624, 0.02983364835381508, -0.01145538967102766, 0.015256436541676521, -0.006726939231157303, 0.0260456632822752, 0.04412349686026573, -0.04124985262751579, -0.04509008303284645, -0.023407135158777237, -0.04626566544175148, -0.018077831715345383, 0.00221727741882205, -0.0023299374151974916, 0.018156204372644424, -0.04409737139940262, 0.008999730460345745, 0.035110704600811005, -0.021500080823898315, -0.027273492887616158, -0.003918605390936136, -0.034457601606845856, -0.01317304465919733, -0.007817617617547512, 0.01926647499203682, 0.007575970143079758, -0.037461865693330765, 0.031740702688694, 0.017672909423708916, -0.0074453498236835, -0.007223295513540506, -0.03887256234884262, 0.03325589746236801, -0.013244885951280594, 0.004320262465626001, 0.004917849786579609, -0.014185351319611073, -0.015308684669435024, -0.019018298014998436, 0.022231554612517357, -0.013780428096652031, -0.041589464992284775, -0.04153721407055855, -0.011004749685525894, -0.0002054206415778026, 0.032158687710762024, 0.003038551891222596, -0.009881416335701942, 0.014707831665873528, 0.02247973158955574, -0.017333297058939934, -0.01250035036355257, 0.007575970143079758, -0.013440815731883049, -0.010332056321203709, 0.0028148647397756577, -0.0020556349772959948, -0.02608484961092472, -0.023981863632798195, 0.01734635978937149, 0.0111092459410429, 0.008927889168262482, -0.0033210180699825287, 0.010207966901361942, -0.003654099302366376, 0.008379284292459488, -0.019593026489019394, 0.015974847599864006, 0.031035354360938072, -0.006955524440854788, -0.05365876853466034, 0.028187833726406097, 0.01604015752673149, 0.0034875585697591305, 0.012637501582503319, -0.01635364629328251, -0.054546985775232315, -0.014564150013029575, -0.02795271761715412, 0.004519457928836346, -0.016157716512680054, 0.03145333752036095, 0.0016964295646175742, 0.009071570821106434, 0.008229071274399757, 0.006864090450108051, -0.007732714526355267, -0.016549576073884964, -0.019841205328702927, -0.009117288514971733, 0.014211474917829037, 0.002870378317311406, 0.04378388449549675, 0.008777676150202751, 0.06938543915748596, -0.016641009598970413, -0.009705078788101673, -0.04469822347164154, 0.0010776164708659053, 0.03247217461466789, -0.00083433638792485, -0.011494575068354607, -0.0230544600635767, -0.02460884116590023, -0.019018298014998436, -0.03479721397161484, 0.01015571877360344, -0.007856803946197033, -0.0023903492838144302, -0.03597279638051987, -0.018378257751464844, -0.008176823146641254, 0.0008490311447530985, 0.01826070062816143, -0.03440535441040993, -0.003817374585196376, 0.006295892409980297, -0.022113995626568794, 0.00122864602599293, 0.005949749145656824, -0.02682938426733017, 0.0024425971787422895, 0.021905003115534782, 0.00017572495562490076, 0.05397225543856621, -0.033282019197940826, -0.0748714879155159, -0.009247908368706703, 0.022192368283867836, -0.004241890273988247, 0.005783208180218935, -0.013688994571566582, -0.024151669815182686, -0.008705834858119488, 0.03414411470293999, 0.03492783382534981, -0.00680531095713377, -0.021539267152547836, -0.03513682633638382, -0.0017160226125270128, 0.038506828248500824, 0.0038598261307924986, 0.016523452475667, 0.042164191603660583, 0.008425001055002213, -0.011265990324318409, -0.003729206044226885, -0.037331245839595795, -0.0033602039329707623, -0.04310465604066849, 0.013532250188291073, -0.0101753119379282, -0.002561788074672222, -0.04203357174992561, 0.01982814259827137, -0.004816618748009205, -0.005107248667627573, 0.02565380185842514, 0.011951746419072151, -0.012755060568451881, -0.024765584617853165, -0.0006216703914105892, 0.01152723003178835, -0.03396124392747879, -0.007569439243525267, 0.0002763433149084449, 0.017176553606987, 0.0011029241140931845, -0.006116289645433426, -0.04503783583641052, 0.021460894495248795, -0.001768270623870194, 0.00986835453659296, 0.0379059761762619, 0.02500070072710514, -0.01852194033563137, 0.01537399459630251, -0.019684460014104843, 0.011350893415510654, -0.006018324755132198, -0.0065375398844480515, 0.03343876451253891, 0.0059791384264826775, 0.0009869986679404974, -0.03312527760863304, -0.010717385448515415, -0.0354764387011528, 0.019318724051117897, 0.0001625608856556937, -0.01835213415324688, -0.008033140562474728, -0.006576725747436285, -0.02782209776341915, -0.018717871978878975, -0.012539536692202091, 0.027534732595086098, -0.007046958431601524, -0.00509745255112648, -0.0005681977490894496, -0.006250175181776285, 0.006870621349662542, 0.06677303463220596, -0.007798024453222752, 0.023211205378174782, -0.014577211812138557, 0.0027038375847041607, -0.0196975227445364, -0.0105018625035882, -0.028971554711461067, 0.006132617127150297, -0.04365326091647148, 0.0037422680761665106, -0.024817833676934242, -0.020141631364822388, -0.02813558652997017, 0.008536028675734997, -0.01061288919299841, -0.024164732545614243, -0.002782209776341915, 0.005695039872080088, -0.0332297720015049, 0.013780428096652031, 0.06975117325782776, -0.029938144609332085, -0.09091164171695709, -0.017881901934742928, 0.01472089346498251, 0.015217250213027, 0.009313218295574188, -0.019893452525138855, 0.012513413093984127, 0.009685485623776913, -0.002976507181301713, -0.05679365247488022, 0.0005853416514582932, 0.004388838075101376, 0.005584012717008591, -0.0004657425743062049, -0.0013837574515491724, -0.04731062799692154, -0.010083877481520176, -0.007425757125020027, 0.018574189394712448, -0.0021911533549427986, -0.019253414124250412, -0.005776677280664444, 0.011292113922536373, 0.027639228850603104, -0.01952771656215191, -0.008980137296020985, 0.03516295179724693, -0.006139148026704788, -0.0001044961391016841, 0.0027789443265646696, -0.005048469640314579, -0.02925891987979412, 0.0012686484260484576, 0.015073568560183048, -0.05266605317592621, -0.024556592106819153, 3.255299816373736e-05, 0.012833432294428349, -0.015556862577795982, 0.027978841215372086, 0.03056512027978897, -0.0408841148018837, 0.0433136485517025, -0.011618664488196373, 0.04307853430509567, -0.022375235334038734, 0.01476007979363203, -0.0065963189117610455, 0.022531980648636818, 0.001666223630309105, 0.030538996681571007, -0.0036443029530346394, 0.011664381250739098, -0.020664112642407417, -0.00932628009468317, 0.03978690505027771, -0.01508663035929203, 0.01336897537112236, -0.021500080823898315, 0.008620931766927242, -0.018117018043994904, 0.033935122191905975, 0.02044205740094185, -0.01158600952476263, -0.020716359838843346, -0.018508879467844963, -0.0026058724615722895, 0.014773141592741013, -0.03691326081752777, -0.04365326091647148, -0.01304242480546236, -0.02464802749454975, 0.019749769940972328, 0.03469271957874298, -0.0029912020545452833, 0.00131028366740793, 0.011442326940596104, 0.045586440712213516, -0.019514653831720352, 0.023276515305042267, 0.06489210575819016, -0.051803961396217346, -0.0007992322207428515, 0.007654342334717512, 0.0040590218268334866, 0.020298374816775322, 0.04221644252538681, -0.02244054526090622, -0.027534732595086098, 0.016458142548799515, 0.009202191606163979, -0.011050466448068619, 0.011977870017290115, -0.02774372510612011, 0.0049635665491223335, -0.017842715606093407, -0.045194581151008606, 0.019331786781549454, 0.04258217662572861, -0.029938144609332085, 0.019318724051117897, 0.03803659602999687, -0.03213256224989891, -0.00653100898489356, 0.02148701809346676, -0.0001904197270050645, 0.0020882899407297373, -0.007223295513540506, 0.04725838080048561, -0.018861552700400352, 0.010717385448515415, 0.014694769866764545, -0.03278566524386406, 0.014877637848258018, -0.011906028725206852, 0.03793209791183472, 0.031975820660591125, 0.024190856143832207, 0.012428510002791882, 0.017189614474773407, 0.003588789375498891, 0.008026610128581524, -0.014420467428863049, 0.032367680221796036, -0.00954180397093296, -0.02470027469098568, 0.02795271761715412, 0.03573767840862274, 0.008026610128581524, 0.002659753430634737, 0.013271009549498558, -0.02065104991197586, 0.033543262630701065, 0.0015854024095460773, -0.0008563785231672227, 0.04273892194032669, 0.029415663331747055, 0.02530112862586975, -0.06316791474819183, 0.018887678161263466, 0.027195120230317116, 0.02548399567604065, 0.02322426810860634, 0.017503103241324425, -0.016157716512680054, 0.014864576049149036, 0.008405407890677452, -0.026189345866441727, -0.04062287509441376, 0.015426242724061012, 0.031244346871972084, -0.03200194239616394, 0.009718140587210655, 0.0012506882194429636, -0.0006502435426227748, 0.025510121136903763, 0.04124985262751579, -0.04017876461148262, 0.02430841512978077, 0.01019490510225296, -0.006008528172969818, 0.02544480934739113, -0.01282690092921257, -0.018848491832613945, 0.02899767830967903, -0.024752523750066757, 0.008124575018882751, 0.007837210781872272, -0.004330058582127094, -0.0007257583783939481, -0.03087860904633999, -0.06400388479232788, 0.007262481842190027, 0.009019322693347931, 0.02860581874847412, 0.03542419150471687, 0.004774167202413082, 0.006162006873637438, 0.004659874830394983, 0.06269768625497818, -0.003103861818090081, 0.0395779125392437, -0.019292600452899933, -0.029676903039216995, 0.03414411470293999, -0.008418470621109009, 0.009724671952426434, 0.0027462891303002834, 0.026411399245262146, 0.038114968687295914, 0.020886166021227837, 0.011422734707593918, 0.0028164975810796022, 0.02569298818707466, 0.02199643664062023, -0.028370702639222145, 0.00860786996781826, 0.04906093701720238, -0.00713186152279377, -0.056375667452812195, -0.0569503977894783, 0.06426512449979782, -0.020729422569274902, -0.0051333727315068245, -0.024190856143832207, 0.02122577838599682, 0.006191396154463291, -0.02365531399846077, 0.006681222002953291, 0.04621341824531555, 0.009594052098691463, -0.016209963709115982, -0.039421167224645615, 0.012578723020851612, 0.014655583538115025, -0.042242564260959625, -0.011174555867910385, -0.008104981854557991, -0.0029846709221601486, -0.002047471236437559, -0.027430236339569092, -0.029102174565196037, -0.009104225784540176, 0.0027577185537666082, -0.013597560115158558, -0.014524963684380054, 0.02078166976571083, 0.011559885926544666, 0.010534517467021942, 0.013401630334556103, 0.006429777946323156, 0.014524963684380054, -0.018443569540977478, 0.015008257701992989, -0.03234155476093292, -0.010012036189436913, 0.008144168183207512, -0.003120189532637596, -0.007869865745306015, 0.009058509021997452, 0.039368920028209686, 0.026411399245262146, -0.011043936014175415, 0.007353915832936764, 0.025980353355407715, -0.00030430417973548174, 0.03140109032392502, 0.042765043675899506, -0.03879419341683388, -0.01206930447369814, -0.002911197254434228, 0.012879149056971073, 0.013388567604124546, 0.012128083035349846, 0.008255194872617722, -0.024674151092767715, 0.021617639809846878, 0.02983364835381508, 0.031897448003292084, -0.002230339450761676, -0.029546283185482025, 0.027456361800432205, 0.010906784795224667, -0.014995195902884007, -0.002094821073114872, -0.03518907353281975, 1.381461424898589e-05, 0.03401349484920502, 0.013068548403680325, 0.010430021211504936, -0.020324498414993286, 0.007060020696371794, -0.010162249207496643, 0.018077831715345383, -0.0006669792928732932, 0.014237599447369576, 0.0061456793919205666, -0.021317211911082268, 0.0380888432264328, 0.00762168737128377, -0.02682938426733017, -0.012977114878594875, -0.047206129878759384, -0.0209122896194458, 0.02012856863439083, -0.005038673058152199, 0.030852485448122025, -0.001528256107121706, 0.006188130937516689, 0.04104086011648178, 0.05371101573109627, 0.035659309476614, 0.006746531929820776, 0.0057505532167851925, 0.01617077738046646, -0.020533490926027298, -6.980015314184129e-05, 0.0064918226562440395, 0.005277055315673351, -0.003908808808773756, 0.044985588639974594, 0.0033863279968500137, -0.0030777379870414734, -0.013238354586064816, 0.007582501042634249, 0.020337561145424843, -0.014551087282598019, -0.02852744609117508, -0.014890699647367, -0.019449343904852867, -0.019854266196489334, -0.009626707062125206, -0.0015584619250148535, -0.0027120013255625963, 0.010874129831790924, -0.004797026049345732, -0.006370998919010162, -0.003752064425498247, -0.007824148051440716, -0.023681437596678734, 0.008379284292459488, 9.776103979675099e-05, -0.0017258190782740712, 0.03009488806128502, -0.023511631414294243, -0.014812327921390533, 0.005747287534177303, 0.0024948453065007925, 0.011899498291313648, -0.0012555863941088319, -0.008601338602602482, 0.01908360794186592, -0.009274032898247242, -0.024595778435468674, -0.037723105400800705, -0.020363684743642807, -0.049844659864902496, -0.009358935989439487, 0.0091956602409482, -0.006253440864384174, 0.021447833627462387, 0.014733956195414066, 0.026110973209142685, -0.010880660265684128, -0.008274788036942482, 0.005273789633065462, 0.013702056370675564, -0.005962810944765806, 0.0076086251065135, -0.006508150137960911, 0.066093809902668, -0.02878868579864502, -0.015465429052710533, 0.004010039381682873, -0.024491282179951668, 0.03803659602999687, 0.0012588519603013992, -0.013728180900216103, -0.02826620638370514, -0.00023144262377172709, 0.013297134079039097, 0.008549090474843979, 0.002429535146802664, 0.0031365170143544674, 0.005681977607309818, -0.011808063834905624, -0.021238841116428375, 0.023289578035473824, 0.045638687908649445, 0.03296853229403496, 0.03283791244029999, -0.006962055340409279, -0.003373265964910388, -0.007360446732491255, 0.007745776325464249, 0.0027740460354834795, -0.012317482382059097, 0.01726798713207245, -0.0035920548252761364, 0.012578723020851612, 0.012010524980723858, -0.030016515403985977, -0.028631942346692085, 0.014420467428863049, -0.05444248765707016, -0.0032867302652448416, 9.515883721178398e-05, 0.024896206334233284, -0.013362444005906582, 0.023381011560559273, 0.0053031789138913155, 0.01063248235732317, 0.0003387960896361619, 0.022414421662688255, -0.004026366863399744, 0.008457656018435955, -0.0017127570463344455, 0.020011011511087418, 0.025340314954519272, 0.02748248539865017, -0.004382306709885597, -0.007562908343970776, 0.026855507865548134, 0.008686241693794727, 0.0028148647397756577, -0.006462433375418186, 0.005407675169408321, 0.034353107213974, -0.0062632374465465546, 0.020729422569274902, -0.03780147805809975, 0.02821395732462406, -0.024425972253084183, -0.011063529178500175, 0.00713186152279377, -0.02291077934205532, 0.012768122367560863, 0.02821395732462406, -0.020193878561258316, 0.05049775913357735, -0.011233335360884666, -0.0028197630308568478, -0.028109461069107056, 0.0033895934466272593, -0.019057484343647957, 0.023603064939379692, -0.018717871978878975, 0.010207966901361942, 0.0008465819992125034, 0.04600442573428154, 0.011631726287305355, 0.006191396154463291, -0.0183913204818964, 0.010234090499579906, -0.017672909423708916, 0.016719382256269455, 0.027064500376582146, -0.00775230722501874, -0.028840934857726097, 0.03994365036487579, -0.010580234229564667, 0.029546283185482025, 0.04516845569014549, 0.013088141568005085, -0.022153181955218315, -0.007543315179646015, -0.0066616288386285305, 0.014603335410356522, 0.0021552329417318106, 0.006442840211093426, -0.02057267725467682, 0.0028491525445133448, 0.030382253229618073, -0.0019805284682661295, -0.020024072378873825, 0.026855507865548134, -0.04326140135526657, 0.0006028937641531229, 0.003647568402811885, -0.008118043653666973, 0.021160468459129333, -0.0060379174537956715, 0.018326010555028915, 0.016680195927619934, 0.0037194094620645046, 0.006155475974082947, -0.003373265964910388, 0.04203357174992561, 0.026581205427646637, -0.00988794770091772, 0.010247152298688889, -0.01734635978937149, 0.024321475997567177, 0.01080228853970766, -0.016928374767303467, 0.02126496471464634, 0.013662870042026043, -0.005969341844320297, 0.01251994352787733, -0.001385390292853117, -0.026672638952732086, 0.016471203416585922, 0.0012245641555637121, -0.0037553301081061363, 0.018443569540977478, -0.003536541247740388, -0.01508663035929203, -0.04239930957555771, -0.020468180999159813, 0.0003883909375872463, 0.01822151429951191, 0.01669325865805149, -0.019279537722468376, 0.012363199144601822, -0.01751616597175598, -0.019279537722468376, 0.014511901885271072, -0.01751616597175598, 0.03597279638051987, 0.01076310221105814, 0.000979651347734034, 0.044672101736068726, -0.006387326400727034, 0.018665622919797897, 0.021460894495248795, -0.013166513293981552, 0.009058509021997452, -0.006129351910203695, 0.02709062397480011, 0.0009755694190971553, 0.03725287318229675, -0.027665352448821068, 0.007340854033827782, 0.002158498391509056, 0.04495946317911148, 0.024412911385297775, -0.0222184918820858, 0.003405921161174774, 0.0015519309090450406, -0.005384816788136959, 0.0011845617555081844, 0.010318993590772152, 0.01280730776488781, -0.014511901885271072, 0.007275543641299009, -0.011141900904476643, -0.011951746419072151, 0.009907539933919907, -0.011181087233126163, 0.018678685650229454, -0.029102174565196037, -0.012905273586511612, 0.028710315003991127, 0.009358935989439487, 0.00965283066034317, 0.012278296053409576, 0.02109515853226185, 0.019410157576203346, 0.007275543641299009, -0.0002808333665598184, 0.011755815707147121, -0.022675663232803345, 0.022401360794901848, 0.0028736437670886517, 0.01861337572336197, 0.038585200905799866, -0.0026989392936229706, 0.004238624591380358, 0.04114535450935364, 0.019684460014104843, 0.01617077738046646, -0.005397878587245941, 0.009104225784540176, 0.02530112862586975, -0.008418470621109009, -0.009489555843174458, -0.0003702265676110983, 0.007706590462476015, 0.011292113922536373, 0.001360082533210516, 0.00029001760412938893, -0.015687482431530952, 0.014120041392743587, 0.011226803995668888, 0.007366978097707033, 0.014067793264985085, -8.806656842352822e-05, 0.027586981654167175, -0.024935390800237656, -0.024922329932451248, 0.007765369489789009, 0.0034091866109520197, 0.0017650051740929484, 0.01829988695681095, -0.0003155293525196612, 0.007523722015321255, 0.019161980599164963, 0.015204188413918018, -0.0014376383041962981, 0.003670427016913891, -0.0010898620821535587, -0.043757759034633636, 0.016105467453598976, 0.021055972203612328, 0.018234577029943466, 0.012787715531885624, 0.005704835988581181, 0.0030107949860394, 0.0012090529780834913, 0.00030736561166122556, -0.025601554661989212, 0.03503233194351196, 0.03375225514173508, -8.99034203030169e-05, -0.014067793264985085, 0.06431737542152405, 0.004166783764958382, 0.026058724150061607, -0.05538295581936836, 0.013179576024413109, 0.0034973551519215107, 0.022336050868034363, -0.004571706056594849, -0.04122372716665268, 0.04310465604066849, -0.033046904951334, 0.014603335410356522, -0.01934484764933586, -0.00013776346168015152, 0.04456760361790657, -0.021722136065363884, -0.003448372706770897, -0.006909807212650776, -0.0027577185537666082, -0.025405624881386757, 0.012343606911599636, -0.0369655080139637, 0.013688994571566582, -5.918726674281061e-05, 0.001920116599649191, 0.010162249207496643, 0.017973335459828377, 0.01934484764933586, 0.002031143754720688, 0.00010220007970929146, 0.014903762377798557, -0.0021797241643071175, 0.008686241693794727, 0.02169601060450077, -0.01604015752673149, 0.046422410756349564, -0.004375775810331106, -0.00521827582269907, 0.005489313043653965, 0.015674421563744545, -0.005234603304415941, -0.029990391805768013, -0.020298374816775322, -1.3406426660367288e-05, -0.006077103782445192, -0.04448923096060753, 0.00745841208845377, 0.014616397209465504, -0.034849461168050766, -0.011461920104920864, 0.005828925408422947, 0.019710583612322807, -0.04038775712251663, -0.020363684743642807, 0.04994915425777435, -0.03265504539012909, 0.010580234229564667, 0.013401630334556103, 0.03147946298122406, 0.05261380597949028, 0.014472715556621552, -0.023328762501478195, 0.025013763457536697, -0.0017878636717796326, 0.02251891791820526, -0.0085882768034935, -0.008385815657675266, 0.008986667729914188, 0.024034112691879272, 0.028762562200427055, 0.00388595019467175, -0.005695039872080088, -0.012735467404127121, -0.008020078763365746, 0.017072057351469994, -0.012128083035349846, -0.014773141592741013, 0.0004114535404369235, 0.012291358783841133, 0.04365326091647148, -0.0025699520483613014, -0.001809089444577694, 0.020546553656458855, 0.019540777429938316, -0.01590953767299652, 0.025810547173023224, 0.007582501042634249, 0.02460884116590023, 0.009757326915860176, -0.003676957916468382, 0.025901980698108673, -0.008144168183207512, 0.016797754913568497, 0.015805041417479515, -0.013532250188291073, -0.016993684694170952, 0.018273763358592987, -0.00986835453659296, -0.0038239057175815105, -0.008725428022444248, 0.010351648554205894, 0.007974362000823021, 0.016850002110004425, -0.004300669301301241, 0.02147395722568035, 0.03343876451253891, 0.05005365237593651, -0.010103470645844936, -0.02165682427585125, 0.011324768885970116, -0.012212986126542091, -0.0007363712647929788, -0.03142721578478813, -0.04057062789797783, -0.0016474470030516386, -0.0519084595143795, -0.010527986101806164, 0.0030712068546563387, 0.014446591027081013, 0.0036802233662456274, -0.019645273685455322, -0.022884653881192207, -0.003641037503257394, 0.015622173435986042, -0.043026287108659744, 0.03767085820436478, 0.03947341814637184, 0.01738554611802101, 0.010207966901361942, -0.027926594018936157, -0.03356938436627388, -0.033046904951334, -0.030434500426054, 0.04822496697306633, 0.005701570771634579, -0.026711825281381607, -0.031374964863061905, -0.0048525393940508366, -0.021160468459129333, -0.0021323743276298046, -0.005786473862826824, -0.004992956295609474, 0.02447822131216526, -0.009469962678849697]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"aussian mixture, reflecting real-world data complexities. The “human preference” is expressed as a bias
towards the right, as we set r= [1,0]⊤a. The KL penalty is critical in maintaining the desired behavior of
πr. By varying the values of η, we demonstrate the impact of KL regularization in (b)-(d). As ηapproaches
zero, πrincreasingly focuses on maximizing rewards, often at the expense of the pretrained data’s structure,
leading to a Gibbs distribution that potentially diverges infinitely.
In a typical LLM training pipeline, the tuning process begins with a pretrained LLM, which is subsequently
fine-tuned using specialized and instructional data, yielding an initial LLM policy denoted as π0. We will
then align the LLM on RLHF data (prompt set), which we assume is taken from a distribution x∼d0. For
preference learning, the way to gather information from the environment is to compare two different actions
under the same state. Considering this, we assume that the agent can perform a pair of actions, aligning
with precedents in existing literature (Novoseller et al., 2020; Pacchiano et al., 2021). In applications, we
want the resulting LLM πto be close to π0, and our goal is to find a policy πfrom some policy class Π to
maximize
J(π) =Ex∼d0Ea∼π(·|x)
r∗(x, a) +ηlogπ0(a|x)
π(a|x)
=Ex∼d0
Ea∼π(·|x)[r∗(x, a)]−ηDKL(π(·|x)∥π0(·|x))
,(2)
where η >0 is the KL penalty coefficient. This formulation is widely studied in practice (Ziegler et al., 2019;
Wu et al., 2021a; Ouyang et al., 2022; Rafailov et al., 2023; Liu et al., 2023a), and our paper aims to study
its theoretical property.
Usually, we have a function class Ffor approximating the ground truth r∗. Following Pacchiano et al.
(2021); Kong and Yang (2022); Zhu et al. (2023a), we make the following assumption for a clear presentation
because it suffices to illustrate our ideas and the algorithmic design in this paper can also apply to the general
case. The analysis also readily generalizes to general function class using standard complexity measures in
RL theory literature (Russo and Van Roy, 2013; Gentile et al., 2022), which essentially state that there are
some low-rank structures in reward model.
Assumption 1. Assume that the reward function is parameterized by rθ(x, a) =⟨θ, ϕ(x, a)⟩for feature
extractor ϕ:X ×A → Rd. We also assume that r∗(x, a) =⟨θ∗, ϕ(x, a)⟩for some θ∗∈Rd. For regularization,
we assume that ∥ϕ(x, a)∥ ≤1for all possible (x, a)∈ X × A and∥θ∥ ≤B. We also denote γ= 1/(2 +
exp(−B) + exp( B)).
Notation. We use ∥z∥Σto denote the induced norm√
z⊤Σzfor some positive-definite matrix. We also
define ϕ(x, π) :=Ea∼π(·|x)ϕ(x, a) to simplify the presentation. We use eOwhen we omit the logarithmic
factors. A notation table is provided in Table 4 to improve the readability of this paper.
2.2 The Insufficiency of Classic Frameworks
The classic RLHF framework adopted by Ziegler et al. (2019); Ouyang et al. (2022) can be divided into
two stages: 1) reward modeling, and 2) policy optimization against the learned reward. We summarize the
7
details of this method in this subsection.
Maximum Likelihood Estimation for reward modeling. Given a preference dataset Dconsists of
numerous tuples, such as ( x, a1, a2, y), where yis the preference signal. Specifically, y= 1 means a preference
fora1≻a2, while y= 0 indicates a1≺a2. Given a dataset","[-0.021356865763664246, -0.017194200307130814, 0.03144536912441254, -0.0124283442273736, 0.03918739780783653, 0.0005874463822692633, -0.0069731296971440315, 0.061246879398822784, -0.01651809737086296, 0.06702689081430435, 0.004165980964899063, -0.04274024814367294, 0.007470263168215752, 0.02076030522584915, 0.02467109076678753, -0.03743748739361763, 0.04083125293254852, -0.013893231749534607, -0.004613401368260384, 0.04356217384338379, -0.036774642765522, -0.03582014515995979, 0.016571125015616417, 0.03269151598215103, -0.013071304187178612, -0.016107134521007538, 0.02921820804476738, 0.03468004986643791, -0.008656756021082401, -0.017578650265932083, 0.041547127068042755, -0.029032612219452858, -0.03295665606856346, -0.02023003064095974, -0.017194200307130814, 0.025572560727596283, 0.01647832803428173, 0.061618074774742126, -0.03958510607481003, 0.018413834273815155, -0.022231822833418846, -0.04114941880106926, -0.033937666565179825, 0.02164851874113083, -0.022510217502713203, 0.022258335724473, 0.01946112886071205, 0.021555719897150993, -0.0036688472609966993, 0.04228951409459114, -0.0820867270231247, 0.01678323559463024, -0.005070764571428299, 0.012845936231315136, 0.02597026713192463, 0.018917595967650414, 0.03778216615319252, 0.00314022833481431, 0.031604450196027756, 0.011082768440246582, 0.013303299434483051, -0.023146547377109528, 0.025135083124041557, 0.02573164366185665, -0.008895380422472954, -0.026407744735479355, -0.07726121693849564, 0.030915090814232826, 0.012607311829924583, 0.08484416455030441, 0.035740602761507034, -0.03383161127567291, 0.05178145319223404, -0.0012792908819392323, -0.020985674113035202, 0.015311719849705696, 0.019739525392651558, 0.03674812614917755, 0.00814636517316103, -0.003083886345848441, 0.02278861217200756, -0.031100688502192497, 0.02244393154978752, -0.03247940540313721, -0.012209605425596237, -0.07561735808849335, -0.02406127378344536, -0.00998244620859623, -0.032028671354055405, -0.03595271334052086, 0.007225010544061661, -0.024525266140699387, -0.043535660952329636, 0.019487643614411354, 0.048626311123371124, 0.008080081082880497, 0.003609191160649061, -0.012309031561017036, 0.016451813280582428, 0.009896276518702507, -0.005395558662712574, -0.03958510607481003, -0.003027544589713216, -0.01641204208135605, 0.029615916311740875, -0.017605163156986237, -0.03070298209786415, 0.05323971062898636, -0.020561452955007553, -0.02799857407808304, -0.03992978483438492, -0.012521142140030861, -0.04865282401442528, 0.020256543532013893, 0.0054055009968578815, -0.0410698764026165, -0.08346544206142426, -0.0053789871744811535, -0.018997138366103172, 0.010691690258681774, -0.02076030522584915, -0.04401290789246559, 0.030464356765151024, -0.002389556262642145, 0.007682373747229576, -0.01128162257373333, 0.013018276542425156, -0.04920961335301399, 0.002051505260169506, -0.013091188855469227, -0.004103010520339012, 0.030835550278425217, -0.004291921388357878, -0.0510125532746315, -0.05785311385989189, 0.0011682643089443445, 0.014198140241205692, 0.0033970808144658804, -0.01797635667026043, -0.04303189739584923, -0.0039472421631217, -0.02137012407183647, -0.04618703946471214, 0.008762811310589314, -0.05732283741235733, 0.04228951409459114, -0.009485311806201935, 0.01525869220495224, -0.022549986839294434, 0.01151361782103777, 0.016663923859596252, 0.006399768870323896, -0.01370763499289751, 0.009796849451959133, -0.026129350066184998, -0.04130849987268448, -0.015192408114671707, 0.015656398609280586, 0.020283058285713196, -0.02367682382464409, 0.0033805095590651035, 0.06183018162846565, 0.003126971423625946, -0.018678972497582436, 0.031074173748493195, 0.022536730393767357, -0.03637693449854851, 0.006678163539618254, -0.030915090814232826, -0.021131498739123344, -0.007596204057335854, -0.008093337528407574, -0.0527624636888504, -0.019434615969657898, 0.002034934237599373, -0.015378004871308804, -0.01568291336297989, -0.03205518424510956, 0.018228238448500633, -0.034547481685876846, 0.008424759842455387, 0.0004312635282985866, -0.029934080317616463, 0.00419580889865756, -0.006562165915966034, 0.03446793928742409, -0.020243287086486816, -0.02516159787774086, 0.014516306109726429, 0.029244722798466682, 0.028661418706178665, 0.059709079563617706, 0.05202007666230202, -0.02000466361641884, -0.017750989645719528, -0.002005106071010232, 0.04867933690547943, 0.05663347989320755, 0.0069466158747673035, 0.02329237386584282, -0.007039414253085852, 0.011858297511935234, 0.019553927704691887, -0.0976768434047699, 0.024339668452739716, 0.019686497747898102, 0.0324263796210289, 0.023239346221089363, -0.06389825791120529, -0.012209605425596237, -0.007039414253085852, -0.002808805787935853, 0.05997421592473984, 0.02964242920279503, -0.028078114613890648, 0.026222148910164833, -0.02516159787774086, 0.0025917240418493748, -0.010022216476500034, 0.06119385361671448, 0.00825904868543148, 0.008438017219305038, 0.025519533082842827, 0.004997851327061653, -0.09184380620718002, -0.018533146008849144, 0.02382265031337738, -0.037994276732206345, 0.030968118458986282, -0.023385172709822655, 0.06023935601115227, 0.025877470150589943, -0.023915449157357216, -0.02233787626028061, -0.0010738088749349117, -0.0021907028276473284, -0.01283267978578806, -0.01690254732966423, 0.03247940540313721, -0.029456833377480507, 0.00401684083044529, 0.029721971601247787, 0.00041759235318750143, 0.00576343759894371, 0.02213902398943901, 0.04313795268535614, -0.004116267431527376, 0.0032628546468913555, -0.0004182137781754136, -0.034627024084329605, 0.030225733295083046, -0.010506093502044678, -0.01070494670420885, -0.03070298209786415, -0.05626228451728821, 0.030649954453110695, -0.031100688502192497, 0.004291921388357878, -0.024618063122034073, 0.0036423334386199713, -0.029615916311740875, 0.010519350878894329, 0.024260127916932106, 0.04122896119952202, 0.0008070138283073902, -0.04226299747824669, -0.039558589458465576, -0.008882123045623302, 0.0023680138401687145, 0.0010373524855822325, -0.009843248873949051, -0.007152097765356302, -0.045868873596191406, 0.016690436750650406, -0.03905482962727547, -0.042077403515577316, 0.08102617412805557, 0.04374777153134346, -0.03311573714017868, 0.012454858049750328, -0.05578503757715225, 0.010194556787610054, 0.09025298058986664, 0.004812255036085844, 0.029350778087973595, -0.011023112572729588, -0.011878183111548424, -0.00444437563419342, -0.06289073824882507, -0.01736653968691826, -0.002245387528091669, -0.04173272103071213, 0.015364747494459152, -0.02294769510626793, 0.04356217384338379, 0.014529562555253506, -0.012083664536476135, -0.04345611855387688, 0.003529649693518877, 0.03666858747601509, 0.03658904507756233, 0.009896276518702507, -0.019023651257157326, -0.0022619585506618023, -0.016120390966534615, 0.024154072627425194, 0.02818416990339756, -0.012839308008551598, -0.001304147532209754, 0.03433537110686302, 0.00316508486866951, 0.017697962000966072, 0.015775712206959724, 0.03619133681058884, -0.013541923835873604, -0.034202802926301956, 0.05323971062898636, 0.011533503420650959, -0.004424490500241518, -0.009286458604037762, -0.043615203350782394, -0.04687640070915222, 0.008338590152561665, -0.023146547377109528, 0.036005742847919464, -0.0098299914970994, -0.020601222291588783, -0.00769563065841794, -0.027972059324383736, -0.02406127378344536, 0.014887498691678047, -0.007755286525934935, 0.019182734191417694, 0.011805269867181778, 0.04069868475198746, -0.017114657908678055, -0.0462665818631649, 0.037994276732206345, 0.014914012514054775, 0.036615557968616486, -0.05058833211660385, -0.02298746444284916, -0.028847014531493187, 0.021051958203315735, -0.01303816121071577, 0.05127768963575363, 0.017340024933218956, 0.013223757967352867, 0.016571125015616417, 0.03871015086770058, -0.023955218493938446, -0.020031176507472992, -0.011354534886777401, 0.011142425239086151, -0.019381588324904442, -0.0030988005455583334, 0.0014723445056006312, -0.08054892718791962, -0.029721971601247787, 0.004384719766676426, -0.007370836567133665, 0.0016173418844118714, 0.011699214577674866, -0.015656398609280586, -0.02187388576567173, 0.023265860974788666, -0.0039372993633151054, -0.014715159311890602, -0.016862777993083, -0.0033771954476833344, 0.0016131990123540163, -0.013787176460027695, -0.04303189739584923, 0.011639558710157871, -0.027627380564808846, -0.008517558686435223, 0.05180796608328819, 0.012607311829924583, 0.02394196204841137, 0.005869492422789335, -0.0006143744685687125, 0.02144966460764408, 0.005601040553301573, -0.03621785342693329, 0.02558581717312336, 0.016186675056815147, -0.03613831102848053, -0.023623796179890633, -0.028210684657096863, 0.011632930487394333, 0.023915449157357216, 0.008345218375325203, -0.005372358951717615, 0.0008699840982444584, -0.012063778936862946, -0.011825155466794968, -0.026712654158473015, 0.04160015285015106, 0.05721678212285042, 0.018387321382761, -0.03958510607481003, -0.032187752425670624, -0.0261558648198843, 0.002051505260169506, -0.01500681135803461, -0.005862864200025797, -0.00764923170208931, 0.038948774337768555, 0.010989970527589321, 0.03770262375473976, 0.04913007467985153, -0.034706566482782364, 0.015815481543540955, -0.038869231939315796, 0.0025668672751635313, -0.01832103542983532, 0.01348226796835661, 0.010539235547184944, 0.019978148862719536, 0.06289073824882507, 0.021622003987431526, -0.006552223116159439, 0.0084313889965415, 0.002503897063434124, -0.0011790356365963817, 0.014834471978247166, 0.05949696898460388, -0.016305986791849136, -0.01568291336297989, -0.03356647118926048, -0.014198140241205692, 0.05013759806752205, 0.027256187051534653, -0.024922972545027733, -0.06819349527359009, 0.003824615851044655, 0.015775712206959724, -0.002152589149773121, -0.0036125052720308304, -0.040672171860933304, 0.052523840218782425, 0.014860985800623894, -0.04899750277400017, 0.027136875316500664, -0.008345218375325203, 0.03871015086770058, -0.00187419424764812, -0.012461486272513866, 0.010280726477503777, -0.014078828506171703, -0.04342960566282272, 0.004225636832416058, 0.0647997260093689, 0.003874329151585698, -0.0005572040681727231, -0.027812976390123367, 0.09290435910224915, 0.005458528641611338, -0.004126210231333971, -0.004639915190637112, -0.008444645442068577, 0.01216320600360632, 0.005137049127370119, -0.005723666865378618, -0.00034737223177216947, 0.016425300389528275, 0.009472055360674858, -0.020866360515356064, -0.02966894395649433, 0.012149949558079243, -0.020468654111027718, -0.05721678212285042, 0.04570979252457619, -0.03200215846300125, -0.029801512137055397, 0.004165980964899063, 0.02069402113556862, -0.016385529190301895, 0.07307203859090805, 0.00025022399495355785, 0.017618421465158463, 0.012050522491335869, 0.0062141721136868, -0.005783322732895613, 0.045418139547109604, 0.051914021372795105, 0.05215264484286308, -0.02990756742656231, -0.012673596851527691, -0.002638123231008649, 0.0031286284793168306, -0.026792196556925774, 0.02791903167963028, -0.014847728423774242, -0.007145469542592764, -0.03303619474172592, 0.007781800348311663, -0.022669300436973572, 0.0039770700968801975, -0.003526335582137108, 0.048361171036958694, -0.03404372185468674, 0.008961664512753487, 0.015484059229493141, 0.005216590128839016, 0.031259771436452866, 0.0026165808085352182, -0.04297887161374092, -0.016995346173644066, 0.04631961137056351, -0.028290225192904472, 0.004381405655294657, -0.022006453946232796, 0.047592271119356155, -0.004467575345188379, 0.02072053588926792, -0.03648298978805542, -0.03369903936982155, -0.014118598774075508, 0.05024365335702896, -0.006615193095058203, 0.001773110474459827, -0.04764530062675476, 0.0014822871889919043, 0.0024608122184872627, 0.04003584012389183, -0.025479761883616447, -0.08723040670156479, -0.027945546433329582, -0.036960236728191376, 0.032983168959617615, 0.003924042452126741, 0.02023003064095974, 0.030066650360822678, -0.005730295088142157, -0.006807418540120125, -0.018108926713466644, -0.04313795268535614, 0.008371732197701931, -0.024869944900274277, -0.0052331616170704365, -0.000593246310018003, -0.020243287086486816, 0.047088511288166046, 0.010280726477503777, -0.032983168959617615, 0.035316381603479385, 0.015311719849705696, 0.007980654016137123, 0.027521325275301933, 0.027123618870973587, -0.03812684491276741, -0.03499821573495865, -0.021887142211198807, -0.026089580729603767, 0.028634903952479362, -0.011347906664013863, 0.030994633212685585, -0.014184883795678616, -0.0024226985406130552, -0.029721971601247787, 0.0028568620327860117, -0.015895023941993713, 0.011102654039859772, -0.03873666375875473, -0.004033411853015423, 0.02199319750070572, -0.007947511970996857, 0.017843788489699364, 0.016624152660369873, -0.012739880941808224, 0.020906131714582443, 0.047327134758234024, -0.04441061615943909, -0.003325824858620763, -0.009969188831746578, 0.018374063074588776, -0.009717307984828949, 0.013813690282404423, 0.006379883270710707, -0.04608098417520523, -0.051834478974342346, -0.03001362271606922, -0.04875887930393219, -0.027786463499069214, -0.005896006245166063, -0.000478491245303303, 0.0035859914496541023, -0.06204229220747948, 0.004096382297575474, 0.03772914037108421, -0.04446364566683769, -0.01552383042871952, 0.00466642901301384, -0.04539162665605545, 0.010711575858294964, -0.015470802783966064, 0.0014143455773591995, -0.013276785612106323, -0.037384457886219025, 0.026566827669739723, 0.024034760892391205, -0.017910072579979897, -0.02940380573272705, -0.023544255644083023, 0.05072090029716492, -0.02264278568327427, 0.006578736938536167, 0.015484059229493141, -0.011115911416709423, -0.0065721082501113415, -0.002195674227550626, 0.007954140193760395, -0.005929148755967617, -0.023650310933589935, -0.03640344738960266, -0.0028634904883801937, -0.012368688359856606, 0.03950556367635727, -0.00574686611071229, -0.025029027834534645, -0.0006429596687667072, 0.017578650265932083, -0.004702885635197163, -0.004987908992916346, -0.008418131619691849, -0.022165536880493164, -0.008404875174164772, 0.020548196509480476, -0.019129706546664238, -0.04133501648902893, -0.009140633046627045, 0.01434396579861641, 0.006144573446363211, 0.006737819407135248, -0.0067113060504198074, 0.016876034438610077, -0.022695813328027725, 0.009518454782664776, -0.02229810692369938, 0.02668614126741886, 0.038524553179740906, 0.006187658291310072, -0.053292740136384964, 0.040327489376068115, 0.014436764642596245, -0.00047476275358349085, 0.016465069726109505, -0.021515948697924614, -0.036695100367069244, -0.03189610317349434, -0.02126406878232956, 0.009008063934743404, -0.023159805685281754, 0.03234683722257614, 0.01801612786948681, 0.002989431144669652, -0.011732356622815132, 0.0024342983961105347, -0.01137442048639059, -0.015444288961589336, -0.01227588951587677, 0.0019951635040342808, 0.002071390626952052, 0.003191598691046238, 0.03714583441615105, 0.01958044245839119, 0.05064135789871216, -0.013601579703390598, 0.003970441874116659, -0.023345401510596275, 0.011904696933925152, 0.006088231690227985, -0.007012900430709124, -0.03086206503212452, -0.028979584574699402, -0.012110178358852863, -0.002604980953037739, -0.03719886392354965, -0.010307240299880505, -0.022085996344685555, -0.0039472421631217, -0.03664207085967064, -0.03987675532698631, -0.016756722703576088, -0.0064130257815122604, 0.04003584012389183, -0.021807601675391197, -0.0012610626872628927, 0.011765498667955399, -0.009803477674722672, -0.007960768416523933, 0.011089397594332695, -0.026818709447979927, 0.01361483708024025, 0.041122905910015106, -0.004152724053710699, 0.05013759806752205, -0.019089937210083008, -0.028581878170371056, -0.019911864772439003, 0.03425583243370056, -0.010545864701271057, 0.004437747411429882, -0.03144536912441254, -0.029881052672863007, -0.015046581625938416, 0.02688499353826046, 0.038869231939315796, -0.030331788584589958, -0.012686853297054768, -0.033062711358070374, 0.0024475553072988987, 0.0263547170907259, 0.002886689966544509, 0.005415443796664476, 0.03913436830043793, 0.008484416641294956, -0.004865282215178013, -0.004905052948743105, -0.048811908811330795, -0.009140633046627045, -0.03338087350130081, 0.033168766647577286, -0.004285293165594339, 0.017485851421952248, -0.051145121455192566, 0.013296671211719513, -0.016836263239383698, 0.005896006245166063, 0.022430675104260445, 0.017883557826280594, -0.006867074407637119, -0.013117702677845955, -0.007781800348311663, 0.01641204208135605, -0.020587965846061707, 0.002018362982198596, -0.014039057306945324, 0.01370763499289751, 0.008802581578493118, -0.025758156552910805, -0.03059692680835724, 0.01942135952413082, 0.008789325132966042, 0.0091936606913805, 0.03070298209786415, 0.02030957117676735, 0.0032959969248622656, 0.01582873985171318, -0.027600865811109543, 0.011427448131144047, -0.008941778913140297, 0.026063065975904465, 0.034202802926301956, -0.00801379606127739, -0.0013165759155526757, -0.02966894395649433, -0.0027972059324383736, -0.021595491096377373, -0.00883572455495596, 0.03383161127567291, -0.014158369973301888, 0.01552383042871952, -0.011487103998661041, -0.04014189541339874, -0.01629273034632206, -0.031949128955602646, 0.03051738440990448, -0.021595491096377373, 0.019898608326911926, -0.01254102773964405, -0.007980654016137123, 0.019514156505465508, 0.06904193758964539, -0.017273740842938423, 0.012938735075294971, -0.02542673423886299, -0.008802581578493118, -0.00022868152882438153, -0.012189719825983047, -0.008689898066222668, 0.023796135559678078, -0.08166250586509705, -0.026606598868966103, -0.011719100177288055, -0.008749553933739662, -0.017565393820405006, -0.006993014831095934, -0.04125547409057617, -0.015020067803561687, 0.005302760284394026, -0.006542280316352844, -0.015470802783966064, 0.013130960054695606, 0.07105698436498642, -0.03070298209786415, -0.08845003694295883, -0.01309781800955534, 0.025095311924815178, 0.005939091555774212, 0.004686314146965742, -0.016756722703576088, 0.022762097418308258, 0.0014731730334460735, -0.005657382309436798, -0.04764530062675476, -0.004335006233304739, -0.010366896167397499, 0.008345218375325203, 0.02134360931813717, -0.0014698588056489825, -0.04311143979430199, 0.0005795751349069178, 0.0009196974569931626, 0.022271592170000076, 0.004679685924202204, -0.019434615969657898, -0.008762811310589314, 0.008497673086822033, 0.03828592970967293, -0.005799893755465746, -0.008882123045623302, 0.03544895350933075, -0.008418131619691849, 0.02868793159723282, -0.0021807600278407335, 0.0005915891961194575, -0.05048227682709694, 0.013893231749534607, 0.02581118419766426, -0.045524194836616516, 0.011115911416709423, -0.005395558662712574, 0.003609191160649061, -0.00908097717911005, 0.03526335582137108, 0.010187927633523941, -0.04692942649126053, 0.04083125293254852, -0.023491227999329567, 0.04995200037956238, -0.03552849218249321, 0.019368331879377365, -0.006456110626459122, 0.006761019118130207, -0.01283267978578806, 0.01732676848769188, -0.01773773320019245, 0.02138338051736355, -0.03961161896586418, -0.0032761115580797195, 0.026261920109391212, 0.010293982923030853, 0.02390219084918499, -0.017101401463150978, 0.015218921937048435, -0.03733143210411072, 0.009816735051572323, 0.007278038188815117, -0.005137049127370119, -0.02956288866698742, -0.004361520055681467, -0.004434433300048113, 0.006820675451308489, -0.03966464474797249, -0.04740667715668678, -0.008418131619691849, -0.01447653491050005, -0.004689628724008799, 0.052099619060754776, -0.01602759212255478, -0.00044493473251350224, 0.01543103251606226, 0.04114941880106926, -0.03924042358994484, 0.0324263796210289, 0.036774642765522, -0.04385382682085037, -0.013800432905554771, 0.0043648346327245235, 0.021887142211198807, 0.03173701837658882, 0.030835550278425217, -0.023106778040528297, -0.04215694218873978, 0.02826371230185032, 0.02489645965397358, 0.007622717879712582, 0.020017920061945915, -0.0259304977953434, 0.012521142140030861, -0.03067646734416485, -0.03078252263367176, 0.02343820035457611, 0.03086206503212452, -0.014927269890904427, 0.007907740771770477, 0.053902555257081985, -0.01122196577489376, -0.004828826058655977, 0.015165894292294979, 0.007708887569606304, 0.01074471790343523, 0.020057689398527145, 0.03754354268312454, -0.00981010589748621, -0.0098299914970994, 0.023186318576335907, -0.050535302609205246, 0.004954766482114792, -0.00433169212192297, 0.023385172709822655, 0.030756009742617607, 0.03528986871242523, 0.01927553303539753, -0.012719996273517609, -0.0019255648367106915, -0.009392513893544674, 0.009266573004424572, 0.02589072659611702, -0.008457902818918228, -0.022192051634192467, 0.005402186885476112, 0.03070298209786415, -0.009259944781661034, 0.010380152612924576, 0.03102114610373974, 0.004000269807875156, 0.042422082275152206, -0.0008964978624135256, -0.004308492410928011, 0.02053493820130825, 0.030994633212685585, 0.016610896214842796, -0.033407390117645264, 0.019408103078603745, 0.016040848568081856, 0.018798284232616425, 0.01755213551223278, 0.032797571271657944, -0.011208709329366684, 0.028078114613890648, 0.00856395810842514, -0.018188467249274254, -0.024313155561685562, 0.00408312538638711, 0.017353283241391182, -0.03810033202171326, 0.01724722795188427, -0.004126210231333971, -0.003257883246988058, 0.004822197370231152, 0.03441491350531578, -0.02374310791492462, 0.02489645965397358, 0.028740959241986275, 0.01582873985171318, 0.017141172662377357, -0.0072448961436748505, -0.011639558710157871, 0.03770262375473976, -0.028131142258644104, -0.004086439497768879, -0.025983525440096855, -0.004023469053208828, 0.017697962000966072, -0.01422465406358242, -0.07217056304216385, 0.0009105833596549928, 0.010824259370565414, -0.00045943446457386017, 0.013866717927157879, 0.0007063442026264966, 0.0198853500187397, 0.005783322732895613, 0.041626665741205215, 0.009419027715921402, 0.02558581717312336, -0.02489645965397358, -0.015417775139212608, 0.0427667610347271, 0.0015618285397067666, 0.013349698856472969, -0.01586850918829441, 0.013429240323603153, 0.028634903952479362, 0.01590828038752079, 0.018864570185542107, 0.03144536912441254, 0.020786819979548454, 0.028900042176246643, -0.02585095539689064, -0.008650127798318863, 0.04748621582984924, 0.007735401391983032, -0.03916088491678238, -0.047671813517808914, 0.05732283741235733, 1.5638999684597366e-05, 0.0018178524915128946, -0.03171050548553467, 0.0328771136701107, 0.018944110721349716, -0.02627517655491829, 0.020853104069828987, 0.012872450053691864, 0.0016571125015616417, -0.018983881920576096, -0.01870548725128174, 0.01992512121796608, 0.008848981000483036, -0.032214269042015076, 0.003352338680997491, -0.010824259370565414, -0.032903626561164856, -0.003804730484262109, -0.01409208495169878, -0.028290225192904472, 0.01361483708024025, 0.018758514896035194, 0.010453065857291222, 0.004126210231333971, 0.01777750253677368, 0.006197601091116667, 0.006535652093589306, 0.015020067803561687, 0.013164102099835873, 0.028210684657096863, -0.030649954453110695, -0.022470446303486824, -0.01935507543385029, -0.03404372185468674, 0.0024077845737338066, 0.010738089680671692, 0.00012138349120505154, 0.008822467178106308, 0.04167969524860382, 0.007072556298226118, -0.031153716146945953, -0.006055089179426432, 0.018559660762548447, -0.006373255047947168, 0.029350778087973595, 0.05241778492927551, -0.03985024243593216, -0.004093068186193705, -0.005282874684780836, 0.024180585518479347, 0.02646077238023281, -0.00010243026918033138, -0.0026795510202646255, -0.010042102076113224, 0.0032363408245146275, 0.038418497890233994, 0.0402214340865612, -0.01682300679385662, -0.03104766085743904, 0.013641350902616978, -0.003798102028667927, -0.036085281521081924, -0.008941778913140297, -0.030040135607123375, 0.01240845862776041, 0.03640344738960266, -0.013760662637650967, -0.015815481543540955, -0.019209248945116997, 0.008086709305644035, -0.00023986704763956368, 0.009922790341079235, 0.0022619585506618023, 0.022576501592993736, 0.01000233180820942, -0.013124331831932068, 0.025705130770802498, 0.003103771712630987, -0.02469760552048683, -0.029934080317616463, -0.042422082275152206, -0.025837698951363564, 0.020680764690041542, -0.008438017219305038, 0.028979584574699402, -0.002392870606854558, -0.003352338680997491, 0.020521681755781174, 0.04610750079154968, 0.03735794499516487, 0.009617880918085575, 0.010797745548188686, 0.019739525392651558, -0.03364601358771324, -0.014489792287349701, 0.004533859901130199, 0.008378361351788044, -0.002107847249135375, 0.039558589458465576, -0.002742521231994033, 0.0060915458016097546, 0.01781727373600006, 0.00316508486866951, 0.027653893455863, -0.00931297242641449, 0.01525869220495224, -0.02783949114382267, -0.02489645965397358, -0.02905912511050701, -0.013376212678849697, -0.0029546315781772137, -0.0001456187601434067, 0.02654031477868557, -0.008312076330184937, -0.019646726548671722, -0.009723936207592487, -0.012189719825983047, -0.020853104069828987, -0.00017544679576531053, 0.006704677361994982, -0.018824798986315727, 0.021701546385884285, -0.026328204199671745, -0.010466323234140873, 0.014277681708335876, -0.0020399056375026703, 0.013972773216664791, -0.015444288961589336, -0.0008065995061770082, 0.05403512716293335, -0.0014673731056973338, -0.01191132515668869, -0.015815481543540955, -0.009346114471554756, -0.05689861625432968, -0.011029740795493126, -0.008418131619691849, -0.0029910882003605366, 0.04226299747824669, 0.00762934610247612, 0.016186675056815147, -0.022046225145459175, -0.016690436750650406, 0.007344322744756937, 0.022974207997322083, 0.002969545777887106, 0.004381405655294657, -0.022284850478172302, 0.0605044923722744, -0.016610896214842796, -0.025413477793335915, -0.00013816176215186715, -0.031074173748493195, 0.04547116905450821, -0.004702885635197163, -0.005349159240722656, -0.013124331831932068, 0.005760123021900654, 0.002112818416208029, 0.031683992594480515, 0.0030822292901575565, 0.004818883258849382, 0.013349698856472969, -0.02435292676091194, -0.0201107170432806, 0.019487643614411354, 0.03388463705778122, 0.02581118419766426, 0.048732366412878036, -0.011599787510931492, -0.0014930584002286196, -0.01254102773964405, 0.018135439604520798, 0.0009718965156935155, -0.0319756455719471, 0.00014313308929558843, -0.014821214601397514, 0.0034799363929778337, -0.008650127798318863, -0.01671695150434971, -0.035740602761507034, 0.019447872415184975, -0.038179874420166016, -0.0048089404590427876, 0.002218873705714941, 0.012421716004610062, -0.010618777014315128, 0.018188467249274254, -1.752914431563113e-05, 0.0027176644653081894, -0.029615916311740875, 0.017048373818397522, -0.006237371824681759, 0.0018261380027979612, 0.010625405237078667, 0.026527058333158493, 0.015152636915445328, 0.04027446359395981, -0.012123435735702515, -0.008802581578493118, 0.01976603828370571, -0.000576675171032548, -0.010811001993715763, -0.01435722317546606, 0.0004097210767213255, 0.0224837027490139, -0.004165980964899063, 0.015470802783966064, -0.03725188970565796, 0.0059622908011078835, -0.025718387216329575, -0.009206917136907578, 0.019606955349445343, -0.029695456847548485, -0.0006529023521579802, 0.025903983041644096, 0.004752598702907562, 0.04350914806127548, -0.02034934237599373, -0.006144573446363211, -0.02887352928519249, 0.017353283241391182, -0.019779294729232788, 0.03112720139324665, -0.015550344251096249, 0.005451900418847799, -2.6565585358184762e-05, 0.008305448107421398, 0.001193121075630188, 0.01100985612720251, -0.01602759212255478, 0.019991405308246613, -0.005345845129340887, 0.013734148815274239, 0.033248305320739746, 0.015470802783966064, -0.024273384362459183, 0.03311573714017868, -0.011745613999664783, 0.02416732907295227, 0.045179516077041626, 0.0025585817638784647, -0.008557328954339027, -0.02106521464884281, 0.017804017290472984, 0.030756009742617607, -0.0066748494282364845, 0.00841150339692831, -0.014158369973301888, 0.008358475752174854, 0.02087961882352829, 0.00020558552932925522, -0.022549986839294434, 0.015576858073472977, -0.05228521674871445, 0.002886689966544509, 0.012454858049750328, -0.004543802700936794, 0.019089937210083008, -0.00801379606127739, 0.023928705602884293, 0.012706738896667957, 0.00614788755774498, -0.002245387528091669, -0.03690721094608307, 0.017843788489699364, -0.002601666608825326, -0.027017563581466675, 0.005922520067542791, -0.0065721082501113415, 0.020296314731240273, -0.0028303482104092836, 0.004315121099352837, 0.0025088684633374214, -0.0010530949803069234, -0.014012543484568596, 0.0010472951689735055, 0.0031087431125342846, -0.034786105155944824, 0.02836976759135723, 0.0011525218142196536, -0.0013356327544897795, 0.013455754145979881, 0.00047269134665839374, -0.018944110721349716, -0.037039779126644135, -0.021781086921691895, -0.007317808922380209, 0.025718387216329575, 0.010910429060459137, -0.015192408114671707, 0.02428664080798626, -0.0022636158391833305, -0.030543899163603783, 0.013362955302000046, -0.017684705555438995, 0.021820858120918274, 0.01659763976931572, -0.0185861736536026, 0.03571408987045288, -0.013813690282404423, 0.03460051119327545, 0.019023651257157326, -0.018997138366103172, -0.004868596792221069, -0.007026157341897488, 0.0056772674433887005, -0.002641437342390418, 0.06586027890443802, -0.022775355726480484, 0.001301661948673427, 0.005475099664181471, 0.05483053997159004, 0.02964242920279503, -0.019487643614411354, -0.018678972497582436, -0.019832322373986244, 0.01487424224615097, -0.0012312346370890737, 0.0022172166500240564, 0.023716595023870468, -0.024538522586226463, 0.0004387205408420414, -0.01759190671145916, -0.005892692133784294, -0.0008550700731575489, -0.007960768416523933, 0.02871444635093212, -0.022576501592993736, -0.010426552034914494, 0.02015048824250698, 0.0028850329108536243, 0.01529846340417862, 6.654342723777518e-05, 0.014251167885959148, 0.01231566071510315, -0.0029745169449597597, -0.009001435711979866, 0.0026530371978878975, -0.023809393867850304, 0.04226299747824669, -0.008842352777719498, 0.027203159406781197, 0.030543899163603783, 0.0045736306346952915, 0.0248566884547472, 0.04427804797887802, 0.018254751339554787, 0.013011647388339043, -0.02998710796236992, 0.01969975419342518, 0.023650310933589935, -0.014675389043986797, -0.005932462867349386, 0.006157830357551575, 0.022152280434966087, -0.0098299914970994, -0.006525709293782711, 0.025705130770802498, -0.01568291336297989, 0.01552383042871952, 0.015775712206959724, 0.02386242151260376, 0.022854896262288094, -0.0009420684655196965, 0.0248566884547472, -0.03855106607079506, -0.03380509465932846, 0.002044876804575324, 0.0005849607405252755, -0.002901604166254401, 0.004802312236279249, -0.02566535957157612, 0.01399928703904152, 0.03319527953863144, 0.007205125410109758, 0.020389113575220108, 0.022841639816761017, 0.008636870421469212, -0.029324263334274292, 0.006359998136758804, 0.015696169808506966, 0.005796579644083977, 0.001009181491099298, -0.005511556286364794, 0.008802581578493118, -0.010598891414701939, 0.007602832280099392, -0.029006097465753555, 0.034706566482782364, 0.025055542588233948, 5.199190491111949e-05, 0.011142425239086151, 0.06167110055685043, 0.006217486225068569, 0.022284850478172302, -0.06039843708276749, 0.011400934308767319, -0.01885131187736988, -0.003917414229363203, -0.017870301380753517, -0.041467584669589996, 0.06548909097909927, -0.02749481052160263, 0.009816735051572323, -0.007549804635345936, -0.013124331831932068, 0.05594411864876747, -0.0033937664702534676, 0.009690794162452221, 0.0045471168123185635, 0.00021604604262392968, -0.009949304163455963, 0.025413477793335915, -0.03735794499516487, 0.026301691308617592, -0.014556076377630234, -0.012010752223432064, -0.001887451158836484, 0.02406127378344536, -0.007682373747229576, -0.00484871119260788, 0.009704051539301872, 0.022496959194540977, 0.00581315066665411, 0.012998390942811966, 0.02623540535569191, -0.015364747494459152, 0.03239986300468445, 0.008749553933739662, -0.013475638814270496, 0.0004639915132429451, 0.015802225098013878, 0.008053567260503769, -0.03078252263367176, -0.0030043451115489006, 0.010240955278277397, 0.005123792216181755, -0.04409245029091835, 0.01361483708024025, 0.02416732907295227, -0.03905482962727547, -0.0036622188054025173, 0.007821571081876755, 0.016955574974417686, -0.029536373913288116, -0.011937838979065418, 0.03343390300869942, -0.012209605425596237, -0.001550228800624609, 0.0157624538987875, 0.028237197548151016, 0.04329703748226166, 0.02049516886472702, -0.017340024933218956, 0.01399928703904152, -0.006939987186342478, 0.026513800024986267, 0.017843788489699364, 0.00576343759894371, 0.020667508244514465, 0.018268009647727013, 0.022152280434966087, 0.00916051771491766, -0.004079811275005341, 0.003179999068379402, -0.006953244097530842, 0.023279117420315742, -0.00042401367682032287, -0.004620029591023922, -0.0033738811034709215, 0.014304195530712605, 0.03510427102446556, -0.0077287727035582066, -0.005302760284394026, 0.02500251494348049, 0.007702259346842766, -0.010174671187996864, 0.005902634933590889, 0.021197782829403877, 0.024830173701047897, 0.012554285116493702, -0.017313512042164803, 0.03176353499293327, 0.002389556262642145, 0.01007524412125349, 0.018427090719342232, -0.021635262295603752, -0.021462921053171158, 0.01478144433349371, -0.017393052577972412, -0.00010325882612960413, -0.006257256958633661, 0.004855339881032705, -0.005309388507157564, 0.025055542588233948, 0.0036456475500017405, 0.025996781885623932, 0.03950556367635727, 0.012454858049750328, -0.022430675104260445, -0.03568757697939873, 0.0025188110303133726, -0.003077257890254259, -0.013641350902616978, -0.030968118458986282, -0.036695100367069244, -0.007609460968524218, -0.04624006897211075, 0.006820675451308489, 0.008921894244849682, 0.026527058333158493, 0.005670639220625162, -0.02072053588926792, -0.00818613637238741, 0.0020995615050196648, 0.003973755985498428, -0.03179004788398743, 0.03812684491276741, 0.04096382111310959, 0.0033904523588716984, 0.006207543425261974, -0.0181619543582201, -0.020256543532013893, -0.024869944900274277, -0.03247940540313721, 0.046823371201753616, -0.006220800336450338, -0.019898608326911926, -0.023120034486055374, -0.0021095043048262596, -0.039717674255371094, 0.008709783665835857, 0.010134899988770485, -0.0018957367865368724, 0.027176646515727043, -0.016120390966534615]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" D={(x, a1, a2, y)}, we can write the log-
likelihood function of the BT models as follows:
ℓD(θ) =X
(x,a1,a2,y)∈Dh
ylog
σ 
rθ(x, a1)−rθ(x, a2)
+ (1−y) log
σ 
rθ(x, a2)−rθ(x, a1)i
.(3)
We can compute the maximum likelihood estimator (MLE) rMLEbased on DasθMLE= argmaxθ∈Θ(B)ℓD(θ)
with Θ( B) ={θ∈Rd:∥θ∥ ≤B}. In practice, the MLE is also conducted with the LLMs (Ouyang et al.,
2022; Bai et al., 2022; Touvron et al., 2023) on the preference dataset.
Policy Optimization and Oracle. With the learned reward in hand, to approximately optimize the target
given in Equation (2), we simply call the seminal DRL method PPO with the following regularized reward:
ˆr(x, a) =rMLE(x, a)−ηlogπ(a|x)
π0(a|x).
To simplify the discussion, we first omit the computational challenges by defining the following information-
theoretical policy improvement oracle, and defer a discussion on its practical implementations in Section 5.
Definition 1 (Policy Improvement Oracle) .For reward function r:X × A → Rand a reference policy π0,
for all x∈ X, we can compute the Gibbs policy (Lemma 11):
πr(·|x) := argmax
π∈ΠEa∼π(·|x)h
r(x, a) +ηlogπ0(a|x)
π(a|x)i
∝π0(·|x)·exp 1
ηr(x,·)
.
Accordingly, we take the policy class as Π :=
π(·|x)∝π0(·|x)·exp 1
η⟨θ, ϕ(x,·)⟩
:θ∈Θ(B)	
. However,
even in this ideal case without worrying about tuning the RL method to its best performance, this useful
framework suffers from the reward over-optimization issue (Gao et al., 2023).
Intuitively, the finite Dcannot cover the whole prompt-response space, and the fine-tuned reward model
often performs poorly in the face of out-of-distribution data (Burns et al., 2023) .
Accordingly, the learned rMLE only aligns well with the ground truth r∗in certain distributions and we
further illustrate this phenomena in Figure 2.
In addition to the PPO algorithm, the direct preference learning methods have attracted significant attention
recently due to its stability and competitive performance (Zhao et al., 2023; Rafailov et al., 2023; Azar et al.,
2023; Ethayarajh et al., 2024). We use the DPO as a representative example and the intuition extends to
other algorithms. We show that the DPO can be viewed as imposing constraints on the resulting policy by
D. Informally, to converge to π∗, the DPO requires an infinite Dto cover the whole prompt-response space.
We defer the discussion to Appendix E.
In recognition of the above issues, the primary goal of this work is to formally formulate the RLHF process,
establish the mathematical foundation, and advance the practical algorithmic designs with the developed
theoretical insights.
2.3 Preliminary
In this section, we present some useful technical tools and lemmas for subsequent analysis.
Value decomposition. We have the following lemma to decompose the value difference.
8
0 20 40 60 80 100
KL divergence between policy and initial policy0.00.20.40.60.81.01.2Ground Truth/Proxy RewardProxy Reward
Ground Truth RewardFigure 2: An illustration of the reward over-optimization adapted from Gao et al. (2023). Here the proxy
reward is trained from the responses of π0. Therefore, in the early stage, the proxy reward aligns well
with the gold reward in terms of the in-distribution responses. As reward gets higher, the distribution shift
becomes larger, and since the training set is lacking in the coverage over these out-of-distribution responses,
the proxy reward does not align with the gold reward in this stage.
Lemma 1. Given a comparator policy π, we can decompose the suboptimality of ˆπas follows","[0.008543445728719234, -0.03613929823040962, 0.028748957440257072, -8.363682718481869e-05, 0.028277233242988586, 0.032129645347595215, -0.012435168959200382, 0.04235033318400383, -0.00668930821120739, 0.04124964401125908, 0.03779033198952675, -0.01935378648340702, -0.030845507979393005, -0.03359723091125488, 0.025761371478438377, -0.04863998666405678, 0.03739723190665245, -0.03406895697116852, 0.018410339951515198, 0.038157228380441666, 0.0025649992749094963, -0.034357231110334396, -4.872843419434503e-05, 0.04436826333403587, 0.02547309547662735, -0.028696542605757713, 0.012887237593531609, 0.00038757530273869634, 0.010502411052584648, -0.03540550544857979, 0.03304688632488251, -0.025158613920211792, -0.006423963699489832, -0.0630013570189476, 0.011452410370111465, 0.031972404569387436, 0.010836548171937466, 0.04211447015404701, -0.004104653839021921, 0.017637236043810844, 0.0033839645329862833, -0.061324119567871094, -0.04591446742415428, 0.04114481434226036, -0.025119302794337273, 0.05238756909966469, 0.036899298429489136, -0.0007182325352914631, 0.0230096485465765, 0.002008102834224701, -0.061114463955163956, 0.07049652934074402, -0.03493378311395645, -0.02054620161652565, 0.01947171799838543, -0.002830344019457698, 0.022734476253390312, 0.00977516919374466, 0.020939303562045097, -0.018790340051054955, -0.009965169243514538, -0.02922068163752556, 0.01934068463742733, 0.027622060850262642, -0.00630603265017271, -0.0035149988252669573, -0.06892411410808563, 0.022747579962015152, 0.01518689189106226, 0.047906193882226944, 0.016654478386044502, 0.01388965081423521, 0.04879722744226456, -0.0359034389257431, -0.023546889424324036, -0.009650686755776405, 0.04877102002501488, 0.046622056514024734, 0.0036689643748104572, -0.02785792201757431, -0.004222584888339043, -0.020913098007440567, 0.06095722317695618, -0.02764826826751232, 0.01449240930378437, -0.06373514980077744, -0.05592549964785576, -0.008622066117823124, -0.03239171579480171, -0.03026895597577095, -0.01147861685603857, -0.03671585023403168, -0.0026665509212762117, 0.018488960340619087, 0.0414855033159256, -0.013719306327402592, -0.02324550971388817, 0.02798895724117756, 0.020886890590190887, 0.020048270002007484, -0.016025511547923088, -0.0580744668841362, -0.002248878590762615, -0.014964133501052856, 0.04132826253771782, 0.001346378936432302, -0.006820342969149351, 0.023887578397989273, -0.0056312051601707935, -0.013254133984446526, -0.0532786063849926, -0.012553099542856216, -0.056397225707769394, 0.031212404370307922, -0.021542062982916832, -0.0456261932849884, -0.0816606655716896, 0.02538137137889862, -0.009139652363955975, -0.022642752155661583, -0.03831447288393974, -0.029351714998483658, 0.010469651781022549, 0.013241030275821686, -0.002171895932406187, -0.02290482074022293, 0.033387575298547745, -0.06672273576259613, 0.00911344587802887, -0.008346893824636936, 0.004681205376982689, 0.031972404569387436, -0.02914205938577652, -0.06457377225160599, -0.04939998686313629, 0.024699993431568146, -0.005536205135285854, -0.008091377094388008, -0.0018230166751891375, -0.020061373710632324, -0.023559993132948875, -0.03671585023403168, -0.06452135741710663, -0.0014946116134524345, -0.0912523865699768, -0.002663274994120002, -0.0018754304619506001, -0.014335168525576591, -0.021109648048877716, 0.02914205938577652, 0.015147581696510315, -0.008969307877123356, -0.020231718197464943, 0.032129645347595215, -0.004084998741745949, -0.04573101922869682, -4.176722723059356e-05, 0.03267998993396759, 0.026298612356185913, -0.021148959174752235, -0.019786201417446136, 0.05128687992691994, -0.03493378311395645, -0.02172551117837429, 0.025984130799770355, 0.024739302694797516, -0.01930137351155281, 0.03307309374213219, -0.07484687119722366, -0.038026195019483566, -0.017401374876499176, 0.006207756698131561, -0.05063170939683914, -0.02408413030207157, -0.008438617922365665, -0.02180413156747818, -0.00661396374925971, -0.03527447208762169, 0.0031612059101462364, -0.011105168610811234, 0.02171240746974945, 0.004248791839927435, 0.014964133501052856, 0.0012333616614341736, 0.004006377886980772, 0.03171033412218094, -0.020965510979294777, -0.013470340520143509, -0.008739997632801533, 0.022695165127515793, 0.025119302794337273, 0.04465653747320175, 0.0317627489566803, -0.03624412789940834, -0.0108234453946352, -0.0278055090457201, 0.035536542534828186, 0.05000274255871773, -0.028775162994861603, 0.01837102882564068, 0.01330654788762331, 0.016300683841109276, 0.03779033198952675, -0.05975170433521271, -0.002243964932858944, 0.007541032042354345, -0.00319560244679451, 0.011314824223518372, -0.029954474419355392, -0.041799988597631454, 0.001307887490838766, 0.002524050883948803, 0.034357231110334396, 0.02291792444884777, -0.017348960041999817, 0.020375855267047882, -0.046595849096775055, 0.03283723071217537, 0.01683792658150196, 0.07096825540065765, 0.018895165994763374, 0.017466891556978226, 0.02656068094074726, -0.005863791331648827, -0.04984550178050995, 0.012946203351020813, 0.023494476452469826, -0.007855514995753765, -0.010725169442594051, -0.03781653940677643, 0.04371308907866478, 0.02648206055164337, -0.013417926616966724, -0.03317791968584061, 0.016536546871066093, -0.012585857883095741, 0.002021206310018897, 0.006355170626193285, 0.04565240070223808, -0.06404963880777359, 0.018868960440158844, 0.0317627489566803, 0.008307583630084991, -0.024555854499340057, 0.02183033898472786, 0.0317627489566803, -0.006623791065067053, 0.011740686371922493, -0.0021325855050235987, -0.009270686656236649, 0.02057240717113018, -0.030714472755789757, 0.007527928799390793, -0.04114481434226036, -0.05348825827240944, 0.0217779241502285, 0.0007915299502201378, -0.007652411703020334, -0.047801364213228226, -0.017650339752435684, -0.016012409701943398, 0.020899994298815727, 0.03168412670493126, 0.02652137167751789, 0.024909647181630135, -0.029692403972148895, -0.021279994398355484, -0.014322064816951752, -0.011976548470556736, 0.00841241143643856, 0.013083789497613907, -0.0035477576311677694, -0.021358614787459373, 0.010764479637145996, -0.03495999053120613, -0.06829515099525452, 0.030059300363063812, 0.04871860519051552, -0.05073653534054756, -0.023494476452469826, -0.013758616521954536, 0.016772408038377762, 0.04339860752224922, -0.003306981874629855, 0.028879990801215172, -0.05002894997596741, -0.02798895724117756, -0.006859653163701296, -0.03414757549762726, -0.016641374677419662, -0.03142205998301506, -0.025617234408855438, 0.017742063850164413, -0.057655155658721924, 0.029902059584856033, -0.005893274210393429, 0.011399996466934681, -0.057445500046014786, 0.035772401839494705, 0.02048068307340145, 0.02291792444884777, 0.011341030709445477, -0.034566886723041534, 0.011393444612622261, 0.012133789248764515, -0.02198757976293564, 0.028251025825738907, 0.001631378778256476, 0.010135513730347157, -0.02179102785885334, -0.0033217230811715126, 0.00571310194209218, 0.0020523269195109606, -0.005067756865173578, -0.008877583779394627, 0.0034036196302622557, 0.061009638011455536, -0.023533785715699196, 0.0027402578853070736, -0.020939303562045097, -0.042874470353126526, -0.05817929282784462, -0.017833787947893143, -0.01159654837101698, 0.027228957042098045, -0.015147581696510315, -0.005621377844363451, -0.004871205426752567, -0.024634474888443947, -0.022760683670639992, 0.008772755973041058, -0.0053331018425524235, 0.025119302794337273, 0.004111205693334341, 0.00781620480120182, -0.02196137234568596, -0.027438612654805183, 0.035851024091243744, 0.033439990133047104, 0.03160550817847252, -0.060118600726127625, 0.0014716805890202522, -0.015422753989696503, -0.003577240277081728, -0.031133783981204033, 0.015606202185153961, 0.01390275452286005, 0.002622326835989952, 0.027438612654805183, 0.052806880325078964, -0.025027578696608543, -0.016431719064712524, 0.03388550877571106, 0.01683792658150196, -0.014335168525576591, 0.019799305126070976, -0.016182754188776016, -0.06871446222066879, -0.04732964187860489, 0.005421550013124943, -0.011655514128506184, -0.011655514128506184, -0.005313446745276451, 0.0028483611531555653, 0.0007849782123230398, 0.05346205458045006, -0.009493445046246052, -0.014243444427847862, 0.014020685106515884, 0.03241791948676109, -0.03013792261481285, 0.036977920681238174, -0.05456274375319481, 0.004147239960730076, -0.03912688419222832, -0.003564136801287532, 0.026324819773435593, 5.369340942706913e-05, 0.008956204168498516, 0.010666203685104847, -0.0061717224307358265, 0.017886200919747353, -0.01831861585378647, -0.021122751757502556, 0.016772408038377762, 0.0090086180716753, -0.0024503441527485847, -0.03288964554667473, -0.04730343446135521, -0.009041376411914825, 0.02898481860756874, -0.012153444811701775, -0.022564131766557693, 0.013162409886717796, -0.031238611787557602, -0.0012128875823691487, -0.05044826120138168, 0.05238756909966469, 0.07757239043712616, 0.06902894377708435, -0.03847171366214752, -0.027412405237555504, -0.0578123964369297, -0.015252409502863884, -0.06357791274785995, -0.0018164649372920394, -0.0066696531139314175, 0.029980679973959923, -0.009873445145785809, 0.03975585103034973, 0.0654648095369339, -0.014977237209677696, 0.021528959274291992, -0.04711998626589775, 0.026337923482060432, -0.044289641082286835, -0.004995688330382109, 0.007835859432816505, 0.023350337520241737, 0.042848262935876846, 0.02547309547662735, -0.03019033558666706, 0.008169997483491898, 0.011111720465123653, -0.011452410370111465, 0.031107576563954353, 0.018934477120637894, -0.007010342553257942, 0.01586827076971531, -0.0534096397459507, -0.0020539648830890656, 0.03786895424127579, 0.03173654153943062, -0.037030335515737534, -0.04101378098130226, 0.007436204701662064, -0.011557238176465034, -0.0011432755272835493, 0.004854826256632805, -0.017479995265603065, 0.027412405237555504, -0.021332407370209694, -0.032234471291303635, 0.028329646214842796, -0.029456542804837227, 0.01702137477695942, 0.004992412403225899, -0.01930137351155281, 0.024529647082090378, 0.00519223976880312, -0.03765929862856865, 0.022236544638872147, 0.07369376718997955, 0.014531719498336315, -0.009395170025527477, -0.05660688132047653, 0.07966893911361694, -0.005857239477336407, 0.0008316592429764569, 0.025774475187063217, -0.020362751558423042, 0.004268446937203407, 0.009886548854410648, -0.026914475485682487, 0.03600826486945152, 0.015252409502863884, 0.0034887921065092087, 0.0074427565559744835, -0.0390220582485199, 0.027595853433012962, -0.018659304827451706, -0.041931021958589554, 0.021397924050688744, -0.03716136887669563, -0.028119990602135658, 0.003950688522309065, 0.028617922216653824, 0.007862066850066185, 0.03291585296392441, -0.004822067450731993, 0.020297234877943993, -0.040620677173137665, 0.0034625851549208164, -0.0090086180716753, 0.04093515872955322, 0.053776536136865616, 0.06562204658985138, -0.03294206038117409, -0.041799988597631454, -0.010345169343054295, 0.003973619546741247, -0.03157930076122284, 0.03016412816941738, -0.014269650913774967, 0.010725169442594051, -0.004356895107775927, 0.013044478371739388, -0.006505860015749931, 0.004340515937656164, 0.00016174564370885491, 0.02791033685207367, -0.038183435797691345, -0.014623443596065044, 0.023324130102992058, 0.025171715766191483, 0.021175166592001915, 0.03634895384311676, -0.01831861585378647, -0.014793789014220238, 0.01818758063018322, -0.03558895364403725, -0.011740686371922493, -0.032155852764844894, 0.029744818806648254, -0.01219930686056614, -0.0037017229478806257, -0.04253378137946129, -0.024844130501151085, -0.011799651198089123, 0.0561351552605629, 0.00839930772781372, -0.03286343812942505, -0.02543378621339798, 0.008209307678043842, 0.012887237593531609, 0.014033788815140724, -0.048954468220472336, -0.10797238349914551, -0.029902059584856033, -0.01830551214516163, 0.038078609853982925, -0.007750687189400196, 0.024647578597068787, 0.028670337051153183, -0.003868791973218322, -0.004075170960277319, -0.011852065101265907, -0.0069710323587059975, -0.017414476722478867, 0.00011271009861957282, 0.024699993431568146, -0.006358446553349495, -8.220363815780729e-05, 0.012153444811701775, -0.0009925859048962593, -0.05215170979499817, 0.012513789348304272, 0.012317237444221973, 0.010351721197366714, 0.02297033742070198, 0.015448960475623608, -0.020388958975672722, -0.05233515799045563, -0.03157930076122284, -0.046700675040483475, 0.004828619305044413, -0.019746890291571617, 0.00918551441282034, 0.023573096841573715, 0.011648962274193764, -0.020153097808361053, -0.0042356885969638824, -0.017925512045621872, 0.025682751089334488, -1.767173489497509e-05, 0.03857653960585594, 0.023822061717510223, -0.008988962508738041, 0.021214475855231285, 0.015475167892873287, -0.029456542804837227, 0.033335164189338684, 0.030557231977581978, -0.029299302026629448, 0.009899652563035488, 0.005352756939828396, 0.05097239837050438, -0.020860683172941208, 0.01563240960240364, 0.012566203251481056, -0.029535163193941116, -0.028198612853884697, -0.018475856631994247, -0.028303440660238266, -0.03640136867761612, 0.013863444328308105, 0.00012182108184788376, 0.014675857499241829, -0.05582067370414734, 0.022537924349308014, 0.029351714998483658, -0.03883861005306244, -0.011216548271477222, 0.00518896384164691, -0.03406895697116852, -0.009159307926893234, 0.0026518094819039106, 0.007717928849160671, 0.004225860815495253, -0.007541032042354345, 0.04439447075128555, 0.012972409836947918, 0.0042127575725317, -0.02185654453933239, -0.03155309334397316, 0.04360826313495636, -0.012317237444221973, 0.0005532110226340592, 0.012382755056023598, -0.0033937920816242695, -0.011989651247859001, -0.0032152575440704823, 0.02911585383117199, -0.006872756406664848, -0.04701515659689903, -0.04633377864956856, 0.0067056878469884396, -3.132542042294517e-05, 0.056344810873270035, -0.0043634469620883465, 0.006859653163701296, -0.0046648262068629265, 0.022092407569289207, -0.0159468911588192, -0.02045447565615177, 0.00841241143643856, -0.006853101309388876, -0.025197923183441162, 0.008654825389385223, -0.01451861672103405, -0.03385930135846138, -0.01278240978717804, -0.00961792841553688, 0.01915723644196987, 0.03252274915575981, 0.0030236197635531425, 0.01457102969288826, -0.02648206055164337, 0.01268413383513689, -0.020192407071590424, 0.00977516919374466, 0.027097923681139946, -0.01700827106833458, -0.04486619308590889, 0.0023537061642855406, -0.02183033898472786, 0.014059995301067829, 0.028172405436635017, -0.024595165625214577, -0.04819446802139282, -0.00918551441282034, -0.009997927583754063, 0.008189653046429157, -0.012978961691260338, 0.019956545904278755, 0.00968344509601593, 0.008739997632801533, 0.013837236911058426, -0.011878272518515587, -0.012854479253292084, -0.024660682305693626, -0.022459303960204124, -0.0241758543998003, 0.004612412303686142, 0.022642752155661583, 0.05236136168241501, 0.020074477419257164, 0.07835859805345535, 0.005847412161529064, -0.019078614190220833, -0.034697920083999634, -0.008124135434627533, 0.039493780583143234, -0.014046892523765564, -0.023402752354741096, -0.008156893774867058, 0.0015142668271437287, -0.016444822773337364, -0.038235850632190704, -0.0083927558735013, -0.019052408635616302, -0.025918612256646156, -0.0342261977493763, -0.024503441527485847, -0.03037378378212452, -0.018528269603848457, 0.03262757509946823, -0.033387575298547745, -0.015501374378800392, -0.003208705922588706, -0.04235033318400383, -0.0025764647871255875, -0.006345342844724655, -0.034671712666749954, 0.00024978441069833934, 0.023717233911156654, 0.016208959743380547, 0.04746067523956299, -0.01590758189558983, -0.04321515932679176, -0.013031375594437122, 0.0231406819075346, -0.015278615988790989, 0.004219308961182833, -0.043110333383083344, -0.022564131766557693, -0.029980679973959923, 0.04596688225865364, 0.02772688865661621, -0.043188951909542084, -0.007423100993037224, -0.008766204118728638, -0.02172551117837429, 0.031002748757600784, 0.000673189468216151, 0.03254895657300949, 0.03647998720407486, 0.008929997682571411, 0.009454134851694107, -0.015160685405135155, -0.025053786113858223, -0.01508206408470869, -0.04363447055220604, 0.025066889822483063, -0.012441720813512802, 0.0074034458957612514, -0.0486137792468071, 0.010227237828075886, -0.023389648646116257, 0.009984824806451797, 0.002034309785813093, -0.0027910335920751095, -0.026167578995227814, -0.0436868816614151, -0.00856965221464634, 0.03286343812942505, 0.001053189393132925, 0.020978614687919617, -0.0009843962034210563, -0.0014331892598420382, 0.020153097808361053, -0.000708404986653477, -0.031998611986637115, -0.01459723711013794, 0.003737757448107004, 0.006807239260524511, 0.007416549604386091, 0.023297924548387527, 0.01510827150195837, 0.029299302026629448, -0.02167309634387493, 0.01147861685603857, -0.01702137477695942, -0.018698615953326225, 0.04929515719413757, -0.00519551569595933, 0.008143790997564793, -0.0016354736872017384, -0.011616203002631664, -0.019995855167508125, -0.016549650579690933, -0.00420948164537549, -0.01459723711013794, 0.017807580530643463, -0.007056204602122307, -0.03472412750124931, -0.04004412516951561, -0.035719990730285645, 0.046543434262275696, -0.004281550645828247, 0.0032381885685026646, 0.008595859631896019, -0.004848274402320385, 0.011531030759215355, 0.07002480328083038, 0.009578618220984936, -0.00229474063962698, -0.011629306711256504, 0.004907239694148302, -0.008340341970324516, -0.04746067523956299, -0.017859995365142822, 0.010587583296000957, -0.02324550971388817, -0.022079303860664368, 0.01269723754376173, 0.006338790990412235, -0.021253786981105804, 0.00019409476954024285, -0.030950335785746574, -0.017466891556978226, -0.013149306178092957, -0.02675723284482956, -0.02770068123936653, 0.03401654213666916, 0.03385930135846138, -0.04722481220960617, -0.10891582816839218, -0.02678344026207924, 0.020821373909711838, 0.0005388791323639452, 0.012585857883095741, -0.004317584913223982, 0.035641368478536606, -0.02527654357254505, -0.03191998973488808, -0.04041102156043053, 0.002337326994165778, -0.024568958207964897, 0.03191998973488808, -0.01930137351155281, 0.016261374577879906, -0.04573101922869682, -0.034619301557540894, 0.0013226289302110672, 0.014872409403324127, -0.031107576563954353, -0.021044131368398666, -0.010862755589187145, -0.0021080165170133114, 0.01956344209611416, -0.04227171093225479, 0.016418615356087685, 0.03034757636487484, 0.0015134478453546762, -0.00788827333599329, -0.02315378561615944, 0.002163706347346306, -0.005287239793688059, -0.0005847411812283099, 0.00017443959950469434, -0.04573101922869682, 0.0003867563500534743, -0.006230687722563744, -0.0008443531696684659, 0.005120170768350363, 0.01158999651670456, 0.02548619918525219, -0.037030335515737534, 0.05471998453140259, -0.01466275379061699, 0.025093095377087593, -0.04387032985687256, 0.015029650181531906, -0.03634895384311676, -0.004432240035384893, 0.0007215084042400122, 0.0266393031924963, -0.028696542605757713, 0.001610904699191451, -0.04140688478946686, 0.017611028626561165, 0.017283443361520767, -0.0011301720514893532, 0.00759344594553113, -0.024844130501151085, -0.027543440461158752, -0.005745860282331705, 0.05419584736227989, 0.02650826796889305, -0.012671031057834625, -0.02671792358160019, 0.003200516337528825, -0.00428810203447938, 0.0008054523495957255, -0.01512137521058321, -0.03433102369308472, -0.0090086180716753, 0.011911030858755112, 0.0049629295244812965, 0.02683585323393345, -0.027412405237555504, -0.00548706715926528, 0.02045447565615177, 0.030871715396642685, -0.02527654357254505, 0.017768271267414093, 0.06195308640599251, -0.031186196953058243, 0.01029275543987751, 0.03506481647491455, 0.007541032042354345, 0.026075854897499084, 0.013666892424225807, -0.008622066117823124, -0.015606202185153961, -0.0021227579563856125, -0.0042291367426514626, -0.01920964941382408, 0.009061031974852085, -0.016772408038377762, -0.006443618796765804, -0.03406895697116852, -0.026154475286602974, 0.01097413431853056, 0.023376544937491417, -0.015147581696510315, 0.028251025825738907, 0.025997232645750046, -0.025722060352563858, 0.0020654303953051567, 0.012428617104887962, -0.010653099976480007, -0.0032381885685026646, 0.016104133799672127, 0.02527654357254505, -0.005955515429377556, -0.006109480746090412, 0.03372826427221298, -0.03349240496754646, 0.0019868097733706236, -0.017650339752435684, 0.040777917951345444, 0.03993929922580719, 0.013358961790800095, 0.011701376177370548, -0.0028893095441162586, 0.0157503392547369, 0.040620677173137665, -0.02078206278383732, 0.02185654453933239, -0.0011637496063485742, -0.01691654697060585, -0.00781620480120182, 0.02652137167751789, -0.022760683670639992, -0.002840171568095684, 0.014728271402418613, -0.005156205501407385, 0.021306199952960014, 0.00334956799633801, -0.009971721097826958, 0.044001366943120956, 0.04384412616491318, 0.016471030190587044, -0.034488264471292496, 0.004324136767536402, 0.013123099692165852, 0.0266393031924963, 0.012507237493991852, 0.025106199085712433, -0.018999993801116943, 0.030819300562143326, 0.03186757490038872, -0.020913098007440567, -0.03841929882764816, 0.024634474888443947, 0.03047861158847809, -0.011852065101265907, 0.01141310017555952, -0.006748273968696594, 0.009408272802829742, 0.027674473822116852, 0.03729240223765373, -0.030819300562143326, -0.0004790946841239929, 0.009729307144880295, -0.007259308360517025, 0.0438179187476635, -0.009873445145785809, -0.021214475855231285, 0.008667928166687489, -0.03747585043311119, 0.0044944812543690205, 0.005310170818120241, -0.01592068560421467, -0.0020703442860394716, -0.010449997149407864, -0.05844136327505112, 0.010941375978291035, 0.017637236043810844, 0.01589447818696499, 0.014964133501052856, -0.016274478286504745, 0.046648260205984116, 0.0036853437777608633, 0.034488264471292496, 0.005981722380965948, 0.027333784848451614, -0.017571719363331795, -0.029535163193941116, 0.032234471291303635, -0.0018344821874052286, 0.0038294815458357334, -0.009794824756681919, 0.004389653913676739, 0.0035706886555999517, 0.03129102662205696, 0.02295723371207714, 0.0009319824748672545, 0.03144826740026474, 0.014439995400607586, -0.009742410853505135, 0.014308961108326912, 0.04947860538959503, -0.000596206693444401, -0.0632634311914444, -0.06216273829340935, 0.04971446841955185, -0.009991376660764217, -0.021148959174752235, -0.019065512344241142, 0.0243724063038826, 0.012992065399885178, -0.012035513296723366, 0.018777236342430115, 0.028460681438446045, 0.007383790798485279, -0.0071413773111999035, -0.017440684139728546, 0.02431999333202839, 0.001994999358430505, -0.05529653653502464, -0.0035412057768553495, 0.0024241372011601925, -0.02895861119031906, -0.00630930857732892, -0.011694824323058128, -0.029744818806648254, 0.016274478286504745, 0.02299654483795166, -0.02429378591477871, -0.01935378648340702, 0.06064274162054062, -0.0037770678754895926, 0.020218614488840103, 0.016143443062901497, -0.02801516465842724, 0.03647998720407486, -0.01564551331102848, -0.0127693060785532, -0.014675857499241829, -0.022799992933869362, -0.0026567233726382256, 0.010338617488741875, -0.004157067742198706, 0.007868618704378605, 0.03155309334397316, 0.0034068955574184656, -0.027150336652994156, 0.004019481595605612, 0.018449649214744568, 0.002240689005702734, 0.03480274975299835, 0.0679282546043396, -0.034435853362083435, -0.012841375544667244, -0.009467238560318947, 0.0337020605802536, 0.0011481893016025424, 0.0027369819581508636, -0.0052675846964120865, -0.012572755105793476, -0.0028876715805381536, 0.028251025825738907, 0.04649101942777634, -0.003144826740026474, -0.031998611986637115, 0.004763102158904076, -0.01716551184654236, -0.025014474987983704, -0.006794136017560959, -0.024883441627025604, 0.01331965159624815, 0.03503860905766487, 0.02069033868610859, 0.0001110721641452983, -0.016693787649273872, 0.023428957909345627, -0.027622060850262642, 0.02304895780980587, 0.0121862031519413, 0.0060013774782419205, 0.016104133799672127, -0.008687583729624748, 0.0256041307002306, -0.005051377695053816, -0.0255386121571064, -0.0014233615947887301, -0.01813516765832901, -0.00608654972165823, 0.014833099208772182, -0.008982410654425621, 0.03980826213955879, -0.0053331018425524235, -0.008045515045523643, 0.03283723071217537, 0.04389653727412224, 0.03883861005306244, 0.0020424993708729744, 0.009395170025527477, 0.012507237493991852, -0.030714472755789757, 0.005693446379154921, 0.0071020666509866714, -0.0004553446779027581, 0.006659825798124075, 0.010259997099637985, -0.006951377261430025, 0.00028377145645208657, -0.00661396374925971, -0.0008746549137867987, 0.03021654300391674, 0.019170338287949562, -0.0027238784823566675, -0.01027965173125267, -0.023677924647927284, -0.005680343136191368, -0.027176544070243835, -0.015383443795144558, 0.022092407569289207, -0.014086202718317509, -0.008949652314186096, -0.005942412186414003, -0.004782757256180048, -0.021463442593812943, 0.0031006024219095707, 0.00020238678553141654, 0.005005515646189451, 0.01321482378989458, 0.038026195019483566, -0.02412344142794609, -0.015475167892873287, 0.005624653305858374, -0.0006338790990412235, 0.0016805167542770505, 0.007947239093482494, -0.03380688652396202, 0.01931447722017765, -1.1510301192174666e-05, -0.028486888855695724, -0.030635852366685867, 0.01391585823148489, -0.03684688359498978, 0.00479913642629981, -0.022747579962015152, -0.013470340520143509, 0.046412400901317596, 0.0013930599670857191, 0.01267758198082447, -0.017794476822018623, -0.02186964824795723, 0.006286377552896738, 0.013470340520143509, 0.007737583946436644, -0.004838446620851755, 0.008333791047334671, 0.06614618748426437, -0.02764826826751232, -0.03509102389216423, 0.0019425855716690421, -0.015986202284693718, 0.05372412130236626, -0.013254133984446526, -0.009919307194650173, -0.028565509244799614, 0.029404129832983017, -0.0024962062016129494, 0.01922275312244892, -0.014348271302878857, -0.00398999871686101, 0.004517412278801203, 0.012513789348304272, 0.003416723106056452, 0.03611309081315994, 0.03364964574575424, 0.008975859731435776, 0.03731860965490341, 0.003153016325086355, -0.01210758276283741, 0.01567171886563301, 0.02054620161652565, -0.001564223668538034, -0.022406889125704765, -0.01576344296336174, 0.009427928365767002, 0.007226549554616213, -0.005437929183244705, -0.011183789931237698, -0.037921369075775146, 0.012913444079458714, -0.020926199853420258, -0.007953790947794914, -0.013811030425131321, 0.01820068433880806, -0.007482066750526428, 0.0008451721514575183, -0.01939309760928154, -0.007803101092576981, 0.0030793093610554934, 0.012743099592626095, 0.0038294815458357334, 0.024477234110236168, 0.007108618505299091, 0.01831861585378647, 0.0018983614863827825, 0.012120685540139675, 0.007626204751431942, -0.022223440930247307, 0.021017923951148987, -0.011727582663297653, -0.012598961591720581, -0.013693098910152912, -0.007652411703020334, 0.028198612853884697, 0.017427580431103706, 0.02557792328298092, -0.03891722857952118, 0.023559993132948875, -0.01830551214516163, -0.010115859098732471, 0.019144132733345032, -0.020100682973861694, -0.0024257751647382975, 0.025853095576167107, -0.005215170793235302, 0.04143309220671654, -0.03907446935772896, 0.016549650579690933, -0.014846201986074448, -0.003967067692428827, -0.015488271601498127, 0.010436893440783024, -0.026324819773435593, 0.011799651198089123, 0.011367238126695156, 0.008373101241886616, 0.004471550229936838, 0.008242066018283367, -0.012297582812607288, 0.010364824905991554, -0.014872409403324127, 0.02932550758123398, 0.016117235645651817, 0.008844824507832527, -0.042926885187625885, 0.04166895151138306, -0.0057622394524514675, 0.010102755390107632, 0.04200964421033859, -0.005179136525839567, -0.014557926915585995, -0.0120224105194211, -0.0045305159874260426, 0.0031775853130966425, 0.003290602471679449, 0.01816137321293354, -0.020100682973861694, 0.010364824905991554, 0.008261721581220627, -0.004383102059364319, -0.033204127103090286, 0.014361375011503696, -0.031159991398453712, -0.020139994099736214, 0.023271717131137848, -0.00788827333599329, 0.008877583779394627, -0.013588272035121918, 0.033361367881298065, 0.02409723401069641, -0.005523101892322302, 0.03296826407313347, 0.004618964157998562, 0.031998611986637115, 0.01803033985197544, -0.0013406461803242564, -0.0006355170626193285, -0.0070299976505339146, 0.005552584305405617, 0.01142620388418436, 0.0002641163009684533, 0.028303440660238266, -0.016693787649273872, 0.006040687672793865, -0.01321482378989458, 0.015278615988790989, -0.0207427516579628, 0.029928267002105713, 0.014282754622399807, -0.010574479587376118, -0.0007108618738129735, 0.008268273435533047, 0.013850340619683266, -0.03367585316300392, -0.012638271786272526, 0.0031055163126438856, -0.0038556884974241257, 0.0291682668030262, -0.017820684239268303, 0.025263439863920212, -0.016405511647462845, -0.028119990602135658, 0.009336204268038273, -0.04706757143139839, 0.023297924548387527, 0.014164823107421398, 0.0013856892473995686, 0.035719990730285645, -0.016680683940649033, 0.024660682305693626, 0.023402752354741096, -0.0386289544403553, -0.0004573921032715589, -0.01706068404018879, -0.0005188144859857857, -0.0033020679838955402, 0.03155309334397316, -0.0168510302901268, 0.024948958307504654, 0.03152688592672348, 0.03509102389216423, 0.007580342702567577, -0.025171715766191483, -0.010050341486930847, -0.008373101241886616, 0.007043101359158754, 0.00728551484644413, 0.008327239193022251, 0.01509516779333353, -0.019117925316095352, -0.017217926681041718, -0.014099306426942348, -0.01390275452286005, -0.009513100609183311, -0.022537924349308014, 0.0291682668030262, -0.016719995066523552, -0.010332065634429455, 0.0305310245603323, 0.0019262062851339579, 0.012592409737408161, 0.010725169442594051, 0.044132400304079056, 0.017584823071956635, 0.02070344239473343, 0.006591032724827528, 0.025132406502962112, -0.005857239477336407, 0.029875852167606354, 0.02203999273478985, 0.014046892523765564, 0.018528269603848457, -0.005893274210393429, -0.001234180643223226, 0.04387032985687256, 0.01584206335246563, 0.026940681040287018, 0.0010024134535342455, 0.012946203351020813, 0.023376544937491417, -0.019838614389300346, -0.007626204751431942, -0.0053986189886927605, 0.005447756964713335, 0.020913098007440567, 0.012284479103982449, 0.0017771546263247728, 0.0016616805223748088, 0.00016624995623715222, 0.024529647082090378, 0.007252756506204605, 0.02042827010154724, -0.0011629307409748435, 0.024739302694797516, -0.02678344026207924, -0.011472065933048725, -0.020166201516985893, -0.00570655008777976, 0.034697920083999634, -0.0037017229478806257, -0.02067723497748375, 0.019851718097925186, 0.022144820541143417, 0.04248136654496193, 0.011131376028060913, 0.010083100758492947, 0.010089651681482792, -0.02306206151843071, -0.007803101092576981, -7.073812594171613e-05, 0.0007010342669673264, 1.6456084267701954e-05, -0.0007362497854046524, -0.011845513246953487, -0.009264134801924229, 0.014846201986074448, -0.058860670775175095, 0.03537929803133011, 0.0016051719430834055, -0.022223440930247307, -0.02046757936477661, 0.05285929515957832, -0.006125860381871462, 0.023625509813427925, -0.035929642617702484, 0.010476203635334969, 0.011904479004442692, 0.016130339354276657, -0.018882064148783684, -0.03797378018498421, 0.05917515605688095, -0.0439489521086216, -0.00289422320201993, -0.03894343599677086, -0.000708404986653477, 0.030033094808459282, -0.010246893391013145, -0.0017476718639954925, -0.005323274061083794, 0.018384132534265518, -0.029377922415733337, 0.03047861158847809, -0.015488271601498127, -0.00907413475215435, -0.013273789547383785, -0.009146204218268394, 0.0015068961074575782, 0.023913785815238953, 0.027071716263890266, -0.024791717529296875, -0.00479913642629981, 0.013837236911058426, -0.00608982564881444, 0.009919307194650173, 0.0034658610820770264, -0.012808617204427719, 0.03587723150849342, -0.0029515507631003857, -0.03032137081027031, -0.005244653671979904, 0.0023635337129235268, 0.02312758006155491, -0.020913098007440567, -0.015396547503769398, -0.01442689262330532, -0.006017756648361683, -0.018842753022909164, 0.0007923488738015294, -0.00449775718152523, -0.037921369075775146, -0.0052675846964120865, 0.002184999408200383, 0.0017804305534809828, -0.018908269703388214, -0.031972404569387436, 0.02165999263525009, -0.008536893874406815, 0.013444134034216404, 0.021293096244335175, 0.011380341835319996, 0.030897920951247215, 0.013483444228768349, -0.01825309731066227, 0.01806964911520481, -0.014387581497430801, 0.018698615953326225, 0.01716551184654236, 0.011963444761931896, 0.02183033898472786, 0.05105102062225342, 0.010515513829886913, 0.02298344112932682, -0.012723444029688835, -0.0030088783241808414, -0.02076895907521248, 0.0035608611069619656, 0.0021882751025259495, 0.001242370344698429, -0.00638792896643281, 0.009932410903275013, 0.0410924032330513, 0.003744309302419424, -0.022537924349308014, 0.014204133301973343, -0.004913791548460722, -0.023507578298449516, 0.0028483611531555653, 0.011399996466934681, 0.029482750222086906, 0.022236544638872147, -0.0014012495521456003, 0.016706891357898712, -0.017781373113393784, -0.0018770684255287051, 0.016366202384233475, -0.013103444129228592, 0.001857413211837411, 0.02295723371207714, -0.004881033208221197, -0.0039015505462884903, -0.004091550596058369, 0.016195857897400856, 0.030924128368496895, 0.03540550544857979, 0.0021899130661040545, 0.01716551184654236, 0.017597924917936325, 0.02806757763028145, -0.02414964698255062, -0.04014895483851433, -0.0034068955574184656, 0.016379306092858315, -0.0031874128617346287, -0.028329646214842796, -0.01934068463742733, -0.0009049565996974707, -0.03493378311395645, -0.0042324126698076725, -0.0008074997458606958, 0.016772408038377762, 0.005929308477789164, 0.013601374812424183, -0.009991376660764217, -0.015278615988790989, 0.003724653972312808, -0.024503441527485847, 0.034540679305791855, 0.05285929515957832, 0.010089651681482792, 0.019786201417446136, -0.033230334520339966, -0.01157689280807972, -0.0008877583313733339, -0.0340951606631279, 0.04950481280684471, -0.014636547304689884, -0.0004451076383702457, -0.017807580530643463, 0.024962062016129494, -0.037082746624946594, -0.0071020666509866714, -0.0046025849878787994, 0.004684481304138899, 0.02674412913620472, -0.006866205018013716]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
":
J(π)−J(ˆπ) =Ex∼d0h
Eπ[r∗(x, a)−ˆr(x, a)] +Eˆπ[ˆr(x, a)−r∗(x, a)] +Eπ[ˆr(x, a)]−Eˆπ[ˆr(x, a)]
+ηDKL(ˆπ(·|x)∥π0(·|x))−ηDKL(π(·|x)∥π0(·|x))i
,
where ˆr:X × A → Ris arbitrary.
Proof. The equality can be verified directly by the definition of J(·) in Equation (2) and basic algebra.
Policy improvement error. In standard RL setting, ˆ πis typically taken as a greedy policy of ˆ r, leading
to
Eπ[ˆr(x, a)]−Eˆπ[ˆr(x, a)]≤0.
In the KL-constrained case, since the policy cannot be greedy or deterministic, we need to additionally
handle the policy improvement error. The following lemma provides such an estimation when our policy is
obtained by calling the Oracle 1 with ˆ r.
Lemma 2 (Policy optimization error) .Suppose that π,ˆπ∈Πso that π0, π,ˆπhave the same support. If ˆπ
is induced by calling Oracle 1 with ˆr, it holds that
Ex∼d0h
Eπ[ˆr(x, a)]−Eˆπ[ˆr(x, a)] +ηDKL(ˆπ∥π0)−ηDKL(π∥π0)i
=−ηEx∼d0DKL(π∥ˆπ).
Here DKL(π∥π0)is short for DKL(π(·|x)∥π0(·|x)).
We will provide the proof of the lemma in Appendix F. The analysis techniques are most similar to the
policy gradient literature since they also consider the soft-max policies (Chen and Teboulle, 1993; Agarwal
9
et al., 2021; Cai et al., 2020; Zanette et al., 2021b; Yuan et al., 2022; Xiao, 2022; Zhong and Zhang, 2023;
Uehara et al., 2024; Alfano et al., 2024). The main difference is that in their iterative choices of policy, for
choosing πt, the reference policy they use is the policy of the last round, i.e., πt−1, while we always use the
SFT-model π0as our reference. We note that their algorithms essentially still use the non-KL-regularized
reward as the target because though we prevent the policy from moving too far away in each individual step,
the cumulative updates makes the reward estimations dominating in the final policy.
Covariance matrix. Given a preference dataset D, a fixed λ >0, we denote Σ Das the covariance matrix
estimation:
λI+X
(x,a1,a2)∈D 
ϕ(x, a1)−ϕ(x, a2) 
ϕ(x, a1)−ϕ(x, a2)⊤.
Both the algorithmic design and analysis will be centered on the covariance matrix. For the readers that
are not familiar with the eluder-type techniques (or elliptical potential lemma in this case), we provide a
brief introduction to the high-level intuition as follows. Given a training set D, the in-sample error on the
observed data in Dis given by
∥θ1−θ2∥2
ΣD=λ∥θ1−θ2∥2+X
(x,a1,a2)∈D 
rθ1(x, a1)−rθ1(x, a2)
− 
rθ2(x, a1)−rθ2(x, a2)2
,
where we additionally add a regularization term λ∥θ1−θ2∥2. Meanwhile, if we test the hypothesis ( θ1−θ2)
on a newly observed data, the out-of-sample error would be given by |
θ1−θ2, ϕ(x, a1)−ϕ(x, a2)
|.The
ideal case would be that we can infer the out-of-sample error via the in-sample","[-0.01625591516494751, -0.04360775649547577, 0.01793711632490158, 0.0003138106258120388, 0.045366548001766205, 0.03533107414841652, -2.5763589292182587e-05, 0.03605528548359871, 0.006278637330979109, 0.06538576632738113, 0.0344516783952713, -0.038796935230493546, -0.021545231342315674, 0.008755175396800041, 0.014251407235860825, -0.019631249830126762, 0.025140414014458656, -0.022334102541208267, -0.0012107876827940345, 0.033339500427246094, -0.015919676050543785, -0.03517588973045349, 0.029589129611849785, 0.034813784062862396, 0.014600579626858234, -0.023304026573896408, 0.040891971439123154, 0.0029905971605330706, 0.02052357792854309, -0.008199085481464863, 0.037865810096263885, -0.040452271699905396, -0.01763967238366604, -0.059747278690338135, -0.006433825008571148, 0.08131837844848633, 0.0003786742454394698, 0.06916200369596481, -0.02051064558327198, 0.01259607169777155, 0.011115321889519691, -0.028114845976233482, -0.08012860268354416, 0.04296113923192024, -0.023472145199775696, 0.0028370257932692766, 0.0058809686452150345, 0.010494571179151535, 0.031942810863256454, 0.01763967238366604, -0.05113435909152031, 0.028942514210939407, -0.008890964090824127, 0.0030746571719646454, 0.008373672142624855, 0.019993353635072708, 0.036417391151189804, 0.01607486419379711, 0.03696054592728615, -0.03186521679162979, 0.021778013557195663, -0.016217118129134178, 0.021066736429929733, 0.019178617745637894, -0.02808898128569126, -0.021144330501556396, -0.021066736429929733, 0.05581585690379143, 0.013501333072781563, 0.06476501375436783, 0.020342526957392693, 0.003052025567740202, 0.046763237565755844, -0.011567953042685986, -0.028347628191113472, 0.006608411204069853, 0.02075636014342308, 0.03918490558862686, 0.04055573046207428, -0.017316365614533424, 0.052686236798763275, -0.03284807130694389, 0.06600651890039444, -0.013436672277748585, 0.02096327766776085, -0.09006062150001526, -0.046556323766708374, -0.010817878879606724, -0.02480417490005493, -0.01654042676091194, -0.0006765215657651424, -0.030546121299266815, -0.0029194694943726063, 0.046763237565755844, 0.06342005729675293, 0.0387452058494091, -0.004707361571490765, 0.008878031745553017, 0.020471850410103798, -0.007888710126280785, 0.007177432999014854, -0.022683274000883102, 0.016411103308200836, 0.007319688331335783, 0.03225318714976311, -0.020368391647934914, -0.03323604166507721, 0.025890488177537918, 0.013553062453866005, -0.03840896487236023, -0.04500444605946541, -0.03696054592728615, -0.04862549155950546, 0.043504297733306885, 0.01542824786156416, -0.07780078798532486, -0.08473251014947891, 0.021790945902466774, -0.03921077027916908, -0.014497121796011925, -0.024584325030446053, -0.025088684633374214, 0.028451085090637207, 0.003588716499507427, 0.0048463838174939156, -0.0093177305534482, 0.03670189902186394, -0.05400533229112625, -0.02995123341679573, -0.018919972702860832, 0.011639080941677094, 0.0025896953884512186, -0.042340390384197235, -0.04901346191763878, -0.0438922643661499, 0.019243279471993446, 0.04050400108098984, 0.03352055326104164, 0.021260719746351242, -0.010326450690627098, -0.01582914963364601, 0.016630953177809715, -0.064247727394104, -0.007164500653743744, -0.04565105959773064, 0.014626444317400455, 0.017406892031431198, -0.009421189315617085, -0.030546121299266815, 0.014574714936316013, 0.016436967998743057, 0.01654042676091194, -0.03176175802946091, 0.023704927414655685, -0.002778830472379923, -0.03473618999123573, -0.007649462204426527, 0.051962029188871384, 0.03207213431596756, -0.0025799961294978857, -0.0528414249420166, 0.07324861735105515, 0.0023358988109976053, 0.01890704035758972, 0.0012487763306125998, 0.009608707390725613, -0.03401197865605354, 0.009621639735996723, -0.058557506650686264, -0.04001257196068764, -0.01692839525640011, 0.011302840895950794, -0.018467340618371964, 0.001989959506317973, -0.005295781884342432, -0.041357532143592834, 0.007578334771096706, -0.0475650429725647, 0.008865099400281906, -0.015622233040630817, -0.0017054486088454723, -0.011205848306417465, 0.001575317233800888, 0.019527791067957878, -0.02520507574081421, 0.03279634192585945, -0.01866132579743862, 0.0016254299553111196, 0.00011669390369206667, -0.008923294954001904, 0.020200271159410477, 0.03983151912689209, 0.024131692945957184, -0.0014306369703263044, -0.0016448283568024635, -0.011639080941677094, 0.026769885793328285, 0.08302544057369232, 0.003588716499507427, 0.043969858437776566, 0.042081743478775024, -0.005111496429890394, 0.04311632737517357, -0.030028827488422394, 0.019230347126722336, -0.006146081257611513, 0.004675030708312988, 0.022347034886479378, -0.06771358102560043, -0.016372306272387505, 0.0004659673722926527, 0.012815920636057854, 0.014238474890589714, 0.022230643779039383, -0.01607486419379711, 0.05591931566596031, -0.02692507393658161, 0.0188811756670475, -0.024170489981770515, 0.07640409469604492, -0.008334875106811523, 0.04826338589191437, 0.0164886973798275, 0.00953111331909895, -0.04790128394961357, -0.00019378261640667915, 0.061661262065172195, -0.019928691908717155, 0.031192736700177193, -0.05297074839472771, 0.03990911319851875, 0.022812597453594208, -0.02568357065320015, -0.01401862595230341, 0.01957952044904232, -0.03561558574438095, -0.03450340777635574, -0.0264207124710083, 0.040167760103940964, -0.04792714864015579, 0.00235691387206316, 0.043762944638729095, 0.004836684558540583, 0.005932698026299477, -0.016307644546031952, 0.03724505752325058, -0.006443524267524481, 0.012130508199334145, -0.014057422988116741, 0.0016310878563672304, 0.03398611396551132, 0.0006163055077195168, 0.016126593574881554, -0.022463425993919373, -0.05804021656513214, 0.006698937620967627, -0.004406685009598732, 0.012098177336156368, -0.030727172270417213, -0.010113067924976349, -0.02573530003428459, -0.004251497332006693, -0.0037115735467523336, -0.028218304738402367, -0.025605976581573486, -0.05560893937945366, -0.0009173858561553061, 0.022747935727238655, 0.01694132760167122, -0.02025200054049492, 0.019682979211211205, 0.01789831928908825, -0.06905854493379593, 0.011251111514866352, -0.02971845306456089, -0.04570278897881508, -0.004154505208134651, 0.036908816546201706, -0.022812597453594208, -0.013016371987760067, -0.0301581509411335, 0.022062523290514946, 0.03765889257192612, 0.014406595379114151, 0.03781408071517944, -0.021260719746351242, -0.0447457991540432, -0.007267959415912628, -0.058609236031770706, -0.04226279631257057, 0.005143826827406883, -0.024920564144849777, 0.02664056234061718, -0.017148245126008987, 0.008612919598817825, 0.007785251829773188, 0.02331695891916752, -0.030701307579874992, -0.0028806724585592747, 0.027028530836105347, 0.040426407009363174, 0.02920115925371647, -0.03271874785423279, 0.03866761177778244, -0.03918490558862686, 0.02524387277662754, 0.032434236258268356, 0.003899092087522149, -0.018001778051257133, 0.0013958814088255167, -0.006957583595067263, 0.018674258142709732, -0.01743275672197342, 0.03388265520334244, -0.0035951826721429825, -0.032123863697052, 0.046814966946840286, -0.007836980745196342, 0.03127032890915871, -0.019217414781451225, -0.034037843346595764, -0.07888710498809814, -0.01318449154496193, -0.017768995836377144, 0.010759683325886726, -0.003226611763238907, -0.020394256338477135, -0.009356527589261532, -0.00814735610038042, -0.028890784829854965, -0.004232098814100027, -0.02124778740108013, 0.012647801078855991, -0.044228505343198776, 0.009957879781723022, -0.014962684363126755, -0.034322354942560196, 0.0536949597299099, -0.0007116812630556524, -0.029149429872632027, -0.047513313591480255, -0.0010661074193194509, -0.015130804851651192, 0.012977574951946735, 0.014225542545318604, -0.008748709224164486, 0.017329297959804535, 0.0026753719430416822, 0.058609236031770706, 0.06347178667783737, -0.0319945402443409, -0.03018401563167572, 0.0073067559860646725, 0.02992536872625351, -0.021894404664635658, -0.0036501449067145586, -0.01719997450709343, -0.08302544057369232, -0.03209799900650978, -0.03295153006911278, 0.013992761261761189, -0.024455001577734947, 0.01507907547056675, 0.027416501194238663, -0.022579817101359367, 0.023885980248451233, 0.010145398788154125, -0.01795004867017269, -0.005771044176071882, -0.01979936845600605, -0.001045092474669218, 0.033598147332668304, -0.06574787199497223, 0.009059084579348564, -0.027675148099660873, -0.03132205829024315, 0.017290500923991203, 0.01981230080127716, 0.052893154323101044, 0.011639080941677094, -0.012680131942033768, 0.017044786363840103, -0.025101616978645325, -0.04332324489951134, 0.041848961263895035, 0.02029079757630825, -0.011264043860137463, -0.0221271850168705, -0.024842970073223114, 0.010216526687145233, 0.002272853860631585, -0.0045263092033565044, -0.025993946939706802, 0.020109744742512703, -0.0036404458805918694, -0.006217208690941334, -0.009375926107168198, 0.08871565759181976, 0.07516259700059891, 0.053436312824487686, -0.011270510032773018, -0.0382537767291069, -0.0344516783952713, -0.017355162650346756, -0.030778901651501656, -0.03473618999123573, -0.018273357301950455, 0.03773648664355278, 0.0020707864314317703, 0.037115734070539474, 0.05209135264158249, -0.01717410981655121, 0.024571392685174942, -0.04759090766310692, -0.006660140585154295, -0.027985522523522377, 0.01368238590657711, 0.013591859489679337, 0.042521439492702484, 0.060937054455280304, 0.009589308872818947, -0.031451381742954254, -0.009763895533978939, -0.0162429828196764, -0.012059380300343037, 0.02023906819522381, 0.034296490252017975, 0.014406595379114151, 0.018105236813426018, -0.06088532507419586, 0.019501926377415657, 0.06331659853458405, 0.028606273233890533, -0.04575451835989952, -0.07314515858888626, 0.007901642471551895, 0.029382212087512016, -0.02757168933749199, -0.0033042056020349264, -0.008457731455564499, 0.0334688238799572, -0.028140710666775703, -0.025153346359729767, 0.03277047723531723, -0.006634275894612074, 0.05405706167221069, -0.01678614132106304, -0.029666723683476448, 0.008852167055010796, 0.035460397601127625, -0.04459061101078987, 0.006647208239883184, 0.05628142133355141, -0.014419527724385262, -0.010087203234434128, -0.05778156965970993, 0.07552470266819, -0.012602537870407104, 0.005528563167899847, 0.013294416479766369, -0.012072312645614147, 0.004312925972044468, -0.014652309007942677, -0.007791718002408743, 0.03137378767132759, 0.025748232379555702, 0.010332916863262653, 0.025774097070097923, -0.03214972838759422, 0.006388561800122261, -0.012389155104756355, -0.04503031075000763, 0.043788809329271317, -0.05959209427237511, -0.022799665108323097, 0.024636054411530495, 0.028166575357317924, -0.025864623486995697, 0.03915904089808464, 0.017161177471280098, 0.00980269256979227, -0.012130508199334145, 0.00659871194511652, 0.02899424359202385, 0.04073678329586983, 0.05462608486413956, 0.041848961263895035, -0.03698641061782837, -0.013203890062868595, -0.015945540741086006, -0.0025331166107207537, -0.04006430134177208, 0.042340390384197235, -0.014212610200047493, 0.010326450690627098, -0.02449379861354828, -0.0018315386259928346, -0.007086907047778368, 0.005677284672856331, 0.0005767002585344017, 0.02664056234061718, -0.012169305235147476, -0.023226432502269745, 0.06310968101024628, -0.007009312976151705, 0.026588832959532738, -0.012990507297217846, -0.045133769512176514, 0.005968261975795031, 0.04014189541339874, -0.048004742711782455, 0.008166754618287086, 0.011335170827805996, 0.03127032890915871, -0.016346441581845284, 0.006770065054297447, -0.04223693162202835, -0.038305506110191345, -0.01935967057943344, 0.0226186141371727, -0.0035693179816007614, -0.0579884871840477, -0.04130580276250839, -0.0020239066798239946, 0.016436967998743057, 0.029175294563174248, -0.03864174708724022, -0.07836981117725372, -0.03605528548359871, -0.03209799900650978, 0.034270625561475754, -0.02313590608537197, 0.023433348163962364, 0.018519069999456406, 0.007494274526834488, 0.008069762960076332, -0.014251407235860825, -0.0074296132661402225, -0.00883276853710413, -0.013055169023573399, 0.02354973927140236, 0.003931422717869282, -0.007830514572560787, 0.03815031796693802, 0.007649462204426527, -0.035693179816007614, 0.026472441852092743, -0.01837681420147419, -0.0057775103487074375, 0.0457286536693573, 0.008140889927744865, -0.02431274577975273, -0.05571239814162254, -0.011361035518348217, -0.04722880199551582, 0.017510350793600082, -0.013734115287661552, 0.021984929218888283, -0.0003568509710021317, 0.02450673095881939, -0.0415644496679306, 0.01819576323032379, -0.018221627920866013, -0.009000889025628567, -0.0448751226067543, 0.036184608936309814, 0.008632318116724491, -0.007836980745196342, 0.02235996723175049, 0.03321017697453499, -0.035253480076789856, 0.03233078122138977, 0.025360263884067535, -0.02149350196123123, 0.012279230169951916, -0.0035499196965247393, 0.05022909864783287, -0.00430969288572669, 0.006440291181206703, -0.005858337040990591, -0.04319392144680023, -0.0004671797505579889, -0.02141590788960457, -0.02739063650369644, -0.054833002388477325, 0.013488400727510452, 0.0015001482097432017, -0.003026160877197981, -0.061195697635412216, 0.015337721444666386, 0.03460686653852463, -0.022088387981057167, -0.019450196996331215, 0.00020297667651902884, 0.0022453726269304752, 0.01818283088505268, 0.018454408273100853, 0.00429676054045558, 0.02759755402803421, -0.017794860526919365, 0.0387452058494091, 0.009285399690270424, 0.01723877154290676, -0.022243576124310493, -0.03882279992103577, 0.019424332305788994, -0.0031845818739384413, 0.001745862071402371, 0.01156148687005043, -0.01047517266124487, 0.005981194321066141, -0.022450493648648262, 0.01841561123728752, 0.014859226532280445, -0.03866761177778244, -0.03064957819879055, 0.022553952410817146, -0.0055867587216198444, 0.03566731512546539, -0.020161474123597145, -0.03556385636329651, -0.02073049545288086, 0.02920115925371647, -0.027442365884780884, -0.006679539103060961, 0.011031261645257473, -0.019424332305788994, -0.02827003411948681, 0.026821615174412727, -0.029796047136187553, -0.010921337641775608, 0.015208398923277855, 0.021351246163249016, 0.00040292233461514115, -0.003241160651668906, -0.014626444317400455, 0.000708852312527597, -0.01981230080127716, -0.00978976022452116, -0.02808898128569126, 0.02286432683467865, 0.012427951209247112, 0.012402087450027466, -0.0205365102738142, 0.02573530003428459, 0.0024700716603547335, 0.00838013831526041, 0.015208398923277855, -0.029149429872632027, -0.040943700820207596, -0.02595514990389347, -0.029304618015885353, -0.008315476588904858, -0.017122380435466766, 0.04407331719994545, 0.004170670639723539, -0.005324879195541143, 0.0029922137036919594, -0.002731950953602791, -0.028192440047860146, -0.005696683190762997, 0.006731268484145403, -0.013798777014017105, -0.014290204271674156, 0.006407960318028927, 0.02308417670428753, 0.02124778740108013, 0.0570056289434433, 0.00860645342618227, -0.01308103371411562, -0.00665367441251874, 0.01625591516494751, -0.003954054322093725, -0.0008252431289292872, -0.006705403793603182, 0.0008672731346450746, -0.028476949781179428, -0.021377110853791237, -0.06067840754985809, 0.007752920966595411, -0.04733226075768471, -0.011567953042685986, -0.025153346359729767, 0.0031215366907417774, -0.0339602492749691, -0.01884237863123417, 0.024416204541921616, -0.017536215484142303, -0.01792418397963047, -0.011238179169595242, -0.016579223796725273, -0.001989959506317973, 0.010216526687145233, -0.027959657832980156, -0.007597733289003372, 0.020213203504681587, -0.010145398788154125, 0.033598147332668304, 0.0004631384217645973, -0.03204626962542534, -0.014923887327313423, 0.022799665108323097, -0.004177136812359095, 0.009964345954358578, -0.029356347396969795, -0.02242462895810604, -0.017135312780737877, 0.037400245666503906, 0.03181348741054535, -0.024235151708126068, -0.01132870465517044, -0.010817878879606724, 0.0018606364028528333, 0.015467044897377491, -0.01297110877931118, 0.00329935597255826, 0.024713648483157158, 0.003608115017414093, -0.0028548077680170536, -0.006705403793603182, -0.026019811630249023, -0.019204482436180115, -0.06507539004087448, 0.008625851944088936, -0.015544638969004154, 0.0006963241612538695, -0.07893883436918259, 0.026136202737689018, -0.023950641974806786, -0.01650162972509861, 0.0031474013812839985, -0.020381323993206024, -0.026459509506821632, -0.03385679051280022, 0.007739988621324301, 0.022243576124310493, -0.005105030257254839, 0.031063413247466087, -0.021609893068671227, -0.0007585608982481062, 0.014186746440827847, -0.011121788062155247, -0.016191253438591957, 0.021984929218888283, 0.008580588735640049, 0.014290204271674156, 0.022928988561034203, 0.029304618015885353, 0.024157557636499405, 0.010222992859780788, 0.006698937620967627, 0.010733818635344505, -0.032408371567726135, -0.014652309007942677, 0.017859522253274918, -0.03566731512546539, -0.017523283138871193, 0.006165479775518179, 0.002463605487719178, 0.0034690925385802984, 0.0029388677794486284, 0.001101671252399683, -0.005334578454494476, 0.03515002503991127, 0.007707657758146524, -0.019450196996331215, -0.028813190758228302, -0.010811412706971169, 0.021635757759213448, -0.007313222158700228, -0.000160542520461604, 0.010216526687145233, -0.03018401563167572, 0.020433053374290466, 0.04955662041902542, 0.00860645342618227, -0.004536008462309837, -0.013565994799137115, 0.016333509236574173, 0.010171263478696346, -0.017833657562732697, -0.010830811224877834, 0.004070444963872433, -0.0301581509411335, -0.010572165250778198, -0.017368094995617867, -0.006951117422431707, -0.04267662763595581, -0.010934269987046719, -0.03778821602463722, -0.006618110463023186, -0.01743275672197342, -0.012091711163520813, -0.006686005275696516, 0.005192323122173548, 0.04415091127157211, -0.05147060006856918, -0.09316437691450119, -0.014445392414927483, 0.026976801455020905, 0.021765081211924553, 0.03352055326104164, -0.01607486419379711, 0.026006879284977913, 0.003756836522370577, -0.004972473718225956, -0.03908144682645798, -0.008903896436095238, -0.0023779289331287146, -0.005308713763952255, 0.003934655804187059, -0.0003643274831119925, -0.046323541551828384, -0.02992536872625351, 0.037581298500299454, 0.006841192953288555, -0.011419231072068214, -0.006938185077160597, -0.005994126666337252, 0.011878328397870064, 0.027907928451895714, -0.01698012463748455, -0.0022777034901082516, 0.020601172000169754, -0.013992761261761189, 0.006243073381483555, 0.013928099535405636, 0.0012083628680557013, -0.015609300695359707, 0.005725780967622995, 0.024700716137886047, -0.04153858497738838, 0.0007589650340378284, -0.0018218393670395017, 0.01692839525640011, -0.018700122833251953, 0.026317253708839417, -0.0019172151805832982, -0.06254065781831741, 0.053901877254247665, 0.006456456612795591, 0.02710612490773201, -0.05416052043437958, 0.009647504426538944, -0.01330734882503748, 0.026226729154586792, 0.003427062649279833, -0.004332324489951134, -0.016618020832538605, -0.005884201731532812, -0.05705735832452774, -0.012473214417696, 0.02777860499918461, -0.00022631546016782522, 0.033624012023210526, -0.010164797306060791, -0.00477202283218503, -0.050565339624881744, 0.019424332305788994, -0.00012861588038504124, 0.005897134076803923, -0.039003852754831314, -0.007681793067604303, -0.017781928181648254, 0.008684047497808933, -0.013488400727510452, -0.02144177258014679, -0.011393366381525993, 0.007287357468158007, 0.002478154143318534, 0.02428688108921051, -0.024170489981770515, 0.0007359293522313237, -0.0032573260832577944, 0.03696054592728615, -0.026058608666062355, 0.013915167190134525, 0.05747119337320328, -0.010565699078142643, 0.01436779834330082, 0.02285139448940754, 0.0030293939635157585, 0.0362880676984787, 0.03246010094881058, -0.033132582902908325, -0.03659844398498535, 0.016398170962929726, 0.03372747078537941, -0.003979919012635946, 0.022502223029732704, -0.002019057283177972, 0.014820429496467113, -0.009000889025628567, -0.022450493648648262, 0.006039389409124851, 0.005619089584797621, -0.004969240631908178, -0.005861570127308369, 0.05638488009572029, -0.004038114566355944, 0.00966690294444561, 0.0015939074801281095, 0.02354973927140236, 0.009375926107168198, 0.030287474393844604, 0.028709731996059418, 0.0025751465000212193, 0.0037406710907816887, 0.013902234844863415, -0.03302912414073944, 0.012085244990885258, -0.0028822890017181635, 0.026976801455020905, 0.02356267161667347, -0.017406892031431198, -0.0053766085766255856, -0.004481045994907618, 0.022023726254701614, 0.034322354942560196, -0.028606273233890533, 0.030597848817706108, 0.011160585097968578, -0.011167051270604134, -0.009117280133068562, 0.003818265162408352, -0.013119830749928951, 0.020355459302663803, 0.023485077545046806, -0.01191065926104784, 0.04368535056710243, 0.007959838025271893, -0.004817286040633917, 0.033624012023210526, 0.04177136719226837, 0.034762054681777954, -0.0028386423364281654, 0.02336868830025196, 0.0023763123899698257, 0.01119938213378191, -0.009020287543535233, 0.03683122247457504, -0.007578334771096706, 0.03393438458442688, -0.017743131145834923, -0.01368238590657711, -0.01472990307956934, 0.028709731996059418, 0.047539178282022476, -0.02190733700990677, 0.0046556321904063225, -0.006744200363755226, 0.004746158607304096, 0.013811709359288216, 0.020200271159410477, -0.020174406468868256, 0.0021112000104039907, 0.03450340777635574, 0.008638784289360046, 0.0294856708496809, -0.014678173698484898, 0.0054833004251122475, 0.019152753055095673, -0.03393438458442688, -0.03207213431596756, -0.016359373927116394, 0.0049498421140015125, 0.002017440740019083, 0.005218187812715769, -0.047746095806360245, 0.0012544342316687107, 0.018790649250149727, 0.03815031796693802, 0.018325086683034897, -0.009097881615161896, 0.004264429677277803, 0.0207822248339653, 0.02546372264623642, 0.02449379861354828, 0.021622825413942337, -0.0188811756670475, -0.00385706196539104, 0.04451301693916321, -0.009421189315617085, 0.022295305505394936, -0.008050364442169666, 0.009479384869337082, 0.025799961760640144, 0.03274461254477501, 0.007145102135837078, 0.012951710261404514, 0.013889302499592304, 0.02832176350057125, -0.02354973927140236, -0.013113364577293396, 0.03815031796693802, 0.010992464609444141, -0.0443836934864521, -0.04267662763595581, 0.038512423634529114, -0.005939164198935032, 0.00419653533026576, -0.014975616708397865, 0.007474876008927822, 0.0014993399381637573, -0.03602942079305649, 0.025101616978645325, 0.008212017826735973, 0.0021257486660033464, -0.0013013138668611646, 0.006340065971016884, -0.01002900768071413, 0.034813784062862396, -0.04668564721941948, -0.0013789077056571841, -0.002293868688866496, -0.0438922643661499, -0.016424035653471947, -0.01769140176475048, -0.02453259564936161, 0.002504018833860755, 0.005321646109223366, -0.003556385636329651, 0.0025331166107207537, 0.022463425993919373, -0.01436779834330082, 0.022773800417780876, -0.0025185677222907543, -0.01743275672197342, 0.06269584596157074, -0.014005693607032299, -0.03719332814216614, -0.00977682787925005, -0.013941031880676746, 0.006062021013349295, 0.004581271670758724, -0.002728717867285013, 0.0022178913932293653, 0.02219184674322605, 0.010041940025985241, -0.016799073666334152, 0.00718389917165041, 0.012175771407783031, 0.0102682551369071, 0.03277047723531723, 0.07635236531496048, -0.02263154648244381, -0.00894269347190857, -0.02334282360970974, 0.023873047903180122, 0.017355162650346756, 0.004031648393720388, -0.016061931848526, 0.005030669271945953, -2.0737163140438497e-05, 0.028451085090637207, 0.04482339322566986, -0.00241995882242918, -0.0162429828196764, 0.009278933517634869, -0.017587944865226746, -0.027028530836105347, -0.004587737377732992, -0.029666723683476448, -0.005767811089754105, 0.02242462895810604, 0.009576376527547836, 0.0018881175201386213, -0.027442365884780884, 0.01717410981655121, -0.03178762272000313, 0.014432460069656372, 0.0008939460385590792, 0.007739988621324301, 0.021118465811014175, -0.009822091087698936, 0.03191694617271423, -0.006171945948153734, -0.025101616978645325, -0.025373196229338646, -0.03225318714976311, 0.0010935886530205607, 0.030934089794754982, -0.02004508301615715, 0.04319392144680023, -0.0010652991477400064, 0.003708340460434556, 0.0035305211786180735, 0.03202040493488312, 0.05090158060193062, -0.012214568443596363, 0.019980421289801598, 0.01214990671724081, -0.026032743975520134, -0.009020287543535233, 0.013294416479766369, 0.0034367619082331657, -0.025088684633374214, 0.03859001770615578, -0.021105533465743065, -0.013759979978203773, -0.007022245321422815, -0.00814735610038042, 0.03129619359970093, 0.00368894194252789, 0.005405706353485584, -0.012550808489322662, -0.042107608169317245, -0.012188703753054142, -0.017859522253274918, 0.004238564986735582, 0.01676027663052082, 0.005366909317672253, -0.014794564805924892, -0.025981014594435692, -0.002570296870544553, 0.004154505208134651, -0.005428337957710028, -0.002130598295480013, -0.005438037216663361, 0.03256355971097946, 0.008994422852993011, -0.013488400727510452, -0.026343118399381638, 0.003656611079350114, -0.01744568906724453, -0.007552470080554485, 0.0007379500311799347, -0.033106718212366104, 0.024338610470294952, 0.03318431228399277, -0.020859818905591965, -0.019747640937566757, 0.009608707390725613, -0.03675362840294838, -0.016579223796725273, -0.02550251968204975, -0.010281187482178211, 0.007694725412875414, 0.015984337776899338, 0.01603606715798378, -0.022217711433768272, -0.030132286250591278, 0.004513376858085394, 0.030520256608724594, 0.024364475160837173, -0.012996973469853401, 0.003730971831828356, 0.06683418899774551, -0.002274470403790474, -0.025166278705000877, 0.0059423972852528095, 0.010416977107524872, 0.039521146565675735, -0.01815696619451046, -0.025825826451182365, -0.017820725217461586, 0.019954556599259377, -0.01763967238366604, 0.03781408071517944, 0.0064726220443844795, 0.0004970857407897711, 0.013992761261761189, 0.017135312780737877, -0.019023431465029716, 0.022010793909430504, 0.02004508301615715, -0.0027820635586977005, 0.016812006011605263, -0.008548257872462273, -0.01719997450709343, 0.004232098814100027, 0.013501333072781563, -0.008522393181920052, -0.01108945719897747, -0.010733818635344505, -0.004684729967266321, 0.01837681420147419, -0.011257577687501907, 0.0007763428147882223, -0.03584836795926094, 0.027675148099660873, -0.0035596187226474285, -0.01236975658684969, -0.01097953226417303, 0.010048406198620796, 0.0030924391467124224, -0.006834726780653, -0.010442841798067093, -0.014173814095556736, -0.009401790797710419, 0.020083880051970482, 0.008205551654100418, -0.011121788062155247, -0.0051502930000424385, 0.004710594657808542, -0.004280595108866692, 0.010307052172720432, 0.014484189450740814, -0.011555020697414875, 0.008806904777884483, -0.004920744802802801, -0.013410807587206364, -0.007248560898005962, -0.019527791067957878, 0.03108927793800831, 0.010630359873175621, 0.004911045543849468, -0.035046566277742386, 0.03535693883895874, -0.028632137924432755, 0.0076300641521811485, 0.011975320987403393, -0.029330482706427574, -0.0038344303611665964, 0.014678173698484898, -0.018725987523794174, 0.040710918605327606, -0.030028827488422394, 0.026795750483870506, -0.004442248959094286, -0.0068993885070085526, -0.033365365117788315, 0.029382212087512016, -0.021635757759213448, 0.01698012463748455, -0.010216526687145233, 0.01013893261551857, -0.023058312013745308, 0.005667585413902998, 0.008890964090824127, -0.011115321889519691, -0.010087203234434128, 0.018454408273100853, 0.024092895910143852, 0.0010539834620431066, -0.04345256835222244, 0.03062371350824833, -0.021778013557195663, -0.0013813325203955173, 0.037633027881383896, -0.011600283905863762, 0.0003340173570904881, -0.031503111124038696, 0.029123567044734955, 0.012001185677945614, -0.003941121976822615, 0.01747155375778675, -0.006159013602882624, 0.011399832554161549, 0.008806904777884483, 0.013255619443953037, -0.008522393181920052, 0.008438333868980408, -0.03918490558862686, 0.009434121660888195, 0.0029485670384019613, -0.005855103954672813, 0.02803725190460682, -0.004005783703178167, 0.014910955913364887, -0.0021031172946095467, 0.007119237445294857, 0.027157854288816452, -0.007791718002408743, 0.01438073068857193, 0.005353976972401142, -0.024623122066259384, 0.01793711632490158, -0.007539537735283375, -0.005415405612438917, 0.0026931539177894592, -0.0068735238164663315, 0.007461943663656712, 0.022217711433768272, -0.005712848622351885, -0.0013966896804049611, 0.004034881480038166, -0.015389450825750828, 0.020652901381254196, 0.014807497151196003, -0.013721182942390442, 0.016385238617658615, -0.004180369898676872, -0.00223890645429492, -0.02260568179190159, -0.008218483999371529, -0.02405410073697567, 4.9203405069420114e-05, 0.0018671024590730667, -0.015143737196922302, 0.0037956335581839085, -0.00945352017879486, -0.05113435909152031, -0.004041347652673721, -0.03142551705241203, 0.03602942079305649, 0.003465859452262521, -0.013074567541480064, 0.04557346552610397, -0.009485851041972637, 0.03892625868320465, 0.008852167055010796, -0.022049590945243835, 0.00630450202152133, -0.022566884756088257, 0.0123826889321208, 0.006559915374964476, 0.03326190635561943, -0.005066233221441507, -0.011244645342230797, 0.024623122066259384, 0.041383396834135056, -0.008334875106811523, -0.01542824786156416, 0.01599727012217045, -0.02808898128569126, 0.002476537600159645, -0.012809454463422298, -0.009996676817536354, 0.0123826889321208, -0.010222992859780788, -0.002229207195341587, -0.013462536968290806, -0.0009739647503010929, -0.005625555757433176, -0.005632021930068731, 0.05328112468123436, -0.0024797706864774227, -0.019889894872903824, 0.02098914235830307, 0.009938481263816357, -0.009718632325530052, 0.01862252876162529, 0.02548958733677864, 0.021040871739387512, -0.023433348163962364, -0.012001185677945614, 0.017743131145834923, 0.004232098814100027, 0.016553359106183052, 0.0027658981271088123, 0.007468409836292267, 0.014406595379114151, 0.004927210975438356, -0.011095923371613026, 0.02850281447172165, 0.0354345329105854, 0.03706400468945503, -0.012899980880320072, 0.013617724180221558, -0.0024797706864774227, -0.026485374197363853, 0.005877735558897257, 0.006204276345670223, 0.008102092891931534, -0.0033882656134665012, 0.017342230305075645, 0.029537400230765343, 0.013876370154321194, -0.017549147829413414, 0.0372709222137928, -0.006197810638695955, 0.005861570127308369, 0.014238474890589714, 0.007578334771096706, -0.013578927144408226, -0.03439994901418686, -0.011936523951590061, -0.0020885684061795473, 0.005324879195541143, 0.010054872371256351, -0.018312154337763786, 0.029123567044734955, 0.024209287017583847, 0.03018401563167572, -0.004322625230997801, 0.002604244276881218, -0.005337811540812254, -0.018014710396528244, -0.01629471220076084, -0.012809454463422298, -0.016618020832538605, -0.002668905770406127, -0.013009905815124512, -0.0004885988892056048, -0.013061635196208954, 0.015169601887464523, -0.033624012023210526, 0.01977350562810898, 0.03352055326104164, -0.006621343549340963, 0.006469388958066702, 0.05985073745250702, 0.006256005726754665, 0.01864839345216751, -0.04011603072285652, 0.0002424808481009677, 0.01577742025256157, 0.003224995220080018, -0.0033397695515304804, -0.03729678690433502, 0.03414130210876465, -0.050591204315423965, 0.022670341655611992, -0.029796047136187553, -0.008561190217733383, 0.02736477181315422, -0.025411993265151978, 0.0015155052533373237, 0.000636512238997966, -0.019708843901753426, -0.017393959686160088, 0.02596808224916458, -0.016126593574881554, 0.006527584511786699, -0.03491724282503128, -0.0247653778642416, 0.0037115735467523336, 0.030002962797880173, 0.0344516783952713, 0.02023906819522381, 0.012039982713758945, 0.02285139448940754, -0.01934673823416233, 0.009738030843436718, 0.0007015779265202582, -0.02407996542751789, 0.06352351605892181, 0.004432549700140953, -0.0006118600140325725, -0.014135017059743404, 0.030985819175839424, 0.005560894031077623, -0.04221106693148613, -0.009854421950876713, 0.005990893580019474, -0.004804353695362806, -0.012802988290786743, -0.0026155600789934397, 0.005599691066890955, -0.029149429872632027, -0.004012249875813723, 0.0022777034901082516, 0.012098177336156368, -0.02454552799463272, 0.009104347787797451, 0.03985738381743431, -0.02708026021718979, 0.011652013286948204, 0.015867946669459343, 0.021299516782164574, 0.031011683866381645, -0.0073067559860646725, -0.010158331133425236, -0.0008365589310415089, -0.01819576323032379, 0.04203001409769058, 0.03483964875340462, 0.007675326894968748, 0.017730198800563812, 0.03204626962542534, 0.007953371852636337, 0.01718704216182232, -0.004047813359647989, 0.006996380630880594, -0.016566291451454163, 0.004093076568096876, -0.009699233807623386, 0.0026511240284889936, -0.00048819478251971304, -0.010824345052242279, 0.035460397601127625, -0.02242462895810604, -0.002146763727068901, -0.005337811540812254, 0.016553359106183052, 0.00719683151692152, 0.01259607169777155, -0.004862549249082804, 0.0111864497885108, -0.011315773241221905, 0.006879989989101887, 0.010662690736353397, -0.0013498100452125072, 0.021855607628822327, -0.001681200577877462, -0.002019057283177972, -0.0024248084519058466, 0.014173814095556736, 0.00418360298499465, -0.006821794435381889, -0.018519069999456406, 0.012389155104756355, 0.023510942235589027, 0.03326190635561943, 0.0205365102738142, 0.0133332135155797, 0.0054121725261211395, 0.0032298448495566845, -0.03522761911153793, -0.03328777104616165, 0.0016763509484007955, 0.004578038584440947, -0.0022599215153604746, -0.031710028648376465, -0.01119938213378191, -0.0183897465467453, -0.02759755402803421, 0.01404449064284563, 0.005289315711706877, 0.014264339581131935, 0.0034302957355976105, 0.00896855816245079, 0.0001763037871569395, 0.008515927009284496, 0.006288336589932442, -0.03377920016646385, 0.04221106693148613, 0.0188811756670475, 0.01167141180485487, 0.018777716904878616, -0.027261313050985336, -0.021558163687586784, -0.01192359160631895, -0.019941624253988266, 0.03817618265748024, -0.015958473086357117, 0.009233670309185982, -0.04968594014644623, 0.006517885252833366, -0.0242739487439394, -0.0023795454762876034, 0.014329001307487488, 0.01168434415012598, -0.0014645842602476478, -0.014522986486554146]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" error, so we look at the ratio
between them:
|
θ1−θ2, ϕ(x, a1)−ϕ(x, a2)
|
∥θ1−θ2∥ΣD≤∥ϕ(x, a1)−ϕ(x, a2)∥Σ−1
D· ∥θ1−θ2∥ΣD
∥θ1−θ2∥ΣD=∥ϕ(x, a1)−ϕ(x, a2)∥Σ−1
D,
where we take a square root on the in-sample error to keep them being of the same order and use Cauchy-
Schwarz inequality (Lemma 7). Here, the ∥ϕ(x, a1)−ϕ(x, a2)∥Σ−1
Dis referred to as the elliptical potential in
the literature of linear function approximation (Abbasi-Yadkori et al., 2011). The elliptical potential can be
viewed as the uncertainty of ϕ(x, a1)−ϕ(x, a2), given the historical samples in D, and can be used to guide
our exploration. The complexity of the reward model space is characterized by the following fact:
Lemma 3 (Elliptical potential is usually small (Hu et al., 2022)) .For a fixed λ >0and{zt}T
t=1⊂Rdwith
∥zt∥ ≤1, we define Zt=λI+Pt−1
s=1zsz⊤
s. Then, for any constant c >0,∥zt∥Z−1
t> chappens at most
3d
log(1+ c2)log
1 +1
λlog(1+ c2)
.
The ratio between the out-of-sample error and the in-sample error in the linear case can be readily generalized
to the general function approximation using the variant of eluder dimension considered in Gentile et al.
(2022); Zhang (2023); Ye et al. (2023); Agarwal et al. (2023), which essentially states that there is some
low-rank structure in the reward model space so the generalization is limited (the elliptical potential cannot
be large for too many times). Moreover, if we can effectively estimate the in-sample error from the preference
data, by Lemma 3, we can infer the out-of-sample error safely most of the time. Such an in-sample error
estimation is provided in Lemma 8. Essentially, the eluder-type complexity measures and techniques reduce
the learning problem to an online supervised learning (in-sample error estimation and minimization) (Zhong
et al., 2022).
10
3 Offline Learning with Pessimism
3.1 Setup
In this section, we consider the offline setting, where we aim to learn a good policy from a pre-collected
dataset without further interactions with the human. We suppose that we are given an offline preference
dataset: Doff={(xi, a1
i, a2
i, yi)}noff
i=1.We denote Σ off:= ΣDofffor offline setting. To motivate the algorithmic
design, with a comparator policy π, we recall Lemma 1 and Lemma 2 to obtain that
J(π)−J(ˆπ) =Ex∼d0h
Eπ[r∗(x, a)−ˆr(x, a)] +Eˆπ[ˆr(x, a)−r∗(x, a)]−η·Ex∼d0
DKL(π∗(·|x)∥ˆπ(·|x))i
,
(4)
where ˆ πis induced by calling the Oracle 1 with ˆ r. In other words, the sub-optimality depends on the quality
of the learned reward ˆ r, under the distributions induced by πand ˆπ, separately. As we have mentioned in
Figure 2, the finite Dofffrom the behavior policy can hardly cover the whole prompt-space. The standard
way to handle this issue is to leverage the principle of pessimism with a conservative reward (Jin et al.,
2021b; Rashidinejad et al., 2021; Xie et al., 2021a; Zanette et al., 2021b), which means that we adopt an
estimator that is a lower bound of the true value with high probability. A technical motivation for doing so
is that in Equation (4),","[-0.0034019937738776207, -0.01452074758708477, 0.007845663465559483, 0.030713750049471855, 0.029487429186701775, 0.01452074758708477, -0.0042503150179982185, 0.031410522758960724, -0.004640507511794567, 0.07597611844539642, 0.037709351629018784, -0.05052997171878815, -0.01806035451591015, -0.00908591877669096, 0.024610020220279694, -0.017948869615793228, 0.031717102974653244, -0.03522883728146553, 0.02470756694674492, 0.04222443699836731, -0.01679222658276558, -0.03383529186248779, 0.023718150332570076, 0.01240952592343092, 0.050307005643844604, -0.027215950191020966, 0.029571043327450752, 0.012841524556279182, 0.05381873995065689, -0.025989629328250885, 0.020889252424240112, -0.030100589618086815, -0.03157774731516838, -0.04476069286465645, 0.008737532421946526, 0.0680050402879715, 0.019690802320837975, 0.04568043351173401, -0.012402557767927647, -0.010061400942504406, -0.031410522758960724, -0.03899141401052475, -0.07725818455219269, 0.02162783220410347, 0.001580803538672626, 0.031522005796432495, 0.015147843398153782, -0.004591733682900667, 0.03199581056833267, 0.016694679856300354, -0.07062490284442902, 0.0305465254932642, -0.019997382536530495, -0.018004612997174263, 0.018659578636288643, -0.009350692853331566, 0.0026216080877929926, 0.024805115535855293, 0.047352686524391174, -0.010047465562820435, 0.011838171631097794, -0.010277400724589825, 0.014172361232340336, 0.02486085705459118, -0.008249791339039803, -0.014938811771571636, -0.04545746371150017, 0.04398030787706375, -0.010590948164463043, 0.0464886873960495, 0.007859598845243454, -0.010744238272309303, 0.052035000175237656, -0.015607713721692562, -0.006894567981362343, 0.025264985859394073, 0.05504506081342697, 0.05250880867242813, 0.03667812794446945, -0.010674561373889446, 0.02331402152776718, -0.0011087398743256927, 0.04576404392719269, -0.04161128029227257, -0.01797674037516117, -0.055881187319755554, -0.04244740679860115, -0.004009928088635206, -0.03887992724776268, -0.020540865138173103, 0.008047726936638355, -0.021251574158668518, -0.01085572224110365, 0.01721029169857502, 0.046349335461854935, 0.008793273940682411, -0.004257282707840204, 0.008995338343083858, 0.041583407670259476, 0.0017576096579432487, -0.017851322889328003, -0.038740575313568115, 0.032441746443510056, -0.030407169833779335, 0.04322779178619385, -0.004835604224354029, -0.01935635134577751, 0.025710919871926308, -0.01771196722984314, -0.023411570116877556, -0.047965846955776215, -0.01721029169857502, -0.07385792583227158, 0.03258110210299492, 0.015119972638785839, -0.0576370544731617, -0.06460478156805038, 0.023216472938656807, -0.0030536074191331863, -0.0020920606330037117, -0.008667855523526669, 0.0016130292788147926, 0.01870138570666313, 0.02293776534497738, 0.03199581056833267, -0.02819143235683441, -0.005678699351847172, -0.05819447338581085, -0.012723073363304138, -0.029180848971009254, 0.00620476296171546, 0.02881852723658085, -0.005135216284543276, -0.05136609822511673, -0.04682314023375511, 0.014715843833982944, 0.03157774731516838, 0.006685536354780197, 0.014395328238606453, -0.0058877309784293175, -0.0097966268658638, -0.03207942470908165, -0.04595914110541344, -0.006142053287476301, -0.07363495975732803, 0.015496229752898216, 0.006232633721083403, -0.019927704706788063, -0.015050294809043407, 0.022310668602585793, 0.017725903540849686, -0.012472235597670078, -0.026477370411157608, 0.0033584453631192446, 0.0003277010109741241, -0.019216997548937798, -0.026714272797107697, 0.03199581056833267, 0.016304485499858856, -0.03645515814423561, -0.04484430328011513, 0.05323345214128494, 0.02313286066055298, -0.007775985635817051, 0.039966896176338196, 0.030741620808839798, -0.03180071711540222, 0.0013081911019980907, -0.05197925865650177, -0.02915297821164131, 0.002276705577969551, 0.020178543403744698, -0.013552233576774597, -0.03246961906552315, -0.0025031566619873047, -0.037207674235105515, 0.00020097543892916292, -0.019662931561470032, 0.0097966268658638, -0.013663716614246368, 0.019426029175519943, 0.02132125198841095, 0.036622386425733566, 0.019523577764630318, 0.002198318485170603, 0.003428122727200389, -0.010535206645727158, -0.01751687191426754, -0.0016051905695348978, 0.0025954791344702244, 0.010695463977754116, 0.04398030787706375, 0.027829110622406006, -0.03968818485736847, -0.00783869531005621, -0.021237637847661972, 0.04384095221757889, 0.08662281185388565, 0.0008639984298497438, 0.043395016342401505, 0.003947218414396048, 0.025264985859394073, 0.0345878079533577, -0.040468569844961166, 0.03199581056833267, 0.0236206017434597, 0.01778164505958557, 0.02370421402156353, -0.038322512060403824, -0.0004716281546279788, -0.008660887368023396, 0.018771061673760414, 0.035897739231586456, 0.013559200800955296, 0.009065015241503716, 0.01989983394742012, -0.018074288964271545, 0.03377955034375191, 0.005852892529219389, 0.0572468638420105, -0.017029130831360817, 0.04520662873983383, 0.011970559135079384, 0.015691326931118965, -0.01736358180642128, -0.009294950403273106, 0.048467524349689484, -0.04261463135480881, 0.017224226146936417, -0.04021773114800453, 0.048579007387161255, 0.007343986537307501, -0.022004088386893272, -0.023230409249663353, 0.03940947726368904, -0.004069153685122728, 0.029459558427333832, 0.003321864875033498, 0.0097966268658638, -0.03729128837585449, -0.011907849460840225, 0.031215427443385124, -0.011266818270087242, -0.01636022888123989, -0.009685143828392029, 0.035981353372335434, -0.01644384115934372, -0.014729779213666916, -0.017837386578321457, -0.013357136398553848, 0.01793493516743183, -0.007601792458444834, 0.01538474578410387, -0.005525409244000912, -0.054877836257219315, -0.0018534159753471613, 0.008960499428212643, 0.001398771652020514, -0.025794534012675285, -0.001453642500564456, -0.03511735424399376, 0.022227056324481964, 0.0228541512042284, 0.0249723419547081, -0.003013542853295803, -0.032748326659202576, -0.005678699351847172, -0.0031894780695438385, 0.00044898304622620344, -0.02665853127837181, 0.02173931524157524, 0.02031789906322956, -0.047157589346170425, 0.032748326659202576, -0.032664716243743896, -0.027452852576971054, -0.006615858990699053, 0.05443190038204193, -0.04478856176137924, -0.03561903163790703, -0.04398030787706375, -0.008876887150108814, 0.04328353330492973, 0.009887207299470901, 0.0599224716424942, -0.009685143828392029, 0.019314546138048172, -0.04152766615152359, -0.02543221227824688, -0.038852058351039886, 0.010110175237059593, -0.03531245142221451, 0.010848754085600376, -0.03890779986977577, 0.04314417764544487, -0.01836693473160267, -0.0023794795852154493, -0.06638852506875992, 0.002492705127224326, 0.008633016608655453, 0.03968818485736847, 0.01847841776907444, -0.020457252860069275, 0.014088748022913933, -0.01670861430466175, 0.020429382100701332, 0.03545180708169937, 0.051951389759778976, -0.02101467177271843, -0.006922438740730286, -0.006197795271873474, 0.04935939237475395, -0.012479202821850777, 0.05289899930357933, -0.012270171195268631, -0.03107607178390026, 0.023021377623081207, -0.03453206643462181, 0.023801762610673904, -0.042168695479631424, -0.04556895047426224, -0.06945432722568512, -0.01651351898908615, -0.015315068885684013, 0.006169924046844244, -0.02105647698044777, -0.022004088386893272, -0.007553018629550934, -0.007601792458444834, -0.026031436398625374, -0.0068248906172811985, -0.011231979355216026, 0.01620693877339363, 0.005309409461915493, 0.019718673080205917, -0.020415445789694786, -0.04325566440820694, 0.04871836304664612, 0.03219090774655342, -0.008437920361757278, -0.059866730123758316, 0.010611851699650288, -0.00709663238376379, 0.015064230188727379, 0.01963506080210209, 0.00047206366434693336, 0.0004147976287640631, 0.032664716243743896, 0.05919782817363739, 0.06577536463737488, -0.02385750412940979, -0.030685879290103912, 0.0060967630706727505, 0.003548316191881895, 0.008862951770424843, 0.006124633830040693, -0.020694155246019363, -0.06705742329359055, -0.05181203410029411, -0.03180071711540222, 0.018798932433128357, -0.02884639799594879, 0.016374163329601288, 0.017642289400100708, 0.010354045778512955, 0.027522530406713486, 0.009991724044084549, -0.01751687191426754, 0.006431214045733213, -0.03249748796224594, -0.0008465790888294578, 0.04866262152791023, -0.0541531927883625, -0.005340764299035072, -0.02689543552696705, -0.01948177069425583, -0.01217959076166153, 0.02696511149406433, 0.04353437200188637, 0.0066228266805410385, 0.006769149098545313, 0.01970473863184452, -0.030379299074411392, -0.03347297012805939, 0.04294908419251442, 0.024832986295223236, -8.715104922885075e-05, -0.03461567685008049, -0.05825021490454674, -0.02973826788365841, 0.007155857980251312, -0.024540342390537262, -0.02777336910367012, 0.005086442455649376, -0.02217131480574608, -0.010033530183136463, -0.020150672644376755, 0.05055784434080124, 0.05563034862279892, 0.038322512060403824, -0.03352871164679527, -0.03191220015287399, -0.04629359394311905, -0.009859336540102959, -0.014019071124494076, 0.020234284922480583, 0.040858764201402664, 0.041889987885951996, 0.0008230630191974342, 0.0484117828309536, 0.0376536101102829, -0.0051979259587824345, 0.03065800853073597, -0.04253101721405983, -0.0002512737410143018, -0.04010624811053276, 0.03352871164679527, 0.005807602312415838, 0.04359011352062225, 0.04732481762766838, 0.005016765091568232, -0.06103730946779251, 0.009169531986117363, -0.001249836408533156, -0.03035142831504345, 0.0334172286093235, 0.02081957459449768, 0.0002220963651780039, 0.009483079425990582, -0.08216346055269241, 0.014897004701197147, 0.04983320087194443, 0.023495182394981384, -0.008570306934416294, -0.08389145880937576, -0.008939596824347973, 0.011789397336542606, -0.03709619119763374, -0.02862343192100525, -0.04749204218387604, 0.03542393445968628, -0.04991681128740311, -0.038015931844711304, 0.029710397124290466, 0.006765665020793676, 0.01898009516298771, -0.04113747179508209, -0.0007516437908634543, 0.030490782111883163, -0.0031145750544965267, -0.032330263406038284, 0.011371334083378315, 0.07212993502616882, 0.002860252745449543, 0.007378824986517429, -0.06226362660527229, 0.04749204218387604, -0.025808468461036682, 0.018882546573877335, 0.027647949755191803, 0.006365020759403706, 0.004023863468319178, -0.015468358993530273, 0.010347077623009682, 0.03826676681637764, 0.03283194079995155, -0.00977572426199913, 0.0170988067984581, -0.04607062414288521, 0.02589208073914051, -0.0170988067984581, -0.04233592376112938, 0.06711316853761673, -0.046126365661621094, -0.02762007899582386, 0.021767186000943184, -0.007476373575627804, -0.0009589337278157473, 0.02724382095038891, -0.0046927654184401035, 0.008382177911698818, -0.012953008525073528, 0.03938160464167595, -0.006291859317570925, 0.027411047369241714, 0.05936505272984505, 0.042809728533029556, -0.016471711918711662, -0.017544742673635483, -0.017419323325157166, -0.011879978701472282, -0.03550754860043526, 0.06889690458774567, -0.015914293006062508, -0.007288244552910328, -0.008026824332773685, -0.00041457987390458584, 0.005072506610304117, 0.024805115535855293, 0.013531330041587353, 0.03316638991236687, -0.032664716243743896, -0.019774414598941803, 0.03796019032597542, -0.005173538811504841, 0.008612113073468208, -0.008061662316322327, -0.04384095221757889, 0.0034176711924374104, 0.030908847227692604, -0.06778206676244736, 0.0318843275308609, -0.014228102751076221, 0.015621649101376534, -0.00040543475188314915, 0.03135478124022484, -0.024233762174844742, -0.02416408434510231, 0.0021373508498072624, 0.033807422965765, 0.0031494135037064552, -0.05270390212535858, -0.020540865138173103, 0.017795579507946968, 0.021502412855625153, -0.006535729859024286, -0.027104467153549194, -0.08361274749040604, -0.05086442455649376, -0.015802809968590736, 0.04359011352062225, -0.015106037259101868, 0.03522883728146553, 0.025487953796982765, -0.005626441445201635, 0.007141922600567341, -0.019844092428684235, -0.012862428091466427, 0.007065277546644211, -0.01824151538312435, 0.03246961906552315, 0.004016895778477192, -0.03138265386223793, 0.025975694879889488, 0.013217782601714134, -0.025209244340658188, 0.02604537084698677, -0.021850798279047012, -0.011510688811540604, 4.0391056245425716e-05, -0.0011766753159463406, -0.031326908618211746, -0.030908847227692604, -0.0217114444822073, -0.047659266740083694, 0.002025867346674204, -0.009267079643905163, 0.025724856182932854, -0.0010155464988201857, -0.0014423199463635683, -0.026979047805070877, 0.005971343722194433, 0.003961154259741306, 0.021613895893096924, -0.04372946918010712, 0.024484600871801376, 0.008974434807896614, -0.0054766349494457245, 0.011698816902935505, 0.0407194085419178, -0.054766349494457245, 0.0572468638420105, 0.00891172606498003, -0.03138265386223793, 0.020499059930443764, 0.009134693071246147, 0.03138265386223793, -0.010298303328454494, 0.019760480150580406, 0.017684096470475197, -0.022993506863713264, 0.005584634840488434, -0.016346292570233345, -0.006567084696143866, -0.02224099077284336, 0.023871440440416336, 0.023411570116877556, 0.007643599063158035, -0.059142086654901505, 0.02309105359017849, 0.026881499215960503, -0.03520096838474274, -0.02527892217040062, 0.009197402745485306, -0.025334663689136505, 0.03004484809935093, 0.0027748981956392527, 0.019495707005262375, 0.004961023107171059, -0.019035836681723595, 0.05524015799164772, -0.007971081882715225, 0.03369593992829323, -0.0057135378010571, -0.01806035451591015, 0.04660017415881157, -0.0067099230363965034, 0.012925137765705585, 0.013740361668169498, -0.026142919436097145, -0.005880763288587332, -0.013803071342408657, 0.0042816693894565105, -0.023564860224723816, -0.044426240026950836, -0.030184201896190643, 0.0025170922745019197, -0.015956100076436996, 0.04130470007658005, -0.013169008307158947, -0.022185249254107475, -0.05220222845673561, 0.02532072737812996, -0.01729390397667885, -0.011434043757617474, 0.010695463977754116, -0.023272216320037842, -0.058528926223516464, 0.013343201018869877, -0.007810824550688267, -0.001860383665189147, 0.002220963593572378, 0.013837910257279873, 0.021572088822722435, 0.012395590543746948, -0.011308624409139156, -0.0038601220585405827, -0.005661279894411564, -0.0030919297132641077, -0.0464886873960495, 0.006155988667160273, 0.012221396900713444, 0.020944993942975998, -0.014492876827716827, -0.0038078639190644026, 0.010834818705916405, 0.008340371772646904, 0.014994553290307522, -0.039743926376104355, -0.014409263618290424, -0.016388099640607834, -0.025906017050147057, 0.018603837117552757, -0.02062447927892208, 0.03168923407793045, 0.0070339227095246315, 0.025864209979772568, 0.009552756324410439, -0.028024205937981606, -0.029989106580615044, -0.0211261548101902, 0.0017131904605776072, -0.007908372208476067, -0.009350692853331566, 0.009420369751751423, 0.04333927482366562, 0.021655702963471413, 0.051115259528160095, 0.015649519860744476, -0.010402820073068142, 0.0023881890811026096, 0.01365674939006567, 0.001980577129870653, 0.0035605095326900482, -0.025766663253307343, -0.03614857792854309, -0.005016765091568232, -0.040552183985710144, -0.04660017415881157, -0.0007856114534661174, -0.03166136145591736, -0.02232460491359234, -0.02147454209625721, -0.00020293511624913663, -0.027411047369241714, -0.03411400318145752, 0.02523711510002613, -0.010974173434078693, -0.013461653143167496, -0.01335016917437315, -0.021795056760311127, -0.03297129273414612, 0.053567901253700256, -0.023787828162312508, -0.0045081209391355515, 0.02447066456079483, 0.008542436175048351, 0.04297695308923721, -0.007803856860846281, -0.03915863856673241, -0.00385663821361959, 0.027801239863038063, -0.012095977552235126, -0.0015520616434514523, -0.043896693736314774, -0.011866042390465736, -0.019119448959827423, 0.05125461518764496, 0.03645515814423561, -0.04484430328011513, 0.012458300217986107, -0.02661672607064247, -0.018882546573877335, -0.001975351246073842, -0.007950179278850555, -0.015872487798333168, 0.02827504463493824, 0.005239732563495636, 6.085875793360174e-05, -0.041471924632787704, -0.03199581056833267, 0.009134693071246147, -0.05830595642328262, 0.01716848462820053, 0.0021390928886830807, 0.0029525752179324627, -0.05206287279725075, 0.017614418640732765, -0.017544742673635483, -0.030908847227692604, 0.009378563612699509, -0.009336757473647594, 0.022770538926124573, -0.013099330477416515, -0.00013565298286266625, 0.015510165132582188, -0.009650304913520813, 0.0234394408762455, 0.020889252424240112, 0.0020241253077983856, 0.00574489263817668, 0.0027139305602759123, -0.01751687191426754, -0.010131077840924263, 0.021599959582090378, 0.002229673322290182, 0.0023847052361816168, 0.021042542532086372, 0.011378301307559013, 0.03545180708169937, -0.0006998212775215507, 0.0137333944439888, -0.024080472066998482, -0.009211338125169277, -0.0005042894044891, -0.0071976641193032265, 0.003361929440870881, 0.010228626430034637, -0.024066535755991936, -0.000663240731228143, 0.017962805926799774, 0.011183205060660839, -0.029571043327450752, 0.04941513389348984, 0.0022941248025745153, -0.026268338784575462, -0.02816356159746647, -0.011524624191224575, 0.03907502442598343, -0.01909157820045948, 0.01909157820045948, -0.0012028042692691088, -0.00016308840713463724, 0.01825544983148575, 0.039966896176338196, 0.00771327642723918, 0.009726949967443943, -0.02385750412940979, 0.00868179090321064, 0.0013726426986977458, -0.022923829033970833, -0.00013064492668490857, 0.02359273098409176, -0.02873491495847702, -0.009023209102451801, -0.009016241878271103, 0.002870704513043165, -0.021084347739815712, -0.012862428091466427, -0.03461567685008049, 0.006894567981362343, -0.02711840160191059, -0.0282332394272089, -0.03450419381260872, 0.020526930689811707, 0.0220877006649971, -0.043785210698843, -0.09699078649282455, -0.016611065715551376, 0.04124895855784416, 0.006657665129750967, 0.002445672871544957, -0.03046291135251522, 0.02488872781395912, -0.011921784840524197, -0.011475849896669388, -0.025334663689136505, -0.006075860001146793, -0.02178112231194973, 0.011071722023189068, 0.003999476321041584, 0.012841524556279182, -0.059755247086286545, -0.010193787515163422, -0.0045464434660971165, 0.010068369098007679, -0.005717021878808737, -0.014757649973034859, -0.006333665922284126, -0.005023732781410217, 0.026449499651789665, -0.03829463943839073, -0.012702170759439468, 0.012291074730455875, 0.002605930669233203, 0.0020241253077983856, 0.009984755888581276, -0.017962805926799774, -0.0128693962469697, 0.017990676686167717, 0.0047310879454016685, -0.04002263769507408, 0.004511604551225901, 0.0016626743599772453, -0.014757649973034859, -0.038433995097875595, 0.015565906651318073, 0.014506812207400799, -0.03433696925640106, 0.052731774747371674, 0.006567084696143866, 0.019579319283366203, -0.04113747179508209, 0.015315068885684013, 0.0105630774050951, 0.010089271701872349, -0.02532072737812996, 0.013127202168107033, -0.005939989350736141, -0.01108565740287304, -0.045819785445928574, -0.017767708748579025, -0.0022261894773691893, 0.01898009516298771, 0.0040029603987932205, -0.02289595827460289, -0.0052745710127055645, -0.041973602026700974, 0.023801762610673904, 0.013050557114183903, -0.008897789753973484, -0.025766663253307343, 0.009517918340861797, -0.005905150435864925, 0.03129903972148895, -0.021028606221079826, -0.03004484809935093, -0.00010974173346767202, 0.0137333944439888, -0.019607190042734146, 0.02554369531571865, -0.03653877228498459, 0.007051341701298952, -0.0005587248015217483, 0.036287933588027954, -0.04255888983607292, 0.031410522758960724, 0.0242058914154768, -0.04924790933728218, 0.022157378494739532, 0.02773156203329563, -0.0055916025303304195, 0.040245603770017624, 0.007434566970914602, -0.008925661444664001, -0.016527453437447548, 0.022254927083849907, 0.03564690425992012, -0.011845139786601067, -0.0088350810110569, -0.028762785717844963, 0.015928229317069054, -0.018102159723639488, -0.001491965027526021, 0.012771847657859325, 0.021767186000943184, 0.0003011365479324013, 0.056522220373153687, 0.04044070094823837, -0.01854809559881687, -0.006023602094501257, 0.006999083794653416, 0.015551971271634102, 0.019565382972359657, 0.0032870261929929256, 0.046739526093006134, -0.0025031566619873047, -0.0013682878343388438, 0.02685362845659256, -0.030825233086943626, 0.016959453001618385, 0.0017576096579432487, 0.042085085064172745, 0.02923659235239029, -0.008005920797586441, 0.018046418204903603, 0.016764355823397636, 0.008633016608655453, 0.047575656324625015, -0.013663716614246368, -0.0038636059034615755, 0.005138700362294912, -0.029989106580615044, 0.009713014587759972, 0.023523053154349327, -0.02158602513372898, 0.02300744131207466, 0.05484996363520622, 0.017182420939207077, 0.02904149517416954, 0.010556109249591827, -0.0007285631727427244, 0.011385269463062286, 0.02862343192100525, 0.018952222540974617, -0.020582672208547592, 0.021558154374361038, 0.00027239465271122754, 0.012883331626653671, -0.011754559352993965, -0.005417409352958202, 0.0045290240086615086, 0.02720201388001442, 0.017684096470475197, -0.007950179278850555, -0.017920998856425285, 0.013942426070570946, 0.0217114444822073, -0.036287933588027954, 0.004814700689166784, -0.018074288964271545, 0.0064137945882976055, 0.015607713721692562, 0.026825757697224617, -0.02346731163561344, -0.011956622824072838, 0.010751206427812576, 0.026031436398625374, 0.023536989465355873, -0.024596083909273148, -0.026324080303311348, 0.04977745562791824, -0.04941513389348984, -0.02578059770166874, -0.014395328238606453, -0.007337018847465515, -0.025362534448504448, 0.004849539604038, -0.05342854559421539, 0.015217520296573639, 0.025362534448504448, 0.03626006096601486, 0.01847841776907444, -9.248571586795151e-05, 0.0361207090318203, -0.0039263153448700905, 0.011670946143567562, 0.027912722900509834, 0.01659713126718998, -0.02619866095483303, -0.0067865680903196335, 0.04810520261526108, 0.008277662098407745, 0.01498061791062355, -0.0045847659930586815, -0.0036127676721662283, 0.030239945277571678, 0.04359011352062225, 0.033946774899959564, 0.005448764190077782, 0.019105512648820877, 0.010068369098007679, 0.004842571914196014, -0.04236379265785217, 0.0353403240442276, 0.020610542967915535, -0.06460478156805038, -0.08110436797142029, 0.040357086807489395, 0.015524100512266159, 0.00023363667423836887, -0.030407169833779335, 0.01825544983148575, 0.006082827690988779, -0.016875840723514557, 0.006685536354780197, 0.022561507299542427, 0.006037537474185228, 0.00900927372276783, -0.006803987547755241, 0.004013412166386843, 0.013538298197090626, -0.02539040520787239, 0.01436745747923851, 0.006103730760514736, -0.0434228889644146, -0.022840216755867004, -0.016346292570233345, -0.02151634730398655, 0.027675820514559746, 0.0003309671301394701, -0.01513390801846981, -0.00328005850315094, 0.0020014801993966103, 0.004943603649735451, 0.014966682530939579, 7.152809848776087e-05, -0.021655702963471413, 0.036009225994348526, -0.015496229752898216, -0.008897789753973484, -0.017043065279722214, -0.03542393445968628, 0.012820621952414513, -0.008465791121125221, 0.01196359097957611, 0.007316115777939558, 0.035981353372335434, -0.004703217186033726, -0.012388622388243675, -0.011726688593626022, 0.03469929099082947, 0.010981141589581966, 0.029375946149230003, 0.06666723638772964, -0.027411047369241714, 0.0018116096034646034, -0.01970473863184452, 0.03581412881612778, 0.013322298415005207, 0.008967467583715916, 0.002971736481413245, 0.015301133506000042, -0.007232503034174442, 0.02370421402156353, 0.026365887373685837, -0.011998429894447327, -0.030016977339982986, 0.003283542348071933, -0.011859075166285038, -0.02258937805891037, -0.014660102315247059, -0.03316638991236687, -0.007782953325659037, 0.026031436398625374, 0.021084347739815712, 0.01158036570996046, -0.025822404772043228, 0.018687449395656586, -0.010500367730855942, 0.05144971236586571, 0.033974647521972656, -0.0040796054527163506, 0.01843661069869995, -0.004567346535623074, 0.03871270269155502, -0.011573398485779762, -0.025292856618762016, -0.023495182394981384, -0.013684620149433613, -0.01212384831160307, 0.03216303884983063, -0.017502935603260994, 0.03929799422621727, -0.013315330259501934, 0.010367981158196926, 0.014283845201134682, 0.04977745562791824, 0.048467524349689484, -0.01659713126718998, 0.008479726500809193, 0.010061400942504406, -0.03807167336344719, -0.01583068072795868, 0.02300744131207466, -0.0036650255788117647, -0.010507335886359215, 0.022909892722964287, -0.007573921699076891, -0.001437094178982079, -0.02282628044486046, 0.02486085705459118, 0.0074066962115466595, 0.005689150653779507, 0.016346292570233345, -0.035284578800201416, -0.02915297821164131, -1.891629653982818e-05, -0.014966682530939579, 0.029097236692905426, -0.006326698232442141, -0.01093236729502678, 0.002863736590370536, -0.029264463111758232, 0.005062055308371782, -0.016388099640607834, 0.010848754085600376, -0.007622695527970791, 0.006486956030130386, 0.013573136180639267, 0.0043757339008152485, -0.008800242096185684, -0.033361487090587616, -0.004675346426665783, 0.013322298415005207, 0.005605537910014391, 0.02024822123348713, -0.01874319091439247, 0.013691587373614311, 0.000549144169781357, -0.0242058914154768, -0.03829463943839073, -0.009371595457196236, -0.04261463135480881, -0.010556109249591827, -0.014994553290307522, 0.013064492493867874, 0.037207674235105515, 0.014715843833982944, 0.012653396464884281, -0.016680743545293808, -0.025989629328250885, 0.02051299437880516, 0.004915732890367508, 0.0176701620221138, -0.03283194079995155, 0.002717414405196905, 0.07647779583930969, -0.02151634730398655, -0.023453377187252045, 0.009343724697828293, -0.008723597042262554, 0.03581412881612778, -0.005657796282321215, -0.01874319091439247, -0.01279275119304657, 0.0112389475107193, -0.012597654014825821, 0.033863164484500885, -0.004961023107171059, 0.00971998181194067, 0.022463958710432053, 0.0129669439047575, -0.02366240881383419, 0.030713750049471855, 0.003008316969498992, 0.029933365061879158, 0.004198056645691395, -0.0003775638178922236, -0.004832120146602392, -0.002632059622555971, 0.015119972638785839, -0.0063754720613360405, -0.014562553726136684, -0.014771586284041405, -0.011879978701472282, 0.040775150060653687, -0.007413663901388645, -0.00034294291981495917, -0.058528926223516464, 0.02339763380587101, -0.007706308271735907, -0.007504244334995747, -0.0228541512042284, 0.016583194956183434, -0.009322822093963623, -0.0129669439047575, -0.008382177911698818, -0.014632231555879116, -0.015886422246694565, 0.008800242096185684, 0.00293341395445168, 0.014938811771571636, -0.0040412829257547855, 0.02954317256808281, 0.008340371772646904, 0.028261110186576843, 0.012325912714004517, 0.0007647082675248384, 0.007420631591230631, 0.0001970560842892155, -0.018952222540974617, -0.00047206366434693336, -0.016109390184283257, 0.04272611439228058, -0.007518179714679718, -0.007901404984295368, -0.03338935971260071, 0.03525670990347862, -0.02328615076839924, 0.025989629328250885, 0.02600356563925743, -0.025641243904829025, 0.011977526359260082, -0.0010625787544995546, -0.019272739067673683, 0.036399416625499725, -0.031020330265164375, 0.0019318029517307878, -0.007629663683474064, -0.022728731855750084, -0.016276614740490913, 0.004354830831289291, -0.041165344417095184, 0.0016896743327379227, 0.012472235597670078, -0.010834818705916405, -0.028595561161637306, 0.0012054170947521925, -0.01033314224332571, -0.010423722676932812, -0.014109651558101177, 0.003692896571010351, 0.02005312405526638, 0.02689543552696705, -0.03403038904070854, 0.0426425039768219, -0.030072718858718872, -0.0036685094237327576, 0.025989629328250885, 0.007281276863068342, 0.007699340581893921, -0.02615685574710369, 0.017767708748579025, -0.006685536354780197, -0.0006048859795555472, 0.015997905284166336, -0.018729256466031075, 0.01725209690630436, 0.023146796971559525, 0.004954055417329073, -0.016332358121871948, 0.007622695527970791, -0.03865696117281914, -0.005978311412036419, -0.004194573033601046, -0.013015718199312687, 0.0006275310879573226, -0.011726688593626022, 0.006027085706591606, -0.007971081882715225, -0.007281276863068342, 0.000697208393830806, 0.008138307370245457, -0.0025136081967502832, 0.025460083037614822, -0.028525883331894875, 0.012298041954636574, 0.0019352867966517806, 0.0057135378010571, 0.007894436828792095, 0.0030414138454943895, 0.03553541749715805, -0.0020694155246019363, -0.0039054122753441334, -0.02020641416311264, 0.009399466216564178, 0.0031476716976612806, 0.01932848058640957, 0.006479988340288401, 0.0007359663723036647, 0.005379086825996637, 0.012632492929697037, 0.0018203192157670856, -0.04244740679860115, -0.025487953796982765, -0.023801762610673904, 0.025251051411032677, 0.0030013492796570063, -0.009413402527570724, 0.025251051411032677, -0.02539040520787239, -0.035368192940950394, 0.013231717981398106, -0.04476069286465645, 0.03835038095712662, 0.012298041954636574, -0.0027748981956392527, 0.059030599892139435, -0.009385530836880207, 0.02704872377216816, 0.01655532419681549, -0.007302180398255587, -0.0027383174747228622, -0.01119714044034481, 0.0040970249101519585, -0.0001655924424994737, 0.027383174747228622, -0.004278185777366161, 0.002356834476813674, 0.015161778777837753, 0.046544432640075684, 0.005933021195232868, -0.0024317374918609858, -0.0037137996405363083, -0.03210729733109474, 0.004062185995280743, 0.004947087727487087, -0.011266818270087242, 0.019230931997299194, -0.01963506080210209, 0.016541389748454094, 0.0014397070044651628, 0.007190696429461241, -0.008249791339039803, 0.006347601301968098, 0.03489438816905022, -0.02427556924521923, -0.0217114444822073, 0.0364830307662487, 0.0020955444779247046, 0.011322559788823128, 0.03361232578754425, 0.039855409413576126, 0.016011841595172882, 0.01258371863514185, -0.010305271483957767, 0.010388883762061596, -0.021293381229043007, 0.03715193271636963, 0.004062185995280743, 0.008598177693784237, 0.02554369531571865, 0.009106822311878204, -0.03285980969667435, 0.03414187207818031, 0.02884639799594879, 0.02059660665690899, -0.022031959146261215, 0.020067060366272926, 0.0020067060831934214, -0.027285628020763397, 0.009726949967443943, -0.005546312313526869, 0.010681528598070145, 0.013823974877595901, 0.007504244334995747, 0.02239428088068962, -0.007734179496765137, -0.002135609043762088, 0.03004484809935093, -0.001424029702320695, -0.003306187456473708, 0.025000212714076042, 0.010186820290982723, -0.033138521015644073, -0.032748326659202576, -0.004807732999324799, -0.01825544983148575, 0.016694679856300354, 0.015161778777837753, -0.008207985199987888, -0.003017026698216796, 0.04347863048315048, 0.03422548621892929, 0.0028811560478061438, 0.022268861532211304, -0.0073300511576235294, -0.013141137547791004, -0.007239470724016428, -0.012395590543746948, -0.0020711575634777546, 0.00013064492668490857, -0.008138307370245457, -0.015858551487326622, 0.020150672644376755, 0.025613373145461082, -0.034671422094106674, 0.021140091121196747, 0.022059829905629158, -0.001980577129870653, -0.007964114658534527, 0.06348995119333267, 0.003403735812753439, 0.013872749172151089, -0.033751681447029114, 0.009678175672888756, -0.022491829469799995, 0.015147843398153782, -0.038517605513334274, -0.029598914086818695, 0.03606496751308441, -0.0169037114828825, -0.015064230188727379, -0.011015979573130608, -0.007364889606833458, 0.040775150060653687, -0.011663978919386864, -0.00469624949619174, 0.0007573050679638982, -0.0018516740528866649, -0.025710919871926308, 0.03107607178390026, -0.016471711918711662, 0.020847445353865623, -0.0305465254932642, -0.024136213585734367, -0.0034316065721213818, 0.023021377623081207, 0.005121280904859304, 0.0022348992060869932, 0.0013421588810160756, 0.007796889171004295, 0.01605364866554737, -0.007817791774868965, 0.004859990905970335, -0.02219918556511402, 0.01782345212996006, -0.013851845636963844, -0.020080994814634323, 0.006034053396433592, 0.012109912931919098, 0.00694334227591753, -0.04347863048315048, -0.021418798714876175, 0.011141398921608925, 0.026881499215960503, -0.027898788452148438, -0.005469667259603739, -0.007880501449108124, -0.011636108160018921, 0.003170316806063056, 0.001296868547797203, 0.025557629764080048, -0.02389931119978428, -0.016569260507822037, 0.02600356563925743, 0.003717283485457301, -0.010075336322188377, 0.005978311412036419, 0.010361013002693653, 0.007706308271735907, -0.003217349061742425, -0.021753249689936638, 0.014465006068348885, -0.021404864266514778, 0.03623219206929207, 0.020805640146136284, 0.011231979355216026, 0.02493053488433361, 0.04166702181100845, -0.0015834164805710316, 0.015106037259101868, -0.004462830722332001, 0.0019004481146112084, -0.019035836681723595, 0.01736358180642128, -0.0137333944439888, 0.005682182963937521, 0.00962243415415287, 0.0161372609436512, 0.029292333871126175, -0.015370810404419899, -0.0006880632718093693, 0.0018656094325706363, -0.003060575108975172, 0.013468620367348194, 0.02881852723658085, 0.002153028268367052, 0.016527453437447548, 0.014590424485504627, 0.008270694874227047, 0.041583407670259476, -0.007114051375538111, 0.01651351898908615, 0.014576489105820656, -0.007511212024837732, -0.014130555093288422, 0.012075074948370457, 0.0040796054527163506, 0.002433479530736804, -0.005490570794790983, -0.004776378162205219, 0.02681182138621807, 0.000595305347815156, -0.012646428309381008, 0.004577798303216696, 0.0203597042709589, 0.013210814446210861, -0.020847445353865623, -0.023829633370041847, -0.006351085379719734, 0.002954317256808281, -0.006072375923395157, -0.04119321331381798, -0.0005352086736820638, -0.017377516254782677, -0.03676173835992813, 0.0032260585576295853, 0.0028254142962396145, 0.012158687226474285, -0.009148628450930119, 0.027104467153549194, 2.176054476876743e-05, -0.0007324825273826718, -0.008709661662578583, -0.026031436398625374, 0.025042017921805382, 0.03135478124022484, 0.01127378549426794, 0.023829633370041847, -0.04490004852414131, -0.016388099640607834, -0.022686926648020744, -0.016987323760986328, 0.012750944122672081, -0.011998429894447327, -0.004828636534512043, -0.05306622385978699, 0.010451593436300755, -0.01978835090994835, 0.0012359009124338627, 0.014395328238606453, 0.00885598361492157, 0.007817791774868965, -0.010981141589581966]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" the second term Eˆπ[ˆr(x, a)−r∗(x, a)] is hard to control because both the estimation
target (ˆ r−r∗) and the distribution induced by ˆ πdepend on Doff. Therefore, they are statistically dependent
and characterizing this term is challenging.
In this section, we connect the newly formulated KL-regularized bandit problem with the pessimism and
show that the modified variants are sample efficient.
3.2 Algorithms
We introduce two different ways to achieve pessimism. The first one is to directly penalize the reward
estimation by an uncertainty estimator ˆ r(x, a) =rMLE(x, a)−β·Γ(x, a, ν, Doff) so that ˆ r(x, a)−r∗(x, a)≤0
for all ( x, a)∈ X × A . The construction of the uncertainty bonus is a standard application of concentration
inequality. Intuitively, the ˆ ris an estimation of the ground truth r∗, and ˆ rwill converge to r∗with infinitely
many samples that cover the whole feature space well. With finite samples, we can use the statistical tool
(concentration inequalities) to quantify the estimation error, in the sense that with high probability,
|r∗(x, a)−ˆr(x, a)| ≤Γ(x, a, ν, Doff),
where νis a reference vector so that the uncertainty is relative to feature ν, which makes sense under the
preference learning nature. We omit the mathematical details here for a clear presentation and we defer the
details to Appendix C.
In addition to adopting a reward estimator with point-wise pessimism, we may also use a modified target
that is biased toward pessimism by penalizing the uncertainty as in Equation (5). Here we do not maintain
a confidence set but use a modified target that is biased toward pessimism, similar to Xie et al. (2021a);
Zhang (2022), which may be easier to approximate in practice (Liu et al., 2023b). Moreover, to handle the
additional trade-off between the reward and the KL term, we also incorporate the KL divergence into the
policy computation.
The full algorithmic framework is presented in Algorithm 1 and is referred to as the offline Gibbs Sampling
from Human Feedback (GSHF) because the output policy is the Gibbs distribution with some reward.
11
Algorithm 1 Offline GSHF
1:Input: Doff,λ >0,β >0, reference vector ν, and prompt distribution d0.
2:Compute θMLEbased on Doffby maximizing the likelihood given in Equation (3)
3:Option I : Output ˆ πby constructing expected uncertainty estimator Γe(π, ν,Doff) and solving
ˆπ= argmax
π∈Πh
Ex∼d0,a∼π(·|x)[rMLE(x, a)]−β·Γe(π, ν,Doff)−η·Ex∼d0[DKL(π(·|x)∥π0(·|x))]i
. (5)
4:Option II : Output ˆ πby constructing uncertainty estimator Γ( x, a, ν, Doff) and calling Oracle 1 with
ˆr(x, a) =rMLE(x, a)−β·Γ(x, a, ν, Doff).
3.3 Main Results: Pessimism is Provably Efficient
We now present the main theoretical guarantee for Offline GSHF.
Theorem 1. Under Assumption 1, if we set β:=O q
d+log(1 /δ)
γ2 +λB2
, for any λ >0and comparator
policy π∈Π, with probability at least 1−δ, the output policy of Algorithm 1 with Option I and Γe(π, ν,Doff) =
∥Ex∼d0[ϕ(x, π)−ν]∥Σ−1
offsatisfies
J(π)−J(ˆπ)≤2β· ∥Ex∼d0[ϕ(x, π)]−ν∥Σ−1
off,
and the output policy of Algorithm 1 with Option II and Γ(x, a, ν, Doff) =∥ϕ(x, a)−ν∥Σ−1
offsatisfies
J(π)−J(ˆπ)≤2β·Ex∼d0,a∼π(·","[-0.029062552377581596, -0.0016352717066183686, 0.0017426126869395375, 0.019978826865553856, 0.01093535590916872, 0.03289999067783356, -0.0048806569539010525, 0.028391672298312187, -0.01965680532157421, 0.040923722088336945, 0.051550474017858505, -0.041004229336977005, -0.025734983384609222, -0.01045903004705906, 0.0009652296430431306, 0.006494125351309776, 0.019375035539269447, -0.012652809731662273, -0.008043860085308552, 0.04277535527944565, -0.03078000620007515, -0.029733432456851006, 0.031289875507354736, 0.005497867241501808, -0.01466545183211565, -0.03016279637813568, 0.020045915618538857, 0.004431167151778936, 0.03829387202858925, -0.03370504826307297, 0.042480167001485825, -0.03507364168763161, 0.00027422248967923224, -0.043929267674684525, 0.035637181252241135, 0.0693422332406044, 0.024648157879710197, 0.046344440430402756, -0.008815372362732887, -0.012471672147512436, -0.015926707535982132, -0.06950324028730392, -0.058339785784482956, 0.014383682049810886, 0.015591267496347427, 0.018610231578350067, 0.01662442460656166, -0.014584946446120739, 0.03762298822402954, 0.0058936867862939835, -0.0826525017619133, 0.031933922320604324, -0.016664676368236542, 0.008386008441448212, -0.0021770079620182514, 0.002141786739230156, 0.017067205160856247, 0.010143715888261795, 0.040306512266397476, -0.04280218854546547, 0.04038701951503754, -0.009439291432499886, 0.034295421093702316, -0.005403944291174412, -0.015524179674685001, 0.0077822161838412285, -0.05248970538377762, 0.04529786482453346, -0.009284988977015018, 0.05283856391906738, 0.003434909274801612, -0.009378911927342415, 0.03134354576468468, -0.011297631077468395, -0.04384876415133476, 0.03386605903506279, 0.06628301739692688, 0.015269245021045208, 0.05055756866931915, -0.019428705796599388, 0.010150425136089325, -0.03703261539340019, 0.03668375685811043, -0.030994689092040062, -0.001782865496352315, -0.07750014215707779, -0.04578090086579323, 0.007916392758488655, -0.05165781453251839, 0.01349141076207161, 0.0003260060911998153, 0.01202218234539032, -0.006450518034398556, 0.030511654913425446, 0.04435863345861435, 0.008895877748727798, 0.0032017782796174288, 0.014450770802795887, 0.011384845711290836, -0.021669447422027588, 0.02486283890902996, -0.021159578114748, 0.04714949429035187, -0.03217544034123421, 0.05053073540329933, -0.011035987176001072, -0.048464421182870865, 0.036495909094810486, -0.009170939214527607, -0.003317505121231079, -0.045458875596523285, -0.034912630915641785, -0.04728367179632187, 0.03614705428481102, 0.011827627196907997, -0.034966301172971725, -0.05844712629914284, 0.05592461675405502, 0.013377360999584198, 0.0006700421217828989, -0.05350944399833679, -0.002425233833491802, 0.02546663209795952, 0.013766472227871418, 0.00751386396586895, 0.02492992766201496, -0.0005987610202282667, -0.07460193336009979, -0.04317788407206535, -0.004954454023391008, 0.012337496504187584, 0.009412456303834915, -0.011626362800598145, -0.03225594386458397, -0.03826703503727913, 0.03738147392868996, 0.009734478779137135, 0.013008376583456993, 0.024245629087090492, -0.00602115411311388, -0.020032497122883797, -0.043204717338085175, -0.06993260234594345, -0.022353745996952057, -0.05329476296901703, 0.030618995428085327, -0.02336006611585617, -0.011713577434420586, -0.02247450314462185, 0.0022390643134713173, 0.021669447422027588, -0.014719123020768166, -0.04570039361715317, 0.01818086765706539, -0.010586497373878956, -0.011767247691750526, -0.030377479270100594, 0.04795455187559128, 0.01728188619017601, -0.0233332309871912, -0.027398768812417984, 0.0641898661851883, 0.026714470237493515, -0.01883833110332489, 0.04604925215244293, 0.009600303135812283, -0.016664676368236542, 0.008842207491397858, -0.03697894513607025, -0.031182534992694855, 0.01396773662418127, 0.03008229099214077, -0.012552178464829922, -0.008587272837758064, 0.004179586656391621, 0.0029183311853557825, 0.003495288547128439, -0.02247450314462185, -0.010734091512858868, -0.04111156985163689, 0.007480320055037737, 0.0166110061109066, 0.04148726165294647, -0.009546632878482342, -0.006306278519332409, 0.0005325115635059774, -0.013726219534873962, -0.03904525563120842, 0.0017015212215483189, 0.030645830556750298, 0.016933029517531395, 0.04379509389400482, 0.006447163410484791, -0.016959864646196365, 0.03834754228591919, -0.005819890182465315, 0.07046931236982346, 0.06778578460216522, 0.0040286388248205185, 0.02943824604153633, -0.003434909274801612, 0.040118664503097534, 0.020770465955138206, -0.06451188772916794, 0.027640284970402718, 0.0020294140558689833, 0.028418507426977158, 0.006346531677991152, -0.03507364168763161, 0.024205375462770462, 0.008124365471303463, -0.0008696290897205472, 0.011465351097285748, 0.011029278859496117, 0.0018046691548079252, 0.03692527487874031, -0.02345398999750614, 0.04862543195486069, 0.013410905376076698, 0.05726637691259384, -0.023923605680465698, 0.04229231923818588, 0.00433053495362401, -0.0012469994835555553, -0.0007308406638912857, -0.006638364400714636, 0.05117477849125862, -0.02254159189760685, 0.035851866006851196, -0.032685309648513794, 0.025895996019244194, 0.026083841919898987, -0.03158506378531456, 0.0058936867862939835, 0.031880252063274384, -0.007708419114351273, -0.0009929034858942032, 0.0045888242311775684, 0.01543025579303503, -0.03912576287984848, 0.004179586656391621, 0.021025400608778, -0.027304844930768013, -0.043258387595415115, -0.010385232977569103, 0.0027707372792065144, -0.02095831371843815, -0.01653050072491169, -0.00783588644117117, -0.00392129784449935, 0.014303176663815975, -0.020716795697808266, -0.012350914068520069, -0.031933922320604324, -0.06365316361188889, 0.0003220227372366935, 0.01319622341543436, -9.256057091988623e-05, -0.019965410232543945, 0.007856013253331184, -0.025010433048009872, 0.006675262935459614, -0.0060177999548614025, 0.014007989317178726, -0.0029334258288145065, -0.02244766801595688, -0.0062794433906674385, -0.0016855878056958318, 0.0031011460814625025, 0.009097142145037651, -0.0082719586789608, -0.015644937753677368, -0.04749835282564163, 0.037220463156700134, -0.03628122806549072, -0.034295421093702316, 0.011190290562808514, 0.03633489832282066, -0.06542428582906723, -0.012679645791649818, -0.040226008743047714, 0.0023111840710043907, 0.030672665685415268, -0.004226548597216606, 0.06853717565536499, -0.015336332842707634, 0.00039833542541600764, -0.0002226485376013443, -0.026030171662569046, -0.009915617294609547, 0.016101136803627014, -0.011183581314980984, 0.019160352647304535, -0.012713189236819744, 0.04717633128166199, -0.025345873087644577, 0.026164347305893898, -0.06757110357284546, 0.008137783035635948, 0.002398398471996188, 0.02849901281297207, 0.009707643650472164, -0.032792650163173676, 0.04446597397327423, -0.008815372362732887, 0.020783884450793266, 0.005481095518916845, 0.0226757675409317, -0.0466664619743824, -0.008486640639603138, 0.01717454567551613, 0.003508706111460924, -0.024366388097405434, 0.07615837454795837, -0.011069531552493572, -0.031316712498664856, 0.04443913698196411, -0.009506379254162312, 0.006527669262140989, -0.03896475210785866, -0.02643270045518875, -0.04878644645214081, -0.011720285750925541, -0.0030122543685138226, 0.0004335566482041031, -0.014678869396448135, 0.003917943220585585, -0.0008507606107741594, -0.00377034954726696, 0.02030085027217865, 0.019737310707569122, -0.006564567796885967, 0.009828402660787106, -0.012941288761794567, -0.01588645577430725, 0.016221895813941956, 0.0004216065863147378, 0.05855446681380272, 0.01543025579303503, -0.02259526215493679, -0.06257975101470947, 0.00984182022511959, -0.0294650811702013, -0.003309119027107954, 0.01123054325580597, -0.011914840899407864, 0.04564672335982323, 0.03987715020775795, 0.05018187686800957, 0.0751386359333992, -0.0033208595123142004, -0.02042160928249359, 0.00154721864964813, 0.021226665005087852, -0.0013006699737161398, -0.021602358669042587, -0.0016176610952243209, -0.023440571501851082, -0.029733432456851006, -0.042453330010175705, -0.02855268307030201, 0.008533602580428123, 0.02718408592045307, 0.0025409606751054525, -8.8682041678112e-05, 0.03236328437924385, 0.013410905376076698, -0.026150930672883987, -0.0020143194124102592, -0.017818590626120567, 0.018569977954030037, 0.059144843369722366, -0.059091173112392426, -0.012894326820969582, -0.027398768812417984, -0.028982046991586685, 0.0233332309871912, 0.027371933683753014, 0.058983832597732544, -0.010043084621429443, -0.035744525492191315, -0.007446775678545237, -0.0391525961458683, -0.0020461862441152334, 0.023896770551800728, 0.028176989406347275, -0.030243301764130592, -0.034134410321712494, -0.022085392847657204, -0.01470570545643568, 0.019039593636989594, -0.04430496320128441, -0.0419166274368763, 0.004464711062610149, -0.033329352736473083, -0.028015978634357452, -0.02621801756322384, 0.07427991181612015, 0.04674696922302246, 0.05243603512644768, -0.03013596124947071, -0.013155970722436905, -0.043124210089445114, 0.003485225373879075, -0.03813285753130913, -0.00821828842163086, 0.012793694622814655, 0.041755616664886475, 0.01799301989376545, 0.044787995517253876, -0.00016688158211763948, 0.002123337471857667, 0.03069950081408024, -0.06279443204402924, -0.01795276813209057, -0.015188739635050297, 0.036495909094810486, 0.01198863796889782, 0.040950559079647064, 0.0601109117269516, -0.004884011577814817, -0.07326017320156097, -0.004015220794826746, 0.015457091853022575, -0.034134410321712494, 0.007829178124666214, 0.021669447422027588, -0.013390778563916683, 0.029035717248916626, -0.05206034332513809, 0.0047800252214074135, 0.05251654237508774, 0.009318533353507519, -0.015041145496070385, -0.0710596814751625, 0.017832009121775627, 0.03359770402312279, -0.03534199669957161, -0.00895625725388527, -0.026137512177228928, 0.038642726838588715, -0.024648157879710197, -0.042319156229496, 0.03609338030219078, -0.02627168782055378, 0.019160352647304535, -0.05058440566062927, -0.008412844501435757, 0.028794199228286743, -0.0024604550562798977, -0.030216466635465622, -0.005242932587862015, 0.07503129541873932, -0.022152481600642204, -0.032604802399873734, -0.05501221865415573, 0.07132803648710251, -0.015255827456712723, 0.006259317044168711, -0.016007212921977043, 0.04293636605143547, -0.03300733119249344, -0.03212176635861397, -0.017026951536536217, 0.03244379162788391, 0.032712142914533615, -0.03166557103395462, 0.037193626165390015, -0.038776904344558716, 0.036522746086120605, -0.020877808332443237, -0.03000178560614586, 0.0068362741731107235, -0.035046808421611786, -0.03633489832282066, 0.0328194834291935, 0.02777446061372757, -0.012028890661895275, 0.035798195749521255, 0.010472447611391544, 0.0029518750961869955, 0.005189262330532074, -0.0024889674969017506, 0.02919672802090645, 0.03386605903506279, 0.05487804114818573, 0.05329476296901703, -0.015980377793312073, -0.023051461204886436, -0.024567650631070137, 0.017791755497455597, -0.04384876415133476, 0.05570993199944496, -0.015363167971372604, -0.00786272156983614, -0.012572304345667362, 0.035851866006851196, 0.01879807747900486, 0.01355849951505661, 0.006883236113935709, 0.0436340793967247, -0.02266235090792179, -0.03542250022292137, 0.062096718698740005, -0.0059842560440301895, 0.02260868065059185, -0.0012595785083249211, -0.04344623535871506, -0.009955869987607002, -0.0009526506182737648, -0.05646131932735443, -0.006557859014719725, -0.02545321360230446, -0.006205646321177483, 0.008855625055730343, 0.006064761430025101, -0.03225594386458397, -0.020113004371523857, -0.022729437798261642, 0.00010419615864520893, -0.017577074468135834, -0.039528291672468185, -0.038857411593198776, -0.004239966161549091, -0.00786272156983614, 0.030538490042090416, -0.00735285272821784, -0.06633668392896652, -0.021615777164697647, -0.03008229099214077, 0.03663008660078049, -0.01396773662418127, 0.014813045971095562, 0.00905018113553524, 0.00453515350818634, 0.005055086221545935, -0.016704929992556572, -0.013565207831561565, 0.01807352714240551, -0.031316712498664856, 0.005102047696709633, -0.032577965408563614, -0.023695506155490875, 0.00984182022511959, 0.015282662585377693, -0.049188971519470215, 0.04980618506669998, -0.005497867241501808, -0.02254159189760685, 0.0234003197401762, -0.012451546266674995, -0.025412961840629578, -0.03445643186569214, 0.0007002317579463124, -0.03960879519581795, -0.01239787507802248, -0.012558886781334877, 0.014745958149433136, 0.009177648462355137, 0.012142940424382687, -0.008573855273425579, 0.0007949936552904546, -0.006661845371127129, 0.017000116407871246, -0.029626091942191124, -0.0008264411590062082, 0.001903624041005969, 0.0020512177143245935, 0.006168748252093792, 0.04435863345861435, -0.030270136892795563, 0.056139297783374786, 5.807311026728712e-05, -0.06086229905486107, 0.03451010212302208, 0.0014432321768254042, 0.016986699774861336, -0.021575523540377617, 0.018449218943715096, 0.0054945130832493305, -0.01797960326075554, -0.01134459301829338, -0.02260868065059185, -0.016221895813941956, -0.014061659574508667, 0.018315043300390244, 0.004474774468690157, 0.0039380695670843124, -0.07529965043067932, -0.026070423424243927, 0.02925039827823639, -0.046237099915742874, -0.016731765121221542, 0.018959088250994682, -0.008801954798400402, 0.0166110061109066, -0.0024118160363286734, 0.00863423477858305, 0.005742738954722881, -0.047068990767002106, 0.04317788407206535, -0.02404436469078064, 0.011773956008255482, -0.01540342066437006, -0.047068990767002106, 0.056783344596624374, -0.012297242879867554, -0.02321247197687626, 0.022836778312921524, -0.006631655618548393, -0.004172877874225378, -0.0166780948638916, 0.015121650882065296, -0.02636561170220375, -0.053697291761636734, -0.05482437089085579, 0.01965680532157421, -0.01583278551697731, 0.07809051126241684, -0.010854849591851234, -0.0262314360588789, -0.017026951536536217, 0.02718408592045307, -0.02487625740468502, -0.005578373093158007, 0.010968899354338646, -0.006034572143107653, -0.041755616664886475, 0.021266918629407883, -0.04009183123707771, -0.011847753077745438, -0.018932253122329712, -0.004961162805557251, -8.789585263002664e-05, -0.014182418584823608, -0.020904643461108208, -0.016865940764546394, -0.0002090212656185031, 0.00042768646380864084, -0.06440454721450806, 0.03681793436408043, 0.010881684720516205, 0.019428705796599388, -0.04714949429035187, -0.009090433828532696, 0.002398398471996188, 0.006044635083526373, 0.008298794738948345, -0.029035717248916626, -0.03689843788743019, -0.026204600930213928, -0.03289999067783356, -0.014826463535428047, -0.018207702785730362, 0.0391525961458683, 0.017832009121775627, 0.005169135984033346, 0.005055086221545935, -0.00984182022511959, -0.01646341197192669, -0.008325629867613316, 0.016208477318286896, 0.007440066896378994, -0.004317117389291525, 0.014692287892103195, 0.03671059384942055, 0.004042056389153004, 0.0601109117269516, 0.017751503735780716, 0.012116105295717716, 0.017778338864445686, -0.006567921955138445, 0.01245825458317995, -0.011304340325295925, -0.017845427617430687, -0.034322258085012436, -0.02264893241226673, -0.047820378094911575, -0.025426378473639488, -0.012766859494149685, -0.005779637489467859, -0.0010826337384060025, -0.04017233848571777, -0.021092489361763, -0.01547050941735506, -0.014719123020768166, 0.04293636605143547, 0.0011975220404565334, -0.002034445758908987, -0.02403094619512558, -0.019160352647304535, -0.011183581314980984, 0.0278818029910326, -0.019200606271624565, -0.03000178560614586, 0.022058557718992233, 0.005585081875324249, 0.03169240429997444, -0.021414512768387794, -0.07122069597244263, -0.025815488770604134, 0.034241750836372375, -0.015175321139395237, -0.006138558499515057, -0.023131966590881348, -0.042587507516145706, -0.009975995868444443, 0.04669329896569252, 0.04961833730340004, -0.050852756947278976, -0.006799376104027033, -0.033490363508462906, -0.022917285561561584, 0.013471284881234169, 0.007305890787392855, -0.03252429515123367, 0.03255113214254379, 0.019267693161964417, 0.03679109737277031, -0.012498507276177406, -0.020005661994218826, -0.038642726838588715, -0.05544158071279526, -0.016356071457266808, -0.0026097260415554047, -0.00018983827612828463, -0.06902020424604416, 0.01665125973522663, -0.028042813763022423, -0.04596874490380287, -0.002123337471857667, 0.021575523540377617, 0.012136232107877731, -0.015175321139395237, -0.006910071242600679, 0.021199829876422882, 0.0075876605696976185, -0.004052119329571724, 0.02796230837702751, -0.004441230092197657, 0.001201715087518096, 0.022139063104987144, -0.04293636605143547, -0.01644999533891678, -0.0039917402900755405, -0.0004048345726914704, 0.021159578114748, 0.026486370712518692, -0.014692287892103195, 0.035019971430301666, 0.00827866792678833, 0.011418389156460762, -0.0361202172935009, 0.009103851392865181, 0.03010912612080574, -0.019039593636989594, 0.01463861670345068, -0.012585721909999847, -0.010344980284571648, -0.008439679630100727, -0.001908655627630651, 0.011827627196907997, -0.06070128455758095, 0.011458642780780792, -0.0050416686572134495, -0.022393997758626938, -0.025748401880264282, -0.021441347897052765, 0.025909412652254105, 0.006477353163063526, 0.017697833478450775, 0.004800151567906141, 0.0009627137915231287, 0.02044844441115856, 0.055173229426145554, 0.013451158069074154, -0.005350273568183184, -0.04309737682342529, 0.022367162629961967, -0.021937798708677292, -0.006618238054215908, -0.008090821094810963, 0.016342654824256897, 0.004414394963532686, -0.012579013593494892, -0.004186295438557863, -0.004941036459058523, -0.01463861670345068, -0.034885797649621964, -0.016101136803627014, -0.00786272156983614, -0.008929422125220299, -0.024997014552354813, -0.018610231578350067, -0.01736239343881607, 0.02793547324836254, -0.03249746188521385, -0.10744825750589371, 0.0016143067041411996, 0.00543413357809186, 0.022997790947556496, 0.007547407876700163, -0.006551150232553482, 0.02472866326570511, 0.01544367428869009, -0.018516307696700096, -0.009821693412959576, 0.015041145496070385, -0.006467290222644806, 0.006896653678268194, 0.01426292397081852, -0.0030810197349637747, -0.017120875418186188, 0.0030877285171300173, -0.0093923294916749, 0.006567921955138445, -0.01461178157478571, -0.0035355412401258945, -0.010640167631208897, 0.009378911927342415, 0.02868685871362686, -0.021629193797707558, 0.005652170162647963, 0.03134354576468468, -0.011559274978935719, 0.002036122838035226, -0.02039477415382862, 0.010606624186038971, -0.014007989317178726, 0.017469733953475952, -0.012283825315535069, -0.04672013223171234, -0.022863615304231644, -0.002277639927342534, -0.008781827986240387, -0.010452321730554104, 0.05042339488863945, 0.031316712498664856, -0.025734983384609222, 0.04062853381037712, 0.005447551142424345, 0.031960755586624146, -0.03236328437924385, 0.02170969918370247, -0.001091858372092247, -0.002893173135817051, 0.0006109207170084119, 0.01730872131884098, -0.003411428304389119, -0.023024626076221466, -0.03767666220664978, -0.0016184997512027621, 0.002416847739368677, 0.01658417098224163, 0.038052354007959366, -0.01886516623198986, 0.012558886781334877, -0.04352673888206482, 0.026741305366158485, 0.009271571412682533, -0.007996898144483566, -0.04661279171705246, -0.011398263275623322, -0.004149397369474173, 0.0116666154935956, -0.0004683586012106389, -0.030216466635465622, -0.007399814203381538, -0.03695210814476013, -0.006651782430708408, 0.018663901835680008, -0.02244766801595688, -0.004307053983211517, -0.0017912514740601182, 0.014960640110075474, -0.04355357587337494, 0.0262314360588789, 0.04867910221219063, -0.060540273785591125, 0.02566789649426937, 0.017107458785176277, 0.004655912052839994, 0.026083841919898987, 0.03241695463657379, -0.012907744385302067, -0.00338794756680727, 0.012283825315535069, 0.04717633128166199, -0.028284329921007156, -0.0064371004700660706, -0.03222911059856415, 0.0345369391143322, -0.02636561170220375, -0.009030054323375225, 0.03179974481463432, 0.007084500044584274, 0.014075077138841152, 0.03083367645740509, 0.02403094619512558, -0.01090181153267622, 0.0024571006651967764, -0.004826986696571112, -0.0014566497411578894, -0.0013996248599141836, 0.008479932323098183, 0.02403094619512558, 0.007386396639049053, 0.003897816874086857, 0.00900992751121521, -0.01796618476510048, 0.01022422220557928, -0.01123054325580597, 0.028364837169647217, 0.02852584794163704, -0.005008124280720949, -0.01243812870234251, 0.013068756088614464, 0.02560080774128437, 0.010412068106234074, -0.014544693753123283, 0.018543142825365067, 0.0019790981896221638, -0.025949666276574135, 0.008473223075270653, 0.016208477318286896, -0.012800403870642185, 0.01199534721672535, 0.023064877837896347, 0.01644999533891678, 0.022944120690226555, -0.011089658364653587, 0.012511924840509892, 0.011143328621983528, 0.014893551357090473, 0.003000513883307576, -0.0027036492247134447, 0.01576569676399231, -0.003528832457959652, -0.013001668266952038, -0.005293248686939478, 0.011431807652115822, -0.023937024176120758, 0.004947745241224766, 0.02327956072986126, -0.009439291432499886, -0.018489472568035126, 0.014813045971095562, 0.03249746188521385, -0.03217544034123421, 0.003309119027107954, -0.011914840899407864, 0.01473254058510065, 0.019965410232543945, 0.033383022993803024, -0.009164230898022652, -0.008842207491397858, 0.012008764781057835, 0.013994571752846241, 0.014504441060125828, 0.00561191700398922, -0.01431659422814846, 0.03896475210785866, -0.03249746188521385, -0.022098811343312263, -0.0006369173643179238, -0.004944390617311001, -0.0094594182446599, -0.022018304094672203, -0.08442363142967224, 0.026043588295578957, 0.035798195749521255, 0.026553457602858543, 0.016342654824256897, 0.016718346625566483, 0.0016143067041411996, 0.0050383140332996845, 0.029572421684861183, 0.03660324960947037, 0.03255113214254379, -0.026647381484508514, -0.01048586517572403, 0.04457331448793411, -0.002757319714874029, 0.016329236328601837, 0.00453515350818634, 0.008184744976460934, 0.028955211862921715, 0.04301686957478523, 0.021253500133752823, -0.005145655013620853, 0.02264893241226673, -0.004833695478737354, 0.013779889792203903, -0.02790863811969757, 0.00585007993504405, 0.010948773473501205, -0.04642494395375252, -0.065638966858387, 0.03171924129128456, -0.006336468271911144, -0.007916392758488655, -0.016369489952921867, 0.011371428146958351, 0.0005631204694509506, -0.030645830556750298, -0.016731765121221542, 0.016369489952921867, -0.007185132242739201, 0.00860069040209055, -0.011894715018570423, -0.01657075434923172, 0.003827374428510666, -0.00863423477858305, -0.008788537234067917, 0.004424458369612694, -0.043285224586725235, -0.03300733119249344, -0.011297631077468395, 0.0036663629580289125, 0.01658417098224163, -0.00017013115575537086, -0.017456315457820892, -0.031236205250024796, -0.005675650667399168, -0.01577911339700222, 0.002966969972476363, 0.011076240800321102, -0.016758600249886513, 0.03837437555193901, -0.010083337314426899, -0.005149009637534618, 0.004179586656391621, -0.016839105635881424, -0.004293636418879032, -0.011545857414603233, 0.00783588644117117, 0.004689455963671207, 0.03807918727397919, -0.008090821094810963, -0.010385232977569103, -0.0005513801006600261, 0.026687635108828545, -0.006292860954999924, -0.0008515992085449398, 0.07363586872816086, -0.022863615304231644, -0.009989413432776928, -0.011841044761240482, 0.05860813707113266, 0.009962578304111958, 0.009707643650472164, 0.010251057334244251, 0.011921550147235394, -0.0027841548435389996, 0.009653973393142223, 0.028740528970956802, -0.010667002759873867, -0.021293753758072853, -0.01949579268693924, -0.02035452052950859, -0.028821034356951714, 0.004266801290214062, -0.03483212739229202, 0.02103881910443306, 0.022903867065906525, 0.02023376151919365, 0.012337496504187584, -0.022313492372632027, 0.014906968921422958, -0.011082949116826057, 0.04215814173221588, -0.00860739964991808, -0.026848645880818367, 0.014155582524836063, -0.021937798708677292, 0.024272464215755463, 0.0026449472643435, -0.020810719579458237, -0.001539671211503446, -0.0300554558634758, -0.015094815753400326, 0.008332338184118271, -0.020166674628853798, 0.026553457602858543, -0.009358786046504974, 0.014987475238740444, 0.01657075434923172, 0.050718583166599274, 0.04516368731856346, -0.013021794147789478, 0.025104356929659843, 0.014356846921145916, -0.031933922320604324, -0.02560080774128437, 0.034134410321712494, -0.008117656223475933, 0.00029707435169257224, -0.018368713557720184, 0.007426649332046509, -0.006923488806933165, -0.0018684028182178736, 0.04808872938156128, 0.009761313907802105, 0.017147710546851158, -0.014491023495793343, -0.04234598949551582, -0.014987475238740444, -0.01358533464372158, 0.015282662585377693, -0.007567534223198891, -0.010881684720516205, -0.0030491529032588005, 0.0021954569965600967, -0.016221895813941956, 0.007205258589237928, -0.00904347188770771, -0.011451933532953262, -0.015537597239017487, -0.005031605251133442, -0.012511924840509892, 0.01547050941735506, -0.0035724397748708725, -0.0156851913779974, -0.0005413168692030013, 0.006977159529924393, -0.009949160739779472, 0.010358397848904133, -0.01201547309756279, 0.025332454591989517, 0.014209253713488579, -0.021414512768387794, -0.024607904255390167, -0.03094101883471012, -0.052409201860427856, 0.007165005896240473, -0.006708806846290827, 0.008412844501435757, 0.000688491330947727, 0.016785435378551483, 0.025882577523589134, -0.03145088627934456, -0.028176989406347275, 0.010425486601889133, 0.008151200599968433, 0.0009752928162924945, -0.010801179334521294, -0.00789626594632864, 0.08737550675868988, -0.033436693251132965, -0.01728188619017601, 0.026540040969848633, -0.004723000340163708, 0.03767666220664978, 0.0040957266464829445, -0.034053903073072433, -0.015228992328047752, 0.004307053983211517, 0.0036663629580289125, 0.018972506746649742, -0.008265250362455845, -0.0005870205932296813, 0.01127750426530838, 0.007071082480251789, -0.03209493309259415, 0.01883833110332489, 0.007399814203381538, 0.016154807060956955, 0.022004887461662292, 0.0031296585220843554, -0.006131849717348814, 0.006722224876284599, 0.002562764333561063, -0.010204095393419266, -0.012552178464829922, -0.002426910912618041, -0.028338000178337097, 0.03526148945093155, 0.016074301674962044, 0.003089405596256256, -0.05275806039571762, 0.022273238748311996, -0.016369489952921867, -0.012800403870642185, -0.026701051741838455, 0.020931478589773178, -0.006380075588822365, -0.006866463925689459, -0.0005585082108154893, -0.010284600779414177, -0.014960640110075474, 0.005605208221822977, 0.02118641324341297, 0.006604820489883423, -0.012183194048702717, 0.019925156608223915, -0.009627138264477253, 0.02479575015604496, 0.028069648891687393, -0.010391942225396633, 0.03075317107141018, -0.0271572507917881, 0.009499670937657356, -0.010378524661064148, -0.01663784123957157, 0.013618878088891506, -0.003864272963255644, 0.010385232977569103, -0.0466664619743824, 0.022018304094672203, -0.029894445091485977, -0.002123337471857667, 0.03179974481463432, -0.032712142914533615, 0.002435297006741166, 0.011760538443922997, -0.013397487811744213, 0.030243301764130592, -0.034107573330402374, 0.009405747056007385, -0.01013029832392931, -0.017523404210805893, 0.00030902441358193755, 0.0017744795186445117, -0.052892234176397324, 0.01567177288234234, 0.01814061403274536, 0.03094101883471012, -0.02849901281297207, 0.010774344205856323, 0.0012947997311130166, -0.01237103994935751, -0.030511654913425446, 0.026929151266813278, 0.03094101883471012, -0.0073260171338915825, -0.03904525563120842, 0.04411711543798447, -0.013981154188513756, -0.005504576023668051, 0.015175321139395237, -0.004649203270673752, -0.0063498858362436295, -0.015014310367405415, 0.03990398347377777, 0.011002443730831146, -0.026727886870503426, 0.0005895364447496831, -0.017107458785176277, 0.012169775553047657, 0.03182658180594444, 5.084017902845517e-05, 0.02031426690518856, 0.033570870757102966, -0.03534199669957161, -0.0063129873014986515, -0.008647652342915535, 0.004961162805557251, 0.00828537717461586, -0.007902974262833595, 0.010653585195541382, -0.010116880759596825, -0.02259526215493679, -0.012411292642354965, 0.025963082909584045, 0.008332338184118271, 0.02032768540084362, -0.008895877748727798, 0.01571202650666237, 0.012471672147512436, -0.009385621175169945, 0.007627913728356361, -0.018234537914395332, 0.011512313038110733, -0.003914589062333107, 0.012659518979489803, -0.006460580974817276, 0.005206034053117037, -0.002851242898032069, 0.02173653431236744, 0.013028503395617008, 0.019911739975214005, 0.02400411106646061, 0.004055473953485489, -0.004759898409247398, -0.023628419265151024, -0.01961655169725418, -0.02777446061372757, -0.004773316439241171, -0.011626362800598145, -0.008332338184118271, 0.02860635332763195, -0.024540815502405167, -0.01952262781560421, -0.014933804050087929, -0.031128864735364914, 0.04210447147488594, 0.010022957809269428, -0.0055984994396567345, 0.03249746188521385, -0.0009719384252093732, 0.03383922204375267, -0.0011119847185909748, -0.012250281870365143, 0.04113840311765671, -0.004914201330393553, 0.010069919750094414, 4.507479752646759e-05, 0.028364837169647217, -0.012069144286215305, 0.014853298664093018, 0.011109784245491028, 0.029518751427531242, -0.0009031731751747429, -0.012612557038664818, 0.009318533353507519, -0.0020193508826196194, -0.013082173652946949, 0.020689960569143295, 0.001178234233520925, 0.008231705985963345, -0.001586632919497788, 0.0018868519691750407, 0.003756931982934475, -0.003508706111460924, -0.004830340854823589, -0.01131104864180088, 0.0388842448592186, -0.010351689532399178, -0.01804669015109539, 0.04132625088095665, -0.004984643775969744, -0.0013358911965042353, 0.009539923630654812, 0.028955211862921715, 0.020931478589773178, 0.007809051312506199, -0.020730214193463326, 0.000857469392940402, -0.0017392581794410944, 0.038669563829898834, 0.021669447422027588, 0.027559779584407806, 0.020609455183148384, 0.01800643838942051, -0.01201547309756279, 0.036415405571460724, 0.04062853381037712, 0.007386396639049053, -0.014222671277821064, 0.028284329921007156, 0.02641928195953369, -0.013571917079389095, 0.017858844250440598, 0.008070695213973522, -0.015631521120667458, -0.0001087036362150684, 0.003864272963255644, 0.03555667772889137, 0.01199534721672535, 0.023816265165805817, 0.020810719579458237, 0.0017442898824810982, -0.003981676883995533, 0.022836778312921524, 0.014048242010176182, -0.009888781234622002, -0.005410653073340654, 4.753818575409241e-05, -0.008231705985963345, 0.019133517518639565, 0.022809943184256554, -0.0025124482344835997, -0.0002431942557450384, 0.039420951157808304, 0.02323930710554123, 0.023722341284155846, 0.009170939214527607, -0.0012201642384752631, -0.032712142914533615, -4.985744453733787e-06, -0.007238802965730429, 0.01090181153267622, 0.0013098946074023843, -0.004374142270535231, -0.006111723370850086, 0.0009962578769773245, 0.009627138264477253, -0.034885797649621964, 0.01505456306040287, 0.00898309238255024, -0.011458642780780792, 0.008258541114628315, 0.05957420542836189, -0.003934715408831835, 0.015537597239017487, -0.05055756866931915, -0.0050383140332996845, -0.0026583648286759853, 0.02099856548011303, 0.0012679644860327244, -0.04041385278105736, 0.02022034488618374, -0.009150812402367592, -0.007010703440755606, -0.0021971343085169792, 0.0027036492247134447, 0.027358515188097954, -0.029599256813526154, -0.010022957809269428, -0.0004717129922937602, 0.005856788717210293, -0.040333349257707596, 0.013263311237096786, 0.010405359789729118, 0.004397623240947723, -0.025359291583299637, -0.005937294103205204, -0.005417361855506897, 0.015041145496070385, 0.012706480920314789, -0.0008188937790691853, 0.013370652683079243, 0.009586885571479797, -0.010438904166221619, 0.011210416443645954, -0.004404332023113966, -0.02247450314462185, 0.04119207710027695, -0.026593711227178574, 0.00029371996060945094, 0.020649708807468414, 0.03365137800574303, -0.013283438049256802, -0.03298049420118332, -0.03818653151392937, -0.008714740164577961, 0.00788955669850111, -0.03233645111322403, -0.008318920619785786, -0.010774344205856323, -0.01797960326075554, -0.005165781360119581, -0.004501609597355127, 0.03764982521533966, -0.04054803028702736, -0.024406639859080315, 0.018476054072380066, -0.027506109327077866, -0.010989026166498661, -0.012947998009622097, 0.0013602105900645256, 0.03622755780816078, 0.0015966960927471519, -0.011170163750648499, 0.022071974352002144, 0.008318920619785786, 0.04317788407206535, 0.027479274198412895, -0.012981541454792023, 0.007279055658727884, 0.03671059384942055, 0.00767487520352006, 0.017644163221120834, 0.0020193508826196194, 0.01051940955221653, -0.012116105295717716, 0.0026013399474322796, -0.016329236328601837, -0.005507930647581816, 0.006309633143246174, -0.013350525870919228, 0.043151047080755234, -0.017764920368790627, -0.017885679379105568, -0.018422383815050125, -0.002785832155495882, -0.014249506406486034, 0.02487625740468502, -0.01500089280307293, 0.02625827118754387, 0.02321247197687626, 0.01096219103783369, 0.022058557718992233, -0.007809051312506199, 0.007815760560333729, -0.0006306278519332409, -0.01167332474142313, -0.0037401600275188684, -0.0027288072742521763, 0.015108233317732811, -0.015202157199382782, -0.02556055411696434, -0.014598364010453224, 0.01644999533891678, 0.0008838853100314736, 0.0029149765614420176, 0.0024906445760279894, 0.02415170520544052, 0.02408461645245552, -0.013766472227871418, 0.00466932961717248, 0.006450518034398556, -0.008191453292965889, -0.012968123890459538, -0.013645713217556477, -0.014826463535428047, -5.849241279065609e-05, -0.034322258085012436, -0.01505456306040287, 0.016342654824256897, 0.018516307696700096, 0.008198162540793419, 0.011747120879590511, -0.005863497499376535, -0.006091597024351358, 0.012713189236819744, -0.027439020574092865, 0.03400023281574249, 0.020850973203778267, 0.011022569611668587, 0.019146936014294624, -0.02472866326570511, 0.012572304345667362, -0.03520781919360161, -0.01870415359735489, 0.009526506066322327, -0.001201715087518096, -0.007822468876838684, -0.05267755314707756, 0.006269379984587431, -0.01646341197192669, -0.014544693753123283, 0.002656687516719103, 0.015202157199382782, 0.02095831371843815, -0.014088494703173637]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"|x)∥ϕ(x, a)−ν∥Σ−1
off−η·Ex∼d0
DKL(π(·|x)∥ˆπ(·|x))
.
We can combine the guarantee with dataset property, usually referred to as the coverage on the comparator
policy π(Jin et al., 2021b; Xie et al., 2021a), to obtain the concrete bound. See Proposition 2 for an concrete
example. The proof of the theorem is rather standard in offline learning based on the principle of pessimism
but with a different analysis to handle the KL and the stochastic policy. We defer the proof of the theorem
to Appendix C. The reference vector νin Algorithm 1 is typically set as Ex∼d0[ϕ(x, πref)] for some available
πref. As showcased by Zhu et al. (2023a), the subtracted reference vector can serve as a pre-conditioner for
a better suboptimality bound. For instance, one typically choice is πref=π0so that π0achieves a reward of
zero (Ouyang et al., 2022; Gao et al., 2023; Dong et al., 2023).
Comparison of two implementations of pessimism. In comparison, the Option I achieves a sharper
bound in the uncertainty bonus because the expectation is inside the norm and by Jensen’s inequality
(Lemma 6) we know that
∥Ex∼d0[ϕ(x, π)]−ν∥Σ−1
off≤Ex∼d0,a∼π(·|x)∥ϕ(x, a)−ν∥Σ−1
off.
Moreover, Option I has a desirable robust improvement property. If we take ν=Ex∼d0[ϕ(x, πref)], the
resulting policy will be better than πref, regardless of the coverage of the Doffaccording to Theorem 1,
which is similar to the original offline RL literature for a robust policy improvement (Bhardwaj et al.,
2023). We will also see that the use of a reference policy πrefcan also simplify the algorithmic design in
subsequent Section 4. However, the main advantage of Option II is that the Oracle 1 can be empirically well
approximated. For instance, we can directly plug the pessimistic reward into the PPO algorithm. Moreover,
we have the following algorithm in a direct preference learning manner that resembles that of Rafailov et al.
(2023); Zhao et al. (2023); Azar et al. (2023). We defer a detailed discussion to Section 5.
12
4 Online Iterative Learning with Batch Exploration
4.1 Setup: Batch Hybrid Learning
Beyond the offline learning, it is also common to query human feedback during the training process. For in-
stance, Bai et al. (2022); Touvron et al. (2023) typically iterate the RLHF process on a weekly cadence, where
the fresh RLHF models are deployed to interact with crowdworkers and to collect new human preference
data.
We consider a slightly more general setting here, where we refer it to as the hybrid learning. This is because
while it is possible to learn from scratch, in many cases, we tend to start with the offline open-source datasets
(Touvron et al., 2023; Bai et al., 2023). For instance, in LLaMA2 (Touvron et al., 2023), the authors start
with 1500K open-source comparison pairs Doffand keep Doffin the data mixture for the entire RLHF
process. Motivated by the practical applications, we formulate the process as a batch hybrid framework in
this section. It is shown that such a batch online framework can significantly improve the aligned LLMs as
evaluated by the humans (Bai et al., 2022; Touvron et al., 2023). For completeness, we also develop the pure
online setting in Appendix B. Mathematically, consider the batch hybrid setting of Tbatches with a fixed
batch size m.
The agent initializes with the Doff(if applicable, otherwise initialize as empty). For each iteration t∈[T],
•we first update the policy pair ( π1
t, π2
t) based on the historical data collected so far: DoffandD1:t−1;
•we collect mtuples as Dt: we sample a random prompt by xt,i∼d0, collect two responses by
(a1
t,i, a2
t,i)∼(π1
t, π2
t), and query","[-0.019339825958013535, -0.014674021862447262, 0.03092680498957634, 0.005106306169182062, 0.027825666591525078, 0.006808408070355654, -0.006692115217447281, 0.03453540429472923, -0.02375189960002899, 0.050097476691007614, 0.03549393638968468, -0.04076587036252022, -0.0262891948223114, -0.03659342974424362, 0.01295430026948452, -0.015125096775591373, 0.018733693286776543, -0.011340298689901829, -0.0025478668976575136, 0.024259358644485474, -0.024414414539933205, -0.0283754151314497, 0.027839763090014458, 0.019551265984773636, -0.00022168293071445078, -0.050802282989025116, 0.016280975192785263, 0.014208851382136345, 0.011678604409098625, -0.034563593566417694, 0.03120872750878334, -0.030644884333014488, -0.04832137003540993, -0.008676138706505299, 0.024132493883371353, 0.03918711096048355, 0.01160107646137476, 0.02566896565258503, -0.014258187264204025, 0.021750256419181824, -0.02884058468043804, -0.08530949056148529, -0.047729335725307465, 0.02362503483891487, -0.0355503186583519, 0.022426867857575417, 0.014659926295280457, -0.001828966778703034, 0.035071052610874176, 0.030362961813807487, -0.03955360874533653, 0.014067890122532845, -0.042288247495889664, -0.008570418693125248, 0.007005752995610237, -0.003566308878362179, 0.03436625003814697, 0.015195577405393124, 0.05209911987185478, -0.024456704035401344, 0.005539760459214449, -0.006928224582225084, 0.024851392954587936, 0.032280027866363525, -0.02115822024643421, -0.006730879656970501, -0.05999292805790901, 0.027797475457191467, -0.005923878867179155, 0.052775733172893524, -0.0006281567038968205, -0.01164336409419775, 0.023808283731341362, -0.02599317580461502, -0.046291533857584, 0.027078574523329735, 0.050661321729421616, 0.05644071474671364, 0.0013100546784698963, -0.027022190392017365, 0.032336413860321045, -0.006371429190039635, 0.029770925641059875, -0.026683883741497993, 0.01533653773367405, -0.07820506393909454, -0.03414071351289749, -0.012038054876029491, -0.04894159734249115, -0.01788792945444584, 0.006212848238646984, 0.019523074850440025, -0.027557842433452606, 0.03867965191602707, 0.02352636121213436, 0.003911662846803665, -0.026937613263726234, -0.037298236042261124, 0.03856688365340233, -0.010113939642906189, 0.00011287878442090005, -0.04950544238090515, 0.012862675823271275, -0.012566657736897469, 0.05348053574562073, -0.017422758042812347, -0.005589096806943417, 0.06393983215093613, -0.003106424119323492, 0.00021959053992759436, -0.09404906630516052, -0.03800303861498833, -0.05536941438913345, 0.0009109593229368329, 0.0018677309853956103, -0.05875247344374657, -0.03115234337747097, 0.014448484405875206, -0.011044280603528023, -0.024654049426317215, -0.029489004984498024, -0.008718427270650864, 0.018550444394350052, 0.019198864698410034, 0.02348407357931137, -0.008514033630490303, 0.021496526896953583, -0.07008571922779083, -0.019945956766605377, -0.0152660571038723, 0.02053799293935299, 0.02351226657629013, -0.02812168560922146, -0.03811580687761307, -0.0514507032930851, 0.00393985491245985, 0.007463875692337751, 0.01425113994628191, -0.008972156792879105, -0.04327497258782387, -0.009564192034304142, -0.07442731410264969, -0.060838691890239716, -0.03174437955021858, -0.07758484035730362, 0.02596498467028141, -0.024090204387903214, -0.01274990662932396, 0.011868901550769806, 0.013468806631863117, -0.008739571087062359, -0.014385052025318146, -0.0203547440469265, 0.04843413829803467, 0.0017073879716917872, -0.02582402341067791, -0.060444001108407974, 0.042767513543367386, 0.03385879099369049, -0.00588159030303359, -0.012855627574026585, 0.060838691890239716, 0.02868552878499031, 0.005106306169182062, 0.042513784021139145, 0.0260072723031044, -0.0037495580036193132, 0.009211789816617966, -0.058019477874040604, -0.03439444303512573, 0.023653225973248482, 0.011157049797475338, -0.011826612986624241, -0.0017179601127281785, -0.011953477747738361, -0.045445770025253296, -0.01295430026948452, -0.03154703229665756, 0.009535999968647957, -0.039976488798856735, 0.040004681795835495, 0.019184768199920654, -0.00014525573351420462, -0.0022342291194945574, -0.030560307204723358, 0.008788907900452614, -0.022032177075743675, -0.02593679167330265, -0.0029918935615569353, 0.03349229320883751, 0.017056260257959366, 0.03405613452196121, 0.013616816140711308, -0.02283565327525139, 0.007199574261903763, -0.032392796128988266, 0.05221189185976982, 0.03315398469567299, -0.014941847883164883, 0.006892984267324209, 0.021440140902996063, 0.021778447553515434, -0.02031245455145836, -0.050492167472839355, 0.021270988509058952, -0.004348641727119684, 0.00894396472722292, 0.015491594560444355, -0.03287206590175629, -0.008457649499177933, 0.013821208849549294, 0.04220367223024368, 0.029827311635017395, -0.0044050258584320545, -0.02338540181517601, -0.016717953607439995, -0.03848230466246605, 0.022807462140917778, -0.011375539004802704, 0.034930091351270676, -1.6697800674592145e-05, 0.0157594196498394, -0.016999876126646996, 0.025344757363200188, -0.026387866586446762, 0.007548452354967594, 0.03845411166548729, -0.048124026507139206, 0.03518382087349892, -0.05954185128211975, 0.05412895604968071, 0.009853161871433258, -0.014575349166989326, -0.024823201820254326, 0.042457401752471924, -0.0032156689558178186, -0.012009862810373306, -0.02306119166314602, 0.016266878694295883, -0.060895077884197235, 0.0047997161746025085, 0.040314797312021255, -0.0006752904737368226, -0.028896968811750412, -0.0011135905515402555, 0.00638200156390667, -0.02315986342728138, -0.0315188392996788, -0.0030236097518354654, -0.03380240499973297, -0.010882175527513027, -0.03938445448875427, -0.02579583041369915, -0.03450721129775047, -0.03952541574835777, 0.017366373911499977, 0.022793365642428398, 0.02610594592988491, -0.0261482335627079, -0.00782332569360733, -0.04194994270801544, 0.016746146604418755, 0.018606828525662422, 0.012009862810373306, -0.029263468459248543, -0.028925161808729172, 0.0023258535657078028, -0.008704330772161484, 0.014617637731134892, 0.0020932683255523443, -0.018874654546380043, 0.03698812052607536, -0.024442607536911964, 0.017140837386250496, -0.04161163419485092, -0.06213553249835968, 0.0142934275791049, 0.042372822761535645, -0.032364606857299805, -0.013525191694498062, -0.03876422718167305, 0.0018553968984633684, 0.07583692669868469, -0.012510273605585098, 0.05362149700522423, -0.022018080577254295, -0.012728762812912464, -0.035127438604831696, -0.002505578799173236, -0.00524374283850193, -0.0117138447239995, 0.002283565467223525, 0.04304943606257439, -0.04118875414133072, 0.025189699605107307, 0.0008373954333364964, 0.010663686320185661, -0.0527193509042263, 0.01053682155907154, 0.006857744418084621, 0.030475730076432228, 0.016887107864022255, -0.01821213960647583, 0.04428989067673683, 0.015125096775591373, -0.001750557217746973, 0.018663212656974792, 0.010268996469676495, 0.004683423321694136, 0.016055438667535782, -0.010050507262349129, 0.029799118638038635, -0.012432744726538658, 0.042401015758514404, -0.0007321152952499688, -0.013778921216726303, 0.0408504493534565, -0.013532239012420177, -0.010579110123217106, -0.03560670465230942, -0.03078584372997284, -0.06004931032657623, -0.0027240680065006018, 0.008232112042605877, 0.013955121859908104, -0.04223186522722244, -0.004880768712610006, -0.03797484561800957, -0.015970861539244652, -0.022412771359086037, -0.01582990027964115, -0.021581102162599564, 0.03171618655323982, -0.010769407264888287, 0.02297661453485489, 0.007872662506997585, -0.01442029234021902, 0.042682938277721405, 0.029404427856206894, 0.016943491995334625, -0.09506398439407349, 0.018804173916578293, -0.03831315413117409, -0.004767999984323978, -0.023892860859632492, -0.010332428850233555, 0.02604955993592739, 0.03264652565121651, 0.04132971540093422, 0.03072945959866047, -0.014504869468510151, -0.021285085007548332, 0.04595322906970978, 0.004813812207430601, -0.02077762596309185, -0.01850815676152706, -0.004207680467516184, -0.04569949954748154, -0.011671556159853935, -0.025147411972284317, -0.008309640921652317, 0.012439792975783348, 0.0020527420565485954, 0.008640898391604424, -0.0037319378461688757, 0.04118875414133072, 0.002803358482196927, 0.006977560929954052, 0.01163631584495306, -0.009909546002745628, 0.032167259603738785, 0.03182895481586456, -0.04925171285867691, 0.00022972209262661636, -0.07431454956531525, -0.02043931931257248, 0.047813910990953445, 0.022525539621710777, 0.01183366123586893, 0.032759297639131546, -0.0006739689270034432, -0.0051979306153953075, -0.026627499610185623, -0.02077762596309185, 0.01313050091266632, 0.03092680498957634, -0.05105601251125336, -0.029094314202666283, -0.04369785636663437, -0.02324444055557251, 0.0318007618188858, -0.029799118638038635, -0.02616233006119728, -0.005641957279294729, -0.029714541509747505, -0.005240218713879585, -0.022596020251512527, 0.05756840109825134, 0.05091505125164986, 0.04166802018880844, -0.040258411318063736, -0.039609991014003754, -0.05128154903650284, -0.012926108203828335, -0.04880063980817795, 0.019212961196899414, -0.004834956489503384, 0.012270639650523663, 0.030165616422891617, 0.04617876559495926, 0.01800069771707058, -0.02066485770046711, 0.016379648819565773, -0.035381168127059937, 0.009338654577732086, -0.009768585674464703, -0.016140013933181763, -0.0030077516566962004, 0.047616567462682724, 0.09478206187486649, -0.0062410407699644566, -0.05627156049013138, 0.03422528877854347, -0.00886643584817648, -0.016224591061472893, 0.026979902759194374, 0.010945607908070087, 0.010579110123217106, -0.009698105044662952, -0.03436625003814697, -0.037270043045282364, 0.042260054498910904, 0.0139762656763196, -0.00385175459086895, -0.06472921371459961, 0.007555500138550997, 0.0028315505478531122, -0.002997179515659809, -0.005081637762486935, -0.022596020251512527, 0.03588862717151642, -0.029770925641059875, -0.027261823415756226, 0.008084103465080261, -0.052634771913290024, -0.0014245853526517749, -0.03633970022201538, -0.016295071691274643, 0.03662162274122238, 0.000544901704415679, -0.035099245607852936, 0.02330082468688488, 0.07916360348463058, 0.013200981542468071, 0.008499938063323498, -0.07087510079145432, 0.055933255702257156, -0.02041112817823887, 0.03786207735538483, -0.005324795376509428, 0.003925758879631758, -0.012016910128295422, 0.0024914825335144997, -0.007386347278952599, 0.04448723793029785, 0.04970278590917587, 0.0006519438466057181, 0.004831432364881039, -0.017422758042812347, 0.027261823415756226, 0.03149065002799034, -0.0288687776774168, 0.010748263448476791, -0.03185714781284332, -0.03662162274122238, 0.006833076011389494, 0.016844818368554115, 0.008662043139338493, 0.030644884333014488, -0.006864792201668024, 0.0054481360130012035, -0.00588159030303359, 0.021581102162599564, 0.005941499024629593, 0.025246083736419678, 0.07313047349452972, 0.04335955157876015, -0.019692227244377136, -0.011424874886870384, -0.02046751230955124, -0.012862675823271275, -0.024639952927827835, 0.012897915206849575, -0.017267702147364616, -0.0157594196498394, -0.021397853270173073, -0.015364729799330235, 0.0073511069640517235, 0.022680597379803658, -0.005233170464634895, 0.04096321761608124, -0.04147067666053772, -0.022159041836857796, 0.029968271031975746, -0.007400443311780691, 0.0261482335627079, 0.004109008237719536, -0.05412895604968071, -0.016816627234220505, 0.022384578362107277, -0.03089861385524273, -0.0064560058526694775, -0.004334545228630304, -0.009874305687844753, -0.005025253631174564, 0.0025989653076976538, -0.02582402341067791, -0.02027016691863537, -0.013264413923025131, 0.030250193551182747, -0.01850815676152706, -0.01571713201701641, -0.06027485057711601, 0.011142953298985958, 0.023906955495476723, 0.026416059583425522, -0.03698812052607536, -0.09951834380626678, -0.0315188392996788, -0.029883695766329765, 0.019029712304472923, 0.013405374251306057, 0.009994122199714184, 0.014603541232645512, -0.002731116022914648, 0.009317510761320591, -0.021806640550494194, -0.005719485692679882, -0.007724653463810682, -0.021496526896953583, 0.001643955591134727, 0.0011127095203846693, -0.009331606328487396, 0.02368141897022724, 0.011023136787116528, -0.055256642401218414, 0.032223645597696304, -0.021567005664110184, 0.00581815792247653, 0.05942908301949501, 0.016971683129668236, -0.01577351614832878, -0.04409254714846611, -0.004249969031661749, -0.04660164937376976, -0.0154070183634758, -0.004161868244409561, 0.006262184586375952, 0.007337010931223631, 0.004063196014612913, -0.010128035210072994, -0.0019523074151948094, -0.019508978351950645, 0.0117138447239995, -0.010191467590630054, 0.04375424236059189, 0.02087629772722721, -0.032561950385570526, 0.0006955535500310361, 0.0411323681473732, -0.05212731286883354, 0.02626100182533264, 0.030447538942098618, -0.04598142206668854, 0.019057903438806534, -0.0064912461675703526, 0.024456704035401344, -0.017324086278676987, 0.016760243102908134, 0.015139192342758179, -0.03070126846432686, -0.05446726456284523, -0.047757528722286224, -0.012714666314423084, -0.013243270106613636, 0.017140837386250496, 0.0229343269020319, 0.032280027866363525, -0.06145891919732094, 0.014462580904364586, 0.008535178378224373, -0.02850227989256382, -0.009832018055021763, -0.02354045771062374, -0.009303414262831211, -0.0013479378540068865, 0.010128035210072994, 0.009585335850715637, -0.0023505217395722866, -0.05982377380132675, 0.03425348177552223, -0.008112295530736446, 0.018832366913557053, 0.008077055215835571, -0.03182895481586456, 0.04710910841822624, -0.005620812997221947, -0.0038376585580408573, 0.0032456230837851763, -0.027910243719816208, 0.0010765882907435298, -0.018677309155464172, 0.04048394784331322, -0.025344757363200188, -0.04338774085044861, -0.003536354750394821, -0.0007902616052888334, 0.027684707194566727, 0.04488192871212959, -0.019875476136803627, -0.013623863458633423, -0.007086805533617735, 0.004531890619546175, 0.011882998049259186, -0.0020122157875448465, -0.002687065862119198, -0.02334311231970787, -0.02589450404047966, 0.007781037595123053, -0.008218016475439072, -0.035240206867456436, -0.03955360874533653, -0.013433566316962242, 0.009324559010565281, -0.011544691398739815, -0.026895325630903244, 0.004249969031661749, -0.00459884712472558, 0.009761537425220013, -0.03543755039572716, 0.026712076738476753, 0.006575822364538908, 0.0045530349016189575, -0.04327497258782387, 0.02042522467672825, -0.0049124849028885365, -5.118089393363334e-05, -0.004930105060338974, -0.006029599346220493, -0.049956515431404114, -0.047729335725307465, -0.040399372577667236, 0.011037232354283333, -0.001371724996715784, 0.042485594749450684, 0.003441206179559231, 0.030447538942098618, -0.017577815800905228, 0.002891459036618471, -0.009444375522434711, -0.004450838081538677, -0.045022886246442795, 0.007992479018867016, 0.0045072222128510475, -0.005465756170451641, 0.04942086711525917, 0.008126392029225826, 0.06506751477718353, -0.0017840354703366756, -0.0010184419807046652, -0.0025690109468996525, -0.012418649159371853, 0.028896968811750412, -0.016929395496845245, -0.027318207547068596, -0.04975917190313339, -0.014674021862447262, -0.03354867547750473, -0.03098318912088871, 0.023963339626789093, -0.011009040288627148, 0.008732522837817669, -0.03464817255735397, -0.008126392029225826, -0.03098318912088871, -0.01599905453622341, 0.0178456399589777, -0.022567829117178917, -0.016774337738752365, 0.0056948172859847546, -0.03430986404418945, -0.007435683626681566, 0.026542924344539642, -0.011206385679543018, 0.006582870613783598, 0.022821558639407158, 0.010078699328005314, 0.044910117983818054, -0.03594500944018364, -0.06315045058727264, -0.002549628959968686, 0.03185714781284332, -0.005687769502401352, 0.012186063453555107, -0.030588500201702118, -0.029742734506726265, -0.009211789816617966, 0.05869608744978905, 0.024343933910131454, -0.03075765259563923, -0.007506163790822029, -0.0045142704620957375, -0.02043931931257248, 0.016788434237241745, -0.005458707921206951, -0.002376951975747943, 0.014984135515987873, 0.0015849282499402761, -0.0049019125290215015, -0.0205661840736866, -0.029911886900663376, -0.021270988509058952, -0.030165616422891617, -0.004052623640745878, -0.0011796659091487527, 0.008401265367865562, -0.05627156049013138, 0.006625158712267876, -0.01774696819484234, -0.024470798671245575, 0.005522140301764011, 0.006297424901276827, 0.003088804194703698, -0.0008122867438942194, 0.004253493156284094, 0.019071999937295914, -0.01015622727572918, -0.0077528455294668674, 0.011424874886870384, -0.007724653463810682, 0.0024544803891330957, -0.0036720295902341604, -0.01564665138721466, 0.016957586631178856, 0.010142131708562374, -0.013708440586924553, 0.021609295159578323, 0.023864667862653732, -0.00912721361964941, 0.03399975225329399, -0.012615993618965149, 0.013172789476811886, -0.03865145891904831, -0.0002999822609126568, 0.019071999937295914, -0.020072821527719498, 0.021355565637350082, -0.006797835696488619, -0.032336413860321045, -0.0053001269698143005, 0.006801359821110964, -0.006103603634983301, -0.02077762596309185, 0.0010942084481939673, 0.003795370226725936, -0.027191342785954475, -0.03306940943002701, -0.008662043139338493, 0.028826488181948662, -0.02341359294950962, -0.021299181506037712, -0.0027223059441894293, 0.011164097115397453, 0.008669090457260609, 0.05909077823162079, 0.0004995299386791885, 0.03332313895225525, -0.0016959349159151316, 0.009155405685305595, 0.004743331577628851, -0.014829078689217567, -0.016661569476127625, -0.0030923280864953995, -0.028925161808729172, -0.00174703320953995, 0.008697283454239368, 0.007992479018867016, -0.01431457232683897, 0.0022254190407693386, -0.02294842340052128, 0.0033055313397198915, -0.027656514197587967, -0.011135905049741268, -0.042541977018117905, 0.013440614566206932, 0.03574766591191292, -0.017112644389271736, -0.11316335201263428, -0.002845646580681205, 0.030222000554203987, 0.0015620221383869648, 0.026838941499590874, -0.016971683129668236, 0.022497348487377167, 0.0018016555113717914, -0.014145419001579285, -0.05965462327003479, -0.006128272041678429, 0.0025831072125583887, 0.008274400606751442, -0.029150698333978653, -0.01843767613172531, -0.02817806974053383, 0.013870545662939548, -0.015096904709935188, 0.016675665974617004, -0.0071009015664458275, -0.013807113282382488, -0.012531417421996593, -0.024047916755080223, 0.03865145891904831, -0.03182895481586456, -0.009613527916371822, 0.026810748502612114, 0.01138258632272482, 0.0020315980073064566, 0.0077457972802221775, 0.0024016201496124268, -0.009881353937089443, 0.014131322503089905, -0.013243270106613636, -0.04987194016575813, -0.0012457412667572498, -0.006709735374897718, -0.00017796304018702358, -0.013560431078076363, 0.025471622124314308, 0.0064947702921926975, -0.04096321761608124, 0.04818040877580643, 0.010868079960346222, 0.026444250717759132, -0.029348043724894524, 0.03546574339270592, 0.0028209786396473646, 0.00795723870396614, 0.005744153633713722, 0.01838129200041294, -0.022525539621710777, -0.003037705784663558, -0.015082808211445808, -0.01416656281799078, 0.009641720913350582, 0.012383408844470978, 0.021482430398464203, 0.0007528188871219754, -0.0018783030100166798, -0.015153288841247559, 0.050379399210214615, 0.01845177263021469, -0.016999876126646996, -0.04375424236059189, -0.005370607599616051, -0.013891689479351044, 0.0408504493534565, -0.032505568116903305, -0.029855502769351006, 0.018733693286776543, -0.014800886623561382, 0.01308116503059864, 0.02579583041369915, -0.004306353162974119, -0.012270639650523663, 0.026655692607164383, 0.029207082465291023, -0.034591786563396454, 0.02813578024506569, 0.0280934926122427, -0.047870296984910965, 0.010445197112858295, 0.025006450712680817, -0.007143189664930105, 0.03642427921295166, 0.020044630393385887, -0.02569715864956379, 0.0005026134313084185, 0.017450951039791107, 0.0076048364862799644, -0.006279804743826389, 0.009141309186816216, -0.03918711096048355, 0.0013505809474736452, -0.035099245607852936, -0.07448370009660721, 0.037692926824092865, 0.032082684338092804, -0.005927402526140213, 0.03879242017865181, 0.0308140367269516, 0.022736981511116028, -0.0012624803930521011, 0.006177608389407396, -0.004059671889990568, -0.007795133627951145, 0.0007259482517838478, 0.042767513543367386, -0.03856688365340233, 0.005462232045829296, 0.019325729459524155, -0.014758598990738392, 0.02062256820499897, -0.0141172269359231, 0.04832137003540993, 0.030165616422891617, 0.006237516645342112, 0.016224591061472893, 0.005113353952765465, 0.03357686847448349, 0.02327263168990612, -0.03673439100384712, -0.005042873788625002, 0.006068363785743713, -0.022694693878293037, 0.010734166949987411, 0.019762707874178886, -0.015942668542265892, 0.012919059954583645, 0.019847285002470016, -0.007337010931223631, 0.021736159920692444, -0.002549628959968686, 0.004126628395169973, 0.04569949954748154, 0.001155878766439855, -0.0014360384084284306, -0.0469963401556015, 0.0356912799179554, 0.016323262825608253, -0.001556736184284091, -0.010614350438117981, 0.014603541232645512, -0.019833188503980637, 0.03377421572804451, 0.00576177379116416, -0.01578761264681816, -0.045135658234357834, 0.021440140902996063, 0.0313778817653656, -0.04048394784331322, -0.0015831663040444255, -0.004732759669423103, -0.0007722010486759245, 0.03061669133603573, 0.032392796128988266, -0.02299071103334427, -0.0017496763030067086, 0.014145419001579285, -0.004538938403129578, 0.03146245703101158, -0.004577702842652798, -0.040568526834249496, 0.03315398469567299, -0.022074464708566666, -0.0010166799183934927, 0.0016430746763944626, -0.010987896472215652, -0.007294722832739353, -0.021468333899974823, -0.04953363537788391, 0.025401141494512558, 0.02313167229294777, 0.020044630393385887, 0.03436625003814697, 0.0032931973692029715, 0.027064478024840355, -0.000270909076789394, 0.027712898328900337, 0.022638307884335518, 0.04603780433535576, -0.02345588244497776, -0.02575354278087616, 0.03910253196954727, -0.02039703167974949, 0.00194173539057374, 0.01764829456806183, 0.011918237432837486, 0.022708788514137268, 0.04451542720198631, 0.000870873627718538, 0.009218838065862656, 0.026979902759194374, 0.01418770756572485, -0.016182303428649902, -0.024273455142974854, 0.02879829704761505, 0.00026606355095282197, -0.06771758198738098, -0.04598142206668854, 0.05170443281531334, -0.006885936483740807, -0.024019725620746613, -0.034845516085624695, 0.02348407357931137, -0.00026914707268588245, -0.010649590753018856, 0.010374716483056545, 0.040061067789793015, -0.007731701247394085, 0.016013149172067642, -0.031941723078489304, 0.022412771359086037, 0.0017144361045211554, -0.004954773001372814, 0.013983313925564289, 0.0005797013873234391, -0.021411949768662453, -0.00221660896204412, -0.03388698399066925, -0.019086096435785294, 0.024132493883371353, -0.002678255783393979, -0.027586033567786217, -0.03185714781284332, 0.034619979560375214, -0.010720070451498032, 0.00097703468054533, 0.011333250440657139, 0.0020967922173440456, 0.005021729506552219, -0.011241625994443893, -0.001359391026198864, -0.03267471864819527, -0.015153288841247559, 0.003619169117882848, -0.010727118700742722, -0.008803003467619419, 0.016182303428649902, 0.06377067416906357, -0.005071065854281187, -0.02089039422571659, -0.0014166563050821424, 0.04465638846158981, -0.009014444425702095, 0.017225412651896477, 0.04051214084029198, -0.03636789321899414, -0.0018430628115311265, -0.01829671487212181, 0.034422632306814194, 0.027684707194566727, -0.0010475151939317584, 0.006251612678170204, 0.0037354619707912207, 0.014955943450331688, 0.04090683162212372, 0.021327372640371323, 0.007978382520377636, -0.035155631601810455, 0.017070356756448746, 0.00037508795503526926, -0.0042640650644898415, 0.0017690584063529968, -0.042372822761535645, -0.005962642841041088, 0.019114287570118904, 0.02065076120197773, 0.021299181506037712, -0.044938310980796814, 0.034591786563396454, 0.0154070183634758, 0.034958284348249435, -0.00775989331305027, 0.007851517759263515, 0.010191467590630054, -0.019128384068608284, 0.024090204387903214, 0.0035152107011526823, -0.024400319904088974, 0.005296602845191956, -0.05708913505077362, -0.037692926824092865, 0.004017383325845003, -0.0154070183634758, 0.022314099594950676, -0.0035116865765303373, -0.0030518018174916506, 0.012637138366699219, 0.060782309621572495, 0.04152705892920494, -0.008182776160538197, 0.014413244090974331, 0.005067541729658842, -0.037749309092760086, -0.018649118021130562, 0.013891689479351044, -0.012256544083356857, 0.004419121891260147, 0.010741215199232101, 0.029911886900663376, 0.01533653773367405, -0.0010254899971187115, 0.03633970022201538, 0.0012968395603820682, -0.0072453864850103855, -0.01818394660949707, -0.0014360384084284306, -0.02067895233631134, -0.006611062679439783, -1.9643661289592274e-05, 0.023906955495476723, -0.032139066606760025, -0.008210968226194382, 0.009980026632547379, 0.0010008218232542276, 0.00011541167623363435, -0.007435683626681566, -0.012524369172751904, -0.008471745997667313, 0.007527308072894812, -0.017169028520584106, 0.029517197981476784, -0.02038293518126011, -0.0409914068877697, -0.020227879285812378, 0.005419943947345018, -0.0025513910222798586, 0.010508629493415356, -0.016337359324097633, 0.010741215199232101, -0.006022551096975803, -0.01542111486196518, -0.04710910841822624, -0.010043459013104439, -0.032702911645174026, -0.016069533303380013, -0.005543284583836794, 0.02619052119553089, 0.01805708184838295, 0.012136727571487427, 0.013849400915205479, -0.0076471250504255295, -0.005765297915786505, 0.008464697748422623, -0.0009065543417818844, -0.00286150467582047, 0.0034218239597976208, -0.005976738873869181, 0.07843060046434402, -0.029037930071353912, -0.01824033074080944, -0.009853161871433258, -0.026909422129392624, 0.035071052610874176, -4.5316704927245155e-05, 0.0014131322968751192, -0.040455758571624756, -0.0025566769763827324, 0.005539760459214449, 0.007456827908754349, -0.02059437707066536, 0.010529773309826851, 0.020002340897917747, 0.019706323742866516, -0.019424401223659515, 0.0255139097571373, 0.026528827846050262, 0.015040520578622818, 0.03571947291493416, 0.01547749899327755, -0.010198515839874744, 0.002091506263241172, 0.022018080577254295, -0.0022307049948722124, -0.004775047767907381, -0.0034958284813910723, -0.010980848222970963, 0.03340771421790123, 0.012129679322242737, -0.024625856429338455, -0.050492167472839355, 0.004693995695561171, -0.022159041836857796, -0.0016650997567921877, -0.013919881545007229, 0.021059546619653702, 0.02315986342728138, 0.00041539393714629114, 0.00705156521871686, 0.008901676163077354, -0.002042169915512204, 0.0018501108279451728, 0.016858914867043495, 0.026599308475852013, -0.019156577065587044, 0.02039703167974949, 0.008246208541095257, 0.018846463412046432, 0.020058725029230118, -0.0012078580912202597, 0.0408504493534565, 0.001703863963484764, -0.0008312283898703754, -0.00795723870396614, -0.0033583915792405605, 0.03783388435840607, 0.006589918863028288, 0.02048160880804062, -0.030306577682495117, 0.024076109752058983, -0.01793021708726883, -0.01048748567700386, 0.01592857390642166, -0.027670610696077347, 0.013708440586924553, 0.01842357963323593, -0.027557842433452606, 0.04048394784331322, -0.015096904709935188, 0.004161868244409561, -0.02606365643441677, -0.017507335171103477, -0.0157594196498394, 0.02315986342728138, -0.032054491341114044, 0.006766119506210089, 0.024710433557629585, 0.02346997708082199, -0.012587801553308964, 0.01839538849890232, -0.0260072723031044, -0.0014078462263569236, -0.016266878694295883, -0.010128035210072994, 0.022511443123221397, -0.015209672972559929, -0.027445072308182716, 0.02354045771062374, -0.017324086278676987, 0.011495355516672134, 0.03969457000494003, 0.013334894552826881, -0.016675665974617004, -0.01825442723929882, -0.019480785354971886, -0.009310462512075901, -0.006085983477532864, -0.00024293716705869883, -0.01852225326001644, -0.01023375615477562, 0.042654745280742645, 0.011065424419939518, -0.009472567588090897, 0.005476328078657389, -0.02593679167330265, -0.009712200611829758, -0.009021492674946785, 0.008492889814078808, -0.01560436375439167, -0.012249495834112167, 0.018902847543358803, 0.010212612338364124, -0.025401141494512558, -0.003827086417004466, 0.006040171254426241, 0.03301302716135979, 0.024682240560650826, -0.0006951130926609039, 0.0068506961688399315, 0.0076471250504255295, 0.00088937469990924, 0.02841770276427269, -0.009902497753500938, 0.019114287570118904, -0.0020597900729626417, 0.002191940788179636, -0.010501581244170666, -0.0014052032493054867, -0.01036766916513443, 0.004475506022572517, 0.02318805642426014, -0.000122900222777389, 0.016605185344815254, 0.018916942179203033, -0.01573122851550579, -0.02038293518126011, -0.008746619336307049, -0.007654172834008932, 0.011065424419939518, 0.02354045771062374, -0.005229646805673838, 0.024372126907110214, 0.004627039190381765, -0.02080581709742546, 0.013482903130352497, -0.02602136880159378, 0.04158344492316246, 0.026514731347560883, 0.0006307996809482574, 0.047898489981889725, -0.00582520617172122, 0.04358508810400963, 0.0021461285650730133, 0.0028579807840287685, 0.025091027840971947, 0.0002715698501560837, 0.034619979560375214, -0.0028385985642671585, 0.02564077451825142, -0.01804298534989357, 0.001647479715757072, 0.012129679322242737, 0.04361328110098839, 0.01288381963968277, 0.004175964277237654, -0.014448484405875206, -0.009155405685305595, -0.0065934425219893456, 0.005997883155941963, 0.013031828217208385, 0.014970039948821068, -0.03862326592206955, 0.009698105044662952, 0.010008218698203564, -0.014603541232645512, 0.007520260289311409, -0.02578173577785492, 0.010071651078760624, -0.01787383295595646, -0.009141309186816216, 0.024851392954587936, 0.035071052610874176, 0.00385175459086895, -0.022412771359086037, 0.029855502769351006, 0.026514731347560883, 0.007358155213296413, -0.0022095609456300735, 0.0024227641988545656, -0.0038094662595540285, 0.0518735833466053, 0.009557143785059452, 0.03103957325220108, 0.026937613263726234, 0.017535526305437088, -0.013969218358397484, 0.02840360626578331, 0.03941264748573303, 0.0030236097518354654, -0.013835305348038673, 0.003774226177483797, 0.02077762596309185, -0.013172789476811886, 0.03160341829061508, 0.0005034944624640048, 0.005472803954035044, 0.010762359015643597, -0.006974036805331707, 0.021863024681806564, 0.005638433154672384, 0.012009862810373306, -0.0034623502288013697, 0.0035751189570873976, -0.002731116022914648, 0.0205661840736866, 0.022060370072722435, -0.016421936452388763, -0.01587218977510929, 0.009395038709044456, -0.035014670342206955, 0.013616816140711308, 0.0003541640762705356, -0.004281685221940279, 0.001349699916318059, 0.03842592239379883, 0.035268399864435196, -0.0038447065744549036, -0.0005149475182406604, -0.003016561735421419, -0.03422528877854347, 0.00323857506737113, 0.0014052032493054867, -0.0016668618191033602, -0.01274990662932396, -0.009528951719403267, -0.019917765632271767, 0.029911886900663376, 0.03315398469567299, -0.01574532501399517, 0.0026007271371781826, 0.0035627849865704775, -0.016323262825608253, 0.010106891393661499, 0.050323013216257095, 0.025175603106617928, 0.022539636120200157, -0.044769156724214554, 0.019241152331233025, -0.01766239106655121, 0.024498991668224335, -0.010649590753018856, -0.02025607042014599, 0.030250193551182747, -0.004676375538110733, 0.007682364899665117, -0.01054386980831623, -0.0009109593229368329, 0.022680597379803658, 0.012524369172751904, -0.0078444704413414, -0.01177727710455656, 0.0025002926122397184, -0.03715727478265762, 0.027853859588503838, -0.03679077699780464, -6.0293790738796815e-05, -0.026317385956645012, 0.0035698330029845238, 0.0018201566999778152, 0.013313749805092812, 0.019804995507001877, 0.009662864729762077, -0.032251838594675064, 0.007037469185888767, -0.011086569167673588, -0.008457649499177933, 0.023878764361143112, -0.01048748567700386, 0.022553732618689537, -0.005324795376509428, 0.0026535876095294952, 0.019114287570118904, 0.035268399864435196, 0.0002570332435425371, -0.02596498467028141, -0.037382811307907104, 0.008140487596392632, 0.02822035737335682, -0.04234463348984718, 0.001593738328665495, 0.022159041836857796, -0.016280975192785263, -0.00021551588724832982, 0.004345117602497339, 0.027388688176870346, -0.01832490786910057, -0.03605777770280838, 0.04581226781010628, -0.027614226564764977, -0.013031828217208385, 0.021144123747944832, -0.0007404848583973944, 0.04460000619292259, 0.018719598650932312, -0.019311632961034775, 0.022511443123221397, -0.013116405345499516, 0.016055438667535782, 0.008746619336307049, -8.138285193126649e-05, 0.012080342508852482, 0.019931860268115997, 0.02624690532684326, 0.004493126180022955, -0.005493948236107826, 0.007675317116081715, -0.02045341581106186, 0.014145419001579285, -0.015505691058933735, -0.0033460576087236404, 0.0020210258662700653, 0.012327024713158607, 0.0051626903004944324, -0.010311284102499485, 0.0018148706294596195, 0.0064489576034247875, 0.013511095196008682, 0.00257429713383317, 0.03422528877854347, 0.0179866012185812, 0.012693522498011589, 0.019635843113064766, 0.003855278715491295, 0.037890270352363586, -0.01312345266342163, 0.004517794586718082, 0.011438971385359764, -0.02803710848093033, -0.0046622795052826405, 0.005500996019691229, -0.006808408070355654, 0.008020671084523201, -0.01177727710455656, 0.005934450775384903, 0.01431457232683897, 0.0016245734877884388, -0.0157594196498394, 0.019917765632271767, 0.027557842433452606, 0.0567508302628994, -0.02864323928952217, 0.001502994797192514, -0.015576171688735485, 0.0063467612490057945, 0.010522725991904736, -0.01767648756504059, -0.03072945959866047, 0.004718663636595011, -0.04569949954748154, -0.01436390820890665, -0.0008387169218622148, 0.01542111486196518, -0.024611759930849075, 0.014730405993759632, 0.0007933451561257243, 0.008225063793361187, -0.0008285853546112776, -0.021919408813118935, 0.02616233006119728, 0.019762707874178886, 0.01276400312781334, 0.00907082948833704, -0.029009738937020302, -0.029658157378435135, -0.03284387290477753, -0.01403969805687666, 0.013257365673780441, -0.005895686335861683, -0.021214604377746582, -0.04620695859193802, -0.011410779319703579, -0.014074938371777534, 0.0006153821013867855, 0.0009673436870798469, 0.013024779967963696, 0.0035275446716696024, -0.02304709516465664]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" the preference signal yt,ifrom the underlying BT model;
•the next iteration begins.
The main technical challenge here is to decide the behavior policy pairs ( π1
t, π2
t). It is well known that it is
important to strike a balance between exploration and exploitation to get RL works (Auer et al., 2002), and
we study such a trade-off in the context of online iterative RLHF.
4.2 Algorithms
Non-symmetric algorithmic structure. Our first idea is to adopt a non-symmetric structure in choosing
π1
tandπ2
t. Specifically, we refer the π1
tas the main agent, which aims to learn a good policy so that the
suboptimality gap J(π∗)−J(π1
t) is small. In contrast, the second agent, referred to as the enhancer, seeks
to enhance the learning of the main agent by choosing appropriate π2
t. The main advantage of such a
non-symmetric structure is that we have a lot of freedoms to choose π2
tbecause we do not worry about the
sub-optimality incurred by it (Jin et al., 2021a; Xiong et al., 2022b; Huang et al., 2021).
From a high level, the Online Iterative GSHF Algorithm continuously enhances the historical dataset by
strategically interacting with the human labeller. Specifically, in Algorithm 2, the main agent always ex-
ploits all the historical information by taking the optimal policy induced from the MLE rMLE. This process,
however, requires the newly collected data can provide more information, compared to those collected pre-
viously. We divide the problem into two different situations.
Option I. If the Doffis diverse enough and provides us with a good coverage in terms of the ( π∗, πref), we
do not need to actively explore and can take π2
t=πrefdirectly2;
2We also mention in passing that for most of the cases, πref=π0. We use πreffor a slightly more general formulation.
13
Algorithm 2 Online Iterative GSHF
1:Input: m,Π,Doff(if applicable, otherwise Doff=∅),β.
2:fort= 1,2,···, Tdo
3: Observe xt,i∼d0fori= 1,2,···, m1.
4: Exploitation with the main agent: denote the MLE rMLE with the likelihood in Equation (3) and
compute the best guess we have so far:
π1
t= argmax
π∈ΠEx∼d0Ea∼π(·|x)h
rMLE(x, a)−ηDKL(π(·|x)∥π0(·|x))i
. (6)
5: Exploration with the enhancer:
6: Option I: ifDoffcan provide good coverage, no need to explore so π2
t=πref;
7: Option II: otherwise, choose π2
tby maximizing the relative uncertainty relative to π1
t:
argmax
eπΓm
t(λ, π1
t,eπ) :=β·mX
i=1∥ϕ(xt,i,eπ)−ϕ(xt,i, π1
t)∥Σ−1
t,m
subject to: eπ∈Πt={π′∈Π :η·Ex∼d0DKL(π′(·|x), π1
t(·|x))≤Γm
t(λ, π1
t, π′)},
where Σ t,m=λI+1
mt−1X
i=1mX
j=1(ϕ(xi,j, a1
i,j)−ϕ(xi,j, a2
i,j))(ϕ(xi,j, a1
i,j)−ϕ(xi,j, a2
i,j))⊤.(7)
8: Sample a1
t,i∼πtanda2
t,i∼π2
t, receive human feedback for all i∈[m], and collect them as Dt.
9:end for
10:Output: the best model in π1
1:Tby a validation set.
Option II. If we cannot expect to have a diverse Doff, the enhancer aims to maximizes the uncertainty
relative to the main agent π1
t, while maintaining a moderate KL divergence3. In this case, the π2
taims to
explore toward the direction that","[-0.02149074524641037, -0.021934138610959053, 0.05775204673409462, -0.0028214396443217993, -0.009616103954613209, 0.027698257938027382, 0.0019519721390679479, 0.031231554225087166, -0.029624251648783684, 0.03680168837308884, 0.04170673340559006, -0.05334582179784775, -0.035028114914894104, -0.01804058626294136, -0.02016056329011917, -0.011431246995925903, 0.01319096703082323, -0.05719780549407005, -0.005268765613436699, 0.050103504210710526, 0.0005061791162006557, -0.030760446563363075, 0.04971553385257721, 0.08230498433113098, -0.0048634763807058334, -0.002310497686266899, 0.01852554827928543, 0.04525388404726982, 0.017167655751109123, -0.029125433415174484, 0.036358293145895004, -0.02573069930076599, -0.0331714004278183, 0.0020022003445774317, -0.007904880680143833, 0.04264894500374794, 0.004814980085939169, 0.036496855318546295, -0.018622541800141335, 0.037660762667655945, 0.01935691200196743, -0.0400162935256958, -0.061742592602968216, 0.030649598687887192, 0.0015094442060217261, 0.004222633317112923, 0.009726952761411667, -0.030400190502405167, 0.036496855318546295, 0.008445266634225845, -0.02704702317714691, 0.041734445840120316, -0.053567517548799515, 0.002610134892165661, 0.01198549009859562, 0.008556115441024303, 0.01707066223025322, -0.03017849288880825, 0.028086228296160698, -0.025689130648970604, 0.002852615900337696, -0.003422446083277464, 0.0216708742082119, 0.027005456387996674, -0.0015995086869224906, 0.031231554225087166, -0.061299197375774384, 0.057308655232191086, 0.003178233280777931, 0.04195614159107208, -0.019259920343756676, -0.020728662610054016, 0.048274505883455276, -0.05104571580886841, -0.028598902747035027, 0.024663781747221947, 0.03261715918779373, 0.021587736904621124, 0.0345015823841095, -0.01163908839225769, 0.013121685944497585, -0.021934138610959053, 0.025065608322620392, -0.019121360033750534, -0.005746799986809492, -0.07742764800786972, -0.035000402480363846, -0.029430266469717026, -0.0633498951792717, -0.05071317031979561, -0.004267665557563305, 0.02097807079553604, -0.020797941833734512, 0.020562389865517616, 0.02639579027891159, -0.01108484622091055, 0.008694675751030445, -0.025689130648970604, 0.033393099904060364, -0.004970860667526722, 0.021712442860007286, -0.04458879306912422, -4.823910785489716e-06, -0.010260410606861115, 0.06041241064667702, -0.03178579732775688, -0.01607302576303482, 0.08108564466238022, -0.0035142425913363695, -0.003748063463717699, -0.07892410457134247, -0.05924850329756737, -0.03367022052407265, 0.011874641291797161, -0.005913072731345892, -0.05608931928873062, -0.047498565167188644, -0.005854184273630381, -0.0013752137310802937, -0.013814489357173443, -0.03311597555875778, -0.021255191415548325, 0.012747572734951973, 0.014867549762129784, -0.011126413941383362, 0.009796232916414738, 0.045198459178209305, -0.06290650367736816, -0.04079223424196243, -0.0015103102196007967, 0.03001222014427185, 0.028086228296160698, -0.033697932958602905, -0.04555871710181236, -0.029901372268795967, 0.024040259420871735, -0.03763305023312569, 0.008313634432852268, -0.013648216612637043, 0.004236489534378052, -0.036192022264003754, -0.06750670820474625, -0.0525144562125206, 0.007932593114674091, -0.011749936267733574, 0.041928429156541824, -0.013897625729441643, -0.001256571151316166, 0.005895752459764481, 0.010759228840470314, -0.013384951278567314, -0.022114267572760582, 0.0007703101728111506, 0.01708451844751835, 0.0030136925633996725, -0.025301160290837288, -0.0603569857776165, 0.040265701711177826, 0.0195093285292387, -0.004364658147096634, -0.030871296301484108, 0.07532152533531189, -0.013987690210342407, 0.011514383368194103, 0.023416737094521523, 0.04361886903643608, -0.02244681306183338, 0.013890697620809078, -0.0481913685798645, 0.002139028860256076, 0.00903414934873581, -0.024677637964487076, -0.05941477417945862, -0.009907080791890621, 0.008140433579683304, -0.022543804720044136, -0.040736809372901917, -0.04228868708014488, -0.01008720975369215, -0.04860704764723778, 0.03439073637127876, 0.02395712397992611, 0.019287632778286934, -0.004562106914818287, -0.027809107676148415, 0.026950031518936157, -0.012276466935873032, -0.046972036361694336, 0.00859768409281969, 0.0218371469527483, 0.008105793967843056, 0.025841547176241875, 0.053068701177835464, 0.009678456000983715, -0.0026274549309164286, 0.006737507879734039, 0.06257395446300507, 0.030317053198814392, 0.016128450632095337, 0.03247859701514244, 0.01790202595293522, -0.01336416695266962, -0.020756373181939125, -0.05658813938498497, 0.010842365212738514, -0.010558315552771091, 0.015283231623470783, 0.03308826684951782, -0.022238971665501595, 0.004004400689154863, -0.0013821417232975364, -0.0007036279421299696, 0.03197978064417839, 0.01689053326845169, -0.04345259442925453, 0.021726297214627266, -0.02643735706806183, 0.0023243536707013845, 0.020091284066438675, 0.045364733785390854, -0.01852554827928543, 0.031120704486966133, -0.00868774764239788, 0.029097720980644226, -0.015019966289401054, 0.013772920705378056, 0.05725323036313057, -0.03774389997124672, 0.018927374854683876, -0.02560599334537983, 0.0468611866235733, 0.009470615535974503, -0.014244027435779572, -0.0393512025475502, 0.0008400235092267394, -0.02561984956264496, -0.002705395221710205, -0.013634360395371914, 0.036967962980270386, -0.0505191870033741, -0.000446424848632887, 0.04528159648180008, 0.01287227775901556, -0.04281521588563919, -0.023749282583594322, 0.008493763394653797, -0.0186779648065567, -0.03441844508051872, -0.01805444248020649, -0.006851820275187492, -0.0022931774146854877, -0.040736809372901917, -0.022557660937309265, -0.02593853883445263, -0.027642834931612015, -0.0029478762298822403, 0.024830054491758347, 0.010232698172330856, -0.06855977326631546, -0.003561006858944893, -0.022072698920965195, 0.0026361148338764906, 0.018012873828411102, 0.022197404876351357, -0.01919063925743103, -0.00398361636325717, -0.011936993338167667, -0.019966578111052513, 0.01147281564772129, -0.011091774329543114, 0.008188930340111256, 0.02676990255713463, -0.0220034196972847, 0.03757762908935547, -0.025037895888090134, -0.05121198669075966, 0.01871953345835209, 0.0606895312666893, -0.047831110656261444, -0.030150780454277992, -0.02474691905081272, 0.004253809805959463, 0.043036915361881256, -0.021560024470090866, 0.054066337645053864, -0.014853693544864655, -0.011597519740462303, -0.016987526789307594, -0.021102774888277054, 0.010856221430003643, 0.03203520551323891, -0.01576819270849228, 0.027518130838871002, -0.05708695575594902, 0.004333482123911381, 0.023873986676335335, -0.0002812346792779863, -0.006578163243830204, 0.021061208099126816, 0.005836864002048969, 0.04860704764723778, -0.0009257578640244901, -0.02954111434519291, 0.04057053476572037, -0.022862493991851807, -0.014257882721722126, 0.00244213012047112, 0.005421182606369257, 0.015782048925757408, 0.014382587745785713, -0.0014973202487453818, 0.005653271451592445, 0.007371422369033098, 0.03624744713306427, 0.03195206820964813, -0.017611049115657806, 0.047332290560007095, -0.014645853079855442, -0.01401540171355009, -0.03292199224233627, -0.039960868656635284, -0.057641200721263885, -0.030233917757868767, 0.0004520538786891848, 0.04882874712347984, -0.022904062643647194, 0.03430759906768799, -0.003803487867116928, -0.04406226426362991, -0.002722715260460973, 0.0015085783088579774, 0.01686282269656658, 0.04395141452550888, -0.009900152683258057, 0.011611375957727432, 0.00693149259313941, -0.05148911103606224, 0.020894935354590416, 0.04760941490530968, 0.014022329822182655, -0.06612110882997513, 0.010163418017327785, -0.032062917947769165, 0.014153962954878807, -0.04810823127627373, 0.02557828277349472, 0.011292686685919762, 0.020271411165595055, -0.0013587595894932747, 0.04292606562376022, 0.007309070322662592, -0.02821093238890171, 0.02280707098543644, 0.031758084893226624, -0.04450565576553345, -0.004756091628223658, 0.013398807495832443, -0.025204168632626534, -0.02951340191066265, -0.010925501585006714, -0.04672262445092201, 0.03685711324214935, 0.0211720559746027, -0.005635951180011034, -0.005109420977532864, 0.0653451681137085, -0.00636339420452714, 0.011167982593178749, -0.013232534751296043, -0.002339941682294011, -0.006093201227486134, 0.039462052285671234, -0.06229683384299278, 0.022737789899110794, -0.04727686941623688, 0.0033254537265747786, 0.04821908101439476, -0.004582890775054693, 0.020146707072854042, 0.04284292832016945, -0.03145325183868408, -0.01999429054558277, -0.02445594221353531, -0.06905858963727951, 0.0029080400709062815, 0.0009439439163543284, -0.02934712916612625, -0.01639171503484249, -0.05714238062500954, -0.008860948495566845, 0.05168309435248375, -0.032229188829660416, 0.0032942777033895254, 0.015989890322089195, -0.011348110623657703, -0.03547150641679764, -0.02606324478983879, 0.04037655144929886, 0.06107750162482262, 0.06246310845017433, -0.019329199567437172, -0.034030478447675705, -0.07044419646263123, -0.0022377532441169024, -0.05495312437415123, 0.005999672692269087, -0.004402762278914452, 0.05725323036313057, 0.026659054681658745, 0.03153638541698456, 0.01197163388133049, -0.019731026142835617, 0.020562389865517616, -0.04705516993999481, 0.011465887539088726, 0.0014583499869331717, -0.00802958570420742, 0.011091774329543114, 0.05974731966853142, 0.0590268038213253, 0.02081179805099964, -0.04195614159107208, 0.011590591631829739, -0.003025816520676017, -0.014590428210794926, 0.007288285996764898, 0.0045274668373167515, -0.008660036139190197, -0.0037965597584843636, -0.04081994667649269, -0.0069661326706409454, 0.06911401450634003, 0.0007941253134049475, 0.005933856591582298, -0.0876811295747757, 0.02704702317714691, 0.023583009839057922, 0.003789631649851799, -0.016654981300234795, -0.04708288237452507, 0.04215012490749359, -0.005760655738413334, -0.02312576025724411, 0.017999019473791122, -0.024885479360818863, 0.002371117938309908, -0.03281114250421524, -0.01592060923576355, -0.02330588921904564, 0.012602084316313267, -0.02773982658982277, -0.002516606356948614, 0.0823604017496109, 0.0039039442781358957, 0.03408589959144592, -0.03907408192753792, 0.07964462041854858, -0.01770804077386856, 0.04287064075469971, 0.017098374664783478, -0.012331890873610973, -0.014230171218514442, -0.007787104230374098, -0.0009829141199588776, 0.017957450821995735, 0.05229276046156883, 0.014576571993529797, 3.9267848478630185e-05, -0.02622951753437519, 0.021601593121886253, 0.030594175681471825, -0.038159582763910294, 0.005632487125694752, -0.04849620163440704, -0.007253645919263363, 0.011334255337715149, 0.02494090422987938, -0.0011145466705784202, 0.02297334372997284, 0.019121360033750534, 0.007925665006041527, -0.018179146572947502, -0.00893715675920248, 0.0190105102956295, 0.028986871242523193, 0.051405973732471466, 0.0423441119492054, -0.02474691905081272, -0.009657671675086021, -0.020867222920060158, 0.014327163808047771, -0.01295541413128376, 0.011840000748634338, -0.016654981300234795, -0.014548860490322113, -0.019772594794631004, 0.010461322963237762, -0.011729152873158455, -0.032062917947769165, -0.006522738840430975, 0.060135290026664734, 0.0062906499952077866, -0.02724100835621357, 0.010482107289135456, -0.020091284066438675, 0.0021563488990068436, 0.01738935150206089, -0.05395548790693283, -0.009941721335053444, 0.024982471019029617, -0.048135943710803986, -0.02807237207889557, -0.03524981066584587, 0.01770804077386856, -0.0021979170851409435, -0.00322326528839767, -0.010662236250936985, -0.008819380775094032, -0.007322926539927721, 0.016336292028427124, -0.028349492698907852, -0.00992093700915575, -0.057807471603155136, 0.013738281093537807, 0.014077754691243172, 0.016627268865704536, -0.011029421351850033, -0.10962912440299988, -0.03807644546031952, -0.030926719307899475, 0.016599556431174278, -0.015255519188940525, -0.010045642033219337, 0.022349821403622627, -0.004524002783000469, -0.0020870687440037727, -0.039295777678489685, -0.016003746539354324, -0.00430230563506484, -0.02577226608991623, 0.021255191415548325, 0.0014592160005122423, -0.01840084418654442, 0.030649598687887192, 0.00976852048188448, -0.05148911103606224, 0.005383078474551439, -0.009262774139642715, 0.008590755984187126, 0.028252501040697098, 0.006533131003379822, -0.010662236250936985, -0.02870975062251091, -0.019883442670106888, -0.03671855106949806, 0.0050921011716127396, -0.02523188106715679, -0.0029825163073837757, -0.003422446083277464, -0.005279157776385546, -0.010350475087761879, 0.0014341019559651613, 0.01001792959868908, 0.0022602693643420935, -0.021366041153669357, 0.018941231071949005, 0.0036614632699638605, -0.011604447849094868, -0.0014739381149411201, 0.01869182102382183, -0.033032841980457306, 0.03020620532333851, 0.046168383210897446, -0.010579099878668785, 0.006664763670414686, 0.009013365022838116, 0.0206732377409935, 0.021435320377349854, 0.02967967465519905, 0.020077427849173546, -0.018456269055604935, -0.053040988743305206, -0.018345419317483902, -0.019426193088293076, -0.03771618753671646, -0.011119485832750797, 0.007433774881064892, 0.043369460850954056, -0.053234972059726715, 0.004215705674141645, -0.0026880751829594374, -0.014001546427607536, 0.01869182102382183, -0.011659872718155384, -0.024525221437215805, -0.014742844738066196, 0.022529948502779007, 0.003361825831234455, -2.795567888824735e-05, -0.03824272006750107, 0.03743906691670418, -0.007565407548099756, 0.013703640550374985, -0.022931775078177452, -0.039101794362068176, 0.019065935164690018, 0.0006256875931285322, 0.0042745936661958694, 0.03818729519844055, -0.0006525337230414152, 0.0030760448426008224, 0.0007923932862468064, 0.045669566839933395, -0.017652617767453194, -0.050934866070747375, -0.015463359653949738, -0.016460996121168137, 0.015297087840735912, 0.05692068487405777, 0.0023936338257044554, -0.0002693271089810878, 0.008791668340563774, 0.05137826129794121, -0.02524573728442192, -0.0007742072339169681, 0.004652171395719051, -0.004122177138924599, -0.008493763394653797, 0.02427581325173378, -0.014299451373517513, -0.03851984068751335, -0.03236775100231171, 0.0070769814774394035, 0.007440702989697456, -0.029236281290650368, -0.006675155833363533, 0.0017770393751561642, -0.0062906499952077866, -0.008299778215587139, -0.020603956654667854, 0.03325453773140907, 0.010925501585006714, -0.012435811571776867, -0.03918493166565895, 0.029291706159710884, 0.04065367206931114, 0.005608239211142063, 0.02315347269177437, -0.032700296491384506, -0.04137418791651726, -0.038159582763910294, -0.003810415742918849, 0.014327163808047771, 0.0026049388106912374, 0.04680576175451279, 0.005355366040021181, 0.012948486022651196, -0.008001873269677162, -0.0020628205966204405, -0.04212241619825363, -0.0016835109563544393, -0.003959368448704481, -0.0024282741360366344, 0.012366531416773796, 0.015033822506666183, 0.029402554035186768, 0.007468414958566427, 0.0616871677339077, 0.01639171503484249, 0.005043604876846075, -0.006945348810404539, -0.012775285169482231, 0.03973917290568352, -0.024137252941727638, -0.02149074524641037, -0.029568826779723167, -0.015463359653949738, -0.05509168282151222, -0.029485689476132393, 0.019758738577365875, -0.018303852528333664, 0.01394612155854702, -0.049798671156167984, 8.254096610471606e-05, -0.0030240844935178757, -0.002831831807270646, 0.019481616094708443, -0.05220962315797806, -0.004406226333230734, -0.006831036414951086, -0.022114267572760582, 0.0011223406763747334, 0.040930792689323425, -0.01335723977535963, 0.004440866410732269, 0.01335723977535963, 0.003153985133394599, 0.03513896092772484, -0.04248267039656639, -0.05753035098314285, 0.0056671276688575745, 0.024511365219950676, -0.012033985927700996, 0.0029080400709062815, -0.04004400596022606, -0.025065608322620392, -0.02660362981259823, 0.06456922739744186, 0.009782376699149609, -0.04990951716899872, 0.004530930891633034, -0.006650907453149557, -0.0216708742082119, 0.029153143987059593, -0.0005745933740399778, 0.007302142214030027, 0.018955087289214134, 0.026478925719857216, 0.0191767830401659, -0.02410954050719738, -0.016142306849360466, 0.0010366062633693218, -0.022072698920965195, 0.005798759870231152, -0.015615777112543583, -0.006564307026565075, -0.049937229603528976, 0.015241662971675396, -0.018331563100218773, -0.028959160670638084, 0.0007053599110804498, 0.02704702317714691, -0.00676521984860301, -0.007440702989697456, -0.010225770063698292, 0.02085336670279503, 0.001849783700890839, -0.0193430557847023, -0.012227971106767654, -0.0018757637590169907, 0.022252827882766724, 0.006276794243603945, -0.04275979474186897, 0.02412339672446251, 0.0009422118891961873, -0.015976034104824066, 0.026617486029863358, 0.01838698796927929, -0.020243700593709946, 0.040736809372901917, -0.029956795275211334, 0.012844565324485302, -0.028737463057041168, -0.0039801523089408875, 0.05686526000499725, 0.01806829869747162, 0.018262283876538277, -0.008569971658289433, -0.021449176594614983, -0.004555178806185722, 0.008840165100991726, 0.005947712808847427, -0.02279321476817131, 0.0035229024942964315, 0.017278503626585007, -0.016294723376631737, -0.03627515956759453, 0.008244354277849197, 0.01148667186498642, 0.007891024462878704, -0.005074780900031328, -0.01082158088684082, -0.006546987220644951, 0.01270600501447916, 0.07066589593887329, -0.02837720513343811, 0.016641125082969666, -0.024164963513612747, -8.15667153801769e-05, -0.02640964463353157, -0.018109867349267006, -0.030594175681471825, 0.0016514688031747937, -0.01576819270849228, -0.019647888839244843, 0.016447139903903008, -0.002003932371735573, 0.0004405793151818216, 0.01255358848720789, -0.03491726517677307, 0.02261308580636978, 0.006443066522479057, -0.027781395241618156, -0.024054115638136864, -0.004409690387547016, 0.028335638344287872, -0.05049147456884384, -0.11267746239900589, -0.008673892356455326, 0.0315086729824543, 0.030594175681471825, 0.028515765443444252, -0.019440049305558205, 0.016696549952030182, -0.01740320771932602, 0.00910342950373888, -0.02376313880085945, -0.015075390227138996, 0.00557706318795681, -0.000869034614879638, -0.011535167694091797, -0.015491072088479996, -0.024566790089011192, 0.0019225279102101922, 0.005015892907977104, 0.003479602513834834, -0.003699567401781678, -0.01870567724108696, -0.005629023537039757, 0.010683020576834679, -0.008812452666461468, -0.03688482567667961, -0.0030206204392015934, 0.010960141196846962, -0.02298719994723797, 0.01723693497478962, 0.024234244599938393, -0.015560352243483067, -0.010308906435966492, 0.01287227775901556, 0.0001072220693458803, -0.04788653552532196, -0.007856384851038456, 0.0030327446293085814, 0.00151550630107522, 0.006716724019497633, 0.027144016698002815, 0.011452031321823597, -0.054371170699596405, 0.03394734114408493, 0.006010064855217934, 0.025190312415361404, -0.024816198274493217, 0.01008720975369215, -0.007336782291531563, 0.016017602756619453, 0.021033495664596558, 0.04458879306912422, 0.013149398379027843, -0.020756373181939125, 0.0055701350793242455, -0.011853856965899467, 0.014756700955331326, 0.03561006858944893, 0.03186893090605736, 0.004887724295258522, -0.006259473972022533, -0.013197895139455795, 0.03818729519844055, 0.030150780454277992, -0.02198956348001957, -0.05040833726525307, -0.011043277569115162, -0.011057133786380291, 0.025855403393507004, -0.04835763946175575, -0.025134887546300888, -0.0005880164098925889, -0.01353043969720602, -0.0036268229596316814, 0.017680330201983452, 0.020312979817390442, 0.014756700955331326, 0.005279157776385546, 0.034667856991291046, -0.02329203300178051, 0.040625959634780884, 0.020631669089198112, -0.03538836911320686, 0.0014921241672709584, 0.006346074398607016, -0.007558479439467192, -0.0019606321584433317, 0.009144998155534267, -0.012934629805386066, -0.020714806392788887, 0.00668208347633481, 0.001993540208786726, -0.022252827882766724, 0.001592580578289926, 0.007101229391992092, -0.012158690020442009, -0.058638833463191986, -0.06351616978645325, 0.024386661127209663, 0.035000402480363846, -0.009969433769583702, 0.028515765443444252, 0.029818234965205193, 0.013765992596745491, -0.017514057457447052, -0.009408262558281422, -0.0024698423221707344, -0.020146707072854042, 0.009699240326881409, 0.023873986676335335, -0.03275572136044502, -0.0018289996078237891, 0.025550570338964462, -0.0019052078714594245, 0.019481616094708443, -0.008847092278301716, 0.052265048027038574, 0.027795251458883286, 0.01604531519114971, -0.012636723928153515, -0.007988017052412033, 0.026326509192585945, 0.004620995372533798, -0.009415190666913986, 0.02002200298011303, -0.01625315472483635, -0.010710732080042362, -0.017333928495645523, 0.015712769702076912, -0.014978397637605667, 0.017458632588386536, 0.008500691503286362, 0.0064292107708752155, 0.057364076375961304, -0.003486530389636755, -0.009886297397315502, 0.01369671244174242, 0.035360660403966904, -0.006630123592913151, -0.04594668745994568, 0.012761428952217102, 0.014881405979394913, -0.00015772090409882367, 0.005002036690711975, 0.017985163256525993, -0.0325063094496727, 0.01722307875752449, 0.0009439439163543284, -0.025509001687169075, -0.02622951753437519, 0.03344852104783058, 0.017486345022916794, -0.04081994667649269, -0.0019398480653762817, -0.012983125634491444, 0.02147688902914524, 0.006536595057696104, 0.007877168245613575, 0.0015960446326062083, 0.00993479322642088, 0.01296234130859375, 0.04248267039656639, 0.038796961307525635, -0.007516911253333092, -0.05212648957967758, 0.02887602336704731, -0.001436699996702373, 0.015033822506666183, -0.000986378057859838, 0.005074780900031328, 0.004929292481392622, -0.03954518958926201, -0.028432630002498627, 0.0026465069968253374, 0.0005771914147771895, 0.04622380807995796, 0.0210057832300663, 0.0058403280563652515, 0.02428966946899891, -0.03427988663315773, 0.07720594853162766, 0.02035454846918583, 0.004873868077993393, -0.02298719994723797, -0.02049310877919197, 0.021255191415548325, -0.013849128969013691, -0.012692148797214031, -0.0016228907043114305, 0.012179474346339703, 0.041762158274650574, 0.02197570726275444, 0.04045968875288963, 0.004084073007106781, 0.030760446563363075, 0.0030448685865849257, -0.016322435811161995, 0.009193493984639645, 0.013218678534030914, 0.0016358807915821671, -0.06750670820474625, -0.03721737116575241, 0.04658406600356102, -0.01401540171355009, -0.019814161583781242, -0.02577226608991623, 0.014687420800328255, -0.003444962203502655, -0.022349821403622627, 0.0012158690951764584, 0.04045968875288963, -0.005067852791398764, 0.00668208347633481, -0.015033822506666183, 0.00570176774635911, -0.01903822273015976, -0.02345830574631691, 0.00821664184331894, 0.0053865425288677216, -0.014271738938987255, -0.019440049305558205, -0.008278993889689445, -0.03294970467686653, 0.026963887736201286, 0.017749609425663948, -0.015504928305745125, -0.03170266002416611, 0.011964705772697926, -0.008209713734686375, 0.006172873545438051, 0.015560352243483067, -0.0024906264152377844, 0.003758455626666546, -0.008258210495114326, -0.016613412648439407, -0.0038277357816696167, 0.004284985829144716, 0.008168146014213562, 0.027795251458883286, -0.027628978714346886, 0.022391388192772865, 0.05079630762338638, 0.017985163256525993, -0.033199112862348557, -0.00520294951274991, 0.02610481157898903, -0.012574371881783009, 0.028903735801577568, 0.032700296491384506, -0.01590675301849842, -0.008944084867835045, -0.026160236448049545, 0.030926719307899475, 0.01065530814230442, -0.010392042808234692, -0.0032336574513465166, 0.01720922254025936, -0.00811964925378561, 0.02772597037255764, 0.013003909960389137, -0.0011266706278547645, 0.0024698423221707344, -0.0067686839029192924, -0.005888824351131916, -0.01986958645284176, 0.013669000938534737, -0.03860297426581383, -0.022280540317296982, 0.027518130838871002, 0.02591082826256752, 0.011327327229082584, 0.007239790167659521, 0.010142633691430092, -0.0065850913524627686, 0.028155509382486343, -0.004693739581853151, -0.00036328850546851754, 0.005206413567066193, -0.02460835874080658, 0.023583009839057922, 0.011521311476826668, -0.008001873269677162, 0.014673564583063126, -0.04949383810162544, -0.005525102838873863, -0.0011050206376239657, -0.013578936457633972, 0.014167819172143936, 0.0027608193922787905, 0.00803651288151741, 0.030899008736014366, 0.052569881081581116, 0.011167982593178749, -0.00684835622087121, 0.023222751915454865, 0.006359930150210857, -0.02904229611158371, 0.01654413342475891, 0.006786004174500704, -0.018414700403809547, -0.03067731112241745, 0.011077918112277985, 0.015144670382142067, -0.0018341955728828907, -0.010870076715946198, 0.021892569959163666, 0.010288123041391373, 0.017514057457447052, -0.04555871710181236, -0.022904062643647194, -0.003831199835985899, -0.013197895139455795, 0.015200095251202583, 0.004776875954121351, -0.009318199008703232, 0.005334582179784775, 0.03425217419862747, -0.007641615811735392, 0.003438034327700734, -0.005358830094337463, -0.004963932558894157, -0.0017077591037377715, -0.001092030550353229, -0.010080281645059586, 0.03754991665482521, -0.033891916275024414, -0.057364076375961304, 0.005899216514080763, -0.01604531519114971, -0.04023798927664757, 0.011098702438175678, 0.006730579771101475, 0.021075062453746796, -0.0005429842276498675, -0.02542586624622345, -0.04489362612366676, -0.007835600525140762, -0.051267411559820175, 0.008978725410997868, -0.0013284494634717703, 0.0017042950494214892, 0.013772920705378056, 0.01819300279021263, 0.009193493984639645, -0.025841547176241875, -0.01621158793568611, 0.02052082121372223, 0.012532804161310196, 0.006553915329277515, 0.016973670572042465, -0.011105629615485668, 0.07460100948810577, -0.019883442670106888, -0.028141653165221214, -0.00868774764239788, -0.0018532476387917995, 0.02559213899075985, 0.010558315552771091, 0.008563043549656868, -0.02937484160065651, 0.015491072088479996, 0.004835763946175575, 0.015795905143022537, -0.03741135448217392, 0.014313307590782642, 0.00796723272651434, 0.020423829555511475, -0.02261308580636978, 0.011161054484546185, 0.008666964247822762, 0.01090471725910902, 0.01637786068022251, 0.013655144721269608, -0.03181350603699684, -0.01887194998562336, 0.01336416695266962, 0.0054869987070560455, 0.019065935164690018, -0.0014765361556783319, -0.012740644626319408, 0.007440702989697456, -0.0033791461028158665, -0.04090308025479317, -0.03594261407852173, 0.0037099593318998814, -0.035000402480363846, 0.001796091441065073, -0.012269538827240467, 0.03153638541698456, -0.006242153700441122, 0.016336292028427124, -0.006384178530424833, -0.008403698913753033, 0.00394204817712307, -0.0019900761544704437, 0.01888580620288849, 0.008999509736895561, 0.0014566180761903524, 0.011590591631829739, 0.026284940540790558, 0.009061861783266068, -0.012449667789041996, -0.006928028538823128, 0.03760534152388573, -0.009394407272338867, -0.001880959840491414, -4.154110865783878e-05, -0.01205477025359869, 0.019426193088293076, 0.017333928495645523, 0.014881405979394913, -0.04406226426362991, -0.004582890775054693, -0.012671364471316338, -0.0002855646889656782, 0.004215705674141645, -0.04932756349444389, 0.019135214388370514, 0.04037655144929886, -0.02327817678451538, 0.055341094732284546, -0.013994618318974972, -0.02607710100710392, -0.015837473794817924, -0.005362294148653746, 0.01658570021390915, 0.0009742540423758328, -0.030926719307899475, 0.00852147489786148, 0.003185161156579852, 0.041595883667469025, 0.015283231623470783, 0.00868774764239788, -0.03572091460227966, -0.0272548645734787, -0.028016947209835052, 0.0073575666174292564, 0.04165130853652954, -0.0017623172607272863, -0.02524573728442192, 0.01622544415295124, -0.019897298887372017, 0.016488708555698395, 0.04902273043990135, 0.003025816520676017, -0.003820807905867696, -0.020590100437402725, 0.01903822273015976, 0.01639171503484249, -0.00868774764239788, 0.015560352243483067, -0.015366367995738983, 0.005438502412289381, 0.03292199224233627, -0.009713096544146538, -0.017791178077459335, 0.0031713051721453667, -0.015588064678013325, -0.00610359339043498, -0.00599274504929781, 0.002618794795125723, 0.009574535302817822, -0.006204049568623304, 0.010994781740009785, 0.027961524203419685, -0.029956795275211334, 0.01213790662586689, -0.0024300061631947756, 0.015047678723931313, 0.023527584969997406, -0.008327490650117397, 0.00967152789235115, -0.011957777664065361, -0.009456759318709373, 0.00109636050183326, -0.02541201002895832, 0.0066266595385968685, -0.003029280574992299, -0.007406062912195921, 0.017167655751109123, 0.003027548547834158, -0.03300512954592705, 0.0035991109907627106, 0.007703967858105898, 0.010814652778208256, 0.012505091726779938, 0.02690846286714077, 0.021407607942819595, -0.033032841980457306, -0.0059788888320326805, -0.012657508254051208, -0.011867713183164597, 0.01371056865900755, -0.02528730407357216, -0.008895589038729668, -0.0017822353402152658, -0.015629632398486137, 0.013184038922190666, -0.0029981043189764023, 0.033060554414987564, 0.018470125272870064, -0.01921835169196129, 0.03547150641679764, -0.003328917780891061, 0.010274266824126244, 0.006152089685201645, -0.029984507709741592, 0.021892569959163666, 0.003664927091449499, 0.026534350588917732, 3.485664274194278e-05, 0.01920449547469616, -0.024691494181752205, -0.001634148764424026, 0.02622951753437519, 0.033032841980457306, 0.018442412838339806, -0.022599229589104652, 0.013814489357173443, -0.00626986613497138, -0.011881569400429726, 0.013689784333109856, -0.020091284066438675, 0.003561006858944893, -0.029070008546113968, 0.018802670761942863, 0.007904880680143833, -0.002287981566041708, 0.008182002231478691, 0.002894184086471796, 0.01245659589767456, -0.0068656764924526215, -0.01970331370830536, 0.03430759906768799, 0.03245088830590248, -0.007000773213803768, 0.0008084143628366292, 0.015380223281681538, 0.01937076821923256, -0.0011924869613721967, -0.015879042446613312, -0.013371095061302185, -0.007780176121741533, 0.029596539214253426, 0.002809315687045455, 0.02491319179534912, 0.0012132710544392467, -0.007433774881064892, 0.008091937750577927, 0.02376313880085945, 0.03594261407852173, 0.014257882721722126, -4.2515363020356745e-05, 0.004080608952790499, 0.03475099056959152, -0.02081179805099964, 0.013468087650835514, -0.0005577062838710845, 0.0007807022193446755, -0.0020662846509367228, 0.00442701019346714, 0.03081587143242359, 0.005424646660685539, 0.010315834544599056, 0.014867549762129784, 0.0033150617964565754, 0.004794195760041475, 0.00851454772055149, 0.004908508155494928, 0.008874804712831974, -0.009969433769583702, 0.0038900880608707666, -0.021934138610959053, 0.01820685900747776, 0.011195694096386433, -0.01303855050355196, 0.01033661887049675, 0.025024039670825005, 0.024552933871746063, 0.004524002783000469, -0.0068241083063185215, 0.022280540317296982, -0.03608117252588272, 0.005940784700214863, 0.00022624344273936003, -0.003081240691244602, 0.003914336208254099, -0.015366367995738983, 0.007752464152872562, 0.009893224574625492, 0.010232698172330856, -0.03522209823131561, 0.010773085057735443, -0.003897016169503331, -0.006023921072483063, 0.008258210495114326, 0.0737142264842987, 0.016613412648439407, 0.010031785815954208, -0.03100985661149025, 0.01238731574267149, 0.02362457849085331, 0.03003993257880211, -0.015782048925757408, -0.045835837721824646, 0.014618140645325184, 0.012678292579948902, 0.014382587745785713, -0.023389024659991264, -0.010274266824126244, 0.03234003856778145, -0.006578163243830204, 0.01100170984864235, -0.01691824570298195, -0.01686282269656658, -0.030123068019747734, 0.01048903539776802, -0.027324145659804344, -0.0196756012737751, -0.024719206616282463, -0.006100129336118698, 0.025522857904434204, 0.026811471208930016, -0.006671691779047251, -0.012851493433117867, -0.0033878060057759285, 0.007731679826974869, -0.014147034846246243, 0.001912135980091989, 0.017098374664783478, -0.007600047625601292, 0.0436742939054966, -0.015366367995738983, -0.0007776712300255895, 0.012588228099048138, 0.02363843470811844, -0.00434387382119894, -0.01075230073183775, -0.016336292028427124, 0.0010002341587096453, 0.011375823058187962, -0.007752464152872562, 0.004610603209584951, 0.036496855318546295, -0.026963887736201286, 0.006831036414951086, 0.01073844451457262, 0.01623929850757122, -0.026368077844381332, -0.005798759870231152, 0.019287632778286934, -0.019315343350172043, -0.021740153431892395, 0.023666145280003548, 0.005843792110681534, 0.045392442494630814, 0.0019138678908348083, -0.02854347787797451, 0.034529294818639755, -0.0043715862557291985, 0.020950358361005783, 0.013578936457633972, 0.002329549752175808, 0.0076693277806043625, 0.028086228296160698, 0.02132447250187397, 0.00614516157656908, -0.010973997414112091, 0.011057133786380291, -0.030233917757868767, 0.014881405979394913, -0.028432630002498627, -0.008396770805120468, -0.002577226608991623, -0.0051198131404817104, 0.029762811958789825, 0.0017623172607272863, -0.0068795327097177505, -0.023860130459070206, 0.03131468966603279, -0.01256051566451788, 0.028765175491571426, 0.010031785815954208, 0.02446979656815529, 0.03084358386695385, 0.0028907200321555138, 0.016294723376631737, 0.0004459918418433517, 0.019578609615564346, -0.010620667599141598, -0.004939684644341469, 0.002423078054562211, 0.006934956647455692, 0.008313634432852268, -0.0010747105116024613, -0.03694025054574013, 0.0027123233303427696, 0.007496126927435398, 0.021075062453746796, -0.014895262196660042, 0.00788409635424614, 0.02495475858449936, 0.03164723515510559, -0.0067271157167851925, -0.0270885918289423, 0.0015735285123810172, -0.0022187011782079935, 0.0049223643727600574, -0.00622829794883728, -0.006820644252002239, -0.001742399181239307, -0.04542015492916107, -0.0400162935256958, 0.02722715213894844, 0.015948321670293808, -0.008542259223759174, 0.03114841692149639, -0.03427988663315773, -0.006661299616098404, 0.0191767830401659, -0.007752464152872562, 0.030705023556947708, 0.02672833390533924, 0.028792887926101685, 0.0004901580396108329, -0.03292199224233627, -0.0007975893095135689, -0.030705023556947708, -0.013308743014931679, 0.046833474189043045, 0.011091774329543114, -0.010315834544599056, -0.03245088830590248, -0.0205069649964571, -0.023846274241805077, -0.0001812112459447235, 0.014992253854870796, -0.013488871976733208, 0.01050289161503315, 0.008812452666461468]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" maximizes the uncertainty relative the main agent π1
t. We additionally
impose a constraint:
eπ∈Πt={π′∈Π :η·Ex∼d0DKL(π′(·|x), π1
t(·|x))| {z }
How far does the enhancer go.≤ Γm
t(λ, π1
t, π′)|{z}
How much information we can get.},
where this set is never empty because π1
talways belongs to it so the choice is well-defined. Intuitively, we
require that the information we can get is worth the cost we pay by moving away from π1
t.
Essentially, we are trying to boost our dataset by strategically choose the behavior policies at each iteration.
If we learn from scratch or the offline dataset is not good enough, we need to explicitly incorporate the
uncertainty into algorithmic design, and explore the direction where we are uncertain about so that we can
gain more information. On the other hand, if Doffis already good enough, our analysis shows that it is also
beneficial to collect more online data, as we now discuss in the next subsection.
4.3 Main Results: RLHF Benefits from Online Exploration
We first consider the case of Option I: π2
t=πref. In this case, it is essential to have a diverse Doffas we do
not explicitly explore. This is most related to the study of hybrid RL in the classic RL theory (Song et al.,
2022; Zhou et al., 2023). The major difference here is that for preference-based learning, the uncertainty
3We remark that we impose an additional KL regularization on π2
tis so that it also converges to π∗.
14
is evaluated on the feature difference instead of a single state-action pair, as we summaize in the following
assumption.
Assumption 2 (Partial Coverage of Offline Data) .For the linear model, there exists a reference policy πref,
a ratio coefficient α(mT,Doff)∈(0,1)and a coverage constant Ccov>0such that
(mT)1−α(mT,Doff)∥Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)]∥(Σoff)−1≤Ccov.
We remark that Assumption 2 implicitly assume that noffis comparable to the total number of online
samples mTso that the influence of Doffwill not be dominated by the online data. To provide a more
detailed understanding and connection to existing literature, we offer a more nuanced characterization of
α(mT,Doff) under standard partial coverage conditions in Appendix D.1. In particular, when mT≈noff, we
show that α(mT,Doff)≈1/2. It is worth emphasizing that this scenario appears to be realistic for LLMs.
For example, in the LLaMA2 project (Touvron et al., 2023), we observe noff= 1500 KandmT= 1400 K.
We are ready to present the results.
Theorem 2. For any ϵ > 0, under Assumption 1 with T= min {n∈N+:n≥dlog(n)}andβ=
O q
dlog(T/δ)
γ2
, with probability at least 1−3δ, there exists a t0∈[T]such that Algorithm 2 with Option I
holds
J(π∗)−J(πt0)≲s
d
γ2m+β· ∥Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)]∥Σ−1
off+D1:t0−ηExt0∼d0
DKL(π1
t0(·|xt0)∥π∗(·|xt0))
,
where Σoff+D1:t0denotes the covariance matrix computed on Doff∪D1:t0. If we further assume that Assump-
tion 2 holds, we have
J(π∗)−J(πt0)≲s
d2
γ2m+β(mT)α(mT,Doff)−1Ccov−ηExt0∼d0
DKL(π∗(·|xt0)∥πt0(·|xt0))
.
The proof is deferred to Appendix D.3. Note that the second result is a conservative bound where we
completely","[-0.003969662357121706, -0.041193921118974686, 0.03581826016306877, 0.017646189779043198, 0.0104372538626194, 0.021283525973558426, -0.003202754305675626, 0.03260454908013344, -0.0371621735394001, 0.07344788312911987, 0.042771559208631516, -0.03391924872994423, -0.02306567318737507, 0.0033616137225180864, 0.01346106268465519, -0.017354033887386322, 0.0015885953325778246, -0.037337467074394226, 0.0017401509685441852, 0.05790521204471588, -0.02835368737578392, -0.0523250438272953, 0.0383307971060276, 0.02535909414291382, -0.008100010454654694, -0.013680179603397846, 0.03429905325174332, 0.027667121961712837, 0.023562338203191757, -0.010546811856329441, 0.04262548312544823, -0.03967471048235893, -0.03967471048235893, -0.02931780181825161, -0.010203530080616474, 0.05732090398669243, 0.020100295543670654, 0.02582654356956482, -0.021166663616895676, 0.008414077572524548, 0.012811017222702503, -0.022159991785883904, -0.07654473185539246, 0.03181573003530502, 0.005251494701951742, 0.008706232532858849, 0.013519493862986565, -0.025023115798830986, 0.03292592242360115, 0.027316536754369736, -0.03561375290155411, -0.004013485740870237, -0.036607079207897186, -0.01189072709530592, -0.0073477099649608135, -0.0017657146090641618, 0.025622034445405006, -0.0036409874446690083, 0.047358401119709015, -0.01273067481815815, 0.010802448727190495, -0.0022806385532021523, 0.014023462310433388, 0.003045720746740699, -0.025534387677907944, 0.006602713372558355, -0.05442856252193451, 0.048205651342868805, -0.0009759818785823882, 0.05176994949579239, -0.008720840327441692, -0.01823050156235695, 0.0468033067882061, -0.0011275374563410878, -0.024438804015517235, 0.03128984943032265, 0.046628013253211975, 0.035175517201423645, 0.024468019604682922, -0.03207866847515106, 0.02426351234316826, -0.0072162398137152195, 0.0215756818652153, -0.030851617455482483, -0.001995787024497986, -0.0719871073961258, -0.0362272784113884, -0.018128246068954468, -0.0625796988606453, -0.019632847979664803, 0.015557278878986835, 0.0006546108634211123, -0.030705539509654045, 0.010291175916790962, 0.033597879111766815, 0.01979353278875351, 0.01907775178551674, -0.01561571005731821, 0.02483321540057659, -0.005441395565867424, 0.015966296195983887, -0.06982515752315521, 0.005306273698806763, -0.014695419929921627, 0.057613056153059006, -0.028791921213269234, -0.017587758600711823, 0.06024245545268059, 0.015761787071824074, -0.0181136392056942, -0.050484463572502136, -0.03219553083181381, -0.031085342168807983, 0.039645496755838394, -0.014315618202090263, -0.0550420880317688, -0.07753805816173553, 0.014987575821578503, -0.02037784457206726, -0.0004875344457104802, -0.042654696851968765, -0.011992981657385826, 0.008297215215861797, 0.026089483872056007, 0.03473728522658348, 0.0008910741889849305, 0.021283525973558426, -0.06637772172689438, -0.03307199850678444, -0.009261328727006912, 0.02230606973171234, 0.04741683229804039, -0.004860736429691315, -0.021561073139309883, -0.05524659901857376, 0.03757119178771973, -0.007278323173522949, 0.014249882660806179, 0.0037067225202918053, -0.013855473138391972, -0.028777312487363815, -0.04957878217101097, -0.05612306669354439, 0.0024303682148456573, -0.03561375290155411, 0.03803864121437073, -0.007117637433111668, 0.01918000541627407, 0.027959277853369713, 0.02085990086197853, 0.0005934407818131149, -0.03464963659644127, -0.02776937745511532, 0.013249250128865242, -0.0015219473280012608, -0.04411547631025314, -0.03064710833132267, 0.053522881120443344, 0.018610302358865738, 0.010605243034660816, -0.02556360326707363, 0.07788864523172379, -0.01489262469112873, -0.0036866366863250732, 0.033627092838287354, 0.03704531490802765, -0.019267652183771133, 0.013541406020522118, -0.060008734464645386, -0.01579100266098976, 0.003080414142459631, 0.0015338162193074822, -0.03441591560840607, -0.012774498201906681, 0.007910109125077724, -0.029011037200689316, -0.02508154697716236, -0.02570968121290207, 0.023985963314771652, -0.040142159909009933, 0.03137749806046486, 0.01941373012959957, 0.03272141143679619, -0.014395960606634617, -0.03272141143679619, 0.02692212536931038, -0.012087932787835598, -0.03169886767864227, -0.008194960653781891, -0.0033743956591933966, 0.02315331995487213, 0.03158200532197952, 0.030092012137174606, -0.027725553140044212, 0.003708548378199339, -0.005452351178973913, 0.04992936924099922, 0.07514238357543945, -0.007380577269941568, 0.03850609064102173, 0.029054861515760422, -0.009852943010628223, -0.0017310210969299078, -0.06053461134433746, 0.022130776196718216, 0.01846422627568245, 0.012591900303959846, 0.03780491650104523, -0.05813893675804138, 0.009611914865672588, 0.004645271692425013, 0.001852448214776814, 0.0019757014233618975, 0.004316596779972315, -0.017164133489131927, -0.0006413725204765797, -0.020246373489499092, 0.031903378665447235, 0.02278812602162361, 0.04256705194711685, -0.00181045092176646, 0.0371621735394001, 0.012832928448915482, -0.0003544667561072856, -0.014702723361551762, -0.0004496455076150596, 0.029025645926594734, -0.04093097895383835, 0.030208874493837357, -0.025139978155493736, 0.04201195761561394, 0.03237082436680794, -0.011949158273637295, -0.05077661946415901, 0.02366459183394909, -0.026279384270310402, -0.01701805554330349, -0.03307199850678444, 0.04066804051399231, -0.03616884723305702, 0.0031644089613109827, 0.00923941656947136, -0.022978028282523155, -0.015002183616161346, -0.009831031784415245, 0.023021850734949112, -0.01630227454006672, -0.018040599301457405, -0.0294638779014349, -0.01073671318590641, 0.010678282007575035, -0.026250168681144714, -0.002138212788850069, -0.025300662964582443, -0.037834133952856064, 0.002934336429461837, 0.01821589283645153, 0.015834826976060867, -0.03800942748785019, 0.03724982216954231, -0.02956613339483738, 0.00107093236874789, -0.006679404526948929, 0.0015822044806554914, -0.023372437804937363, -0.015294338576495647, 0.014658900909125805, -0.0013786086346954107, 0.021298132836818695, -0.011437886394560337, 0.025169193744659424, 0.0012078802101314068, -0.06696203351020813, 0.031202204525470734, -0.06906554847955704, -0.04464135691523552, 0.017164133489131927, 0.0564444363117218, -0.04978329315781593, -0.014118412509560585, -0.030822401866316795, 0.007574130315333605, 0.05273406207561493, -0.02483321540057659, 0.04505037143826485, -0.036723941564559937, 0.022393716499209404, -0.020816076546907425, -0.04624820873141289, -0.03631492331624031, 0.028061533346772194, -0.03295513615012169, 0.05808050557971001, -0.03476649895310402, -0.000505794130731374, 0.00403904914855957, 0.03611041605472565, -0.06053461134433746, 0.014447087422013283, 0.03497100993990898, 0.04505037143826485, 0.00648950319737196, -0.002782780909910798, 0.03873981535434723, -0.005138284061104059, 0.016024727374315262, 0.018508048728108406, 0.011379455216228962, -0.0366947278380394, 0.025665856897830963, 0.0070336428470909595, 0.04002529755234718, 0.010408038273453712, 0.03026730567216873, -0.0013713047374039888, -0.030734755098819733, 0.03996686637401581, -0.017091095447540283, -9.97437018668279e-05, -0.028178393840789795, -0.03876902908086777, -0.048906825482845306, -0.03429905325174332, -0.012416607700288296, 0.033597879111766815, -0.0235185157507658, -0.0006806309102103114, 0.013534101657569408, -0.0458684079349041, -0.014563949778676033, -0.0011348413536325097, 0.015323554165661335, 0.03979157283902168, -0.031172988936305046, 0.004962990991771221, -0.026367031037807465, -0.07251298427581787, 0.04969564452767372, 0.03254611790180206, 0.007588738109916449, -0.041427645832300186, 0.01603933423757553, -0.021400388330221176, 0.017178742215037346, -0.005996490828692913, -0.004093828611075878, 0.04992936924099922, 0.006383596919476986, 0.028791921213269234, 0.0509226992726326, 0.004616056568920612, -0.03219553083181381, 0.026498500257730484, 0.023430868983268738, -0.017646189779043198, 0.011949158273637295, 0.005240538623183966, -0.047358401119709015, -0.019749710336327553, -0.028295256197452545, -0.014016158878803253, 0.03260454908013344, 0.018435010686516762, 0.0090568196028471, -0.025154585018754005, 0.04207038879394531, -0.000875553407240659, 0.013556013815104961, -0.008472508750855923, -0.020363235846161842, 0.0037797612603753805, 0.02991672046482563, -0.03990843519568443, 0.008253391832113266, -0.04659879580140114, -0.012285137549042702, 0.024044394493103027, 0.0159370806068182, 0.06450792402029037, 0.007654473185539246, -0.027462614700198174, 0.0017949301982298493, -0.03438669815659523, -0.06082676723599434, 0.019106967374682426, 0.007888197898864746, -0.03780491650104523, -0.04078490287065506, -0.047475263476371765, -0.03628570958971977, 0.05188681185245514, -0.03248768672347069, 0.0017045445274561644, 0.007000775542110205, -0.04537174478173256, -0.023576946929097176, -0.006664796732366085, 0.06298872083425522, 0.053610529750585556, 0.02857280522584915, -0.0378633476793766, -0.043501947075128555, -0.06018402427434921, -0.014702723361551762, -0.033364154398441315, 0.000523140886798501, 0.005434091668576002, 0.018420401960611343, 0.011167642660439014, 0.05220818147063255, 0.013804345391690731, -0.027681730687618256, 0.033860817551612854, -0.05112720653414726, -0.016258452087640762, -0.00012291071470826864, 0.008231480605900288, -0.0039002755656838417, 0.05825579911470413, 0.06240440905094147, 0.01663825288414955, -0.047095462679862976, 0.02015872672200203, -0.02652771584689617, -0.024292726069688797, 0.03485414758324623, 0.03657786548137665, 0.00491916760802269, -0.0034930838737636805, -0.05320151150226593, 0.004616056568920612, 0.06748791038990021, 0.02594340592622757, 0.0003225122345611453, -0.08291371911764145, 0.028981821611523628, 0.012234009802341461, -0.018727164715528488, -0.014249882660806179, -0.020363235846161842, 0.033743955194950104, -0.003819932695478201, -0.03643178567290306, 0.017076486721634865, -0.03789256513118744, 0.02205773815512657, -0.03307199850678444, -0.0470370315015316, 0.01944294571876526, 0.02364998497068882, -0.05694109946489334, -0.004630664363503456, 0.049754075706005096, 0.013103172183036804, 0.0037377639673650265, -0.0424501895904541, 0.059307560324668884, -0.015834826976060867, 0.0359935536980629, 0.016258452087640762, -0.008187657222151756, -0.016083158552646637, -0.01381164975464344, -0.017061879858374596, 0.03447434678673744, 0.04394018277525902, 0.003944098949432373, 0.007128593511879444, -0.022525185719132423, 0.00965573824942112, 0.022758910432457924, -0.05837266147136688, 0.03768805414438248, -0.029113292694091797, -0.017514720559120178, 0.021035194396972656, 0.032633766531944275, -0.02099137008190155, 0.05214975029230118, -0.005437743384391069, -0.004152259789407253, -0.008275303989648819, 0.015484239906072617, 0.021268917247653008, 0.035175517201423645, 0.04984172433614731, 0.04440763220191002, -0.00887422263622284, -0.0016853718552738428, -0.016433745622634888, 0.00964843388646841, -0.046511150896549225, 0.04399861395359039, -0.018435010686516762, -0.0006349816685542464, -0.025665856897830963, 0.01799677684903145, -0.0013037438038736582, 0.011817689053714275, -0.010678282007575035, 0.06818908452987671, -0.03128984943032265, -0.025037722662091255, 0.010342303663492203, -0.021634113043546677, 0.016126981005072594, 0.01833275519311428, -0.0470370315015316, -0.011321024037897587, 0.029011037200689316, -0.023723023012280464, -0.006708620116114616, 0.0014425176195800304, 0.012650331482291222, -0.021049801260232925, -0.014162235893309116, -0.02737496793270111, -0.010181617923080921, -0.01904853619635105, 0.0016168978763744235, -0.00960461050271988, -0.02630859985947609, -0.040989410132169724, 0.03412375971674919, 0.013906599953770638, 0.03535081073641777, -0.015338161960244179, -0.0733894556760788, -0.03380238637328148, -0.037337467074394226, 0.026995165273547173, -0.01140867080539465, 0.013979638926684856, 0.013015526346862316, -0.0035387331154197454, -0.002026828471571207, -0.02316792868077755, -0.0004288750933483243, 0.0018734469776973128, -0.0015602927887812257, 0.034445129334926605, 0.0031479750759899616, -0.0061900438740849495, 0.036022767424583435, 0.01605394296348095, -0.05702874809503555, 0.03222474828362465, -0.02270047925412655, -0.008253391832113266, 0.028762705624103546, 0.002574620069935918, -0.01538198534399271, -0.029653780162334442, -0.0232847910374403, -0.030851617455482483, 0.011949158273637295, -0.007888197898864746, -0.009151769801974297, -0.011379455216228962, -0.0021710803266614676, -0.013840865343809128, 0.012263225391507149, 0.0002759499766398221, 0.01991039514541626, -0.024029787629842758, 0.01844961754977703, -0.0020688259974122047, -0.007742119953036308, -0.01145249418914318, 0.05065975710749626, -0.04922819510102272, 0.04852702468633652, 0.024555666372179985, 0.0048753442242741585, 0.034561991691589355, -0.010824359953403473, 0.04055117815732956, 0.007365969475358725, 0.032400041818618774, 0.005068897269666195, -0.015206691808998585, -0.019136182963848114, -0.019866570830345154, -0.00636168522760272, -0.02508154697716236, -0.004112088121473789, 0.02943466231226921, 0.014352137222886086, -0.05995030328631401, -0.008026971481740475, -0.002769998973235488, -0.031172988936305046, -0.010451861657202244, -0.018376579508185387, -0.030121227726340294, 0.017514720559120178, 0.008487116545438766, 0.013285770080983639, -0.0010855401633307338, -0.024789391085505486, 0.03777570277452469, -0.007997755892574787, 0.013088565319776535, -0.023927532136440277, -0.05694109946489334, 0.05071818828582764, -0.020582351833581924, -0.011138427071273327, 0.026104090735316277, -0.007406141143292189, 0.003998877946287394, -0.004174171015620232, 0.03006279654800892, -0.006887564901262522, -0.0364610031247139, -0.019705886021256447, -0.01044455822557211, -0.0019665714353322983, 0.05548032373189926, -0.03751276060938835, -0.017061879858374596, -0.010524900630116463, 0.022130776196718216, -0.010481077246367931, 0.012884056195616722, 0.0117592578753829, -0.00751569913700223, -0.02535909414291382, 0.033977679908275604, -0.010532204993069172, -0.02833908051252365, -0.024526450783014297, 0.01025465689599514, -0.008932653814554214, -0.00048388249706476927, -0.016200020909309387, -0.004743874538689852, 0.003911231178790331, -0.017310211434960365, -0.04250862076878548, 0.03873981535434723, 0.01489262469112873, 0.003511343616992235, -0.03558453544974327, 0.007669080980122089, 0.015717964619398117, -0.013862776570022106, 0.021312741562724113, -0.03184494748711586, -0.03982079029083252, -0.03859373554587364, -0.01091931015253067, 0.017091095447540283, 0.009670346044003963, 0.04347273334860802, -0.006073181517422199, 0.00976529624313116, -0.008129226043820381, 0.008005059324204922, -0.03757119178771973, -0.0032392737921327353, -0.011583964340388775, 0.00019069990958087146, -0.004681791178882122, 0.007417096756398678, 0.030968479812145233, 0.0020669999066740274, 0.05384425073862076, 0.01723717339336872, -0.004553973209112883, -0.014264490455389023, 0.002936162520200014, 0.025388309732079506, 0.001405998133122921, -0.01831814832985401, -0.04209960252046585, -0.027097418904304504, -0.05945363640785217, -0.023328613489866257, 0.02519840933382511, -0.030004367232322693, 0.007917413488030434, -0.036022767424583435, -0.013519493862986565, -0.019033929333090782, -0.010210833512246609, 0.010714801959693432, -0.021765582263469696, -0.02245214767754078, 0.0028759054839611053, -0.0249939002096653, 0.0030146792996674776, 0.06935770809650421, -0.01085357554256916, -0.008362949825823307, 0.0126138124614954, -0.0017383249942213297, 0.02327018231153488, -0.038067858666181564, -0.06842280924320221, 0.012394695542752743, 0.038915108889341354, -0.02218920737504959, 0.0039039275143295527, -0.046277426183223724, -0.03237082436680794, -0.00856745894998312, 0.03955785185098648, 0.04320979490876198, -0.05863560363650322, 0.017894523218274117, -0.012109844014048576, -0.020056473091244698, 0.017558543011546135, 0.002194817876443267, -0.0006902173045091331, 0.014921840280294418, 0.0006048530922271311, 0.01723717339336872, -0.023606162518262863, -0.006898520980030298, -0.010174314491450787, -0.04767977073788643, 0.0005085330922156572, -0.006887564901262522, 0.01265763584524393, -0.07712904363870621, 0.03520473465323448, -0.0189316738396883, -0.016360705718398094, 0.008932653814554214, 0.012825625017285347, -0.00910064298659563, -0.01881481148302555, -0.01627305895090103, 0.016930408775806427, 0.020363235846161842, 0.012694154866039753, -0.01339532807469368, -0.0074864840134978294, 0.01896088942885399, -0.025037722662091255, -0.043385088443756104, 0.027959277853369713, 0.006317861843854189, -0.01881481148302555, 0.0159370806068182, 0.014673508703708649, -0.02451184391975403, 0.04461213946342468, -0.011415975168347359, 0.014059982262551785, -0.03535081073641777, 0.0038491482846438885, 0.02594340592622757, 0.00260931346565485, 0.030617892742156982, -0.0024577579461038113, -0.007815158925950527, 0.001856100163422525, 0.011284505017101765, 0.007398837246000767, -0.02123970165848732, 0.009940589778125286, 0.010773233138024807, 0.0050068143755197525, -0.03400689736008644, -0.0032392737921327353, 0.028996430337429047, -0.025665856897830963, -0.009064123034477234, 0.0043786801397800446, -0.01104347687214613, -0.006511414889246225, 0.05381503701210022, -0.003436478553339839, 0.004816913045942783, -0.015586494468152523, 0.005799286067485809, -0.03193259239196777, 0.0022167295683175325, -0.024453412741422653, 0.008779271505773067, -0.0016935886815190315, -0.010568724013864994, 0.021327348425984383, 0.013570621609687805, -0.01430101040750742, 0.008304519578814507, -0.022145384922623634, 0.006803570315241814, -0.01932608336210251, -0.01441056840121746, -0.013117779977619648, 0.006219259463250637, 0.03330572322010994, -0.037103742361068726, -0.12714606523513794, -0.01332959346473217, 0.018245108425617218, 0.02991672046482563, 0.01115303486585617, -0.020772254094481468, 0.03701609745621681, 0.002061522100120783, 0.00016399507876485586, -0.034211404621601105, -0.009706865064799786, -0.006456635892391205, -0.0017611496150493622, 0.001992135075852275, -0.04005451500415802, -0.030734755098819733, -0.014286402612924576, 0.019369907677173615, 0.023547731339931488, -0.00789550133049488, -0.022393716499209404, -0.0022167295683175325, -0.002196643967181444, 0.012343568727374077, -0.013548709452152252, -0.004221646580845118, 0.022262247279286385, -0.025388309732079506, 0.004119392018765211, 0.011299112811684608, 0.012204794213175774, -0.009714169427752495, 0.018610302358865738, 0.007092074025422335, -0.046394288539886475, -0.02413204126060009, -0.000990589614957571, -0.01919461414217949, -0.010327695868909359, 0.03751276060938835, 0.004185127094388008, -0.0408141203224659, 0.03453277423977852, 0.006935040466487408, 0.014739243313670158, -0.03748354688286781, 0.012409303337335587, -0.009429317899048328, 0.009787208400666714, -0.009984413161873817, 0.024891646578907967, -0.006350729614496231, -0.01944294571876526, -0.011788473464548588, -0.005324533209204674, 0.009254024364054203, 0.010378822684288025, 0.04522566497325897, 0.017879914492368698, -0.012949790805578232, -0.01954520121216774, 0.033627092838287354, 0.021911660209298134, -0.02137117274105549, -0.03736668452620506, 0.0013055697781965137, 0.00021409518376458436, 0.026703009381890297, -0.029639171436429024, -0.04411547631025314, 0.007683688774704933, -0.0364610031247139, -0.009728777222335339, 0.02473095990717411, -0.00976529624313116, 0.012482342310249805, 0.019340692088007927, 0.013059349730610847, -0.03657786548137665, 0.035905905067920685, 0.03911961615085602, -0.04063882678747177, 0.016959624364972115, 0.002256901003420353, -0.0011877946089953184, 0.015557278878986835, 0.00040057252044789493, -0.025724288076162338, -0.02245214767754078, 0.01104347687214613, 0.02871888317167759, -0.00940010230988264, 0.008859614841639996, -0.017792267724871635, -0.019822748377919197, -0.04356037825345993, -0.06520909816026688, 0.008808487094938755, 0.022174600511789322, -0.02511076256632805, 0.04250862076878548, 0.03581826016306877, 0.017076486721634865, -0.008012363687157631, -0.0012297919020056725, -0.0008833137690089643, -0.02809074893593788, -0.012927879579365253, 0.03438669815659523, -0.018405795097351074, -0.009626522660255432, 0.003292226931080222, -0.01884402707219124, 0.03353944793343544, 0.008939957246184349, 0.04008372873067856, 0.035409241914749146, 0.014096501283347607, -0.011503621935844421, 0.017675405368208885, 0.019253045320510864, 0.01159126777201891, -0.00381628074683249, 0.002556360326707363, 0.011072692461311817, -0.02194087579846382, 0.0037541978526860476, 0.008194960653781891, -0.02692212536931038, 0.00669766403734684, 0.02194087579846382, 0.018522657454013824, 0.030501030385494232, 0.009692257270216942, -0.001935529988259077, 0.0035843823570758104, 0.04116470366716385, 0.026746833696961403, -0.022028522565960884, 0.028266040608286858, 0.00833373423665762, -0.0016853718552738428, 0.006978863850235939, 0.019004713743925095, -0.026819871738553047, 0.03128984943032265, -0.012117148377001286, -0.02001264877617359, -0.018639517948031425, 0.040375884622335434, 0.03266298025846481, -0.03882746025919914, 0.011956462636590004, -0.00268600438721478, -0.004141303710639477, 0.012336264364421368, 0.0036373354960232973, -0.005704335402697325, 0.012277833186089993, 0.02340165339410305, 0.035526104271411896, 0.031669653952121735, -0.009042211808264256, -0.055451106280088425, 0.05553875491023064, -0.002943466417491436, -0.0035314292181283236, -0.01868334226310253, -0.016492176800966263, 0.002057870151475072, -0.029624564573168755, -0.07227925956249237, 0.019267652183771133, 0.0037907171063125134, 0.028266040608286858, 0.03532159700989723, 0.0015949863009154797, 0.03532159700989723, 0.004685443360358477, 0.04957878217101097, 0.01750011183321476, 0.012160970829427242, -0.03029652126133442, -0.00621560774743557, 0.04490429535508156, -0.005529042333364487, 0.025139978155493736, 0.005927104037255049, 0.014030766673386097, 0.04545938968658447, 0.051711518317461014, 0.022992635145783424, 0.003882015822455287, 0.026703009381890297, 0.01503139827400446, -0.0186979491263628, -0.009305151179432869, 0.020684607326984406, -0.004798653535544872, -0.05729168653488159, -0.06579340994358063, 0.05974579229950905, 0.01122607383877039, 0.00615352438762784, -0.02918633073568344, 0.00440059183165431, 0.009480444714426994, -0.02871888317167759, -0.0057627665810287, 0.02147342637181282, -0.0030475466046482325, 0.00041472382145002484, -0.002019524574279785, 0.0023135060910135508, -0.0018460573628544807, -0.019851963967084885, -0.0028266040608286858, 0.0006326991715468466, -0.022992635145783424, -0.02232067845761776, -0.004499194212257862, -0.023489300161600113, 0.03175729885697365, 0.01085357554256916, -0.010532204993069172, -0.033977679908275604, 0.010342303663492203, 0.0035168214235454798, 0.005214975215494633, 4.699024066212587e-05, -0.0026732224505394697, 0.012263225391507149, -0.010634458623826504, 0.008165745064616203, -0.027331143617630005, -0.02632320672273636, -0.003250229638069868, 0.026367031037807465, -0.017952952533960342, 0.017105702310800552, 0.04732918366789818, -0.005003162194043398, -0.03026730567216873, -0.0003549232496879995, 0.026220953091979027, -0.007501091808080673, 0.02242293208837509, 0.0513901449739933, -0.03315964713692665, -0.0019665714353322983, -0.03777570277452469, 0.04259626567363739, 0.015659533441066742, 0.0090568196028471, 0.008180352859199047, 0.00887422263622284, 0.009546180255711079, 0.011788473464548588, 0.02366459183394909, 0.0011001479579135776, -0.006456635892391205, 0.0030073754023760557, -0.012022197246551514, -0.018873242661356926, 8.325289672939107e-05, -0.04636507108807564, -0.01773383654654026, 0.016813546419143677, 0.023562338203191757, 0.013972335495054722, -0.018376579508185387, 0.0235185157507658, 0.003987922333180904, 0.03803864121437073, 0.007442660629749298, 0.0008047969895415008, 0.0029452922753989697, -0.005722595378756523, 0.015893258154392242, 0.013658268377184868, -0.029273977503180504, -0.015206691808998585, -0.035759828984737396, -0.014819585718214512, 0.006266734562814236, -0.012533469125628471, 0.018873242661356926, -0.0034163929522037506, -0.0047584823332726955, 0.027462614700198174, 0.0359935536980629, 0.04040510207414627, -0.006328817922621965, 0.026965949684381485, -0.0008810313302092254, -0.028645843267440796, 0.008662409149110317, 0.005806589964777231, 0.0020706518553197384, -0.011313720606267452, 0.03260454908013344, 0.020596960559487343, -0.002958073979243636, 0.006719575729221106, 0.03657786548137665, 0.012628420256078243, 0.009918677620589733, -0.020947547629475594, -0.027082812041044235, -0.030384168028831482, -0.005423136055469513, -0.007453616242855787, 0.008428685367107391, -0.01628766767680645, 0.015732571482658386, 0.0040974803268909454, -0.009984413161873817, 0.01350488606840372, 0.005488870665431023, 6.002881855238229e-05, -0.0024541059974581003, -0.006500459276139736, -0.0011448842706158757, 0.02363537810742855, -0.027900846675038338, -0.03742511570453644, -0.010904702357947826, -0.00606222590431571, -0.023723023012280464, 0.012080628424882889, 0.001231617876328528, 0.009312455542385578, -0.011773865669965744, 0.019106967374682426, -0.023226359859108925, -0.006463939789682627, -0.028134571388363838, -0.010101275518536568, -0.03161122277379036, 0.006547934375703335, 0.028499765321612358, 0.019355298951268196, 0.012818320654332638, -0.034824930131435394, -0.018025992438197136, 0.015995511785149574, -0.0020761298947036266, 0.006650188937783241, -0.010802448727190495, 0.00639820471405983, 0.09822266548871994, -0.026513108983635902, -0.01417684368789196, 0.004521105904132128, -0.011028869077563286, 0.027827808633446693, 0.01260650809854269, -0.00564590422436595, -0.03003358282148838, 0.007939324714243412, -0.030617892742156982, 0.02966838702559471, -0.021079016849398613, 0.006379945203661919, 0.0028521677013486624, -0.012635723687708378, -0.023430868983268738, 0.016141589730978012, 0.017806876450777054, 0.01013779453933239, 0.0064785475842654705, 0.006474895402789116, -0.022992635145783424, -4.913004886475392e-05, 0.017894523218274117, 0.007917413488030434, 0.0003729547024704516, -0.010261960327625275, -0.019355298951268196, 0.003827236592769623, 0.006175436079502106, 0.0050068143755197525, -0.05407797545194626, 0.024584881961345673, -0.021327348425984383, -0.00235002557747066, -0.010963133536279202, 0.02340165339410305, 0.010897398926317692, -0.007066510152071714, -0.0014562123687937856, -0.0034583902452141047, -0.016492176800966263, 0.0028521677013486624, 0.008246088400483131, -0.00044302636524662375, -0.013139692135155201, -0.0008102749125100672, 0.01429370604455471, 0.020319413393735886, 0.004448066931217909, -0.011795776896178722, 0.03917804732918739, -0.004864388611167669, -0.022744303569197655, -0.016550607979297638, -0.013088565319776535, 0.023314006626605988, -0.005755462683737278, 0.0024887993931770325, -0.05136093124747276, 0.002452279906719923, -0.00928323995321989, 0.01116033922880888, 0.012029501609504223, -0.033831603825092316, 0.004349464550614357, 0.021765582263469696, -0.00910064298659563, 0.03853530436754227, -0.03126063570380211, -0.014081893488764763, -0.026615362614393234, -0.013870080932974815, -0.0036282057408243418, 0.026849087327718735, -0.026732224971055984, 0.00636168522760272, 0.01526512298732996, 0.016974233090877533, -0.020056473091244698, 0.0011101907584816217, -0.01954520121216774, -0.024468019604682922, -0.009005691856145859, 0.012299745343625546, 0.027959277853369713, 0.02535909414291382, -0.026688402518630028, 0.01676972396671772, -0.011394063010811806, 0.014264490455389023, 0.03260454908013344, -0.00033963072928600013, -0.01032039150595665, -0.027550259605050087, 0.028032317757606506, -0.007690992671996355, -0.02085990086197853, 0.013117779977619648, -0.0016808068612590432, 0.010079363361001015, 0.025139978155493736, -0.00025244057178497314, 0.011605875566601753, 0.021897051483392715, -0.02920093946158886, -0.02246675454080105, -0.019822748377919197, -0.001126624527387321, -0.020772254094481468, -0.019004713743925095, 0.01582021825015545, 0.023620769381523132, -0.02861662767827511, -0.0013594358460977674, 0.006869305390864611, 0.011065388098359108, 0.021911660209298134, -0.0359935536980629, 0.02173636667430401, 0.0106709785759449, -0.006854697596281767, 0.013198123313486576, -0.016126981005072594, 0.0020523921120911837, -0.0013731307117268443, -0.0043385084718465805, 0.0005518999532796443, 0.005101765040308237, -0.012336264364421368, 0.014914536848664284, 0.023314006626605988, -0.015761787071824074, 0.006778006907552481, 0.03015044331550598, 0.0058102416805922985, -0.024205081164836884, -0.017222564667463303, -0.02508154697716236, 0.019253045320510864, 0.001308308681473136, 0.0011384933022782207, 0.004221646580845118, -0.011934550479054451, -0.008048882707953453, 0.011963766068220139, -0.01381164975464344, 0.01690119318664074, 0.008326430805027485, -0.026133306324481964, 0.03982079029083252, -0.0071139857172966, 0.02170715108513832, 0.006482199300080538, -0.021137448027729988, 0.030939264222979546, -0.013614444993436337, 0.03076397068798542, -0.0040974803268909454, 0.02883574366569519, -0.006522370968014002, 0.013855473138391972, 0.036490216851234436, 0.0335102304816246, 0.014644293114542961, -0.009027604013681412, -0.006084137596189976, -0.009984413161873817, -0.010656370781362057, 0.0068510458804667, -0.006799918599426746, 0.011277200654149055, -0.03015044331550598, 0.009020299650728703, 0.019136182963848114, -0.019121576100587845, -0.0012197491014376283, -0.0003804868320003152, 0.03684080392122269, 0.007420748937875032, -0.03158200532197952, 0.05261719971895218, 0.021882444620132446, 0.004637967795133591, 0.01235817652195692, 0.025066938251256943, 0.025066938251256943, 0.021181270480155945, -0.02547595649957657, 0.006657492835074663, -0.005802937783300877, 0.04326822608709335, 0.01265763584524393, 0.026951340958476067, 0.03222474828362465, 0.001496383803896606, 0.015557278878986835, 0.027126634493470192, 0.025987228378653526, 0.007669080980122089, 0.00224594515748322, -0.020567744970321655, 0.02424890361726284, -0.007179720792919397, 0.03041338361799717, -0.012022197246551514, 0.020480098202824593, -0.0017419769428670406, -0.01454934198409319, 0.02836829610168934, 0.004517453722655773, 0.02221842296421528, -0.008173049427568913, -0.00010556398774497211, 0.011415975168347359, 0.02278812602162361, 0.0071066818200051785, -0.008823094889521599, -0.023620769381523132, 6.590616249013692e-05, -0.02147342637181282, -0.00482786912471056, 0.025797327980399132, -0.013950423337519169, 0.014089196920394897, 0.019589023664593697, 0.03219553083181381, 0.01133563183248043, 0.014819585718214512, 0.0011567530455067754, -0.019238436594605446, -0.015279730781912804, -0.009436621330678463, 0.023138713091611862, -0.0009549831738695502, -0.027813199907541275, -0.006686708424240351, 0.014308313839137554, 0.018011383712291718, -0.030676323920488358, 0.006807222496718168, 0.013132387772202492, -0.013650964014232159, -0.013541406020522118, 0.07327259331941605, 0.020290197804570198, 0.013044741936028004, -0.03508787229657173, 0.024468019604682922, -0.01992500200867653, 0.008348342031240463, -0.011394063010811806, -0.011664306744933128, 0.03111455775797367, -0.006182739976793528, 0.012533469125628471, -0.03435748443007469, -0.0035916862543672323, 0.025884974747896194, -0.021181270480155945, -0.008735448122024536, 0.0030566765926778316, -0.004239906091243029, -0.03026730567216873, 0.009677649475634098, -0.019457554444670677, 0.003819932695478201, -0.03882746025919914, 0.003069458296522498, 0.003995225764811039, 0.03827236592769623, 0.009509660303592682, -0.0029179027769714594, 0.0013786086346954107, 0.012511557899415493, 0.004418851342052221, 0.00032935963827185333, -0.0009988064412027597, -0.018420401960611343, 0.004473630804568529, -0.012774498201906681, 0.008494419977068901, -0.00230985414236784, 0.020553136244416237, 0.002466887701302767, -0.01823050156235695, -0.021911660209298134, 0.0006043966277502477, 0.0008381209918297827, -0.027170458808541298, -0.0005934407818131149, 0.027900846675038338, -0.019968826323747635, -0.01760236732661724, 0.0018615780863910913, 0.015893258154392242, -0.018040599301457405, -0.0011467102449387312, 0.02293420396745205, -0.021166663616895676, 0.0023810670245438814, 0.018770989030599594, 0.01627305895090103, 0.03029652126133442, 0.024935469031333923, -0.032896704971790314, 0.03053024597465992, -0.0048497808165848255, 0.013424543663859367, 0.00928323995321989, -0.004367724061012268, 0.004543017596006393, 0.018069814890623093, 0.007544914726167917, 0.020421667024493217, 0.0030092012602835894, 0.008275303989648819, -0.022481363266706467, 0.031435929238796234, -0.024190472438931465, -0.006493155378848314, 0.0009358105016872287, -0.023474691435694695, 0.02280273474752903, -0.00886691827327013, 0.019092360511422157, -0.0040901764295995235, 0.014702723361551762, 0.004594144877046347, 0.03792177885770798, 0.0074390084482729435, 0.028981821611523628, 0.008238784037530422, 0.001510078553110361, 0.021312741562724113, -0.01013779453933239, 0.01992500200867653, 0.009363582357764244, -0.018259717151522636, 0.011065388098359108, 0.024409588426351547, -0.00763256149366498, 0.025534387677907944, -0.03789256513118744, -0.018727164715528488, 0.02836829610168934, 0.0017958431271836162, -0.005262450315058231, 0.020304804667830467, 0.013351504690945148, 0.03932412713766098, -0.02375223860144615, -0.017456289380788803, 0.011569356545805931, -0.008596674539148808, 0.001984831178560853, -0.026703009381890297, -0.013643660582602024, 0.011496317572891712, -0.04429076984524727, -0.030325736850500107, 0.0060330103151500225, 0.007048250641673803, -0.005539997946470976, -0.003195450408384204, -0.0035423850640654564, -0.01212445180863142, 0.015002183616161346, -0.00024331072927452624, 0.03041338361799717, 0.026615362614393234, 0.034445129334926605, 0.021648719906806946, -0.030822401866316795, 0.0020049167796969414, -0.020830685272812843, -0.005236886907368898, 0.03415297344326973, 0.005992839112877846, -3.5749100788962096e-05, -0.04803035780787468, 0.011503621935844421, -0.022481363266706467, -0.0062813423573970795, -0.0017310210969299078, 0.019238436594605446, 0.00030813273042440414, 0.0068181781098246574]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" ignore the coverage provided by the online data D1:t0−1. We now qualitatively analyze the
impact of the online data as follows.
RLHF Benefits from Online Exploration. One natural question arises under Assumption 2: if we
can directly apply Algorithm 1 to get a good policy, why should we collect online data? The difference is
that now the second term corresponds to the coverage condition of Doff∪ D1:t0. Under Assumption 2, with
suitable hyper-parameters (large enough mand suitable β), we know that π1
t→π∗. Since the online data is
collected by ( π1
t, πref) and the goal is to cover ( π∗, πref), we expect that the intermediate policies can provide
a much better coverage as compared to the Doff, i.e., a much smaller Ccov, for many average instances. We
will partially verify this intuition in the experiment part.
We now move to the case of Option II where we cannot expect to have a diverse Doffand need explicit
exploration. We first show that with suitable β, the constructed confidence set contains π∗with high
probability.
Lemma 4 (Confidence set) .For the linear model in Assumption 1, given the policy of the main agent π1
t,
we consider the following confidence set with β=O q
dlog(T/δ)
γ2m
:
Πt=n
eπ∈Π :ηmX
i=1DKL(eπ(·|xt,i)∥π1
t(·|xt,i))≤βmX
i=1∥ϕ(xt,i,eπ)−ϕ(xt,i, π1
t)∥Σ−1
t,mo
.
Then, with probability at least 1−δ, we know that π∗∈Πtfor all t∈[T].
15
We defer the proof to Appendix B.3 and present the main result for the Option II.
Theorem 3. For any ϵ > 0, we set the batch size m=d/(γ2ϵ2). Under Assumption 1, with β:=
O q
dlog(T/δ)
γ2m
andλ= Θ 
dlog(T/δ)/(mγ2B2)
, after T= min {n∈N+:n≥dlog(n)}iterations, we
have with probability at least 1−3δ, Algorithm 2 with Option II satisfies: there exists a t0∈[T],
J(π∗)−J(π1
t0)≲ϵ−η·Ext0∼d0
DKL(π∗(·|xt0)∥π1
t0(·|xt0))
,
where the number of collected samples is at most mT=eO
d2
γ2ϵ2
.
Getting Rid of Data Coverage. One notable feature of Theorem 3 is that with explicit exploration,
we do not need an offline dataset with good coverage, highlighting the importance of strategic explorations.
This is particularly important in the context of LLMs because the distribution shift between LLMs are very
large so data coverage is more sparse. For instance, along the way of finding the optimal policy of some
learned reward function by PPO, the KL divergence to the initial checkpoint can be >25 (Bai et al., 2022).
Algorithmic Simplicity v.s. Data Coverage. We note that Option I and Option II are complementary
to each other and hold their own values. Specifically, the Option I offers simplicity in algorithmic design,
at the cost of demand for a high-quality Doff. In comparison, the online learning does not relies on the
quality of Doff, but the choice of the enhancer is challenging because for the neural network, the uncertainty
estimators do not admit a closed-form. In practice, we typically resort to heuristic methods (Wu et al.,
2021b; Coste et al., 2023) to estimate the uncertainty, as we discuss in the experiment part of this paper.
The advantage of reward modeling. Theorem 2 and Theorem 3 reveal a key characteristic of reward
modeling: the sample complexity is dependent on the complexity of the reward model rather than the
generative models. For simple reward functions, such as sentiment or politeness evaluation, the required
function class is substantially smaller compared to the generative model. This is corroborated by evidence
showing that even compact models like BERT (Devlin et al.,","[-0.005278894677758217, -0.018156707286834717, 0.03171371668577194, 0.01827775314450264, 0.015749262645840645, 0.0021149201784282923, -0.024948660284280777, 0.03391942009329796, -0.030207380652427673, 0.062190085649490356, 0.04096691310405731, -0.034349799156188965, -0.010571238584816456, -0.008015850558876991, -0.0020090059842914343, -0.022460520267486572, 0.014363973401486874, -0.034080810844898224, 0.04567420482635498, 0.024007203057408333, -0.04521692544221878, -0.02753094770014286, 0.018654335290193558, 0.01928645744919777, 0.033381443470716476, -0.01991858147084713, -0.0015542478067800403, 0.02848585695028305, 0.016327587887644768, -0.05296378955245018, 0.03502226993441582, -0.022850552573800087, -0.04720744118094444, -0.029104528948664665, 0.00793515332043171, 0.053259674459695816, 0.026912275701761246, 0.005837045144289732, 0.0003341338597238064, 0.005605042912065983, 0.009723925963044167, -0.04804130271077156, -0.04500173404812813, 0.03351593762636185, -0.006011887453496456, 0.04357609897851944, 0.0013953766319900751, -0.023307831957936287, 0.00014510656183119863, 0.01927300915122032, -0.06181350350379944, 0.019932029768824577, -0.033112455159425735, -0.05398594215512276, -0.01905781775712967, -0.017107652500271797, 0.014337074011564255, 0.015897206962108612, 0.022030139341950417, -0.047745417803525925, 0.015614768490195274, -0.011324405670166016, 0.02274295687675476, 0.019178863614797592, -0.010187930427491665, 0.006008525379002094, -0.04182767495512962, 0.017430439591407776, -0.0209676343947649, 0.044921040534973145, 0.004868687596172094, -0.0184660442173481, 0.03152542561292648, -0.0047745415940880775, -0.007477873470634222, 0.01564166694879532, 0.01576271280646324, 0.03287036716938019, 0.004021374508738518, -0.027732688933610916, 0.00984496995806694, -0.00594800291582942, 0.01496919710189104, -0.05858564376831055, -0.01558787003159523, -0.058047667145729065, -0.009690302424132824, -0.01763218082487583, -0.057186905294656754, 0.009723925963044167, 0.016125846654176712, 0.012205341830849648, -0.004377783741801977, 0.010456918738782406, 0.04863307625055313, 0.007901529781520367, 0.009528908878564835, -0.011795135214924812, 0.043549198657274246, 0.030153583735227585, -0.0113916527479887, -0.058370452374219894, 0.01326784584671259, -0.028432058170437813, 0.08311737328767776, 0.016341036185622215, -0.008358810096979141, 0.024141697213053703, -0.020268265157938004, -0.016583126038312912, -0.0702059343457222, -0.04244634881615639, -0.05761728435754776, 0.025822872295975685, 0.014054636470973492, -0.04424856975674629, -0.06342743337154388, 0.029911493882536888, -0.0009179224143736064, -0.007921704091131687, -0.01768597774207592, -0.0033354545012116432, 0.025769075378775597, 0.024585526436567307, 0.036125123500823975, -0.006136294454336166, 0.01768597774207592, -0.08623763918876648, -0.00872866902500391, -0.01768597774207592, 0.020362410694360733, 0.06003817915916443, 0.01087385043501854, -0.03168681636452675, -0.04680395871400833, 0.036716897040605545, -0.017699427902698517, 0.018681233748793602, -0.0014332031132653356, -0.031014345586299896, -0.021478712558746338, -0.05293688923120499, -0.05584196373820305, 0.030691560357809067, -0.07047492265701294, 0.0070676663890480995, 0.007948603481054306, 0.007282857317477465, 0.01772632636129856, 0.034296002238988876, 0.0011205042246729136, -0.02205703780055046, -0.03198270499706268, 0.030476368963718414, -0.010295525193214417, -0.035614047199487686, -0.04258084297180176, 0.055034998804330826, 0.026549141854047775, -0.022124284878373146, 0.00950201041996479, 0.08300977945327759, 0.001650074846111238, -0.0063044121488928795, 0.015399578027427197, 0.056541331112384796, -0.021734250709414482, -0.004303812049329281, -0.05551917850971222, -0.019299907609820366, 0.018062561750411987, 0.000799819768872112, -0.019340256229043007, -0.03063776344060898, -0.01927300915122032, -0.060629952698946, -0.02958870865404606, -0.007551845163106918, 0.02821686863899231, -0.07289581745862961, 0.03537195548415184, 0.0037725602742284536, 0.014485017396509647, -0.007081116084009409, -0.020079974085092545, -0.0002757129550445825, 0.009421314112842083, -0.02169390395283699, -0.005964814685285091, 0.031659919768571854, 0.012541577219963074, 0.023966854438185692, 0.0510539710521698, -0.02548663690686226, 0.021088680252432823, -0.014511916786432266, 0.026791229844093323, 0.06003817915916443, -0.011149562895298004, 0.011331130750477314, 0.023361630737781525, 0.011983427219092846, 0.001997237792238593, -0.04744952917098999, 0.04158558323979378, 0.0042231157422065735, 0.010060161352157593, 0.048659976571798325, -0.05393214523792267, -0.023899607360363007, -0.012662622146308422, 0.01850639283657074, 0.040455833077430725, 0.0017097566742449999, -0.023119540885090828, -6.089011731091887e-05, -0.011304231360554695, 0.030099786818027496, 0.03249378129839897, 0.052587203681468964, 0.0034211943857371807, 0.03655550628900528, 0.022998496890068054, -0.004081896971911192, -0.024679671972990036, 0.003661602735519409, 0.019259558990597725, -0.054900504648685455, 0.025742176920175552, -0.04007925093173981, 0.05428183078765869, 0.01591065526008606, -0.01713455282151699, -0.038492221385240555, 0.029319720342755318, -0.04634667560458183, 0.018882974982261658, 0.0020056436769664288, 0.00394067820161581, -0.04094001278281212, 0.007094565313309431, 0.00492248497903347, -0.003436325117945671, 0.00393059104681015, 0.0036985885817557573, 0.03018048219382763, -0.027383005246520042, -0.029158327728509903, -0.015251634642481804, 0.0016988290008157492, 0.030826054513454437, -0.03531815856695175, -0.02360372059047222, -0.02953491173684597, -0.040267542004585266, -0.002272950718179345, 0.019205762073397636, 0.013866344466805458, -0.02980390004813671, 0.030557066202163696, -0.01496919710189104, 0.02092728577554226, 0.001546682440675795, -0.004865325056016445, -0.013610806316137314, -0.026266703382134438, -0.02087348885834217, -0.030341874808073044, -0.005497447680681944, -0.024303089827299118, 0.02260846272110939, -0.004804802592843771, -0.027920981869101524, 0.016784867271780968, -0.04180077463388443, -0.03897639736533165, 0.025136953219771385, 0.04750332608819008, -0.031095042824745178, -0.017847370356321335, -0.003863343968987465, 0.010772979818284512, 0.051430556923151016, 0.0001397478044964373, 0.03647480905056, -0.03504917025566101, 0.016663823276758194, -0.011492523364722729, -0.03838462382555008, -0.03714727982878685, 0.007585468702018261, -0.027383005246520042, 0.026791229844093323, -0.06617110967636108, -0.0034901227336376905, -0.028512755408883095, 0.014135332778096199, -0.06041476130485535, 0.016973158344626427, 0.01909816637635231, 0.0319020077586174, 0.025365592911839485, -0.011828758753836155, 0.016112396493554115, 0.01568201556801796, 0.012568476609885693, 0.01850639283657074, 0.02749060094356537, -0.020079974085092545, 0.022958148270845413, -0.0065162405371665955, 0.013509935699403286, -0.009999638423323631, 0.03816943243145943, 0.006667546462267637, -0.012312937527894974, 0.02638774737715721, -0.040052350610494614, -0.015601319260895252, -0.025943918153643608, -0.05885463207960129, -0.0391915887594223, -0.03628651797771454, -0.00820414163172245, 0.022137733176350594, -0.02926592342555523, -0.002953827381134033, 0.0011272289557382464, -0.02775958925485611, -0.03636721149086952, -0.018197055906057358, 0.015144038945436478, 0.021572858095169067, 0.017739776521921158, -0.010584687814116478, -0.009259920567274094, -0.06353502720594406, 0.0341884084045887, 0.03660930320620537, 0.03273587301373482, -0.06412680447101593, 0.004707294516265392, -0.030234280973672867, 0.015130589716136456, -0.025876671075820923, 0.03354283422231674, 0.024693122133612633, 0.03467258810997009, 0.03063776344060898, 0.03655550628900528, -0.0019417590228840709, -0.02165355533361435, 0.023401979357004166, 0.05794006958603859, -0.027517499402165413, 0.03771215304732323, -0.01150597259402275, -0.060737550258636475, -0.004149144049733877, -0.04709984362125397, -0.020954186096787453, -0.0016584807308390737, 0.004949383903294802, 0.029776999726891518, -0.001268447726033628, 0.03983716294169426, -0.004781266208738089, 0.02197634056210518, -0.0024393873754888773, -0.00820414163172245, 0.0012734913034364581, 0.020658297464251518, -0.048659976571798325, -0.026602938771247864, -0.05204922705888748, 0.0008300809422507882, 0.012501229532063007, 0.0227833054959774, 0.0134426886215806, 0.011062142439186573, -0.0038061838131397963, -0.0017803660593926907, -0.01772632636129856, -0.04653497040271759, 0.013752024620771408, 0.021572858095169067, -0.03628651797771454, -0.02502935752272606, -0.05022010952234268, -0.04042893648147583, 0.01995892822742462, -0.012252415530383587, -0.026226354762911797, -0.004861962981522083, -0.015372678637504578, 0.001822395483031869, -0.023092642426490784, 0.042392548173666, 0.07585468888282776, 0.03365043178200722, -0.04809509962797165, -0.01021482888609171, -0.04244634881615639, -0.022124284878373146, -0.016919361427426338, 0.00441140728071332, 0.024989008903503418, -0.005137675907462835, -0.0023637344129383564, 0.06579452753067017, 0.008816090412437916, -0.00797550193965435, 0.015238184481859207, -0.05347486585378647, -0.019703390076756477, -0.008937135338783264, 0.005373040679842234, 0.032117199152708054, 0.05519638955593109, 0.0697755515575409, 0.01050399150699377, -0.056864116340875626, 0.022487418726086617, 0.004872049670666456, -0.012131370604038239, 0.0341884084045887, 0.021317319944500923, 0.01673107035458088, -0.011041968129575253, -0.03956817463040352, -0.00987186934798956, 0.04110140725970268, 0.03545265272259712, -0.0010734312236309052, -0.05691791698336601, -0.007585468702018261, 0.02293124981224537, 0.0036985885817557573, 0.0014273189008235931, -0.019905131310224533, 0.03187510743737221, 0.0005955568049103022, -0.0391915887594223, 0.028324464336037636, -0.028136171400547028, -0.007874631322920322, -0.037443164736032486, -0.036259617656469345, 0.035936832427978516, -0.0013634342467412353, -0.02693917416036129, 0.005339417140930891, 0.05546537786722183, 0.036125123500823975, -0.007242508698254824, -0.06708566844463348, 0.066547691822052, -0.03405391424894333, 0.02972320280969143, 0.03400011733174324, -0.002693244954571128, -0.022635361179709435, 0.005884118378162384, 0.02693917416036129, 0.03720107674598694, 0.034349799156188965, -0.010846951976418495, 0.000790573307313025, -0.011472349055111408, 0.030610863119363785, -0.015278533101081848, -0.056541331112384796, 0.03410771116614342, -0.030072886496782303, -0.009239746257662773, 0.006707894615828991, 0.024531729519367218, 0.002891623880714178, 0.026697084307670593, -0.018882974982261658, -0.010954546742141247, 0.0012440707068890333, 0.008083097636699677, 0.008695045486092567, 0.03230549022555351, 0.0378197506070137, 0.025607682764530182, -0.02644154615700245, 0.007181986700743437, -0.005030080676078796, -0.01682521589100361, -0.05309828370809555, 0.06934517621994019, -0.015332330949604511, 0.0024141697213053703, -0.024720020592212677, 0.0004442509089130908, -0.0052553582936525345, 0.026871927082538605, 0.011559770442545414, 0.03515676409006119, -0.03262827545404434, -0.003849894506856799, 0.019246110692620277, -0.02720816247165203, 0.022554665803909302, 0.004999819211661816, -0.016381384804844856, -0.02579597383737564, 0.04139729216694832, -0.06170590594410896, -0.0022998496424406767, 0.03227858990430832, 0.01077970489859581, -0.022312575951218605, -0.00454590143635869, -0.018990570679306984, -0.008782466873526573, -0.003987750969827175, 0.022500867024064064, -0.023092642426490784, -0.03394631668925285, -0.03365043178200722, 0.04371059313416481, 0.007155087776482105, 0.006395196076482534, -0.0355602465569973, -0.10011743009090424, -0.02775958925485611, -0.018385346978902817, 0.03378492593765259, -0.014121883548796177, 0.03203650191426277, 0.029104528948664665, -0.045916296541690826, -0.021895645186305046, -0.029642505571246147, 0.010362772271037102, 0.002750404877588153, 0.024625875055789948, 0.022541215643286705, -0.0028025214560329914, -0.0009935754351317883, 0.034941576421260834, -0.00297904503531754, -0.04212355986237526, 0.03946057707071304, -0.03174061328172684, -0.010927648283541203, 0.005746261682361364, 0.0369320884346962, -0.014996095560491085, -0.01650242879986763, -0.0275712963193655, -0.03483397886157036, 0.008291563019156456, -0.004539176821708679, -0.0005972380167804658, -0.00011011707101715729, -0.003819633275270462, -0.003194235498085618, -0.008816090412437916, 0.007027318235486746, 0.03924538567662239, -0.03932608291506767, 0.04796060547232628, 0.021868744865059853, -0.02653569169342518, 0.01562821865081787, 0.03588303551077843, -0.03892260044813156, 0.03843842074275017, 0.01483470294624567, -0.04613148793578148, 0.03545265272259712, -0.004485379438847303, 0.02511005476117134, -0.016435183584690094, 0.013294744305312634, 0.019125064834952354, -0.02535214275121689, -0.025284895673394203, -0.04040203616023064, -0.032386187463998795, -0.02894313633441925, 0.0044416687451303005, 0.035990629345178604, 0.028835540637373924, -0.05944640561938286, 0.012225516140460968, 0.012433982454240322, -0.024235842749476433, -0.009011106565594673, -0.013866344466805458, -0.060737550258636475, 0.010470367968082428, 0.016152745112776756, 0.006122845225036144, -0.024087898433208466, -0.042231157422065735, 0.030933650210499763, -0.012393633835017681, 0.030019089579582214, -0.017699427902698517, -0.029239023104310036, 0.054497022181749344, -0.021169375628232956, 0.004720743745565414, 0.02219153195619583, -0.001940077869221568, -0.0011650554370135069, -0.015749262645840645, 0.02913142926990986, -0.02853965386748314, -0.02835136279463768, -0.0023015306796878576, -0.017712876200675964, -0.01479435432702303, 0.06052235886454582, -0.03308555483818054, 0.013866344466805458, -0.0076123676262795925, 0.022366372868418694, 0.01613929495215416, 0.006697807461023331, 0.018358448520302773, -0.02133076824247837, -0.0273426566272974, 0.0037322121206671, -0.01002653781324625, -0.03365043178200722, -0.020846590399742126, 0.009024555794894695, 0.0149288484826684, 0.016354486346244812, -0.02161320671439171, -0.010739356279373169, 0.010625036433339119, -0.018425695598125458, -0.028889339417219162, 0.012427257373929024, 0.027235060930252075, 0.01722869835793972, -0.051807139068841934, -0.012117921374738216, 0.0149288484826684, -0.00682557700201869, 0.035856135189533234, -0.013825996778905392, -0.009273369796574116, -0.015897206962108612, -0.031202638521790504, 0.019434401765465736, 0.017067305743694305, 0.028916237875819206, 0.002040948485955596, 0.03176751360297203, 0.006496066693216562, 0.0061262077651917934, -0.013483036309480667, -0.011600119061768055, -0.017538035288453102, -0.023401979357004166, -0.015507172793149948, -0.006496066693216562, 0.04365679621696472, 0.01114283874630928, 0.05616474896669388, 0.006859200540930033, 0.003769197966903448, -0.043280210345983505, -0.006600299384444952, 0.025957366451621056, -0.00959615595638752, -0.01659657619893551, -0.039595071226358414, -0.005911016836762428, -0.06579452753067017, -0.018560189753770828, 0.032655175775289536, -0.03453809395432472, -0.009071629494428635, -0.04758402332663536, -0.035479553043842316, -0.03063776344060898, -0.0065162405371665955, 0.020752444863319397, -0.01496919710189104, -0.00041314915870316327, -0.0003875112161040306, -0.01631413772702217, -0.02041620947420597, 0.02420894242823124, -0.0019064543303102255, -0.011156287975609303, 0.02880864217877388, 0.018573639914393425, 0.04723433777689934, -0.04053653031587601, -0.0669780746102333, -0.008869888260960579, 0.03892260044813156, -0.02233947440981865, -0.008681596256792545, -0.027598194777965546, -0.003960852045565844, -0.004021374508738518, 0.027477150782942772, 0.02680468000471592, -0.05729449912905693, 0.017524585127830505, -0.003105133306235075, -0.019407503306865692, 0.01818360574543476, -0.008621073327958584, -0.0070609417743980885, 0.029965292662382126, -0.010887299664318562, 0.0008061241824179888, -0.020174119621515274, -0.027544397860765457, 0.001052416511811316, -0.0298576969653368, 0.00952218472957611, -0.0037086757365614176, 0.01726904697716236, -0.047019146382808685, 0.03131023421883583, -0.034349799156188965, 0.00030828575836494565, -0.000693905632942915, -0.0019199036760255694, -0.005137675907462835, -0.03184821084141731, -0.0035842685028910637, 0.0010297206463292241, 0.006496066693216562, 0.02653569169342518, 0.009723925963044167, -5.526867971639149e-05, 0.008378984406590462, -0.005867306608706713, -0.021169375628232956, 0.007108014542609453, -0.014242928475141525, 0.02056415192782879, -0.011432001367211342, 0.024410683661699295, -0.007282857317477465, 0.046696361154317856, 0.015103690326213837, 0.01214481983333826, -0.015184387564659119, 0.006499428767710924, 0.011479074135422707, 0.00297400145791471, 0.020227916538715363, 0.0008275592117570341, -0.014108434319496155, -0.010080334730446339, -0.002817651955410838, -0.0002748723782133311, -0.022460520267486572, 0.031659919768571854, 0.005850494839251041, -0.012097747065126896, -0.02913142926990986, -0.0006010206416249275, 0.03268207237124443, -0.018681233748793602, -0.002817651955410838, -0.0009069947991520166, 0.007074391003698111, 0.009555808268487453, 0.04435616359114647, 0.007303031161427498, 0.025553883984684944, -0.004915760364383459, -0.008432782255113125, -0.02411479689180851, -0.010329148732125759, -0.008358810096979141, 0.01886952668428421, -0.008526927791535854, -0.007672890089452267, 0.00442149443551898, 0.0029454214964061975, -0.017107652500271797, 0.02001272700726986, -0.05027390643954277, -0.029239023104310036, -0.030019089579582214, -0.01381254754960537, -0.03994475677609444, 0.02749060094356537, 0.03515676409006119, -0.03529125824570656, -0.1139434278011322, -0.008237765170633793, 0.027423353865742683, 0.01317370031028986, 0.007276132237166166, -0.027087118476629257, 0.03970266878604889, -0.01896367222070694, -0.040724821388721466, -0.049117255955934525, -0.0070609417743980885, -0.01659657619893551, 0.008392433635890484, -0.0007863703649491072, 0.001528189517557621, -0.04112830385565758, -0.003217772115021944, -0.025002459064126015, 0.025648031383752823, -0.006102670915424824, 0.005268807522952557, 0.0026411283761262894, -0.011539596132934093, 0.009105253033339977, -0.012205341830849648, -0.026064962148666382, 0.016421733424067497, -0.02999219112098217, -0.018815727904438972, 0.004408045206218958, -0.0012146501103416085, 0.008627798408269882, 0.021223174408078194, 0.0009187630494125187, -0.0428498312830925, -0.000880095933098346, 0.007235784083604813, -0.010705732740461826, -0.031014345586299896, 0.030422572046518326, 0.0355602465569973, -0.027100566774606705, 0.045970093458890915, -0.016704170033335686, 0.021048331633210182, -0.0314447283744812, 0.01431017555296421, -0.02867414802312851, 0.00029630737844854593, -0.007235784083604813, 0.022097386419773102, -0.009562532417476177, -0.020174119621515274, -0.006358209997415543, 0.006216991227120161, 0.002259501488879323, 0.013725126162171364, 0.02966940589249134, -0.019851334393024445, -0.0033035119995474815, -0.03168681636452675, 0.04699224978685379, 0.03467258810997009, -0.015668565407395363, -0.0351029671728611, 0.005964814685285091, 0.010510716587305069, 0.054174236953258514, -0.018681233748793602, -0.03157922253012657, -0.00556133221834898, -0.030799156054854393, 0.003116901498287916, 0.02174770087003708, -0.0032598015386611223, 0.02178804948925972, 0.027181264013051987, 0.026589488610625267, -0.051161568611860275, 0.024989008903503418, 0.04763782024383545, -0.058316655457019806, 0.0103694973513484, 0.02411479689180851, -0.00042848990415222943, 0.029023833572864532, 0.01667727157473564, -0.020322062075138092, -0.029561810195446014, 0.01964959315955639, 0.037900444120168686, -0.014754005707800388, -0.0008094865479506552, -0.015534072183072567, -0.01338216569274664, -0.0469653494656086, -0.048606179654598236, 0.009475111030042171, 0.04443686082959175, -0.024827616289258003, 0.053394168615341187, 0.032117199152708054, 0.00505025452002883, -0.014807803556323051, -0.005507534835487604, 0.017161451280117035, -0.0010061842622235417, -0.011384927667677402, 0.02356337197124958, -0.014619511552155018, 0.004367697052657604, 0.0271140169352293, -0.003997838124632835, 0.018479492515325546, -0.005497447680681944, 0.03806183859705925, 0.06396540999412537, 0.018519841134548187, 0.0052150096744298935, 0.022864002734422684, 0.022447070106863976, 0.021774599328637123, 0.002953827381134033, 0.0054739112965762615, -0.004273551050573587, -0.04137039557099342, 0.002042629523202777, 0.030503269284963608, -0.020954186096787453, 0.009340616874396801, -0.0003511557588353753, 0.016381384804844856, 0.02953491173684597, 0.0031219450756907463, -0.01713455282151699, 0.015964454039931297, 0.015372678637504578, 0.016650373116135597, -0.022716058418154716, 0.002617591992020607, 0.00041062739910557866, -0.005053617060184479, 0.01394704170525074, -0.0007145000854507089, -0.010947822593152523, 0.015251634642481804, 0.01791461743414402, -0.02443758398294449, -0.013893243856728077, 0.0018879612907767296, 0.022272227331995964, -0.02894313633441925, 0.0033791649620980024, -0.02123662270605564, 0.002836144994944334, 0.011189911514520645, 0.016717620193958282, -0.03841152414679527, 0.016892462968826294, 0.02207048609852791, 0.010564513504505157, 0.04225805401802063, -0.038492221385240555, -0.04166628047823906, 0.04486723989248276, -0.03529125824570656, -0.0004665265150833875, -0.012992133386433125, -0.02024136669933796, 0.001797177828848362, -0.013119902461767197, -0.07262682914733887, 0.007551845163106918, 0.020133771002292633, 0.029292821884155273, 0.0209676343947649, -0.010161031037569046, 0.044006478041410446, 0.024128247052431107, 0.040644124150276184, 0.012292763218283653, 0.02547318860888481, -0.017618730664253235, -0.011068866588175297, 0.04720744118094444, -0.003789372043684125, 0.0074980477802455425, -0.012097747065126896, -0.009179224260151386, 0.04392578452825546, 0.02584977261722088, 0.028270665556192398, -0.0032614825759083033, 0.023132991045713425, 0.01913851499557495, -0.01873503252863884, -0.035210564732551575, 0.022595014423131943, -0.017605282366275787, -0.06579452753067017, -0.08586104959249496, 0.02260846272110939, 6.540827598655596e-05, -0.0020560789853334427, -0.03437669947743416, 0.03687829151749611, 0.01012068334966898, -0.0074913231655955315, -0.008419332094490528, 0.005285619292408228, 0.007027318235486746, -0.0038734308909624815, -0.013483036309480667, 0.013577182777225971, -0.001080155954696238, -0.015574419870972633, -0.005386489909142256, 0.0033035119995474815, -0.03841152414679527, -0.011707713827490807, -0.01864088699221611, -0.016636922955513, 0.023321282118558884, 0.016529329121112823, -0.02001272700726986, 0.004458480514585972, 0.03572164103388786, 0.005167936906218529, 0.007074391003698111, -0.02138456702232361, 0.006169917993247509, -0.01686556451022625, -0.008284837938845158, 0.0027840284164994955, -0.021895645186305046, -0.03319315239787102, 0.000602281535975635, 0.020214468240737915, -0.00895730871707201, 0.019111616536974907, 0.054443225264549255, -0.011889280751347542, -0.028136171400547028, -0.016112396493554115, 0.024276189506053925, -0.011526146903634071, 0.02493521198630333, 0.04790680855512619, -0.041047606617212296, 0.005877393297851086, -0.014189130626618862, 0.044006478041410446, 0.0186946839094162, 0.01166736613959074, 0.027315758168697357, -0.00670117000117898, 0.014390871860086918, 0.03157922253012657, 0.027786487713456154, 0.013825996778905392, -0.023966854438185692, 0.029561810195446014, 0.002466286066919565, -0.011418551206588745, -0.0018005401361733675, -0.04874067381024361, 0.003137075575068593, 0.017215248197317123, 0.007363553624600172, -0.0032211344223469496, -0.025688378140330315, 0.050758086144924164, -0.004461842589080334, 0.04206976294517517, 0.00859417486935854, 0.010927648283541203, 0.0021014707162976265, -0.01178168598562479, 0.023321282118558884, 0.0008775742026045918, -0.03405391424894333, -0.020658297464251518, -0.023213686421513557, -0.03857291489839554, 0.008358810096979141, -0.007686339318752289, 0.008681596256792545, -0.0013852895935997367, 0.0077199628576636314, 0.0061900923028588295, 0.045647308230400085, 0.04336090758442879, 0.007585468702018261, 0.02247396856546402, -0.013301469385623932, -0.009515459649264812, 0.006566675845533609, -0.003876793198287487, 0.010302250273525715, 0.005968177225440741, 0.0044988286681473255, 0.018681233748793602, 0.010087059810757637, -0.005056979134678841, 0.03104124590754509, 0.017968416213989258, -0.0013726807665079832, -0.001884598983451724, -0.020819691941142082, -0.03846532106399536, -0.003564094426110387, -0.024195494130253792, 0.005668927449733019, -0.020174119621515274, -0.01695971004664898, 0.019810985773801804, -0.005534433294087648, -0.008688320405781269, -0.004239927511662245, 0.0074644242413342, 0.006378384307026863, 0.007928429171442986, 0.010530889965593815, 0.01426982693374157, -0.04548591375350952, -0.02913142926990986, 0.0136713283136487, 0.003385889809578657, 0.006482616998255253, 0.022487418726086617, 0.01496919710189104, 0.010134132578969002, -0.016287239268422127, 0.002484779106453061, -0.03865361213684082, -0.008123445324599743, -0.027813386172056198, 0.019205762073397636, -0.021707352250814438, 0.0022779942955821753, 0.010241728276014328, 0.012844189070165157, 0.01709420420229435, -0.014189130626618862, -0.0007846892112866044, 0.008715219795703888, 0.007652715779840946, 0.007007144391536713, -0.021209724247455597, 0.01050399150699377, 0.07375658303499222, -0.03141782805323601, -0.030072886496782303, -0.006529690232127905, -0.03085295297205448, 0.019353704527020454, -0.005756348837167025, -0.013301469385623932, -0.031068144366145134, 0.018385346978902817, -0.00443158159032464, 0.01705385558307171, -0.014256377704441547, -0.005988351069390774, 0.0066305603832006454, -0.0005367156118154526, -0.03564094379544258, 0.011882556602358818, 0.018681233748793602, 0.014767455868422985, 0.02470657229423523, 0.009286819957196712, -0.00975754950195551, -0.014216029085218906, 0.023805461823940277, 0.012366735376417637, 0.0027083754539489746, 0.0017921342514455318, -0.005716000683605671, 0.03851911798119545, 0.008950584568083286, -0.01214481983333826, -0.057993870228528976, 0.026374299079179764, -0.013099728152155876, -0.01125715859234333, -0.006600299384444952, 0.01659657619893551, -0.01023500319570303, 0.009952565655112267, 0.0005963973817415535, -0.0010540977818891406, -0.032197896391153336, 0.005379765294492245, 0.006260701920837164, 0.018345000222325325, 5.526867971639149e-05, 0.01968993991613388, 0.02406099997460842, 0.03295106068253517, 0.0001757880236255005, -0.04414097219705582, 0.02676433138549328, 0.002812608378008008, -0.0014743919018656015, -0.01631413772702217, -0.002743680262938142, 0.02100798301398754, -0.011835483834147453, 0.0080898217856884, -0.035345058888196945, 0.013099728152155876, -0.0202817153185606, 0.01349648553878069, 0.03198270499706268, -0.044786546379327774, 0.003960852045565844, 0.001555928960442543, 0.018950222060084343, 0.03574854135513306, -0.01381254754960537, 0.005860581528395414, -0.007457699626684189, -0.016704170033335686, -0.0077737607061862946, 0.010315699502825737, -0.030099786818027496, -0.0067415181547403336, 0.026549141854047775, -0.005141037981957197, -0.011687539517879486, 0.0069466219283640385, -0.0323592871427536, -0.016919361427426338, -0.005662202835083008, 0.01974373869597912, 0.023038843646645546, 0.014848152175545692, -0.02014722116291523, 0.009811346419155598, -0.030368775129318237, 0.0046064238995313644, 0.0451362282037735, 0.02287745103240013, 0.004293724894523621, -0.02146526239812374, 0.015924105420708656, -0.026038063690066338, -0.009407863952219486, 0.008984208106994629, -0.007740137167274952, 0.002580606145784259, 0.017430439591407776, 0.014323624782264233, -0.011156287975609303, 0.006633922923356295, -0.027678892016410828, -0.03596372902393341, -0.00014647250645793974, 0.016515878960490227, -0.019676491618156433, -0.00530915567651391, 0.012575200758874416, 0.01201032567769289, -0.0205103550106287, -0.0016794954426586628, -0.01713455282151699, 0.004993094597011805, 0.012864363379776478, -0.02913142926990986, 0.02579597383737564, 0.006331311073154211, 0.005500809755176306, 0.01151269767433405, -0.0003438006096985191, 0.01328802015632391, -0.001252476591616869, -0.0016492342110723257, -0.010295525193214417, 0.0039036921225488186, -0.011727888137102127, 0.019246110692620277, 0.01010050904005766, -0.025083154439926147, -0.0017265684437006712, 0.026925723999738693, -0.01262899860739708, -0.021667003631591797, -0.0033539473079144955, -0.00416931789368391, 0.014323624782264233, 0.02794788032770157, 0.00036649650428444147, 0.01677141711115837, -0.014982646331191063, 0.0002109876659233123, 0.01378564815968275, -0.027463700622320175, 0.01531888172030449, 0.014686758629977703, -0.009663403034210205, 0.061974894255399704, 0.005430200602859259, 0.03230549022555351, -0.002045992063358426, -0.034349799156188965, 0.014848152175545692, -0.012750043533742428, 0.016757968813180923, -0.007847732864320278, 0.03254757821559906, -0.0029908132273703814, 9.693033643998206e-05, 0.02115592733025551, 0.028189970180392265, 0.004202941432595253, -0.013160250149667263, 0.005127588752657175, -0.02921212464570999, 0.013093003071844578, -0.00569918891415, 0.004703931976109743, 0.0232405848801136, -0.013604081235826015, 0.017161451280117035, -0.008459680713713169, -0.004525727592408657, -0.004387870896607637, -0.038492221385240555, 0.023307831957936287, 0.007397177163511515, -0.012474330142140388, 0.03198270499706268, 0.019447851926088333, 0.006361572537571192, 0.012366735376417637, 0.02907763049006462, 0.016475530341267586, 0.006398558150976896, -0.004233202897012234, 0.015076791867613792, -0.01506334263831377, 0.03313935175538063, 0.007282857317477465, 0.027194712311029434, 0.035667844116687775, 0.010927648283541203, 0.0003723806294146925, 0.03779285028576851, 0.0031337132677435875, 0.012931610457599163, -0.007531671319156885, -0.028189970180392265, 0.02196289226412773, -0.017376640811562538, 0.032789669930934906, 0.008130170404911041, 0.04002545401453972, 0.024625875055789948, -0.007323205471038818, 0.01690591126680374, -0.015614768490195274, 0.009676852263510227, 0.005366315599530935, -0.018452594056725502, 0.016932811588048935, 0.005241908598691225, -0.0010751124937087297, -0.014162232168018818, -0.033273845911026, 0.0103694973513484, -0.023079192265868187, 0.007108014542609453, -0.0007006303640082479, -0.023361630737781525, -0.008735394105315208, 0.04037513956427574, 0.028862440958619118, 0.006035424303263426, 0.019568895921111107, 0.0103694973513484, -0.02287745103240013, 0.013247671537101269, -0.009327167645096779, 0.0069533465430140495, 0.0023771836422383785, -0.027732688933610916, -0.017887718975543976, 0.03354283422231674, 0.004616511054337025, -0.02224532887339592, 0.005379765294492245, 0.004377783741801977, -0.013745300471782684, -0.01749768666923046, 0.07434835284948349, 0.0005287300446070731, 0.02398030273616314, -0.018022213131189346, 0.007424076087772846, -0.0271140169352293, 0.017174899578094482, -0.03459189087152481, -0.03230549022555351, 0.032924164086580276, -0.0033539473079144955, -0.0006098468438722193, -0.0080898217856884, 0.000479135342175141, 0.03741626814007759, -0.01496919710189104, -0.0002696187002584338, 0.01251467876136303, 0.002098108408972621, -0.02451827935874462, 0.014363973401486874, -0.02789408341050148, 0.013825996778905392, -0.0323592871427536, 0.013852895237505436, 0.0032009603455662727, 0.009421314112842083, 0.012602100148797035, -0.02880864217877388, 0.0011877513024955988, 0.013348542153835297, 0.011001619510352612, -0.000565295631531626, -0.00658685015514493, -0.015076791867613792, 0.006274151150137186, -0.014713658019900322, 0.000845631817355752, -0.005107414443045855, 0.019716840237379074, 0.01787427067756653, -0.016932811588048935, -0.009676852263510227, -0.006223715841770172, 0.02201668918132782, -0.03440359979867935, 0.008742118254303932, 0.016058599576354027, -0.028001677244901657, -0.013415789231657982, 0.008325186558067799, 0.023872708901762962, -0.008668147027492523, -0.010497266426682472, 0.02556733414530754, -0.009011106565594673, 0.004465205129235983, 0.04134349524974823, 0.021398015320301056, 0.04381818696856499, 0.018170157447457314, -0.018560189753770828, 0.030368775129318237, 0.0037557485047727823, 0.008278113789856434, 0.010187930427491665, -0.014068085700273514, 0.017309393733739853, 0.013079553842544556, 0.012507953681051731, 0.025096604600548744, 8.059140236582607e-05, 0.021411465480923653, -0.01964959315955639, 0.01795496605336666, -0.025903569534420967, 0.006435544230043888, -0.006697807461023331, 0.014283276163041592, 0.01959579437971115, -0.012198617681860924, -0.009905492886900902, -0.011324405670166016, 0.000907835375983268, -0.004502191208302975, 0.04037513956427574, 0.016811765730381012, 0.028835540637373924, 0.0021367755252867937, -0.010113958269357681, 0.03243998438119888, -0.012117921374738216, 0.033623531460762024, 0.03176751360297203, -0.017928067594766617, 0.007592193782329559, -0.0007090362487360835, -0.01621999219059944, 0.008701770566403866, -0.02315988950431347, 0.005716000683605671, 0.0149288484826684, 0.0038061838131397963, -0.01456571463495493, 0.026374299079179764, 0.02480071783065796, 0.0341884084045887, -0.01791461743414402, -0.006754967849701643, 0.016488980501890182, -0.004381146281957626, 0.0017551484052091837, -0.02137111686170101, -0.02211083471775055, 0.0019585706759244204, -0.04169318079948425, -0.013987389393150806, 0.005584868602454662, 0.01787427067756653, -0.012541577219963074, 0.007780485320836306, -0.023173337802290916, -0.02333473227918148, -0.016973158344626427, 0.004861962981522083, 0.025728726759552956, 0.015372678637504578, 0.02862035110592842, 0.03499537333846092, -0.029158327728509903, 0.011055417358875275, -0.018533291295170784, 0.0014121884014457464, 0.037120379507541656, -0.018856076523661613, 0.00720216054469347, -0.04562040790915489, 0.02808237448334694, -0.014875050634145737, -0.00682557700201869, 0.0027705791871994734, -0.0009717200882732868, 0.006559951230883598, 0.01189600583165884]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" 2018) can yield accurate reward assessments.
This may illustrate the advantage of the most popular RLHF framework used by Ouyang et al. (2022); Bai
et al. (2022); Touvron et al. (2023), in contrast to the idea of bypassing reward modeling (Rafailov et al.,
2023; Zhao et al., 2023; Azar et al., 2023) and training based only on the offline dataset.
5 Implementations of GSHF
In this section, we discuss how to practically implement the information-theoretical Algorithm 1 and Al-
gorithm 2. From a high level, the GSHF framework can be implemented by combining many existing
algorithms to approximate the computational Oracle 1. Notable examples include PPO, DPO, and InfoNCA
(Chen et al., 2024). Here, we focus on the PPO and DPO and discuss several popular ways to implement it.
In practice, the policy is represented by a deep neural network. In this case, one common choice (Ziegler
et al., 2019; Wu et al., 2021a; Ouyang et al., 2022; Bai et al., 2022) is to use the standard deep RL algorithms
like PPO to optimize the regularized reward:
er(x, a) =r(x, a)−ηlogπθ(a|x)
π0(a|x).
However, PPO is significantly less stable and sensitive to implementation as compared to SFT (Choshen
et al., 2019; Engstrom et al., 2020). Recently, another line of work considers a family of algorithms that
directly learn from the preference data without reward modeling, including the DPO (Rafailov et al., 2023),
SLIC (Zhao et al., 2023), IPO (Azar et al., 2023). These algorithms attracted significant attention due to
16
its stability and easy implementation. We use the DPO as a representative example here. Specifically, DPO
chooses to train the LLM as a reward model, by optimizing the following loss:
X
(x,aw,al)∈Doff−h
logσ
ηlogπθ(aw|x)
π0(aw|x)−ηlogπθ(al|x)
π0(al|x)i
, (8)
where aw,alis the chosen/rejected response. It is shown that the optimal policy for the DPO loss in
Equation (8) is identical to the one for the RLHF objective πrwhen ris the MLE (Azar et al., 2023). To fit
the DPO into the GSHF framework, we generalize this result to incorporate the pessimism.
5.1 Direct Preference Learning with Pessimism
For notation simplicity, we denote the uncertainty bonus as Γ( x, y) and omit the dependency on νandDoff.
Then, we have the following proposition.
Proposition 1 (Direct Preference Learning with Pessimism) .Given the preference dataset Doff, we can
implement Option II of Algorithm 1 by minimizing the following loss function:
LDoff(θ, π0) =X
(x,aw,al)∈Dofflogσ
ηlogπθ(aw|x)
π0(aw|x)−ηlogπθ(al|x)
π0(al|x)+ (Γ( x, aw)−Γ(x, al))| {z }
m(x,aw,al)
, (9)
where ywis preferred over yl.
Intuitively, we add an adaptive margin for each preference pair ( x, aw, al) according to their uncertainty
difference. We defer the proof to Appendix C.2.
Uncertainty Estimation via Ensemble. The uncertainty estimation for the general neural network is
still an open problem. In practical applications, we typically resort to heuristic methods. For instance, Coste
et al. (2023) uses the idea of ensemble to get the pessimistic reward model. Specifically, they independently
train 5 reward models {ri}5
i=1and subtract the variance:
ˆr(x, a) :=1
55X
i=1ri(x, a)−λ1
55X
i=1 
ri(x, a)−1
55X
j=1rj(x, a)2.
It is shown that such a pessimistic version of the reward model can significantly reduce the reward over-
optimization for PPO and best-of-n sampling (Nakano et al., 2021).
5.2 Enhancer Explores with Variants of Main Agent Policy
For the online exploration","[-0.025467194616794586, -0.008191242814064026, 0.049570318311452866, 0.012065202929079533, 0.03475651517510414, -0.006585049908608198, -0.01640976592898369, 0.0428045280277729, -0.007754740305244923, 0.02749965898692608, 0.05420815572142601, -0.027404174208641052, -0.013586141169071198, 0.0011441140668466687, 0.004412767477333546, -0.015400354750454426, 0.038548629730939865, -0.040949393063783646, 0.018414949998259544, 0.03186468407511711, -0.012624471448361874, -0.00982812698930502, -0.011103533208370209, 0.032546717673540115, -0.00812985934317112, -0.02486700378358364, 0.016096031293272972, 0.04539626091718674, 0.027676988393068314, -0.030446050688624382, 0.041031237691640854, -0.025562679395079613, 0.0031117855105549097, -0.018605919554829597, 0.008593643084168434, 0.02870004065334797, -0.0013427567901089787, 0.059746284037828445, -0.008334469981491566, 0.0149092897772789, 0.02897285483777523, -0.046405673027038574, -0.034865640103816986, 0.03879416361451149, 0.001561860553920269, 0.04122220724821091, 0.04905197024345398, -0.028781885281205177, 0.009746283292770386, 0.0007374505512416363, -0.06596644222736359, 0.05251671001315117, -0.030282363295555115, -0.02635383978486061, 0.017296412959694862, -0.012140226550400257, 0.024757876992225647, -0.007038603071123362, 0.042449869215488434, -0.0149092897772789, -0.004290001466870308, -0.016437048092484474, 0.017691992223262787, 0.039476197212934494, 0.018278542906045914, 0.005920065566897392, -0.07687900960445404, 0.028672760352492332, -0.021456826478242874, 0.04482335224747658, -0.0010085594840347767, -0.021661438047885895, 0.07033146917819977, -0.03669349476695061, -0.012058381922543049, 0.0042115673422813416, 0.05679989233613014, 0.032764971256256104, 0.03243759274482727, -0.03260128200054169, -0.01007365994155407, 0.0027741780504584312, 0.010482881218194962, -0.034101758152246475, -0.006489564664661884, -0.044686947017908096, -0.05546310171484947, -0.0153048699721694, -0.07093165814876556, -0.023898513987660408, -0.0012029395438730717, -0.006666894070804119, -0.023571135476231575, 0.01205156184732914, 0.02282089740037918, -0.031046241521835327, -0.01597326435148716, 0.02183876745402813, 0.04616014286875725, -0.009698540903627872, -0.027090437710285187, -0.04678761586546898, 0.016055108979344368, -0.0027315509505569935, 0.050770699977874756, 0.02968217246234417, -0.031619150191545486, 0.02714500017464161, -0.022861819714307785, 0.018674124032258987, -0.07595144212245941, -0.029000137001276016, -0.052543990314006805, 0.032683126628398895, -0.01957440935075283, -0.06072841212153435, -0.08097121864557266, 0.022807257249951363, 0.030282363295555115, 0.02444414049386978, -0.04806984215974808, -0.020952120423316956, 0.01746010035276413, 0.022507160902023315, 0.010619288310408592, 0.0021773972548544407, -0.0008448711014352739, -0.07573318481445312, -0.018264902755618095, -0.019560769200325012, -0.006155367475003004, 0.030773427337408066, -0.019315237179398537, -0.05794570967555046, -0.03898513317108154, 0.009637157432734966, -0.01010776124894619, 0.010094121098518372, -0.021784204989671707, -0.01632792316377163, -0.025480834767222404, -0.04509616643190384, -0.05497203767299652, -0.0037546036764979362, -0.052543990314006805, 0.010810257866978645, -0.015318510122597218, -0.015291228890419006, -0.04220433905720711, 0.04847906157374382, 0.007318237796425819, -0.008177601732313633, -0.027049515396356583, 0.0035465830005705357, -0.004562815651297569, -0.044414132833480835, -0.026613013818860054, 0.025617241859436035, 0.015550401993095875, -0.05838221311569214, -0.00353294238448143, 0.07475105673074722, -0.013211022131145, -0.0005507434252649546, 0.06563906371593475, 0.027895240113139153, -0.045969173312187195, 0.009882690384984016, -0.05437184497714043, -0.01773291453719139, -0.006861274130642414, -0.038766879588365555, -0.03189196437597275, -0.013981721363961697, 0.0052721318788826466, -0.013565680012106895, -0.020529258996248245, 0.01859227940440178, 0.00515959644690156, -0.037975721061229706, 0.002552516758441925, 0.03167371451854706, -0.0021756922360509634, 0.009405265562236309, 0.0030896193347871304, -0.0013214432401582599, 0.017705634236335754, -0.020092757418751717, 0.004208157304674387, 0.045696359127759933, 0.024635111913084984, 0.04967944324016571, 0.03159186989068985, -0.008859637193381786, 0.005463101901113987, -0.01049652136862278, 0.06569363176822662, 0.04970672354102135, 0.005023189354687929, -0.00074427091749385, -0.002578092971816659, 0.02572636678814888, 0.010960305109620094, -0.07573318481445312, 0.026749420911073685, -0.016355203464627266, 0.014009002596139908, -0.004504842218011618, -0.002252421109005809, 0.012917746789753437, 8.290990081150085e-05, -0.0042013367637991905, 0.05306233838200569, 0.018251262605190277, -0.002562747336924076, 0.014404583722352982, -0.008327649906277657, 0.043650250881910324, 2.8133952582720667e-05, 0.06225617229938507, -0.013374710455536842, 0.009548492729663849, 0.0106056472286582, 0.02621743269264698, -0.03265584632754326, -0.005336925387382507, 0.026735778898000717, -0.02126585692167282, 0.02699495293200016, -0.0466512069106102, 0.0293275136500597, 0.03541126847267151, -0.022670850157737732, -0.0062338015995919704, 0.007672896143049002, -0.008880098350346088, 0.03235574811697006, 0.006083753891289234, 0.03167371451854706, -0.06329286843538284, 0.02642204426229, 0.030336925759911537, 0.02670849859714508, -0.0353294238448143, 0.016450688242912292, 0.03284681588411331, -0.01675078459084034, -0.024703314527869225, -0.009957714006304741, -0.023557495325803757, 0.014500068500638008, -0.0049072434194386005, -0.003597735660150647, -0.0424225889146328, -0.04493247717618942, -0.004228617995977402, 0.014377301558852196, 0.0013342313468456268, -0.03123721107840538, -0.008013913407921791, -0.014813804067671299, 0.0022353704553097486, 0.02910926192998886, 0.014854726381599903, 0.0015413995133712888, -0.004982267040759325, -0.0333651602268219, -0.017896603792905807, -0.03131905570626259, 0.01928795501589775, -0.00019938872719649225, 0.023421088233590126, -0.022029737010598183, 0.03767562285065651, -0.03519301488995552, -0.024539627134799957, 0.019683536142110825, 0.05308961868286133, -0.05723639205098152, 0.02007911540567875, -0.02968217246234417, -0.0003893994726240635, 0.03505660966038704, -0.006158777978271246, 0.0637839287519455, 0.016096031293272972, 0.0022114990279078484, -0.011690082959830761, -0.015413994900882244, -0.00812303926795721, -0.007072704844176769, -0.02466239221394062, 0.0254399124532938, -0.039967261254787445, 0.04602373391389847, 0.01180602889508009, -0.005384667776525021, -0.02091119810938835, 0.03811212629079819, 0.012897285632789135, 0.045669075101614, -0.017828399315476418, -0.03151002526283264, 0.0056404308415949345, 0.02197517454624176, -0.01816941797733307, 0.03074614703655243, 0.011785567738115788, 0.012985950335860252, -0.007168190088123083, -0.001058007124811411, 0.005694993771612644, -0.011703724041581154, 0.050770699977874756, -0.017350975424051285, -0.0028730733320116997, 0.05936434492468834, -0.026203792542219162, 0.0015865843743085861, -0.03622971102595329, -0.042504433542490005, -0.03462010622024536, 0.006503205746412277, -0.0055585866793990135, 0.012665393762290478, -0.03492020070552826, 0.026913108304142952, -0.01085118018090725, -0.038057561963796616, 0.0012924566399306059, 0.005507434252649546, -0.007516027893871069, 0.03341972455382347, 0.0015882895095273852, 0.009084708988666534, -0.026599371805787086, -0.03743009269237518, 0.035302139818668365, 0.045696359127759933, -0.02021552249789238, -0.06880371272563934, -0.013940799050033092, -0.03977629169821739, -0.008927840739488602, -0.030200518667697906, 0.026803983375430107, 0.014704679138958454, 0.04771518334746361, 0.02557631954550743, 0.036939024925231934, -0.0061519574373960495, -0.025958258658647537, 0.012037920765578747, 0.006963579449802637, -0.0009710476151667535, 0.01336106937378645, -0.007175010163336992, -0.04528713598847389, -0.04291365295648575, 0.00019544571114238352, -0.047878868877887726, 0.009637157432734966, 0.0013870890252292156, 0.020761150866746902, 0.039530761539936066, 0.021784204989671707, 0.010823898948729038, 0.009869049303233624, -0.006660073529928923, -0.0048595005646348, -0.006915837060660124, 0.04711499065160751, -0.039694447070360184, 0.005166416522115469, -0.03944891691207886, 0.001237893826328218, 0.030446050688624382, -0.002134770154953003, 0.013647524639964104, 0.016068749129772186, -0.01710544340312481, 0.007024962455034256, -0.06307461112737656, -0.037348248064517975, 0.01413176953792572, -0.004688992165029049, -0.02685854583978653, -0.0306097399443388, -0.03314691036939621, -0.0007110217120498419, 0.037921156734228134, -0.036993589252233505, -0.05860046297311783, 0.02601282298564911, -0.05598144978284836, -0.017541944980621338, -0.04517801105976105, 0.04253171384334564, 0.05213477090001106, 0.03920338302850723, -0.06056472659111023, -0.0067657888866961, -0.041031237691640854, 0.0029515072237700224, -0.04460510239005089, 0.01590505987405777, 0.005684763193130493, 0.032273903489112854, -0.015359432436525822, 0.04146774113178253, 0.01452734973281622, 0.004740144591778517, 0.03080070950090885, -0.05213477090001106, -0.01544127706438303, -0.020229164510965347, 0.030691584572196007, 0.008027554489672184, 0.02628563717007637, 0.05060701072216034, 0.042013369500637054, -0.04029463976621628, 0.011901513673365116, -0.019315237179398537, -0.019028780981898308, 0.0042558996938169, 0.029245669022202492, -0.01930159516632557, 0.016205156221985817, -0.04670577123761177, -0.0057734278962016106, 0.046323832124471664, 0.030200518667697906, -0.03868503496050835, -0.04940662905573845, 0.014513708651065826, 0.017569227144122124, -0.021224934607744217, -0.002717910334467888, -0.02254808321595192, 0.06296548992395401, -0.006281543988734484, -0.018142135813832283, 0.0010972240706905723, -0.024839721620082855, -0.014322739094495773, -0.04217705503106117, -0.00740008195862174, -0.005705224350094795, -0.006591869983822107, -0.024703314527869225, 0.016573455184698105, 0.06803983449935913, -0.004392306786030531, -0.018333105370402336, -0.04026735946536064, 0.09079252183437347, 0.014445505104959011, 0.0353294238448143, 0.006315645761787891, 0.023298321291804314, 0.009268858470022678, -0.028536353260278702, -0.013033692725002766, 0.03740280866622925, 0.022316191345453262, -0.020829355344176292, -0.022029737010598183, -0.0408402681350708, 0.04725139960646629, -0.03003682941198349, -0.02820897474884987, 0.008893738500773907, -0.025890056043863297, -0.002987314248457551, -0.0038432683795690536, 0.015809575095772743, -0.0005477595259435475, 0.04771518334746361, -0.007638794369995594, 0.020870277658104897, -0.03159186989068985, -0.0013453144347295165, 0.009630337357521057, 0.05137088894844055, 0.0398581363260746, 0.0686945840716362, -0.021184012293815613, -0.0017383372178301215, 0.01099440734833479, 0.018046651035547256, -0.031700994819402695, 0.03142818063497543, -0.01568681001663208, 0.0048970128409564495, -0.010203246027231216, 0.02232983149588108, -0.01417269092053175, -0.01430909801274538, -0.0001496214681537822, 0.0680943951010704, -0.01675078459084034, -0.030282363295555115, 0.030336925759911537, -0.0022592416498810053, 0.023066429421305656, 0.0035431727301329374, -0.05142545327544212, -0.01739189773797989, 0.02692675031721592, -0.017487382516264915, -0.002506479388102889, -0.04386850446462631, 0.026544809341430664, 0.015932342037558556, 0.009568953886628151, -0.02820897474884987, -0.023762106895446777, 0.0034545082598924637, 0.01872868649661541, -0.014049924910068512, -0.003104965202510357, -0.03260128200054169, 0.019247032701969147, 0.010005456395447254, 0.012372118420898914, -0.012842722237110138, -0.0846269279718399, -0.01660073734819889, -0.031073523685336113, 0.02799072489142418, -0.034238167107105255, 0.013122357428073883, 0.015154821798205376, -0.010660209693014622, 0.0013240007683634758, -0.02677670121192932, -0.032546717673540115, 0.01216068770736456, -0.011881053447723389, 0.011233119294047356, -0.01986086554825306, -0.00797981210052967, 0.02396671660244465, 0.0056506614200770855, -0.04198608547449112, 0.023407448083162308, 0.0020188242197036743, -0.012249352410435677, 0.013811212964355946, 0.0022387804929167032, -0.03732096403837204, -0.025180738419294357, -0.012467603199183941, -0.054590098559856415, 0.007284136023372412, 0.0097190011292696, 0.014227254316210747, 0.01286318339407444, -0.0033607285004109144, 0.003151002572849393, -0.006997681222856045, -0.017269130796194077, 0.042368024587631226, -0.024471422657370567, 0.021565953269600868, 0.008668667636811733, 0.018960578367114067, 0.008088937029242516, 0.026763061061501503, -0.028154412284493446, 0.03039148822426796, 0.03519301488995552, -0.04255899786949158, 0.02324375882744789, 0.0051732370629906654, -0.009248397313058376, -0.01378393080085516, 0.032110217958688736, 0.05772745981812477, -0.016423407942056656, -0.0317828394472599, -0.01822398044168949, -0.018783248960971832, -0.032055653631687164, 0.015168462879955769, -0.003717091865837574, 0.03571136295795441, -0.046896740794181824, 0.005210748873651028, 0.03879416361451149, -0.023271040990948677, -0.006871504709124565, -0.013320147059857845, -0.05535397678613663, -0.012126585468649864, 0.014854726381599903, 0.003863729303702712, 0.014036283828318119, -0.02359841763973236, 0.04970672354102135, -0.009609876200556755, 0.02614923007786274, -0.01916518807411194, -0.03598417714238167, 0.022507160902023315, 0.0052619013004004955, 0.009984995238482952, 0.0153048699721694, -0.007522847969084978, -0.021184012293815613, 0.008075296878814697, 0.02295730449259281, -0.05066157504916191, -0.057782020419836044, -0.04086754843592644, -0.00336584378965199, 0.017091801390051842, 0.07344155013561249, -0.0022899331524968147, -0.02684490568935871, -0.00515959644690156, 0.028918292373418808, -0.0068374029360711575, -0.00558245787397027, -0.013040512800216675, -0.02451234497129917, -0.013026872649788857, 0.008163961581885815, -0.030991679057478905, -0.019110625609755516, 0.002226844895631075, -0.008013913407921791, 0.012358477339148521, -0.01346337515860796, 0.006407720502465963, -0.009841768071055412, -0.0019165189005434513, 0.0016488201217725873, -0.04602373391389847, 0.016355203464627266, 0.014540989883244038, -0.004764015786349773, -0.037621062248945236, 0.03088255412876606, 0.01073523424565792, -0.0002617310092318803, 0.00038343167398124933, -0.003108375472947955, -0.04168599098920822, -0.01915154792368412, -0.00439912686124444, 0.023652980104088783, -0.005084572359919548, 0.023639339953660965, 0.02741781435906887, 0.029382076114416122, 0.015032055787742138, -0.00875733233988285, -0.012917746789753437, -0.030909834429621696, -0.0004919178900308907, -0.0029634428210556507, 0.01808757334947586, 0.018073933199048042, 0.03781203180551529, 0.012638112530112267, 0.059691719710826874, 0.009105170145630836, -0.013224662281572819, -0.029027417302131653, 0.002625835593789816, 0.035383984446525574, -0.00575637724250555, -0.02078843303024769, -0.0375937782227993, -0.012344837188720703, -0.05251671001315117, -0.02790888026356697, -0.00370004097931087, 0.0062338015995919704, 0.005207338836044073, -0.035302139818668365, -0.002322329906746745, -0.011956077069044113, -0.011137634515762329, 0.020747510716319084, -0.034729231148958206, -0.004828809294849634, -0.014104487374424934, -0.018128495663404465, 0.007202291861176491, 0.01338835060596466, -0.02247988060116768, 0.01544127706438303, 0.02085663564503193, 0.022779975086450577, 0.04817896708846092, -0.0262310728430748, -0.0787341445684433, -0.02466239221394062, 0.03355612978339195, -0.003253307892009616, 0.00745464488863945, -0.03988541662693024, -0.026981312781572342, -0.03412904217839241, 0.06700313836336136, 0.03824853524565697, -0.04195880517363548, -0.007297776639461517, -0.03453826159238815, -0.0048151686787605286, 0.0405401736497879, 0.003198744961991906, 0.010837539099156857, 0.058818716555833817, 0.030282363295555115, 0.026053745299577713, -0.02359841763973236, -0.03429272770881653, -0.0061417268589138985, -0.030091391876339912, 0.018551357090473175, -0.020174600183963776, -0.017623789608478546, -0.05860046297311783, -0.005323284771293402, -0.036147866398096085, -0.022875459864735603, 0.0033146911300718784, -0.00512208417057991, -0.0021313598845154047, -0.010189605876803398, -0.006595280487090349, 0.032464876770973206, -0.02205701731145382, -0.008348111063241959, 0.006298595108091831, -0.029136544093489647, 0.02897285483777523, 0.0031595281325280666, -0.02198881469666958, -0.008716410025954247, -0.009173373691737652, 0.0018261491786688566, 0.025562679395079613, 0.031046241521835327, -0.001308655017055571, 0.02684490568935871, -0.0073250578716397285, 0.01272677630186081, -0.023993998765945435, -0.0028526121750473976, 0.02001091279089451, 0.001363217830657959, -0.009337062016129494, -0.01994270831346512, -0.014500068500638008, -0.011219479143619537, 0.0010895512532442808, 0.020815713331103325, -0.03620242699980736, 0.008389032445847988, -0.01519574411213398, -0.0144182238727808, -0.036284271627664566, -0.03412904217839241, 0.02430773340165615, 0.010264629498124123, 0.02021552249789238, 0.007195471320301294, -0.008177601732313633, 0.018360387533903122, 0.05810939893126488, -0.020106397569179535, 0.006407720502465963, -0.01610967144370079, -0.0015942573081701994, -0.0030299413483589888, -0.00968489982187748, -0.03745737299323082, 0.0036932206712663174, -0.008825534954667091, -0.013047332875430584, -0.0035909153521060944, 0.002912290161475539, -0.00997135415673256, -0.0005993384402245283, -0.04247715324163437, -0.02027008682489395, 0.009657618589699268, -0.026381121948361397, -0.03773018717765808, 0.00588255375623703, 0.05265311524271965, -0.03541126847267151, -0.11305415630340576, -0.017119083553552628, 0.036011457443237305, 0.003384599694982171, 0.007441003806889057, -0.022452598437666893, 0.02119765430688858, 0.019124267622828484, 0.006322466302663088, -0.037975721061229706, -0.0006880030268803239, -0.021443186327815056, 0.02288910187780857, -0.0007310564978979528, 0.00865502655506134, -0.04782430827617645, 0.011212658137083054, -0.012788159772753716, 0.01480016391724348, -0.004924294073134661, -0.004440049175173044, -0.02212522178888321, 0.018701404333114624, -0.0013299686834216118, -0.05821852385997772, 0.0032771790865808725, 0.021797845140099525, -0.017610149458050728, -0.023298321291804314, 0.011171736754477024, -0.031073523685336113, -0.025876415893435478, 0.00582799082621932, -0.014240894466638565, -0.057618334889411926, -0.0037511936388909817, 0.011731005273759365, 0.009473469108343124, -0.019096985459327698, 0.02839994616806507, 0.02856363356113434, -0.028318101540207863, 0.058273088186979294, -0.02741781435906887, 0.014118128456175327, -0.034865640103816986, 0.003587505081668496, -0.002301868749782443, 0.0028492019046097994, 0.0035670441575348377, 0.018033010885119438, -0.0015439571579918265, 0.00040986051317304373, -0.016300641000270844, -0.00338289444334805, 0.007290956098586321, 0.024716954678297043, 0.05434456467628479, -0.02177056297659874, -0.007618333213031292, -0.03478379547595978, 0.06323830038309097, 0.02763606607913971, -0.0160414669662714, -0.03696630895137787, 0.0024979538284242153, -0.004903832916170359, 0.00812303926795721, -0.03895784914493561, -0.041522301733493805, -0.03311963006854057, -0.021947892382740974, -0.012958669103682041, 0.029136544093489647, -0.005398308392614126, -0.012378938496112823, 0.025071613490581512, 0.03497476503252983, -0.02594461850821972, 0.004102441482245922, 0.03644796088337898, -0.0515618622303009, 0.028536353260278702, 0.019110625609755516, 0.006022370886057615, 0.042013369500637054, 0.03358341380953789, -0.022807257249951363, -0.0009983290219679475, 0.007161369547247887, 0.014636475592851639, -0.022288909181952477, 0.013347428292036057, -0.0022899331524968147, 0.018496794626116753, -0.054453689604997635, -0.030282363295555115, 0.02232983149588108, 0.026176510378718376, -0.0013214432401582599, 0.04673305153846741, 0.036857180297374725, -0.004402537364512682, -0.007645614445209503, 0.02091119810938835, -0.008532260544598103, -0.01582321710884571, 0.009903150610625744, 0.0051732370629906654, 0.0061519574373960495, -0.011287682689726353, 0.032901376485824585, -0.004187696147710085, 0.0003527400840539485, -0.009398444555699825, 0.02430773340165615, 0.047878868877887726, 0.021115809679031372, -0.013763470575213432, 0.027117719873785973, 0.013204201124608517, 0.023080071434378624, -0.01590505987405777, 0.016846269369125366, 0.014963852241635323, -0.01480016391724348, 0.0016880370676517487, 0.022930022329092026, -0.020379211753606796, 0.019069703295826912, 0.030118674039840698, 0.010482881218194962, 0.018633201718330383, 0.00628836452960968, -0.010366935282945633, 0.030364206060767174, 0.03202837333083153, -0.007768380921334028, -0.03399263322353363, 0.0019727868493646383, 0.020597463473677635, -0.004982267040759325, -0.013429272919893265, 0.006257672794163227, -0.016805347055196762, 0.035929612815380096, 0.03295594081282616, -0.03039148822426796, -0.021006684750318527, 0.02488064393401146, 0.019465284422039986, -0.03620242699980736, 0.008982403203845024, -0.013395171612501144, 0.019110625609755516, 0.025617241859436035, 0.03350156918168068, -0.004344564396888018, 0.001904583303257823, -0.005916655529290438, 0.0007992599857971072, 0.02537170983850956, -0.013824853114783764, -0.015850497409701347, 0.02976401522755623, -0.015509480610489845, -0.004658300429582596, -0.00044502795208245516, 0.011928795836865902, -0.0015456622932106256, -0.027404174208641052, -0.07022234052419662, 0.01773291453719139, 0.016382485628128052, 0.03221934288740158, 0.014186332002282143, -0.006492975167930126, 0.028672760352492332, -0.012945028021931648, 0.030227798968553543, 0.0069397082552313805, 0.01793752610683441, 0.01036011427640915, -0.009036966599524021, 0.048942845314741135, -0.027936162427067757, 0.005463101901113987, -0.026176510378718376, 0.002368367277085781, 0.019274314865469933, 0.013558859936892986, 0.024225890636444092, -0.0020188242197036743, 0.022943664342164993, 0.0010631224140524864, 0.014568272046744823, -0.015345792286098003, 0.02839994616806507, 0.005309644155204296, -0.08299004286527634, -0.06509343534708023, 0.046814896166324615, 0.016846269369125366, -0.02297094464302063, -0.023230118677020073, 0.03295594081282616, 0.0032226163893938065, -0.02792252041399479, 0.0057631973177194595, 0.022370753809809685, -0.009398444555699825, -0.0002941276761703193, -0.015318510122597218, 0.02297094464302063, -0.011048969812691212, -0.015359432436525822, -0.012815441004931927, 0.014513708651065826, -0.024212248623371124, -0.016587095335125923, -0.010189605876803398, -0.04078570380806923, 0.010414677672088146, -0.004020597320050001, -0.008498158305883408, -0.03088255412876606, -0.002134770154953003, -0.006700995843857527, 0.0048049381002783775, 0.011349065229296684, -0.014650115743279457, 0.02875460311770439, -0.010933023877441883, -0.00715454900637269, -0.0015277587808668613, -0.0093234209343791, -0.02035192959010601, 0.011287682689726353, 0.006192879751324654, 0.01428181678056717, 0.04719683527946472, 0.007284136023372412, -0.0018517255084589124, -0.002475787652656436, 0.03942163288593292, -0.006898785941302776, 0.027158642187714577, 0.0333651602268219, -0.013477015309035778, -0.01583685725927353, -0.013899877667427063, 0.035656798630952835, 0.011055790819227695, -0.009132451377809048, -0.010871641337871552, 0.0031134907621890306, -0.0023342655040323734, 0.024485062807798386, 0.020120037719607353, -0.0034715591464191675, -0.010182785801589489, 0.012604010291397572, -0.004982267040759325, -0.018564997240900993, 0.01495021115988493, -0.020188242197036743, 0.01625971868634224, 0.009480289183557034, 0.019383439794182777, 0.0288364477455616, -0.0048867822624742985, 0.019397081807255745, -0.01338835060596466, 0.03644796088337898, 0.008839176036417484, -0.007754740305244923, 0.0005209043738432229, -0.010012276470661163, 0.02168871834874153, -0.007822943851351738, -0.023980356752872467, 0.008716410025954247, -0.027363251894712448, 0.0037682445254176855, 0.005933706182986498, -0.011921974830329418, 0.016096031293272972, -0.010967126116156578, 0.015277588739991188, 0.02444414049386978, 0.057782020419836044, 0.021033965051174164, -0.006397489923983812, 0.004221797920763493, -0.021593233570456505, -0.020229164510965347, -0.008989224210381508, 0.016587095335125923, 0.003884190460667014, -0.010114582255482674, 0.009193834848701954, 0.001986427465453744, 0.0014979197876527905, -0.007413722574710846, 0.02063838578760624, 0.01455463096499443, 0.003272063797339797, -0.03440185636281967, -0.0217023603618145, -0.023993998765945435, -0.00823898520320654, -0.005036829970777035, -0.018742326647043228, -0.008225344121456146, 0.0010230528423562646, 0.006564588751643896, -0.001474048593081534, -0.018073933199048042, -0.03492020070552826, -0.006772609427571297, -0.009425726719200611, 0.003607966238632798, -0.00219956343062222, 0.03688446432352066, -0.02875460311770439, -0.03546582907438278, 0.014377301558852196, -0.0056711225770413876, -0.003679579822346568, 0.005486973095685244, -0.00109978171531111, 0.019683536142110825, 0.001331673702225089, -0.02861819602549076, -0.0369117446243763, -0.009418905712664127, -0.05832764878869057, -0.011881053447723389, 0.0074887461960315704, -0.01063292846083641, 0.009875869378447533, -0.0014186331536620855, 0.02875460311770439, -0.02048833668231964, -0.02599918097257614, 0.018346747383475304, -0.007522847969084978, -0.011035329662263393, 0.03074614703655243, -0.009528031572699547, 0.07093165814876556, -0.023803027346730232, -0.024703314527869225, -0.0021296548657119274, -0.0061519574373960495, 0.041031237691640854, -0.015032055787742138, -0.001931864651851356, -0.018619561567902565, 0.014854726381599903, 0.0008832355961203575, 0.037566497921943665, -0.029573045670986176, 0.004808348137885332, 0.0024280452635139227, -0.0002645017812028527, -0.01780111901462078, 0.03025508113205433, 0.003870549611747265, 0.006339516956359148, 0.011424089781939983, 0.022070659324526787, -0.0025934388395398855, -0.009521211497485638, 0.01568681001663208, -0.004266130272299051, -0.00536761712282896, -0.0022404855117201805, -0.003094734624028206, 0.03333787992596626, 0.007822943851351738, -0.04828809201717377, -0.03669349476695061, 0.014350020326673985, -0.02219342440366745, -0.002477492904290557, -0.009473469108343124, 0.036584366112947464, -0.008948301896452904, 0.003466443857178092, -0.015359432436525822, -0.0061417268589138985, -0.0008188685169443488, 0.00694652833044529, 0.01774655655026436, 0.022016096860170364, 0.004081980790942907, 0.021661438047885895, 0.014718319289386272, 0.032192062586545944, 0.009568953886628151, -0.00032972139888443053, 0.01681898720562458, -0.023830309510231018, 0.006506615784019232, 0.008088937029242516, -0.0204201340675354, 0.029927704483270645, -0.0029549174942076206, 0.011574137024581432, -0.020679306238889694, 0.007338698487728834, -0.01901514083147049, 0.013381530530750751, 0.016641657799482346, -0.03696630895137787, 0.02578093111515045, 0.027445096522569656, -0.01466375682502985, 0.05238030105829239, -0.052543990314006805, -0.00570863438770175, -0.00037554564187303185, 0.0022404855117201805, 0.0019438002491369843, 0.011499113403260708, -0.028318101540207863, 0.020406492054462433, 0.0011731005506590009, 0.02557631954550743, -0.011853771284222603, 0.02488064393401146, -0.011710544116795063, -0.0009727526921778917, -0.014486427418887615, 0.014731960371136665, 0.01886509358882904, 0.020883917808532715, -0.04174055531620979, 0.024403220042586327, -0.018046651035547256, 0.018196698278188705, 0.03440185636281967, 0.01589141972362995, -0.01374982949346304, -0.02516709826886654, 0.002245600800961256, 0.0025900285691022873, -0.0064486428163945675, 0.02290274202823639, -0.014691038057208061, 0.02303914912045002, 0.01690083183348179, 0.007932069711387157, 0.0007617480587214231, 0.017896603792905807, -0.017855681478977203, -0.004443459212779999, 0.016573455184698105, 0.01561860553920269, 0.022370753809809685, -0.004157004412263632, 0.02317555621266365, 0.0037580139469355345, -0.012515345588326454, 0.01893329620361328, 0.012167507782578468, -0.005442640744149685, 0.026190150529146194, -0.016873551532626152, -0.009377984330058098, -0.013258764520287514, -0.008586823008954525, 0.0008614956750534475, -0.01837402768433094, 0.015127540566027164, -0.004961805883795023, -0.006602100562304258, 0.00023338392202276736, 0.0032839993946254253, -0.014868367463350296, 0.024976128712296486, 0.00706588476896286, -0.0005967807956039906, -0.008027554489672184, -0.0043752556666731834, 0.016559815034270287, -0.025180738419294357, -0.009453007951378822, -0.0004382076149340719, -0.011560496874153614, 0.014963852241635323, -0.03295594081282616, 0.026108307763934135, -0.02572636678814888, -0.02331196330487728, 0.019478924572467804, -0.04806984215974808, 0.04171327129006386, 0.01452734973281622, -0.017855681478977203, 0.031619150191545486, 0.005780248437076807, 0.026599371805787086, 0.007700177375227213, -0.026094665750861168, 0.015495839528739452, -0.008464056998491287, -0.0010094121098518372, -0.0034255217760801315, 0.021115809679031372, -0.01879688911139965, 0.024566907435655594, 0.0186468418687582, 0.028181694447994232, 0.01661437749862671, -0.025276225060224533, 0.0010153799084946513, 0.002782703610137105, -0.00848451815545559, 0.02664029411971569, -0.018005728721618652, 0.015795934945344925, -0.006533897016197443, -0.013627063482999802, -0.0085117993876338, -0.007038603071123362, -0.015018414705991745, -0.017419178038835526, 0.005040240008383989, -0.019478924572467804, -0.01964261382818222, 0.047524213790893555, 0.003162938170135021, 0.012167507782578468, 0.011608239263296127, 0.024335015565156937, 0.006090574432164431, 0.010796616785228252, 0.0023325602523982525, 0.006902195978909731, -0.016641657799482346, 0.03052789531648159, -0.008716410025954247, -0.00032311415998265147, 0.03625699132680893, -0.00014237484720069915, -0.025180738419294357, 0.029081979766488075, 0.0230255089700222, -0.0014808689011260867, 0.007502387277781963, 0.02197517454624176, 0.015468558296561241, -0.03622971102595329, -0.025699086487293243, 0.011403628624975681, -0.023134633898735046, 0.028072567656636238, -0.0026821033097803593, 0.03369253873825073, 0.017200928181409836, 0.019069703295826912, 0.013211022131145, 0.02162051573395729, 0.010858000256121159, 0.00406492967158556, 0.0003299345262348652, -0.011696903966367245, -0.0068578640930354595, -0.00904378667473793, -0.021443186327815056, 0.02070658840239048, 0.016996316611766815, -0.02403492107987404, 0.01455463096499443, 0.038193970918655396, 0.024566907435655594, 0.02960032783448696, 0.013736188411712646, 0.02523530274629593, -0.04043104499578476, 0.015113899484276772, 0.00038300539017654955, 0.0071204472333192825, 0.00827308651059866, -0.010830719023942947, -0.012167507782578468, 0.0014228959335014224, -0.0051834676414728165, -0.03620242699980736, 0.024580547586083412, -0.011478652246296406, -0.009507570415735245, -0.009473469108343124, 0.0700586587190628, -0.004324103239923716, 0.004845859948545694, -0.04097667336463928, 0.006752148270606995, 0.012801800854504108, 0.026340199634432793, -0.03172827884554863, -0.0401582308113575, 0.04924293980002403, -0.017350975424051285, -0.02325740084052086, -0.013477015309035778, -0.007045423611998558, 0.037921156734228134, -0.025317145511507988, -0.0073045967146754265, 0.00879825372248888, 0.011853771284222603, -0.03647524118423462, 0.010516982525587082, -0.036775339394807816, -0.006394079886376858, 0.007822943851351738, -0.023993998765945435, -0.0036727595143020153, 0.015809575095772743, 0.0028815986588597298, -0.01695539429783821, -0.005350566003471613, 0.020883917808532715, 0.011785567738115788, 0.008007093332707882, 0.002854317193850875, -0.026271995157003403, 0.026203792542219162, -0.01495021115988493, -0.015373073518276215, 0.015986904501914978, 0.03587505221366882, 0.025835493579506874, 0.003255012910813093, -0.026203792542219162, 0.003815986914560199, 0.01204474177211523, -0.0317828394472599, 0.003519301535561681, 0.016300641000270844, -0.046760331839323044, 0.005207338836044073, 0.011840131133794785, 0.034592825919389725, -0.019451644271612167, -0.011253580451011658, 0.029218386858701706, -0.01739189773797989, -0.009255217388272285, 0.02466239221394062, 0.02013367973268032, 0.04425044357776642, -0.0010060019558295608, -0.011608239263296127, 0.007161369547247887, -0.011430909857153893, 0.02699495293200016, 0.05093438923358917, 0.01024416834115982, 0.010980766266584396, 0.04326831176877022, 0.026885828003287315, 0.015659527853131294, -0.0037546036764979362, 0.009384804405272007, -0.01887873373925686, 0.018210340291261673, -0.017541944980621338, -0.007106806617230177, 0.02650388702750206, 0.02875460311770439, 0.04457781836390495, -0.004092211369425058, -0.04100395739078522, 0.004139953758567572, 0.010155503638088703, -0.018605919554829597, 0.026653936132788658, -0.0010273155057802796, 0.02870004065334797, 0.0515618622303009, -0.005681353155523539, 0.021565953269600868, 0.0027588324155658484, 0.018851453438401222, -0.008805074729025364, -0.004726503975689411, -0.013613422401249409, 0.016518892720341682, -0.009364343248307705, 0.002005183370783925, -0.004460510332137346, -0.01625971868634224, 0.033256035298109055, -0.009869049303233624, -0.024921566247940063, -0.0024894285015761852, 0.022561723366379738, 0.02910926192998886, -0.012938207946717739, -0.01717364601790905, -0.0046924022026360035, -0.017419178038835526, 0.0019284544978290796, -0.015673168003559113, -0.022275269031524658, -0.033392444252967834, -0.04839721694588661, -0.02092484012246132, -0.0011176852276548743, 0.014513708651065826, -0.010592006146907806, 0.01879688911139965, -0.00411949260160327, -0.0041911061853170395, 0.0052857729606330395, -0.03039148822426796, 0.040321920067071915, 0.03511117026209831, 0.01477288268506527, 0.007475105579942465, -0.04283180832862854, -0.003809166606515646, -0.017214568331837654, -0.012372118420898914, 0.017719274386763573, -0.004392306786030531, -0.011158095672726631, -0.03355612978339195, 0.012931386940181255, -0.014431864954531193, -0.002117719268426299, -0.003594325389713049, -0.011683262884616852, 0.018333105370402336, -0.008580002933740616]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
", selecting an appropriate optimistic policy for the enhancer to maximize the
uncertainty with respect to the main agent π1
tis largely less explored in practical applications. To be
specific, we recall that our goal is to find an enhancer policy from the following policy subset:
eπ∈Πt={π′∈Π :η·Ex∼d0DKL(π(·|x), π1
t(·|x))| {z }
How far does the enhancer go.≤ Γm
t(λ, π1
t, π′)|{z}
How much information we can get.}.
While it is challenging to obtain the analytical solution of uncertainty, the insight here is to maximize the
policy difference with π1
t, while maintaining a moderate KL divergence. We discuss some popular heuristic
implementations here.
17
Model Variants. In the project of Claude (Bai et al., 2022), the authors choose to use the models with
different training steps as ( π1
t, π2
t). For instance, if we run PPO for 2 epoch in total, we may take π1
tas the
model saved at the end of the first epoch and take π1
tas the one saved at the end of second epoch. Moreover,
in addition to the model variants, the LLaMA2 project (Touvron et al., 2023) further adjusts the sampling
temperature of π1
tto induce π2
t.
Rejection Sampling. A popular ensemble-based approach in the literature is the so-called rejection sam-
pling (Nakano et al., 2021; Dong et al., 2023; Liu et al., 2023a). We present a brief introduction to the
concept of rejection sampling in Appendix A.1. In the context of LLM, however, the rejection sampling
is usually restricted to the best-of-n sampling. Specifically, we sample nindependent responses by π1
tfor
each prompt, and then use a reward function to rank them and take the one with the highest reward as the
final output. In other words, we take π2
tas the best-of-n variant of π1
t. In this way, the π2
tenlarges the
margins between π1
t. Meanwhile, in this case, the KL divergence between the two policies is upper bounded
by log n−n−1
nand is usually far better than this conservative estimation (Beirami et al., 2024). We note
that similar idea has been adopted in Liu et al. (2023a); Hoang Tran (2024); Yuan et al. (2024) for improving
DPO.
5.3 Offline Learning with Pseudo-Labeling
We now consider a family of approaches that may slightly deviate from the main story of the paper but are
beneficial to clarify some confusing concepts in RLHF. In the formulation of RLHF, we define the offline
learning as learning without further querying the human feedback (the underlying ground-truth BT model),
while we define the online learning as the scenario where we can query the humans along the way of training.
In this sense, there are several existing algorithms in the literature are classified as offline one:
•PPO with a fixed reward (Christiano et al., 2017; Ziegler et al., 2019);
•RAFT (rejection sampling fine-tuning, or iterative SFT) (Dong et al., 2023): we generate nresponses
for each prompt, and use a fixed reward to rank them, and fine-tune the model on those with high
rewards;
•RSO (DPO with rejection sampling) (Liu et al., 2023a): we generate nresponses and use statistical
rejection sampling to approximately sample from π0(·|x) exp(1
ηr(x,·)) and use these samples to run
DPO.
All these algorithms do not query new human feedbacks during the training. Instead, they first train a proxy
reward ˆ r, and use ˆ rto label the model-generated samples for the subsequent training. In particular, it is
known that
•PPO and RAFT outperform the SFT-baseline, which fine-tunes the models on the preferred samples
(Dong et al., 2023; Yuan et al., 2023);
•RSO outperforms DPO (Liu et al., 2023a).
In other words, while we are prohibited from collecting the ground-truth preference label, the offline RLHF
benefits from the pseudo labels from the learned reward, which resembles the insights of the semi-supervised
learning. One reasonable","[-0.023038707673549652, -0.01839771680533886, 0.035216111689805984, -0.0104041313752532, 0.008125197142362595, -0.0032850592397153378, -0.025670912116765976, 0.019062696024775505, -0.0324176661670208, 0.057021841406822205, 0.03815309703350067, -0.030949171632528305, -0.015557708218693733, -0.01644434593617916, 0.01861937716603279, -0.04264169931411743, 0.020184844732284546, -0.04114549607038498, -0.006989193148910999, 0.0372941680252552, -0.020448066294193268, -0.022221339866518974, 0.02698701247572899, 0.02172260545194149, 0.01081974245607853, -0.02731950208544731, 0.032140590250492096, 0.025352276861667633, 0.0002042338892351836, -0.009441298432648182, 0.017608055844902992, -0.03571484610438347, -0.04879274219274521, -0.01307096891105175, 0.0004701600410044193, 0.040785301476716995, 0.010951352305710316, 0.02708398923277855, -0.027485746890306473, 0.007169291377067566, 0.0002749094273895025, -0.056966427713632584, -0.053669244050979614, 0.010050861164927483, -0.0004045714158564806, 0.03698938712477684, 0.022235192358493805, -0.00814597774296999, 0.026335889473557472, 0.016679858788847923, -0.042863357812166214, 0.0368785560131073, -0.05361383035778999, -0.008429978042840958, 0.015765514224767685, -0.01835615560412407, 0.009032614529132843, 0.003383766859769821, 0.05530398339033127, -0.019118109717965126, 0.00978764146566391, -0.0326947383582592, 0.017053907737135887, 0.026793060824275017, -0.0049526989459991455, 0.011304621584713459, -0.07868903130292892, 0.022359875962138176, 0.004772600717842579, 0.05139723792672157, 0.0082083186134696, -0.03128166124224663, 0.03557631000876427, -0.01831459440290928, -0.017732739448547363, 0.021348556503653526, 0.04048052057623863, 0.05211763083934784, -0.017109323292970657, -0.025269154459238052, 0.023454319685697556, -0.023177245631814003, 0.03554860129952431, -0.02730564773082733, 0.0015611391281709075, -0.05253324285149574, -0.04117320477962494, -0.026280473917722702, -0.05560876429080963, -0.04652073606848717, -0.005659237504005432, -0.006992656737565994, -0.025504667311906815, 0.01953372173011303, 0.00985690951347351, -0.002833082340657711, -0.015807075425982475, -0.006493923254311085, 0.03912285715341568, 0.010092422366142273, 0.016887664794921875, -0.06799397617578506, 0.0045128436759114265, -0.03061668388545513, 0.037571243941783905, -0.005243626423180103, -0.011117596179246902, 0.0829559713602066, 0.01475419383496046, -0.013708239421248436, -0.058240968734025955, -0.03657377511262894, -0.05979258194565773, 0.013140236958861351, 0.0070099737495183945, -0.07824571430683136, -0.08301138877868652, 0.00491460133343935, 0.003240034682676196, 0.009552128612995148, -0.019034987315535545, -0.007577975280582905, 0.030644390732049942, 0.020018599927425385, 0.011401597410440445, 0.003335278946906328, 0.03801456093788147, -0.06344995647668839, 0.001672834623605013, 0.009656030684709549, 0.01971381902694702, 0.030672097578644753, -0.0239114910364151, -0.053890906274318695, -0.07292589545249939, 0.03806997463107109, -0.005839335732161999, -0.0026322035118937492, -0.014006094075739384, -0.013223359361290932, -0.024687299504876137, -0.06383786350488663, -0.06710733473300934, 0.01733098179101944, -0.04344521090388298, 0.0005519834812730551, -0.03468967229127884, -0.010189398191869259, 0.003716255770996213, 0.03255620226264, 0.0007593560731038451, -0.017566494643688202, -0.010528814047574997, 0.03294410556554794, -0.009628323838114738, -0.03510528430342674, -0.0226923655718565, 0.03665689751505852, 0.013174871914088726, -0.009981593117117882, -0.011304621584713459, 0.07181759923696518, -0.007522560656070709, 0.0003013180394191295, 0.02504749409854412, 0.002886765403673053, -0.002417471259832382, 0.004970015957951546, -0.0669965073466301, -0.01081281527876854, 0.00047708689817227423, 0.015654684975743294, -0.024770420044660568, -0.014449412003159523, 0.0021802266128361225, -0.009628323838114738, -0.0023118366952985525, 0.006906070746481419, -0.004114549607038498, -0.038513295352458954, 0.016014881432056427, 0.04585575684905052, 0.0008359843632206321, 0.0011282109189778566, -0.008734759874641895, 0.02608652226626873, -0.016527468338608742, -0.02504749409854412, 0.0020590065978467464, 0.014892730861902237, 0.03219600394368172, 0.02162563055753708, 0.03493903949856758, 0.015003560110926628, -0.014975853264331818, -0.02827540785074234, 0.06189834326505661, 0.06932392716407776, -0.007501780055463314, -0.0037959145847707987, 0.0017195908585563302, -0.002467690734192729, -0.029591510072350502, -0.08140435814857483, 0.002575057093054056, 0.011159157380461693, 0.00708963256329298, 0.012856236658990383, -0.02184728905558586, 9.735473577165976e-05, 0.0087486132979393, 0.01751108095049858, 0.05192367732524872, 0.014961998909711838, -0.025781741365790367, -0.02054504118859768, -0.03685085102915764, 0.026557547971606255, 0.029037361964583397, 0.04585575684905052, -0.0046098195016384125, 0.009517493657767773, -0.0036435239017009735, 0.02069743163883686, -0.001375845866277814, -0.0027707405388355255, 0.026474425569176674, -0.03770978003740311, 0.015834782272577286, -0.05084308981895447, 0.035160697996616364, 0.039455346763134, -0.024299394339323044, -0.020240260288119316, 0.034024693071842194, -0.011006766930222511, 0.01529448851943016, -0.020863676443696022, 0.02823384664952755, -0.06217541918158531, 0.011616329662501812, 0.010875157080590725, 0.006192605011165142, -0.030145658180117607, 0.007737292908132076, 0.025504667311906815, -0.008028221316635609, -0.03599192202091217, 0.0041768914088606834, -0.017788155004382133, 0.027735114097595215, -0.026876183226704597, -0.023315781727433205, -0.048321716487407684, -0.029730046167969704, 0.019921625033020973, 0.015820927917957306, -0.012786967679858208, -0.04987332969903946, -0.0036643045023083687, -0.029563801363110542, 0.02058660238981247, 0.02068357914686203, 0.025726325809955597, -0.013320335187017918, -0.0368785560131073, -0.010161691345274448, -0.01861937716603279, 0.0016988103743642569, 0.007848123088479042, -0.0098638366907835, 0.012786967679858208, -0.05001186579465866, 0.019187377765774727, -0.04693634435534477, -0.038596417754888535, 0.045218486338853836, 0.03732187673449516, -0.05995882675051689, -0.019104257225990295, -0.0204619187861681, 0.0012494308175519109, 0.047462787479162216, -0.014463265426456928, 0.036601483821868896, -0.008513100445270538, -0.0003032662207260728, -0.03776519373059273, -0.030201071873307228, -0.0030027900356799364, 0.012738480232656002, -0.03906744346022606, 0.02615579031407833, -0.04253086820244789, 0.036462947726249695, 0.010798961855471134, 0.024562615901231766, -0.0589059442281723, 0.01092364452779293, 0.009517493657767773, 0.0291758980602026, -0.00928198080509901, -0.011325402185320854, 0.0020849823486059904, 0.021306995302438736, -0.008887150324881077, 0.014269313775002956, 0.00402796408161521, -0.0018633230356499553, -0.007141584064811468, -0.0002223086339654401, 0.034274060279130936, 0.015751659870147705, 0.021445531398057938, 0.029923997819423676, -0.032057467848062515, 0.04674239456653595, -0.018162203952670097, 0.021473240107297897, -0.048349421471357346, -0.06505698710680008, -0.05558105558156967, -0.003383766859769821, 0.007771927397698164, 0.04438726603984833, -0.028510920703411102, 0.003375108353793621, -0.0022841293830424547, -0.024701151996850967, 0.0029594972729682922, -0.01248911302536726, -0.01088208332657814, 0.007771927397698164, 0.015308341942727566, 0.017635764554142952, -0.011069108732044697, -0.04261399060487747, 0.0393168106675148, 0.021029921248555183, 0.0076126097701489925, -0.07220549881458282, 0.02725023403763771, -0.03183580935001373, -0.0073493896052241325, -0.02840009145438671, -0.00338896200992167, 0.021403970196843147, 0.02605881541967392, 0.013708239421248436, 0.04056364297866821, -0.00809748936444521, -0.006327678915113211, 0.026571402326226234, 0.018577815964818, -0.012142770923674107, 0.02503364160656929, 0.007196998689323664, -0.0503997728228569, -0.03294410556554794, -0.010251739993691444, -0.01475419383496046, 0.02826155349612236, -0.010868229903280735, -0.0027083989698439837, -0.002542154397815466, 0.041782766580581665, -0.0145879490301013, -0.033165764063596725, 0.021029921248555183, -0.019104257225990295, 0.01609800197184086, 0.023579003289341927, -0.041865888983011246, 0.01835615560412407, -0.06610987335443497, 0.021210018545389175, 0.04244774580001831, 0.0002539124106988311, 0.02508905529975891, 0.03452342748641968, -0.024687299504876137, -0.008693198673427105, -0.03333200886845589, -0.044082481414079666, 0.004211525898426771, 0.03128166124224663, -0.03238995745778084, -0.049346890300512314, -0.055802714079618454, -0.020946798846125603, 0.028981946408748627, -0.027430331334471703, -0.009469006210565567, 0.01241291780024767, -0.02726408652961254, -0.012246672995388508, -0.055913545191287994, 0.06200917437672615, 0.047462787479162216, 0.04427643492817879, -0.04211525619029999, -0.014851169660687447, -0.04219837859272957, 0.00875554047524929, -0.038513295352458954, 0.021459385752677917, 0.007723439484834671, 0.01417233794927597, 0.03912285715341568, 0.049319181591272354, 0.03230683505535126, -0.033165764063596725, 0.02625276707112789, -0.02923131361603737, 0.012620723806321621, -0.031004587188363075, 0.0204619187861681, -0.0041249399073421955, 0.04056364297866821, 0.060235898941755295, 0.005454895552247763, -0.059349264949560165, 0.0228309016674757, -0.010729692876338959, -0.014338582754135132, 0.028871117159724236, 0.029037361964583397, -0.01860552281141281, 0.00033162301406264305, -0.04485829174518585, -0.0019845429342240095, 0.04873732849955559, 0.034301768988370895, -0.035132989287376404, -0.05635686218738556, 0.006248020101338625, -0.0010078569175675511, -0.0031863516196608543, -0.0064004105515778065, -0.012973993085324764, 0.04685322195291519, -0.003702402114868164, -0.029619216918945312, 0.01298784650862217, -0.04264169931411743, -0.016790688037872314, -0.03818080574274063, -0.028621749952435493, -0.0002110525092575699, 0.02175031416118145, -0.035243820399045944, 0.007404804229736328, 0.06705192476511002, 0.005686945281922817, 0.014158484525978565, -0.052560947835445404, 0.07680492848157883, -0.008513100445270538, 0.021971972659230232, -0.005589968990534544, 0.008658564649522305, -0.01306404173374176, 0.006895680446177721, -0.016555175185203552, 0.034107815474271774, 0.02263695001602173, 0.011969598941504955, 0.008540808223187923, -0.006663631182163954, 0.02626662142574787, 0.0015888465568423271, -0.061510439962148666, 0.012759260833263397, -0.001301382202655077, -0.04438726603984833, 0.00028118689078837633, 0.027582721784710884, -0.010757400654256344, 0.03601962700486183, -0.009718372486531734, 0.01622268557548523, -0.028510920703411102, 0.026543695479631424, 0.013902191072702408, 0.04546785354614258, 0.0672735795378685, 0.05100933462381363, 0.00867241807281971, -0.02819228544831276, 0.006538947578519583, -0.006535484455525875, -0.026363596320152283, 0.03130936995148659, -0.01640278473496437, -0.028483213856816292, -0.030145658180117607, 0.01626424677670002, 0.015696246176958084, -0.011657890863716602, -0.010999839752912521, 0.045107655227184296, -0.026405157521367073, -0.022152071818709373, 0.023731393739581108, -0.006365776527673006, 0.04663156345486641, 0.015820927917957306, -0.01613956317305565, -0.0005420261295512319, 0.01722015254199505, -0.02596183866262436, -0.008007440716028214, -0.010577302426099777, -0.009025687351822853, -0.010417984798550606, 0.003785524284467101, -0.0414779856801033, -0.013902191072702408, -0.024604177102446556, 0.027984479442238808, 0.004287721123546362, -0.007931244559586048, -0.04449809342622757, 0.03222371265292168, 0.016624443233013153, 0.017053907737135887, -0.03682314231991768, -0.09553513675928116, -0.027416478842496872, -0.036379825323820114, 0.009448225609958172, -0.008997980505228043, 0.026502134278416634, 0.010078568942844868, -0.011332329362630844, -0.0008524356526322663, -0.021999679505825043, -0.009642177261412144, -0.011720232665538788, -0.02504749409854412, 0.0058670430444180965, 0.014407850801944733, -0.009683738462626934, 0.014477119781076908, 0.01408921554684639, -0.03607504069805145, 0.04233691468834877, -0.011727159842848778, 0.0006195202586241066, 0.020891383290290833, 0.0036123530007898808, -0.04142257198691368, -0.03363678976893425, -0.03831934183835983, -0.03579796850681305, 0.004014110658317804, -0.0009281981037929654, -0.004502453375607729, -0.005208992399275303, -0.002646057168021798, -0.00313440035097301, -9.627241524867713e-05, -0.01252374704927206, 0.017053907737135887, -0.01187262311577797, 0.034218646585941315, 0.004807234741747379, -0.012025014497339725, 0.0040314276702702045, 0.04887586459517479, -0.06056838855147362, 0.036352116614580154, 0.05463900417089462, -0.034274060279130936, 0.018079081550240517, 0.01134618278592825, 0.03582567721605301, -0.019783087074756622, 0.03928910195827484, 0.036241285502910614, -0.01950601302087307, -0.028760287910699844, -0.011824135668575764, -0.023565148934721947, -0.03604733571410179, -0.0020520796533674, 0.020905237644910812, 0.034301768988370895, -0.0783565416932106, 0.01615341752767563, 0.03061668388545513, -0.029840875416994095, -0.006635923869907856, -0.009905397891998291, -0.050621431320905685, 0.012426771223545074, 0.02270621992647648, 0.0003606292011681944, -0.012689991854131222, -0.03518840670585632, 0.005378700327128172, 0.01516980491578579, 0.003688548458740115, -0.01361126359552145, -0.026474425569176674, 0.06112253665924072, -0.002528300741687417, 0.009191932156682014, 0.01722015254199505, -0.006078312173485756, 0.015807075425982475, -0.018009813502430916, 0.02622506022453308, -0.01733098179101944, -0.03341513127088547, -0.029065068811178207, -0.0007827341905795038, 0.011498573236167431, 0.03826392814517021, -0.012683064676821232, -0.01724785938858986, -0.013749800622463226, 0.023260368034243584, -0.012232819572091103, -0.0008307892712764442, 0.00764724425971508, -0.012502966448664665, -0.006147580686956644, -0.000600471452344209, -0.0020382259972393513, -0.027887504547834396, -0.02726408652961254, -0.0006346727604977787, 0.008159831166267395, 0.007027290761470795, 0.008035147562623024, 0.00628611771389842, -0.022152071818709373, 0.0029231312219053507, -0.011013694107532501, 0.024202419444918633, 0.02298329398036003, 0.010473399423062801, -0.05305968225002289, 0.016666004434227943, 0.004495526663959026, 0.002869448158890009, 0.011796427890658379, -0.007093095686286688, -0.050704553723335266, -0.040619056671857834, -0.02810916304588318, 0.0059224581345915794, 0.0025906425435096025, 0.03233454376459122, 0.012918578460812569, 0.01471263263374567, 0.00708963256329298, -0.00047578811063431203, -0.015682391822338104, -0.02066972479224205, -0.02618349902331829, -0.007238559890538454, 0.006566655356436968, 0.00519513851031661, 0.045107655227184296, 0.013424238190054893, 0.05746515840291977, 0.014241606928408146, -0.02611423097550869, -0.03036731667816639, -0.00703075435012579, 0.04111779108643532, -0.02060045674443245, -0.012267453595995903, -0.021237727254629135, -0.013971459120512009, -0.03881807625293732, -0.03247307986021042, 0.018259180709719658, -0.028594043105840683, -0.004623673390597105, -0.05020581930875778, -0.007695732172578573, -0.025227593258023262, -0.004692941904067993, 0.030699806287884712, -0.027471892535686493, -0.024202419444918633, -0.004211525898426771, -0.014892730861902237, -0.007100022863596678, 0.02731950208544731, -0.01133925560861826, 0.007390950340777636, 0.013943752273917198, 0.0038928906433284283, 0.038651831448078156, -0.01838386431336403, -0.07547497004270554, 0.0035742553882300854, 0.028594043105840683, -0.020392650738358498, 8.566566975787282e-05, -0.022318314760923386, -0.013299554586410522, -0.03809768334031105, 0.048432543873786926, 0.037404999136924744, -0.03657377511262894, -0.0020849823486059904, -0.010210178792476654, -0.011734086088836193, 0.01613956317305565, 0.004464355763047934, -0.014297021552920341, 0.03491133078932762, 0.006265337113291025, 0.011907258071005344, -0.027555014938116074, -0.013306481763720512, -0.00814597774296999, -0.025906424969434738, 0.006151044275611639, -0.0052644070237874985, -0.005991726648062468, -0.06422577053308487, 0.02069743163883686, -0.018993426114320755, -0.0008030818426050246, 0.0007623865967616439, 0.012870090082287788, -0.0014944681897759438, -0.023592855781316757, -0.01751108095049858, 0.01953372173011303, 0.004204598721116781, 0.01032100897282362, 0.010556521825492382, -0.003605426289141178, 0.006736363284289837, -0.009981593117117882, -0.02610037662088871, 0.0046098195016384125, 0.010611936450004578, 0.004232306033372879, 0.01645819842815399, 0.03238995745778084, -0.021348556503653526, -0.007550267968326807, -0.022997146472334862, 0.01309867575764656, -0.014906584285199642, 0.0023464709520339966, 0.029563801363110542, -0.0030149121303111315, 0.014878876507282257, 0.005970946047455072, -0.01866093836724758, -0.0066948020830750465, 0.015543854795396328, 0.013867557048797607, -0.01645819842815399, 0.003059936687350273, 0.004166501108556986, -0.021071482449769974, -0.031974345445632935, 0.0009697591885924339, 0.01257916260510683, -0.022346023470163345, -0.0196584053337574, -0.002881570253521204, -0.008450758643448353, 0.02068357914686203, 0.07148510962724686, -0.005375236738473177, 0.017954399809241295, 0.01248911302536726, -0.0028781068976968527, 0.003633133601397276, -0.010979059152305126, -0.02840009145438671, 0.013361896388232708, -0.041782766580581665, -0.008326075039803982, 0.008727832697331905, 0.003139595501124859, -0.0002268543903483078, 0.01187955029308796, -0.023343488574028015, 0.011443158611655235, 0.011276913806796074, -0.009905397891998291, -0.026599109172821045, 0.0054306513629853725, 0.04136715829372406, -0.04668697714805603, -0.12501581013202667, -0.009191932156682014, 0.022512266412377357, 0.016721419990062714, 0.020184844732284546, -0.007737292908132076, 0.035493187606334686, -0.0007022095960564911, -0.00677792401984334, -0.035271529108285904, 0.0027274477761238813, -0.01969996467232704, 0.002206202130764723, -0.018023667857050896, -0.02180572785437107, -0.05001186579465866, -0.011865696869790554, -0.003117083106189966, 0.01740025170147419, -0.01307096891105175, -0.018716352060437202, -0.002909277565777302, 0.012780041433870792, 0.00973222590982914, -0.03671231120824814, -0.009344322606921196, 0.0036123530007898808, -0.0010701986029744148, -0.016915371641516685, -0.0036435239017009735, -0.012717699632048607, -0.008776321075856686, 9.778766252566129e-05, -0.026890037581324577, -0.039483051747083664, -0.009427445009350777, -0.00626880070194602, 0.0008416124619543552, 0.0012199917109683156, 0.014075362123548985, 0.024728858843445778, -0.0303950235247612, 0.04347291961312294, -0.011983453296124935, 0.014283168129622936, -0.021002214401960373, 0.017912838608026505, 0.006313825026154518, 0.015543854795396328, 0.005808164831250906, 0.031060002744197845, -0.03405240178108215, -0.0033768401481211185, -0.006483532954007387, 0.002526569180190563, 0.022498413920402527, 0.017691178247332573, 0.015834782272577286, -0.010985986329615116, 0.002519642235711217, -0.02615579031407833, 0.04693634435534477, 0.020101722329854965, -0.018245326355099678, -0.03784831613302231, -0.001650322345085442, -0.014809608459472656, 0.040868423879146576, -0.04266940429806709, -0.04854337498545647, 0.004748356528580189, -0.009510567411780357, 0.004263476934283972, 0.03840246424078941, -0.001135137747041881, -0.015502293594181538, 0.052699487656354904, 0.01861937716603279, -0.044027067720890045, 0.025366129353642464, 0.05203450843691826, -0.055885836482048035, 0.022664658725261688, 0.0032608152832835913, 0.010688131675124168, 0.02413315139710903, 0.01720629818737507, -0.02169489860534668, -0.0073216818273067474, 0.024271687492728233, 0.011595549061894417, -0.011173011735081673, 0.009600616060197353, -0.03344283998012543, -0.004114549607038498, -0.03793143853545189, -0.05078767612576485, 0.010494180023670197, 0.031004587188363075, -0.01947830617427826, 0.03056126832962036, 0.02720867283642292, -0.023592855781316757, -0.011027547530829906, 0.016527468338608742, -0.0049042110331356525, 0.0028798384591937065, -5.63889007025864e-05, 0.045135363936424255, -0.012703845277428627, 0.007799634709954262, 0.015336048789322376, -0.017109323292970657, 0.014781900681555271, -0.026460573077201843, 0.05968175083398819, 0.041810475289821625, 0.011526281014084816, 0.010909791104495525, 0.03139249235391617, 0.0043431357480585575, 0.03723875433206558, -0.0239807590842247, 0.02288631722331047, 0.0045613315887749195, -0.016582882031798363, 0.002388032153248787, 0.026779208332300186, -0.028704872354865074, 0.01085437647998333, 0.01356277521699667, 0.006313825026154518, 0.0237729549407959, 0.001693615224212408, -0.006196068599820137, 0.015793221071362495, 0.04444267973303795, 0.03136478364467621, -0.047241125255823135, 0.014165411703288555, 0.004287721123546362, 0.009531348012387753, -4.25893122155685e-05, 0.04158881679177284, -0.03180810064077377, 0.028677165508270264, 0.030921464785933495, -0.02066972479224205, -0.041865888983011246, 0.027970626950263977, 0.013140236958861351, -0.0344403050839901, 0.002247763331979513, 0.0067432899959385395, -0.006324215326458216, 0.025518521666526794, 0.04904210940003395, -0.014338582754135132, -0.006220312789082527, 0.011713305488228798, 0.026654524728655815, 0.030976880341768265, -0.01076432690024376, -0.04873732849955559, 0.04261399060487747, -0.014393997378647327, -0.004727575927972794, 0.0016425296198576689, 0.0019360550213605165, -0.010258667171001434, -0.023648271337151527, -0.0799635723233223, 0.01192111149430275, 0.011983453296124935, 0.026515986770391464, 0.018951864913105965, 0.002336080651730299, 0.04003719985485077, -0.01133925560861826, 0.04153340309858322, 0.006106019485741854, 0.045024532824754715, 0.0058220187202095985, -0.0009481128072366118, 0.031143125146627426, -0.008305295370519161, -0.0033300837967544794, 3.7691814213758335e-05, 0.017095468938350677, 0.023482026532292366, 0.036324407905340195, 0.026723792776465416, -0.006750216707587242, 0.032168298959732056, 0.009503640234470367, -0.0024815446231514215, -0.0002547782496549189, 0.003428791416808963, 0.00493191834539175, -0.07752532511949539, -0.06511240452528, 0.08955033868551254, 0.018813328817486763, -0.009469006210565567, -0.04374999552965164, 0.025338422507047653, 0.0008732161950320005, -0.01081974245607853, 0.002562934998422861, 0.037377290427684784, -0.009413591586053371, 0.024701151996850967, -0.011131450533866882, 0.027610430493950844, 0.024410225450992584, -0.042863357812166214, -0.0038825003430247307, 0.0033023764844983816, -0.03782060742378235, -0.005662701092660427, -0.021930411458015442, -0.027596576139330864, 0.023260368034243584, 0.012163551524281502, -0.030090242624282837, -0.04136715829372406, 0.023689832538366318, -0.010750473476946354, 0.01351428683847189, 0.0037197191268205643, -0.00924734678119421, 0.012274380773305893, -0.004575185477733612, 0.007051534950733185, -0.025227593258023262, -0.03166956454515457, 0.012745406478643417, 0.014186191372573376, -0.007016900461167097, 0.0017498958623036742, 0.04826630279421806, 0.013971459120512009, -0.03554860129952431, -0.005157040897756815, 0.036462947726249695, -0.0030460830312222242, 0.032057467848062515, 0.020392650738358498, -0.03496674448251724, -0.02157021500170231, -0.024188565090298653, 0.025296861305832863, 0.015973320230841637, -0.0036920118145644665, 0.0005117211258038878, -0.005832409020513296, -0.011179937981069088, 0.03577025979757309, 0.040757592767477036, 0.001584517303854227, -0.03053356148302555, 0.010037007741630077, -0.00014481449034065008, -0.003868646454066038, 0.002491934923455119, -0.045052241533994675, 0.0050946990959346294, 0.009143443778157234, 0.02837238274514675, 0.002479812828823924, -0.031226245686411858, 0.012322869151830673, 0.013825995847582817, 0.0291758980602026, 0.000886636960785836, 0.012177404947578907, 0.018092935904860497, 0.01203194074332714, 0.031143125146627426, 0.00022025223006494343, -0.011526281014084816, -0.006767533719539642, -0.06062380224466324, -0.012087355367839336, 0.022179778665304184, -0.015377609990537167, 0.028898824006319046, -0.0031292052008211613, 0.006881827022880316, 0.03629670292139053, 0.07021056860685349, 0.04012032225728035, -0.015419171191751957, -1.2859321032010484e-05, -0.007958952337503433, -0.02503364160656929, -0.0012624186929315329, 0.01240599062293768, 0.0056488472037017345, -0.019090402871370316, 0.03881807625293732, 0.012426771223545074, -0.0037093290593475103, 0.0061337267979979515, 0.020143283531069756, 0.006767533719539642, -0.0058220187202095985, -0.028012188151478767, -0.020170992240309715, -0.00985690951347351, -0.01958913542330265, -0.00511894328519702, 0.020143283531069756, -0.00041929096914827824, -0.0027568868827074766, 0.0047310395166277885, -0.009136517532169819, -0.010598083026707172, -0.010743546299636364, -0.006466215942054987, -0.004225379321724176, -0.0064004105515778065, -0.002651252318173647, 0.02622506022453308, -0.0329718142747879, -0.029923997819423676, 0.004537087865173817, -0.004419331438839436, -0.00624455651268363, 0.01943674497306347, 0.004422794561833143, 0.02285861037671566, -0.005808164831250906, -0.015474585816264153, -0.04136715829372406, -0.004762210417538881, -0.03671231120824814, -0.005309431813657284, -0.00298720458522439, 0.009607543237507343, 0.03496674448251724, 0.001165442750789225, 0.004758746828883886, -0.00764724425971508, -0.0031586443074047565, 0.022664658725261688, -0.011096816509962082, -0.007702658884227276, -0.006590899080038071, -0.0010424911743029952, 0.07098637521266937, -0.016832249239087105, -0.02931443601846695, -0.006272263824939728, -0.03493903949856758, 0.030838342383503914, 0.0038305488415062428, 0.009718372486531734, -0.02407773584127426, 0.006895680446177721, -0.005534554366022348, 0.020960653200745583, -0.02826155349612236, 0.007384023629128933, -0.0004153946356382221, -0.0029369851108640432, -0.015973320230841637, 0.01946445181965828, 0.040702179074287415, 0.014040728099644184, 0.02060045674443245, 0.02170875295996666, -0.016956932842731476, -0.0027915211394429207, 0.020226405933499336, -0.014463265426456928, -0.022332169115543365, 0.004311964847147465, 0.002318763639777899, 0.01138081680983305, -0.003941378556191921, -0.023149536922574043, -0.04901440069079399, 0.013285701163113117, -0.03887348994612694, -0.0008407466229982674, -0.010563448071479797, 0.018273035064339638, 0.014851169660687447, -0.0021161530166864395, 0.00874168612062931, 0.0034807429183274508, 0.008319148793816566, 0.010258667171001434, 0.009891543537378311, 0.01967225782573223, -0.004311964847147465, 0.02945297211408615, 0.01737254299223423, 0.03366449847817421, -0.006615143269300461, -0.006168361287564039, 0.027665844187140465, -0.0018944938201457262, -0.0011368695413693786, -0.0026304719503968954, -0.03031190112233162, 0.03394157066941261, 0.0005342334043234587, 0.006580508779734373, -0.04555097594857216, 0.019796941429376602, -0.011491646990180016, -0.0037924512289464474, 0.022235192358493805, -0.02704242803156376, 0.0037578169722110033, 0.030117949470877647, -0.011976526118814945, 0.056052081286907196, -0.02945297211408615, -0.009946959093213081, -0.02834467589855194, -0.0008944296860136092, -0.002310104900971055, 0.007390950340777636, -0.02701472118496895, 0.022165924310684204, 0.01361126359552145, 0.02514447085559368, -0.01089593768119812, -0.00863778404891491, -0.023329636082053185, -0.02170875295996666, -0.0013775775441899896, 0.008804027922451496, 0.032085176557302475, 0.00813905056566, -0.04036968946456909, 0.03150331974029541, -0.0061371903866529465, 0.02837238274514675, 0.039566174149513245, -0.0027845941949635744, -0.010037007741630077, -0.020087869837880135, -0.00019936345051974058, 0.02587871626019478, -0.010037007741630077, -0.0016451271949335933, -0.015793221071362495, 0.006708655506372452, 0.014878876507282257, -0.012142770923674107, -0.013853702694177628, 0.013077895157039165, -0.030699806287884712, -0.01963069662451744, -0.014865023083984852, -0.0032504249829798937, 0.015100535936653614, -0.00933046918362379, 0.01611185632646084, 0.02840009145438671, -0.02288631722331047, 0.01516980491578579, 0.002022640546783805, 0.0345788411796093, 0.022276753559708595, -0.019727673381567, -0.004093769006431103, 0.002902350854128599, 0.009988519363105297, 0.01622268557548523, -0.0007242889259941876, 0.004557868465781212, -0.013133310712873936, -0.01192111149430275, 0.022456852719187737, 0.013832922093570232, -0.013916044495999813, 0.038457877933979034, 0.003837475785985589, -0.01643049158155918, 0.021140750497579575, 0.008561588823795319, -0.0067398264072835445, -0.017829716205596924, -0.006043677683919668, -0.020337235182523727, 0.005808164831250906, 0.006379630416631699, -0.019990893080830574, 0.009649104438722134, -0.012877017259597778, -0.015446878969669342, 0.01145701203495264, -0.024715006351470947, 0.029702339321374893, 0.015391464345157146, -0.0006147580570541322, 0.03460654988884926, 0.005025430582463741, 0.034329477697610855, 0.010334862396121025, -0.021168457344174385, 0.01246140617877245, -0.028704872354865074, 0.015696246176958084, 0.0020018601790070534, 0.015266780741512775, -0.03831934183835983, 0.008333002217113972, 0.03377532958984375, 0.05547022819519043, 0.010653497651219368, -0.00924041960388422, -0.010542668402194977, -0.021473240107297897, -0.004755283705890179, -0.004447038751095533, -0.002883301815018058, 0.006722509395331144, -0.02815072424709797, -0.00597440917044878, 0.010667351074516773, -0.013451945967972279, 0.0058705066330730915, -0.0204619187861681, 0.036435239017009735, -0.0019222012488171458, -0.00599865335971117, 0.03610274940729141, 0.030893757939338684, 0.010016227141022682, 0.0056523107923567295, 0.023454319685697556, 0.02169489860534668, 0.024160858243703842, 0.0026252768002450466, 0.009905397891998291, -0.01837000995874405, 0.03244537115097046, 0.02713940478861332, 0.012232819572091103, 0.036546070128679276, 0.020974505692720413, -0.006975339259952307, 0.03358137607574463, 0.01740025170147419, -0.008270660415291786, 0.005292114336043596, 0.0026962768752127886, 0.024701151996850967, -0.022581536322832108, -0.010411057621240616, -0.011685598641633987, -0.0047345031052827835, 0.018854890018701553, -0.011865696869790554, 0.01080588810145855, -0.0009844787418842316, 0.006334605626761913, 0.008970272727310658, 0.0049492353573441505, -0.008443832397460938, 0.018273035064339638, 0.010584228672087193, -0.0322791263461113, -0.007508706767112017, -6.791561190766515e-06, -0.013777507469058037, 0.018841035664081573, 0.009635250084102154, 0.004883430432528257, 0.008838662877678871, 0.025366129353642464, 0.04427643492817879, 0.012516820803284645, 0.015017413534224033, 0.01636122353374958, -0.036268994212150574, 0.0041768914088606834, -0.014878876507282257, -0.004492063075304031, 0.010189398191869259, -0.0040764519944787025, -0.015959465876221657, 0.018051374703645706, 0.01240599062293768, -0.04023115336894989, 0.019907770678400993, 0.011332329362630844, -0.004699868615716696, -0.01244755182415247, 0.039593882858753204, 0.008014366962015629, 0.027596576139330864, -0.05344758555293083, 0.02159792371094227, 0.011096816509962082, 0.018993426114320755, -0.02055889554321766, -0.03250078856945038, 0.030256487429142, -0.014768047258257866, 0.01195574551820755, -0.027402624487876892, 0.007896610535681248, 0.027748966589570045, -0.0028625214472413063, -0.02708398923277855, -0.006265337113291025, 0.008464612066745758, -0.03399698808789253, 0.0186470840126276, -0.03723875433206558, 0.003392425598576665, -0.013230286538600922, -0.009233493357896805, -0.0017602861626073718, 0.032999519258737564, 0.010417984798550606, -0.005157040897756815, 0.0057007987052202225, 0.0018373474013060331, 0.012773114256560802, 0.006161434575915337, 0.014975853264331818, -0.01413077674806118, 0.027513453736901283, -0.002990668173879385, -0.00866549089550972, 0.010140910744667053, 0.002431324915960431, 0.016887664794921875, -0.011366963386535645, -0.022470707073807716, -0.016042588278651237, 0.015336048789322376, -0.01960298977792263, 0.00978764146566391, 0.023246513679623604, -0.026377450674772263, 0.0031378637067973614, -0.0012979188468307257, 0.015446878969669342, -0.03460654988884926, -0.03050585463643074, 0.026571402326226234, -0.008686271496117115, -0.005451431963592768, 0.00516050448641181, 0.01722015254199505, 0.05203450843691826, 0.011831061914563179, -0.02931443601846695, 0.02177802100777626, -0.013902191072702408, 0.013458872213959694, 0.014393997378647327, -0.009552128612995148, 0.004381233360618353, 0.01828688755631447, 0.015086682513356209, 0.008700125850737095, -0.0026703013572841883, 0.005835872143507004, -0.0349944531917572, 0.015793221071362495, -0.01631966233253479, -0.004038354381918907, -0.01755264215171337, 0.017885129898786545, 0.028815701603889465, -0.00875554047524929, 0.013084822334349155, -0.004869576543569565, 0.012773114256560802, -0.02834467589855194, 0.046132829040288925, 0.0026651062071323395, 0.021487092599272728, 0.026945453137159348, -0.005801238119602203, 0.030755219981074333, -0.006407337728887796, 0.009365103207528591, 0.03061668388545513, -0.023565148934721947, -0.007487926632165909, 0.01969996467232704, -0.01644434593617916, 0.009316614829003811, -0.02518603205680847, 0.008125197142362595, 0.013091749511659145, -0.004260013811290264, -0.003087643999606371, 0.016707565635442734, 0.020032454282045364, 0.05946009233593941, -0.016666004434227943, -0.002793252933770418, 0.011477792635560036, 0.007972805760800838, 0.00822217296808958, -0.0303950235247612, -0.03330430015921593, 0.021223872900009155, -0.03829163312911987, -0.015682391822338104, 0.018162203952670097, 0.01969996467232704, -0.021473240107297897, -0.012232819572091103, -0.0140476543456316, -0.013735946267843246, 0.02374524623155594, -0.023315781727433205, 0.014795755036175251, 0.02708398923277855, 0.01528063416481018, 0.01849469356238842, -0.04433184862136841, -0.02396690659224987, -0.023537442088127136, -0.030256487429142, 0.03732187673449516, 0.014449412003159523, -0.016804542392492294, -0.040674470365047455, -0.006878363434225321, -0.03596421331167221, 0.006968412548303604, -0.0037127924151718616, -0.0013256261590868235, 0.02287246286869049, -0.022359875962138176]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" hypothesis is that the reward model may generalize better than the policy in terms
of sample complexity, i.e., reward model has better preference classification accuracy given a fixed number
of samples. Some empirical results (Li et al., 2023a) can also support the hypothesis.
multi-step RSO. Motivated by RSO (rejection sampling improves DPO) and RAFT (iterative learning is
more efficient), we propose a multi-step rejection-sampling-based offline DPO algorithm, referred to as the
18
multi-step RSO. To motivate our method, we first review the main challenge of RSO. Liu et al. (2023a)
found that the usage of offline datasets typically impedes the effectiveness of DPO-based algorithms. This
negative impact is particularly pronounced when there is a disparity between the distribution of offline data
and the target distribution. Consequently, they trained a reward model, denoted as r, and approximated
samples from πrusing rejection sampling. In this case, they generate samples from the optimal policy of
the underlying BT model associated with rand get Dgen={(x, a1, a2, y)}. The authors suggested that this
is more suitable for DPO training and leads to better performance. The key basis of the success of RSO is
that the rejection sampling can well approximate πr.
However, in practice, the rejection rate can be so large that the sampling is not effective. Given a prompt-
response pair ( x, a), the rejection rate is 1 −exp(−η−1(R(x)−r(x, a))), where R(x) is the largest pos-
sible reward over all a∈ A. For example, given η > 0, if the samples drawn from π0(a|x) satisfies
Ea∼π0(a|x)exp(η−1r(x, a)) = exp( −η−1(rx−R(x))), the expected acceptance rate becomes exp( −rx
η), where
rxis the reward gap between average sample and the best sample given prompt x. Setting rx= 1 and
η= 0.1 yields a notably low acceptance rate of approximately 0 .00004. Essentially, the majority of samples
are rejected, necessitating a substantial number of sampled candidates to produce a single accepted com-
parison pair. In the practical implementation of RSO (Liu et al., 2023a), we typically fix the total budget
of candidate responses and the number of samples to be accepted. In this case, due to the low sampling
efficiency, the collected samples may not well approximate the target distribution, and train on these samples
can lead to inferior performance compared to the original DPO.
To mitigate this issue and to make the algorithm more effective, we propose a multi-step approach to
progressively achieve our ultimate target. Instead of using π0to approximate π0exp(1
ηr) directly, we divide
the path into several steps by considering a sequence of distributions
π0→π0exp(1
η1r)→ ··· → π0exp(1
ηNr),
where η0=∞(i.e., π0),ηN=η. The high-level intuition is that while approximating πrfrom π0is
hard, approximating π0exp(1
ηir) with π0exp(1
ηi−1r) is much easier. Therefore, we can do the rejection
sampling step by step. Considering the case Ea∼π0(a|x)exp(η−1r(x, a)) = exp( −η−1(rx−R(x))), by choosing
N= [rx/η] + 1 steps, the acceptance rate at each step becomes an O(1) probability exp( −rx
η([rx/η]+1))>
exp(−1)>0.367. The acceptance rate can be exponentially increased with the number of steps, i.e., N
steps correspond to an exp( N) increase in the acceptance rate. We also provide a numerical example in the
Appendix (Figure 7).
6 Experiments
In this section, we conduct real-world alignment experiments to verify the theoretical findings in the previous
sections. For a clear presentation, we refer the Algorithm 2 with Option I as Hybrid GSHF to stress that
we need a good offline dataset Doffto avoid explicit exploration and take π2
t=π0. Meanwhile, we refer
Algorithm 2 with Option II as Online GSHF to stress the need of online explorations. We describe the main
setup, competitors, and results in this section, and defer some omitted details to Appendix H for a clear
presentation.
6.1 Experiments Setup
Model, and Task. We use the","[0.004703461192548275, -0.021254483610391617, 0.037125613540410995, 0.016219792887568474, -0.01804678700864315, -0.011359433643519878, -0.0313238650560379, 0.02206338196992874, -0.02313726395368576, 0.032885875552892685, 0.032272227108478546, -0.03414105996489525, 0.0004685156454797834, 0.0008398415520787239, -0.0006925314664840698, -0.0340573824942112, 0.023248836398124695, -0.03076600655913353, 0.004783653654158115, 0.016512669622898102, -0.004351311828941107, -0.03174225986003876, 0.023499872535467148, 0.014839088544249535, 0.03154700994491577, -0.038603946566581726, 0.030626541003584862, 0.014113870449364185, 0.011436140164732933, -0.04789232090115547, -0.005264808423817158, -0.033415842801332474, -0.04089117422699928, -0.04248107597231865, 0.00916983187198639, 0.043373651802539825, 0.0045465631410479546, 0.037906620651483536, -0.028325365856289864, 0.003139708423987031, 0.016331365332007408, -0.05249467119574547, -0.04814336076378822, 0.02242599055171013, 0.011101423762738705, 0.046999745070934296, 0.018004946410655975, -0.05388932302594185, 0.024950310587882996, -0.008395800366997719, -0.06387502700090408, 0.04959379509091377, -0.04747392609715462, -0.030877577140927315, 0.004940551705658436, -0.035675179213285446, 0.003038596361875534, -0.010278579778969288, 0.04666502773761749, -0.0011715070577338338, 0.02243993803858757, -0.014134789817035198, 0.01842334307730198, 0.01912066712975502, -0.009309296496212482, 0.033025339245796204, -0.05614865943789482, 0.03193751350045204, -0.0054251933470368385, 0.030654434114694595, -0.018618592992424965, 0.0001047622790792957, 0.05835220590233803, -0.04038909822702408, 0.0007143229013308883, -0.01514591183513403, 0.02652626670897007, 0.05536765232682228, 0.0037550984416157007, -0.018186252564191818, -0.0031275053042918444, 0.007851886563003063, 0.04351311922073364, -0.05096055567264557, 0.0014094694051891565, -0.061029937118291855, -0.011373380199074745, -0.04150481894612312, -0.04292736575007439, -0.010076355189085007, -0.0211986992508173, 0.021407896652817726, 0.008744463324546814, 0.004553536418825388, 0.016456883400678635, -0.03366687893867493, -0.014783303253352642, 0.002055367222055793, 0.03787872567772865, 0.0189812034368515, 0.004372231662273407, -0.0750880241394043, 0.020612943917512894, -0.02652626670897007, 0.0585753507912159, -0.011059584096074104, 0.009846237488090992, 0.04566087946295738, -0.002733516274020076, -0.003106585470959544, -0.024266930297017097, -0.032662730664014816, -0.08741673827171326, 0.014406747184693813, 0.014950660988688469, -0.04454515874385834, -0.05506082996726036, 0.007356785237789154, -0.013284052722156048, 0.022872280329465866, -0.02760014683008194, -0.002301174448803067, -0.00724521279335022, 0.02753041498363018, 0.008681703358888626, -0.005547225009649992, 0.041532713919878006, -0.08005297929048538, -0.005153235979378223, 0.014950660988688469, 0.002838115207850933, 0.021477628499269485, -0.004351311828941107, -0.052550457417964935, -0.05734805762767792, 0.015522467903792858, -0.007837940007448196, -0.02105923369526863, -0.017223943024873734, 0.017935214564204216, -0.023960107937455177, -0.062257230281829834, -0.04711131751537323, 0.02259334921836853, -0.05790591984987259, -0.006680379156023264, -0.05592551454901695, -0.002540008397772908, -0.022077329456806183, 0.007398624438792467, -0.034419991075992584, -0.03414105996489525, -0.005979566834867001, 0.03400159627199173, 0.004672081675380468, -0.02628917433321476, -0.05104423314332962, 0.042062681168317795, 0.005292701534926891, 0.0003129248507320881, -0.015996649861335754, 0.038352906703948975, 0.010153060778975487, -0.0029496874194592237, 0.010620268993079662, 0.03840869292616844, -0.029789749532938004, 0.00964401289820671, -0.05653915926814079, 0.010634215548634529, 0.009609146974980831, 0.003139708423987031, -0.03255115821957588, -0.023960107937455177, 0.00289041455835104, -0.02313726395368576, -0.025842886418104172, 0.0075520360842347145, 0.017237888649106026, -0.045856133103370667, -0.0011392557062208652, 0.018855683505535126, 0.017935214564204216, 0.007782153785228729, 0.0006419753772206604, -0.025717368349432945, 0.025633689016103745, -0.027725666761398315, 0.01813046634197235, 0.01457410492002964, 0.06666433066129684, 0.017391299828886986, 0.03361109271645546, -0.03154700994491577, -0.015313270501792431, -0.060193147510290146, 0.06967677175998688, 0.04805967956781387, -0.02211916819214821, 0.02405773289501667, 0.00361563335172832, 0.018674379214644432, -0.01951117068529129, -0.05692966282367706, -0.010543563403189182, -0.007963458076119423, 0.012733165174722672, 0.0005970850470475852, -0.020222442224621773, 0.004710434470325708, 0.01627557910978794, 0.008549211546778679, 0.04278789833188057, 0.009888077154755592, -0.0019525117240846157, -0.011749936267733574, -0.0628150925040245, 0.026428639888763428, 0.056706517934799194, 0.05851956456899643, -0.012328716926276684, 0.022314419969916344, 0.019064882770180702, 0.03718139976263046, -0.006826817523688078, 0.022635189816355705, 0.03107282891869545, -0.0278372373431921, 0.002266308292746544, -0.0682821199297905, 0.020236389711499214, 0.043457332998514175, 0.009818344376981258, -0.02351382002234459, 0.037655580788850784, -0.021268431097269058, 0.011638364754617214, -0.03500574454665184, 0.009093126282095909, -0.03748822584748268, -0.00011582142178667709, 0.04655345901846886, 0.01835360936820507, -0.0394965223968029, 0.008765382692217827, 0.01942749135196209, -0.006715245544910431, -0.02080819569528103, 0.006492101587355137, -0.013814019970595837, -0.00222795526497066, -0.013423518277704716, -0.014232415705919266, -0.03090547025203705, -0.05204838141798973, 0.008012271486222744, 0.012593700550496578, -0.00956730730831623, -0.04348522424697876, -0.0012639026390388608, -0.05218784883618355, -0.0016875279834493995, 0.035898320376873016, 0.040277525782585144, 0.003887590253725648, -0.018604647368192673, -0.03154700994491577, 0.00023926985159050673, -0.008451586589217186, -0.016945011913776398, -0.0060109468176960945, 0.02875770814716816, -0.013897699303925037, 0.0026533238124102354, -0.045856133103370667, -0.02243993803858757, 0.03737665340304375, 0.045381952077150345, -0.07464173436164856, -0.029622390866279602, -0.01091314572840929, 0.008946687914431095, 0.039301272481679916, 0.0067047858610749245, 0.03207697719335556, -0.019023042172193527, 0.004103761166334152, -0.03508942574262619, -0.012747111730277538, 0.0001495981268817559, -0.005215995479375124, -0.04616295546293259, -0.00222795526497066, -0.059412140399217606, 0.0021529928781092167, -0.034894172102212906, -0.001079111360013485, -0.03280219808220863, 0.029036637395620346, 0.011582578532397747, 0.036205146461725235, -0.00054217065917328, -0.00647815503180027, 0.009895049966871738, 0.02096160687506199, 0.0006188764818944037, 0.005826155189424753, 0.02753041498363018, -0.015201698057353497, 0.009044312871992588, 0.0011810952564701438, 0.009650986641645432, -0.005324081052094698, 0.04457305371761322, 0.05241099372506142, -0.00578082911670208, 0.06939784437417984, -0.04557720199227333, -0.010592375881969929, -0.049538012593984604, -0.05620444193482399, -0.06270352005958557, -0.0078030736185610294, -0.0064153955318033695, 0.023262782022356987, -0.050848983228206635, 0.014113870449364185, -0.02190997079014778, -0.007067394908517599, -0.008925767615437508, 0.0062306043691933155, -0.018325716257095337, 0.0033088100608438253, -0.0015768274897709489, 0.02813011407852173, -0.015634039416909218, -0.029120316728949547, 0.026623891666531563, 0.03408527374267578, 0.02429482340812683, -0.07352600991725922, 0.00105470500420779, -0.01734946109354496, -0.0020379340276122093, -0.013039988465607166, 0.01688922569155693, 0.0102576594799757, 0.02373696304857731, 0.027181752026081085, 0.0038562105037271976, 0.013472330756485462, 0.0012394962832331657, 0.03336005657911301, 0.023011744022369385, 0.017558658495545387, 0.029203996062278748, 0.007886752486228943, -0.05511661618947983, -0.035284675657749176, 7.883048237999901e-05, -0.037655580788850784, 0.02428087778389454, 0.0009161115158349276, -0.0016761964652687311, 0.015383003279566765, 0.07804468274116516, -0.03369477391242981, -0.025354759767651558, 0.020096924155950546, -0.006757085211575031, -0.014657784253358841, 0.020459532737731934, -0.06934205442667007, 0.01913461461663246, -0.05745963007211685, 0.014504372142255306, 0.039440736174583435, 0.02945503406226635, 0.03757190331816673, 0.032885875552892685, -0.025410544127225876, 0.01087827980518341, -0.03977545350790024, -0.04340154677629471, 0.01161047164350748, 0.013095774687826633, -0.042983151972293854, -0.005222968757152557, -0.045298270881175995, -0.0187301654368639, 0.0001046533216140233, -0.01071789488196373, 0.006237577646970749, 0.02729332447052002, -0.026944661512970924, -0.013430491089820862, -0.04535405710339546, 0.06130886822938919, 0.048784900456666946, 0.05676230415701866, -0.03522888943552971, -0.017795749008655548, -0.05645548179745674, -0.008298174478113651, -0.05634390935301781, 0.028004596009850502, 0.019483277574181557, 0.035117316991090775, 0.02683308906853199, 0.022788600996136665, 0.02760014683008194, -0.03709772229194641, 0.047920215874910355, -0.044907767325639725, 0.028436938300728798, -0.008988526649773121, -0.005613470915704966, 0.007224293425679207, 0.026693623512983322, 0.0652138888835907, 0.007175480481237173, -0.03667932748794556, -0.015536414459347725, -0.004755760543048382, -0.02514556050300598, 0.04002648964524269, 0.010808547027409077, -0.004835953004658222, 0.020306121557950974, -0.04641399160027504, -0.003863183781504631, 0.029176102951169014, 0.02914820984005928, -0.035814642906188965, -0.07436279952526093, -0.00964401289820671, 0.025020042434334755, -0.02582894079387188, -0.011457059532403946, -0.03483838587999344, 0.03344373777508736, -0.01627557910978794, -0.027893023565411568, -0.02422509156167507, -0.03684668615460396, -0.026582052931189537, -0.036511968821287155, -0.013214319944381714, -0.01843728870153427, 0.01988772675395012, -0.02373696304857731, 0.007719394285231829, 0.06415395438671112, 0.014448586851358414, 0.030124466866254807, -0.07296814769506454, 0.06934205442667007, -0.0016448167152702808, 0.034977853298187256, 0.008012271486222744, 0.014699623920023441, -0.027934864163398743, 0.02690282091498375, 0.02528502605855465, 0.025801047682762146, 0.011003797873854637, -0.01372336782515049, 0.018562806770205498, 0.0039085098542273045, 0.018311770632863045, -0.02553606405854225, -0.028199847787618637, 0.0211986992508173, -0.00287995464168489, -0.023304620757699013, -0.0026969066821038723, 0.03436420485377312, -0.007042988669127226, 0.00020669166406150907, -0.0069279298186302185, 0.0033279864583164454, -0.015118018724024296, -0.005341514013707638, 0.020069031044840813, 0.06208987161517143, 0.03464313596487045, 0.04170007258653641, -0.009127992205321789, -0.0325232669711113, 0.010968931950628757, -0.0004532616294454783, -0.022244686260819435, 0.048840686678886414, -0.01610822230577469, -0.016512669622898102, -0.02242599055171013, 0.019943512976169586, 0.0031728316098451614, -0.012391475960612297, 0.014964607544243336, 0.03969177231192589, -0.03243958577513695, -0.005592551548033953, 0.0170286912471056, -0.01787942834198475, 0.01997140608727932, 0.006980229169130325, -0.0026847035624086857, 0.000580959371291101, 0.013179454021155834, -0.019706422463059425, 0.016986852511763573, -0.011171156540513039, -0.0032652271911501884, -0.011917294934391975, 0.010487777180969715, -0.02444823645055294, -0.043066829442977905, -0.014309121295809746, 0.025410544127225876, -0.022788600996136665, 0.003326243022456765, -0.04351311922073364, 0.02589867264032364, 0.007670581806451082, -0.0034221254754811525, -0.023179102689027786, -0.11570026725530624, -0.03600989282131195, -0.029566606506705284, 0.032662730664014816, 0.009072205983102322, 0.004679054953157902, 0.047780752182006836, 0.005254348274320364, -0.025466330349445343, -0.013702448457479477, -0.005651824176311493, -0.01920434646308422, -0.03193751350045204, 0.027195697650313377, 0.002682960359379649, -0.004386178217828274, -0.003960809204727411, -0.003429098753258586, -0.03137965127825737, 0.046609241515398026, -0.008883927948772907, -0.012893550097942352, 0.014260308817029, -0.000536940700840205, -0.029901321977376938, -0.015452735126018524, -0.037209294736385345, -0.04209057241678238, -0.00505212415009737, -0.0015445762546733022, -0.007482303772121668, 0.003549387212842703, -0.01527143083512783, 0.00659321341663599, 0.0027858158573508263, -0.01588507741689682, 0.0026794737204909325, 0.008144763298332691, 0.04644188657402992, 0.00362260639667511, -0.026275228708982468, 0.006492101587355137, 0.03015235997736454, -0.0510721281170845, 0.042453180998563766, 0.03006868064403534, -0.053777750581502914, 0.016512669622898102, -0.005184615962207317, 0.004734840709716082, -0.03369477391242981, 0.02998500131070614, 0.023193050175905228, -0.02359749935567379, -0.027851184830069542, -0.016387151554226875, -0.010425018146634102, -0.02959449775516987, 0.004431504290550947, 0.0049126590602099895, 0.05991421639919281, -0.03263483941555023, 0.014274255372583866, 0.00806108396500349, -0.028116168454289436, 0.0031379652209579945, 0.009713745675981045, -0.03213276341557503, 0.010118194855749607, 0.019232239574193954, 0.02928767539560795, -0.008507372811436653, -0.021156858652830124, 0.05642758682370186, -0.0009631809662096202, 0.008577104657888412, -0.018534913659095764, -0.029901321977376938, 0.04602348804473877, -0.0027823292184621096, 0.0004092429589945823, 0.036511968821287155, -0.013793100602924824, 0.010934065096080303, 0.0009239564533345401, 0.013207347132265568, -0.03988702595233917, -0.04864543303847313, -0.019399598240852356, -0.019023042172193527, -0.0032756871078163385, 0.05026322975754738, -0.0039085098542273045, -0.009016419760882854, -0.025968406349420547, 0.04624663293361664, -0.00921167153865099, 3.7590207284665667e-06, 0.014079003594815731, -0.007914645597338676, -0.02375091053545475, -0.03849237412214279, 0.009804397821426392, -0.024657433852553368, -0.02831142023205757, 0.0011906834552064538, -0.007545062806457281, 0.017558658495545387, -0.0009100098977796733, 0.004856872837990522, 0.015285377390682697, 0.006833790801465511, -0.017949160188436508, 0.00439663790166378, 0.014190576039254665, 0.010690001770853996, -0.03280219808220863, 0.02489452436566353, 0.023555658757686615, 0.010808547027409077, 0.015215644612908363, -0.012998148798942566, -0.026777302846312523, -0.03857605159282684, -0.025410544127225876, 0.016903173178434372, -0.021770505234599113, 0.022928066551685333, 0.0029235375113785267, 0.013988351449370384, 0.0011662770994007587, -0.013325892388820648, -0.017307622358202934, -0.02559185028076172, -0.017098423093557358, -0.028241686522960663, 0.003028136445209384, 0.01087827980518341, 0.045856133103370667, 0.03849237412214279, 0.06627382338047028, 0.009497574530541897, -0.004815033171325922, -0.0391618050634861, -0.006335203070193529, 0.04605138301849365, -0.0016831696266308427, -0.01658240333199501, -0.022579403594136238, -0.024239037185907364, -0.047613393515348434, -0.033192697912454605, 0.0034813981037586927, -0.030514968559145927, -0.015285377390682697, -0.0377950482070446, -0.007565982639789581, -0.039831239730119705, -0.024001946672797203, 0.04047277942299843, -0.0393291637301445, -0.008346987888216972, -0.002799762412905693, -0.027948809787631035, -0.020473480224609375, 0.03514521196484566, 0.0009605660452507436, 0.010690001770853996, 0.010229766368865967, 0.019064882770180702, 0.04432201385498047, -0.04234161227941513, -0.09455735236406326, -0.0030403395649045706, 0.03177015483379364, 0.0005046894075348973, -0.013297999277710915, -0.028171954676508904, 0.00044759587035514414, -0.020347960293293, 0.06638539582490921, 0.034392099827528, -0.042369503527879715, 0.012475155293941498, -0.015313270501792431, -0.012879603542387486, 0.03536835312843323, 0.006676892749965191, -0.01672186888754368, 0.034196846187114716, -0.008312121033668518, -0.01087130606174469, -0.0374603308737278, -0.015062233433127403, -0.0033733125310391188, -0.04401519149541855, 8.21264347905526e-06, -0.013535089790821075, 0.0007674939697608352, -0.03776715323328972, -0.011136289685964584, -0.053164105862379074, -0.0034604782704263926, 0.014894874766469002, 0.00871657021343708, -0.01942749135196209, -0.0061922515742480755, -0.011464033275842667, 0.02157525345683098, -0.0019856346771121025, 0.008863008581101894, 0.02753041498363018, 0.004428017418831587, 0.03146333247423172, 0.002423206577077508, -0.031184401363134384, -0.0036365529522299767, 0.006687352433800697, -0.0012037582928314805, -0.007161533925682306, 0.019525116309523582, -0.00018827791791409254, 0.017712069675326347, -0.0246016476303339, 0.01380007341504097, -0.031184401363134384, 0.005916807800531387, 0.048924364149570465, 0.00044454506132751703, -0.006349149625748396, -0.002803248818963766, -0.027879077941179276, -0.010013595223426819, 0.006042326334863901, 0.02260729670524597, -0.00875143613666296, 0.006757085211575031, 0.020096924155950546, -0.015899023041129112, -0.013214319944381714, 0.0030403395649045706, 0.004598862491548061, 0.010006622411310673, 0.011498899199068546, 0.014560158364474773, 0.011261808685958385, 0.026038138195872307, 0.07943933457136154, 0.02121264487504959, 0.011847562156617641, 0.0059725940227508545, -0.006882603745907545, 0.0073288921266794205, -0.02499214932322502, -0.022174954414367676, -0.010083328001201153, 0.006042326334863901, -0.024239037185907364, 0.03737665340304375, -0.00429552560672164, 0.002789302496239543, 0.015466681681573391, -0.04518669843673706, 0.019915619865059853, -0.01071092113852501, -0.003863183781504631, -0.004344338551163673, 0.01803283952176571, 0.03294166177511215, -0.04108642414212227, -0.11603497713804245, 0.003253023838624358, 0.028897173702716827, -0.0016666081501170993, 0.011931241489946842, -0.008779329247772694, 0.03701404482126236, -0.0031710881739854813, -0.017237888649106026, -0.02165893279016018, -0.0029479439835995436, -0.03693036362528801, 0.004874305799603462, -0.016707921400666237, 0.013458384200930595, -0.05299674719572067, -0.010780653916299343, -0.00034277912345714867, -0.010892226360738277, -0.01237752940505743, -0.020027190446853638, -0.016931066289544106, 0.014030191116034985, 0.011471006087958813, -0.03430841863155365, -0.010724867694079876, 0.01566193252801895, -0.01673581451177597, -0.021073179319500923, 0.00847947970032692, 0.013088801875710487, -0.0014007528079673648, 0.0027718693017959595, -0.011471006087958813, -0.037125613540410995, -0.025089776143431664, -0.011003797873854637, -0.004061921499669552, 0.007116207852959633, 0.02305358462035656, 0.027321217581629753, -0.04091906547546387, 0.034392099827528, -0.011436140164732933, 0.01634531281888485, -0.0425647534430027, 0.02158920094370842, -0.0085143456235528, 0.0023761370684951544, 0.009804397821426392, 0.02720964513719082, -0.019608795642852783, 0.003239077515900135, 0.0032931200694292784, 0.009127992205321789, 0.01234266348183155, 0.030319716781377792, 0.007063908502459526, -0.02945503406226635, -0.023639338091015816, -0.035284675657749176, 0.04370836913585663, 0.04231371730566025, -0.018409395590424538, -0.006132978480309248, -0.0038213443476706743, -0.017070529982447624, 0.032969553023576736, -0.009783478453755379, -0.042760007083415985, -0.023541713133454323, -0.005282241385430098, -0.005773855838924646, 0.009839264675974846, 0.009832290932536125, 0.01951117068529129, 0.015173804946243763, 0.03243958577513695, -0.037432439625263214, 0.02322094328701496, 0.05628812313079834, -0.05851956456899643, 0.024657433852553368, 0.020375853404402733, -0.012245037592947483, 0.03232801333069801, 0.017140263691544533, -0.003999162465333939, -0.015745611861348152, 0.030793897807598114, 0.010885252617299557, -0.029789749532938004, -0.00924653746187687, -0.027432790026068687, -0.02373696304857731, -0.057403843849897385, -0.028199847787618637, -0.005892401561141014, 0.055786047130823135, 0.006066732574254274, 0.040138062089681625, 0.020403746515512466, -0.002773612504824996, -0.013618769124150276, 0.01283776480704546, -0.016791600733995438, 0.025020042434334755, 0.013562982901930809, 0.023346461355686188, -0.02150552161037922, -0.00653394078835845, 0.014448586851358414, -0.02428087778389454, -0.018716219812631607, -0.009190751239657402, 0.04755760729312897, 0.039357058703899384, 0.010208847001194954, 0.002848575124517083, 0.01010424830019474, 0.005212509073317051, 0.004110734444111586, 0.0001717164268484339, 0.035982001572847366, 0.000537376559805125, 0.005285728257149458, 0.0029427141416817904, 0.04234161227941513, -0.009030366316437721, 0.013270106166601181, 0.02959449775516987, -0.0029130775947123766, 0.021017393097281456, 0.017391299828886986, -0.0034604782704263926, 0.037041936069726944, 0.04373626038432121, 0.015452735126018524, -0.05149052292108536, 0.01966458186507225, -0.0073288921266794205, -0.00035236735129728913, 0.00017258808657061309, 0.008779329247772694, -0.02635890804231167, 0.014713570475578308, 0.04033331200480461, -0.016945011913776398, -0.02720964513719082, 0.011798749677836895, -0.008890901692211628, -0.03893866017460823, 0.015787452459335327, -0.026972554624080658, -0.0033175265416502953, 0.00033667750540189445, 0.024810845032334328, -0.01680554635822773, -0.0059760804288089275, -0.016540562734007835, 0.03246748074889183, 0.0471671037375927, -0.0005260449834167957, -0.02543843723833561, 0.037655580788850784, -0.028785601258277893, 0.012098599225282669, 0.015829291194677353, 0.005345000885426998, -0.0005247375229373574, -0.0026759870816022158, -0.05006797984242439, 0.0005674487329088151, 0.015759559348225594, 0.030208144336938858, -0.010885252617299557, -0.032746411859989166, -0.0023569604381918907, -0.01973431371152401, 0.04354101046919823, 0.014560158364474773, 0.03748822584748268, 0.00360517343506217, -0.001811303198337555, 0.0313238650560379, -0.01503434032201767, -0.005930754356086254, -0.0022035487927496433, 1.6207372027565725e-05, 0.02545238472521305, 0.017488926649093628, 0.05288517475128174, -0.02189602330327034, 0.023151209577918053, 0.002475505927577615, 0.012823818251490593, -0.0064886147156357765, 0.006387502420693636, -0.018297823145985603, -0.06599489599466324, -0.029706070199608803, 0.035507820546627045, 0.015926916152238846, -0.009093126282095909, -0.02344408631324768, 0.02644258737564087, 0.003922456409782171, -0.017614444717764854, -0.028171954676508904, 0.041281674057245255, 0.01033436506986618, 0.01758655160665512, -0.0031815480906516314, 0.006760571617633104, 0.011973080225288868, -0.0541403591632843, -0.014218469150364399, 0.00806108396500349, -0.02652626670897007, -0.02344408631324768, -0.01082946639508009, -0.025075828656554222, -0.0005234300042502582, 0.014211495406925678, -0.014099923893809319, -0.006579266861081123, 0.01446253340691328, -0.004142113961279392, -0.0071475873701274395, 0.008123842999339104, 0.01665213517844677, 0.003678392618894577, -0.013284052722156048, 0.009504548273980618, -0.01499250065535307, 0.001226421445608139, -0.0060492996126413345, 0.019608795642852783, 0.025703420862555504, -0.010264633223414421, 0.031491223722696304, -0.006882603745907545, -0.02775355987250805, -0.00180781667586416, 0.04719499871134758, -0.002670757006853819, 0.02082214318215847, 0.0340573824942112, -0.020710570737719536, -0.008765382692217827, -0.024476129561662674, 0.014908821322023869, 0.00879327580332756, 0.004591889213770628, 0.008521318435668945, 0.007095288019627333, -0.025801047682762146, 0.032188549637794495, 0.02568947523832321, -0.005435653030872345, -0.05165788158774376, 0.0012490844819694757, 0.006791951600462198, 0.0019368218490853906, 0.03107282891869545, -0.03531256690621376, 0.01291447039693594, 0.013046962209045887, 0.000422535726102069, 0.0015253997407853603, 0.010132141411304474, 0.013311945833265781, 0.0003961681213695556, 0.041281674057245255, -0.0036714193411171436, -0.004246713127940893, 0.024266930297017097, 0.00032316683791577816, 0.02575920708477497, 0.004891739226877689, -0.016833439469337463, 0.01988772675395012, -0.05985843017697334, -0.02838115207850933, -0.006725705228745937, -0.03090547025203705, 0.021017393097281456, 0.0071824537590146065, 0.01635925844311714, 0.043764155358076096, 0.058798495680093765, 0.028102220967411995, -0.007015095558017492, 0.004173493944108486, -0.015118018724024296, 0.00045500494888983667, -0.004068894777446985, 0.018255984410643578, 0.0036609594244509935, -0.010167007334530354, 0.006830304395407438, 0.0020483939442783594, 0.005575118120759726, -0.03600989282131195, 0.03414105996489525, 0.014267281629145145, 0.01078762672841549, -0.029510820284485817, -0.002954917261376977, -0.02945503406226635, -0.005613470915704966, -0.02044558711349964, -0.00213904632255435, -0.0007827479857951403, -0.018911469727754593, 0.002513858722522855, -0.0008459431119263172, 0.012363582849502563, -0.029733963310718536, 0.006628079805523157, -0.005240401718765497, -0.015369056724011898, -0.0013519399799406528, 0.03316480666399002, -0.015243537724018097, -0.018758058547973633, -0.005634390749037266, -0.0001858808536780998, -0.03322059288620949, 0.007077855058014393, 0.012781978584825993, 0.007342838682234287, -0.02582894079387188, -0.024183252826333046, -0.04019384831190109, -0.004717407748103142, -0.022774653509259224, 0.01090617198497057, -0.005003311205655336, -0.004532616585493088, 0.016442937776446342, 0.013897699303925037, 0.0015123249031603336, -0.014797248877584934, -0.004877792671322823, 0.03534046187996864, 0.025954458862543106, 0.008395800366997719, -0.013060908764600754, -0.005386840086430311, 0.07519959658384323, -0.02467137947678566, -0.01573166623711586, 0.01330497208982706, -0.019929565489292145, 0.0006293363403528929, 0.0007343710167333484, 0.00015994906425476074, -0.02651231922209263, 0.006132978480309248, 0.01974826119840145, -0.0013737314147874713, -0.016177954152226448, 0.011136289685964584, 0.010669081471860409, 0.006767544895410538, -0.02104528620839119, 0.021951809525489807, 0.016540562734007835, 0.021017393097281456, 0.00584358861669898, 0.027098072692751884, 0.002505142241716385, 0.011247862130403519, 0.01905093528330326, -0.014406747184693813, -0.014392800629138947, 0.007384678348898888, 0.024727165699005127, 0.0012769774766638875, -0.004720894154161215, -0.01071092113852501, -0.02845088392496109, 0.01091314572840929, -0.03924548625946045, -0.010160033591091633, -0.021380003541707993, 0.0410306379199028, 0.0015942606842145324, -0.017684176564216614, -0.0017363408114761114, 0.0036470128688961267, 0.026791250333189964, 0.020250335335731506, 0.035814642906188965, 0.013549036346375942, -0.013353785499930382, 0.03718139976263046, 0.015313270501792431, 0.017977053299546242, 0.007844912819564342, -0.006181791424751282, 0.009399949572980404, 0.004229279700666666, 0.006202711258083582, 0.0068547106347978115, -0.0019647148437798023, 0.012726192362606525, 0.03653986006975174, 0.006798924412578344, -0.03313691169023514, 0.0035180076956748962, -0.012809871695935726, -0.0027805857826024294, 0.00518810236826539, -0.021533414721488953, 0.001142742345109582, 0.018939362838864326, -0.002756179543212056, 0.03238379955291748, -0.03486628085374832, -0.012189251370728016, -0.03757190331816673, -0.021254483610391617, 0.005446113180369139, 0.004462883807718754, -0.012070706114172935, 0.029092423617839813, 0.009699799120426178, 0.05444718152284622, 0.01672186888754368, 0.00019023913773708045, -0.006955822929739952, -0.0054635461419820786, -0.031574904918670654, 0.018702272325754166, 0.025089776143431664, 0.003312296699732542, -0.031268078833818436, 0.032746411859989166, -0.03377845138311386, 0.010703948326408863, 0.04379204660654068, -0.0011601754231378436, 0.009818344376981258, -0.014546211808919907, 0.006359609309583902, -0.00730797229334712, -0.014560158364474773, -0.01082946639508009, -0.021784452721476555, 0.0017807952826842666, 0.03333216533064842, -0.00817962922155857, -0.02283043973147869, 0.0068930634297430515, -0.021728666499257088, -0.016219792887568474, -0.003946863114833832, -0.006955822929739952, -0.012265956960618496, 0.016470830887556076, 0.009650986641645432, 0.04418255016207695, -0.050625838339328766, 0.02036190778017044, -0.012049786746501923, 0.0589100681245327, 0.018214145675301552, -0.017949160188436508, 0.007398624438792467, 0.014560158364474773, -0.0020989500917494297, -0.003946863114833832, -0.002689933404326439, 0.018939362838864326, -0.011310621164739132, -0.00723126670345664, 0.015564307570457458, -0.00032207724871113896, 0.004497750196605921, 0.031798046082258224, 0.023932214826345444, -0.021561307832598686, 0.009399949572980404, 0.037739261984825134, 0.0029339974280446768, -0.027865130454301834, 0.009351136162877083, 0.010250686667859554, 0.0009562077466398478, 0.02474111318588257, -0.03536835312843323, 0.004825493320822716, -0.008388826623558998, -0.00016245507868006825, 0.0003355879453010857, -0.03308112546801567, 0.03670721873641014, 0.04418255016207695, 0.009853211231529713, 0.020850036293268204, -0.006080679129809141, 0.03539624810218811, -0.001792126800864935, -0.03361109271645546, 0.012628566473722458, -0.020152710378170013, 0.016164006665349007, -0.011554685421288013, 0.011282728053629398, -0.027279376983642578, 0.025731313973665237, 0.020877929404377937, 0.034280527383089066, 0.0031048422679305077, -0.028869280591607094, 0.004368744790554047, -0.0229001734405756, 0.0037237186916172504, -0.0040549482218921185, -0.008883927948772907, -0.004536102991551161, -0.0036644460633397102, -0.008890901692211628, -0.005948187317699194, -0.0027474628295749426, 0.0033244998194277287, -0.007412570994347334, 0.026163656264543533, -0.018562806770205498, -0.027265431359410286, 0.03143543750047684, 0.02366723120212555, 0.012907496653497219, 0.01919040083885193, 0.034419991075992584, 0.019762206822633743, 0.006073705852031708, 0.005732016637921333, 0.011192075908184052, -0.004713920876383781, 0.026582052931189537, 0.013737314380705357, 0.01499250065535307, 0.049928512424230576, 0.009462708607316017, -0.014713570475578308, 0.02143578976392746, 0.017712069675326347, -0.00785885937511921, 0.0008376623736694455, 0.00023295033315662295, 0.002463302807882428, 0.01461594458669424, 0.001161918742582202, -0.014978554099798203, -0.01376520749181509, 0.024001946672797203, 0.0016317418776452541, 0.03037550300359726, -0.021031340584158897, 0.01457410492002964, 0.0035336974542587996, -0.01619189977645874, -0.009776504710316658, 0.02337435446679592, 0.012000973336398602, -0.011401273310184479, -0.013402597978711128, 0.001611693762242794, -0.029706070199608803, 0.040668029338121414, -0.002301174448803067, -0.00928837712854147, -0.001206373330205679, 0.025243187323212624, 0.04189532250165939, 0.0052055357955396175, 0.012503048405051231, 0.010431990958750248, -0.033109020441770554, -0.015508521348237991, -0.02543843723833561, 0.021240537986159325, 0.02150552161037922, -0.017447086051106453, -0.011157209984958172, -0.014079003594815731, 0.008883927948772907, -0.034280527383089066, 0.002062340499833226, 0.00870959646999836, -0.017154209315776825, 0.02720964513719082, 0.04535405710339546, -0.009114045649766922, 0.008737489581108093, -0.02760014683008194, 0.024197198450565338, 0.007196400314569473, 0.0260520838201046, -0.035117316991090775, -0.04326207935810089, 0.030263930559158325, 0.0021285864058882, 0.0131097212433815, -0.002794532338157296, 0.01626163348555565, 0.04334576055407524, -0.008953660726547241, -0.015592200681567192, 0.014741463586688042, -0.0030856658704578876, -0.007705447729676962, 0.0026254309341311455, -0.0357588566839695, 0.007384678348898888, -0.01905093528330326, -0.01934381201863289, -0.005404273513704538, 0.01564798690378666, -0.00107475311961025, -0.026386801153421402, 0.005299674812704325, 0.005637877620756626, 0.012768032029271126, 0.010703948326408863, 0.0033367029391229153, -0.03386213257908821, 0.024490075185894966, -0.015466681681573391, -0.006565320771187544, -0.005836615338921547, 0.018311770632863045, 0.011589551344513893, -0.007161533925682306, -0.02182629145681858, -0.008814195170998573, 0.01518775150179863, -0.009183778427541256, 0.023318568244576454, 0.0014905334683135152, -0.026540212333202362, -0.002086746972054243, 0.007642688695341349, 0.03280219808220863, -0.05076530575752258, -0.030821790918707848, 0.023792749270796776, 0.013123667798936367, 0.0024545860942453146, 0.026805195957422256, -0.011924267746508121, 0.05698544904589653, 0.003918970003724098, -0.037739261984825134, 0.028046436607837677, -0.006056272890418768, -0.003237334080040455, 0.010355285368859768, -0.006471181754022837, -0.0013737314147874713, 0.026582052931189537, 0.021393949165940285, 0.033973705023527145, -0.016791600733995438, 0.01002056896686554, -0.018604647368192673, 0.010724867694079876, -0.017628390341997147, -0.008151736110448837, -0.005313620902597904, 0.01612216793000698, 0.0391618050634861, -0.005338027607649565, -0.026344960555434227, -0.01580139808356762, 0.008033190853893757, -0.01866043359041214, 0.03486628085374832, 0.015940863639116287, 0.03054286167025566, 0.024043787270784378, 0.002470275852829218, 0.010578429326415062, -0.02089187502861023, 0.012558833695948124, 0.03015235997736454, -0.015689825639128685, -0.0005059968680143356, 0.016150061041116714, 0.015355110168457031, 0.00847947970032692, -0.013862833380699158, -0.0002706494997255504, 0.02589867264032364, -0.008549211546778679, -0.019301973283290863, -0.004874305799603462, -0.0032024679239839315, 0.03207697719335556, 0.008312121033668518, 0.0025487251114100218, 0.0019769181963056326, -8.988962508738041e-05, -0.020375853404402733, -0.017600499093532562, -0.012391475960612297, -0.005257835146039724, -0.017251836135983467, -0.02005508355796337, 0.006519994232803583, 0.021338162943720818, -0.027265431359410286, -0.0020832603331655264, -0.012516994960606098, -0.006031866651028395, 0.008521318435668945, -0.01433701440691948, 0.00790767278522253, 0.029510820284485817, 0.015006447210907936, 0.012391475960612297, -0.029650283977389336, -0.023764856159687042, -0.03907812759280205, -0.03015235997736454, 0.05282938852906227, -0.010187926702201366, 0.0005068685277365148, -0.026888875290751457, 0.004563996102660894, -0.01997140608727932, 0.004881279077380896, -0.014239388518035412, -0.009065233170986176, 0.019301973283290863, -0.005529792048037052]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" Open-LLaMA-3B-V2 (Geng and Liu, 2023) as the pretrained model and
use the helpful subset of the Anthropic HH-RLHF dataset (Bai et al., 2022) (see Table 1 for a sample
example). We delete the noisy samples (e.g., with the same chosen and rejected responses), and prompts
19
longer than 400 tokens, and eventually get 103K training set and 5K test set. We also sample a subset
of the UltraFeedback (Cui et al., 2023), consisting of 5K prompts, as another out-of-distribution test set.
Meanwhile, the UltraRM-13B (Cui et al., 2023) will be used as the ground truth reward model, also referred
to as the gold reward, which is trained on a mixture of UltraFeedback, Anthropic HH-RLHF, and other
open-source datasets based on LLaMA2-13B. For all the experiments, we fix the KL penalty in the learning
target Equation (2) as η= 0.1.
Offline Data DoffGeneration and Initial Checkpoint. Following Gao et al. (2023); Coste et al. (2023),
we use the training prompts to generate responses by an Open-LLaMA-3B-V2 model that is fine-tuned on
the preferred responses of the original HH-RLHF dataset4. For each prompt, we generate two responses
and use the UltraRM-13B to label them. After filtering the low-quality responses, we eventually obtain 77K
comparison pairs in training set, 5 .6K pairs as the validation set. We also set 20K samples as the “SFT”
split to get the RLHF starting checkpoint π0.
HH-RLHF Examples
Prompt :
Human: How can I get my girlfriend to cook more?
Assistant: Have you tried reminding her of how nice the food tastes?
Human: I could do it more.
Assistant:
Responses :
Chosen aw:That might work. But you could also explain to her how much you enjoy her cooking and how much you
appreciate her effort. Try pointing out the activities that you think go into making great meals: sourcing the ingredients,
cleaning and preparing the kitchen, etc.
Rejected al: Have you considered making an effort to create more harmonious interactions?
Table 1: An example of HH-RLHF dataset: A prompt-response pair with both chosen and rejected samples.
Setup of offline learning and hybrid learning. For offline learning, we learn from the offline dataset
Doff, and cannot further query human feedback in the training though it is possible to leverage the model
itself to generate more responses. For hybrid learning, we start with a subset of Doff, consisting of 25K
comparison pairs, and then fix the budget of online human feedback as 52K, leading to a total number of
queries consistent with the offline learning for a fair comparison. For all the hybrid algorithms, we will iterate
for three steps.
Method, Competitor and Evaluation. In our experiments, we compare the performance of the following
algorithms.
•SFT on the preferred samples;
•Offline DPO (Rafailov et al., 2023);
•RSO (Liu et al., 2023a);
•Hybrid-GSHF-DPO where we adopt the DPO as the computational oracle (this work);
•Multi-step RSO (this work).
The representative models of different RLHF methods will be measured by the gold reward of UltraRM-13B
and the KL divergence Ex∼d0DKL(π(·|x)∥π0(·|x)), which are both evaluated on the split test set.
4While it is possible to include other high-quality dialog datasets from Chat-GPT (like ShareGPT), we decide not to do
this in this round of experiment. The use of GPT4-generated datasets will make our verification noisy because it is more like
distillation and may not scale to larger models. However, we do observe in some preliminary experiments that in the distillation
scenario, the proposed algorithms offer even more gains.
20
Models Settings Gold Reward Gold Win Rate GPT4 Eval OOD Gold Reward Difference ∆↓ OOD Gold Win Rate OOD GPT4 Eval
SFT Offline 0.27 - - -0.21 0.48 - -
DPO Offline 2.15 0.5 0.5 1.71 0.44 0.5 0.5
RSO Offline 2.25 0.54 0.53 1.89 0.36 0.55 0.52
Multi","[-0.024653127416968346, -0.005923437420278788, 0.0547136627137661, -0.016294904053211212, 0.029420949518680573, -0.027560336515307426, -0.029101157560944557, 0.06302828341722488, 0.01026244554668665, 0.027313223108649254, 0.03764835000038147, -0.035962168127298355, -0.02069932408630848, -0.008648945018649101, 0.01253733690828085, -0.02799641713500023, 0.02497292123734951, -0.0601792149245739, -0.04418956860899925, 0.02917383797466755, 0.0022712566424161196, 0.0009266727138310671, 0.0168472733348608, 0.0017615866381675005, 0.018838711082935333, -0.00321428244933486, -0.003374178893864155, -0.0002487025922164321, -0.004564317408949137, -0.008547193370759487, 0.012689964845776558, -0.03256073594093323, -0.05433572828769684, -0.02788013033568859, -0.001007529441267252, 0.05023656412959099, 0.012108523398637772, 0.034682996571063995, -0.014049084857106209, 0.0013327733613550663, -0.014419754035770893, -0.051079653203487396, -0.03500279039144516, -0.0015390034532174468, -0.015713462606072426, 0.025946835055947304, 0.05442294478416443, 0.00938301533460617, 0.01748685911297798, 0.01285712979733944, -0.07169175893068314, 0.06895898282527924, -0.03174671530723572, -0.021571487188339233, 0.025917762890458107, -0.0419510193169117, 0.003043483942747116, -0.007515133824199438, 0.01558263786137104, -0.04055555909872055, -0.011846874840557575, -0.028199922293424606, 0.03064197674393654, 0.020437676459550858, -0.013547591865062714, -0.015786143019795418, -0.08186699450016022, 0.003346923738718033, 0.034595780074596405, 0.03947989270091057, -0.012064915150403976, 0.009252190589904785, 0.03965432196855545, -0.041166070848703384, -0.019914377480745316, 0.012064915150403976, 0.03410155698657036, 0.04764914885163307, -0.006254132371395826, -0.046631623059511185, -0.006733821704983711, -0.029377341270446777, 0.005643618293106556, -0.027792913839221, 0.008866986259818077, -0.052097175270318985, -0.04349184036254883, -0.0020168758928775787, -0.04587575048208237, -0.023388491943478584, -0.036979690194129944, -0.018838711082935333, 0.004110066220164299, -0.0027709330897778273, 0.02616487629711628, -0.04174751415848732, -0.006126942113041878, 0.007013640366494656, 0.023839110508561134, 0.041892874985933304, 0.018359022215008736, -0.043433696031570435, 0.009121366776525974, -0.008830646052956581, 0.04058463126420975, 0.01194862648844719, 0.015364596620202065, 0.03747391700744629, -0.0012473741080611944, 0.008125647902488708, -0.053637996315956116, -0.011359916999936104, -0.08361131697893143, -0.01651294343173504, 0.001893319538794458, -0.028548788279294968, -0.05881282687187195, -0.0227779783308506, -0.0191439688205719, -0.017835723236203194, -0.046718839555978775, 0.027458583936095238, 0.02915930189192295, -0.0031397852580994368, 0.0205248910933733, 0.01622222363948822, 0.015030267648398876, -0.05506252869963646, -0.02378096617758274, -0.005712664686143398, 0.0026455598417669535, 0.02561250701546669, -0.02588869072496891, -0.03930545970797539, -0.03299681469798088, 0.01931839995086193, -0.036514539271593094, -0.004549781326204538, -0.028505180031061172, -0.021716848015785217, -0.027763841673731804, -0.055847473442554474, -0.054481085389852524, 0.030322184786200523, -0.0720406249165535, -0.015335524454712868, -0.03985782712697983, -0.018795102834701538, -0.05389964580535889, 0.04299761354923248, -0.015422740951180458, -0.0016834554262459278, -0.02716786414384842, 0.0428231805562973, 0.021586023271083832, -0.02524910494685173, -0.0346248522400856, 0.033229392021894455, 0.0026346577797085047, -0.029333733022212982, 0.024740343913435936, 0.009339407086372375, -0.013889188878238201, -0.01888231933116913, 0.01508841197937727, 0.008939665742218494, 0.011752390302717686, 0.013140582479536533, -0.07052887976169586, -0.027414975687861443, 0.018838711082935333, 0.02161509543657303, -0.0200452022254467, -0.013438571244478226, -0.032502591609954834, -0.03363640233874321, 0.003067104844376445, -0.002772750100120902, 0.008241935633122921, -0.030700121074914932, 0.0017970182234421372, 0.02725507877767086, -0.02479848824441433, -0.013191458769142628, -0.024682199582457542, -0.015655318275094032, -0.0014436107594519854, -0.032037436962127686, 0.02024870738387108, 0.03247351944446564, 0.04596296697854996, -0.0006486708880402148, 0.06372600793838501, -0.0032469884026795626, -0.007010006345808506, -0.04636997729539871, 0.06971485912799835, 0.020379532128572464, -0.004502539057284594, -0.004001045599579811, 0.018097372725605965, 0.03561330586671829, -0.007638690527528524, -0.08163441717624664, 0.03639825060963631, -0.023926325142383575, -0.01969633810222149, -0.01299522165209055, -0.010044405236840248, 0.03043847344815731, 0.05578932911157608, 0.05671963840723038, 0.047823578119277954, 0.024900240823626518, -0.03107805922627449, 0.016294904053211212, -0.04857945442199707, 0.005153026897460222, 0.023301275447010994, 0.03602031245827675, 0.015059339813888073, 0.025234568864107132, 0.013758364133536816, 0.021033653989434242, -0.0042118183337152, 0.03392712399363518, 0.022647153586149216, -0.03398526832461357, 0.019623657688498497, -0.06808682531118393, 0.030060535296797752, -0.002660095691680908, -0.020583035424351692, -0.03509000688791275, 0.024217046797275543, -0.019362008199095726, 0.01822819747030735, -0.0163966566324234, 0.013961868360638618, -0.043520912528038025, 0.012064915150403976, 0.028025489300489426, 0.044538434594869614, -0.01053136307746172, 0.04474193975329399, 0.013867384754121304, -0.015713462606072426, -0.054917167872190475, 0.019928913563489914, -0.020815612748265266, 0.02362106926739216, -0.032589808106422424, -0.008329152129590511, -0.040148548781871796, -0.020103346556425095, 0.010487754829227924, -0.019173039123415947, -0.008300079964101315, -0.06878454983234406, 0.005356531590223312, -0.051544807851314545, 0.00013093794404994696, 0.006043359637260437, 0.061749108135700226, 0.004179112147539854, -0.007464258000254631, -0.03334568068385124, 0.0075296699069440365, -0.03811350464820862, -0.022022103890776634, -0.014150837436318398, 0.03346196934580803, 0.048724815249443054, 0.01221027597784996, -0.04820151627063751, -0.058929115533828735, 0.02899940498173237, 0.032677024602890015, -0.027138791978359222, -0.026470134034752846, -0.02170231193304062, 0.016730984672904015, 0.03270609676837921, 0.0033251196146011353, 0.009644663892686367, -0.008859718218445778, 0.021934887394309044, -0.014732278883457184, -0.014245321974158287, 0.014826763421297073, 0.008082039654254913, -0.04046834260225296, 0.055847473442554474, -0.045614100992679596, 0.01786479540169239, -0.009317602962255478, 0.03125249221920967, 0.012173935770988464, 0.004760554060339928, 0.010589506477117538, 0.04090442508459091, 0.03602031245827675, -0.040061332285404205, 0.026949822902679443, 0.033229392021894455, 0.02952270209789276, -0.005156660918146372, -0.00011214329424547032, -0.005113053135573864, -0.007631422486156225, -0.029653526842594147, 0.020830148831009865, -0.0008221949101425707, 0.029057549312710762, 0.011527081951498985, -0.018300877884030342, 0.05677778273820877, -0.0033850809559226036, 0.020016130059957504, -0.03854958340525627, -0.03491557389497757, -0.040235765278339386, -0.006693847477436066, 0.014710474759340286, 0.018838711082935333, -0.02607765980064869, 0.02334488369524479, -0.036136601120233536, -0.050730787217617035, -0.007893071509897709, -6.172139546833932e-05, -0.008961469866335392, 0.02514735423028469, -0.0138964569196105, 0.026571884751319885, 0.004164576064795256, -0.04985862597823143, 0.027792913839221, 0.03447949141263962, 0.016730984672904015, -0.04340462386608124, -0.013540323823690414, -0.035787735134363174, 0.022443650290369987, -0.025496218353509903, 0.0023457538336515427, 0.02286519482731819, 0.026368381455540657, 0.03619474545121193, 0.014390681870281696, -0.01444882620126009, -0.00792941078543663, -0.005618180613964796, 0.0002632386458572, 0.0017824822571128607, -0.008554461412131786, -0.012137595564126968, -0.04482915624976158, -0.0008889698656275868, -0.004375348798930645, -0.011374453082680702, 0.05232975259423256, 0.009608323685824871, -0.007624154444783926, 0.037677422165870667, 0.04482915624976158, -0.010378734208643436, 0.0024129829835146666, 0.015568101778626442, -0.03000239096581936, -0.013009757734835148, 0.01349671557545662, -0.026760853826999664, 0.021309837698936462, -0.0766340121626854, 0.014027280732989311, 0.06128395348787308, 0.012450120411813259, 0.0037975411396473646, 0.030322184786200523, -0.021484270691871643, 0.0036467297468334436, -0.019928913563489914, -0.038869377225637436, -0.006737455725669861, 0.02287973091006279, -0.01924571953713894, -0.012878933921456337, -0.047823578119277954, -0.01189775113016367, -0.012421048246324062, -0.02453683875501156, -0.03325846418738365, 0.005690860562026501, 0.01805376447737217, 0.006523048970848322, -0.01317692268639803, 0.05131223052740097, 0.043898846954107285, 0.06802868098020554, -0.015306452289223671, -0.020902829244732857, -0.06401672959327698, 0.014565114863216877, -0.02625209279358387, 0.03145599737763405, -0.016701912507414818, 0.03671804443001747, 0.02197849564254284, 0.03683433309197426, 0.030322184786200523, -0.015044803731143475, 0.028403427451848984, -0.03764835000038147, 0.011454401537775993, -0.007813123054802418, 0.014913979917764664, 0.003336021676659584, 0.03770649433135986, 0.056516133248806, -0.011955894529819489, -0.05122501403093338, -0.01285712979733944, -0.021266229450702667, -0.022487258538603783, 0.02815631404519081, 0.017210673540830612, -0.005705396644771099, 0.001929659629240632, -0.02789466455578804, -0.06041179224848747, 0.05488809570670128, 0.06622620671987534, -0.04209638014435768, -0.06366786360740662, -0.002233099425211549, 0.013191458769142628, 0.009230387397110462, -0.00027595768915489316, -0.0163966566324234, 0.06267941743135452, -0.0005918894894421101, -0.012689964845776558, -0.01978355459868908, -0.0474165715277195, 0.0001501300575910136, 0.017545003443956375, 0.02305416390299797, 0.01676005683839321, 0.004498905036598444, -0.04154400900006294, -0.017806652933359146, 0.05753365531563759, 0.02177499234676361, 0.007053614594042301, -0.040061332285404205, 0.07593628764152527, 0.00064685387769714, 0.04145679250359535, 0.026455597952008247, 0.02817085012793541, -0.00824920367449522, -0.006046993657946587, 0.013990940526127815, 0.010829351842403412, 0.02242911420762539, 0.007413381710648537, 0.012864397838711739, 0.011759658344089985, 0.00727165536954999, -0.016919953748583794, -0.05785344913601875, -0.010276981629431248, -0.0173269622027874, -0.020394068211317062, -0.04113699868321419, 0.014848567545413971, -0.015786143019795418, 0.009252190589904785, 0.010633114725351334, 0.034682996571063995, -0.0009675553301349282, 0.008474512957036495, 0.013126046396791935, 0.03953803703188896, 0.04090442508459091, 0.031310636550188065, -0.029115693643689156, -0.026135804131627083, -0.016382120549678802, 0.014514238573610783, -0.02469673566520214, 0.02298148348927498, -0.018475310876965523, -0.003419603919610381, -0.014703206717967987, -0.0026491936296224594, 0.031223420053720474, -0.026004979386925697, 0.00409916415810585, 0.013285942375659943, -0.025118282064795494, -0.020379532128572464, 0.03657268360257149, 0.006908254232257605, 0.01594603806734085, -0.003108896082267165, -0.045265235006809235, -0.020437676459550858, -0.007293459493666887, -0.018097372725605965, 0.009993528947234154, -0.005447382107377052, 0.007017274387180805, 0.009899045340716839, 0.01612047106027603, -0.028461571782827377, 0.013147850520908833, -0.01594603806734085, 0.05796973779797554, -0.010960175655782223, -0.001629853737540543, -0.028505180031061172, -0.004938620608299971, 0.010371466167271137, 0.004789625760167837, -0.01130904071033001, -0.11471844464540482, -0.040962569415569305, -0.009913580492138863, 0.014259858056902885, 0.00028754110098816454, 0.030845481902360916, 0.01876603066921234, -0.025409001857042313, -0.0196091216057539, -0.02177499234676361, -0.01694902591407299, -0.026223020628094673, -0.03907288238406181, 0.022167464718222618, 0.03491557389497757, 0.004815063904970884, -0.0013736559776589274, 0.01859159767627716, -0.02798188105225563, 0.046806056052446365, -0.013976404443383217, -0.014405217953026295, 0.005607278551906347, 0.05788252130150795, -0.05660334974527359, -0.010378734208643436, -0.02286519482731819, -0.03128156438469887, -0.0005264772917144, -7.211240153992549e-05, -0.023039627820253372, 0.013918261043727398, 0.007031810469925404, 0.02642652578651905, -0.009688272140920162, 0.008794305846095085, 0.011178216896951199, -0.02407168596982956, 0.012406512163579464, 0.013380426913499832, 0.013554859906435013, -0.001911489525809884, 0.03308403119444847, -0.02927558869123459, -0.00017352400755044073, 0.03727041184902191, -0.04200916364789009, 0.004480734933167696, -0.014550578780472279, 0.034217845648527145, 0.02853425219655037, 0.03654361143708229, 0.02708064764738083, -0.019274791702628136, -0.044625651091337204, -0.019478296861052513, 0.00875796563923359, -0.03035125695168972, 0.0035449774004518986, 0.012057647109031677, 0.028854044154286385, -0.03424691781401634, 0.02315591648221016, 0.033316608518362045, -0.012362903915345669, 0.013213262893259525, -0.009688272140920162, -0.014565114863216877, 0.0016244027065113187, -0.0015680756187066436, 0.004160942044109106, 0.002334851771593094, -0.029566310346126556, 0.028854044154286385, 0.019725410267710686, -0.0003588585532270372, -0.021862206980586052, -0.02788013033568859, 0.04904460906982422, 0.00011214329424547032, -0.014368877746164799, 0.015451813116669655, -0.016658304259181023, -0.009542912244796753, -0.021091798320412636, 0.001307335332967341, -0.03447949141263962, -0.042067307978868484, 0.004713311791419983, -0.012922542169690132, 0.038782160729169846, 0.03427598625421524, -0.010822083801031113, -0.032967742532491684, -0.002285792725160718, 0.002502016257494688, -0.016919953748583794, 0.01787933148443699, 0.00875069759786129, -0.017646756023168564, -0.010480486787855625, -0.017443250864744186, -0.002418434014543891, -0.05357985198497772, -0.005625448655337095, 0.006083333864808083, -0.01660015992820263, 0.0013046098174527287, 0.021455198526382446, 0.011788730509579182, 0.005185733083635569, 0.010654918849468231, -0.03256073594093323, 0.013533055782318115, 0.010814815759658813, 0.008132915943861008, -0.03904381021857262, 0.017443250864744186, -0.004233622457832098, 0.004731481894850731, -0.03712505102157593, -0.021193549036979675, -0.045992039144039154, -0.03657268360257149, -0.03610752895474434, -0.008205596357584, 0.005272949580103159, 0.03526443988084793, 0.022807050496339798, -0.0016425728099420667, 0.0055963764898478985, -0.022574473172426224, -0.0309908427298069, -0.027662089094519615, -0.00025574350729584694, -0.02142612636089325, 0.002527454402297735, -0.012617284432053566, 0.05544046685099602, 0.004295400343835354, 0.07430824637413025, -0.00051602948224172, -0.017196137458086014, 0.002959901699796319, -0.01476135104894638, 0.02936280518770218, -0.0028890385292470455, -0.015030267648398876, -0.015117484144866467, 0.006076065823435783, -0.04985862597823143, -0.012457388453185558, 0.026004979386925697, -0.027007967233657837, 0.00453524524345994, -0.038782160729169846, -0.023214058950543404, -0.008052967488765717, -0.008387296460568905, 0.0547136627137661, -0.03674711659550667, -0.007580546196550131, -0.0032833286095410585, -0.017530467361211777, -0.011025588028132915, -0.007994823157787323, -0.008103843778371811, 0.015539029613137245, 0.02971167117357254, -0.006781063973903656, 0.06099323555827141, -0.01034966204315424, -0.08192513883113861, -0.014528774656355381, 0.004953156691044569, 0.010451414622366428, 0.00770410243421793, -0.026775389909744263, -0.011766926385462284, -0.023228595033288002, 0.042619675397872925, 0.05494624003767967, -0.02535085752606392, -0.008707089349627495, -0.013772900216281414, -0.003083457937464118, 0.01293707825243473, 0.017574075609445572, 0.007402479648590088, 0.01831541396677494, 0.003975607454776764, 0.013860116712749004, -0.028010953217744827, -0.01814098097383976, -0.0026909848675131798, -0.005977947264909744, 0.013220530934631824, -0.01074940338730812, -0.0030398499220609665, -0.03756113350391388, 0.0013627540320158005, -0.045614100992679596, -0.007119026966392994, 0.036863405257463455, 0.023475708439946175, 0.002165870275348425, -0.03663082793354988, -0.019827160984277725, -0.00039270028355531394, -0.028374355286359787, -0.010713063180446625, 0.01924571953713894, 0.0048041618429124355, 0.022123856469988823, -0.003505003172904253, -0.017443250864744186, 0.019623657688498497, -0.0028617833741009235, -0.029973318800330162, 0.018925927579402924, 0.030060535296797752, -0.0029035743791610003, -0.00042040960397571325, -0.027473120018839836, 0.014194445684552193, -0.008300079964101315, -0.00537833571434021, 0.017370570451021194, -0.007871267385780811, 0.013743828050792217, -0.004938620608299971, -0.028694147244095802, 0.018577061593532562, 0.006432198919355869, 0.011977698653936386, 0.002238550456240773, 0.012719037011265755, 0.01363480743020773, -0.002905391389504075, -0.018722422420978546, -0.009346675127744675, 0.004131869878619909, -0.02205117605626583, -0.03439227491617203, -0.023228595033288002, 0.0023130476474761963, 0.018068300560116768, 0.05166109651327133, -0.029479093849658966, 0.033403825014829636, 0.013140582479536533, -0.007082686759531498, -0.010247910395264626, 0.002990790642797947, -0.010247910395264626, -0.0022621715907007456, -0.03000239096581936, -0.007813123054802418, 0.013053365983068943, -0.01340223103761673, -0.001859704963862896, 0.0006686579436063766, -0.02917383797466755, 0.014194445684552193, -0.008910593576729298, -0.0020441310480237007, -0.002071385970339179, 0.018286341801285744, 0.05052728205919266, -0.03125249221920967, -0.12733572721481323, -0.017893867567181587, 0.02415890246629715, -0.02269076183438301, 0.02141159027814865, -0.013540323823690414, 0.011200021021068096, 0.009760952554643154, -0.012057647109031677, -0.019565513357520103, 0.020205099135637283, -0.02962445467710495, 0.0028999403584748507, -0.0116215655580163, -0.01275537721812725, -0.0446547232568264, 0.006824671756476164, 0.007249851245433092, 0.028476107865571976, -0.031688570976257324, -0.018824175000190735, -0.02168777585029602, 0.036601755768060684, 0.00035817717434838414, -0.0305256899446249, -0.03125249221920967, 0.010218838229775429, 0.003027130849659443, -0.008009359240531921, -0.021949423477053642, -0.008866986259818077, 0.005996117368340492, 0.013729291968047619, -0.012101255357265472, -0.05276583507657051, -0.0259904433041811, -0.021367982029914856, 0.006864645984023809, -0.00274549494497478, 0.014470630325376987, 0.02334488369524479, -0.02715332806110382, 0.051283158361911774, -0.01814098097383976, 0.032037436962127686, -0.02215292863547802, 0.008031163364648819, -0.0006550304242409766, 0.011352648958563805, 0.012333831749856472, 0.04724213853478432, 0.01194862648844719, -0.011585226282477379, -0.00505490880459547, -0.00956471636891365, 0.04113699868321419, 0.016730984672904015, 0.01895499974489212, -0.005127588752657175, -0.0011120073031634092, -0.035409800708293915, 0.0337526910007, 0.018257269635796547, -0.03244444727897644, -0.024856632575392723, -0.02687714248895645, -0.02945002168416977, 0.021353445947170258, -0.025001993402838707, -0.03538072854280472, -0.013424035161733627, 0.025031065568327904, 0.025089209899306297, 0.007631422486156225, -0.00401194766163826, 0.012515532784163952, 0.034217845648527145, 0.03363640233874321, -0.019463760778307915, 0.02132437378168106, 0.030845481902360916, -0.055178817361593246, 0.0250746738165617, 0.017733972519636154, -0.0074061136692762375, 0.040788136422634125, 0.024667663499712944, -0.0017970182234421372, -0.010138889774680138, 0.01924571953713894, 0.025641579180955887, -0.03163042664527893, 0.0018806004663929343, 0.0007740442524664104, -0.005229341331869364, -0.03901473805308342, -0.019303863868117332, 0.0013736559776589274, 0.03116527572274208, -0.002754579996690154, 0.02069932408630848, 0.03308403119444847, -0.03657268360257149, 0.0074242837727069855, 0.013525787740945816, 0.021673239767551422, 0.0025619775988161564, 0.023999005556106567, 0.0364563949406147, -0.028141777962446213, 0.0020659349393099546, 0.04686420038342476, -0.0287086833268404, 0.023403028026223183, -0.02687714248895645, 0.046340905129909515, 0.05122501403093338, -0.006039725616574287, 0.013373158872127533, 0.012413780204951763, 0.02460951916873455, 0.019216647371649742, -0.022269217297434807, 0.0017752142157405615, -0.010051673278212547, 0.00578534509986639, -0.012842593714594841, 0.012682696804404259, -0.012522800825536251, 0.039421748369932175, 0.02415890246629715, -0.010793011635541916, 0.012253884226083755, 0.011374453082680702, -0.01275537721812725, 0.03773556649684906, 0.02799641713500023, -0.002640108810737729, -0.028316210955381393, 0.02389725297689438, 0.0074933297000825405, 0.013990940526127815, 0.025932298973202705, -0.0073879435658454895, -0.02196395955979824, 0.007776782847940922, 0.01722520962357521, -0.01942015253007412, -0.040788136422634125, 0.013467643409967422, 0.014615991152822971, -0.033142175525426865, -0.016716448590159416, 0.008074771612882614, 0.009840901009738445, 0.027676625177264214, 0.020452212542295456, -0.04311390221118927, -0.005040372721850872, -0.001327322330325842, 0.018344486132264137, 0.03910195454955101, 0.018620669841766357, -0.021527878940105438, 0.050643570721149445, -0.03793907165527344, -0.006192354019731283, 0.012871665880084038, -0.0006950045353733003, 0.023853646591305733, -0.02014695480465889, -0.042881324887275696, 0.020655715838074684, 0.002968986751511693, 0.021179012954235077, 0.01997252181172371, -0.0066865794360637665, 0.0007227138848975301, 0.002136798342689872, 0.056457988917827606, -0.010480486787855625, 0.04038112610578537, 0.008830646052956581, -0.01796654798090458, 0.03151414170861244, -0.021280765533447266, -0.0006768344901502132, 0.03183393180370331, -0.002914476441219449, 0.02616487629711628, 0.0205248910933733, 0.04546874016523361, 0.015117484144866467, 0.02024870738387108, 0.02042314037680626, -0.010306053794920444, 0.028606930747628212, 0.02862146683037281, -0.045904822647571564, -0.05070171505212784, 0.0014481532853096724, 0.0719824805855751, 0.014267126098275185, -0.010415074415504932, -0.020161490887403488, 0.0035304413177073, -0.01976901851594448, -0.024754879996180534, -0.019303863868117332, 0.03224094212055206, 0.002783652162179351, 0.009492035955190659, -0.02879589982330799, -0.0039792414754629135, 0.0019223915878683329, -0.015335524454712868, 0.007863999344408512, -0.002274890663102269, -0.027821986004710197, -0.03817164897918701, -0.03526443988084793, -0.023461172357201576, 0.01042961049824953, 0.035409800708293915, -0.012595481239259243, -0.02178952842950821, 0.01025517750531435, -0.0031070790719240904, 0.022559937089681625, 0.02189127914607525, -0.0034159698989242315, -0.021469734609127045, -0.004796893801540136, 0.003664899617433548, -0.027400439605116844, -0.024187974631786346, 0.0023130476474761963, -0.0023294007405638695, 0.000486957433167845, 0.0021295303013175726, 0.05203903093934059, 0.004600657615810633, -0.0011637918651103973, -0.01614954322576523, 0.030845481902360916, 0.023853646591305733, 0.031397853046655655, 0.015553565695881844, -0.037328556180000305, -0.006145111750811338, -0.02142612636089325, 0.0019750846549868584, 0.01025517750531435, -0.010676722973585129, 0.006061529740691185, 0.008285543881356716, -0.001836992334574461, 0.03727041184902191, 0.03346196934580803, 0.014804959297180176, -0.03506093472242355, 0.03171764314174652, 0.006759259849786758, -0.005447382107377052, 0.008714357390999794, -0.023853646591305733, -0.01596057415008545, 0.026135804131627083, 0.02379550226032734, -0.005014934577047825, -0.020350459963083267, 0.012915274128317833, 0.0034523101057857275, 0.032415375113487244, 0.0018787834560498595, -0.0017007170245051384, 0.03235723078250885, -0.0012927992502227426, 0.028112705796957016, 0.005421943962574005, -0.015015731565654278, 0.018097372725605965, -0.01696356199681759, 0.011861410923302174, 0.006679311394691467, -0.035497017204761505, 0.014746814966201782, -0.015248308889567852, 0.03151414170861244, 0.024551374837756157, 0.04122421517968178, 0.047736361622810364, -0.004567951429635286, -0.005799880716949701, -0.0024020809214562178, -0.006701115518808365, 0.014005476608872414, 0.017385106533765793, 0.03043847344815731, -0.009731880389153957, 0.01988530531525612, 0.03064197674393654, 0.026833534240722656, -0.0409916415810585, 0.03657268360257149, 0.005530964117497206, 0.003982875496149063, -0.029973318800330162, 0.008866986259818077, -0.0113962572067976, -0.025539826601743698, 0.013467643409967422, 0.0227925144135952, -0.017254281789064407, -0.03520629554986954, -0.016803665086627007, 0.009819096885621548, -0.010451414622366428, -0.021804064512252808, 0.015030267648398876, -0.00610513798892498, -0.008321884088218212, 0.017893867567181587, 0.025917762890458107, -0.012428316287696362, -0.006330446340143681, -0.010189766064286232, 0.01668737642467022, 0.009462963789701462, -0.0011192752281203866, -0.00024052607477642596, -0.00801662728190422, -0.011970430612564087, 0.003027130849659443, -0.051922742277383804, -0.004724213853478432, -0.058027882128953934, -0.008765233680605888, -0.010320589877665043, -0.010327857919037342, 0.021222621202468872, 0.010095281526446342, -0.014746814966201782, -0.019274791702628136, 0.0031833932735025883, 0.02478395216166973, -0.019085824489593506, 0.005821684841066599, 0.0010347844799980521, -0.0007540571969002485, 0.0756455659866333, -0.0009007803746499121, -0.01348944753408432, 0.004934986587613821, -0.022007567808032036, 0.018446238711476326, -3.872492379741743e-05, 0.013831044547259808, -0.013613003306090832, 0.01694902591407299, -0.010465950705111027, 0.002427519066259265, -0.006570291239768267, 0.014899443835020065, 0.01421624980866909, 0.023940861225128174, -0.01613500714302063, 0.024900240823626518, 0.041892874985933304, 0.01348944753408432, 0.005858025047928095, 0.017065314576029778, 0.013620271347463131, -0.0003856593684758991, 0.011934090405702591, 0.035962168127298355, 0.012595481239259243, 0.025379929691553116, 0.03415970131754875, 0.04256153106689453, 0.015059339813888073, -0.03215372562408447, -0.03270609676837921, 0.024275191128253937, -0.05898725986480713, -0.006097869947552681, -0.009695540182292461, 0.03328753635287285, 0.010676722973585129, -0.012297491542994976, -0.015597173944115639, -0.017792116850614548, 0.016890881583094597, 0.01052409503608942, 0.0037648349534720182, 0.020713860169053078, -0.011381721124053001, 0.012079451233148575, 0.017995620146393776, -0.005156660918146372, 0.007834927178919315, -0.011926823295652866, 0.002238550456240773, -0.013642075471580029, 0.02423158288002014, -0.02132437378168106, 0.0017161614960059524, 0.02132437378168106, 0.009346675127744675, 0.022356433793902397, -0.03712505102157593, -0.005908901337534189, -0.02197849564254284, 0.003957437351346016, -0.015364596620202065, -0.03401434049010277, -0.013096974231302738, 0.023126844316720963, -0.042619675397872925, 0.022559937089681625, -0.027574872598052025, 6.0472208133433014e-05, -0.0195945855230093, -0.01632397621870041, -0.0033432897180318832, 0.01317692268639803, -0.023533852770924568, 0.011374453082680702, 0.03389805182814598, 0.021353445947170258, 0.007100856862962246, 0.009819096885621548, -0.020990045741200447, -0.014586918987333775, -0.016018718481063843, -0.0019987057894468307, 0.010495022870600224, -0.0005187549977563322, -0.028577858582139015, 0.0086634811013937, -0.008394564501941204, 0.01614954322576523, 0.05814417079091072, 0.021455198526382446, -0.029144765809178352, 0.00578897912055254, -0.00758781423792243, 0.03910195454955101, 0.0013745644828304648, -0.012653624638915062, -0.00537470169365406, 0.00793667882680893, 0.03445041924715042, 0.002725508064031601, -0.037968143820762634, -0.002545624505728483, -0.03953803703188896, 0.006021555513143539, -0.0006018829881213605, 0.003541343379765749, -0.014092693105340004, -0.015916965901851654, 0.012820789590477943, 0.03901473805308342, -0.018213661387562752, 0.019303863868117332, -0.002765482058748603, 0.05087614804506302, 0.019260255619883537, -0.016193151473999023, 0.019899841398000717, 0.020074274390935898, 0.01298795361071825, 0.01213032752275467, -0.005618180613964796, -0.0025746964383870363, -0.005941607523709536, -0.02633930929005146, 0.0041754781268537045, -0.007464258000254631, -0.015887893736362457, -0.0035104542039334774, 0.020655715838074684, -0.0056981286033988, 0.0076532261446118355, 0.017370570451021194, -0.009739148430526257, -0.05631262809038162, -0.005778077058494091, -4.819322839466622e-06, 0.02453683875501156, 0.030205896124243736, -0.015597173944115639, -0.0009348492021672428, 0.016207687556743622, -0.006370420567691326, -0.005941607523709536, -0.001072941580787301, 0.03116527572274208, 0.021993031725287437, 0.0035631475038826466, 0.006871914025396109, 0.0163966566324234, 0.038229793310165405, -0.004702409729361534, 0.003728494979441166, 0.010894764214754105, -0.022283753380179405, 0.014085425063967705, 0.002427519066259265, 0.015539029613137245, -0.016004182398319244, 0.0038375151343643665, 0.016978098079562187, 0.03863679990172386, 0.0063849566504359245, -0.019362008199095726, 0.01358393207192421, -0.0009430257487110794, 0.02350478060543537, 0.016701912507414818, -0.01308243814855814, -0.0084236366674304, -0.013460375368595123, 0.0011937725357711315, 0.007307995576411486, -0.012421048246324062, 0.022007567808032036, -0.034944646060466766, -0.007558742072433233, -0.013249603100121021, -0.009608323685824871, 0.010618578642606735, 0.013358622789382935, 0.0067410897463560104, -0.006090601906180382, 0.019928913563489914, 0.010582239367067814, 0.016890881583094597, -0.003968339413404465, -0.004509807098656893, -0.03081640973687172, 0.024289727210998535, 0.013591200113296509, 0.021222621202468872, 0.07640144228935242, -0.005992483347654343, 0.008401832543313503, 0.030583832412958145, 0.022182000800967216, -0.01526284497231245, -0.017181601375341415, 0.004444395191967487, 0.002316681668162346, -0.015393668785691261, 0.008467244915664196, -0.011105536483228207, -0.005516428034752607, 0.014557846821844578, -0.003541343379765749, 0.04017762094736099, 0.010095281526446342, 0.008329152129590511, 0.01878056675195694, 0.004455296788364649, -0.011781462468206882, 0.005538232158869505, 0.026382917538285255, -0.01878056675195694, -0.010306053794920444, -0.001695265993475914, -0.009244922548532486, 0.03398526832461357, -0.003663082607090473, 0.008067503571510315, -0.0013836495345458388, 0.052911195904016495, 0.026223020628094673, 0.006126942113041878, 0.024202510714530945, 0.012159399688243866, -0.04520709067583084, 0.00033955287653952837, 0.003223367501050234, -0.009949920699000359, 0.015132020227611065, -0.01171605009585619, 0.008881522342562675, 0.005323825404047966, 0.018751494586467743, -0.03790999948978424, 0.021644167602062225, 0.011781462468206882, 0.009978992864489555, -0.03808443248271942, 0.054190367460250854, 0.020815612748265266, 0.05840582028031349, -0.025961371138691902, 0.01307517010718584, 0.02170231193304062, 0.009637395851314068, -0.016294904053211212, -0.03163042664527893, 0.03145599737763405, -0.055585827678442, -0.00011515271035023034, -0.025409001857042313, -0.016556551679968834, 0.019391080364584923, -0.02260354533791542, -0.024115294218063354, -0.009172243066132069, -0.011970430612564087, -0.02991517446935177, 0.024275191128253937, -0.04119514301419258, -0.025103745982050896, -0.0066502392292022705, 0.00017931571346707642, 0.0009884508326649666, 0.0075660101138055325, 0.00019464669458102435, 0.0003706690913531929, -0.015059339813888073, 0.020394068211317062, 0.0019314766395837069, -0.013155118562281132, 0.007151732686907053, -0.01796654798090458, 0.0278074499219656, 0.0039101955480873585, -0.026382917538285255, 0.0013037013122811913, 0.013503983616828918, 0.02487116865813732, 0.003801175160333514, -0.032415375113487244, -0.004815063904970884, 0.012515532784163952, -0.04276503622531891, 0.021760456264019012, 0.006308642216026783, -0.012973417527973652, -0.005193001125007868, 0.023388491943478584, 0.01696356199681759, -0.02398446947336197, -0.02761848084628582, 0.014427022077143192, -0.0013064268277958035, -0.02042314037680626, 0.04171844199299812, 0.005291119683533907, 0.03445041924715042, 0.014884907752275467, -0.03837515041232109, 0.027662089094519615, -0.01776304468512535, 0.025234568864107132, -0.00993538461625576, 0.019739946350455284, -0.025118282064795494, 0.04026483744382858, 0.027763841673731804, 0.03700876235961914, -0.00044425780652090907, 0.020161490887403488, -0.03407248482108116, 0.016076862812042236, -0.04291039705276489, 0.010175229981541634, 0.007362505421042442, 0.026048587635159492, 0.032822385430336, 0.022734370082616806, -0.013794704340398312, 0.0031634061597287655, 0.01042961049824953, -0.03299681469798088, 0.04131143167614937, 0.00747152604162693, 0.02177499234676361, 0.01715252920985222, -0.008787037804722786, 0.0033578258007764816, -0.0023366687819361687, -0.0020277779549360275, 0.01769036427140236, -0.007144464645534754, -0.022908803075551987, -0.00294899963773787, -0.002763665048405528, 0.01613500714302063, -0.029493629932403564, -0.0056145465932786465, -0.010807547718286514, -0.010604042559862137, -0.015509957447648048, -0.006933692377060652, 0.006174183916300535, 0.0592779815196991, 0.0111636808142066, 0.006817403715103865, -0.012966149486601353, 0.010516826994717121, -0.009230387397110462, -0.020350459963083267, -0.023548388853669167, 0.0116288335993886, -0.02897033281624317, -0.03244444727897644, 0.018940463662147522, 0.02751672826707363, -0.03703783452510834, 0.04163122549653053, 0.0005405590636655688, -0.025118282064795494, 0.009659199975430965, -0.029973318800330162, -0.0015353694325312972, 0.027240542694926262, 0.013823776505887508, 0.004756920039653778, -0.0327933132648468, -0.007776782847940922, -0.011643369682133198, -0.02815631404519081, 0.03360733017325401, -0.02014695480465889, 0.010640382766723633, -0.013467643409967422, -0.01066945493221283, -0.01098924782127142, 0.007834927178919315, -0.01796654798090458, -0.02104819007217884, 0.019565513357520103, -0.010284249670803547]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"-step RSO Offline 2.59 0.63 0.57 2.41 0.18 0.64 0.60
Hybrid-GSHF-DPO Hybrid 2.67 0.67 0.65 2.46 0.21 0.66 0.59
Table 2: The evaluation results of the models from different RLHF algorithms. The gold rewards are
computed on the test split with 5K prompts and the GPT4 evaluations are with 100 randomly sampled test
prompts, with the DPO as baseline. We use 5K prompts from the UltraFeedback to compute the OOD
reward and ∆ is the difference between the in-domain test reward and the OOD one. We count GPT4
evaluation score as win ×1 + tie ×0.5 and provide the details in Table 3.
Model1 Model2 ID OOD
Win Lose Tie Win Lose Tie
RSO DPO 36 30 34 25 21 54
Multi-step RSO DPO 37 24 39 35 14 51
Hybrid-GSHF-DPO DPO 42 13 45 25 21 54
Table 3: GPT-4 evaluation results on both in-domain (HH-RLHF) and out-of-domain (UltraFeedback (Cui
et al., 2023)). The results were evaluated using a random sample of 100 hand-selected prompts, with a
temperature setting of 1 .0. To assess the performance, we employed the GPT-4-1106-preview model to
compare the effectiveness of two models. In each paired comparison, we conducted two tests to mitigate the
influence of input order. GPT-4 responded with Win (W), Lose (L), or Tie (T) for each test.
Stronger DPO Model with Gold RM for Model Selection. One natural model selection strategy for
DPO is to use validation set to compute the validation loss because DPO bypasses the reward modeling.
Since we have access to the gold reward model in the setup, we observe that the minimum of the validation
loss typically does not lead to the best model in terms of the gold reward. Instead, the best model can
appear when we train the DPO for up to 2 ∼3 epochs. This is similar to the observation in Tunstall et al.
(2023), where the authors found that overfitting the preference dataset within certain limit does not hurt
the model performance (gold reward) and the strongest model was obtained with 3 epochs of DPO training.
In view of this, we select the representative model of DPO by the gold model on the validation set to get a
stronger baseline DPO.
6.2 Main Results: RLHF Benefits from Online and/or Pseudo Labelling Data
We use the reward-KL trade-off as the main metric to evaluate model, as all the considered RLHF algorithms
(except SFT) share the same KL-constraint reward optimization target in Equation (2). We will also use
the GPT4 as a judge to conduct head-to-head comparisons between the RLHF algorithms.
6.2.1 Online Exploration Improves Model Performance
We report the gold rewards and the GPT4 evaluations compared to the DPO baseline in Table 2 and the
reward-KL trade-off curves in Figure 3. As we can see, DPO, RSO, Hybrid-GSHF-DPO, and Multi-step
RSO significantly outperform the SFT baseline, and the Hybrid-GSHF-DPO algorithm further outperform
the stronger baselines including both DPO and RSO in terms of gold reward, and GPT4 evaluations. In
particular, the GSHF algorithm tend to be more robust in the face of OOD data, as they achieve a much
21
smaller ∆ compared to other RLHF algorithms.
10 15 20 25 30 35
KL Divergence1.92.02.12.22.32.42.52.62.7Reward
Multi-step RSO
Hybrid-GSHF-DPO
Offline DPO
RSO
10 15 20 25 30
KL Divergence1.21.41.61.82.02.22.4OOD Reward
Multi-step RSO
Hybrid-GSHF-DPO
Offline DPO
RSO
Figure 3: The figure of Reward-KL trade-off and the rightest point is the highest gold reward that can
be achieved by the RLHF algorithm. Here the left figure is tested on a hand-out set of HH-RLHF (in-
distribution prompts), while the right figure is tested on a subset of Ultra","[-0.0242072194814682, 0.012655703350901604, 0.05654013529419899, -0.0008692833362147212, 0.04320492967963219, 0.002234920859336853, -0.026854440569877625, 0.05580401048064232, -0.004165481775999069, 0.02332952991127968, 0.03731592372059822, -0.014297830872237682, -0.021390121430158615, 0.0016615919303148985, 0.013193641789257526, -0.038986362516880035, 0.04085499048233032, -0.04396937042474747, -0.029926350340247154, 0.04626268520951271, -0.014750831760466099, -0.02902035042643547, 0.01786521077156067, 0.02583518996834755, 0.025622844696044922, -0.005301522556692362, -0.011098514311015606, -0.0016146993730217218, 0.022862372919917107, -0.02300393581390381, 0.005021936260163784, -0.031341977417469025, -0.03253110498189926, -0.04504524543881416, 0.006614516489207745, 0.036976173520088196, 0.0039106691256165504, 0.06415620446205139, -0.018120022490620613, 0.012252249754965305, -0.0104685602709651, -0.054218508303165436, -0.026684565469622612, 0.005750983953475952, -0.014014705084264278, 0.03785385936498642, 0.047933124005794525, -0.027746286243200302, 0.021828966215252876, -0.0021659089252352715, -0.04620606079697609, 0.07633059471845627, -0.014920706860721111, -0.030435975641012192, 0.019507337361574173, -0.024575281888246536, 0.027010159566998482, -0.026174940168857574, 0.050056565552949905, -0.03524910658597946, 0.007460353430360556, -0.023994874209165573, 0.04832949861884117, 0.020215151831507683, -0.003146230708807707, -0.01588333211839199, -0.08091723173856735, -0.006621594540774822, 0.029898038133978844, 0.031483542174100876, -0.014963175170123577, 0.013554627075791359, 0.056908197700977325, -0.0391562394797802, -0.00859285518527031, -0.01626555249094963, 0.024490343406796455, 0.04348805546760559, -0.0003132074198219925, -0.04501693323254585, -0.02137596532702446, -0.010029716417193413, 0.030690789222717285, -0.04714037477970123, 0.01203282829374075, -0.0454133078455925, -0.05101919174194336, -0.040430303663015366, -0.03247448056936264, -0.01871458627283573, -0.02713756635785103, -0.029898038133978844, 0.011678921058773994, -0.0023304757196456194, 0.01596827059984207, -0.04748012498021126, -0.012839735485613346, -0.0020968972239643335, 0.007715166080743074, 0.03471117094159126, 0.003533758455887437, -0.06279720366001129, 0.024320468306541443, -0.005248436238616705, 0.04762168601155281, 0.027392378076910973, 0.018346523866057396, 0.03640992194414139, -0.009038777090609074, -0.0024525735061615705, -0.04258205369114876, 0.01228056289255619, -0.10889001190662384, 0.00760191585868597, -0.0037797235418111086, -0.04985837638378143, -0.07174396514892578, 0.01191249955445528, -0.00796997919678688, -0.012747719883918762, -0.03655148297548294, 0.013023766689002514, 0.012223937548696995, 0.0138023616746068, -0.010256215929985046, 0.0199886504560709, 0.010801232419908047, -0.05118906497955322, -0.006193367298692465, -0.002523354720324278, -0.011091436259448528, 0.03771229833364487, -0.018063398078083992, -0.05365225672721863, -0.05175531655550003, 0.03468285873532295, -0.024674374610185623, -0.021828966215252876, -0.018459774553775787, -0.015713457018136978, -0.0372592993080616, -0.06302370876073837, -0.04954693838953972, 0.025283094495534897, -0.05130231752991676, 0.019464869052171707, -0.039580926299095154, -0.009406840428709984, -0.04629099741578102, 0.04968849942088127, -0.010553497821092606, -0.01169307716190815, -0.019181743264198303, 0.03165341541171074, 0.016053207218647003, -0.021602464839816093, -0.03742917254567146, 0.021234402433037758, 0.016845958307385445, 0.000795847678091377, 0.025113219395279884, 0.013264423236250877, -0.010737529024481773, -0.004388443194329739, -0.0002245095674879849, 0.035560544580221176, -0.0038398876786231995, 0.007102907635271549, -0.07293309271335602, 0.0019181743264198303, 0.04071342572569847, 0.006320773623883724, -0.05855032429099083, -0.025325564667582512, -0.011325014755129814, -0.011509045958518982, -0.022593403235077858, 0.036806296557188034, 0.012075296603143215, -0.036777984350919724, 0.01800677366554737, 0.015430332161486149, -0.007863806560635567, -0.001813771901652217, -0.034881044179201126, -0.006908258888870478, 0.02010190114378929, -0.03253110498189926, 0.016845958307385445, 0.024815937504172325, 0.06511883437633514, -0.0045512402430176735, 0.045243434607982635, 0.008493760600686073, -0.013498001731932163, -0.027916161343455315, 0.04838612303137779, 0.043742869049310684, -0.024844249710440636, 0.00807615090161562, 0.009116636589169502, 0.028779692947864532, -0.008217713795602322, -0.08878811448812485, 0.02300393581390381, -0.018813680857419968, -0.02559453248977661, -0.012790188193321228, -0.017228178679943085, 0.02039918303489685, 0.02450449950993061, 0.056879885494709015, 0.04334649443626404, 0.027364065870642662, -0.0035054460167884827, -0.020356712862849236, -0.06409958004951477, 0.01715739630162716, 0.05526607111096382, 0.0364382341504097, 0.01901186816394329, 0.019464869052171707, 0.011048967018723488, 0.040373675525188446, -0.011360405012965202, 0.023966562002897263, 0.027010159566998482, -0.02045580744743347, 0.011282545514404774, -0.08669298887252808, 0.041647739708423615, 0.03706111013889313, 0.0009670500876381993, -0.020554902032017708, 0.01090740505605936, -0.02028593234717846, 0.009420996531844139, -0.017383897677063942, 0.01554358284920454, -0.05855032429099083, -0.008047838695347309, 0.03193654119968414, 0.038165297359228134, -0.00894676148891449, 0.015670988708734512, -0.005627116654068232, -0.0052625928074121475, -0.03558885678648949, 0.013568783178925514, -0.021475058048963547, 0.018530555069446564, -0.01792183518409729, -0.015586051158607006, -0.032814230769872665, -0.026996003463864326, 0.02689690887928009, -0.003043597564101219, -0.005089178215712309, -0.03519248217344284, -0.02039918303489685, -0.036183420568704605, -0.028383318334817886, 0.02240937203168869, 0.03185160458087921, 0.011926655657589436, 0.009562559425830841, -0.025283094495534897, -0.008097385056316853, -0.03230460360646248, -0.043063368648290634, -0.028779692947864532, 0.008699026890099049, 0.018884461373090744, 0.020186837762594223, -0.036777984350919724, -0.05016981437802315, 0.03366360440850258, 0.041817616671323776, -0.05503956973552704, -0.03111547790467739, 0.008132776245474815, 0.025311406701803207, 0.038136985152959824, 0.01303792279213667, 0.009498856030404568, -0.006044726353138685, 0.007488665636628866, -0.00481313094496727, -0.0047317324206233025, -0.01653452031314373, -0.010829545557498932, -0.04544162005186081, 0.028864631429314613, -0.05184025317430496, -0.01031991932541132, -0.010107575915753841, -0.0029621990397572517, -0.005620038602501154, 0.012988376431167126, 0.018827836960554123, 0.036777984350919724, 0.0367213599383831, -0.02358434349298477, 0.015727613121271133, 0.028737224638462067, 0.014496018178761005, 0.009463464841246605, 0.004179638344794512, -0.012662782333791256, -0.012273484840989113, -0.009633340872824192, 0.027788754552602768, 0.023994874209165573, 0.05022643879055977, 0.026528846472501755, -0.014354456216096878, 0.06409958004951477, -0.007948745042085648, 0.0132573451846838, -0.04983006417751312, -0.041817616671323776, -0.04088330268859863, -0.018728742375969887, 0.008338041603565216, 0.03669304773211479, -0.012521219439804554, 0.0031798516865819693, -0.01090740505605936, -0.05741782486438751, 0.0074178846552968025, -0.0028365622274577618, -0.01427659671753645, 0.010121732018887997, -0.008246026001870632, -0.01173554640263319, -0.0031019921880215406, -0.04142124205827713, 0.03493766859173775, 0.049405377358198166, 0.0221687164157629, -0.057531073689460754, -0.007715166080743074, -0.02368343621492386, 0.000743204087484628, -0.04159111529588699, 0.0025180461816489697, 0.01083662360906601, 0.01039070077240467, 0.029388412833213806, 0.023159654811024666, 0.0004720230645034462, -0.006363242398947477, 0.032078102231025696, 0.017553772777318954, 0.027038471773266792, -0.0023676359560340643, -0.007906275801360607, -0.03924117609858513, -0.03227629140019417, 0.0004087622510269284, -0.04207243025302887, 0.036919549107551575, -0.0143473781645298, 0.015600207261741161, 0.03932611271739006, 0.04886743798851967, -0.032700978219509125, 0.004533544648438692, 0.010447326116263866, -0.02512737549841404, -0.016548678278923035, 0.03397504240274429, -0.03165341541171074, 0.023994874209165573, -0.062344204634428024, 0.02630234695971012, 0.05634194612503052, 0.023782530799508095, 0.004629099741578102, 0.04014717787504196, -0.008783964440226555, 0.01756792888045311, -0.032134730368852615, -0.03909961134195328, 0.0022455379366874695, -0.015104738064110279, -0.01656283438205719, -0.008953839540481567, -0.07757634669542313, -0.012323031201958656, 0.008012447506189346, -0.007354181259870529, -0.004795435816049576, 0.021333497017621994, -0.004745888989418745, -0.004200872499495745, -0.029982976615428925, 0.05744613707065582, 0.05645519867539406, 0.054190196096897125, -0.03912792354822159, -0.0012882204027846456, -0.06568508595228195, 0.0034895201679319143, -0.03233291581273079, 0.004788357764482498, -0.022239496931433678, 0.015232144854962826, 0.020002806559205055, 0.040458615869283676, 0.02852488122880459, -0.02058321423828602, 0.026712877675890923, -0.04957525059580803, 0.014722518622875214, -0.014170424081385136, 0.012223937548696995, 0.007545290980488062, 0.027321597561240196, 0.06013582646846771, -0.0015394941437989473, -0.04980175197124481, -0.028468254953622818, -0.014991488307714462, -0.019082648679614067, 0.04261036589741707, 0.009420996531844139, -0.020186837762594223, 0.01735558547079563, -0.04125136509537697, -0.019323306158185005, 0.04810300096869469, 0.06874284148216248, -0.03924117609858513, -0.05600219592452049, 0.013115782290697098, 0.013427220284938812, -0.006069499999284744, -0.022664185613393784, -0.009852762334048748, 0.06251408159732819, 0.0017376819159835577, -0.00018469506176188588, -0.02904866263270378, -0.060192450881004333, -0.011381639167666435, -0.0013510388089343905, -0.006869329139590263, 0.011820483952760696, -0.004197333473712206, -0.017766116186976433, 0.027562255039811134, 0.04832949861884117, -0.001827928121201694, 6.138069147709757e-05, -0.047876499593257904, 0.08250273019075394, -0.027675503864884377, 0.017766116186976433, 0.022281965240836143, 0.010015559382736683, -0.020144369453191757, -0.004193794447928667, 0.00882643274962902, -0.007262165658175945, 0.006097812671214342, -0.002132287947461009, 0.030747413635253906, -0.0024490344803780317, 0.018771210685372353, -0.020512431859970093, -0.04985837638378143, -0.011671843007206917, -0.0076868534088134766, -0.013165329582989216, -0.010369466617703438, 0.023810843005776405, -0.007014431059360504, 0.012549531646072865, 0.0018491625087335706, -0.004215029068291187, -0.025283094495534897, -0.010404856875538826, -0.009605027735233307, 0.04903731122612953, 0.04915056377649307, 0.06596820801496506, -0.0359002947807312, -0.05093425139784813, -0.015387863852083683, -0.005251975264400244, -0.032078102231025696, 0.036806296557188034, -0.01732727140188217, -0.00697550131008029, -0.007382493931800127, 0.01925252377986908, 0.024999968707561493, -0.022310279309749603, -0.0038115752395242453, 0.04810300096869469, -0.023428624495863914, 0.0027445463929325342, 0.009279433637857437, 0.009201574139297009, 0.03649485856294632, 0.005938554648309946, -0.0009528938098810613, -0.019507337361574173, 0.004728193394839764, -0.020243464037775993, 0.019762150943279266, -0.01086493581533432, 0.010610123164951801, -0.0019606431014835835, -0.007255087606608868, -0.027746286243200302, -0.024971656501293182, -0.021390121430158615, 0.032729290425777435, -0.028057724237442017, -0.008366354741156101, -0.0220271535217762, 0.00010843922791536897, 0.004668029490858316, -0.0018093480030074716, 0.0004852945567108691, -0.08873149007558823, -0.03026610054075718, -0.017497148364782333, 0.018587179481983185, -0.01702999137341976, 0.021121151745319366, 0.021899746730923653, -0.02317381091415882, -0.020653994753956795, -0.017044147476553917, -0.017497148364782333, -0.02308887429535389, -0.045215118676424026, 0.03355035558342934, 0.007743478752672672, 0.005722671281546354, -0.007962901145219803, 0.024263843894004822, -0.01683180220425129, 0.04023211449384689, 0.0035886140540242195, 0.005347530357539654, 0.010978185571730137, 0.018459774553775787, -0.05116075277328491, -0.00884058978408575, -0.016407115384936333, -0.048131313174963, 0.0018040394643321633, -0.0005450163153000176, -0.018374836072325706, 0.019266681745648384, 0.021475058048963547, 0.016138145700097084, -0.0003572245768737048, -0.01930915005505085, 0.016435427591204643, -0.018077554181218147, 0.02031424455344677, 0.014722518622875214, 0.004784818738698959, 0.002870183438062668, 0.03674967214465141, -0.04077005386352539, 0.028793849050998688, 0.03292747959494591, -0.029529975727200508, -0.0054430849850177765, -0.013703268021345139, 0.016902584582567215, 0.011346248909831047, 0.05733288452029228, 0.016364645212888718, -0.019068492576479912, -0.030067913234233856, -0.014864081516861916, -0.003974372521042824, -0.0516703799366951, 0.010150044225156307, -0.00012375674850773066, 0.030039601027965546, -0.03439973294734955, 0.036891233175992966, 0.021489214152097702, -0.021191934123635292, 0.025410501286387444, 0.0010272142244502902, -0.032672666013240814, 0.0011838179780170321, 0.012584922835230827, 0.015458645299077034, 0.024348780512809753, -0.030124539509415627, 0.037485796958208084, -0.01086493581533432, 0.01064551342278719, -0.02439125068485737, -0.04951862618327141, 0.04224230349063873, 0.013809439726173878, -0.0017403361853212118, 0.008847667835652828, -0.022239496931433678, 0.011990359053015709, -0.018374836072325706, -0.005874851252883673, -0.014694206416606903, -0.04753674939274788, -0.024900875985622406, -0.008316807448863983, 0.029218537732958794, 0.03505092114210129, -0.013795283623039722, -0.02238105982542038, -0.006412789691239595, 0.027420692145824432, -0.03037935122847557, 0.023725904524326324, 0.013292735442519188, 0.010928639210760593, 0.0026242181193083525, -0.03519248217344284, -0.011466577649116516, -0.049292124807834625, -0.010369466617703438, -0.009222808293998241, -0.032644353806972504, 0.018063398078083992, 0.015996582806110382, 0.0020314245484769344, 0.006143820472061634, 0.021206090226769447, -0.034144919365644455, 0.014864081516861916, 0.011714312247931957, 0.007559447083622217, -0.03635329753160477, 0.02955828793346882, 0.022692497819662094, 0.013370594941079617, -0.012839735485613346, -0.01487823761999607, -0.054728131741285324, -0.027024315670132637, -0.0007423193310387433, 0.007502822205424309, 0.021559996530413628, 0.02526893839240074, 0.008691948838531971, -0.003402812872081995, 0.02793031744658947, -0.020271776244044304, -0.02545296959578991, -0.03669304773211479, -0.0053086006082594395, -0.041817616671323776, 0.0017456448404118419, 0.02235274761915207, 0.0359002947807312, 0.006136742420494556, 0.07236684113740921, 0.0038646613247692585, -0.011020654812455177, -0.01623724028468132, -0.0044167558662593365, 0.059059951454401016, 0.00851499568670988, -0.010008481331169605, -0.0037054033018648624, 1.4197741620591842e-05, -0.04688556119799614, -0.03369191661477089, 0.03035103902220726, -0.034201543778181076, -0.015642676502466202, -0.055549196898937225, -0.018105866387486458, -0.028850475326180458, -0.018049241974949837, 0.040260426700115204, -0.03496598079800606, -0.0006410134956240654, -0.01056765392422676, -0.0186296496540308, -0.014071330428123474, -0.001543033285997808, -0.017582084983587265, 0.01824742928147316, 0.029388412833213806, 0.017964303493499756, 0.06596820801496506, -0.020922964438796043, -0.06902596354484558, 0.020229307934641838, 0.015982426702976227, 0.011027732864022255, -0.004844982642680407, -0.04263867810368538, -0.008267260156571865, -0.0231171865016222, 0.045781370252370834, 0.04357299208641052, -0.024985812604427338, -0.004395521245896816, 0.003938981797546148, -0.009930621832609177, 0.02113530784845352, 0.0042504193261265755, 0.023301217705011368, 0.03522079437971115, 0.0037337157409638166, -0.00018403147987555712, -0.033380478620529175, -0.016350489109754562, 0.010001403279602528, -0.006504805292934179, 0.00916618388146162, 0.0011581596918404102, 0.009293589740991592, -0.05503956973552704, 0.00358684454113245, -0.04048692807555199, 0.015755927190184593, 0.02439125068485737, 0.006345547270029783, -0.039014674723148346, -0.03227629140019417, -0.011247155256569386, 0.045271746814250946, -0.0034806723706424236, 0.004997162614017725, 0.013703268021345139, 0.00814693234860897, 0.04688556119799614, -0.01448186207562685, -0.04062848910689354, -0.014977331273257732, 0.009102480486035347, -0.019535649567842484, 0.02267834171652794, 0.03105885162949562, -0.007736400701105595, 0.005627116654068232, -0.012153156101703644, 0.013363516889512539, -0.015033956617116928, 0.0178085844963789, 0.03941104933619499, -0.009378527291119099, -0.0007759404252283275, -0.0020632760133594275, -0.0024047959595918655, -0.0034647465217858553, 0.0053333742544054985, 0.0391562394797802, 0.007148915436118841, 0.003220550948753953, 0.01936577446758747, 0.002861335640773177, -0.04396937042474747, 0.003670012578368187, 0.005259053781628609, -0.007991213351488113, -0.01256368774920702, -0.020569058135151863, 0.010794154368340969, 0.024603594094514847, 0.06681758910417557, -0.016789333894848824, 0.023230435326695442, 0.012471672147512436, -0.010532263666391373, 0.0023587881587445736, 0.004717576317489147, -0.030719101428985596, 0.020880496129393578, 0.008047838695347309, -0.004130091052502394, 0.005722671281546354, -0.012662782333791256, 0.0038646613247692585, 0.006203984376043081, -0.02967153862118721, -0.0016067364485934377, -0.021899746730923653, -0.005117490887641907, 0.0076443846337497234, 0.015486957505345345, 0.04665905982255936, -0.05996595323085785, -0.10956951230764389, -0.019974494352936745, 0.02164493314921856, -0.014864081516861916, 0.0012917594285681844, -0.009548403322696686, 0.017468834295868874, 0.004165481775999069, -0.01868627406656742, -0.008302651345729828, -0.0034328950569033623, -0.04714037477970123, 0.014665894210338593, -0.0017978460527956486, -0.0019836470019072294, -0.02194221504032612, 0.015869176015257835, -0.008366354741156101, 0.010312841273844242, -0.041109804064035416, -0.024929188191890717, -0.023839155212044716, 0.03907129913568497, 0.012988376431167126, -0.04476211965084076, -0.012995454482734203, 0.011438264511525631, -0.02184312231838703, -0.00013116667105350643, -0.010638435371220112, -0.004296427592635155, 0.006993196438997984, 0.017256490886211395, -0.031002227216959, -0.045130182057619095, -0.03439973294734955, -0.027463160455226898, -0.019889555871486664, 0.022197028622031212, 0.005566952284425497, 0.02491503208875656, -0.04470549523830414, 0.024787625297904015, -0.02727912925183773, 0.01748299039900303, -0.033352166414260864, 0.001605851692147553, -0.016407115384936333, -0.0034116606693714857, -0.002576440805569291, 0.037627361714839935, 0.0056978981010615826, 0.0020703542977571487, 0.0007569179870188236, -0.007216157857328653, 0.0413363017141819, 0.003762028180062771, 0.015515269711613655, -0.02409396879374981, -0.02042749524116516, -0.00488745141774416, 0.03380516916513443, 0.01136748306453228, -0.002121670637279749, 0.001560728531330824, 0.0003678417706396431, -0.011813405901193619, 0.020894652232527733, -0.01626555249094963, -0.058890074491500854, -0.0018385453149676323, 0.013363516889512539, 0.012464594095945358, -0.005874851252883673, -0.011862952262163162, 0.014113799668848515, 0.027293285354971886, 0.01977630704641342, -0.03878817334771156, 0.021305182948708534, 0.04348805546760559, -0.04193086549639702, 0.022834060713648796, 0.021475058048963547, 0.011346248909831047, 0.035447295755147934, 0.020710621029138565, 0.009753668680787086, -0.00515995966270566, 0.00016722091822884977, 0.01618061400949955, -0.02477346919476986, 0.007159532513469458, -0.002234920859336853, -0.005942093674093485, -0.047876499593257904, -0.005871312227100134, -0.02589181438088417, 0.03941104933619499, -0.0026047532446682453, 0.028057724237442017, 0.009923543781042099, -0.029161913320422173, 0.005064405035227537, 0.006646367721259594, 0.006741922814399004, 0.015685144811868668, 0.015331238508224487, 0.027689659968018532, -0.030492601916193962, -0.008154010400176048, 0.03026610054075718, -0.007531134877353907, 0.0104685602709651, -0.03298410400748253, 0.03524910658597946, 0.0484144389629364, 0.016010738909244537, 0.015387863852083683, 0.027972785755991936, 0.02096543274819851, 0.01919589936733246, -0.0008418555953539908, 0.03938273712992668, 0.0064764926210045815, 0.004381365142762661, -0.00011037465446861461, 0.031993165612220764, -0.033522043377161026, 0.023697592318058014, 0.005991640500724316, -0.013413064181804657, -0.00445922464132309, 0.02559453248977661, -0.025849346071481705, 0.020866340026259422, 0.055605821311473846, 0.0010749916546046734, -0.034144919365644455, 0.019139274954795837, -1.1785369679273572e-05, 0.028482411056756973, 0.017058303579688072, 0.0026047532446682453, 0.003931903280317783, 0.021559996530413628, 0.028298379853367805, -0.014920706860721111, -0.02695353515446186, 0.0179501473903656, -0.0013244958827272058, -0.03374854475259781, -0.02580687776207924, -0.0024472649674862623, 0.023966562002897263, 0.015741771087050438, 0.012924673035740852, -0.02849656715989113, 0.008210635744035244, 0.00031099552870728076, 0.018558867275714874, 0.04136461392045021, 0.0004136284696869552, -0.032163042575120926, 0.05362394452095032, -0.02031424455344677, 0.008422979153692722, 0.0051210299134254456, -0.00020349635451566428, 0.0017288342351093888, -0.010312841273844242, -0.027364065870642662, 0.006395094096660614, -0.002261463785544038, 0.03788217529654503, 0.00894676148891449, -0.03035103902220726, 0.004774201661348343, -0.0022561552468687296, 0.06930908560752869, -0.015430332161486149, 0.03657979518175125, 0.016010738909244537, -0.020540745928883553, 0.032672666013240814, -0.020809713751077652, 0.01427659671753645, 0.01729895919561386, 0.004724654369056225, 0.04917887598276138, 0.01365372072905302, 0.04764999821782112, -0.018728742375969887, 0.00032382464269176126, 0.018827836960554123, -0.0067525398917496204, 0.029869725927710533, 0.022579247131943703, -0.027364065870642662, -0.05464319512248039, -0.01191249955445528, 0.05798407271504402, 0.02613247185945511, -0.010348232463002205, -0.01715739630162716, 0.022097934037446976, 0.00022638968948740512, -0.02798694185912609, -0.021531684324145317, 0.03306904062628746, 0.02184312231838703, 0.020356712862849236, -0.0026012142188847065, 0.013384751975536346, 0.0004711383080575615, -0.03844842314720154, -0.017256490886211395, 0.00045344297541305423, -0.013200719840824604, -0.017228178679943085, -0.028383318334817886, -0.03321060538291931, 0.005184733308851719, 0.010956951417028904, -0.008564542047679424, -0.028213443234562874, 0.02175818383693695, 0.007516978308558464, 0.027095098048448563, 0.025141531601548195, 0.009286511689424515, -0.011969124898314476, -0.008437136188149452, 0.026019221171736717, -0.029416725039482117, -0.031511854380369186, 0.0023853310849517584, 0.028071880340576172, -0.010157122276723385, 0.007906275801360607, 0.04331818222999573, 0.014991488307714462, -0.00890429224818945, -0.017638709396123886, 0.016308020800352097, 0.02341446839272976, 0.043119993060827255, 0.04532837122678757, -0.008713182993233204, -0.01220978144556284, -0.01942240074276924, -0.0007117948844097555, -0.006872868165373802, 0.006157976575195789, -0.016024895012378693, -0.00023645391047466546, -0.019026024267077446, 0.030804039910435677, 0.024023186415433884, 0.011381639167666435, -0.031964853405952454, 0.02633065916597843, 0.009555481374263763, -0.008507916703820229, 0.021036215126514435, -0.015670988708734512, -0.0031426914501935244, 0.01253537554293871, 0.03162510320544243, -0.0005733288708142936, -0.0011555054225027561, 0.012315953150391579, -0.00832388550043106, 0.01803508587181568, 0.004586630966514349, -0.0006215486209839582, 0.028185129165649414, 0.006511883344501257, 0.043742869049310684, 0.004770662169903517, 0.0026153705548495054, 0.01871458627283573, -0.03094560280442238, 0.01408548653125763, 0.01554358284920454, -0.03587198257446289, 0.010610123164951801, -0.012995454482734203, 0.03595692291855812, 0.03703279793262482, 0.03626835718750954, 0.03909961134195328, 0.0012324800482019782, -0.0014731367118656635, -0.008550385944545269, -0.006175672169774771, 0.02267834171652794, -0.002902034902945161, 0.00882643274962902, -0.031993165612220764, 0.031964853405952454, 0.015713457018136978, 0.019153431057929993, -0.03638160973787308, 0.023612655699253082, 0.000757360365241766, 0.013045000843703747, -0.03241785243153572, -0.016690239310264587, -0.02037086896598339, -0.0041159349493682384, -0.0018827837193384767, 0.002272081095725298, 0.004944076761603355, -0.043176617473363876, -0.00597748439759016, 0.010157122276723385, -0.006618055514991283, -0.013243189081549644, 0.0058606951497495174, 0.01745467819273472, -0.021361809223890305, 0.018488086760044098, 0.02967153862118721, -0.0244761873036623, -0.030549226328730583, -0.006515422370284796, 0.0132573451846838, -0.012592000886797905, 0.000956432893872261, 0.004724654369056225, -0.01887030526995659, -0.013377672992646694, -0.012627391144633293, -0.061098452657461166, 0.006787930615246296, -0.036155108362436295, -8.090086339507252e-05, -0.022281965240836143, -0.021899746730923653, 0.010702138766646385, 0.011629374697804451, 0.010546419769525528, -0.036976173520088196, 0.009159105829894543, 0.03380516916513443, 0.006848094519227743, 0.012351344339549541, 0.004905147012323141, -0.009201574139297009, 0.08380510658025742, -0.012761875987052917, -0.00257997983135283, -0.0033320316579192877, -0.03193654119968414, 0.008430058136582375, -0.005135186482220888, 0.004193794447928667, -0.012655703350901604, 0.026019221171736717, 0.022225340828299522, 0.01762455329298973, -0.010411934927105904, 0.01427659671753645, 0.010751686058938503, 0.010581810027360916, -0.01800677366554737, 0.03858998790383339, 0.03607017174363136, 0.033522043377161026, 0.008699026890099049, 0.005556335207074881, -0.007616072427481413, -0.00840174499899149, 0.028411630541086197, 0.007382493931800127, -0.0028808005154132843, 0.02020099386572838, 0.03326722979545593, 0.007587759755551815, 0.007991213351488113, -0.03510754555463791, -0.02184312231838703, 0.014680050313472748, -0.03578704595565796, -0.010702138766646385, -0.029105287045240402, 0.04680062085390091, 0.0016642463160678744, -0.01686011627316475, -0.024872563779354095, -0.006203984376043081, 0.030662477016448975, 0.004041614476591349, 0.013795283623039722, 0.022069621831178665, 0.008238947950303555, -0.002804710529744625, 0.018488086760044098, -0.0029834334272891283, 0.01892692968249321, -0.02184312231838703, 0.0004830826655961573, -0.005942093674093485, 0.020229307934641838, 0.004048692528158426, -0.002565823495388031, 0.007007352542132139, 0.026854440569877625, 0.012556609697639942, -0.0413363017141819, -0.01656283438205719, -0.031341977417469025, 0.012669860385358334, -0.005559874232858419, -0.03176666423678398, -0.002932117087766528, 0.030747413635253906, -0.032191354781389236, 0.02695353515446186, -0.018827836960554123, 0.005474936682730913, -0.05393538251519203, -0.006260609719902277, -0.005382921081036329, -0.0015209140256047249, -0.02485840767621994, 0.025736095383763313, 0.021234402433037758, 0.024164749309420586, -0.0029338866006582975, -0.006610977463424206, -0.013660798780620098, -0.010249137878417969, -0.01942240074276924, 0.010518107563257217, 0.008161088451743126, -0.007304634433239698, -0.037004485726356506, 0.024277999997138977, -0.011770936660468578, 0.02474515698850155, 0.03742917254567146, 0.002510968130081892, -0.008677792735397816, -0.0048909904435276985, -0.012620313093066216, 0.014991488307714462, -0.009484699927270412, 0.01408548653125763, -0.009569637477397919, -0.003163925837725401, 0.02725081704556942, -0.005464319605380297, -0.0048909904435276985, -0.008897214196622372, -0.01480745617300272, -0.0029993592761456966, 0.0020915886852890253, 2.0266688807168975e-05, -0.004997162614017725, -0.01579839549958706, 0.029161913320422173, 0.04263867810368538, -0.008175244554877281, 0.0221687164157629, -0.005574030801653862, 0.062004454433918, 0.02129102684557438, -0.004154864698648453, 0.005319217685610056, 0.0025445891078561544, 0.007311712484806776, 0.015685144811868668, -0.020512431859970093, 0.018615493550896645, -0.0178085844963789, 1.6395833881688304e-05, -0.004795435816049576, -0.003618696006014943, -0.006253531668335199, 0.0244761873036623, 0.022281965240836143, -0.01514720730483532, 0.004809591919183731, 0.031426914036273956, 0.004625560715794563, -0.049263812601566315, 0.0027286207769066095, 0.016520364210009575, 0.02662794105708599, 0.034767795354127884, -0.023244591429829597, -0.014637581072747707, 0.01151612401008606, 0.006419867742806673, -0.0030329804867506027, -0.02211209014058113, 0.026585470885038376, 0.02458943799138069, 0.007764712907373905, 0.007488665636628866, 0.0031727736350148916, 0.025665314868092537, -0.0018880922580137849, -0.003579766256734729, -0.00775055680423975, -0.028539037331938744, 0.014078408479690552, -0.0013793513644486666, 0.02618909627199173, -0.018020929768681526, 0.006724227219820023, 0.016789333894848824, 0.023315373808145523, 0.01039070077240467, -0.03323891758918762, 0.013398908078670502, 0.0047812797129154205, 0.027802910655736923, 0.003914208151400089, -0.02137596532702446, 0.008982151746749878, 0.0013890838017687201, -0.016746865585446358, 0.009484699927270412, -0.014595112763345242, -0.016605302691459656, -0.030011288821697235, 1.3644762475450989e-05, -0.009081246331334114, -0.0043459744192659855, 0.014248283579945564, 0.032814230769872665, 0.00807615090161562, 0.007743478752672672, 0.038335174322128296, 0.015458645299077034, 0.031172102317214012, 0.01140995230525732, 0.004650333896279335, -0.021871434524655342, 0.027434848248958588, 0.026797816157341003, 0.014566799625754356, 0.06189120560884476, -0.011919577606022358, -0.00025193733745254576, 0.015217987820506096, 0.006391555070877075, -0.006143820472061634, -0.006023492198437452, -0.0010104036191478372, -0.006515422370284796, -0.0016695548547431827, -0.009569637477397919, 0.0016040821792557836, -0.014113799668848515, 0.025056594982743263, 0.009357293136417866, 0.024646062403917313, 0.006434023845940828, 0.0016819415614008904, 0.01647789590060711, -0.01201867125928402, 0.017001677304506302, 0.011317936703562737, 0.02403734251856804, -0.019974494352936745, -0.0005428044241853058, -0.022423528134822845, -0.015515269711613655, 0.024249687790870667, 0.0009688196005299687, 0.005708515178412199, -0.005439545959234238, 0.02417890541255474, 0.03097391501069069, -0.009689965285360813, 0.008699026890099049, -0.003493059193715453, -0.03717435896396637, -0.008338041603565216, -0.006058882921934128, 0.009385605342686176, 0.021092839539051056, -0.006720688194036484, 0.027703816071152687, -0.008897214196622372, 0.0140076270326972, -0.016661927103996277, 0.007467431481927633, -0.008960917592048645, 0.009159105829894543, -0.012528297491371632, 0.034173231571912766, 0.01108435820788145, 0.04017549008131027, -0.0029391951393336058, 0.029360100626945496, 0.013313970528542995, 0.010603045113384724, -0.020356712862849236, -0.026996003463864326, 0.02521231397986412, -0.0489523746073246, 0.007998291403055191, -0.03032272681593895, -0.0061296639032661915, 0.01974799484014511, -0.0315401665866375, -0.02388162352144718, 0.018289897590875626, 0.0051033347845077515, 0.0003897397546097636, 0.003903590841218829, -0.022338591516017914, -0.0017421056982129812, -0.0165911465883255, -0.004211489576846361, -0.010334075428545475, 0.009371449239552021, 0.009258199483156204, -0.030209476128220558, 0.004427372943609953, 0.015331238508224487, 0.017383897677063942, -0.003068371210247278, -0.009279433637857437, -0.021559996530413628, 0.008422979153692722, -0.031964853405952454, -0.029416725039482117, -0.010150044225156307, -0.003946059849113226, 0.02137596532702446, 0.0056023430079221725, -0.01677517779171467, 0.0030648319516330957, 0.0018385453149676323, -0.03674967214465141, 0.0055138664320111275, -6.906710768816993e-05, -0.023301217705011368, -0.011204686015844345, 0.023640967905521393, 0.042440492659807205, -0.0377972349524498, -0.020809713751077652, 0.02477346919476986, -0.0005529792397283018, -0.0037974189035594463, 0.021446745842695236, 0.0178085844963789, 0.027109254151582718, 0.0093148248270154, -0.014793300069868565, 0.043856117874383926, -0.028836317360401154, 0.00023999297991394997, -0.007658541202545166, 0.015430332161486149, -0.018049241974949837, 0.028892943635582924, 0.015288769267499447, 0.04430912062525749, -0.0022826981730759144, 0.03490935638546944, -0.015246300958096981, 0.014510175213217735, -0.020031118765473366, -0.01963474415242672, -0.0032134728971868753, 0.005867773201316595, 0.03171003982424736, 0.021446745842695236, -0.02069646492600441, 0.011657686904072762, 0.004830826539546251, -0.04142124205827713, 0.03326722979545593, 0.012875125743448734, 0.02902035042643547, 0.031285353004932404, 0.002742776880040765, 0.007955823093652725, -0.019535649567842484, -0.005152881611138582, 0.02208377793431282, -0.018757054582238197, -0.010850779712200165, 0.004738810937851667, 0.017001677304506302, 0.013498001731932163, -0.020469963550567627, -0.02110699564218521, 0.012138999998569489, -0.011657686904072762, -0.011530280113220215, 0.004062849096953869, -0.0006768465973436832, 0.04909393936395645, -0.017383897677063942, 0.003956676926463842, -0.0024490344803780317, 0.012450437992811203, -0.014389846473932266, -0.032021477818489075, -0.020795557647943497, 0.003744332818314433, -0.01718571037054062, -0.024957500398159027, 0.017638709396123886, 0.04391274228692055, -0.03527741879224777, 0.010326997376978397, 0.013682032935321331, -0.029954662546515465, 0.012853891588747501, -0.026061689481139183, 0.013873143121600151, 0.0289637241512537, 0.021248558536171913, 0.02415059320628643, -0.015288769267499447, -0.004034536425024271, -0.005712054204195738, -0.01361125148832798, 0.04671568423509598, -0.01833236776292324, -0.0026312964037060738, -0.023612655699253082, 0.0030595234129577875, -0.003641699906438589, 0.01960643194615841, -0.015217987820506096, -0.03162510320544243, 0.03666473552584648, 0.005036092363297939]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"Feedback (Cui et al., 2023) with
5K out-of-distribution prompts.
To further illustrate the improvement from the online exploration, we compare different iterations of Hybrid-
GSHF-DPO in Figure 4. For each iteration, we evaluate the models every 400 training steps and plot the
representative models. Clearly, the previous iteration is strictly dominated by the subsequent one in terms of
the frontier. This demonstrates the significant improvements achieved by further iterating DPO with online
data. In particular, compared to offline DPO which uses more offline data than the iteration 1, leveraging
online data proves to be far more efficient, as evidenced by the enhanced frontier of the reward-KL trade-off.
10.0 12.5 15.0 17.5 20.0 22.5 25.0 27.5 30.0
KL Divergence1.92.02.12.22.32.42.52.62.7Reward
Hybrid-GSHF-DPO-Iter1
Hybrid-GSHF-DPO-Iter2
Hybrid-GSHF-DPO-Iter3
Offline DPO
Figure 4: The Reward-KL trade-off curves of different iterations of Hybrid-GSHF-DPO. The rightest point
is the highest gold reward that can be achieved in that round.
6.2.2 RLHF Benefits from Pseudo Labelling and Iterative Learning
Consistent with the observations of the previous literature (Ouyang et al., 2022; Dong et al., 2023; Liu et al.,
2023a), if we first construct a proxy reward and use it as the preference oracle to provide pseudo label, the
resulting algorithm usually outperforms those learn directly from the offline data. In particular, according
to Table 2 and Figure 3, RSO outperforms the DPO even though the DPO is selected via the ground truth
UltraRM-13B. Moreover, we observe that the Multi-step RSO admits a strictly dominating reward-KL curve
22
compared to the original RSO, demonstrating the effectiveness of iterative learning. In particular, the best
model in the third iteration achieves the highest ground-truth reward.
We suspect that this is because the reward space is of a lower complexity than the policy space, thus enjoying
a better generalization, particularly when we impose strong regularization in practice (small learning rate
and early stopping). In particular, while the reward model can make mistakes, the real human preference
data is also quite noisy because humans typically possess a set of intricate or even contradictory targets
thus the agreement rate between humans is typically only around 70% (Bansal et al., 2023). Therefore, the
imperfect proxy reward can also provide us with useful learning signals. However, as shown in Gao et al.
(2023), the major difference between the proxy reward model and the ground-truth reward model (human, or
a very large model trained a diverse set of preference data) is that the latter one is stable across a wide range
of KL divergence and is more reliable under large distribution shift. Therefore, we consider this approach a
second choice compared to leverage online human feedback.
6.2.3 Robustness to Sampling Temperature and Length Bias
Performance Comparison Under Different Sampling Temperatures. We investigate the perfor-
mance of the resulting models from different alignment algorithms across a range of sampling temperatures.
We report the test gold reward with respect to the sampling temperature in Figure 5. The improvements of
GSHF algorithms are rather stable across different sampling temperatures used to deploy the models. For
all the models, a temperature of 0.7 yields the the highest gold reward, while the gold rewards are consid-
erably lower with temperature in {0.2,0.5,1.0}. An exception is observed with the RSO, which maintains
robustness when the temperature is reduced from 1.0 to 0.7. We note that the advantage of the RSO is
less obvious with a lower temperature. Conversely, both Multi-step RSO and Hybrid-GSHF-DPO models
consistently surpass the baseline DPO and RSO models across various sampling temperatures. Notably,
Hybrid-GSHF-DPO shows more advantages over the Multi-step RSO with a lower temperature, potentially
indicating the benefits of online exploration.
0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0
Sampling T emperature1.251.501.752.002.252.502.753.00Reward
Multi-step RSO
Hybrid-GSHF-DPO
Offline DPO
RSO
Figure 5","[0.004585381597280502, 0.00567002035677433, 0.04905906319618225, 0.02078891545534134, 0.026114773005247116, 0.008558914996683598, -0.026573657989501953, 0.03643275052309036, -0.017562810331583023, 0.02491888776421547, 0.026476318016648293, -0.01856401562690735, -0.015880228951573372, -0.02637897990643978, 0.010137204080820084, -0.028019843623042107, 0.029340878129005432, -0.024251418188214302, -0.017256885766983032, 0.02735237404704094, -0.02213776297867298, -0.035654034465551376, 0.013933440670371056, 0.028144994750618935, 0.02956336922943592, -0.029924914240837097, -0.00894827302545309, 0.004936498589813709, 0.023917682468891144, -0.028270145878195763, 0.005391907878220081, -0.03796236962080002, -0.040493194013834, -0.037155844271183014, 0.0020667242351919413, 0.042884960770606995, 0.006073283962905407, 0.04221749305725098, -0.028047654777765274, 0.0009003895102068782, 0.014920740388333797, -0.05884862318634987, -0.038852330297231674, 0.020927973091602325, -0.009511450305581093, 0.02892370894551277, 0.025502923876047134, -0.04458145052194595, -0.00885788630694151, 0.015546494163572788, -0.06302031129598618, 0.06585706025362015, -0.03690554201602936, -0.05259109288454056, 0.020218785852193832, -0.022429781034588814, 0.026559753343462944, -0.0072031160816550255, 0.04644480347633362, -0.03888013958930969, 0.01387781836092472, -0.020538615062832832, 0.030286461114883423, 0.018369337543845177, 0.02172059379518032, 0.0081626046448946, -0.06630203872919083, -0.0028610832523554564, 0.005857746582478285, 0.030703630298376083, 0.004043061751872301, 0.0016286969184875488, 0.05498285964131355, -0.04700102657079697, -0.027839070186018944, -0.007974878884851933, 0.020844539627432823, 0.03128766641020775, 0.004623621702194214, -0.03420785069465637, -0.042579036206007004, -0.0032643466256558895, 0.028812464326620102, -0.032261062413454056, 0.004616668913513422, -0.03824048116803169, -0.014294987544417381, -0.027171600610017776, -0.028242334723472595, 0.008607584983110428, -0.028534352779388428, -0.01917586289346218, 0.022499307990074158, -0.004536711610853672, 0.025516830384731293, -0.03935293108224869, -0.004926069173961878, -0.017534999176859856, 0.01521275844424963, 0.01768796145915985, -0.002723765093833208, -0.060906656086444855, 0.024195795878767967, 0.0028541304636746645, 0.050505246967077255, 0.000321784958941862, 0.010783815756440163, 0.029174011200666428, 0.002181445714086294, -0.014600911177694798, -0.030230838805437088, -0.003709326731041074, -0.10356912761926651, 0.014281081967055798, -0.006539122201502323, -0.04399741068482399, -0.08827293664216995, 0.021873556077480316, -0.004606239963322878, -0.0023570042103528976, -0.027171600610017776, -0.011791974306106567, 0.00755075691267848, 0.022749610245227814, -0.018188564106822014, -0.014489666558802128, 0.018174657598137856, -0.07358859479427338, -0.0277695432305336, -0.011819785460829735, -0.014587005600333214, 0.015324003994464874, -0.015045891515910625, -0.060906656086444855, -0.045415785163640976, 0.012793179601430893, -0.02712988294661045, -0.008892649784684181, -0.02501622773706913, -0.024348758161067963, -0.025294341146945953, -0.06118477135896683, -0.06224159896373749, 0.022749610245227814, -0.04366367682814598, -0.0034625018015503883, -0.040326327085494995, -0.001775575103238225, -0.023681286722421646, 0.06268657743930817, -0.008343378081917763, -0.008412905968725681, -0.014559194445610046, 0.051450829952955246, -0.0011785021051764488, -0.010839438065886497, -0.03593214601278305, 0.036822106689214706, 0.010943730361759663, -0.016366926953196526, 0.01962084323167801, 0.04132753238081932, -0.008454622700810432, -0.010742099024355412, 0.0023935064673423767, 0.001321903895586729, -0.01821637526154518, 0.007828869856894016, -0.07292111963033676, -0.0098034692928195, 0.033011965453624725, -0.012257812544703484, -0.03134328871965408, -0.033985357731580734, -0.008934367448091507, -0.013697044923901558, -0.0083225192502141, 0.02469639852643013, -0.00031917766318656504, -0.019370542839169502, 0.04199500009417534, 0.010888108052313328, -0.009615742601454258, 0.00734217232093215, -0.019996294751763344, 0.003664133371785283, 0.0059516094624996185, -0.03167702257633209, 0.01864744909107685, 0.04177251085639, 0.050171513110399246, 0.0070744892582297325, 0.04611106961965561, -0.01569945551455021, 0.0022735705133527517, -0.026893487200140953, 0.05934922769665718, 0.028158899396657944, -0.033039774745702744, 0.011944935657083988, 0.03170483559370041, 0.02850654162466526, 0.005996802821755409, -0.07080746442079544, -0.0004008732212241739, -0.006125429645180702, -0.006420924328267574, -0.011847596615552902, -0.031120799481868744, 0.028534352779388428, 0.02799203246831894, 0.055705953389406204, 0.033039774745702744, 0.038101423531770706, -0.00028897635638713837, -0.004255122505128384, -0.0680263414978981, 0.003587652463465929, 0.04427552595734596, 0.04494299367070198, 0.0025864471681416035, 0.024348758161067963, 0.02704644948244095, 0.030870497226715088, -0.008524150587618351, -0.00043259543599560857, 0.02605915069580078, -0.0451376736164093, 0.009921667166054249, -0.07420043647289276, 0.03359600156545639, 0.05211830139160156, -0.009518403559923172, -0.006274915300309658, 0.025892281904816628, -0.017298603430390358, -0.0005227647488936782, -0.011082787066698074, 0.02810327708721161, -0.04419209063053131, -0.01447576005011797, 0.0451376736164093, 0.02967461384832859, -0.002459558192640543, 0.021970894187688828, 0.014517477713525295, -0.026337262243032455, -0.0384073480963707, 0.004175165202468634, -0.026239922270178795, -0.007891444489359856, -0.039380744099617004, -0.022846950218081474, -0.06507834792137146, -0.034625016152858734, 0.01510151382535696, -0.02439047396183014, 0.0036189400125294924, -0.025197001174092293, -0.013599705882370472, -0.02407064475119114, -0.017201263457536697, 0.035236865282058716, 0.03812923654913902, 0.021887460723519325, -0.002310072770342231, -0.04485956206917763, 0.012250859290361404, -0.03509780764579773, -0.024654680863022804, 0.002977543044835329, 0.02947993576526642, -0.002647284185513854, 0.005680449772626162, -0.03760082274675369, -0.032817285507917404, 0.03317883238196373, 0.05806991085410118, -0.04675072804093361, -0.042245302349328995, -0.013224253430962563, 0.017354225739836693, 0.03234449401497841, -0.0073143611662089825, 0.011673776432871819, -0.030286461114883423, -0.0018424959853291512, -0.02533605694770813, -0.00963660143315792, -0.022401969879865646, -0.015407437458634377, -0.031760457903146744, 0.017451565712690353, -0.040660060942173004, -0.0062053874135017395, -0.008287754841148853, 0.00673032458871603, -0.022721799090504646, 0.008280802518129349, -0.01171549316495657, 0.022944288328289986, 0.007411700673401356, -0.0523407906293869, 0.025155283510684967, 0.016700660809874535, -0.0007491657743230462, 0.007926208898425102, 0.02543339692056179, -0.010992400348186493, 0.016603322699666023, -0.006810282357037067, 0.010067676194012165, 0.00986604392528534, 0.04388616606593132, 0.03479188680648804, -0.00416125962510705, 0.08849542587995529, -0.013196442276239395, 0.0024439143016934395, -0.03276166319847107, -0.04216187074780464, -0.0438583567738533, -0.020427370443940163, 0.005284139420837164, 0.032261062413454056, -0.024654680863022804, 0.00513812992721796, -0.030258649960160255, -0.054120711982250214, -0.023486608639359474, -0.02743580751121044, -0.0037371378857642412, 0.01643645390868187, -0.01362751703709364, 0.0016799739096313715, 0.0045471410267055035, -0.03234449401497841, 0.016255680471658707, 0.03276166319847107, 0.0277695432305336, -0.07981831580400467, -0.015073702670633793, -0.01981552317738533, -0.013272923417389393, -0.035153429955244064, -0.002304858062416315, 0.003104431787505746, 0.012125709094107151, 0.02375081554055214, 0.01419764757156372, 0.011458238586783409, -0.019440069794654846, 0.019259296357631683, 0.0320107601583004, -0.0007456893799826503, 0.023236306384205818, -0.004380273167043924, -0.0523407906293869, -0.040020402520895004, -0.011263559572398663, -0.00921943224966526, 0.014753873459994793, 0.01579679548740387, 0.009275054559111595, 0.04091036319732666, 0.046166691929101944, -0.03582090139389038, 0.0042412169277668, 0.01845277100801468, -0.005075554829090834, -0.030036160722374916, 0.02605915069580078, -0.0360155813395977, 0.021790120750665665, -0.07547976076602936, 0.021039217710494995, 0.0716974288225174, 0.02247149683535099, 0.015616022050380707, 0.046695105731487274, -0.011645965278148651, 0.02649022452533245, -0.0008564998861402273, -0.030230838805437088, -0.006250580307096243, -0.007328266743570566, -0.0456104651093483, -0.0025151807349175215, -0.06073978915810585, -0.017674054950475693, -0.00018022999574895948, -0.017521092668175697, -0.019022900611162186, 0.012278671376407146, -0.005252851638942957, 0.009671365842223167, -0.03454158455133438, 0.04622231423854828, 0.0508946031332016, 0.07208678126335144, -0.046806350350379944, -0.01191712450236082, -0.05851488932967186, -0.009212479926645756, -0.03465282917022705, 0.01090896688401699, -0.01760452799499035, 0.020330030471086502, 0.021136557683348656, 0.033011965453624725, 0.03595995903015137, -0.038435161113739014, 0.01843886449933052, -0.03946417570114136, 0.003059238428249955, -0.016464265063405037, -0.016255680471658707, 0.009928619489073753, 0.031537968665361404, 0.056540291756391525, -0.01843886449933052, -0.047640688717365265, -0.003328660037368536, -0.011159268207848072, -0.015379626303911209, 0.03901919722557068, -0.010283213108778, -0.02415407821536064, 0.030397705733776093, -0.04811348021030426, -0.031204232946038246, 0.04766849800944328, 0.060350432991981506, -0.025794943794608116, -0.05526097118854523, 0.00015491740487050265, 0.011089739389717579, -0.024418285116553307, -0.008399000391364098, -0.023889871314167976, 0.0529804490506649, -0.007105776574462652, -0.009455827996134758, -0.02681005373597145, -0.030258649960160255, -0.013231206685304642, -0.005972467828541994, 0.010408364236354828, 0.005868175532668829, -0.0018355430802330375, -0.01727079227566719, 0.019606938585639, 0.06051729992032051, 0.005099889822304249, 0.018633544445037842, -0.030286461114883423, 0.07447855174541473, -0.020065823569893837, 0.022499307990074158, 0.019676465541124344, 0.0012958308216184378, -0.016714567318558693, -0.01309214998036623, 0.003318230854347348, 0.0003632845764514059, 0.001929406076669693, -0.0013531915610656142, 0.01962084323167801, 0.009205526672303677, 0.02213776297867298, -0.03443033993244171, -0.04875313863158226, -0.0019798139110207558, -0.015504777431488037, -0.026949109509587288, -0.00827384926378727, 0.04146658629179001, -0.004470659885555506, 0.022749610245227814, -0.008649301715195179, 0.004418513737618923, -0.024863265454769135, -0.004787012934684753, 0.00043607185943983495, 0.04878094792366028, 0.017966073006391525, 0.06641329079866409, -0.023250212892889977, -0.05364792048931122, -0.033456943929195404, -0.003851859364658594, -0.041494399309158325, 0.043608054518699646, -0.01642254926264286, 0.0050338380970060825, -0.0015739434165880084, 0.009671365842223167, 0.014753873459994793, -0.022401969879865646, 0.010915919207036495, 0.051784563809633255, -0.04780755564570427, -0.005214611068367958, -0.002993186702951789, 0.0040534911677241325, 0.04210624843835831, 0.011750256642699242, -0.005457959603518248, -0.020941877737641335, 0.013655328191816807, -0.03381849080324173, 0.03454158455133438, 0.012382963672280312, 0.006080236751586199, 0.015296192839741707, -0.008677112869918346, -0.01090896688401699, -0.018369337543845177, -0.010401410982012749, 0.04719570651650429, -0.04747381806373596, -0.007668954785913229, -0.03315101936459541, 0.005079031456261873, 0.013196442276239395, -0.0029288732912391424, -0.007620285265147686, -0.125818133354187, -0.04046538099646568, -0.014948551543056965, 0.022318536415696144, -0.021164368838071823, 0.026156488806009293, 0.021484198048710823, -0.009441922418773174, -0.029646802693605423, -0.019008995965123177, -0.02660146914422512, -0.029924914240837097, -0.025739319622516632, 0.0280893724411726, 0.0005892510525882244, 0.0031148609705269337, 0.01736813224852085, 0.025405585765838623, -0.03084268607199192, 0.04444239288568497, -0.016686756163835526, -0.01113145612180233, 0.019022900611162186, 0.0028888946399092674, -0.05373135209083557, -0.01928710751235485, -0.008510245010256767, -0.04177251085639, 0.003147886833176017, -0.00026985612930729985, 0.002560374094173312, 0.011075833812355995, 0.004606239963322878, 0.023931588977575302, -0.007418653462082148, 0.0011845858534798026, 0.030258649960160255, -0.0009299389785155654, 0.033846303820610046, 0.02418188937008381, -0.008593679405748844, 0.016992678865790367, 0.034180037677288055, -0.04391397908329964, 0.029730236157774925, 0.031092988327145576, -0.0542597658932209, 0.00416125962510705, 0.007682860363274813, 0.030592385679483414, -0.008079171180725098, 0.06352091580629349, 0.026114773005247116, -0.02373690903186798, -0.03595995903015137, -0.01081858016550541, -0.003848382970318198, -0.03737833350896835, 0.01800779066979885, -0.006872857455164194, 0.043941788375377655, -0.02076110430061817, 0.009038659743964672, 0.009129045531153679, -0.03134328871965408, 0.0163252092897892, 0.0029688519425690174, -0.020274408161640167, 0.011103644967079163, -0.002224900759756565, 0.010929824784398079, 0.014100308530032635, -0.0379345566034317, 0.03337351232767105, -0.005875128321349621, 0.0120839923620224, -0.019787710160017014, -0.02005191706120968, 0.050727736204862595, 0.01810513064265251, -0.016519887372851372, 0.007064059842377901, -0.027644392102956772, 0.007356077898293734, -0.03306758776307106, -0.0034120939671993256, -0.012313434854149818, -0.06457774341106415, -0.023903777822852135, 0.007620285265147686, 0.026253828778862953, 0.037684258073568344, -0.008510245010256767, -0.010616947896778584, -0.017952168360352516, 0.02619820646941662, -0.02140076458454132, 0.02299991063773632, 0.011729398742318153, 0.0007856680895201862, -0.024209700524806976, -0.04794660955667496, -0.01223695371299982, -0.03284509852528572, -0.03011959418654442, -0.028589975088834763, -0.012146567925810814, 0.031649213284254074, 0.00873968843370676, 0.003935293294489384, 0.0037579964846372604, 0.0061428118497133255, -0.026684902608394623, 0.002268355805426836, 0.025057945400476456, 0.011910172179341316, -0.04655604809522629, 0.03737833350896835, 0.01906461827456951, 0.027185505256056786, -0.0006783339777030051, -0.014879023656249046, -0.04508205130696297, -0.029313066974282265, -0.017757488414645195, -0.009921667166054249, 0.003893576329573989, 0.024946698918938637, 0.006803329102694988, 0.011958841234445572, 0.013370262458920479, -0.019982390105724335, -0.02344489097595215, -0.033540379256010056, -0.02247149683535099, -0.038101423531770706, -0.0028124134987592697, 0.01643645390868187, 0.04883657023310661, 0.015449154190719128, 0.07114119827747345, 0.01867526024580002, -0.005388431716710329, -0.018480582162737846, -0.008378141559660435, 0.04950404167175293, 0.014656533487141132, -0.023403175175189972, -0.008197369053959846, -0.009539262391626835, -0.04035413637757301, -0.03379068151116371, 0.007439511828124523, -0.042857151478528976, -0.001547001302242279, -0.04396960139274597, -0.04444239288568497, -0.032928530126810074, -0.03189951553940773, 0.05014370009303093, -0.02309725061058998, -0.01845277100801468, 0.004929545801132917, -0.02831186167895794, -0.005704784765839577, 1.8658531189430505e-05, -0.014823401346802711, 0.008336424827575684, 0.046695105731487274, 0.012890518642961979, 0.06140726059675217, -0.027644392102956772, -0.07959582656621933, 0.022916477173566818, 0.019982390105724335, -0.007675907574594021, -0.0008391178562305868, -0.034180037677288055, 0.007731529884040356, -0.009768704883754253, 0.041828133165836334, 0.02087235078215599, -0.029952725395560265, 0.003698897548019886, -0.004119542893022299, -0.007926208898425102, 0.017229074612259865, 0.011333088390529156, -0.008426811546087265, 0.019259296357631683, 0.005016455892473459, -0.010158062912523746, -0.027922503650188446, -0.013217301107943058, -0.008774451911449432, -0.03495875373482704, 0.011812832206487656, -0.003879670752212405, 0.015838511288166046, -0.041299719363451004, -0.0005931620253250003, -0.05236859992146492, 0.0031426723580807447, 0.009984241798520088, 0.004519329871982336, -0.039074819535017014, -0.03167702257633209, -0.014176789671182632, 0.03818485885858536, -0.009782610461115837, -0.005214611068367958, 0.028784653171896935, 0.010707334615290165, 0.04010383412241936, -0.009942525066435337, -0.03773988038301468, -0.012848801910877228, 0.019565220922231674, -0.013391121290624142, 0.008989989757537842, 0.009038659743964672, 0.008545009419322014, 0.01457310002297163, 0.0017503711860626936, 0.012876613065600395, -0.015449154190719128, 0.015727266669273376, 0.048085667192935944, -0.01017196848988533, 0.012883566319942474, -0.008934367448091507, -0.0068519990891218185, -0.013530177995562553, -0.001400992157869041, 0.03710021823644638, -0.0032382735516875982, 0.01489292923361063, 0.04302401840686798, -0.009198574349284172, -0.0385742150247097, -0.0015678597846999764, -0.008440717123448849, -0.006024613976478577, -0.004428943153470755, -0.013217301107943058, 0.010825532488524914, 0.02130342461168766, 0.049865588545799255, 0.005120748188346624, 0.02280523255467415, 0.02831186167895794, -0.000493215280584991, 0.006170623004436493, -0.019467880949378014, -0.02690739370882511, 0.015393531881272793, -0.005579634103924036, -0.015073702670633793, 0.007988784462213516, -0.011910172179341316, -0.00689371582120657, 0.009024753235280514, -0.041716888546943665, -0.014322798699140549, -0.010804674588143826, -0.01086029689759016, -0.013231206685304642, 0.000832599587738514, 0.048920005559921265, -0.05451006814837456, -0.10735145956277847, -0.011402616277337074, 0.01715954765677452, -0.023403175175189972, 0.008093076758086681, -0.02183183841407299, 0.017952168360352516, -0.02140076458454132, -0.020594237372279167, -0.027310656383633614, -0.017868734896183014, -0.029813669621944427, 0.015171041712164879, -0.021025311201810837, -0.0032938960939645767, -0.03287290781736374, 0.0023552661295980215, -0.00739084230735898, 0.003147886833176017, -0.021525913849473, -0.027839070186018944, -0.022096045315265656, 0.03621026128530502, 0.006024613976478577, -0.04438677057623863, -0.024877171963453293, 0.017646243795752525, -0.01823027990758419, -0.02892370894551277, -0.018049506470561028, -0.01547696627676487, 0.0001982638641493395, 0.017660150304436684, -0.019871145486831665, -0.05403727665543556, -0.03604339063167572, -0.022193385288119316, -0.008343378081917763, 0.011785021051764488, 0.0005497069214470685, 0.03340132161974907, -0.015351815149188042, 0.054955046623945236, -0.010797721333801746, 0.027310656383633614, -0.028339672833681107, 0.020635955035686493, -0.008934367448091507, 0.006872857455164194, 0.00210496480576694, 0.03918606415390968, 0.01542134303599596, 0.01186845451593399, -0.000717009010259062, -0.0080026900395751, 0.03707240894436836, 0.009601837024092674, 0.019314920529723167, -0.025906188413500786, -0.0057604070752859116, -0.023027721792459488, 0.03187170252203941, 0.013119961135089397, -0.0014053377090021968, -0.00755075691267848, 0.009122093208134174, -0.010526562109589577, 0.02651803568005562, 0.0018963802140206099, -0.040965985506772995, -0.02184574492275715, 0.00481830071657896, 0.009574025869369507, 0.008976084180176258, -0.006045472342520952, 0.011805879883468151, 0.031120799481868744, 0.020594237372279167, -0.028673408553004265, 0.03829610347747803, 0.03721146658062935, -0.045527029782533646, 0.02109484001994133, 0.028895897790789604, 0.011423475109040737, 0.03125985711812973, -0.0021727546118199825, 0.005284139420837164, -0.020747199654579163, 0.011061928234994411, 0.024307040497660637, -0.013620564714074135, 0.013453696854412556, -0.017423754557967186, -0.017660150304436684, -0.0483359694480896, -0.011082787066698074, -0.019759899005293846, 0.04374711215496063, -0.00551358237862587, 0.034819696098566055, 0.009358488954603672, -0.0143645154312253, 0.007321313954889774, 0.019634749740362167, -0.00937934685498476, 0.011159268207848072, 0.020733293145895004, 0.017576714977622032, -0.042134057730436325, -0.0026594516821205616, 0.04310745373368263, -0.010046817362308502, -0.0053362855687737465, -0.018480582162737846, 0.034625016152858734, 0.05058868229389191, 0.02330583520233631, 0.01383610162883997, 0.01973208785057068, 0.03253917396068573, -0.008996942080557346, -0.0018233757000416517, 0.02743580751121044, 0.0062019107863307, 0.009003895334899426, 0.0017564548179507256, 0.023903777822852135, -0.03595995903015137, 0.016130531206727028, 0.018939467146992683, -0.011103644967079163, 0.003820571815595031, 0.017938261851668358, -0.042884960770606995, 0.029313066974282265, 0.05192362144589424, -0.00937934685498476, -0.031315479427576065, 0.02903495542705059, -0.004359414801001549, 0.012042275629937649, 0.007300455588847399, -0.007349125109612942, -0.007571615278720856, 0.010721240192651749, 0.030258649960160255, -0.030230838805437088, -0.01874478906393051, 0.022513214498758316, 0.00490173464640975, -0.04102160781621933, -0.012897471897304058, 0.01622786931693554, 0.00933763012290001, 0.005537916906177998, 0.02903495542705059, -0.03807361423969269, 0.008392047137022018, -0.009080376476049423, 0.02098359540104866, 0.039853535592556, -0.003552888287231326, -0.030981743708252907, 0.02617039531469345, -0.028868086636066437, -0.0026681427843868732, 0.01747937686741352, -0.01425327081233263, -0.0020111016929149628, -0.001470520393922925, -0.05884862318634987, 0.008336424827575684, 0.005829935427755117, 0.023264117538928986, 0.010533514432609081, -0.028784653171896935, 0.014447948895394802, -0.0012263027019798756, 0.07336610555648804, -0.019148051738739014, 0.049670908600091934, 0.0048600174486637115, -0.026365073397755623, 0.04163345694541931, -0.016895340755581856, -0.0009412373183295131, 0.01149995531886816, -0.004105637315660715, 0.04399741068482399, 0.00501297926530242, 0.034708451479673386, 0.00049408437917009, 0.02586447075009346, 0.008969130925834179, -0.012786226347088814, 0.006660796701908112, 0.014350609853863716, -0.006076760124415159, -0.07147493958473206, -0.03156577795743942, 0.03963104635477066, 0.004731390625238419, 0.0015330957248806953, -0.016366926953196526, 0.021692782640457153, -0.02181793376803398, -0.01505979709327221, 0.0019068095134571195, 0.03426347300410271, 0.001812946517020464, 0.012487255036830902, -0.013418932445347309, -0.0030435947701334953, 0.0064139715395867825, -0.041494399309158325, -0.002722027013078332, -0.008941319771111012, -0.025349963456392288, 0.011353946290910244, -0.008343378081917763, -0.01314081996679306, 0.017256885766983032, 0.005694355349987745, -0.012904424220323563, -0.01909242942929268, 0.03020302765071392, 0.013064338825643063, -0.001131570665165782, 0.01378743164241314, 0.0031548396218568087, -0.022499307990074158, -0.012758415192365646, 0.015351815149188042, -0.010582184419035912, -0.030175216495990753, 0.013238159008324146, 0.038741085678339005, 0.004230787977576256, 0.012528972700238228, 0.03701678663492203, 0.009942525066435337, -0.015351815149188042, -0.029591180384159088, 0.019453976303339005, 0.005645685829222202, 0.03337351232767105, 0.033011965453624725, -0.024779831990599632, -0.029702425003051758, -0.028589975088834763, 0.011200984939932823, -0.003994392231106758, -0.006841569673269987, -0.00799573678523302, 0.008823121897876263, -0.010623901151120663, 0.035570599138736725, 0.019857238978147507, 0.01049179770052433, -0.030814874917268753, 0.023361457511782646, 0.005624826997518539, -0.013321593403816223, 0.02227681875228882, -0.027825165539979935, 0.0008638872532173991, 0.03899138420820236, 0.026114773005247116, 0.0025551593862473965, -0.0027133359108120203, 0.018828222528100014, 0.006518263835459948, 0.027950314804911613, -0.0002576886909082532, 0.0033043252769857645, 0.01834152638912201, 0.006229721941053867, 0.0464169904589653, 0.0006188005208969116, -0.0027394089847803116, 0.008663207292556763, -0.026100866496562958, -0.0104431277140975, 0.0037475673016160727, -0.03267822787165642, 0.0019015948055312037, 0.00452975882217288, 0.02503013424575329, 0.035236865282058716, 0.03262260556221008, 0.03526467829942703, 0.001287139835767448, -0.003478145692497492, -0.001139392494224012, 0.011465191841125488, 0.012716698460280895, 0.008148699067533016, 0.0042620752938091755, -0.023875966668128967, 0.01885603368282318, -0.0008026155410334468, 0.022082140669226646, -0.020413463935256004, 0.029841480776667595, 0.024001115933060646, 0.013703998178243637, -0.0326504185795784, 0.0016930104466155171, -0.01309910323470831, 0.007543804123997688, 0.00025877507869154215, -0.005238946061581373, 0.01885603368282318, -0.030036160722374916, 0.0038066660054028034, 0.005318903364241123, 0.00056665443116799, -0.01581070013344288, 0.006862428039312363, 0.004745296202600002, -0.004724437836557627, 0.01235515158623457, 0.029229633510112762, -0.03231668472290039, -0.028367483988404274, -0.020594237372279167, -0.006375730969011784, -0.02110874652862549, 0.01049179770052433, -0.0006726848077960312, 0.008433764800429344, -0.03773988038301468, -0.028478730469942093, -0.06240846589207649, -0.00016675892402417958, -0.05840364471077919, -0.005120748188346624, -0.009886902756989002, -0.023583948612213135, 0.0034416434355080128, 0.007655049208551645, -0.004084778483957052, -0.024765927344560623, 0.0007652441854588687, 0.02743580751121044, 0.003594605252146721, 0.029313066974282265, 0.017034396529197693, -0.02395940013229847, 0.08716048300266266, -0.01845277100801468, 0.0029671136289834976, -0.005875128321349621, -0.04252341389656067, 0.00020717215375043452, -0.00017175625544041395, 0.00420992961153388, -0.012730604037642479, 0.021748404949903488, 0.03723927587270737, 0.016589416190981865, -0.0023656953126192093, 0.017757488414645195, 0.009393252432346344, 0.023375364020466805, -0.027588769793510437, 0.044998615980148315, 0.029924914240837097, 0.026643186807632446, 0.014976362697780132, -0.003241749946027994, -0.005482294596731663, 0.014865118078887463, 0.022833043709397316, 0.005364096723496914, -0.01266107615083456, 0.0008634526748210192, 0.017145641148090363, 0.010192826390266418, -0.021178273484110832, -0.026573657989501953, -0.013759620487689972, 0.015324003994464874, -0.04185594618320465, -0.01930101402103901, -0.03106517717242241, 0.040632251650094986, 0.006045472342520952, 0.012591547332704067, -0.0008473743218928576, -0.009351535700261593, 0.030787063762545586, 0.010582184419035912, 0.0143645154312253, 0.019843334332108498, 0.021011406555771828, 0.008837027475237846, 0.021595442667603493, -0.0039040055125951767, 0.004116066265851259, -0.02650413103401661, -0.0011672037653625011, -0.005329332780092955, 0.009233337827026844, -0.0005818636855110526, -0.008656254038214684, 0.01973208785057068, 0.01727079227566719, 0.01171549316495657, -0.02703254483640194, -0.01811903528869152, -0.02280523255467415, 0.00970612931996584, -0.002678571967408061, -0.026531942188739777, -0.013453696854412556, 0.0293686892837286, -0.01855010911822319, 0.029924914240837097, -0.03148234635591507, 0.004282934125512838, -0.04174470156431198, -0.00869797170162201, 0.020441275089979172, 0.0009690485894680023, -0.02722722291946411, 0.02426532283425331, 0.014642627909779549, 0.0084824338555336, 0.006897192448377609, -0.012730604037642479, -0.014489666558802128, -0.01106888148933649, -0.03570965677499771, 0.011173173785209656, 0.0017051778268069029, -0.01447576005011797, -0.027713919058442116, 0.04143877699971199, -0.026420695707201958, -0.0006613865261897445, 0.030063971877098083, 0.01325901784002781, -0.0033443039283156395, -0.016728471964597702, -0.0034990040585398674, 0.007335219532251358, -0.02850654162466526, 0.015129324980080128, -0.01207703910768032, 0.01339807454496622, 0.029507746919989586, -0.00599332619458437, -0.0038379537872970104, -0.01643645390868187, -0.011242701672017574, -0.003526815213263035, -0.009122093208134174, 0.0038344773929566145, 0.008843980729579926, 0.002690739231184125, 0.040743496268987656, 0.042551226913928986, -0.03412441536784172, 0.01843886449933052, 0.0007513385498896241, 0.05512191727757454, 0.016770189628005028, 0.0026559752877801657, 0.01877260021865368, 0.006928479764610529, 0.012070086784660816, 0.018953373655676842, -0.007863633334636688, 0.006233198568224907, -0.019231485202908516, -0.0064765471033751965, -0.015337909571826458, -0.014009921811521053, 0.0017634076066315174, 0.018828222528100014, 0.02989710308611393, -0.008753594011068344, 0.004265551920980215, 0.022415874525904655, 0.007696765940636396, -0.05907111614942551, 0.012389915995299816, 0.008266896940767765, 0.013578847050666809, 0.030703630298376083, -0.019231485202908516, 0.0026611897628754377, 0.011694634333252907, 0.00043520276085473597, 0.0070119136944413185, -0.03498656302690506, 0.024140173569321632, 0.030898308381438255, 0.007529898546636105, 0.016297398135066032, 0.005635256413370371, 0.027157694101333618, -0.015087608247995377, -0.016575509682297707, -0.012042275629937649, -0.020927973091602325, 0.023681286722421646, 0.0065078348852694035, 0.013975157402455807, -0.0014879023656249046, 0.00771067151799798, 0.007627238053828478, 0.020399559289216995, 0.003928340505808592, -0.03771206736564636, 0.007307408377528191, -0.007001484744250774, 0.035042185336351395, 0.014434043318033218, 0.005190276075154543, 0.0005888165323995054, -0.002953208051621914, -0.008315566927194595, 0.00857977382838726, -0.010776863433420658, 0.0014114214573055506, -0.01973208785057068, 0.015324003994464874, -0.014948551543056965, -0.005941180046647787, 0.01855010911822319, 0.03804580122232437, 0.0006140204495750368, 0.0027880787383764982, 0.03139891102910042, 0.020691577345132828, 0.036822106689214706, 0.01325901784002781, -0.00841985922306776, -0.022026516497135162, 0.02564198151230812, 0.011931030079722404, 0.0172846969217062, 0.05000464245676994, -0.007502087391912937, 0.012994810938835144, 0.028478730469942093, 0.0008786619873717427, -0.017145641148090363, 0.004717485047876835, -0.011075833812355995, -0.009414111264050007, -0.007258738856762648, 0.006956291384994984, 0.01277927402406931, -0.014906834810972214, 0.02650413103401661, 0.007244833279401064, 0.029813669621944427, -0.006688607856631279, 0.006403542589396238, 0.01325901784002781, -0.010596089996397495, -0.004352462012320757, 0.0006466117920354009, 0.008329472504556179, -0.015351815149188042, -0.027004733681678772, -0.011444333009421825, -0.02322240173816681, 0.029062766581773758, -0.010526562109589577, 0.008955225348472595, 0.01277927402406931, 0.02553073689341545, 0.04332994297146797, 0.007286550011485815, -0.0007587259169667959, 0.0070119136944413185, -0.02331974171102047, -0.0008521543932147324, -0.01653379388153553, 0.006372254807502031, 0.026420695707201958, -0.016088813543319702, 0.011013258248567581, -0.01106888148933649, 0.014093355275690556, -0.029618991538882256, 0.0069319563917815685, 0.005252851638942957, -0.004964309744536877, -0.012855754233896732, 0.04702883958816528, -0.003987439442425966, 0.04313526302576065, -0.01610272005200386, 0.04146658629179001, 0.008684066124260426, 0.03151015564799309, -0.01802169531583786, -0.02637897990643978, 0.033206645399332047, -0.03139891102910042, 0.011625106446444988, -0.022221196442842484, 0.0014670438831672072, 0.023611759766936302, -0.030230838805437088, -0.013050433248281479, 0.017868734896183014, 0.010457033291459084, -0.008475481532514095, 0.011680728755891323, -0.024112362414598465, 0.006250580307096243, -0.021762309595942497, -0.01845277100801468, -0.00348683656193316, 0.017423754557967186, 0.00869101844727993, -0.026128677651286125, 0.004303792491555214, 0.020705481991171837, 0.023152872920036316, 0.0142046008259058, -0.007004960905760527, -0.02311115711927414, -0.0010116345947608352, -0.030397705733776093, -0.012946140952408314, -0.002683786442503333, -0.012480302713811398, 0.012709745205938816, 0.012966999784111977, -0.0022092568688094616, -0.0138847716152668, 0.012188284657895565, -0.029201822355389595, 0.016158342361450195, 0.007522945757955313, -0.02786688134074211, -0.004494994878768921, 0.013168631121516228, 0.02672662027180195, -0.03295634314417839, -0.032594796270132065, 0.015031985938549042, 0.014948551543056965, -0.01685362309217453, 0.026949109509587288, 0.0008882220718078315, 0.04388616606593132, 0.04830815643072128, -0.02511356770992279, 0.041271910071372986, -0.009928619489073753, 0.008259943686425686, -0.018313713371753693, 0.005701308138668537, -0.02362566441297531, 0.026782242581248283, 0.0010663879802450538, 0.036404937505722046, -0.014823401346802711, 0.041800323873758316, -0.01070038229227066, 0.012209142558276653, -0.018480582162737846, -0.025906188413500786, 0.004265551920980215, 0.0033773297909647226, 0.01685362309217453, 0.007168352138251066, -0.028562163934111595, -0.007404747884720564, -0.003064453136175871, -0.03031427226960659, 0.03454158455133438, 0.02066376619040966, 0.03748957812786102, 0.029841480776667595, 0.0036050344351679087, 0.015616022050380707, -0.005968991667032242, -0.008649301715195179, 0.02820061706006527, -0.0287290308624506, -0.003544197417795658, 0.0007248309557326138, 0.00917771551758051, 0.002494322368875146, -0.030342083424329758, -0.009094282053411007, 0.015449154190719128, -0.0017651459202170372, -0.02375081554055214, 0.013363310135900974, 0.00460971612483263, 0.041939377784729004, 0.002278784988448024, 0.0016087074764072895, -0.005499676335602999, 0.011771115474402905, -0.006723371800035238, -0.020316125825047493, -0.012480302713811398, -0.0011367852566763759, -0.014795590192079544, -0.027908599004149437, 0.021219991147518158, 0.034485962241888046, -0.036627426743507385, 0.0138847716152668, -0.007947067730128765, -0.03050895221531391, 0.004654909484088421, -0.010853343643248081, 0.0293686892837286, 0.023875966668128967, -0.008197369053959846, 0.02269398793578148, -0.028381390497088432, -0.010783815756440163, -0.007668954785913229, -0.01113840937614441, 0.04010383412241936, 0.0025134426541626453, -0.004178641829639673, -0.0280893724411726, -0.00010918091720668599, -0.014281081967055798, 0.0036328458227217197, -0.01789654605090618, -0.02341707982122898, 0.018633544445037842, -0.0046583861112594604]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
": The gold reward with respect to the sampling temperature. The gold reward is tested on the
hand-out test set.
Length Bias. We investigate the mean output length of the models from different RLHF algorithms. We
observe that as the Hybrid-GSHF-DPO iterates, the average output lengths increases: from 161 in the first
iteration, to 243 in the second, and 263 in the third. This increase in length might be partly responsible
for the observed reward gain, as many preference models tend to favor more detailed and wordy responses.
In comparison, the average output lengths for DPO, RSO, and Multi-step RSO are 241, 275, and 240,
23
respectively. Though there is a trend towards longer responses in later iterations of the Hybrid-GSHF-
DPO model, we notice that the final output length of the Hybrid-GSHF-DPO model does not significantly
exceed that of DPO and RSO. In practice, however, the reward (signal) hacking is the fundamental issue of
RLHF (Casper et al., 2023). Therefore, it may be beneficial to integrate additional strategies such as early
stopping, replay, and a thorough validation process to ensure the selection of the most effective model during
the training process.
6.3 Scaling-up Experiments
Setup. For the purpose of simulation study, we use the Open-LLaMA-3B-V2 and do not use the high-quality
SFT data for a clear and controllable verification process. In this subsection, we scale up the experiment
with the Zephyr-SFT-beta Tunstall et al. (2023), which is fine-tuned on 200K high quality Chat-GPT data
of UltraChat, starting from the strong pre-trained model Mistral-7B-v0.15. We use the prompt set of
UltraFeedback (Cui et al., 2023) and still use the UltraRM-13B to provide preference signal. We adopt
the DPO as the computational oracle and the rejection sampling as the exploration strategy as described
in Section 5.2 and set n= 8 through out the experiments. We iterate the Online-GSHF-DPO for three
iterations, and for each iteration, we mix all the historical data and run the DPO training for two epochs.
Competitors. The Zephyr project provides us with a baseline model trained by offline DPO on the Ultra-
Feedback dataset. We also include the RAFT (also known as rejection sampling fine-tuning) (Dong et al.,
2023) as a baseline, which iteratively learns from the best-of-n policy. For the SFT baseline, we decide to take
the Zephyr-SFT-beta and do not further fine-tune on the preferred responses of the UltraFeedback because
the UltraChat is generated by Chat-GPT, while UltraFeedback is generated by a mixture of Chat-GPT and
other open-source models like LLaMA2-7B-Chat.
Evaluation. We use the length-control win rate of the AlpacaEval-2 benchmark to evaluate the models6,
which is one of the most widely adopted benchmark to evaluate a general chatbot. The benchmark include
805 prompts and conduct head-to-head comparison for the model and GPT-4 Preview (11/06), where the
GPT-4 Preview (11/06) also serves as the judge. The length-control version aims to mitigate the length bias
of the GPT-4 (the model may prefer the longer responses) and has a correlation with human annotators of
0.98.
We report the main result in Figure 6. We observe that the length-control win rate to the GPT-4 Preview
(11/06) increases as the Online-GSHF-DPO iterates and outperforms the baseline offline DPO and RAFT in
the second iteration and eventually surpass them with a large margin. We also note that the UltraRM-13B
may bias toward the longer responses so that the the model after three iterations achieves a win rate of
30.49%, while its length-control win rate is only 24.17%. We leave the study of mitigating the length bias in
online iterative RLHF for future study. The performance of Online-GSHF-DPO can be further boosted with
a stronger reward model and a heavily filtered seed prompt set and the additional prompts generated by
ChatGPT-4 with self-instruct type prompt augmentation (Wang et al., 2022), with the final model achieving
a length-control win rate of 34.79%7. The details are described in the model card page.
To summarize, the simulation study and the scaling-up experiments have demonstrated the significant poten-
tial of the iterative RL","[0.019184241071343422, 0.014290153980255127, 0.06204017996788025, 0.001749055227264762, 0.014624171890318394, 0.015815017744898796, -0.021769247949123383, 0.056492578238248825, 0.011472785845398903, 0.025748416781425476, 0.052019644528627396, -0.027273280546069145, -0.04560069367289543, 0.011349344626069069, 0.0071959057822823524, -0.04394512623548508, 0.01546647772192955, -0.041824840009212494, -0.006821950897574425, 0.027491118758916855, -0.008960391394793987, -0.015219594351947308, 0.00500300619751215, 0.03453453630208969, 0.022350149229168892, -0.015277684666216373, -0.005801744293421507, 0.01914067380130291, 0.03035205416381359, -0.03598678857088089, 0.01582954078912735, -0.03630628436803818, -0.03740999475121498, -0.03337273746728897, -0.013484153896570206, 0.02332315780222416, 0.010216588154435158, 0.050305988639593124, -0.022843914106488228, 0.005369699560105801, -0.0064007979817688465, -0.06279534846544266, -0.047256261110305786, 0.02102860063314438, -0.016686368733644485, 0.021638546139001846, 0.023933103308081627, -0.01626521535217762, 0.013338929042220116, 0.020404132083058357, -0.05977466702461243, 0.09143374860286713, -0.0483890175819397, -0.02791227214038372, 0.051583968102931976, -0.02281486988067627, 0.024644706398248672, -0.028435083106160164, 0.018182188272476196, -0.02805749699473381, -0.014253847301006317, -0.03842657059431076, 0.02904502861201763, 0.009018480777740479, -0.0064516267739236355, 0.0018280214862897992, -0.08306878060102463, 0.006041365675628185, 0.02412189543247223, 0.04716912657022476, 0.003964646253734827, -0.009926138445734978, 0.030468234792351723, -0.06750064343214035, -0.021188348531723022, 0.0027502011507749557, 0.04603637009859085, 0.012518406845629215, 0.005079249385744333, -0.013164659030735493, -0.023061752319335938, -0.01957634836435318, -0.02182733826339245, -0.049434635788202286, 0.011342083103954792, -0.032878972589969635, -0.03694527596235275, -0.04420653358101845, -0.0469367653131485, -0.002103949198499322, -0.031020089983940125, -0.011523614637553692, -0.00514823105186224, 0.014115883968770504, 0.01510341465473175, -0.049144186079502106, 0.014362766407430172, 0.0014749427791684866, 0.02296009473502636, 0.019750619307160378, 0.015931198373436928, -0.026619767770171165, -0.0003249412402510643, -0.00931619293987751, 0.053878527134656906, 0.0005309794214554131, 0.01590215228497982, 0.0367419607937336, -0.013818171806633472, -0.0012925037881359458, -0.0407501757144928, -0.028042973950505257, -0.10177377611398697, 0.0034581737127155066, 0.007958337664604187, -0.04458411782979965, -0.05175824090838432, 0.01190119981765747, -0.029742108657956123, 0.0183709803968668, -0.036771006882190704, 0.01812409795820713, 0.02131905034184456, -0.002042228588834405, 0.01246031653136015, 0.009947922080755234, 0.0006884579197503626, -0.07987383008003235, -0.02052031271159649, 0.02441234514117241, -0.009526768699288368, 0.037177637219429016, -0.020651014521718025, -0.06018129736185074, -0.042376697063446045, 0.01177049707621336, -0.05225200578570366, -0.008372229523956776, -0.03218189254403114, -0.022626075893640518, -0.02980019897222519, -0.050886888056993484, -0.049289412796497345, 0.0331113301217556, -0.04673345014452934, -0.006074041593819857, -0.049434635788202286, -0.0013170104939490557, -0.040082138031721115, 0.04374181106686592, -0.048011429607868195, -0.0023217869456857443, -0.023889536038041115, 0.038048986345529556, -0.0033147637732326984, -0.0009067494538612664, -0.04115680605173111, 0.034302178770303726, -0.0030043451115489006, -0.036073923110961914, 0.004552808124572039, 0.022756779566407204, -0.04214433580636978, -0.007221320178359747, 0.03279183804988861, 0.007373806554824114, 0.004182484000921249, 0.0036251824349164963, -0.07290302217006683, -0.012714460492134094, 0.019039016216993332, 0.007224950473755598, -0.04234765097498894, -0.018545249477028847, -0.00831413920968771, -0.012293308041989803, -0.033895548433065414, 0.013324406929314137, 0.005427789408713579, -0.03624819591641426, 0.015931198373436928, 0.03380841389298439, -0.007849418558180332, 0.0017454246990382671, -0.05472083389759064, -0.021348094567656517, -0.005485879722982645, -0.008619111962616444, 0.011886677704751492, 0.03377936780452728, 0.054604653269052505, 0.02139166370034218, 0.050596438348293304, -0.0063499691896140575, -0.027244236320257187, -0.009570336900651455, 0.07696932554244995, 0.024325210601091385, 0.0048178439028561115, -0.005126447416841984, 0.022538941353559494, 0.046965811401605606, -0.0072285812348127365, -0.06953379511833191, 0.01249662321060896, -0.02844960428774357, -0.004625420551747084, -0.001855251146480441, -0.04083731025457382, 0.013948874548077583, 0.024354256689548492, 0.032036665827035904, 0.057480111718177795, 0.024731840938329697, -0.03465071693062782, 0.006698509678244591, -0.06250490248203278, 0.01328083872795105, 0.04966699704527855, 0.03883320093154907, 0.017659377306699753, 0.00784215796738863, 0.008009166456758976, 0.017368925735354424, -0.006865518633276224, 0.019285898655653, 0.017993394285440445, -0.00032335284049622715, 0.008321400731801987, -0.044961702078580856, 0.04592018947005272, 0.022045176476240158, -0.02921929769217968, -0.02859482914209366, 0.015030802227556705, -0.01641044020652771, 0.012017380446195602, -0.0023217869456857443, 0.03212380036711693, -0.04690771922469139, 0.002955331699922681, 0.035783473402261734, 0.05097402259707451, -0.016294261440634727, 0.016642801463603973, 0.0072067975997924805, -0.02489158883690834, -0.06964997947216034, 0.02980019897222519, -0.0015039878198876977, 0.0013043032959103584, -0.04031449928879738, 0.004465673118829727, -0.03688718378543854, -0.044816479086875916, 0.013404279947280884, -0.01779007911682129, 0.007424635346978903, -0.047546710819005966, -0.031891439110040665, -0.030613459646701813, -0.00445841159671545, 0.00914918351918459, 0.043248046189546585, 0.020752672106027603, -0.0062664649449288845, -0.011712407693266869, -0.026518110185861588, -0.025704849511384964, -0.014943666756153107, -0.005024789832532406, 0.03325655683875084, 0.010993543080985546, 0.045106928795576096, -0.05091593414545059, -0.0071450769901275635, 0.04173770546913147, 0.03424408659338951, -0.05149683356285095, -0.035493023693561554, -0.014406333677470684, 0.02641645260155201, 0.051293518394231796, 0.010448948480188847, 0.02110121212899685, 0.00811808556318283, 0.023119842633605003, -0.025312742218375206, 0.014449900947511196, -0.00030565354973077774, 0.00014465785352513194, -0.03081677481532097, 0.02696830779314041, -0.05315240100026131, 0.009940660558640957, 0.007286671549081802, 0.016584711149334908, 0.023715265095233917, 0.021333573386073112, 0.007791328709572554, 0.014682261273264885, 0.043509453535079956, -0.008611850440502167, -0.0030642503406852484, 0.024659229442477226, 0.030323009938001633, 0.0185597725212574, 0.02146427519619465, 0.0010138530051335692, -0.010020534507930279, 0.005199059844017029, 0.039239831268787384, -0.023816922679543495, 0.038949381560087204, -0.002223759889602661, -0.018530728295445442, 0.07063750922679901, 0.008960391394793987, -0.0062882485799491405, -0.048011429607868195, -0.044090352952480316, -0.018893791362643242, -0.017586763948202133, 0.014399072155356407, 0.04891182854771614, -0.024760887026786804, 0.02041865512728691, -0.007653364911675453, -0.047546710819005966, -0.010238372720777988, -0.002978930715471506, -0.01115329097956419, 0.003331101732328534, -0.02933547832071781, -0.00383394374512136, -0.010768444277346134, -0.0716831311583519, 0.013781866058707237, 0.05588263273239136, 0.022132311016321182, -0.05724775046110153, -0.0011245871428400278, -0.022582508623600006, 0.009083832614123821, -0.03932696953415871, 0.0025940840132534504, 0.0071886442601680756, 0.030874865129590034, 0.018588818609714508, 0.02452852576971054, -0.005177276208996773, 0.004966699983924627, 0.022538941353559494, 0.0008273294661194086, 0.02638740837574005, -0.008364968001842499, 0.003369223326444626, -0.04833092540502548, -0.021958041936159134, -0.019256852567195892, -0.038078032433986664, 0.06860435754060745, 0.012532929889857769, 0.028725532814860344, 0.03064250387251377, 0.05515650659799576, -0.027810614556074142, -0.015219594351947308, 0.012060947716236115, -0.015553612262010574, 0.009156445041298866, 0.025167517364025116, -0.01015123724937439, 0.022582508623600006, -0.07551707327365875, 0.023381248116493225, 0.05050930380821228, 0.026503587141633034, -0.017078476026654243, 0.030468234792351723, -0.026009822264313698, -0.0018425439484417439, -0.014195756986737251, -0.05396566167473793, -0.0054495735093951225, 0.02044769935309887, -0.0312814936041832, -0.00564925791695714, -0.07063750922679901, -0.02587912045419216, -0.003975538071244955, -0.012801595963537693, -0.012837902642786503, 0.01771746762096882, 0.0030097910203039646, 0.014696784317493439, -0.022437283769249916, 0.03854275122284889, 0.06360860913991928, 0.05341380462050438, -0.027897749096155167, -0.02303270623087883, -0.061807818710803986, 0.014783918857574463, -0.04493265971541405, 0.002093057380989194, -0.00039074639789760113, 0.003017052309587598, 0.027084488421678543, 0.04228955879807472, 0.020912420004606247, -0.020897896960377693, 0.03293706104159355, -0.03900747373700142, 0.0048359972424805164, -0.01400696486234665, -0.015350297093391418, -0.014384550042450428, 0.04231860488653183, 0.06616457551717758, 0.008502932265400887, -0.06099455803632736, -0.03508639335632324, 0.002002291614189744, -0.011066155508160591, 0.04173770546913147, 0.014987234026193619, -0.006898194085806608, 0.003084218828007579, -0.025951731950044632, -0.038223255425691605, 0.03514448553323746, 0.05910663306713104, -0.026547156274318695, -0.07046324014663696, 0.008735291659832, -0.00698532909154892, 0.01771746762096882, -0.03694527596235275, -0.019808709621429443, 0.04795334115624428, 0.003986429888755083, 0.004523762967437506, 0.0029408091213554144, -0.0447583869099617, -0.014769396744668484, -0.0037577005568891764, 0.0002906771842390299, 0.0014731275150552392, -0.004324078559875488, -0.03308228775858879, -0.019779663532972336, 0.05942612513899803, 0.0064225816167891026, 0.00273386319167912, -0.05413993075489998, 0.06819772720336914, 0.01115329097956419, 0.03009064868092537, 0.006640419363975525, -0.0031060026958584785, -0.01590215228497982, -0.018545249477028847, 0.023482905700802803, 0.012155343778431416, 0.015669792890548706, 0.028623875230550766, 0.021565932780504227, -0.012365920469164848, 0.030584413558244705, -0.018574295565485954, -0.04676249623298645, -0.0028482279740273952, -0.01674445904791355, 0.005943338852375746, -0.006923608481884003, 0.018022440373897552, 0.005340654402971268, 0.02150784246623516, 0.012779812328517437, -0.0041135018691420555, -0.05724775046110153, 0.0189228355884552, 0.04019831866025925, 0.054749876260757446, 0.05300717428326607, 0.04118584841489792, -0.030293963849544525, -0.017194656655192375, -0.017891736701130867, 0.006291879341006279, -0.02365717478096485, 0.015510044991970062, -0.018385503441095352, -0.014747613109648228, -0.02110121212899685, 0.019779663532972336, -0.01079022791236639, -0.007464572321623564, -0.0019024492939934134, 0.04014023020863533, -0.02547249011695385, 0.005079249385744333, 0.007566229905933142, 0.018400024622678757, 0.014733090065419674, 0.004480195697396994, -0.03133958578109741, -0.0071668606251478195, 0.013672946952283382, -0.03909460827708244, -0.0012725353008136153, -0.014507991261780262, 0.006629527546465397, 0.0054386816918849945, -0.0027483857702463865, -0.024078328162431717, -0.014435378834605217, -0.004356754012405872, 0.03918174281716347, -0.017877215519547462, 0.011799542233347893, -0.010173020884394646, 0.00914918351918459, 0.010964497923851013, -0.0070543112233281136, -0.026096956804394722, -0.08591519296169281, -0.03409886360168457, -0.023816922679543495, 0.03868797793984413, -0.012416749261319637, 0.008575544692575932, 0.017601286992430687, -0.027810614556074142, -0.019039016216993332, -0.02460113912820816, -0.0047452314756810665, -0.020041069015860558, -0.03563825041055679, 0.029350001364946365, 0.008147130720317364, 0.0073919594287872314, 0.003823051694780588, 0.014478946104645729, -0.02008463628590107, 0.02358456328511238, -0.017441539093852043, -0.012402227148413658, -0.008089040406048298, 0.033605098724365234, -0.041650570929050446, -0.02740398421883583, -0.011073417030274868, -0.05170014873147011, 0.006789275445044041, 0.0072067975997924805, -0.014173973351716995, -0.007936554029583931, 0.005144600756466389, 0.021086690947413445, -0.012830641120672226, -0.0212900061160326, 0.019619915634393692, -0.028725532814860344, 0.0212900061160326, 0.01699134148657322, -0.002944439649581909, 0.005053834989666939, 0.03340178355574608, -0.038920335471630096, 0.018254799768328667, 0.03697432205080986, -0.04879564791917801, 0.023061752319335938, -0.01079022791236639, 0.009548553265631199, 0.009359760209918022, 0.03700336441397667, 0.030613459646701813, -0.015727883204817772, -0.040953490883111954, -0.009192751720547676, -0.005071987863630056, -0.042696189135313034, 0.0017345327651128173, 0.006934500299394131, 0.04551355913281441, -0.029350001364946365, 0.042957596480846405, 0.024572093039751053, -0.02150784246623516, 0.01786269247531891, -0.011559921316802502, -0.023744311183691025, -0.015989288687705994, 0.001951462822034955, 0.0028391515370458364, 0.0034745114389806986, -0.022074220702052116, 0.031020089983940125, -0.0053987447172403336, 0.00813260767608881, -0.009178228676319122, -0.03953028470277786, 0.033314645290374756, 0.01779007911682129, -0.0102819399908185, 0.011690624058246613, -0.01495818980038166, 0.0036560429725795984, 0.0023381246719509363, 0.002820998430252075, -0.031717170029878616, -0.04859233275055885, -0.022335626184940338, 0.002968038897961378, 0.011022588238120079, 0.04664631560444832, -0.003051543142646551, -0.019039016216993332, -0.003441835753619671, 0.01863238587975502, -0.019532781094312668, 0.001230783062055707, 0.0040626730769872665, -0.001585677033290267, -0.012961343862116337, -0.01776103489100933, -0.006128500681370497, -0.03436026722192764, -0.01373829785734415, -0.017412494868040085, -0.0004951269365847111, -0.002784691983833909, 0.00762431975454092, 0.022321103140711784, 0.011211380362510681, 0.013839955441653728, -0.030874865129590034, 0.01674445904791355, -0.005761807318776846, -0.0039573851972818375, -0.0271135326474905, 0.024760887026786804, 0.014733090065419674, 0.012670893222093582, -0.023236021399497986, 0.006611374672502279, -0.0363934189081192, -0.03133958578109741, -0.01479118037968874, 0.007733238860964775, 0.013767343014478683, 0.04202815517783165, -0.010710353963077068, -0.003285718848928809, -1.177826925413683e-05, -0.019561827182769775, -0.012104514986276627, -0.0252836961299181, -0.021231915801763535, -0.03133958578109741, 0.002212868072092533, -0.0027247867546975613, 0.028406037017703056, 0.018240276724100113, 0.04653013497591019, -0.005485879722982645, -0.0056347353383898735, -0.028362469747662544, -0.015858585014939308, 0.0509449802339077, 0.014086838811635971, -0.025269174948334694, -0.036480553448200226, -0.002632205607369542, -0.05933899059891701, -0.012329614721238613, 0.02598077803850174, -0.03543493524193764, -0.0022891112603247166, -0.054749876260757446, -0.017949827015399933, -0.018182188272476196, -0.006106717046350241, 0.0345635823905468, -0.028260812163352966, -0.0029517009388655424, -0.00811808556318283, -0.02605338953435421, -0.00323489005677402, -0.0004933116724714637, -0.0009784543653950095, -0.0056129517033696175, 0.023889536038041115, -0.0010120377410203218, 0.0633181631565094, -0.004629051312804222, -0.05196155607700348, -0.013375235721468925, 0.011363866738975048, 0.0007624319987371564, 0.0004796967841684818, -0.03770044445991516, -0.0073011936619877815, -0.004414844326674938, 0.03499925881624222, 0.030584413558244705, -0.02368622086942196, -0.008154391311109066, 0.0017063954146578908, -0.02143523097038269, 0.028362469747662544, 0.0046217902563512325, 0.026692381128668785, 0.016134513542056084, -0.000963931845035404, 0.01793530397117138, -0.025414399802684784, -0.004741600714623928, -0.01548099983483553, -0.016308782622218132, 0.015422909520566463, 0.01259101927280426, -0.017848169431090355, -0.03947219252586365, 0.002739309100434184, -0.03723572567105293, 0.013876262120902538, 0.01659923419356346, 0.012046425603330135, 0.0023417554330080748, -0.03354700654745102, -0.00195509335026145, 0.040924444794654846, -0.022219445556402206, -0.01609094627201557, 0.0033728538546711206, 0.006143023259937763, 0.041098713874816895, -0.0030097910203039646, -0.034302178770303726, 0.0028663810808211565, 0.014232063665986061, -0.0302068293094635, 0.03485403209924698, 0.03427313268184662, 0.014391811564564705, 0.01062321849167347, -0.01706395298242569, 0.014239325188100338, -0.03328560292720795, 0.006008690223097801, 0.020607447251677513, 0.015945719555020332, 0.010398119688034058, 0.00043794457451440394, -0.014326459728181362, 0.012903253547847271, 0.0017200101865455508, 0.0014649585355073214, -0.010615957900881767, 0.0030551739037036896, 0.02714257873594761, -0.014783918857574463, -0.02994542382657528, -0.014718567952513695, -0.00045677844900637865, -0.010325507260859013, -0.00015827271272428334, -0.026038868352770805, -0.00044384432840161026, 0.03523162007331848, 0.06424760073423386, -0.04060494899749756, 0.02808654122054577, 0.019198764115571976, 0.01757224276661873, -0.007529923692345619, -0.012104514986276627, -0.027592776343226433, 0.01280885748565197, 0.003387376433238387, -0.013527722097933292, 0.006680356338620186, -0.004875934217125177, 0.0018216678872704506, 0.015510044991970062, -0.03139767423272133, 0.008996697142720222, -0.015161504969000816, -0.0031786151230335236, -0.005652888678014278, 0.02470279671251774, 0.03900747373700142, -0.029306432232260704, -0.1291922777891159, -0.011654317378997803, 0.027447551488876343, -0.011044371873140335, 0.0010347290663048625, -0.013948874548077583, 0.00369416456669569, -0.005471357144415379, -0.002122102305293083, -0.028827190399169922, 0.029103117063641548, -0.03299515321850777, -0.002405291423201561, -0.020549356937408447, 0.0026630659122020006, -0.04545546695590019, 0.0027592775877565145, -0.01575692743062973, 0.03409886360168457, -0.031020089983940125, -0.020680060610175133, -0.009592120535671711, 0.015873108059167862, 0.0027247867546975613, -0.016875160858035088, -0.014253847301006317, 0.011886677704751492, -0.004469303879886866, -0.008256048895418644, -0.015887631103396416, -0.0048069520853459835, -0.0016918728360906243, 0.014798441901803017, -0.010739399120211601, -0.04560069367289543, -0.03267565742135048, -0.023918580263853073, 0.008793381974101067, 0.018167665228247643, -0.005082879681140184, 0.02358456328511238, -0.038223255425691605, 0.06482850015163422, -0.02554510161280632, 0.02300366200506687, -0.025094904005527496, -0.0015566319925710559, -0.028072020038962364, 0.013985181227326393, 0.011102462187409401, 0.04170865938067436, 0.021275483071804047, 0.0072685182094573975, 0.008982175029814243, -0.007232211995869875, 0.03656769171357155, 0.002506949007511139, 0.014747613109648228, -0.0032094756606966257, -0.0037794841919094324, -0.006970806512981653, 0.05106115713715553, 0.014420856721699238, -0.02314888685941696, -0.03078772872686386, -0.0035689077340066433, -0.001222614198923111, 0.02027343027293682, -0.018138619139790535, -0.05527268722653389, -0.028536740690469742, 0.013469631783664227, 0.02991637960076332, 0.021188348531723022, -0.003392822341993451, 0.006426212377846241, 0.043974172323942184, 0.03816516697406769, -0.007065203040838242, 0.024034760892391205, 0.03883320093154907, -0.04908609762787819, 0.0036033987998962402, 0.011182336136698723, 0.004687141161412001, 0.023236021399497986, 0.01742701604962349, -0.010782966390252113, -0.012816118076443672, -0.001740886364132166, 0.031746216118335724, -0.004425736144185066, 0.01725274696946144, -0.009926138445734978, -0.020825285464525223, -0.05512746423482895, -0.0003467250207904726, -0.03308228775858879, 0.042521920055150986, -0.014624171890318394, 0.02285843715071678, 0.01395613607019186, -0.0407501757144928, -0.0041643306612968445, 0.01328083872795105, 0.0065133473835885525, 0.007381067611277103, 0.009904354810714722, 0.035899654030799866, -0.03883320093154907, -0.009512246586382389, 0.047837160527706146, 0.0024252599105238914, 0.00390292564406991, -0.006255572661757469, 0.053471896797418594, 0.06575794517993927, -0.009613904170691967, 0.010071363300085068, 0.02223396860063076, 0.016758980229496956, 0.02030247449874878, -0.024136418476700783, 0.03665482625365257, -0.008364968001842499, 0.0026630659122020006, -0.025196561589837074, 0.018036961555480957, -0.023119842633605003, 0.0198377538472414, 0.021406184881925583, 0.004516501910984516, 0.007747760973870754, 0.02426712028682232, -0.026547156274318695, 0.01979418657720089, 0.03816516697406769, -0.010354552417993546, -0.04060494899749756, 0.017630331218242645, 0.0008913193014450371, 0.0010501593351364136, 0.005547600332647562, 0.013818171806633472, -0.027883226051926613, 0.0022491742856800556, 0.02172568067908287, -0.03168812394142151, -0.026358362287282944, 0.018254799768328667, 0.020897896960377693, -0.030148738995194435, -0.008285094052553177, 0.005543969571590424, 0.023424815386533737, 0.019532781094312668, 0.023991193622350693, -0.015321251936256886, 0.0037794841919094324, -0.007508139591664076, 0.032007619738578796, 0.06378287822008133, -0.00744278822094202, -0.02518203854560852, 0.043248046189546585, -0.027171622961759567, -0.0005713701830245554, 0.013215487822890282, -0.009751868434250355, 0.00298437662422657, -0.010485255159437656, -0.026808559894561768, 0.005311609245836735, -0.009163706563413143, 0.031049134209752083, 0.022945571690797806, 0.003884772537276149, 0.018937358632683754, -0.008096301928162575, 0.07110223174095154, 0.0012943190522491932, 0.02842056006193161, 0.020113682374358177, -0.013426064513623714, 0.035609204322099686, -0.005046573467552662, -0.0022219447419047356, 0.028827190399169922, 0.014014226384460926, 0.02754920907318592, -0.008190697990357876, 0.053588077425956726, 0.0041135018691420555, 0.015655269846320152, 0.008059995248913765, -0.01157444342970848, 0.01969252899289131, 0.0096429493278265, -0.04234765097498894, -0.07208976149559021, -0.03151385486125946, 0.06906907260417938, 0.009308931417763233, -0.006455257534980774, -0.02762182056903839, 0.026735948398709297, -0.014616910368204117, -0.011618010699748993, -0.011705146171152592, 0.036771006882190704, 0.031426720321178436, 0.018908312544226646, -0.007312085945159197, 0.01790625974535942, -0.00996970571577549, -0.01732535846531391, -0.013469631783664227, 0.004567330703139305, -0.030991043895483017, -0.03009064868092537, -0.02314888685941696, -0.01677350327372551, 0.018356457352638245, 0.02095598727464676, -0.025094904005527496, -0.0045491773635149, -0.007914770394563675, 0.0003694164624903351, 0.006302771158516407, 0.02078171819448471, 0.006800167262554169, -0.032878972589969635, -0.009947922080755234, 0.01171966828405857, -0.022292058914899826, -0.02980019897222519, 0.014036010019481182, 0.021899951621890068, -0.003739547450095415, 0.005406005773693323, 0.048853736370801926, 0.019300421699881554, -0.0019732466898858547, -0.00383394374512136, 0.0400240495800972, 0.022175878286361694, 0.012685416266322136, 0.0037577005568891764, -0.030874865129590034, -0.016323305666446686, -0.011421957053244114, 0.007696932181715965, -0.015771450474858284, -1.5245803297148086e-05, -0.006113978568464518, -0.003300241194665432, 0.005994167644530535, 0.04098253324627876, 0.00606678007170558, 0.009809957817196846, -0.03534780070185661, 0.006048627197742462, 0.0048069520853459835, -0.009272624738514423, 0.03624819591641426, -0.021130258217453957, -0.025922687724232674, 0.025530578568577766, 0.024731840938329697, 0.008800643496215343, -0.0031568314880132675, 0.022756779566407204, 0.001278888899832964, 0.05207773670554161, -0.003038835944607854, -0.011269470676779747, 0.029538793489336967, 0.015132459811866283, 0.013048478402197361, 0.018966402858495712, -0.007972859777510166, 0.019736096262931824, -0.028841713443398476, 0.0027592775877565145, 0.006255572661757469, -0.03563825041055679, 0.0021856382954865694, 0.0019314943347126245, 0.020897896960377693, 0.02416546270251274, 0.06128500774502754, 0.04667535796761513, -0.007464572321623564, -0.004240573849529028, -0.011545398272573948, -0.007689671125262976, 0.012620064429938793, 0.008430318906903267, 0.013745559379458427, -0.02066553756594658, 0.001153632183559239, 0.019082583487033844, 0.014261108823120594, -0.04231860488653183, 0.037787582725286484, 0.006466149352490902, 0.0030660657212138176, -0.04388703778386116, 0.004716186318546534, -0.00482147466391325, -0.020099159330129623, -0.0015021725557744503, 0.0039174482226371765, -0.00013887154636904597, -0.010674047283828259, -0.014210280030965805, 0.01735440455377102, -0.020985033363103867, -0.01328083872795105, 0.012830641120672226, 0.009076571092009544, 0.0035416781902313232, 0.005104663781821728, 0.03947219252586365, -0.004984852857887745, -0.026038868352770805, 0.004552808124572039, 0.023453859612345695, 0.007936554029583931, 0.006495194509625435, 0.0073011936619877815, 0.001100080437026918, -0.0429285503923893, -0.024978723376989365, -0.06378287822008133, -0.0033093178644776344, -0.03816516697406769, -0.010143975727260113, 0.008800643496215343, -0.022553464397788048, 0.015495521947741508, -0.00606678007170558, 0.0026358363684266806, -0.00835044588893652, -0.009439634159207344, 0.0289288479834795, 0.003204029519110918, 0.0004656281089410186, -0.0016564741963520646, -0.0178336463868618, 0.07046324014663696, -0.012707199901342392, -0.015176027081906796, 0.0014567896723747253, -0.03680004924535751, 0.01180680375546217, 0.0028609351720660925, 0.008924084715545177, -0.02070910483598709, 0.039646461606025696, 0.007493617013096809, 0.01148004736751318, -0.018501682206988335, 0.026140525937080383, 0.016860637813806534, 0.00542052835226059, -0.032878972589969635, 0.04414844140410423, 0.03499925881624222, 0.022698689252138138, 0.005819897633045912, 0.02063649147748947, 0.006415320560336113, -0.001951462822034955, 0.019242331385612488, 0.011777758598327637, -0.002989822532981634, 0.015292206779122353, 0.04263810068368912, 0.04069208353757858, 0.001057420508004725, -0.026184093207120895, -0.03377936780452728, 0.01659923419356346, -0.022175878286361694, -0.009200012311339378, -0.009454156272113323, 0.04682058468461037, 0.007566229905933142, -0.01732535846531391, -0.015306729823350906, 0.01829836703836918, 0.028740055859088898, 0.004385799169540405, 0.002937178360298276, 0.026939263567328453, 0.007529923692345619, 0.005406005773693323, 0.03180430456995964, -0.012206172570586205, 0.024252599105238914, -0.021188348531723022, 0.022408239543437958, -0.00164195173420012, 0.02182733826339245, 0.009563075378537178, 0.002269142773002386, 0.024209029972553253, 0.005289825610816479, 0.029713062569499016, -0.022350149229168892, 0.003761331085115671, -0.03009064868092537, -0.0034055295400321484, -0.0018507128115743399, -0.037351906299591064, 0.019024493172764778, 0.03714859113097191, -0.025167517364025116, 0.02259703166782856, -0.020694581791758537, -0.010310985147953033, -0.027854181826114655, -0.006930869538336992, -0.0070325275883078575, 0.0004737970302812755, -0.035202573984861374, 0.028188198804855347, -0.0031513855792582035, 0.05027694255113602, -0.0022382824681699276, -0.0101875439286232, -0.013861739076673985, -0.018530728295445442, -0.017964350059628487, 0.035202573984861374, 0.014072315767407417, 0.004291402641683817, -0.021188348531723022, 0.025559624657034874, 0.0017136565875262022, 0.01246031653136015, 0.04377085715532303, 0.024615660309791565, -0.016294261440634727, -0.0012670893920585513, 0.009802697226405144, 0.015074369497597218, 0.00431318674236536, -0.006219266448169947, -0.019968457520008087, 0.00473796995356679, 0.01331714540719986, -0.005565753672271967, -0.014014226384460926, -0.014515252783894539, -0.00707609485834837, -0.010521560907363892, -0.01115329097956419, 0.008815165609121323, 0.002093057380989194, -0.012917776592075825, 0.016149034723639488, 0.04609445855021477, -0.01844359189271927, 0.023599084466695786, -0.007885725237429142, 0.06604839116334915, 0.01259101927280426, -0.00024393285275436938, 0.029684018343687057, 0.01216986682265997, 0.004988483618944883, 0.00656054588034749, -0.028812667354941368, 0.015989288687705994, -0.009577597491443157, -0.03395363688468933, -0.0007052496075630188, -0.003804898587986827, -0.02078171819448471, -0.005028420593589544, 0.027084488421678543, -0.01144374068826437, -0.015626225620508194, 0.014370027929544449, 0.013179181143641472, -0.05155492573976517, 0.0020331519190222025, 0.015016279183328152, 0.015800494700670242, 0.04301568493247032, -0.018879268318414688, -0.010020534507930279, -0.0078203734010458, -0.014987234026193619, 0.0010020534973591566, -0.02136261761188507, 0.04272523522377014, 0.03163003548979759, -0.006694878917187452, -0.000680742843542248, 0.015350297093391418, 0.019184241071343422, -0.004988483618944883, -0.008030950091779232, -0.008241526782512665, -0.010035057552158833, 0.018182188272476196, -0.005373330321162939, 0.006273726001381874, -0.02849317155778408, 0.005373330321162939, 0.015553612262010574, 0.03697432205080986, -0.005652888678014278, -0.009083832614123821, 0.012010118924081326, -0.007036157883703709, 0.018109574913978577, 0.018211232498288155, -0.0086408955976367, -0.00014885576092638075, -0.01259101927280426, -0.001137294340878725, 0.00835044588893652, -0.02815915457904339, 0.020476745441555977, -0.016439486294984818, 0.01725274696946144, -0.013186442665755749, -0.012968605384230614, 0.013520460575819016, 0.020621970295906067, 0.0005282564670778811, 0.000682104320731014, 0.022074220702052116, 0.01720917969942093, 0.015205072239041328, 0.01346237026154995, -0.002920840634033084, -0.03938505798578262, 0.0035834303125739098, 0.01524863950908184, 0.021086690947413445, 0.04763384535908699, 0.016003809869289398, 0.00555849215015769, 0.028769100084900856, 0.0017036724602803588, -0.013571289367973804, -0.003750439267605543, -0.00012151259579695761, 0.025937210768461227, -0.010122192092239857, -0.007922030985355377, 0.011022588238120079, -0.010035057552158833, 0.01641044020652771, -0.0020458591170608997, 0.03941410407423973, 0.0032312592957168818, -0.005474987905472517, 0.017659377306699753, 0.013404279947280884, -0.01424658577889204, 0.008960391394793987, 0.007595274597406387, -0.013208226300776005, -0.007312085945159197, -0.016657322645187378, -0.00422242097556591, 0.021899951621890068, 0.0028536738827824593, 0.003391006961464882, 0.0014495283830910921, 0.029204774647951126, 0.017383448779582977, 0.011596227064728737, 0.006963545456528664, 0.011095200665295124, -0.05251340940594673, -0.011465524323284626, -0.003494479926303029, -0.012394965626299381, 0.002240097848698497, -0.012075470760464668, 0.005812636110931635, -0.00017143374134320766, 0.0013170104939490557, -0.03584156557917595, 0.022945571690797806, -0.009766390547156334, 0.016512097790837288, -0.0007647011079825461, 0.04028545320034027, 0.004875934217125177, 0.03473785147070885, -0.011356606148183346, 0.012932298704981804, 0.02044769935309887, 0.02223396860063076, -0.007740499917417765, -0.02310531958937645, 0.03970455378293991, -0.03592870011925697, 0.004316817037761211, -0.02160950005054474, -0.0029063180554658175, 0.02667785808444023, -0.03743904083967209, -0.03886224702000618, -0.006015951279550791, -0.009054787456989288, -0.026213137432932854, 0.008067256771028042, -0.038513705134391785, -0.023381248116493225, -0.022843914106488228, 0.00680379755795002, -0.0038085293490439653, 0.014638694003224373, 0.0004533747269306332, -0.03473785147070885, 0.003067881101742387, 0.01211903803050518, 0.018240276724100113, 0.0024924264289438725, 0.018879268318414688, -0.011777758598327637, 0.011712407693266869, -0.028551261872053146, -0.022466329857707024, 0.005304348189383745, 0.0008482055854983628, 0.015539090149104595, 0.014108622446656227, -0.026953786611557007, -0.005536708515137434, 0.018893791362643242, -0.029524270445108414, 0.010579651221632957, 0.010209327563643456, -0.03168812394142151, 0.011407434940338135, 0.030410144478082657, 0.037206679582595825, -0.019024493172764778, -0.023424815386533737, 0.014871054328978062, -0.001828929060138762, -0.016875160858035088, 0.018312890082597733, 0.005907032638788223, 0.0323852077126503, 0.0396755076944828, -0.014065055176615715, 0.04345136135816574, -0.0022655122447758913, 0.007900247350335121, 0.009490462951362133, 0.018864745274186134, -0.013338929042220116, 0.04255096614360809, 0.02285843715071678, 0.026910217478871346, -0.0006389906047843397, 0.013397019356489182, -0.03206571191549301, 0.003913817461580038, -0.027026398107409477, -0.0002999806893058121, -0.005071987863630056, 0.013760081492364407, 0.03587060794234276, 0.029379045590758324, -0.0209269430488348, 0.0035816149320453405, -0.00031677234801463783, -0.028188198804855347, 0.03247234225273132, 0.01611999049782753, 0.019416600465774536, 0.021711157634854317, -0.0006467056809924543, 0.006044996436685324, 0.012373181991279125, 0.010049579665064812, 0.019155194982886314, -0.014224802143871784, -0.03308228775858879, 0.00015770542086102068, 0.015945719555020332, 0.005293456371873617, -0.02052031271159649, -0.005035681650042534, -0.0007161414832808077, -0.008110824041068554, -0.016149034723639488, -0.0037976372987031937, -0.0024415976367890835, 0.04650108888745308, 0.0021693005692213774, -0.00310237193480134, -0.0035707231145352125, 0.006418951321393251, -0.009076571092009544, -0.023700742051005363, -0.015771450474858284, 0.00022362402523867786, -0.015495521947741508, -0.02088337577879429, 0.026082435622811317, 0.02518203854560852, -0.047285307198762894, 0.04809856787323952, -0.010405381210148335, -0.001585677033290267, 0.03621914982795715, -0.009802697226405144, 0.00638627540320158, 0.028740055859088898, 0.022843914106488228, 0.012605542317032814, -0.03642246499657631, -0.028870757669210434, -0.01611999049782753, -0.03900747373700142, 0.05120638385415077, -0.015698837116360664, 0.0056238435208797455, -0.01768842153251171, -0.0014023302355781198, -0.015030802227556705, 0.003222182858735323, -0.01998297870159149, -0.03067154996097088, 0.03932696953415871, 0.003191322321072221]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"HF algorithm for LLMs to deliver appropriate and well-structured responses. Notably,
in this process, we do not leverage any external responses from the powerful closed-source LLMs. Here, the
external information is the relative preference signal.
5https://huggingface.co/mistralai/Mistral-7B-v0.1
6https://tatsu-lab.github.io/alpaca_eval/
7https://huggingface.co/sfairXC/FsfairX-Zephyr-Chat-v0.1
24
0.0 0.5 1.0 1.5 2.0 2.5 3.0
Iteration81012141618202224Length-control Win Rate
SFT Model
Zephyr-Beta: Offline DPO
RAFT
Online-GSHF-DPOFigure 6: The results of length-control AlpacaEval-2 Win-Rate v.s. GPT-4 Preview (11/06) for different
methods.
7 Conclusion
In this paper, we formulate the real-world RLHF process as a reverse-KL regularized contextual bandit
problem. Compared to existing theoretical RLHF frameworks, the proposed framework admits a stochas-
tic optimal policy, that more accurately reflects the dynamics of foundation generative models and aligns
closely with current alignment practices (Ouyang et al., 2022; Bai et al., 2022; Rafailov et al., 2023). We
design statistically efficient algorithms in offline, online, and hybrid settings, featuring the standard ideas
of pessimism and optimism in the new framework, while also handling the distinct challenges of preference
learning as well as the newly introduced KL constraint with distinct algorithmic designs.
The theoretical findings also sheds light on innovative pathways for practical algorithmic development, as
we move toward implementations of the information-theoretical algorithms in Section 5. The practical
implementations of the proposed algorithms outperform strong baselines like DPO and RSO in real-world
alignment of LLMs.
8 Acknowledgement
The authors would like to thank the anonymous reviewers for many insightful comments and suggestions.
References
Abbasi-Yadkori, Y., P´ al, D., and Szepesv´ ari, C. (2011). Improved algorithms for linear stochastic bandits.
Advances in neural information processing systems , 24.
Agarwal, A., Jiang, N., Kakade, S. M., and Sun, W. (2019). Reinforcement learning: Theory and algorithms.
CS Dept., UW Seattle, Seattle, WA, USA, Tech. Rep , 32.
Agarwal, A., Jin, Y., and Zhang, T. (2023). Vo ql: Towards optimal regret in model-free rl with nonlinear
function approximation. In The Thirty Sixth Annual Conference on Learning Theory , pages 987–1063.
PMLR.
25
Agarwal, A., Kakade, S. M., Lee, J. D., and Mahajan, G. (2021). On the theory of policy gradient methods:
Optimality, approximation, and distribution shift. The Journal of Machine Learning Research , 22(1):4431–
4506.
Alfano, C., Yuan, R., and Rebeschini, P. (2024). A novel framework for policy mirror descent with general
parameterization and linear convergence. Advances in Neural Information Processing Systems , 36.
Anthropic (2023). Introducing claude.
Askell, A., Bai, Y., Chen, A., Drain, D., Ganguli, D., Henighan, T., Jones, A., Joseph, N., Mann, B.,
DasSarma, N., et al. (2021). A general language assistant as a laboratory for alignment. arXiv preprint
arXiv:2112.00861 .
Auer, P., Cesa-Bianchi, N., and Fischer, P. (2002). Finite-time analysis of the multiarmed bandit problem.
Machine learning , 47:235–256.
Azar, M. G., Rowland, M., Piot, B., Guo, D., Calandriello, D., Valko, M., and Munos, R. (2023). A general
theoretical paradigm to understand learning from human preferences. arXiv preprint arXiv:2310.12036 .
Bai, J., Bai, S., Chu, Y., Cui, Z., Dang, K., Deng, X., Fan, Y., Ge, W., Han, Y., Huang, F., et al. (2023).
Qwen technical report. arXiv preprint arXiv:2309.16609 .
Bai","[-0.022073494270443916, 0.009999983943998814, 0.04664698243141174, 0.00542278541252017, 0.02651466242969036, 0.01149262860417366, -0.03644111752510071, 0.03299994766712189, -0.030794067308306694, 0.019485263153910637, 0.02599995769560337, -0.04252934455871582, -0.004345581401139498, 0.001822607358917594, 0.023132314905524254, -0.004613962955772877, 0.03167641907930374, -0.05529402941465378, 0.009786749258637428, 0.03676464781165123, -0.009330867789685726, -0.030941126868128777, -0.02383819781243801, 0.021911729127168655, -0.014242623932659626, -0.029132306575775146, 0.027941131964325905, 0.04564698413014412, 0.001961393980309367, -0.05461755767464638, 0.0271323099732399, -0.026823487132787704, -0.0215440820902586, -0.02773525007069111, -0.036646999418735504, 0.03317641839385033, 0.0010156233329325914, 0.01636761985719204, -0.026323487982153893, 0.014661741442978382, -0.0033051418140530586, -0.07929398864507675, -0.030970538035035133, 0.03729405626654625, -0.018323499709367752, 0.029411718249320984, -0.010110277682542801, 0.03632346913218498, 0.033029358834028244, 0.03117641992866993, -0.058588139712810516, 0.024661725386977196, -0.033882297575473785, -0.02495584264397621, 0.001619482645764947, 0.009139691479504108, 0.028441131114959717, 0.014558800496160984, 0.05020580068230629, 5.5577806051587686e-05, -0.03523523733019829, -0.019691145047545433, 0.021029377356171608, 0.039470523595809937, -0.02651466242969036, -0.02902936562895775, -0.08417633175849915, 0.004301463719457388, 0.01080145314335823, 0.05841166898608208, -0.019764674827456474, -0.005988961085677147, 0.027088191360235214, -0.027352897450327873, -0.026573486626148224, 0.014794093556702137, 0.0397646427154541, 0.08523515611886978, -0.019485263153910637, -0.022794080898165703, -0.014823505654931068, 0.004047787748277187, 0.04514698684215546, -0.06129401922225952, 0.0166323259472847, -0.05008815601468086, -0.04544110223650932, -0.005430138204246759, -0.062117546796798706, -0.0030845538713037968, -0.022014670073986053, -0.006444842554628849, -0.031970538198947906, 0.020264673978090286, 0.027764661237597466, 0.007308811880648136, 0.003424626775085926, 0.009904395788908005, 0.030352892354130745, 0.01895585097372532, -0.009397043846547604, -0.04079405218362808, 0.02548525296151638, -0.02773525007069111, 0.04897050932049751, 0.015632327646017075, -0.007970575243234634, 0.01286762673407793, -0.01988232135772705, 0.005985284689813852, -0.1152351051568985, -0.01886761747300625, -0.0482352152466774, 0.034558769315481186, -0.005507343914359808, -0.05641167238354683, -0.0661175400018692, -0.010514688678085804, 0.00701469462364912, -0.005415432620793581, -0.02661760337650776, 0.01545585785061121, 0.02135290764272213, 0.012485274113714695, 0.001996320206671953, -0.011970569379627705, 0.03961758315563202, -0.08188222348690033, -0.021632317453622818, -0.02876465953886509, 0.028352895751595497, 0.03367641568183899, 0.003062495030462742, -0.04173522815108299, -0.038529351353645325, 0.019661733880639076, 0.013742624782025814, 0.010367630049586296, -0.024764666333794594, -0.0382058210670948, -0.0096029257401824, -0.020323496311903, -0.040323466062545776, 0.005841902457177639, -0.05599990859627724, 0.03717641159892082, -0.020205849781632423, -0.010617629624903202, -0.024558784440159798, 0.010566159151494503, 0.008558809757232666, -0.009397043846547604, -0.04073522984981537, 0.01816173456609249, -0.012676450423896313, -0.07005871087312698, -0.024147020652890205, 0.037147000432014465, 0.02736760303378105, -0.05570579320192337, 0.02454407885670662, 0.06588225066661835, -0.00838969275355339, -0.0032224212773144245, 0.04829404130578041, 0.01024263072758913, -0.03264700621366501, 0.02383819781243801, -0.06488224864006042, -0.03458818048238754, 0.01532350480556488, 0.014441153034567833, -0.05164697393774986, -0.017676442861557007, -0.017441147938370705, -0.01037498377263546, -0.005176462233066559, -0.018529381603002548, -0.010419100522994995, -0.05735284835100174, 0.008669103495776653, 0.0026305103674530983, -0.021558789536356926, -0.00609557842835784, -0.03252935782074928, 0.005183815024793148, -0.0019135999027639627, -0.019588204100728035, 0.0047830804251134396, 0.05544108897447586, 0.03399994596838951, 0.062294017523527145, 0.05238226801156998, 0.00730145862326026, -0.013191155157983303, -0.02007349766790867, 0.042411696165800095, 0.04588228091597557, 0.00598160782828927, -0.029661716893315315, 0.004466904792934656, 0.026588192209601402, 0.010507335886359215, -0.06223519518971443, 0.005794108379632235, -0.020735260099172592, 0.007371311541646719, 0.0071470472030341625, -0.033970534801483154, -0.011441158130764961, 0.043941106647253036, 0.011926451697945595, 0.07335282117128372, -0.005643373355269432, -0.04391169548034668, 0.008095575496554375, -0.0473528653383255, 0.018205853179097176, -0.006904400885105133, 0.05285285785794258, 0.006974253337830305, 0.006463224999606609, -0.0006778481765650213, 0.005485285073518753, -0.04311757907271385, 0.022161729633808136, 0.031147008761763573, -0.01356615498661995, 0.040588170289993286, -0.05691167339682579, 0.06182343140244484, 0.022352905943989754, -0.01594115048646927, -0.010389689356088638, 0.0075735170394182205, -0.020602907985448837, -0.002761024981737137, -0.025676429271697998, 0.00016463668725918978, -0.06770577281713486, 0.016426444053649902, 0.021117612719535828, 0.02944112941622734, -0.014514682814478874, -8.116944809444249e-05, 0.023999961093068123, -0.03264700621366501, -0.035294059664011, 0.01869114674627781, 0.008088222704827785, 0.016205856576561928, -0.031058773398399353, -0.0266911331564188, -0.022102905437350273, -0.03047053888440132, -0.02619113400578499, -0.019779380410909653, 0.0044963164255023, -0.013580860570073128, -0.028823483735322952, -0.0652351900935173, 0.0072720469906926155, 0.0016764679457992315, 0.03020583465695381, 0.007874987088143826, 0.002150731859728694, -0.01654409058392048, 0.0031948478426784277, -0.010992629453539848, -0.03226465359330177, -0.00537866773083806, 0.027485249564051628, -0.0027463191654533148, 0.020044084638357162, -0.056176379323005676, -0.027661720290780067, 0.03364700451493263, 0.03797052800655365, -0.0571763776242733, 0.014044094830751419, -0.0019871292170137167, 0.009419102221727371, 0.07694105058908463, 0.0026029369328171015, 0.016926443204283714, 0.02642642892897129, 0.006422783713787794, -0.030176421627402306, -0.046794041991233826, -0.002318010898306966, 0.009154397062957287, -0.017632324248552322, 0.027058780193328857, -0.05802932009100914, 0.04002934694290161, 0.023220550268888474, 0.0332646518945694, -0.027602896094322205, 0.005345579702407122, -0.0011865790002048016, 0.04608816280961037, 0.00891910307109356, -0.0177499707788229, 0.010963217355310917, 0.030352892354130745, 0.0346175916492939, -0.009823513217270374, 0.025691134855151176, 0.007919104769825935, -0.007860281504690647, -0.0049080802127718925, 0.029588187113404274, -0.01851467601954937, 0.012470568530261517, -0.043176401406526566, -0.06182343140244484, 0.04467639699578285, -0.027147015556693077, 0.029044071212410927, -0.02977936342358589, -0.04247051849961281, -0.051617562770843506, 0.005731608252972364, 0.0030882302671670914, 0.02963230572640896, -0.01755879446864128, 0.03811758756637573, -0.018117617815732956, -0.02763230912387371, -0.0229999627918005, 0.01283086184412241, -0.017352912575006485, 0.0317058302462101, -0.01141174603253603, -0.004536757245659828, -0.017088208347558975, -0.025676429271697998, 0.04485286772251129, 0.0384117029607296, 0.012551450170576572, -0.06323519349098206, -0.012544097378849983, -0.03485288470983505, 0.011845569126307964, -0.03235289081931114, -0.017441147938370705, 0.011691157706081867, -0.009227925911545753, 0.03452935442328453, 0.04614698514342308, -0.01747056096792221, -0.004746316000819206, 0.021808788180351257, -0.003718744032084942, -0.041646990925073624, 0.010308806784451008, 0.017544088885188103, -0.046117573976516724, -0.02977936342358589, 0.010022042319178581, -0.008117633871734142, 0.03644111752510071, -0.009220573119819164, -2.6869785870076157e-05, 0.025529371574521065, 0.023220550268888474, -0.017014678567647934, -0.01661762036383152, -0.00766175240278244, -0.036558765918016434, 0.018911734223365784, 0.03349994495511055, -0.05167638882994652, -0.026411721482872963, -0.033705826848745346, -0.01286762673407793, 0.013176449574530125, 0.016720561310648918, 0.02083820104598999, 0.04029405117034912, -0.004216904751956463, 0.013874977827072144, -0.008382339030504227, -0.031205832958221436, 0.018808793276548386, 0.028088189661502838, -0.036294057965278625, -0.0008175538387149572, -0.03552935644984245, 0.007525722961872816, -0.0006291350000537932, 0.005749990697950125, -0.054294031113386154, 0.013073508627712727, -0.003167274408042431, -0.002770216204226017, -0.006231607403606176, 0.027691131457686424, 0.05091168358922005, 0.033352889120578766, -0.028779365122318268, -0.0025533046573400497, -0.036911703646183014, 0.013911742717027664, -0.03297053650021553, 0.01283086184412241, -0.007139694411307573, 0.059705786406993866, 0.013374978676438332, 0.034647002816200256, 0.03952934965491295, -0.0600881390273571, 0.029735246673226357, -0.03649993985891342, 0.015264681540429592, -0.026147017255425453, -0.0107720410451293, -0.023235255852341652, 0.04899992048740387, 0.0817645713686943, 0.02505878359079361, -0.025279371067881584, -0.017088208347558975, -0.02661760337650776, -0.03367641568183899, 0.013360273092985153, 0.03805876150727272, -0.04432345926761627, 0.030794067308306694, -0.06094107776880264, -0.008654397912323475, 0.04035287722945213, 0.03158818557858467, -0.05088227242231369, -0.0602940209209919, -0.0012224245583638549, 0.028529366478323936, 0.03358818218111992, -0.0002837771025951952, -0.02892642468214035, 0.042323462665081024, 0.024558784440159798, -0.044735223054885864, 0.02797054313123226, -0.025514664128422737, 0.004404404666274786, -0.02427937276661396, 0.005040433257818222, 0.0036709499545395374, -0.031235244125127792, -0.021749965846538544, 0.017323501408100128, 0.07982340455055237, 0.00630513671785593, -0.01097792387008667, -0.03661758825182915, 0.09882336854934692, -0.02945583499968052, 0.036117587238550186, 0.01938232220709324, 0.014330859296023846, 0.0005307896062731743, -0.027852896600961685, 0.008514692075550556, 0.007202194072306156, 0.02419113740324974, -0.0009586381493136287, 0.0133455665782094, -0.008095575496554375, 0.019911732524633408, -0.007823516614735126, -0.04320581257343292, -0.003312494605779648, -0.040264640003442764, -0.026926428079605103, 0.02280878648161888, 0.029808776453137398, -0.014433800242841244, 0.01626467891037464, 0.006514695473015308, 0.027411719784140587, -0.01209556870162487, 0.024323489516973495, 0.030970538035035133, 0.05199991539120674, 0.03220583125948906, 0.014441153034567833, -0.007374987937510014, -0.008860279805958271, 0.020632319152355194, 0.020191144198179245, -0.010183807462453842, 0.042411696165800095, -0.018058793619275093, 0.00761763472110033, -0.04082346335053444, -0.0059191081672906876, 0.002568010473623872, -0.008242634125053883, -0.022088199853897095, 0.007794104982167482, -0.01033086609095335, 0.013764684088528156, 0.01481615286320448, -0.0022702168207615614, 0.022838197648525238, 0.010308806784451008, -0.018147028982639313, -0.011463216505944729, 0.04535286873579025, -0.01342644914984703, -0.0028713189531117678, -0.024558784440159798, 0.016470562666654587, 0.014397035352885723, 0.02376466803252697, -0.049999918788671494, -0.030882302671670914, -0.00641175452619791, 0.027014661580324173, -0.01343380194157362, -0.018823498860001564, -0.03811758756637573, -0.015132328495383263, 0.011852921918034554, 0.022867610678076744, -0.027573484927415848, -0.09205867350101471, -0.010816158726811409, -0.028205836191773415, 0.02160290628671646, -0.003373156301677227, 0.010147042572498322, 0.023220550268888474, -0.03497053310275078, 0.010522041469812393, -0.012029392644762993, -0.04117640480399132, -0.01296321488916874, -0.018117617815732956, 0.010095572099089622, -0.0021819816902279854, 0.0107205705717206, 0.02074996754527092, -0.012036745436489582, -0.03847052529454231, 0.0052132271230220795, -0.009161749854683876, 0.0037260970566421747, 0.040941111743450165, 0.04858815670013428, -0.0293675996363163, -0.024558784440159798, 0.01325733121484518, -0.026882309466600418, -0.0028327160980552435, 0.009198514744639397, -0.014205859042704105, 0.014279388822615147, 0.014220565557479858, 0.009566160850226879, -0.01904408633708954, -0.027808777987957, 0.03429406136274338, -0.025029372423887253, 0.014360271394252777, -0.008647045120596886, -0.00639337208122015, 0.011242629028856754, 0.02755877934396267, -0.022779375314712524, 0.004694845527410507, 0.02495584264397621, -0.03308818116784096, 0.028191130608320236, 0.005485285073518753, -0.0180882066488266, -0.0023455845657736063, 0.0025955841410905123, 0.031970538198947906, -0.039999935775995255, -0.0413234643638134, -0.044058751314878464, -0.0063161663711071014, -0.04941168427467346, 0.02341172657907009, 0.014933799393475056, 0.031382303684949875, -0.04226463660597801, 0.017602913081645966, 0.034147005528211594, -0.029676422476768494, -0.03573523834347725, -0.018044088035821915, -0.03161759674549103, -0.0037371262442320585, -0.013411743566393852, -0.006040431559085846, -0.007205870933830738, -0.017970560118556023, 0.020426437258720398, -0.005183815024793148, -0.00783822312951088, -0.018705852329730988, -0.0154117401689291, 0.009352926164865494, -0.009374984540045261, -0.0007674620137549937, 0.008124986663460732, -0.011352922767400742, -0.010213218629360199, -0.002919113030657172, 0.026485251262784004, -0.014830858446657658, -0.0399705246090889, -0.0457940436899662, -0.014264683239161968, -0.014139682985842228, 0.03805876150727272, 0.000639245321508497, -0.03941170126199722, -4.974716284777969e-05, 0.022367611527442932, 0.007580870296806097, -0.0060330783016979694, 0.012463214807212353, 0.015294092707335949, -0.011235276237130165, -0.01730879582464695, -0.006882342044264078, -0.01886761747300625, -0.009889690205454826, 0.0053161680698394775, 0.0013602919643744826, 0.013485272414982319, 0.009463219903409481, 0.005419109016656876, 0.008573515340685844, 0.0139043889939785, -0.04294110834598541, 0.0392940528690815, 0.018044088035821915, 0.004183816723525524, -0.041470520198345184, 0.026808779686689377, -0.010544100776314735, -0.0012325347634032369, -0.0029283040203154087, -0.022073494270443916, -0.022338198497891426, -0.021941140294075012, -0.02997053973376751, 0.02883818931877613, -0.013316155411303043, 0.0292646586894989, -0.0018327176803722978, 0.009404396638274193, 0.002520216628909111, 0.019867615774273872, -0.01626467891037464, -0.026279369369149208, 0.004400728270411491, -0.00890439748764038, 0.01549997553229332, -0.0011360276257619262, 0.03323524072766304, 0.023132314905524254, 0.0683528333902359, 0.009191161952912807, -0.021029377356171608, 0.007069841492921114, -0.006106607615947723, 0.024749960750341415, -0.013749977573752403, -0.023897020146250725, -0.03658817708492279, 0.010191160254180431, -0.011242629028856754, -0.014647034928202629, 0.015205858275294304, -0.015051445923745632, 0.022426433861255646, -0.06088225543498993, -0.020044084638357162, 0.002738966140896082, -0.009389691054821014, 0.05311756208539009, -0.005400726571679115, 0.004235287196934223, -0.009977925568819046, -0.009316161274909973, -0.004591904580593109, 0.0005197601858526468, -0.014448505826294422, -0.010544100776314735, 0.017514677718281746, 0.016573503613471985, 0.06423518806695938, -0.02979406900703907, -0.11423511058092117, -0.005363962147384882, 0.029647011309862137, 0.004779404029250145, 0.0014117624377831817, -0.029499951750040054, -0.0330587700009346, -0.016147032380104065, 0.03176465630531311, 0.05520579218864441, -0.004970580339431763, -0.035264648497104645, -0.04082346335053444, -0.022691139951348305, 0.021970553323626518, -0.01277939137071371, 0.024308783933520317, 0.041029345244169235, 0.0070551359094679356, 0.023235255852341652, -0.04332346096634865, -0.053617559373378754, 0.012205862440168858, -0.037676408886909485, 0.004724257159978151, 0.005025727208703756, -0.020132320001721382, -0.045999925583601, 0.007933810353279114, 0.004599257372319698, -0.02152937650680542, -0.0010248145554214716, 0.020161733031272888, 0.013463214039802551, -0.02005879208445549, 0.01626467891037464, 0.01459556445479393, -0.026235252618789673, -0.0007835465366952121, -0.009455867111682892, 0.017088208347558975, 0.013323508203029633, -0.015485269017517567, -0.03435288742184639, 0.016470562666654587, -0.02317643351852894, 9.300306555815041e-05, 0.016926443204283714, 0.024867607280611992, -0.01460291724652052, 0.016058797016739845, -0.0007509178831242025, 0.01523526944220066, 0.00972792599350214, -0.008080868981778622, 0.0314999483525753, -0.016720561310648918, -0.010455865412950516, -0.02935289405286312, -0.02601466327905655, -0.009227925911545753, 0.012073510326445103, 0.0025955841410905123, -0.019852908328175545, 0.001376835978589952, -0.0003311116015538573, -0.01670585572719574, -0.018632322549819946, -0.0020808789413422346, 0.014316153712570667, 0.00669851852580905, -0.006132342852652073, -0.006389695685356855, 0.007227929774671793, 0.03161759674549103, 0.059882257133722305, -0.007867634296417236, 0.018367618322372437, 0.01140439324080944, -0.012757332064211369, 0.0018244455568492413, -0.00016819825395941734, -0.016749972477555275, 0.005330873653292656, -0.002351099159568548, -0.020794084295630455, -0.010139689780771732, -0.0011525716399773955, -0.011889686807990074, -0.016499973833560944, -0.02376466803252697, -0.03558817878365517, -0.002599260536953807, -0.009367631748318672, -0.012647038325667381, 0.01282350905239582, 0.043264634907245636, -0.0056396969594061375, -0.1089998260140419, -0.015823503956198692, 0.025117605924606323, 0.010786747559905052, 0.011992627754807472, -0.03299994766712189, 0.02170584723353386, 0.02635289914906025, 0.008985280059278011, -0.049999918788671494, 0.04108816757798195, -0.0025238930247724056, 0.004540433641523123, 0.0053602852858603, 0.013499977998435497, -0.057999905198812485, 0.0165293850004673, -0.010323512367904186, 0.045264631509780884, 0.010507335886359215, -0.017764678224921227, 0.021455848589539528, 0.018999969586730003, 0.04302934184670448, -0.013169096782803535, -0.01403674203902483, 0.027235250920057297, 0.006036755163222551, 0.023441139608621597, 0.02480878308415413, 4.655898010241799e-05, -0.020044084638357162, -0.000526653544511646, 0.02419113740324974, -0.046794041991233826, 0.00038694791146554053, -0.005562491249293089, 0.008963220752775669, -0.022794080898165703, 0.010213218629360199, 0.010617629624903202, -0.034058768302202225, 0.055499911308288574, -0.0021783052943646908, 0.040941111743450165, -0.028544072061777115, 0.010213218629360199, -0.018794087693095207, 0.021941140294075012, 0.006466901395469904, 0.03447053208947182, -0.01704408973455429, -0.0002605694462545216, -0.015808798372745514, -0.00606984319165349, 0.020455850288271904, 0.011933804489672184, 0.01894114539027214, 0.0028033042326569557, 0.021852906793355942, -0.024941137060523033, 0.044470515102148056, 0.02119114249944687, -0.022941140457987785, -0.014838211238384247, -0.0019632321782410145, -0.02023526094853878, 0.008338222280144691, -0.031735241413116455, -0.02902936562895775, -0.05720578879117966, -0.0035827148240059614, 0.01807350106537342, 0.03614700213074684, -0.004117640666663647, -0.0032077154610306025, 0.04244110733270645, 0.02661760337650776, -0.04041169956326485, 0.0030955832917243242, 0.06823518127202988, -0.0442352220416069, 0.0039007291197776794, 0.0007532156887464225, -0.020632319152355194, 0.03494112193584442, 0.028867600485682487, -0.022073494270443916, -0.003816170385107398, 0.014830858446657658, 0.034911707043647766, 0.0006305137067101896, 0.029661716893315315, -0.027867602184414864, 0.00445219874382019, -0.02091173082590103, -0.012904390692710876, 0.02211761102080345, 0.020102908834815025, -0.024176431819796562, 0.019691145047545433, 0.029764657840132713, -0.02480878308415413, 0.002062496729195118, 0.012044098228216171, 0.008536751382052898, -0.0056396969594061375, -0.0020073496270924807, 0.030676420778036118, 0.004397051874548197, -0.0005597417475655675, 0.0244558434933424, -0.0075735170394182205, 0.031470537185668945, 0.015294092707335949, 0.046470511704683304, 0.0270293690264225, 0.027441132813692093, 0.0005404403200373054, 0.02841171808540821, 0.0068455771543085575, -0.0043271989561617374, -0.030617598444223404, 0.0267940741032362, -0.01141174603253603, -0.024941137060523033, 0.019073499366641045, 0.028014661744236946, 0.0035606559831649065, -0.014374976977705956, 0.026823487132787704, -0.0014604756142944098, -0.004194846376776695, 0.0029135982040315866, -0.0025422752369195223, 0.013933801092207432, 0.013639683835208416, -0.0027518337592482567, -0.05949990451335907, 0.022882316261529922, 0.011382334865629673, -0.007249988149851561, -0.006764695048332214, 0.013676448725163937, -0.008095575496554375, 0.012882332317531109, 0.0027720544021576643, -0.015220563858747482, -0.013132331892848015, 0.010227925144135952, 0.04144110903143883, -0.021558789536356926, -0.011897039599716663, 0.02488231286406517, -0.007602929137647152, 0.027426427230238914, 0.015352916903793812, -0.019735261797904968, 0.008110281080007553, 0.022176435217261314, 0.027676425874233246, 0.047058746218681335, -0.013860272243618965, -0.014095565304160118, 0.018397029489278793, -0.02470584213733673, -0.024852901697158813, -0.011419098824262619, -0.0026397015899419785, 0.005841902457177639, -0.026661721989512444, -0.04311757907271385, 0.03644111752510071, 0.021749965846538544, 0.00947792548686266, 0.05185285955667496, 0.01842644065618515, -0.0021397024393081665, 0.015264681540429592, 0.045411691069602966, 0.010948511771857738, 0.011757333762943745, -0.013720566406846046, -0.014698505401611328, 0.02755877934396267, -0.013926448300480843, -0.014147035777568817, 0.018044088035821915, -0.0063676368445158005, 0.028191130608320236, 0.0059080785140395164, 0.014235271140933037, -0.0007895207963883877, 0.047470513731241226, 0.013536742888391018, -0.025970546528697014, 0.014889681711792946, 0.04717639461159706, -0.014669094234704971, -0.05244109034538269, -0.01080880593508482, 0.06035284325480461, 0.004033081699162722, 0.009213220328092575, -0.03661758825182915, 0.03247053548693657, -0.0038933760952204466, -0.036823470145463943, 0.010058807209134102, 0.02876465953886509, -0.005330873653292656, -0.0008561566937714815, -0.03467641398310661, 0.023955844342708588, 0.004268375691026449, -0.025441136211156845, 0.014941152185201645, -0.007386017590761185, -0.034823473542928696, -0.016823502257466316, -0.03161759674549103, -0.02782348543405533, -0.011477923020720482, -0.0064705777913331985, 0.0007826274377293885, -0.004988962784409523, 0.02110290713608265, -0.006819841917604208, -0.008117633871734142, 0.009022044017910957, 0.005749990697950125, 0.018485264852643013, -0.014352917671203613, -0.01080880593508482, -0.018323499709367752, -0.013455860316753387, 0.010014689527451992, 0.0005376829649321735, -0.01037498377263546, -0.0015468725468963385, 0.035941120237112045, 0.016735266894102097, 0.013044096529483795, 0.004518375266343355, 0.026411721482872963, -0.026911720633506775, 0.01782350055873394, 0.04505874961614609, -0.039235230535268784, 0.005363962147384882, -0.008367633447051048, -0.00973527878522873, 0.029926422983407974, 0.024161726236343384, 0.0031562449876219034, -0.024661725386977196, 0.0009567999513819814, 0.025352900847792625, 0.03399994596838951, 0.013698507100343704, -0.014654388651251793, 0.012345568276941776, -0.012080863118171692, -0.007477929349988699, 0.015426445752382278, -0.029999950900673866, 0.00727572338655591, 0.01807350106537342, 0.012360273860394955, 0.018470559269189835, -0.037676408886909485, 0.00413602264598012, -0.015352916903793812, 0.025367606431245804, 0.0058676376938819885, -0.00417278753593564, 0.008852927014231682, -0.030176421627402306, 0.004808815661817789, 0.010786747559905052, -0.0014770196285098791, -0.0090441033244133, -0.042735226452350616, -0.0090441033244133, 0.0007605686550959945, -0.010360277257859707, 0.02489701844751835, -0.020470555871725082, 0.03532347083091736, -0.003205877263098955, 0.04682345315814018, 0.03291171044111252, -0.0018538573058322072, 0.01037498377263546, -0.022161729633808136, -0.004746316000819206, 0.007132341619580984, 0.009382338263094425, 0.020558791235089302, 0.0013235273072496057, 0.029058776795864105, 0.016720561310648918, 0.002534922445192933, 0.01817644201219082, 0.017544088885188103, 0.01644114963710308, 0.0006957709556445479, -0.04014699533581734, -0.018999969586730003, -0.007341899909079075, -0.012764685787260532, 0.00036075309617444873, -0.0038933760952204466, -0.013757330365478992, 0.02048526145517826, -0.01704408973455429, -0.0166323259472847, -0.02549995854496956, 0.0013933801092207432, -0.01089704129844904, 0.01347056683152914, 0.025088194757699966, 0.008102928288280964, 0.03367641568183899, -0.02392643131315708, -0.007801458239555359, 0.007433811668306589, -0.0037536704912781715, -0.0006043188623152673, 0.006577195134013891, -0.009816160425543785, 0.02033820189535618, -0.010477924719452858, -0.00822792761027813, -0.027838191017508507, -0.002253672806546092, -0.036823470145463943, 0.005025727208703756, 0.0036562441382557154, -0.012308803386986256, 0.026073487475514412, -0.008382339030504227, 0.03588229417800903, -0.0016645194264128804, 0.014147035777568817, 0.010727924294769764, 0.01231615711003542, 0.0023602903820574284, 0.010727924294769764, -0.01807350106537342, 0.08494103699922562, -0.0177499707788229, -0.017529383301734924, 0.004525728058069944, -0.00551102077588439, 0.026235252618789673, -0.012985273264348507, -0.012073510326445103, -0.03588229417800903, 0.009419102221727371, 0.014426447451114655, 0.028529366478323936, -0.011330864392220974, -0.0022555110044777393, -0.0011498143430799246, -0.013669095933437347, -0.020441142842173576, 0.03967640548944473, 0.029382305219769478, 0.03573523834347725, 0.018367618322372437, 0.02091173082590103, 0.004893374629318714, -0.030970538035035133, 0.01011763047426939, 0.0020202172454446554, 0.00010914504673564807, 0.0022794080432504416, -0.010558806359767914, 0.03985287621617317, 0.00886763259768486, -0.027955837547779083, -0.04167640209197998, 0.017352912575006485, -0.030852891504764557, 0.01089704129844904, -0.01780879497528076, 0.03273523971438408, -5.224601045483723e-05, -0.0022738934494554996, 0.020558791235089302, 0.005194844678044319, -0.013360273092985153, 0.02497054822742939, -0.01644114963710308, 0.010558806359767914, 0.00030859324033372104, 0.014911741018295288, 0.00038373100687749684, 0.020029379054903984, 0.01269850879907608, -0.028647013008594513, 0.024661725386977196, -0.009867630898952484, 0.00019841419998556376, -0.0019264675211161375, -0.0005363042582757771, 0.05064697563648224, 0.006077195983380079, 0.011911745183169842, -0.039735231548547745, 0.026220545172691345, -0.03255877271294594, -0.012257332913577557, 0.01594115048646927, -0.0466763973236084, 0.018823498860001564, 0.022882316261529922, -0.022264670580625534, 0.036029353737831116, -0.030382303521037102, 0.0016930119600147009, -0.013095567002892494, -0.01011763047426939, 0.0036856557708233595, 0.02489701844751835, -0.026470545679330826, 0.009382338263094425, 0.0035018327180296183, 0.04461757466197014, -0.0018722396343946457, 0.0056066084653139114, -0.018970558419823647, -0.008286751806735992, -0.0037683763075619936, 0.028117602691054344, 0.030294068157672882, -0.008698515594005585, -0.0504705086350441, 0.029235247522592545, -0.019514674320816994, 0.01730879582464695, 0.047911688685417175, 0.03341171145439148, -0.0214411411434412, -0.020161733031272888, -0.007029400672763586, 0.020779378712177277, 0.0457940436899662, 0.008617633022367954, -0.016411738470196724, -0.01335291936993599, 0.017367620021104813, 0.011102923192083836, -0.02049996703863144, 0.02048526145517826, -0.044999927282333374, -0.010382336564362049, 0.009433808736503124, 0.0217793770134449, 0.003242641920223832, -0.0005367638659663498, 0.028794070705771446, 0.03358818218111992, 0.005238962359726429, 0.025705840438604355, 0.0023805107921361923, 0.01988232135772705, 0.008330868557095528, -0.02126467227935791, 0.030382303521037102, 0.016926443204283714, 0.018132323399186134, -0.022926433011889458, -0.01929408684372902, 0.005959549453109503, 0.008654397912323475, -0.005959549453109503, 0.005955872591584921, -0.008419103920459747, -0.013058802112936974, 0.005363962147384882, 0.018838204443454742, 0.011852921918034554, 7.490796997444704e-05, 0.009345573373138905, -0.009764689952135086, -0.017632324248552322, -0.01851467601954937, 0.00224815821275115, -0.002628672169521451, 0.009749984368681908, -0.015022034756839275, 0.012808802537620068, -0.02523525431752205, -0.03349994495511055, 0.009654396213591099, -0.015051445923745632, 0.03426465019583702, 0.018191147595643997, -0.008007340133190155, 0.03073524497449398, 0.002216908149421215, 0.022455846890807152, -0.00903675053268671, -0.0010597408981993794, 0.013499977998435497, -0.010632336139678955, 0.02007349766790867, 0.007246311753988266, 0.010051454417407513, -0.02282349206507206, -0.011485275812447071, 0.005363962147384882, 0.036294057965278625, -0.0279117189347744, -0.020867614075541496, -0.00538602052256465, 0.009904395788908005, -0.001494482858106494, -0.0069779297336936, 0.004411757458001375, 0.013492625206708908, 0.004143375903367996, 0.0010257336543872952, -0.018102912232279778, -0.022264670580625534, -0.0036047736648470163, -0.013220567256212234, 0.011066158302128315, -0.022691139951348305, -0.018897028639912605, 0.03814699873328209, -0.00017394273891113698, -0.002180143492296338, 0.021455848589539528, 0.024411724880337715, 0.018029382452368736, -0.008639692328870296, -0.016764678061008453, 0.011749980971217155, -0.020176438614726067, 0.015588209964334965, 0.011352922767400742, 0.02894113026559353, 0.021852906793355942, 0.004323522560298443, 0.008191163651645184, 0.027749955654144287, 0.020455850288271904, 0.006327195558696985, 0.009176455438137054, 0.004117640666663647, 0.012492626905441284, -0.006823518313467503, -0.005518373567610979, -0.007544105406850576, 0.008757338859140873, 0.0009094654233194888, 0.002483451971784234, -0.01286762673407793, 0.0017610265640541911, 0.01549997553229332, 0.027602896094322205, -0.0008736199233680964, 0.0052095502614974976, 0.0033970533404499292, 0.030323481187224388, -0.02317643351852894, 0.0036617587320506573, 0.014257330447435379, 0.0007150723831728101, 0.007999987341463566, 0.018661735579371452, -0.0014126815367490053, 0.01549997553229332, 0.02505878359079361, 0.002650731010362506, -0.0025827165227383375, 0.0006231607403606176, 0.004158081486821175, -0.02626466378569603, 0.008786750957369804, -0.0020422760862857103, 0.021455848589539528, -0.011551451869308949, -0.03332347422838211, 0.00014556501992046833, -0.007816163823008537, 0.002443010685965419, -0.01904408633708954, 0.01911761611700058, 0.021058790385723114, 0.01594115048646927, -0.012529391795396805, 0.0831175148487091, 0.02438231371343136, 0.00508087407797575, -0.037058763206005096, 0.0009002742590382695, -0.010661747306585312, 0.021397024393081665, -0.017367620021104813, -0.03747052699327469, 0.036382295191287994, -0.05099991708993912, -0.005198521073907614, -7.78950925450772e-05, -0.011654392816126347, 0.03232347592711449, -0.012029392644762993, -0.03561758995056152, 0.016249973326921463, 0.01209556870162487, -0.030294068157672882, 0.029588187113404274, -0.03547053039073944, 0.0014246300561353564, -0.002990803914144635, -0.020176438614726067, -0.0029595540836453438, 0.011522040702402592, 0.005529402755200863, -0.011124982498586178, 0.002702201483771205, 0.019411733373999596, 0.007231606170535088, 0.005610284861177206, 0.01877938210964203, -0.00774998776614666, 0.03952934965491295, -0.012536744587123394, -0.01219115685671568, -0.000997241004370153, 0.019867615774273872, 0.012249980121850967, -0.026323487982153893, -0.04079405218362808, 0.007238958962261677, 0.00032169066253118217, -0.027808777987957, 0.023720549419522285, 0.013147037476301193, -0.020102908834815025, -0.004647051449865103, 0.018661735579371452, 0.01789703033864498, -0.044823456555604935, -0.008014692924916744, 0.027323486283421516, -0.03023524582386017, -0.000989888096228242, -0.0011498143430799246, 0.029117600992321968, 0.03761758655309677, 0.024749960750341415, -0.014051447622478008, 0.04338228330016136, -0.007720575667917728, 0.02582348696887493, 0.008551456965506077, 0.015441151335835457, -0.0009067081264220178, 0.019573498517274857, 0.02549995854496956, 0.02610289864242077, -0.025764664635062218, 0.028470542281866074, -0.029411718249320984, 0.010367630049586296, -0.010367630049586296, -0.019573498517274857, 0.020558791235089302, -0.016764678061008453, 0.001819850062020123, -0.0063161663711071014, -0.019235262647271156, 0.048088159412145615, 0.022161729633808136, 0.006922782864421606, 0.012301450595259666, -0.005202197469770908, 0.019838202744722366, 0.027279367670416832, -0.018044088035821915, 0.008749986067414284, -0.011897039599716663, 0.018617616966366768, 0.016764678061008453, -0.022779375314712524, -0.023720549419522285, -0.0035404355730861425, -0.009176455438137054, -0.0008014693157747388, -0.029147012159228325, 0.019176440313458443, 0.019661733880639076, 0.027235250920057297, 0.01729409024119377, -0.0019283057190477848, 0.0392940528690815, 0.04144110903143883, 0.0001386716467095539, -0.008257339708507061, 0.0002053075731964782, 0.028647013008594513, 0.014426447451114655, -0.004499992821365595, -0.02745583839714527, 0.002387863816693425, -0.037764646112918854, -0.013647036626935005, 0.0037757293321192265, 0.022632315754890442, -0.014897034503519535, 0.007080871146172285, -0.01218380406498909, 0.006099254824221134, -0.012507332488894463, -0.04485286772251129, 0.01266174390912056, 0.03355877101421356, 0.009661749005317688, 0.027588190510869026, -0.03167641907930374, -0.04638227820396423, -0.032235242426395416, -0.011235276237130165, 0.00908822100609541, -0.006389695685356855, -0.0031635977793484926, -0.008191163651645184, 0.008933809585869312, -0.01947055757045746, 0.0016544091049581766, 0.012301450595259666, -0.009235279634594917, 0.019852908328175545, -0.009080867283046246]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
", Y., Jones, A., Ndousse, K., Askell, A., Chen, A., DasSarma, N., Drain, D., Fort, S., Ganguli, D.,
Henighan, T., et al. (2022). Training a helpful and harmless assistant with reinforcement learning from
human feedback. arXiv preprint arXiv:2204.05862 .
Bansal, H., Dang, J., and Grover, A. (2023). Peering through preferences: Unraveling feedback acquisition
for aligning large language models. arXiv preprint arXiv:2308.15812 .
Beirami, A., Agarwal, A., Berant, J., D’Amour, A., Eisenstein, J., Nagpal, C., and Suresh, A. T. (2024).
Theoretical guarantees on the best-of-n alignment policy. arXiv preprint arXiv:2401.01879 .
Bengs, V., Busa-Fekete, R., El Mesaoudi-Paul, A., and H¨ ullermeier, E. (2021). Preference-based online
learning with dueling bandits: A survey. The Journal of Machine Learning Research , 22(1):278–385.
Bhardwaj, M., Xie, T., Boots, B., Jiang, N., and Cheng, C.-A. (2023). Adversarial model for offline rein-
forcement learning. arXiv preprint arXiv:2302.11048 .
Bradley, R. A. and Terry, M. E. (1952). Rank analysis of incomplete block designs: I. the method of paired
comparisons. Biometrika , 39(3/4):324–345.
Burns, C., Izmailov, P., Kirchner, J. H., Baker, B., Gao, L., Aschenbrenner, L., Chen, Y., Ecoffet, A.,
Joglekar, M., Leike, J., et al. (2023). Weak-to-strong generalization: Eliciting strong capabilities with
weak supervision. arXiv preprint arXiv:2312.09390 .
Cai, Q., Yang, Z., Jin, C., and Wang, Z. (2020). Provably efficient exploration in policy optimization. In
International Conference on Machine Learning , pages 1283–1294. PMLR.
Casper, S., Davies, X., Shi, C., Gilbert, T. K., Scheurer, J., Rando, J., Freedman, R., Korbak, T., Lindner,
D., Freire, P., et al. (2023). Open problems and fundamental limitations of reinforcement learning from
human feedback. arXiv preprint arXiv:2307.15217 .
Chen, G. and Teboulle, M. (1993). Convergence analysis of a proximal-like minimization algorithm using
bregman functions. SIAM Journal on Optimization , 3(3):538–543.
Chen, H., He, G., Su, H., and Zhu, J. (2024). Noise contrastive alignment of language models with explicit
rewards. arXiv preprint arXiv:2402.05369 .
26
Chen, X., Zhong, H., Yang, Z., Wang, Z., and Wang, L. (2022). Human-in-the-loop: Provably efficient
preference-based reinforcement learning with general function approximation. In International Conference
on Machine Learning , pages 3773–3793. PMLR.
Choshen, L., Fox, L., Aizenbud, Z., and Abend, O. (2019). On the weaknesses of reinforcement learning for
neural machine translation. arXiv preprint arXiv:1907.01752 .
Christiano, P. F., Leike, J., Brown, T., Martic, M., Legg, S., and Amodei, D. (2017). Deep reinforcement
learning from human preferences. Advances in neural information processing systems , 30.
Coste, T., Anwar, U., Kirk, R., and Krueger, D. (2023). Reward model ensembles help mitigate overopti-
mization. arXiv preprint arXiv:2310.02743 .
Cui, G., Yuan, L., Ding, N., Yao, G., Zhu, W., Ni, Y., Xie, G., Liu, Z., and Sun, M. (2023). Ultrafeedback:
Boosting language models with high-quality feedback.
Dani","[-0.02084243856370449, 0.012612508609890938, 0.04783056303858757, -0.0011578258126974106, 0.013210705481469631, 0.008752564899623394, 0.0024714975152164698, 0.035992562770843506, -0.02182473987340927, 0.038914281874895096, 0.015011592768132687, -0.03994695842266083, 0.0026415113825351, 0.005393216852098703, 0.021635835990309715, -0.04024920240044594, 0.03307083994150162, -0.0487876757979393, 0.04045070335268974, 0.032693032175302505, -0.017089540138840675, -0.02045203559100628, 0.011183133348822594, 0.03130773454904556, 0.026925155892968178, -0.027051091194152832, 0.018399275839328766, 0.048963986337184906, -0.03125736117362976, -0.03866240754723549, 0.04853580519556999, -0.02833564206957817, -0.03684892877936363, -0.008362162858247757, -0.04692382365465164, 0.029746126383543015, 0.025816917419433594, -0.00373715627938509, -0.014369318261742592, 0.0036678912583738565, -0.020313506945967674, -0.06105386093258858, 0.013172924518585205, 0.054202932864427567, -0.016321329399943352, 0.014646378345787525, 0.010918666608631611, -0.011888375505805016, -0.0035545488353818655, 0.03992177173495293, -0.05274207517504692, 0.02868826314806938, -0.035639937967061996, -0.03977064788341522, -0.012562134303152561, 0.007071316707879305, 0.013966322876513004, 0.02376415766775608, 0.03551400452852249, -0.010194534435868263, -0.01249916572123766, -0.04040032625198364, -0.0018071841914206743, 0.04778018966317177, -0.027907459065318108, -0.06528531759977341, -0.08860869705677032, 0.011309069581329823, 0.017139915376901627, 0.0292423814535141, 0.00045927352039143443, -0.003340457333251834, 0.03027505800127983, -0.014180414378643036, -0.010320469737052917, -0.00041834425064735115, 0.03513619676232338, 0.0813547745347023, -0.016749512404203415, -0.01688804291188717, -0.01978457346558571, -0.0010122120147570968, 0.01087458897382021, -0.0553615465760231, -0.027076279744505882, -0.03697486221790314, -0.024141965433955193, 0.0015742023242637515, -0.008148071356117725, -0.001452201628126204, 0.002633640542626381, -0.024973144754767418, -0.04097963497042656, 0.0013176073553040624, 0.03480876237154007, 0.0260184146463871, -0.004152745474129915, 0.006951677147299051, 0.05269169807434082, 0.015213090926408768, -0.02931794337928295, -0.03024987131357193, 0.002504555741325021, -0.04125669226050377, 0.031030675396323204, -0.007707294542342424, -0.006970567628741264, -0.02434346452355385, -0.011945047415792942, -0.0040173642337322235, -0.09248753637075424, 0.010377141647040844, -0.04911511018872261, -0.004155893810093403, 0.0033373087644577026, -0.06528531759977341, -0.08211039006710052, -0.01414263341575861, -0.01978457346558571, -0.0033656444866210222, -0.007946573197841644, 0.01759328506886959, 0.0488632395863533, 0.012266184203326702, 0.005109860561788082, -0.02695034258067608, 0.04087888449430466, -0.05989524722099304, -0.02531317248940468, -0.0553615465760231, -0.0019976627081632614, 0.02241664007306099, 0.010263798758387566, -0.031005488708615303, -0.06745141744613647, 0.015087154693901539, 0.006517197471112013, -0.008922578766942024, -0.039543960243463516, -0.05264132469892502, 0.01726585067808628, -0.004089777357876301, -0.06327033787965775, -0.008179554715752602, -0.08100215345621109, 0.0033971285447478294, -0.002701331162825227, -0.01918007992208004, 0.00019795593107119203, -0.0015962411416694522, 0.017001384869217873, 0.007014645263552666, -0.027756335213780403, 0.03030024655163288, -0.040148455649614334, -0.029141632840037346, -0.05034928768873215, 0.051533084362745285, 0.01848743110895157, -0.08906207233667374, 0.058031391352415085, 0.04614301770925522, -0.00422515906393528, -0.009514478966593742, 0.054807428270578384, -0.0044864765368402, -0.012921052053570747, 0.03342346474528313, -0.03438057750463486, -0.02793264575302601, 0.03150923177599907, 0.03992177173495293, -0.031735919415950775, -0.00991747435182333, -0.0005674998974427581, -0.022038832306861877, -0.007789153140038252, -0.03443095088005066, -0.024532368406653404, -0.04324648529291153, 0.04591633379459381, -0.005405810661613941, -0.00714687816798687, 0.02507389336824417, -0.027126653119921684, 0.007915088906884193, -0.013412203639745712, 0.001955159241333604, 0.002370748668909073, 0.041785623878240585, 0.010975338518619537, 0.009457807056605816, 0.07082650810480118, 0.003715117461979389, -0.020011259242892265, -0.04103000834584236, 0.04737719148397446, -0.0028225446585565805, -0.026194725185632706, -0.029091257601976395, -0.005371178034693003, 0.041433002799749374, -0.026547348126769066, -0.045664459466934204, 0.03342346474528313, -0.03196260333061218, -0.004165339283645153, 0.01724066399037838, -0.057678770273923874, -0.014646378345787525, 0.0308795515447855, 0.023210039362311363, 0.051583461463451385, 0.0031263658311218023, -0.04715050756931305, -0.003853647271171212, -0.03455688804388046, -0.007839526981115341, -0.01089347992092371, 0.042138248682022095, -0.005342842545360327, -0.005893813446164131, 0.03188704326748848, 0.01853780634701252, -0.015036780387163162, 0.00959633756428957, 0.028814198449254036, -0.011926156468689442, 0.04639488831162453, -0.0391409657895565, 0.07133025676012039, -0.012278777547180653, -0.015804991126060486, -0.015477556735277176, 0.010654200799763203, -0.01232915185391903, 0.007858417928218842, -0.01041492260992527, 0.04380060359835625, -0.034682825207710266, 2.7450152629171498e-05, 0.008374756202101707, 0.01724066399037838, 0.008393646217882633, 0.007165768649429083, 0.06009674817323685, -0.04191156104207039, -0.025968041270971298, 0.005597863346338272, 0.019280830398201942, 0.025779137387871742, -0.0003539987374097109, 0.008336975239217281, -0.014331537298858166, -0.008532176725566387, -0.03229003772139549, -0.010408625937998295, 0.020288318395614624, -0.02347450517117977, -0.02964537777006626, -0.04513552784919739, 0.052490200847387314, 0.002403806895017624, 0.016132425516843796, 0.006762772798538208, 0.008991843089461327, -0.03027505800127983, 0.02179955318570137, 0.0010877738241106272, -0.02956981584429741, 0.013752231374382973, 0.014734533615410328, -0.018726710230112076, 0.053850311785936356, -0.04357391968369484, -0.041508566588163376, 0.03415389358997345, 0.05692315474152565, -0.04717569425702095, -0.008809235878288746, -0.013487765565514565, 0.041785623878240585, 0.06563793867826462, 0.013827793300151825, 0.006211802363395691, 0.016447264701128006, -0.02411677874624729, -0.049568481743335724, -0.05390068516135216, 0.0015419311821460724, -0.019306017085909843, -0.032038163393735886, 0.019406765699386597, -0.057729147374629974, 0.04621857777237892, 0.001855984446592629, 0.05455555394291878, -0.014747126959264278, 0.009715976193547249, -0.018386682495474815, 0.0244190264493227, 0.005950484424829483, -0.025426514446735382, 0.021988457068800926, 0.023990843445062637, 0.03289452940225601, -0.03926690295338631, 0.0227692611515522, 0.013273674063384533, -0.013575920835137367, 0.014910844154655933, 0.022630732506513596, -0.03281896933913231, 0.020326100289821625, -0.04198712483048439, -0.054505180567502975, 0.04327167198061943, -0.010950150899589062, 0.011378333903849125, -0.020590566098690033, -0.055109672248363495, -0.005500262603163719, -0.0012853362131863832, 0.0006651004659943283, 0.023524878546595573, 0.015691649168729782, 0.028184518218040466, -0.005925297271460295, -0.005273577757179737, -0.029771313071250916, 0.0066368370316922665, 0.008192148990929127, 0.01089347992092371, -0.011617613025009632, 0.011605019681155682, -0.02118246629834175, -0.04337242245674133, 0.04380060359835625, 0.020590566098690033, 0.004118113312870264, -0.07067538797855377, -0.009010734036564827, -0.04296942427754402, -0.0064070033840835094, -0.035312507301568985, -0.013512952253222466, -0.007902495563030243, 0.029091257601976395, 0.03642074391245842, 0.05065153166651726, -0.015527931042015553, -0.020011259242892265, 0.015074561350047588, 0.03541325405240059, -0.027756335213780403, 0.028814198449254036, -0.03375089541077614, 0.005922148935496807, -0.0030161715112626553, -0.006435338873416185, 0.02212698757648468, 0.007260221056640148, 0.019734200090169907, -0.0015167439123615623, 0.018361495807766914, 0.015817584469914436, -0.01253065001219511, 0.006041788496077061, 0.018285933881998062, -0.03405314311385155, 0.0073798601515591145, 0.030501743778586388, -0.07928942143917084, 0.009124076925218105, -0.04586595669388771, 0.002589562674984336, -0.001221581012941897, 0.014835282228887081, 0.022555170580744743, 0.006743882782757282, -0.015842771157622337, 0.0004899704363197088, 0.00479501998052001, -0.03226485103368759, 0.010987931862473488, 0.030955113470554352, -0.03606812283396721, -0.015767209231853485, -0.010528264567255974, -0.017089540138840675, -0.012713257223367691, -0.0041307066567242146, -0.05631865933537483, 0.0042283073998987675, 0.03027505800127983, 0.03712598606944084, -0.009464103728532791, 0.01594352163374424, 0.038183849304914474, 0.028511952608823776, -0.028789011761546135, -0.008525880053639412, -0.031761106103658676, 0.02401603013277054, -0.024204934015870094, 0.018462244421243668, -0.005207461304962635, 0.08664409071207047, 0.011479083448648453, 0.030023185536265373, 0.06447932869195938, -0.039543960243463516, 0.0028870869427919388, -0.011120164766907692, 0.008261413313448429, -0.04805724695324898, -0.0034160190261900425, 0.00014718790771439672, 0.06261546909809113, 0.05788027122616768, -0.0009264180553145707, 0.011453895829617977, 0.0022605545818805695, -0.03178629279136658, -0.028889760375022888, 0.020074227824807167, 0.0027501313015818596, -0.029066070914268494, 0.028083769604563713, -0.05294357240200043, -0.04710013419389725, 0.02732815220952034, 0.03730229660868645, -0.03516138345003128, -0.0456392727792263, -0.038511283695697784, 0.030778802931308746, 0.0058906651102006435, -0.00365844601765275, -0.04155893996357918, 0.02017497643828392, -0.0046470449306070805, -0.057729147374629974, 0.026169538497924805, 0.011995421722531319, 0.010654200799763203, -0.02377675101161003, 0.03319677710533142, 0.0036017748061567545, -0.023008540272712708, -0.014419692568480968, 0.018474837765097618, 0.058434389531612396, 0.014596004039049149, 0.0019614561460912228, -0.008796642534434795, 0.0749572142958641, 0.0032397082541137934, 0.027882270514965057, 0.02504870668053627, 0.028814198449254036, -0.002939035650342703, -0.02118246629834175, -0.012757335789501667, 0.014772314578294754, 0.04009808227419853, 0.013575920835137367, 0.025590231642127037, 0.0006119711324572563, 0.001042908988893032, -0.004640748258680105, -0.016699137166142464, -0.011661690659821033, -0.03934246301651001, -0.04616820439696312, -0.007896198891103268, 0.014117445796728134, -0.01156094204634428, -0.03944321349263191, -0.004499070346355438, -0.004307017661631107, -0.027554836124181747, -0.002504555741325021, 0.019986072555184364, 0.026849593967199326, 0.027126653119921684, -0.011661690659821033, -0.01090607326477766, -0.006435338873416185, 0.012536946684122086, 0.03508581966161728, -0.009545962326228619, 0.05168420821428299, -0.012341746129095554, -0.009816725738346577, 0.0006395196542143822, 0.0025470592081546783, 0.00336879282258451, 0.0020165531896054745, -0.011340552940964699, -0.025867292657494545, -0.020237945020198822, -0.021320994943380356, 0.0018339456291869283, -0.013613701798021793, -0.008897391147911549, 0.02474646084010601, -0.004996518138796091, 0.0026194725651293993, 0.0552607960999012, -0.026522159576416016, -0.003519916208460927, 0.009174451231956482, 0.03312121704220772, 0.010137862525880337, 0.035967372357845306, -0.036597054451704025, -0.012643992900848389, -0.030627679079771042, 0.05722540244460106, 0.00031129849958233535, -0.043750230222940445, -0.007172065787017345, -0.007795449811965227, 0.022290704771876335, -0.010358250699937344, -0.027076279744505882, -0.07606545090675354, -0.0075624678283929825, -0.004791871644556522, 0.014570816420018673, 0.002950055059045553, 0.04284349083900452, -0.00624958286061883, -0.04034995287656784, 0.0002918177633546293, -0.008456614799797535, -0.03926690295338631, -0.028159329667687416, 0.006142537109553814, 0.0030350619927048683, 0.010307876393198967, 0.008274007588624954, 0.028713449835777283, 0.004366836976259947, -0.024582743644714355, 0.02310928888618946, -0.026144351810216904, -0.0037906791549175978, 0.028411202132701874, 0.029166819527745247, -0.04329685866832733, -0.027781521901488304, -0.002639937214553356, -0.021661022678017616, -0.008884797804057598, -0.006561275105923414, -0.019431952387094498, 0.019066737964749336, -0.001340433256700635, -0.012033202685415745, -0.039166152477264404, 0.0015482279704883695, 0.029720939695835114, -0.04362429305911064, -0.006932786665856838, 0.0020102562848478556, -0.047931309789419174, 0.024910176172852516, 0.012782522477209568, -0.02508648857474327, 0.01414263341575861, 0.02672365866601467, -0.05037447437644005, 0.01889042742550373, 0.020237945020198822, 3.637268264355953e-06, 0.01107608713209629, -0.002573820762336254, 0.031358107924461365, -0.03521175682544708, -0.025502076372504234, -0.010030817240476608, 0.016699137166142464, -0.0356903150677681, 0.007436531595885754, 0.013915948569774628, 0.0023676003329455853, -0.032491534948349, 0.019381579011678696, 0.05601641535758972, -0.03677336499094963, -0.029091257601976395, -0.03543844074010849, -0.02727777697145939, -0.00228259339928627, -0.008368459530174732, -0.002290464239194989, -0.003645852440968156, 0.015464963391423225, -0.00032979538082145154, -0.010855698958039284, 0.01251805666834116, -0.03375089541077614, 0.0029469067230820656, 0.018777085468173027, 0.0026493824552744627, -0.010011926293373108, 0.00018575586727820337, -0.005475075449794531, -0.0003358954272698611, -0.015011592768132687, -0.0010145733831450343, -0.00894146878272295, -0.021648429334163666, -0.02831045351922512, -0.009911177679896355, 0.00329952803440392, 0.03160998225212097, -0.022013645619153976, 0.006510900799185038, -0.014457473531365395, 0.028789011761546135, 0.010811621323227882, 0.00017808163829613477, 0.0032711923122406006, 0.0012184325605630875, -0.0211320910602808, -0.015590899623930454, -0.01784515753388405, -0.022227736189961433, -0.001934694591909647, 0.011762439273297787, -0.0021283214446157217, -0.0009091018000617623, -0.008847016841173172, 0.012958833016455173, -0.028184518218040466, 0.018965989351272583, -0.02798301912844181, -0.0020700760651379824, 0.017631065100431442, 0.015024187043309212, -0.01283919345587492, 0.01591833308339119, -0.01073605939745903, 0.02310928888618946, -0.0002939822734333575, -0.027806708589196205, -0.012354339472949505, -0.03674817830324173, -0.04415322467684746, 0.0211320910602808, -0.020061634480953217, 0.022983353585004807, -0.007512093521654606, -0.0022526835091412067, -0.014936030842363834, 0.016724325716495514, -0.028083769604563713, -0.0423901192843914, 0.007700997404754162, -0.004854839760810137, 0.014281162992119789, -0.008928875438869, 0.01954529620707035, 0.022378860041499138, 0.05929075554013252, 0.014784907922148705, -0.023814532905817032, -0.02606878988444805, -0.005682870279997587, 0.02411677874624729, -0.020968373864889145, -0.022970760241150856, -0.05949225276708603, 0.03390201926231384, -0.01462119072675705, 0.004133854992687702, 0.00611105328425765, -0.03863722085952759, 0.02440643310546875, -0.05445480719208717, -0.04984554275870323, 0.0026163242291659117, -0.02504870668053627, 0.023575253784656525, 0.0071216910146176815, 0.014243382029235363, -0.0006611649878323078, 0.0016686543822288513, -0.014570816420018673, 0.011825407855212688, -0.0053365458734333515, -0.016774699091911316, 0.03027505800127983, 0.0023282452020794153, 0.03380127251148224, -0.01727844402194023, -0.12492869049310684, 0.00577102554962039, 0.019608262926340103, -0.006687211338430643, 0.01691322959959507, -0.03148404508829117, -0.017328819260001183, -0.017416974529623985, 0.017631065100431442, 0.021862521767616272, 0.0037749370094388723, -0.03153441846370697, 0.001696990104392171, 0.0027501313015818596, 0.022290704771876335, -0.014331537298858166, 0.014092259109020233, 0.012694367207586765, 0.018978582695126534, 0.026597721502184868, -0.05470667779445648, -0.04971960559487343, -0.0013569623697549105, -0.003412870457395911, 0.010641607455909252, -0.013387016020715237, -0.018046654760837555, -0.034632451832294464, 0.019343797117471695, -0.004845394752919674, -0.004209416918456554, -0.008985546417534351, -0.01169947162270546, 9.509165829513222e-05, -0.021333590149879456, -0.007468015421181917, 0.016422078013420105, -0.032038163393735886, 0.002646234119310975, -0.01724066399037838, 0.018651148304343224, -0.006274770479649305, -0.003756046760827303, 0.00586232915520668, 0.029343130066990852, -0.007392453961074352, 0.022870011627674103, 0.015364214777946472, 0.0007068168488331139, -0.01853780634701252, 0.004807613790035248, -0.021598055958747864, 0.010515671223402023, 0.003916615154594183, 0.004347946494817734, 0.02143433876335621, -0.020061634480953217, -0.016812480986118317, -0.024796834215521812, -0.037277109920978546, 0.007266517728567123, 0.008582551032304764, 0.023335974663496017, -0.023550067096948624, 0.027126653119921684, 0.012467682361602783, -0.03178629279136658, -0.021333590149879456, -0.007083910517394543, -0.009262606501579285, 0.017857750877738, -0.001796164782717824, -0.011831704527139664, 0.005015408620238304, 0.027831897139549255, 0.03841053694486618, -0.013437390327453613, 0.01055345218628645, 0.015061967074871063, -0.004124409984797239, -0.007852121256291866, -0.008991843089461327, 0.004118113312870264, 0.04513552784919739, -0.017026571556925774, -0.03196260333061218, -0.033020466566085815, -0.026799220591783524, -0.02536354772746563, 0.0035356583539396524, -0.04135744273662567, -0.02606878988444805, 0.009804131463170052, 0.025942854583263397, -0.006362925749272108, 0.006268473342061043, 0.04304498806595802, -0.023285599425435066, -0.058434389531612396, -0.027202215045690536, 0.03961952403187752, -0.009331870824098587, 0.00462500611320138, -0.03440576419234276, 0.032012976706027985, 0.029267568141222, -0.011397224850952625, -0.032063353806734085, 0.023839719593524933, 0.009791538119316101, 0.01254954095929861, -0.006051233503967524, 0.007663216907531023, -0.056066788733005524, 0.0034978773910552263, -0.02375156432390213, 0.05657053366303444, 0.022038832306861877, -0.01024490874260664, -0.006230692844837904, -0.01815999671816826, 0.022202549502253532, -0.012455088086426258, -0.011252397671341896, 0.01543977577239275, 0.024557555094361305, -0.020363880321383476, 0.021358776837587357, -0.024141965433955193, -0.03347383812069893, 0.017379192635416985, 0.040752947330474854, -0.040148455649614334, -0.0003478987200651318, 0.0024478845298290253, -0.007745075039565563, -0.03027505800127983, -0.004363688640296459, 0.005626198835670948, -0.022341078147292137, 0.019986072555184364, -0.024607930332422256, 0.03720154985785484, -0.00023278516891878098, 0.02604360319674015, -0.037856414914131165, 0.023550067096948624, -0.002066927496343851, 0.04352354630827904, 0.0044581410475075245, -0.016119832172989845, -0.010830511339008808, -0.003989028744399548, -0.013160331174731255, 0.03700004890561104, -0.0035702907480299473, 0.013752231374382973, 0.01923045516014099, -0.011812813580036163, 0.004470734391361475, 0.017782188951969147, -0.008444021455943584, -0.015162716619670391, 0.0047163101844489574, -0.004001622088253498, 0.029192008078098297, -0.02508648857474327, -0.0486869290471077, -0.05324581637978554, 0.03619405999779701, 0.00943891704082489, 0.03969508409500122, -0.014016697183251381, -0.014998999424278736, 0.034330204129219055, 0.04352354630827904, -0.013764824718236923, 0.005909555591642857, 0.045085154473781586, -0.026925155892968178, -0.001174354925751686, 0.040425512939691544, -0.024507181718945503, 0.03775566816329956, -0.021031342446804047, 0.016472453251481056, -0.007688404060900211, 0.03939283639192581, 0.04579039663076401, -0.009829319082200527, 0.024822020903229713, -0.03284415602684021, 0.02336116135120392, -0.00207322440110147, -0.008595144376158714, 0.02142174541950226, 0.027151841670274734, -0.00795286986976862, 0.04060182720422745, 0.0357910618185997, -0.043725043535232544, -0.0003927634679712355, 0.018928207457065582, 0.014885656535625458, -0.00512245437130332, 0.0034223156981170177, 0.013487765565514565, 0.017366599291563034, 0.0037088205572217703, 0.04397691413760185, -0.02337375469505787, 0.008903687819838524, -0.003579735988751054, 0.019104519858956337, 0.0016623575938865542, 0.028763825073838234, 0.0018182036001235247, 0.043120548129081726, 0.018965989351272583, 0.016447264701128006, -0.02929275669157505, 0.0015435053501278162, -0.018764492124319077, -0.017114726826548576, 0.002661976031959057, 0.0026021564844995737, -0.028386015444993973, -0.005723799578845501, 0.036571867763996124, -0.019066737964749336, 0.02727777697145939, -0.007159471977502108, -0.017303630709648132, 0.02868826314806938, 0.01827334053814411, -0.008840720169246197, -0.041483379900455475, 0.03309603035449982, 0.0021613796707242727, -0.008834423497319221, -0.02473386563360691, -0.0009075276320800185, 0.018625961616635323, -0.010679388418793678, -0.002625769469887018, -0.036269620060920715, -0.013777418062090874, 0.016837667673826218, 0.032038163393735886, -0.01623317413032055, -0.010219721123576164, 0.04385098069906235, -0.005638792645186186, 0.004108667839318514, 0.017769595608115196, -0.03687411546707153, -0.009262606501579285, 0.013361829333007336, 0.01171206496655941, 0.03019949607551098, -0.021938083693385124, -0.017102133482694626, 0.009728570468723774, -0.03327234089374542, -0.029519440606236458, -0.0195201076567173, -0.01691322959959507, 0.012184325605630875, -0.02697553113102913, -0.03795716539025307, 0.01821037195622921, 0.03634518384933472, 0.016082050278782845, 0.027731146663427353, -0.0058245486579835415, 0.010068598203361034, 0.030426181852817535, 0.04301980137825012, 0.029821688309311867, 0.004159042611718178, -0.009243715554475784, -0.038536470383405685, 0.03024987131357193, -0.008739971555769444, -0.0003697407664731145, 0.010370844975113869, -0.012253590859472752, 0.020716501399874687, 0.017807375639677048, -0.010578639805316925, 0.011094978079199791, 0.04624376818537712, 1.0945625490421662e-06, -0.03977064788341522, 0.0029327389784157276, 0.04337242245674133, -0.017165102064609528, -0.06442894786596298, -0.026774032041430473, 0.05004703998565674, 0.008425130508840084, -0.0013915948802605271, -0.051205653697252274, 0.032667845487594604, 0.018940802663564682, -0.03090474009513855, 0.007732481695711613, 0.019066737964749336, -0.007153175305575132, 0.008847016841173172, -0.04458140954375267, 0.02507389336824417, -0.007908792234957218, -0.021686211228370667, 0.026119165122509003, -0.005616753827780485, -0.04045070335268974, 0.020036445930600166, -0.012285074219107628, 0.006957974284887314, 0.013827793300151825, -0.003005152102559805, -0.0032837858889251947, -0.0031657207291573286, 0.01815999671816826, -0.005506559740751982, 0.009722272865474224, 0.013021801598370075, -0.010163050144910812, 0.004369985777884722, -0.040828511118888855, -0.015578306280076504, -0.004968182649463415, -0.03448132798075676, 0.011743549257516861, -0.015792397782206535, -0.0019110816065222025, 0.023650815710425377, 0.0456392727792263, 0.031987790018320084, 0.006674617528915405, -0.024947958067059517, 0.011378333903849125, -0.005912703927606344, 0.010175643488764763, 0.035916998982429504, -0.027554836124181747, -0.016686543822288513, -0.004473882727324963, -0.00940743274986744, 0.03745342046022415, 0.011485380120575428, -0.005034299101680517, -0.029166819527745247, -0.014507847838103771, 0.030350619927048683, 0.03606812283396721, 0.04488365724682808, -0.019129706546664238, 0.041483379900455475, -0.003038210328668356, -0.0031909081153571606, 0.009237418882548809, -0.0179459061473608, -0.008192148990929127, 0.034002769738435745, 0.03052693046629429, 0.013739638030529022, -0.0389646552503109, 0.0009649859857745469, 0.0033184185158461332, 0.03654668107628822, 0.014671565033495426, -0.004218861926347017, 0.01482268888503313, -0.011309069581329823, 0.013563326559960842, 0.005493965931236744, -0.019759386777877808, -0.002501407405361533, 0.0019488624529913068, -0.013525545597076416, 0.01092496421188116, -0.01594352163374424, 0.01755550317466259, -0.030400995165109634, 0.03372570872306824, -0.008318085223436356, 0.017958499491214752, 0.026925155892968178, -0.022517388686537743, -0.004118113312870264, -0.010251205414533615, 0.008752564899623394, -0.0033499025739729404, -0.007417641114443541, 0.038209039717912674, -0.014381912536919117, 0.03838535025715828, 0.024847209453582764, 0.015024187043309212, 0.023638222366571426, 0.017744408920407295, 0.004640748258680105, -0.0017158804694190621, -0.04395172744989395, -0.0029138484969735146, -0.010156753472983837, -0.014394505880773067, 0.002592711243778467, 0.020666128024458885, -0.013588514178991318, 0.02506130002439022, -0.030048374086618423, -0.00894146878272295, -0.029116446152329445, 0.0064920103177428246, -0.005786767695099115, 0.012310261838138103, -0.008733673952519894, 0.01482268888503313, 0.002507704310119152, -0.028486764058470726, 0.0034443545155227184, 0.00962152425199747, -0.0194949209690094, 0.007682107388973236, 0.02669847011566162, 0.007354672998189926, 0.015515337698161602, -0.006293660961091518, -0.003989028744399548, -0.022013645619153976, -0.009829319082200527, -0.057426899671554565, -0.007329485844820738, -0.006895006168633699, -0.02507389336824417, 0.047956500202417374, 0.005676573608070612, 0.009482994675636292, -0.006211802363395691, 0.0068635218776762486, 0.023940468207001686, -0.0031121978536248207, 0.020577972754836082, -0.004439250566065311, -0.036294806748628616, 0.0684589073061943, -0.0013427945086732507, -0.007360969670116901, 0.01919267512857914, 0.004432953428477049, 0.02833564206957817, -0.033045653253793716, 0.0001646025339141488, -0.013084769248962402, 0.018311120569705963, 0.0025659496895968914, 0.01856299303472042, -0.006819444242864847, -0.009042218327522278, 0.01090607326477766, -0.011932453140616417, -0.00039906028541736305, 0.029267568141222, 0.006957974284887314, 0.0037466015201061964, -0.009394839406013489, 0.03946840018033981, 0.018323713913559914, -0.025766542181372643, 0.01254954095929861, 0.035715501755476, -0.0001439411280443892, -0.011346850544214249, 0.017681440338492393, 0.047301631420850754, 0.0011176835978403687, -0.01692582294344902, -0.048989176750183105, 0.021371370181441307, -0.0552607960999012, 0.015867959707975388, -0.03553919121623039, 0.025968041270971298, -0.01202060841023922, 4.365951826912351e-05, 0.0211069043725729, -0.017492536455392838, -0.0046470449306070805, 0.012751038186252117, -0.007763965521007776, 0.011989125050604343, -0.0029421839863061905, 0.016182798892259598, -0.008022135123610497, 0.011756142601370811, 0.0031200689263641834, -0.016207987442612648, 0.01268807053565979, -0.01754290983080864, -0.008412537164986134, -0.005550637375563383, -0.023008540272712708, 0.04694901034235954, 0.016132425516843796, 0.010118972510099411, -0.018336309120059013, 0.02249220199882984, -0.01722807064652443, -0.0060323430225253105, 0.012599915266036987, -0.03521175682544708, 0.0023140774574130774, -0.0011531031923368573, -0.00642904220148921, 0.04647045210003853, -0.03150923177599907, -0.005604160018265247, -0.016094643622636795, 0.0013364977203309536, 0.014658971689641476, 0.010276392102241516, -0.006321996450424194, -0.0008193723042495549, 0.0025376142002642155, 0.018625961616635323, -0.009873396717011929, 0.004574631806463003, -0.01979716867208481, 0.007291704881936312, 0.006510900799185038, 0.0056891669519245625, 0.032743409276008606, -0.006580165587365627, -0.04511034116148949, 0.021283214911818504, -0.01881486549973488, 0.0021220247726887465, 0.04788093641400337, 0.042767927050590515, -0.010333064012229443, -0.0194949209690094, -0.007505796384066343, 0.030476557090878487, 0.022265518084168434, 0.001571840955875814, -0.0017678291769698262, -0.0034286126028746367, 0.0032176694367080927, 0.0038442020304501057, -0.04606745392084122, 0.013714450411498547, -0.021283214911818504, -0.010282689705491066, 0.015716835856437683, 0.010792731307446957, 0.00378753081895411, -0.003796975826844573, 0.03548881784081459, 0.020628346130251884, -0.024469399824738503, 0.019129706546664238, 0.007732481695711613, 0.013172924518585205, 0.006400706712156534, -0.017769595608115196, 0.025892479345202446, -0.007222440093755722, 0.003982731606811285, 0.0010476316092535853, -0.009073701687157154, -0.012574727647006512, 0.02086762525141239, -0.023348568007349968, -0.00633773859590292, 0.011176836676895618, -0.01657320186495781, -0.027781521901488304, 0.02052759751677513, -0.006819444242864847, -4.396697931952076e-06, 0.036622241139411926, -0.009054811671376228, -0.024532368406653404, -0.007896198891103268, -0.0113594438880682, 0.014910844154655933, 0.009023327380418777, -0.026874780654907227, 0.06709879636764526, -0.017102133482694626, -0.03616887331008911, 0.01319811213761568, -0.03536288067698479, 0.029670564457774162, -0.011038306169211864, 0.020993562415242195, 0.031408485025167465, -0.0028162479866296053, 0.032718218863010406, 0.014394505880773067, -0.010849402286112309, 0.032718218863010406, -0.007549874018877745, 0.0070272390730679035, -0.022618139162659645, 0.004892620723694563, -0.01915489323437214, -0.009911177679896355, 0.016371704638004303, 0.03871278092265129, -0.029066070914268494, -0.02506130002439022, -0.0012074131518602371, 0.00236287759616971, 0.027076279744505882, -0.012259887531399727, 0.018084436655044556, 0.011611316353082657, -0.0008839145884849131, 0.0037340077105909586, -0.03506063297390938, -0.016661357134580612, -0.022706294432282448, -0.0008351143333129585, 0.011737252585589886, -0.016799887642264366, -0.014444880187511444, 0.0017143063014373183, -0.0034758385736495256, -0.013122550211846828, 0.007915088906884193, 0.017064353451132774, 0.014092259109020233, -0.006447932682931423, -0.030678054317831993, -0.013563326559960842, -0.02343672327697277, 0.03553919121623039, 0.011252397671341896, 0.020930593833327293, 0.035639937967061996, 0.009092592634260654, 0.010673091746866703, 0.032491534948349, 0.020980967208743095, -0.013588514178991318, -0.003966989926993847, 0.009338168427348137, -0.0033436056692153215, -0.00552230142056942, 0.014998999424278736, -0.002021275693550706, 0.02215217426419258, -0.0038788344245404005, -0.012543244287371635, -0.009237418882548809, -0.024809427559375763, 0.03747860714793205, 0.0007123265531845391, 0.02695034258067608, 0.002038592007011175, 0.0013349235523492098, 0.009999332949519157, -0.05405180901288986, -0.005978820379823446, 0.00875886157155037, -0.01598130166530609, 0.010912369936704636, -0.00037544724182225764, -0.01824815385043621, 0.03810828924179077, 0.015817584469914436, 0.002350284019485116, -0.01105090044438839, -0.0036521493457257748, -0.010433812625706196, -0.007159471977502108, -0.0013317750999704003, 0.0049429950304329395, -0.005663979798555374, -0.001123193302191794, 0.0014970663469284773, -0.0044864765368402, -0.0027359635569155216, -0.0015757764922454953, -0.03123217262327671, 0.050903405994176865, 0.006252731662243605, 0.005799361038953066, -0.050223350524902344, 0.10215943306684494, 0.027051091194152832, 0.01429375633597374, -0.05067671835422516, 0.017694033682346344, -0.023839719593524933, 0.017971092835068703, -0.017416974529623985, -0.02571616880595684, 0.01332404837012291, -0.06750179082155228, -0.016094643622636795, -0.003315269947052002, -0.035614751279354095, 0.027731146663427353, -0.010137862525880337, -0.021081717684864998, 0.0001541734382044524, 0.00896035972982645, -0.03412870690226555, 0.04380060359835625, -0.011365740559995174, 0.009363355115056038, 0.005437294486910105, -0.017291037365794182, -0.0027092022355645895, 0.012448791414499283, -0.010824214667081833, -0.011856891214847565, 0.0038127179723232985, 0.026219913735985756, 0.02564060688018799, 0.014684159308671951, 0.027580024674534798, -0.04188637435436249, 0.00832438189536333, -0.0026415113825351, -0.029443878680467606, 0.005056337919086218, 0.008865906856954098, -0.0008626628550700843, -0.03160998225212097, -0.023184850811958313, 0.004338501486927271, 0.023613033816218376, -0.03158479556441307, 0.011019416153430939, 0.010276392102241516, -0.028713449835777283, -0.009558556601405144, 0.02240404672920704, 0.0022023089695721865, -0.01496121846139431, -0.0004395959840621799, 0.013852979987859726, 0.0018166294321417809, -0.020351286977529526, 0.0050122602842748165, 0.022026238963007927, 0.03609330952167511, 0.0455385223031044, -0.005868626292794943, 0.046646762639284134, -0.010276392102241516, 0.03372570872306824, -0.008928875438869, 0.01333664171397686, -0.015527931042015553, 0.0015891571529209614, 0.013601107522845268, 0.028738636523485184, -0.01921786181628704, 0.02208920568227768, -0.03286934271454811, 0.018084436655044556, -0.007184659130871296, -0.016749512404203415, 0.001227090717293322, -0.0024478845298290253, -0.027428900822997093, -0.005582121200859547, -0.02245442196726799, 0.034330204129219055, 0.03606812283396721, 0.02150990068912506, 0.03420426696538925, 0.013160331174731255, 0.008374756202101707, 0.02798301912844181, -0.00945151038467884, 0.018008874729275703, -0.011397224850952625, -0.008998140692710876, 0.020603159442543983, -0.013978916220366955, -0.02730296365916729, -0.0005698612076230347, 0.002798931673169136, 0.02054019086062908, -0.0019000621978193521, 0.005752135068178177, 0.02730296365916729, 0.04128187894821167, 0.0037528981920331717, 0.016447264701128006, 0.02337375469505787, 0.014873063191771507, 0.01104460284113884, -0.007593951653689146, -0.0036741881631314754, 0.04911511018872261, 0.006712398491799831, -0.031005488708615303, -0.01987273059785366, -0.004325907677412033, -0.039846207946538925, -0.017782188951969147, 0.015112342312932014, -0.001115322345867753, -0.009495588019490242, 0.0276052113622427, -0.01886524073779583, -0.004026809241622686, -0.014671565033495426, -0.026446597650647163, 0.0178829375654459, 0.034657638520002365, 0.014583409763872623, 0.017643658444285393, -0.023625627160072327, -0.00764432642608881, -0.04689863324165344, -0.02176177315413952, 0.0017505129799246788, -0.019583076238632202, 0.008053618483245373, -0.034305017441511154, 0.0023723228368908167, -0.03395239636301994, -0.009564853273332119, 0.016359109431505203, -0.0211698729544878, 0.01107608713209629, -0.021308401599526405]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
", V., Hayes, T. P., and Kakade, S. M. (2008). Stochastic linear optimization under bandit feedback.
Devlin, J., Chang, M.-W., Lee, K., and Toutanova, K. (2018). Bert: Pre-training of deep bidirectional
transformers for language understanding. arXiv preprint arXiv:1810.04805 .
Diao, S., Pan, R., Dong, H., Shum, K. S., Zhang, J., Xiong, W., and Zhang, T. (2023). Lmflow: An extensible
toolkit for finetuning and inference of large foundation models. arXiv preprint arXiv:2306.12420 .
Dong, H., Xiong, W., Goyal, D., Zhang, Y., Chow, W., Pan, R., Diao, S., Zhang, J., SHUM, K., and Zhang,
T. (2023). RAFT: Reward ranked finetuning for generative foundation model alignment. Transactions on
Machine Learning Research .
Engstrom, L., Ilyas, A., Santurkar, S., Tsipras, D., Janoos, F., Rudolph, L., and Madry, A. (2020). Implemen-
tation matters in deep policy gradients: A case study on ppo and trpo. arXiv preprint arXiv:2005.12729 .
Ethayarajh, K., Xu, W., Muennighoff, N., Jurafsky, D., and Kiela, D. (2024). Kto: Model alignment as
prospect theoretic optimization. arXiv preprint arXiv:2402.01306 .
Faury, L., Abeille, M., Calauz` enes, C., and Fercoq, O. (2020). Improved optimistic algorithms for logistic
bandits. In International Conference on Machine Learning , pages 3052–3060. PMLR.
Gao, L., Schulman, J., and Hilton, J. (2023). Scaling laws for reward model overoptimization. In International
Conference on Machine Learning , pages 10835–10866. PMLR.
Geng, X. and Liu, H. (2023). Openllama: An open reproduction of llama.
Gentile, C., Wang, Z., and Zhang, T. (2022). Fast rates in pool-based batch active learning. arXiv preprint
arXiv:2202.05448 .
Google (2023). Bard.
Gulcehre, C., Paine, T. L., Srinivasan, S., Konyushkova, K., Weerts, L., Sharma, A., Siddhant, A., Ahern,
A., Wang, M., Gu, C., et al. (2023). Reinforced self-training (rest) for language modeling. arXiv preprint
arXiv:2308.08998 .
Hao, Y., Chi, Z., Dong, L., and Wei, F. (2022). Optimizing prompts for text-to-image generation. arXiv
preprint arXiv:2212.09611 .
Hoang Tran, Chris Glaze, B. H. (2024). Snorkel-mistral-pairrm-dpo.
Hong, J., Bhatia, K., and Dragan, A. (2022). On the sensitivity of reward inference to misspecified human
models. arXiv preprint arXiv:2212.04717 .
27
Hu, P., Chen, Y., and Huang, L. (2022). Nearly minimax optimal reinforcement learning with linear function
approximation. In International Conference on Machine Learning , pages 8971–9019. PMLR.
Huang, B., Lee, J. D., Wang, Z., and Yang, Z. (2021). Towards general function approximation in zero-sum
markov games. arXiv preprint arXiv:2107.14702 .
Jin, C., Liu, Q., and Yu, T. (2021a). The power of exploiter: Provable multi-agent rl in large state spaces.
arXiv preprint arXiv:2106.03352 .
Jin, Y., Yang, Z., and Wang, Z. (2021b). Is pessimism provably efficient for offline rl? In International
Conference on Machine Learning , pages 5084–5096. PMLR.
Kong, D. and Yang, L. (2022). Provably feedback-efficient reinforcement learning via active reward learning.
Advances","[-0.03328254818916321, 0.0074069988913834095, 0.019538814201951027, -0.0038470712024718523, 0.017581017687916756, 0.004901018459349871, -0.031168129295110703, 0.06740042567253113, -0.03077656961977482, 0.026939287781715393, 0.032107871025800705, -0.026130065321922302, -0.004705239087343216, 0.02264518477022648, 0.022384146228432655, -0.024328891187906265, 0.026834871619939804, -0.02631279267370701, 0.016771795228123665, 0.03114202432334423, -0.030698256567120552, -0.045394785702228546, -0.029680203646421432, 0.025216426700353622, 0.007792032323777676, -0.01443549059331417, -0.012490744702517986, 0.04090490564703941, -0.023506617173552513, -0.03171631321310997, 0.054296236485242844, -0.029445268213748932, -0.045864660292863846, -0.03458774834871292, -0.030619945377111435, 0.03390904515981674, 0.02016530930995941, 0.032003454864025116, -0.007785506080836058, -0.004920596722513437, -0.001198334968648851, -0.09987375140190125, 0.003595820628106594, 0.05492273345589638, 0.00023717895965091884, 0.03539697080850601, 0.008627358824014664, 0.0021552082616835833, 0.0021503136958926916, 0.051555320620536804, -0.05972586199641228, 0.0134435398504138, -0.04615180194377899, -0.03390904515981674, -0.013019350357353687, 0.005038064438849688, 0.01647159829735756, 0.01842939667403698, 0.025555776432156563, -0.02107894793152809, -0.01538828480988741, -0.034613851457834244, 0.007485310547053814, 0.032212287187576294, -0.022592978551983833, -0.014422438107430935, -0.10681740939617157, 0.011857723817229271, 0.0065325163304805756, 0.042758285999298096, -0.011446586810052395, -0.015453544445335865, 0.03448333218693733, -0.017698485404253006, -0.006911023519933224, -0.004799865651875734, 0.031768519431352615, 0.09919504821300507, -0.013417435809969902, -0.037955157458782196, -0.002923643682152033, -0.013404383324086666, 0.04014788940548897, -0.0501457080245018, -0.03923425078392029, -0.05852507799863815, -0.05690663307905197, -0.0205046609044075, -0.011244281195104122, 0.01177941169589758, -0.022854017093777657, -0.01855991594493389, -0.02243635430932045, 0.011303015053272247, 0.03915594145655632, 0.005782027263194323, 0.015988675877451897, -0.005465516820549965, 0.051477011293172836, 0.028766565024852753, -0.03276047110557556, -0.030854880809783936, 0.03719814494252205, -0.03080267272889614, 0.03158579394221306, 0.0003583176585379988, -0.026378052309155464, -0.00978245958685875, 0.003856860101222992, -0.0035044567193835974, -0.10765273123979568, 0.0007517124759033322, -0.058890536427497864, -0.00031630657031200826, -0.01923861913383007, -0.06557314842939377, -0.04450725391507149, 0.011929510161280632, -0.01762017421424389, -0.015714583918452263, -0.01322165597230196, -0.016667379066348076, 0.03471826761960983, 0.018729591742157936, 0.008999340236186981, -0.0016771794762462378, 0.022123105823993683, -0.06745263189077377, 0.0017457023495808244, -0.026717403903603554, -0.003938435111194849, 0.02426363155245781, -0.0003071294049732387, -0.026482468470931053, -0.04273218289017677, -0.013358701951801777, -0.013202077709138393, 0.006826185621321201, -0.026586884632706642, -0.050667788833379745, 0.021796807646751404, -0.016876209527254105, -0.07246459275484085, 0.011074605397880077, -0.080609031021595, -0.0018794852076098323, -0.009965186938643456, -0.030933193862438202, -0.016758741810917854, 0.01230801735073328, 0.03946918994188309, -0.0013468011748045683, -0.018964527174830437, 0.02141829952597618, -0.028818773105740547, -0.04009568318724632, -0.04555141180753708, 0.05920378118753433, 0.046438947319984436, -0.03231670334935188, 0.03482268378138542, 0.08123552799224854, -0.002998692449182272, -0.004421358462423086, 0.04923206940293312, -0.001047421363182366, -0.0179856289178133, 0.014239710755646229, -0.049153756350278854, -0.0220839511603117, 0.05244285613298416, 0.004026535898447037, -0.02312810905277729, -0.013299968093633652, -0.015975624322891235, -0.026991495862603188, -0.03568411245942116, -0.011126813478767872, -0.020752647891640663, -0.057846374809741974, 0.019395243376493454, 0.00979551114141941, -0.02552967332303524, 0.014722634106874466, -0.016562962904572487, -0.0012334121856838465, 0.003990642726421356, 0.014500750228762627, 0.020530764013528824, 0.06202301010489464, 0.03638892248272896, 0.027069807052612305, 0.052808310836553574, 0.0014389808056876063, -0.016980625689029694, -0.025216426700353622, 0.04570803418755531, 0.01006307639181614, -0.0065488312393426895, -0.017333028838038445, -0.014409386552870274, 0.023258628323674202, -0.0010882088681682944, -0.05815962329506874, 0.014070034958422184, -0.005837498232722282, -0.013143343850970268, 0.026351947337388992, -0.029053708538413048, -0.022919276729226112, 0.028688251972198486, 0.030515529215335846, 0.04750920832157135, -0.014905361458659172, -0.013717630878090858, -0.008438104763627052, -0.013691526837646961, 0.026586884632706642, 0.012810518965125084, 0.05460948497056961, -0.0048031285405159, -0.007557096425443888, -0.009769407100975513, 1.8048442143481225e-05, -0.016510754823684692, 0.03529255464673042, 0.028557732701301575, -0.0243680477142334, 0.03813788667321205, -0.01611919514834881, 0.04816180840134621, 0.0007137801731005311, -0.025829868391156197, -0.025386100634932518, 0.00217315461486578, -0.0338568352162838, 0.011146390810608864, -0.023976488038897514, 0.03289099037647247, -0.05450506880879402, 0.019943425431847572, 0.035423073917627335, 0.002182943746447563, -0.004545351956039667, 0.02083096094429493, 0.04925817251205444, -0.03364800661802292, -0.02999345026910305, 0.014722634106874466, 0.015349128283560276, 0.03443112224340439, -0.0355013869702816, -0.004790076520293951, -0.011185547336935997, -0.019186411052942276, -0.023180317133665085, -0.020073944702744484, -0.0060430667363107204, -0.024237526580691338, -0.02551662176847458, -0.013717630878090858, 0.019878165796399117, -0.0010335537372156978, 0.019512711092829704, 0.010102232918143272, -0.0067609259858727455, -0.04221010580658913, 0.03174241632223129, 0.010996293276548386, -0.01832498051226139, 0.014396334066987038, 0.005175109952688217, -0.029236435890197754, 0.007922551594674587, -0.05051116272807121, -0.04902323707938194, 0.052938830107450485, 0.04696102440357208, -0.07068952172994614, -0.008457683026790619, 0.014148346148431301, 0.03544917702674866, 0.054452862590551376, 0.006643457803875208, 0.021196415647864342, -0.0010294748935848475, -0.008392423391342163, -0.02093537710607052, -0.031115921214222908, -0.0006901234737597406, -0.017006730660796165, -0.008398949168622494, 0.009345217607915401, -0.06155313923954964, 0.05805520713329315, 0.020543817430734634, 0.030411113053560257, -0.028218381106853485, 0.03422229364514351, -0.018834007903933525, 0.034170083701610565, 0.01070914976298809, -0.04281049594283104, 0.013078084215521812, 0.04129646718502045, 0.032107871025800705, -0.014539905823767185, 0.005302366800606251, 0.008164013735949993, 0.01012833695858717, 0.010656941682100296, 0.021953430026769638, -0.012229705229401588, 0.017032833769917488, -0.020060893148183823, -0.0280617568641901, 0.04578634724020958, -0.03487488999962807, 0.014618217945098877, -0.03581463545560837, -0.03161189705133438, -0.035188138484954834, -0.008274955675005913, 0.008966710418462753, 0.011812042444944382, 0.014526854269206524, 0.028244486078619957, -0.021496610715985298, 0.004812917672097683, -0.008940606378018856, 2.040646540990565e-05, 0.011400904506444931, 0.014004774391651154, -0.005253422074019909, -0.0278268214315176, -0.009182068519294262, -0.028244486078619957, 0.0347965806722641, 0.03732866421341896, 0.008999340236186981, -0.08593423664569855, 0.009488789364695549, -0.04422010853886604, -0.024550775066018105, -0.024759607389569283, -0.006633669137954712, 0.005158795043826103, 0.022175313904881477, 0.027174223214387894, 0.03993906080722809, 0.01969543844461441, -0.04419400542974472, 0.04450725391507149, 0.010578629560768604, -0.011818568222224712, 0.029627995565533638, 0.013352176174521446, -0.04844895005226135, -0.0275918859988451, -0.002078527817502618, -0.01718945801258087, 0.015636272728443146, 0.008901450783014297, -0.023859020322561264, 0.022162262350320816, 0.03388294205069542, 0.0037557072937488556, -0.016667379066348076, 0.025112010538578033, 0.0034848786890506744, 0.00869261845946312, 0.056854426860809326, -0.08274955302476883, -0.018246667459607124, -0.020230568945407867, 0.010089180432260036, 0.0047280797734856606, 0.021666286513209343, 0.018481604754924774, 0.03333475813269615, -0.012869252823293209, 0.02393733151257038, 0.004281049594283104, -0.01716335490345955, -0.003253206145018339, 0.01299324631690979, -0.0134435398504138, -0.01704588532447815, -0.014566009864211082, -0.014187502674758434, 0.006911023519933224, -0.0023787233512848616, -0.05977806821465492, 0.008770930580794811, 0.015179453417658806, 0.0124189592897892, -0.017567966133356094, 0.015257764607667923, 0.0364411287009716, 0.046412840485572815, -0.03868607059121132, -0.012921459972858429, -0.0336218997836113, 0.007420050911605358, -0.016784846782684326, 0.022253626957535744, 0.03056773729622364, 0.06854899972677231, -0.0061181155033409595, 0.0388949029147625, 0.05669780075550079, -0.05664559453725815, 0.01127691101282835, -0.04805739223957062, 0.016210559755563736, -0.045499201864004135, -0.006483571138232946, -0.007459206506609917, 0.029105916619300842, 0.08389812707901001, 0.006496623158454895, 0.0016282345168292522, 0.005801605060696602, -0.029471371322870255, -0.03161189705133438, 0.02357187680900097, 0.04087880253791809, -0.046856608241796494, 0.029706306755542755, -0.053304288536310196, -0.023793760687112808, 0.032682158052921295, 0.05223402380943298, -0.03986074775457382, -0.030828777700662613, -0.03445722907781601, 0.03845113515853882, 0.0083467410877347, -0.0038144411519169807, -0.05152921751141548, 0.028348900377750397, -0.005550354719161987, -0.05335649475455284, 0.04317595064640045, -0.007243848871439695, 0.01254295278340578, -0.016171403229236603, 0.030306698754429817, 0.014657373540103436, 0.0017881212988868356, -0.008581677451729774, 0.021209467202425003, 0.07648460566997528, 0.007902974262833595, -0.0076288823038339615, -0.039129838347435, 0.09152048826217651, -0.024785710498690605, 0.03824230283498764, 0.021248623728752136, 0.002182943746447563, -0.002895908197388053, -0.003147158771753311, -0.03179462254047394, 0.020178360864520073, 0.049754150211811066, 0.008823138661682606, 0.0025679771788418293, 0.0027017598040401936, 0.015988675877451897, 0.00036627118242904544, -0.013241234235465527, -0.005507935769855976, -0.020465504378080368, -0.026025649160146713, 0.010317590087652206, -0.0018631701823323965, -0.013626267202198505, -0.005550354719161987, -0.010957137681543827, 0.011661943979561329, -0.004698712844401598, 0.019747646525502205, 0.006561883259564638, 0.05941261351108551, 0.025046750903129578, 0.0022808334324508905, -0.00819011777639389, -0.006496623158454895, -0.009273432195186615, 0.002553293714299798, -0.008059597574174404, 0.024707399308681488, -0.013952567242085934, -0.003840545192360878, -0.01024580467492342, 0.008359793573617935, 0.010493791662156582, 0.003971064928919077, -0.00944310799241066, -0.0032319966703653336, -0.04863167926669121, -0.03957360237836838, -0.004835758823901415, -0.008033493533730507, -0.001415324048139155, 0.037824638187885284, -0.006581461057066917, 0.015492700971662998, 0.03959970921278, -0.04649115353822708, -0.018155304715037346, -0.005853813141584396, 0.017215561121702194, 0.00818359199911356, 0.031168129295110703, -0.05113765969872475, -0.010950610972940922, -0.005827709101140499, 0.054087407886981964, -0.008934080600738525, -0.02643026039004326, -0.014983673579990864, 0.004140740726143122, 0.02519032172858715, 0.006003910675644875, -0.03289099037647247, -0.07878175377845764, -0.02107894793152809, -0.005984332878142595, 0.011674996465444565, -0.015061984769999981, 0.03785074129700661, 0.002285727998241782, -0.039208147674798965, -0.00038931609014980495, -0.02620837651193142, -0.02025667391717434, -0.022501613944768906, -0.0006986887892708182, 0.0015278974315151572, 0.013162922114133835, -0.002341198967769742, 0.03155968710780144, -0.019251670688390732, -0.030828777700662613, 0.008562099188566208, -0.02622142806649208, 0.006806607823818922, 0.026260584592819214, 0.0556536428630352, -0.030515529215335846, -0.021705443039536476, -0.017920369282364845, -0.02816617302596569, -0.0240156427025795, -0.00021168679813854396, 0.01752880960702896, 0.01764627732336521, 0.013939514756202698, 0.0013419067254289985, -0.021953430026769638, -0.01299977209419012, 0.023767655715346336, -0.041035424917936325, 0.00921469833701849, 0.005436149891465902, -0.03884269297122955, 0.01841634325683117, 0.01946050301194191, -0.007511414587497711, 0.022344989702105522, 0.013665423728525639, -0.04696102440357208, 0.02242330275475979, -0.004855336621403694, 0.02575155720114708, -0.00500543462112546, 0.0121840238571167, 0.02529473789036274, -0.051555320620536804, -0.028479421511292458, -0.027539677917957306, -0.02161407843232155, -0.04108763486146927, 0.01866433210670948, 0.0036610804963856936, 0.03510982543230057, -0.04625621810555458, 0.02242330275475979, 0.057428713887929916, -0.0336218997836113, -0.03996516391634941, -0.011694574728608131, -0.0494409017264843, -0.0027768088039010763, -0.010526422411203384, -0.021222520619630814, -0.021261675283312798, 0.00013786154158879071, 0.01614530012011528, -0.007380894850939512, 0.009423529729247093, -0.028009548783302307, -0.02186206728219986, 0.0065749348141252995, -0.025607984513044357, 0.011172494851052761, -0.009058074094355106, -0.016876209527254105, 0.002750704763457179, -0.011485742405056953, 0.004568193107843399, -0.02164018340408802, -0.05549702048301697, -0.04683050513267517, -0.003060689428821206, 0.0031863145995885134, 0.052834417670965195, -0.0073025827296078205, -0.001735913334414363, -0.018246667459607124, 0.02402869611978531, -0.004039587918668985, -0.01105502713471651, 0.015845103189349174, -0.011289962567389011, -0.02999345026910305, -0.018729591742157936, -0.03991295397281647, -0.02769630216062069, -0.026860974729061127, 0.002086685271933675, 0.015492700971662998, 0.014918413013219833, -0.03607567399740219, 0.0038079151418060064, -0.021496610715985298, 0.02632584422826767, -0.02725253440439701, 0.02897539548575878, 0.008320637047290802, 0.005015223287045956, -0.020530764013528824, 0.01138785295188427, -0.01482704933732748, 0.00580813130363822, 0.016288870945572853, -0.03124644048511982, -0.01623666286468506, -0.025607984513044357, -0.03218618407845497, -0.0012122027110308409, -0.02107894793152809, 0.021783754229545593, 0.006969757378101349, 0.02049160934984684, -0.034405019134283066, 0.022475510835647583, -0.01784205622971058, -0.04497712478041649, 0.01322818174958229, 0.0041962116956710815, 0.00800738949328661, -0.010493791662156582, 0.03471826761960983, 0.02597344107925892, 0.07867733389139175, 0.0218490157276392, -0.02402869611978531, -0.01047421433031559, -0.0007003202917985618, 0.016314975917339325, -0.02221447043120861, -0.016106143593788147, -0.03717203810811043, 0.022723497822880745, -0.02062212862074375, 0.000688491971231997, 0.02355882339179516, -0.037824638187885284, 0.019160306081175804, -0.053278181701898575, -0.033021509647369385, 0.003628450445830822, -0.027748510241508484, 0.026730455458164215, -0.006826185621321201, 0.01785510964691639, -0.015962570905685425, -0.020922323688864708, -0.017659328877925873, 0.003726340364664793, -0.009841193445026875, -0.010089180432260036, 0.03174241632223129, 0.02012615278363228, 0.050302330404520035, -0.04341088607907295, -0.1122470274567604, -0.013078084215521812, 0.0314030647277832, -0.0018566441722214222, -0.004832495469599962, -0.041035424917936325, -0.0007782243192195892, -0.008333689533174038, 0.029497474431991577, 0.0388949029147625, -0.01104197558015585, -0.01604088395833969, -0.0169284176081419, 0.01322818174958229, 0.007974759675562382, -0.018912319093942642, 0.01875569485127926, 0.03035890683531761, 0.015492700971662998, 0.006173586472868919, -0.03560580313205719, -0.03923425078392029, -0.004979330580681562, -0.03009786643087864, 0.014879257418215275, -0.00683923764154315, -0.004405043553560972, -0.037824638187885284, -0.016223611310124397, -0.008790508843958378, -0.004215789493173361, 0.013639319688081741, -4.744088801089674e-05, 0.0008671409450471401, -0.0253077894449234, 0.00478355074301362, 0.01991732232272625, -0.04043503478169441, -0.0010931033175438643, -0.005759186111390591, 0.0026707614306360483, -0.016993679106235504, -0.005977807100862265, -0.008588203229010105, 0.022919276729226112, 0.0016649431781843305, 0.008431578986346722, 0.007935604080557823, 0.014174450188875198, -0.00037381687434390187, 0.0033266234677284956, -0.006251898594200611, 0.0113943787291646, 0.022814860567450523, 0.012862726114690304, 0.036676064133644104, -0.016758741810917854, 0.001577658113092184, -0.007746350485831499, -0.024655191227793694, -0.00466608302667737, 0.000841852743178606, 0.010611260309815407, -0.028636043891310692, 0.01887316256761551, 0.008842716924846172, -0.02803565375506878, -0.012014348059892654, -0.004176633898168802, -0.01623666286468506, 0.026991495862603188, 0.004238630644977093, -0.02038719318807125, 0.0046204011887311935, 0.022031743079423904, 0.04787466302514076, 0.008222747594118118, 0.0041962116956710815, 0.015427440404891968, 0.0006313895573839545, 0.007654986344277859, 0.0006052855751477182, 0.000582444597966969, 0.02918422780930996, -0.009808562695980072, -0.035527490079402924, -0.02393733151257038, -0.012046977877616882, -0.015649324283003807, 0.0013892201241105795, -0.023741552606225014, -0.04777024686336517, -0.001619261340238154, -2.2764488676330075e-05, -0.011668470688164234, 0.0009772670455276966, 0.048475053161382675, -0.009051548317074776, -0.07669343799352646, -0.011348696425557137, 0.032107871025800705, 0.0005469595198519528, 0.0032727839425206184, -0.03529255464673042, 0.030019555240869522, 0.014644321985542774, 0.004767235834151506, -0.04419400542974472, 0.011929510161280632, -0.01750270463526249, 0.011831619776785374, 0.005008697509765625, 0.018116148188710213, -0.046987127512693405, 0.023611031472682953, -0.027200326323509216, 0.04925817251205444, 0.008026967756450176, -0.008934080600738525, -0.008366319350898266, -0.0031504216603934765, 0.03586684167385101, -0.028244486078619957, -0.010036972351372242, 0.03328254818916321, 0.012066556140780449, 0.0038503340911120176, 0.002817596308887005, 0.0010988136054947972, -0.03294319659471512, 0.019199462607502937, 0.026508571580052376, -0.039886850863695145, 0.006969757378101349, 0.00029713648837059736, 0.006013699807226658, -0.00627147639170289, 0.02139219641685486, 0.008888398297131062, -0.03792905434966087, 0.04612569883465767, -0.005507935769855976, 0.04855336621403694, -0.02495538629591465, 0.01604088395833969, -0.03779853507876396, -0.0015499226283282042, -0.014187502674758434, 0.04988466948270798, 0.006408522371202707, -0.01818140782415867, 0.0008394054602831602, 0.013352176174521446, -0.004447462037205696, 0.016641274094581604, 0.01356100756675005, 0.015988675877451897, 0.0175157580524683, -0.010552526451647282, 0.03189903870224953, 0.0071785892359912395, -0.014109190553426743, -0.022736549377441406, -0.001948008080944419, -0.007426576688885689, 0.02094842866063118, -0.008483787067234516, -0.04260166361927986, -0.03547528386116028, 0.022410249337553978, 0.016184454783797264, 0.03500540927052498, -0.011909931898117065, -0.023637136444449425, 0.03604957088828087, 0.03967801854014397, -0.02965409867465496, 0.0007986180135048926, 0.050093501806259155, -0.04649115353822708, 0.008209695108234882, 0.016628222540020943, -0.015218609012663364, 0.034065667539834976, 0.0024097219575196505, 0.0096062570810318, -0.009534471668303013, 0.018625175580382347, 0.0434630922973156, -0.004274523351341486, 0.017567966133356094, -0.036571647971868515, 0.024890126660466194, -0.01909504644572735, -0.017881212756037712, 0.025908181443810463, 0.029706306755542755, 0.008000863716006279, 0.022344989702105522, 0.028296692296862602, -0.03544917702674866, -0.010624311864376068, 0.015962570905685425, 0.010350219905376434, 0.01390035916119814, 0.00457471888512373, 0.005103324074298143, -0.013600163161754608, -0.005253422074019909, 0.03631060943007469, -0.022723497822880745, 0.00683923764154315, -0.0020605814643204212, 0.02312810905277729, 0.012223179452121258, 0.009978238493204117, 0.010258856229484081, 0.02988903410732746, 0.02414616383612156, 0.009430055506527424, -0.039312563836574554, 0.008222747594118118, -0.012823570519685745, -0.03033280186355114, 0.00914943777024746, 0.020295828580856323, -0.03182072937488556, 0.005455727688968182, 0.03722424805164337, -0.0004364255873952061, 0.015061984769999981, -0.007896448485553265, -0.031115921214222908, 0.030541634187102318, 0.03309982270002365, 0.005047853570431471, -0.018390240147709846, 0.020817909389734268, 0.004659556783735752, -0.008777456358075142, -0.0071785892359912395, 4.8052701458800584e-05, 0.019055891782045364, 0.011446586810052395, -0.0018240142380818725, -0.026130065321922302, -0.019290827214717865, 0.015075037255883217, 0.03740697354078293, -0.015075037255883217, -0.012001295574009418, 0.020778752863407135, -0.0022188366856426, 0.01661517098546028, 0.01797257736325264, -0.030541634187102318, -0.01681094989180565, 0.01923861913383007, 0.022579925134778023, 0.05403519794344902, -0.007942129857838154, -0.0240156427025795, -0.002073633251711726, -0.04602128267288208, -0.027879029512405396, -0.008947132155299187, -0.015845103189349174, 0.006229057442396879, -0.019512711092829704, -0.031168129295110703, 0.03356969356536865, 0.016314975917339325, 0.013378279283642769, 0.012327595613896847, 0.011002819053828716, 0.014526854269206524, 0.030071763321757317, 0.050981033593416214, 0.019943425431847572, -0.00523384427651763, -0.007348265033215284, -0.023676292970776558, 0.022149210795760155, -0.012784414924681187, -0.0007733298116363585, 0.008111805655062199, -0.01661517098546028, 0.04361971840262413, 0.0029954295605421066, 0.011864249594509602, 0.010663467459380627, 0.0556536428630352, 0.004398517310619354, -0.01912115141749382, 0.004943437408655882, 0.03273436799645424, -0.024877075105905533, -0.060822226107120514, -0.024185318499803543, 0.03615398705005646, -0.0004829232639167458, -4.1756138671189547e-05, -0.0501457080245018, 0.026612987741827965, 0.007276479154825211, -0.037145934998989105, 0.015309972688555717, 0.016628222540020943, -0.0034685637801885605, 0.005514461547136307, -0.01878179982304573, 0.02323252521455288, 0.003958012908697128, -0.017098093405365944, 0.018977578729391098, -0.01132259238511324, -0.049284275621175766, 0.009390899911522865, -0.03735476732254028, -0.013469643890857697, -0.011296489275991917, 0.0023787233512848616, 0.010441584512591362, -0.00039319091592915356, 0.014787893742322922, -0.0066630360670387745, -0.014957569539546967, 0.01356100756675005, -0.015584064647555351, 0.014161398634314537, -0.028818773105740547, -0.014539905823767185, 0.005348049104213715, -0.031089816242456436, 0.013887306675314903, -0.008483787067234516, -0.010911455377936363, 0.012856200337409973, 0.028923187404870987, 0.03307371959090233, 0.009116807952523232, -0.011231228709220886, 0.017581017687916756, -0.00563519261777401, 0.019421346485614777, 0.04730037599802017, -0.04304543137550354, -0.01760712079703808, -0.00027490733191370964, 0.015584064647555351, 0.01540133636444807, 0.018964527174830437, 0.00047843664651736617, -0.01254295278340578, 0.015714583918452263, 0.0280617568641901, 0.029680203646421432, 0.014331074431538582, -0.016106143593788147, 0.015727635473012924, 0.0008883504197001457, -0.010422006249427795, 0.007152485195547342, -0.022697392851114273, 0.004307153634727001, 0.02667824737727642, 0.027174223214387894, 0.018599072471261024, -0.03320423886179924, -0.0052991039119660854, 0.004659556783735752, 0.03137696161866188, 0.011133339256048203, -0.005847287364304066, 0.009090703912079334, -0.008066123351454735, 0.02333694137632847, 0.016314975917339325, -0.03571021929383278, -0.006627142895013094, -0.008659988641738892, -0.008177065290510654, 0.004933648742735386, -0.0058309719897806644, 0.027905134484171867, -0.01647159829735756, 0.028531629592180252, 0.00956057570874691, 0.039547499269247055, 0.040017370134592056, -0.013117239810526371, 0.011035448871552944, -0.012888830155134201, 1.4938399544917047e-05, -0.006943653337657452, 0.008940606378018856, 0.019434398040175438, -0.006212742533534765, 0.018481604754924774, 0.009632361121475697, 0.008046546019613743, 0.022136159241199493, 0.017894264310598373, 0.0240156427025795, 0.0046530310064554214, -0.03941697999835014, 0.020765701308846474, -0.011544476263225079, -0.013469643890857697, 0.002553293714299798, 0.0007015439332462847, 0.00899281445890665, 0.021366091445088387, 0.0003925790952052921, -0.01254295278340578, -0.027539677917957306, -0.004933648742735386, -0.009952135384082794, 0.0013027507811784744, -0.010160966776311398, 0.020909272134304047, 0.008509891107678413, -0.027983445674180984, -0.00898628868162632, 0.013704579323530197, -0.018037836998701096, 0.014448542147874832, 0.019734594970941544, 0.006773977540433407, 0.017685433849692345, -0.032682158052921295, -0.0011265490902587771, -0.020452452823519707, 0.002726232400164008, -0.029915139079093933, 0.0172808226197958, -0.007380894850939512, -0.03591904789209366, 0.038973212242126465, 0.016915366053581238, 0.016093092039227486, -0.01614530012011528, 0.0058962320908904076, 0.012125289998948574, -0.011583632789552212, 0.014226658269762993, 0.001245648367330432, -0.019852062687277794, 0.06990640610456467, 0.0005436965730041265, -0.007968233898282051, -4.5401517127174884e-05, -0.030123969539999962, 0.050641681998968124, -0.02345440909266472, -0.0014781367499381304, -0.023963436484336853, 0.02277570590376854, 0.012451589107513428, 0.022005638107657433, -0.013378279283642769, -0.024864021688699722, 0.002781703369691968, -0.011250806972384453, 0.006323684472590685, 0.028766565024852753, 0.014644321985542774, 0.04341088607907295, 0.015022829174995422, 0.026834871619939804, 0.018847059458494186, -0.02941916324198246, 0.014096138998866081, 0.01604088395833969, 0.005958228837698698, 0.001415324048139155, 0.02118336409330368, 0.04223620891571045, 0.009488789364695549, -0.03067215345799923, -0.05664559453725815, 0.031063713133335114, -0.026012595742940903, 0.007798558101058006, -0.03706762567162514, 0.03328254818916321, -0.007609304506331682, 0.011988244019448757, 0.012941038236021996, -0.015061984769999981, 0.00015132139378692955, 0.0027017598040401936, -0.007100277114659548, 0.014696530066430569, -0.00011063592683058232, 0.013887306675314903, -0.006121378857642412, 0.025960389524698257, 0.0012970404932275414, -0.03150748088955879, 0.006503148935735226, -0.013717630878090858, -0.002262887079268694, 0.007139433175325394, -0.008366319350898266, 0.058107417076826096, 0.0008704039501026273, 0.01855991594493389, -0.025007594376802444, -0.0009943977929651737, -0.010572103783488274, -0.005795079283416271, -0.005272999871522188, -0.028688251972198486, -0.01762017421424389, -0.01729387417435646, 0.010141388513147831, 0.04716985672712326, -0.03798126429319382, 0.0172808226197958, -0.013286915607750416, 0.0019039575709030032, 0.007139433175325394, 0.009645413607358932, -0.00979551114141941, 0.010219700634479523, 0.007896448485553265, 0.03270826116204262, -0.015884259715676308, 0.006428100168704987, -0.022697392851114273, 0.01993037387728691, 0.013352176174521446, 0.022279730066657066, 0.03286488726735115, -0.004281049594283104, -0.04730037599802017, 0.02887098118662834, -0.006496623158454895, 0.005383941810578108, 0.05309545621275902, 0.026860974729061127, -0.011596684344112873, -0.014200554229319096, -0.0022400461602956057, 0.014291917905211449, 0.008483787067234516, 0.012464640662074089, -0.012386329472064972, -0.008705670945346355, 0.0013215129729360342, 0.003556664567440748, -0.025151165202260017, 0.03685879334807396, -0.033256445080041885, -0.0036415024660527706, 0.012157919816672802, 0.013025876134634018, -0.0024586666841059923, -0.0020328459795564413, 0.028140069916844368, 0.01901673525571823, -0.0011379695497453213, 0.03262995183467865, 0.0012888830387964845, 0.027852926403284073, 0.013613215647637844, -0.023154212161898613, 0.02551662176847458, -0.010800513438880444, 0.026234479621052742, -0.0010417111916467547, -0.003987379837781191, 0.013887306675314903, 0.0065325163304805756, 0.0004133806796744466, 0.0002869396412279457, 0.015296921133995056, -0.006477045360952616, -0.008620833046734333, 0.004594297148287296, -0.008973236195743084, 0.0005877469666302204, 0.024185318499803543, 0.005106587428599596, -0.009488789364695549, -0.004144003614783287, -0.0029595366213470697, 0.013508799485862255, 0.028453316539525986, -0.0015956045826897025, 0.04839674383401871, -0.01810309663414955, -0.02211005426943302, 0.015766791999340057, -0.03962581232190132, 0.04317595064640045, 0.010983241721987724, 0.005015223287045956, 0.025895128026604652, 0.004281049594283104, 0.03466605767607689, 0.019277775660157204, -0.013835098594427109, 0.007100277114659548, -0.027043703943490982, -0.00032058925717137754, -0.016889262944459915, 0.013169447891414165, -0.007942129857838154, -0.0034848786890506744, 0.013743734918534756, 0.03821619972586632, -0.030045658349990845, -0.03135085478425026, 0.009123333729803562, 0.005517724435776472, 0.017215561121702194, 0.002753967884927988, 0.018455499783158302, -0.017032833769917488, -0.01437023002654314, 0.012803992256522179, -0.018729591742157936, -0.016510754823684692, -0.02289317362010479, -0.022057846188545227, 0.005149006377905607, -0.028296692296862602, -0.01379594299942255, 0.0032124186400324106, -0.019969530403614044, -0.00609201192855835, 0.00523384427651763, 0.013175973668694496, 0.009625835344195366, -0.00489449268206954, -0.019421346485614777, -0.00045274055446498096, -0.010728728026151657, 0.04466387629508972, 0.006134430877864361, 0.01046768855303526, 0.018455499783158302, 0.01200782135128975, 0.02324557676911354, 0.034613851457834244, 0.021679339930415154, 0.004186422564089298, -0.009188594296574593, 0.01047421433031559, -0.00042296573519706726, -0.02803565375506878, 0.007224271073937416, 0.007668038364499807, 0.013717630878090858, 0.003977591171860695, -0.006529252976179123, -0.023859020322561264, -0.025725452229380608, 0.02439415082335472, 0.010683045722544193, 0.02769630216062069, -0.0029579049441963434, -0.0014968989416956902, 0.022606030106544495, -0.047926872968673706, -0.003329886356368661, -0.0069567053578794, -0.002970956964418292, 0.010428532026708126, -0.0001491800503572449, -0.007237323094159365, 0.02243635430932045, 0.0386599637567997, 0.01036327239125967, 0.00262018502689898, -0.007831187918782234, 0.012621264904737473, -0.018964527174830437, 0.007322160992771387, -0.005113113205879927, 0.0027474418748170137, -0.0033869887702167034, -0.00788992177695036, -0.008490312844514847, -0.007935604080557823, -0.0056025623343884945, -0.04529036954045296, 0.03202955797314644, -0.006587986834347248, 0.020191414281725883, -0.03155968710780144, 0.08348046243190765, 0.029810722917318344, 0.013202077709138393, -0.03717203810811043, 0.01764627732336521, -0.0017799638444557786, 0.02816617302596569, -0.021822910755872726, -0.054766107350587845, 0.021888170391321182, -0.05004129186272621, -0.011368274688720703, -0.009162490256130695, -0.02678266353905201, 0.010069603100419044, -0.018481604754924774, -0.021888170391321182, 0.009390899911522865, 0.01866433210670948, -0.056854426860809326, 0.04589076340198517, -0.027774613350629807, 0.01567542739212513, 0.021548818796873093, -0.008333689533174038, -0.0034424597397446632, 0.024472462013363838, 0.007093751337379217, -0.01577984355390072, 3.456735430518165e-05, 0.02175765112042427, 0.026038700714707375, 0.016889262944459915, 0.021718494594097137, -0.03881658986210823, 0.022044794633984566, -0.006333473604172468, -0.02462908625602722, -0.0005991674843244255, -0.016536859795451164, 0.007446154486387968, -0.029210330918431282, -0.015414388850331306, 0.006976283621042967, -0.005423097871243954, -0.027330847457051277, 0.005237107165157795, -0.0011404167162254453, -0.039443083107471466, -0.005589510314166546, 0.003683921415358782, 0.010167492553591728, -0.03189903870224953, -0.023088952526450157, 0.020543817430734634, -0.0035109827294945717, -0.01638023555278778, 0.011074605397880077, 0.019525762647390366, 0.022827913984656334, 0.042862702161073685, -0.006248635705560446, 0.05915157496929169, -0.02016530930995941, 0.035423073917627335, 0.01333912368863821, 0.018964527174830437, 0.00040970981353893876, 0.013978671282529831, 0.0126538947224617, 0.026234479621052742, -0.003971064928919077, 0.006865341681987047, -0.03137696161866188, 0.017711536958813667, 0.009058074094355106, -0.019643230363726616, 0.012445063330233097, -0.0010009236866608262, -0.025098957121372223, -0.011035448871552944, -0.021901221945881844, 0.04074828326702118, 0.009227749891579151, 0.001845223712734878, 0.02256687358021736, -0.01200782135128975, 0.018494656309485435, 0.024994542822241783, -0.02221447043120861, 0.017124198377132416, 0.0057167671620845795, 0.016393287107348442, 0.03899931535124779, -0.027383053675293922, -0.027043703943490982, 0.010839669965207577, 0.0033184660132974386, 0.00033466093009337783, -0.01604088395833969, 0.0034326708409935236, 0.02887098118662834, 0.036806583404541016, 0.004068954847753048, 0.008229273371398449, 0.03563190624117851, 0.0381900928914547, 0.020100049674510956, -0.007243848871439695, 0.010578629560768604, 0.021470507606863976, 0.0029056970961391926, -0.029732411727309227, -0.030254490673542023, -0.008823138661682606, -0.05291272699832916, -0.0024847707245498896, 0.01934303529560566, 0.013299968093633652, 0.008679566904902458, 0.019525762647390366, -0.006229057442396879, -0.004385465290397406, -0.01752880960702896, -0.03860775753855705, 0.003235259559005499, 0.026704352349042892, 0.004793339874595404, 0.02542525716125965, -0.026169219985604286, -0.01195561420172453, -0.029262538999319077, -0.01550575252622366, 0.013195551931858063, -0.029915139079093933, 0.009939082898199558, -0.018246667459607124, 0.01671958714723587, -0.04278439283370972, -0.005827709101140499, 0.013978671282529831, -0.018742643296718597, 0.023545771837234497, -0.01025233045220375]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" in Neural Information Processing Systems , 35:11063–11078.
Langford, J. and Zhang, T. (2007). The epoch-greedy algorithm for multi-armed bandits with side informa-
tion. Advances in neural information processing systems , 20.
Lee, K., Liu, H., Ryu, M., Watkins, O., Du, Y., Boutilier, C., Abbeel, P., Ghavamzadeh, M., and Gu, S. S.
(2023). Aligning text-to-image models using human feedback. arXiv preprint arXiv:2302.12192 .
Li, Z., Xu, T., and Yu, Y. (2023a). Policy optimization in rlhf: The impact of out-of-preference data. arXiv
preprint arXiv:2312.10584 .
Li, Z., Xu, T., Zhang, Y., Yu, Y., Sun, R., and Luo, Z.-Q. (2023b). Remax: A simple, effective, and efficient
reinforcement learning method for aligning large language models. arXiv e-prints , pages arXiv–2310.
Li, Z., Yang, Z., and Wang, M. (2023c). Reinforcement learning with human feedback: Learning dynamic
choices via pessimism. arXiv preprint arXiv:2305.18438 .
Liu, T., Zhao, Y., Joshi, R., Khalman, M., Saleh, M., Liu, P. J., and Liu, J. (2023a). Statistical rejection
sampling improves preference optimization. arXiv preprint arXiv:2309.06657 .
Liu, Z., Lu, M., Xiong, W., Zhong, H., Hu, H., Zhang, S., Zheng, S., Yang, Z., and Wang, Z. (2023b).
Maximize to explore: One objective function fusing estimation, planning, and exploration. In Thirty-
seventh Conference on Neural Information Processing Systems .
Michaud, E. J., Gleave, A., and Russell, S. (2020). Understanding learned reward functions. arXiv preprint
arXiv:2012.05862 .
Nakano, R., Hilton, J., Balaji, S., Wu, J., Ouyang, L., Kim, C., Hesse, C., Jain, S., Kosaraju, V., Saunders,
W., et al. (2021). Webgpt: Browser-assisted question-answering with human feedback. arXiv preprint
arXiv:2112.09332 .
Neumann, V. (1951). Various techniques used in connection with random digits. Notes by GE Forsythe ,
pages 36–38.
Novoseller, E., Wei, Y., Sui, Y., Yue, Y., and Burdick, J. (2020). Dueling posterior sampling for preference-
based reinforcement learning. In Conference on Uncertainty in Artificial Intelligence , pages 1029–1038.
PMLR.
OpenAI (2023). Gpt-4 technical report. ArXiv , abs/2303.08774.
Ouyang, L., Wu, J., Jiang, X., Almeida, D., Wainwright, C., Mishkin, P., Zhang, C., Agarwal, S., Slama, K.,
Ray, A., et al. (2022). Training language models to follow instructions with human feedback. Advances in
Neural Information Processing Systems , 35:27730–27744.
28
Pacchiano, A., Saha, A., and Lee, J. (2021). Dueling rl: reinforcement learning with trajectory preferences.
arXiv preprint arXiv:2111.04850 .
Rafailov, R., Sharma, A., Mitchell, E., Ermon, S., Manning, C. D., and Finn, C. (2023). Direct preference
optimization: Your language model is secretly a reward model. arXiv preprint arXiv:2305.18290 .
Rashidinejad, P., Zhu, B., Ma, C., Jiao, J., and Russell, S. (2021). Bridging offline reinforcement learning and
imitation learning: A tale of pessimism. Advances in Neural Information Processing Systems , 34:11702–
11716.
Rusmevichientong, P. and Tsitsiklis, J. N. (2010). Linearly parameterized bandits. Mathematics of Opera-
tions Research , 35(2):395–411.
Russo, D","[-0.04436011239886284, 0.012937203980982304, 0.04642337188124657, -0.0005968470359221101, 0.017955947667360306, -0.0062316060066223145, -0.016798848286271095, 0.049574028700590134, -0.020730197429656982, 0.02262616530060768, 0.02227764204144478, -0.06513213366270065, -0.002854410093277693, 0.005280135665088892, 0.025930171832442284, -0.045335978269577026, 0.02418755367398262, -0.04260355234146118, 0.025902289897203445, 0.03529849275946617, -0.024926424026489258, -0.02466154471039772, -0.028997180983424187, 0.020325908437371254, -0.004311239812523127, -0.008266984485089779, 0.026376282796263695, 0.06401685625314713, -0.010351157747209072, -0.03886737674474716, 0.02350444532930851, -0.03267759457230568, -0.04031723365187645, -0.018485702574253082, -0.050968121737241745, 0.0112294377759099, 0.03304005786776543, 0.0077720810659229755, -0.011159732937812805, 0.017955947667360306, -0.007409616373479366, -0.06580130010843277, 0.007786022033542395, 0.042854487895965576, -0.030000930652022362, 0.03655317798256874, 0.021692123264074326, -0.020897487178444862, 0.002850924851372838, 0.054369714111089706, -0.06429567188024521, 0.024466371163725853, -0.047705940902233124, -0.03797515481710434, 0.004213653039187193, 0.0035322888288646936, 0.025623470544815063, 0.019336100667715073, 0.03532637283205986, -0.011382787488400936, -0.016255151480436325, -0.042408376932144165, 0.01214256975799799, 0.026264755055308342, -0.016603674739599228, -0.042575668543577194, -0.08124787360429764, 0.018806345760822296, -0.0071517089381814, 0.025498002767562866, -0.0017007961869239807, -0.024326961487531662, 0.029945166781544685, -0.00013832039257977158, -0.015446575358510017, 0.022709811106324196, 0.04246414080262184, 0.08715883642435074, 0.0015091081149876118, -0.041934385895729065, -0.01144552230834961, -0.02326744981110096, 0.004063787870109081, -0.06435143947601318, -0.04951826483011246, -0.042241085320711136, -0.026097463443875313, -0.023323213681578636, -0.019015459343791008, 1.6500423953402787e-05, -0.02010285295546055, -0.010023544542491436, -0.03797515481710434, 0.01353666465729475, 0.02099507488310337, 0.00959834549576044, -0.001916880952194333, 0.002878806786611676, 0.03892314061522484, 0.018262647092342377, -0.043467890471220016, -0.03903466835618019, 0.012086805887520313, -0.014289476908743382, 0.020562905818223953, -0.004189256113022566, -0.0039522601291537285, 0.018025651574134827, 0.0025128566194325686, -0.014819232746958733, -0.10550513118505478, 0.000942756945732981, -0.05961151421070099, 0.027324266731739044, 0.01268626656383276, -0.04187862202525139, -0.050968121737241745, -0.018123239278793335, 0.0012119915336370468, -0.013787602074444294, -0.02894141711294651, -0.012832647189497948, 0.016617614775896072, -0.01146643329411745, 0.011145791970193386, -0.009479847736656666, 0.028132842853665352, -0.08381300419569016, 0.009549552574753761, -0.014219772070646286, -0.012184392660856247, 0.02863471768796444, 0.010546330362558365, -0.05428607016801834, -0.05133058875799179, -0.0030792078468948603, 0.022542521357536316, -0.005973698105663061, -0.03178537264466286, -0.02350444532930851, 0.006346618756651878, -0.010901824571192265, -0.06228817626833916, 0.0006460760487243533, -0.08420335501432419, -0.006398897152394056, -0.01936398260295391, 0.0105811832472682, -0.03234301134943962, -0.009605316445231438, 0.015530221164226532, 0.026515692472457886, -0.02310015819966793, 0.011361876502633095, -0.036190714687108994, -0.05138635262846947, -0.04402552917599678, 0.04979708418250084, 0.008538833819329739, -0.05289197340607643, 0.02669692412018776, 0.05883082002401352, -0.001993556274101138, -0.017244959250092506, 0.03733387216925621, 0.0005850843735970557, -0.019085165113210678, 0.03747327998280525, -0.03184113651514053, -0.010748474858701229, 0.036162830889225006, 0.014749527908861637, -0.034768734127283096, -0.03172960877418518, -0.006388441659510136, -0.017007961869239807, -0.009842312894761562, -0.01061603520065546, -0.014638000167906284, -0.060113389045000076, 0.013404225930571556, -0.006702112965285778, -0.030474921688437462, 0.02503795176744461, -0.019503392279148102, 0.0031523979268968105, -0.03766845539212227, -0.012065894901752472, -0.006377985700964928, 0.06496483832597733, 0.038978904485702515, 0.05495523661375046, 0.04993649199604988, 0.006308280862867832, -0.020674433559179306, -0.03359769657254219, 0.04742712154984474, -0.0007149094599299133, -0.016227269545197487, -0.018388116732239723, 0.0023839029017835855, 0.0427987240254879, -0.013355433009564877, -0.051274824887514114, 0.017942005768418312, -0.021664241328835487, 0.004307754337787628, 0.00445761950686574, -0.04511292278766632, -0.01318117044866085, 0.03312370181083679, 0.005391663406044245, 0.04898850619792938, -0.022444933652877808, -0.04622820019721985, -0.01657579280436039, -0.010880913585424423, 0.015362929552793503, -0.009145264513790607, 0.0409027561545372, 0.0038442176301032305, 0.0007719802670180798, 0.014526472426950932, 0.003016473725438118, -0.009305586107075214, 0.04360729828476906, 0.02877412550151348, -0.011173673905432224, 0.051414232701063156, -0.022361287847161293, 0.05977880582213402, -0.0013461732305586338, -0.011912544257938862, -0.010846061632037163, -0.0026749202515929937, -0.004332151263952255, 0.008280925452709198, -0.026013817638158798, 0.016561850905418396, -0.057827070355415344, 0.013871247880160809, 0.026445986703038216, 0.031199852004647255, -0.013669104315340519, 0.02194305881857872, 0.04159980267286301, -0.03281700238585472, -0.017370427027344704, -0.0038163356948643923, 0.007827844470739365, 0.0006992259295657277, -0.004687645472586155, 0.00029079956584610045, -0.024173611775040627, -0.018666936084628105, -0.020298026502132416, -0.015585985034704208, 0.03172960877418518, -0.02350444532930851, -0.012288949452340603, -0.03557731211185455, 0.020744137465953827, -0.00426244642585516, 0.02513553760945797, -0.002408299595117569, -0.0030269294511526823, -0.03379286825656891, 0.017063725739717484, 0.0013034790754318237, -0.03387651592493057, -0.01334846206009388, -0.004914185963571072, -0.03797515481710434, 0.05102388560771942, -0.047678057104349136, -0.04695312678813934, 0.03033551387488842, 0.04620031639933586, -0.059053875505924225, 0.005217401310801506, -0.016994021832942963, 0.023532327264547348, 0.05855200067162514, -0.0009636683389544487, 0.019029401242733, 0.006524365860968828, -0.007946343161165714, -0.017398308962583542, -0.036330122500658035, -0.007974225096404552, -0.02300257235765457, -0.05146999657154083, 0.012003160081803799, -0.06909136474132538, 0.05660026893019676, 0.01865299418568611, 0.03423897922039032, -0.018639054149389267, 0.018597230315208435, -0.028244370594620705, 0.032761238515377045, -0.02537253312766552, -0.022096410393714905, 0.00479917274788022, 0.018639054149389267, 0.03284488618373871, -0.022974690422415733, 0.0191548690199852, 0.022514639422297478, -0.011557050049304962, -0.006608011666685343, 0.031171970069408417, -0.018694818019866943, 0.015809040516614914, -0.04809628799557686, -0.051553644239902496, 0.06167477369308472, -0.022681929171085358, 0.029973048716783524, -0.02751944027841091, -0.021524831652641296, -0.02241705171763897, 0.014972583390772343, 0.028453484177589417, 0.003966201096773148, 0.0032133895438164473, 0.034015923738479614, -0.0075141736306250095, -0.008043929934501648, -0.007932402193546295, 0.03225936368107796, 0.0009680248913355172, -0.004370488692075014, 0.00410212529823184, -0.006057343911379576, -0.02676662988960743, -0.0245918408036232, 0.0527246817946434, 0.029499055817723274, -0.006332677789032459, -0.08236315101385117, -0.01012113131582737, -0.043467890471220016, -0.020883547142148018, -0.04093063622713089, 0.0071168565191328526, -0.015209578908979893, 0.028244370594620705, 0.031673844903707504, 0.03956442326307297, -0.004614455159753561, -0.02894141711294651, 0.022988630458712578, 0.010128102265298367, -0.03660894185304642, 0.011612813919782639, -0.0014864540426060557, -0.027700673788785934, -0.043021779507398605, 0.0088664460927248, -0.004258960951119661, 0.008085752837359905, 0.016087859869003296, -0.01884816773235798, 0.0164363831281662, 0.006517395377159119, -0.01228197943419218, -0.01304176077246666, -0.002368219429627061, -0.015599926002323627, 0.012609591707587242, 0.02986152097582817, -0.07706558704376221, -0.008127575740218163, -0.016464265063405037, -0.0059005082584917545, -0.006660290062427521, 0.02581864409148693, 0.01776077412068844, 0.013243905268609524, -0.023365037515759468, 0.019810093566775322, 0.0068345521576702595, -0.036497414112091064, 0.02296074852347374, 0.03376498818397522, -0.023044394329190254, -0.004949038382619619, -0.017746832221746445, -0.01976827159523964, -0.0034190185833722353, -0.014568295329809189, -0.04187862202525139, 0.0043495772406458855, 0.004715527407824993, 0.01898757740855217, -0.008824623189866543, 0.0209253691136837, 0.03440627083182335, 0.028523189947009087, -0.01967068389058113, 0.009605316445231438, -0.033820752054452896, 0.003645559074357152, -0.022138232365250587, 0.01953127421438694, 0.0024640634655952454, 0.06373803317546844, 0.00597021309658885, 0.03646953031420708, 0.05317079275846481, -0.05133058875799179, 0.013167229481041431, -0.05333808436989784, 0.020465318113565445, -0.03738963603973389, 0.026724806055426598, -0.03172960877418518, 0.04781746864318848, 0.08219585567712784, 0.004136977717280388, 0.0102256890386343, 0.009277704171836376, -0.039006784558296204, -0.03209207206964493, 0.019949503242969513, 0.023560209199786186, -0.02747761830687523, 0.056405093520879745, -0.046590663492679596, 0.0005389049765653908, 0.021427243947982788, 0.03984324261546135, -0.03922984004020691, -0.02969422936439514, -0.024675486609339714, 0.05866352841258049, 0.015516280196607113, -0.02234734781086445, -0.055011000484228134, 0.05057777464389801, -0.02160847745835781, -0.06251122802495956, 0.031534433364868164, 0.0024326962884515524, 0.0012477152049541473, -0.03295641392469406, 0.03652529418468475, -0.0032674106769263744, -0.035410020500421524, -0.00025572936283424497, 0.006262972950935364, 0.05634932965040207, 0.002673177747055888, -0.00255990750156343, -0.023183804005384445, 0.10076520591974258, -0.015920568257570267, 0.02367173694074154, 0.011717370711266994, 0.009786549024283886, 0.0067055984400212765, -0.01404550950974226, -0.002465805970132351, 0.017412248998880386, 0.02506583370268345, -0.006806670222431421, 0.01078332681208849, 0.0001659844710957259, -0.011187614873051643, -0.003025186713784933, -0.03278912231326103, -0.0010246600722894073, -0.03423897922039032, -0.019280336797237396, -0.002720228396356106, -0.005499705672264099, -0.02584652602672577, -0.014944701455533504, -0.000398624106310308, 0.0036246476229280233, -0.018764521926641464, 0.018694818019866943, 0.03421109914779663, 0.04974132031202316, 0.04310542717576027, 0.0027132579125463963, -0.016701260581612587, -0.017342545092105865, 0.004558691289275885, -0.002640067832544446, -0.005788980517536402, 0.027017565444111824, -0.015836922451853752, 0.005475309211760759, -0.02625081315636635, 0.040066298097372055, -0.025010069832205772, -0.013494841754436493, -0.021747885271906853, 0.012065894901752472, -0.02452213503420353, -0.01725889928638935, 0.02969422936439514, -0.021343598142266273, -0.00839245319366455, 0.027491558343172073, 0.0008665173663757741, 0.013766691088676453, 0.05213916301727295, -0.013822454959154129, -0.01851358450949192, -0.024062084034085274, 0.03627435863018036, 0.018429938703775406, 0.03418321534991264, -0.048152051866054535, -0.038198210299015045, -0.015070170164108276, 0.04717618227005005, -0.0023699619341641665, -0.024717308580875397, -0.005165122915059328, -0.013104495592415333, 0.03387651592493057, -0.0029502541292458773, -0.019280336797237396, -0.062455467879772186, -0.020841723307967186, -0.005077992100268602, 0.027505500242114067, -0.00480614323168993, 0.03209207206964493, 0.009187087416648865, -0.03251030296087265, 0.01884816773235798, -0.014484649524092674, -0.03761269152164459, -0.029973048716783524, 0.00911738257855177, -0.005778525024652481, -0.006064314395189285, -0.007312029600143433, 0.02724062092602253, -0.0031471699476242065, -0.031367141753435135, 0.03142290562391281, -0.034434154629707336, 0.0020353791769593954, 0.027421854436397552, 0.04338424652814865, -0.03766845539212227, -0.01319511141628027, 0.00317156664095819, -0.023086218163371086, -0.012783853337168694, 0.005116329528391361, -0.00579943647608161, 0.033848632127046585, 0.005025713238865137, -0.0058865672908723354, -0.03203630819916725, -0.011187614873051643, 0.025525884702801704, -0.028411662206053734, -0.004928126931190491, 0.014373121783137321, -0.03256606683135033, 0.027435794472694397, 0.01379457302391529, -0.015948450192809105, 0.03161808103322983, 0.033374641090631485, -0.034294743090867996, 0.02194305881857872, -0.005203460808843374, -0.0105811832472682, -0.0035009216517210007, -0.007305059116333723, 0.04355153441429138, -0.04168344661593437, -0.033848632127046585, -0.008490039967000484, 9.704210242489353e-05, -0.03496390953660011, 0.011543109081685543, 0.0031471699476242065, 0.016701260581612587, -0.03538213670253754, 0.032900650054216385, 0.047399237751960754, -0.05336596816778183, -0.03097679652273655, -0.013404225930571556, -0.0394807793200016, -0.009584404528141022, -0.015056229196488857, -0.0020475774072110653, 0.000988936284556985, 0.0359397754073143, 0.015098052099347115, -0.004569147247821093, -0.004464589990675449, -0.017983829602599144, 0.00047791327233426273, 0.019614920020103455, -0.011501286178827286, 0.013243905268609524, 0.0078626973554492, -0.005123300012201071, 0.013473930768668652, -0.019001519307494164, 0.00633616279810667, -0.02075807936489582, -0.04260355234146118, -0.03646953031420708, -0.026585396379232407, 0.0036560148000717163, 0.029471173882484436, -0.004171830136328936, -0.011522197164595127, -0.012121658772230148, 0.035270608961582184, 0.008322748355567455, -0.010741503909230232, -0.003739660605788231, 0.004238049499690533, -0.017217077314853668, -0.011738281697034836, -0.02139936201274395, -0.013104495592415333, 0.005998095031827688, 0.024577898904681206, 0.011640695855021477, -0.003056553890928626, -0.013432107865810394, -0.00031563188531436026, -0.029025062918663025, 0.02211035043001175, -0.035242728888988495, 0.024842778220772743, 0.011794045567512512, 0.0008277440792880952, -0.01234471332281828, 0.01248412299901247, 0.0009166176314465702, 0.010623006150126457, 0.0055659255012869835, -0.03529849275946617, -0.02506583370268345, -0.03607918694615364, -0.05629356577992439, 0.018527526408433914, -0.01725889928638935, 0.029499055817723274, -0.0023089703172445297, 0.007001843303442001, -0.03067009523510933, 0.015850862488150597, -0.02123207040131092, -0.03761269152164459, 0.008601567707955837, 0.009688962250947952, -0.0009052905952557921, -0.0007423557108268142, 0.025944113731384277, 0.014275535941123962, 0.06412838399410248, 0.01664549671113491, -0.01617150567471981, -0.018402056768536568, 0.0007179590757004917, 0.045503269881010056, -0.005224371794611216, -0.016380619257688522, -0.05400725081562996, 0.02418755367398262, -0.02510765567421913, 5.685294672730379e-05, 0.014038539491593838, -0.01650608703494072, 0.01244927104562521, -0.05264103785157204, -0.04371882602572441, 0.006949564907699823, -0.025010069832205772, 0.024856718257069588, -0.011452492326498032, 0.01586480438709259, 0.0032517272047698498, -0.012965085916221142, 0.0014611860970035195, 0.02652963250875473, -0.004095154814422131, -0.0034033351112157106, 0.033235229551792145, 0.005356810986995697, 0.04388611763715744, -0.03175748884677887, -0.10701075196266174, -0.016520028933882713, 0.036636821925640106, 5.2959283493692055e-05, 0.013766691088676453, -0.020437436178326607, -0.013209052383899689, 0.008364571258425713, 0.021106602624058723, 0.03842126578092575, -0.005872626323252916, -0.01997738517820835, -0.033541932702064514, 0.0036838967353105545, 0.020033149048686028, -0.015753276646137238, 0.012247126549482346, 0.03362557664513588, 0.021747885271906853, 0.0209253691136837, -0.04056817293167114, -0.05989033356308937, -0.00019157917995471507, -0.0021347084548324347, -0.0016615872737020254, -0.004698100965470076, -0.02326744981110096, -0.03931348770856857, -0.013933981768786907, 0.0008390711154788733, 0.01540475245565176, -0.0033040058333426714, -0.0040777288377285, -0.0008804582757875323, -0.01671520248055458, 0.022444933652877808, 0.0170219037681818, -0.04530809447169304, -0.01579509861767292, -0.005924904718995094, 0.015321106649935246, -0.005102388560771942, -0.006280399393290281, -0.019865857437253, 0.027658849954605103, 0.009709873236715794, 0.01830447092652321, 0.021315716207027435, 0.01742619089782238, -0.021720003336668015, 0.002746367594227195, -0.02574894018471241, 0.013696986250579357, 0.021009014919400215, -0.00367344100959599, 0.018471762537956238, -0.02503795176744461, -0.010455714538693428, -0.0323987752199173, -0.01796988770365715, 0.006311766337603331, 0.014003686606884003, 0.017272841185331345, -0.04670219123363495, 0.02068837359547615, 0.0014803549274802208, -0.018123239278793335, -0.02017255872488022, -0.004659763537347317, -0.008197280578315258, 0.0177328921854496, 6.578386819455773e-05, -0.01776077412068844, 0.002894490258768201, 0.005576380994170904, 0.057492487132549286, -0.009507729671895504, 0.017175253480672836, 0.008685213513672352, 0.00633616279810667, 0.001456829602830112, -0.017928065732121468, -0.0066951424814760685, 0.040846992284059525, -0.03596765920519829, -0.018025651574134827, -0.02303045429289341, -0.014679823070764542, -0.019573098048567772, 0.0029432836454361677, -0.029610583558678627, -0.05133058875799179, 0.008573685772716999, 0.015098052099347115, -0.01922457292675972, -0.007786022033542395, 0.03791939094662666, -0.008601567707955837, -0.08319960534572601, -0.02553982473909855, 0.024787014350295067, -0.020423496142029762, 0.008036958985030651, -0.03777998313307762, 0.034768734127283096, 0.02137148007750511, 0.0037117786705493927, -0.04274296015501022, 0.03621859475970268, -0.002141678938642144, 0.012574739754199982, -0.022305523976683617, 0.03465721011161804, -0.045809969305992126, 0.041962265968322754, -0.03764057159423828, 0.05199975520372391, 0.01612968184053898, -0.021246012300252914, 0.0064999694004654884, -0.002537253312766552, 0.028718361631035805, -0.021385421976447105, 0.006402382627129555, 0.02686421573162079, 0.02738003060221672, 0.005098903551697731, 0.02038167230784893, -0.01562780700623989, -0.029749993234872818, 0.01882028579711914, 0.04260355234146118, -0.04014994204044342, 0.010595124214887619, -0.012762942351400852, -0.007646612357348204, -0.008009077049791813, 0.01318117044866085, 0.013250875286757946, -0.045363858342170715, 0.02721273899078369, -0.028997180983424187, 0.03094891458749771, -0.03301217406988144, 0.02310015819966793, -0.030251868069171906, 0.014721645973622799, -0.015376870520412922, 0.05194399133324623, 0.010727562941610813, -0.02910870872437954, -0.006214179564267397, 0.018931813538074493, 0.0038442176301032305, 0.02132965810596943, 0.004516868852078915, 0.02710121124982834, 0.006869404576718807, -0.0197403896600008, 0.017928065732121468, 0.01742619089782238, -0.007960284128785133, -0.008364571258425713, 0.0003276123898103833, -0.0010290165664628148, 0.013104495592415333, -0.0059005082584917545, -0.04946250095963478, -0.0510796494781971, 0.01861117221415043, -0.004293813370168209, 0.03655317798256874, -0.004265931434929371, -0.02839772030711174, 0.033681340515613556, 0.04436011239886284, -0.011215496808290482, 0.0022810883820056915, 0.04929520934820175, -0.05054989457130432, -0.0014428886352106929, 0.018388116732239723, -0.019085165113210678, 0.03301217406988144, 0.010469655506312847, -0.005203460808843374, -0.009152235463261604, 0.03164596110582352, 0.050522010773420334, 0.006074770353734493, 0.016520028933882713, -0.011591902002692223, 0.0056844232603907585, -0.003141942201182246, -0.011766163632273674, 0.023281391710042953, 0.027352148666977882, -0.0018402057467028499, 0.03708293288946152, 0.03610706701874733, -0.05294773727655411, 0.01431735884398222, 0.014986524358391762, 0.0010264026932418346, 0.0017373912269249558, 0.02234734781086445, 0.022598283365368843, -0.0022078983020037413, -0.004032420460134745, 0.03270547464489937, -0.02853712998330593, 0.005457882769405842, 0.011689488776028156, 0.007583878468722105, 0.021427243947982788, 0.03301217406988144, -0.0008294867002405226, 0.0265993382781744, 0.01976827159523964, -0.008497010916471481, -0.025930171832442284, 0.010448743589222431, -0.020256204530596733, -0.03217571973800659, 0.005719275679439306, -0.0016807561041787267, -0.014101273380219936, -0.006301310379058123, 0.0522506907582283, -0.016352737322449684, 0.008364571258425713, 0.0033841661643236876, -0.02598593570291996, 0.02655751444399357, 0.01525140181183815, 0.019963443279266357, -0.04402552917599678, 0.010992441326379776, 0.019810093566775322, -0.006754391361027956, -0.01610179990530014, 0.008824623189866543, -0.0031959633342921734, 0.012679296545684338, 0.01355060562491417, -0.032426655292510986, -0.020256204530596733, 0.011340964585542679, 0.0277843177318573, -0.030056694522500038, 0.010100220330059528, 0.026404164731502533, 0.004377459175884724, 0.012532916851341724, -0.0025790762156248093, -0.04344000667333603, 0.0005297561874613166, 0.006580129731446505, 0.012539886869490147, 0.033820752054452896, 0.0005707077216356993, -0.018778463825583458, 0.017788656055927277, -0.020660491660237312, -0.013982775621116161, -0.02553982473909855, -0.02721273899078369, 0.01790018379688263, -0.010386009700596333, -0.026501750573515892, 0.012525945901870728, 0.026919979602098465, 0.02927600033581257, 0.022640107199549675, 0.0231698639690876, 0.01610179990530014, 0.035242728888988495, 0.040874872356653214, 0.03532637283205986, 0.007277177181094885, -0.018903931602835655, -0.023392919450998306, 0.051888227462768555, -0.026822393760085106, -0.0011004639090970159, 0.016115741804242134, -0.001157099031843245, 0.03465721011161804, 0.009661080315709114, -0.00367344100959599, 0.014157037250697613, 0.05710214376449585, 0.015153815969824791, -0.011041234247386456, 0.014157037250697613, 0.02697574347257614, -0.014484649524092674, -0.04960190877318382, -0.03621859475970268, 0.030223986133933067, -0.008768859319388866, 0.00876188836991787, -0.05972304195165634, 0.04251990467309952, -3.588706022128463e-05, -0.04123733937740326, 0.005255739204585552, 0.015906626358628273, -0.0008691312395967543, 0.006308280862867832, -0.043663062155246735, 0.021664241328835487, -0.007799963001161814, -0.02456395886838436, 0.016729142516851425, -0.01562780700623989, -0.04650701954960823, 0.0012834389926865697, -0.026404164731502533, -0.01837417483329773, -0.016910376027226448, 0.007113371044397354, 0.0015892685623839498, 0.0021434214431792498, 0.0044332230463624, 0.00936134997755289, -0.005266194697469473, 0.019517334178090096, 0.005910963751375675, 0.014101273380219936, -0.033988043665885925, -0.020897487178444862, 0.0047608353197574615, -0.012749001383781433, 0.0028927477542310953, 0.0018070959486067295, 0.011682518757879734, 0.01993556320667267, 0.03147866949439049, 0.018471762537956238, 0.009661080315709114, -0.01353666465729475, 0.024856718257069588, -0.004314724821597338, 0.008441247045993805, 0.03543790057301521, -0.030865268781781197, -0.011780104599893093, 0.004412311594933271, 0.007904520258307457, 0.03847702965140343, 0.021761827170848846, 0.0061444747261703014, -0.026724806055426598, 0.01469376403838396, 0.01617150567471981, 0.036302242428064346, 0.02068837359547615, -0.018332352861762047, 0.017858359962701797, -0.005593807436525822, -0.019001519307494164, 0.00631873682141304, -0.026571456342935562, 0.0037640572991222143, 0.01810929737985134, 0.012742030434310436, 0.02395055629312992, -0.04017782583832741, 0.007071548141539097, -0.0018123238114640117, 0.036190714687108994, 0.004377459175884724, -0.005991124548017979, 0.005691393744200468, -0.019182750955224037, 0.03111620619893074, 0.014958642423152924, -0.021552713587880135, -0.013522723689675331, -0.022291583940386772, -0.017217077314853668, 0.007277177181094885, -0.019726447761058807, 0.011459463275969028, -0.021984882652759552, 0.0446946956217289, 0.01518169790506363, 0.04642337188124657, 0.02863471768796444, -0.00906858965754509, 0.011654636822640896, -0.02714303508400917, -0.005910963751375675, -0.004447164013981819, -0.009249822236597538, 0.03920195996761322, -0.0015840406995266676, 0.033374641090631485, 0.0035514577757567167, 0.01579509861767292, 0.02894141711294651, 0.02300257235765457, 0.022221878170967102, 0.016296973451972008, -0.03448991850018501, -0.0020022692624479532, -0.01042783260345459, -0.0026522662956267595, -0.00617235666140914, 0.01565568894147873, -0.004541265312582254, 0.037250224500894547, -0.007242324762046337, -0.012226215563714504, -0.024536076933145523, -0.006792729254812002, 0.0085109518840909, 0.00026901683304458857, -0.008636420592665672, -0.011375817470252514, 0.018095357343554497, -0.022751634940505028, -0.002688861219212413, 0.012477152980864048, -0.00952864158898592, 0.012818706221878529, 0.009138294495642185, -0.001465542591176927, 0.019308218732476234, -0.010804238729178905, 0.005043139681220055, -0.019001519307494164, -0.015321106649935246, -0.040066298097372055, -0.0019465055083855987, -0.0016014669090509415, -0.03251030296087265, 0.0491836816072464, -0.008734006434679031, 0.02955481968820095, -0.010204777121543884, 0.009842312894761562, 0.0020475774072110653, 0.007242324762046337, 0.024089965969324112, 0.007744199130684137, -0.010337216779589653, 0.07511385530233383, 0.011891632340848446, -0.013738809153437614, -0.007026240229606628, -0.015641748905181885, 0.02924811840057373, -0.012288949452340603, -0.0014437598874792457, -0.012268038466572762, 0.0011239893501624465, 0.011996190063655376, 0.02224976010620594, -0.010692710988223553, -0.004468075465410948, 0.003270895918831229, -0.02714303508400917, -0.0016790134832262993, 0.029777875170111656, 0.00971684418618679, 0.028383780270814896, 0.005980668589472771, 0.06189782917499542, 0.005328929051756859, -0.021190248429775238, 0.012240156531333923, 0.02496824599802494, -0.0007501975051127374, -0.007653582841157913, 0.01827658899128437, 0.05180457979440689, -0.0008521407144144177, -0.028369838371872902, -0.04656278342008591, 0.03370922431349754, -0.03577248379588127, 0.0040184794925153255, -0.03577248379588127, 0.039592307060956955, -0.008950091898441315, -0.005189519841223955, 0.030586449429392815, -0.00651390990242362, -0.006517395377159119, 0.018332352861762047, 0.00014158780686557293, 0.006601041182875633, 0.008155457675457, 0.024159671738743782, 0.006698627956211567, 0.030140340328216553, -0.0029380556661635637, 0.009277704171836376, 0.010037485510110855, -0.007430527824908495, -0.004907215479761362, -0.006601041182875633, -0.025051891803741455, 0.044248584657907486, 0.0018524040933698416, 0.008964032866060734, -0.03574460372328758, 0.02038167230784893, -0.02775643765926361, -0.00684500765055418, 0.02466154471039772, -0.04703677445650101, 0.009201028384268284, -0.0019186235731467605, -0.00479917274788022, 0.040512409061193466, -0.020353790372610092, -0.01047662552446127, -0.007085489109158516, 0.0023351095151156187, 0.014874996617436409, 0.020298026502132416, -0.01593450829386711, 0.010135072283446789, 0.010211748071014881, 0.044248584657907486, -7.411577098537236e-05, 0.0001888563419925049, -0.011891632340848446, 0.016422443091869354, 0.002748110331594944, 0.011752222664654255, 0.016352737322449684, -2.2967175027588382e-05, -0.05565228313207626, 0.01962886191904545, -0.028314074501395226, 0.013425137847661972, 0.044415876269340515, 0.02449425309896469, -0.020507141947746277, -0.005966727621853352, -0.005259224213659763, 0.02849530801177025, 0.012031042017042637, 0.014568295329809189, -0.012874470092356205, -0.007744199130684137, 0.0005707077216356993, 0.007569937501102686, -0.019754329696297646, 0.04274296015501022, -0.028997180983424187, -0.012595650739967823, 0.026445986703038216, 0.015516280196607113, -0.00546136824414134, 0.00476432079449296, 0.031199852004647255, 0.018025651574134827, 0.0072980886325240135, 0.021176306530833244, 0.013369373977184296, 0.017007961869239807, -0.005795951001346111, -0.023727500811219215, 0.01370395626872778, -0.005311503075063229, 0.018081415444612503, -0.0066184671595692635, -0.002999047515913844, 0.012407448142766953, 0.02367173694074154, -0.018555408343672752, 0.003145427443087101, 0.005924904718995094, -0.005820347927510738, -3.3000847906805575e-05, 0.0021503919269889593, 0.007918461225926876, 0.00078984210267663, 0.014428885653614998, -0.0143034178763628, -0.021315716207027435, -0.013327551074326038, -0.004572632256895304, 0.01993556320667267, 0.005551984533667564, 0.0014498591190204024, 0.036497414112091064, -0.01671520248055458, -0.033681340515613556, 0.02272375300526619, -0.02303045429289341, 0.03998265042901039, -0.009500759653747082, -0.006740450393408537, 0.028718361631035805, 0.006879860069602728, 0.031534433364868164, 0.0354657843708992, -0.009486818686127663, 0.007542055565863848, -0.018095357343554497, 0.0037989094853401184, -0.027965551242232323, 0.007249295245856047, -0.02839772030711174, 0.0007262364961206913, 0.011187614873051643, 0.036636821925640106, -0.01657579280436039, -0.019642801955342293, 0.0068240961991250515, 0.0032691534142941236, 0.006461631506681442, 0.006893801037222147, 0.01023963000625372, 0.008971002884209156, 0.0011849809670820832, 0.016603674739599228, -0.015348988585174084, -0.016589732840657234, -0.02830013446509838, -0.009138294495642185, 0.006095681339502335, -0.026306577026844025, -0.007569937501102686, -0.00017970759654417634, -0.016631556674838066, -0.012665355578064919, 0.017133431509137154, 0.0017731148982420564, 0.016520028933882713, -0.01600421406328678, -0.021887294948101044, -0.0011623268947005272, -0.020897487178444862, 0.027630968019366264, 0.003617677139118314, 0.028578953817486763, 0.05160940811038017, 0.001105691771954298, 0.014226742088794708, 0.025693176314234734, 0.02010285295546055, -0.02099507488310337, -0.0020127249881625175, 0.01440100371837616, -0.003722234396263957, -0.014972583390772343, -0.009138294495642185, -0.003784968750551343, 0.0076954057440161705, 0.0070297252386808395, -0.009821400977671146, -0.02520524151623249, -0.015976332128047943, 0.009444995783269405, 0.013362403027713299, 0.03189690038561821, 0.0012633987935259938, 0.00385118811391294, 0.019893739372491837, -0.05325444042682648, 0.023727500811219215, 0.00579943647608161, -0.017774714156985283, -0.0007297217380255461, 0.015390811488032341, -0.013271787203848362, 0.029805757105350494, 0.03379286825656891, -0.006907742004841566, 3.7602450902340934e-05, 0.011264289729297161, -0.001208506291732192, -0.018025651574134827, 0.00549273518845439, 0.012560798786580563, 0.01470770500600338, -0.01076938584446907, -0.003297035349532962, -0.0007933273445814848, -0.00274288235232234, 0.0036072214134037495, -0.03253818303346634, 0.03950865939259529, 0.0016049521509557962, 0.0258883498609066, -0.024550016969442368, 0.08927786350250244, 0.029749993234872818, -0.0006639378843829036, -0.04558691382408142, 0.016324855387210846, 0.0016703003784641623, 0.017914123833179474, -0.02146906778216362, -0.05372843146324158, 0.04497351497411728, -0.05043836683034897, -0.011515227146446705, -0.012693237513303757, -0.0143034178763628, 0.029917284846305847, -0.017133431509137154, -0.03730598837137222, 0.013927011750638485, -0.005520617123693228, -0.02038167230784893, 0.028718361631035805, -0.02615322731435299, 0.014819232746958733, 0.018123239278793335, -0.017788656055927277, -0.008803711272776127, 0.014958642423152924, -0.01858329027891159, -0.017621364444494247, 0.0009566978551447392, 0.022500697523355484, 0.025958053767681122, 0.018597230315208435, 0.013759720139205456, -0.01617150567471981, 0.016798848286271095, -0.02371356077492237, -0.0229328665882349, 0.012895381078124046, 0.005475309211760759, 0.01557204406708479, -0.051581524312496185, -0.012560798786580563, 0.026487810537219048, 0.01107608713209629, -0.019824035465717316, 0.008469128981232643, -0.003962715622037649, -0.03766845539212227, -0.01540475245565176, 0.008922209963202477, -0.0027812200132757425, -0.04324483498930931, -0.013899129815399647, 0.025302829220891, -0.010609065182507038, -0.018388116732239723, 0.019684625789523125, 0.016324855387210846, 0.032426655292510986, 0.031673844903707504, -0.013766691088676453, 0.058105889707803726, -0.020019207149744034, 0.023490505293011665, 0.01107608713209629, 0.014331298880279064, -0.012512004934251308, 0.010650888085365295, 0.01210771780461073, 0.03329099342226982, 0.00022229284513741732, 0.018931813538074493, -0.03920195996761322, 0.019238514825701714, -0.0005323701188899577, -0.006796214263886213, 0.005740187130868435, -0.004691130481660366, -0.018708758056163788, -0.01983797550201416, -0.034294743090867996, 0.030865268781781197, 0.034796617925167084, 0.005384692922234535, 0.02683633379638195, -0.009800489991903305, 0.018834227696061134, 0.025525884702801704, -0.020339850336313248, 0.030893150717020035, 0.005071021616458893, 0.012337743304669857, 0.025288887321949005, -0.01990768127143383, -0.031952664256095886, -0.006883345544338226, 0.0012886668555438519, 0.017621364444494247, 0.005186034366488457, 0.018736639991402626, 0.02615322731435299, 0.020367732271552086, -0.0013749264180660248, 0.005280135665088892, 0.03373710438609123, 0.026808451861143112, 0.01234471332281828, 0.002282830886542797, 0.006196753587573767, 0.023281391710042953, -0.0021904720924794674, -0.02106477878987789, -0.03317946568131447, 0.003002532757818699, -0.04901638999581337, -0.007611759938299656, 0.01905728317797184, 0.0047712912783026695, 0.015432634390890598, 0.015990272164344788, -0.007953313179314137, -0.0067055984400212765, -0.0007623958517797291, -0.05339384824037552, 0.013871247880160809, 0.038226090371608734, 0.02428513951599598, 0.022138232365250587, -0.026878157630562782, -0.02846742607653141, -0.030558567494153976, -0.03016822226345539, 0.008720065467059612, -0.01766318641602993, 0.010190836153924465, -0.020646551623940468, 0.009633198380470276, -0.03998265042901039, 0.02286316268146038, -0.0035357740707695484, -0.009744726121425629, 0.019210632890462875, -0.016757024452090263]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
". and Van Roy, B. (2013). Eluder dimension and the sample complexity of optimistic exploration.
Advances in Neural Information Processing Systems , 26.
Saha, A. (2021). Optimal algorithms for stochastic contextual preference bandits. Advances in Neural
Information Processing Systems , 34:30050–30062.
Schulman, J., Wolski, F., Dhariwal, P., Radford, A., and Klimov, O. (2017). Proximal policy optimization
algorithms. arXiv preprint arXiv:1707.06347 .
Song, Y., Zhou, Y., Sekhari, A., Bagnell, J. A., Krishnamurthy, A., and Sun, W. (2022). Hybrid rl: Using
both offline and online data can make rl efficient. arXiv preprint arXiv:2210.06718 .
Tiapkin, D., Belomestny, D., Calandriello, D., Moulines, E., Naumov, A., Perrault, P., Valko, M., and
Menard, P. (2023). Regularized rl. arXiv preprint arXiv:2310.17303 .
Tien, J., He, J. Z.-Y., Erickson, Z., Dragan, A. D., and Brown, D. S. (2022). Causal confusion and reward
misidentification in preference-based reward learning. arXiv preprint arXiv:2204.06601 .
Touvron, H., Martin, L., Stone, K., Albert, P., Almahairi, A., Babaei, Y., Bashlykov, N., Batra, S., Bhargava,
P., Bhosale, S., et al. (2023). Llama 2: Open foundation and fine-tuned chat models. arXiv preprint
arXiv:2307.09288 .
Tunstall, L., Beeching, E., Lambert, N., Rajani, N., Rasul, K., Belkada, Y., Huang, S., von Werra, L.,
Fourrier, C., Habib, N., et al. (2023). Zephyr: Direct distillation of lm alignment. arXiv preprint
arXiv:2310.16944 .
Uehara, M., Kallus, N., Lee, J. D., and Sun, W. (2024). Offline minimax soft-q-learning under realizability
and partial coverage. Advances in Neural Information Processing Systems , 36.
von Werra, L., Belkada, Y., Tunstall, L., Beeching, E., Thrush, T., Lambert, N., and Huang, S. (2020). Trl:
Transformer reinforcement learning. https://github.com/huggingface/trl .
Wang, C., Jiang, Y., Yang, C., Liu, H., and Chen, Y. (2023a). Beyond reverse kl: Generalizing direct
preference optimization with diverse divergence constraints. arXiv preprint arXiv:2309.16240 .
Wang, X., Peng, H., Jabbarvand, R., and Ji, H. (2023b). Leti: Learning to generate from textual interactions.
Inarxiv .
Wang, X., Wang, Z., Liu, J., Chen, Y., Yuan, L., Peng, H., and Ji, H. (2024). Mint: Multi-turn interactive
evaluation for tool-augmented llms with language feedback. In Proc. The Twelfth International Conference
on Learning Representations (ICLR2024) .
Wang, Y., Kordi, Y., Mishra, S., Liu, A., Smith, N. A., Khashabi, D., and Hajishirzi, H. (2022). Self-instruct:
Aligning language models with self-generated instructions. arXiv preprint arXiv:2212.10560 .
29
Wang, Y., Liu, Q., and Jin, C. (2023c). Is rlhf more difficult than standard rl? arXiv preprint
arXiv:2306.14111 .
Wang, Z., Hou, L., Lu, T., Wu, Y., Li, Y., Yu, H., and Ji, H. (2023d). Enable language models to implicitly
learn self-improvement from data. arXiv preprint arXiv:2310.00898 .
Wirth, C., Akrour, R., Neumann, G., F¨ urnkranz, J., et al. (2017).","[-0.01423301175236702, 0.0032070395536720753, 0.043422747403383255, -0.0053249625489115715, 0.055598147213459015, 0.011323971673846245, 0.0009995391592383385, 0.040840085595846176, -0.04580674320459366, 0.04455798119306564, 0.018561096861958504, -0.04671492800116539, -0.0028292189817875624, 0.016758909448981285, 0.01800766959786415, -0.01431105937808752, 0.02616717293858528, -0.01196254137903452, 0.02044842392206192, 0.05616576224565506, -0.006470840889960527, -0.048219114542007446, -0.016858242452144623, 0.02679155208170414, 0.01565205492079258, -0.011210448108613491, 0.01249468233436346, 0.052220821380615234, -0.022874990478157997, -0.03337591513991356, 0.036497812718153, -0.028040310367941856, -0.043167319148778915, -0.028905926272273064, -0.05250462889671326, 0.041861798614263535, 0.020774804055690765, 0.017298147082328796, -0.014928343705832958, 0.02473393827676773, -0.0032088132575154305, -0.07015753537416458, -0.010330640710890293, 0.045210741460323334, -0.029743162915110588, 0.04129417985677719, 0.00841493159532547, 0.023996034637093544, -0.007570600137114525, 0.03996028006076813, -0.06459488719701767, 0.022548610344529152, -0.04370655491948128, -0.028934307396411896, -0.024024415761232376, -0.01746843196451664, 0.013154538348317146, 0.0032265514601022005, 0.018092811107635498, -0.01256563514471054, -0.012217968702316284, -0.025713078677654266, 0.00039045882294885814, 0.028522785753011703, -0.015879102051258087, -0.03919399529695511, -0.07055486738681793, 0.004611893091350794, -0.0034624673426151276, 0.040726564824581146, 0.00017161564028356224, -0.016617005690932274, 0.021285660564899445, -0.00881226360797882, -0.015964245423674583, 0.029686400666832924, 0.015027676708996296, 0.08145312964916229, -0.0002470023464411497, -0.03885342553257942, -0.005917413625866175, -0.009869451634585857, 0.007169719785451889, -0.04027247056365013, -0.02911878377199173, -0.04311055690050125, -0.042656462639570236, 0.00033547088969498873, -0.0221512783318758, -0.006740459240972996, -0.01952604576945305, -0.0283666905015707, -0.0032815393060445786, 0.0034181224182248116, 0.04245779663324356, 0.009557261131703854, 0.0006540906033478677, -0.0016620553797110915, 0.03561800345778465, 0.03706543147563934, -0.038512855768203735, -0.0401589460670948, 0.017894145101308823, -0.020505186170339584, 0.0514829158782959, -0.012948776595294476, 0.003191075287759304, -0.002295303624123335, -0.01519796159118414, -0.016617005690932274, -0.11840503662824631, -0.01327515672892332, -0.03794523701071739, 0.0023609346244484186, 0.023215560242533684, -0.05097206309437752, -0.04915568605065346, -0.02149851806461811, -0.030708113685250282, -0.021058613434433937, -0.011806446127593517, -0.016347387805581093, 0.05358310416340828, 0.015879102051258087, 0.00331878918223083, -0.03547609969973564, 0.031900111585855484, -0.07129277288913727, -0.0019582808017730713, -0.012551444582641125, 0.006584364455193281, 0.03365972638130188, 0.023002704605460167, -0.029090402647852898, -0.04504045844078064, -0.02538669854402542, 0.0017267991788685322, 0.0036646812222898006, -0.0352206714451313, -0.05190863087773323, 1.1120926501462236e-05, -0.01590748317539692, -0.05775509402155876, 0.005296581890434027, -0.059088993817567825, 0.015751387923955917, 0.0011059674434363842, 0.010621544905006886, -0.02513127028942108, 0.019128713756799698, 0.00536753423511982, -0.0055200811475515366, -0.032694775611162186, 0.00859940703958273, -0.0476514995098114, -0.062040604650974274, -0.02521641179919243, 0.05437776818871498, 0.028139643371105194, -0.054831862449645996, 0.023258130997419357, 0.05749966576695442, 0.008166598156094551, -0.017553575336933136, 0.03232582286000252, -0.009841070510447025, -0.014403296634554863, 0.028281547129154205, -0.040300849825143814, -0.03209877759218216, 0.018575286492705345, 0.0013285799650475383, -0.02768554911017418, -0.033319152891635895, -0.0055910334922373295, -0.01682986319065094, -0.0018891023937612772, -0.028238976374268532, -0.02032070979475975, -0.02435079589486122, 0.01196254137903452, 0.015041866339743137, -0.052731677889823914, 0.0010820210445672274, -0.02484746091067791, 0.0031360872089862823, -0.02693345583975315, -0.010983400978147984, -0.003322336822748184, 0.04171989485621452, 0.0033950628712773323, 0.06635449826717377, 0.05125587061047554, 0.0057648662477731705, -0.006864625494927168, -0.010791829787194729, 0.04506883770227432, 0.019753092899918556, -0.009266357868909836, -0.022747276350855827, -0.0028983973897993565, 0.0318717285990715, -0.0034039318561553955, -0.03612885996699333, 0.020803185179829597, 0.002002625958994031, 0.01021711714565754, 0.01917128451168537, -0.03845609351992607, -0.010990495793521404, 0.04410388693213463, 0.03482333943247795, 0.06499221920967102, 0.007400314789265394, -0.0328366793692112, -0.004679297562688589, -0.012239255011081696, -0.019313190132379532, -0.003008373314514756, 0.04887187480926514, 0.004271322395652533, 0.010117784142494202, 0.014133678749203682, -0.002197744557633996, -0.03925075754523277, 0.021824898198246956, 0.0255002211779356, -0.02887754701077938, 0.038001999258995056, -0.02240670472383499, 0.059997182339429855, 0.003304598852992058, -0.0352206714451313, -0.017766430974006653, -0.0015423235017806292, -0.029743162915110588, -0.007613171357661486, -0.017298147082328796, 0.04469988867640495, -0.0414360873401165, 0.018405001610517502, 0.014374916441738605, 0.0026074934285134077, -0.0034677889198064804, 0.02873564139008522, 0.03865475952625275, -0.035277433693408966, -0.05730099976062775, 0.027259835973381996, -0.013537679798901081, 0.02342841774225235, -0.030566208064556122, -0.003941394854336977, -0.02341422624886036, -0.026862503960728645, -0.010387402027845383, -0.018603667616844177, 0.005878389813005924, -0.018731381744146347, -0.027401739731431007, -0.031389255076646805, 0.017809001728892326, 0.01978147402405739, 0.03598695620894432, 0.012267636135220528, -0.009982975199818611, -0.033574581146240234, 0.046771690249443054, -0.008698740042746067, -0.006126722786575556, 0.012501778081059456, -0.0082872174680233, -0.029856687411665916, 0.02107280306518078, -0.05863489955663681, -0.05134101212024689, 0.04787854477763176, 0.02420889213681221, -0.04855968803167343, 0.021257279440760612, -0.009457928128540516, 0.02625231444835663, 0.07401733845472336, 0.014843200333416462, 0.01863204874098301, 0.013594442047178745, -0.00026429694844409823, -0.024549461901187897, -0.044728267937898636, -0.02796935848891735, 0.0018429834162816405, -0.021016042679548264, 0.038370952010154724, -0.06340289115905762, 0.03768980875611305, 0.013495109044015408, 0.048105593770742416, 0.006091246381402016, 0.007205196190625429, -0.02084575779736042, 0.04617569223046303, -0.009812689386308193, -0.031531158834695816, 0.030310779809951782, 0.03402867540717125, 0.02046261541545391, -0.0013631691690534353, -0.005065987352281809, 0.03947780653834343, 0.004938273224979639, 0.01087697222828865, 0.01773804984986782, -0.009337309747934341, 0.002987087704241276, -0.03207039460539818, -0.04001704230904579, 0.03468143567442894, -0.01684405282139778, 0.044728267937898636, -0.036441050469875336, -0.030452685430645943, -0.029544496908783913, 0.010642830282449722, 0.019327379763126373, 0.009039310738444328, 0.00112459238152951, 0.015893293544650078, -0.02267632447183132, -0.04645950347185135, -0.020803185179829597, 0.0035245507024228573, 0.0018802332924678922, 0.0302824005484581, -0.0076557425782084465, -0.001188449328765273, -0.04404712840914726, -0.021938420832157135, 0.037604667246341705, 0.03868313878774643, 0.020221376791596413, -0.08576702326536179, -0.0004549809964373708, -0.03854123502969742, -0.01287782471626997, -0.022037753835320473, 0.020093662664294243, 0.019568616524338722, 0.021058613434433937, 0.0290052592754364, 0.05732937902212143, -0.0022793395910412073, -0.04061304032802582, 0.023329084739089012, -0.011430399492383003, -0.03405705839395523, 0.029799925163388252, -0.028281547129154205, -0.05619414523243904, -0.03263801336288452, -0.01003264170140028, 0.00427487026900053, 0.008372359909117222, 0.005626509431749582, -0.0029746710788458586, 0.001011068932712078, 0.025060318410396576, 0.01261530164629221, -0.007393219508230686, -0.0027813264168798923, -0.030736492946743965, 0.03039592318236828, 0.01604938879609108, -0.03652619197964668, -0.002309494186192751, -0.038768284022808075, -0.01431105937808752, 0.002577338833361864, 0.0023893152829259634, 0.009245071560144424, 0.029856687411665916, -0.01060735434293747, 0.01514120027422905, -0.004973749164491892, -0.04379170015454292, 0.010025545954704285, 0.011409114114940166, -0.0070349108427762985, -0.0033471700735390186, -0.02562793530523777, -0.026238124817609787, 0.015268913470208645, -0.0318717285990715, -0.045381028205156326, -0.006201222538948059, 0.015127009712159634, -0.004920535255223513, -0.02406698651611805, 0.01431105937808752, 0.046289216727018356, 0.040981993079185486, -0.017794812098145485, -0.0033276581671088934, -0.023357464000582695, -0.010969210416078568, -0.020505186170339584, 0.03845609351992607, -0.009975879453122616, 0.05852137506008148, -0.008294312283396721, 0.023783177137374878, 0.031900111585855484, -0.03453953191637993, 0.007343553006649017, -0.044586364179849625, -0.004587059840559959, -0.038881804794073105, 0.012317302636802197, -0.015183771029114723, 0.0621541291475296, 0.08162341266870499, 0.007847313769161701, -0.01112530566751957, -0.001321484800428152, -0.05315738916397095, -0.025400888174772263, 0.02574145793914795, 0.03470981866121292, -0.059599850326776505, 0.013807298615574837, -0.054831862449645996, -0.022562799975275993, 0.027657167986035347, 0.06851144880056381, -0.031389255076646805, -0.030310779809951782, -0.037576284259557724, 0.05063148960471153, 0.01592167466878891, 0.01656024344265461, -0.04540940746665001, 0.024776509031653404, -0.019327379763126373, -0.05718747526407242, 0.011529732495546341, -0.003806585678830743, 0.018589476123452187, -0.042769987136125565, 0.018291477113962173, -0.004895702004432678, -0.02781326323747635, -0.015112819150090218, 0.00016274661174975336, 0.06811411678791046, 0.005573295522481203, -0.005211439449340105, -0.04152122884988785, 0.09229462593793869, -0.037207335233688354, 0.04790692776441574, 0.035901814699172974, 0.00676529249176383, 0.013466727919876575, -0.019469283521175385, -0.00925926212221384, 0.028636308386921883, 0.03507876768708229, 0.0026713504921644926, 0.007556409575045109, 0.007982122711837292, -0.012288921512663364, -0.004186179954558611, -0.013949203304946423, -0.017283955588936806, -0.05400881543755531, -0.008038884028792381, 0.01707109995186329, 0.026110410690307617, -0.019838236272335052, 0.004203917924314737, -0.020150424912571907, 0.027770692482590675, 0.008876120671629906, 0.033461056649684906, 0.009628213942050934, 0.05233434587717056, 0.043820079416036606, 0.0016904361546039581, -0.027103740721940994, 0.002935647265985608, -0.0031165755353868008, -0.005484605208039284, -0.006552435923367739, 0.02147013694047928, -0.01684405282139778, 0.005200796294957399, -0.0023964105639606714, -0.005034058820456266, 0.008074360899627209, 0.0018270191503688693, -0.016588624566793442, -0.007833123207092285, -0.03587343171238899, -0.007478361949324608, 0.03524905443191528, -0.01475805789232254, 0.00466510746628046, 0.03209877759218216, -0.015581103973090649, 0.0057648662477731705, 0.05715909227728844, -0.03584505245089531, -0.007049101404845715, 0.0011467649601399899, 0.026096219196915627, 0.018731381744146347, 0.03944942355155945, -0.03933589905500412, -0.0211153756827116, -0.005534271709620953, 0.039931900799274445, -0.005828723311424255, -0.020788995549082756, -0.026493553072214127, -0.011061448603868484, 0.04467150568962097, 0.02680574171245098, -0.027217265218496323, -0.07151982188224792, -0.024535272270441055, -0.018447572365403175, 0.008826454170048237, -0.008507168851792812, 0.0155385322868824, 0.0052291774190962315, -0.04333760589361191, -0.007833123207092285, -0.010380307212471962, -0.022747276350855827, -0.0283666905015707, -0.0006926708738319576, 0.010515116155147552, 0.0369802862405777, 0.010259688831865788, 0.04339436814188957, -0.011515541933476925, -0.017056908458471298, 0.020817376673221588, -0.015581103973090649, 0.009067690931260586, 0.02784164436161518, 0.06334612518548965, -0.051199108362197876, -0.011160781607031822, -0.013686679303646088, -0.009862355887889862, -0.01978147402405739, -0.005289486609399319, 0.016858242452144623, -0.005183058325201273, 0.006644673645496368, 0.003118349239230156, -0.021441755816340446, -0.0062047699466347694, 0.027486883103847504, -0.03042430430650711, 0.007967932149767876, 0.006261531729251146, -0.0155385322868824, 0.008542644791305065, 0.01980985514819622, -0.017511002719402313, -0.013821489177644253, 0.034113816916942596, -0.009195405058562756, 0.03141763433814049, -0.018802333623170853, 0.01519796159118414, 0.012168302200734615, 0.014687106013298035, 0.022619562223553658, -0.035788290202617645, -0.045239124447107315, -0.013424156233668327, -0.01308358646929264, -0.026238124817609787, 0.008003408089280128, 0.005552009679377079, 0.013942107558250427, -0.03774657100439072, 0.01761033572256565, 0.04824749752879143, -0.02899106964468956, -0.02098766155540943, -0.029601259157061577, -0.03672485798597336, -0.004228751175105572, 0.0072938865050673485, -0.009862355887889862, -0.014843200333416462, 0.0005955550586804748, 0.015637865290045738, 0.000750319508370012, 0.00891869142651558, -0.02186746895313263, -0.014829009771347046, 0.026692219078540802, -0.005683271214365959, 0.014197535812854767, -0.00312189687974751, 0.0015183771029114723, -0.009273452684283257, -0.014431677758693695, 0.005073082633316517, -0.022420896217226982, -0.04126580059528351, -0.019185476005077362, -0.00790407508611679, -0.001208848087117076, 0.040442753583192825, -0.02884916588664055, -0.016744719818234444, -0.017894145101308823, 0.010366116650402546, 0.018703000620007515, -0.006612745113670826, 0.009720451198518276, -0.01112530566751957, -0.02189585007727146, -0.017922526225447655, -0.000390680565033108, -0.018021859228610992, 0.0063856979832053185, 0.012970062904059887, 0.008060170337557793, 0.005254010669887066, -0.0019423165358603, -0.005179510917514563, -0.02303108386695385, 0.020774804055690765, -0.03456791117787361, 0.016915004700422287, 0.02561374567449093, -0.0015485318144783378, -0.01850433461368084, 0.019994329661130905, -0.002307720249518752, 0.0028380879666656256, 0.011976731941103935, -0.01580815017223358, -0.019086143001914024, -0.03016887605190277, -0.04668654873967171, 0.04194694012403488, -0.010359021835029125, 0.040045421570539474, -0.005686819087713957, 0.01901518926024437, -0.009010929614305496, 0.0015582877676934004, -0.012480492703616619, -0.044728267937898636, -0.0004121879464946687, 0.0014829010469838977, 0.011409114114940166, -0.013516394421458244, 0.0443025566637516, 0.03723571449518204, 0.06680859625339508, 0.016404148191213608, -0.009422452189028263, -0.014644534327089787, -0.017766430974006653, 0.0372924767434597, -0.008045979775488377, -0.008968357928097248, -0.054292626678943634, 0.04049951583147049, -0.009188310243189335, -0.0061409128829836845, 0.01579396054148674, -0.019909188151359558, 0.007457076571881771, -0.05605223774909973, -0.028139643371105194, -0.005988365970551968, 0.00037471632822416723, 0.026209743693470955, -0.009663689881563187, -8.680558676132932e-05, 0.001367603661492467, -0.006357317324727774, -0.012863634154200554, 0.01249468233436346, -0.011799351312220097, -0.021924231201410294, 0.03195687010884285, 0.0072158388793468475, 0.05264653265476227, -0.02551441267132759, -0.09887898713350296, -0.0014500856632366776, 0.02005109190940857, -0.012849443592131138, -0.0057932473719120026, -0.02781326323747635, -0.023059464991092682, -0.0045302980579435825, 0.008932881988584995, 0.052873581647872925, -0.009557261131703854, -0.012388254515826702, -0.01902938075363636, -0.0019334475509822369, 0.013076490722596645, -0.030254019424319267, 0.020405853167176247, 0.03470981866121292, 0.008592311292886734, 0.00312189687974751, -0.022491848096251488, -0.04552293196320534, -0.0037817524280399084, -0.02937421202659607, 0.0025188031140714884, -0.006077056284993887, -0.002816802356392145, -0.040329232811927795, 0.007350648287683725, 0.0024762318935245275, -0.014325249940156937, 0.018220525234937668, -0.006811411585658789, -0.004952463787049055, -0.017794812098145485, 0.019596997648477554, 0.012423730455338955, -0.036951906979084015, -0.007740885019302368, -0.01152263768017292, 0.0012514194240793586, 0.00016551818407606333, -0.019483475014567375, -0.01519796159118414, 0.0357031486928463, 0.014545201323926449, 0.0072867912240326405, 0.03632752597332001, 0.015056056901812553, -0.0049808444455266, 0.016915004700422287, -0.030764874070882797, 0.013651203364133835, 0.024946793913841248, -0.0031963966321200132, 0.012125731445848942, -0.02574145793914795, 0.0019068404799327254, -0.03249610960483551, -0.01775224134325981, -0.002192422980442643, 0.0021640420891344547, 0.01914290338754654, -0.015751387923955917, 0.014218821190297604, 0.001367603661492467, 0.0033453963696956635, -0.018944237381219864, -0.01787995547056198, -0.009365690872073174, 0.023910891264677048, -0.028962688520550728, -0.017553575336933136, 0.014999295584857464, 0.0003940064343623817, 0.03439762815833092, 0.0010837948648259044, 0.006605649832636118, 0.0236696545034647, 0.005920961033552885, -0.0077337902039289474, -0.010642830282449722, -0.015325675718486309, 0.030850017443299294, -0.04890025779604912, -0.013055205345153809, -0.029459353536367416, -0.03133249282836914, -0.0294025931507349, 0.022477658465504646, -0.04021570831537247, -0.06873849034309387, 0.0005729390541091561, 0.024038605391979218, -0.015240533277392387, -0.0021037328988313675, 0.053270913660526276, -0.015183771029114723, -0.07963675260543823, -0.014162059873342514, 0.029289068654179573, -0.012061874382197857, 0.025429269298911095, -0.03726409748196602, 0.005775509402155876, 0.01732652820646763, 0.004391941241919994, -0.05891870707273483, -0.0026057197246700525, -0.0041684419848024845, 0.013956298120319843, -0.01138782873749733, 0.02033490128815174, -0.06578688323497772, 0.02395346388220787, -0.025415077805519104, 0.05409395694732666, -0.0034873008262366056, -0.019639570266008377, 0.02419470064342022, 0.0008576347609050572, 0.05341281741857529, -0.013956298120319843, -0.008578121662139893, 0.01783738285303116, 0.015850722789764404, -0.015992626547813416, 0.01619129255414009, -0.02911878377199173, -0.028536975383758545, -0.0062260557897388935, 0.03658295422792435, -0.05874842405319214, 0.007219386752694845, -0.012551444582641125, -0.002298851264640689, -0.02172556333243847, 0.014523915946483612, -0.0021746850106865168, -0.04552293196320534, 0.04748121276497841, -0.025329936295747757, 0.02537250705063343, -0.016673767939209938, 0.010699591599404812, -0.02277565747499466, 0.014282678253948689, -0.0046012504026293755, 0.04855968803167343, 0.014069821685552597, -0.009663689881563187, 0.006758197210729122, 0.00860650185495615, 0.014176249504089355, 0.010252593085169792, 0.012374063953757286, 0.025954315438866615, 0.02409536764025688, 0.00357776484452188, 0.01092663872987032, 0.015268913470208645, -0.011068543419241905, -0.02666383795440197, -0.002313041826710105, -0.017369098961353302, 0.04308217763900757, -0.017525194212794304, -0.04907054454088211, -0.03039592318236828, 0.017440050840377808, 0.001438555889762938, 0.0318717285990715, -0.003678871551528573, -0.02210870571434498, 0.03368810564279556, 0.03658295422792435, -0.0005139600252732635, 0.013282252475619316, 0.04725416749715805, -0.042911890894174576, 0.006492126267403364, 0.00550234317779541, -0.011472971178591251, 0.02328651212155819, 0.012579825706779957, 0.0033312058076262474, -0.012870728969573975, 0.0328366793692112, 0.04725416749715805, -0.008372359909117222, 0.03419896215200424, -0.03104868344962597, 0.0036398479714989662, 0.0029072663746774197, -0.02110118418931961, 0.020008521154522896, 0.03351781889796257, -0.01048673503100872, 0.03624238446354866, 0.04435931518673897, -0.027898406609892845, 0.0012860086280852556, -0.0015565139474347234, 0.02379736863076687, 0.002057613804936409, 0.01786576397716999, 0.044841792434453964, 0.007230029441416264, 0.009791404008865356, 0.03859799727797508, -0.031275730580091476, 0.01314034778624773, 0.016730528324842453, 0.022733084857463837, 0.014176249504089355, 0.02043423429131508, -0.00331878918223083, 0.021711373701691628, 0.028125451877713203, 0.019639570266008377, -0.020632900297641754, -0.012579825706779957, -0.026834122836589813, -0.04313893988728523, 0.03002697229385376, -0.005431390833109617, -0.020278139039874077, -0.0005618527648039162, 0.03326239064335823, -0.009692071005702019, -0.006080603692680597, -0.001997304381802678, -0.030083732679486275, 0.0494111143052578, 0.02068966254591942, 0.023272322490811348, -0.04904216155409813, 0.017894145101308823, 0.029175546020269394, 0.006804316304624081, 0.00646729301661253, 0.012125731445848942, 0.0024496247060596943, 0.009869451634585857, 0.0007352422107942402, -0.02948773466050625, -0.006257984321564436, 0.0007263731677085161, 0.025911744683980942, -0.01365829911082983, -0.02315879799425602, 0.03470981866121292, 0.004583512432873249, 0.014169154688715935, 0.006006103940308094, -0.04416064918041229, -0.016219673678278923, 0.023272322490811348, 0.00019356647680979222, 0.045863501727581024, -0.0025329936761409044, -0.020618710666894913, 0.019838236272335052, -0.029289068654179573, -0.010827305726706982, -0.010969210416078568, -0.022321563214063644, 0.009152834303677082, -0.025911744683980942, -0.03079325519502163, 0.019710522145032883, 0.034000296145677567, 0.011919969692826271, 0.033092107623815536, 0.0037817524280399084, 0.02846602350473404, 0.0372924767434597, 0.03944942355155945, 0.02392508275806904, 0.013679584488272667, -0.016801482066512108, -0.016588624566793442, 0.048219114542007446, -0.001599085284397006, -0.004374203272163868, -0.004987939726561308, -0.01443877350538969, 0.0427132248878479, 0.0060309371910989285, -0.012402445077896118, 0.007428695447742939, 0.041748274117708206, 0.005839366000145674, -0.04401874542236328, 0.002992409048601985, 0.021711373701691628, -0.022591181099414825, -0.05451967194676399, -0.050943680107593536, 0.05108558386564255, -0.004047823138535023, 0.0023981845006346703, -0.049921970814466476, 0.027203073725104332, -0.012473396956920624, -0.02484746091067791, 0.006339579354971647, 0.016801482066512108, 0.007882789708673954, -0.00014223699690774083, -0.03587343171238899, 0.016120340675115585, 0.0030296589247882366, -0.015495960600674152, 0.008237550966441631, 0.00802469439804554, -0.04345112666487694, -0.012402445077896118, -0.03703704848885536, -0.02408117800951004, 0.0028292189817875624, 0.014332344755530357, -0.0008962149731814861, -0.011998017318546772, 0.00982687994837761, -0.020505186170339584, 0.009677880443632603, 0.002057613804936409, -0.0011095150839537382, 0.011040162295103073, -0.007875693961977959, 0.0014013060135766864, -0.009670784696936607, -0.027472693473100662, 0.021314041689038277, -0.004299703519791365, -0.009982975199818611, 0.016517672687768936, 0.036554574966430664, 0.009209595620632172, 0.012523063458502293, -0.006410531233996153, 0.01418334525078535, 0.013537679798901081, 0.02564212493598461, 0.03675324097275734, -0.026578694581985474, -0.02498936466872692, -0.005073082633316517, -0.013296443037688732, 0.04279836639761925, 0.007435790728777647, 0.014523915946483612, -0.01902938075363636, 0.02703278884291649, 0.037462763488292694, 0.030254019424319267, 0.026621265336871147, -0.02615298144519329, 0.028423452749848366, -0.003386193886399269, -0.016915004700422287, -0.018561096861958504, -0.023087846115231514, 0.0032939559314399958, 0.011827732436358929, 0.006662411615252495, 0.01204768382012844, -0.04259970039129257, 0.009081881493330002, 0.012650777585804462, 0.04115227609872818, 0.00023924195556901395, -0.0022225778084248304, 0.001562722260132432, -0.013282252475619316, 0.022818228229880333, 0.004111680202186108, -0.017823193222284317, -0.01772386021912098, -0.020732233300805092, -0.010529306717216969, 0.025698887184262276, -0.01644672080874443, 0.020476805046200752, -0.02290337160229683, 0.023456797003746033, -0.020405853167176247, 0.03221229836344719, 0.04427417367696762, -0.003308146493509412, 0.015524341724812984, -0.024308225139975548, 0.00010393388947704807, 0.009876546449959278, -0.005949342157691717, 0.030736492946743965, -0.019894996657967567, 0.050659872591495514, 0.007485457230359316, 0.00040952724521048367, 0.008045979775488377, 0.012111540883779526, 0.011182066984474659, 0.006321841385215521, -0.0352206714451313, 0.00030886378954164684, -0.022321563214063644, -0.009848165325820446, 0.012068969197571278, 0.011728398501873016, 0.0038597998209297657, 0.027855833992362022, -0.010493830777704716, -0.003959132824093103, -0.03558962419629097, 0.0017090612091124058, -0.005335605703294277, 0.00028957368340343237, 0.018078621476888657, 0.013303537853062153, 0.012530159205198288, -0.02860792726278305, -0.01853271573781967, 0.010174545459449291, -0.0013356752460822463, 0.01874557137489319, 0.0019050666596740484, -0.007996313273906708, -0.0004401253827381879, -0.01428977306932211, 0.009429547935724258, -0.02005109190940857, -0.005353343673050404, -0.034369245171546936, -0.0022970775607973337, -0.015439199283719063, -0.025713078677654266, 0.033830009400844574, 0.0027724571991711855, 0.021044423803687096, -0.015339866280555725, -0.0064850314520299435, -0.00563360471278429, -0.008925787173211575, 0.012104446068406105, 0.001498865312896669, -0.006591459736227989, 0.08270188421010971, -0.007996313273906708, -0.0033844199497252703, -0.0030846470035612583, -0.02743012085556984, 0.04427417367696762, -0.026578694581985474, 0.0017445372650399804, -0.028764022514224052, 0.022364133968949318, 0.008038884028792381, 0.023130416870117188, -0.01759614609181881, -0.007151981815695763, -0.005864199250936508, -0.02393927238881588, -0.009018024429678917, 0.04694197699427605, 0.010174545459449291, 0.03042430430650711, 0.020420042797923088, 0.03232582286000252, -0.013821489177644253, -0.0172130037099123, 0.015368246473371983, 0.00759898079559207, -0.0033950628712773323, 0.0008394532487727702, 0.013445442542433739, 0.03820066526532173, 0.00462608365342021, -0.01593586429953575, -0.05477510020136833, 0.02743012085556984, -0.04609055072069168, 0.02005109190940857, -0.021640421822667122, 0.012523063458502293, 0.003870442509651184, -0.013899536803364754, 0.027146313339471817, -0.001402192865498364, -0.010195831768214703, 0.020008521154522896, -0.017000148072838783, 0.00808145571500063, -0.008911596611142159, 0.006843339651823044, -0.0021587207447737455, 0.01966794952750206, -0.009968784637749195, -0.014318154193460941, 0.019497664645314217, -0.008173693902790546, -0.016148721799254417, -0.01980985514819622, -0.008443311788141727, 0.05426424369215965, 0.01436072587966919, 0.029856687411665916, -0.034511152654886246, 0.022704703733325005, -0.03550448268651962, -0.002935647265985608, -0.0013720381539314985, -0.031644683331251144, -0.008911596611142159, 0.006932029966264963, -0.02240670472383499, 0.04066980257630348, -0.03581667318940163, -0.0019316737307235599, -0.012288921512663364, 0.01709948107600212, -0.0012017529224976897, 0.025599554181098938, -0.007180362939834595, 0.02887754701077938, 0.016517672687768936, 0.040726564824581146, -0.01060735434293747, -0.003998156636953354, -0.009734641760587692, 0.011352351866662502, 0.01144459005445242, 0.010280974209308624, 0.03221229836344719, -0.00327089661732316, -0.04657302424311638, 0.02603945881128311, -0.02809707261621952, 0.005949342157691717, 0.054406147450208664, 0.02240670472383499, -0.018972618505358696, -0.014020155183970928, -0.004934725817292929, 0.0024460770655423403, 0.030764874070882797, 0.00027848739409819245, -0.008258836343884468, -0.007169719785451889, 0.014587773010134697, 0.011501352302730083, -0.03419896215200424, 0.01968214102089405, -0.029430972412228584, -0.01968214102089405, 0.006729816552251577, 0.01029516477137804, 0.005062439478933811, -0.011551018804311752, 0.033461056649684906, 0.018291477113962173, -0.0024673629086464643, 0.013757632113993168, -0.0017755788285285234, -0.0008558609406463802, 0.009323119185864925, -0.04404712840914726, 0.0328366793692112, -0.004246489144861698, 0.02691926620900631, 0.015155389904975891, 0.002194196917116642, -0.0023006252013146877, 0.018830714747309685, -0.029998591169714928, 0.005285939201712608, 0.00023392053844872862, -0.0282105952501297, -0.011792255565524101, 0.018036048859357834, 0.0017064004205167294, 0.003164468100294471, 0.016617005690932274, -0.02237832359969616, -0.02926068753004074, -0.01775224134325981, -0.0062260557897388935, 0.02937421202659607, 0.01762452721595764, -0.006006103940308094, 0.047424450516700745, -0.006878816056996584, -0.03740600124001503, -0.0007463285000994802, -0.025060318410396576, 0.02926068753004074, -0.0065737213008105755, -0.013466727919876575, 0.02537250705063343, -0.0009942176984623075, 0.031133826822042465, 0.013346109539270401, -5.6290595239261165e-05, 0.0022899822797626257, -0.005527176428586245, 0.0076557425782084465, -0.01616291143000126, 0.0060309371910989285, -0.014573582448065281, 0.0016647160518914461, 0.012139922007918358, 0.04748121276497841, -0.008975453674793243, -0.01559529360383749, 0.006793673150241375, -0.0009968784870579839, 0.0016079542692750692, -0.017667097970843315, 0.012955872341990471, 0.016531862318515778, -0.014743867330253124, 0.00933021493256092, -0.019965950399637222, -0.023740606382489204, -0.0039023710414767265, 0.0017303468193858862, 0.0043422747403383255, -0.02393927238881588, -0.020405853167176247, 0.011905779130756855, -0.010465449653565884, -0.007478361949324608, 0.0010793603723868728, -0.00015576225996483117, 0.015680436044931412, -0.00633603148162365, -0.013935012742877007, 0.0012922169407829642, -0.01541081815958023, 0.023754797875881195, 0.008620692417025566, 0.02511707879602909, 0.03732085973024368, 0.015510151162743568, 0.03312048688530922, 0.03632752597332001, 0.03743438050150871, 0.013927916996181011, -0.014027249999344349, -0.0013250323245301843, -0.010891162790358067, -0.022690514102578163, -0.0035990504547953606, 0.007137791719287634, 0.018915856257081032, -0.007975027896463871, -0.007677028421312571, -0.026720598340034485, -0.007818932645022869, 0.0051511297933757305, 0.005725842900574207, 0.033063724637031555, 0.005988365970551968, 0.00898964423686266, 0.017553575336933136, -0.04660140722990036, -0.005906770937144756, -0.0008997626136988401, -0.017766430974006653, -0.0011937707895413041, -0.0009033101960085332, -0.0029817663598805666, 0.03476657718420029, 0.013104871846735477, -0.0023041728418320417, -0.0037604665849357843, 0.0110756391659379, -0.008904500864446163, -0.009713356383144855, 0.010288069024682045, 0.0036753241438418627, 0.018092811107635498, -0.0024851008784025908, -0.007989217527210712, 0.001162729226052761, 0.002061161445453763, 0.00873421598225832, -0.018731381744146347, 0.030906779691576958, 0.022208038717508316, 0.0339435338973999, -0.046658169478178024, 0.10177383571863174, 0.039818376302719116, 0.028693070635199547, -0.04126580059528351, 0.027855833992362022, -0.009535975754261017, 0.00983397476375103, -0.01590748317539692, -0.047197405248880386, 0.030878398567438126, -0.05244786664843559, -0.018305668607354164, -0.009741737507283688, -0.0022101611830294132, 0.020022710785269737, -0.017383288592100143, -0.03686676546931267, 0.016219673678278923, 0.006279269699007273, -0.028920117765665054, 0.04206046462059021, -0.02392508275806904, 0.034085437655448914, 0.004828297533094883, -0.012856539338827133, -0.0035245507024228573, 0.021271470934152603, -0.01644672080874443, -0.004682845436036587, 0.002022137865424156, 0.032183919101953506, 0.007833123207092285, 0.004931177943944931, 0.02212289720773697, -0.014481344260275364, 0.031133826822042465, -0.013991774059832096, -0.02240670472383499, 0.0030332065653055906, 0.003952037543058395, 0.005225629545748234, -0.03726409748196602, -0.031786587089300156, 0.01877395249903202, -2.9046057534287684e-05, -0.016404148191213608, 0.016645386815071106, 0.001719704014249146, -0.0328366793692112, -0.00524336751550436, 0.012076064944267273, -0.0071058631874620914, -0.026351647451519966, -0.0217539444565773, 0.02872145175933838, -0.024279844015836716, -0.026195552200078964, 0.008166598156094551, 0.03607209771871567, 0.026323266327381134, 0.033347535878419876, -0.020093662664294243, 0.04467150568962097, -0.011614875867962837, 0.021129565313458443, -0.006932029966264963, 0.005392367485910654, -0.004008799325674772, 0.008968357928097248, 0.023655464872717857, 0.029090402647852898, -0.0038349665701389313, 0.014829009771347046, -0.030764874070882797, 0.02897688001394272, -0.013679584488272667, -0.013906631618738174, 0.015155389904975891, 0.005509438458830118, -0.019767282530665398, 0.0037178953643888235, -0.013353204354643822, 0.037860095500946045, 0.022307371720671654, 0.021186327561736107, 0.016460910439491272, -0.004838940221816301, 0.01358025148510933, -0.0003141852212138474, -0.02267632447183132, 0.019724711775779724, 0.004572869278490543, 0.01475805789232254, 0.03751952573657036, -0.015339866280555725, -0.03133249282836914, 0.00624379375949502, -0.020490996539592743, 0.0027369812596589327, -0.011919969692826271, 0.01708528958261013, 0.032155536115169525, 0.01339577604085207, 0.004927630536258221, 0.004296155646443367, 0.0339435338973999, 0.04552293196320534, 0.013260966166853905, -0.01566624641418457, 8.170589717337862e-05, 0.01501348614692688, -0.0032247775234282017, -0.03865475952625275, -0.04308217763900757, 0.0028026120271533728, -0.05239110440015793, -0.013622823171317577, 0.008166598156094551, 0.009316024370491505, 0.004540940746665001, 0.007350648287683725, -0.004679297562688589, -0.02059032954275608, -0.013119062408804893, -0.03805876150727272, 0.02108699455857277, 0.04152122884988785, 0.019000999629497528, 0.02277565747499466, -0.029714781790971756, -0.03598695620894432, -0.020533567294478416, -0.023967653512954712, 0.007556409575045109, -0.006946220528334379, -0.0003410140343476087, -0.03672485798597336, 0.01783738285303116, -0.026337457820773125, -0.0012443242594599724, 0.0011618422577157617, -0.014857390895485878, 0.010103593580424786, -0.017056908458471298]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" A survey of preference-based reinforcement
learning methods. Journal of Machine Learning Research , 18(136):1–46.
Wu, J., Ouyang, L., Ziegler, D. M., Stiennon, N., Lowe, R., Leike, J., and Christiano, P. (2021a). Recursively
summarizing books with human feedback. arXiv preprint arXiv:2109.10862 .
Wu, R. and Sun, W. (2023). Making rl with preference-based feedback efficient via randomization. arXiv
preprint arXiv:2310.14554 .
Wu, X., Sun, K., Zhu, F., Zhao, R., and Li, H. (2023). Better aligning text-to-image models with human
preference. arXiv preprint arXiv:2303.14420 .
Wu, Y., Zhai, S., Srivastava, N., Susskind, J., Zhang, J., Salakhutdinov, R., and Goh, H. (2021b). Uncertainty
weighted actor-critic for offline reinforcement learning. arXiv preprint arXiv:2105.08140 .
Xiao, L. (2022). On the convergence rates of policy gradient methods. Journal of Machine Learning Research ,
23(282):1–36.
Xie, T., Cheng, C.-A., Jiang, N., Mineiro, P., and Agarwal, A. (2021a). Bellman-consistent pessimism for
offline reinforcement learning. Advances in neural information processing systems , 34:6683–6694.
Xie, T. and Jiang, N. (2021). Batch value-function approximation with only realizability. In International
Conference on Machine Learning , pages 11404–11413. PMLR.
Xie, T., Jiang, N., Wang, H., Xiong, C., and Bai, Y. (2021b). Policy finetuning: Bridging sample-efficient
offline and online reinforcement learning. Advances in neural information processing systems , 34:27395–
27407.
Xiong, W., Zhong, H., Shi, C., Shen, C., Wang, L., and Zhang, T. (2022a). Nearly minimax optimal offline
reinforcement learning with linear function approximation: Single-agent mdp and markov game. arXiv
preprint arXiv:2205.15512 .
Xiong, W., Zhong, H., Shi, C., Shen, C., and Zhang, T. (2022b). A self-play posterior sampling algorithm for
zero-sum markov games. In International Conference on Machine Learning , pages 24496–24523. PMLR.
Xu, Y., Wang, R., Yang, L., Singh, A., and Dubrawski, A. (2020). Preference-based reinforcement learning
with finite-time guarantees. Advances in Neural Information Processing Systems , 33:18784–18794.
Ye, C., Xiong, W., Gu, Q., and Zhang, T. (2023). Corruption-robust algorithms with uncertainty weighting
for nonlinear contextual bandits and markov decision processes. In International Conference on Machine
Learning , pages 39834–39863. PMLR.
Yin, M., Duan, Y., Wang, M., and Wang, Y.-X. (2022). Near-optimal offline reinforcement learning with
linear representation: Leveraging variance information with pessimism. arXiv preprint arXiv:2203.05804 .
Yuan, R., Du, S. S., Gower, R. M., Lazaric, A., and Xiao, L. (2022). Linear convergence of natural policy
gradient methods with log-linear policies. In The Eleventh International Conference on Learning Repre-
sentations .
Yuan, W., Pang, R. Y., Cho, K., Sukhbaatar, S., Xu, J., and Weston, J. (2024). Self-rewarding language
models. arXiv preprint arXiv:2401.10020 .
30
Yuan, Z., Yuan, H., Tan, C., Wang, W., Huang, S., and Huang, F. (2023). Rrhf: Rank responses to align
language models with human feedback without tears. arXiv preprint arXiv:2304.05302 .
Yue, Y., Broder, J., Kleinberg, R., and Joachims, T. (2012). The k-armed dueling bandits problem. Journal
of Computer and System Sciences , 78(","[-0.02930229902267456, 0.01320762000977993, 0.029086444526910782, 0.022287016734480858, 0.02491774782538414, -0.007366047706454992, -0.011602199636399746, 0.03262106701731682, -0.028708698228001595, 0.04994342103600502, 0.028546808287501335, -0.060979001224040985, -0.011345871724188328, 0.01535267848521471, 0.012937801890075207, -0.02811509743332863, 0.01900872029364109, -0.02781829796731472, 0.025457384064793587, 0.0353192538022995, -0.008951231837272644, -0.043251920491456985, 0.001078431261703372, 0.019777704030275345, 0.017848500981926918, -0.031244993209838867, 0.02800717018544674, 0.05682379752397537, -0.016863662749528885, -0.047569017857313156, 0.02324487268924713, -0.026685059070587158, -0.041713956743478775, -0.01899522915482521, -0.03221634030342102, 0.035885874181985855, 0.01627006195485592, -0.0010371152311563492, -0.00146966811735183, -0.014151985757052898, -0.018118318170309067, -0.07948856055736542, 0.000564089510589838, 0.03998711705207825, -0.0264557134360075, 0.02932928130030632, 0.014111512340605259, -0.013389747589826584, 0.005065844394266605, 0.03394317999482155, -0.06297565996646881, 0.010070979595184326, -0.0322972871363163, -0.031056120991706848, 0.007804502733051777, -0.007359302137047052, 0.004576798062771559, 0.011204217560589314, 0.04130922630429268, -0.039123695343732834, 0.010185652412474155, -0.050887785851955414, 0.008148521184921265, 0.023082980886101723, -0.01740329898893833, -0.051805172115564346, -0.06572780758142471, 0.012270000763237476, -0.0005843259277753532, 0.030543465167284012, 0.013922639191150665, -0.03942049667239189, 0.03861103951931, 0.0018937892746180296, -0.0159462783485651, 0.0502941869199276, 0.04978153109550476, 0.07004490494728088, -0.01613515242934227, -0.028681717813014984, 0.023986874148249626, -0.002465467434376478, 0.015865333378314972, -0.04864829406142235, -0.04508668929338455, -0.04524857923388481, -0.03537321835756302, -0.008984959684312344, -0.01756519079208374, 0.019629303365945816, -0.018401628360152245, 0.004499224945902824, -0.021356141194701195, -0.008964722976088524, 0.026981860399246216, 0.008445322513580322, -0.006003463640809059, 0.004590288735926151, 0.04689447209239006, 0.013416729867458344, -0.037450820207595825, -0.03488754481077194, 0.019696757197380066, -0.03340354189276695, 0.038799915462732315, -0.01034079771488905, -0.007554920855909586, 0.0060338182374835014, 0.00866792257875204, -0.026739023625850677, -0.1308080554008484, -0.0038111875765025616, -0.06972112506628036, 0.025848621502518654, 0.013032237999141216, -0.04940378665924072, -0.07981234043836594, -0.021545015275478363, -0.018172282725572586, 0.011156998574733734, 0.01245887391269207, 0.0052209896966814995, 0.025808148086071014, -0.014435295015573502, 0.01614864356815815, -0.0162835530936718, 0.0264557134360075, -0.07279706001281738, -0.0074065206572413445, -0.008202485740184784, 0.01616213470697403, 0.021518032997846603, 0.0040304153226315975, -0.055069975554943085, -0.05736343562602997, 0.010549907572567463, 0.014489258639514446, 0.0014840023359283805, -0.030516482889652252, -0.035966817289590836, 0.00588879082351923, -0.016796207055449486, -0.05968387424945831, -0.014813041314482689, -0.07026076316833496, 0.014421803876757622, -0.005150162614881992, -0.0010919221676886082, -0.003389596240594983, -0.004536325111985207, 0.03699212893843651, 0.005339035298675299, -0.021180760115385056, 0.029976846650242805, -0.03556209057569504, -0.035858891904354095, -0.01457020454108715, 0.058172889053821564, 0.01609467901289463, -0.047811854630708694, 0.022516362369060516, 0.07554920762777328, -0.013976603746414185, -0.0232988353818655, 0.051994044333696365, -0.02035781368613243, -0.026725532487034798, 0.027440551668405533, -0.02220606990158558, -0.032782960683107376, 0.040283918380737305, 0.029787972569465637, -0.005983227398246527, -0.017012063413858414, 0.007844976149499416, -0.009517851285636425, -0.01533918734639883, -0.007305338513106108, -0.021464070305228233, -0.03102913871407509, 0.03221634030342102, -0.006489137187600136, -0.02058715932071209, -0.0025278630200773478, -0.0246749110519886, -0.007379538845270872, -0.01778104528784752, -0.02352818101644516, -0.012978274375200272, 0.04085053503513336, 0.035912856459617615, 0.03971729800105095, 0.016958098858594894, -0.0008313785656355321, -0.006748837884515524, -0.03394317999482155, 0.05080684274435043, 0.005207499023526907, -0.04006806015968323, -0.012128345668315887, -0.04106638953089714, 0.04827054589986801, -0.015703441575169563, -0.050348151475191116, 0.019561847671866417, -0.021598977968096733, -0.0068095470778644085, 0.01379447616636753, -0.04071562737226486, -0.01624307967722416, 0.0321623757481575, 0.013646075502038002, 0.05979179963469505, -0.002441858407109976, -0.04576123505830765, -0.012364436872303486, -0.02062763087451458, 0.028330951929092407, 0.003969706129282713, 0.047569017857313156, 0.01608118787407875, 0.00482637993991375, 0.012708456255495548, 0.01605420745909214, -0.018711918964982033, 0.017093008384108543, 0.052048008888959885, -0.03540020063519478, 0.02930229902267456, -0.049241892993450165, 0.06367719173431396, 0.010084469802677631, -0.024391600862145424, -0.00548743549734354, 0.0063812099397182465, -0.014529731124639511, 0.01310643833130598, 0.00511980801820755, 0.02628033049404621, -0.04576123505830765, 0.01465114951133728, 0.027534987777471542, 0.006300264038145542, -0.002640849445015192, 0.007015283685177565, 0.032890886068344116, -0.03850311413407326, -0.03993315249681473, 0.01616213470697403, -0.011042325757443905, 0.009996779263019562, -0.021207742393016815, 0.00693433778360486, -0.02640174888074398, -0.02367658168077469, -0.038853876292705536, -0.0038887604605406523, 0.017322354018688202, -0.016755735501646996, -0.019548356533050537, -0.050887785851955414, 0.016701770946383476, 0.01164941769093275, 0.011460544541478157, -0.00733906589448452, -0.003939351532608271, -0.017929445952177048, 0.028303971514105797, 0.01400358509272337, -0.002145057776942849, -0.014988423325121403, 0.007966394536197186, -0.028843607753515244, 0.05968387424945831, -0.05617623031139374, -0.05285746231675148, 0.028951535001397133, 0.053478047251701355, -0.06691501289606094, -0.0026104948483407497, -0.010388015769422054, 0.025686729699373245, 0.06999094784259796, -0.0007162840338423848, 0.030543465167284012, 0.005325544625520706, -0.01175734493881464, -0.02916738949716091, -0.02354167215526104, -0.01933250203728676, -0.03413205221295357, -0.04076959192752838, 0.00890401378273964, -0.05601434037089348, 0.06027747318148613, 0.0023929537273943424, 0.038691986352205276, -0.024337638169527054, 0.009490869008004665, -0.004505970515310764, 0.056068304926157, -0.004043906461447477, -0.04090449959039688, 0.031703684478998184, 0.027076296508312225, 0.041740935295820236, -0.013814711943268776, 0.009187323041260242, 3.1145074899541214e-05, 0.0052715810015797615, -0.002657713135704398, 0.02640174888074398, -0.01617562584578991, 0.013571875169873238, -0.04818960279226303, -0.040445808321237564, 0.05382880941033363, -0.021194251254200935, 0.038988787680864334, -0.04527556151151657, -0.035777945071458817, -0.022975053638219833, 0.019386466592550278, 0.02479632943868637, 0.005389626603573561, -0.012202546000480652, 0.015703441575169563, -0.009942815639078617, -0.00628340058028698, -0.00876910425722599, 0.008998449891805649, -0.0005725213559344411, 0.0322972871363163, -0.001330542960204184, 0.013700039125978947, -0.04217264801263809, -0.006040563806891441, 0.056284159421920776, 0.025700220838189125, 0.014421803876757622, -0.08537060767412186, -0.01241840049624443, -0.03718100115656853, -0.0020523075945675373, -0.03863802179694176, -0.024499528110027313, 0.02323138155043125, 0.0645945742726326, 0.02058715932071209, 0.03979824483394623, -0.013767493888735771, -0.029059462249279022, 0.012627510353922844, 0.02486378327012062, -0.014259913004934788, 0.011453799903392792, -0.004215915687382221, -0.01772708259522915, -0.02622636780142784, -0.0025126857217401266, 0.01098836213350296, 0.010273342952132225, 0.006391327828168869, -0.00588879082351923, 0.028330951929092407, 0.030084773898124695, -0.007022028788924217, -0.01386867556720972, 0.005676308646798134, -0.012904074043035507, 0.009807906113564968, 0.026091458275914192, -0.08358979970216751, -0.001327170175500214, -0.03928558900952339, -0.0034806597977876663, -0.0015573592390865088, 0.02938324585556984, 0.02216559834778309, 0.019507884979248047, -0.009288505651056767, 0.003173741279169917, -0.02046574093401432, -0.033106740564107895, 0.040607698261737823, 0.02792622521519661, -0.035993799567222595, -0.012121600098907948, -0.00797313917428255, -0.0019764213357120752, -0.0014679818414151669, -0.031244993209838867, -0.0412282831966877, -0.009598796255886555, 0.0008343296940438449, 0.005254717078059912, -0.028951535001397133, 0.03842216730117798, 0.03685722127556801, 0.020087994635105133, -0.023771017789840698, 0.0064621553756296635, -0.023946400731801987, 0.014138494618237019, -0.02476934716105461, 0.04557236284017563, -0.009207559749484062, 0.050698913633823395, 0.009099632501602173, 0.038988787680864334, 0.03467169031500816, -0.02656364068388939, 0.007359302137047052, -0.04257737472653389, -0.0057336450554430485, -0.03334957733750343, -0.012748928740620613, -0.011379599571228027, 0.04406137764453888, 0.060763146728277206, -0.000811142148450017, -0.01244538277387619, 0.001322111114859581, -0.01776755414903164, -0.02483680099248886, 0.03140688315033913, 0.014421803876757622, -0.05703965201973915, 0.03407808765769005, -0.03979824483394623, -0.025484366342425346, 0.031137065961956978, 0.05558263137936592, -0.044951777905225754, -0.031164048239588737, -0.0175247173756361, 0.0378015860915184, -0.0018634346779435873, 0.0058921636082232, -0.03499547392129898, 0.04112035408616066, -0.02211163379251957, -0.05838874354958534, 0.03758573159575462, 0.0009839946869760752, 0.004863480105996132, -0.03977126255631447, 0.03952842578291893, 0.007069247309118509, -0.007035519927740097, -0.00878934096544981, 0.0094503965228796, 0.05973783880472183, 0.005615599453449249, -0.01612166129052639, -0.04716429114341736, 0.09540785849094391, -0.018091337755322456, 0.026968369260430336, 0.028627753257751465, 0.019521376118063927, 0.015649478882551193, -0.018469082191586494, -0.006512746214866638, 0.01602722518146038, 0.027238188311457634, 0.009929324500262737, 0.010718544013798237, 0.019521376118063927, 0.015271732583642006, -0.004192306660115719, -0.02216559834778309, 0.008337394334375858, -0.02938324585556984, -0.02323138155043125, -0.005602108780294657, -0.006607182789593935, -0.0014443726977333426, -0.0033002186100929976, -0.01389565784484148, -0.014867004938423634, -0.026698550209403038, 0.03378129005432129, 0.014394822530448437, 0.03788253292441368, 0.05129251629114151, -0.007912429980933666, -0.012013672851026058, -0.01774057187139988, 0.008074321784079075, 0.019453920423984528, 0.014421803876757622, 0.031218010932207108, -0.014813041314482689, -0.014367840252816677, -0.009362705051898956, 0.0019646165892481804, 0.012243018485605717, -0.002623985754325986, -0.010151924565434456, -0.027548478916287422, -0.03812536969780922, -0.0264557134360075, 0.021221233531832695, -0.015541551634669304, 0.0014840023359283805, 0.022948071360588074, -0.010428489185869694, -0.0022917718160897493, 0.06054729223251343, -0.029814954847097397, -0.0005898065865039825, -0.015541551634669304, 0.008276685141026974, 0.009376196190714836, 0.04662465304136276, -0.024593966081738472, -0.01923806592822075, -0.019467411562800407, 0.043197955936193466, -0.0013178952503949404, -0.02946419082581997, -0.013153656385838985, -0.0010522925294935703, 0.025794658809900284, 0.029841937124729156, -0.021302178502082825, -0.09503010660409927, -0.016809698194265366, -0.024108292534947395, 0.009194068610668182, 0.005662817973643541, 0.03931257128715515, 0.005969736259430647, -0.03844914957880974, 0.00955157820135355, -0.01243863720446825, -0.02333930879831314, -0.029734009876847267, 0.0006812919746153057, 0.0005295189912430942, -0.013059220276772976, -0.004020296968519688, 0.020074503496289253, -0.0020725440699607134, -0.03073233738541603, 0.04085053503513336, -0.044654976576566696, 0.002349108224734664, 0.03378129005432129, 0.03469867259263992, -0.05010531470179558, -0.01782151870429516, -0.010549907572567463, -0.036209654062986374, -0.006128254812210798, -0.005214244592934847, 0.0072716111317276955, 0.012121600098907948, -0.00030249194242060184, 0.008323904126882553, -0.024081310257315636, -0.005683054216206074, 0.021167268976569176, -0.04872923716902733, -0.004701589234173298, 0.028250006958842278, -0.010543162003159523, 0.026712041348218918, 0.028384916484355927, -0.02773735113441944, 0.01602722518146038, 0.03245917707681656, -0.05463826656341553, 0.01245212834328413, 0.005021998658776283, 0.019669774919748306, -0.014178967103362083, 0.0014376272447407246, 0.02922135405242443, -0.03637154772877693, -0.015379659831523895, -0.009315486997365952, -0.00733232032507658, -0.02185530588030815, 0.004394670482724905, 0.011939472518861294, 0.007791012059897184, -0.036074746400117874, 0.032917868345975876, 0.05428750067949295, -0.030381573364138603, -0.04273926466703415, -0.015204277820885181, -0.029599100351333618, 0.011069308035075665, 0.004664489068090916, 0.0024098174180835485, -0.006833156105130911, 0.0028819998260587454, 0.010765762068331242, 0.0117843272164464, 0.000960385543294251, -0.024580474942922592, -0.004650997929275036, 0.0324321947991848, 0.018226245418190956, -0.0016054206062108278, -0.014920968562364578, -0.005042234901338816, -0.0002531657228246331, -0.020803013816475868, 0.010286834090948105, -0.016998572275042534, -0.03102913871407509, -0.021234722808003426, -0.020978396758437157, 0.014138494618237019, 0.02779131568968296, -0.031298957765102386, -0.01023287046700716, -0.014826531521975994, 0.0233662910759449, 0.000665271480102092, 0.0021602350752800703, -0.0005168712232261896, 0.003989942371845245, -0.029760992154479027, -0.016782715916633606, -0.006148491520434618, -0.010185652412474155, -0.013261583633720875, 0.010549907572567463, -0.004192306660115719, 0.004303606692701578, -0.009706724435091019, -0.0015539864543825388, -0.01894126646220684, 0.015163805335760117, -0.037558749318122864, 0.028870590031147003, 0.011453799903392792, 0.00040472790715284646, -0.01256005559116602, 0.01245887391269207, -0.003790951333940029, 0.014529731124639511, -0.000365730666089803, -0.02078952267765999, -0.024027345702052116, -0.01914362981915474, -0.04354872182011604, 0.019831666722893715, -0.009753942489624023, 0.018630973994731903, -0.015096350573003292, 0.017106499522924423, -0.021464070305228233, 0.007575157098472118, -0.017322354018688202, -0.02621287666261196, -0.006367718800902367, 0.0012841678690165281, -0.002430053660646081, -0.012836620211601257, 0.03227030485868454, 0.01770010031759739, 0.06400097161531448, 0.018428610637784004, 0.0019022211199626327, -0.02203068882226944, 0.0007639239192940295, 0.011177235282957554, -0.010462216101586819, -0.01880635693669319, -0.05396372079849243, 0.03817933052778244, -0.028654735535383224, -0.00346716889180243, 0.020155448466539383, -0.01167639996856451, 0.01734933629631996, -0.04584217816591263, -0.023109963163733482, 0.00800012145191431, -0.03688420355319977, 0.024256691336631775, -0.014354349114000797, -0.0020978394895792007, -0.002443544566631317, -0.010759016498923302, -0.014138494618237019, -0.000537529238499701, 0.01167639996856451, -0.025389930233359337, 0.039015769958496094, -0.0009536400903016329, 0.04541046917438507, -0.025754185393452644, -0.09297949075698853, 0.005710036028176546, 0.02181483432650566, 0.009780923835933208, 0.0102396160364151, -0.03227030485868454, -0.028142079710960388, -0.008600467815995216, 0.02217908948659897, 0.026158912107348442, -0.013740512542426586, -0.021356141194701195, -0.03359241411089897, -0.013308802619576454, 0.023892436176538467, -0.03542718291282654, 0.005247971508651972, 0.05129251629114151, 0.005376135464757681, 0.026725532487034798, -0.03804442286491394, -0.03475263714790344, -0.010873689316213131, -0.017133481800556183, 0.005210871808230877, -0.0159462783485651, -0.007440248038619757, -0.04303606599569321, 0.011932727880775928, -0.004367688670754433, -0.009126613847911358, -0.008330648764967918, -0.010590380057692528, -0.0008153580711223185, -0.016661297529935837, 0.002927531721070409, 0.028654735535383224, -0.037504784762859344, -0.010414998047053814, -0.006219318602234125, 0.01166965439915657, -0.006097900215536356, -0.004239524714648724, -0.006263164337724447, 0.012897329404950142, -0.006920847110450268, 0.014745586551725864, 0.031703684478998184, 0.011527999304234982, -0.03515736386179924, -0.0027032450307160616, -0.018266718834638596, 0.0125735467299819, 0.020236395299434662, 0.008391357958316803, 0.004968035034835339, -0.04066166281700134, -0.010779253207147121, -0.028519826009869576, -0.016769226640462875, 0.017200935631990433, -0.017389807850122452, 0.018050864338874817, -0.0322972871363163, 0.004013551864773035, 0.0036594148259609938, -0.031541794538497925, -0.02035781368613243, -0.009065904654562473, -0.0017023867694661021, 0.01165616326034069, 0.004360943101346493, -0.011163744144141674, 0.015555041842162609, 0.018023882061243057, 0.05431448295712471, -0.00366278737783432, 0.013754002749919891, 0.006826410535722971, -0.00943690538406372, -0.005656072404235601, -0.009909087792038918, 0.009848378598690033, 0.02660411410033703, -0.034428853541612625, -0.018657956272363663, -0.024189237505197525, -0.004300233907997608, -0.02362261898815632, 0.0017959800316020846, -0.031325940042734146, -0.05102269724011421, 0.00628677336499095, 0.034428853541612625, -0.022475888952612877, -0.0010000151814892888, 0.04565330594778061, -0.024364618584513664, -0.08348187059164047, -0.00549755385145545, 0.03707307577133179, -0.006435173563659191, 0.01167639996856451, -0.0435757040977478, 0.01887381076812744, 0.015042386949062347, -0.004637507256120443, -0.059360090643167496, 0.02078952267765999, 0.005426726769655943, 0.013693293556571007, -0.021679924800992012, 0.022705234587192535, -0.0412282831966877, 0.026968369260430336, -0.04098544642329216, 0.03817933052778244, 0.0077775209210813046, -0.01610817015171051, 0.0017175640678033233, -0.014192458242177963, 0.021167268976569176, -0.008546504192054272, 0.003055695677176118, 0.026981860399246216, 0.02628033049404621, -0.019980067387223244, 0.01604071632027626, -0.013430221006274223, -0.019399957731366158, 0.02636127732694149, 0.041767917573451996, -0.054962050169706345, 0.015379659831523895, -0.025605784729123116, 0.008836559019982815, -0.0220576710999012, -0.006580200977623463, 0.006914101541042328, -0.04093148186802864, 0.04273926466703415, -0.02943720854818821, 0.025470875203609467, -0.02949117310345173, 0.017066026106476784, -0.03191953897476196, 0.022260034456849098, -0.02039828523993492, 0.04106638953089714, 0.01590580679476261, -0.027629423886537552, -0.012917565181851387, 0.015379659831523895, 0.0021231351420283318, 0.014745586551725864, -0.0023136944510042667, -0.006573455408215523, 0.022475888952612877, -0.031191030517220497, 0.018752392381429672, 0.013565129600465298, -0.029626082628965378, -0.016715262085199356, -0.0033997143618762493, 0.0005194008117541671, 0.032998815178871155, -0.012748928740620613, -0.043305885046720505, -0.017295371741056442, -0.00801361259073019, -0.005936009343713522, 0.025889094918966293, -0.013538148254156113, -0.016755735501646996, 0.043386831879615784, 0.035777945071458817, -0.018738901242613792, 0.006327246315777302, 0.05574452131986618, -0.04570727050304413, -0.003384537063539028, 0.007244629319757223, -0.029032481834292412, 0.030300628393888474, 0.001956184860318899, -0.003767342073842883, -0.014219440519809723, 0.03221634030342102, 0.047730911523103714, -0.002733599627390504, 0.011359362863004208, -0.031191030517220497, 0.00666114641353488, -0.010630852542817593, -0.02333930879831314, 0.01736282743513584, 0.029976846650242805, -0.00880283210426569, 0.04403439536690712, 0.025592293590307236, -0.0295451357960701, 0.016391480341553688, 0.017983408644795418, 0.00800012145191431, 0.01109628938138485, -0.005463826470077038, 0.026172403246164322, 0.005308680702000856, 0.010286834090948105, 0.016539879143238068, -0.03475263714790344, 0.008438576944172382, 0.007521193474531174, 0.023744037374854088, 0.02073555998504162, 0.04114733636379242, -0.011824799701571465, 0.035804927349090576, 0.005544772371649742, 0.006644282955676317, -0.025241529569029808, -0.011339126154780388, -0.018361154943704605, -0.024634437635540962, 0.01533918734639883, 0.0028853726107627153, -0.018496064469218254, -0.007912429980933666, 0.05898234620690346, -0.008398103527724743, 0.00327829597517848, -0.005254717078059912, -0.019804684445261955, 0.0291404090821743, 0.0039528426714241505, 0.010691561736166477, -0.04392646625638008, 0.026792986318469048, 0.008249703794717789, -0.0076156300492584705, -0.024216219782829285, -0.010792744345963001, 0.004256388172507286, 0.0001060829745256342, -0.004371061455458403, -0.02038479596376419, -0.009733705781400204, 0.02204417996108532, 0.03340354189276695, -0.01643195189535618, -0.011069308035075665, 0.012404910288751125, -0.006792683154344559, 0.015123332850635052, 0.0219902154058218, -0.047434110194444656, -0.003932605963200331, 0.007514447905123234, 0.01608118787407875, 0.041767917573451996, 0.0010489197447896004, -0.02951815538108349, 0.009733705781400204, -0.03933954983949661, -0.016742244362831116, -0.013760748319327831, -0.017322354018688202, -0.0014553340151906013, -0.02773735113441944, -0.03772063925862312, 0.018185773864388466, 0.04872923716902733, 0.02065461315214634, 0.023096472024917603, 0.02366309054195881, 0.022799670696258545, 0.037288930267095566, 0.030300628393888474, 0.0295451357960701, 0.01763264462351799, -0.018158791586756706, -0.02501218393445015, 0.056607943028211594, -0.013828203082084656, 0.002868508920073509, 0.009524596855044365, -0.0189007930457592, 0.03685722127556801, 0.022799670696258545, 0.0011551608331501484, -0.010057488456368446, 0.04851338267326355, 0.0110288355499506, -0.029086444526910782, -0.005183889996260405, 0.004782534670084715, 0.0008811263833194971, -0.05849667266011238, -0.02779131568968296, 0.031568776816129684, 0.0014401567168533802, 0.02024988643825054, -0.05145440623164177, 0.044762905687093735, -0.004644252825528383, -0.01604071632027626, 0.032782960683107376, 0.022975053638219833, -0.0012538132723420858, 0.02941022627055645, -0.04648974537849426, 0.02642873115837574, 0.00655321916565299, -0.01751122623682022, 0.019494393840432167, 0.013308802619576454, -0.03688420355319977, 0.0043305885046720505, -0.03059742972254753, -0.02046574093401432, 0.0008086126181297004, 0.006583573762327433, -0.001728525385260582, -0.014597185887396336, 0.018212756142020226, 0.0009452083031646907, -0.003871896769851446, 0.014637659303843975, 0.002453662920743227, 0.01902221143245697, -0.028600770980119705, -0.018388137221336365, -0.012006927281618118, -0.016944607719779015, 0.01543362345546484, 0.0012765792198479176, -0.005679681431502104, 0.02182832546532154, 0.044681958854198456, 0.02069508656859398, -0.006064172834157944, -0.01309969276189804, 0.02637476846575737, -0.0004283370217308402, 0.012796146795153618, 0.0384761318564415, -0.02333930879831314, -0.021329160779714584, 0.0009898969437927008, 0.0012268314603716135, 0.0530463345348835, 0.024445565417408943, -0.010455470532178879, -0.018536537885665894, 0.01102208998054266, 0.006725228391587734, 0.013625838793814182, 0.02943720854818821, -0.016458934172987938, 0.02916738949716091, -0.01168989110738039, -0.005683054216206074, 0.010050742886960506, -0.023177416995167732, -0.011581962928175926, 0.017187444493174553, 0.021518032997846603, 0.014718604274094105, -0.052182916551828384, 0.009888852015137672, 0.018185773864388466, 0.02811509743332863, 0.006961319595575333, -0.00868141371756792, 0.004880344029515982, -0.005919145420193672, 0.021140286698937416, 0.0018566892249509692, -0.02343374490737915, -0.0054840631783008575, -0.018833337351679802, -0.026725532487034798, 0.012290237471461296, -0.025565311312675476, 0.04120130091905594, -0.024337638169527054, 0.02045224979519844, -0.0010362720349803567, 0.04840545728802681, 0.04103940725326538, -0.02636127732694149, 0.01747075468301773, -0.02919437177479267, 7.952270971145481e-05, 5.860122837475501e-05, -0.016458934172987938, 0.03777460381388664, 0.007662848103791475, 0.02811509743332863, 0.018091337755322456, 0.012168819084763527, 0.017052534967660904, 0.01604071632027626, 0.014259913004934788, -0.00887028593569994, -0.03259408473968506, -0.0003705789858940989, -0.012809637933969498, -0.008978214114904404, -0.0019275166559964418, 0.016512898728251457, 0.00222263066098094, 0.02641524001955986, -0.011716872453689575, -0.008060830645263195, -0.03235125169157982, -0.005848317872732878, -0.012128345668315887, -0.006914101541042328, -0.003790951333940029, -0.0162160973995924, 0.0266580767929554, -0.014286894351243973, -0.02065461315214634, 0.006421682424843311, -0.010745525360107422, 0.016796207055449486, 0.02644222229719162, -0.01591929793357849, 0.013686547987163067, -0.004000060725957155, -0.004394670482724905, -0.020141959190368652, -0.010651089251041412, -0.043143995106220245, 0.026010513305664062, -0.0026880677323788404, -0.01896824687719345, 0.04395344853401184, 0.003558232681825757, 0.02221956104040146, -0.01544711459428072, 0.008924250490963459, 0.0060810367576777935, 0.0016037343302741647, 0.008816322311758995, -0.018064355477690697, -0.014246421866118908, 0.08121539652347565, 0.0033221414778381586, -0.006961319595575333, 0.005082707852125168, -0.01465114951133728, 0.034266963601112366, -0.022745708003640175, -0.002254671650007367, -0.014327367767691612, 0.003794324118643999, 0.006634164601564407, 0.02354167215526104, -0.007170429453253746, -0.009794414974749088, -0.0013963112141937017, -0.009895596653223038, -0.0026745768263936043, 0.030219683423638344, 0.0014258226146921515, 0.029734009876847267, 0.013693293556571007, 0.044654976576566696, 0.014867004938423634, -0.012229528278112411, 0.02051970362663269, -8.579387940699235e-05, -0.010448724962770939, 0.0025801402516663074, 0.02930229902267456, 0.042037736624479294, 0.0013895657612010837, -0.021423596888780594, -0.05258764326572418, 0.018833337351679802, -0.05469223111867905, 0.016485916450619698, -0.03925860673189163, 0.03089422918856144, 0.0013558384962379932, 0.003882015123963356, 0.03537321835756302, -0.010111452080309391, -0.0012369495816528797, 0.028843607753515244, 0.005345780868083239, 0.01771359145641327, -0.0017706844955682755, 0.03062441013753414, 0.008202485740184784, 0.031352922320365906, -0.006202455144375563, -0.003035459201782942, 0.018603991717100143, 0.006748837884515524, -0.00797988474369049, -0.0018077846616506577, -0.0261858943849802, 0.05404466390609741, -0.0059427544474601746, 0.015784388408064842, -0.033322595059871674, 0.023905927315354347, -0.019966576248407364, -0.005743763409554958, 0.033052779734134674, -0.0232988353818655, 0.001517729600891471, -0.009207559749484062, -0.014259913004934788, 0.046408798545598984, -0.02779131568968296, 0.0048398710787296295, -0.011602199636399746, 0.004306979477405548, 0.0043238429352641106, 0.011554981581866741, -0.01543362345546484, 0.024337638169527054, 0.024040836840867996, 0.032917868345975876, -0.014853513799607754, -0.024229710921645164, -0.029032481834292412, 0.00026665665791369975, -0.0012985019711777568, 0.0006741249235346913, 0.047622982412576675, 0.005241226404905319, -0.047703929245471954, 0.030489500612020493, -0.021059341728687286, 0.013814711943268776, 0.04816262051463127, 0.028330951929092407, -0.015595515258610249, -0.012384673580527306, -0.0027285406831651926, 0.024324147030711174, -0.00333394599147141, 0.006627419497817755, -0.011069308035075665, -0.013086201623082161, 0.013922639191150665, 0.013605603016912937, -0.023082980886101723, 0.030219683423638344, -0.029626082628965378, -0.01595976948738098, 0.0019140256335958838, 0.005554890260100365, 0.005625717807561159, 0.012694965116679668, 0.04295511916279793, 0.007379538845270872, -0.008317158557474613, 0.011318890377879143, 0.015123332850635052, 0.006644282955676317, 0.014826531521975994, -0.028330951929092407, 0.02485029213130474, 0.004610525444149971, 0.010833216831088066, 6.439152457460295e-06, -0.0057302722707390785, 0.010819725692272186, 0.01595976948738098, -0.027615932747721672, -0.004910698626190424, -0.003844914957880974, -0.021113304421305656, -0.0027588950470089912, 0.00628340058028698, 0.019858649000525475, -0.005376135464757681, 0.023109963163733482, -0.043278902769088745, -0.01101534441113472, -0.026158912107348442, -0.013949621468782425, 0.004991644062101841, -0.00511643523350358, -0.004590288735926151, 0.049133967608213425, -0.03097517415881157, -0.02806113474071026, 0.01311318390071392, -0.0327020138502121, 0.039096713066101074, -0.009861869737505913, -0.006654401309788227, 0.04265832155942917, 0.015797879546880722, 0.042010754346847534, 0.01013168878853321, -0.011818054132163525, 0.01399009395390749, -0.011919236741960049, 0.014543222263455391, -0.008620704524219036, 0.008371122181415558, -0.037127040326595306, -0.003969706129282713, 0.008694903925061226, 0.04341381415724754, -0.0029696908313781023, -0.008148521184921265, -0.001531220506876707, -0.007649357430636883, 0.009275014512240887, -0.006087782327085733, 0.02208465151488781, 0.0189007930457592, 0.001527847838588059, 0.02644222229719162, -0.013524657115340233, -0.018334174528717995, -0.030300628393888474, -0.01181130949407816, 0.01780802756547928, -0.03467169031500816, -0.015622496604919434, 0.0037471058312803507, -0.003993315156549215, -0.002035444136708975, -0.010401506908237934, 0.009369450621306896, 0.012492600828409195, 0.009281760081648827, -0.03102913871407509, 0.0003575096488930285, -0.008829813450574875, 0.026819968596100807, 0.0353192538022995, 0.02190927043557167, 0.044816870242357254, 0.017241409048438072, 0.01324809342622757, 0.04001409932971001, 0.03839518502354622, -0.010624106973409653, 0.0018583756173029542, 0.0009291878086514771, 0.010590380057692528, -0.015838351100683212, 0.018266718834638596, -0.0013010315597057343, 0.038907840847969055, 0.004209170117974281, -0.0013533089077100158, -0.015595515258610249, -0.022637780755758286, 0.025322474539279938, -0.0015969888772815466, 0.03334957733750343, 0.004306979477405548, 0.006506001111119986, 0.003959587775170803, -0.0590902715921402, 0.013450456783175468, 0.0057876091450452805, -0.0133290383964777, -0.012985019944608212, 0.014178967103362083, -0.00654984638094902, 0.019642794504761696, 0.020168939605355263, -0.004779161885380745, -0.0062935189343988895, -0.00046459390432573855, -0.00957856047898531, -0.01751122623682022, 0.0030405183788388968, 0.005763999652117491, 0.0068095470778644085, 0.004900580272078514, -0.005194007884711027, -0.011447054333984852, 0.014273404143750668, -0.0020034031476825476, -0.0246749110519886, 0.03067837469279766, 0.015366168692708015, 0.0280341524630785, -0.023082980886101723, 0.0709083303809166, 0.03235125169157982, 0.00888377707451582, -0.049457747489213943, 0.024040836840867996, 0.014718604274094105, 0.013673057779669762, -0.019575338810682297, -0.027197714895009995, 0.032027468085289, -0.04864829406142235, -0.010657834820449352, -0.019292030483484268, -0.017160462215542793, 0.016539879143238068, -0.028169061988592148, -0.02211163379251957, 0.003770714858546853, 0.006229436956346035, -0.029787972569465637, 0.03353845328092575, -0.04527556151151657, 0.011143508367240429, 0.0012614019215106964, -0.014961441047489643, -0.00016399910964537412, 0.022759199142456055, -0.0189007930457592, 0.0025059401523321867, -0.009086141362786293, 0.012411655858159065, 0.03618267551064491, 0.02629382163286209, 0.031244993209838867, -0.021288687363266945, 0.020856978371739388, -0.022313997149467468, -0.02919437177479267, 0.016620825976133347, -0.0008621547603979707, 0.010010270401835442, -0.034401871263980865, -0.03364637866616249, 0.010819725692272186, 0.015689952298998833, -0.027467533946037292, 0.013801220804452896, -0.007878703065216541, -0.03718100115656853, -0.0018027254845947027, 0.01089392602443695, 0.006347482558339834, -0.0379364937543869, -0.009045668877661228, 0.023986874148249626, -0.005096198990941048, -0.015244750306010246, 0.007541429717093706, 0.0130929471924901, 0.03086724691092968, 0.016526389867067337, -0.010064234025776386, 0.057957034558057785, -0.01600024290382862, 0.047703929245471954, 0.006981556303799152, 0.0071906656958162785, 0.00024410150945186615, 0.014367840252816677, 0.009780923835933208, 0.03696514666080475, 0.012971528805792332, 0.020236395299434662, -0.03210841491818428, 0.01311318390071392, -0.0034148916602134705, -0.008067576214671135, 0.014448786154389381, -0.000142287157359533, 0.0005965520394966006, -0.0059495000168681145, -0.04114733636379242, 0.04076959192752838, 0.013713530264794827, 0.0138821667060256, 0.031622741371393204, 0.0001292178058065474, 0.0029359636828303337, 0.008317158557474613, -0.018738901242613792, 0.024378109723329544, -0.01757868193089962, -0.002451976528391242, 0.01933250203728676, -0.023042507469654083, -0.009753942489624023, -0.007379538845270872, -0.01633751578629017, 0.009699978865683079, -0.004290115553885698, 0.023055998608469963, 0.02768338844180107, 0.037531767040491104, -0.015784388408064842, 0.020074503496289253, 0.03218935802578926, 0.034563761204481125, 0.004883716814219952, 0.007089483551681042, -0.000738206843379885, 0.03661438450217247, -0.008155266754329205, -0.03507641702890396, -0.03537321835756302, -0.005440217442810535, -0.04414232075214386, -0.013349275104701519, 0.0094503965228796, -0.005308680702000856, -0.003878642339259386, -0.006725228391587734, -0.009679742157459259, -0.014597185887396336, 0.0031653093174099922, -0.04260435700416565, 0.03100215643644333, 0.030300628393888474, 0.0219902154058218, 0.022840144112706184, -0.034563761204481125, -0.018644465133547783, -0.036209654062986374, -0.014880496077239513, 0.013376257382333279, -0.002765640616416931, -0.006300264038145542, -0.018698429688811302, 0.017066026106476784, -0.024135272949934006, -0.006637537386268377, -0.01098836213350296, -0.0003185124369338155, 0.023959891870617867, -0.015811370685696602]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"5):1538–1556.
Zanette, A., Cheng, C.-A., and Agarwal, A. (2021a). Cautiously optimistic policy optimization and explo-
ration with linear function approximation. In Conference on Learning Theory , pages 4473–4525. PMLR.
Zanette, A., Wainwright, M. J., and Brunskill, E. (2021b). Provable benefits of actor-critic methods for
offline reinforcement learning. Advances in neural information processing systems , 34:13626–13640.
Zhan, W., Uehara, M., Kallus, N., Lee, J. D., and Sun, W. (2023a). Provable offline reinforcement learning
with human feedback. arXiv preprint arXiv:2305.14816 .
Zhan, W., Uehara, M., Sun, W., and Lee, J. D. (2023b). How to query human feedback efficiently in rl?
arXiv preprint arXiv:2305.18505 .
Zhang, T. (2022). Feel-good thompson sampling for contextual bandits and reinforcement learning. SIAM
Journal on Mathematics of Data Science , 4(2):834–857.
Zhang, T. (2023). Mathematical Analysis of Machine Learning Algorithms . Cambridge University Press.
Zhao, Y., Joshi, R., Liu, T., Khalman, M., Saleh, M., and Liu, P. J. (2023). Slic-hf: Sequence likelihood
calibration with human feedback. arXiv preprint arXiv:2305.10425 .
Zhong, H., Xiong, W., Zheng, S., Wang, L., Wang, Z., Yang, Z., and Zhang, T. (2022). Gec: A unified
framework for interactive decision making in mdp, pomdp, and beyond. arXiv preprint arXiv:2211.01962 .
Zhong, H. and Zhang, T. (2023). A theoretical analysis of optimistic proximal policy optimization in linear
markov decision processes. arXiv preprint arXiv:2305.08841 .
Zhou, Y., Sekhari, A., Song, Y., and Sun, W. (2023). Offline data enhanced on-policy policy gradient with
provable guarantees. arXiv preprint arXiv:2311.08384 .
Zhu, B., Jiao, J., and Jordan, M. I. (2023a). Principled reinforcement learning with human feedback from
pairwise or k-wise comparisons. arXiv preprint arXiv:2301.11270 .
Zhu, B., Sharma, H., Frujeri, F. V., Dong, S., Zhu, C., Jordan, M. I., and Jiao, J. (2023b). Fine-tuning
language models with advantage-induced policy alignment. arXiv preprint arXiv:2306.02231 .
Ziegler, D. M., Stiennon, N., Wu, J., Brown, T. B., Radford, A., Amodei, D., Christiano, P., and Irving, G.
(2019). Fine-tuning language models from human preferences. arXiv preprint arXiv:1909.08593 .
31
A Notation Table, Backgrounds, and Organization of Appendix
To improve the readability of this paper, we provide a Table 4 for the notations used in this paper. We also
provide an introduction to the rejection sampling for completeness.
Notation Description
⟨z1, z2⟩ The inner product of two vectors z⊤
1z2.
∥z∥Σ The induced norm√
z⊤Σz.
X,A The state (prompt) space and the action (response) space.
ϕ(x, a), θ The feature map and parameter of the linear parameterization in Assumption 1.
d The dimension of the feature vector.
π,Π Policy and policy class.
ℓD The log-likelihood of the BT model on Ddefined in Equation (3).
y∈ {0,1} Preference signal.
J(π) The KL-regularized target defined in Equation (2).
η The coefficient of KL penalty, defined in Equation (2).
d0 Distribution of state (prompt).
B, γ Regularization constant: ∥θ∥ ≤B, γ= 1/(2 + exp( −B) + exp( B)).
Θ(B) {θ∈Rd:∥θ∥ ≤B}.
Doff,DtThe offline dataset","[0.013487393967807293, -0.004884924273937941, 0.02640499733388424, 0.007164092734456062, 0.004871027078479528, 0.0063441479578614235, -0.011750223115086555, 0.03919057548046112, -0.03435429185628891, 0.047223251312971115, 0.028767548501491547, -0.03866247460246086, -0.0001179104729089886, 0.004256068728864193, 0.025890793651342392, -0.002779473317787051, 0.02443157136440277, -0.002953190356492996, 0.023611625656485558, 0.038745857775211334, 0.00012800777039956301, -0.026752430945634842, 0.0018691958393901587, 0.027113761752843857, 0.01913667470216751, -0.025668436661362648, 0.03718935325741768, 0.01363331638276577, 0.0016728955088183284, -0.048946525901556015, 0.035382695496082306, -0.03502136468887329, -0.04402685910463333, -0.04866857826709747, -0.027516786009073257, 0.01826114021241665, 0.008977699093520641, 0.02111010067164898, -0.03024066984653473, -0.009825438261032104, -0.047890324145555496, -0.07582402974367142, -0.035716231912374496, 0.04083046317100525, -0.029490211978554726, 0.02694699354469776, 0.012076811864972115, 0.007747781928628683, 0.008560777641832829, 0.03518813103437424, -0.05142025649547577, 0.035438284277915955, -0.03791201487183571, 0.00041540098027326167, 0.014481056481599808, -0.0019299967680126429, 0.003620264120399952, 0.007949293591082096, 0.04019118472933769, -0.03635551035404205, 0.008234189823269844, -0.017705244943499565, 0.0034621814265847206, 0.0390515998005867, -0.016232123598456383, -0.02376449666917324, -0.07232189923524857, 0.030991127714514732, 0.002025541150942445, 0.02686361037194729, 0.034382086247205734, -0.008324522525072098, 0.007747781928628683, -0.015842998400330544, -0.018705856055021286, 0.045110851526260376, 0.05458885803818703, 0.06142636016011238, 0.015801304951310158, -0.0443326011300087, 0.017121555283665657, -0.0048814499750733376, 0.04713986814022064, -0.04991934075951576, -0.006333725061267614, -0.07471224665641785, -0.05770186707377434, -0.018636368215084076, -0.013271985575556755, 0.004276914522051811, -0.009561387822031975, -0.012424245476722717, -0.03435429185628891, 0.014314287342131138, 0.033770602196455, 0.007984037511050701, -0.014911874197423458, -0.009373773820698261, 0.04811268299818039, 0.0020915537606924772, -0.010402179323136806, -0.03435429185628891, 0.00969341304153204, -0.04263712093234062, 0.042192406952381134, -0.01753847673535347, -0.0023191231302917004, 0.01569012738764286, -0.008546880446374416, -0.019567491486668587, -0.12118503451347351, -0.006038405932486057, -0.05647889897227287, 0.05367162823677063, 0.01588468998670578, -0.04877975583076477, -0.04791811853647232, -0.01713545247912407, -0.011166534386575222, -0.0023677637800574303, -0.014314287342131138, 0.0026735058054327965, 0.02686361037194729, -0.01827503740787506, -0.006910465657711029, -0.01416836492717266, 0.03966308385133743, -0.08933227509260178, -0.01813606359064579, 0.021735481917858124, 0.018761444836854935, 0.013313677161931992, -0.019484108313918114, -0.07015390694141388, -0.07087656855583191, 0.02679412253201008, 0.010895535349845886, 0.02851739712059498, -0.01085384376347065, -0.007678295020014048, -0.009874079376459122, -0.0339929573237896, -0.03866247460246086, -0.005336588714271784, -0.05981426686048508, 0.01924785226583481, -0.032075121998786926, 0.02686361037194729, -0.023069629445672035, -0.007448988500982523, 0.032464247196912766, 0.004259543027728796, -0.025070849806070328, 0.016037560999393463, -0.004259543027728796, -0.03235306963324547, -0.03182496875524521, 0.05581182613968849, 0.017969295382499695, -0.018566882237792015, 0.012931499630212784, 0.04333198815584183, 0.03315911814570427, 0.001792760333046317, 0.01924785226583481, 0.03176937997341156, -0.03143584355711937, 0.017913704738020897, -0.03793980926275253, -0.04730663448572159, 0.017038172110915184, 0.019150571897625923, -0.028711959719657898, -0.03849570453166962, -0.012820321135222912, -0.012417296878993511, -0.009491901844739914, -0.02534879744052887, -0.0238895732909441, -0.07321132719516754, 0.014481056481599808, -0.010416076518595219, -0.03449326381087303, -0.0067436969839036465, -0.025779614225029945, 0.014300390146672726, -0.0356050543487072, 0.004162261262536049, 0.007817268371582031, 0.034326497465372086, 0.041997842490673065, 0.01913667470216751, 0.0338817797601223, -0.032797783613204956, -0.005680548492819071, -0.044388189911842346, 0.05058641359210014, 0.02700258418917656, 0.018163857981562614, 0.014369877055287361, -0.02304183319211006, 0.014022442512214184, 0.010624537244439125, -0.05495018884539604, -0.008491290733218193, -0.009672567248344421, -0.006180853582918644, -0.004610451404005289, -0.037300530821084976, -0.02666904591023922, 0.01357077807188034, 0.004971783142536879, 0.037439506500959396, -0.009860181249678135, -0.03857909142971039, 0.038301143795251846, -0.03741171211004257, 0.0077269356697797775, -0.0023833983577787876, 0.055228136479854584, -0.017566271126270294, 0.033131323754787445, 0.037495095282793045, 0.002939293161034584, -0.01714934967458248, 0.022319171577692032, 0.03410413861274719, -0.01114568766206503, 0.011708531528711319, -0.02026236057281494, 0.041803278028964996, 0.00679928669705987, -0.035243723541498184, 0.002531057922169566, 0.016246020793914795, -0.018149960786104202, -0.007560167461633682, -0.027099864557385445, 0.013723650015890598, -0.03496577590703964, -0.00212455983273685, 0.037022583186626434, -0.0076713464222848415, 0.015870792791247368, 0.03327029570937157, 0.03718935325741768, -0.010881638154387474, -0.028086578473448753, -0.01152091659605503, -0.004818911664187908, 0.02144363708794117, -0.022221889346837997, 0.005037795286625624, -0.04297065734863281, -0.03999662026762962, -0.002676980337128043, -0.005214986857026815, 0.007914550602436066, -0.02568233385682106, 0.006132212933152914, -0.04222020134329796, -0.00514549994841218, -0.00949885044246912, -0.01581520400941372, -0.012868961319327354, -0.017760833725333214, -0.010297948494553566, 0.008922109380364418, 0.02010948956012726, -0.028823139145970345, 0.009749002754688263, 0.002984459511935711, -0.009943566285073757, 0.048946525901556015, -0.051003336906433105, -0.06281609833240509, 0.04071928560733795, 0.046417202800512314, -0.057090383023023605, -0.000450795836513862, -0.026224330067634583, 0.012716090306639671, 0.07921499013900757, -0.002058547455817461, 0.026293817907571793, -0.01343875378370285, 0.000949363864492625, -0.008150805719196796, -0.03885703533887863, -0.014508850872516632, -0.007706089876592159, -0.005100333597511053, 0.02912888117134571, -0.04269270971417427, 0.05108672007918358, 0.011103996075689793, 0.025696231052279472, -0.038690268993377686, 2.1321056919987313e-05, -0.007198835723102093, 0.04647279530763626, 0.014647824689745903, -0.0434153750538826, -0.004370721988379955, 0.0016346777556464076, 0.051197897642850876, 0.005961970426142216, 0.014981361106038094, -0.00021703778475057334, -0.011166534386575222, 0.00724747683852911, 0.009179210290312767, -0.018566882237792015, 0.014717311598360538, -0.022027326747775078, -0.03243645280599594, 0.055700644850730896, -0.007184938527643681, 0.00037305743899196386, -0.03415972739458084, -0.045305415987968445, -0.05394957587122917, -0.020095592364668846, 0.010666228830814362, 0.0329645536839962, -0.003964223898947239, -0.018233345821499825, 0.012813371606171131, -0.022055121138691902, -0.01734391413629055, 0.027766939252614975, -0.03621653839945793, 0.0252098236232996, -0.0043325042352080345, 0.034576646983623505, -0.008505187928676605, -0.04989154636859894, 0.05831335112452507, -0.015648433938622475, 0.02454274892807007, -0.09711480140686035, -0.014522748067975044, -0.05936954915523529, 0.017705244943499565, -0.022930655628442764, -0.014314287342131138, 0.01965087652206421, 0.01966477371752262, 0.03188055753707886, 0.04394347220659256, -0.009728156961500645, -0.03254763409495354, 0.03891262784600258, 0.0028194282203912735, -0.021262971684336662, 0.01449495367705822, 0.012389502488076687, -0.03655007481575012, -0.045972488820552826, 0.009561387822031975, -0.010867740958929062, 0.007789473980665207, 0.024904081597924232, -0.02077656239271164, 0.011236021295189857, 0.04399906098842621, -0.014897977001965046, -0.007421193644404411, -0.007108503021299839, -0.018094372004270554, -0.0013827879447489977, 0.0025779614225029945, -0.07321132719516754, -0.017038172110915184, -0.051253486424684525, -0.03368721529841423, 0.04035795107483864, 0.03599417954683304, 0.02818385884165764, 0.008977699093520641, -0.02079045958817005, 0.027030378580093384, -0.0023260717280209064, -0.026891404762864113, 0.026988685131072998, -0.0008981173159554601, -0.00038109184242784977, -0.01244509220123291, -0.011319405399262905, 0.02105451002717018, 0.004120569210499525, -0.03443767502903938, -0.029017701745033264, 0.009491901844739914, 0.01468951627612114, 0.028739754110574722, -0.033325884491205215, 0.05606197565793991, 0.06670735776424408, 0.027739142999053, -0.03799540176987648, -0.03488238900899887, -0.03210291638970375, -0.002115874085575342, -0.033520448952913284, 0.011381943710148335, 0.009193108417093754, 0.03413193300366402, -0.0008816142217256129, 0.030379643663764, 0.028420114889740944, -0.03315911814570427, 0.007358655799180269, -0.03507695347070694, 0.02455664612352848, -0.02654397115111351, 0.008407906629145145, 0.010784356854856014, 0.03969087824225426, 0.07815878838300705, -0.01635720022022724, -0.013049627654254436, -0.005923752672970295, -0.01104840636253357, -0.04930785670876503, 0.025571154430508614, 0.01238255389034748, -0.020762665197253227, 0.05317132547497749, -0.02780863083899021, 0.009241748601198196, 0.04124738276004791, 0.019623082131147385, -0.015495563857257366, -0.047890324145555496, -0.03791201487183571, 0.017455091699957848, 0.013640264980494976, 0.006938260514289141, -0.03182496875524521, 0.03777304291725159, -0.012472886592149734, -0.045305415987968445, 0.03552166745066643, -0.018483497202396393, 0.012167144566774368, -0.022611016407608986, -0.0067436969839036465, 0.008261984214186668, -0.013028780929744244, -0.005117705091834068, 0.011875299736857414, 0.031074510887265205, 0.01188224833458662, -0.010756561532616615, -0.03899601101875305, 0.0833842009305954, -0.01538438443094492, 0.027850322425365448, -0.005340063013136387, -0.026238229125738144, -0.013577727600932121, 0.003522982355207205, 0.0020498614758253098, 0.013688906095921993, 0.01931734010577202, 0.006514390464872122, 0.00011280753096798435, 0.007014696020632982, 0.019581388682127, -0.03680022805929184, -0.028628574684262276, 0.013820931315422058, -0.04177548363804817, -0.020957229658961296, -0.004363772924989462, 0.004864078480750322, -0.025307103991508484, 0.019275646656751633, -0.015926381573081017, 0.028628574684262276, -0.021554816514253616, 0.0116876857355237, 0.016843607649207115, 0.03857909142971039, 0.04713986814022064, 0.015620640479028225, -0.019706465303897858, 0.00017230563389603049, -0.019414620473980904, 0.0010978919453918934, -0.036105357110500336, 0.04055251553654671, -0.01667683944106102, -0.01144448108971119, -0.012862012721598148, -0.0277947336435318, -0.017621861770749092, 0.00926259532570839, -0.015856895595788956, 0.010784356854856014, -0.03240865841507912, -0.026627354323863983, 0.04725104570388794, 0.008769238367676735, -0.00979764387011528, 0.0016381520545110106, -0.013862622901797295, -0.013369266875088215, 0.038023196160793304, -0.06387230008840561, -0.010436922311782837, -0.019275646656751633, 0.01495356671512127, -0.0043325042352080345, 0.013417907059192657, -0.022541528567671776, -0.03482680022716522, -0.029434623196721077, 0.05942513793706894, -0.007587962318211794, -0.027516786009073257, -0.019498005509376526, -0.003232874907553196, 0.026307715103030205, 0.012097657658159733, -0.0238895732909441, -0.12240800261497498, -0.03463223949074745, -0.03919057548046112, 0.026113152503967285, -0.021540917456150055, 0.02052641101181507, 0.010992816649377346, -0.018566882237792015, 0.016315508633852005, -0.01333452295511961, -0.007021644618362188, -0.025598948821425438, -0.006924362853169441, 0.007636602967977524, 0.010332692414522171, 0.008407906629145145, -0.0025883845519274473, 0.003083478193730116, -0.04591690003871918, 0.03949631750583649, -0.009811541065573692, -0.007455937098711729, 0.013786187395453453, 0.04472172632813454, -0.026043664664030075, -0.021068407222628593, -0.03880144655704498, -0.0364110991358757, -0.013466548174619675, -0.022791681811213493, 0.02277778461575508, 0.010165923275053501, -0.007977088913321495, -0.010026950389146805, -0.018316728994250298, -0.002306962851434946, 0.011722428724169731, -0.052115123718976974, 0.023125218227505684, 0.027238838374614716, -0.01846960000693798, 0.025446077808737755, 0.020901639014482498, -0.029768159613013268, 0.03004610724747181, 0.012521527707576752, -0.010284051299095154, -0.0013845250941812992, -0.02818385884165764, 0.020665384829044342, -0.024709517136216164, -0.003960749600082636, 0.011507019400596619, -0.03585520759224892, -0.01602366380393505, -0.020220668986439705, -0.02063758857548237, -0.02184665948152542, 0.012500680983066559, 0.021471431478857994, 0.01459223497658968, -0.06281609833240509, 0.005430396180599928, 0.06609587371349335, -0.02244424633681774, -0.04713986814022064, 0.01353603508323431, -0.019623082131147385, 0.009359876625239849, 0.005590215791016817, -0.00983238685876131, -0.01808047480881214, -0.009484952315688133, 0.04638940840959549, -0.009276492521166801, -0.0048223864287137985, -0.010513357818126678, -0.04380450025200844, 0.0434153750538826, -0.00349866203032434, -0.00037805180181749165, 0.018650265410542488, -0.0037383916787803173, 0.0004911850555799901, 0.0037453402765095234, 0.017649656161665916, -0.011833608150482178, -0.03969087824225426, -0.02918446995317936, -0.005385229364037514, 0.010117283090949059, 0.07437870651483536, -0.017885910347104073, -0.006906991358846426, -0.015217616222798824, 0.036438893526792526, -0.02846180647611618, -0.002590121701359749, 0.01965087652206421, -0.026432791724801064, -0.03685581684112549, -0.0011682474287226796, -0.016982581466436386, -0.038745857775211334, -0.004429785534739494, 0.03335367888212204, 0.011826658621430397, -0.005895957816392183, -0.013827879913151264, 0.004506221041083336, -0.0190671868622303, 0.00016144831897690892, -0.029017701745033264, 0.032186299562454224, 0.007219681981950998, 0.029795954003930092, -0.028281141072511673, 0.025598948821425438, 0.008373163640499115, -0.013278934173285961, 0.03315911814570427, -0.025321001186966896, -0.037105970084667206, -0.03124128095805645, -0.05998103320598602, 0.0007852012058719993, -0.01052725501358509, 0.0194702111184597, -0.01307742204517126, 0.011409738101065159, -0.02190225012600422, 0.007455937098711729, -0.020998921245336533, -0.014578337781131268, -0.039079394191503525, 0.009978309273719788, 0.0017910231836140156, -0.001973425969481468, 0.027280529960989952, 0.016120946034789085, 0.07749171555042267, 0.005624959245324135, -0.027961501851677895, -0.014661721885204315, 0.01620432920753956, 0.025835204869508743, -0.01158345490694046, 0.004964834079146385, -0.04374891147017479, 0.013056576251983643, -0.024111930280923843, -0.021026715636253357, 0.03449326381087303, -0.023681113496422768, 0.012507629580795765, -0.05217071622610092, -0.011757172644138336, 0.006840978749096394, -0.020484717562794685, 0.027919810265302658, 0.010839945636689663, 0.008394009433686733, -0.009915770962834358, -0.012153247371315956, -0.02111010067164898, -0.0018969905795529485, 0.011618198826909065, -0.0009207005496136844, 0.017052069306373596, 0.007483731955289841, 0.047612376511096954, -0.02243034914135933, -0.07743612676858902, -0.024014649912714958, 0.004867552779614925, -0.011242969892919064, -0.012896756641566753, -0.03566064313054085, -0.02476510778069496, -0.011993427760899067, 0.02726663276553154, 0.033909574151039124, -0.04322081059217453, -0.009304286912083626, -0.012215785682201385, -0.036633457988500595, 0.041191793978214264, -0.00544429337605834, -0.012236631475389004, 0.04208122566342354, 0.019567491486668587, 0.003672379069030285, -0.025960281491279602, -0.0320473276078701, -0.02098502404987812, -0.020276257768273354, 0.012959294021129608, -0.008623315952718258, -0.019692568108439445, -0.045694541186094284, 0.0021193483844399452, -0.01680191606283188, -0.01667683944106102, 0.004999577533453703, 0.0186641626060009, 0.019164469093084335, -0.001279426272958517, -0.009213954210281372, 0.036299921572208405, -0.04839063063263893, 0.012194938957691193, 0.007386450190097094, -0.0089012635871768, -0.0016668153693899512, -0.01174327451735735, -0.028100475668907166, 0.004843232221901417, 0.017038172110915184, 0.015870792791247368, -0.007782525382936001, 0.010603690519928932, -0.017121555283665657, -0.011083150282502174, -0.018219446763396263, 0.012757782824337482, -0.033325884491205215, -0.013410958461463451, 0.017774732783436775, -0.010471666231751442, 0.0038287246134132147, -0.02990713343024254, -0.020568102598190308, 0.005958496127277613, -0.003974646795541048, 0.016176534816622734, -0.03382619097828865, 0.0242925975471735, -0.0058542657643556595, -0.041803278028964996, -0.004158786963671446, -0.005551998037844896, 0.03655007481575012, 0.009123621508479118, 0.009589183144271374, -0.008373163640499115, 0.010909432545304298, 0.01449495367705822, 0.06709648668766022, -0.0068340301513671875, 0.01339706126600504, -0.012723038904368877, -0.0010405653156340122, -0.014981361106038094, -0.0365222804248333, 0.023083526641130447, 0.021596508100628853, -0.04174768924713135, -0.01924785226583481, -0.027322223410010338, -0.017330016940832138, -0.012632706202566624, -0.004770271014422178, -0.04989154636859894, -0.030629796907305717, -0.006469224113970995, 0.014147519133985043, -0.0032346120569854975, 0.008046574890613556, -0.004492323845624924, -0.022875064983963966, -0.09539152681827545, -0.000979764387011528, 0.011208225972950459, -0.0033718484919518232, 0.03938513621687889, -0.02898990735411644, 0.019164469093084335, 0.01694088988006115, -0.007400347851216793, -0.06081487610936165, 0.016162637621164322, 0.00923480000346899, 0.012966242618858814, -0.014703413471579552, 0.007268322631716728, -0.0467507429420948, 0.0416921004652977, -0.03963528946042061, 0.023542139679193497, -0.000615827040746808, 0.00027751302695833147, 0.014564440585672855, -0.00729611748829484, 0.036105357110500336, -0.02839232049882412, 4.1474952013231814e-05, 0.023611625656485558, 0.02476510778069496, 0.012222734279930592, 0.0063406736589968204, 0.016259919852018356, -0.04547218233346939, 0.00857467483729124, 0.041997842490673065, -0.03738391771912575, -0.0045930794440209866, -0.016954787075519562, 0.009742054156959057, -0.010457768104970455, 0.002689140383154154, 0.022319171577692032, -0.06209343299269676, 0.03340926766395569, 0.001731959288008511, 0.042386967688798904, -0.041997842490673065, 0.019206160679459572, -0.014856284484267235, 0.00015384818834718317, -0.010937227867543697, 0.02330588363111019, 0.01873365044593811, -0.0164822768419981, -0.030101696029305458, 0.021610405296087265, -0.0023434434551745653, 0.001582562574185431, -0.004495798144489527, -0.0015182873466983438, 0.008025729097425938, -0.03574402630329132, 0.030268464237451553, 0.008790084160864353, -0.041469741612672806, -0.01952579990029335, -0.011923940852284431, -0.007782525382936001, 0.03340926766395569, -0.0016259918920695782, -0.042664915323257446, -0.010318794287741184, 0.017719142138957977, -0.01300098653882742, 0.01569012738764286, -0.01713545247912407, 0.0086997514590621, 0.00041170947952196, 0.017649656161665916, -0.015620640479028225, 0.013056576251983643, 0.03168599680066109, -0.03243645280599594, 0.002590121701359749, 0.023875676095485687, -0.009255645796656609, 0.03607756271958351, -0.00024276961630675942, -0.021360252052545547, -0.016649045050144196, 0.02251373417675495, 0.03991323709487915, 0.004739001858979464, 0.003542091231793165, -0.02654397115111351, -0.005972393322736025, -0.021624302491545677, -0.01912277564406395, 0.024000752717256546, 0.028114372864365578, 0.0012359970714896917, 0.047167662531137466, 0.03354824334383011, -0.007476783357560635, -0.0077269356697797775, 0.010631485842168331, 0.0008438307559117675, 0.0009545753709971905, -0.01244509220123291, 0.02350044623017311, -0.006125264335423708, 0.0021141369361430407, 0.004784168675541878, -0.025056952610611916, 0.002548429649323225, -0.02937903255224228, 0.03407634422183037, 0.037439506500959396, 0.0173995029181242, 0.022791681811213493, -0.02249983698129654, -0.005611061584204435, 0.005253204610198736, -0.011632096022367477, 0.025446077808737755, -0.012667450122535229, -0.024195315316319466, 0.023347575217485428, 0.02149922586977482, -0.032075121998786926, 0.024653928354382515, 0.045305415987968445, -0.019539697095751762, 0.0194702111184597, 0.0038738909643143415, -0.00863721314817667, 0.029073290526866913, 0.015704024583101273, 0.016968684270977974, -0.03932954743504524, 0.011791915632784367, 0.005322691518813372, 0.004127517808228731, -0.013855674304068089, 0.015870792791247368, -0.018761444836854935, 0.024278700351715088, 0.003609840990975499, -0.03254763409495354, -0.004033710807561874, 0.015495563857257366, 0.037105970084667206, -0.011173482984304428, -0.0020898166112601757, -0.006246866192668676, 0.0168853010982275, 0.018372317776083946, 0.026752430945634842, -0.047278840094804764, -0.023069629445672035, 0.028086578473448753, -0.01343875378370285, 0.024667825549840927, -0.00012257912021595985, -0.025654539465904236, 0.022333068773150444, -0.04121958836913109, -0.025654539465904236, -0.0018396639497950673, -0.021068407222628593, 0.002544955350458622, -0.015648433938622475, -0.0521429181098938, 0.03368721529841423, 0.028364526107907295, 0.015259308740496635, 0.01787201315164566, 0.017163248732686043, 0.021096203476190567, -0.0014861496165394783, 0.03563284873962402, 0.03693920001387596, 0.03354824334383011, -0.030101696029305458, 0.0016833185218274593, 0.05572843924164772, -0.00524625601246953, -0.0015869055641815066, -0.010179821401834488, -0.0011456641368567944, 0.042915068566799164, 0.03343706578016281, 0.010631485842168331, 0.0164822768419981, 0.055506084114313126, 0.009130570106208324, -0.009887976571917534, 0.006048828829079866, 0.015439974144101143, -0.00020748334645759314, -0.0546722412109375, -0.023319780826568604, 0.04002441465854645, -0.017455091699957848, 0.003992018755525351, -0.03057420626282692, 0.05217071622610092, 0.011569557711482048, -0.025321001186966896, 0.031074510887265205, 0.03527151793241501, 0.0028576459735631943, -0.00584036810323596, -0.021860558539628983, 0.014981361106038094, -0.009811541065573692, -0.036438893526792526, 0.014800695702433586, 0.024209212511777878, -0.053504861891269684, -0.015787407755851746, -0.029795954003930092, -0.009408516809344292, 0.011381943710148335, 0.01852519065141678, -0.006941734813153744, -0.002953190356492996, 0.029879339039325714, 0.00504474388435483, -0.0004946594126522541, 0.01813606359064579, 0.0030018312390893698, 0.03899601101875305, -0.023722805082798004, -0.015995869413018227, 0.012153247371315956, -0.012764731422066689, 0.0088734682649374, -0.021957838907837868, 0.0004260411369614303, 0.020929433405399323, 0.04096943512558937, 0.014981361106038094, -0.014022442512214184, -0.013244190253317356, 0.02416752092540264, -0.005961970426142216, 0.02124907448887825, 0.05572843924164772, -0.01713545247912407, -0.02508474700152874, -0.015981972217559814, 0.013098267838358879, 0.026057561859488487, -0.02124907448887825, -0.010742664337158203, -0.014856284484267235, 0.010839945636689663, 0.023208601400256157, 0.03618874400854111, 0.01681581325829029, -0.02860078029334545, 0.019901029765605927, 0.014439363963901997, -0.003474341705441475, 0.005663176998496056, -0.03271440044045448, -0.006417109165340662, 0.023319780826568604, 0.005868162959814072, 0.014453261159360409, -0.03785642609000206, 0.030351849272847176, 0.008331471122801304, 0.024000752717256546, 0.017107658088207245, 0.01290370523929596, 0.010402179323136806, -0.0233753714710474, 0.02659955993294716, 0.016120946034789085, -0.03201953321695328, -0.01463392749428749, -0.02104061283171177, -0.03129686787724495, 0.006135687232017517, -0.02416752092540264, 0.019817644730210304, -0.010541152209043503, 0.010916381143033504, 0.011117893271148205, 0.04547218233346939, 0.04436039552092552, -0.010138128884136677, 0.013251138851046562, -0.006597775034606457, -0.013167754746973515, -0.007706089876592159, 0.0035212452057749033, 0.033909574151039124, 0.007970139384269714, 0.013584676198661327, -0.007713038474321365, -0.005065590143203735, 0.0005168083007447422, 0.025043055415153503, 0.014147519133985043, 0.011409738101065159, -0.026585662737488747, -0.016704633831977844, -0.0016624724958091974, -0.013278934173285961, -0.006021033972501755, -0.0012690032599493861, 0.017621861770749092, 0.02633550949394703, -0.017330016940832138, -0.014467158354818821, -0.012403399683535099, 0.0034152779262512922, -0.0002818559587467462, 0.01905328966677189, -0.00434987572953105, -0.0020672332029789686, 0.03882924094796181, -0.011833608150482178, -0.037967607378959656, -0.0028698062524199486, -0.02390347048640251, 0.007831166498363018, 0.00026947862352244556, -0.012785577215254307, 0.035716231912374496, 0.02177717350423336, -0.014772900380194187, -0.019511902704834938, 0.0064900703728199005, -0.04608366638422012, 0.010158974677324295, -0.012201887555420399, 0.009540542028844357, 0.020401334390044212, 0.011576506309211254, 0.015801304951310158, -0.02131856046617031, -0.016565661877393723, 0.010839945636689663, 0.002456359565258026, -0.00415183836594224, -0.04069149121642113, -0.018344523385167122, 0.08193887025117874, -0.019956618547439575, -0.012194938957691193, 0.010819099843502045, -0.011354148387908936, 0.013709751889109612, -0.00504821864888072, -0.0004499272326938808, -0.045972488820552826, 0.028823139145970345, 0.002779473317787051, 0.0233753714710474, -0.016037560999393463, -0.00992966815829277, 0.003555988660082221, 0.00729611748829484, 0.00519414059817791, 0.0005654491251334548, 0.030546411871910095, 0.021485328674316406, 0.025696231052279472, 0.03885703533887863, 0.008553829044103622, -0.011041457764804363, 0.005055167246609926, -0.000959786877501756, -0.01528710313141346, 0.003090426791459322, 0.0017024273984134197, 0.055756233632564545, -0.025265412405133247, -0.017316119745373726, -0.04302624613046646, 0.007101554423570633, -0.040274567902088165, 0.007997934706509113, -0.023014038801193237, 0.013549932278692722, -0.0007257031393237412, 0.0006054040277376771, 0.03780083730816841, -0.0034899762831628323, -0.004787642974406481, 0.026224330067634583, 0.01799708977341652, 0.013376215472817421, -0.012674398720264435, 0.02860078029334545, 0.014620029367506504, 0.022263580933213234, 0.018094372004270554, 0.004214376211166382, 0.009151415899395943, -0.006719376891851425, 0.010103385895490646, -0.029156675562262535, -0.013716700486838818, 0.02851739712059498, 0.008880416862666607, 0.005802150350064039, -0.044304803013801575, 0.014717311598360538, -0.03999662026762962, -0.018094372004270554, 0.016384994611144066, -0.050475236028432846, -0.00554504944011569, 0.0016659467946738005, -0.013647214509546757, 0.056756846606731415, -0.018552985042333603, 0.018886521458625793, -0.026905301958322525, 0.00959613174200058, -0.012771680019795895, -0.002725620986893773, -0.02489018440246582, 0.017316119745373726, 0.014481056481599808, 0.044971879571676254, -0.020290154963731766, 8.21898938738741e-05, -0.01088858675211668, 0.013549932278692722, 0.007990986108779907, 0.010138128884136677, 0.04360993579030037, 0.0017614911776036024, -0.022485939785838127, 0.028017090633511543, 0.0040962486527860165, 0.017983192577958107, 0.040080007165670395, 0.028739754110574722, 0.002779473317787051, -0.015981972217559814, 0.0028454859275370836, 0.011374994181096554, 0.01602366380393505, -0.002522371942177415, -0.014314287342131138, -0.007511526811867952, 0.03793980926275253, 0.00027447298634797335, -0.015578947961330414, 0.02462613396346569, -0.046417202800512314, -0.013459599576890469, 0.008428752422332764, 0.0026561343111097813, -0.008671957068145275, 0.016051458194851875, 0.022013429552316666, -0.0002751244173850864, -0.03440988063812256, -0.005301845259964466, -0.01482849009335041, 0.030101696029305458, 0.01627381704747677, -0.029934927821159363, 0.028823139145970345, -0.022152401506900787, 0.02362552285194397, -0.009158364497125149, 0.004377670586109161, 0.01049251202493906, 0.014015493914484978, 0.0031060613691806793, -0.025710128247737885, -0.006931311450898647, -0.013848725706338882, 0.004620874300599098, 0.020206771790981293, 0.0017206677002832294, 0.019636979326605797, 0.028017090633511543, -0.008970750495791435, -0.011131790466606617, -0.03535490110516548, 0.0019369454821571708, -0.006906991358846426, 0.004297760780900717, -0.007608808111399412, 0.02489018440246582, -0.005937649868428707, -0.021624302491545677, 0.00673674838617444, -0.01859467662870884, 0.03282558172941208, 0.0012811635388061404, -0.0064935446716845036, 0.036966994404792786, 0.011465327814221382, 0.01681581325829029, 0.011027560569345951, -0.03866247460246086, 0.023333678022027016, -0.016857504844665527, 0.01674632728099823, -0.01999831013381481, 0.013688906095921993, -0.008727545849978924, -0.01820554956793785, 0.012855064123868942, 0.042331378906965256, 0.01792760379612446, -0.024056341499090195, -0.005190666299313307, -0.019178366288542747, -0.0040476080030202866, 0.006639467086642981, 0.017260529100894928, 0.024501057341694832, -0.0009328607120551169, 0.015620640479028225, -0.006563031580299139, -0.015565050765872002, -0.00439851637929678, -0.010874689556658268, 0.011124841868877411, -0.013369266875088215, -0.03124128095805645, 0.018372317776083946, 0.013445702381432056, 0.004516643937677145, -0.004127517808228731, 0.023444857448339462, 0.011437532491981983, 0.0005024766433052719, -0.017983192577958107, 0.004009390249848366, -0.006316353101283312, 0.017885910347104073, 0.01104840636253357, 0.017288323491811752, 0.03185276314616203, 0.020679282024502754, -0.01701037585735321, 0.05272660776972771, 0.024278700351715088, -0.001510470057837665, -0.01845570281147957, 0.007796422578394413, 0.033047936856746674, -0.007351706735789776, 0.026905301958322525, -3.27890993503388e-05, 0.00926259532570839, -0.004808488767594099, -0.008526034653186798, 0.002614442026242614, -0.016843607649207115, 0.008512137457728386, -0.0012429457856342196, 0.011694634333252907, -0.012389502488076687, 0.019206160679459572, 0.008324522525072098, -0.03407634422183037, -0.011013663373887539, -0.004818911664187908, -0.013959905132651329, 0.0199844129383564, -0.009714258834719658, -0.009526644833385944, 0.011215174570679665, 0.03593859076499939, 0.001561716548167169, -0.008164702914655209, -0.0023868726566433907, 0.010179821401834488, -0.032269686460494995, -0.016843607649207115, -0.0024216161109507084, 0.003212028881534934, 0.014717311598360538, -0.009637823328375816, 0.00027469013002701104, 0.013160806149244308, 0.0127786286175251, -0.05736833065748215, 0.023722805082798004, 0.0055658952333033085, 0.00844265054911375, 0.003752289107069373, 0.06003662571310997, -0.0002451582404319197, 0.0030574207194149494, -0.0589248351752758, 0.03251983970403671, 0.011750223115086555, 0.022124607115983963, -0.0138973668217659, -0.04625043645501137, 0.03251983970403671, -0.01853908784687519, 0.010235410183668137, -0.026960890740156174, -0.02441767230629921, 0.03999662026762962, -0.029295649379491806, -0.025696231052279472, 0.00017729999672155827, -0.010513357818126678, 0.004030236508697271, 0.02951800636947155, -0.03932954743504524, 0.010839945636689663, -0.027627965435385704, -0.0016077515901997685, 0.00045036154915578663, 0.01972036249935627, -0.006986901164054871, -0.004235222470015287, 0.0015069956425577402, 0.02898990735411644, 0.010374384000897408, 0.00963087473064661, 0.02290285937488079, -0.03151922672986984, 0.03646669164299965, -0.01880313642323017, -0.004916193429380655, 0.013410958461463451, 0.005284473765641451, -0.0047285789623856544, -0.04413803666830063, -0.020012207329273224, -0.011993427760899067, 0.011020611971616745, -0.027169352397322655, 0.00863721314817667, 0.006514390464872122, -0.046695150434970856, 0.010867740958929062, 0.017121555283665657, -0.0038947369903326035, -0.026585662737488747, -0.017246631905436516, 0.022249683737754822, -0.018747547641396523, 0.001371496357023716, 0.014772900380194187, 0.02158261090517044, 0.02740560658276081, 0.005732663907110691, -0.020067797973752022, 0.017913704738020897, -0.011069252155721188, 0.02111010067164898, 0.004356824327260256, 0.024834593757987022, 0.019289545714855194, 0.010020001791417599, 0.00430123507976532, 0.016120946034789085, 0.008546880446374416, 0.009825438261032104, -0.006066200323402882, 0.0169964786618948, -0.028572985902428627, -0.010381332598626614, -0.007004272658377886, -0.005475562531501055, 0.04652838408946991, -0.010944176465272903, -0.020609794184565544, 0.02163819968700409, 0.004085825756192207, 0.0005406943964771926, 0.034326497465372086, 0.016190432012081146, 0.005882060620933771, 0.014508850872516632, 0.0116876857355237, 0.01409192942082882, -0.031185690313577652, 0.020012207329273224, 0.023347575217485428, -0.024501057341694832, -0.022472042590379715, 0.025001361966133118, 0.009700361639261246, -0.02063758857548237, -0.004280388820916414, 0.02898990735411644, -0.004784168675541878, 0.023055730387568474, -0.010666228830814362, 0.034771211445331573, -0.0005806493572890759, 0.03666125237941742, -0.012820321135222912, -0.01687140390276909, -0.0004976994241587818, 0.017760833725333214, 0.002522371942177415, -0.03693920001387596, -0.026196535676717758, -0.008720597252249718, -0.04366552457213402, -0.021888352930545807, -0.0030886896420270205, 0.022624913603067398, -0.013188600540161133, -0.006264238152652979, -0.01114568766206503, -0.016954787075519562, -0.00025102117797359824, -0.037967607378959656, 0.014147519133985043, 0.049669187515974045, 0.024528851732611656, 0.0255572572350502, -0.014995258301496506, -0.021930044516921043, -0.03885703533887863, -0.03224189206957817, 0.018149960786104202, 0.005819522310048342, 0.013126063160598278, -0.032214097678661346, -0.004197004716843367, -0.020595896989107132, 0.019553594291210175, -0.008331471122801304, 0.004853655118495226, 0.033464860171079636, -0.019442416727542877]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" and the dataset collected in online iteration t.
Σoff,Σt The covariance matrix with DoffandDt.
σ(·) σ(z) = 1 /(1 + exp( −z)) is the sigmoid function.
Ccov(Doff, πref, α) The coverage of the offline dataset defined in Definition 2.
Rejection Sampling See Appendix A.1 for an introduction.
Best-of-n Policy See Appendix A.1 for an introduction.
Table 4: The table of notations used in this paper.
A.1 Rejection Sampling
We briefly introduce the rejection sampling in this subsection. We first remark that in the literature, many
papers use this terminology to refer best-of-n policy (Touvron et al., 2023), which can be different from
the notion of rejection sampling here. Specifically, the best-of-n policy takes a base policy πand a reward
function ras the input, and output a new policy eπ: for each x∈ X, we sample nindependent policies from
πand output the one with the highest reward measured by r. In what follows, we introduce the rejection
sampling.
Rejection sampling, a widely utilized method in Monte Carlo tasks, is designed to sample from a target
distribution using samples from a proposal distribution and a uniform sampler (Neumann, 1951). This
technique is applicable when the density ratio between the target distribution qand the proposal distribution
pis bounded, satisfying q(x)/p(x)≤Mfor all x∈ X. In practical implementation, nsamples are drawn
from the proposal distribution p. Each sample, denoted as x∼p, is accepted with a probability r=q(x)
Mp(x).
This acceptance is determined by evaluating whether u < r , where uis a number drawn from a uniform
distribution U[0,1]. The accepted samples exare then representative of the target distribution q.
The primary challenge in rejection sampling is its low acceptance rate, particularly problematic for high-
dimensional data due to the curse of dimensionality, where the density ratio often scales with exp( d). This
issue persists even in low-dimensional scenarios, as a large density ratio Mcan drastically reduce acceptance
rates. The method is most efficient when pclosely approximates q, leading to M≈1.
32
A.2 Organization of the Appendix
In the appendix, we need to formally prove Theorem 1, 2, and 3. To distinguish them, we refer the first
theorem as the offline setting, the second setting as the hybrid learning to stress the requirement of a diverse
offline Doffand finally, we refer Theorem 3 as the online learning where we may start from scratch. While we
mainly focus on the batch learning setting to match the practical applications, we also develop the results
of sequential setting with m= 1 in case that readers are interested in the technique for completeness. The
map of the appendix is as follows.
•We develop the pure online framework in Appendix B, where we do not make any assumption on Doff.
We also provide the proof of Theorem 3 in this section;
•We study the offline learning in Appendix C with the proof of Theorem 1;
•We study the hybrid learning in Appendix D and prove Theorem 2;
•We study the coverage condition for DPO to converge in Appendix E;
•We provide the proof of some technical Lemmas in Appendix F, as well as some existing technical
Lemma in Appendix G;
•We provide the additional experimental details, hyper-parameters, and illustrating examples in Ap-
pendix H.
B Proof of Online Learning
In this section, we develop the online framework of the KL-constraint contextual bandit, that is missing in
the main paper.
B.1 Batch Online Learning
We first consider the case of m > 1, which leads to a more sparse update of the model. Our goal is also to
design a sample-efficient algorithm, which finds a policy ˆ πso that the suboptimality J(π∗)−J(ˆπ)< ϵwith
the number of samples polynomial in the accuracy number 1 /ϵ, feature dimension d, and other problem-
dependent parameters. In practical applications, it is observed that the diversity of the outputs is critical,
and the response pairs ( a1
t, a2
t) are recommended to be collected by different model variants with different
temperature hyper-parameter (Touvron et al., 2023).
Proof of Theorem 3. Recall the definition of the covariance matrix:
Σt,m=λI+1
mt−1X
i=1mX
j=1(ϕ(xi,j, a1
i,j)−ϕ(xi,j, a2
i,j))(�","[0.030720146372914314, -0.01546564046293497, 0.015703167766332626, 0.030825713649392128, 0.0005402087699621916, 0.01201490219682455, -0.020348137244582176, -0.0031307365279644728, -0.050804365426301956, 0.0387696698307991, 0.024834757670760155, -0.051886431872844696, 0.004410742782056332, -0.0024874345399439335, 0.036684710532426834, -0.003239603014662862, 0.03855853155255318, -0.03167025372385979, 0.009567055851221085, 0.04061710089445114, -0.035206764936447144, -0.04980147257447243, 0.033359333872795105, 0.016560902819037437, 0.029163025319576263, -0.024979911744594574, 0.021601751446723938, 0.0038763070479035378, 0.03473171219229698, -0.03845296427607536, 0.03837379068136215, -0.03457336127758026, -0.08667092770338058, -0.021799691021442413, -0.01984669268131256, 0.05075158178806305, -0.002296093385666609, 0.041276898235082626, -0.018619470298290253, 0.029611686244606972, -0.032039739191532135, -0.04014204442501068, -0.05259901285171509, 0.012034696526825428, 0.00420620571821928, 0.020955150946974754, -0.013618208467960358, -0.01873823255300522, 0.005628068000078201, 0.02781703881919384, -0.051332201808691025, -0.0015736157074570656, -0.042200613766908646, -0.026167547330260277, -0.009969531558454037, -0.003376510925590992, 0.01108458824455738, 0.014383573085069656, 0.03898080438375473, -0.05310045927762985, 0.019200090318918228, -0.004829713609069586, -0.00043670309241861105, 0.03264675289392471, -0.01386893168091774, 0.0034639339428395033, -0.010081697255373001, 0.04953755438327789, -0.023211656138300896, 0.021641340106725693, 0.020941954106092453, 0.020268961787223816, 0.02434650808572769, -0.017247091978788376, -0.029954781755805016, 0.018249982967972755, 0.03037705086171627, 0.058853887021541595, -0.021654535084962845, -0.041883908212184906, 0.03143272548913956, 0.0032346544321626425, 0.05610913038253784, -0.01938483491539955, -0.015610795468091965, -0.06418504565954208, -0.032805103808641434, -0.019200090318918228, -0.021482989192008972, 0.0348636694252491, 0.004328268114477396, 0.04510371759533882, -0.002957539865747094, 0.018856996670365334, -0.0031719738617539406, 0.017999259755015373, 0.0061987922526896, -0.02038772590458393, 0.03496923670172691, 0.006525391712784767, 0.0014226872008293867, -0.06038461625576019, 0.029638078063726425, -0.037687599658966064, 0.052123960107564926, -0.02541537769138813, -0.013103567063808441, 0.015848321840167046, 0.005895285867154598, -0.011869747191667557, -0.07336942106485367, -0.054208915680646896, -0.03306902199983597, 0.04858744516968727, 0.0434146374464035, -0.05880110338330269, -0.033042632043361664, 0.015201721340417862, -0.01759018562734127, -0.02966446988284588, -0.008597154170274734, 0.009461488574743271, 0.003358366433531046, 0.034203872084617615, 0.014278005808591843, 0.007053229492157698, 0.005733635276556015, -0.06307658553123474, -0.0333065502345562, 0.007930759340524673, 0.02005782723426819, 0.014845430850982666, -0.014621100388467312, -0.06107080355286598, -0.06481844931840897, 0.028397660702466965, 0.014673884026706219, 0.02069123275578022, -0.006594670470803976, -0.014119654893875122, -0.032963454723358154, -0.04782208427786827, -0.020585665479302406, -0.01336748618632555, -0.03349129110574722, 0.027104457840323448, -0.03779317066073418, 0.007132404949516058, 0.02046690136194229, 0.010972423478960991, 0.0008152616210281849, -0.012245831079781055, -0.018012456595897675, 0.01798606477677822, -0.009824376553297043, -0.029426943510770798, -0.05943450704216957, 0.04742620512843132, 0.028608795255422592, -0.003536511678248644, -2.878879604395479e-05, 0.07384447753429413, 0.03515398129820824, 0.008616948500275612, -0.001481244107708335, 0.0028569207061082125, -0.020651644095778465, 0.012021500617265701, -0.05616191402077675, -0.028872713446617126, 0.02982282266020775, 0.0325411856174469, -0.036315225064754486, -0.0007484571542590857, -0.007713026367127895, -0.03597212955355644, 0.0014226872008293867, -0.020796800032258034, 0.014502337202429771, -0.05642583593726158, 0.01927926577627659, 0.01619141735136509, 0.019793909043073654, -0.005855697672814131, -0.01984669268131256, 0.012140263803303242, -0.0009715509950183332, -0.03605130314826965, 0.0010647473391145468, 0.010490771383047104, 0.03998369351029396, 0.0016107292613014579, 0.007158796768635511, -0.024386094883084297, 0.01627059280872345, -0.05858996883034706, 0.02966446988284588, 0.04359938204288483, -0.007290756329894066, 0.02393743395805359, 0.0014185634208843112, -0.0011373249581083655, -0.016600491479039192, -0.034837279468774796, 0.0060470388270914555, 0.0030218700412660837, -0.004621877800673246, 0.00424579344689846, -0.0449189767241478, -0.0255605336278677, 0.002571558579802513, 0.017141524702310562, 0.023515162989497185, 0.01100541278719902, 0.00518930284306407, -0.023119285702705383, -0.05075158178806305, 0.02742116153240204, 0.0197543203830719, 0.058167699724435806, -0.017062349244952202, 0.04209504649043083, 0.015623991377651691, 0.006706835702061653, -0.007053229492157698, 0.008544370532035828, 0.0034507380332797766, -0.033755213022232056, 0.03919193893671036, -0.06439618021249771, 0.052414268255233765, 0.03306902199983597, 0.0058853887021541595, -0.0016057807952165604, 0.042965978384017944, -0.040564317256212234, -0.019793909043073654, -0.03581377863883972, -0.007350137922912836, -0.032277267426252365, -0.004024761263281107, 0.02845044434070587, -0.009078806266188622, 0.0064396183006465435, 0.008511380292475224, 0.025309810414910316, -0.02199763059616089, -0.015188525430858135, -0.015584403648972511, -0.018302766606211662, 0.013354290276765823, 0.0023752690758556128, -0.0031818707939237356, -0.029928389936685562, -0.04871940612792969, 0.017062349244952202, 0.01703595742583275, 0.005971162114292383, -0.022195568308234215, 0.004816517699509859, -0.039482250809669495, 0.011671807616949081, -0.011282527819275856, -0.021060718223452568, -0.016310179606080055, -0.022419899702072144, 0.0003284551785327494, -0.012773668393492699, 0.04586908221244812, 0.0008230966632254422, 0.007264364510774612, 0.01681162603199482, -0.04085462540388107, 0.014924607239663601, -0.05043487995862961, -0.01806524023413658, -0.008808289654552937, 0.06286545097827911, -0.02395062893629074, -0.041118547320365906, -0.01147386897355318, 0.007779005914926529, 0.054895106703042984, 0.018949368968605995, 0.04138246551156044, -0.017497815191745758, -0.00979798473417759, -0.013215732760727406, -0.01984669268131256, -0.03357046842575073, 0.0012165006482973695, -0.019727928563952446, -0.004872600547969341, -0.024781974032521248, -0.00298228207975626, -0.015069762244820595, -0.014753059484064579, -0.06640196591615677, -0.011922530829906464, 0.02348877117037773, 0.006284565664827824, 0.01712832786142826, -0.01819719932973385, 0.0488249734044075, -0.006776114460080862, 0.000626394699793309, 0.008643340319395065, 0.02618074230849743, -0.026668991893529892, -0.007970347069203854, -0.005915079731494188, 0.033042632043361664, -0.0275003369897604, 0.04373134300112724, 0.017326267436146736, 0.006921269930899143, 0.059698428958654404, -0.030086740851402283, -7.773232937324792e-05, -0.023686710745096207, -0.027210025116801262, -0.04586908221244812, -0.03233005106449127, 0.0340983048081398, 0.0248083658516407, -0.02881992980837822, -0.025362594053149223, -0.006268071010708809, 0.0031142416410148144, -0.028028173372149467, -0.005212395917624235, -0.026787756010890007, 0.02581125684082508, -0.005608274135738611, 0.006320854648947716, -0.003328675637021661, -0.026695383712649345, 0.07289436459541321, 0.017933281138539314, 0.008511380292475224, -0.10741494596004486, 0.024135371670126915, -0.0395350344479084, -0.0028965086676180363, 0.0010466028470546007, -0.002396712312474847, 0.019477205350995064, 0.03193417191505432, 0.034203872084617615, 0.010781082324683666, -0.004562495741993189, -0.0033814592752605677, 0.012529543600976467, 0.02294773794710636, -0.008036326617002487, 0.0019332050578668714, -0.01546564046293497, -0.04811239242553711, -0.001590110594406724, -0.03240922465920448, -0.028793537989258766, -0.009316332638263702, 0.026088371872901917, 0.007963748648762703, -0.003038364928215742, 0.052097566425800323, -0.06423783302307129, -0.024768777191638947, 0.021285049617290497, -0.010992216877639294, 0.017946476116776466, 0.008458596654236317, -0.06861887872219086, -0.02153577283024788, -0.06888280063867569, -0.031802210956811905, 0.03713337332010269, 0.04169916734099388, 0.051728080958127975, 0.006254875101149082, -0.01619141735136509, -0.003833420341834426, -0.005238787736743689, -0.010094893164932728, 0.016165025532245636, 0.02294773794710636, -0.0557924285531044, -0.018619470298290253, -0.03594573587179184, -0.0037674405612051487, 0.007244570646435022, -0.034995630383491516, 0.008432204835116863, -0.005538995377719402, -0.0104577811434865, -0.0032445513643324375, -0.004430536646395922, 0.040485139936208725, 0.06481844931840897, 0.03681666776537895, -0.022723406553268433, -0.029083849862217903, -0.0488249734044075, -0.012971607968211174, -0.02331722341477871, 0.03758203238248825, 0.03085210546851158, 0.018342355266213417, 0.03193417191505432, 0.013882127590477467, 0.03396634757518768, -0.024689601734280586, 0.0045723929069936275, -0.03636800870299339, 0.007409519515931606, -0.000635466945823282, -0.009844169951975346, 0.023528359830379486, 0.04819156974554062, 0.08550968021154404, -0.004575691651552916, -0.03314819931983948, 0.019965454936027527, 0.007713026367127895, -0.027394769713282585, 0.03620965778827667, 0.02534939907491207, -0.0061724004335701466, 0.002729909960180521, -0.032567575573921204, -0.00903262011706829, 0.0333065502345562, 0.009778190404176712, 0.001132376492023468, -0.07331663370132446, -0.012232635170221329, 0.028846321627497673, 9.70365454122657e-06, -0.0005175282130949199, -0.013347691856324673, 0.0340719148516655, -0.009303136728703976, -0.017326267436146736, 0.025204243138432503, -0.028160134330391884, -0.0016956781037151814, -0.03169664368033409, -0.017141524702310562, 0.0526781864464283, 0.033042632043361664, -0.03895441070199013, -0.019793909043073654, 0.07637809216976166, 0.018632665276527405, 0.011302321217954159, -0.06524071842432022, 0.045605164021253586, -0.016085850074887276, 0.034441400319337845, 0.0036486771423369646, -0.014119654893875122, -0.014119654893875122, -0.0012049541110172868, 0.009052414447069168, 0.023264439776539803, 0.02511187084019184, 0.004595485515892506, 0.039640601724386215, 0.00790436752140522, 0.030324267223477364, 0.012417378835380077, -0.022446291521191597, 0.006690341047942638, -0.03029787540435791, -0.001887019257992506, -0.01003551110625267, 0.039798952639102936, -0.002589703071862459, 0.03747646510601044, -0.008214471861720085, 0.03818904608488083, -0.019859887659549713, 0.01247675996273756, 0.0565841868519783, 0.05600356310606003, 0.05354911834001541, 0.0271308496594429, 0.0016519665950909257, -0.014185634441673756, -0.021588556468486786, -0.006056935992091894, -0.02340959571301937, 0.05151694640517235, -0.014568316750228405, -0.005337757058441639, -0.024306919425725937, -0.01356542482972145, -0.027012087404727936, 0.015082958154380322, -0.01604626141488552, 0.021958041936159134, -0.02641827054321766, -0.02619393914937973, 0.029928389936685562, -0.01603306643664837, 0.029242200776934624, -0.00016082551155705005, -0.01633657142519951, -0.003764141583815217, 0.04518289491534233, -0.06376277655363083, 0.005317963194102049, 0.011882943101227283, -0.0009270146838389337, -0.01952998898923397, 0.0070004453882575035, -0.024043001234531403, -0.0519392155110836, -0.03021869994699955, 0.023726297542452812, -0.0137501684948802, -0.010979020968079567, -0.06645474582910538, 0.034441400319337845, 0.02037452906370163, 0.028265701606869698, -0.02695930376648903, -0.11580756306648254, -0.0534435510635376, -0.024755582213401794, 0.025468161329627037, 0.013578620739281178, 0.01711513288319111, 0.027473945170640945, 0.0065484847873449326, 0.011823561042547226, -0.029928389936685562, 0.007336942013353109, -0.013802952133119106, -0.017418639734387398, -0.0015332031762227416, -0.013855735771358013, -0.01534687727689743, -0.004024761263281107, -0.00701364129781723, -0.05547572672367096, 0.024663209915161133, -0.011500260792672634, -0.01860627345740795, 0.04674001410603523, -0.0021311440505087376, -0.007528283167630434, -0.03238283470273018, -0.023845061659812927, -0.052968498319387436, -0.02579805999994278, 0.0033847582526504993, -0.0023406296968460083, 0.008544370532035828, -0.021641340106725693, -0.002424753736704588, -0.014132850803434849, -0.010028913617134094, 0.020202983170747757, -0.016376160085201263, 0.05336437746882439, 0.02401660941541195, -0.03478449583053589, 0.0013855735305696726, 0.03190778195858002, -0.06450174748897552, 0.051253028213977814, 0.009903552010655403, -0.03272593021392822, 0.005258581601083279, 0.009652829729020596, 0.04283401742577553, -0.023343615233898163, -0.0017765032825991511, 0.010629328899085522, -0.0379515215754509, -0.016217809170484543, -0.03338572382926941, -0.03990451991558075, 0.0026061979588121176, 0.03349129110574722, 0.02681414783000946, 0.015069762244820595, -0.04299236834049225, 0.0047307442873716354, -0.0028767145704478025, -0.032435618340969086, -0.028925497084856033, -0.003000426571816206, -0.01088005118072033, 0.011256136000156403, 0.027632296085357666, 0.02215598151087761, 0.015030174516141415, -0.0259564109146595, 0.048772189766168594, -0.011434281244874, 0.008511380292475224, -0.017946476116776466, -0.05610913038253784, 0.06260153651237488, -0.023647122085094452, 0.0032643454615026712, 0.023198461160063744, -0.0056874495930969715, 0.005921677686274052, -0.007073023356497288, 0.0340719148516655, -0.02278938703238964, -0.004984765779227018, -0.014198830351233482, -0.01274067908525467, -0.009085403755307198, 0.05843161791563034, -0.014515533111989498, 0.017959672957658768, -0.03647357597947121, 0.04082823544740677, -0.0020107312593609095, 0.006327452603727579, 0.02432011440396309, 0.0018391839694231749, -0.051569730043411255, 0.0108470618724823, -0.0063340505585074425, -0.04085462540388107, -0.0480332188308239, 0.013235527090728283, 0.012186449952423573, -0.007917563430964947, -0.04122411459684372, -0.0170491524040699, 0.023607535287737846, 0.020559273660182953, -0.012727483175694942, 0.035655427724123, 0.027315594255924225, 0.033676035702228546, -0.020334942266345024, 0.04378412663936615, 0.023449182510375977, 0.0006696939235553145, 0.026457857340574265, -0.026866931468248367, -0.035919345915317535, -0.044681448489427567, -0.05758707597851753, -0.02045370452105999, -0.020968347787857056, 0.032831497490406036, -0.006687041837722063, 0.025758473202586174, -0.022815778851509094, 0.00023505266290158033, -0.010523761622607708, 0.0053113652393221855, -0.03029787540435791, 0.014950999058783054, -0.012173254042863846, -0.02945333532989025, 0.035840168595314026, 0.0069080740213394165, 0.05880110338330269, -0.006687041837722063, -0.015254504978656769, 0.0022433095145970583, -0.005205797962844372, 0.022433096542954445, -0.012285418808460236, -0.012127067893743515, -0.013644601218402386, -0.023304028436541557, -0.031274374574422836, -0.033438507467508316, 0.037318114191293716, -0.027553120627999306, -0.005172808188945055, -0.03167025372385979, 0.006739825941622257, -0.017326267436146736, -0.017339464277029037, 0.028397660702466965, -0.007798799779266119, -0.012509750202298164, -0.013129958882927895, -0.02030855044722557, -0.012298614718019962, 0.035365115851163864, 0.017392247915267944, -0.01906813122332096, -0.003536511678248644, 0.018395138904452324, 0.02829209342598915, -0.02278938703238964, -0.05785099416971207, 0.0054004378616809845, 0.021403813734650612, -0.035206764936447144, 0.00903262011706829, -0.023383203893899918, -0.012080881744623184, 0.0048594046384096146, 0.03481088578701019, 0.025520944967865944, -0.04713589325547218, 0.012852844782173634, -6.618587940465659e-05, -0.04214783012866974, 0.01135510578751564, 0.005499407649040222, -0.021496184170246124, 0.015742754563689232, -2.93558096018387e-05, -0.00550270639359951, -0.03747646510601044, -0.018329158425331116, -0.02007102221250534, -0.0689883679151535, -0.02193165011703968, -0.0005311365239322186, 0.00741611747071147, -0.05473675578832626, 0.012133665382862091, -0.027078066021203995, -0.02705167420208454, -0.01201490219682455, 0.03122159093618393, 0.0189889557659626, -0.01811802387237549, -0.025151459500193596, 0.003985173534601927, 0.004209504462778568, 0.000954231305513531, 0.010061902925372124, -0.011520054191350937, -6.664980173809454e-05, -0.012503151781857014, -0.045974649488925934, -0.017946476116776466, 0.019701536744832993, 0.0278962142765522, -0.004516310058534145, 0.007521685212850571, 0.0008882516412995756, 0.04346742108464241, -0.0062416791915893555, 0.011335311457514763, -0.051253028213977814, 0.0034045521169900894, 0.01952998898923397, -0.02293454110622406, 0.014739863574504852, -0.013578620739281178, -0.013387279585003853, -0.00395218376070261, 0.00937571469694376, 0.006881682202219963, -0.02821291796863079, 0.023119285702705383, 0.020519685000181198, -0.033913563936948776, -0.022881757467985153, 0.008775299414992332, 0.005829305853694677, 0.0166532751172781, 0.009006228297948837, -0.002812384394928813, 0.005413633771240711, 0.023501968011260033, 0.054895106703042984, 0.03291067108511925, -0.011757581494748592, 0.007779005914926529, -0.004938580095767975, -0.00017907301662489772, -0.020889170467853546, 0.007185188587754965, 0.013169546611607075, -0.013077175244688988, -0.02441248670220375, -0.0022268146276474, 0.006564979441463947, -0.009012825787067413, 0.01765616610646248, -0.027078066021203995, -0.008775299414992332, -0.011328713968396187, -0.018236787989735603, -0.01433078944683075, 0.023304028436541557, 0.016930390149354935, -0.027157241478562355, -0.07695871591567993, -0.01711513288319111, 0.0026754767168313265, 0.028608795255422592, 0.031643860042095184, -0.022683819755911827, 0.028239309787750244, -0.012113871984183788, -0.027685079723596573, -0.03518037125468254, -0.01773534156382084, -0.003289087675511837, -0.004532805178314447, -0.012800061143934727, -0.015333681367337704, -0.03681666776537895, -0.016244200989603996, -0.010972423478960991, -0.0005418582586571574, 0.010154275223612785, 0.0002971148060169071, -0.009468086063861847, -0.01627059280872345, 0.04737342149019241, -0.023066502064466476, -0.043124329298734665, 0.025375790894031525, -0.003330325009301305, 0.01033901795744896, 0.0036486771423369646, 0.029638078063726425, -0.03449418395757675, 0.00011433043982833624, -0.0028833127580583096, -0.048244353383779526, -0.024913933128118515, -0.01146727055311203, -0.01952998898923397, -0.02837126888334751, -0.002630940405651927, 0.010523761622607708, -0.06297101825475693, 0.023660318925976753, 0.004440433345735073, 0.0472678542137146, -0.04322989657521248, 0.03605130314826965, -0.00046804346493445337, -0.008141893893480301, -0.007059827446937561, 0.03502202033996582, -0.008339833468198776, -0.0031224889680743217, -0.0017962971469387412, 0.023198461160063744, -0.010101491585373878, 0.007409519515931606, 0.006538587622344494, 0.004028060473501682, 0.013473053462803364, -0.020744016394019127, 0.050091784447431564, 0.05014456808567047, -0.023119285702705383, -0.04871940612792969, -0.009342724457383156, -0.016099045053124428, 0.05046126991510391, -0.01425161398947239, -0.03077293001115322, 0.0018886687466874719, -0.02937415987253189, 0.012140263803303242, -0.00014804194506723434, -0.00887426920235157, 0.0035596045199781656, 0.01633657142519951, 0.01798606477677822, -0.04346742108464241, 0.03869049251079559, 0.04383691027760506, -0.040405966341495514, 0.018315963447093964, 0.02154896780848503, -0.020334942266345024, 0.019239678978919983, 0.02463681809604168, -0.03222448378801346, -0.0024461972061544657, 0.017761733382940292, 0.024122176691889763, -0.007363333832472563, 0.01719430834054947, -0.0480596087872982, -0.013816148042678833, -0.024927128106355667, -0.057692643254995346, 0.014185634441673756, 0.046845581382513046, 0.0035035216715186834, 0.028001781553030014, 0.02649744600057602, 0.00623837998136878, 0.012226037681102753, 0.014383573085069656, -0.0037014607805758715, 0.021588556468486786, -0.0259696077555418, 0.03927111253142357, -0.006037142127752304, 0.009824376553297043, -0.00992334634065628, -0.03462614491581917, 0.004588887561112642, 0.000505981792230159, 0.04592186585068703, 0.038400180637836456, 0.022565055638551712, 0.0019744422752410173, 0.007719624321907759, -0.003526614746078849, 0.014212026260793209, -0.014502337202429771, 0.02393743395805359, 0.0018639264162629843, -0.02170731872320175, 0.014515533111989498, 0.025388985872268677, -0.004499814938753843, 0.011790571734309196, 0.03850574791431427, -0.013162949122488499, 0.03533872589468956, 0.024465270340442657, 0.009085403755307198, 0.06049018353223801, 0.005420231726020575, 0.0387432761490345, -0.048772189766168594, 0.026748167350888252, -0.008966640569269657, -0.004216102417558432, -0.021786494180560112, 0.01088005118072033, 0.002452795160934329, 0.02813374251127243, 0.011566240340471268, -0.028846321627497673, -0.006076729856431484, 0.029638078063726425, 0.01728668063879013, -0.012206243351101875, -0.009395508095622063, -0.029242200776934624, 0.006861888337880373, 0.024306919425725937, 0.023462379351258278, -0.033887170255184174, 0.005961265414953232, 0.031274374574422836, -0.007706428412348032, 0.026141155511140823, -0.0071060131303966045, -0.02845044434070587, 0.04167277365922928, -0.02858240343630314, 0.002106401836499572, 0.005469716619700193, 0.006960857659578323, -0.015782343223690987, 0.0029657871928066015, -0.06455453485250473, 0.019952259957790375, 0.03462614491581917, 0.011447477154433727, 0.021166285499930382, -0.006769516505300999, 0.014647492207586765, 0.0075546749867498875, 0.01868544891476631, 0.034124698489904404, 0.023897845298051834, -0.05360190197825432, -0.01612543687224388, 0.01658729463815689, -0.007053229492157698, -0.0014672233955934644, 0.004054452292621136, -0.008339833468198776, 0.03246200829744339, 0.048613838851451874, 0.020348137244582176, -0.011691601946949959, 0.03673749417066574, 0.0030317669734358788, -0.016138633713126183, -0.032963454723358154, 0.012707688845694065, -0.008821485564112663, -0.03845296427607536, -0.03826822340488434, 0.0110450005158782, -0.0004577341314870864, 0.0071060131303966045, -0.03269953653216362, 0.03430943936109543, -0.009177775122225285, -0.0014713471755385399, -0.015676775947213173, 0.04555238038301468, 0.009725406765937805, -0.005027652718126774, -0.020875975489616394, 0.0045723929069936275, -0.0031818707939237356, -0.029321376234292984, 0.009903552010655403, 0.01003551110625267, -0.03982534259557724, -0.0032956856302917004, -0.02664260007441044, 0.013895323500037193, 0.0061724004335701466, -0.0015167081728577614, -0.04132968187332153, 0.000933612696826458, 0.03935028985142708, -0.017458226531744003, -0.014475945383310318, 0.0030367153231054544, -0.0007303127204068005, 0.03401913121342659, -0.02005782723426819, 0.01092623732984066, -0.002959189238026738, -0.012080881744623184, -0.005034250672906637, -0.002274649916216731, 0.02470279671251774, -0.003955482505261898, 0.04845548793673515, -0.00015762961993459612, -0.009949738159775734, -0.001311346422880888, 0.026985695585608482, -0.010220254771411419, 0.011097784154117107, 0.05917058885097504, -0.031010456383228302, -0.010820670053362846, -0.019398029893636703, 0.03272593021392822, 0.03240922465920448, 0.002640837337821722, 0.017101936042308807, 0.0003967029042541981, 0.004255690146237612, 0.0340983048081398, 0.021113501861691475, 0.0052222926169633865, -0.02519104816019535, 0.009817778132855892, -0.01937163807451725, -0.012615317478775978, 0.01682482287287712, -0.043889693915843964, 0.016468532383441925, 0.010015717707574368, -0.009778190404176712, 0.004367855843156576, -0.02845044434070587, 0.015122545883059502, -0.01429120171815157, 0.018540294840931892, 0.0043777525424957275, -0.012153459712862968, -0.0032527989242225885, -0.011658611707389355, 0.013895323500037193, 0.00828704982995987, -0.023884648457169533, -0.021166285499930382, -0.03747646510601044, -0.05959286168217659, 0.0076470463536679745, -0.00979798473417759, 0.02718363329768181, 0.011407889425754547, 0.005727037321776152, 0.031089631840586662, 0.059223372489213943, 0.04634413868188858, -0.01596708595752716, 0.009751798585057259, 0.0010061903158202767, -0.018315963447093964, -0.019714733585715294, 0.0449453666806221, -0.0108470618724823, 0.016085850074887276, -0.007844985462725163, 0.007950552739202976, 0.012496554292738438, -0.014739863574504852, 0.03771399334073067, 0.020493293181061745, -0.009527468122541904, -0.023963825777173042, -0.031195199117064476, -0.013657797127962112, 0.0069080740213394165, -0.030640970915555954, 0.0037410487420856953, 0.006581474561244249, -0.011698199436068535, 0.008616948500275612, 0.010602937079966068, 0.012061088345944881, 0.009804582223296165, 0.004437134601175785, 0.012127067893743515, -0.005654459819197655, -0.011632219888269901, 0.01752420701086521, -0.03322737291455269, -0.026550229638814926, -0.020348137244582176, 0.0034606349654495716, -0.020440509542822838, 0.012423976324498653, -0.0275003369897604, 0.0022400105372071266, -0.0055060056038200855, -0.02633909322321415, -0.03810987249016762, -0.007066425401717424, -0.025995999574661255, 0.010800875723361969, -0.01579553820192814, 0.006188895553350449, 0.017867300659418106, 0.015544815920293331, -0.0006107245571911335, -0.018619470298290253, -0.008847877383232117, 0.02137742005288601, 0.0071060131303966045, 0.014581512659788132, -0.022921346127986908, 0.008960042148828506, 0.07199703902006149, -0.028028173372149467, -0.0026012493763118982, -0.0010894896695390344, -0.006340648513287306, -0.008095708675682545, -0.01619141735136509, 0.011915932409465313, -0.030957672744989395, 0.0089072585105896, 0.010741494596004486, 0.019120914861559868, -0.026299506425857544, 0.003350118873640895, 0.006967455614358187, 0.011051598936319351, -0.035127587616443634, -0.009844169951975346, 0.02333042025566101, 0.02395062893629074, 0.026207134127616882, 0.005007858853787184, -0.008300245739519596, 0.013162949122488499, 0.034283049404621124, -0.024122176691889763, -0.010134480893611908, -0.005007858853787184, -0.009461488574743271, 0.04642331227660179, -0.002802487462759018, -0.01135510578751564, -0.055528510361909866, 0.0012725833803415298, -0.01727348379790783, -0.01666647009551525, -0.012681297026574612, 0.028001781553030014, 0.016085850074887276, 0.00240331026725471, 0.014053675346076488, -0.011836756952106953, 0.01991267129778862, 0.020361334085464478, -0.0016626883298158646, 0.01487182267010212, -0.008471792563796043, 0.027922606095671654, 0.021403813734650612, 0.01088664960116148, 0.022129589691758156, -0.004348061978816986, 0.007429313380271196, -0.014000890776515007, -0.02053287997841835, 0.0057765222154557705, -0.0030119731090962887, 0.02982282266020775, 0.00979798473417759, 0.0034507380332797766, -0.025600122287869453, 0.004677960183471441, -0.018263179808855057, -0.004239195492118597, 0.008900661021471024, -0.019424421712756157, -0.001101036206819117, 0.009699014946818352, 0.02115309052169323, 0.027078066021203995, -0.004513011313974857, 0.012166655622422695, -0.031195199117064476, -0.011685003526508808, -0.008432204835116863, -0.007270962465554476, -0.025085479021072388, -0.0026078473310917616, 0.026761364191770554, 0.04225339740514755, -0.015162133611738682, 0.012344800867140293, -0.03288428112864494, -0.007218178361654282, -0.009507673792541027, 0.0027546521741896868, 0.01883060485124588, -0.014898215420544147, -0.024214547127485275, 0.024834757670760155, -0.013499445281922817, 0.01789369247853756, 0.029031066223978996, 0.004506412893533707, 0.011236341670155525, -0.010556750930845737, 4.2371335439383984e-05, -0.02302691340446472, -0.015360073186457157, -0.005007858853787184, -0.002642486710101366, -0.0028437247965484858, 0.043282680213451385, 0.0008997980621643364, -0.013882127590477467, 0.023145677521824837, -0.029638078063726425, -0.011678406037390232, -0.019820300862193108, 0.002406609244644642, -0.007759212050586939, 0.011216548271477222, -0.003041663905605674, -0.009943139739334583, -0.053813040256500244, -0.013802952133119106, -0.0267349723726511, 0.038875237107276917, 0.011612426489591599, -0.009830974042415619, 0.030086740851402283, -0.0021888762712478638, 0.002221866277977824, 0.004496516194194555, -0.009784788824617863, 0.01274067908525467, 0.011110980063676834, 0.011110980063676834, -0.01000252179801464, 0.000874230929184705, 0.003645378164947033, 0.014713471755385399, 0.02850322797894478, -0.021417008712887764, 0.027605904266238213, 0.03557625040411949, -0.010906443931162357, 0.007508489303290844, -0.001181036583147943, -0.01867225393652916, 0.0008461895631626248, 0.018619470298290253, -0.02845044434070587, 0.011454074643552303, -0.00443383539095521, 0.016864409670233727, 0.0007072198204696178, -0.03201334923505783, 0.03378160297870636, 0.016838017851114273, -0.0011744385119527578, 0.017550598829984665, -0.00685529038310051, 0.05294210836291313, -0.008630144409835339, -0.022129589691758156, 0.0255605336278677, -0.010246646590530872, 0.03430943936109543, -0.005473015829920769, 0.034283049404621124, -0.027078066021203995, -0.0004581465036608279, 0.028846321627497673, 0.04077545180916786, 0.003289087675511837, -0.017629774287343025, -0.024584034457802773, -0.022063609212636948, -0.013723776675760746, -0.007917563430964947, 0.009619839489459991, 0.0071060131303966045, -0.006317555904388428, 0.009943139739334583, -0.0019694939255714417, -0.016165025532245636, -0.004631774500012398, -0.02007102221250534, 0.013393878005445004, -0.03013952448964119, -0.009685819037258625, 0.040089260786771774, 0.019028544425964355, 0.0009418601403012872, 0.012179851531982422, 0.021245460957288742, 0.025085479021072388, 0.014000890776515007, -0.0006086626672185957, 0.013934911228716373, 0.012549337930977345, 0.031485509127378464, 0.012377791106700897, 0.007970347069203854, 0.01386893168091774, 0.018012456595897675, -0.02765868790447712, 0.05085714906454086, 0.04161999002099037, 0.00573693448677659, -0.010042109526693821, -0.009751798585057259, 0.007877975702285767, 0.00441404152661562, 0.025995999574661255, -0.00945489015430212, 0.009316332638263702, 0.021324636414647102, -0.004232597537338734, 0.03549707680940628, -0.016389356926083565, 0.016851214691996574, -0.00015958838048391044, -0.03317458927631378, 0.005430128891021013, 0.03462614491581917, 0.015689970925450325, -0.0024676406756043434, -0.02153577283024788, -0.0009311384637840092, -0.022921346127986908, 0.02990199811756611, -0.009461488574743271, 0.00019360917212907225, -0.004809919744729996, 0.052097566425800323, 0.02240670472383499, -0.019318854436278343, 8.81962914718315e-05, 0.019635556265711784, -0.026853736490011215, -0.010899845510721207, -0.029031066223978996, -0.002759600756689906, -0.0026573322247713804, -0.01698317378759384, -0.00014371202269103378, 0.02115309052169323, 0.018421530723571777, -0.017563793808221817, -0.002762899734079838, 0.00806271843612194, -0.006941063795238733, 0.02509867586195469, 0.03481088578701019, -0.004107235930860043, 0.020638449117541313, -0.050487663596868515, 0.013393878005445004, -0.011770777404308319, 0.028318485245108604, -0.01951679401099682, -0.02850322797894478, 0.015571207739412785, 0.009039218537509441, 0.02619393914937973, -0.0015389763284474611, 0.011460673063993454, 0.034283049404621124, -0.013802952133119106, -0.022103197872638702, 0.014172438532114029, 0.005479613784700632, 0.0017418639035895467, 0.013618208467960358, -0.04051153361797333, 0.002282897476106882, -0.0488249734044075, -0.0004944353131577373, 0.005100230220705271, 0.026154350489377975, 0.014436356723308563, -0.014080067165195942, -0.00828704982995987, 0.018922977149486542, 0.014647492207586765, 0.00441404152661562, 0.013110165484249592, -0.011764179915189743, 0.030878497287631035, -0.034283049404621124, -0.003305582795292139, 0.02441248670220375, 0.023383203893899918, 0.0017220700392499566, -0.021509381011128426, -0.009580251760780811, -0.012061088345944881, 0.026761364191770554, -0.027553120627999306, -0.0008424782427027822, 0.025388985872268677, -0.014581512659788132, -0.0033913562074303627, -0.003975276369601488, 0.011012011207640171, -0.04201586917042732, -0.0325411856174469, 0.01819719932973385, -0.012021500617265701, 0.00575672835111618, 0.02239350788295269, -0.0014350583078339696, 0.037318114191293716, 0.005888687912374735, -0.02347557432949543, 0.030509009957313538, -0.008108904585242271, 0.018315963447093964, -0.021258657798171043, -0.002988880267366767, 0.008471792563796043, 0.015241309069097042, 0.010939433239400387, 0.0007587664877064526, -0.0010210357140749693, 0.008419008925557137, -0.01429120171815157, 0.0026985695585608482, -0.025085479021072388, -0.00540373707190156, 3.42785133398138e-05, 0.007746016141027212, 0.033676035702228546, -0.015360073186457157, -0.008966640569269657, 0.016692861914634705, 0.013347691856324673, -0.0038466162513941526, 0.04146163910627365, 0.015980282798409462, 0.0110450005158782, 0.018659057095646858, 0.00546311866492033, 0.013492847792804241, -0.02695930376648903, 0.04578990861773491, 0.02239350788295269, -0.015755951404571533, 0.011757581494748592, 0.02107391506433487, 0.02186567150056362, 0.004199607763439417, -0.0035826973617076874, 0.005139818415045738, 0.018540294840931892, 0.008715917356312275, -0.03156468644738197, 0.02261783927679062, 0.011117578484117985, 0.02643146552145481, -0.0363943986594677, 0.019793909043073654, -0.012569131329655647, 0.033676035702228546, -0.007930759340524673, -0.024927128106355667, -0.03446779400110245, 0.0009971181862056255, -0.028925497084856033, -0.026365485042333603, 0.001756709418259561, 0.022221960127353668, -0.020242569968104362, -0.005779821425676346, -0.020941954106092453, -0.004582289606332779, 0.006941063795238733, -0.007673438638448715, 0.017154719680547714, 0.014898215420544147, 0.02247268334031105, 0.02307969704270363, -0.03156468644738197, -0.021258657798171043, -0.05030291900038719, -0.003388057230040431, 0.028951890766620636, 0.015821930021047592, 0.006211988162249327, -0.012100676074624062, -0.008847877383232117, -0.015439248643815517, -0.0014985637972131371, 0.0018243385711684823, 0.03977255895733833, 0.017629774287343025, -0.011341909877955914]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"�(xi,j, a1
i,j)−ϕ(xi,j, a2
i,j))⊤.
Then, by invoking Lemma 8 for θtwith Σ D=mΣt,mandλ′=mλ, we have with probability at least 1 −δ,
33
for any t∈[T],
∥θt−θ∗∥Σt,m=1√m∥θt−θ∗∥ΣD
≤C√ms
d+ log( T/δ)
γ2+mλB2
=Cs
d+ log( T/δ)
γ2m+λB2. (10)
Let
eΣt=λI+t−1X
i=1Ex∼d0,a1∼π1
i,a2∼π2
i
(ϕ(xt, a1)−ϕ(xt, a2))(ϕ(xt, a1)−ϕ(xt, a2))⊤
.
Now, by elliptical potential lemma (Lemma 9), we have
TX
t=1log 
1 +Ext∼d0∥ϕ(xt, π1
t)−ϕ(xt, π2
t)∥2
eΣ−1
t
≤TX
t=1log 
1 +Ext∼d0,a1∼π1
t,a2∼π2
t∥[ϕ(xt, a1)−ϕ(xt, a2)]∥2
eΣ−1
t
≤logdet(eΣT)
det(λI)
≤dlog(1 + TL2/λd) :=γT(λ).
Since each term on the left-hand side is positive, we know that there exists at least a t0∈[T], the value is
smaller or equal than the average value:
log 
1 +ψ2
t0
≤1
TγT(λ),
where we use the short-hand notation ψt=Ext∼d0∥ϕ(xt, π1
t)−ϕ(xt, π2
t)∥eΣ−1
t. It is equivalent to
ψ2
t0≤exp γT(λ)
T
−1.
We now consider the suboptimality at iteration t0:
J(π∗)−J(π1
t0) =Ext0∼d0h
θt0−θ∗, ϕ(xt0, π1
t0)−ϕ(xt0, π∗)i
−ηExt0∼d0
DKL(π∗(·|xt0)∥π1
t0(·|xt0))
≤Ext0∼d0h
∥ϕ(xt0, π1
t0)−ϕ(xt0, π∗)∥Σ−1
t,mi
· ∥θt0−θ∗∥Σt,m−ηExt0∼d0
DKL(π∗(·|xt0)∥π1
t0(·|xt0))
,
(11)
where the inequality uses the Cauchy-Schwarz inequality (Lemma 7). Then, since the samples {xt,i}m
i=1are
i.i.d and for any x∈ X
∥ϕ(x, π1
t0)−ϕ(xt0, π∗)∥Σ−1
t,m≤2√
λ,
we can use Chernoff bound (Theorem 2.16 of Zhang (2023)) to obtain that with probability at least 1 −δ/2,
Ext0∼d0h
∥ϕ(xt0, π1
t0)−ϕ(xt0, π∗)∥Σ−1
t,mi
≤1
mmX
i=1∥ϕ(xt,i, π1
t0)−ϕ(xt,i, π∗)∥Σ−1
t,m+r
log(2/δ)
2m.
Similarly, we also get with probability at least 1 −δ/2,
1
mmX
i=1∥ϕ(xt,i, π1
t0)−�","[-0.006153999362140894, -0.03575148805975914, 0.008931172080338001, -0.0032260760199278593, -0.006512452382594347, 0.0008504880825057626, 0.014137113466858864, 0.03835110738873482, -0.008066864684224129, 0.048803191632032394, 0.015034920535981655, 0.003966432064771652, -0.0398787222802639, 0.035778287798166275, 0.02413359470665455, 0.011296290904283524, 0.002904473338276148, -0.023021385073661804, -0.01606673002243042, 0.0518852174282074, -0.025714807212352753, -0.008448767475783825, 0.03883351385593414, 0.025406604632735252, 0.024093393236398697, -0.012234298512339592, 0.029319435358047485, -0.004274634178727865, 0.04660557582974434, -0.018733350560069084, 0.020314563065767288, -0.03585868701338768, 0.016616133973002434, -0.048803191632032394, -0.009741878136992455, 0.08313427120447159, 0.001844189828261733, 0.05633405223488808, -0.017848944291472435, -0.004331585019826889, 0.02697441726922989, -0.012676501646637917, -0.10360963642597198, 0.01431131549179554, 0.007115457206964493, -0.03124905191361904, -0.0007663186406716704, -0.010793786495923996, 0.03676989674568176, 0.034384675323963165, -0.015168922021985054, 0.027108417823910713, -0.011637993156909943, 0.003892731387168169, 0.007537560537457466, -0.012274499051272869, -0.011771994642913342, 0.03853870928287506, 0.05191201716661453, -0.029828639701008797, 0.026009609922766685, 0.001386911142617464, 0.05049160495400429, -0.041459932923316956, -0.03526908531785011, 0.0003588716499507427, -0.02661261335015297, 0.031651053577661514, 0.05218001827597618, 0.04438115656375885, -0.024615997448563576, 0.014967920258641243, 0.04572116583585739, -0.0001336870191153139, -0.005916147492825985, 0.007035056594759226, 0.008817271329462528, -0.0037821803707629442, 0.037064697593450546, -0.024884000420570374, 0.035510286688804626, -0.0006134737050160766, 0.06887655705213547, -0.005393543280661106, 0.020997969433665276, -0.08034704625606537, -0.017178937792778015, 0.005078640766441822, -0.08801190555095673, -0.015369923785328865, -0.016441931948065758, -0.019644558429718018, 0.012153897434473038, -0.005406943615525961, 0.06876935064792633, 0.0031054748687893152, 0.03636789321899414, -0.011966296471655369, -0.026063209399580956, -0.028595829382538795, 0.021373171359300613, -0.03693069517612457, 0.02811342664062977, -0.01067318581044674, 0.04309474676847458, -0.008777070790529251, -0.021507173776626587, 0.03497428074479103, -0.021118570119142532, 0.018371548503637314, 0.010184082202613354, -0.028247427195310593, -0.0014480490935966372, 0.04740958288311958, 0.033875472843647, -0.02635801210999489, -0.0700557604432106, 0.026773415505886078, -0.027148617431521416, -0.006599552929401398, -0.03942311555147171, -0.0075643607415258884, 0.01689753495156765, -0.00787926372140646, -0.005999898072332144, -0.028301026672124863, 0.026371411979198456, -0.07321818917989731, -0.035161882638931274, -0.006398551631718874, 0.017219139263033867, -0.01807674579322338, -0.006954655982553959, -0.014257715083658695, -0.0017252638936042786, 0.013949512504041195, 0.05724526196718216, 0.06716133654117584, 0.05472604185342789, -0.010237682610750198, 0.0006377613754011691, -0.0036950798239558935, -0.041620735079050064, 0.03966432064771652, -0.020126961171627045, 0.011617893353104591, -0.05547644570469856, 0.0205155648291111, 0.00787926372140646, 0.004847488831728697, -0.007343259174376726, -0.03647509217262268, -0.013333107344806194, -0.002440494718030095, 0.0014781993813812733, -0.05467243865132332, -0.03173145651817322, 0.06603573262691498, 0.011048388667404652, 0.01283730287104845, -0.05276962369680405, 0.031195450574159622, 0.0026398212648928165, -0.001245372463017702, 0.05129561200737953, 0.03451867774128914, 0.015597725287079811, -0.0019966161344200373, -0.0633557066321373, -0.06030048429965973, -0.018612749874591827, 0.0010024955263361335, -0.019363155588507652, -0.03709149733185768, 0.050545208156108856, -0.014257715083658695, -0.010766986757516861, -0.045908767729997635, 0.0015711626037955284, 0.004053532611578703, 0.028542229905724525, 0.0452655628323555, 0.0464983731508255, 0.013775310479104519, -0.014418516308069229, -0.012488900683820248, 0.017647942528128624, 0.00027679596678353846, 0.01469991821795702, -0.0001319073053309694, -0.0018374897772446275, 0.017795342952013016, 0.009333174675703049, -0.011932795867323875, 0.00019880315812770277, -0.026800215244293213, 0.0647493228316307, 0.07713101804256439, 0.022659583017230034, 0.05327882990241051, 0.03331266716122627, 0.013949512504041195, 0.009614577516913414, -0.007711762096732855, -0.005316492635756731, -0.016776934266090393, 0.018331347033381462, 0.04842798784375191, -0.059335678815841675, -0.019081752747297287, 0.0006356675876304507, -0.028944233432412148, 0.005494044162333012, -0.020113561302423477, -0.023597590625286102, 0.06255169957876205, -0.037279099225997925, 0.023945992812514305, -0.012562600895762444, 0.04239794239401817, -0.029078233987092972, 0.06308770924806595, 0.02516540326178074, 0.004931239876896143, -0.022096777334809303, 0.017808742821216583, 0.04837438836693764, -0.009942879900336266, 0.018023144453763962, -0.02247198112308979, 0.004877639003098011, 0.025018000975251198, -0.0477311834692955, -0.03685029596090317, 0.01648213341832161, -0.030820248648524284, -0.0386459119617939, -0.030177041888237, -0.024508796632289886, -0.032160259783267975, -0.008696669712662697, 0.043067947030067444, -0.008328166790306568, -0.017031537368893623, -0.020636165514588356, -0.008696669712662697, -0.01500812079757452, -0.008046764880418777, -0.03028424270451069, -0.010746886022388935, 0.0002627677458804101, -0.008636369369924068, -0.010244382545351982, 0.0011725093936547637, -0.04033432528376579, 0.01575852744281292, -0.048856791108846664, 0.019698157906532288, -0.03023064322769642, 0.039449919015169144, -0.005185841582715511, -0.01469991821795702, -0.026465212926268578, 0.015450323931872845, -0.0011473841732367873, -0.013152205385267735, 0.008174065500497818, 0.022619381546974182, 0.022485380992293358, -0.010076881386339664, 0.032776664942502975, 0.002584545873105526, -0.02692081592977047, 0.03623389080166817, -0.04293394461274147, -0.0670541375875473, 0.006391851231455803, 0.045801568776369095, -0.06180129572749138, 0.00520594185218215, -0.03776150196790695, 0.0013910987181589007, 0.04277314245700836, -0.007262858562171459, 0.039905522018671036, -0.065285325050354, -0.0006394364172592759, 0.01283730287104845, -0.03674309700727463, -0.04872279241681099, 0.02185557596385479, -0.024709798395633698, 0.029694639146327972, 0.014860719442367554, -0.02737642079591751, -0.005376793444156647, 0.018103545531630516, -0.028997832909226418, -0.027322819456458092, 0.009252774529159069, 0.046364374458789825, -0.02315538562834263, 0.012703302316367626, 0.03301786631345749, -0.012334799394011497, 0.016361530870199203, 0.03178505599498749, -0.021681373938918114, -0.02583540789783001, 0.00014802931400481611, 0.00700155645608902, -0.014874119311571121, -0.031061450019478798, 0.029748238623142242, -0.01590592786669731, -0.0410311296582222, 0.025500405579805374, -0.0031490253750234842, -0.007745262235403061, -0.08227666467428207, 0.0008701694896444678, -0.050036001950502396, 0.0036515293177217245, -0.04759718105196953, 0.0027252468280494213, 0.000995795475319028, -0.004324884619563818, -0.02314198575913906, 0.007705062162131071, -0.03768110275268555, -0.023731591179966927, 0.023115186020731926, 0.0157049261033535, -0.023128585889935493, -0.0075643607415258884, 0.007189157884567976, -0.029641037806868553, 0.04521196335554123, 0.016468731686472893, 0.01813034527003765, -0.04743638262152672, 0.022806983441114426, 0.004566086921840906, 0.010324782691895962, 0.023651190102100372, -0.015972929075360298, 0.03781510517001152, -0.001215222291648388, 0.07514780759811401, 0.07648781687021255, -0.014766918495297432, -0.032321058213710785, 0.018317947164177895, 0.00441868556663394, 0.020381564274430275, -0.050920408219099045, 0.004643137101083994, -0.04982160031795502, -0.059228476136922836, -0.01731293834745884, -0.01297130435705185, -0.009292975068092346, 0.05276962369680405, 0.003299776464700699, -0.00595299806445837, 0.026626013219356537, -0.0017436890630051494, 0.018666349351406097, -0.00842196773737669, -0.013353207148611546, -0.019805358722805977, 0.05708445981144905, -0.044086355715990067, -0.019349755719304085, -0.03124905191361904, -0.025152001529932022, 0.018894152715802193, 0.0014086862793192267, 0.05617325007915497, 0.0014756869059056044, -0.021627774462103844, -0.02237818017601967, -0.00407028291374445, -0.014713318087160587, -0.016294531524181366, 0.001578700146637857, -0.009614577516913414, -0.04459555819630623, -0.023289388045668602, -0.030927449464797974, 0.03253545984625816, -0.027403220534324646, -0.009755278006196022, 0.030043041333556175, -0.046685975044965744, -0.04475636035203934, 0.007490660063922405, 0.07922143489122391, 0.004800588823854923, 0.052099619060754776, -0.03291066363453865, -0.04499756172299385, -0.04821358621120453, -0.021172169595956802, -0.0410311296582222, -0.03730589896440506, 0.0075174602679908276, 0.06115809082984924, 0.023235786706209183, 0.009185774251818657, 0.024012992158532143, 0.013674809597432613, 0.021507173776626587, -0.03743990138173103, -0.006981456186622381, 0.001909515354782343, -0.004981489852070808, 0.032213859260082245, 0.037895504385232925, 0.03698429837822914, -0.033714670687913895, -0.0019195654895156622, 0.0025443455670028925, -0.0031909006647765636, -0.06040768697857857, 0.024656198918819427, 0.03837790712714195, -0.002948023611679673, 0.02278018370270729, -0.04944639652967453, 0.021064968779683113, 0.04231753945350647, 0.04030752554535866, 0.023624390363693237, -0.060622088611125946, -0.016616133973002434, -0.003376827109605074, -0.026425013318657875, -0.019617756828665733, -0.05218001827597618, -0.0048642391338944435, -0.023436788469552994, -0.02448199689388275, 0.01591932773590088, 0.0014145488385111094, 0.01397631224244833, -0.010773686692118645, -0.029158635064959526, 0.032776664942502975, 0.028542229905724525, -0.03497428074479103, -0.01751394011080265, 0.04832078889012337, -0.024924200028181076, -0.018666349351406097, -0.03057904541492462, 0.043067947030067444, -0.015597725287079811, 0.02371819131076336, -0.03250866010785103, -0.0034187023993581533, -0.02412019483745098, -0.001765464199706912, -0.02252558059990406, 0.012033296748995781, 0.043791551142930984, 0.023115186020731926, -0.012736801989376545, 0.003157400293275714, 0.03894071280956268, 0.029935840517282486, -0.0647493228316307, 0.05472604185342789, -0.03915511444211006, -0.009185774251818657, 0.04748998209834099, 0.05617325007915497, -0.015436924062669277, 0.03470627963542938, -0.012890903279185295, 0.026183810085058212, -0.03435787558555603, -0.027631022036075592, 0.02800622582435608, 0.00296477391384542, 0.06817974895238876, 0.06823334842920303, -0.003996582236140966, -0.010766986757516861, -0.03497428074479103, 0.004391885362565517, -0.03829750791192055, 0.015611125156283379, -0.015463724732398987, -0.007591160945594311, 0.011229290626943111, 0.008026664145290852, -0.016455331817269325, -0.02345018833875656, -0.0011716719018295407, 0.03612669184803963, 0.029721438884735107, 0.0013835611753165722, 0.020019760355353355, -0.009493975900113583, 0.007296358700841665, 0.00934657547622919, -0.026572413742542267, 0.008535868488252163, 0.011383391916751862, -0.02019396238029003, -0.0032729762606322765, 0.019724959507584572, 0.024870600551366806, -0.017192337661981583, 0.0043014343827962875, -0.039905522018671036, 0.016093529760837555, -0.035671085119247437, 0.01880035176873207, 0.019550757482647896, -0.024053193628787994, -0.02939983643591404, 0.001010033069178462, 0.03248186036944389, -0.01993936114013195, -0.013614509254693985, -0.1067720577120781, -0.04759718105196953, -0.035778287798166275, 0.0459623709321022, -0.02227097935974598, -0.01807674579322338, 0.009782078675925732, 0.023115186020731926, -0.005765396170318127, -0.018170546740293503, 0.00045937244431115687, 0.0031490253750234842, -0.02164117433130741, 0.011055088602006435, -0.0032579011749476194, -0.00047821635962463915, 0.011503992602229118, 0.020649565383791924, -0.044461555778980255, 0.0223647803068161, 0.011282891035079956, -0.011899295262992382, 0.025272604078054428, -0.015490524470806122, -0.015745125710964203, -0.014793719165027142, -0.0010309708304703236, -0.031195450574159622, 0.019041553139686584, -0.009507376700639725, 0.0055777947418391705, -0.005440443754196167, 0.03467947989702225, -0.006817304994910955, 0.02216377854347229, 0.024374796077609062, -0.007671561557799578, -0.006994856055825949, 0.03827070817351341, -0.005939597729593515, -0.0026398212648928165, 0.01968475803732872, 0.025862207636237144, -0.02097116783261299, 0.012026596814393997, -0.009091973304748535, 0.038511909544467926, 0.0032428260892629623, -0.026934215798974037, 0.0482671894133091, 0.011637993156909943, -0.019081752747297287, -0.036448292434215546, -0.05244802311062813, 0.011805495247244835, -0.010264482349157333, -0.002599620958790183, -0.004954689648002386, 0.019148753955960274, -0.00896467175334692, -0.008663170039653778, -0.04154033586382866, -0.016053328290581703, 0.030659446492791176, -0.019336355850100517, -0.03904791548848152, -0.01080048643052578, 0.0040736328810453415, 0.036448292434215546, -0.010123781859874725, 0.01110868901014328, 0.018894152715802193, -0.031061450019478798, 0.058049265295267105, 0.00870336964726448, 0.014619517140090466, -0.02661261335015297, -0.024937599897384644, 0.023651190102100372, -0.034331075847148895, 0.0072025577537715435, 0.012509000487625599, 0.02040836401283741, -0.002666621468961239, 0.0038692811504006386, -0.004361735191196203, 0.03492068126797676, 0.005081990733742714, -0.029587438330054283, 0.01829114742577076, -0.02856902964413166, 0.05172441527247429, -0.0017889144364744425, -0.008710069581866264, -0.038002707064151764, 0.0012034971732646227, -0.011168989352881908, 0.0019346405752003193, 0.030713047832250595, 0.009574376977980137, -0.04242474213242531, 0.026827014982700348, -0.018719950690865517, -0.028033025562763214, -0.01244870014488697, 0.026786815375089645, 0.011972996406257153, -0.014807119034230709, -0.00885747093707323, 0.01565132662653923, 0.024012992158532143, -0.036501891911029816, -0.04266594350337982, 0.02122577093541622, 0.004599587060511112, -0.00397983193397522, -0.04215673729777336, 0.0023131936322897673, 0.030096642673015594, -0.00634160079061985, 0.022311178967356682, -0.05038440600037575, -0.024629397317767143, -0.004502436146140099, -0.000159649716806598, 0.04159393534064293, 0.001386073650792241, 0.039959121495485306, -0.02268638275563717, -0.0010133831528946757, -0.0070082563906908035, -0.01389591209590435, -0.06742934137582779, 0.010043380782008171, 0.026853816583752632, -0.003594578942283988, -0.0052595422603189945, 0.010485583916306496, 0.023570789024233818, 0.014847319573163986, 0.01064638514071703, -0.015611125156283379, 0.004602937027812004, 0.03001624159514904, 0.045533567667007446, 0.01916215382516384, 0.005795546807348728, 0.016602734103798866, -0.004730238113552332, -0.04639117419719696, -0.016977936029434204, -0.04577476903796196, 0.007102057337760925, -0.04322874918580055, 0.010659785941243172, -0.023128585889935493, 0.01880035176873207, -0.033044666051864624, -0.0064957020804286, 0.007725161965936422, 0.0014865744160488248, -0.040682725608348846, -0.0057787965051829815, -0.021198971197009087, 0.005909447558224201, 0.05475284159183502, -0.03481347858905792, 0.02004656195640564, -0.01126279029995203, -0.022257579490542412, 0.010445384308695793, 0.008046764880418777, -0.01136999111622572, -0.03095424920320511, 0.03170465677976608, -0.040897127240896225, 0.005768746603280306, -0.045238763093948364, -0.017580941319465637, -0.011591093614697456, 0.03475987911224365, 0.05124201253056526, -0.059282075613737106, 0.002157417358830571, -0.00612384919077158, -0.03760070353746414, 0.008301367051899433, 0.00040305012953467667, 0.005725196097046137, 0.0002380612859269604, 0.015972929075360298, -0.021212371066212654, -0.007410259451717138, -0.007470560260117054, -0.006827354896813631, -0.07155657559633255, -0.0034136774484068155, 0.011892595328390598, -0.002824072726070881, -0.03663589432835579, -0.0002223580377176404, 0.01193949580192566, -0.02062276564538479, -0.020582566037774086, 0.028595829382538795, 4.860156332142651e-05, -0.01948375627398491, 0.0009564327192492783, 0.03175825625658035, 0.025152001529932022, 0.04794558510184288, -0.011122089810669422, 0.0004198002570774406, 0.01916215382516384, -0.03837790712714195, -0.04183513671159744, -0.007249458227306604, 0.034331075847148895, 0.012488900683820248, 0.03358066827058792, 0.016307931393384933, -0.013882511295378208, 0.03497428074479103, -0.030311044305562973, 0.011376691050827503, -0.04221034049987793, -0.00671680411323905, 0.02232457883656025, -0.015798727050423622, 0.03157065436244011, -0.014820518903434277, -0.02784542366862297, -0.0006201737560331821, 0.020729966461658478, -0.011805495247244835, -0.03229425847530365, 0.011477191932499409, -5.417621650849469e-05, 0.007182457949966192, -0.04716837778687477, -0.021775174885988235, 0.027523821219801903, -0.030311044305562973, -0.012066797353327274, 0.023986192420125008, 0.000275539729045704, 0.007932864129543304, 0.02784542366862297, 0.0223647803068161, -0.007530860602855682, -0.029078233987092972, 0.030552245676517487, -0.021935977041721344, -0.01183229498565197, -0.026492012664675713, -0.0065627028234303, -0.012931103818118572, -0.00700155645608902, -0.0037151798605918884, -0.026465212926268578, -0.0016733384691178799, -0.020314563065767288, -0.028301026672124863, 0.006994856055825949, -0.009976380504667759, -0.00903837289661169, 0.023490387946367264, 0.0011934470385313034, 0.0034940780606120825, -0.02768462337553501, -0.12467460334300995, -0.006391851231455803, -0.002289743395522237, 0.01175189483910799, -0.0038525310810655355, -0.004083682782948017, 0.015075121074914932, 0.014137113466858864, 0.0015334747731685638, 0.011966296471655369, 0.01845194771885872, -0.014485516585409641, -0.016495533287525177, 0.0080065643414855, -0.01144369225949049, -0.029212234541773796, -0.023932592943310738, 0.05745966359972954, 0.0054973941296339035, 0.0048206886276602745, -0.031061450019478798, 0.012924403883516788, 0.015731725841760635, 0.03183865547180176, -0.03752030059695244, -0.01813034527003765, 0.016723334789276123, -0.018023144453763962, 0.018478749319911003, 0.0101036811247468, 0.009246074594557285, -0.007376759313046932, 0.04754358157515526, 0.048481591045856476, -0.029775040224194527, -0.0048307389952242374, -0.0047503383830189705, -0.005638095550239086, 0.01695113629102707, 0.015731725841760635, 0.005346642807126045, -0.030766647309064865, 0.05006280168890953, 0.011249390430748463, 0.002678346587345004, -0.04355034977197647, 0.0018693150486797094, -0.033151865005493164, 0.02190917544066906, -0.025071602314710617, -0.00647225184366107, 0.0018559149466454983, -0.004170783329755068, -0.02035476453602314, 0.01198639627546072, -0.018250945955514908, -0.003772130236029625, 0.027765022590756416, -0.005038440693169832, 0.01439171563833952, -0.035617485642433167, -0.00476708821952343, 0.016093529760837555, -0.04033432528376579, -0.04014672338962555, -0.009105373173952103, -0.027979424223303795, 0.007363358978182077, 0.013567608781158924, -0.02019396238029003, 0.0007122994866222143, -0.010907687246799469, -0.009058472700417042, 0.0021724924445152283, -0.005500744096934795, 0.013292906805872917, -0.015946127474308014, 0.005437093786895275, -0.041406333446502686, 0.01771494187414646, 0.012415199540555477, -0.0026130210608243942, 0.0250582005828619, 0.021426772698760033, -0.004361735191196203, -0.015356523916125298, 0.01993936114013195, -0.018250945955514908, 0.019028153270483017, 0.010009880177676678, 0.02676001563668251, 0.01400311291217804, 0.00025334578822366893, 0.011503992602229118, -0.004730238113552332, -0.02299458533525467, -0.020381564274430275, -0.0017470390303060412, 0.023168785497546196, 0.019564157351851463, 0.030043041333556175, 0.022753382101655006, 0.00715565774589777, -0.011812195181846619, -0.023651190102100372, -0.0064890021458268166, -0.01420411467552185, -0.0020150411874055862, 0.03508148342370987, -0.018626149743795395, 0.0025912458077073097, -0.006783804390579462, -0.03524228185415268, 0.005808946676552296, 0.00873017031699419, 0.009815579280257225, 0.020488765090703964, -0.014954520389437675, 0.009520776569843292, -0.0452655628323555, 0.014793719165027142, 0.010351583361625671, 0.010465484112501144, -0.0010653085773810744, -0.018465347588062286, -0.0041104829870164394, -0.024602597579360008, 0.014364915899932384, -0.022043177857995033, 0.0025744957383722067, 0.030793447047472, 0.009929480031132698, 0.042237140238285065, -0.01586572825908661, 0.010472184047102928, -0.008334866724908352, 0.031409852206707, 0.014632917940616608, -0.00492118950933218, 0.033768270164728165, -6.338879029499367e-05, 0.011919395998120308, -0.000497060245834291, 0.026827014982700348, -0.011664793826639652, 0.0018358147935941815, -0.0021942676976323128, -0.02542000450193882, -0.015999728813767433, 0.025714807212352753, 0.043121546506881714, -0.018049946054816246, 0.01542352419346571, 0.008622969500720501, -0.011175690218806267, -0.024548998102545738, -0.0009246074478141963, -0.016294531524181366, -0.011564292944967747, 0.03467947989702225, 0.07166377454996109, 0.026827014982700348, 0.012462100014090538, 0.004850838799029589, 0.016723334789276123, -0.01528952270746231, -0.05183161795139313, -0.017446940764784813, 0.010204182006418705, 0.03920871391892433, 0.0030836998485028744, -0.009393475949764252, -0.00614729942753911, 0.018733350560069084, 0.001041020848788321, -0.02257918193936348, 0.02980183996260166, 0.013085205107927322, -0.016294531524181366, 0.016830535605549812, 0.021172169595956802, 0.01389591209590435, -0.035939089953899384, 0.004415335599333048, 0.03146345168352127, -0.005611295346170664, 0.03457227721810341, -0.0023734939750283957, 0.02768462337553501, 0.030498644337058067, 0.028381427749991417, 0.016455331817269325, 0.02639821171760559, 0.035778287798166275, 0.03240146115422249, 0.0024957701098173857, 0.007276258431375027, 0.01941675692796707, 0.005745296366512775, -0.0262508112937212, 0.010378383100032806, 0.035054683685302734, 0.015637924894690514, -0.02923903428018093, -0.0076514617539942265, -0.005762046203017235, -0.015075121074914932, -0.03545668348670006, 0.020636165514588356, -0.015021520666778088, 0.03162425383925438, 0.020448563620448112, 0.0060166483744978905, -0.009011572226881981, -0.0036548792850226164, -0.03969112038612366, 0.012509000487625599, 0.022029777988791466, -0.014646317809820175, -0.014029912650585175, 0.0023131936322897673, -0.01562452595680952, 0.03848510980606079, 0.03821710869669914, -0.01621413044631481, 0.0018877402180805802, 0.011926095932722092, 0.00393963186070323, -0.004850838799029589, -0.01709853671491146, -0.019349755719304085, 0.031115049496293068, -0.01917555369436741, -0.03170465677976608, -0.006435401737689972, 0.008127165026962757, -0.02381199225783348, 0.010291283018887043, -0.024414995685219765, -0.00929967500269413, 0.029373036697506905, 0.016656333580613136, -0.02268638275563717, 0.014539116993546486, -0.0007286308682523668, 0.0067268540151417255, 0.040736328810453415, 0.06357011198997498, -0.017527341842651367, -0.01498132012784481, -0.02558080479502678, 0.03786870464682579, -0.005896047223359346, 0.0047402880154550076, 0.002289743395522237, 0.04293394461274147, 0.0001351526443613693, 0.034599076956510544, 0.027711423113942146, 0.0018274396425113082, -0.0033818522933870554, -0.021775174885988235, 0.009661477990448475, -0.0169377364218235, -0.00021628612012136728, -0.045077960938215256, -0.023597590625286102, -0.0002090626221615821, 0.0009564327192492783, -0.0028776731342077255, -0.04003952071070671, 0.007845763117074966, -0.00542369345203042, 0.030713047832250595, 0.015209122560918331, -0.0032897265627980232, 0.027255818247795105, 0.007865862920880318, -0.00013923548976890743, -0.0031188749708235264, -0.0284082293510437, -0.02489740028977394, -0.02272658236324787, 0.00359792890958488, 0.023785190656781197, 0.02811342664062977, 0.014244314283132553, -0.011148889549076557, 0.04009312391281128, 0.002318218583241105, 0.019336355850100517, 0.01968475803732872, -0.0030987749341875315, 0.008408567868173122, 0.015061721205711365, -0.03224065899848938, -0.02945343591272831, 0.016093529760837555, -0.030418245121836662, -0.020381564274430275, 0.011256090365350246, 0.0005523356958292425, -0.015972929075360298, -0.030096642673015594, 0.00017399202624801546, 0.032883863896131516, 0.00873017031699419, 0.010351583361625671, -0.045908767729997635, -0.033607471734285355, 0.004361735191196203, -0.003942981828004122, -0.0009966329671442509, 0.009212573990225792, 0.011805495247244835, 0.016187330707907677, -0.027523821219801903, -0.013788711279630661, 0.01984556019306183, 0.031168650835752487, -0.040521927177906036, -0.009125472977757454, -0.0016130380099639297, -0.0208237674087286, -0.0038525310810655355, 0.012053396552801132, -0.008830671198666096, -0.0162811316549778, 0.0004715162795037031, -0.004207633901387453, 0.0014011487364768982, 0.0013977987691760063, 0.01963115856051445, -0.00179896445479244, -0.020059961825609207, 0.032053057104349136, -0.01467311754822731, -3.919269602192799e-06, -0.017299538478255272, -0.008314766921103, 0.0006574427825398743, 0.025393204763531685, 0.012937803752720356, -0.021560773253440857, -0.03406307473778725, 0.011631293222308159, 0.0080065643414855, 0.0017235889099538326, -0.026907416060566902, -0.01325270626693964, 0.08409907668828964, -0.031222250312566757, -0.029105033725500107, 0.021466972306370735, 0.02996264025568962, 0.049097996205091476, -0.003219375852495432, -0.011363291181623936, -0.018049946054816246, 0.024200594052672386, -0.041004329919815063, 0.03403627499938011, 0.006043448578566313, -0.0042310841381549835, 0.021413372829556465, 0.008314766921103, -0.020059961825609207, 0.012636302039027214, -0.006824004929512739, 0.007691661827266216, -0.01363460998982191, -0.039342716336250305, -0.005393543280661106, 0.002412019297480583, 0.004981489852070808, 0.0026716464199125767, -0.004666587337851524, 0.007390159647911787, -0.029775040224194527, 0.0005573607049882412, -0.007463859859853983, 0.020488765090703964, -0.040789928287267685, 0.013594409450888634, 0.007792162708938122, -0.011055088602006435, -0.016669733449816704, 0.018532348796725273, -0.009004872292280197, -0.036609094589948654, -0.014163914136588573, -0.002254568040370941, -0.009828979149460793, 0.00350077822804451, -0.0101036811247468, -0.01439171563833952, -0.025795208290219307, 0.017969544976949692, -0.009219273924827576, -0.018639549612998962, -0.006247800309211016, 0.0021054919343441725, 0.019671358168125153, -0.03508148342370987, -0.017232539132237434, 0.004602937027812004, -0.008616269566118717, 0.014539116993546486, 0.006505752447992563, 0.015463724732398987, -0.05067920684814453, 0.002286393428221345, -0.019309556111693382, 0.003748680232092738, 0.02428099513053894, -0.0256746057420969, -0.005192541982978582, -0.0001687576004769653, -0.018518948927521706, 0.03526908531785011, -0.008428667671978474, 0.004860889166593552, -0.01843854784965515, -0.016763534396886826, -0.009353275410830975, -0.005410293582826853, -0.014190713874995708, 0.020863967016339302, 0.0006239425274543464, 0.03063264675438404, -0.01612032949924469, -0.027523821219801903, -0.009031672962009907, -0.00570844579488039, -6.59536544844741e-06, 0.008663170039653778, -0.00013871205737814307, -0.01886735111474991, -0.013828910887241364, -0.0017537390813231468, -0.014378315769135952, -0.007175757549703121, 0.004599587060511112, -0.02283378317952156, 0.019054953008890152, -0.024736598134040833, 0.03248186036944389, 0.00350077822804451, -0.013393407687544823, 0.028542229905724525, -0.026049809530377388, 0.012509000487625599, 0.023785190656781197, 0.006425351835787296, -0.024843798950314522, 0.008911071345210075, -0.04266594350337982, -6.480208685388789e-05, -0.022485380992293358, 0.002932948525995016, 0.008817271329462528, -0.016468731686472893, 0.03186545521020889, -0.009413575753569603, 0.0017905894201248884, 0.01340680755674839, -0.02243177965283394, 0.02107836864888668, -0.0032260760199278593, -0.02856902964413166, 0.04505116119980812, 0.02211017720401287, 0.014619517140090466, 0.012797103263437748, -0.010244382545351982, 0.017473740503191948, -0.006907755509018898, 0.010713386349380016, -0.012763602659106255, 0.031383052468299866, -0.025125201791524887, 0.012361599132418633, 0.0034304275177419186, -0.006422001868486404, 0.035778287798166275, -0.003959731664508581, -0.0003335370565764606, -0.004991540219634771, -0.02856902964413166, -0.03175825625658035, 0.02768462337553501, -0.011034988798201084, -0.011202489957213402, -0.012663101777434349, 0.0010359957814216614, -0.01993936114013195, -0.02071656659245491, -0.016013128682971, 0.023999592289328575, 0.0025443455670028925, -0.008482268080115318, 0.006753654219210148, -0.035215482115745544, -0.00025962709332816303, 0.01255590096116066, -0.025688007473945618, 0.002586220856755972, -0.03336626663804054, -0.0025493705179542303, 0.016307931393384933, 0.04928559809923172, 0.0025610956363379955, -0.0009338200325146317, 0.034545477479696274, 0.03776150196790695, -0.013272807002067566, -0.030766647309064865, 0.020904168486595154, 0.0036213791463524103, -0.022150378674268723, -0.01030468288809061, 0.0019162154057994485, 0.022458581253886223, -0.028327828273177147, -0.007973063737154007, -0.004964740015566349, 0.007128857541829348, -0.020086761564016342, -0.0009547576773911715, 0.03481347858905792, -0.017540741711854935, -0.035617485642433167, 0.03470627963542938, 0.020957767963409424, 0.003879331285133958, -0.004348334856331348, 0.0026448462158441544, 0.022404979914426804, -0.01910855434834957, -0.012676501646637917, 0.0060166483744978905, 0.031490251421928406, 0.029560638591647148, -0.002097116783261299, 0.03285706415772438, -0.000331233924953267, 0.006566052790731192, -0.01787574402987957, 0.03869951143860817, 0.030552245676517487, 0.015463724732398987, -0.02062276564538479, -0.006954655982553959, 0.01420411467552185, 0.024240795522928238, -0.0037754804361611605, 0.00023219874128699303, 0.010050080716609955, -0.03768110275268555, 0.0253664031624794, 0.06399891525506973, 0.010619585402309895, -0.01286410354077816, 0.039503518491983414, -0.004251184407621622, -0.004874289035797119, 0.026331212371587753, 0.017286138609051704, 0.008770370855927467, -0.05553004518151283, -0.006636403501033783, 0.003829080844298005, -0.0077653625048696995, -0.002130617154762149, -0.03725229948759079, 0.008488968014717102, 0.0107200862839818, 0.010880887508392334, 0.007885963656008244, 0.016026528552174568, -0.00419758353382349, -0.03291066363453865, -0.007343259174376726, -0.01673673465847969, 0.012488900683820248, -0.019604356959462166, 0.008428667671978474, -0.017741743475198746, -0.014056713320314884, 0.0011272840201854706, -0.06046128645539284, 0.006080298684537411, 0.030418245121836662, -0.01973835937678814, -0.004609636962413788, 0.042290739715099335, 0.025500405579805374, 0.00359792890958488, -0.035617485642433167, 0.002778847236186266, 0.004569436889141798, 0.0018425148446112871, 0.022096777334809303, -0.044086355715990067, 0.013654709793627262, 0.014860719442367554, 0.00039844383718445897, -0.03462587669491768, 0.004492386244237423, -0.0019597657956182957, -0.00734995910897851, 0.004140633158385754, 0.0075643607415258884, -0.015048321336507797, -0.033875472843647, 0.008924472145736217, 0.009875879622995853, -0.0026548963505774736, -0.057942066341638565, -0.010217581875622272, -0.007477260194718838, 0.020475365221500397, 0.027818623930215836, -0.001924590440467, 0.0070886570028960705, 0.01771494187414646, -0.02511180192232132, -0.007490660063922405, 0.01283730287104845, -0.015972929075360298, 0.022311178967356682, -0.010914388112723827, 0.017192337661981583, -0.007557660806924105, 0.006157349329441786, -0.00842196773737669, -0.024763399735093117, -0.0006038423744030297, 0.025808608159422874, -0.01389591209590435, 0.012924403883516788, -0.021064968779683113, 0.0075643607415258884, -0.05244802311062813, -0.015879128128290176, -0.006696703843772411, 0.028301026672124863, -0.027925824746489525, 0.016147129237651825, 0.02015376277267933, -0.012643001973628998, 0.010143881663680077, -0.01232139952480793, -0.016200730577111244, 0.017889143899083138, 0.01814374513924122, -0.03475987911224365, 0.003628079080954194, 0.0032059757504612207, 0.01735313981771469, 0.007671561557799578, 0.02996264025568962, 0.011611193418502808, 0.02339658886194229, -0.00857606902718544, 0.029024632647633553, -0.02345018833875656, 0.004556036554276943, 0.006428701803088188, 0.020421763882040977, -0.006066898815333843, 0.003607979044318199, 0.0034639278892427683, -0.04121873155236244, 0.03963751718401909, -0.029828639701008797, 0.010914388112723827, 0.013989712111651897, 0.00459623709321022, -0.00896467175334692, 0.01591932773590088, -0.00842196773737669, -0.019751759245991707, -0.01869315095245838, 0.02422739565372467, 0.005641445517539978, 0.022512180730700493, 0.02702801674604416, 0.0022562432568520308, -0.02319558709859848, 0.029775040224194527, 0.0068876552395522594, 0.008777070790529251, -0.014619517140090466, -0.04872279241681099, 0.006197549868375063, 0.034947481006383896, 0.011095289140939713, 0.021265970543026924, 0.0018944402690976858, 0.01679033413529396, 0.024937599897384644, -0.014123713597655296, -0.05708445981144905, -0.01500812079757452, -0.011899295262992382, 0.02382539212703705, -0.03824390843510628, -0.016147129237651825, 0.006589503027498722, -0.024723198264837265, -0.009748578071594238, 0.025018000975251198, 0.0014011487364768982, 0.012462100014090538, 0.007906063459813595, -0.010110381059348583, -0.009212573990225792, 0.0065325526520609856, -0.006291350815445185, 0.0126832015812397, 0.027470221742987633, 0.002587895840406418, 0.012984704226255417, -0.0015937753487378359, 0.00579889677464962, 0.0008961322018876672, -0.021306172013282776, 0.02862263098359108, -0.0007328183855861425, -0.005762046203017235, -0.021373171359300613, -0.001481549465097487, -0.00704175652936101, -0.008408567868173122, 0.006793854758143425, -0.0065694027580320835, 0.005571094807237387, 0.015785327181220055]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"�(xt,i, π∗)∥eΣ−1
t0≤Ext0∼d0h
∥ϕ(xt0, π1
t0)−ϕ(xt0, π∗)∥eΣ−1
t0i
+r
log(2/δ)
2m
34
We take the two inequalities above back into Equation (11) to derive with that probability at least 1 −3δ,
J(π∗)−J(π1
t0)
≤1
mmX
i=1h
∥ϕ(xt0,i, π1
t0)−ϕ(xt0,i, π∗)∥Σ−1
t0,mi
+r
log(2/δ)
2m
· ∥θt0−θ∗∥Σt0,m−ηExt0∼d0
DKL(π∗(·|xt0)∥π1
t0(·|xt0))
≤1
mmX
i=1h
∥ϕ(xt0,i, π1
t0)−ϕ(xt0,i, π2
t0)∥Σ−1
t0,mi
+r
log(2/δ)
2m
· ∥θt0−θ∗∥Σt0,m−ηExt0∼d0
DKL(π∗(·|xt0)∥π1
t0(·|xt0))
≤√
3
mmX
i=1h
∥ϕ(xt0,i, π1
t0)−ϕ(xt0,i, π2
t0)∥eΣ−1
t0i
+r
log(2/δ)
2m
· ∥θt0−θ∗∥Σt0,m−ηExt0∼d0
DKL(π∗(·|xt0)∥π1
t0(·|xt0))
≤√
3Ext0∼d0h
∥ϕ(xt0, π1
t0)−ϕ(xt0, π∗)∥eΣ−1
t0i
+ 2r
log(2/δ)
2m
· ∥θt0−θ∗∥Σt0,m−ηExt0∼d0
DKL(π∗(·|xt0)∥π1
t0(·|xt0))
≤C·r
exp γT(λ)
T)−1 + 2r
log(2/δ)
2ms
d+ log( T/δ)
γ2m+λB2−ηExt0∼d0
DKL(π∗(·|xt0)∥π1
t0(·|xt0))
,
(12)
where the second inequality applies Lemma 10 with λ= Ω( dlog(T/δ)/m), and the last inequality uses
Equation (10). By choosing Tsatisfying that T≥dlog(T) and λ= Θ( dlog(T/δ)/mγ2), we have
J(π∗)−J(π1
t0) =eOs
d
γ2m−ηExt0∼d0
DKL(π∗(·|xt0)∥π1
t0(·|xt0))
,
which concludes the proof.
B.2 Sequential Online Setting
While we mainly care about finding a good model, with a slightly more involved analysis for the enhancer,
we can also derive an upper bound for the average regret as in Pacchiano et al. (2021); Chen et al. (2022):
Regave(T) :=TX
t=1h2J(π∗)−J(π1
t)−J(π2
t)
2i
,
where we now discuss in the sequential case with m= 1. We consider two kinds of regrets: (1) cumulative
suboptimality for the main policy π1
tcompared to π∗:
Reg(T) :=TX
t=1
J(π∗)−J(π1
t)
,
and (2) the","[0.015298688784241676, -0.01856485940515995, 0.014054433442652225, -0.006005654577165842, -0.0009225872927345335, 0.013305052183568478, 0.025012366473674774, 0.04278542846441269, -0.007826085202395916, 0.05409684032201767, 0.018013428896665573, -0.014676560647785664, -0.020077761262655258, -0.01703781820833683, 0.01596323400735855, -0.02798161283135414, 0.034556373953819275, -0.05848001688718796, -0.002158005954697728, 0.04513254389166832, -0.008985505439341068, -0.025889001786708832, 0.040466587990522385, 0.0486956425011158, 0.014704839326441288, -0.0012910920195281506, 0.022439019754529, 0.010498407296836376, 0.05949804186820984, -0.024899251759052277, 0.028151284903287888, -0.04309649020433426, -0.007129726465791464, -0.07058323174715042, 0.016613639891147614, 0.0820077583193779, 0.019738418981432915, 0.04089076444506645, -0.020360546186566353, 0.023499464616179466, 0.031813353300094604, 0.010151995345950127, -0.09806996583938599, 0.0167126152664423, 0.010137856006622314, 0.0033527740743011236, -0.016104627400636673, 0.01137504167854786, 0.02143513225018978, 0.0269494466483593, -0.026228344067931175, 0.025252733379602432, -0.029268287122249603, 0.010321666486561298, -0.009840930812060833, 0.005288086365908384, 0.02187344804406166, 0.017914453521370888, 0.05791444331407547, -0.03987273946404457, 0.04207846522331238, -0.010371153242886066, 0.025210315361618996, -0.018211377784609795, 0.005570871755480766, -0.008589605800807476, -0.027246370911598206, 0.03882643207907677, -0.004559914115816355, 0.06238245218992233, -0.04411451891064644, -0.011820429004728794, 0.06147754192352295, -0.022354183718562126, -0.03325555846095085, 0.03127606213092804, 0.05692469701170921, 0.0422198548913002, 0.053955450654029846, -0.03285966068506241, 0.028009891510009766, 0.02321667969226837, 0.04600917920470238, 0.02118062414228916, 0.030088363215327263, -0.07030044496059418, -0.009133967570960522, -0.006737361662089825, -0.07510779798030853, 0.015609752386808395, -0.011862846091389656, -0.012668784707784653, 0.010668078437447548, 0.015015902929008007, 0.04773417115211487, 0.021760335192084312, 0.0013264401350170374, -0.02798161283135414, 0.013722159899771214, 0.003524212632328272, 0.01780133880674839, -0.04552844539284706, 0.01220925897359848, -0.012958639301359653, 0.026412153616547585, -0.013064684346318245, -0.029211729764938354, 0.059667713940143585, -0.02949451468884945, -0.02314598299562931, -0.0370166040956974, -0.017249908298254013, -0.04462353140115738, 0.03845880925655365, 0.01141039002686739, -0.03987273946404457, -0.09891832619905472, 0.042757149785757065, 0.004870978184044361, -0.004266524221748114, -0.042050186544656754, -0.004588192794471979, 0.0045210313983261585, -0.013184867799282074, 0.0086178844794631, -0.009890418499708176, 0.023881224915385246, -0.08042415976524353, -0.04971366748213768, -0.019809115678071976, 0.02516789920628071, 0.007126191630959511, 0.005164368078112602, -0.02542240545153618, -0.025846583768725395, 0.023994339630007744, 0.02092611789703369, 0.05729231610894203, 0.013969597406685352, -0.02778366208076477, -0.02014845795929432, -0.04386001080274582, -0.04227641224861145, -0.006012724246829748, -0.031954746693372726, 0.04829974099993706, -0.013623185455799103, 0.02143513225018978, -0.0017117352690547705, 0.029042057693004608, 4.8520887503400445e-05, -0.037412505596876144, -0.004404382314532995, 0.0002874248311854899, 0.0006813360378146172, -0.03871331736445427, -0.05138210207223892, 0.043068211525678635, 0.02034640684723854, -0.012576879933476448, -0.04796040058135986, 0.05613289773464203, -0.013806995935738087, -0.020176736637949944, 0.029607629403471947, 0.040155522525310516, -0.018932480365037918, 0.03718627616763115, -0.06057262793183327, -0.05729231610894203, 0.012159771285951138, 0.009989392943680286, -0.0357440710067749, -0.03141745552420616, 0.0263131782412529, -0.05061858147382736, -0.048158347606658936, -0.036592427641153336, 0.01609048806130886, -0.002449628198519349, 0.02656768634915352, 0.02898550033569336, 0.019724279642105103, -0.016104627400636673, -0.020247433334589005, 0.0052986908704042435, 0.018267935141921043, -0.0023683274630457163, -0.0015844817971810699, -0.06532341986894608, 0.014676560647785664, 0.050646860152482986, 0.0186214167624712, -0.010463058948516846, 0.004931069910526276, -0.009077410213649273, 0.028391651809215546, 0.08607986569404602, 0.00762813538312912, 0.027444319799542427, 0.027515016496181488, 0.00014426471898332238, 0.010420640930533409, -0.03155884891748428, 0.017589250579476357, -0.003561328398063779, 0.010448919609189034, 0.03732766956090927, -0.06187343969941139, 0.011155882850289345, 0.005334039218723774, -0.0205302182585001, -0.0030735235195606947, -0.01487451046705246, -0.018140681087970734, 0.035687513649463654, -0.025648633018136024, 0.036790378391742706, -0.00036320247454568744, 0.048158347606658936, -0.0054931058548390865, 0.030427705496549606, -0.00014592167281080037, -0.004057969897985458, -0.018324492499232292, 0.026468710973858833, 0.045104268938302994, -0.028066448867321014, 0.008844112977385521, -0.0382891409099102, 0.033029332756996155, 0.03348178789019585, -0.046631306409835815, -0.03605513647198677, 0.01874867081642151, -0.04171084240078926, -0.006599503569304943, -0.038685038685798645, 0.017716502770781517, -0.04747966304421425, 0.0243478212505579, 0.031134670600295067, -0.018833504989743233, -0.012032517232000828, -0.022226929664611816, 0.009487449191510677, -0.029664184898138046, -0.011763871647417545, -0.04779072850942612, 0.027317067608237267, 0.029466236010193825, 0.0016922936774790287, 0.007529160473495722, 0.005535523872822523, -0.036394476890563965, -0.0020961465779691935, 0.01665605790913105, 0.05158005282282829, -0.03667726367712021, 0.026751495897769928, 0.01503004226833582, 0.008667372167110443, -0.01399080641567707, 2.4591832698206417e-05, 0.01137504167854786, -0.01328384317457676, 0.037978075444698334, -0.00797454733401537, 0.03814774751663208, -0.026299038901925087, 0.024319542571902275, -0.0269494466483593, -0.054379627108573914, 0.041032157838344574, -0.03249203786253929, -0.03020147792994976, 0.014231174252927303, 0.03433014452457428, -0.04674442112445831, 0.004192293155938387, -0.04629196599125862, -0.0011426296550780535, 0.02580416575074196, 0.014902789145708084, 0.043633781373500824, -0.037101440131664276, -0.0006269881851039827, -0.0034340748097747564, -0.056557074189186096, -0.03647931292653084, 0.011523503810167313, -0.035065386444330215, 0.018282074481248856, -0.01989395171403885, 0.00735948933288455, -0.006408623419702053, 0.003683279501274228, -0.049430884420871735, -0.004566983785480261, 0.024814415723085403, 0.03170023858547211, -0.014280661009252071, -0.029579350724816322, 0.030031805858016014, -0.0249275304377079, 0.022580411285161972, -0.0006208022823557258, -0.02644043229520321, -0.04889358952641487, 0.013326261192560196, 0.014273591339588165, 0.010357013903558254, -0.01220925897359848, 0.04063626006245613, -0.011997169815003872, -0.03876987472176552, 0.021816890686750412, -0.005047718994319439, -0.0026033928152173758, -0.051834557205438614, -0.022863198071718216, -0.05497347563505173, -0.028886526823043823, -0.032774824649095535, 0.01640155166387558, 0.0008377516642212868, -0.009480379521846771, -0.014273591339588165, -0.0019123360980302095, -0.012279954738914967, -0.027416041120886803, 0.024178149178624153, -0.005987980403006077, -0.015157296322286129, -0.014690699987113476, -0.010540824383497238, -0.041484612971544266, 0.04578295350074768, 0.02478613890707493, 0.014506889507174492, -0.03424530848860741, 0.021732056513428688, -0.00976316537708044, -0.000438980117905885, 0.04007068648934364, 0.005662776995450258, 0.0395616739988327, 0.007734179962426424, 0.06012016907334328, 0.051268987357616425, -0.04111699387431145, -0.03153057023882866, 0.022537995129823685, 0.012301163747906685, 0.015850119292736053, 0.001930010155774653, 0.0069176373071968555, -0.017942732200026512, -0.04798867926001549, -0.011615409515798092, -0.020629193633794785, 0.00022910033294465393, 0.008087662048637867, 0.0029745486099272966, 0.0026422757655382156, 0.02816542237997055, -0.036790378391742706, 0.026398014277219772, -0.017886174842715263, -0.02034640684723854, -0.028900664299726486, 0.09077410399913788, -0.06656767427921295, 0.005782960914075375, -0.05265463516116142, -0.020106039941310883, -0.005500175524502993, 0.011714383959770203, 0.04029691591858864, -0.013446444645524025, -0.018423467874526978, -0.017150932922959328, -0.005616824608296156, -0.024574048817157745, 0.00743725523352623, 0.004718980751931667, -0.011403320357203484, -0.01760338991880417, -0.011042769066989422, -0.00408271374180913, 0.014202895574271679, -0.016924705356359482, -0.007051960099488497, 0.015468359924852848, -0.058197230100631714, -0.010625660419464111, 0.020572636276483536, 0.06826438754796982, 0.03554612025618553, 0.04538705199956894, -0.028660297393798828, -0.018098263069987297, -0.057575102895498276, -0.041541170328855515, -0.015807703137397766, -0.013333329930901527, 0.03718627616763115, 0.022170374169945717, 0.040268637239933014, -0.0025309291668236256, 0.044991154223680496, -0.0115093644708395, 0.01874867081642151, -0.04671614244580269, 0.005652172490954399, -0.029551072046160698, 0.010922584682703018, 0.020827142521739006, 0.060685742646455765, 0.05056202411651611, -0.02071402780711651, -0.06204311177134514, 0.0050194403156638145, -0.019441494718194008, -0.04895014688372612, 0.014832092449069023, 0.04108871519565582, -0.010759983211755753, 0.017645807936787605, -0.0408342070877552, 0.0045210313983261585, 0.045556724071502686, 0.016627779230475426, -0.004839164670556784, -0.04872392117977142, -0.0004979673540219665, 0.022043120115995407, 0.0007851712871342897, -0.010724634863436222, -0.05271119251847267, -0.005143159069120884, -0.013962527737021446, -0.02569105103611946, 0.01487451046705246, -0.018550720065832138, 0.010258039459586143, -0.03237892687320709, -0.03393424674868584, 0.017773060128092766, 0.0039519257843494415, -0.052428409457206726, 0.01645810902118683, 0.050759974867105484, -0.028660297393798828, -0.019356658682227135, -0.03138917684555054, 0.05616117641329765, -0.0037893240805715322, 0.02205725945532322, -0.02161894179880619, 0.011466947384178638, -0.015595613047480583, -0.003768115071579814, -0.012294094078242779, 0.027670549228787422, 0.0424460843205452, 0.023188401013612747, 0.005524919368326664, -0.04436902701854706, 0.01805584691464901, -0.00024544887128286064, -0.06159065291285515, 0.04818662628531456, -0.043011654168367386, 0.012838455848395824, 0.0165995005518198, 0.033736295998096466, -0.002495580818504095, 0.028688576072454453, -0.05191939324140549, 0.004114527255296707, -0.040268637239933014, 0.002870271448045969, 0.02236832305788994, -0.015539056621491909, 0.06888651847839355, 0.07041355967521667, -0.03540473058819771, -0.03642275556921959, -0.01978083699941635, 0.022651107981801033, -0.027317067608237267, 0.022594550624489784, -0.01685400865972042, 0.006097559817135334, -0.010123716667294502, 0.02720395289361477, -0.03243548423051834, -0.013566628098487854, 0.005411805119365454, 0.03676209971308708, 0.01331919152289629, 0.0013078823685646057, 0.002907387213781476, -0.0211099274456501, -0.00919052492827177, 0.003863555146381259, -0.00998232327401638, 0.011170022189617157, -0.011325553990900517, -0.014316009357571602, 0.00093407544773072, -0.003140685148537159, 0.022735944017767906, -0.009805582463741302, 0.005277481861412525, -0.035574398934841156, 0.022269347682595253, -0.01856485940515995, 0.014747257344424725, 0.010858958587050438, -0.03806291148066521, -0.020190875977277756, 0.010081298649311066, 0.029466236010193825, -0.0071968878619372845, 0.012456695549190044, -0.07844465970993042, -0.013213146477937698, -0.048356298357248306, 0.06464473903179169, -0.004107457585632801, 0.000713591231033206, 0.0020325197838246822, 0.006164721213281155, 0.008214915171265602, -0.010180273093283176, 0.010477198287844658, -0.002755390014499426, 0.0017028981819748878, 0.01449275016784668, -0.014478610828518867, -0.011481085792183876, 0.03285966068506241, 0.010661008767783642, -0.05030751973390579, 0.044538695365190506, -0.004036761354655027, -0.030936719849705696, 0.0437186174094677, -0.0052032507956027985, -0.017150932922959328, -0.022905616089701653, -0.025266872718930244, -0.0589890293776989, -0.01965358294546604, -0.0005509896436706185, 0.011629548855125904, 0.0005010603344999254, 0.014096850529313087, -0.01049133762717247, 0.02009190060198307, -0.000641127466224134, -0.017136793583631516, -0.023089425638318062, 0.023923642933368683, 0.0093107083812356, -0.008971366100013256, 0.00648285448551178, 0.026044532656669617, -0.03922232985496521, 0.019186988472938538, 0.003934251610189676, 0.020459521561861038, 0.024644745513796806, -0.0049169305711984634, 0.04482148215174675, 0.02727464959025383, -0.00020203689928166568, -0.02130787819623947, -0.044029682874679565, 0.0016763870371505618, -0.02771296724677086, -0.02791091613471508, -0.04411451891064644, 0.004750794265419245, -0.003902438096702099, -0.006567690521478653, -0.05562388151884079, 0.027698827907443047, 0.010081298649311066, -0.023626718670129776, -0.02963590808212757, -0.009232942014932632, -0.004086248576641083, 0.0306539349257946, -0.01204665657132864, 0.002044891705736518, 0.006949450355023146, -0.0382891409099102, 0.036592427641153336, -0.014634143561124802, -0.00766348373144865, -0.005235064309090376, -0.004941674415022135, 0.03899610415101051, -0.025464823469519615, 0.02033226750791073, 0.026270762085914612, 0.0007449627155438066, 0.01887592300772667, -0.015581473708152771, 0.009975254535675049, 0.02530929073691368, -0.03891126811504364, -0.03599857911467552, 0.0008443794795311987, -0.006313183344900608, 0.04945916309952736, -0.0013768112985417247, 0.0014554610243067145, 0.005079532507807016, 0.026864610612392426, -0.026850471273064613, 0.008031104691326618, 0.026101090013980865, -0.0032697059214115143, -0.012824316509068012, 0.04948744177818298, -9.394881635671481e-05, -0.023032868281006813, -0.015737006440758705, 0.010385292582213879, 0.017051957547664642, 0.005415339954197407, -0.029833856970071793, -0.003061151597648859, 0.00829268153756857, -0.029098615050315857, -0.057886164635419846, 0.02156238444149494, 0.025068923830986023, 0.021322017535567284, -0.041993629187345505, 0.005475431680679321, 0.02263696864247322, -0.003987273667007685, 0.02682219259440899, -0.03268998861312866, -0.03763873502612114, -0.02536584809422493, -0.01652880571782589, 0.02758571319282055, 0.005648637656122446, 0.03800635412335396, -0.036592427641153336, 0.022735944017767906, -0.004987627267837524, -0.033340394496917725, -0.051721446216106415, -0.003206079127267003, 0.007394837681204081, -0.00950158853083849, -0.004627075511962175, 0.007331210654228926, 0.03517850115895271, 0.019809115678071976, 0.027741245925426483, 0.006659595761448145, -0.015015902929008007, -0.0053022257052361965, 0.02116648480296135, 0.039250608533620834, -0.016571223735809326, 0.02205725945532322, -0.024503352120518684, -0.045867789536714554, -0.04462353140115738, -0.024460934102535248, 0.01570872776210308, -0.050194405019283295, 0.0009027039632201195, -0.029664184898138046, 0.015496638603508472, -0.026850471273064613, -0.01863555610179901, 0.009911627508699894, -0.013354538939893246, -0.02994697168469429, -0.02282078005373478, -0.004764933604747057, 0.009522797539830208, 0.05519970506429672, -0.005715799517929554, -0.012414277531206608, -0.0015871329233050346, 0.0030311057344079018, 0.023372210562229156, -0.027034282684326172, -0.016415691003203392, -0.0141109898686409, 0.02740190364420414, -0.04920465499162674, 0.015440081246197224, -0.04855424910783768, 0.0012919757282361388, -0.012647575698792934, 0.045556724071502686, 0.039137497544288635, -0.06713324785232544, 0.012541531585156918, -0.011968891136348248, -0.030088363215327263, 0.021265460178256035, 0.00810180138796568, 0.01887592300772667, 0.007776597980409861, -0.0006875219405628741, -0.0012389534385874867, -0.018154820427298546, -0.03294449672102928, 0.005539058707654476, -0.07239305227994919, -0.005196181125938892, 0.01033580582588911, -0.006051606964319944, -0.04134322330355644, 0.025521380826830864, -0.0033527740743011236, -0.004581123124808073, -0.017702365294098854, 0.0034340748097747564, 0.012145631946623325, -0.011212440207600594, 0.01437256671488285, 0.04159772768616676, -0.0011691407999023795, 0.025394126772880554, 0.012067865580320358, 0.015298688784241676, -0.002256980864331126, -0.023556021973490715, -0.04569811746478081, -0.001476669916883111, 0.017758920788764954, 0.02505478449165821, 0.023188401013612747, 0.04366206005215645, 0.002663484774529934, 0.02193000540137291, -0.008992575109004974, 0.01293743122369051, -0.04547188803553581, 0.006161186378449202, 0.02142099291086197, 0.0009650050778873265, 0.029098615050315857, -0.019625304266810417, -0.034103915095329285, 0.0012813712237402797, 0.01525627076625824, -0.04038175195455551, -0.012442556209862232, 0.01716507226228714, 0.0025433008559048176, 0.012407207861542702, -0.024008478969335556, -0.00020214736287016422, 0.007811945863068104, -0.010053019970655441, -0.017758920788764954, 0.0011099325492978096, -0.014987625181674957, 0.011707314290106297, 0.046320244669914246, 0.02854718267917633, -0.012661715038120747, -0.03560267761349678, -0.026030393317341805, -0.00835630763322115, 0.004220571834594011, 0.00868151057511568, -0.009876279160380363, -0.011233649216592312, -0.007034286390990019, -0.01678331196308136, 0.012435486540198326, -0.005758217070251703, -0.03758217766880989, -0.021661359816789627, -0.0030293383169919252, -0.029607629403471947, -0.026157647371292114, -0.0010357014834880829, 0.020261572673916817, -0.013821135275065899, -0.03158712759613991, -0.11741248518228531, 0.0006623363588005304, 0.01102862972766161, 0.019158709794282913, -0.002962176688015461, -0.008525978773832321, 0.022028980776667595, -0.007995756343007088, -0.013898900710046291, -0.019851533696055412, -0.005065393168479204, -0.011820429004728794, -0.005167902912944555, -0.012378930114209652, -0.027811940759420395, -0.038430530577898026, -0.018918341025710106, 0.019851533696055412, 0.027133256196975708, -0.023697413504123688, -0.02480027638375759, 0.013121241703629494, 0.004609401803463697, 0.0294379573315382, -0.021958284080028534, -0.027175674214959145, 0.03285966068506241, -0.018607277423143387, 0.0167126152664423, -0.003817602526396513, 0.01881936751306057, -0.004107457585632801, 0.038882989436388016, 0.01920112781226635, -0.0027076699770987034, -0.005524919368326664, 0.0057723564095795155, -0.012053726240992546, 0.008066453039646149, 0.025592075660824776, -0.0028402255848050117, -0.031756795942783356, 0.04501943290233612, 0.009628841653466225, 0.0345846526324749, -0.04340755566954613, 0.015977373346686363, -0.02644043229520321, 0.03020147792994976, -0.033538345247507095, 0.023343931883573532, -0.001056026667356491, -0.021703777834773064, -0.02338634990155697, -0.018423467874526978, -0.01773064211010933, 0.03076704777777195, 0.013008126989006996, -0.007571578491479158, 0.012838455848395824, -0.016231879591941833, 0.008575466461479664, 0.022014841437339783, -0.021519966423511505, -0.04159772768616676, -0.002410745248198509, 0.030738770961761475, 0.021406853571534157, -0.005281016696244478, -0.014931067824363708, 0.008031104691326618, -0.030229756608605385, -0.005949097219854593, 0.00702368188649416, -0.02823611907660961, 0.00267055444419384, -0.036196526139974594, 0.017971010878682137, -0.06588899344205856, 0.02556379698216915, 0.027882637456059456, -0.00728172343224287, 0.014549307525157928, 1.0563027899479493e-05, -0.011000351049005985, -0.014478610828518867, 0.0044467998668551445, -0.019724279642105103, 0.017758920788764954, 0.011304344981908798, 0.04131494462490082, 0.001180628896690905, -0.002228702185675502, -0.03198302537202835, -0.013326261192560196, -0.04807351529598236, -0.03611169382929802, -0.006369740702211857, 0.025846583768725395, 0.012414277531206608, 0.023259097710251808, 0.020190875977277756, 0.001624248456209898, -0.010321666486561298, -0.00534110888838768, -0.004938139580190182, -0.008794625289738178, 0.006171790882945061, 0.020940257236361504, -0.0010401199106127024, -0.015185575000941753, -0.005337574053555727, -0.03763873502612114, -0.0017488508019596338, 0.03356662392616272, 0.014535168185830116, 0.01894661970436573, -0.010045950300991535, 0.0016922936774790287, -0.011389181017875671, 0.0044255913235247135, 0.004312477074563503, -0.00766348373144865, 0.010470128618180752, -0.013396956957876682, -0.010321666486561298, -0.008313889615237713, 0.02924000844359398, -0.00419582799077034, 0.014464471489191055, 0.020431242883205414, 0.005797100253403187, 0.03534817323088646, 0.014033224433660507, -0.0010542592499405146, 0.0016330855432897806, 0.02651112899184227, 0.006896428298205137, -0.006839871406555176, 0.028844108805060387, 0.0024513956159353256, 0.005560267250984907, 0.020516078919172287, 0.021519966423511505, -0.01160127017647028, 0.003331565298140049, 0.006952985189855099, -0.020516078919172287, -0.0052067856304347515, 0.008363377302885056, 0.03121950477361679, -0.017575111240148544, 0.0032308229710906744, -0.004178153816610575, 0.0006663130479864776, -0.013206076808273792, -3.004594509548042e-05, -0.01978083699941635, 0.005033579654991627, 0.00957228522747755, 0.056415680795907974, 0.0288582481443882, -0.00716860918328166, -0.020487800240516663, 0.049232933670282364, -0.034499816596508026, -0.013927179388701916, -0.0384022556245327, -0.006652526091784239, 0.0043301512487232685, -0.0034711905755102634, -0.032011304050683975, 0.014450332149863243, -0.0030169663950800896, 0.024687163531780243, -0.009042062796652317, 0.005146693903952837, 0.026468710973858833, 0.006889358628541231, 0.03554612025618553, 0.028886526823043823, 0.018578998744487762, -0.04049486666917801, -0.0008677976438775659, 0.04640508070588112, -0.025408266112208366, 0.028377512469887733, -0.004948744084686041, 0.030229756608605385, 0.02403675764799118, 0.05446446314454079, 0.02079886384308338, 0.0006649874849244952, 0.02963590808212757, 0.005500175524502993, -0.018932480365037918, 0.009409683756530285, 0.01284552551805973, 0.002564509864896536, -0.049741946160793304, -0.04609401524066925, 0.029664184898138046, 0.011770941317081451, -0.018098263069987297, -0.02618592604994774, -0.003958995454013348, -0.0050123706459999084, -0.014803814701735973, -0.00979144312441349, -0.008858251385390759, 0.009741956368088722, 0.011198300868272781, -0.026101090013980865, 0.014973485842347145, 0.0022304696030914783, -0.022142095491290092, 0.009911627508699894, 0.023188401013612747, -0.019879812374711037, -0.0028667368460446596, 0.012371860444545746, -0.04029691591858864, 0.008080592378973961, 0.0525132454931736, -0.006581829395145178, -0.011869915761053562, 0.025196176022291183, 0.023541882634162903, 0.007500882260501385, -0.022170374169945717, -0.016670197248458862, 0.015510777942836285, -0.02218451350927353, -0.012668784707784653, 0.007748319301754236, -0.015454220585525036, -0.015440081246197224, 0.01449275016784668, -0.0047331200912594795, 0.000904029468074441, 0.04007068648934364, 0.021053371950984, -0.020007064566016197, -0.010880167596042156, 0.014832092449069023, -0.0004679214325733483, 0.008936017751693726, 0.06447506695985794, -0.006599503569304943, -0.0009932835819199681, -0.03854364529252052, 0.031191226094961166, 0.017575111240148544, 0.003190172603353858, 0.02867443673312664, 0.039250608533620834, 0.012612227350473404, 0.036790378391742706, 0.01614704541862011, -0.006744431331753731, 0.0019759628921747208, -0.014521028846502304, -0.006875219289213419, -0.013142450712621212, -0.007083773612976074, -0.03622480481863022, -0.011778010986745358, 0.028193701058626175, 0.01925768330693245, 0.006776244379580021, -0.03738422691822052, 0.019243543967604637, -0.018225517123937607, 0.03478259965777397, 0.015539056621491909, -0.03636619821190834, 0.0282219797372818, -0.007239305414259434, -0.00018347910372540355, -0.010250969789922237, -0.040466587990522385, -0.015199713408946991, -0.028787551447749138, -0.01736302115023136, 0.026850471273064613, 0.0013290912611410022, 0.01576528511941433, -0.006101094651967287, 0.038119468837976456, 0.0014722513733431697, 0.018918341025710106, 0.03910921886563301, -0.026496989652514458, 0.024432655423879623, 0.006076350808143616, -0.028518905863165855, 0.0037433714605867863, 0.013934249058365822, -0.02072816714644432, -0.02796747349202633, 0.008978435769677162, -0.005977375898510218, -0.018805228173732758, -0.03172851726412773, 0.027939194813370705, 0.033849410712718964, 0.02656768634915352, 0.0009217035840265453, -0.014506889507174492, -0.01083774957805872, -0.006931776646524668, 0.004489217884838581, -0.014287730678915977, 0.00038419043994508684, 0.0014050898607820272, 0.021590663120150566, -0.023372210562229156, -0.023414628580212593, 0.00835630763322115, 0.006291974801570177, -0.00033647040254436433, -0.012244606390595436, 0.005167902912944555, -0.00217037764377892, -0.02256627194583416, -0.036139972507953644, -0.0005598266725428402, -0.022340044379234314, -0.008646163158118725, 0.01525627076625824, -0.004107457585632801, -0.022976310923695564, 0.01328384317457676, 0.0068186623975634575, -0.024446794763207436, 0.008108871057629585, -0.026977725327014923, -0.017405439168214798, -0.04241780564188957, 0.0007657297537662089, 0.015906676650047302, 0.02574760839343071, 0.01976669766008854, -0.016387412324547768, -0.03260515257716179, 0.016231879591941833, 0.029833856970071793, 0.0026086950674653053, -0.021717917174100876, 0.0016065743984654546, 0.1000494658946991, -0.0147189786657691, -0.0359703004360199, 0.0287451334297657, 0.007062564603984356, 0.02543654479086399, 0.012301163747906685, -0.01274655107408762, -0.026016253978013992, -0.0023329793475568295, -0.011367972008883953, 0.033340394496917725, -0.011707314290106297, -0.003557793563231826, 0.008073522709310055, 0.010201482102274895, -0.02212795615196228, 0.03127606213092804, 0.00896429643034935, 0.014634143561124802, -0.006744431331753731, -0.024008478969335556, -0.031247783452272415, 0.01144573837518692, -0.0069176373071968555, 0.00781901553273201, -0.009897488169372082, -0.01510073896497488, -0.0042594545520842075, 0.03020147792994976, -0.009770235046744347, 0.024319542571902275, -0.051014482975006104, 0.013149519450962543, 0.012393069453537464, 0.004185223486274481, -0.031134670600295067, 0.030314592644572258, -0.0034641209058463573, -0.009869209490716457, -0.005669846665114164, 0.0008784020901657641, -0.015044181607663631, 0.005468362011015415, 0.031191226094961166, -0.0027006003074347973, -0.017645807936787605, 0.009275360032916069, 0.0017302930355072021, 0.002541533438488841, -0.020134318619966507, -0.010194412432610989, 0.04442558065056801, -0.020487800240516663, -0.015341106802225113, -0.005786495748907328, -0.010901376605033875, 0.017009539529681206, 0.007925059646368027, 0.028080588206648827, -0.05087308958172798, 0.015284549444913864, -0.009049131534993649, -0.005828913301229477, 0.0211099274456501, -0.02338634990155697, -0.00503711448982358, 0.008858251385390759, -0.0022675851359963417, 0.029409678652882576, -0.023061146959662437, -0.00507246283814311, -0.007868503220379353, -0.016062209382653236, -0.014521028846502304, 0.012378930114209652, -0.03670554235577583, 0.008108871057629585, 0.021152345463633537, -0.004591727629303932, -0.03240720555186272, -0.024121591821312904, -0.007649344392120838, -0.02569105103611946, -0.026143508031964302, 0.012060795910656452, 0.044340748339891434, 0.007165074348449707, -0.025903141126036644, 0.01255567092448473, -0.006306113675236702, 0.009961115196347237, 0.004489217884838581, -0.03090844117105007, 0.0017674085684120655, -0.015737006440758705, 0.02651112899184227, -0.016118766739964485, -0.014832092449069023, 0.04448213800787926, -0.020360546186566353, -0.01163661852478981, 0.02320254035294056, 0.004715445917099714, -0.009607632644474506, 0.008851182647049427, -0.04086248576641083, -0.003290914697572589, -0.044397301971912384, -0.0010215621441602707, 0.018677974119782448, -0.024771999567747116, 0.022665247321128845, -0.0023047009017318487, -0.038373976945877075, -0.007734179962426424, -0.004209967330098152, 0.004945209249854088, 0.020007064566016197, -0.02340048924088478, 0.03565923497080803, 0.027119116857647896, 0.005885470658540726, -0.006733826827257872, -0.024319542571902275, 0.016868147999048233, -0.012004239484667778, 0.018409328535199165, -0.00025340222055092454, 0.006387414410710335, -0.010858958587050438, 0.01729232631623745, 0.007373628672212362, -0.008264402858912945, 0.010116646997630596, 0.017659947276115417, -0.016613639891147614, -0.031954746693372726, -0.03161540627479553, -0.020954396575689316, 0.025012366473674774, 0.007080238778144121, -0.016302576288580894, -0.0035524913109838963, -0.00553198903799057, -0.015468359924852848, -0.004301872570067644, -0.02200070209801197, 0.021449269726872444, 0.021944144740700722, -0.02282078005373478, 0.028024030849337578, -0.018706252798438072, 0.026115229353308678, 0.015496638603508472, -0.018776949495077133, 0.010526685975492, -0.018154820427298546, 0.03427358716726303, -0.012718272395431995, 0.037610456347465515, 0.004630610346794128, -0.0026086950674653053, 0.030540820211172104, 0.0524001307785511, -0.006963589694350958, -0.01709437556564808, -0.0013591372407972813, 0.0004524565883912146, -0.008660302497446537, -0.01927182264626026, 0.013121241703629494, 0.014931067824363708, -0.027557434514164925, -0.001177094061858952, -0.011339693330228329, -0.0022110282443463802, -0.008540118113160133, -0.00033956338302232325, 0.029211729764938354, -0.027500877156853676, -0.034867435693740845, 0.031247783452272415, 0.020049482583999634, -0.006401553750038147, 0.006974194198846817, 0.005638033617287874, 0.008405795320868492, -0.0269494466483593, -0.023428767919540405, 0.008667372167110443, 0.006776244379580021, 0.027430180460214615, 0.006846941076219082, 0.03427358716726303, 0.0050123706459999084, 0.023089425638318062, -0.016557084396481514, 0.021788613870739937, 0.02327323704957962, 0.0018434071680530906, 0.0072958627715706825, 0.000601802603341639, 0.009324847720563412, 0.0147189786657691, 0.008038174360990524, -0.009756095707416534, -0.0019936368335038424, -0.013460583984851837, -0.01487451046705246, 0.04643335938453674, -0.0002209260710515082, -0.007044890429824591, 0.026595965027809143, -0.014803814701735973, 0.01360904611647129, 0.02416400983929634, 0.013637324795126915, -0.012393069453537464, -0.04309649020433426, -0.01166489627212286, -0.008787555620074272, 0.0007330327061936259, 0.0040438310243189335, -0.0071014477871358395, 0.002578649204224348, 0.02436196058988571, 0.027317067608237267, 8.367575355805457e-05, 0.019794976338744164, -0.004393777810037136, -0.024870973080396652, -0.0016631315229460597, -0.013934249058365822, 0.025478962808847427, -0.029155172407627106, -0.01500176452100277, -0.00988334883004427, -0.00816542748361826, 0.03071049228310585, -0.047592777758836746, 0.013736299239099026, 0.013297982513904572, -0.043633781373500824, -0.009848000481724739, 0.03421702980995178, 0.019186988472938538, 0.00915517657995224, -0.041286665946245193, 0.007500882260501385, -0.015807703137397766, -0.0009941672906279564, 0.013446444645524025, -0.041230108588933945, 0.03198302537202835, -0.0018769878661260009, 0.013015196658670902, -0.019724279642105103, 0.002228702185675502, 0.01976669766008854, -0.03209614008665085, 0.00351184094324708, -0.010533755645155907, -0.013149519450962543, -0.029607629403471947, 0.029098615050315857, 0.010724634863436222, -0.004072109237313271, -0.04490631818771362, -0.022778362035751343, 0.008752207271754742, 0.022340044379234314, 0.017560971900820732, 0.004764933604747057, 0.017971010878682137, 0.01399080641567707, 0.0076988316141068935, -0.010668078437447548, 0.013354538939893246, -0.02016259729862213, 0.022156234830617905, 0.0017179211135953665, -0.006369740702211857, 0.016627779230475426, 0.04007068648934364, -0.005281016696244478, -0.042813707143068314, -0.0013697416288778186, 0.020077761262655258, -0.008059383369982243, -0.006291974801570177, 0.009162246249616146, 0.01338281761854887, -0.02656768634915352, -0.0033916570246219635, 0.008957226760685444, 0.020487800240516663, -0.03249203786253929, 0.010385292582213879, 0.01319193746894598, -0.02091197855770588, 0.03051254153251648, 0.020431242883205414, -0.008002826012670994, 0.027939194813370705, 0.008936017751693726, -0.011799219995737076, 0.01577942445874214, 0.009565215557813644, 0.012032517232000828, 0.01033580582588911, -0.017829617485404015, 0.029918693006038666, 0.042813707143068314, 0.009642980992794037, 0.00309119769372046, -0.01131848432123661, 0.03605513647198677, -0.025606215000152588, 0.03789323940873146, 0.012343581765890121, -0.006210673600435257, 0.012393069453537464, -0.03845880925655365, 0.04151289165019989, -0.024842694401741028, 0.020756445825099945, 0.011226579546928406, 0.015341106802225113, -0.012322372756898403, 0.015355246141552925, -0.008285611867904663, 0.01141039002686739, -0.005136089399456978, -0.011558852158486843, 0.028957221657037735, -0.0015438314294442534, 0.02168963849544525, -0.002104983665049076, -0.004524565767496824, 0.025507241487503052, 0.013467653654515743, 0.022481437772512436, 0.013043475337326527, -0.009409683756530285, 0.014690699987113476, 0.02605867199599743, 0.03681865707039833, 0.016033930703997612, -0.00027792499167844653, 0.015298688784241676, 0.01652880571782589, -0.02294803224503994, -0.035687513649463654, 0.029098615050315857, -0.00887239072471857, -0.0006804523291066289, -0.048469413071870804, -0.0020731703843921423, -0.011099325492978096, -0.03625308349728584, -0.013524210080504417, 0.02129373885691166, 0.002999292453750968, 0.01392010971903801, -0.003213148796930909, 0.00251855724491179, 0.011155882850289345, -0.005337574053555727, -0.0035560261458158493, 0.026412153616547585, 0.020501939579844475, 0.009770235046744347, 0.02791091613471508, -0.00686461478471756, 0.03158712759613991, -0.027741245925426483, -0.028943082317709923, 0.03546128422021866, 0.00919052492827177, 0.01093672402203083, -0.06000705808401108, -0.0080098956823349, -0.01456344686448574, -0.0019211731851100922, 0.021831030026078224, -0.0003609932027757168, 0.01787203550338745, 0.0011983030708506703]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" average suboptimality:
Regave(T) :=TX
t=12J(π∗)−J(π1
t)−J(π2
t)
2
.
In this case, our goal is to output a sequence of policy pair {π1
t, π2
t}T
t=1so that the regrets Reg( T) and
Regave(T) are sublinear. To achieve this goal, the enhancer computes its policy by maximizing the uncertainty
estimator
π2
t= argmax
π2
t∈ΠtmX
i=1Γ(xt,i, π1
t, π2
t,D1:t−1), (13)
where D1:t−1=∪t−1
s=1Ds.
35
Theorem 4 (Sequential Online learning) .Under Assumption 1, with λ= Ω( dlog(T/δ)/(γ2B2))andβ:=
O q
dlog(T/δ)
γ2
, with probability at least 1−2δ, the regret of Algorithm 2 with Option II and m= 1satisfies
Regave(T)≲p
Tβ2d−ηTX
t=1Ext∼d0
DKL(π∗(·|xt)∥πt
1(·|xt))
,
which further implies that
Reg(T)≲p
Tβ2d−ηTX
t=1Ext∼d0
DKL(π∗(·|xt)∥πt
1(·|xt))
.
Proof of Theorem 4. First, we invoke the decomposition Lemma 1 and Lemma 2 to obtain for each batch
t∈[T]
J(π∗)−J(π1
t)
=Ext∼d0h
Eπ∗[r∗(xt, a)−ˆr(xt, a)] +Eπ1
t[ˆr(xt, a)−r∗(xt, a)]−η·Ext∼d0
DKL(π∗(·|xt)∥π1
t(·|xt))i
=Ext∼d0hD
ˆθ−θ∗, ϕ(xt, π1
t)−ϕ(xt, π∗)Ei
−η·Ext∼d0
DKL(π∗(·|xt)∥π1
t(·|xt))i
. (14)
Then, we deduce that with probability at least 1 −δ,
TX
t=1
J(π∗)−J(π1
t)
=TX
t=1Ext∼d0h
θt−θ∗, ϕ(xt, π1
t)−ϕ(xt, π∗)i
−ηTX
t=1Ext∼d0
DKL(π∗(·|xt)∥πt
1(·|xt))
≤βTX
t=1Ext∼d0min
1,∥ϕ(xt, π1
t)−ϕ(xt, π∗)∥Σ−1
t	
−ηTX
t=1Ext∼d0
DKL(π∗(·|xt)∥πt
1(·|xt))
≤βTX
t=1Ext∼d0min
1,∥ϕ(xt, π1
t)−ϕ(xt, π2
t)∥Σ−1
t	
−ηTX
t=1Ext∼d0
DKL(π∗(·|xt)∥πt
1(·|xt))
≤βvuutTTX
t=1Ext∼d0,(a1
t,a2
t)∼(π1
t,π2
t)min
1,∥ϕ(xt, a1
t)−ϕ(xt, a2
t)∥2
Σ−1
t	
−ηTX
t=1Ext∼d0
DKL(π∗(·|xt)∥πt
1(·|xt))
,
(15)
where the first inequality uses the Cauchy-Schwarz","[-0.008621986024081707, -0.03172999992966652, 0.017052827402949333, 0.005693377926945686, -0.012943219393491745, 0.0033706300891935825, 0.04134184494614601, 0.03776470944285393, -0.004283686634153128, 0.06378767639398575, 0.030774278566241264, -0.03126579150557518, -0.031020035967230797, 0.0035532412584871054, -0.013796542771160603, -0.006140519864857197, 0.016315555199980736, -0.04071379825472832, -0.020711882039904594, 0.039020802825689316, -0.0409049428999424, -0.023934032768011093, 0.03552558645606041, 0.04128723219037056, 0.013892115093767643, -0.01871851645410061, 0.03170269355177879, 0.009372911415994167, 0.0507352352142334, -0.0524282306432724, 0.025149166584014893, -0.03481562063097954, -0.0022101092617958784, -0.03795585408806801, 0.0008968435577116907, 0.059746336191892624, 0.04543779790401459, 0.038693126291036606, 0.0015658496413379908, 0.01698456145823002, 0.02284177765250206, -0.04560163617134094, -0.06728289276361465, 0.027224451303482056, 0.01471813302487135, 0.016438433900475502, -0.01383067574352026, -0.016588618978857994, 0.01942848227918148, 0.031020035967230797, -0.02916320227086544, 0.026036623865365982, -0.040522653609514236, 0.021312622353434563, -0.01989269070327282, 0.004044755827635527, 0.017216665670275688, 0.025026287883520126, 0.06690060347318649, -0.056469570845365524, 0.020152101293206215, 0.002962741069495678, 0.031893838196992874, 0.01591961272060871, -0.0024507467169314623, -0.0007180721731856465, -0.0418606661260128, 0.034105654805898666, 0.00802807230502367, 0.04049534723162651, -0.038174305111169815, -0.0197151992470026, 0.05130866914987564, -0.014431416057050228, -0.003164125606417656, 0.05229169875383377, 0.05543192848563194, 0.033122625201940536, 0.04371749609708786, -0.05480388551950455, 0.029600104317069054, 0.008901876397430897, 0.07165191322565079, 0.021080518141388893, 0.012233253568410873, -0.08579660952091217, -0.048851095139980316, -0.020438818261027336, -0.04737655073404312, -0.028289398178458214, -0.011072732508182526, 0.01863659732043743, -0.009707414545118809, -0.005000479053705931, 0.044673219323158264, 0.015578283928334713, 0.022391222417354584, -0.03891157731413841, -0.010362767614424229, -0.007898367010056973, 0.0030088205821812153, -0.06526222079992294, 0.03478831425309181, 0.003887744387611747, 0.0368909053504467, -0.022964656352996826, -0.036808986216783524, 0.064060740172863, -0.03295878693461418, -0.0011366276303306222, -0.026514485478401184, -0.047622308135032654, -0.016356514766812325, 0.041642215102910995, 0.04147837683558464, -0.06717366725206375, -0.0820283368229866, 0.01763991452753544, 0.003339910414069891, -0.012902259826660156, -0.05690647289156914, -0.05281051993370056, -0.013209456577897072, -0.02771596424281597, -0.013817022554576397, 0.002653837902471423, 0.036727067083120346, -0.06569912284612656, -0.029217815026640892, -0.017489729449152946, 0.021886054426431656, 0.02428901568055153, 0.010731402784585953, -0.01890966109931469, -0.02719714492559433, 0.03702743723988533, 0.011946536600589752, 0.03740972653031349, 0.019783465191721916, -0.016820723190903664, -0.02424805611371994, -0.028862832114100456, -0.0671190544962883, 0.009693761356174946, -0.050243720412254333, 0.04142376407980919, -0.028944751247763634, 0.016083450987935066, 0.010963506996631622, 0.00817143078893423, -0.0023602943401783705, -0.02812555991113186, -0.03238535299897194, 0.0074751186184585094, 0.010478819720447063, -0.05485849827528, -0.049178771674633026, 0.05707031115889549, 0.026842162013053894, -0.0013089991407468915, -0.04437284916639328, 0.06269542127847672, 0.0027442900463938713, -0.021176090463995934, 0.042761776596307755, 0.0427071638405323, -0.02270524576306343, 0.05130866914987564, -0.07126962393522263, -0.03426949307322502, 0.00226472201757133, -0.016042491421103477, -0.019360216334462166, -0.01661592535674572, 0.022350262850522995, -0.041915278881788254, -0.04835958033800125, -0.06995891779661179, 0.011106865480542183, 0.011243397369980812, 0.04082302376627922, 0.06706444174051285, 0.04693964868783951, 0.0071474420838057995, -0.020152101293206215, 0.010772362351417542, 0.009209073148667812, -0.023196760565042496, -0.005403247661888599, -0.03609902039170265, -0.01448602881282568, 0.028944751247763634, -0.001670808531343937, -0.01731223799288273, -0.014376803301274776, -0.02762039192020893, 0.03219420835375786, 0.08437668532133102, 0.018418146297335625, 0.024316322058439255, 0.0359351821243763, -0.011782698333263397, 0.018732169643044472, -0.02340155839920044, 0.007440985646098852, -0.0064716096967458725, 0.0057923635467886925, 0.024603039026260376, -0.0457654744386673, 0.0004390352114569396, 0.014335843734443188, -0.0336141400039196, -0.0004817014269065112, -0.004334886092692614, -0.01273159496486187, 0.02626872807741165, -0.009031581692397594, 0.028234785422682762, -0.006628621369600296, 0.04030420258641243, -0.012806687504053116, 0.026050277054309845, -0.0031965519301593304, -0.012438051402568817, -0.02181778848171234, 0.026883121579885483, 0.038501981645822525, -0.03394181653857231, 0.022295650094747543, -0.020001916214823723, 0.010915720835328102, 0.02644621953368187, -0.033259157091379166, -0.02667832374572754, 0.03495215252041817, -0.01114099845290184, 0.009297818876802921, -0.02902667038142681, 0.013209456577897072, -0.04352635145187378, 0.01109321229159832, 0.028589768335223198, 0.003278471063822508, -0.012151334434747696, -0.035034071654081345, 0.001463450724259019, -0.03467908874154091, 0.01142088882625103, -0.03612632676959038, 0.016301902011036873, 0.008048552088439465, -0.011489154770970345, 0.019128112122416496, -0.008410361595451832, -0.044536687433719635, 0.009038408286869526, 0.01966058649122715, 0.0006186599493958056, -0.035034071654081345, 0.018322573974728584, -0.003556654555723071, 0.023387905210256577, -0.009222726337611675, 0.005604632198810577, -0.009052061475813389, -0.019824424758553505, 0.05100829899311066, -0.011434542015194893, 0.03839275613427162, -0.0033091907389461994, 0.006331664510071278, -0.01788567192852497, -0.0467211976647377, 0.06094781681895256, -0.034706395119428635, -0.051472507417201996, 0.00948213692754507, 0.027784230187535286, -0.05111752450466156, 0.011004466563463211, -0.03590787574648857, 0.0016221690457314253, 0.01060169842094183, -0.0016682485584169626, 0.07651244848966599, -0.042488712817430496, 0.013148017227649689, 0.012629196047782898, -0.0434444323182106, -0.04385402798652649, 0.006563768722116947, -0.027538472786545753, 0.0368909053504467, -0.017421463504433632, -0.02069822885096073, 0.021681256592273712, 0.012444877997040749, -0.044673219323158264, 0.009686934761703014, -0.006164412945508957, 0.04497358947992325, -0.011741738766431808, -0.02617315575480461, 0.0523190051317215, -0.031183874234557152, 0.011134171858429909, 0.014827358536422253, -0.01825430803000927, -0.04011305794119835, 0.028152866289019585, 0.005324742291122675, 0.02037055231630802, 0.0025480256881564856, 0.034706395119428635, -0.015591937117278576, -0.05018910765647888, 0.030774278566241264, -0.04207911714911461, -0.0003159432380925864, -0.06662753969430923, 0.004324646200984716, -0.0687028244137764, -0.03355952724814415, -0.013885288499295712, 0.008014419116079807, -0.012533623725175858, -0.024357281625270844, -0.018322573974728584, 0.012799860909581184, -0.012164987623691559, -0.00033663632348179817, -0.01694360189139843, -0.011291183531284332, -0.014649867080152035, -0.01657496578991413, -0.017585301771759987, -0.02222738415002823, 0.06001939997076988, 0.016834376379847527, 0.00589817576110363, -0.0786423459649086, -0.014922930859029293, -0.010103357024490833, -0.024316322058439255, -0.0009719360969029367, 0.006792459636926651, 0.04063187912106514, 0.0077891419641673565, 0.04431823641061783, 0.06029246374964714, -0.026746589690446854, -0.032549191266298294, 0.018322573974728584, 0.030637746676802635, -0.0006259132060222328, -0.009919038973748684, 0.023715581744909286, -0.024684958159923553, -0.046502746641635895, -0.009577709250152111, 0.004925386514514685, 0.024070564657449722, 0.029545491561293602, 0.0025753320660442114, -0.006246332079172134, -0.000917323341127485, -0.008929182775318623, 0.026760242879390717, 0.008287482894957066, -0.02644621953368187, -0.03197575733065605, 0.06717366725206375, -0.06837514787912369, 0.02083476074039936, -0.04764961451292038, -0.022200077772140503, -0.010588045231997967, 0.014076433144509792, 0.038501981645822525, -0.0015086769126355648, -0.015400792472064495, -0.016165370121598244, -0.024971675127744675, 0.00262823817320168, 0.029053976759314537, -0.0026162916328758, 0.010547085665166378, -0.02102590538561344, -0.002850102260708809, -0.03413296118378639, 0.01109321229159832, -0.03213959559798241, -0.020657269284129143, 0.018936967477202415, -0.029327040538191795, 0.0041471547447144985, -0.0022220558021217585, 0.05057139694690704, 0.034105654805898666, 0.057834889739751816, -0.013393774628639221, -0.037000130861997604, -0.049588367342948914, -0.04237948730587959, -0.039157334715127945, -0.00028373024542815983, 0.03172999992966652, 0.02715618535876274, 0.03552558645606041, 0.007277147378772497, 0.0425979383289814, 0.008519587107002735, 0.012649675831198692, -0.054694660007953644, 0.001885846140794456, -0.02663736417889595, -0.012294692918658257, 0.005119944456964731, 0.05218247324228287, 0.05630573257803917, 0.001189533737488091, -0.022309303283691406, -0.0022937350440770388, -0.020998599007725716, -0.04874186962842941, 0.0020684574265033007, 0.03394181653857231, 0.002404667204245925, 0.011209264397621155, -0.053711630403995514, 0.00488101365044713, 0.04642082750797272, 0.01095668040215969, -0.00014559841656591743, -0.03839275613427162, 0.04136915132403374, 0.010308154858648777, 0.00886774342507124, -0.015591937117278576, -0.047294631600379944, -0.0012006269535049796, -0.019073499366641045, -0.009086194448173046, 0.0013653184287250042, -0.003935530316084623, 0.008628812618553638, -0.038693126291036606, -0.026459872722625732, 0.04461860656738281, 0.0036010274197906256, -0.05578691139817238, 0.014267577789723873, 0.04123261943459511, 0.004747895058244467, -0.007372719701379538, -0.037191275507211685, 0.0320303700864315, -0.021176090463995934, 0.030446602031588554, 0.00488101365044713, 0.01834988035261631, -0.012178640812635422, -0.019838077947497368, -0.015987878665328026, 0.05707031115889549, 0.019455788657069206, 0.01652035303413868, 0.001151987467892468, -0.028535155579447746, 0.02181778848171234, 0.011018119752407074, -0.050762541592121124, 0.007161095272749662, -0.033777978271245956, -0.023142147809267044, 0.026241421699523926, 0.03298609331250191, -0.02405691146850586, 0.03317723795771599, -0.03563481196761131, -0.009884906001389027, -0.021326275542378426, 0.005461273714900017, 0.0233059860765934, -0.021831441670656204, 0.08131837099790573, 0.06624525040388107, -0.03347760811448097, -0.04314406216144562, -0.0017493142513558269, 0.03459716960787773, -0.032412659376859665, 0.019496748223900795, -0.015933265909552574, -0.0006288998411037028, 0.020575350150465965, 0.036071714013814926, -0.011803178116679192, 0.008301136083900928, -0.015073115937411785, 0.03323185071349144, -0.010171622969210148, -0.03041929565370083, 0.006403343752026558, -0.006652514450252056, 0.014199311845004559, 0.027128878980875015, -0.023565396666526794, 0.003012233879417181, 0.02640525996685028, -0.03178461268544197, -0.03945770487189293, -0.017517035827040672, 0.004679629113525152, -0.013120710849761963, 0.013516653329133987, -0.037191275507211685, 0.0031846053898334503, -0.011994322761893272, 0.013639532029628754, -0.017844712361693382, -0.020138448104262352, -0.014745439402759075, -0.004304166417568922, 0.01731223799288273, 0.012444877997040749, 0.011086385697126389, -0.07520174235105515, -0.030037006363272667, -0.053902775049209595, 0.05414853245019913, -0.0059050023555755615, -0.007440985646098852, 0.024466507136821747, 0.008929182775318623, -0.00478544132784009, -0.000512847735080868, 0.01994730345904827, 0.010335461236536503, 0.004874187055975199, 0.018882354721426964, -0.005655831657350063, 0.00259239855222404, 0.017517035827040672, 0.01732589118182659, -0.06744673103094101, 0.04366288334131241, -0.003445722395554185, -0.016356514766812325, 0.03891157731413841, 0.002164029749110341, -0.005621698684990406, -0.002268135314807296, -0.02392037957906723, -0.047021567821502686, -0.015837693586945534, -0.007086002733558416, 0.007427332457154989, -0.012513143941760063, 0.001937045599333942, -0.00826017651706934, 0.024329975247383118, -0.0035361747723072767, -0.030200844630599022, -0.019169071689248085, 0.04530126601457596, 0.010280848480761051, -0.010786015540361404, 0.02929973416030407, 0.04292561113834381, -0.019169071689248085, 0.010021437890827656, 0.01127753034234047, 0.008144124411046505, 0.00098046928178519, -0.0041471547447144985, 0.03284956142306328, -0.0008746571256779134, 0.0008763637742958963, -0.01825430803000927, -0.04207911714911461, 0.0033586835488677025, -0.03080158494412899, -0.027470208704471588, -0.04139645770192146, -0.0098575996235013, -0.009905385784804821, 0.027033306658267975, -0.06673676520586014, 0.017667220905423164, 0.013571266084909439, -0.007905193604528904, -0.023620009422302246, -0.007393199484795332, -0.01282716728746891, 0.003911637235432863, 0.0003400496207177639, 0.002414907095953822, -0.005024372134357691, -0.02583182603120804, 0.03402373567223549, -0.011755391955375671, 0.021694909781217575, -0.013209456577897072, -0.03380528464913368, 0.04464591294527054, -0.041642215102910995, 0.015619243495166302, 0.008860916830599308, 0.0030719665810465813, 0.01844545267522335, -0.014199311845004559, 0.013414254412055016, 0.01665688492357731, -0.04647544026374817, -0.0360444076359272, 0.008109991438686848, -0.008034898899495602, 0.07143346220254898, -0.008342095650732517, -0.003495215205475688, 0.004966346081346273, 0.03492484614253044, -0.01927829720079899, -0.002126483479514718, 0.03861120715737343, 0.003266524523496628, -0.029845861718058586, 0.04666658490896225, 0.007516078185290098, -0.03877504542469978, 0.0010188688756898046, 0.005683138035237789, 0.0112843569368124, -0.012567756697535515, -0.012950045987963676, -0.024411894381046295, 0.010588045231997967, -0.03197575733065605, -0.05360240489244461, 0.01871851645410061, 0.039812687784433365, 0.008109991438686848, -0.0351979099214077, -0.010642657987773418, 0.00976202730089426, -0.02752482146024704, 0.004454351495951414, -0.027046959847211838, -0.030692359432578087, -0.027675004675984383, -0.014226618222892284, 0.036672454327344894, 0.005007305648177862, 0.04595661908388138, -0.016315555199980736, 0.01402182038873434, -0.01665688492357731, -0.02326502650976181, -0.0483049675822258, 0.003188018687069416, 0.00011157211702084169, -0.014281230978667736, 0.0007551917806267738, 0.01863659732043743, 0.023237720131874084, 0.01481370534747839, 0.035498280078172684, -0.0011255344143137336, -0.013803369365632534, -0.00693923095241189, -0.008144124411046505, 0.01727127842605114, -0.02443920075893402, 0.001664835261180997, -0.009215899743139744, -0.03151154890656471, -0.04874186962842941, -0.02224103733897209, 0.02060265652835369, -0.03197575733065605, 0.009919038973748684, -0.03331376984715462, 0.016834376379847527, -0.015223301015794277, -0.013257242739200592, -0.01099763996899128, -0.012089895084500313, -0.02284177765250206, -0.015619243495166302, -0.027415595948696136, 0.012519970536231995, 0.039485011249780655, -0.011509634554386139, -0.015742121264338493, -0.0067105405032634735, 0.00341670960187912, 0.037054743617773056, -0.02326502650976181, -0.029927780851721764, -0.01708013378083706, 0.03399642929434776, -0.03694551810622215, -0.011461848393082619, -0.04562894254922867, -0.023374252021312714, -0.0018056336557492614, 0.061111655086278915, 0.054366983473300934, -0.062422361224889755, 0.013018311932682991, -0.0031555923633277416, -0.02405691146850586, 0.00830796267837286, -0.007352239917963743, 0.0064340634271502495, 0.016206329688429832, -0.0055158864706754684, 0.004566990304738283, -0.024493813514709473, -0.04095955565571785, 0.009297818876802921, -0.07072349637746811, -0.002327868016436696, -0.009318298660218716, -0.009564056061208248, -0.030528521165251732, 0.008294309489428997, -0.016274595633149147, -0.008219216950237751, -0.005812843330204487, 0.00691533787176013, -0.0006212199223227799, -0.0027579432353377342, 0.009755200706422329, 0.023606356233358383, 0.005812843330204487, 0.01985173113644123, -0.0012799861142411828, -0.009693761356174946, 0.0021691496949642897, -0.025545109063386917, -0.02968202345073223, 0.0026333581190556288, 0.00664910115301609, 0.036863598972558975, 0.015591937117278576, 0.04347173869609833, -0.0035771343391388655, 0.0320303700864315, -0.004427045118063688, 0.012335652485489845, -0.03525252267718315, -0.013366468250751495, 0.030228151008486748, 0.01439045649021864, 0.032931480556726456, -0.020916679874062538, -0.027019653469324112, 0.015523671172559261, 0.017571648582816124, -0.04199719801545143, -0.0241524837911129, 0.0021077103447169065, -0.011803178116679192, -0.008546893484890461, -0.025026287883520126, -0.0028193825855851173, 0.030555827543139458, 0.003942356910556555, -0.024562079459428787, -0.006717367097735405, -0.026036623865365982, 0.021776828914880753, 0.052974358201026917, 0.029272427782416344, -0.019018886610865593, -0.061712395399808884, -0.00943435076624155, -0.012431224808096886, -0.004812747705727816, 0.016301902011036873, -0.015605590306222439, -0.01095668040215969, -0.02147645875811577, -0.008137297816574574, 0.017844712361693382, -0.010888414457440376, -0.03525252267718315, -0.02981855534017086, -0.01642478071153164, -0.034515250474214554, -0.008335269056260586, -0.003942356910556555, 0.007372719701379538, 0.009441177360713482, -0.0385839007794857, -0.11326681822538376, -0.007898367010056973, 0.02224103733897209, 0.022596020251512527, 0.0022971483413130045, -0.006314598023891449, 0.01904619298875332, -0.011243397369980812, -0.02280081808567047, -0.01798124425113201, -0.0008473508059978485, -0.0027767163701355457, 0.00085119076538831, -0.024835143238306046, -0.005686551332473755, -0.041915278881788254, -0.010021437890827656, 0.0005683138151653111, 0.024370934814214706, -0.013810195960104465, -0.041915278881788254, 0.00724301440641284, 0.0021810962352901697, 0.007905193604528904, -0.025736253708600998, 0.011134171858429909, 0.029327040538191795, -0.007031389977782965, 0.008062205277383327, 0.010383247397840023, 0.013632705435156822, 0.01202845573425293, 0.03399642929434776, 0.035034071654081345, -0.008069031871855259, -0.029190508648753166, 0.01118878461420536, -0.004949279595166445, 0.015755774453282356, 0.03145693615078926, 0.013393774628639221, -0.040659185498952866, 0.03716396912932396, 0.0006591928540728986, 0.017667220905423164, -0.0442909300327301, 0.01590595953166485, -0.025954704731702805, 0.03492484614253044, -0.021708562970161438, 0.020493431016802788, -0.020821107551455498, -0.00957088265568018, -0.020015569403767586, -0.015742121264338493, -0.028862832114100456, 0.021694909781217575, 0.012868126854300499, -0.009420697577297688, 0.00488101365044713, -0.029381653293967247, 0.024002298712730408, 0.007120135705918074, -0.048659950494766235, -0.018691210076212883, -0.0011938003590330482, 0.02812555991113186, 0.022363916039466858, 0.000512847735080868, -0.031429629772901535, -0.006082493811845779, -0.006928991060703993, -0.016069797798991203, -0.010977160185575485, -0.023701928555965424, 0.0014566241297870874, -0.018827741965651512, 0.016793416813015938, -0.047540389001369476, 0.005952788516879082, 0.04057726636528969, -0.01406277995556593, 0.006655927747488022, 0.012526797130703926, -0.025244738906621933, -0.008082685060799122, 0.008089511655271053, -0.0311292614787817, -0.0005465540452860296, 0.0011844137916341424, 0.03757356479763985, -0.006393103860318661, -0.005724097602069378, -0.025203779339790344, -0.02224103733897209, -0.029381653293967247, -0.04961567372083664, 0.011577900499105453, 0.0196059737354517, 0.002341521205380559, 0.007959806360304356, 0.0466119721531868, 0.00424955366179347, -0.019250990822911263, -0.008362575434148312, -0.01434949692338705, 0.009796160273253918, 0.0018585397629067302, 0.024725917726755142, -0.00933877844363451, 0.006847072392702103, -0.009741547517478466, -0.04835958033800125, 0.01773548685014248, 0.02405691146850586, 0.02392037957906723, 0.032603804022073746, -0.004300753120332956, -0.002594105200842023, -0.0002331707946723327, 0.02729271724820137, 0.016219982877373695, -0.003505455097183585, -0.00316071230918169, -0.03566211834549904, -0.016929948702454567, -0.01862294413149357, 0.012383438646793365, -0.005730924196541309, 0.001611929154023528, 0.013632705435156822, 0.009768853895366192, 0.010130663402378559, -0.008662945590913296, 0.02135358192026615, 0.018759476020932198, 0.013311855494976044, -0.013605399057269096, -0.009038408286869526, 0.0200838353484869, 0.0054646870121359825, -0.011598380282521248, 0.011591553688049316, 0.020247673615813255, -0.011038599535822868, -0.0005657538422383368, 0.013359641656279564, -0.022773511707782745, -0.0081646041944623, 0.011755391955375671, 0.039293866604566574, -0.029272427782416344, 0.012977352365851402, -0.01576942764222622, -0.004375845659524202, 0.005167730618268251, 0.019933650270104408, -0.0037921720650047064, 0.003976489882916212, -0.0012893726816400886, 0.030446602031588554, 0.038501981645822525, -0.014881971292197704, -0.0034098830074071884, 0.017339544370770454, -0.029245121404528618, -0.021981626749038696, -0.040604572743177414, -0.005785536952316761, -0.006690060719847679, -0.03661784157156944, -0.02659640461206436, 0.0015829161275178194, 0.021244356408715248, 0.032412659376859665, 0.0036488135810941458, 0.01600153185427189, 0.0047137620858848095, 0.004416805226355791, 0.03612632676959038, 0.040276896208524704, 0.021189743652939796, -0.04876917600631714, 0.0001292785891564563, 0.036399390548467636, -0.03426949307322502, 0.03492484614253044, -0.001836353330872953, 0.025640681385993958, 0.02363366261124611, 0.03618093952536583, 0.01821334846317768, 0.014144699089229107, 0.03885696455836296, 0.00985077302902937, -0.013741930946707726, 0.012444877997040749, 0.008546893484890461, 0.031156567856669426, -0.04385402798652649, -0.04237948730587959, 0.01537348609417677, -0.003860438009724021, -0.010383247397840023, -0.021053211763501167, 0.016738804057240486, -0.018527371808886528, -0.002416613744571805, 0.029081283137202263, -0.014759092591702938, 0.006495502777397633, 0.013352815061807632, -0.018786782398819923, 0.003781932173296809, 0.00689144479110837, 0.00023210413928609341, 0.026063930243253708, -0.002665784442797303, -0.044727832078933716, 0.001986538292840123, 0.0015965693164616823, -0.027279064059257507, 0.009816640056669712, 0.03394181653857231, -0.007966632954776287, -0.034515250474214554, 0.014663520269095898, 0.02125800959765911, -0.009331951849162579, -0.009236379526555538, -0.01434949692338705, 0.032221514731645584, -0.026296034455299377, 0.0036931864451617002, -0.00516090402379632, 0.010328634642064571, -0.015646548941731453, 0.004450938198715448, -0.028425930067896843, 0.0009634028538130224, 0.03252188488841057, 0.009168113581836224, -0.020670922473073006, -0.007365893106907606, 0.024302668869495392, -0.011864617466926575, 0.014458722434937954, 0.06832053512334824, -0.006478436291217804, -0.0009181766654364765, -0.028070947155356407, 0.049178771674633026, 0.03675437346100807, 0.004819574300199747, 0.011721258983016014, 0.02326502650976181, 0.013933074660599232, 0.02280081808567047, 0.009284165687859058, -0.015346179716289043, -0.018172388896346092, -0.005550019443035126, 0.010499299503862858, -0.010806495323777199, -0.008301136083900928, -0.023005615919828415, -0.008929182775318623, 0.028917444869875908, 0.029408959671854973, 0.012936392799019814, -0.030583133921027184, 0.019032539799809456, -0.013980860821902752, 0.03284956142306328, 0.003785345470532775, -0.02519012615084648, 0.03547097370028496, -0.01353030651807785, -0.0018636597087606788, -0.017762793228030205, -0.031566161662340164, -0.016820723190903664, -0.016493046656250954, -0.0025463190395385027, -0.003252871334552765, -0.01094985380768776, 0.015591937117278576, 0.0004927946138195693, 0.0265827514231205, -0.00013567852147389203, 0.011659819632768631, 0.03612632676959038, -0.0072976271621882915, 0.030692359432578087, 0.014977543614804745, -0.027920762076973915, -0.0016929949633777142, 0.028016334399580956, -0.009345605038106441, -0.006956297438591719, -0.0007590317400172353, 0.004194940906018019, -0.012444877997040749, -0.018418146297335625, 0.02467130497097969, 0.03041929565370083, 0.016779763624072075, 0.013475693762302399, 0.00452944403514266, -0.011960189789533615, -0.0017766206292435527, 0.014103739522397518, -0.01652035303413868, -0.00340476306155324, 0.00033514300594106317, 0.02050708420574665, -0.018991580232977867, -0.002619704930111766, -0.018663903698325157, 0.008895049802958965, 0.007673089858144522, -0.005734337493777275, -0.01254727691411972, 0.016929948702454567, -0.015168688260018826, -0.040194977074861526, -0.007079176139086485, -0.01567385531961918, -0.0030958596616983414, 0.024985328316688538, 0.0004735948459710926, -0.0011391876032575965, 0.03309531882405281, -0.02116243727505207, -0.02133992873132229, 0.0007364186458289623, -0.025954704731702805, -0.0039048108737915754, -0.0286989938467741, -0.013748757541179657, 0.0003765292349271476, 0.03249457851052284, 0.020397858694195747, -0.02265063300728798, -0.02255506068468094, 0.0026640777941793203, 0.014731786213815212, -0.01333916187286377, -0.011591553688049316, 0.014131045900285244, 0.07973460108041763, -0.033068012446165085, -0.03375067189335823, 0.03282225504517555, 0.013571266084909439, 0.03178461268544197, 0.003935530316084623, -0.01273159496486187, -0.0344606377184391, 0.008342095650732517, -0.015796734020113945, 0.035170603543519974, -0.004502137657254934, -0.009953171946108341, 0.020793801173567772, 0.017435116693377495, -0.012806687504053116, 0.03861120715737343, 0.019974609836935997, 0.003696599742397666, 0.0022237624507397413, -0.020425165072083473, -0.004850293975323439, 0.0024626932572573423, 0.0023841874208301306, 0.0071474420838057995, -0.026364300400018692, -0.013537133112549782, 0.006727606989443302, 0.022268343716859818, 0.0024712265003472567, 0.003546414664015174, -0.06083859130740166, 0.03066505305469036, 0.011960189789533615, 0.006048360839486122, -0.021681256592273712, 0.02513551339507103, -0.0013712916988879442, -0.028726300224661827, -0.008847263641655445, 0.004973172675818205, -0.024234402924776077, 0.0112843569368124, 0.02355174347758293, 0.0014771039132028818, -0.010014611296355724, 0.018554678186774254, 0.0028705820441246033, 0.005771883763372898, -0.0001554116461193189, 0.0023739475291222334, 0.02935434691607952, -0.017544342204928398, 0.0004040489438921213, -0.016138063743710518, -0.003479855367913842, -0.0006365797598846257, 0.019073499366641045, 0.010069224052131176, -0.03342299535870552, 0.018800435587763786, -0.0016127824783325195, -0.0110454261302948, 0.027074266225099564, -0.028862832114100456, -0.01245170459151268, -0.003874091198667884, -0.03252188488841057, 0.02640525996685028, 0.0012654796009883285, 9.68522799666971e-05, 0.004498724360018969, -0.03334107622504234, -0.013195803388953209, 0.011530114337801933, -0.03148424252867699, 0.016629578545689583, -0.001675075152888894, 0.0197151992470026, -0.02274620532989502, -0.029327040538191795, -0.017448769882321358, -0.03246727213263512, -0.013264069333672523, 0.015810387209057808, 0.039157334715127945, 0.0237838476896286, -0.030200844630599022, 0.022213730961084366, -0.02551780268549919, -0.013427907600998878, 0.04024958983063698, -0.018841395154595375, -0.011550594121217728, -0.02153107151389122, 0.01661592535674572, -0.0008669772068969905, -0.0020582175347954035, 0.040522653609514236, 0.0030173538252711296, -0.00312487268820405, -0.0014139579143375158, 0.029245121404528618, -0.023374252021312714, 0.023988645523786545, -0.04371749609708786, -0.005693377926945686, -0.01952405460178852, 0.01759895496070385, 0.018336227163672447, -0.0225687138736248, 0.036863598972558975, 0.00691533787176013, -0.04057726636528969, 0.018855048343539238, 0.004635256249457598, 0.0018824328435584903, 0.01533252652734518, -0.0241524837911129, 0.028862832114100456, 0.01132531650364399, 0.020384205505251884, 0.006611554883420467, -0.02037055231630802, 0.016138063743710518, -0.005795776844024658, 0.03074697218835354, -0.015714814886450768, -0.01193971000611782, -0.014540641568601131, 0.00845132116228342, 0.027688657864928246, -0.007959806360304356, 0.023483477532863617, 0.012697461992502213, -0.02929973416030407, -0.0039833164773881435, -0.008690251968801022, -0.01900523342192173, -0.0011613740352913737, -0.01895062066614628, -0.02199527993798256, 0.015387139283120632, -0.014417762868106365, -0.021653950214385986, -0.0032852976582944393, -0.011120518669486046, 0.030446602031588554, 0.0046762158162891865, -0.017817405983805656, 0.03500676527619362, -0.02288273721933365, 0.0498887374997139, 0.02434362843632698, -0.03246727213263512, 0.01736685074865818, -0.016315555199980736, 0.03465178236365318, -0.00559439230710268, 0.03885696455836296, -0.002923488151282072, 0.0015317166689783335, 0.03323185071349144, 0.04909685254096985, 0.01779009960591793, -0.03822891786694527, -0.016042491421103477, 0.0081646041944623, -0.020793801173567772, -0.02692408114671707, 0.011864617466926575, 0.03448794409632683, -0.017680874094367027, 0.010478819720447063, -0.022295650094747543, 0.007686743047088385, -0.009734720923006535, 0.010390073992311954, 0.02878091298043728, -0.0258454792201519, -0.03487023338675499, 0.01933290995657444, 0.006864138878881931, -0.004645496141165495, -0.017148399725556374, 0.014049126766622066, 0.006263398565351963, -0.030501214787364006, -0.017216665670275688, 0.020261326804757118, -0.004334886092692614, 0.02064361609518528, 0.004447524901479483, 0.024220749735832214, 0.021640297025442123, 0.018732169643044472, -0.009236379526555538, 0.017162052914500237, 0.02635064721107483, 0.017121093347668648, -0.013352815061807632, 0.0028654620982706547, 0.025859132409095764, 0.017435116693377495, 0.00905888807028532, -0.01434949692338705, 0.010888414457440376, -0.004522617440670729, -0.003061726689338684, 0.05657879635691643, 0.009871252812445164, -0.01055391225963831, 0.02897205762565136, -0.01500484999269247, 0.018595637753605843, 0.02050708420574665, 0.007086002733558416, -0.005846976302564144, -0.00313681922852993, 0.009837119840085506, -0.02353809028863907, 0.025313004851341248, 0.0007389786187559366, -0.008936009369790554, 0.004307579714804888, 0.026569098234176636, 0.01759895496070385, 0.01170077919960022, 0.012246906757354736, 0.010786015540361404, -0.0286989938467741, 0.01179635152220726, -0.005096051376312971, 0.01264284923672676, -0.025968357920646667, -0.02910858951508999, -0.017189359292387962, -0.0040208627469837666, 0.015482711605727673, -0.05046217143535614, 0.014117392711341381, 0.007454638835042715, -0.030228151008486748, 0.002165736397728324, 0.060074012726545334, 0.018554678186774254, -0.0035668944474309683, -0.05144520103931427, 0.013844328932464123, -0.0032716444693505764, 0.0118919238448143, 0.013448387384414673, -0.03735511377453804, 0.024794183671474457, -0.0018022203585132957, -0.0048776003532111645, -0.02804364077746868, -3.6026274756295606e-05, 0.027511168271303177, -0.021230703219771385, 0.00811681803315878, -0.029463572427630424, -0.007495598401874304, -0.03814699873328209, 0.023620009422302246, 0.0016989682335406542, -0.012513143941760063, -0.0265827514231205, -0.021694909781217575, 0.0013781182933598757, 0.045519717037677765, 0.017066480591893196, 0.003276764415204525, -0.012103548273444176, 0.005423727445304394, 0.008082685060799122, -0.0005870869499631226, 0.0018926727352663875, -0.02798902802169323, 0.025108207017183304, -0.017203012481331825, -0.011059079319238663, 0.020575350150465965, 0.0217222161591053, -0.005051678512245417, -0.0336141400039196, -0.014431416057050228, 0.0019250990590080619, -0.004126674961298704, -0.0027408767491579056, 0.010233062319457531, 0.010840628296136856, -0.027838842943310738, -0.033777978271245956, 0.011250223964452744, 0.0011494274949654937, -0.031893838196992874, -0.0009932691464200616, 0.02883552573621273, -0.024917062371969223, 0.029381653293967247, 0.026377953588962555, 0.00019541120855137706, 0.027046959847211838, 0.018145082518458366, -0.024780530482530594, 0.017189359292387962, 0.005225756671279669, -0.0009267099085263908, 0.011639339849352837, -0.02480783686041832, 0.005457860417664051, 0.0367816798388958, 0.015346179716289043, 0.011434542015194893, -0.0014540641568601131, 0.023756541311740875, -0.042242955416440964, 0.019592320546507835, -0.006792459636926651, 0.0014591841027140617, 0.0055534327402710915, -0.016888989135622978, 0.03664514794945717, -0.017899325117468834, 0.019769812002778053, 0.00039935566019266844, 0.006082493811845779, -0.009727894328534603, 0.0209303330630064, -0.00170238153077662, 0.006239505484700203, 0.00445776479318738, -0.004696695599704981, 0.03355952724814415, 0.0008174844551831484, -0.0003103966300841421, 0.016411127522587776, -0.012178640812635422, 0.02363366261124611, 0.015387139283120632, 0.011011293157935143, 0.017817405983805656, -0.010629004798829556, 0.031101955100893974, 0.01994730345904827, 0.025217432528734207, 0.03514329716563225, 0.0032170317135751247, -0.002491706283763051, 0.03402373567223549, -0.024643998593091965, -0.03959423676133156, 0.015537324361503124, -0.007379546295851469, 0.01027402188628912, -0.02902667038142681, -0.005887935869395733, 0.019360216334462166, -0.03839275613427162, -0.005304262507706881, 0.023565396666526794, 0.007181575056165457, 0.0028159692883491516, 0.007079176139086485, 0.005393007770180702, 0.010376420803368092, -0.01305927149951458, -0.02419344335794449, 0.02756577916443348, 0.017203012481331825, 0.01956501416862011, 0.012847647070884705, 0.01798124425113201, 0.009680108167231083, -0.04530126601457596, -0.004727415274828672, 0.009673281572759151, 0.007017736788839102, 0.016028838232159615, -0.037983160465955734, 0.006294118240475655, -0.03822891786694527, 0.002860342152416706, -0.0034354827366769314, 0.0034918019082397223, 0.018172388896346092, 0.010615351609885693]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" inequality, Lemma 8 and reward r≤1 for any r∈ F,
the second inequality uses π∗∈Πtaccording to Lemma 4, and the last inequality uses the Cauchy-Schwarz
inequality and Jensen’s inequality.
Then, we define
¯Σt=TX
t=1Ext∼d0,(a1
t,a2
t)∼(π1
t,π2
t)[(ϕ(xt, a1
t)−ϕ(xt, a2
t))(ϕ(xt, a1
t)−ϕ(xt, a2
t))⊤] +λI.
According to the concentration of the covariance matrix in Lemma 10, since λ= Ω( dlog(T/δ)), we have
with probability at least 1 −δ, for any t∈[T],
Σ−1
t⪯3¯Σ−1
t,
36
which implies that
TX
t=1Ext∼d0,(a1
t,a2
t)∼(π1
t,π2
t)min
1,∥ϕ(xt, a1
t)−ϕ(xt, a2
t)∥2
Σ−1
t	
≤3TX
t=1Ext∼d0,(a1
t,a2
t)∼(π1
t,π2
t)min
1,∥ϕ(xt, a1
t)−ϕ(xt, a2
t)∥2
¯Σ−1
t	
≤6dlog(1 + T/dλ ).
By taking the result above back into Equation (15), we get with probability at least 1 −2δ,
TX
t=1
J(π∗)−J(π1
t)
≤βp
T6dlog(1 + T/dλ )−ηTX
t=1Ext∼d0
DKL(π∗(·|xt)∥πt
1(·|xt))
, (16)
where the inequality uses Lemma 9.
Moreover, to analyze the average regret Regave(T), we make the following decomposition
TX
t=1J(π1
t)−J(π2
t) =TX
t=1Ext∼d0h
Eπ1
t[r∗(xt, a)−rt(xt, a)] +Eπ2
t[rt(xt, a)−r∗(xt, a)]i
| {z }
(∆1
t)
+TX
t=1Ext∼d0h
Eπ1
t[rt(xt, a)]−Eπ2
t[rt(xt, a)] +ηDKL(π2
t(·|xt)∥π0(·|xt))−ηDKL(π1
t(·|xt)∥π0(·|xt))
| {z }
(∆2
t)i
.
(17)
For Term (∆1
t), we have
(∆1
t) =Ext∼d0[
ϕ(xt, π1
t)−ϕ(xt, π2
t), θ∗−θt
]
≤β·Ext∼d0∥ϕ(xt, π1
t)−ϕ(xt, π2
t)∥Σ−1
t
We can deal with the Term (∆2
t) by invoking Lemma 4 with π=π2
tand using the definition of the confidence
set:
(∆2
t) =ηDKL(π2
t(·|xt)∥π1
t(·|xt))≤β· ∥ϕ(xt, π1
t)−ϕ(xt, π2
t)∥Σ−1
t.
Combining the above two inequalities and Equation (17), we have
TX
t=1J(π1
t)−J(π2
t)≤2βTX
t=1Ext∼d0∥ϕ(xt, π1
t)−ϕ(xt, π2
t)∥Σ−1
t
≤2βTX
t=1Ext∼d0,(a1
t,a2
t)�","[0.0044797067530453205, -0.038727786391973495, 0.013948334380984306, -0.009344764053821564, 0.010982506908476353, 0.009296595118939877, 0.023451367393136024, 0.06325263530015945, -0.004706788342446089, 0.04318685084581375, 0.01718941144645214, -0.009344764053821564, -0.029809661209583282, 0.03470912575721741, 0.00955120287835598, -0.015482856892049313, 0.04370982572436333, -0.029479360207915306, -0.048967115581035614, 0.03729648143053055, -0.0391957126557827, -0.0023585553281009197, 0.05664661154150963, 0.03437882289290428, 0.02224026434123516, 0.007149639539420605, 0.013975858688354492, -0.011897715739905834, 0.06138092651963234, -0.019763007760047913, 0.0023327504750341177, -0.044205278158187866, 0.00807172991335392, -0.07051925361156464, 0.00012719597725663334, 0.06435363739728928, 0.012331235222518444, 0.06859249621629715, 0.009909028187394142, 0.00406683050096035, 0.02544693648815155, 0.002059220103546977, -0.08664894849061966, -0.0020919060334563255, -0.004176930990070105, -0.00998472236096859, -0.010961863212287426, -0.014808492735028267, 0.013955214992165565, 0.04178307205438614, -0.04533380642533302, 0.02464870922267437, -0.014780967496335506, 0.015978308394551277, -0.024910196661949158, -0.010032891295850277, 0.020038258284330368, 0.05133427307009697, 0.05133427307009697, -0.04973781853914261, 0.018951017409563065, -0.013673082925379276, 0.0362505279481411, -0.025501985102891922, -0.02704339101910591, -0.014904830604791641, -0.01306064985692501, 0.024180782958865166, 0.027456266805529594, 0.03853511065244675, -0.047480762004852295, 0.023382555693387985, 0.04761838540434837, 0.013232681900262833, -0.024937720969319344, 0.039773739874362946, 0.014244228601455688, 0.026823189109563828, 0.04874691367149353, -0.03754420951008797, 0.03715885803103447, -0.015262656845152378, 0.047040361911058426, 0.040957316756248474, 0.025901099666953087, -0.11202707141637802, -0.015303944237530231, -0.0015087183564901352, -0.058132968842983246, -0.010659086517989635, -0.020382320508360863, -0.00665762834250927, 0.017051786184310913, 0.006017670501023531, 0.06523443758487701, 0.0024497320409864187, 0.0404343418776989, -0.014904830604791641, -0.0293967854231596, -0.020657572895288467, 0.006089923903346062, -0.03974621370434761, 0.03369069844484329, 0.006303243339061737, 0.04054444283246994, -0.00588692631572485, -0.026424076408147812, 0.00621034624055028, -0.005013004876673222, 0.013535457663238049, -0.003199790371581912, -0.042113371193408966, -0.001103583606891334, 0.03223186731338501, 0.003557616611942649, -0.026465363800525665, -0.10145743936300278, 0.01775367558002472, -0.0004477126058191061, -0.000827042618766427, -0.021841149777173996, -0.044645678251981735, -0.019363893195986748, -0.00807861052453518, 0.0014665706548839808, 0.0012928185751661658, 0.029369259253144264, -0.08185958862304688, -0.040957316756248474, -0.015524144284427166, 0.013108818791806698, 0.0018699850188568234, 0.007645090576261282, -0.0006412483053281903, -0.015262656845152378, 0.025598322972655296, 0.04431537911295891, 0.07112480700016022, 0.04486588016152382, -0.01577186957001686, -0.0250202976167202, -0.009709471836686134, -0.02840588241815567, 0.021909963339567184, -0.012744111940264702, 0.018042689189314842, -0.05045346915721893, 0.013115700334310532, -0.002991632092744112, 0.02457989566028118, -0.001821816200390458, -0.03303009644150734, -0.030057387426495552, -0.0047790417447686195, -0.007596922107040882, -0.05015069618821144, -0.016749011352658272, 0.0709596574306488, 0.015400282107293606, 0.011085725389420986, -0.05023327097296715, 0.042608823627233505, -0.00597638264298439, -0.009358527138829231, 0.03550735116004944, 0.010776068083941936, -0.005549744237214327, 0.019363893195986748, -0.051416847854852676, -0.04084721580147743, -0.013535457663238049, -0.009564965032041073, -0.03850758448243141, -0.024070682004094124, 0.048031263053417206, -0.03080056421458721, -0.04373735189437866, -0.021717287600040436, 0.011243995279073715, 0.009496152400970459, -0.005763063672930002, 0.06281223148107529, 0.03905808925628662, -0.007920341566205025, -0.015744345262646675, 0.01798763871192932, 0.0454714298248291, -0.03627805411815643, 0.016501285135746002, -0.026919526979327202, 0.014285515993833542, 0.0395810641348362, 0.016611386090517044, -0.016487522050738335, 0.008938769809901714, -0.02409820631146431, 0.03677350655198097, 0.07982272654771805, -0.014120365492999554, 0.03272731974720955, 0.0463247075676918, 0.02477257139980793, 0.011416026391088963, -0.020987872034311295, -0.025116635486483574, -0.006939760409295559, 0.010328786447644234, 0.03258969262242317, -0.06396828591823578, -0.0029073364567011595, 0.01257207989692688, -0.05108654871582985, 0.010239329189062119, -0.015014930628240108, -0.021097972989082336, 0.038122233003377914, -0.02890133298933506, 0.04949009418487549, -0.0012326074065640569, 0.040324240922927856, -0.009069513529539108, 0.0500405952334404, -0.013955214992165565, -0.011753208935260773, -0.023836718872189522, 0.027951717376708984, 0.06815209984779358, -0.019240031018853188, 0.01566177047789097, -0.04219594597816467, 0.05020574480295181, 0.05769256502389908, -0.03322277218103409, -0.05193982273340225, 0.04783858731389046, -0.031516216695308685, -0.03616795316338539, -0.05659156292676926, -0.004118440207093954, -0.048471663147211075, -0.0009126284276135266, 0.038617685437202454, -0.02094658464193344, -0.029314208775758743, -0.013377188704907894, -0.0088493125513196, -0.0212631244212389, 0.01328085083514452, -0.026162587106227875, 0.013108818791806698, 0.014505716972053051, -0.00517815537750721, 0.00013343212776817381, -0.013404713943600655, -0.04621460661292076, -0.00157839129678905, 0.007727665826678276, 0.0044280970469117165, 0.003905120538547635, 0.021166786551475525, -0.011257757432758808, -0.0017271987162530422, -0.025680899620056152, 0.017671100795269012, -0.013232681900262833, -0.02742874063551426, 0.018317939713597298, 0.010941218584775925, 0.04753581061959267, -0.0037227668799459934, 0.027098439633846283, 0.00028385239420458674, -0.048471663147211075, 0.0488019660115242, -0.03784698247909546, -0.039911363273859024, 0.025226734578609467, 0.04478330537676811, -0.048829492181539536, 0.015524144284427166, -0.03498437628149986, 0.016680197790265083, 0.011718802154064178, 0.016239797696471214, 0.05218755081295967, -0.050866346806287766, -0.014780967496335506, 0.008216235786676407, -0.03492932394146919, -0.04057196527719498, 0.037681832909584045, -0.019363893195986748, 0.015427807345986366, 0.004957954864948988, -0.010280617512762547, -0.0068675074726343155, 0.012021577917039394, -0.04387497529387474, -0.020299745723605156, 0.019804295152425766, 0.035342201590538025, -0.0029830303974449635, -0.018070215359330177, 0.037874508649110794, -0.029369259253144264, 0.01676277257502079, 0.015799395740032196, -0.016170984134078026, -0.0479486882686615, 0.02661675214767456, 0.0066301035694777966, 0.024167019873857498, -0.031020764261484146, 0.0304427370429039, -0.02211640030145645, -0.02539188601076603, 0.0304427370429039, -0.03223186731338501, 0.002267378382384777, -0.054141830652952194, -0.009496152400970459, -0.07073945552110672, -0.0001294538815272972, -0.014863543212413788, -0.0015912936069071293, 0.004221659153699875, -0.01601959578692913, -0.0043420810252428055, 0.01549661997705698, -0.02674061432480812, -0.014946117997169495, 0.004861616995185614, -0.011416026391088963, -0.02686447650194168, -0.02124936133623123, -0.022997204214334488, -0.031763941049575806, 0.05934407189488411, 0.00040534979780204594, -0.013046887703239918, -0.022955916821956635, -0.007899697870016098, -0.0200244951993227, -0.016721485182642937, 0.02287334017455578, 0.010094822384417057, 0.05571075901389122, 0.01186330895870924, 0.0705743059515953, 0.06974855065345764, -0.040324240922927856, -0.0412876196205616, 0.012689061462879181, 0.010445768013596535, 0.005264171399176121, -0.010583393275737762, 0.027263591066002846, -0.042856547981500626, -0.033773273229599, -0.01078294962644577, -0.01812526397407055, -0.0036092260852456093, 0.045884307473897934, -0.003622988471761346, -0.007624446880072355, 0.026836952194571495, -0.013796946033835411, -0.004871938843280077, -0.00664042541757226, -0.02034103311598301, -0.003196349833160639, 0.07624446600675583, -0.06248192861676216, -0.00039975877734832466, -0.032809894531965256, -0.003308170475065708, 0.01619850844144821, 0.01522136852145195, 0.05039842054247856, -0.026355262845754623, -0.0250202976167202, -0.021221837028861046, -0.0041253212839365005, 0.010046654380857944, 0.015510382130742073, 0.007466177921742201, 0.0027077796403318644, -0.03649825602769852, 0.0069638448767364025, -0.011147657409310341, 0.01571682095527649, -0.020107069984078407, -0.019859343767166138, 0.02969956025481224, -0.02890133298933506, -0.04024166613817215, 0.004689585417509079, 0.0821898877620697, 0.024813858792185783, 0.066775843501091, -0.030470263212919235, -0.03481922671198845, -0.05818801745772362, -0.050756245851516724, -0.022047588601708412, 0.007954748347401619, 0.037434108555316925, 0.04117751866579056, 0.024758808314800262, -0.027621416375041008, 0.04203079640865326, -0.008051085285842419, 0.020864009857177734, -0.034351300448179245, -0.015290181152522564, -0.020423607900738716, 0.010727900080382824, 0.019501518458127975, 0.019061116501688957, 0.04456310346722603, -0.002704339101910591, -0.0006012509693391621, -0.004985480103641748, -0.0371038056910038, -0.0421408973634243, 0.04574668034911156, 0.030222536996006966, -0.013177631422877312, 0.02557079866528511, -0.060059722512960434, 0.03636062890291214, 0.057031963020563126, 0.017905063927173615, 0.005680488422513008, -0.03517705202102661, 0.029506884515285492, 0.0266855638474226, -0.0052504087798297405, -0.032011665403842926, -0.03864521160721779, -0.013156987726688385, -0.01546909473836422, -0.02829578146338463, -0.0056047942489385605, 0.0171205997467041, 0.023588992655277252, -0.006702356971800327, 0.0018407396273687482, 0.0458567813038826, 0.039718687534332275, -0.054196879267692566, 0.011822021566331387, 0.023203641176223755, -0.020409846678376198, -0.032562170177698135, -0.03173641487956047, 0.036388155072927475, 0.0039567300118505955, 0.01970795728266239, -0.008188711479306221, 0.001625700038857758, -0.029782135039567947, -0.00667139096185565, -0.00700857350602746, 0.030525313690304756, 3.6583627661457285e-05, 0.018937254324555397, 0.013329019770026207, -0.027277354151010513, 0.02532307244837284, -0.0022432939149439335, -0.045388855040073395, 0.03944343701004982, -0.038480062037706375, -0.005312340334057808, 0.04269139841198921, 0.05485748127102852, -0.029919760301709175, 0.03875531256198883, -0.012503267265856266, 0.024566132575273514, -0.039911363273859024, -0.02679566480219364, 0.008064848370850086, -0.003462999127805233, 0.08758480101823807, 0.07453791797161102, -0.015854446217417717, -0.03358059749007225, -0.020038258284330368, 0.026038724929094315, -0.03864521160721779, 0.031461164355278015, -0.01601959578692913, -0.010727900080382824, 0.00554630346596241, 0.02452484518289566, -0.016900397837162018, 0.0022123281378299, -0.02693329006433487, 0.0505085214972496, 0.021097972989082336, 0.011588058434426785, 0.03234196826815605, -0.02119431085884571, 0.027635179460048676, 0.03000233694911003, -0.02526802197098732, -0.009936553426086903, 0.034103572368621826, -0.002644127933308482, -0.008684162050485611, 0.011539889499545097, 0.016556335613131523, -0.02969956025481224, 0.006151854991912842, -0.045196179300546646, 0.006733322516083717, -0.03993888944387436, -0.016790298745036125, -0.003444075584411621, -0.04087474197149277, -0.01879962906241417, -0.023822955787181854, 0.03451645001769066, 0.014072196558117867, 0.006196583621203899, -0.08813530206680298, -0.05070119723677635, -0.03198414295911789, 0.05317845195531845, -0.015881970524787903, -0.013067531399428844, 0.02237788960337639, 0.025281785055994987, 0.006200023926794529, -0.012991837225854397, -0.02014835737645626, 0.005446525290608406, 0.0031825872138142586, 0.0038879173807799816, -0.007555634249001741, 0.0074042463675141335, -0.011175182648003101, 0.03286494314670563, -0.04018661752343178, 0.023217404261231422, 0.004538197536021471, -0.02532307244837284, 0.028323305770754814, 0.004448740743100643, -0.013542339205741882, -0.009262189269065857, -0.004049627110362053, -0.04825146496295929, 0.004586366470903158, 0.013569864444434643, 5.2846000471618026e-05, -0.006829660385847092, 0.014230466447770596, -0.022460464388132095, 0.03063541278243065, -0.002516824519261718, -0.015358993783593178, -0.014202941209077835, 0.04024166613817215, 0.0023172677028924227, -0.023272454738616943, 0.015826920047402382, 0.054940059781074524, -0.00828504841774702, 0.012186728417873383, -0.003595463465899229, -0.009379170835018158, 0.008856194093823433, -0.01867576688528061, 0.04533380642533302, -0.008835550397634506, -0.016735248267650604, -0.024607419967651367, -0.04120504483580589, 0.009379170835018158, -0.028378356248140335, -0.02748379111289978, -0.030828088521957397, 0.0009693988831713796, -0.010652205906808376, 0.00403586495667696, -0.04139772057533264, -0.0028780910652130842, 0.021042922511696815, -0.01217296626418829, -0.024387219920754433, 0.02112549915909767, 0.009220901876688004, 0.034351300448179245, -0.034048523753881454, 0.0001732144592097029, 0.017299512401223183, -0.011890834197402, 0.042058322578668594, -0.0020127713214606047, 0.005811232142150402, -0.040076516568660736, -0.04263634607195854, 0.045829255133867264, -0.030580362305045128, -0.01816655322909355, 0.0231623537838459, 0.012929906137287617, 0.004297352861613035, -0.014092840254306793, 0.013452882878482342, 0.017767438665032387, -0.017960114404559135, -0.03889293596148491, 0.032259393483400345, -0.03371822088956833, 0.04816889017820358, -0.0037262076511979103, -0.020189644768834114, -0.01954280585050583, 0.028983907774090767, -0.024621183052659035, 0.014891067519783974, 0.035947754979133606, -0.004321437329053879, -0.03440634906291962, 0.05199487507343292, -0.005315781105309725, -0.0463247075676918, 0.007356077432632446, 0.0212631244212389, 0.0007362958858720958, -0.017905063927173615, -0.011994053609669209, 0.0048340922221541405, 0.034351300448179245, -0.02058875933289528, -0.05317845195531845, 0.02188243716955185, 0.031818993389606476, 0.0007633908535353839, -0.038920462131500244, 0.0009780004620552063, 0.019006067886948586, -0.005092139821499586, 0.018827153369784355, -0.036580830812454224, -0.027222303673624992, -0.0312960147857666, -0.004569163080304861, 0.0467100590467453, -0.007700141053646803, 0.04734313488006592, -0.0023327504750341177, 0.010459530167281628, -0.001777087920345366, -0.02268066443502903, -0.059068821370601654, -0.0045966883189976215, 0.010452648624777794, -0.019996970891952515, -0.005353627726435661, 0.008113017305731773, 0.009606252424418926, 0.00409779604524374, 0.0068468633107841015, 0.006351412273943424, -0.009558083489537239, 0.004152846522629261, 0.0333879217505455, 0.02181362546980381, 0.017038024961948395, -0.011471076868474483, -0.0018097739666700363, -0.04761838540434837, -0.03099323995411396, -0.020753908902406693, 0.0036092260852456093, -0.03223186731338501, -0.005281374789774418, -0.014395616017282009, -0.0008240320603363216, -0.029616985470056534, -0.02027222141623497, 0.006939760409295559, 0.0051334272138774395, -0.02151084877550602, -0.031130865216255188, -0.021951250731945038, 0.019088642671704292, 0.050866346806287766, -0.03660835698246956, -0.0047790417447686195, -0.0024480116553604603, -0.015868207439780235, 0.023878006264567375, -0.013920809142291546, -0.048526715487241745, -0.01331525668501854, 0.03437882289290428, -0.03751668334007263, -0.016418710350990295, -0.04759086295962334, -0.015193844214081764, -0.0027284235693514347, 0.02994728647172451, 0.06149102747440338, -0.06694099307060242, 0.007493702694773674, 0.0019783650059252977, -0.031103339046239853, 0.024056918919086456, -0.003082808805629611, -0.0045966883189976215, 0.009193376637995243, 0.010879287496209145, -0.025956150144338608, -0.009489270858466625, -0.016102170571684837, -0.004610450938344002, -0.06985864788293839, -0.016611386090517044, 0.01442314125597477, -0.012578961439430714, -0.038920462131500244, -0.011471076868474483, -0.000621464685536921, -0.0010141271632164717, -0.019446467980742455, 0.009282832965254784, -0.007892816327512264, -0.008298811502754688, 0.0009814411168918014, 0.01947399415075779, 0.002735304646193981, 0.02200630120933056, -0.0214970875531435, 0.002375758485868573, 0.003526650834828615, -0.04577420651912689, -0.026286451146006584, 0.002368877176195383, 0.01786377653479576, 0.018703291192650795, 0.034846749156713486, 0.046985309571027756, 0.002675093710422516, 0.028515981510281563, -0.021841149777173996, 0.012812924571335316, -0.03702123090624809, -0.001609356957487762, 0.032066717743873596, -0.01146419532597065, 0.015152555890381336, -0.011484839022159576, -0.04037928953766823, -0.012186728417873383, 0.009929671883583069, -0.012461979873478413, -0.025116635486483574, 0.01075542438775301, 0.0028282019775360823, -0.005123105365782976, -0.03418614715337753, -0.007947866804897785, 0.013535457663238049, -0.016047121956944466, 0.001173256547190249, -0.006327327806502581, -0.02341008000075817, 0.022267788648605347, 0.03627805411815643, 0.02156589925289154, -0.023217404261231422, -0.0550776831805706, 0.00406683050096035, -0.005769944749772549, -0.005439643748104572, -0.003512888215482235, -0.014175415970385075, 9.9240816780366e-05, -0.0147947296500206, -0.012014697305858135, 0.006034873425960541, -0.010617799125611782, -0.029369259253144264, -0.027084678411483765, 0.00027051992947235703, -0.022955916821956635, -0.02429088205099106, 0.012062866240739822, -0.0005560925928875804, 0.020547471940517426, -0.04092979431152344, -0.13101938366889954, -0.003939527086913586, -0.001505277818068862, 0.017712388187646866, 0.0004075001925230026, 0.005412118509411812, 0.03413109853863716, 0.0013994782930240035, -0.03000233694911003, -0.004493469372391701, 0.009028226137161255, -0.02840588241815567, -0.005680488422513008, 0.005525659769773483, -0.02243294008076191, -0.02594238705933094, -0.015345231629908085, 0.029809661209583282, 0.01941894367337227, 0.005088699050247669, -0.036085378378629684, 0.01812526397407055, 0.006151854991912842, 0.029121533036231995, -0.01824912801384926, 0.00952367763966322, 0.020162120461463928, -0.030112436041235924, 0.007170283235609531, -0.002532307291403413, 0.0363331064581871, -0.00835386198014021, 0.04781106114387512, 0.013156987726688385, -0.01112013217061758, -0.009172732941806316, -0.011195826344192028, 0.007865291088819504, 0.011594939976930618, 0.014202941209077835, 0.006599137559533119, -0.03407604992389679, 0.03523210063576698, -0.007177164312452078, 0.006365174427628517, -0.048471663147211075, -0.008236880414187908, -0.031763941049575806, 0.031130865216255188, -0.01546909473836422, 0.025722187012434006, -0.007507465314120054, -0.005253849551081657, -0.029616985470056534, -0.015207606367766857, -0.008057966828346252, 0.005243527702987194, 0.0035335321445018053, -0.011409145779907703, 0.013569864444434643, -0.015826920047402382, -0.005164393223822117, 0.01903359219431877, -0.032259393483400345, -0.03000233694911003, -9.563889761921018e-05, -0.005099020898342133, -0.0020729824900627136, -0.004366165492683649, -0.0281581562012434, -0.00627227732911706, -0.02588733658194542, -0.011945884674787521, -0.0073491963557899, -0.0442328006029129, 0.010507699102163315, -0.030029861256480217, -0.014946117997169495, -0.05169209837913513, 0.02569466084241867, 0.01484978012740612, -0.018015164881944656, 0.0032806454692035913, 0.012833568267524242, -0.011746327392756939, -0.017079312354326248, 0.017216937616467476, -0.020107069984078407, 0.01645999774336815, 0.01303312461823225, 0.033855848014354706, 0.008305693045258522, 0.0019422384211793542, -0.01731327548623085, -0.0034991255961358547, 0.0001390231482218951, -0.02268066443502903, 0.0005758762708865106, 0.0073698400519788265, 0.015207606367766857, 0.01081047486513853, 0.03779193386435509, 0.002217489294707775, -0.011058200150728226, -0.025722187012434006, -0.010528342798352242, 0.008601587265729904, 0.009743877686560154, 0.021552136167883873, -0.01658385992050171, 0.0013736734399572015, -0.03154373914003372, -0.0379570834338665, -0.025735948234796524, 0.03878283500671387, -0.005787148140370846, 0.022777002304792404, -0.012750992551445961, -0.007204689551144838, -0.04318685084581375, 0.0006102826446294785, 0.0026733733247965574, 0.0019284759182482958, 0.014065315946936607, -0.002441130578517914, -0.013542339205741882, -0.01663891039788723, 0.028089342638850212, 0.008711687289178371, -0.0023705975618213415, 0.024676233530044556, 0.02094658464193344, 0.021428273990750313, -0.0016687079332768917, 0.026052488014101982, 0.0015818319516256452, 0.028488457202911377, -0.006289480719715357, 0.022295314818620682, 0.022584328427910805, 0.013597388751804829, 0.005831876304000616, 0.013851996511220932, 0.021235598251223564, -0.002336191013455391, 0.01029437966644764, 0.005883485544472933, -0.02032727189362049, -0.005632319487631321, 0.01658385992050171, 0.027070915326476097, -0.018648240715265274, 0.010927456431090832, -0.01584068313241005, 0.00403930526226759, -0.0011405705008655787, -0.006444309372454882, -0.013507932424545288, 0.001537103671580553, 0.017891300842165947, 0.046242132782936096, 0.05158199742436409, -0.005436202976852655, 0.008278167806565762, 0.02619011327624321, -0.014684629626572132, -0.034296248108148575, -0.04448052868247032, -0.0048994640819728374, -0.0034354738891124725, -0.005794029217213392, -0.025680899620056152, -0.002712940564379096, 0.01562048215419054, 0.005883485544472933, 0.0007788737420924008, -0.002045457484200597, 0.0060761612839996815, -0.0036918013356626034, 0.013046887703239918, 0.032259393483400345, 0.024979010224342346, -0.0350119024515152, 0.0009564965148456395, 0.022474227473139763, -0.02797924354672432, 0.05125169828534126, 0.0005578129203058779, 0.01041136123239994, 0.029314208775758743, 0.015510382130742073, 0.02459365874528885, 0.009695708751678467, 0.03316771984100342, 0.03704875707626343, -0.001565488870255649, 0.030112436041235924, 0.029479360207915306, 0.017547238618135452, -0.036690931767225266, 0.020354796200990677, 0.025006534531712532, 0.018565665930509567, -0.0266855638474226, -0.0036849200259894133, -0.007583159487694502, -0.01860695332288742, -0.007899697870016098, 0.020781435072422028, -0.014505716972053051, 0.03184651583433151, 0.014244228601455688, -0.017230698838829994, -0.0009238104685209692, -0.0027301437221467495, -0.00926907081156969, -0.0011844385880976915, 0.0063101244159042835, -0.011147657409310341, -0.01146419532597065, -0.0008769318228587508, -0.020506184548139572, 0.030029861256480217, 0.03294752165675163, -0.011271519586443901, -0.009840215556323528, 0.03025006130337715, 0.01632237248122692, -0.009193376637995243, -0.010700374841690063, -0.015111268498003483, 0.04764591157436371, -0.013040006160736084, -0.0029795898590236902, 0.009620015509426594, 0.012785399332642555, -0.02211640030145645, 0.004321437329053879, -0.027525078505277634, -0.029011433944106102, 0.027525078505277634, 0.009805809706449509, -0.031048288568854332, 0.0005823274841532111, -0.009909028187394142, -0.002506502438336611, 0.01780872605741024, 0.0762995183467865, -0.009227782487869263, -0.0004631954652722925, -0.005646082106977701, 0.04706788435578346, 0.00664042541757226, 0.007115233223885298, 0.018317939713597298, 0.018813392147421837, 0.009977840818464756, 0.021923726424574852, 0.015758108347654343, -0.016047121956944466, 0.000771562394220382, 0.0004799685557372868, 0.014354328624904156, -0.016749011352658272, -0.022020064294338226, -0.03949848935008049, -0.02402939461171627, 0.021428273990750313, 0.0088493125513196, 0.0005866282735951245, -0.029314208775758743, -0.004954514093697071, -0.031075814738869667, 0.0275388415902853, 0.017574762925505638, -0.014368091709911823, 0.02546069771051407, -0.0009823013097047806, -0.0028540065977722406, -0.013796946033835411, -0.03528715297579765, -0.034736648201942444, -0.017354562878608704, 0.011739445850253105, 0.009365408681333065, 0.0077895973809063435, 0.03525962680578232, -0.002026533940806985, 0.038122233003377914, 0.013693726621568203, 0.007934103719890118, 0.022584328427910805, -0.010844881646335125, 0.025350598618388176, 0.02829578146338463, -0.03636062890291214, 0.004108117893338203, 0.010328786447644234, -0.010432004928588867, -0.010246210731565952, -0.008684162050485611, 0.008684162050485611, -0.007817122153937817, -0.027937956154346466, 0.012276185676455498, 0.03481922671198845, 0.00705330166965723, 0.009255307726562023, -0.01544156949967146, -0.030580362305045128, 0.00625507440418005, -0.007452415302395821, -0.008525893092155457, 0.007741428446024656, -0.00785152893513441, 0.018262889236211777, -0.013404713943600655, -0.013494170270860195, 0.004004898946732283, 0.026148825883865356, -0.01718941144645214, -0.003370101796463132, 0.011237113736569881, -0.015014930628240108, -0.013466645032167435, -0.003237637458369136, 0.004541638307273388, -0.009344764053821564, -0.006633543875068426, 0.020313508808612823, -0.015317706391215324, 1.5711337255197577e-05, 0.005608235020190477, -0.0011612143134698272, -0.019584093242883682, -0.004947633016854525, -0.01370748970657587, -0.010672849602997303, -0.032259393483400345, -0.028818758204579353, 0.007211570627987385, 0.021978775039315224, 0.0055394223891198635, -0.023822955787181854, -0.017712388187646866, 0.012489505112171173, 0.01991439424455166, -0.0010184278944507241, -0.033057618886232376, -0.00816118624061346, 0.08725450187921524, -0.03492932394146919, -0.027635179460048676, 0.044205278158187866, 0.004923548549413681, 0.03914066404104233, -0.011643108911812305, -0.007596922107040882, -0.023451367393136024, 0.02846093289554119, -0.030112436041235924, 0.04233357310295105, -0.0006137232412584126, -0.009840215556323528, 0.013920809142291546, 0.01294366829097271, -0.019487755373120308, 0.02895638346672058, 0.006771169602870941, 0.014381853863596916, -0.0022054470609873533, -0.030167486518621445, -0.015537907369434834, 0.009372289292514324, 0.006306683644652367, 0.004772160667926073, -0.005511897150427103, -0.007156520616263151, -0.01756099984049797, 0.010032891295850277, 0.011099488474428654, 0.01991439424455166, -0.040819693356752396, 0.019735481590032578, 0.009867740795016289, -0.00065458077006042, -0.02107044868171215, 0.029121533036231995, -0.0061621773056685925, -0.020107069984078407, -0.03319524601101875, -0.006826219614595175, -0.017574762925505638, 0.004555400460958481, 0.002546069910749793, -0.0012652934528887272, -0.015524144284427166, 0.019061116501688957, 0.013507932424545288, -0.02298344112932682, -0.005824994761496782, 0.0019456790760159492, 0.014395616017282009, -0.017794962972402573, -0.023864243179559708, 0.005680488422513008, 0.005697691347450018, -0.001878586714155972, 0.012386285699903965, 0.027869142591953278, -0.04035176709294319, 0.0005444804555736482, -0.020368559285998344, 0.010521461255848408, 0.00781024107709527, -0.01947399415075779, -0.0050680553540587425, -0.0043627251870930195, -0.015881970524787903, 0.016996735706925392, -0.0052504087798297405, -0.0009874622337520123, -0.009812690317630768, -0.03198414295911789, 0.002014491707086563, 0.017148124054074287, -0.033498022705316544, 0.03184651583433151, -0.02342384308576584, 0.009936553426086903, -0.013452882878482342, -0.027387453243136406, 0.0038844768423587084, -0.02188243716955185, -0.010954981669783592, 0.014904830604791641, 0.020547471940517426, -0.003592022927477956, -0.00597638264298439, 0.0016102171503007412, -0.01885467953979969, 0.008264404721558094, 0.0235477052628994, -0.04497598111629486, -0.012957431375980377, -0.019955681636929512, 0.024786334484815598, -0.010480173863470554, -0.0013556102057918906, 0.04607698321342468, -0.006406462285667658, 0.013776302337646484, 0.012744111940264702, 0.021662237122654915, -0.010948100127279758, 0.01549661997705698, -0.05262795090675354, 0.000664042541757226, -0.018703291192650795, 0.007782716304063797, 0.026052488014101982, -0.014808492735028267, 0.03850758448243141, -0.015125030651688576, 0.0030776478815823793, 0.01571682095527649, -0.010989387519657612, 0.018152790144085884, -0.00835386198014021, -0.016804059967398643, 0.04412270337343216, 0.012799161486327648, 0.016501285135746002, 0.0022622174583375454, -0.03261721879243851, 0.020753908902406693, 0.0003528801316861063, 0.04258129745721817, -0.0016532250447198749, 0.0025409089867025614, -0.011608702130615711, 0.013528576120734215, 0.020547471940517426, -0.009062631987035275, 0.02539188601076603, 0.0015981749165803194, -0.01549661997705698, 0.011161419562995434, -0.021097972989082336, -0.03162631765007973, 0.027690229937434196, -0.024855146184563637, 0.01738208718597889, -0.01007417868822813, 0.008746094070374966, -0.021799862384796143, -0.015056218020617962, -0.014959880150854588, 0.008236880414187908, -0.008009797893464565, -0.010363192297518253, 0.00335805956274271, -0.026093775406479836, 0.05083882063627243, 0.033002570271492004, -0.03162631765007973, 0.00519191799685359, -0.03611290454864502, 0.018689528107643127, -0.006499359384179115, 0.06633543968200684, 0.0029520648531615734, -0.0063135651871562, 0.01928131841123104, 0.03839748725295067, 0.002893574070185423, -0.01731327548623085, 0.007046420127153397, 0.01075542438775301, -0.014987405389547348, -0.01732703670859337, 0.0002191254316130653, 0.026850715279579163, -0.013473526574671268, -0.010067298077046871, -0.014354328624904156, -0.005904129706323147, -0.023644043132662773, 0.004173490218818188, 0.04607698321342468, -0.02071262151002884, -0.025735948234796524, 0.02562584914267063, 0.005092139821499586, -0.010555868037045002, -0.004070271272212267, 0.006062398664653301, 0.010583393275737762, -0.021029161289334297, -0.015028693713247776, 0.023809192702174187, 0.0032840860076248646, 0.021455800160765648, -0.004527875687927008, 0.02934173494577408, 0.02870865724980831, 0.027401216328144073, -0.011443551629781723, 0.02371285669505596, 0.013005600310862064, 0.01584068313241005, 0.001207662862725556, 0.0033941862639039755, 0.003117215121164918, 0.01401714701205492, -0.014574529603123665, 0.000720812997315079, 0.007782716304063797, -0.021359462291002274, 0.018221601843833923, 0.05378400534391403, 0.006870947778224945, -0.005972942337393761, 0.0433795265853405, -0.01228994783014059, 0.012695943005383015, 0.030470263212919235, 0.008539656177163124, 0.005302018485963345, -0.041315145790576935, 0.005033649038523436, -0.005140308756381273, -0.005646082106977701, -0.003093130886554718, -0.006575053092092276, -0.015799395740032196, 0.010198041796684265, 0.010583393275737762, -0.0032238748390227556, 0.008608468808233738, -0.004455622285604477, -0.03159879148006439, 0.010225567035377026, -0.002437689807265997, 0.011815140023827553, -0.042801499366760254, -0.007899697870016098, -0.002441130578517914, -0.03297504410147667, 0.03322277218103409, -0.05612363666296005, 0.014863543212413788, 0.020905297249555588, -0.022639377042651176, -0.018070215359330177, 0.02471752092242241, 0.01614345982670784, -0.005652963183820248, -0.032259393483400345, 0.009062631987035275, -0.0068468633107841015, -0.022969678044319153, -0.007817122153937817, -0.04503102973103523, 0.01800140179693699, -0.02335502952337265, -0.006857185158878565, -0.01849685236811638, 0.010438886471092701, 0.01676277257502079, -0.03446139767765999, 0.024125732481479645, -0.000743177137337625, -0.012668417766690254, -0.03157126531004906, -0.008684162050485611, 0.01182890310883522, 0.0009306917199864984, -0.036828555166721344, -0.03025006130337715, -0.0019456790760159492, 0.04891206696629524, 0.019763007760047913, -0.010672849602997303, 0.0014932355843484402, -0.004304234404116869, 0.007858410477638245, -0.006774609908461571, 0.0024325288832187653, -0.02496524713933468, 0.013404713943600655, -0.004259506240487099, -0.00822311732918024, 0.014629580080509186, 0.02890133298933506, 0.005735538434237242, -0.022281551733613014, 0.002191684441640973, 0.024015631526708603, -0.0038947986904531717, -0.007445533759891987, -0.005112783517688513, 0.008202473632991314, -0.03347049653530121, -0.03289246931672096, 0.0017383807571604848, 0.01566177047789097, -0.02014835737645626, 0.016253558918833733, 0.022336602210998535, 0.007610684260725975, 0.0206438098102808, 0.0071358769200742245, -0.004947633016854525, 0.021951250731945038, 0.00835386198014021, -0.024979010224342346, 0.017299512401223183, 0.012365642003715038, 0.02206135168671608, 0.018221601843833923, -0.0026836951728910208, 0.0028471252880990505, 0.035782601684331894, 0.010824237018823624, 0.023836718872189522, -0.01155365165323019, 0.016115933656692505, -0.01818031445145607, 0.01171192154288292, 0.008381386287510395, -0.0036401916295289993, 0.009007582440972328, -0.02674061432480812, 0.04238862171769142, -0.03148869052529335, -0.005780266597867012, 0.0026733733247965574, 0.0007711322978138924, -0.018703291192650795, 0.006234430242329836, -0.0057561821304261684, 0.005804351065307856, -0.012503267265856266, 0.014808492735028267, 0.012035341002047062, 0.028515981510281563, 0.015482856892049313, 0.005697691347450018, -0.009743877686560154, 0.029424309730529785, 0.020506184548139572, 0.03000233694911003, -0.0008051085751503706, -0.010948100127279758, 0.00668515358120203, 0.03080056421458721, 0.011959646828472614, 0.025653373450040817, -0.00204889802262187, 0.008174948394298553, 0.019859343767166138, -0.015262656845152378, -0.04621460661292076, -0.009090157225728035, -0.01589573360979557, -0.0017650456866249442, -0.041562870144844055, -0.030965713784098625, 0.015345231629908085, -0.026768140494823456, 0.0036161073949187994, 0.026410313323140144, -0.000309012015350163, 0.012248660437762737, 0.002134914044290781, 0.012166084721684456, -0.00010106865374837071, 0.0006008208729326725, 0.006643866188824177, 0.03402099758386612, 0.016253558918833733, 0.030332637950778008, 0.013879520818591118, 0.02082272246479988, 0.008422674611210823, -0.03993888944387436, -0.01140226423740387, 0.03531467542052269, -0.007514346856623888, 0.01429927907884121, -0.020740147680044174, 0.001420122105628252, -0.016129696741700172, 0.0015947342617437243, -0.008601587265729904, 0.010920574888586998, 0.015207606367766857, 0.009867740795016289]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"�(π1
t,π2
t)∥ϕ(xt, a1
t)−ϕ(xt, a2
t)∥Σ−1
t
≤2βvuut3TTX
t=1Ext∼d0,(a1
t,a2
t)∼(π1
t,π2
t)∥ϕ(xt, a1
t)−ϕ(xt, a2
t)∥2
¯Σ−1
t
≲p
Tβ2d, (18)
where the last inequality uses Lemma 9. Combining the results of Reg( T) and the upper bound ofPT
t=1J(π1
t)−
J(π2
t) in Equation (18), we can obtain the bound for the average regret in the following theorem.
37
Therefore, by combining the results above and Equation (16), we have
TX
t=1 
2J(π∗)−J(π1
t)−J(π2
t)
=TX
t=12 
J(π∗)−J(π1
t)
+ 
J(π1
t)−J(π2
t)
≲p
Tβ2d−ηTX
t=1Ext∼d0
DKL(π∗(·|xt)∥πt
1(·|xt))
,
which concludes the proof.
B.3 Construction of the Confidence Set
In this subsection, we show that the confidence set contains π∗for all iterations with high probability by
proving Lemma 4.
Proof of Lemma 4. By the definition of the π∗thatπ∗is optimal at every context, for any π1
t∈Π and any
xt,i∈ X, we have
0≤
θ∗, ϕ(xt,i, π∗)−ϕ(xt,i, π1
t)
+ηDKL(π1
t(·|xt,i)∥π0(·|xt,i))−ηDKL(π∗(·|xt,i)∥π0(·|xt,i))
=
θ∗−θt, ϕ(xt,i, π∗)−ϕ(xt,i, π1
t)
| {z }
Term(i)
+
θt, ϕ(xt,i, π∗)−ϕ(xt,i, π1
t)
+ηDKL(π1
t(·|xt,i)|π0(·|xt,i))−ηDKL(π∗(·|xt,i)∥π0(·|xt,i))| {z }
Term(ii), (19)
For Term (i), by Cauchy-Schwarz inequality and Lemma 8 with Σ D=mΣt,mandλ′=mλ, we have
Term(i) ≤β· ∥ϕ(xt,i, π∗)−ϕ(xt,i, π1
t)∥Σ−1
t,m,
where β=O q
dlog(T/δ)
γ2m
and the additional log Tfactor is because of the union bound over the Titerations.
Meanwhile, by invoking Lemma 2 with π=π∗,ˆπ=πt, we obtain that
Term(ii) =
θt, ϕ(xt,i, π∗)−ϕ(xt,i, π1
t)
+ηDKL(π1
t(·|xt,i)∥π0(·|xt,i))−ηDKL(π∗(·|xt,i)∥π0(·|xt,i))
=Eπ∗[rt(xt,i, a)]−Eπ1
t[rt(xt,i, a)] +ηDKL(π1
t(·|xt,i)∥π0(·|xt,i))−ηDKL(π∗(·|xt,i)∥π0(·|xt,i))
=−ηDKL(π∗(·|xt,i)|π1
t(·|xt,i)).
Taking respective upper bounds for Terms (i) and (ii) back into Equation (19) and summing over i∈[m],
we have
β·mX
i=1∥ϕ(xt,i, π∗)−ϕ(x","[0.0021972183603793383, -0.05930793285369873, 0.015579434111714363, -0.005581705365329981, -0.006463676691055298, 0.0047768293879926205, 0.007209959905594587, 0.060886844992637634, 0.013198728673160076, 0.05131468176841736, 0.02753230184316635, 0.0034662082325667143, -0.029950011521577835, 0.002679835306480527, 0.00740732392296195, -0.004271083977073431, 0.03641368821263313, -0.02920989692211151, -0.045122381299734116, 0.028272416442632675, -0.021907422691583633, -0.008850549347698689, 0.0269155390560627, 0.002306693699210882, -0.004527040757238865, 0.0012096264399588108, 0.01730637066066265, -0.024374473839998245, 0.04635590687394142, -0.033305201679468155, 0.006661040708422661, -0.03976887837052345, 0.02024216204881668, -0.051413364708423615, 0.028025710955262184, 0.07248198986053467, -0.0001355915010208264, 0.050451215356588364, -0.010534312576055527, -0.0068954103626310825, 0.046553272753953934, 0.000606740650255233, -0.10233332216739655, 0.007592352572828531, -0.0038085116539150476, 0.0026767514646053314, -0.04018827900290489, 0.0024392977356910706, 0.022289816290140152, 0.03584626689553261, -0.01763942278921604, 0.04657794162631035, -0.015431410633027554, 0.02497890219092369, -0.023424658924341202, -0.009380965493619442, 0.011866520158946514, 0.028099723160266876, 0.06123223155736923, -0.023782381787896156, 0.021944427862763405, 0.0054429336450994015, 0.04773745685815811, -0.017071999609470367, -0.011305266059935093, 0.0006368078175000846, 0.00802408717572689, 0.013679804280400276, 0.0259533878415823, 0.049143675714731216, -0.04149581491947174, 0.00976335909217596, 0.04504837095737457, -0.01163215097039938, 0.030492763966321945, 0.04263066127896309, 0.056643515825271606, 0.020439526066184044, 0.0447523258626461, -0.05545933172106743, 0.03609297052025795, -0.012588133104145527, 0.08387976884841919, 0.02020515687763691, 0.02468285523355007, -0.10055704414844513, -0.025756023824214935, 0.02410309948027134, -0.05703824386000633, 0.003170161973685026, -0.02644679881632328, 0.015345063991844654, 0.03332987427711487, 0.013334416784346104, 0.058074407279491425, -0.009640006348490715, 0.03851068392395973, -0.0330338291823864, 0.0006364223663695157, -0.018552232533693314, 0.002854070859029889, -0.05822242796421051, 0.03742517903447151, 0.014123872853815556, 0.030172046273946762, -0.017873791977763176, -0.020550543442368507, 0.025176266208291054, -0.040508996695280075, -0.0028432775288820267, -0.02745828963816166, -0.03177563101053238, -0.021154971793293953, 0.04647926241159439, 0.013050705194473267, -0.03848601132631302, -0.06532754004001617, 0.0154684167355299, 0.0014624992618337274, -0.008665520697832108, -0.005954846739768982, -0.03784457966685295, -0.0010824190685525537, -0.009350127540528774, 0.0026289522647857666, -0.008832046762108803, 0.013692138716578484, -0.06754788756370544, -0.022080115973949432, -0.016615595668554306, 0.030320070683956146, 0.004974193871021271, 0.009436474181711674, -0.0037067458033561707, 0.004255665000528097, 0.01588781550526619, 0.023449329659342766, 0.07001493871212006, 0.05466987565159798, -0.036783747375011444, -0.008116601034998894, -0.031331561505794525, -0.02644679881632328, 0.02443615160882473, -0.009615335613489151, 0.01873726025223732, -0.029826659709215164, 0.021525029093027115, 0.00580682372674346, 0.03641368821263313, 0.006556191015988588, -0.0374005101621151, -0.014382913708686829, -0.004786081146448851, 0.0037838411517441273, -0.019008636474609375, -0.040138937532901764, 0.07075505703687668, 0.015369734726846218, 0.016035838052630424, -0.052794914692640305, 0.02871648594737053, 0.0008426524582318962, -0.030418751761317253, 0.03212101757526398, 0.029283909127116203, -0.014493931084871292, 0.018243849277496338, -0.05624878779053688, -0.06981757283210754, 0.0022018440067768097, -0.020636890083551407, -0.026249434798955917, -0.018848277628421783, 0.04070635885000229, -0.025139261037111282, -0.05042654648423195, -0.02657015062868595, 0.027063561603426933, 0.0009328540763817728, 0.017281699925661087, 0.03609297052025795, 0.035352855920791626, -0.010256769135594368, -0.004314257297664881, 0.010811856016516685, 0.045961178839206696, -0.013716809451580048, 0.008961566723883152, -0.03865870460867882, 0.04255664721131325, 0.042902037501335144, 0.0009050997323356569, -0.0148146478459239, -0.005310329608619213, -0.019107317551970482, 0.02032850868999958, 0.0893072858452797, -0.007154451217502356, 0.045122381299734116, 0.04618321359157562, 0.031035514548420906, 0.009288450703024864, -0.020254498347640038, 0.01364279817789793, -0.023708371445536613, 0.023548012599349022, 0.004542459733784199, -0.06374862790107727, -2.6573812647257e-05, 0.006488346960395575, -0.04119976982474327, 0.005788321141153574, -0.02842044085264206, -0.006207719910889864, 0.03710446506738663, -0.036364346742630005, 0.0492917001247406, -0.023572683334350586, 0.033379215747117996, 0.00838180910795927, 0.04828020930290222, 0.014321237802505493, -0.0005173099925741553, -0.035944949835538864, 0.022228138521313667, 0.07371551543474197, -0.018095826730132103, 0.010595988482236862, -0.03189898282289505, 0.033675260841846466, 0.04292670637369156, -0.03009803593158722, -0.05462053418159485, 0.055607352405786514, -0.027359608560800552, -0.035402197390794754, -0.03801727294921875, -0.007697202730923891, -0.039300139993429184, 0.01751606911420822, 0.04309939965605736, -0.016245538368821144, -0.018169838935136795, -0.026594821363687515, -0.008936895988881588, -0.037375837564468384, 0.018391873687505722, -0.017047330737113953, 0.014678959734737873, 0.011083231307566166, -0.0073456475511193275, -0.009288450703024864, 0.0034168672282248735, -0.04647926241159439, 0.00840031262487173, 0.01049730647355318, 0.02267220802605152, -0.0010646871523931623, 0.025336625054478645, 0.008036422543227673, -0.0018950044177472591, -0.026249434798955917, 0.0026351199485361576, -0.015258717350661755, -0.00492485286667943, 0.014444589614868164, 0.014123872853815556, 0.04845290258526802, -0.01125592552125454, 0.028864508494734764, 0.0075676823034882545, -0.04435759782791138, 0.062219053506851196, -0.012588133104145527, -0.037079792469739914, -0.008011751808226109, 0.04941505193710327, -0.05437382683157921, 0.02837109938263893, -0.0269155390560627, 0.006133708171546459, 0.038165297359228134, 0.028741156682372093, 0.07470233738422394, -0.049439724534749985, -0.0149873411282897, 0.006580861285328865, -0.03831331804394722, -0.05318964272737503, 0.03927546739578247, -0.02510225586593151, 0.03118353895843029, 0.018675584346055984, 0.00731480959802866, -0.001578913303092122, 0.005637214053422213, -0.04004025459289551, 0.002470135921612382, 0.03587093576788902, 0.03944816440343857, -0.011496462859213352, -0.01952671818435192, 0.024386810138821602, -0.0071236127987504005, -0.0018256185576319695, 0.022413168102502823, -0.02967863716185093, -0.0477127879858017, 0.017787445336580276, -0.002004479756578803, 0.007715705316513777, -0.04396286979317665, 0.04191521555185318, -0.03387262672185898, -0.021228983998298645, 0.011650653555989265, -0.02263520285487175, -0.008042589761316776, -0.039250798523426056, -0.023585017770528793, -0.05654483288526535, -0.01274232380092144, 0.007431994192302227, 0.009350127540528774, -0.006975589785724878, -0.028346428647637367, -0.0005728186806663871, 0.019600728526711464, -0.01945270597934723, -0.009664676152169704, -0.01773810386657715, -0.005510777700692415, -0.029308577999472618, -0.029037203639745712, -0.022413168102502823, -0.03197299689054489, 0.04255664721131325, -0.01018275786191225, 0.006420502904802561, -0.02644679881632328, 0.02669350430369377, 0.002917289035394788, -0.009343959391117096, 0.030295399948954582, 4.519716458162293e-05, 0.03130689263343811, 0.006105953827500343, 0.07835357636213303, 0.07169253379106522, -0.018724925816059113, -0.023523341864347458, 0.04115042835474014, 0.012612803839147091, 0.021648382768034935, -0.0309368334710598, 0.01421022042632103, -0.004107641521841288, -0.04672596603631973, -0.019082648679614067, -0.02015581540763378, 0.011181913316249847, 0.03878206014633179, -0.021105630323290825, -0.004483866970986128, 0.026890868321061134, -0.00046719799865968525, -0.014518601819872856, -0.01899630017578602, -0.02331364154815674, -0.027310267090797424, 0.07790950685739517, -0.058321110904216766, 0.012218075804412365, -0.0456157922744751, -0.010306109674274921, 0.01680062524974346, 0.005066708195954561, 0.041273780167102814, 0.0003893316606990993, -0.03747452050447464, -0.026348115876317024, 0.022228138521313667, 0.002988216932862997, 0.002490180777385831, 0.009985392913222313, 0.008893722668290138, -0.030492763966321945, 0.028765827417373657, -0.017170682549476624, -0.000897390185855329, -0.035402197390794754, -0.006531520280987024, 0.0036635722499340773, -0.07169253379106522, -0.01630721427500248, -0.0033428554888814688, 0.07282737642526627, 0.0023914985358715057, 0.08220217376947403, -0.05284425616264343, -0.02191975712776184, -0.07948841899633408, -0.04174252226948738, -0.03197299689054489, 0.0031424076296389103, 0.02321496047079563, 0.021944427862763405, 0.04507303982973099, 0.01639356091618538, 0.02925923839211464, -0.0045979684218764305, 0.014715965837240219, -0.03374927118420601, 0.0060720317997038364, 0.009109590202569962, 0.0026274104602634907, 0.011200416833162308, 0.033477894961833954, 0.041767191141843796, -0.00857300590723753, 0.013963514938950539, -0.014271896332502365, -0.022573526948690414, -0.035352855920791626, 0.028617804870009422, 0.04045965522527695, -0.01786145754158497, 0.019107317551970482, -0.05911056697368622, 0.04359281063079834, 0.04837889224290848, 0.010454133152961731, 0.00168684683740139, -0.05210414156317711, 0.015431410633027554, 0.04238395392894745, 0.003765338333323598, -0.05772901698946953, -0.03717847540974617, -0.009331624954938889, -0.019045641645789146, -0.02153736539185047, 0.0054491013288497925, -0.006290982943028212, 0.014074532315135002, -0.023819386959075928, -0.023794718086719513, 0.03350256755948067, 0.02468285523355007, -0.03537752851843834, -0.007832890376448631, 0.04001558572053909, 0.002059988444671035, -0.016492243856191635, -0.027186913415789604, 0.04887230321764946, 0.0050173671916127205, 0.008073427714407444, 0.0018502890598028898, -0.004286502953618765, -0.004465364385396242, -0.025509318336844444, -0.028617804870009422, 0.03488411754369736, 0.012705318629741669, 0.018219180405139923, 0.007506005931645632, -0.037375837564468384, -0.0015295722987502813, -0.01496267132461071, -0.04813218489289284, 0.03641368821263313, -0.04477699473500252, -0.014012855477631092, 0.030320070683956146, 0.05496592074632645, -0.033847954124212265, 0.02272154949605465, -0.02896319143474102, 0.02418944612145424, -0.04184120520949364, 0.00030761054949834943, 0.03584626689553261, -0.023659029975533485, 0.08728430420160294, 0.07455431669950485, 0.0023436995688825846, -0.02233915589749813, -0.005581705365329981, 0.010676167905330658, -0.038461342453956604, 0.024954231455922127, -0.012643641792237759, -0.008461988531053066, -0.01680062524974346, 0.03715380281209946, -0.020439526066184044, -0.004995780531316996, -0.011551971547305584, 0.05521262437105179, 0.009664676152169704, -0.009578329510986805, 0.042655330151319504, -0.016664937138557434, 0.02787768840789795, 0.011385445483028889, -0.036537040024995804, 0.011786341667175293, 0.015123029239475727, -0.01847822032868862, -0.003253425005823374, 0.020316174253821373, 0.0077527109533548355, -0.024004416540265083, 0.0004259519628249109, -0.03118353895843029, 0.011348439380526543, -0.03226904198527336, 0.0006422044825740159, -0.0077527109533548355, -0.021154971793293953, -0.02967863716185093, 0.00012450903886929154, 0.03777056559920311, -0.0003307391598355025, -0.01349477469921112, -0.10105045139789581, -0.04828020930290222, -0.007950074970722198, 0.03448938950896263, 0.00349396257661283, -0.007302474230527878, -0.011644485406577587, 0.010287607088685036, 0.02057521417737007, -0.02221580408513546, -0.0018919205758720636, -0.0064821792766451836, -0.0048261708579957485, 0.011416283436119556, -0.014308902435004711, -0.0018071156227961183, 0.011373110115528107, 0.02518860250711441, -0.029357919469475746, 0.04085438326001167, 0.005735896062105894, -0.019983122125267982, 0.02590404637157917, -0.023079272359609604, -0.013938844203948975, -0.003176329657435417, -0.006198468152433634, -0.0296292956918478, -0.0012003750307485461, 0.002332906238734722, -0.0004664270381908864, -0.0010623743291944265, 0.011897359043359756, 0.007049601525068283, 0.041101086884737015, -0.011669156141579151, -0.006926248781383038, -0.018206844106316566, 0.03796793147921562, 0.006500682327896357, -0.014111537486314774, 0.02824774570763111, 0.04884763062000275, -0.03515549376606941, 0.016948647797107697, -0.00872102938592434, 0.006543855648487806, 0.014012855477631092, -0.029234567657113075, 0.0430007167160511, 0.0016560087678954005, -0.019094983115792274, -0.032589759677648544, -0.03424268215894699, 0.0149009944871068, -0.015382070094347, -0.01814516820013523, -0.01609751395881176, 0.006383497267961502, 0.014271896332502365, -0.022166462615132332, -0.013864832930266857, 0.013013700023293495, 0.007370318286120892, -0.020427191630005836, -0.03004869446158409, -0.0023020680528134108, -0.0009922175668179989, 0.03848601132631302, -0.04307473078370094, 0.0007701828144490719, 0.013100046664476395, -0.012612803839147091, 0.020686231553554535, 0.01583847403526306, 0.02247484400868416, -0.010737843811511993, -0.03207167610526085, 0.04058300703763962, -0.04213725030422211, -0.00032033128081820905, 0.011841850355267525, 0.006833734456449747, 0.01667727157473564, -0.007845225743949413, 0.004449945408850908, 0.036068301647901535, -0.026422128081321716, -0.03779523819684982, 0.003163994289934635, -0.0194033645093441, 0.05654483288526535, 0.0043635983020067215, -0.0014725216897204518, -0.006133708171546459, 0.00852983258664608, -0.01819450967013836, -0.011416283436119556, 0.0470220111310482, -0.019168995320796967, -0.010509641841053963, 0.05269623175263405, 0.00679056067019701, -0.023831723257899284, 0.002542605623602867, 0.013396092690527439, -0.000742043019272387, 0.012569630518555641, -0.011163410730659962, 0.0011325310915708542, 0.0412491112947464, -0.03466208279132843, -0.05240018665790558, 0.02615075185894966, 0.0286671444773674, -0.0009991561528295279, -0.022277479991316795, -0.0027106734924018383, 0.023881064727902412, -0.024460822343826294, 0.026249434798955917, -0.03276245296001434, -0.03241706266999245, -0.03902876377105713, -0.016948647797107697, 0.04198922589421272, 0.005109881516546011, 0.035895608365535736, -0.012915018014609814, 0.0075491792522370815, 0.021574370563030243, -0.02247484400868416, -0.05689021944999695, -0.01718301698565483, -0.00026694274856708944, -0.004918685182929039, -0.020908266305923462, 0.009029410779476166, 0.031134197488427162, -0.015382070094347, 0.01613452099263668, 0.0013414595741778612, 0.006839902140200138, -0.009356294758617878, 0.01828085631132126, 0.006753555033355951, -0.001113257254473865, 0.0028371098451316357, -0.0032503411639481783, -0.04936571046710014, -0.039127446711063385, -0.022104786708950996, 0.01639356091618538, -0.042778681963682175, 0.005936344154179096, -0.03629033640027046, 0.0016297962283715606, -0.020476533100008965, -0.012489451095461845, -0.002977423369884491, -0.005267156288027763, -0.024386810138821602, -0.027902359142899513, -0.017627086490392685, 0.015850810334086418, 0.036537040024995804, -0.008215283043682575, -0.03448938950896263, -0.019724082201719284, -0.02967863716185093, 0.0216730535030365, -0.003083815099671483, -0.004397520329803228, -0.02733493782579899, 0.03905343636870384, -0.018811272457242012, -0.005945595446974039, -0.060245413333177567, -0.003987372852861881, 0.006395832635462284, 0.040558334439992905, 0.04048432409763336, -0.06986691802740097, 0.009664676152169704, 0.008653185330331326, -0.01630721427500248, 0.013790820725262165, -0.014826983213424683, 0.02536129578948021, 0.004095306620001793, 0.0054491013288497925, -0.021821076050400734, -0.010096410289406776, -0.017590081319212914, 2.8645750717259943e-05, -0.04845290258526802, 0.0033089336939156055, -0.0071236127987504005, -0.01928001269698143, -0.02896319143474102, -0.013149387203156948, -0.006164546590298414, -0.002693712478503585, -0.012915018014609814, 0.011558138765394688, -0.0013406886719167233, -0.01597416214644909, 0.0034847110509872437, 0.02389339916408062, 0.009017075411975384, 0.04507303982973099, -0.026101410388946533, 0.0033521070145070553, -0.001437057857401669, -0.038708046078681946, -0.023794718086719513, -0.009572162292897701, 0.013112382031977177, 0.017331041395664215, 0.038757387548685074, 0.03219502791762352, -0.019477376714348793, 0.029061874374747276, -0.007808219641447067, 0.009134260006248951, -0.031750962138175964, 0.01054047979414463, 0.029012532904744148, 0.004986529238522053, 0.00840031262487173, -0.007647861260920763, -0.030912162736058235, -0.01081802323460579, 0.03730182722210884, -0.003577225608751178, -0.011909693479537964, -0.005106797907501459, -0.0052147312089800835, 0.008252289146184921, -0.03278712183237076, -0.013716809451580048, 0.014777641743421555, -0.0028864508494734764, -0.016911642625927925, -0.014802312478423119, -0.01240927167236805, 0.015900149941444397, 0.023696035146713257, 0.01763942278921604, -0.013938844203948975, -0.0471947081387043, -0.0005998020642437041, -0.01081802323460579, -0.01148412749171257, -0.005840745754539967, -0.028075052425265312, -0.01815750263631344, -0.03419334068894386, -0.010565150529146194, 0.001700724009424448, 0.0033243526704609394, -0.03885607048869133, -0.020266832783818245, 0.008307797834277153, -0.03483477607369423, -0.015197040513157845, 0.013346752151846886, 0.02314094826579094, -0.006667208392173052, -0.04490034654736519, -0.09952088445425034, -0.020007792860269547, -0.00024265769752673805, 0.02356034703552723, 0.0056834714487195015, 0.007808219641447067, 0.046257227659225464, 0.003987372852861881, -0.007987081073224545, -0.017997145652770996, 0.013766150921583176, -0.012076219543814659, 0.001329124323092401, -0.0149873411282897, -0.04598585143685341, -0.02314094826579094, -0.024411480873823166, 0.03305849805474281, 0.02740894816815853, -0.0073333121836185455, -0.03532818704843521, 0.019477376714348793, 0.012680647894740105, 0.03022138774394989, -0.030295399948954582, 0.01456794235855341, 0.03221970051527023, -0.013988185673952103, -0.002941959537565708, -0.0009968432132154703, 0.010873531922698021, 0.012927353382110596, 0.040928393602371216, 0.035525549203157425, -0.021932093426585197, 0.017034994438290596, -0.0008064176654443145, 0.003063770243898034, 0.006889243144541979, 0.020895931869745255, 0.014802312478423119, -0.030986174941062927, 0.04166850820183754, -0.009646173566579819, 0.01265597715973854, -0.06947218626737595, -0.0021879668347537518, -0.02585470676422119, 0.0347854346036911, -0.014173214323818684, -0.0037838411517441273, -0.02050120197236538, -0.016775954514741898, -0.031874313950538635, -0.0058685000985860825, -0.013803156092762947, -0.002362202387303114, 0.012668312527239323, -0.008930728770792484, 0.018663249909877777, -0.014839318580925465, -0.00454862741753459, 0.03490878641605377, -0.020476533100008965, -0.035402197390794754, 0.006815231405198574, 0.01540673989802599, 0.008955399505794048, -0.007863728329539299, -0.014197885058820248, -0.004570214077830315, -0.015431410633027554, -0.01414854358881712, -0.01735571213066578, -0.023782381787896156, -0.000175584718817845, -0.02859313413500786, 0.004542459733784199, -0.04531974717974663, 0.026101410388946533, 0.033477894961833954, -0.012927353382110596, 0.018095826730132103, 0.03022138774394989, -0.028075052425265312, -0.019724082201719284, 0.011453289538621902, -0.04687399044632912, 0.013470103964209557, -0.013544116169214249, 0.04223593324422836, -0.004770662169903517, 0.0025133092422038317, -0.021599041298031807, -0.01119424868375063, -0.009615335613489151, -0.013630462810397148, -0.016948647797107697, -0.002133999951183796, 0.022437838837504387, -0.012581965886056423, 0.051117319613695145, -7.140959496609867e-05, -0.027088232338428497, -0.012705318629741669, -0.019933780655264854, -0.007388820871710777, -0.0069139134138822556, 0.027556972578167915, -0.012057716958224773, -0.007697202730923891, -0.039250798523426056, -0.035944949835538864, -0.021932093426585197, 0.0326884388923645, 0.013013700023293495, 0.023486336693167686, -0.01167532429099083, -0.018675584346055984, -0.02301759645342827, 0.005526196677237749, 0.013013700023293495, 0.020279167219996452, 0.011650653555989265, -0.015345063991844654, -0.0328611321747303, -0.021389340981841087, 0.025632672011852264, 0.011218919418752193, 0.016208531334996223, 0.014407584443688393, 0.03838733211159706, 0.014925665222108364, 0.007709537632763386, 0.024497827515006065, 0.002679835306480527, 0.01982276327908039, -0.0006784393335692585, 0.020550543442368507, 0.025040578097105026, -0.01020742766559124, 0.012002208270132542, 0.00010610251047182828, 0.025706682354211807, -0.02859313413500786, 0.006238557863980532, 0.0005812991294078529, -0.029950011521577835, -0.006155294831842184, 0.03710446506738663, 0.023066937923431396, -0.01387716829776764, 0.011730832979083061, -0.0034538728650659323, -0.037277158349752426, -0.0058870031498372555, -0.010176589712500572, 0.004224826581776142, -0.011730832979083061, 0.023609688505530357, 0.06009738892316818, 0.040262289345264435, -0.0030082615558058023, -0.00872102938592434, 0.021389340981841087, -0.023079272359609604, -0.035229504108428955, -0.04011426866054535, 0.015567098744213581, 0.009017075411975384, -0.014913329854607582, -0.04307473078370094, 0.006050445139408112, 0.024707525968551636, 0.011181913316249847, 0.0012258165515959263, -0.002377621363848448, 0.012779329903423786, -0.0045856330543756485, 0.013408428058028221, 0.05343634635210037, 0.006889243144541979, -0.05708758533000946, -0.010941375978291035, 0.02050120197236538, -0.01439524907618761, 0.030418751761317253, -0.0024470072239637375, 0.014407584443688393, 0.018046485260128975, 0.05254821106791496, 0.019810428842902184, 0.01119424868375063, 0.030122706666588783, 0.021895086392760277, -0.01355645153671503, 0.009596833027899265, 0.035056810826063156, 0.013050705194473267, -0.03244173526763916, -0.017368046566843987, 0.029727976769208908, -0.010010063648223877, -0.011897359043359756, 0.0037900088354945183, -0.01018275786191225, -0.02263520285487175, -0.04438226670026779, 0.0028294003568589687, -0.014740636572241783, 0.023622022941708565, 0.01322339940816164, -0.010947543196380138, 0.0003097306762356311, -0.00881971139460802, -0.00215867068618536, 0.000567421957384795, 0.001228129374794662, -0.010275271721184254, 0.01763942278921604, 0.010565150529146194, -0.03488411754369736, 0.025459976866841316, 0.06216971203684807, -0.005606375634670258, -0.01676361821591854, 0.022647537291049957, 0.029037203639745712, 0.009553658775985241, -0.020895931869745255, -0.01462961919605732, 0.021562036126852036, -0.018835943192243576, 0.00020468822913244367, 0.0014640411827713251, -0.006957086734473705, -0.035056810826063156, 0.002875657519325614, -0.024658186361193657, -0.0372278168797493, 0.03831331804394722, 0.020550543442368507, -0.015086023136973381, 0.005026618484407663, 0.0005288742831908166, 0.008437317796051502, 0.014160878956317902, 0.07302474230527878, -0.031208209693431854, -0.0051561389118433, 0.005405928008258343, 0.026101410388946533, 0.026668833568692207, -0.003500130260363221, 0.00806726049631834, 0.0165169145911932, 0.014234890230000019, 0.020094139501452446, 0.004712069407105446, -0.0048076678067445755, 0.0007324061007238925, -0.022783225402235985, -0.0004575610801111907, -0.019761087372899055, 0.0010307652410119772, -0.022154128178954124, -0.0026150753255933523, 0.026644162833690643, 0.020562879741191864, -0.01251412183046341, -0.03599429130554199, 0.0024747615680098534, -0.02669350430369377, 0.028075052425265312, 0.002772349864244461, -0.014099203050136566, 0.02393040433526039, 0.0020877427887171507, -0.009146595373749733, -0.008344803936779499, -0.04078036919236183, -0.0247321967035532, -0.009794197045266628, -0.006802896037697792, 0.01802181638777256, 0.005446017254143953, 0.025805365294218063, -0.016146855428814888, 0.023794718086719513, 0.013359086588025093, 0.014580277726054192, 0.029037203639745712, -0.01994611695408821, 0.020932937040925026, 0.019206000491976738, -0.026594821363687515, -0.007950074970722198, 0.018552232533693314, -0.017454393208026886, -0.02280789613723755, -0.00932545680552721, 0.0027029640041291714, -0.016960982233285904, -0.014876323752105236, 0.010781018063426018, 0.015616439282894135, 0.028617804870009422, 0.016356555745005608, -0.017910799011588097, -0.027433618903160095, 0.005779069382697344, -0.0207109022885561, 0.002420794917270541, 0.011138739995658398, 0.003207167610526085, 0.016368890181183815, -0.011410116218030453, -0.017207687720656395, 0.011095566675066948, 0.022746220231056213, -0.013371421955525875, -0.0062601445242762566, -0.013211064040660858, 0.0027646401431411505, -0.021265989169478416, -0.0003717924701049924, 0.013630462810397148, -0.011737000197172165, -0.0058623324148356915, 0.02146335318684578, -0.033675260841846466, 0.006105953827500343, 0.01987210474908352, -0.007154451217502356, -0.001660634414292872, -0.0012119393795728683, -0.012668312527239323, -0.024115433916449547, -0.04095306620001793, -0.03352723643183708, 0.021660717204213142, 0.027384277433156967, 0.014247225597500801, -0.026545479893684387, -0.021685387939214706, 0.030714798718690872, 0.03357657790184021, -0.0009860498830676079, -0.021512694656848907, -0.0008488200837746263, 0.06749854236841202, -0.0058561647310853004, -0.04184120520949364, 0.031158868223428726, 0.010084075853228569, 0.0351308211684227, -0.008128936402499676, -0.012631306424736977, -0.031454913318157196, 0.020168151706457138, -0.013753815554082394, 0.026052070781588554, 0.012100890278816223, -0.005122216884046793, 0.004576381761580706, 0.009652341715991497, -0.007530676666647196, 0.014382913708686829, 0.005109881516546011, -0.0005227066576480865, -0.0010616033105179667, -0.03742517903447151, -0.006513017695397139, 0.019428035244345665, -0.0012296712957322598, 0.0026104494463652372, -0.01814516820013523, -0.02078491449356079, -0.007598520256578922, 0.023399988189339638, 0.017084335908293724, 0.018169838935136795, -0.0657222643494606, 0.02233915589749813, 0.01054047979414463, -0.004218658898025751, -0.025052914395928383, 0.031208209693431854, 0.008696358650922775, -0.02620009332895279, -0.017577746883034706, 0.0024115433916449547, -0.004049049224704504, 0.006377329584211111, 0.016208531334996223, -0.002332906238734722, -0.013655133545398712, 0.021451018750667572, 0.0014154710806906223, -0.019563723355531693, 0.013174057938158512, 0.014197885058820248, 0.023079272359609604, -0.02775433659553528, -0.01847822032868862, -0.0069015780463814735, 0.009547491557896137, 0.007394988555461168, 0.02800104208290577, 0.018502891063690186, -0.03365059196949005, 0.006170713808387518, -0.018465884029865265, -0.003611147403717041, 0.006432838272303343, -0.026940207928419113, 0.0075676823034882545, 0.004761410411447287, -0.023029930889606476, 0.03004869446158409, -0.01139778085052967, 0.01751606911420822, 0.0019798092544078827, -0.04462897405028343, -0.005566286388784647, 0.007524508982896805, -0.025250278413295746, 0.024362139403820038, -0.0015881648287177086, 0.010682335123419762, -0.011662988923490047, -0.03143024444580078, 0.0038763554766774178, -0.03431669622659683, 0.0015573266427963972, 0.007246965542435646, 0.018626242876052856, 0.003463124390691519, -0.010608323849737644, 0.010392457246780396, -0.010922873392701149, 0.012433942407369614, 0.006463676691055298, -0.046849317848682404, -0.010632994584739208, -0.0025179351214319468, 0.004619555082172155, -0.030591445043683052, -0.006543855648487806, 0.028469780460000038, -0.015197040513157845, 0.001174162607640028, 0.010867364704608917, 0.0007836745353415608, -0.02057521417737007, 0.0022234306670725346, -0.053090959787368774, -0.010441797785460949, -0.019933780655264854, 0.002887992886826396, 0.01355645153671503, -0.016590924933552742, 0.04815685749053955, -0.014370578341186047, -0.0004575610801111907, 0.02427579276263714, -0.0010361619060859084, 0.03034474141895771, -0.0196624044328928, -0.012483283877372742, 0.06147893890738487, 0.01877426728606224, 0.01915665902197361, -0.008350971154868603, -0.027063561603426933, 0.03244173526763916, 0.011915861628949642, 0.028272416442632675, -0.01722002401947975, -0.010114913806319237, -0.022289816290140152, 0.010367786511778831, 0.004634974058717489, -0.007302474230527878, 0.04312407225370407, 0.005603292025625706, 0.0037221647799015045, 0.011872688308358192, -0.024534832686185837, -0.024954231455922127, 0.030665457248687744, -0.009300786070525646, 0.002995926421135664, -0.005988768767565489, 0.0018980881432071328, -0.021907422691583633, -0.014654288999736309, -0.02812439389526844, 0.019057977944612503, 0.012224243022501469, -0.02314094826579094, -0.0034908787347376347, -0.023424658924341202, 0.05590340122580528, 0.020180486142635345, -0.014641954563558102, 0.012816336005926132, -0.034020647406578064, 0.02510225586593151, -0.011120237410068512, 0.05856781825423241, 0.012563462369143963, 0.013211064040660858, 0.02859313413500786, 0.04396286979317665, -0.012692983262240887, -0.028864508494734764, 0.0018179089529439807, 0.011052393354475498, -0.022351492196321487, -0.02205544523894787, 0.0075676823034882545, 0.036364346742630005, -0.011533468961715698, -0.010417127050459385, -0.013285075314342976, 0.014407584443688393, -0.008085763081908226, 0.007401156239211559, 0.05536064878106117, -0.013112382031977177, -0.019045641645789146, 0.03698110952973366, -0.002335989847779274, -0.011866520158946514, -0.01744205877184868, -0.008535999804735184, 0.006216971203684807, -0.013519445434212685, -0.024214116856455803, 0.019773421809077263, 0.015554763376712799, 0.03868337720632553, 0.004320424981415272, 0.02824774570763111, 0.03239239379763603, 0.02158670499920845, -0.027853017672896385, 0.02661949209868908, 0.012242745608091354, 0.0235110055655241, -0.025250278413295746, -0.006802896037697792, 0.018256185576319695, 0.010509641841053963, -0.004961858503520489, 0.011231254786252975, 0.0025456894654780626, -0.015295722521841526, 0.009683179669082165, 0.061429597437381744, 0.009269948117434978, -0.015665780752897263, 0.028938520699739456, -0.010441797785460949, 0.0054367659613490105, 0.02615075185894966, -0.004943355452269316, 0.0028232326731085777, -0.015258717350661755, 0.000877345388289541, 0.006389664951711893, 0.014555606991052628, -0.004533207975327969, -0.014382913708686829, -0.005183893255889416, 0.00600418820977211, 0.013790820725262165, 0.007629358675330877, 0.013445434160530567, -0.00928228348493576, -0.025336625054478645, 0.0063125696033239365, 0.006876907777041197, 0.01894696056842804, -0.041347794234752655, 0.0026166171301156282, -0.01355645153671503, -0.026940207928419113, 0.03631500527262688, -0.05674219876527786, 0.011323768645524979, 0.0060843671672046185, -0.02489255554974079, -0.005905505735427141, 0.0018996300641447306, 0.0096585089340806, 0.0014740636106580496, -0.03022138774394989, 0.01083652675151825, -0.0011934364447370172, -0.022536519914865494, -0.003746835282072425, -0.040731031447649, 0.02992534264922142, -0.030961504206061363, 0.012230411171913147, -0.015727456659078598, 0.004894014447927475, 0.007049601525068283, -0.010429462417960167, 0.013149387203156948, 0.0032380057964473963, -0.0015804552240297198, -0.021599041298031807, -0.004446861334145069, 0.01242777518928051, -0.0031609104480594397, -0.03582159802317619, -0.012100890278816223, 0.003805427812039852, 0.04203856736421585, 0.01163215097039938, 0.008733364753425121, -0.016997989267110825, 0.004724404774606228, -0.006146043539047241, -0.018971631303429604, 0.007721873000264168, -0.021302994340658188, 0.035599563270807266, -0.013593456707894802, -0.019896775484085083, 0.012692983262240887, 0.03853535279631615, -0.009374798275530338, -0.025978058576583862, 0.002026066416874528, 0.028050381690263748, -0.012014543637633324, -0.0013021408813074231, 0.0047829970717430115, 0.0034847110509872437, -0.017614752054214478, -0.019637733697891235, -0.011120237410068512, 0.020254498347640038, -0.01915665902197361, 0.007222294807434082, 0.016627931967377663, -0.013248070143163204, 0.025706682354211807, 0.0013823200715705752, -0.004249497316777706, 0.034218013286590576, -0.00019322028674650937, -0.01064532995223999, 0.012181069701910019, 0.027927029877901077, 0.016208531334996223, 0.014173214323818684, -0.012680647894740105, 0.005304161924868822, 0.044160231947898865, -0.0009821951389312744, 0.014432254247367382, -0.007524508982896805, 0.015172370709478855, -0.02205544523894787, 0.017071999609470367, -0.006321820896118879, -0.01504901796579361, 0.01054047979414463, -0.03009803593158722, 0.04238395392894745, -0.014025190845131874, 0.010435630567371845, 0.020106473937630653, 0.0026890868321061134, -0.021944427862763405, 0.02116730622947216, 0.002166380174458027, -0.0030283064115792513, -0.004289587028324604, 0.012446277774870396, 0.011391612701117992, 0.024719862267374992, 0.02338765375316143, -0.006093618459999561, -0.010725509375333786, 0.02883983962237835, 0.010232098400592804, 0.020266832783818245, 0.013938844203948975, -0.01873726025223732, -0.00029681719024665654, 0.02238849736750126, 0.024423815310001373, 0.03374927118420601, 0.0052085635252296925, -0.0020414856262505054, 0.018786601722240448, -0.027803676202893257, -0.01664026640355587, 0.007746543735265732, -0.015209375880658627, 0.01672661304473877, -0.028198406100273132, -0.038165297359228134, 0.008856716565787792, -0.036068301647901535, -0.005612543318420649, 0.025879375636577606, 0.015998832881450653, 0.006661040708422661, -0.004354347009211779, 0.019428035244345665, 0.006531520280987024, -0.011551971547305584, 0.011582809500396252, 0.016960982233285904, 0.012248913757503033, 0.019835099577903748, 0.02196909859776497, 0.004971109796315432, 0.01936635933816433, -0.02871648594737053, -0.018922289833426476, 0.03167694807052612, -0.0023452413734048605, 0.024596508592367172, -0.03927546739578247, 0.014247225597500801, -0.01814516820013523, -0.009695515036582947, -0.0035340520553290844, -0.00014917955559212714, 0.018169838935136795, 0.0038825231604278088]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"t,i, π1
t)∥Σ−1
t,m−ηmX
i=1DKL(π∗(·|xt,i)|π1
t(·|xt,i))≥0,
which implies that π∗∈Πt. Therefore, we finish the proof of Lemma 4.
C Proof of the Offline Learning
C.1 Proof of Theorem 1
Proof of Theorem 1. We start with Option I. If we set ˆ r(x, a) =⟨θMLE, ϕ(x, a)⟩, and take the policy by
ˆπ= argmax
π∈Πh
⟨θMLE,Ex∼d0ϕ(x, π)⟩ −β· ∥Ex∼d0[ϕ(x, π)−ν]∥Σ−1
off−η·Ex∼d0[DKL(π(·|x)∥π0(·|x))]i
.
38
Then, we have

θMLE,Ex∼d0
ϕ(x, π)−ϕ(x,ˆπ)
+β· ∥Ex∼d0[ϕ(x,ˆπ)]−ν∥Σ−1
off−β· ∥Ex∼d0[ϕ(x, π)]−ν∥Σ−1
off
+η·Ex∼d0
DKL(ˆπ(·|x)∥π0(·|x))−DKL(π(·|x)∥π0(·|x))
≤0.(20)
For simplicity, we denote the LHS of Equation (20) as ( ⋆). We plugging this into the estimation of J(π)−J(ˆπ):
J(π)−J(ˆπ)
=Ex∼d0h
Ea∼π(·|x)
r∗(x, a) +ηlogπ0(a|x)
π(a|x)
−Ea∼ˆπ(·|x)
r∗(x, a) +ηlogπ0(a|x)
ˆπ(a|x)i
= (⋆) +⟨θ∗−θMLE,Ex∼d0[ϕ(x, π)]⟩+⟨θMLE−θ∗,Ex∼d0[ϕ(x,ˆπ)]⟩
−β· ∥Ex∼d0[ϕ(x,ˆπ)]−ν∥Σ−1
off+β· ∥Ex∼d0[ϕ(x, π)]−ν∥Σ−1
off
≤ ⟨θ∗−θMLE,Ex∼d0[ϕ(x, π)]−ν⟩+⟨θMLE−θ∗,Ex∼d0[ϕ(x,ˆπ)]−ν⟩
−β· ∥Ex∼d0[ϕ(x,ˆπ)]−ν∥Σ−1
off+β· ∥Ex∼d0[ϕ(x, π)]−ν∥Σ−1
off
≤2β· ∥Ex∼d0[ϕ(x, π)]−ν∥Σ−1
off,
where the first inequality is from the Equation (20) and the second inequality uses Cauchy-Schwarz inequality
and Lemma 8.
For Option II, we use the point-wise pessimism:
ˆr(x, a) =rMLE(x, a)−β∥ϕ(x, a)−ν∥Σ−1
off.
Then, we call Oracle 1 with ˆ rto get ˆ π. By Lemma 1, we have
J(π)−J(ˆπ) =Ex∼d0h
Eπ[r∗(x, a)−ˆr(x, a)] +Eˆπ[ˆr(x, a)−r∗(x, a)]
+Eπ[ˆr(x, a)]−Eˆπ[ˆr(x, a)] +ηDKL(ˆπ(·|x)∥π0(·|x))−ηDKL(π(·|x)∥π0(·|x))i
,
Since ˆ ris obtained from the Oracle 1 with �","[-0.006174534093588591, -0.04424077272415161, 0.008882439695298672, 0.01079987920820713, 0.015428398735821247, -0.006965001113712788, 0.009364974685013294, 0.04114239662885666, -0.009580845013260841, 0.06841827929019928, 0.03771386295557022, -0.03705355152487755, -0.02943459153175354, -0.004092017654329538, 0.04132017120718956, -0.02879967726767063, 0.038196396082639694, -0.00960624124854803, -0.019872793927788734, 0.03748529404401779, 0.010088776238262653, -0.024317188188433647, 0.044037602841854095, -0.006831669248640537, 0.04002494737505913, -0.04005034640431404, 0.02633621357381344, -0.01253319252282381, 0.02421560138463974, -0.029942521825432777, 0.02610764466226101, -0.03118695132434368, 0.003711069468408823, -0.04873596131801605, 0.02151086926460266, 0.0454598069190979, 0.009777667932212353, 0.05252004787325859, -0.018387096002697945, -0.004984071012586355, 0.014882372692227364, -0.028926659375429153, -0.09808143973350525, 0.018882328644394875, 0.008298319764435291, 0.029180625453591347, 0.007117380388081074, 0.01579664833843708, 0.04919309914112091, -0.006072947755455971, -0.06338976323604584, 0.03824719041585922, -0.001772996038198471, 0.016863303259015083, -0.04594234377145767, -0.025663204491138458, 0.02930760756134987, 0.020761672407388687, 0.04830421879887581, -0.035809122025966644, 0.035047225654125214, -0.0009420529240742326, 0.023961635306477547, 0.013714131899178028, -0.01701568253338337, 0.016977587714791298, -0.03169488161802292, 0.0612056627869606, -0.017675992101430893, 0.037739258259534836, -0.006647544447332621, -0.012996680103242397, 0.059021562337875366, 0.005269782152026892, -0.0016118866624310613, 0.028520315885543823, 0.028012383729219437, 0.006476117763668299, 0.04258999973535538, -0.01503475196659565, 0.03893289715051651, -0.010742736980319023, 0.07293886691331863, -0.04231063649058342, 0.03893289715051651, -0.10504009574651718, -0.04738994315266609, 0.017129966989159584, -0.06344056129455566, -0.014945863746106625, -0.011231619864702225, -0.0026412401348352432, 0.024812420830130577, 0.008050703443586826, 0.0550089068710804, 0.01832360401749611, -0.0007753881509415805, -0.018564870581030846, 0.004301539156585932, -0.013104614801704884, 0.031263142824172974, -0.06831669807434082, 0.04441855102777481, 0.001868232968263328, 0.03507262095808983, -0.008958629332482815, -0.01210780069231987, 0.04576456546783447, -0.032837726175785065, -0.024837816134095192, -0.07908482849597931, -0.05188513174653053, -0.02120611071586609, 0.010831624269485474, 0.009441164322197437, -0.04713597893714905, -0.06211993843317032, 0.01664743199944496, -0.015961725264787674, -0.03456469252705574, -0.02335212007164955, -0.009784017689526081, 0.008901487104594707, 0.006358658894896507, 0.02386005036532879, 0.00350472261197865, 0.025193369016051292, -0.05973266437649727, -0.016139501705765724, -0.01181574072688818, 0.006533259991556406, 0.016406165435910225, -0.024863213300704956, -0.04358046501874924, -0.03001871146261692, 0.055973976850509644, 0.02448226511478424, 0.030348865315318108, 0.04518044739961624, 0.009885603561997414, 0.0016396641731262207, -0.023961635306477547, -0.06450721621513367, 0.007218966726213694, -0.05765014886856079, 0.026361608877778053, 0.0016952190781012177, -0.003828528570011258, 0.006787225604057312, -0.031847260892391205, 0.014437933452427387, -0.036342449486255646, -0.016190294176340103, 0.030171090736985207, -0.011009400710463524, -0.019504543393850327, -0.02182832732796669, 0.06344056129455566, 0.015415700152516365, 0.027250487357378006, -0.051554977893829346, 0.033650416880846024, 0.03723132982850075, -0.0017396630719304085, 0.029942521825432777, 0.036342449486255646, -0.008203082717955112, 0.017587104812264442, -0.053993046283721924, -0.02768222987651825, 0.0024967973586171865, 0.03250757232308388, -0.0179553534835577, -0.007542772684246302, -0.002469813684001565, -0.03486945107579231, -0.012361765839159489, -0.019783904775977135, 0.01570776104927063, -0.017625199630856514, 0.021942611783742905, 0.02641240321099758, 0.03987256810069084, 0.0032602809369564056, -0.025180669501423836, 0.0023618782870471478, -0.010241154581308365, -0.018107732757925987, 0.007282458245754242, -0.005323749966919422, 0.0073142037726938725, 0.03824719041585922, 0.00868561677634716, -0.03705355152487755, -0.0008912598714232445, -0.025485428050160408, 0.028698090463876724, 0.09157992899417877, -0.03415834903717041, 0.039542414247989655, 0.04853278771042824, 0.005993583705276251, 0.008641173131763935, -0.026564782485365868, 0.00925069022923708, 0.0016793461982160807, 0.04322491213679314, 0.020774370059370995, -0.03065362386405468, 0.0008706251392140985, 0.020647387951612473, 0.008431651629507542, 0.006653893738985062, -0.004149159882217646, -0.019961681216955185, 0.012171291746199131, -0.027072712779045105, 0.015441096387803555, 0.007511026691645384, 0.043859824538230896, -0.017841069027781487, 0.04195508360862732, -0.0048158192075788975, 0.004666614346206188, -0.03151710703969002, 0.012723666615784168, 0.0677579715847969, -0.036164674907922745, 0.039491619914770126, -0.04495187848806381, 0.06267866492271423, 0.010996702127158642, -0.02389814518392086, -0.03438691794872284, 0.04901532456278801, -0.022539429366588593, -0.03530118986964226, -0.024609247222542763, 0.005882473662495613, -0.06399928033351898, -0.01224113255739212, 0.029764745384454727, -0.0306028313934803, -0.054297804832458496, -0.03291391581296921, -0.0029507605358958244, -0.005079308059066534, 0.002736477181315422, -0.030755210667848587, -0.018564870581030846, -0.011593520641326904, 0.010374486446380615, -0.015314114280045033, -0.006590402219444513, -0.045662980526685715, 0.010457025840878487, 0.021980706602334976, 0.025371143594384193, -0.005920568481087685, 0.016634734347462654, -0.014856976456940174, -0.008850694634020329, -0.006057074759155512, -7.951299630803987e-05, 0.007085634861141443, -0.02377116121351719, 0.00014156587712932378, 0.00779673783108592, 0.022425144910812378, -0.008215781301259995, 0.015072846785187721, 0.01431095041334629, -0.041523344814777374, 0.0350218303501606, -0.03921226039528847, -0.06003742292523384, 0.009930047206580639, 0.038196396082639694, -0.0550089068710804, -1.1985232958977576e-05, -0.05125021934509277, 0.0033047248143702745, 0.04022812098264694, 0.019999776035547256, 0.03900908678770065, -0.04200587794184685, 0.011847485788166523, -0.025091782212257385, -0.04302173852920532, -0.041523344814777374, 0.0175109151750803, -0.02349179983139038, 0.04375823959708214, -0.006768178194761276, -0.007187221199274063, 0.009663383476436138, 0.01203795988112688, -0.05724380165338516, 0.004139636177569628, 0.03728212043642998, 0.05125021934509277, 0.013510959222912788, -0.033421847969293594, 0.02142198197543621, -0.04045668989419937, 0.01132050808519125, 0.03349803760647774, -0.006768178194761276, -0.015580778010189533, 0.008018957450985909, -0.03174567595124245, 0.0035110716708004475, 0.005812633316963911, 0.030958382412791252, 0.003872972447425127, -0.03232979774475098, 0.020088663324713707, -0.046831220388412476, 0.0025285431183874607, -0.05805649235844612, -0.004282491747289896, -0.06679290533065796, 0.008069750852882862, -0.021498171612620354, -0.015631571412086487, -0.015466493554413319, -0.015339510515332222, -0.0077078500762581825, 0.006476117763668299, -0.04078684374690056, -0.03410755470395088, -0.0012301449896767735, 0.002842825371772051, -0.033421847969293594, 0.0020793417934328318, 0.01989818923175335, -0.03852655366063118, 0.05785331875085831, 0.019326766952872276, -0.017383931204676628, -0.05653269961476326, 0.029104435816407204, -0.029586970806121826, 0.014907768927514553, 0.006539609283208847, -0.04848199710249901, 0.05081847682595253, 0.02170134335756302, 0.06364373117685318, 0.055516839027404785, -0.021777532994747162, -0.025460032746195793, 0.05617714673280716, 0.011288762092590332, 0.01859026774764061, -0.02173943817615509, -0.01302842516452074, -0.04655186086893082, -0.03065362386405468, -0.0004154715279582888, -0.023466404527425766, -0.017523612827062607, 0.032075829803943634, -0.008330065757036209, 0.0004317411803640425, 0.048278823494911194, -0.006003107409924269, -0.008603078313171864, 0.009504655376076698, -0.023694971576333046, 0.002731715328991413, 0.025853678584098816, -0.06851986795663834, -0.0024174333084374666, -0.02276799827814102, -0.04231063649058342, -0.007377695292234421, 0.015314114280045033, 0.06034218147397041, 0.009187198244035244, -0.03012029640376568, -0.015415700152516365, -0.018564870581030846, -0.019187087193131447, 0.013345882296562195, 0.030628228560090065, -0.013333183713257313, -0.037561483681201935, -0.008317367173731327, -0.04195508360862732, 0.022615619003772736, -0.04261539503931999, -0.013676037080585957, 0.013498261570930481, -0.05693904310464859, 9.240967483492568e-05, -0.015771251171827316, 0.06542149186134338, 0.014780786819756031, 0.054704148322343826, -0.05170735716819763, -0.0350218303501606, -0.04716137424111366, -0.016596639528870583, -0.03248217701911926, -0.027021918445825577, 0.030501244589686394, 0.03563134744763374, 0.012361765839159489, 0.02497749775648117, 0.025371143594384193, 0.018717249855399132, 0.0348440520465374, -0.054805733263492584, -0.005136450286954641, -0.006279294844716787, -0.00604120222851634, 0.01823471672832966, 0.04893913492560387, 0.03235519304871559, -0.005501525476574898, -0.04340268671512604, 0.008787202648818493, 0.0015587126836180687, -0.0451042577624321, 0.02552352286875248, 0.05216449499130249, 0.0028063177596777678, 0.030806003138422966, -0.05262163281440735, -0.006660242564976215, 0.0408630333840847, -0.01474269200116396, 0.007028492633253336, -0.07405631244182587, -0.011314159259200096, 0.014856976456940174, 0.002944411477074027, -0.03730751946568489, -0.012774460017681122, 0.024774326011538506, -0.01922518201172352, -0.04276777431368828, 0.016406165435910225, -0.018475983291864395, 0.010107823647558689, -0.0604945607483387, -0.0200759656727314, 0.014361743815243244, 0.01984739676117897, -0.043097928166389465, -0.014818881638348103, 0.03652022406458855, -0.0016190294409170747, -0.017993448302149773, -0.07634200155735016, 0.044316962361335754, 0.015910932794213295, -0.003742815228179097, 0.012996680103242397, 0.004739629570394754, -0.022539429366588593, -0.017345836386084557, -0.009066564962267876, 0.030856797471642494, 0.031034572049975395, 0.022806093096733093, 0.02186642214655876, -0.020507706329226494, 0.030907589942216873, -0.01552998460829258, -0.06430403888225555, 0.042691584676504135, -0.04180270433425903, -0.012583985924720764, 0.028342539444565773, 0.01132050808519125, -0.014793485403060913, 0.049929600208997726, -0.025129877030849457, 0.017231551930308342, 0.018196621909737587, 0.003352343337610364, 0.004984071012586355, -0.007206268608570099, 0.07232934981584549, 0.05150418356060982, 0.0031174253672361374, -0.016088709235191345, -0.010069728828966618, 0.014285554178059101, -0.03286312520503998, 0.036164674907922745, -0.01332048512995243, -0.02862190082669258, 0.010444327257573605, 0.010641150176525116, -0.03232979774475098, -0.010476073250174522, -0.011212572455406189, 0.03357422724366188, -0.031263142824172974, -0.00306028313934803, 0.03514881059527397, -0.019428353756666183, 0.01053321547806263, -0.006187232211232185, -0.0252060666680336, 0.00355551578104496, 0.017980750650167465, -0.021993404254317284, 0.022564826533198357, 0.006406277418136597, -0.014056985266506672, -0.03728212043642998, -0.014768088236451149, -0.021168015897274017, -0.010774482041597366, -0.03547896817326546, -0.012488748878240585, 0.007206268608570099, -0.020952146500349045, -0.01867915503680706, -0.008812599815428257, 0.03172028064727783, 0.024063222110271454, -0.032558366656303406, -0.1026020273566246, -0.04680582508444786, -0.028393331915140152, 0.05450097471475601, -0.004533282481133938, 0.013701433315873146, 0.008050703443586826, 0.0203426294028759, 0.027174297720193863, -0.025955265387892723, -0.0037332915235310793, -0.0030825051944702864, -0.029866332188248634, 0.024139411747455597, -0.008012608624994755, -0.005498351063579321, 0.008063402026891708, 0.018399793654680252, -0.048456598073244095, 0.021523568779230118, -0.006104693282395601, -0.017498215660452843, 0.04596773907542229, -0.021129921078681946, -0.03372660651803017, -0.03601229563355446, 0.005723745562136173, -0.05724380165338516, -0.001242049620486796, -0.013917304575443268, 0.004092017654329538, 0.008387207984924316, 0.040888428688049316, -0.0048920088447630405, 0.025536222383379936, 0.0017856942722573876, 0.00345392944291234, -0.012272878549993038, 0.010018935427069664, 0.008215781301259995, -0.022526731714606285, -0.002530130324885249, 0.05107244476675987, -0.05389145761728287, 0.04264079034328461, -0.016990285366773605, 0.0035364683717489243, 0.024825118482112885, -0.019022008404135704, 0.02556161768734455, 0.01404428668320179, -0.00026130658807232976, -0.009111008606851101, -0.02669176459312439, -0.015377605333924294, -0.025828281417489052, -0.00911735836416483, -0.020952146500349045, 0.01098400354385376, -0.0008896725485101342, 0.0005932472995482385, -0.05958028510212898, 0.006647544447332621, 0.011466538533568382, -0.03189805522561073, -0.033548831939697266, -0.023428309708833694, -0.006491990759968758, 0.019326766952872276, 0.003368216101080179, 0.014958562329411507, 0.007352298591285944, -0.04914230480790138, 0.04924389347434044, -0.004241222515702248, 0.02524416148662567, 0.001141257002018392, -0.01970771513879299, 0.04690741002559662, -0.030323470011353493, 0.006799923721700907, 0.017498215660452843, -0.030983779579401016, 0.004904706962406635, -0.010177663527429104, 0.015987122431397438, 0.010717339813709259, -0.030552038922905922, -0.022399749606847763, 0.007199919316917658, -0.01352365780621767, 0.04248841106891632, -0.030450452119112015, -0.01480618305504322, -0.03834877535700798, 0.014590312726795673, -0.027580643072724342, -0.016723621636629105, 0.02587907575070858, -0.011225271038711071, -0.021053731441497803, 0.029536176472902298, -0.021625153720378876, -0.002833301667124033, -0.03547896817326546, 0.020190250128507614, -0.009377672336995602, 0.02416480891406536, -0.034310728311538696, -0.003631705418229103, -0.002877745544537902, -0.012190339155495167, -0.030907589942216873, 0.01701568253338337, 0.018793439492583275, -0.008495142683386803, -0.01733313873410225, 0.005517398472875357, 0.021396584808826447, -0.00687611335888505, 0.00925069022923708, -0.029764745384454727, -0.046297892928123474, -0.03001871146261692, -0.017091872170567513, 0.024418773129582405, -0.0036285307724028826, 0.029942521825432777, -0.011237969622015953, 0.008653870783746243, 0.0015174433356150985, -0.007225316017866135, -0.042818568646907806, -0.0011237969156354666, -0.006193581502884626, 0.005793585907667875, -0.006498340051621199, 0.0002886872389353812, 0.02704731561243534, 0.028571108356118202, 0.04820263385772705, 0.019821999594569206, -0.005336448084563017, 0.0015118877636268735, -0.009872904978692532, 0.026996523141860962, -0.027174297720193863, -0.007860229350626469, -0.03286312520503998, -0.03898369148373604, -0.03230439871549606, -0.058259665966033936, -0.0006115011055953801, -0.039491619914770126, -0.00753007410094142, -0.024863213300704956, -0.008501492440700531, -0.030907589942216873, -0.023885445669293404, 0.028748884797096252, -0.0025126703549176455, -0.01862836256623268, -0.024596549570560455, -0.0175109151750803, -0.020533103495836258, 0.055110491812229156, -0.016723621636629105, -0.0008730060653761029, 0.0007456265739165246, 0.0051269265823066235, 0.03987256810069084, 0.0005317400791682303, -0.05180894210934639, -0.018755344673991203, 0.027479056268930435, -0.01652044989168644, 0.01673632115125656, -0.04434236139059067, -0.03728212043642998, -0.026590177789330482, 0.04571377485990524, 0.03568213805556297, -0.05505970120429993, -0.012482400052249432, -0.021256905049085617, -0.00947290938347578, 0.006882462650537491, 0.008863392286002636, 0.024202903732657433, 0.02669176459312439, -0.008196733891963959, 0.0012063357280567288, -0.015999820083379745, -0.011333206668496132, 0.007149126380681992, -0.048405807465314865, -0.0003728132869582623, 0.011809390969574451, 0.0014031588798388839, -0.05653269961476326, 0.03174567595124245, -0.03512341529130936, -0.014272855594754219, -0.016622036695480347, 0.011149081401526928, 0.004431696143001318, -0.004241222515702248, -0.014095080085098743, 0.01588553562760353, 0.010380836203694344, 0.020241042599081993, 0.013104614801704884, -0.03253296762704849, -0.006545958574861288, -0.019453750923275948, -0.02389814518392086, 0.0027761594392359257, 0.010342741385102272, 0.020507706329226494, 0.010241154581308365, 0.03047584928572178, -0.014069683849811554, 0.02492670528590679, -0.007091984152793884, 0.009910999797284603, -0.04002494737505913, 0.016266483813524246, 0.015288717113435268, -0.020533103495836258, 0.00554596958681941, 0.006965001113712788, -0.053586699068546295, -0.015822045505046844, 0.01445063203573227, -0.009301482699811459, -0.015517286024987698, 0.01187923178076744, 0.017714086920022964, -0.01805694028735161, -0.01053321547806263, -0.024279093369841576, 0.04650106653571129, -0.0137522267177701, -0.016266483813524246, 0.0003245995321776718, -0.008615775965154171, 0.0024269570130854845, 0.022806093096733093, 0.03497103601694107, 0.01316810678690672, -0.04949785768985748, 0.01111733540892601, -0.013269692659378052, 0.008837996050715446, -0.018298206850886345, -0.016723621636629105, -0.02920602262020111, -0.010272900573909283, -0.011371301487088203, -0.010501469485461712, -0.00960624124854803, -0.02948538400232792, -0.02250133454799652, 0.011676060035824776, -0.054754942655563354, -0.03172028064727783, -0.009631638415157795, 0.021320395171642303, -0.0046539162285625935, -0.04657725617289543, -0.08832916617393494, 0.01782837137579918, -0.012596684508025646, -0.01066654734313488, 0.041574135422706604, 0.023212438449263573, 0.01917438767850399, -0.016990285366773605, -0.01823471672832966, -0.021929912269115448, 0.003495198907330632, -0.025269558653235435, 0.010876068845391273, 0.0017222028691321611, -0.010749085806310177, -0.03748529404401779, -0.02340291254222393, 0.012514145113527775, -0.006387230008840561, -0.013536356389522552, -0.034818656742572784, -0.0306028313934803, 0.015428398735821247, 0.013739528134465218, -0.028647297993302345, -0.02575209178030491, 0.011834788136184216, 0.003755513345822692, 0.002571399789303541, 0.024634644389152527, -0.004193603992462158, -0.0036602765321731567, 0.030729813501238823, 0.007028492633253336, -0.01664743199944496, 0.006371357012540102, -0.002588859759271145, -0.019771207123994827, -0.008641173131763935, 0.04352967068552971, 0.012876045890152454, -0.042285241186618805, 0.036393243819475174, 0.012545891106128693, 0.006012631114572287, -0.03192345052957535, 0.03420913964509964, -0.0012436368269845843, 0.018983913585543633, -0.023110851645469666, 0.007282458245754242, -0.01471729576587677, -0.004015828017145395, -0.02773302234709263, -0.006863415241241455, -0.006882462650537491, 0.019237879663705826, 0.02592986822128296, -0.012342718429863453, -0.026133039966225624, -0.032075829803943634, 0.014818881638348103, -0.011580822989344597, -0.00911735836416483, -0.025637807324528694, -0.00047578831436112523, 0.004438045434653759, 0.01867915503680706, -0.015441096387803555, -0.0028301270212978125, 0.029637763276696205, -0.02669176459312439, -0.014476028271019459, -0.010082426480948925, -0.009885603561997414, -0.009695129469037056, -0.00996814202517271, 0.006533259991556406, -0.043326497077941895, 0.03042505495250225, 0.03728212043642998, -0.02651398815214634, 0.020723577588796616, 0.015403001569211483, -0.020914051681756973, 0.0035078972578048706, 0.025002894923090935, -0.0344885028898716, -0.017790276557207108, -0.008095147088170052, 0.03456469252705574, -0.015682363882660866, -0.008431651629507542, -0.005898346658796072, -0.0019872793927788734, -0.03367581218481064, -0.04182810336351395, 0.02377116121351719, 0.024787023663520813, 0.0011753836879506707, 0.02542193792760372, 0.05125021934509277, 0.021231507882475853, 0.004412648733705282, -0.006288818549364805, -0.026844143867492676, 0.0027761594392359257, 0.0026682240422815084, 0.03222820907831192, -0.02205689623951912, 0.008742759004235268, 0.011034796945750713, -0.03123774565756321, 0.005958663299679756, 0.0003974161809310317, 0.025955265387892723, 0.019745809957385063, -0.016317278146743774, -0.00897767674177885, -0.014120476320385933, 0.0022539428900927305, 0.05765014886856079, -0.014323648996651173, 0.027352074161171913, 0.010647499933838844, -0.030171090736985207, -0.0005305496160872281, 0.022209275513887405, -0.023034662008285522, 0.008857043460011482, 0.004276142455637455, -0.0053713684901595116, 0.031263142824172974, 0.007485630456358194, 0.02363148145377636, 0.014209364540874958, 0.005872949957847595, 0.0002819412911776453, -0.007961815223097801, 0.01876804418861866, 0.0012785571161657572, 0.004495187662541866, -0.0051110535860061646, 0.01935216411948204, -0.006850716657936573, 0.014285554178059101, -0.011237969622015953, 0.0022507684770971537, -0.04358046501874924, 0.036215465515851974, 0.03860274329781532, -0.01931406930088997, 0.02669176459312439, -0.018475983291864395, -0.0023666401393711567, -0.008304668590426445, 0.042869359254837036, -0.03801862150430679, -0.00572691997513175, 0.022945774719119072, 0.0172442514449358, 0.026133039966225624, -9.930444502970204e-05, -0.011625266633927822, 0.04035510495305061, -0.02722509205341339, -0.02223467081785202, -0.016723621636629105, 0.01611410453915596, 0.005253909155726433, -0.011758598499000072, -0.02278069779276848, 0.009930047206580639, 0.03293931484222412, 0.017574405297636986, 0.006479292642325163, 0.03230439871549606, 0.026717159897089005, -0.00925069022923708, 0.00902212131768465, 0.027148902416229248, 0.023885445669293404, -0.02069818042218685, 0.0038888452108949423, 0.04838040843605995, -0.009587193839251995, 0.03037426248192787, 0.007364996708929539, 0.018831534311175346, 0.04038050025701523, 0.050208959728479385, 0.016050614416599274, -0.011110986582934856, 0.013498261570930481, 0.014907768927514553, 0.004872961435467005, 0.007434837520122528, 0.023847350850701332, 0.007917371578514576, -0.03718053549528122, -0.02704731561243534, 0.021777532994747162, 0.01239986065775156, -0.007276108954101801, 0.00866022054105997, -0.0005611047963611782, -0.011237969622015953, -0.04137096554040909, 0.0016571242595091462, 0.028698090463876724, 0.01850138045847416, 0.00737134600058198, -0.006679289974272251, -0.0052951788529753685, -0.0032380588818341494, -0.0041745565831661224, 0.001636489643715322, -0.0025237812660634518, -0.0009706240380182862, -0.02232355996966362, -0.012482400052249432, -0.009942745789885521, 0.03486945107579231, 0.028418729081749916, -0.03316788375377655, -0.009142754599452019, 0.04027891531586647, -0.013841114938259125, 0.004641217645257711, -0.014056985266506672, -0.035707537084817886, 0.04937087371945381, -0.024812420830130577, -0.004171381704509258, -0.0011380824726074934, -0.019771207123994827, 0.003419009270146489, 0.015695061534643173, 0.0022031499538570642, -0.01550458837300539, 0.04393601417541504, -0.008050703443586826, -0.03339645266532898, 0.01017131470143795, 0.034945640712976456, 0.01899661310017109, 0.02186642214655876, 0.07598645240068436, -0.015174432657659054, 0.003771386342123151, -0.033955175429582596, 0.04693280905485153, 0.0353773795068264, -0.003079330548644066, 0.009079263545572758, 0.021218810230493546, 0.010247504338622093, 0.027555245906114578, 0.026209229603409767, 0.00904751755297184, -0.011034796945750713, -0.003590435953810811, -0.006031678523868322, -0.021218810230493546, -0.0102602019906044, -0.03588531166315079, -0.006399928126484156, 0.025409238412976265, 0.004111065063625574, 0.02147277444601059, -0.008984026499092579, 0.02124420553445816, -0.017206156626343727, 0.016672829166054726, 0.018933121114969254, -0.007568168919533491, 0.027961591258645058, -0.0037491642870008945, 0.002085690852254629, -0.0061777085065841675, -0.032075829803943634, -0.03464088216423988, -0.01066654734313488, -0.017790276557207108, 0.01719345897436142, -0.009168150834739208, 0.03276153653860092, -0.020177552476525307, -0.006838018540292978, 0.031212348490953445, 0.026387006044387817, 0.04060906916856766, -0.013295088894665241, 0.012323671020567417, 0.015910932794213295, -0.054704148322343826, -0.020647387951612473, 0.022577524185180664, -0.030932987108826637, 0.009377672336995602, 0.026564782485365868, 0.0073840441182255745, -0.026945728808641434, -0.005085657350718975, 0.014920467510819435, 0.006882462650537491, 0.021460076794028282, -0.011441141366958618, -0.02646319568157196, -0.030171090736985207, 0.008501492440700531, 0.004349157679826021, 0.008907836861908436, -0.0041650328785181046, -0.007866578176617622, 0.011891930364072323, -0.03667260333895683, -0.0030079027637839317, -0.012450654059648514, -0.006603100802749395, -0.012583985924720764, -0.013218899257481098, 0.004228523932397366, -0.015872837975621223, -0.011663361452519894, -0.00828562118113041, -0.008317367173731327, -0.011510982178151608, 0.0026539384853094816, 0.007618962321430445, -0.02768222987651825, 0.012209386564791203, 0.015834743157029152, -0.006717384792864323, -0.0394408293068409, -0.012476050294935703, -0.042107462882995605, -0.006101518869400024, -0.03974558785557747, 0.010723689571022987, 0.017117269337177277, 0.03012029640376568, 0.01867915503680706, -0.03860274329781532, -0.01325699407607317, 0.01325699407607317, -0.0011134796077385545, 0.01660933718085289, -0.011422093957662582, 0.006488816346973181, 0.08502762019634247, -0.0071427770890295506, -0.015149036422371864, 0.026183834299445152, 0.016190294176340103, 0.04119318723678589, -0.007809436414390802, -0.010215758346021175, -0.019504543393850327, 0.010837974026799202, -0.024202903732657433, -0.0086221257224679, 0.012450654059648514, 0.003023775527253747, 0.0042507462203502655, 0.009999888017773628, -0.03560594841837883, 0.014577614143490791, -0.01737123355269432, 0.011396697722375393, -0.00235235458239913, -0.02186642214655876, -0.022806093096733093, 0.021764835342764854, -0.011542728170752525, -0.004453918430954218, -0.021168015897274017, 0.002569812349975109, -0.014641106128692627, 0.04373284429311752, 0.021041033789515495, -0.01827281154692173, -0.042056672275066376, 0.03649482876062393, 0.018069637939333916, -0.012583985924720764, -0.012095102109014988, 0.014615708962082863, 0.02979014255106449, -0.020139457657933235, -0.011866533197462559, -0.0014976022066548467, -0.0313139334321022, 0.0006301516550593078, 0.03903448209166527, 0.002317434409633279, -0.0059300921857357025, 0.021231507882475853, -0.0032079005613923073, -0.0005071371560916305, -0.004533282481133938, -0.0037682116962969303, 0.029688555747270584, -0.027021918445825577, -0.006526911165565252, -0.006545958574861288, -0.008869742043316364, 0.022615619003772736, -0.012952235527336597, 0.013561752624809742, -0.05168196186423302, -0.002019024919718504, -0.01733313873410225, 0.0012595097068697214, 0.023428309708833694, -0.010939559899270535, 0.008336414583027363, 0.0029761570040136576, -0.0058539025485515594, 0.03827258571982384, -0.026133039966225624, 0.007276108954101801, -0.016279183328151703, -0.029942521825432777, -0.0074538844637572765, 0.019733112305402756, -0.029129832983016968, 0.007980862632393837, -0.010768133215606213, 0.046653445810079575, -0.029104435816407204, 0.0005999932764098048, -0.0038888452108949423, -0.013003028929233551, -0.0128696970641613, 0.017129966989159584, 0.02674255706369877, -0.014349045231938362, -0.01267287414520979, 0.00275711202993989, -0.011803042143583298, -0.004841215442866087, 0.011644314043223858, -0.02186642214655876, -0.006704686675220728, -0.013917304575443268, 0.02605685032904148, -0.0014928403543308377, -0.015923630446195602, 0.030552038922905922, 0.006136439274996519, 0.013853812590241432, 0.048583582043647766, -0.020583895966410637, 0.005882473662495613, 0.005142799578607082, -0.06389769911766052, 0.002606319962069392, -0.007739595603197813, -0.011460188776254654, 0.007720548193901777, -0.008209431543946266, 0.021396584808826447, -0.00812689308077097, -0.024494962766766548, -0.008939581923186779, 0.006034852936863899, 0.02925681509077549, 0.022399749606847763, -0.01993628405034542, 0.014666502363979816, 0.018336301669478416, 0.00261584366671741, 0.010914163663983345, -0.005149148404598236, 0.034310728311538696, 0.0026174308732151985, 0.004355506505817175, -0.02366957627236843, 0.018920423462986946, -0.004590424709022045, 0.022298162803053856, 0.00947290938347578, -0.012368115596473217, 0.026209229603409767, 0.025320351123809814, -0.019872793927788734, 0.0006777701782993972, -0.02030453458428383, -0.02556161768734455, 0.01809503510594368, 0.012545891106128693, 0.015403001569211483, 0.01500935573130846, 0.013828416354954243, -0.01607600972056389, 0.009320530109107494, -0.029231417924165726, 0.007720548193901777, 0.0013420484028756618, -0.02426639385521412, 0.03268534690141678, -0.016888700425624847, 0.05140259861946106, 0.004517409484833479, -0.024520359933376312, 0.019415656104683876, -0.01894581876695156, 0.02704731561243534, -0.00505073694512248, 0.034463103860616684, -0.0027031442150473595, 0.022310860455036163, 0.029713952913880348, 0.03883131220936775, -0.005447558127343655, -0.008723711594939232, 0.02366957627236843, 0.0031428218353539705, -0.02276799827814102, 0.006139613687992096, 0.0027094935066998005, 0.023466404527425766, -0.022031499072909355, 0.0073967427015304565, 0.001882518525235355, 0.02115531824529171, -0.011510982178151608, -0.027656832709908485, 0.03667260333895683, 0.003266629995778203, -0.03712974116206169, 0.03453929349780083, 0.011199874803423882, -0.0018158527091145515, 0.004606297705322504, 0.012152244336903095, 0.017929958179593086, -0.004771375097334385, -0.015187131240963936, 0.02088865451514721, 0.03672339767217636, 0.05368828773498535, 0.020672783255577087, 0.023390214890241623, 0.018069637939333916, 0.0027999687008559704, -0.024406075477600098, 0.055516839027404785, 0.02610764466226101, 0.02214578352868557, -0.010418931022286415, -0.026844143867492676, 0.0032094877678900957, -0.001741250278428197, 0.01239986065775156, 0.01129511184990406, -0.0013896669261157513, -0.02088865451514721, 0.016317278146743774, 0.011193525046110153, 0.014882372692227364, -0.019110897555947304, 0.02156166359782219, -0.026590177789330482, 0.017980750650167465, 0.017536310479044914, -0.008012608624994755, 0.0024888610932976007, -0.02646319568157196, -0.0070602381601929665, -0.02628541924059391, 0.003104727016761899, 0.00859672948718071, -0.001187288318760693, 0.004025351721793413, 0.039669398218393326, 0.02366957627236843, 0.017041079699993134, 0.0070729367434978485, 0.01746012084186077, -0.029358401894569397, 0.006491990759968758, -0.016672829166054726, 0.008831647224724293, 0.002868221839889884, 0.016266483813524246, -0.016368070617318153, -0.001378556014969945, 0.03583451732993126, -0.030704418197274208, -0.005285655148327351, 0.02057119831442833, -0.01935216411948204, 0.015225226059556007, 0.019948983564972878, 0.00832371599972248, 0.01989818923175335, -0.04010113701224327, 0.0071427770890295506, 0.010584007948637009, -0.016444260254502296, 0.008291970938444138, -0.024228299036622047, 0.02826634980738163, -0.009841159917414188, -0.0056062862277030945, -0.01952994056046009, 0.009504655376076698, 0.017523612827062607, 0.0077078500762581825, 0.014844277873635292, -0.004136461764574051, -0.011288762092590332, -0.021929912269115448, 0.010888766497373581, -0.006276119966059923, -0.0059300921857357025, -0.012990330345928669, -0.018437888473272324, -0.014133174903690815, 0.02727588452398777, 0.021929912269115448, 0.004374553915113211, 0.0001933510066010058, -0.0055427951738238335, -0.004679312463849783, -0.004990420304238796, 0.0027856831438839436, -0.0074538844637572765, 0.006152311805635691, -0.0012817316455766559, 0.003711069468408823, 0.0007357060094363987, 0.05211370065808296, 0.014298252761363983, -0.04279316961765289, -0.03344724327325821, 0.014387140050530434, 0.007352298591285944, -0.02844412624835968, -0.018260112032294273, -0.013015727512538433, -0.01940295659005642, -0.0018809313187375665, -0.005079308059066534, 0.015872837975621223, -0.02187911979854107, -0.007091984152793884, 0.02681874670088291, -0.03956780955195427, 0.005996758118271828, 0.009352276101708412, -0.0047935969196259975, 0.03550436347723007, 0.002190451603382826, -0.029815537855029106, 0.0073142037726938725, 0.0007499915664084256, 0.010844322852790356, 0.006882462650537491, 0.010476073250174522, 0.020177552476525307, 0.05152958258986473, 0.006958652287721634, 0.011441141366958618, -0.003171392949298024, 0.008063402026891708, -0.016901398077607155, 0.001807916210964322, -0.013396674767136574, -0.0033047248143702745, -0.005955488886684179, -0.004552329890429974, 0.027250487357378006, -0.03151710703969002, 0.006622148212045431, 0.016761716455221176, 0.008145940490067005, 0.03136472776532173, 0.026209229603409767, -0.015441096387803555, 0.02147277444601059, -0.004688836168497801, 0.003574563190340996, 0.024952100589871407, -0.01634267345070839, 0.010952258482575417, 0.017802974209189415, -0.01814582757651806, 0.02173943817615509, 0.0065078637562692165, 0.01098400354385376, 0.005260258447378874, -0.014323648996651173, -0.009237991645932198, 0.03565674275159836, -0.0020666434429585934, 0.020736275240778923, 0.00677452702075243, 0.0073142037726938725, 0.031212348490953445, -0.029180625453591347, -0.013142709620296955, -0.006520561873912811, -0.006466594059020281, 0.006958652287721634, -0.018514078110456467, -0.03822179511189461, -0.01714266464114189, -0.029358401894569397, 0.005225338041782379, 0.019047405570745468, 0.019199784845113754, -0.0008190384251065552, -0.020241042599081993, -0.01867915503680706, -0.0008761806529946625, 0.0029459986835718155, -0.00859672948718071, 0.021841024979948997, 0.014971260912716389, 0.019999776035547256, 0.01655854471027851, -0.015047450549900532, 0.004584075417369604, -0.032202813774347305, 0.006691988557577133, 0.02872348763048649, -0.02867269515991211, -0.013180804438889027, -0.03357422724366188, 0.0016999809304252267, -0.0019809301011264324, 0.014412537217140198, -0.006660242564976215, 0.03314248472452164, 0.0038761470932513475, -0.0008753869915381074]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"� r, it follows from Lemma 2:
J(π)−J(ˆπ)
=Ex∼d0h
Eπ[r∗(x, a)−ˆr(x, a)] +Eˆπ[ˆr(x, a)−r∗(x, a)]−ηDKL(π(·|x)∥ˆπ(·|x))i
=Ex∼d0,a∼π(·|x)
⟨θ∗−θMLE, ϕ(x, a)−ν⟩+β∥ϕ(x, a)−ν∥Σ−1
off
+Ex∼d0,a∼ˆπ(·|x)
⟨θMLE−θ∗, ϕ(x, a)−ν⟩ −β∥ϕ(x, a)−ν∥Σ−1
off
−ηEx∼d0
DKL(π(·|x)∥ˆπ(·|x))
≤2βEx∼d0,a∼π(·|x)∥ϕ(x, a)−ν∥Σ−1
off−ηEx∼d0
DKL(π(·|x)∥ˆπ(·|x))
,
where we use Cauchy-Schwarz inequality in the last inequality.
C.2 Proof of the Direct Preference Learning with Pessimism
In this subsection, we prove the Proposition 1 that combines the direct preference learning with the pes-
simism. The technique is similar to the (Rafailov et al., 2023) with additional consideration of the uncertainty
bonus.
39
Proof of Proposition 1. For notation simplicity, we denote the uncertainty bonus as Γ( x, a). We first recall
that in Algorithm 1, we optimize the following KL-regularized target:
ˆπ= argmax
πEx∼d0,a∼π(·|x)
rMLE(x, a)−Γ(x, a)−ηlogπ(a|x)
π0(a|x)
, (21)
where rMLEis the MLE of the BT model on the offline preference dataset Dobtained via
rMLE= argmax
rX
(x,aw,al)∈Dofflogσ 
r(x, aw)−r(x, al)
. (22)
According to Lemma 11, for any fixed r, we have the following closed-form policy for Equation (21):
eπr(a|x) =1
Z(x)π0(a|x) exp(1
η(r(x, a)−Γ(x, a))). (23)
We can solve the reward as
r(x, a) = Γ( x, a) +ηlogeπr(a|x)
π0(a|x)+ηlogZ(x). (24)
We can plug Equation (24) into Equation (22) to get
ˆπ= argmax
eπrX
(x,aw,al)∈Dofflogσ
ηlogπr(aw|x)
π0(aw|x)−ηlogπr(al|x)
π0(al|x)+ (Γ( x, aw)−Γ(x, al))| {z }
m(x,aw,al)
, (25)
where the uncertainty serves as an adaptive margin.
Clearly, if ris the solution of Equation (22), the πris the solution of Equation (25). In contrast, if πis
optimal for the DPO target in Equation (25), then, the induced implicit reward βlogπ(y|x)
π0(y|x)−Γ(x, a) is
optimal for Equation (22).
D Proof of the Hybrid Learning
D.1 More Discussions on α(mT,Doff)
To better elaborate the quantify α(mT,Doff) in Assumption 2, we provide the following proposition.
Proposition 2. Under Assumption 1, assuming that there exists absolute constants c†andα‡such that
(mT)α‡/noff= 1,Σoff⪰B2I+c†·noff·(Ex∼d0z)(Ex∼d0z)⊤,
where z=ϕ(x, π∗)−ϕ(x, πref). Then, we have α(mT,Doff) = 1−α‡
2+1
2 log( mT)log
d
c†C2cov","[0.025453755632042885, -0.009559642523527145, 0.0029853766318410635, 0.004303448833525181, 0.022621270269155502, 0.022466769441962242, 0.02586575411260128, 0.05695873498916626, -0.02586575411260128, 0.03792957216501236, 0.03980931267142296, -0.02711462415754795, -0.01565592736005783, -0.018166540190577507, 0.03316584601998329, 0.006469657178968191, 0.04737978056073189, -0.017123669385910034, 0.017097920179367065, 0.043208297342061996, -0.02555675618350506, -0.02817036770284176, 0.029689611867070198, 0.02584000490605831, -0.0011965647572651505, -0.014033684507012367, 0.014072309248149395, -0.006965342443436384, 0.04011831432580948, -0.031260352581739426, 0.029560862109065056, -0.036822326481342316, -0.012688253074884415, -0.04637553170323372, 0.021565524861216545, 0.05083026364445686, 0.0168661717325449, 0.05912172421813011, -0.03517433628439903, -0.017793167382478714, -0.014587306417524815, -0.03355209156870842, -0.08765259385108948, 0.01601642556488514, -0.02817036770284176, 0.04449579119682312, 0.0156816765666008, 0.008877270855009556, 0.04024706035852432, 0.006611281540244818, -0.06504419445991516, 0.016042174771428108, 0.0013904934749007225, 0.000989760970696807, -0.001292322063818574, -0.019312409684062004, 0.03620433062314987, 0.00257176929153502, 0.04470179229974747, -0.010448013432323933, 0.025003133341670036, 0.006402063649147749, 0.024063263088464737, 0.010538138449192047, 0.011426509357988834, -0.019248034805059433, -0.07225416600704193, 0.05963672325015068, -0.04150880500674248, 0.01729104481637478, 0.019042035564780235, -0.0009696439374238253, 0.06030621752142906, 0.006913842633366585, -0.0333203449845314, 0.020072031766176224, 0.0660741925239563, 0.041019558906555176, 0.015694551169872284, -0.0351228341460228, 0.007280778605490923, -0.011555258184671402, 0.030281858518719673, -0.043053798377513885, 0.008452397771179676, -0.08167862147092819, -0.05912172421813011, -0.012012318708002567, -0.05999721959233284, -0.005864534992724657, 0.0012062209425494075, -0.01747129298746586, -0.00847814790904522, 0.016338298097252846, 0.044392794370651245, -0.005748660769313574, -0.010576763190329075, -0.009765641763806343, 0.0009398706024512649, -0.009405143558979034, -0.012540191411972046, -0.06020322069525719, 0.021720023825764656, -0.014226808212697506, 0.041895054280757904, -0.0337323434650898, -0.004908571019768715, 0.014265432953834534, -0.0035663582384586334, -0.0018362882547080517, -0.044907789677381516, -0.007602652069181204, -0.02528638206422329, 0.061284713447093964, 0.0048828208819031715, -0.029792610555887222, -0.08389310538768768, 0.0266253761947155, -0.018977660685777664, -0.021539773792028427, -0.05901872366666794, -0.02251826971769333, 0.027861369773745537, 0.013467187061905861, 0.02303326688706875, -0.004950414411723614, -0.009598267264664173, -0.06576519459486008, -0.0254408810287714, -0.00023315711587201804, 0.010306389071047306, 0.016698796302080154, -0.006505063269287348, -0.024050388485193253, -0.021024776622653008, 0.02501600794494152, 0.02108915150165558, 0.038496069610118866, 0.04024706035852432, -0.027423622086644173, -0.010557450354099274, -0.042075302451848984, -0.03432459011673927, 0.0022418489679694176, -0.05953372269868851, 0.00461244722828269, -0.007493215147405863, 0.0008425038540735841, -0.011439383961260319, 0.01695629581809044, -0.009784954600036144, -0.017278170213103294, -0.03133760392665863, -0.016338298097252846, -0.022029021754860878, -0.045422788709402084, -0.018771661445498466, 0.031595103442668915, 0.02282726764678955, -0.005693942308425903, -0.02510613203048706, 0.04040156304836273, 0.015218178741633892, -0.02130802534520626, 0.03265084698796272, 0.0361785814166069, -0.03780082240700722, 0.028350617736577988, -0.05644373595714569, -0.03826432302594185, -0.003936512861400843, 0.00694603007286787, -0.026393625885248184, -0.021050525829195976, 0.009797829203307629, -0.022621270269155502, 0.0014476260403171182, -0.04282205179333687, 0.009418018162250519, -0.0020648185163736343, 0.02441088669002056, 0.020561279729008675, 0.050624262541532516, 0.008046837523579597, 0.006405282765626907, -0.008774271234869957, -0.0282991174608469, -0.005597379989922047, -0.0016117815393954515, 0.03726007416844368, 0.03638457879424095, 0.013531561940908432, 0.03620433062314987, -0.04449579119682312, -0.019312409684062004, -0.027397872880101204, 0.047585777938365936, 0.08615909516811371, -0.021475398913025856, 0.01441993284970522, 0.036642078310251236, 0.010995198972523212, 0.028067369014024734, -0.06458070129156113, 0.03190410137176514, 0.015295428223907948, 0.00990726612508297, -0.0031012510880827904, -0.03592108190059662, -0.0008642303291708231, 0.023380890488624573, 0.016209550201892853, 0.0399380624294281, 0.014664556831121445, -0.019106410443782806, 0.012546628713607788, -0.02644512616097927, 0.0033442657440900803, -0.014728930778801441, 0.03164660185575485, -0.010853574611246586, 0.002175864763557911, 0.01704641990363598, -0.004383916966617107, -0.0266253761947155, 0.000998612493276596, 0.04024706035852432, -0.03550908342003822, 0.01923516020178795, -0.038187071681022644, 0.04689053073525429, 0.006746468599885702, -0.010615387931466103, -0.0026490187738090754, 0.03321734443306923, -0.012623878195881844, -0.0026731593534350395, -0.02492588385939598, 0.010480200871825218, -0.04882177338004112, 0.0059385658241808414, 0.04766302555799484, -0.001657648477703333, -0.032934095710515976, -0.011658257804811, 0.03267659619450569, -0.019582783803343773, 0.0016359220026060939, -0.034453339874744415, -0.016711672767996788, -0.0004453924484550953, 0.001956990920007229, -0.011072448454797268, -0.02428213693201542, -0.06895817816257477, 0.004284136462956667, 0.013235438615083694, 0.017033545300364494, -0.012244068086147308, 0.027037372812628746, -0.02142390049993992, 0.005751879420131445, 0.01277837809175253, 0.011387884616851807, 0.013035876676440239, 0.009405143558979034, 0.0073129660449922085, 0.023149142041802406, 0.0011337994365021586, 0.02021365612745285, 0.019505534321069717, -0.005838785320520401, -0.027706870809197426, 0.06262370944023132, -0.015617301687598228, -0.056546736508607864, 0.0007660589180886745, 0.04732827842235565, -0.034813836216926575, 0.007267903536558151, -0.04163755476474762, -0.001535336603410542, 0.07647714018821716, 0.0020294124260544777, 0.060615215450525284, -0.024578260257840157, 0.012617440894246101, -0.009334331378340721, -0.01702067069709301, -0.022080522030591965, 0.009746329858899117, -0.057525232434272766, 0.04174055531620979, -0.03164660185575485, 0.02559537999331951, 0.005961097311228514, -0.006189627572894096, -0.05819472670555115, -0.007139154244214296, 0.036487579345703125, 0.03888231888413429, 4.091313894605264e-05, -0.02173289842903614, 0.009244207292795181, -0.0007314575486816466, 0.006978217512369156, 0.011420072056353092, 0.007113404106348753, -0.011754820123314857, -0.009160519577562809, -0.01608080044388771, 0.006215377245098352, -0.020509779453277588, 0.05304475128650665, -0.013969309628009796, 0.01720091886818409, 0.03290834650397301, -0.02063852921128273, -0.019492659717798233, -0.01201875600963831, -0.010177640244364738, -0.04653003439307213, -0.030384857207536697, -0.025054633617401123, 0.0018588193925097585, -0.01799916662275791, -0.023599764332175255, -0.03576658293604851, -0.0017091482877731323, -0.040015313774347305, -0.010023140348494053, 0.01802491582930088, 0.023792888969182968, -0.006978217512369156, -0.0010814949637278914, -0.02930336259305477, -0.021694274619221687, 0.06499269604682922, 0.01927378587424755, -0.0087807085365057, -0.05294175446033478, 0.023483891040086746, -0.022544018924236298, 0.0011474790517240763, 0.011072448454797268, -0.007873025722801685, 0.04781752824783325, 0.030050110071897507, 0.06854618340730667, 0.06442619860172272, -0.01847553811967373, -0.02117927558720112, 0.0513710118830204, 0.015037929639220238, -0.02644512616097927, -0.002043896820396185, -0.016879046335816383, -0.04550003632903099, -0.031595103442668915, -0.011523070745170116, -0.019170785322785378, -0.005636004731059074, -0.00022772549709770828, -0.00025769995409063995, -0.0023174891248345375, 0.019531283527612686, -0.002418879419565201, -0.005233663134276867, -0.015849050134420395, -0.01999478228390217, -0.019685782492160797, 0.0717906653881073, -0.03239334747195244, 0.00795027520507574, -0.033809591084718704, -0.018153665587306023, 0.007609089370816946, -0.00461244722828269, 0.05211775749921799, -0.008729209192097187, 0.004783040378242731, -0.021874522790312767, -0.032264597713947296, -0.02027803100645542, 0.007383778225630522, 0.011754820123314857, -0.011156135238707066, -0.05778273195028305, -0.02546663023531437, -0.017497044056653976, 0.02179727330803871, -0.04920801892876625, 0.001950553385540843, 0.004213324282318354, -0.07096666842699051, 0.00981714203953743, -0.03216160088777542, 0.05809172987937927, 0.02644512616097927, 0.047946274280548096, -0.05716473236680031, -0.01340281218290329, -0.06190270930528641, -0.008793584071099758, -0.027758371084928513, -0.014613056555390358, 0.0034440464805811644, 0.044418543577194214, -0.0015586724039167166, 0.0361013300716877, 0.043053798377513885, -0.039191316813230515, 0.009360081516206264, -0.030230358242988586, -0.011181885376572609, 0.0020310217514634132, -0.0008585975738242269, 0.024398010224103928, 0.08003062754869461, 0.03929431736469269, -0.015346928499639034, -0.02340664155781269, 0.026496626436710358, -0.04838402569293976, -0.02981836162507534, 0.027912870049476624, 0.018707288429141045, 0.024874383583664894, 0.04150880500674248, -0.056031737476587296, -0.036976829171180725, 0.04045306146144867, 0.019750157371163368, 0.019891781732439995, -0.07127566635608673, 0.032573599368333817, 0.0029660642612725496, -0.02917461283504963, -0.023548265919089317, -0.032084349542856216, 0.029226113110780716, -0.022801518440246582, -0.028736865147948265, -0.010312827304005623, -0.016286799684166908, 0.023844389244914055, -0.02799011953175068, -0.007190654054284096, 0.014432807452976704, -0.00471866549924016, -0.05000626668334007, 0.01570742577314377, 0.03455634042620659, 0.00265223765745759, -0.013583061285316944, -0.027037372812628746, 0.060924217104911804, 0.02635500207543373, 0.014844805933535099, 0.010467326268553734, 0.023548265919089317, -0.019093535840511322, -0.02517050690948963, -0.030719606205821037, 0.020381029695272446, 0.0256855059415102, -0.0036629203241318464, 0.009887954220175743, -0.04251305013895035, 0.025968752801418304, -0.008658397011458874, -0.05103626102209091, -0.0003643205564003438, -0.043053798377513885, -0.026831375434994698, -0.0012359942775219679, 0.024307886138558388, -0.0156816765666008, 0.04992901533842087, -0.01048663817346096, 0.03066810593008995, -0.009282832033932209, -0.012025194242596626, 0.014046559110283852, 0.014510056935250759, 0.06339620053768158, 0.059894219040870667, -0.00048079853877425194, -0.01150375884026289, -0.013364187441766262, 0.022106271237134933, -0.06494119763374329, 0.035277336835861206, -0.013930684886872768, -0.008793584071099758, -0.013171063736081123, 0.02631637640297413, -0.015694551169872284, 0.008059712126851082, -0.027372121810913086, 0.05968822166323662, -0.011986568570137024, -0.0022643799893558025, 0.03671932965517044, 0.000605524517595768, 0.004152168054133654, 0.013505811803042889, -0.053508251905441284, -0.02550525590777397, 0.01838541403412819, -0.019711533561348915, 0.0060254717245697975, -0.019801657646894455, 0.02479713410139084, -0.011980131268501282, 0.010744137689471245, -0.048100776970386505, -0.026548126712441444, -0.03424733877182007, 0.02240239456295967, -0.020419655367732048, -0.020844528451561928, -0.03522583469748497, 0.012894252315163612, 0.012997251935303211, -0.0006799577386118472, -0.03844457119703293, -0.0936780646443367, -0.03388684242963791, -0.014664556831121445, 0.03762057423591614, 0.005980409681797028, 0.02537650614976883, -0.009990952908992767, 0.01644129864871502, 0.010525262914597988, -0.010731262154877186, -0.010512388311326504, 0.015630176290869713, -0.01741979457437992, 0.031054355204105377, -0.025479506701231003, -0.009913703426718712, 0.0016238518292084336, -0.0010187296429648995, -0.04665878042578697, 0.03859907016158104, -0.0004783844924531877, -0.013480061665177345, 0.01617092452943325, -0.013982185162603855, -0.010512388311326504, -0.022994643077254295, 0.0027166123036295176, -0.027500871568918228, -0.0025975191965699196, -0.009752767160534859, 0.0013269234914332628, 0.033449094742536545, -0.015797551721334457, -0.01255306601524353, -0.0006220205104909837, -0.021295150741934776, 0.020445404574275017, -0.01457443181425333, 0.04192080348730087, 0.021411025896668434, -0.011793444864451885, 0.007506089750677347, 0.0480235256254673, -0.04179205372929573, 0.034813836216926575, -0.011600321158766747, -0.0034537026658654213, 0.03785232454538345, -0.006501844618469477, 0.026908624917268753, 0.01103382371366024, 0.0053141312673687935, -0.016518548130989075, -0.020677153021097183, -0.01693054661154747, -0.009321456775069237, -0.03084835596382618, -0.0033796716015785933, 0.021745773032307625, -0.0020615996327251196, -0.021076276898384094, -0.04336279630661011, -0.013673186302185059, 0.013840560801327229, -0.04297655075788498, -0.022891642525792122, -0.008890146389603615, -0.015359803102910519, 0.01677604578435421, -0.004844196140766144, 0.013904934749007225, 0.024114761501550674, -0.03620433062314987, 0.05453824624419212, -0.006311939097940922, 0.013415687717497349, -0.03468508645892143, -0.024964507669210434, 0.06638319045305252, -0.03774932399392128, -0.02249252051115036, 0.01966003328561783, -0.004258386325091124, -0.014188183471560478, -0.01054457575082779, 0.027835620567202568, -0.017818916589021683, -0.035148587077856064, -0.03033335879445076, -0.0010541357332840562, 0.0004904547240585089, 0.07410815358161926, -0.02437226101756096, -0.004573822487145662, -0.03298559412360191, 0.0342215895652771, 0.00837514828890562, -0.024307886138558388, 0.015269679017364979, 0.012044506147503853, -0.037311576306819916, 0.057731229811906815, -0.04117405787110329, -0.03146635368466377, -0.01657004840672016, 0.008703459054231644, 0.00833008624613285, 0.003936512861400843, -0.021192150190472603, 0.012971501797437668, -0.008304336108267307, -0.006836593151092529, -0.05304475128650665, -0.0009028551867231727, 0.017097920179367065, 0.00040274421917274594, -0.012276255525648594, 0.010293514467775822, 0.006855905521661043, -0.0045577287673950195, 0.017007796093821526, -0.038161322474479675, -0.04737978056073189, -0.02814461849629879, -0.004348510876297951, 0.021411025896668434, -0.002518660156056285, 0.03308859467506409, 0.027732620015740395, 0.01753566786646843, -0.0074224029667675495, -0.019891781732439995, -0.021810147911310196, -0.023226391524076462, -0.012160380370914936, 0.015295428223907948, -0.004886039532721043, 0.0030787200666964054, 0.051293760538101196, -0.007222841493785381, 0.05886422470211983, 0.009752767160534859, 0.009984515607357025, -0.00194733461830765, 0.006920280400663614, 0.029071614146232605, 0.007300090976059437, -0.0038528258446604013, -0.052993252873420715, -0.008130524307489395, -0.0351228341460228, -0.027938619256019592, -0.003485889872536063, -0.028350617736577988, -0.01159388292580843, -0.03414434194564819, -0.005446099676191807, -0.00599650340154767, -0.011091760359704494, 0.0313633531332016, -0.008677709847688675, -0.0194797832518816, -0.02146252430975437, -0.01693054661154747, -0.0037433886900544167, 0.05716473236680031, -0.03777507320046425, -0.006067315582185984, 0.014793305657804012, 0.02039390429854393, 0.04395504295825958, -0.011020948179066181, -0.06617718935012817, -0.03476233780384064, 0.019505534321069717, -0.03100285492837429, 0.02416626177728176, -0.049465518444776535, -0.04199805483222008, -0.01614517532289028, 0.04241005331277847, 0.04835827276110649, -0.04462454095482826, -0.0026763782370835543, -0.035792332142591476, -0.029612362384796143, 0.011297759599983692, 0.029535112902522087, -0.008651959709823132, 0.010795637033879757, 0.03589533269405365, 0.0068430304527282715, -0.005764754489064217, -0.027603870257735252, -0.022080522030591965, -0.0282991174608469, 0.010673325508832932, 0.00572934839874506, 0.0007266293978318572, -0.028427867218852043, 0.012263379991054535, -0.0005081577692180872, -0.010435138829052448, -0.001744554378092289, 0.00805327482521534, -0.0073387157171964645, 0.0024011763744056225, -0.023998888209462166, 0.019415410235524178, 0.0016528203850612044, 0.024513885378837585, -0.010087515227496624, -0.018321039155125618, 0.006431032437831163, -0.006563000380992889, -0.017793167382478714, 0.009533893316984177, 0.011819195002317429, 0.013061626814305782, 0.005822691600769758, 0.02559537999331951, -0.009121894836425781, 0.05355975031852722, -0.009720579721033573, 0.01006176508963108, -0.0313633531332016, -0.01735541969537735, 0.0187845379114151, -0.013087376020848751, 0.016222424805164337, -0.012939314357936382, -0.02912311442196369, 0.014896305277943611, 0.017303919419646263, -0.013518686406314373, -0.024513885378837585, 0.04055606201291084, -0.01408518385142088, -0.02711462415754795, -0.026522375643253326, -0.03442759066820145, 0.051345258951187134, -0.009353644214570522, -0.011214072816073895, 0.01599067449569702, -0.007847275584936142, -0.0015337271615862846, 0.03607558086514473, 0.002924220636487007, -0.004197230562567711, -0.049130771309137344, 0.0017928354209288955, -0.023316515609622, -0.003160797758027911, -0.018501289188861847, -0.0009205581736750901, -0.03187835216522217, -0.006237908266484737, -0.005053414031863213, -0.0017735229339450598, -0.012701128609478474, -0.0010541357332840562, -0.025234881788492203, -0.005111351143568754, -0.0206642784178257, -0.008471710607409477, -0.0069524673745036125, -0.006205720826983452, 0.03388684242963791, -0.012115318328142166, -0.10763449966907501, -0.02385726384818554, -0.001754210563376546, -0.01744554378092289, 0.01890041120350361, -0.008394461125135422, 0.042899299412965775, 0.00534953735768795, -0.020947527140378952, -0.044058043509721756, 0.012179693207144737, -0.00518860062584281, 0.0285051167011261, 5.4567615734413266e-05, -0.0185399129986763, -0.03468508645892143, -0.0175614170730114, -0.003099641762673855, 0.016312548890709877, -0.002272426849231124, -0.02121790125966072, -0.011787007562816143, -0.007564027328044176, 0.027912870049476624, -0.043079547584056854, -0.013261187821626663, 0.022685643285512924, -0.024295011535286903, -0.0012818612158298492, -0.004696134477853775, 0.008014650084078312, -0.009752767160534859, 0.005790504161268473, 0.009025332517921925, -0.04833252355456352, -0.01382768526673317, 0.007087654434144497, -0.018218040466308594, -0.017831791192293167, 0.03267659619450569, 0.027063123881816864, -0.01704641990363598, 0.057370733469724655, -0.003089985577389598, 0.0025106132961809635, -0.04094230756163597, 0.012160380370914936, -0.017252419143915176, 0.01542417798191309, -0.025479506701231003, 0.012347067706286907, -0.009662642143666744, 0.005961097311228514, -0.04243580251932144, 4.4609656470129266e-05, -0.0022708175238221884, 0.013879185542464256, 0.03118310496211052, 0.007699213922023773, -0.00997164100408554, -0.043749045580625534, 0.019595658406615257, 0.029586611315608025, 0.005214350763708353, -0.05556824058294296, 0.013338437303900719, 0.0034215152263641357, 0.014046559110283852, -0.03473658859729767, -0.00518860062584281, -0.02461688593029976, -0.001136213424615562, -0.006868780590593815, -0.0024414104409515858, -0.0414058081805706, -0.01086644921451807, -0.011426509357988834, 0.002325535984709859, -0.05901872366666794, 0.037826571613550186, 0.05160275846719742, -0.009585392661392689, 0.024655509740114212, 0.031955599784851074, -0.014522932469844818, 0.03285684809088707, -0.014986430294811726, -0.04194655269384384, -0.02222214639186859, 0.011935069225728512, 0.035637833178043365, -0.022569769993424416, 0.00017250407836399972, -0.025646880269050598, 0.011510196141898632, -0.022775769233703613, -0.03432459011673927, 0.013196812942624092, 0.02677987515926361, -0.012965064495801926, 0.03522583469748497, 0.05157700926065445, 0.001532117836177349, -0.00572934839874506, 0.011986568570137024, -0.0225826445966959, -0.02255689539015293, -0.0024333635810762644, 0.04792052507400513, -0.01399505976587534, -0.002322317333891988, -0.002459113486111164, -0.0147418063133955, 0.02613612823188305, 0.003353921929374337, 0.011471571400761604, 0.035200085490942, 0.0025041757617145777, 0.01610654965043068, -0.0018185852095484734, 0.013132438994944096, 0.04799777641892433, -0.0318526029586792, 0.014188183471560478, 0.011471571400761604, -0.018527038395404816, -0.0019859594758599997, 0.01711079478263855, -0.016788922250270844, 0.02620050311088562, 0.003209078684449196, 0.02410188689827919, 0.025234881788492203, 0.006353782955557108, 0.025273507460951805, 0.027758371084928513, 0.010718387551605701, 0.0017638667486608028, -0.02155265025794506, 0.018153665587306023, 0.0062411269173026085, 0.009302143938839436, -0.014007934369146824, 0.014806181192398071, -0.015321178361773491, 0.03097710572183132, 0.014651681296527386, -0.017252419143915176, 0.003675795393064618, 0.03146635368466377, 0.023110516369342804, -0.024874383583664894, 0.02242814563214779, -0.02711462415754795, 0.0063022831454873085, -0.000945503416005522, 0.011729069985449314, -0.030384857207536697, -0.003030438907444477, 0.00811764970421791, 0.018243789672851562, 0.018076416105031967, 0.018037790432572365, -0.013492937199771404, 0.044598791748285294, -0.013776185922324657, -0.034633588045835495, -0.023960262537002563, -0.0003985196235589683, -7.855724834371358e-05, 0.006488969549536705, -0.04622103273868561, 0.017909040674567223, 0.03787807375192642, 0.0004256776883266866, 0.012514441274106503, -0.0032074693590402603, 0.04722527787089348, -0.013068064115941525, 0.012514441274106503, 0.031080104410648346, 0.027217622846364975, -0.03301134705543518, -0.017123669385910034, 0.06205721199512482, -0.02626487798988819, 0.015475677326321602, 0.00151039136108011, 0.014432807452976704, 0.023136267438530922, 0.04789477586746216, 0.002090568421408534, -0.01525680348277092, 0.020432529971003532, 0.02117927558720112, 0.013222563080489635, -0.03015310876071453, 0.04225555434823036, 0.005327006336301565, -0.06643468886613846, -0.04550003632903099, 0.007757151499390602, 0.02307189255952835, -0.014664556831121445, -0.025209132581949234, 0.005452536977827549, 0.01659579761326313, -0.029535112902522087, 0.003411859041079879, 0.005021226592361927, 0.0127204405143857, 0.011194759979844093, -0.030642356723546982, 0.003666139207780361, -0.013583061285316944, 0.002921001985669136, 0.005281944293528795, 0.03169810026884079, -0.009765641763806343, -0.007473902776837349, 0.006035128142684698, -0.012488692067563534, 0.0490020215511322, 0.04215255379676819, -0.021205026656389236, -0.021372400224208832, 0.04344004765152931, -0.007003967184573412, 0.009688392281532288, -0.0026039564982056618, -0.04959426820278168, 0.05072726309299469, -0.018076416105031967, -0.008600459434092045, -0.002581425476819277, -0.028196118772029877, -0.030256109312176704, 0.005861316341906786, 0.00831077340990305, -0.0071198418736457825, 0.038006823509931564, 0.0007230083574540913, -0.00010194336937274784, -0.005764754489064217, 0.024694135412573814, 0.014007934369146824, 0.010370763950049877, 0.0731811597943306, -0.03792957216501236, -0.017909040674567223, -0.023020392283797264, 0.030256109312176704, 0.020844528451561928, -0.004152168054133654, 0.008594022132456303, 0.022325145080685616, 0.009559642523527145, 0.015179554000496864, 0.023419516161084175, 0.010795637033879757, -0.019080661237239838, -0.0013687669998034835, -0.010312827304005623, -0.046427033841609955, -0.009488830342888832, -0.017818916589021683, 0.016814671456813812, 0.010576763190329075, 0.02166852355003357, 0.012115318328142166, -0.021436775103211403, 0.02622625231742859, -0.02881411463022232, 0.014819055795669556, 0.023715639486908913, -0.00127300969325006, 0.03483958914875984, -0.016982045024633408, 0.004168261773884296, 0.005298037547618151, -0.019003411754965782, -0.034607838839292526, -0.015012179501354694, -0.012430754490196705, 0.021810147911310196, -0.011709758080542088, 0.03084835596382618, -0.0007873830618336797, -0.0034762336872518063, 0.029560862109065056, 0.02780986949801445, 0.031929850578308105, -0.02407613769173622, 0.013544436544179916, 0.012829877436161041, -0.05448674410581589, -0.03754332289099693, 0.02847936749458313, -0.0313633531332016, -0.003714420134201646, 0.011741945520043373, 0.03100285492837429, -0.0010694246739149094, -0.004528759978711605, 0.05222075432538986, 0.009495268575847149, 0.02224789559841156, -0.002668331377208233, -0.029020113870501518, -0.03723432496190071, 0.004818446468561888, -0.007184216286987066, -0.0032380474731326103, -0.0034376089461147785, 0.001734898192808032, 0.0017493824707344174, -0.02665112540125847, 0.013467187061905861, -0.012836314737796783, -0.00048039620742201805, -0.01653142273426056, -0.003971918951719999, 0.0029322674963623285, 0.006534032057970762, -0.014883430674672127, -0.01256594154983759, -0.015565802343189716, 0.008426648564636707, -0.01086644921451807, 0.0007298481650650501, -0.027578121051192284, 0.02282726764678955, 0.022724268957972527, -0.013428562320768833, -0.026702625676989555, 0.004606009926646948, -0.04882177338004112, 0.002282083034515381, -0.01570742577314377, -0.008246398530900478, 0.024758510291576385, 0.02340664155781269, 0.027217622846364975, -0.016518548130989075, -0.035637833178043365, 0.02744937129318714, 0.012701128609478474, -0.016737421974539757, -0.01483193039894104, -0.014110933989286423, 0.08487160503864288, -0.022080522030591965, -0.020767277106642723, 0.008973833173513412, -0.005771191790699959, 0.03908831626176834, -0.025067508220672607, -0.011098198592662811, -0.030436357483267784, 0.0048699458129704, -0.0077700261026620865, 0.023046141490340233, 0.005014789290726185, -0.0021645992528647184, 0.006128471344709396, -0.005813035182654858, -0.02099902741611004, 0.013454312458634377, 0.01981453225016594, 0.010177640244364738, 0.006183189805597067, 0.006044784095138311, -0.03726007416844368, 0.018797412514686584, 0.012012318708002567, 0.007087654434144497, -0.01209600642323494, -0.00858758483082056, -0.022453894838690758, 0.022389519959688187, 0.008323648944497108, -0.02048403024673462, -0.030719606205821037, 0.019531283527612686, -0.01817941479384899, -0.0175614170730114, -0.016853297129273415, 0.028402118012309074, 0.00046430251677520573, -0.024784259498119354, -0.012817002832889557, -0.012520878575742245, -0.019338158890604973, 0.006170314736664295, 0.009289269335567951, 0.013010126538574696, -0.019775908440351486, -0.008413773030042648, 0.0013872748240828514, 0.037646323442459106, 0.019647158682346344, 0.011072448454797268, 0.006292626727372408, -0.028041619807481766, -0.007834400981664658, -0.014625932089984417, -0.024063263088464737, 0.015192428603768349, -0.0042776986956596375, 0.030590856447815895, -0.023110516369342804, 0.017213795334100723, -0.007847275584936142, -0.0019038817845284939, 0.031440604478120804, -0.021501149982213974, 0.003136657178401947, 0.018501289188861847, -0.013969309628009796, 0.03141485154628754, -0.042023804038763046, -0.010454450733959675, -0.013274063356220722, -0.035277336835861206, 0.004480479285120964, 0.001744554378092289, -0.0282991174608469, -0.007911650463938713, 0.007551152259111404, 0.024320760741829872, -0.03435033932328224, 0.01570742577314377, 0.0033346093259751797, -0.0035373896826058626, -0.0166601724922657, -0.024269262328743935, 0.0010404561180621386, -0.004808790050446987, -0.03641033172607422, 0.03100285492837429, -0.010615387931466103, 0.008136961609125137, 0.023380890488624573, -0.01893903687596321, -0.0030191733967512846, -0.021385274827480316, 0.023329390212893486, 0.012437191791832447, -0.01244362909346819, 0.032934095710515976, -0.015205304138362408, 0.002665112493559718, 0.03705407679080963, 0.015398427844047546, -0.0006143760401755571, 0.014587306417524815, -0.03980931267142296, -0.02535075694322586, 0.006991092581301928, 0.004422541707754135, -0.020767277106642723, -0.01847553811967373, 0.004940757993608713, -0.014754680916666985, -0.006550125777721405, -0.003049751278012991, 0.017484167590737343, 0.0282991174608469, 0.008774271234869957, 0.002986985957249999, 0.012347067706286907, 0.003608201863244176, -0.004715446848422289, 0.008742083795368671, 0.0037787947803735733, 0.023870138451457024, -0.0038689193315804005, 0.02316201664507389, -0.026419376954436302, 0.015668801963329315, -0.01276550255715847, 0.009810703806579113, 0.02005915716290474, -0.0026023471727967262, 0.010370763950049877, 0.03504558652639389, -0.00482488377019763, -0.031208854168653488, -0.03154360130429268, 0.0035534834023565054, 0.014780431054532528, -0.0062411269173026085, 0.0009374565561302006, 0.03790382295846939, 0.0008384804823435843, -0.018861787393689156, 0.0014250949025154114, -0.030771106481552124, 0.02589150331914425, 0.025273507460951805, -0.000705305312294513, 0.017600042745471, -0.01956990920007229, 0.032110098749399185, 0.007454590406268835, -0.0041940114460885525, 0.016518548130989075, -0.004969726782292128, 0.018063541501760483, 0.013274063356220722, 0.0565982349216938, -0.004007325042039156, 0.017303919419646263, 0.02309764176607132, 0.03002435900270939, 0.005323787685483694, -0.014072309248149395, -0.012302004732191563, 0.006791530642658472, -0.015874801203608513, -0.004647853318601847, 0.01610654965043068, 0.036461830139160156, -0.026277752593159676, -0.024423761293292046, 0.010879323817789555, -0.00492466427385807, -0.015128054656088352, -0.01483193039894104, 0.02340664155781269, -0.007345153018832207, -0.018771661445498466, 0.03435033932328224, 0.0147418063133955, 0.003804544685408473, 8.876667561708018e-05, 0.0004936734912917018, 0.0059385658241808414, 0.014510056935250759, 0.007351590786129236, 0.017677292227745056, -0.002933876821771264, 0.06236620992422104, 0.020870277658104897, 0.03607558086514473, 0.039165567606687546, 0.030565107241272926, -0.022621270269155502, 0.029741110280156136, 0.02224789559841156, 0.003315296955406666, -0.012701128609478474, -0.00017099529213737696, 0.004322761204093695, -0.020226530730724335, 0.03069385699927807, 0.024179136380553246, -0.0028904241044074297, -0.011014510877430439, 0.0019714750815182924, 0.02075440250337124, 0.0058709727600216866, 0.006311939097940922, -7.760168955428526e-05, 0.00562313012778759, 0.007409527897834778, 0.015462802723050117, -0.0058806287124753, -0.0034665775019675493, -0.0004924664390273392, -0.009186269715428352, -0.024810008704662323, 0.017432669177651405, 0.017484167590737343, -0.02647087723016739, 0.00678509334102273, 0.03960331529378891, 0.030410608276724815, 0.024604009464383125, 0.026161877438426018, 0.0018411163473501801, -0.02215777151286602, -0.008169149048626423, 0.0012118536978960037, 0.02343239076435566, -0.013917810283601284, -0.016982045024633408, -0.011600321158766747, 0.004290573764592409, 0.019415410235524178, -0.05255550518631935, 0.012437191791832447, -0.005433224607259035, -0.024269262328743935, -0.010750574991106987, 0.04601503536105156, 0.01024201512336731, 0.014020809903740883, -0.06257221102714539, 0.004548072349280119, -0.014664556831121445, 0.003881794400513172, -0.018797412514686584, -0.029947109520435333, 0.04797202721238136, -0.020741527900099754, -0.006752905901521444, -0.014728930778801441, 0.010364326648414135, 0.019067786633968353, 0.0071455915458500385, 0.003392546670511365, 0.01632542349398136, 0.013879185542464256, -0.028427867218852043, 0.020419655367732048, -0.010538138449192047, -0.012900689616799355, -0.016737421974539757, -0.030256109312176704, -0.009044645354151726, 0.015102304518222809, 0.0047476342879235744, -0.024423761293292046, -0.01738116890192032, 0.03859907016158104, 0.009656204842031002, -0.007287215907126665, -0.002589472336694598, -0.021990397945046425, 0.023574015125632286, -0.018230915069580078, -0.013338437303900719, 0.014213933609426022, 0.020252279937267303, 0.011555258184671402, -0.02191314846277237, -0.012469379231333733, -0.01425255835056305, 0.011600321158766747, -0.03084835596382618, -0.009939453564584255, 0.01586192660033703, -0.04158605635166168, -0.01124626025557518, -0.0006996724987402558, 0.008394461125135422, -0.020986152812838554, -0.03051360696554184, 0.012965064495801926, -0.046272534877061844, 0.005252975504845381, 0.01363456156104803, 0.01583617553114891, 0.021372400224208832, 0.017342543229460716, -0.03352634236216545, 0.022930268198251724, 0.00737090315669775, -0.0038946692366153, 0.015552927739918232, 0.004728321451693773, -0.002296567428857088, 0.06004871800541878, -0.0036114207468926907, 0.0052916002459824085, 0.011452258564531803, -0.005610255058854818, 0.009572518058121204, 0.02865961566567421, -0.030642356723546982, 0.007911650463938713, 0.0007535862969234586, -0.01608080044388771, 0.024938758462667465, 0.007924525067210197, 0.0010742527665570378, 0.024449510499835014, 0.017767416313290596, 0.013776185922324657, 0.03602408245205879, 0.005343100056052208, 0.027603870257735252, 0.01835966482758522, 0.018462663516402245, 0.04956851899623871, 3.096146429015789e-06, 0.010151890106499195, 0.006559781730175018, -0.013518686406314373, -0.008336523547768593, 0.014226808212697506, 0.00720352865755558, -0.0011337994365021586, -0.01230844296514988, -0.014819055795669556, 0.013866310007870197, 0.014110933989286423, -0.002896861406043172, 0.013222563080489635, 0.03035910800099373, 0.023110516369342804, -0.0175614170730114, -0.03535458445549011, -0.015643052756786346, -7.533851749030873e-05, 0.011368571780622005, -0.035792332142591476, -0.010634700767695904, -0.004937539342790842, -0.02881411463022232, -0.016608672216534615, 0.0034440464805811644, 0.028917115181684494, 0.00873564649373293, 0.014394182711839676, 0.011220510117709637, -0.010261327028274536, -0.00026795969461090863, -0.009540330618619919, 0.03048785775899887, 0.027732620015740395, 0.02762962132692337, 0.0025701599661260843, -0.008877270855009556, 0.01389206014573574, -0.01872016303241253, -0.01583617553114891, 0.022029021754860878, -0.011407196521759033, -0.017497044056653976, -0.040710560977458954, 0.009920140728354454, -0.008851520717144012, 0.004847414791584015, 0.014934930019080639, 0.019351035356521606, 0.01708504557609558, -0.005169288255274296]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"
.
The condition of Proposition 2 is referred to as the single-policy coverage in the literature of offline learning
(Jin et al., 2021b; Xie et al., 2021b,a), which is substantially weaker than the uniform coverage condition
considered in Xie and Jiang (2021); Yin et al. (2022); Xiong et al. (2022a), which requires Doffto well cover
the entire feature space. In this case, Proposition 2 states that α(mT,Doff) mainly depends on the ratio
between the online data size mTand the offline data size noff. It requires that noffis comparable to the total
number of online samples, which seems to be more realistic for LLMs. For instance, in LLaMA2 project, the
noff≈1.5×106, while the total number of online data is 1 .4×106. Since noffandTare of the same order,
α(mT,Doff) approximates 1 /2.
40
Proof of Proposition 2. First, we have
∥Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)]∥Σ−1
off=q
(Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)])⊤Σ−1
offEx∼d0[ϕ(x, π∗)−ϕ(x, πref))
=r
tr
Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)] (Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)])⊤Σ−1
off
,
where the last equality uses the property of trace. To facilitate our analysis, we use the notation that
Σ‡=Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)] (Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)])⊤. Together with the assumption that
Σoff⪰B2I+c†·noff·Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)] (Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)])⊤,
we further have
∥Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)]∥Σ−1
off≤r
tr
Σ‡(B2I+c†·noff·Σ‡)−1
=vuutdX
j=1λj
B2+c†·noff·λj,
where λjdenotes the j-th eigenvalue of Σ‡. It is not difficult to show that λj∈[0, B2], which further implies
that
∥Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)]∥Σ−1
off≤vuutdX
j=11
1 +c†·noff≤r
d
c†·noff.
If (mT)α‡/noff= 1, we have
(mT)1−α(T,Doff)· ∥Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)]∥(Σoff)−1≤Ccov.
with
α(mT,Doff) = 1−α‡
2+1
2 log( mT)logd
c†C2cov
,
which concludes the proof of Proposition 2.
D.2 Sequential Hybrid Setting
Theorem 5. Under Assumption 1, let λ=dlog(T/δ)/(γ2B2)andβ:=O q
dlog(T/δ)
γ2
. Under Assumption
2, with probability at least 1−2δ, the output policy of Algorithm 2 with Option II and m= 1satisfies
TX
t=1
J(π∗)−J(π1
t)
≤βTα(T,Doff)·Ccov+βp
6Tdlog(1 + T/dλ )−ηTX
t=1Ext∼d0
DKL(π1
t(·|xt)∥π∗(·|","[0.02241121418774128, -0.01635824702680111, -0.0005778540507890284, 0.013491052202880383, 0.03205163776874542, 0.015277855098247528, 0.0021590532269328833, 0.029225995764136314, -0.03532051667571068, 0.05789794400334358, 0.04814671352505684, -0.027577705681324005, -0.009418804198503494, 0.001374729909002781, -0.0029347194358706474, -0.029087483882904053, 0.04534877464175224, -0.0170646570622921, 0.025084491819143295, 0.04340960830450058, -0.02833952009677887, -0.020111918449401855, 0.01980719156563282, 0.0336860753595829, 0.024696659296751022, -0.03097124584019184, 0.034434039145708084, -0.011517258360981941, 0.034434039145708084, -0.046207547187805176, 0.048340629786252975, -0.042772453278303146, -0.013491052202880383, -0.049753449857234955, 0.020832179114222527, 0.054490555077791214, 0.025693943724036217, 0.02278519608080387, -0.00044799919123761356, 0.026012521237134933, -0.010236023925244808, -0.04379744082689285, -0.08033686131238937, -0.0071402848698198795, -0.0026421132497489452, 0.04213529825210571, 0.0045708902180194855, -0.0019028062233701348, -0.0013704013545066118, 0.01696769893169403, -0.030417198315262794, -0.014931575395166874, -0.03000166267156601, -0.0011894702911376953, -0.011115574277937412, -0.0002631724637467414, 0.025306111201643944, 0.02443348616361618, 0.058064159005880356, -0.06908970326185226, 0.030057067051529884, -0.008587733842432499, 0.01754944957792759, 0.030195578932762146, -0.03534821793437004, -0.0007739348220638931, -0.04230151325464249, 0.04554269090294838, -0.00983433984220028, 0.025943266227841377, -0.04437918961048126, -0.02062441222369671, 0.05213585123419762, 0.01405202504247427, -0.01137874647974968, 0.04171976447105408, 0.014848467893898487, 0.039088036864995956, -0.0011937988456338644, -0.028394924476742744, 0.03365837410092354, 0.00912792980670929, 0.04515485465526581, -0.03695495426654816, 0.01767410896718502, -0.07535043358802795, -0.020569005981087685, 0.008587733842432499, -0.07285722345113754, -0.000566599948797375, 0.0026230677030980587, 0.034821875393390656, -0.007569671608507633, 0.01351875439286232, 0.05111086368560791, 0.007805141620337963, 0.02430882677435875, -0.021150756627321243, -0.012874674052000046, -0.0026923236437141895, 0.0014379259664565325, -0.06504515558481216, 0.026054074987769127, -0.039780598133802414, 0.047841984778642654, -0.016330543905496597, -0.02645576000213623, 0.030167875811457634, -0.01980719156563282, 0.0005064338911324739, -0.024585850536823273, -0.012327552773058414, -0.0010301817674189806, 0.06498975306749344, 0.021150756627321243, -0.03601307421922684, -0.0564851239323616, 0.04058396443724632, -0.017937282100319862, -0.01280541904270649, -0.025680093094706535, -0.02476591430604458, 0.013920438475906849, -0.0007700392161495984, 0.02419801615178585, -0.003767521819099784, 0.0033346721902489662, -0.09003268927335739, -0.05368718504905701, 0.004421990364789963, 0.016870740801095963, 0.05268989875912666, 0.006662419065833092, -0.029696935787796974, -0.04518255963921547, 0.03407391160726547, 0.01328328438103199, 0.007195689715445042, 0.01174580305814743, -0.00414842925965786, -0.00230968464165926, -0.042994070798158646, -0.041442740708589554, 0.022452767938375473, -0.04728793725371361, 0.012417585588991642, -0.030694222077727318, 0.00476826960220933, 0.025583134964108467, 0.005273838061839342, -0.01979334093630314, -0.05490608885884285, -0.014862319454550743, 0.034434039145708084, -0.006634716410189867, -0.04969804361462593, -0.03756440803408623, 0.04473932087421417, 0.029032079502940178, 0.0030316775664687157, -0.025555431842803955, 0.05576486140489578, 0.011060169897973537, 0.017992686480283737, 0.008047536946833134, 0.04529336839914322, -0.01126793771982193, 0.0006700509693473577, -0.0481744147837162, -0.04088869318366051, 0.017023103311657906, 0.02394869551062584, -0.01541636697947979, -0.03756440803408623, -0.0050349049270153046, -0.06438029557466507, -0.021206161007285118, -0.06831403076648712, 0.00014846737030893564, -0.03257798030972481, 0.04399135708808899, 0.025306111201643944, 0.02809019945561886, -0.031165162101387978, -0.02835337072610855, -0.012161338701844215, 0.00691174017265439, -0.015928860753774643, 0.021441631019115448, 0.016635270789265633, 0.0219541247934103, 0.013761150650680065, 0.03975289314985275, -0.017355531454086304, -0.009979777038097382, -0.042883262038230896, 0.030057067051529884, 0.047980498522520065, -0.017701812088489532, 0.027369936928153038, 0.023339243605732918, 0.011053243651986122, -0.008968641050159931, -0.0264419075101614, 0.013380242511630058, 0.009785860776901245, -0.007735885679721832, 0.02145548164844513, -0.04886697232723236, -0.004996814299374819, -0.0036601750180125237, 0.006094520445913076, 0.0029399136546999216, 0.013241730630397797, -0.006897889077663422, -0.006956756580621004, -0.036123886704444885, 0.00491716992110014, 0.018893012776970863, 0.04612443968653679, 0.003888719482347369, 0.03651171922683716, 0.0009159094770438969, 0.019377805292606354, -0.008102942258119583, 0.018228156492114067, 0.013103218749165535, -0.041581250727176666, 0.015208599157631397, -0.03997451439499855, 0.02207878604531288, 0.008920161984860897, 0.0028412239626049995, -0.039309658110141754, 0.022369660437107086, -0.03914344310760498, 0.00012693311145994812, -0.024807468056678772, -0.016039669513702393, -0.04365892708301544, -0.010263726115226746, 0.03169150650501251, -0.0010345102054998279, -0.025555431842803955, 0.013123995624482632, -0.0072510940954089165, -0.016067372635006905, -0.00983433984220028, -0.018560584634542465, -0.04185827448964119, -0.030029363930225372, -0.012396808713674545, -0.03227325528860092, -0.02444733865559101, -0.06465732306241989, 0.01579034887254238, 0.031857721507549286, 0.008393816649913788, -0.046318355947732925, 0.03072192333638668, -0.031608399003744125, 0.000711171654984355, -0.013387167826294899, -0.019350102171301842, -0.013310986571013927, -0.004962186329066753, 0.006548146717250347, -0.011967422440648079, 0.041110310703516006, 0.007334201131016016, 0.006212255451828241, 0.011191755533218384, -0.010880104266107082, 0.05063992366194725, -0.04293866828083992, -0.05371488630771637, 0.005914455279707909, 0.0545736588537693, -0.019253144040703773, -0.0025261095724999905, -0.042523130774497986, -0.013234805315732956, 0.047038618475198746, -0.00823452789336443, 0.04723253473639488, -0.049393318593502045, -0.025056790560483932, 0.0008613704121671617, -0.03382458910346031, -0.025583134964108467, 0.015624133870005608, -0.03216244652867317, 0.03169150650501251, -0.039420466870069504, -0.03778602555394173, -0.005204582121223211, -0.0018491329392418265, -0.061610061675310135, -0.01957172155380249, 0.03454485163092613, 0.05227436497807503, 0.03335364907979965, -0.005239210091531277, 0.018532883375883102, -0.014363676309585571, 0.03437863662838936, 0.015083937905728817, 0.002900091465562582, -0.02894897200167179, 0.017397085204720497, -0.023436201736330986, 0.008553105406463146, -0.02953072264790535, 0.04329879954457283, 0.010983987711369991, -0.01908693090081215, 0.03975289314985275, -0.01203667838126421, -0.031109755858778954, -0.050085876137018204, -0.009931297972798347, -0.05728849396109581, -0.04426838085055351, -0.02098454162478447, 0.01244528777897358, -0.012126710265874863, -0.013123995624482632, 0.0031494128052145243, 0.013449498452246189, -0.048839271068573, -0.011780431494116783, 0.0004107741406187415, 0.039088036864995956, 0.021441631019115448, -0.007119507994502783, -0.012057454325258732, -0.04432378709316254, 0.09042052179574966, 0.006097983103245497, 0.008823203854262829, -0.08560030907392502, 0.027453044429421425, -0.02005651220679283, 0.024156462401151657, -5.1400875236140564e-05, -0.0041865198872983456, 0.04088869318366051, 0.03036179207265377, 0.07645852863788605, 0.029253698885440826, -0.018186602741479874, -0.024336528033018112, 0.025181449949741364, 0.024849021807312965, -0.02016732282936573, -0.007479638792574406, 0.015222449786961079, -0.050224389880895615, -0.020942987874150276, -0.01803424023091793, 0.0007825918146409094, -0.005024516489356756, 0.03418472036719322, 0.002100185491144657, -0.03022328019142151, 0.03642861172556877, -0.023685522377490997, 0.010000553913414478, 0.01049919705837965, -0.015374813228845596, -0.01465455163270235, 0.060557372868061066, -0.03601307421922684, -0.010097512044012547, -0.03878331184387207, -0.03922655060887337, 0.002387597691267729, 0.029253698885440826, 0.0628843680024147, -0.008206825703382492, 0.019502464681863785, -0.018712949007749557, 0.016981549561023712, 0.011025541462004185, -0.0076597039587795734, 0.012770790606737137, -0.02966923452913761, -0.019294697791337967, -0.023034516721963882, -0.04105490446090698, 0.0353759229183197, -0.04124882444739342, -0.010187544859945774, 0.028201008215546608, -0.056651338934898376, -0.03335364907979965, 0.021995678544044495, 0.07053022086620331, 0.05050141364336014, 0.04124882444739342, -0.02206493355333805, -0.035736050456762314, -0.033048924058675766, -0.030444899573922157, -0.04232921451330185, -0.009827414527535439, 0.014280569739639759, 0.024627402424812317, 0.0188653115183115, 0.02077677473425865, 0.021164607256650925, -0.005540473386645317, 0.015208599157631397, -0.028076346963644028, -0.008379966020584106, 0.006797467824071646, -0.008622361347079277, 0.025416919961571693, 0.06305058300495148, 0.06022494286298752, -0.00241530011408031, -0.020444346591830254, 0.010062884539365768, -0.011939719319343567, -0.02836722321808338, -0.006662419065833092, 0.010069809854030609, 0.00661047687754035, 0.007088342681527138, -0.06238572672009468, -0.016081223264336586, 0.03473876789212227, 0.017369383946061134, 0.020846029743552208, -0.05000276863574982, -0.006395783741027117, 0.001300279749557376, -0.012438362464308739, -0.004068784881383181, -0.030029363930225372, -0.006489279214292765, 0.015804199501872063, -0.035265110433101654, -0.019003823399543762, -0.01897612027823925, 0.00376405892893672, -0.018699096515774727, -0.02134467288851738, 0.04141503572463989, 0.014038173481822014, -0.04557039216160774, 0.00040038576116785407, 0.041802868247032166, 0.021760208532214165, 0.004879079293459654, -0.06249653548002243, 0.058895230293273926, -0.0028464181814342737, 0.026164883747696877, 0.013200176879763603, 0.008587733842432499, -0.034821875393390656, -0.00022270105546340346, -0.016510609537363052, 0.0058278851211071014, 0.02620643749833107, 0.029004376381635666, 0.0015530638629570603, 0.006042578723281622, 0.03340905159711838, 0.011233309283852577, -0.04803590103983879, 0.022508172318339348, -0.03972519189119339, 0.0027633109129965305, 0.01637209765613079, 0.05263449624180794, -0.008698542602360249, 0.019488614052534103, -0.027079062536358833, 0.031109755858778954, -0.03881101310253143, -0.0072649456560611725, 0.005311928689479828, 0.026621973142027855, 0.05072303116321564, 0.06271815299987793, -0.01080392301082611, -0.020319685339927673, -0.009107152931392193, -0.01777106709778309, -0.040971800684928894, 0.04673388972878456, -0.016635270789265633, -0.015956562012434006, -0.023062219843268394, 0.008054463192820549, -0.01802038960158825, -0.0034333618823438883, -0.0015045847976580262, 0.033630672842264175, -0.015208599157631397, -0.0036497865803539753, -0.01074159238487482, -0.019724084064364433, 0.0051595657132565975, 0.015014681965112686, -0.03238406404852867, -0.018283560872077942, 0.008553105406463146, -0.04232921451330185, 0.012140561826527119, 0.00860158447176218, -0.023671671748161316, -0.03205163776874542, -0.007493489887565374, -0.021552439779043198, 0.007077954243868589, -0.020222727209329605, 0.029475316405296326, -0.0048860046081244946, -0.019405506551265717, -0.015734944492578506, 0.005346556659787893, 0.015499473549425602, 0.008476924151182175, -0.026275694370269775, -0.08654218912124634, -0.022715939208865166, -0.04493323713541031, 0.02941991202533245, -0.019031524658203125, 0.002848149510100484, 0.018117347732186317, 0.013906587846577168, -0.010616932064294815, -0.004629757720977068, 0.024017950519919395, -0.004390825051814318, -0.010873178951442242, 0.019876446574926376, -0.01649675890803337, 0.005315391346812248, 0.01803424023091793, 0.01682918705046177, -0.06992077082395554, 0.031746912747621536, -0.008753947913646698, -0.0064096348360180855, 0.03983600065112114, 0.0017400548094883561, -0.010942434892058372, -0.030057067051529884, -0.0020101529080420732, -0.05003047361969948, -0.009024045430123806, 0.011828910559415817, -0.007874397560954094, 0.002455122070387006, -0.01422516442835331, 0.020070364698767662, -0.0067316750064492226, 0.0038991079200059175, 0.018699096515774727, -0.008407668210566044, 0.05834118276834488, 0.01020139642059803, -0.012895450927317142, 0.014668402262032032, 0.03809075430035591, -0.06111142039299011, 0.03166380524635315, 0.007978281006217003, 0.010159842669963837, 0.00789517443627119, -0.017494043335318565, 0.038478586822748184, 0.00492063257843256, 0.009294143877923489, -0.018948419019579887, -0.036096181720495224, -0.001015464891679585, -0.030888138338923454, -0.030749626457691193, -0.02468280866742134, 0.013664191588759422, 0.006420023273676634, 0.02005651220679283, -0.06593163311481476, 0.006624328438192606, 0.006665881723165512, -0.0364840142428875, -0.036123886704444885, -0.02666352689266205, -0.0018231619615107775, 0.008940938860177994, 0.015915008261799812, 0.023920992389321327, -0.013601861894130707, -0.0375090017914772, 0.04983655735850334, -0.03329824283719063, -0.0014180148718878627, -0.015444069169461727, -0.03158069774508476, 0.048562247306108475, -0.027466895058751106, 0.002683666767552495, 0.021898720413446426, 0.01512549165636301, 0.0032030860893428326, -0.001110691693611443, 0.03556983917951584, -0.001694172853603959, -0.015471771359443665, -0.009121003560721874, -0.012285999022424221, -0.02573549747467041, 0.0552385188639164, -0.013470275327563286, 0.014682253822684288, -0.02905978262424469, 0.03047260269522667, 0.01084547583013773, -0.025319961830973625, 0.03105435147881508, -0.0010786608327180147, -0.03094354271888733, 0.010720815509557724, -0.038838718086481094, -0.04219070449471474, -0.022134190425276756, 0.01684303767979145, 0.017272425815463066, -0.0006302288384176791, -0.030915839597582817, -0.007019086740911007, 0.025209153071045876, -0.0026109479367733, -0.05468447133898735, 0.010997839272022247, 0.0009358205716125667, 0.009010194800794125, -0.0426616445183754, -0.021884869784116745, 0.013359465636312962, -0.0222865529358387, 0.027106765657663345, -0.05172031745314598, -0.03163610026240349, -0.03393539786338806, -0.027369936928153038, -0.00744501082226634, 0.017452489584684372, 0.037758324295282364, -0.009114078246057034, 0.027120616286993027, -0.0159981157630682, -0.008504626341164112, -0.011101722717285156, -0.015471771359443665, -0.013137847185134888, -0.012133636511862278, -0.0157764982432127, -0.006188015919178724, 0.04185827448964119, 0.015319407917559147, 0.06465732306241989, -0.015277855098247528, -0.009785860776901245, 0.020555155351758003, 0.012569948099553585, 0.02430882677435875, -0.0057101501151919365, 0.0054262010380625725, -0.04521026089787483, -0.03473876789212227, -0.05321624502539635, -0.021386226639151573, 0.024336528033018112, -0.05077843740582466, -0.006807856261730194, -0.034461744129657745, -0.0005211507668718696, -0.01778491958975792, -0.009030971676111221, 0.016884591430425644, -0.0017088897293433547, -0.020596709102392197, -0.021995678544044495, -0.02418416552245617, -0.005910992156714201, 0.04875616356730461, -0.02753615193068981, -0.006645104847848415, 0.009398027323186398, 0.017646407708525658, 0.04385284334421158, -0.020915286615490913, -0.06521137058734894, -0.0040133800357580185, 0.022480469197034836, -0.030306387692689896, 0.014488337561488152, -0.041581250727176666, -0.026012521237134933, -0.03487727791070938, 0.037398193031549454, 0.030915839597582817, -0.04936561733484268, -0.0003726833965629339, -0.001837013172917068, -0.045708902180194855, 0.0019720622804015875, 0.017272425815463066, 0.0007202615379355848, 0.016787633299827576, 0.0018785666907206178, 0.023865588009357452, -0.01991800032556057, -0.0005038367817178369, -0.014917723834514618, -0.058895230293273926, 0.0007622478879056871, 0.004075710661709309, 0.019779488444328308, -0.07507341355085373, 0.024170314893126488, -0.008740096352994442, -0.00930799450725317, -0.003019557800143957, 0.024752063676714897, 0.015388663858175278, -0.002024004003033042, -0.020610559731721878, 0.00830378383398056, 0.017507895827293396, 0.0004757015558425337, -0.005914455279707909, -0.017452489584684372, 0.010561526753008366, 0.007985207252204418, -0.02631724812090397, -0.0038090753369033337, 0.0159981157630682, 0.01969638280570507, -0.0007579193916171789, 0.027342235669493675, -0.0002980168501380831, 0.05778713524341583, -0.003933736123144627, 0.01238295715302229, -0.043935950845479965, -0.009155631996691227, 0.00652044452726841, 0.004851376637816429, 0.010111363604664803, 0.00645811390131712, -0.04138733446598053, -0.001545272534713149, -0.0069844587706029415, -0.028782758861780167, -0.016773782670497894, 0.013539531268179417, 0.01874065026640892, -0.011579588986933231, -0.03343675658106804, -0.005377721972763538, 0.038007646799087524, -0.01990414969623089, -0.026760485023260117, 0.011240234598517418, 0.0037744473665952682, 0.010880104266107082, 0.04742645099759102, 0.020111918449401855, 0.0037328938487917185, -0.04931021109223366, -0.0009488060022704303, -0.02512604556977749, 0.008885533548891544, -0.00889245979487896, -0.006004487629979849, -0.008823203854262829, -0.03238406404852867, 0.014169760048389435, 0.00652736984193325, -0.0016024087090045214, 0.013643414713442326, -0.025790901854634285, 0.0013314449461176991, -0.04437918961048126, -0.010062884539365768, -0.00188202946446836, 0.013740373775362968, 0.03778602555394173, -0.02372707612812519, -0.13153083622455597, -0.022438915446400642, 0.021538589149713516, 0.005038367584347725, 0.005775943398475647, -0.011087872087955475, 0.03205163776874542, -0.015721092000603676, -0.03903263434767723, -0.04063937067985535, -0.014003545977175236, -0.006316139362752438, -0.01429442036896944, -0.005997562315315008, 0.005048756022006273, -0.024945979937911034, -0.005921380594372749, 0.012431436218321323, 0.030444899573922157, -0.012542245909571648, -0.00203092978335917, 0.008019834756851196, -0.018671395257115364, 0.01731397770345211, -0.03637320548295975, -0.025707796216011047, 0.02658041939139366, -0.04515485465526581, 0.016746079549193382, 0.0007315155817195773, 0.007964430376887321, 0.0052842264994978905, 0.030860435217618942, -0.005637431517243385, -0.013657266274094582, -0.022383511066436768, -0.0009470746153965592, -0.027328383177518845, -0.01836666837334633, 0.028616543859243393, 0.017715662717819214, -0.047010913491249084, 0.032079339027404785, 0.010000553913414478, 0.024807468056678772, -0.0458197146654129, 0.017881877720355988, -0.03487727791070938, 0.007161061745136976, -0.0035632168874144554, 0.019031524658203125, -0.006821707356721163, -0.0020915286149829626, -0.007929801940917969, 0.0026507701259106398, -0.012971633113920689, -0.008920161984860897, 0.0201534703373909, 0.001496793469414115, -0.012085157446563244, -0.037065766751766205, 0.02869965136051178, 0.04352041706442833, -0.0317746140062809, -0.054268933832645416, -0.00044843205250799656, 0.00788824912160635, 0.049254804849624634, -0.020541304722428322, -0.009778935462236404, 0.003964900970458984, -0.040029916912317276, -0.0048929303884506226, -0.009425729513168335, -0.014322123490273952, 0.007271870970726013, -0.01850518025457859, 0.012874674052000046, -0.06083439663052559, 0.02561083808541298, 0.02799324132502079, -0.017244722694158554, 0.011392598040401936, 0.02917059138417244, -0.002915673889219761, 0.016067372635006905, 0.007756662555038929, -0.0047197905369102955, -0.01883760839700699, -0.0016500221099704504, 0.02583245560526848, -0.0066935839131474495, -0.002082871738821268, -0.016538312658667564, -0.0027373400516808033, -0.05005817487835884, -0.06792619824409485, 0.015111640095710754, 0.025319961830973625, -0.004117263946682215, 0.032661087810993195, 0.029586127027869225, 0.000650139874778688, -0.0233530942350626, 0.007119507994502783, -0.015347111038863659, -0.0062607345171272755, -0.020375089719891548, 0.022258851677179337, -0.036234695464372635, 0.011247160844504833, -0.02146933414041996, -0.021136905997991562, 0.022341957315802574, -0.008033686317503452, 0.021677101030945778, 0.04576430842280388, 0.012853898108005524, 0.01042994111776352, -0.00035645152092911303, 0.014024322852492332, 0.03595767170190811, -0.018449775874614716, -0.0007877860334701836, 6.498152652056888e-05, -0.01375422440469265, -0.012244445271790028, 0.037176575511693954, -0.024613551795482635, 0.015707241371273994, 0.0007129030418582261, 0.018796054646372795, 0.03188542276620865, -0.013636489398777485, 0.022217297926545143, 0.0240872073918581, 0.00622610654681921, 0.010229098610579967, -0.032688792794942856, 0.004401213489472866, 0.012466064654290676, -0.002320073079317808, -0.0005709284450858831, -0.011863538064062595, -0.0043181064538657665, 0.01743863895535469, -0.0033485235180705786, -0.026012521237134933, -0.013373317196965218, 0.008463072590529919, 0.02349160611629486, -0.03484957665205002, 0.014668402262032032, -0.005055681802332401, -0.010900881141424179, -0.0157764982432127, 0.014100504107773304, -0.01646905578672886, 0.018186602741479874, 0.05194193497300148, 0.02642805688083172, 0.05554324388504028, -0.026968253776431084, -0.016219735145568848, 0.04615214094519615, -0.025195302441716194, -0.01304781436920166, -0.008823203854262829, 0.008096016012132168, 0.00017216587730217725, -0.03025098331272602, -0.043575819581747055, -0.0005137923290021718, 0.02254972606897354, 0.023297689855098724, 0.006426949054002762, 0.0077151088044047356, 0.02241121418774128, -0.0036809518933296204, 0.015721092000603676, 0.03296581655740738, 0.015388663858175278, -0.05047370865941048, -0.0024672418367117643, 0.049725744873285294, -0.01991800032556057, 0.04365892708301544, -0.012694609351456165, 0.008255304768681526, 0.03914344310760498, 0.03288270905613899, 0.02691284753382206, 0.006056429818272591, 0.02609562873840332, 0.04127652570605278, 0.010589228942990303, -0.03845088556408882, 0.049614936113357544, -0.005505845416337252, -0.052108149975538254, -0.003114784834906459, 0.02360241487622261, 0.001403297996148467, -0.0007432025158777833, -0.024752063676714897, 0.021801762282848358, 0.015610283240675926, -0.008615436032414436, -0.015388663858175278, 0.027827026322484016, 0.024599701166152954, 0.02336694486439228, -0.02584630809724331, -0.01615048013627529, 0.004512022715061903, -0.008975566364824772, 0.03014017455279827, 0.03828467056155205, -0.01646905578672886, -0.009806637652218342, -0.003521663136780262, 0.003215205855667591, 0.01352567970752716, 0.019751787185668945, -0.045265667140483856, -0.005142251495271921, 0.0550168976187706, 0.015111640095710754, -0.0012154412688687444, 0.0018214305164292455, -0.018546734005212784, 0.012853898108005524, 0.013968917541205883, -0.022632833570241928, -0.001984182046726346, -0.01411435566842556, 0.00959886983036995, 0.007039863616228104, -0.019045377150177956, -0.010014405474066734, 0.050584521144628525, -0.01635824702680111, -0.021857166662812233, 0.009010194800794125, 0.019779488444328308, 0.013130920939147472, 0.01144107710570097, 0.041941381990909576, -0.038478586822748184, -0.012576874345541, -0.03465566039085388, 0.03734279051423073, 0.03501579165458679, 0.0030559173319488764, 0.021192310377955437, 0.018879162147641182, 0.01991800032556057, 0.04421297460794449, 0.02311762422323227, 0.025790901854634285, -0.025444623082876205, 0.0029606902971863747, 0.01173887774348259, -0.002853343728929758, 0.011801207438111305, -0.06044656038284302, -0.009550390765070915, 0.0088993851095438, 0.008047536946833134, 0.009259515441954136, -0.009543465450406075, 0.04235691577196121, -0.029503019526600838, 0.028284115716814995, 0.018671395257115364, 0.01038146112114191, 0.03213474527001381, -0.019294697791337967, 0.01944706030189991, 0.019003823399543762, -0.051775719970464706, -0.018643692135810852, -0.022577427327632904, -0.02182946354150772, -0.0020014960318803787, -0.011967422440648079, 0.012992409989237785, -0.01824200712144375, 0.01067926175892353, 0.01238295715302229, 0.029225995764136314, 0.038256965577602386, -0.025583134964108467, 0.007728959899395704, 0.0038229264318943024, -0.022826749831438065, -0.013622638769447803, 0.025112194940447807, -0.01910078153014183, 0.005744778085500002, -0.00032095788628794253, 0.040971800684928894, -0.005557787138968706, -0.022341957315802574, 0.04521026089787483, 0.01979334093630314, 0.013678043149411678, -0.005093772429972887, -0.005318854004144669, -0.04171976447105408, -0.0003289656015112996, -0.0065827746875584126, -0.003961438313126564, -0.005163028370589018, -0.0034437503200024366, 0.030777327716350555, -0.00028027003281749785, 0.023643968626856804, 0.011261011473834515, 0.0022871766705065966, -0.0008968641050159931, -0.012722311541438103, 0.008511551655828953, 0.01601196825504303, -0.016205884516239166, -0.02716217003762722, -0.007701257709413767, -9.933895489666611e-05, -0.0028360297437757254, 0.019183889031410217, -0.007687406614422798, 0.018352817744016647, 0.040390048176050186, -0.013775001280009747, -0.02551387809216976, 0.021621696650981903, -0.04230151325464249, 0.02016732282936573, -0.018574437126517296, -0.009640423581004143, 0.0038090753369033337, 0.036234695464372635, 0.008137569762766361, -0.019474763423204422, -0.007046789396554232, 0.00930799450725317, 0.008975566364824772, -0.01696769893169403, -0.01613662764430046, -0.019239293411374092, 0.08305168896913528, -0.03631780296564102, -0.020804475992918015, 0.005699761677533388, -0.0017184123862534761, 0.036345504224300385, 0.0019374341936782002, 0.015956562012434006, -0.04058396443724632, 0.0018768352456390858, -0.004380436614155769, 0.01824200712144375, -0.016164330765604973, -0.010533824563026428, 0.009425729513168335, 0.024253420531749725, -0.031248267740011215, 0.00030083037563599646, 0.013463350012898445, 0.039780598133802414, 0.015707241371273994, -0.03188542276620865, -0.03471106290817261, 0.017452489584684372, 0.0201534703373909, -0.011704249307513237, -0.013574158772826195, 0.013227880001068115, -0.01743863895535469, 0.026525015011429787, 0.010949360206723213, -0.03917114436626434, -0.052606791257858276, 0.0001732480013743043, -0.003746744943782687, 0.0014084922149777412, -0.012819269672036171, 0.0319962315261364, -0.012542245909571648, 0.0029260623268783092, -0.006776691414415836, -0.013484126888215542, -0.014640700072050095, 0.01623358577489853, 0.023436201736330986, 0.004183057229965925, -0.025195302441716194, 0.008283006958663464, 0.0275084488093853, 0.022923707962036133, 0.02429497428238392, -0.018463626503944397, 0.03889412060379982, -0.02148318476974964, -0.008878608234226704, 0.003019557800143957, 0.000844922149553895, 0.008705468848347664, -0.0017565031303092837, 0.02881046012043953, -0.029392210766673088, 0.0009332234621979296, -0.017577150836586952, -0.011240234598517418, 0.006264197640120983, -0.013262507505714893, -0.014211313799023628, 0.002745996927842498, -0.005685910582542419, 0.03036179207265377, 0.0023789405822753906, 0.00806138850748539, -0.013719596900045872, -0.024211866781115532, -0.0032706104684621096, 0.018297413364052773, -0.01615048013627529, -0.007722034584730864, 0.008456147275865078, 0.009550390765070915, -0.013435647822916508, 0.009654274210333824, -0.013484126888215542, -0.017466342076659203, 0.008324560709297657, -0.005588952451944351, 0.019253144040703773, -0.037065766751766205, -0.011288713663816452, 0.0009583287173882127, -0.016302842646837234, 0.014107429422438145, 0.03831237182021141, -0.0029849298298358917, 0.01042994111776352, -0.01227907370775938, 0.029724638909101486, -0.02207878604531288, -0.014931575395166874, 0.016801483929157257, -0.02101224474608898, -0.006638179533183575, 0.036234695464372635, 0.010263726115226746, -0.006004487629979849, 0.016510609537363052, -0.033519864082336426, 0.0019928389228880405, -0.007576596923172474, -0.005744778085500002, -0.011004764586687088, -0.005343094002455473, 0.016330543905496597, -0.012292925268411636, -0.024613551795482635, -0.017244722694158554, -0.0054192752577364445, 0.045958224684000015, 0.019530167803168297, 0.003919884562492371, 0.03631780296564102, -0.0017989224288612604, 0.025306111201643944, 0.014003545977175236, -0.009737381711602211, 0.004865228198468685, -0.011731951497495174, 0.03083273395895958, -0.016649121418595314, 0.016427502036094666, -0.008823203854262829, 0.007361903786659241, 0.01860213838517666, -0.022217297926545143, 0.0078328438103199, 0.028187157586216927, -0.001157439430244267, -0.015208599157631397, -0.018463626503944397, -0.0040514711290597916, 0.007867472246289253, 0.006208792794495821, 0.005253061186522245, 0.021552439779043198, 0.00774281146004796, 0.009425729513168335, -0.003329477971419692, -0.03194082900881767, 0.0026646212209016085, 0.02290985733270645, -0.006745526101440191, 0.043714333325624466, -0.009460357949137688, 0.0213308222591877, 0.0010249875485897064, -0.023505456745624542, 0.015915008261799812, 0.013421796262264252, 0.02468280866742134, 0.01849132962524891, 0.043825142085552216, -0.006548146717250347, -0.01358801033347845, 0.029087483882904053, 0.032910410314798355, 0.004605518188327551, -0.012563022784888744, 0.007909025065600872, -0.015818050131201744, -0.034434039145708084, 0.006600088439881802, 0.026040224358439445, 0.02085988223552704, -0.024945979937911034, -0.003090545069426298, 0.004363122396171093, 0.0029347194358706474, -0.013865034095942974, -0.018768353387713432, 0.024239569902420044, -0.00023611937649548054, -0.016579866409301758, 0.020582858473062515, 0.02041664347052574, 0.009314920753240585, 0.0007453667931258678, 0.012251371517777443, 0.01932240091264248, 0.013387167826294899, 0.011967422440648079, 0.019474763423204422, 0.004158817697316408, 0.04160895198583603, -0.0026109479367733, 0.01334561500698328, 0.02453044429421425, 0.02266053482890129, -0.031137458980083466, 0.03806304931640625, 0.01637209765613079, 0.026635823771357536, -0.01955787092447281, -0.007479638792574406, 0.02062441222369671, 0.01418361160904169, 0.04316028580069542, 0.007770513650029898, 0.014779211953282356, -0.011607291176915169, 0.0029312565457075834, 0.026137182489037514, 0.007244168780744076, 0.010062884539365768, -0.006219181232154369, -0.024211866781115532, -0.0020482437685132027, 0.021884869784116745, 0.006624328438192606, 0.004858302418142557, -0.01482076570391655, 3.227433990105055e-05, -0.03845088556408882, 0.021995678544044495, -0.009931297972798347, -0.018325114622712135, -0.016275139525532722, 0.02465510554611683, 0.00667280750349164, 0.021427780389785767, 0.01090780645608902, 0.007053714711219072, -0.01214748714119196, -0.010097512044012547, -0.013338688760995865, 0.030666518956422806, 0.011219457723200321, -0.022120339795947075, -0.011835835874080658, 0.011399523355066776, 0.030334090813994408, -0.0156656876206398, -0.023810183629393578, 0.009543465450406075, -0.027092913165688515, 0.011877389624714851, 0.039060335606336594, 0.01351182907819748, 0.013546456582844257, -0.04543187841773033, -0.00015550116950180382, -0.005869438871741295, 0.00048652279656380415, -0.007119507994502783, -0.033381350338459015, 0.03678874298930168, 0.019266994670033455, 0.012327552773058414, -0.017230872064828873, 0.0021884869784116745, 0.035985372960567474, -0.0066693443804979324, 0.004965648986399174, -0.008677765727043152, -0.015915008261799812, -0.029475316405296326, 0.005640894174575806, 0.001975524937734008, -0.0008289067191071808, -0.03803534805774689, 0.0019460911862552166, 0.0014595683896914124, 0.007098731119185686, 0.03119286336004734, -0.016510609537363052, -0.02206493355333805, 0.012846971862018108, -0.02073522098362446, -0.013304061256349087, 0.00406532222405076, -0.015222449786961079, 0.021497035399079323, -0.000883445783983916, -0.006052966695278883, -0.0011816790793091059, 0.02705135941505432, -0.010312206111848354, -0.01768796145915985, 0.004131115507334471, 0.008172198198735714, 0.023505456745624542, -0.030860435217618942, -0.020125769078731537, 0.020541304722428322, -0.026511164382100105, -0.011330267414450645, -0.01489002164453268, 0.007632001768797636, -0.0022663997951895, -0.00991052109748125, 0.045598093420267105, -0.025403069332242012, 0.016926145181059837, 0.0116765471175313, 0.003594381967559457, 0.02158014290034771, 0.021497035399079323, -0.03288270905613899, 0.02705135941505432, -0.0019114632159471512, -0.012909302487969398, -0.012992409989237785, -0.018297413364052773, -0.0031009335070848465, 0.025541581213474274, -0.0008509820327162743, 0.0054504405707120895, 0.0013271165080368519, 0.0026161421556025743, 0.007077954243868589, 0.025112194940447807, -0.027203723788261414, -0.01103939302265644, 0.006032190285623074, -0.017120061442255974, 0.043603524565696716, 0.0025555433239787817, 0.016995402052998543, 0.027065211907029152, 0.014017397537827492, 0.006350767333060503, 0.03426782786846161, -0.00014987413305789232, 0.022923707962036133, -0.0023252672981470823, -0.0049933516420423985, 0.03141448274254799, -0.019253144040703773, 0.033021219074726105, 0.0177987702190876, -0.015194747596979141, 0.006271122954785824, 0.0015868261689320207, 0.00776358786970377, 0.00907252449542284, -0.01754944957792759, 0.01800653710961342, 0.007618150673806667, 0.010866252705454826, -0.010180619545280933, 0.022480469197034836, 0.04363122582435608, 0.041110310703516006, -0.02158014290034771, -0.023643968626856804, -0.00788824912160635, 0.00630921358242631, 0.00043847650522366166, -0.025223003700375557, -0.019045377150177956, 0.012064380571246147, -0.02018117345869541, -0.020430494099855423, 0.029973959550261497, 0.009820488281548023, -0.00829685851931572, 0.013775001280009747, -0.010637708008289337, -0.015236301347613335, -0.011157128028571606, -0.018893012776970863, 0.0009851653594523668, 0.020956840366125107, 0.03712116926908493, 0.02407335676252842, 0.004228073637932539, 0.009993628598749638, -0.0383954793214798, -0.00337968859821558, 0.037176575511693954, -0.013906587846577168, -0.009176408872008324, -0.0240872073918581, -0.011392598040401936, -0.01203667838126421, -0.016053520143032074, 0.01932240091264248, 0.015319407917559147, -0.006544684059917927, 0.007867472246289253]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"xt))
.
Proof of Theorem 5. Define the following covariance matrices:
Σoff=λI+X
(x,a1,a2)∈Doff(ϕ(x, a1)−ϕ(x, a2))(ϕ(x, a1)−ϕ(x, a2))⊤,
Σt= Σ off+t−1X
i=1(ϕ(xi, a1
i)−ϕ(xi, a2
i))(ϕ(xi, a1
i)−ϕ(xi, a2
i))⊤,
¯Σt= Σ off+t−1X
i=1Ex∼d0,a1∼πt,a2∼πref(ϕ(x, a1)−ϕ(x, a2))(ϕ(x, a1)−ϕ(x, a2))⊤.
41
Similar to the proofs of the offline and online setting, we get the following decomposition: with probability
at least 1 −2δ,
TX
t=1
J(π∗)−J(πt)
=TX
t=1Ext∼d0h
Eπ∗[r∗(x, a)−rt(x, a)] +Eπt[rt(x, a)−r∗(x, a)]i
−ηTX
t=1Ext∼d0
DKL(πt(·|xt)∥π∗(·|xt))
=TX
t=1Ext∼d0h
θ∗−θt, ϕ(xt, π∗)−ϕ(xt, πref)i
+TX
t=1Ext∼d0h
θt−θ∗, ϕ(xt, πt)−ϕ(xt, πref)i
−ηTX
t=1Ext∼d0
DKL(πt(·|xt)∥π∗(·|xt))
≤TX
t=1∥θ∗−θt∥Σt·Ext∼d0h
∥ϕ(xt, π∗)−ϕ(xt, πref)∥Σ−1
ti
+TX
t=1∥θ∗−θt∥Σt·Ext∼d0h
min
1,∥ϕ(xt, πt)−ϕ(xt, πref)∥Σ−1
t	i
−ηTX
t=1Ext∼d0
DKL(πt
1(·|xt)∥π∗(·|xt))
,
≤Tβ· ∥Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)]∥Σ−1
off| {z }
P1+βTX
t=1Ext∼d0min
1,∥ϕ(xt, πt)−ϕ(xt, πref)∥Σ−1
t	
| {z }
P2
−ηTX
t=1Ext∼d0
DKL(πt
1(·|xt)∥π∗(·|xt))
,
where the first equality holds due to Lemma 1 and Lemma 2, the first inequality uses the Cauchy-Schwarz
inequality, and the last inequality holds due to Lemma 8 and Σ t⪰Σoff. For the term P1, according to
Assumption 2, we get
P1=Tα(T,Doff)β·T1−α(T,Doff)∥Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)]∥Σ−1
off
≤Tα(T,Doff)β·Ccov.
For the term P2, we can apply Lemmas 9 and 10 to obtain
P2≤βvuut3TTX
t=1Ext∼d0,a1∼πt,a2∼πrefmin 
∥ϕ(xt, a1)−ϕ(x, a2)∥2
¯Σ−1
t,1
≤βp
3T·2dlog(1 + T/dλ ).
By taking the upper bound of P1andP2back, we have
TX
","[-0.012926190160214901, -0.025684256106615067, 0.006880173459649086, 0.023007195442914963, 0.0036987399216741323, -0.012932656332850456, 0.0019027171656489372, 0.04047921672463417, -0.014691498130559921, 0.03378009796142578, 0.030521070584654808, -0.021157827228307724, -0.02159753628075123, 0.025231612846255302, 0.004859445616602898, -0.018713554367423058, 0.03116770274937153, 0.005554575938731432, -0.02159753628075123, 0.0477215051651001, -0.029538188129663467, -0.03988431394100189, 0.060369640588760376, 0.03809960559010506, 0.0050178710371255875, -0.00958309881389141, 0.025231612846255302, -0.0013579289661720395, 0.04779909923672676, -0.034581925719976425, 0.00541878305375576, -0.044798724353313446, 0.007507407106459141, -0.05198927968740463, -0.03145221993327141, 0.07454383373260498, -0.0028274019714444876, 0.06109387055039406, -0.005270057823508978, 0.004571693949401379, 0.0050954669713974, 0.006983634550124407, -0.08426918834447861, -0.014924285933375359, 0.0060848151333630085, 0.032952409237623215, -0.005270057823508978, -0.003595278598368168, 0.010798768140375614, 0.0172133669257164, -0.02164926752448082, -0.003037557704374194, -0.0005924773286096752, 0.010876364074647427, -0.033909425139427185, 0.013734481297433376, -0.017252163961529732, 0.03654768690466881, 0.053334277123212814, -0.06642212718725204, 0.04391930252313614, -0.0039153615944087505, 0.03597865253686905, -0.007843656465411186, -0.02865876816213131, -0.02035600133240223, -0.005842327605932951, 0.05695541948080063, 0.028788093477487564, 0.02259335108101368, -0.028736364096403122, 0.005066368263214827, 0.04684208333492279, 0.01687711663544178, -0.012137298472225666, 0.012467080727219582, 0.030365878716111183, 0.05134264752268791, 0.05421369522809982, -0.02710684761404991, 0.043169207870960236, 0.01194977480918169, 0.07609575241804123, -0.0012455765390768647, 0.03654768690466881, -0.09001129120588303, -0.002298779785633087, 0.021765660494565964, -0.07159518450498581, 0.017627211287617683, -0.006046017166227102, 0.016773656010627747, 0.022127775475382805, 0.007636733818799257, 0.042858824133872986, 0.014019000343978405, 0.021726863458752632, -0.012499412521719933, 0.008199304342269897, -0.017937595024704933, 0.028788093477487564, -0.056903690099716187, 0.045729875564575195, -0.0052118608728051186, 0.05255831778049469, 0.002871049800887704, -0.02767588570713997, 0.006314369849860668, -0.01850663125514984, -0.007669065613299608, -0.029072612524032593, -0.041591424494981766, -0.0013708616606891155, 0.06011098995804787, 0.008988196030259132, -0.03822893276810646, -0.060007527470588684, 0.017911730334162712, -0.026537811383605003, -0.01050131767988205, 0.019502446055412292, -0.0040608542039990425, 0.03225404769182205, 0.03590105473995209, 0.021494075655937195, 0.005564275663346052, 0.003267112420871854, -0.08995956182479858, -0.03370250388979912, -0.021196624264121056, 0.029538188129663467, 0.007171158213168383, -0.011878645047545433, 0.01035259198397398, -0.04164315387606621, 0.034297406673431396, 0.03564240038394928, 0.04831640422344208, 0.048549193888902664, 0.01692884787917137, -0.01319130975753069, -0.011807515285909176, -0.023071859031915665, 0.014303518459200859, -0.015997696667909622, 0.028581172227859497, -0.024972960352897644, -0.010708239860832691, 0.02930540032684803, -0.00415461603552103, -0.02329171448945999, -0.0497131310403347, 0.00603955052793026, -0.002798303496092558, 0.0025994640309363604, -0.03259029611945152, -0.01207910105586052, 0.07821670919656754, 0.02423579804599285, -0.01191744301468134, -0.024093540385365486, 0.028503576293587685, -0.0029421793296933174, 0.033624906092882156, 0.03530615195631981, 0.016734857112169266, 0.0004740626900456846, 0.015001881867647171, -0.059076376259326935, -0.05612773075699806, -0.002099940087646246, 0.04148796200752258, -0.02512815222144127, -0.003996191080659628, 0.02011028118431568, -0.033288657665252686, -0.018571294844150543, -0.02608516812324524, 0.022735610604286194, -0.015389861539006233, 0.02455911599099636, 0.03528028726577759, 0.057110611349344254, -0.010339658707380295, -0.03196952864527702, 0.014562171883881092, 0.03375423327088356, -0.01655380055308342, -0.002219567308202386, -0.00814757402986288, 0.009350311011075974, 0.0049047102220356464, 0.0014921053079888225, -0.01813158392906189, 0.028917420655488968, -0.040893059223890305, 0.025632524862885475, 0.04973899945616722, -0.021106095984578133, 0.047902561724185944, 0.04482458904385567, 0.018299710005521774, -0.005089000333100557, -0.0019835461862385273, 0.0013158977963030338, 0.006585955619812012, 0.025425603613257408, 0.02829665318131447, -0.0657496303319931, -0.003695506602525711, 0.005670969840139151, -0.038022011518478394, 0.01145833358168602, 0.01226015854626894, -0.020278405398130417, 0.015092410147190094, -0.04774736985564232, 0.033650774508714676, 0.019877493381500244, 0.07433690875768661, -0.033573176711797714, 0.057524457573890686, 0.01814451813697815, -0.019347254186868668, -0.006951303221285343, 0.013320636004209518, 0.05167889595031738, -0.035823460668325424, 0.04050508141517639, -0.03336625546216965, 0.047281794250011444, 0.01939898543059826, -0.030133090913295746, -0.03176260367035866, 0.04195353761315346, -0.03354731202125549, -0.024791903793811798, -0.04327267035841942, -0.0369098037481308, -0.061300791800022125, -0.027856942266225815, 0.035538941621780396, -0.019916292279958725, -0.0387721061706543, -0.01369568333029747, -0.00161011575255543, -0.011736385524272919, 0.014225922524929047, -0.05607600137591362, -0.009305046871304512, 0.02067931741476059, 0.010624177753925323, -0.012020904570817947, -0.016372743993997574, -0.03574586287140846, 0.010197400115430355, 0.022541619837284088, -0.008005314506590366, -0.02581358328461647, 0.04715246707201004, -0.024119405075907707, -0.030469339340925217, -0.050204575061798096, -0.016708992421627045, 0.008069978095591068, 0.0002639070153236389, 0.01386380847543478, 0.005444648675620556, 0.030029628425836563, 0.006763779558241367, 0.03062453120946884, 0.008800673298537731, -0.027158578857779503, 0.03308173641562462, -0.06585308909416199, -0.0401429682970047, -0.007345749065279961, 0.03905662149190903, -0.045419491827487946, -0.008677812293171883, -0.036444228142499924, 0.029770975932478905, 0.035202693194150925, 0.024714307859539986, 0.04516083747148514, -0.054937925189733505, -0.015816638246178627, 0.017885863780975342, -0.04270363226532936, -0.04050508141517639, 0.04867852106690407, -0.028607036918401718, 0.020912105217576027, -0.009796487167477608, -0.012007972225546837, 0.0037666363641619682, 0.007171158213168383, -0.06435289978981018, -0.0031830500811338425, 0.008496755734086037, 0.02197258360683918, 0.0024604378268122673, -0.002099940087646246, 0.04174661636352539, -0.03476298227906227, -0.005063135176897049, 0.024106472730636597, 0.007410412188619375, -0.03189193084836006, 0.017717739567160606, -0.021907920017838478, 0.0039153615944087505, -0.047333523631095886, 0.003569413209334016, -0.027468962594866753, -0.0034950505942106247, 0.050152841955423355, -0.00621090829372406, -0.016101157292723656, -0.03240923956036568, -0.001703877467662096, -0.0645080953836441, -0.017394423484802246, -0.015221737325191498, -0.0059716543182730675, 0.00797944888472557, -0.03941873833537102, -0.004274243023246527, 0.027546558529138565, -0.03494403883814812, -0.013171911239624023, 0.00445530004799366, 0.029538188129663467, -0.026925791054964066, -0.0184549018740654, -0.015131208114326, -0.0336766391992569, 0.08457957208156586, 0.011678189039230347, -0.0027514228131622076, -0.05840387940406799, 0.010598312132060528, -0.03375423327088356, 0.010436654090881348, 0.014523373916745186, -0.010882830247282982, 0.061921559274196625, 0.02067931741476059, 0.08530380576848984, 0.06295616924762726, -0.0028322518337517977, -0.008322164416313171, 0.016036493703722954, 0.018028123304247856, 0.012564076110720634, -0.025658391416072845, 0.01510534342378378, -0.04102238640189171, -0.008613149635493755, -0.003960626199841499, -0.003388355951756239, 0.004920875653624535, 0.03936700522899628, -0.006123613100498915, -0.011852779425680637, 0.03057279996573925, -0.02832251787185669, 0.021882055327296257, 0.012072634883224964, -0.008470890112221241, -0.010391389951109886, 0.07097441703081131, -0.06926731020212173, -0.007720795925706625, -0.038022011518478394, -0.061766367405653, 0.016385676339268684, 0.018390238285064697, 0.06931903958320618, -0.0009246849804185331, -0.0013514626771211624, -0.026589542627334595, -0.01387674082070589, 0.019243793562054634, 0.006068649236112833, 0.01818331517279148, -0.023640897125005722, -0.024610845372080803, -0.0051601300947368145, -0.015583851374685764, -0.007481541950255632, -0.05959368124604225, -0.011742852628231049, 0.022451091557741165, -0.04911823198199272, -0.03623730316758156, 0.041591424494981766, 0.07744074612855911, 0.007015966344624758, 0.06497366726398468, -0.004034989047795534, -0.02480483613908291, -0.06419771164655685, -0.012544676661491394, -0.035228557884693146, 0.020317204296588898, 0.02230883203446865, 0.027779346331954002, 0.030521070584654808, -0.0004768917278852314, 0.026667138561606407, -0.007125894073396921, 0.020136145874857903, -0.03791854903101921, -0.009337377734482288, -0.00019974893075414002, 0.00041243049781769514, 0.03556480631232262, 0.040608543902635574, 0.055920809507369995, -0.003152335062623024, -0.00830923207104206, 0.002415173687040806, -0.006705582607537508, -0.05457581207156181, 0.006873706821352243, 0.02195965126156807, 0.019644705578684807, 0.013786211609840393, -0.055558692663908005, -0.003171734046190977, 0.03121943399310112, 0.03352144733071327, 0.03706499561667442, -0.05292043089866638, 0.009001129306852818, 0.030986646190285683, 0.0014031932223588228, -0.02420993335545063, -0.023511569947004318, -0.01846783421933651, -0.02320118620991707, -0.005894058384001255, -0.01623048447072506, 0.0013336802367120981, 0.005464047659188509, -0.007759593892842531, -0.028503576293587685, 0.021907920017838478, 0.032667890191078186, -0.016165820881724358, 0.010869897902011871, 0.0331851989030838, -0.017058175057172775, -0.06445635855197906, -0.049221690744161606, 0.028503576293587685, 0.008632548153400421, 0.010507783852517605, -0.01908860169351101, -0.00797944888472557, -0.045031510293483734, -0.010578913614153862, -0.006230307277292013, 0.035202693194150925, 0.016993511468172073, 0.01970936916768551, 0.02230883203446865, -0.01207910105586052, 0.04006537050008774, -0.013424097560346127, -0.04583333432674408, 0.044721126556396484, -0.05160130187869072, 0.004164315294474363, 0.025904111564159393, 0.05902464687824249, -0.03530615195631981, 0.044746991246938705, -0.03434913605451584, 0.021817391738295555, -0.04203113541007042, -0.014937218278646469, 0.029719244688749313, 0.0036987399216741323, 0.10449586808681488, 0.03729778155684471, 0.015144141390919685, -0.007429811172187328, -0.02007148414850235, -0.008005314506590366, -0.04293642193078995, 0.04192767292261124, -0.013747413642704487, -0.008729543536901474, 0.010520716197788715, 0.007429811172187328, -0.0005144772585481405, 0.006479260977357626, -0.01417419221252203, 0.046661026775836945, 0.015402793884277344, 0.02515401691198349, 0.0047301193699240685, -0.020627588033676147, 0.011264343746006489, 0.0362890362739563, -0.01467856578528881, -0.0026447284035384655, 0.0362890362739563, -0.010068072937428951, -0.0009295347263105214, 0.022037247195839882, 0.008839471265673637, -0.03727191686630249, 0.007397479843348265, -0.05700715258717537, -0.023330513387918472, -0.04019469767808914, -0.03274548798799515, -0.007591469679027796, -0.032926544547080994, -0.020847443491220474, -0.00843855831772089, 0.016321012750267982, 0.016333945095539093, -0.017032308503985405, -0.1068754717707634, -0.06564616411924362, -0.03494403883814812, 0.020187877118587494, -0.016476204618811607, 0.010637110099196434, -0.00048537878319621086, 0.030391743406653404, -0.0053347209468483925, -0.012286024168133736, -0.005037270020693541, 0.02933126501739025, -0.02290373481810093, -0.0018138050800189376, -0.03341798484325409, -0.0032574129290878773, -0.009499036706984043, 0.026033438742160797, -0.04210872948169708, 0.024675508961081505, -0.011102685704827309, -0.025425603613257408, 0.04624718055129051, -0.017290962859988213, -0.022515755146741867, -0.003553247544914484, 0.0067185149528086185, -0.04997178539633751, 0.0021015566308051348, 0.021843256428837776, 0.005787363741546869, 0.008231636136770248, -0.010934561491012573, 0.007423344999551773, 0.0030472571961581707, 0.010869897902011871, -0.012531744316220284, -0.013398231938481331, 0.04748871549963951, -0.0015850587515160441, -0.022244170308113098, 0.006016918458044529, 0.053644660860300064, -0.03465951979160309, 0.020640520378947258, -0.01846783421933651, 0.04686794802546501, 0.030521070584654808, -0.012460614554584026, 0.06047310307621956, 0.00922098383307457, -0.020330136641860008, -0.028555305674672127, -0.038979027420282364, 0.01686418429017067, -0.023175321519374847, -0.018403170630335808, -0.010656509548425674, 0.004859445616602898, 0.007488008122891188, -0.010934561491012573, -0.04011709988117218, -0.0034918172750622034, -0.0015220120549201965, -0.0219984482973814, -0.040970657020807266, 0.009130455553531647, 0.010268529877066612, 0.02201138250529766, 0.014264720492064953, 0.004995238501578569, 0.0021080230362713337, -0.05002351477742195, 0.04353132098913193, -0.009589564986526966, 0.004012356977909803, -0.009014061652123928, -0.03269375488162041, 0.01128374319523573, -0.032616160809993744, -0.003986491356045008, 0.021507008001208305, 0.0033172264229506254, 0.012615806423127651, 0.022787341848015785, 0.021817391738295555, 0.02096383646130562, 0.00796651653945446, -0.03784095495939255, 0.001710343873128295, -0.017316827550530434, 0.060007527470588684, -0.03530615195631981, -0.005140731111168861, -0.027468962594866753, 0.019980954006314278, -0.0022292667999863625, -0.0032024490647017956, 0.040918927639722824, 0.01624341681599617, -0.028141461312770844, 0.050799474120140076, -0.02489536441862583, -0.022774407640099525, -0.024740172550082207, 0.03142635524272919, 0.0028144693933427334, -0.01785999909043312, -0.016747791320085526, 0.006324069108814001, 0.04529016464948654, -0.01977403275668621, -0.047281794250011444, 0.01754961535334587, 0.031400490552186966, -0.003194366116076708, -0.022683879360556602, -0.00500493822619319, 0.025089353322982788, -0.011070353910326958, 0.027236174792051315, -0.048885442316532135, -0.029460592195391655, -0.027210310101509094, -0.015829572454094887, 0.03119356743991375, -0.010701773688197136, 0.025231612846255302, -0.02161046862602234, 0.015092410147190094, -0.005548109766095877, -0.00581969553604722, -0.051083993166685104, 0.011238479055464268, -0.003950926475226879, 0.0056515708565711975, 0.007022432517260313, -0.010165068320930004, 0.021545806899666786, 0.004025289323180914, 0.0362890362739563, 0.011923909187316895, 0.010391389951109886, 0.018558362498879433, 0.030055494979023933, 0.017368558794260025, 0.002654427895322442, 0.004762450698763132, 0.006560089997947216, -0.020498260855674744, -0.026899926364421844, -0.03354731202125549, 0.024675508961081505, -0.03528028726577759, 0.013346501626074314, -0.03315933048725128, 0.013475827872753143, -0.025671323761343956, -0.006149478256702423, 0.0035047500859946012, 0.007798391859978437, -0.033909425139427185, -0.04195353761315346, -0.031400490552186966, 0.008108776062726974, 0.04645410180091858, -0.023627962917089462, -0.014057798311114311, -0.027624154463410378, -0.00907872524112463, 0.011658789590001106, 0.006653851829469204, -0.0082639679312706, -0.008328630588948727, 0.023692626506090164, -0.04231565445661545, -0.015493323095142841, -0.06445635855197906, -0.03499576821923256, 0.013734481297433376, 0.03269375488162041, 0.04880784824490547, -0.07412999123334885, 0.025684256106615067, -0.0008244568598456681, -0.04293642193078995, 0.010255596600472927, 0.0021306551061570644, 0.001917266403324902, 0.0018962507601827383, 0.011762251146137714, -0.003656708635389805, -0.01716163568198681, -0.0037601699586957693, -0.02011028118431568, -0.060990408062934875, -0.010553047992289066, 0.0036373096518218517, -0.016178753226995468, -0.05030803382396698, 0.007319883909076452, -0.011083287186920643, -0.01033319253474474, -0.0034497862216085196, 0.016023561358451843, 0.0034368534106761217, -0.006188276223838329, -0.020252540707588196, 0.01654086820781231, 0.014924285933375359, 0.02798626944422722, 0.00533795403316617, -0.009014061652123928, -0.0016238567186519504, -0.027960404753684998, -0.03383183106780052, -0.003944460302591324, 0.005218327045440674, 0.03054693527519703, 0.0061462451703846455, 0.012990853749215603, -0.012842128053307533, 0.06326655298471451, 0.007378080859780312, 0.011050955392420292, -0.0432468056678772, -0.0027384900022298098, 0.005105166230350733, -0.01128374319523573, 0.012027370743453503, -0.011723453179001808, -0.04278123006224632, -0.0014937218511477113, 0.017730671912431717, -0.018648890778422356, -0.016760723665356636, -0.004717186558991671, 0.0023990077897906303, -0.023615030571818352, -0.030340012162923813, -0.030960779637098312, 0.021843256428837776, -0.014600969851016998, -0.015777841210365295, 0.0017733905697241426, -0.022451091557741165, 0.012117899022996426, 0.022464023903012276, 0.032047122716903687, -0.009757689200341702, -0.044126223772764206, -0.004089952912181616, -0.02452031709253788, 0.0058584935031831264, -0.01598476432263851, -0.025425603613257408, -0.0037569368723779917, -0.03375423327088356, 0.01080523431301117, 0.013146045617759228, 0.005402617156505585, 0.0029486457351595163, -0.019696436822414398, 0.022412294521927834, -0.011846313253045082, -0.0016990277217701077, 0.0041740150190889835, 0.006847841665148735, 0.018623026087880135, -0.0369098037481308, -0.10134030133485794, -0.0035985116846859455, -0.005923156626522541, 0.010546581819653511, 0.010404322296380997, -0.02161046862602234, 0.03186606615781784, 0.018545430153608322, -0.011322541162371635, -0.013592221774160862, 0.009938746690750122, -0.031710874289274216, -0.02260628342628479, 0.006207675207406282, -0.032926544547080994, -0.021481143310666084, -0.02616276405751705, 0.020912105217576027, 0.02168806456029415, -0.01386380847543478, -0.016657261177897453, 0.0023569767363369465, 0.01594596542418003, 0.026175696402788162, -0.018002258613705635, -0.00629173731431365, 0.017096972092986107, -0.042832959443330765, 0.0011995038948953152, 0.002845184411853552, 0.026693003252148628, 0.0007060422212816775, 0.02930540032684803, 0.012848594225943089, -0.02930540032684803, -0.014303518459200859, 0.01255760993808508, -3.604473022278398e-05, 0.0004829539102502167, 0.024960028007626534, 0.010152135975658894, -0.055920809507369995, 0.02710684761404991, 0.007901852950453758, 0.022515755146741867, -0.04143623262643814, 0.008399760350584984, -0.030779723078012466, 0.01068884041160345, 0.005522244609892368, 0.0034627187997102737, -0.02512815222144127, 0.007850122638046741, -0.013003786094486713, -0.0010814934503287077, 0.005519011057913303, 0.010029274970293045, 0.01560971699655056, -0.005780897568911314, -0.007378080859780312, -0.02517988346517086, 0.024753104895353317, 0.04231565445661545, -0.020601721480488777, -0.04104825109243393, -0.015454525128006935, 0.005780897568911314, 0.021584603935480118, -0.028607036918401718, -0.028813960030674934, 0.01479495968669653, -0.019916292279958725, -0.00693190423771739, -0.03559067100286484, -0.015803705900907516, 0.015506255440413952, -0.0036308434791862965, 0.004397103097289801, -0.06461155414581299, 0.028865689411759377, 0.02545146830379963, 0.0030601900070905685, 0.011057421565055847, 0.018920477479696274, -0.009602497331798077, -0.005635404959321022, 0.02108023129403591, -0.03279721736907959, 0.013029651716351509, 0.005852027330547571, 0.02834838442504406, 0.00011073587666032836, -0.007339282892644405, -0.007080629467964172, -0.002447505248710513, -0.028788093477487564, -0.04047921672463417, -0.005722700618207455, 0.018002258613705635, 0.00724228797480464, 0.027132714167237282, 0.03882383555173874, 0.014161258935928345, -0.020123213529586792, -0.01910153403878212, -0.013437029905617237, 0.0011914209462702274, -0.02868463285267353, 0.007578536868095398, 0.003533848561346531, 0.015363995917141438, -0.02104143239557743, -0.039315275847911835, -0.008173438720405102, 0.014976016245782375, -0.0005552959628403187, 0.019256725907325745, 0.0043486058712005615, -0.025373872369527817, -0.022709745913743973, 0.007416878826916218, 0.04340199753642082, 0.003465952118858695, 0.02741723135113716, 0.003834532806649804, -0.008761875331401825, -0.022438159212470055, 0.025102287530899048, -0.021248355507850647, 0.005767964757978916, -0.0007981873932294548, -0.00542848277837038, 0.023977145552635193, 0.021170759573578835, 0.028891555964946747, -0.006427530199289322, -0.005202161148190498, 0.00010790685337269679, -0.0002822956594172865, 0.0194507148116827, -0.01018446683883667, 0.00039565845509059727, -0.006020151544362307, 0.018403170630335808, -0.025412671267986298, 0.022153640165925026, -0.01691591553390026, -0.036418359726667404, 3.440288855927065e-05, 0.024365125223994255, 0.010844032280147076, -0.006104214116930962, -0.0008842704119160771, -0.029538188129663467, -0.0033818897791206837, 0.0012625505914911628, 0.004862678702920675, -0.01654086820781231, -0.008716610260307789, 0.04107411950826645, 0.0420052707195282, 0.026253292337059975, -0.004015590064227581, -0.002951878821477294, 0.024339260533452034, -0.018390238285064697, -0.0296416487544775, -0.03186606615781784, 0.020149080082774162, -0.011400137096643448, 0.00013023590145166963, -0.02708098292350769, 0.0067831785418093204, 0.03659942001104355, 0.013359433971345425, 0.03116770274937153, -0.0028112363070249557, 0.024921229109168053, -0.022451091557741165, 0.022696811705827713, 0.03864277899265289, 0.002019111067056656, -0.027262039482593536, -0.007216422352939844, 0.03786681964993477, -0.019179129973053932, 0.056800227612257004, -0.004733352456241846, 0.025257479399442673, 0.041591424494981766, 0.048885442316532135, 0.038384124636650085, -0.00731341727077961, 0.01968350261449814, 0.02098970115184784, 0.01563558168709278, 0.002251898869872093, 0.02321411855518818, 0.015726109966635704, -0.037116724997758865, 0.00590052455663681, 0.018972206860780716, 0.018377305939793587, -0.016101157292723656, -0.023809021338820457, -0.002877516206353903, -0.0005039694951847196, -0.026563676074147224, 0.006686183623969555, 0.00861961580812931, 0.021856190636754036, 0.016980579122900963, -0.0046654557809233665, 0.006686183623969555, -0.007740194909274578, -0.00313940248452127, 0.01910153403878212, 0.030676262453198433, -0.002145204460248351, -0.007882454432547092, 0.019179129973053932, -0.016760723665356636, 0.012117899022996426, 0.01749788410961628, -0.0413845032453537, 0.0020029451698064804, 0.023110657930374146, 0.0008899284293875098, -0.004704253748059273, -0.018247978761792183, -0.03445259854197502, 0.04192767292261124, -0.014976016245782375, 0.0043777041137218475, 0.0037116724997758865, 0.0019948622211813927, -0.008238102309405804, 0.009680093266069889, -0.024714307859539986, -0.024015944451093674, 0.03822893276810646, -0.005839094519615173, -0.03812547028064728, 0.015467457473278046, 0.0014347166288644075, 0.00042475693044252694, 0.023110657930374146, 0.08416572958230972, -0.001703877467662096, -0.0035758796148002148, -0.012286024168133736, 0.023058926686644554, 0.008658413775265217, 0.011691121384501457, 0.0203818678855896, 0.03502163290977478, 0.017924662679433823, 0.030081359669566154, 0.005577208008617163, 0.012783931568264961, -0.0042968750931322575, 0.00022207797155715525, 0.015131208114326, -0.007856588810682297, -0.00564833777025342, -0.054265428334474564, -0.011374271474778652, 0.01273220032453537, 0.014083663001656532, -0.00017843024397734553, -0.020912105217576027, 0.0019738466944545507, -0.018351439386606216, 0.018946342170238495, 0.02132595144212246, -0.008166972547769547, 0.01542865950614214, 0.002675443422049284, -0.0021969350054860115, 0.009479637257754803, -0.037090860307216644, -0.019308457151055336, -0.028193192556500435, -0.0026398785412311554, 0.023097725585103035, 0.0007472650613635778, 0.010236198082566261, -0.01562264934182167, 0.011497131548821926, 0.029719244688749313, -0.0014088512398302555, 0.022425226867198944, -0.005156897008419037, 0.014562171883881092, 0.012117899022996426, -0.025735987350344658, -0.027598289772868156, 0.019515378400683403, -0.03781508654356003, 0.019036870449781418, 0.001925349235534668, 0.030133090913295746, -0.0056224726140499115, -0.02386075258255005, 0.031012510880827904, 0.019968021661043167, 0.02801213413476944, 0.0077078635804355145, -0.02040773257613182, -0.03225404769182205, 0.016773656010627747, -0.027960404753684998, 0.027003386989235878, 0.012370086275041103, -0.0044617666862905025, 0.031685009598731995, -0.0003037153510376811, 0.0013102397788316011, 0.00627880496904254, 0.01748495176434517, -0.034866441041231155, -0.005664503667503595, 0.017252163961529732, 0.0008430475718341768, -0.022852003574371338, 0.006369333248585463, -0.00015488876670133322, -0.01691591553390026, 0.005422016140073538, 0.0012180946068838239, -0.03085731901228428, 0.0030957546550780535, 0.026188630610704422, -0.010339658707380295, -0.04774736985564232, 0.02546440064907074, -0.025089353322982788, -0.014303518459200859, -0.023382242769002914, 0.00874894205480814, 0.011807515285909176, 0.03525442257523537, 0.0066085876896977425, -0.02358916588127613, -0.01749788410961628, 0.010727638378739357, 0.004688087850809097, -0.0004910368006676435, -0.03447846323251724, -0.004225745797157288, 0.08044112473726273, -0.03631490096449852, -0.01258994173258543, 0.020252540707588196, 0.026848195120692253, 0.02227003499865532, -0.008419159799814224, -3.0184619390638545e-05, -0.02326584979891777, 0.01813158392906189, -0.03636663034558296, 0.022063111886382103, -0.012997319921851158, -0.011387203820049763, -0.0058584935031831264, 0.010941027663648129, -0.01787293143570423, 0.00030977753340266645, -0.013553423807024956, 0.0210026353597641, -0.008567885495722294, -0.05581734701991081, -0.01749788410961628, 0.012201962061226368, 0.017704807221889496, -0.017743604257702827, -0.013954336754977703, -0.006880173459649086, -0.026369687169790268, 0.03176260367035866, 0.013320636004209518, 0.009718891233205795, -0.04435901343822479, 0.02483070082962513, 0.00493704155087471, -0.0017556081293150783, -0.028089730069041252, 0.01780826784670353, 0.004878844600170851, -0.005034036468714476, -0.0038377658929675817, -0.01082463376224041, -0.0190756693482399, -0.00016024369688238949, 0.013631019741296768, 0.004251610953360796, -0.020925039425492287, 0.022735610604286194, -0.005050202365964651, -0.011406603269279003, 0.004513496998697519, 0.017109904438257217, 0.021222488954663277, -0.027468962594866753, -0.013255973346531391, -0.005059902090579271, 0.002560666063800454, -0.0018526030471548438, 0.001784706604667008, 0.02956405282020569, -0.04099652171134949, -0.017265096306800842, -0.02450738474726677, 0.002654427895322442, -0.012803330086171627, -0.012835661880671978, -0.011859246529638767, 0.002830635290592909, -0.022192439064383507, 0.03533201664686203, -7.76969754952006e-05, 0.03269375488162041, -0.023084791377186775, -0.02383488602936268, -0.004209579899907112, 0.0038539317902177572, -0.019696436822414398, 0.019282590597867966, -0.006938370410352945, 0.017407355830073357, -0.02483070082962513, 0.003244480350986123, -0.0005350886494852602, -0.019657637923955917, -0.0159718319773674, -0.00262856250628829, 0.01661846414208412, -0.022994263097643852, -0.014109528623521328, 0.004319507163017988, -0.0138250095769763, 0.005076067987829447, 0.0018396704690530896, -0.024326328188180923, 0.024132337421178818, -0.024921229109168053, 0.026240359991788864, -0.02511521987617016, -0.006065416149795055, 0.04322093725204468, -0.008141107857227325, 0.017898796126246452, 0.04999765008687973, 0.011587660759687424, -0.00652129203081131, 0.018066922202706337, -0.053023893386125565, -0.002845184411853552, -0.026343822479248047, 0.0001954043545993045, 0.0019738466944545507, -0.004070553928613663, 0.01683831959962845, -0.025373872369527817, -0.02904674783349037, 0.01431645080447197, -0.0015737427165731788, 0.01881701499223709, -0.0062270741909742355, -0.010229731909930706, 0.034607790410518646, 0.0055093117989599705, 0.0023117123637348413, 0.011199681088328362, -0.014833757653832436, 0.01685125194489956, -0.0037504704669117928, 0.03251269832253456, -0.021778594702482224, 0.013643953017890453, -0.02136474847793579, 0.025218680500984192, 0.015454525128006935, -0.011943308636546135, 0.0382806621491909, 0.015816638246178627, -0.0035564806312322617, 7.072546577546746e-05, -0.027313770726323128, -0.014031932689249516, 0.01321070920675993, -0.003299443982541561, 0.0067831785418093204, -0.0053023891523480415, 0.001280333031900227, -0.005270057823508978, -0.013540491461753845, -0.02166219986975193, 0.017459087073802948, 0.010553047992289066, 0.0005096275126561522, 0.002588147995993495, -0.012486480176448822, 0.04751458019018173, -0.002702925354242325, -0.03370250388979912, 0.01431645080447197, -0.03152981773018837, 0.04779909923672676, -0.003714905586093664, 0.0528169684112072, 0.00793418474495411, -0.009014061652123928, 0.04244497790932655, 0.04353132098913193, -0.019347254186868668, -0.03768576309084892, 0.003063423093408346, 0.01976109854876995, -0.019942156970500946, -0.0013336802367120981, -0.00017206495977006853, 0.0165925994515419, -0.014588036574423313, -0.020575856789946556, 0.0053961509838700294, 0.01275159977376461, -0.01207910105586052, -0.013631019741296768, 0.03978085145354271, 0.0015171623090282083, -0.043143343180418015, 0.01911446638405323, 0.02930540032684803, 0.002200168324634433, -0.003802201012149453, 0.016683127731084824, 0.015661446377635002, 0.002520251553505659, -0.014445777982473373, 0.02834838442504406, 0.03352144733071327, 0.03129702806472778, 0.017989326268434525, 0.02582651562988758, 0.02136474847793579, 0.002602697117254138, -0.03191779553890228, 0.03921181336045265, 0.010876364074647427, 0.011529463343322277, -0.01386380847543478, 0.011484199203550816, -0.0018606859957799315, 0.014019000343978405, 0.001237493590451777, 0.0003188708215020597, 0.01116734929382801, -0.0007577728829346597, 0.023071859031915665, 0.04560054838657379, 0.012499412521719933, 0.0007953583844937384, 0.007908319123089314, -0.015170006081461906, 0.01113501749932766, 0.025619592517614365, 0.029072612524032593, 0.011180281639099121, -0.03271962329745293, -0.00023501062241848558, -0.01449750829488039, -0.0018412870122119784, 0.006437229923903942, -0.007972982712090015, -0.005076067987829447, 0.014394046738743782, 0.004403569735586643, -0.005745332688093185, 0.017433220520615578, -0.005350886844098568, -0.04177248105406761, 0.00891060009598732, -0.015195871703326702, 0.0344267338514328, -0.024740172550082207, -0.005321788135915995, -0.002790220780298114, -0.013747413642704487, 0.029486456885933876, -0.03119356743991375, -0.012221360579133034, 0.018066922202706337, -0.026977522298693657, -0.021558739244937897, 0.008031180128455162, 0.02225710265338421, 0.013294771313667297, -0.032616160809993744, -0.010759970173239708, -0.009984010830521584, 0.008548486046493053, -0.005852027330547571, -0.03207298740744591, 0.003831299487501383, 0.0015365612925961614, 0.0068931058049201965, -0.021183691918849945, 0.023071859031915665, 0.005295922979712486, -0.016075292602181435, -0.002449121791869402, -0.011438935063779354, -0.026951655745506287, -0.016657261177897453, -0.002977744210511446, 0.010779369622468948, 0.012725734151899815, -0.04394516721367836, -0.014122460968792439, 0.0016214317874982953, 0.033961158245801926, 0.010488384403288364, 0.010229731909930706, 0.01323657389730215, 0.007294018287211657, 0.008283366449177265, -0.0036470091436058283, 0.010287928394973278, -0.011426001787185669, 0.026059303432703018, -0.019204994663596153, 0.0239254143089056, 0.010391389951109886, 0.03693566843867302, 0.011212613433599472, -0.009505502879619598, -0.0017814735183492303, 0.006563323084264994, 0.01462683454155922, -0.010242664255201817, -0.01687711663544178, 0.009363243356347084, -0.0331851989030838, -0.01288092602044344, 0.020446529611945152, 0.011083287186920643, -0.009039927273988724, 0.0012261775555089116, 0.022114843130111694, 0.015260535292327404, 0.030081359669566154, 0.0021904688328504562, -0.005806762725114822, 0.02514108456671238, 0.008988196030259132, -0.0005120523856021464, 0.020433597266674042, 0.005240959115326405, -0.005043736193329096, 0.002044976456090808, -0.005383218172937632, 0.007901852950453758, 0.049221690744161606, -0.0076755317859351635, 0.00407378701493144, 0.00047446685493923724, -0.007268153131008148, 0.025425603613257408, -0.002817702479660511, -0.0030795889906585217, 0.005703301634639502, 0.0038991959299892187, -0.03212472051382065, 0.03499576821923256, -0.02329171448945999, 0.024119405075907707, 0.018674755468964577, 0.014109528623521328, -0.006595654878765345, -0.002258365275338292, -0.02007148414850235, 0.009298579767346382, -0.014458710327744484, -0.0035500142257660627, 0.014083663001656532, -0.012997319921851158, 0.021261287853121758, 0.009330911561846733, -0.019890425726771355, 0.030960779637098312, 0.0022777642589062452, 0.01946364901959896, -0.001770157366991043, -0.014911353588104248, 6.754282367182896e-05, 0.035771727561950684, -0.005674202926456928, 0.00022329040803015232, 0.017290962859988213, -0.01322364155203104, 0.02102850005030632, -0.02455911599099636, -0.028917420655488968, -0.007940650917589664, 0.0074686091393232346, 0.008839471265673637, -0.023459838703274727, -0.020782779902219772, 0.01018446683883667, -0.013850875198841095, -0.01180104911327362, 0.021817391738295555, 0.014536306262016296, 0.004649289883673191, -0.0019819296430796385, 1.212436586683907e-06, -0.019321389496326447, 0.005722700618207455, -0.006873706821352243, 0.023796088993549347, 0.001904333708807826, 0.017135770991444588, 0.022050179541110992, -0.006951303221285343, -0.0028823658358305693, -0.024403924122452736, -0.0032703455071896315, 0.04391930252313614, 0.005370285827666521, -0.0003140210756100714, -0.019592974334955215, -0.008567885495722294, 0.00010214778012596071, 0.005185995250940323, 0.013566357083618641, 0.02705511823296547, 0.010520716197788715, -0.007022432517260313]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"t=1
J(π∗)−J(πt)
≤Tα(T,Doff)β·Ccov+βp
6Tdlog(1 + T/dλ )−ηTX
t=1Ext∼d0
DKL(πt
1(·|xt)∥π∗(·|xt))
.
which concludes the proof.
42
D.3 Proof of Theorem 2
Proof of Theorem 2. We recall the value decomposition
J(π∗)−J(πt0)
=Ext0∼d0h
Eπ∗[r∗(xt0, a)−ˆr(xt0, a)] +Eπt0[ˆr(xt0, a)−r∗(xt0, a)]−η·Ext0∼d0
DKL(π∗(·|xt0)∥πt0(·|xt0))i
≤Ext0∼d0h
θ∗−θt0, ϕ(xt0, π∗)−ϕ(xt0, πref)i
| {z }
P′
1+Ext0∼d0h
θt0−θ∗, ϕ(xt0, πt0)−ϕ(xt0, πref)i
| {z }
P′
2
−η·Ext0∼d0
DKL(π∗(·|xt0)∥πt0(·|xt0))i
.
Following the proof of batch online learning (Theorem 3), we can control the exploration error P′
2as in
Equation (12) by fixing π2
tasπref. We notice that since πrefis directly available to the agent and is used to
collect data, we do not need to optimism to relate its uncertainty to the data. Therefore, we only need to
additionally handle the suboptimality source P1, which satisfies
P′
1≤β· ∥Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)]∥Σ−1
off+D1:t0,
by Cauchy-Schwarz inequality and Lemma 8. It follows that
J(π∗)−J(πt0)
≤r
exp γT(λ)
T)−1 + 2r
log(2/δ)
2m
·Cs
d+ log( T/δ)
γ2m+λB2
+β· ∥Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)]∥Σ−1
off+D1:t0−ηExt0∼d0
DKL(π∗(·|xt0)∥πt0(·|xt0))
≤Cs
dlog(T/δ)
γ2m+β· ∥Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)]∥Σ−1
off+D1:t0−ηExt0∼d0
DKL(π∗(·|xt0)∥πt0(·|xt0))
,(26)
where we use T≥dlog(T) and C >0 is an absolute constant. Now we proceed to suppose that Assumption 2
holds. Then, we have
β·∥Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)]∥Σ−1
off+D1:t0≤β·∥Ex∼d0[ϕ(x, π∗)−ϕ(x, πref)]∥Σ−1
off≤(mT)α(mT,Doff)−1β·Ccov.
Plugging this estimation back and combining with the choices of parameters, we conclude the proof of
Theorem 2.
In particular, in Proposition 2, when noff≈mTas in the LLaMA2 project (Touvron et al., 2023), we have
α(mT,Doff)≈1
2. In this case, the final sample complexity to find an ϵ-optimal policy is
eOd2+dC2
cov
γ2ϵ2
,
where the convergence rate is jointly determined by the data coverage of the offline dataset and","[-0.001974910730496049, -0.03714720532298088, 0.03454221412539482, -0.016906406730413437, 0.004633632022887468, 0.0010175756178796291, 0.012849129736423492, 0.032510317862033844, -0.03055657260119915, 0.04952092468738556, 0.06189464405179024, -0.028785178437829018, -0.028785178437829018, -0.005721217021346092, 0.02163447067141533, -0.02886332757771015, 0.025411710143089294, -0.04834868013858795, -0.0018381484551355243, 0.04363363981246948, -0.025997834280133247, -0.05538216233253479, 0.0449882373213768, 0.02430458925664425, 0.014483763836324215, -0.036834608763456345, 0.028759127482771873, 0.0005975203821435571, 0.025489861145615578, -0.03258846700191498, 0.030400274321436882, -0.04795793071389198, -0.016216084361076355, -0.03735560551285744, 0.00178930489346385, 0.05658045783638954, 0.02259831875562668, 0.013207316398620605, -0.022350843995809555, -0.005727729294449091, -0.017857229337096214, -0.03422961384057999, -0.08434968441724777, 0.01947232522070408, 0.01942022703588009, -0.00464340066537261, -0.012100194580852985, 0.004741088021546602, 0.016684982925653458, 0.024747436866164207, -0.0411328449845314, 0.009781750850379467, -0.02545078657567501, -0.0035818659234791994, -0.03412541374564171, -0.005861235316842794, 0.015499711036682129, 0.03706905618309975, 0.06788612902164459, -0.057101454585790634, 0.02823812887072563, 0.02078784815967083, 0.023249566555023193, 0.011292646639049053, -0.01965467631816864, -0.012738417834043503, -0.04157569631934166, 0.05559055879712105, -0.0030445861630141735, 0.05751825496554375, -0.025307511910796165, -0.027847379446029663, 0.03350021690130234, -0.006600402295589447, -0.02351006492972374, 0.006942307576537132, 0.02055339887738228, 0.025528935715556145, 0.033031318336725235, -0.024695338681340218, 0.03310946747660637, 0.008909077383577824, 0.05668465793132782, -0.02948852628469467, 0.021504221484065056, -0.07913970202207565, -0.015708111226558685, -0.004871337674558163, -0.07293981313705444, -0.009788262657821178, -0.011416384018957615, 0.010003174655139446, 0.03508926182985306, 0.039335399866104126, 0.04514453560113907, 0.0014197214040905237, 0.009306339547038078, -0.033369965851306915, 0.027065882459282875, -0.00926075130701065, 0.02810787968337536, -0.05934175103902817, 0.023418890312314034, -0.03256241977214813, 0.04074209928512573, -0.017700931057333946, -0.008883027359843254, 0.01897737756371498, -0.03738165646791458, -0.02748268097639084, -0.05087552219629288, -0.019172752276062965, -0.01658078283071518, 0.04696803167462349, 0.03277081623673439, -0.04840077832341194, -0.04050764814019203, 0.0262322835624218, -0.022064294666051865, -0.022989066317677498, 8.288153185276315e-05, -0.0031683233100920916, 0.004207064397633076, 0.019719799980521202, 0.05105787143111229, -0.00909142754971981, 0.0080038420855999, -0.08117159456014633, -0.014509813860058784, 0.001298426417633891, 0.010667447932064533, 0.04134124517440796, -0.022936968132853508, -0.025138186290860176, -0.030712872743606567, 0.05751825496554375, 0.012341156601905823, 0.03123387135565281, 0.03641780838370323, -0.02119162119925022, -0.008752778172492981, -0.028941476717591286, -0.04952092468738556, 0.015174087136983871, -0.0577266551554203, 0.009384488686919212, -0.010087837465107441, 0.015356436371803284, 0.02543776109814644, 0.0007652168278582394, -0.02641463279724121, -0.046655431389808655, -0.017479505389928818, 0.004526176024228334, 0.005363030359148979, -0.02545078657567501, -0.030764972791075706, 0.0591854527592659, 0.040585797280073166, -0.004675963427871466, -0.023614265024662018, 0.060800548642873764, 0.02448693849146366, 0.013532941229641438, 0.03459431231021881, 0.05803925544023514, -0.006356183905154467, 0.016098858788609505, -0.06517693400382996, -0.03983034938573837, 0.01096051000058651, 0.046212583780288696, -0.022311769425868988, -0.03290106728672981, 0.008095016703009605, -0.036834608763456345, -0.024226438254117966, -0.0466814823448658, 0.01857360266149044, -0.039674051105976105, 0.026662107557058334, -0.008720215409994125, 0.047619279474020004, -0.0004656425735447556, -0.03209351748228073, -0.015148037113249302, 0.0031943731009960175, -0.009618937969207764, 0.02384871430695057, -0.012061120010912418, 0.02169959619641304, 0.02374451607465744, 0.019094601273536682, -0.025984808802604675, 0.013415716588497162, -0.019511401653289795, 0.04970327392220497, 0.04420673847198486, -0.010817235335707664, 0.049494873732328415, 0.03172881901264191, -0.008407616056501865, -0.006076147314161062, -0.03443801403045654, 0.0267011821269989, 0.019524425268173218, 0.015043837018311024, 0.017805129289627075, -0.050354521721601486, 0.002561034169048071, 0.018534528091549873, -0.008075479418039322, -0.010550223290920258, -0.00999666191637516, -0.023418890312314034, 0.026935631409287453, -0.04264374449849129, 0.017414381727576256, 0.004656425677239895, 0.049390677362680435, -0.026610007509589195, 0.042070645838975906, 0.020266849547624588, 0.010485098697245121, -0.008349004201591015, 0.003215538803488016, 0.03561025857925415, -0.03485481068491936, 0.03925725072622299, -0.020188698545098305, 0.03316156566143036, 0.0031276203226298094, -0.02499491162598133, -0.03313551843166351, 0.04100259765982628, -0.02492978796362877, -0.022533193230628967, -0.017766054719686508, -0.016828257590532303, -0.03589680790901184, -0.00928680133074522, 0.03350021690130234, -0.014431663788855076, -0.034959010779857635, -0.023197466507554054, 0.006916257552802563, -0.017766054719686508, -0.020631548017263412, -0.01318126730620861, -0.0196025762706995, 0.00988595001399517, -0.030764972791075706, -0.03204141929745674, -0.053141865879297256, -0.0531679168343544, 0.02651883289217949, 0.023431915789842606, 0.03180696815252304, -0.02022777497768402, 0.044050440192222595, -0.00897420197725296, 0.013480841182172298, -0.0216474961489439, 0.0031390171498060226, 0.018443353474140167, -0.005073224660009146, 0.024669287726283073, -0.004073558375239372, 0.0428260937333107, -0.002074226038530469, 0.015929535031318665, 0.012842617928981781, -0.055069562047719955, 0.030139774084091187, -0.045873936265707016, -0.04782767966389656, -0.0037674717605113983, 0.045691583305597305, -0.05991484969854355, 0.00017186850891448557, -0.04806213080883026, 0.013819490559399128, 0.05923755094408989, 0.002280997345224023, 0.03545396029949188, -0.07184571772813797, 0.022910917177796364, 0.0026912838220596313, -0.03430776298046112, -0.025294486433267593, 0.02868097834289074, -0.027925530448555946, 0.028941476717591286, -0.012145781889557838, -0.023536115884780884, -0.0061347596347332, 0.0012691202573478222, -0.04618653282523155, 0.02067062258720398, 0.031494371592998505, 0.020592473447322845, 0.012959842570126057, -0.021426070481538773, 0.019667699933052063, -0.008824415504932404, 0.014132089912891388, 0.021504221484065056, 0.01326592918485403, -0.026271358132362366, 0.006877182517200708, -0.02401803992688656, 0.04436303675174713, -0.040976546704769135, 0.03949170187115669, -0.0006614241283386946, -0.008362028747797012, 0.019381150603294373, -0.01919880136847496, -0.01919880136847496, -0.052334319800138474, -0.02039709873497486, -0.052855316549539566, -0.022963017225265503, -0.016854306682944298, 0.017583705484867096, -0.00897420197725296, -0.013037992641329765, -0.0005580384167842567, 0.005711447913199663, -0.030582623556256294, -0.016606833785772324, -0.008609503507614136, 0.03175486996769905, -0.02748268097639084, 0.01744043081998825, -0.024786513298749924, -0.03232796862721443, 0.05501746013760567, 0.03305736556649208, 0.018729902803897858, -0.06871972978115082, 0.02151724509894848, -0.03732955455780029, 0.02481256239116192, 0.021452121436595917, -0.0016647536540403962, 0.058195553719997406, 0.0014889165759086609, 0.07533641159534454, 0.0654374361038208, -0.02795157954096794, -0.023601241409778595, 0.027274280786514282, 0.025541961193084717, -0.015981635078787804, -0.01206763181835413, 0.007743343245238066, -0.06126944720745087, -0.014483763836324215, -0.014679137617349625, -0.0040605333633720875, 0.015343411825597286, 0.023418890312314034, 0.0027645493391901255, -0.027534781023859978, 0.038762301206588745, -0.011312183924019337, 0.011891795322299004, 0.0001428676041541621, -0.028420478105545044, 0.005942641291767359, 0.04918227717280388, -0.031833019107580185, -0.01947232522070408, -0.04894782602787018, -0.04061184823513031, 0.007150706835091114, 0.02050129882991314, 0.04840077832341194, -0.0028199052903801203, -0.007307006511837244, -0.0307910218834877, 0.002370544010773301, -0.003471153788268566, 0.008186192251741886, 0.025203311815857887, -0.01738833077251911, -0.02584153413772583, -0.00954078882932663, -0.04389413818717003, 0.022415969520807266, -0.03112967126071453, -0.0051969620399177074, 0.012992404401302338, -0.03602705895900726, -0.01630725897848606, 0.015812309458851814, 0.0750759094953537, 0.037694256752729416, 0.03839760273694992, -0.02447391301393509, -0.03290106728672981, -0.05736195668578148, -0.02061852253973484, -0.02636253461241722, -0.003236704273149371, 0.016346333548426628, 0.03191116824746132, 0.03313551843166351, 0.030869172886013985, 0.029175925999879837, 0.003949821460992098, 0.013213829137384892, -0.05087552219629288, -0.0001715632388368249, 0.007906154729425907, -0.014757287688553333, 0.03383886441588402, 0.057570356875658035, 0.05590315908193588, -0.009898975491523743, -0.02272856794297695, 0.02641463279724121, 0.027300331741571426, -0.05428806319832802, 0.028602827340364456, 0.02714403159916401, 0.017753031104803085, -0.013767390511929989, -0.019107626751065254, -0.0021165572106838226, 0.03811105340719223, 0.0071311695501208305, 0.02556801028549671, -0.07403391599655151, -0.012119731865823269, -0.012510481290519238, -0.010107374750077724, -0.029749024659395218, -0.022585293278098106, -0.007880105637013912, -0.006030560005456209, -0.0236924160271883, 0.013155217282474041, -0.011702933348715305, 0.007013944908976555, -0.06345763802528381, -0.03469851240515709, 0.0382673554122448, 0.011787595227360725, -0.038085002452135086, -0.001764883054420352, 0.05371496453881264, 0.0005075666704215109, -0.017023632302880287, -0.05350656434893608, 0.04840077832341194, -0.02259831875562668, 0.006649245973676443, -0.0029827174730598927, 0.002762921154499054, -0.04704618081450462, -0.017453456297516823, -0.0006573538412339985, 0.027612930163741112, 0.04345129057765007, 0.0428260937333107, 0.011435921303927898, -0.01760975643992424, 0.02254621870815754, 0.027013782411813736, -0.045795783400535583, 0.025802459567785263, -0.04993772506713867, -0.01607280969619751, 0.0257373359054327, 0.030921272933483124, -0.024447863921523094, 0.01789630576968193, -0.023991988971829414, 0.01738833077251911, -0.013259416446089745, -0.007541456259787083, 0.00931285135447979, -0.0021019040141254663, 0.060800548642873764, 0.0649685338139534, 6.375111115630716e-05, -0.01789630576968193, -0.03800685331225395, 0.01484846230596304, -0.04345129057765007, 0.04647308215498924, -0.014145114459097385, -0.02675328217446804, -0.02477348782122135, -0.014210239052772522, -0.03443801403045654, 0.016958506777882576, 0.0029778331518173218, 0.035870760679244995, -0.01828705333173275, -0.007521918509155512, 0.01460098847746849, -0.03355231508612633, 0.010576273314654827, -0.009039327502250671, -0.041888292878866196, -0.004675963427871466, 0.017049681395292282, -0.036313608288764954, 0.011116809211671352, 0.005262086633592844, 0.010354848578572273, -0.033474165946245193, -0.010967022739350796, -0.03829340264201164, -0.01982400007545948, -0.017192956060171127, 0.020774822682142258, -0.005994741339236498, -0.026909582316875458, -0.02220756933093071, 0.020709697157144547, 0.016046758741140366, 0.004031227435916662, -0.02237689308822155, -0.1135777160525322, -0.03891860321164131, -0.0246562622487545, 0.04610838368535042, -0.010973534546792507, 0.011904819868505001, -0.0007904527010396123, 0.00014195179392118007, 0.008212242275476456, -0.014079989865422249, 0.03521951287984848, -0.01744043081998825, -0.013174754567444324, 0.011409871280193329, -0.01335059106349945, -0.007111632265150547, 0.01366319041699171, 0.003290432272478938, -0.05996694788336754, 0.03878835216164589, -0.030061624944210052, -0.006271521560847759, 0.03912700340151787, 0.0034157976042479277, -0.008042917586863041, -0.02998347394168377, -0.012588630430400372, -0.043373141437768936, -0.022754617035388947, 0.005962178576737642, -0.001632191240787506, 0.01402788981795311, 0.007202806882560253, 0.009404025971889496, 0.0078019555658102036, 0.020371049642562866, -0.0040637897327542305, -0.0021947070490568876, 0.04649913311004639, 0.00888954009860754, -0.0346464142203331, 0.010172499343752861, 0.05897705256938934, -0.04175804555416107, 0.052568767219781876, -0.003026676829904318, 0.03574050962924957, 0.01664590835571289, -0.016229109838604927, 0.046368882060050964, 0.013767390511929989, -0.007619605865329504, -0.033317867666482925, -0.04350338876247406, -0.0033864914439618587, -0.04464958608150482, -0.016216084361076355, -0.013532941229641438, -0.003949821460992098, 0.021881945431232452, 0.005971947684884071, -0.058195553719997406, 0.0056007360108196735, 0.005115556064993143, -0.02703983150422573, -0.0365741066634655, -0.013832515105605125, -0.025659184902906418, 0.012705855071544647, 0.006043585017323494, 0.010862822644412518, 0.007847542874515057, -0.05663255602121353, 0.04782767966389656, -0.013018454425036907, 0.020019374787807465, -0.01129915937781334, -0.026909582316875458, 0.04801002889871597, -0.041653845459222794, 0.01987610012292862, 0.03326576575636864, 0.005144861992448568, 0.011624783277511597, 0.00030201641493476927, 0.027873430401086807, -0.00342231011018157, -0.01590348407626152, -0.017232032492756844, -0.008909077383577824, -0.002066085347905755, 0.06679203361272812, -0.021504221484065056, 0.00604684092104435, -0.02323654107749462, 0.021426070481538773, -0.01676313206553459, -0.007521918509155512, 0.027977630496025085, -0.01896435208618641, -0.026479758322238922, 0.03402121365070343, -0.0057472665794193745, -0.022819742560386658, -0.03852785378694534, 0.013884615153074265, 0.015200137160718441, 0.008427153341472149, -0.0307910218834877, 0.009449613280594349, 0.02095717191696167, -0.043086592108011246, -0.04209669306874275, 0.029045676812529564, 0.022923942655324936, 0.008980714716017246, -0.018782002851366997, -0.010400435887277126, 0.01484846230596304, -0.012386743910610676, 0.020970197394490242, -0.04845287650823593, -0.031780920922756195, -0.03402121365070343, -0.0048843626864254475, 0.030374223366379738, 0.009794775396585464, 0.03545396029949188, -0.012302081100642681, 0.022481093183159828, -0.005538867320865393, 0.010263673961162567, -0.03581865876913071, -0.010133424773812294, -0.003920515067875385, 0.007202806882560253, -0.006746932864189148, -0.0059068226255476475, 0.02420038916170597, 0.003930283710360527, 0.040012698620557785, -0.00795174203813076, 0.001641145907342434, 0.012152294628322124, 0.001904901466332376, 0.011761545203626156, -0.012048094533383846, -0.012731905095279217, -0.04173199459910393, -0.0241873636841774, -0.06444753706455231, -0.045118484646081924, 0.022468067705631256, -0.03949170187115669, -0.015174087136983871, -0.02732638083398342, 0.007619605865329504, -0.04365969076752663, -0.007385156583040953, 0.001698130159638822, -0.006505971308797598, -0.022220594808459282, -0.007775905542075634, -0.012263006530702114, -0.017974454909563065, 0.060175348073244095, -0.0017632549861446023, -0.011207984760403633, -0.014249314554035664, 0.006092428229749203, 0.031546469777822495, -0.016111884266138077, -0.027638981118798256, -0.007847542874515057, 0.01999332383275032, -0.03863205388188362, -0.005516073666512966, -0.04868732765316963, -0.005363030359148979, -0.008668115362524986, 0.043711788952350616, 0.051266271620988846, -0.0469159334897995, 0.0036990907974541187, -0.0011657346040010452, -0.04418068751692772, 0.005030893720686436, -0.005844953935593367, 0.008251316845417023, 0.0009345414000563323, 0.002004216890782118, -0.0029957424849271774, -0.01277749240398407, -0.01056324876844883, -0.007912667468190193, -0.058872852474451065, 0.004353595431894064, 0.012445355765521526, -0.009957587346434593, -0.05736195668578148, 0.02050129882991314, -0.006838107947260141, -0.017818154767155647, 0.0066459896042943, 0.01602070964872837, 0.0029078240040689707, -0.01036136131733656, -0.01612490974366665, 0.035532109439373016, 0.006746932864189148, 0.03066077269613743, 0.013331053778529167, 0.005408617667853832, 0.007613093126565218, -0.021386995911598206, -0.02935827523469925, 0.006095684599131346, 0.023939888924360275, 0.024265514686703682, 0.011325209401547909, 0.03925725072622299, -0.007730318233370781, 0.06700043380260468, -0.00013513403246179223, 0.010778160765767097, -0.03738165646791458, -0.005402104929089546, 0.0151610616594553, -0.014171164482831955, 0.0267011821269989, 0.00447082007303834, -0.03469851240515709, -0.01676313206553459, 0.007059532217681408, -0.03402121365070343, -0.019068552181124687, 0.010556736029684544, 0.013988815248012543, -0.015291311778128147, -0.03719930723309517, -0.029097776859998703, 0.03571445867419243, -0.004939718637615442, -0.030817072838544846, 0.006479921285063028, 0.010836772620677948, 0.0039074900560081005, 0.030921272933483124, 0.026388583704829216, 0.004324289038777351, -0.020644573494791985, 0.012738417834043503, -0.027847379446029663, -0.01098656002432108, -0.004672707058489323, -0.0012145781656727195, -0.005971947684884071, -0.01693245768547058, -0.010641397908329964, 0.00933890137821436, 0.006118478253483772, -0.014040914364159107, -0.029436426237225533, -0.0008620900334790349, -0.035922858864068985, -0.008355516940355301, -0.010875847190618515, 0.018313104286789894, -0.00011936161172343418, -0.022923942655324936, -0.10638793557882309, -0.017570680007338524, -0.010289723984897137, 0.021673545241355896, 0.020892048254609108, -0.014184189029037952, 0.03527161106467247, 0.0017909329617395997, 0.002668490167707205, -0.033812813460826874, 0.0042721894569695, -0.032796867191791534, -0.004923437722027302, -0.008173166774213314, -0.022168494760990143, -0.030374223366379738, -0.006502714939415455, 0.034620363265275955, 0.006799032911658287, -0.005962178576737642, -0.00671437056735158, 9.768725249159615e-06, -0.01737530715763569, 0.015017786994576454, -0.026909582316875458, -0.014093014411628246, 0.02873307839035988, -0.023770565167069435, 0.010146449320018291, 0.011507558636367321, 0.01583836041390896, 0.016971532255411148, 0.03584470972418785, 0.01229556929320097, -0.03889255225658417, -0.023366792127490044, 0.0028475834988057613, -0.021439095959067345, -0.02651883289217949, 0.03725140541791916, -0.01629423350095749, -0.03696485608816147, 0.04720248281955719, 0.019732825458049774, 0.014262339100241661, -0.028133928775787354, 0.03925725072622299, -0.03412541374564171, 0.0028996833134442568, -0.023601241409778595, 0.022559242323040962, -0.023991988971829414, -0.004763881675899029, -0.02095717191696167, -0.014835437759757042, -0.023640315979719162, 0.009729650802910328, 0.01771395467221737, 0.006877182517200708, -0.015148037113249302, -0.04295634105801582, 0.03613125905394554, 0.02612808346748352, -0.02158237062394619, -0.05168306827545166, -0.003604659577831626, 0.006154296919703484, 0.04725458100438118, -0.03811105340719223, -0.0029175926465541124, 0.012178344652056694, -0.02278066799044609, 0.0014522838173434138, -0.0012308594305068254, -0.004034483805298805, -0.001562996068969369, -0.018417304381728172, 0.026649082079529762, -0.058299753814935684, 0.03165066987276077, 0.021999169141054153, -0.029749024659395218, 0.004334057681262493, 0.012562581337988377, -0.014405613765120506, 0.0027759461663663387, 0.010159474797546864, -0.02362729050219059, -0.003673040773719549, 0.009247726760804653, 0.032510317862033844, 0.00037772406358271837, 0.010719547979533672, -0.011943895369768143, -0.009430075995624065, -0.03852785378694534, -0.0469159334897995, 0.011032147333025932, 0.01886015199124813, 0.0005625157500617206, 0.02920197695493698, 0.021139521151781082, 0.007189781870692968, -0.02367939054965973, 0.005867747589945793, -0.004503382369875908, -0.028993576765060425, -0.020253824070096016, 0.02935827523469925, -0.020149623975157738, 0.012959842570126057, 0.011702933348715305, -0.017075732350349426, 0.016802208498120308, 0.020983222872018814, 0.03284896910190582, 0.01975887455046177, 0.006948819849640131, 0.010406948626041412, 0.006740420591086149, 0.021738670766353607, 0.03128597140312195, -0.006043585017323494, 0.0011356143513694406, -0.008420641534030437, -0.03198932111263275, -0.006554814986884594, 0.03407331556081772, -0.01215880736708641, 0.023184441030025482, 0.022129420191049576, 0.006271521560847759, 0.02504701167345047, 0.001435188576579094, 0.014770313166081905, 0.005558404605835676, -0.002688027685508132, 0.014327463693916798, -0.015864409506320953, 0.007508893497288227, -0.0031113389413803816, 0.000733875494915992, -0.01568206027150154, 0.008596478030085564, -0.013806465081870556, 0.020019374787807465, -0.007248394191265106, -0.013897639699280262, 0.005512817297130823, 0.03665225952863693, 0.03305736556649208, -0.03321366757154465, -0.008212242275476456, 0.005203474313020706, -0.00857694074511528, 0.0005503048887476325, 0.005200217943638563, -0.01612490974366665, -0.008472741581499577, 0.023484015837311745, 0.035922858864068985, 0.042174842208623886, -0.012503968551754951, -0.01583836041390896, 0.03136412054300308, -0.024864662438631058, -0.028498629108071327, -0.01258211862295866, 0.011514071375131607, -0.012907742522656918, -0.0077498555183410645, -0.04399833828210831, -0.006593889556825161, 0.017075732350349426, 0.017049681395292282, -0.005063456017524004, 0.006017534993588924, 0.044102538377046585, -0.018938302993774414, 0.029332226142287254, 0.028316278010606766, 0.017583705484867096, -0.0572577565908432, -0.008173166774213314, 0.029332226142287254, -0.021842870861291885, 0.018313104286789894, -0.00791918020695448, 0.019120652228593826, 0.04782767966389656, 0.05350656434893608, 0.01122100930660963, -0.007880105637013912, 0.03540186211466789, 0.019837025552988052, -0.013057529926300049, -0.016684982925653458, 0.018782002851366997, -0.003972615115344524, -0.0449882373213768, -0.03209351748228073, 0.010895385406911373, 1.1460444511612877e-05, -0.017049681395292282, -0.009456126019358635, 0.015369460918009281, 0.0065776086412370205, -0.017179932445287704, 0.0021051603835076094, -0.0005560033023357391, 0.01818285509943962, 0.011051684617996216, -0.023015117272734642, 0.00982733815908432, -0.004672707058489323, -0.012972867116332054, 0.018834102898836136, 0.02005844935774803, -0.009182602167129517, -0.018156804144382477, 0.0008409244474023581, -0.020123574882745743, 0.02901962772011757, 0.03930935263633728, -0.033760715276002884, -0.005496536381542683, 0.04936462640762329, -0.02073574811220169, 0.0005364658427424729, -0.010380898602306843, -0.014431663788855076, 0.025646161288022995, -0.016828257590532303, -0.004770394414663315, 0.015603911131620407, -0.017961429432034492, -0.015343411825597286, 0.011650833301246166, -0.01659380830824375, 0.0049266936257481575, 0.04457143694162369, -0.004044252447783947, -0.0245390385389328, 0.00315855466760695, 0.029514575377106667, 0.012113219127058983, 0.013910665176808834, 0.054392263293266296, -0.027456630021333694, 0.009058864787220955, -0.026935631409287453, 0.034385912120342255, 0.006909745279699564, -0.0062161656096577644, 0.00671437056735158, 0.01693245768547058, 0.020657597109675407, 0.04181014373898506, -0.0028687489684671164, 0.0014522838173434138, -0.010817235335707664, -0.006740420591086149, -0.00029835314489901066, -0.008733240887522697, 0.010582786053419113, -0.04102864861488342, -0.02805577963590622, 0.013884615153074265, -0.004174502100795507, 0.0034613851457834244, -0.02901962772011757, 0.013832515105605125, -0.008186192251741886, 0.03422961384057999, 0.017570680007338524, 0.005564917344599962, 0.03521951287984848, -0.037746354937553406, -0.011312183924019337, 0.009019790217280388, -0.07252302020788193, -0.01578626036643982, -0.029905324801802635, -0.0327187180519104, 0.0286288782954216, 0.01777908019721508, 0.01583836041390896, -0.013598065823316574, 0.012256493791937828, 0.016567759215831757, 0.03089522197842598, 0.04795793071389198, -0.02225966937839985, 0.013767390511929989, 0.014171164482831955, -0.02886332757771015, -0.010667447932064533, 0.030921272933483124, -0.03152042254805565, 0.00851832889020443, 0.012985892593860626, 0.012862155213952065, -0.005685398355126381, -0.022285718470811844, 0.02271554246544838, 0.021048346534371376, 0.012784005142748356, -0.004128914792090654, -0.02805577963590622, -0.05191751942038536, 0.013728315010666847, -0.016059784218668938, 0.004822493996471167, -0.011676883324980736, 0.0005531540955416858, 0.021087421104311943, -0.009677550755441189, 0.01306404173374176, 0.02051432430744171, 0.011540121398866177, 0.00564957968890667, -0.018755951896309853, -1.4576769899576902e-05, 0.009013277478516102, -0.015304336324334145, -0.010263673961162567, -0.004304751753807068, -0.010895385406911373, -0.019680725410580635, 0.003484178800135851, -0.007300494238734245, 0.008511816151440144, 0.0076000685803592205, 0.0007167802541516721, -0.03839760273694992, 0.008883027359843254, -0.011097271926701069, -0.015148037113249302, -0.027795279398560524, 0.015082912519574165, 0.01999332383275032, 0.033474165946245193, 0.013083579950034618, -0.0033002011477947235, -0.02562011033296585, 0.025997834280133247, 0.011722470633685589, -0.011227522045373917, -0.018221929669380188, -0.006786007899791002, 0.08153629302978516, -0.018834102898836136, -0.02930617704987526, 0.020266849547624588, 0.018261004239320755, 0.03844970464706421, -0.005923104006797075, 0.0019472326384857297, -0.018703853711485863, 0.00996410008519888, -0.010009687393903732, 0.018026554957032204, -0.012686317786574364, -0.016841283068060875, 0.004920181352645159, 0.018365204334259033, -0.02556801028549671, 0.017596730962395668, 0.00846622884273529, 0.01630725897848606, -0.007619605865329504, -0.011963432654738426, -0.03167672082781792, 0.0100487619638443, 0.01772698014974594, -0.017010606825351715, -0.011702933348715305, -0.010810722596943378, -0.014535863883793354, 0.029149876907467842, 0.01994122564792633, 0.003637222107499838, -0.039387501776218414, 0.022559242323040962, -0.0030201643239706755, -0.012836105190217495, -0.022064294666051865, 0.01874292828142643, -0.004623863380402327, -0.005102531053125858, 0.003500459948554635, 0.008707190863788128, -0.022897891700267792, -0.008257829584181309, 0.010003174655139446, 0.012048094533383846, -0.017336230725049973, 0.01619003340601921, 0.009729650802910328, 0.01715388149023056, 0.014535863883793354, -0.028446529060602188, 0.028550727292895317, -0.02169959619641304, -0.015200137160718441, -0.003940052818506956, -0.0023640315048396587, 0.008622528053820133, 0.00553561095148325, 0.01613793522119522, -0.04543108493089676, -0.010406948626041412, -0.02896752767264843, 0.002626158995553851, 0.014640063047409058, -0.034385912120342255, -0.0016264928271993995, 0.016776157543063164, -0.005372799001634121, 0.050015874207019806, -0.016502633690834045, 0.007782417815178633, -0.023470990359783173, -0.02959272637963295, -0.005027637351304293, 0.004614094737917185, -0.0344119630753994, -0.009469151496887207, -0.005063456017524004, 0.00393354007974267, -0.05105787143111229, 0.009208652190864086, -0.004874594043940306, -0.025932710617780685, -0.016163984313607216, -0.01869082823395729, 0.027899479493498802, -0.004633632022887468, -0.01402788981795311, 0.008042917586863041, -0.008101529441773891, 0.001649286481551826, 0.025346586480736732, -0.01771395467221737, 0.014353513717651367, -0.006896720267832279, 0.025463810190558434, -0.01977190002799034, -0.016150958836078644, 0.027899479493498802, -0.006786007899791002, -0.002124697668477893, 0.01943325065076351, 0.0052881366573274136, -0.010159474797546864, 0.007997330278158188, -0.043763890862464905, -0.024851636961102486, -0.029149876907467842, 0.01269283052533865, 0.005646323319524527, 0.0011665485799312592, 0.01794840395450592, -0.010413461364805698, -0.02685748226940632, -0.0002470673352945596, -0.004125658422708511, 0.027899479493498802, 0.024213414639234543, -0.03378676623106003, 0.03566236048936844, 0.013155217282474041, 0.013161729089915752, 0.019915174692869186, -0.014666113071143627, 0.01897737756371498, -0.0020709699019789696, 0.027925530448555946, -0.017818154767155647, 0.005473742261528969, -0.007463306188583374, 0.01630725897848606, 0.00020331160339992493, -0.011950407177209854, 0.02401803992688656, 0.02430458925664425, -0.01629423350095749, -0.0070790695026516914, -0.013728315010666847, -0.020449198782444, 0.029228026047348976, 0.00046889882651157677, -0.009482176043093204, 0.0110712219029665, 0.0012959842570126057, -0.002419387688860297, 0.0034451037645339966, -0.045978132635354996, 0.02464323863387108, 0.018378227949142456, 0.002407990861684084, 0.03699090704321861, -0.023887790739536285, 0.027352431789040565, 0.0006557257147505879, -0.023132340982556343, 0.026115059852600098, -0.008570428006350994, 0.027638981118798256, 0.006948819849640131, 0.039048850536346436, -0.01067396067082882, 0.00011600361176533625, 0.05538216233253479, 0.043373141437768936, 0.0009711741004139185, -0.0200975239276886, 0.010419974103569984, -0.005447692703455687, -0.020449198782444, -0.0004957627970725298, -0.0019179264781996608, 0.023614265024662018, -0.01754463091492653, -0.0015866038156673312, 0.00973616261035204, 0.017818154767155647, -0.0016346334014087915, -0.032458219677209854, 0.041210997849702835, -0.0015825334703549743, -0.02766503021121025, 0.03196327015757561, 0.012048094533383846, -0.00860299076884985, -0.004285214003175497, 0.03191116824746132, 0.02436971291899681, 0.0008441807003691792, -0.006326877977699041, 0.016658933833241463, 0.016150958836078644, 0.023887790739536285, 0.01104517187923193, 0.025815485045313835, 0.011605245992541313, 0.010732573457062244, -0.019172752276062965, 0.05189146846532822, 0.01465308852493763, 0.01663288287818432, -0.016880357638001442, -0.02158237062394619, 0.01204158179461956, 0.007300494238734245, 0.02709193155169487, 0.001719295629300177, 0.026779333129525185, -0.013213829137384892, 0.015252236276865005, 0.02147817052900791, -0.007854055613279343, -0.013819490559399128, 0.00035431981086730957, -0.010830259881913662, 0.007111632265150547, 0.023145366460084915, -0.0035786097869277, 0.005434667691588402, -0.04003874957561493, 0.005001587327569723, -0.034099362790584564, 0.016255158931016922, 0.015278286300599575, -0.019524425268173218, 0.0034581287764012814, 0.034672461450099945, 0.022298743948340416, 0.0012390000047162175, 0.0013928574044257402, -0.007391668856143951, -0.013051017187535763, -0.0017583705484867096, -0.012751443311572075, 0.02442181296646595, -0.00633339025080204, -0.015017786994576454, -0.005854722578078508, 0.017179932445287704, 0.021543296054005623, -0.03540186211466789, -0.0006133945425972342, 0.008016867563128471, -0.021452121436595917, -0.0023363535292446613, 0.04123704507946968, 0.0191336777061224, 0.014587962999939919, -0.04777558147907257, 0.000849065079819411, -0.026375558227300644, 0.005994741339236498, -0.0032594981603324413, -0.03430776298046112, 0.01784420572221279, 0.025476835668087006, 0.009671038016676903, -0.017284130677580833, 0.009332388639450073, 0.035063210874795914, 0.018847128376364708, -0.00021409790497273207, -0.01828705333173275, -0.00668832054361701, -0.04782767966389656, 0.009898975491523743, 0.0033539291471242905, -0.01264073047786951, -0.043190792202949524, -0.01200901996344328, 0.004161477088928223, 0.019185775890946388, 0.03456826135516167, -0.012126244604587555, -0.026388583704829216, 0.005613761022686958, -0.01240628119558096, -0.0023184441961348057, 0.01436653919517994, -0.02073574811220169, 0.012705855071544647, -0.010947484523057938, 0.033760715276002884, -0.01686733216047287, 0.0180526040494442, -0.004539201036095619, -0.03352626413106918, -0.004659682046622038, 0.001961885718628764, 0.02998347394168377, -0.020006349310278893, -0.012927279807627201, 0.011950407177209854, -0.02033197320997715, 0.003454872639849782, -0.0018169829854741693, 0.006613427307456732, -0.02027987316250801, 0.005727729294449091, 0.02964482456445694, -0.030243974179029465, 0.014744263142347336, -0.00045628088992089033, -0.00020778893667738885, 0.03477666154503822, 0.0026489526499062777, -0.01612490974366665, 0.01676313206553459, 0.009658013470470905, -0.01195691991597414, 2.2908170649316162e-05, -0.004099608398973942, -0.0031194796320050955, 0.042565591633319855, 0.014770313166081905, 0.012113219127058983, -0.02039709873497486, 0.007821492850780487, 0.0007249208283610642, 0.02829022891819477, -0.0038944652769714594, -0.014132089912891388, -0.004516407381743193, -0.026544883847236633, 0.015213161706924438, -0.021204646676778793, 0.03170277178287506, 0.01462703850120306, 0.022963017225265503, -0.0052360366098582745, 0.01948535069823265, -0.015708111226558685, 0.0232235174626112, 0.00894164014607668, -0.01590348407626152, 0.03584470972418785, -0.009169576689600945, 0.02810787968337536, 0.01193086989223957, -0.019797950983047485, 0.01930300146341324, 0.01133172120898962, 0.01794840395450592, -0.004317776765674353, -0.024526013061404228, -0.004057277459651232, 0.03430776298046112, 0.011461971327662468, 0.013624115847051144, 0.018143778666853905, 0.012490944005548954, 0.0404294990003109, -0.04524873569607735, -0.027248231694102287, 0.003480922430753708, 0.002041663508862257, 0.01641145907342434, -0.03521951287984848, -0.015330386348068714, 0.009703600779175758, -0.04147149622440338, 0.002437297021970153, 0.020865997299551964, 0.008837440051138401, -0.006248727906495333, 0.013122654519975185, -0.00045790901640430093, -0.010726060718297958, 0.000548269716091454, -0.0020270105451345444, 0.0200975239276886, 0.01642448455095291, 0.026323458179831505, 0.01994122564792633, -0.009189113974571228, 0.0324842669069767, -0.030478423461318016, -0.014066964387893677, 0.03542790934443474, -0.007788930553942919, -0.025255411863327026, -0.045352935791015625, -0.006753445602953434, 0.007873592898249626, 0.0034581287764012814, 0.02504701167345047, 0.01368924044072628, 0.013174754567444324, 0.003047842299565673]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" the complexity
of the reward function (exploration). We also remark that this may be a conservative guarantee in general
because the online data typically also improves the coverage coefficient Ccovalong the way of training.
E Discussion on the Coverage Condition for Vanilla RLHF
In this section, we investigate the condition for DPO to converge to π∗. DPO is a practical algorithm
derived from the reverse-KL regularized contextual bandit framework presented in this paper, which skips
43
the reward modeling step with a clever reparameterization technique and directly optimizes the LLMs based
on the offline preference data Doffby the following loss function
L(θ, π0,Doff) =−X
(x,aw,al)∈Doffh
logσ
ηlogπθ(aw|x)
π0(aw|x)−ηlogπθ(al|x)
π0(al|x)i
, (27)
where awis the chosen response and alis the rejected response. Given x, aw, al, fitting the model with
the loss in Equation (27) yields a MLE for the preference probability (Lemma 5) by training the LLM as
a reward model. This process, however, necessitates considering the generation distributions of a1anda2,
which is missing in the original DPO paper.
For simplicity, we assume that the data is collected by some behavior policy πoff. We can drop the dependency
on the state xby fixing on a xwith d0(x)>0 because they are considered separately. Meanwhile, we assume
that the size of the offline dataset |Doff|approaches infinity so we can handle the population loss directly.
In this case, given a prompt x, the loss function in Equation (8) converges to:
L∞(θ, π0, x) =−Ea1,a2∼πoff(·|x)
p∗(a1≻a2|x, a1, a2) logpθ(a1≻a2|x, a1, a2)
+p∗(a2≻a1|x, a1, a2) logpθ(a2≻a1|x, a1, a2)
,
where pθis the preference model associated with πθ. Given x, a1, a2, the following lemma demonstrates that
pθ=p∗uniquely minimizes the loss.
Lemma 5 (Solution of Preference data) .Given x, a1, a2, we consider the preference learning for
p∗(a1≻a2|x) =1
1 + exp
ηlogπ∗(a2|x)
π0(a2|x)−ηlogπ∗(a1|x)
π0(a1|x)=σ
ηlogπ∗(a1|x)
π0(a1|x)−ηlogπ∗(a2|x)
π0(a2|x)
,
by
pθ(a1≻a2|x) =1
1 + exp
ηlogπθ(a2|x)
π0(a2|x)−ηlogπθ(a1|x)
π0(a1|x)=σ
ηlogπθ(a1|x)
π0(a1|x)−ηlogπθ(a2|x)
π0(a2|x)
.
Consider the population loss (when we have sufficiently many samples),
p∗(a1≻a2|x) logpθ(a1≻a2|x) +p∗(a2≻a1|x) logpθ(a2≻a1|x).
The solution satisfies πθ(a1|x)/πθ(a2|x) =π∗(a1|x)/π∗(a2|x).
Therefore, if pθis the minimizer of the loss, we have pθ=p∗for any a1, a2on support( πoff). For any
a1, a2∈support( π∗)∩support( πoff), we can further obtain thatπθ(a1|x)
π∗(a1|x)=πθ(a2|x)
π∗(a2|x):=C(Lemma 5).
We restrict our attention on πθwith the same support with π∗(as well as π0) and fix a2and go over a1
to get πθ(·|x) =C·π∗(·|x) on support( πoff). Conversely, for ( x, a) pairs where πoff(a|x) = 0, the choice
ofpθ(orπθ) does not impact the","[0.03197624161839485, -0.029577385634183884, 0.020007479935884476, 0.011898580938577652, 0.045833464711904526, 0.029807062819600105, 0.005139038898050785, 0.02814827859401703, 0.012989550828933716, 0.0342474989593029, 0.036671873182058334, -0.025698384270071983, -0.02735716663300991, -0.002232977654784918, 0.021398305892944336, -0.02947530522942543, 0.046624574810266495, -0.0032697173301130533, 0.020020240917801857, 0.04565482586622238, -0.03483445197343826, -0.04366428405046463, 0.037131231278181076, 0.016192277893424034, 0.011069189757108688, -0.0033494664821773767, 0.02919458970427513, 0.03445165604352951, 0.03524276986718178, -0.04072951525449753, 0.0535404272377491, -0.024243758991360664, -0.027561325579881668, -0.04139302670955658, 0.0035089650191366673, 0.04029567912220955, 0.019637444987893105, 0.05578616261482239, -0.020734792575240135, 0.023312287405133247, 0.001689088181592524, -0.060532838106155396, -0.037258829921483994, 0.02113034948706627, 0.01203256007283926, 0.03825409710407257, 0.013487185351550579, 0.0073433066718280315, 0.006035419646650553, 0.035370368510484695, -0.052621714770793915, 0.03225695714354515, -0.008293917402625084, -0.013499945402145386, -0.013946540653705597, -0.0033143770415335894, 0.033175669610500336, 0.004832801874727011, 0.046037621796131134, -0.028071720153093338, 0.0020479594822973013, -0.017570344731211662, 0.03570212423801422, 0.004485095385462046, 0.00654581468552351, 0.001451435498893261, -0.06078803539276123, 0.019573645666241646, -9.340625547338277e-05, 0.052774835377931595, -0.005617533810436726, -0.00388538115657866, 0.04562930390238762, 0.0040480694733560085, -0.008140798658132553, 0.018846331164240837, 0.049253109842538834, 0.022572215646505356, 0.015222528018057346, -0.007675063330680132, 0.010348256677389145, -0.026208778843283653, 0.030368497595191002, -0.06160466745495796, 0.027663404121994972, -0.0805913582444191, -0.051090531051158905, -0.007911121472716331, -0.016332637518644333, 0.02955186553299427, 0.0029331757687032223, 0.009589044377207756, 0.00826839730143547, 0.005158178508281708, 0.033762622624635696, -0.006080079358071089, 0.010042020119726658, -0.012377076782286167, 0.016205038875341415, 0.005780222360044718, -0.012721593491733074, -0.08013200014829636, 0.009352986700832844, -0.03753954544663429, 0.04864063486456871, 0.009812342002987862, -0.0036174238193780184, 0.04294973239302635, -0.003307997016236186, -0.016205038875341415, -0.045374106615781784, -0.020071279257535934, -0.05823605880141258, 0.05451017618179321, 0.0032665273174643517, -0.049482785165309906, -0.06068595498800278, 0.002004894893616438, 0.0063512264750897884, 0.007011550012975931, -0.03460477665066719, -0.026157738640904427, 0.0007109641446731985, 0.012160158716142178, 0.008887250907719135, 0.011949621140956879, 0.01850181631743908, -0.060890112072229385, 0.025928061455488205, -0.016689913347363472, 0.008721373043954372, 0.049253109842538834, -0.011617864482104778, -0.061400506645441055, -0.07839665561914444, 0.026642614975571632, 0.00794302113354206, -0.006845671683549881, -0.002180343260988593, -0.024192718788981438, -0.03327774628996849, -0.03651875630021095, -0.05726630985736847, 0.02332504652440548, -0.045527227222919464, 0.0005399021320044994, -0.006376746576279402, 0.012147398665547371, 0.011828402057290077, 0.01275987271219492, 0.024677593261003494, -0.01878253184258938, -0.02010956034064293, 0.034859973937273026, -0.021666264161467552, -0.05384666472673416, -0.02531558834016323, 0.03730986639857292, 0.01697063073515892, -0.02120690792798996, -0.03013881854712963, 0.04029567912220955, -0.012989550828933716, -0.021627984941005707, 0.03434957563877106, 0.0390707291662693, -0.034936532378196716, 0.004083159379661083, -0.06502430886030197, -0.017965901643037796, -0.003914090804755688, -0.0003217880439478904, -0.06533055007457733, -0.03284391388297081, 0.01290661096572876, -0.017710702493786812, -0.004124628845602274, -0.0250221099704504, -0.005926961079239845, -0.046701133251190186, 0.02625981904566288, 0.035421404987573624, 0.030878892168402672, -0.03064921498298645, -0.0008357716724276543, 0.008274777792394161, 0.0036365636624395847, -0.03687603399157524, -0.011286107823252678, 0.006596854422241449, 0.02998570166528225, 0.030598174780607224, 0.04759432375431061, -0.02539214678108692, -0.019190847873687744, -0.028352437540888786, 0.043179407715797424, 0.06578990072011948, -0.01637091673910618, 0.035651084035634995, 0.004379826132208109, 0.022419096902012825, 0.0021500384900718927, -0.047645363956689835, 0.0008596964180469513, 0.0009386481251567602, 0.0040703993290662766, 0.04511890932917595, -0.05147332698106766, -0.03794786334037781, -0.01536288671195507, 0.001030359766446054, 0.025800462812185287, 0.021819382905960083, -0.02786756120622158, -0.004092729184776545, -0.012192058376967907, 0.03919832780957222, 0.018667694181203842, 0.052621714770793915, -0.0024387307930737734, 0.03284391388297081, 0.02479243278503418, 0.04103574901819229, -0.025111429393291473, -0.028199318796396255, 0.03401781991124153, -0.05471433326601982, 0.018629414960741997, -0.037411946803331375, 0.0567559152841568, 0.03743746504187584, -0.01027807779610157, 0.002220217837020755, 0.012230337597429752, -0.011215928010642529, -0.035727642476558685, 0.006013090256601572, 0.007898361422121525, -0.039453525096178055, -0.025787703692913055, 0.023006049916148186, 0.021525904536247253, -0.011898580938577652, -0.0012297327630221844, 0.02398856170475483, -0.027816522866487503, -0.006724453065544367, -0.026515016332268715, -0.022406335920095444, 0.02595358155667782, -0.02553250454366207, -0.020275438204407692, -0.02384820207953453, -0.04680321365594864, 0.02567286416888237, 0.007668683305382729, -0.01342338602989912, -0.026668133214116096, -0.0057706525549292564, -0.010067539289593697, 0.03327774628996849, -0.010501375421881676, 0.012389836832880974, 0.004083159379661083, -0.004523375071585178, -0.014316577464342117, -0.0035919041838496923, 0.015184248797595501, 0.007553844712674618, 0.0023286768700927496, -0.01448245532810688, -0.03560004383325577, 0.043996039777994156, -0.013869981281459332, -0.03955560550093651, 0.017583103850483894, 0.05231547728180885, -0.04047431796789169, -0.018833572044968605, -0.034911010414361954, 0.019560884684324265, 0.07763106375932693, 0.022202178835868835, 0.06793355941772461, -0.030827851966023445, -0.012083599343895912, 0.0008034732309170067, -0.057827744632959366, -0.02239357680082321, -0.006890331394970417, -0.05604135990142822, 0.03981080278754234, -0.038585856556892395, -0.001264024875126779, 0.015669124200940132, -0.004373446572571993, -0.038509294390678406, 0.00965922325849533, 0.0243585966527462, 0.037922341376543045, 0.01254933513700962, -0.030598174780607224, 0.026361897587776184, 0.013385106809437275, -0.007132769096642733, 0.0318741612136364, 0.02326124720275402, -0.03644219785928726, 0.009314707480370998, -0.017213068902492523, 0.027076449245214462, -0.003307997016236186, 0.036824993789196014, -0.006705312989652157, -0.005649433471262455, 0.06293169409036636, -0.01324474811553955, -0.011566824279725552, -0.049406226724386215, -0.04287317395210266, -0.05236651748418808, -0.030598174780607224, -0.005646243691444397, 0.03868793323636055, -0.008274777792394161, 0.00026855545002035797, -0.007209328003227711, -0.011215928010642529, -0.03516620770096779, -0.015911560505628586, -0.00990804098546505, 0.024562755599617958, 0.023465406149625778, -0.01901221089065075, -0.012268617749214172, -0.04981454461812973, 0.05425497889518738, 0.017940381541848183, 0.016855791211128235, -0.07109800726175308, 0.018705973401665688, -0.016217797994613647, 0.0017895721830427647, -0.02465207502245903, 0.012204818427562714, 0.03366054594516754, 0.016868552193045616, 0.02201078087091446, 0.04037223756313324, -0.010960730724036694, -0.021028270944952965, 0.03600836172699928, 0.024320317432284355, -0.0070434496738016605, 0.027306128293275833, 0.011107468977570534, -0.06002243980765343, -0.0342474989593029, 0.002443515695631504, -0.022214937955141068, -0.011145749129354954, 0.006354416720569134, -0.0025120999198406935, -0.018910132348537445, 0.029220107942819595, -0.012625894509255886, -0.029169069603085518, 0.016728192567825317, -0.012370696291327477, -0.009895280934870243, 0.028122760355472565, -0.04813024029135704, 0.019548125565052032, -0.054459135979413986, -0.010392916388809681, 0.0009864976163953543, -0.005426135845482349, 0.02493279054760933, -0.003776922356337309, -0.034400615841150284, -0.013078869320452213, -0.009040369652211666, -0.00041150589822791517, 0.02304433099925518, 0.014456936158239841, -0.05721526965498924, -0.01732790656387806, -0.0631868913769722, -0.04856407642364502, 0.013895501382648945, -0.045756902545690536, 0.024473436176776886, 0.008931910619139671, -0.04167374595999718, -0.02786756120622158, -0.033762622624635696, 0.0390707291662693, 0.04636937752366066, 0.06854603439569473, -0.0348089337348938, -0.0008477340452373028, -0.03330326825380325, -0.022138379514217377, -0.03753954544663429, -0.0033526564948260784, -0.014533494599163532, 0.01624331809580326, -0.01075657270848751, 0.06747420877218246, 0.01901221089065075, -0.003955560736358166, 0.022559454664587975, -0.06017556041479111, 0.024805191904306412, -0.024754153564572334, 0.009410406462848186, -0.007496425416320562, 0.044940270483493805, 0.06476911157369614, 0.015528765507042408, -0.023452647030353546, -0.0018278517527505755, -0.019867122173309326, -0.02026267722249031, 0.04644593596458435, 0.015822242945432663, 0.013142668642103672, -0.026081180199980736, -0.043996039777994156, 0.004166098311543465, 0.049993179738521576, 0.02560906484723091, -0.013563744723796844, -0.06354416906833649, -0.004386206157505512, 0.03751402720808983, -0.0039970302022993565, -0.00951248500496149, -0.04279661178588867, 0.03330326825380325, 0.003464305540546775, -0.044863712042570114, -0.0022935871966183186, 0.005094379186630249, 0.006756352726370096, -0.005324056837707758, -0.02275085262954235, 0.004628643859177828, 0.007668683305382729, -0.05175404250621796, -0.007049829699099064, 0.07951952517032623, 0.036467716097831726, -0.009301947429776192, -0.048997912555933, 0.055633045732975006, 0.011605104431509972, -0.028990430757403374, 0.039376966655254364, -0.012772632762789726, -0.021602464839816093, 0.0003215886536054313, -0.020237158983945847, 0.016843032091856003, 0.025175228714942932, -0.0021420635748654604, -0.007285887375473976, -0.022623253986239433, 0.025762183591723442, -0.018476296216249466, -0.05147332698106766, 0.03863689303398132, -0.008498075418174267, -0.021117588505148888, 0.006577714346349239, 0.03248663619160652, -0.010195137932896614, 0.024703113362193108, -0.00486470153555274, -0.00056661810958758, -0.01185392215847969, 0.00029148333123885095, 0.0013126719277352095, 0.05052909627556801, 0.06538158655166626, 0.05384666472673416, -0.0002936764503829181, -0.03562556579709053, 0.002709877910092473, -0.00113323621917516, -0.04978902265429497, 0.03577868267893791, -0.014061380177736282, -0.01799141988158226, -0.011235067620873451, 0.033686064183712006, -0.006858431734144688, 0.019407765939831734, 0.009091408923268318, 0.07053657621145248, -0.04159718379378319, -0.005097568966448307, 0.015145968645811081, -0.01027169730514288, 0.03664635494351387, 0.022470135241746902, -0.021028270944952965, -0.02472863346338272, 0.019063249230384827, -0.035217247903347015, 0.015592564828693867, -0.015592564828693867, -0.009671983309090137, -0.033022549003362656, -0.003464305540546775, -0.03603387996554375, -0.04009152203798294, -0.034043341875076294, 0.020300958305597305, -0.010010120458900928, -0.024460675194859505, -0.012319657020270824, 0.02962842397391796, -0.010577934794127941, 0.014724893495440483, -0.03743746504187584, -0.09983324259519577, -0.034911010414361954, -0.03973424434661865, 0.017059950157999992, -0.001107716467231512, 0.014737652614712715, 0.02070927433669567, -0.0013716863468289375, 0.00453294487670064, -0.01878253184258938, -0.004162908531725407, -0.007196568418294191, -0.007732483092695475, 0.013346826657652855, -0.0218066219240427, -0.01163062360137701, 0.028122760355472565, 0.007451765704900026, -0.051524367183446884, 0.026974370703101158, 0.017940381541848183, 0.00344835571013391, 0.02471587434411049, 0.005384666379541159, -0.0046669235453009605, -0.04601209983229637, -0.005113518796861172, -0.03970872238278389, 0.0043479264713823795, -0.02814827859401703, -0.016434716060757637, 0.01309162937104702, -0.0018422065768390894, -0.007815422490239143, 0.013997580856084824, 0.013078869320452213, 0.02560906484723091, 0.00036246012314222753, 0.032869432121515274, 0.0055664945393800735, 0.0018039270071312785, -0.001968210330232978, 0.004650973714888096, -0.0409591905772686, 0.04134198650717735, 0.025047630071640015, -0.042388297617435455, 0.03511517122387886, -0.004290507175028324, 0.05425497889518738, -0.005620724055916071, 0.009423165582120419, 0.0012225552927702665, -0.010361016727983952, 0.005419755820184946, -0.016715433448553085, -0.040346719324588776, -0.0223680566996336, 0.01181564200669527, 0.01615399867296219, -0.00012450844224076718, -0.04233725741505623, 0.007560224737972021, 0.007675063330680132, -0.050503578037023544, -0.035727642476558685, 0.0014362832298502326, -0.04440435767173767, 0.010520515032112598, 0.003981080371886492, 0.034426137804985046, 0.010175998322665691, -0.04277109354734421, 0.030623694881796837, 0.018335936591029167, 0.012606753967702389, -0.00794302113354206, -0.035446926951408386, 0.048104722052812576, -0.03174656257033348, 0.005509075243026018, 0.01115850917994976, 0.023376086726784706, 0.0023797163739800453, -0.03085337206721306, 0.03230799734592438, 0.0023781212512403727, -0.01878253184258938, -0.04192894324660301, -0.009346607141196728, -0.01834869757294655, 0.058031901717185974, -0.03144032508134842, -0.008108898997306824, -0.006558574736118317, 0.021895941346883774, -0.0036812233738601208, -0.005209218244999647, -0.002995380200445652, -0.020390275865793228, -0.023133648559451103, 0.017302388325333595, -0.009167968295514584, -0.03896865248680115, -0.03511517122387886, -0.013219228014349937, 0.0014833351597189903, 0.023975800722837448, -0.0052474974654614925, -0.002901276107877493, -0.017366187646985054, 0.024116160348057747, -0.057878781110048294, 0.015158728696405888, 0.04021912068128586, -0.0004944450920447707, -0.02822483889758587, 0.003760972525924444, 0.029526345431804657, 0.005215597804635763, 0.02375888265669346, -0.011324387043714523, -0.03644219785928726, 0.002325486857444048, -0.0015072600217536092, 0.00866395328193903, 0.009110549464821815, 0.037488505244255066, -0.0017193928360939026, 0.00025918491883203387, 7.830375398043543e-05, 0.00017116173694375902, -0.011139368638396263, -0.02310813032090664, -0.022648774087429047, 0.012383456341922283, -0.012460015714168549, -0.007177428342401981, 0.021538665518164635, 0.003965130541473627, 0.0677294060587883, -0.0005498707760125399, -0.002532834652811289, -0.04448091611266136, -0.005703662987798452, 0.038509294390678406, -0.0030272798612713814, -0.035574525594711304, -0.018910132348537445, -0.009863381274044514, -0.03899417072534561, -0.045450665056705475, 0.0017672423273324966, -0.04154614731669426, -0.011458366177976131, -0.042286217212677, -0.01952260546386242, -0.04323044791817665, -0.003764162538573146, 0.02151314541697502, -0.02428203821182251, -0.009646464139223099, -0.006405455991625786, -0.023669563233852386, -0.002856616396456957, 0.05119260773062706, 0.001521614845842123, -0.012268617749214172, 0.023057090118527412, 0.0015814267098903656, 0.03447717800736427, -0.018973931670188904, -0.0500442199409008, -0.02426927722990513, 0.025468705222010612, 0.00035189336631447077, 0.008766032755374908, -0.03751402720808983, -0.030394017696380615, 0.005186888389289379, 0.036238037049770355, 0.024256518110632896, -0.05180508270859718, 0.003008140018209815, 0.014214497990906239, -0.04529754817485809, 0.034196458756923676, 0.012345177121460438, 0.03626355901360512, 0.021079309284687042, -0.0007620036485604942, 0.003116598818451166, -0.019981959834694862, -0.005308107007294893, -0.015324607491493225, -0.061757784336805344, -0.00226647243835032, -0.01712374947965145, 0.00972302258014679, -0.0484364777803421, 0.006533054634928703, -0.022763613611459732, 0.009652843698859215, -0.008714993484318256, 0.004140578676015139, -0.032359037548303604, -0.022329777479171753, 0.0019522604998201132, 0.019407765939831734, 0.004861511290073395, 0.026719173416495323, -0.022278737276792526, -0.008740512654185295, 0.010329117067158222, -0.012485535815358162, -0.04149510711431503, -0.03174656257033348, 0.018986690789461136, 0.018335936591029167, 0.017468266189098358, 0.021041030064225197, -0.016855791211128235, 0.04636937752366066, -0.006654273718595505, 0.010016500018537045, -0.014354856684803963, 0.004083159379661083, 0.05068221315741539, 0.003113409038633108, 0.0010183973936364055, -0.0002789228456094861, -0.01187944132834673, -0.020938951522111893, 0.02581322193145752, 0.01639643684029579, -0.023465406149625778, 0.0029571005143225193, 0.004765812307596207, -0.030878892168402672, -0.05236651748418808, -0.03041953593492508, 0.04649697616696358, -0.025928061455488205, 0.009289187379181385, 0.005027390085160732, -0.006488395389169455, 0.03776922449469566, 0.05823605880141258, 0.0026875482872128487, 0.0051996479742228985, -0.012830051593482494, 9.186111856251955e-05, -0.018195578828454018, -0.03611043840646744, -0.026017380878329277, 0.023899242281913757, -0.023057090118527412, -0.014763172715902328, 0.01944604516029358, 0.007285887375473976, -0.03904521092772484, 0.011228688061237335, -0.037258829921483994, -0.006060939747840166, -0.016689913347363472, -0.00826839730143547, -0.017378946766257286, 0.03924936801195145, 0.01952260546386242, -0.039887361228466034, -0.09335123002529144, -0.0342474989593029, -0.007630404084920883, 0.006131118629127741, 0.011605104431509972, -0.011432846076786518, 0.0506056547164917, -0.00398427015170455, -0.0063703665509819984, -0.028352437540888786, 0.007445385679602623, 0.009997360408306122, 0.014354856684803963, -0.02326124720275402, 0.0023701463360339403, -0.0361359603703022, -0.02604290097951889, 0.018552854657173157, 0.008989330381155014, -0.018552854657173157, -0.03202728182077408, 0.001145996036939323, 0.02193422056734562, 0.015413925983011723, -0.038943130522966385, -0.0036716533359140158, 0.023860961198806763, -0.045680344104766846, -0.02202353999018669, 0.011432846076786518, 0.005671763326972723, -0.017748983576893806, 0.00906588975340128, -0.007649543695151806, -0.03845825791358948, -0.024996589869260788, 0.0022345727775245905, -0.008938291110098362, -0.004682873375713825, 0.03498757258057594, 0.027101969346404076, -0.03567660599946976, 0.03932592645287514, -0.011949621140956879, 0.012689693830907345, -0.053285229951143265, 0.009046750143170357, -0.014240018092095852, 0.0025487844832241535, 0.000276929116807878, 0.0063703665509819984, -0.020887911319732666, 0.0013573314063251019, -0.040908150374889374, 0.011292487382888794, 0.0003875811235047877, -0.0024243758525699377, 0.0383051373064518, -0.01312990952283144, -0.010450336150825024, -0.01689407229423523, 0.025634584948420525, 0.022061819210648537, -2.8161437512608245e-05, -0.04448091611266136, 0.0015192223945632577, 0.0001482338411733508, 0.013104389421641827, -0.024384116753935814, -0.04049983620643616, -0.026310857385396957, -0.028071720153093338, -0.00022210153110790998, 0.026463976129889488, -0.01586052216589451, -0.007451765704900026, 0.006265097297728062, 0.010718293488025665, -0.03871345520019531, 0.04302629083395004, 0.057011112570762634, -0.021985260769724846, 0.008159938268363476, 0.029526345431804657, 0.01060983445495367, 0.015158728696405888, 0.009257287718355656, -0.028709713369607925, -0.04851303622126579, -0.012153779156506062, 0.01090331096202135, -0.015184248797595501, 0.009110549464821815, -0.021487625315785408, -0.040627434849739075, -0.02105378918349743, -0.02845451608300209, 0.0145207354798913, 0.02120690792798996, -0.010048399679362774, 0.02215113863348961, 0.03085337206721306, -0.022482896223664284, -0.007285887375473976, 0.021487625315785408, -0.02230425737798214, 0.0058695413172245026, 0.0024881751742213964, 0.034400615841150284, -0.0014283081982284784, 0.005891871172934771, 0.01297679077833891, -0.026055660098791122, 0.015962600708007812, -0.013844462111592293, 0.021462105214595795, 0.04279661178588867, 0.013563744723796844, -0.010329117067158222, -0.005952480714768171, -0.00344835571013391, 0.030317457392811775, 0.008421516045928001, 0.02597910165786743, -0.003799252212047577, -0.008383236825466156, -0.012568474747240543, 0.028173798695206642, -0.023963041603565216, -0.008759652264416218, -0.0023318666499108076, 0.01689407229423523, 0.024052361026406288, 0.0060960291884839535, 0.01865493319928646, 0.02779100276529789, 0.030087780207395554, 0.017736222594976425, -0.04116334766149521, 0.01631987653672695, 0.016192277893424034, 0.03332878649234772, 0.015286327339708805, 0.0103099774569273, -0.017225828021764755, 0.037411946803331375, 0.017800021916627884, -0.027382686734199524, -0.025417666882276535, 0.023886481299996376, 0.02142382599413395, -0.022878451272845268, -0.006947750691324472, -0.01320646796375513, 0.006207678001374006, 0.02304433099925518, 0.009608183987438679, -0.02712748944759369, 0.01586052216589451, 0.011030909605324268, 0.01360202394425869, 0.03672291338443756, -0.013882741332054138, -0.026668133214116096, 0.044149160385131836, -0.0148524921387434, 0.009671983309090137, -0.008555494248867035, -0.008861731737852097, -0.008951051160693169, -0.014801451936364174, -0.05507161095738411, 0.0055218348279595375, -0.0014657904393970966, 0.020224398002028465, 0.012485535815358162, 0.00812165904790163, 0.04300077259540558, -0.015413925983011723, 0.03279287368059158, 0.004686063155531883, 0.02370784431695938, -0.029653944075107574, -0.02509867027401924, 0.014890771359205246, -0.003894951194524765, 0.014456936158239841, -0.0013804587069898844, 0.021398305892944336, 0.0374629870057106, 0.041648223996162415, 0.024116160348057747, 0.024486195296049118, 0.03154240548610687, 0.02932218834757805, -0.030087780207395554, -0.025940820574760437, 0.02684677205979824, 0.020224398002028465, -0.04667561501264572, -0.04116334766149521, 0.04014255851507187, -0.007324167061597109, -0.0011061214609071612, -0.034119900315999985, 0.04374084249138832, 0.007037069648504257, -0.02932218834757805, -0.013767902739346027, 0.02032647654414177, 0.024626554921269417, -0.016804752871394157, -0.012058080174028873, 0.012089979834854603, 0.012593994848430157, -0.02830139733850956, -0.020096799358725548, 0.027025410905480385, -0.02860763482749462, -0.00954438466578722, 0.025494225323200226, -0.02231701835989952, 0.010386536829173565, 0.04315388947725296, -0.017876582220196724, -0.019560884684324265, 0.03496205061674118, -0.007215708028525114, 0.00226647243835032, -0.000881228712387383, -0.02289121225476265, 0.013155428692698479, -0.015822242945432663, 0.01254295464605093, -0.011196788400411606, -0.04220965877175331, -0.0008070619660429657, 0.022253217175602913, 0.009053129702806473, -0.011534924618899822, 0.043893963098526, 0.0033111870288848877, -0.03519172966480255, 0.024613793939352036, 0.018182817846536636, 0.0012935320846736431, -0.004564844537526369, 0.05019734054803848, -0.02472863346338272, -0.003126168856397271, -0.03414541855454445, 0.03771818429231644, 0.00965922325849533, 0.008415136486291885, 0.006864811759442091, 0.01324474811553955, 0.013078869320452213, 0.016996150836348534, 0.033966779708862305, -0.0008963810396380723, -0.03246111795306206, 0.0002809165744110942, 0.0021867232862859964, -0.026234298944473267, -0.009333847090601921, -0.04251589626073837, -0.00453294487670064, 0.04644593596458435, 0.01631987653672695, 0.017149269580841064, 0.010265317745506763, 0.010724673047661781, -0.025136949494481087, 0.02896491065621376, 0.021883182227611542, 0.0026540535036474466, 0.013895501382648945, -0.014597294852137566, 0.025506986305117607, 0.004954020492732525, -0.01638367585837841, -0.004245847463607788, -0.02216389961540699, -0.015120449475944042, 0.006749972701072693, 0.008364096283912659, 0.023427126929163933, 0.01375514268875122, -0.014125179499387741, 0.01191772148013115, 0.03519172966480255, 0.019037730991840363, -0.006485205143690109, 0.02500935085117817, 0.013550984673202038, -0.026310857385396957, -0.015822242945432663, 0.023950280621647835, -0.026093939319252968, -0.00654581468552351, 0.02486899122595787, 0.010667253285646439, 0.00689671142026782, -0.0029539105016738176, 0.017315147444605827, 0.01887185126543045, 0.003716313047334552, -0.015605323947966099, -0.01667715422809124, -0.04966142401099205, 0.015133209526538849, -0.04182686284184456, -0.0009171158308163285, 0.02983258292078972, 0.007120009046047926, 0.013155428692698479, -0.0008453415939584374, -0.007222088053822517, -0.019586404785513878, 0.0022951820865273476, 0.0004266582545824349, -0.012089979834854603, 0.015758443623781204, 0.007579364348202944, -0.022776372730731964, -0.018182817846536636, 0.012702452950179577, 0.0043447366915643215, -0.003949180711060762, -0.005990760400891304, -0.0036493237130343914, 0.021844903007149696, 0.006539434660226107, -0.02282741293311119, -0.02105378918349743, 0.010941591113805771, -0.024830712005496025, 0.016996150836348534, -0.033456385135650635, -0.04368980601429939, 0.040117040276527405, 0.011471125297248363, 0.017238589003682137, -0.018667694181203842, -0.016000879928469658, 0.02932218834757805, 0.0009482180466875434, 0.013142668642103672, -0.010660873726010323, 0.007177428342401981, 0.0690564289689064, -0.020390275865793228, -0.026795731857419014, 0.0021612034179270267, -0.013742382638156414, 0.04386844113469124, -0.011936861090362072, -0.03687603399157524, -0.018157299607992172, 0.016421956941485405, 0.0015774392522871494, 0.023274008184671402, 0.007502804975956678, -0.012153779156506062, 0.018922891467809677, -0.005081619136035442, -0.019484326243400574, 0.018820812925696373, 0.02244461700320244, 0.015745682641863823, 0.01689407229423523, -0.011050050146877766, 0.005110329017043114, 0.005958860740065575, 0.03873897343873978, -0.007955780252814293, -0.024307558313012123, -0.008179078809916973, -0.02076031267642975, 0.024996589869260788, 0.011477505788207054, -0.016855791211128235, -0.07538532465696335, 0.018616653978824615, -0.027893081307411194, -0.020300958305597305, -0.011598723940551281, 0.020798591896891594, -0.009857001714408398, -0.002051149494946003, -0.016051920130848885, 0.0007001979975029826, -0.023975800722837448, 0.01828489825129509, 0.0021596085280179977, 0.02127070724964142, 0.005885491147637367, 0.027306128293275833, 0.007234847638756037, 0.023886481299996376, 0.014393136836588383, -0.018757013604044914, 0.03064921498298645, -0.0063512264750897884, -0.02398856170475483, 0.01027807779610157, -0.021666264161467552, 0.006966890301555395, 0.011783742345869541, 0.031057531014084816, -0.025251789018511772, 0.0010279671987518668, -0.014890771359205246, -0.024179959669709206, 0.003406886011362076, -0.003390936180949211, 0.0012281377566978335, 0.015567044727504253, -0.006788252387195826, 0.029679464176297188, -0.026234298944473267, 0.0055441646836698055, -0.025928061455488205, -0.0342474989593029, -0.02215113863348961, 0.005177318584173918, -0.014635574072599411, 0.013576504774391651, 0.008600153960287571, 0.015516005456447601, -0.0003170030831824988, -0.011732703074812889, -0.011841162107884884, -0.0058631617575883865, -0.00305439461953938, 0.012983170337975025, 0.019637444987893105, 0.0223680566996336, -0.016626114025712013, 0.032945990562438965, -0.02024991810321808, 0.031644485890865326, 0.019280167296528816, -0.0026237487327307463, -0.007005169987678528, -0.005065669305622578, 0.009474205784499645, 0.01100539043545723, -0.022291498258709908, 0.020951710641384125, -0.027842042967677116, 0.004204377997666597, 0.013729623518884182, 0.02590254135429859, -0.005681333132088184, 0.01586052216589451, -0.0396321639418602, -0.016064679250121117, 0.010775712318718433, -0.006332086864858866, 0.0021484436001628637, -0.007923880591988564, 0.04149510711431503, 0.0019028160022571683, -0.008051480166614056, 0.013321307487785816, 7.541284139733762e-05, 0.022699814289808273, 0.03080233372747898, -0.013806181959807873, 0.017276868224143982, 0.002371741458773613, 0.02304433099925518, 0.008364096283912659, -0.002410020912066102, 0.03562556579709053, -0.006788252387195826, 0.012779012322425842, 0.0063958861865103245, 0.008753272704780102, -0.020887911319732666, 0.0204795952886343, 0.018757013604044914, -0.02735716663300991, -0.002850236603990197, 0.032945990562438965, 0.002507315017282963, -0.02654053457081318, -0.0018757012439891696, -0.008829832077026367, 0.03723330795764923, 0.018399735912680626, -0.009652843698859215, 0.01936948671936989, -0.012855571694672108, -0.004743482917547226, 0.02809724025428295, -0.03577868267893791, 0.039963919669389725, 0.021755583584308624, -0.014559014700353146, 0.02735716663300991, -0.014775932766497135, 0.04917655140161514, 0.019701244309544563, -0.056653834879398346, 0.00486470153555274, -0.01152216549962759, 0.01075657270848751, -0.01996920071542263, 0.041571665555238724, -0.025060389190912247, 0.01813177950680256, 0.023159168660640717, 0.027153009548783302, 0.005706853233277798, -0.037182267755270004, -0.019548125565052032, -0.020811352878808975, -0.004411725793033838, -0.003441975684836507, -0.011196788400411606, 0.03289495036005974, -0.02266153320670128, 0.0009633703739382327, -0.02290397137403488, -0.012038939632475376, -0.02786756120622158, -0.024384116753935814, 0.02712748944759369, -0.0026221538428217173, -0.011324387043714523, 0.04037223756313324, 0.012223958037793636, 0.01236431673169136, 0.004638213664293289, 0.009021230041980743, 0.020390275865793228, 0.01880805194377899, -0.016485756263136864, 0.02625981904566288, -0.0007320977165363729, 0.04601209983229637, 0.03281839191913605, 0.011624244041740894, 0.032154880464076996, 0.020964471623301506, -0.002421185839921236, 0.03856033459305763, -4.2142470192629844e-05, 0.0226104948669672, -0.013410625979304314, 0.00561115425080061, 0.02939874678850174, -0.0012983171036466956, -0.019943680614233017, 0.014252778142690659, 0.008134419098496437, 0.0017879771767184138, -0.011828402057290077, 0.021704543381929398, 0.005958860740065575, 0.004009789787232876, 0.02290397137403488, -0.01712374947965145, 0.0193950068205595, 0.019560884684324265, 0.009538005106151104, -0.01565636321902275, -0.009933561086654663, -0.0030129249207675457, -0.007809041999280453, 0.01769794337451458, -0.004775382578372955, -0.019216367974877357, -0.00870223343372345, 0.02587702125310898, 0.004485095385462046, -0.015439446084201336, 0.023860961198806763, 0.019701244309544563, -0.03685051202774048, 0.0038439116906374693, -0.01520976796746254, -0.002193103078752756, -0.001427510753273964, -0.004877461586147547, -0.016141239553689957, -0.004797711968421936, 0.011132989078760147, -0.013576504774391651, 0.01637091673910618, 0.007840941660106182, -0.03600836172699928, -0.023299528285861015, 0.043179407715797424, -0.01481421198695898, 0.007700583431869745, -0.04213310033082962, 0.014291057363152504, -0.004073589574545622, -0.0076431636698544025, -0.02252117544412613, -0.03445165604352951, 0.03378814458847046, -0.009754923172295094, 0.01309162937104702, -0.010290836915373802, 0.002532834652811289, 0.041801344603300095, 0.002496150089427829, -0.020147839561104774, -0.0024164009373635054, 0.014265538193285465, -0.028428995981812477, 0.028862832114100456, -0.03672291338443756, 0.006679793354123831, -0.032512154430150986, -0.011273347772657871, 0.008587393909692764, 0.031032010912895203, -0.00194269057828933, -0.015350126661360264, -0.0012472775997593999, 0.005630293861031532, 0.011617864482104778, 0.019790561869740486, 0.005789792165160179, -0.021194148808717728, 0.048104722052812576, -0.016115719452500343, -0.017506545409560204, 0.005202838219702244, 0.010482235811650753, 0.026668133214116096, -0.013882741332054138, -0.013780662789940834, -0.008051480166614056, 0.0011691233376041055, -0.043255969882011414, -0.00512308906763792, -0.012121879495680332, -0.037692662328481674, -0.01910153031349182, -0.002816741820424795, 0.021474866196513176, -0.01330854743719101, -0.0031963482033461332, 0.026872292160987854, -0.006813772022724152, 0.005107139237225056, 0.02092619054019451, 0.034043341875076294, 0.03873897343873978, 0.0030846991576254368, -0.018999449908733368, 0.02603013999760151, 0.002291992073878646, 0.008236497640609741, 0.015745682641863823, 0.008797932416200638, 0.024447916075587273, 0.029679464176297188, 0.01916532963514328, 0.039019692689180374, -0.0020894291810691357, 0.0029443406965583563, -0.027025410905480385, -0.01616675965487957, -0.023860961198806763, -0.00627466756850481, -0.009142449125647545, 0.01843801699578762, 0.008874491788446903, 0.0010678418911993504, -0.005183698143810034, 0.020887911319732666, 0.01364030409604311, -0.010303596965968609, 0.021321747452020645, 0.012421736493706703, 0.018386976793408394, 0.014074139297008514, -0.02244461700320244, 0.02457551471889019, 0.004287317395210266, 0.015413925983011723, 0.029653944075107574, -0.009423165582120419, 0.0007655923836864531, 0.024192718788981438, -0.010877791792154312, 0.005808932241052389, -0.013117149472236633, -0.0058440216816961765, 0.02239357680082321, 0.015681883320212364, -0.008459795266389847, 0.017391705885529518, 0.02881179191172123, 0.02508590929210186, -0.02896491065621376, -0.005662193521857262, 0.0034962052013725042, -0.0167409535497427, -0.021334506571292877, -0.008600153960287571, -0.03715674951672554, -0.00690947100520134, -0.030470576137304306, -0.02157694473862648, 0.022329777479171753, 0.005145418457686901, 0.002205862896516919, -0.0036397536750882864, -0.033890221267938614, -0.02633637748658657, -0.004280937369912863, 0.011898580938577652, 0.04182686284184456, 0.04394500330090523, 0.02267429418861866, 0.02763788402080536, -0.010584314353764057, -0.008931910619139671, -0.021679023280739784, -0.01624331809580326, 0.041648223996162415, -0.0043479264713823795, -0.016702674329280853, -0.025328347459435463, 0.0027401826810091734, -0.03100649081170559, -0.0037450226955115795, -0.010743812657892704, 0.004016169812530279, 0.02574942260980606, -0.00026038114447146654]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" loss function and can be arbitrary. Assume that πθ=C′πfor all
a∈support( π∗)\\support( πoff), where π(·|x)∈∆(A) and define
Ωx={a∈support( π∗) :πoff(a|x) = 0},
as the set of outputs that can be generated by π∗but not by πoff. Then the policy πθ(a|x)∝(1−
1Ωx(a))π∗(a|x)+1Ωx(a)π(a|x) minimizes L∞(θ, π0, x), where 1Ωx(·) is the indicator function for Ω xand the
normalizing constant C, C′satisfy the normalization condition Eπθ(a|x)1 = 1.
Essentially, the dataset used for optimizing loss in Equation (8) imposes constraints via Lemma 5. For
outputs not covered by πoff,πθcan be an arbitrary solution and only sufficient constraints can lead to
44
convergence to the π∗. Therefore, to ensure that πθconverges to π∗for every state-action pair ( x, a) where
π∗(a|x)>0, it is essential to have |Ωx|=∅or
sup
a∈Aπ∗(a|x)
πoff(a|x)<∞,for any x∈support( d0),
where we use the convention of 0 /0 = 0.
Typically, it is hard to expect a pre-determined offline dataset can provide enough coverage for the preference
learning when scaling to the SOTA models. Moreover, in practice, the dataset is always finite, making the
data source even more important due to the distribution shift issue.
F Technical Lemma Proofs
Proof of Lemma 2. Since ˆ πis induced by calling Oracle 1 with ˆ r, we know that for any x∈ X,
ˆπ(a|x) =1
Z(x)π0(a|x)·exp1
η·ˆr(a|x)
,
where Z(x) =P
a∈Aπ0(a|x) exp(1
ηˆr(x, a)) is the normalization constant. We can rewrite the reward function
as
ˆr(x, a) =ηlogˆπ(a|x)
π0(a|x)+ηlogZ(x).
Plugging this reward reparameterization into the policy optimization error under ˆ r, we have
Eπ[ˆr(x, a)]−Eˆπ[ˆr(x, a)]
=Eπh
ηlogˆπ(a|x)
π0(a|x)i
−Eˆπh
ηlogˆπ(a|x)
π0(a|x)i
=Eπh
ηlogπ(a|x)
π0(a|x)i
−Eπh
ηlogπ(a|x)
ˆπ(a|x)i
−η·DKL(ˆπ(·|x)∥π0(·|x))
=η·DKL(π(·|x)∥π0(·|x))−η·DKL(π(·|x)∥ˆπ(·|x))−η·DKL(ˆπ(·|x)∥π0(·|x)).
Plugging the above equality into the LHS of the Lemma 2 completes the proof.
Proof of Lemma 5. The loss function can be reformulated as the KL divergence plus a constant term:
DKL(p∗∥pθ)−
p∗(a1≻a2|x) logp∗(a1≻a2|x) +p∗(a2≻a1|x) logp∗(a2≻a1|x)
.
This implies that p∗=pθis the unique optimal solution for pθ. Moreover, if the condition πθ(a1|x)/πθ(a2|x) =
π∗(a1|x)/π∗(a2|x) is satisfied, the optimality of the solution is assured.
G Technical Lemmas
Lemma 6 (Jensen’s Inequality) .Suppose that ϕ(w)is a convex function on Ω. Consider w1,···, wm∈Ω,
and non-negative numbers α1,···, αm∈Rso thatPm
i=1αi= 1. Then,
ϕ(mX
i=1αiwi)≤mX
","[0.018282536417245865, -0.046922240406274796, 0.006407077889889479, -0.006652777083218098, 0.03593507781624794, 0.002455416601151228, 0.00013781202142126858, 0.032810285687446594, 0.006218078546226025, 0.04321785271167755, 0.03999226167798042, -0.0257165115326643, -0.04422584921121597, -0.011453360319137573, 0.02797190472483635, -0.00893336907029152, 0.05102982372045517, 0.00785607285797596, -0.0018317187204957008, 0.02683790773153305, 0.006233828607946634, -0.02651030942797661, 0.03779986873269081, 0.0066338772885501385, 0.029534298926591873, -0.010546163655817509, 0.033868685364723206, 0.02373831905424595, 0.029307499527931213, -0.049240630120038986, 0.04490624740719795, -0.02560311183333397, -0.022188523784279823, -0.054784610867500305, 0.00028861776809208095, 0.05554061010479927, 0.02610711008310318, 0.05816140025854111, -0.021835725754499435, 0.013998552225530148, -9.942153701558709e-05, -0.036867473274469376, -0.060479793697595596, 0.039311863481998444, 0.001068633864633739, 0.018685735762119293, 0.021092327311635017, 0.020361529663205147, -0.016757942736148834, 0.024393515661358833, -0.03762347251176834, 0.022843722254037857, 0.019303133711218834, 0.003972136415541172, 0.004750183783471584, 0.0036760373041033745, 0.011150961741805077, 0.02135692723095417, 0.04866103455424309, -0.015976745635271072, 0.028097903355956078, 0.0005969229387119412, 0.0271151065826416, 0.009134968742728233, -0.008366371504962444, 0.009865766391158104, -0.023045320063829422, 0.051332224160432816, 0.0027704155072569847, 0.07464214414358139, -0.0076481737196445465, -0.022012123838067055, 0.05453261360526085, -0.00372328725643456, -0.00836007110774517, 0.015674347057938576, 0.0564982071518898, 0.03452388197183609, 0.019479533657431602, -0.020600929856300354, 0.016027145087718964, -0.01847153715789318, 0.052466221153736115, -0.05241582170128822, 0.023587118834257126, -0.08436930924654007, -0.06748536974191666, 0.007137875538319349, -0.0621429868042469, 0.02090332843363285, 2.628272159199696e-05, -0.007830873131752014, 0.016291745007038116, -0.0015529446536675096, 0.04674584046006203, 0.024935314431786537, 0.04399904981255531, 0.0008560095448046923, 0.014401750639081001, 0.005503030959516764, 0.008070272393524647, -0.08809889853000641, 0.003950086422264576, -0.03029029630124569, 0.02875310182571411, -0.022793320938944817, -0.006192878820002079, 0.048232633620500565, 0.011654959991574287, -0.017362739890813828, -0.05463341251015663, -0.05271821841597557, -0.04621664062142372, 0.036640673875808716, 0.014968748204410076, -0.08043812215328217, -0.07388614863157272, 0.003518537851050496, -0.004328085109591484, -0.018862135708332062, 0.005994429346174002, -0.03661547601222992, 0.0161027442663908, 0.006980375852435827, 0.01378435268998146, -0.01775333844125271, 0.019529933109879494, -0.05216382071375847, 0.005940879695117474, -0.007919073104858398, -0.008095472119748592, 0.00836007110774517, 0.0020222931634634733, -0.06541897356510162, -0.03795107081532478, 0.03207949176430702, 0.003946936689317226, 0.006753576919436455, 0.01983233168721199, 0.007868672721087933, -0.006189728621393442, -0.006652777083218098, -0.06809016317129135, 0.010728863067924976, -0.06521737575531006, 0.005692030303180218, 0.0060857790522277355, 0.01712334156036377, -0.011875458993017673, 0.003628787584602833, 0.03192828968167305, 0.0017639939906075597, -0.02943349815905094, 0.03419628366827965, -0.014641149900853634, -0.0333394855260849, -0.029685497283935547, 0.0734325498342514, 0.020411929115653038, -0.020537929609417915, -0.018736135214567184, 0.059471797198057175, 0.010772963054478168, -0.014930948615074158, 0.04097506031394005, 0.039815861731767654, -0.013519753701984882, 0.02440611645579338, -0.048031035810709, -0.044099848717451096, 0.002134117763489485, 0.0037957369349896908, -0.04157985746860504, -0.0276947058737278, -0.00617397902533412, -0.030164295807480812, -0.01239835750311613, -0.03316308557987213, 0.0026837908662855625, -0.012990555725991726, 0.026459909975528717, 0.02915629930794239, 0.004646234214305878, -0.007383574731647968, -0.033314283937215805, 0.008479771204292774, -0.009701966308057308, -0.007811973337084055, 0.021545926108956337, -0.013368554413318634, 0.016455544158816338, 0.014804949052631855, 0.05211342126131058, -0.020361529663205147, -0.00018811342306435108, -0.03538068011403084, 0.02283112145960331, 0.05957259610295296, -0.007585173938423395, 0.0367162749171257, 0.023776117712259293, 0.0059188297018408775, 0.016657141968607903, -0.0384298674762249, -0.010842262767255306, 0.011024962179362774, -0.0025467663072049618, 0.021734924986958504, -0.05080302432179451, -0.02615750953555107, 0.0003526019281707704, 0.0026743407361209393, 0.009720866568386555, -0.020991528406739235, -0.013355954550206661, 0.02971069887280464, -0.03132349252700806, 0.023813918232917786, -0.00836007110774517, 0.07096295803785324, -0.01528374757617712, 0.04467944800853729, 0.03273468837141991, 0.019454333931207657, -0.022679923102259636, -0.013721353374421597, 0.03719507157802582, -0.04142865911126137, 0.02588031068444252, -0.04374704882502556, 0.03716987371444702, 0.0257165115326643, -0.011270660907030106, -0.008706570602953434, 0.02259172312915325, -0.050878625363111496, -0.017488740384578705, -0.00254204124212265, -0.006526777520775795, -0.03779986873269081, -0.024683315306901932, 0.014502550475299358, 0.0009953966364264488, -0.02892949990928173, -0.013935551978647709, 0.020600929856300354, -0.02983669750392437, 0.023700518533587456, -0.04163025692105293, -0.0322054885327816, 0.014704149216413498, -0.016631942242383957, -0.03255828842520714, -0.019504733383655548, -0.050878625363111496, -0.0030318645294755697, 0.0015198697801679373, -0.00744657451286912, -0.019366133958101273, 0.02865230105817318, -0.011478560976684093, 0.01927793398499489, -0.00521323224529624, -0.0013741827569901943, -0.01065326388925314, -0.02683790773153305, 0.008939669467508793, 0.02396511845290661, 0.04392344877123833, 0.01105016190558672, 0.021961724385619164, 0.0406978614628315, -0.06531817466020584, 0.04530944302678108, -0.010363464243710041, -0.05362541601061821, 0.00022443673515226692, 0.040597062557935715, -0.04893823340535164, 0.009248368442058563, -0.04848463460803032, -0.01916453428566456, 0.062243785709142685, 0.01627914421260357, 0.056699804961681366, -0.03583427891135216, -0.010968262329697609, -0.009846866130828857, -0.06365498155355453, -0.026661507785320282, -0.0037705369759351015, -0.026737108826637268, 0.028904300183057785, 0.0060857790522277355, 0.0012198332697153091, 0.03283548727631569, -0.010432763956487179, -0.05322221666574478, -0.020978927612304688, 0.048106636852025986, 0.057607002556324005, -0.00861837062984705, -0.05102982372045517, 0.005991279613226652, -0.011629760265350342, 0.018748736009001732, 0.03283548727631569, -0.0007209538016468287, -0.005695180501788855, -0.0027940403670072556, -0.008076571859419346, 0.027770305052399635, -0.022579122334718704, 0.0451834462583065, -0.03933706507086754, -0.028576701879501343, 0.054280612617731094, -0.021823124960064888, 0.0008213596884161234, -0.03512867912650108, -0.013973352499306202, -0.06143739074468613, -0.004498184658586979, -0.031096693128347397, 0.02513691410422325, 0.02385171875357628, -0.028123103082180023, 0.004863583482801914, -0.00018456968246027827, -0.03527987748384476, 0.005399081390351057, -0.027190707623958588, 0.008007272146642208, -0.008479771204292774, -0.018106138333678246, -0.01740054041147232, -0.0296602975577116, 0.05417981371283531, 0.024884914979338646, 0.008605770766735077, -0.08744370192289352, 0.0018395936349406838, -0.03434748202562332, 0.007988372817635536, -0.01615314371883869, -0.0030098147690296173, 0.02361231856048107, 0.023272119462490082, 0.06768696755170822, 0.05276861786842346, -0.027493106201291084, -0.02135692723095417, 0.02620791085064411, 0.04024426266551018, 0.011629760265350342, 0.010772963054478168, -0.0011363585945218801, -0.07237415015697479, -0.06315098702907562, -0.0008237221627496183, -0.010646963492035866, -0.036867473274469376, 0.04878703132271767, -0.020991528406739235, -0.007465474307537079, 0.024683315306901932, -0.0009048344218172133, -0.010917862877249718, 0.0007945847464725375, 0.0033925382886081934, -0.003833536757156253, 0.03230628743767738, -0.05307101830840111, 0.013204754330217838, -0.034775879234075546, 0.0028633400797843933, -0.017324941232800484, -0.001675794250331819, 0.04979502782225609, -0.016871342435479164, -0.03316308557987213, -0.0010733588133007288, 0.00044769220403395593, -0.015560946427285671, 0.011535260826349258, 0.0031216393690556288, -0.033591486513614655, -0.01931573450565338, -0.017614739015698433, -0.04251225292682648, 0.025640912353992462, -0.01706034131348133, 6.767555169062689e-05, 0.030869893729686737, -0.029055500403046608, 0.003102739341557026, -0.02860190160572529, 0.048459433019161224, 0.03538068011403084, 0.04039546102285385, -0.013015755452215672, -0.00958226714283228, -0.04684663936495781, -0.01756433956325054, -0.06199178844690323, -0.024494316428899765, 0.00895856972783804, 0.02531331405043602, -0.01921493373811245, 0.05559100955724716, 0.021382126957178116, -0.004743883851915598, -0.00015897602133918554, -0.024431316182017326, 0.01876133494079113, -0.011415560729801655, 0.004205235745757818, 0.004261935595422983, 0.01285195630043745, 0.023876918479800224, 0.018912535160779953, -0.029307499527931213, 0.025514911860227585, -0.02593071013689041, -0.02875310182571411, 0.0017057191580533981, 0.039009466767311096, -0.006929976399987936, 0.011913259513676167, -0.039412666112184525, 0.009909866377711296, 0.038959067314863205, 0.013570153154432774, -0.002485341392457485, -0.07181975245475769, 0.006246428471058607, 0.0296602975577116, -0.03802666813135147, -0.006980375852435827, -0.04656944051384926, 0.02129392698407173, -0.03170149028301239, -0.03480108082294464, 0.019126733765006065, -0.002800340298563242, 0.014603350311517715, -0.016972141340374947, -0.02333511970937252, -0.011541560292243958, 0.02102932706475258, -0.043822649866342545, 0.005773930344730616, 0.06798936426639557, 0.00477223377674818, -0.005534531082957983, -0.05644780769944191, 0.06546937674283981, 0.0007721410947851837, -0.021709725260734558, 0.02289412170648575, -0.01637994311749935, -0.03583427891135216, -0.01265665702521801, -0.02407851815223694, 0.01927793398499489, 0.0177911389619112, 0.031222693622112274, 0.006025929469615221, -0.023813918232917786, 0.039185866713523865, -0.03790067136287689, -0.05236542224884033, 0.04163025692105293, -0.025288112461566925, -0.023650119081139565, 0.014363951049745083, 0.034498680382966995, -0.018458936363458633, 0.03779986873269081, -0.055742207914590836, 0.010596564039587975, -0.01684614270925522, -0.014704149216413498, -0.009046768769621849, 0.02294452115893364, 0.07242455333471298, 0.08280691504478455, -0.02265472151339054, -0.03215508908033371, -0.005635330453515053, -0.01712334156036377, -0.04344465211033821, 0.052516620606184006, -0.013129155151546001, -0.00329173868522048, -0.038908667862415314, -0.011654959991574287, -0.028274303302168846, -0.0005138419801369309, 0.005021082703024149, 0.0621429868042469, -0.05730460211634636, -0.010987162590026855, 0.02792150340974331, -0.015182947739958763, 0.021709725260734558, 0.012461356818675995, -0.008908169344067574, -0.02734190598130226, 0.02174752578139305, -0.042940653860569, 0.013431553728878498, -0.0015560946194455028, -0.002504241419956088, -0.02729150652885437, -0.0018474686658009887, -0.03175188973546028, -0.0030476145911961794, -0.03298668563365936, 0.03653987497091293, -0.0039437864907085896, -0.02514951303601265, 0.0037957369349896908, -0.012127458117902279, 0.02451951615512371, 0.03107149340212345, -0.029987897723913193, -0.10533563792705536, -0.037724271416664124, -0.03719507157802582, 0.052466221153736115, -0.0013206329895183444, 0.029685497283935547, 0.0033043387811630964, 0.008177371695637703, 0.02305792085826397, -0.011743159964680672, -0.0003120457986369729, -0.02057573013007641, 0.013040955178439617, 0.031449493020772934, -0.007685973774641752, -0.014754549600183964, 0.007553674280643463, 0.02842550165951252, -0.06284858286380768, 0.036817073822021484, -0.009727166965603828, -0.019807131960988045, 0.033641885966062546, -0.02305792085826397, -0.005739280488342047, -0.05216382071375847, -0.0110186617821455, -0.0570526048541069, -0.006797676905989647, -0.02860190160572529, 0.036086276173591614, -0.0026050410233438015, 0.04881223291158676, -0.015447546727955341, 0.01135256141424179, 0.013456753455102444, -0.011024962179362774, -0.021936524659395218, 0.033415086567401886, 0.0148301487788558, 0.005184882320463657, 0.0047942837700247765, 0.029962697997689247, -0.05826219916343689, 0.021772725507616997, 0.027896303683519363, -0.028954701498150826, 0.01031306479126215, -0.010073665529489517, 0.05276861786842346, 0.0032822887878865004, 0.005269932094961405, -0.0012025083415210247, -0.031147092580795288, 0.0032255889382213354, -0.023246919736266136, -0.030315496027469635, -0.031953491270542145, -0.0025136913172900677, -0.0031184894032776356, -0.006101529113948345, -0.04304145276546478, 0.018660536035895348, 0.04034506157040596, -0.053121417760849, -0.044780246913433075, -0.016946941614151, -0.038959067314863205, -0.004359585233032703, 0.01031306479126215, 0.021394725888967514, 0.007881272584199905, -0.02339811995625496, 0.05062662810087204, 0.012083358131349087, 0.002212867373600602, -0.0038650366477668285, -0.01294015534222126, 0.015208147466182709, -0.042008254677057266, 0.023889517411589622, 0.028223903849720955, 0.01785413920879364, -0.000701660115737468, -0.03311268612742424, 0.032860688865184784, 0.025527512654662132, -0.05281901732087135, -0.030995894223451614, 0.004973832983523607, 0.0027688404079526663, 0.04362105205655098, -0.024544715881347656, -0.012083358131349087, -0.012562156654894352, 0.030239896848797798, -0.0024601416662335396, -0.019618133082985878, 0.045057445764541626, -0.05102982372045517, -0.024670714512467384, 0.03515388071537018, -0.011648659594357014, -0.010331964120268822, -0.013028355315327644, 0.017324941232800484, 0.004198935814201832, 0.025275513529777527, -0.027140306308865547, 0.014174951240420341, -0.02283112145960331, 0.021495526656508446, -0.049921028316020966, 0.021936524659395218, 0.04299105331301689, -0.008095472119748592, -0.01915193349123001, 0.007811973337084055, 0.006394478026777506, -0.025666112080216408, 0.02779550477862358, -0.03255828842520714, -0.0434950515627861, -0.01265665702521801, -0.02221372351050377, 0.00721977511420846, 0.0018836935050785542, 0.01650594361126423, 0.0010016965679824352, 0.004573784302920103, -0.016934342682361603, 0.01039496436715126, -0.01780373975634575, -0.02565351128578186, 0.0014608075143769383, 0.013708752579987049, -0.007238675374537706, 0.011421861127018929, 0.00764187378808856, 0.023713119328022003, 0.051508624106645584, 0.007433974649757147, -0.023977717384696007, -0.027543505653738976, 0.0071000754833221436, 0.030466696247458458, -0.019227534532546997, -0.019504733383655548, -0.01869833655655384, -0.01819433830678463, -0.016820942983031273, -0.04780423641204834, 0.01712334156036377, -0.04157985746860504, 0.0004055611207149923, -0.026308709755539894, 0.006961476057767868, -0.024683315306901932, 0.0024002918507903814, 0.016795743256807327, -0.012366857379674911, -0.010382364504039288, -0.020273329690098763, -0.02943349815905094, -0.007944272831082344, 0.03243228793144226, -0.015031748451292515, 0.0020978928077965975, 0.029131099581718445, -0.007919073104858398, 0.042688652873039246, -0.008769569918513298, -0.037598270922899246, -0.016014544293284416, 0.022516122087836266, -0.022730322554707527, -0.002058517886325717, -0.05271821841597557, -0.027719905599951744, -0.001093046274036169, 0.051281824707984924, 0.012839355506002903, -0.057607002556324005, -0.00488563347607851, -0.00186164362821728, -0.022075124084949493, 0.014074151404201984, 0.004066635854542255, 0.00951926689594984, 0.03853066638112068, -0.008322271518409252, 0.007786773145198822, -0.033767882734537125, -0.02407851815223694, -0.028324702754616737, -0.05927019566297531, 0.0231713205575943, -0.0067346771247684956, 0.00114108354318887, -0.03470028191804886, 0.008019872941076756, -0.004869883414357901, 0.009538167156279087, -0.008101772516965866, 0.022226324304938316, -0.032003890722990036, -0.006432278081774712, -0.005921979900449514, 0.031953491270542145, 0.021621525287628174, 0.03633827716112137, -0.01767773926258087, -0.019139334559440613, 0.010470564477145672, -0.011113162152469158, -0.042865052819252014, -0.006495277862995863, 0.047779034823179245, 0.018320336937904358, 0.005490431096404791, 0.027442706748843193, 0.009947665967047215, 0.03621227666735649, -0.005685730371624231, 0.010174465365707874, -0.01350715383887291, -0.00048076710663735867, 0.03238188847899437, -0.007276474963873625, -0.013355954550206661, 0.010854862630367279, -0.011075361631810665, -0.02067652903497219, 0.008202571421861649, -0.007717473432421684, -0.02960989810526371, 0.007881272584199905, -0.001823843689635396, -0.04422584921121597, -0.030214697122573853, -0.031096693128347397, 0.052516620606184006, -0.012965355068445206, 0.016858741641044617, 0.013859952799975872, -0.02746790647506714, 0.038505468517541885, 0.022742921486496925, 0.0069110761396586895, 0.009701966308057308, -0.03643907606601715, 0.02158372662961483, -0.03185269236564636, -0.03412068262696266, -0.019025934860110283, 0.01378435268998146, -0.022629521787166595, -0.025124313309788704, -0.018295137211680412, 0.009506667032837868, -0.015132548287510872, 0.008511270396411419, -0.05352461710572243, -0.01775333844125271, -0.020096931606531143, -0.005458931438624859, -0.023599719628691673, 0.020701728761196136, 0.011957358568906784, -0.0514078252017498, -0.0955076739192009, -0.03338988497853279, -0.005959779489785433, -0.005805430002510548, 0.01897553540766239, -0.007471774239093065, 0.03212989121675491, 0.0037894370034337044, 0.005165982060134411, -0.044956646859645844, 0.0032885887194424868, -0.00711897574365139, 0.0012308582663536072, 0.012707056477665901, 0.010187065228819847, -0.04137825965881348, -0.02514951303601265, 0.018635336309671402, 0.014111951924860477, -0.0014482075348496437, -0.011610860005021095, -0.011900658719241619, 0.022238923236727715, 0.03442308306694031, -0.0172367412596941, 0.009116068482398987, 0.02424231730401516, -0.001845893682911992, -0.009065669029951096, 0.008063971996307373, 0.0025451912079006433, -0.019403932616114616, 0.028349902480840683, 0.013242554850876331, -0.025439312681555748, -0.02153332531452179, 0.008259271271526814, -0.009922466240823269, 0.006177128758281469, 0.035229478031396866, 0.01223455835133791, -0.04006786271929741, 0.05982459336519241, 0.0021120677702128887, 0.008007272146642208, -0.05417981371283531, 0.02424231730401516, -0.009424767456948757, -0.007893873378634453, -0.022503523156046867, 0.0009394842782057822, -0.018572336062788963, -0.006627577356994152, -0.03230628743767738, 0.008763269521296024, -0.010640663094818592, 0.01566174626350403, 0.022251524031162262, -0.016027145087718964, -0.010968262329697609, -0.03338988497853279, 0.025162113830447197, 0.02164672501385212, -0.007263875100761652, -0.013103955425322056, -0.018068337813019753, -0.014880549162626266, 0.004454084672033787, -0.02153332531452179, -0.04283985123038292, -0.004866733215749264, -0.02978629805147648, -0.010659563355147839, 0.02870270237326622, -0.00924206804484129, 0.008914469741284847, 0.0013938702177256346, 0.0029562648851424456, -0.018383337184786797, 0.027593905106186867, 0.05639740824699402, 0.01062176376581192, 0.011793559417128563, 0.035683076828718185, 0.020386729389429092, 0.02210032381117344, 0.01881173625588417, -0.02593071013689041, -0.03961426392197609, -0.027039507403969765, 0.02892949990928173, -0.01566174626350403, 0.011226561851799488, -0.01706034131348133, -0.02390211820602417, -0.00943736732006073, -0.037598270922899246, 0.01830773800611496, 0.0121526587754488, 0.011365161277353764, 0.025729112327098846, 0.04135305806994438, 0.006170828826725483, 0.007685973774641752, 0.019983531907200813, -0.023183921352028847, 0.01053986418992281, 0.011377761140465736, 0.024028116837143898, -0.004249335266649723, 0.016064945608377457, -0.011125762015581131, -0.02779550477862358, -0.001330082886852324, -0.013998552225530148, -0.0015419196570292115, 0.036136675626039505, 0.014363951049745083, -0.004507634323090315, -0.018093537539243698, 0.0231713205575943, 0.03092029318213463, -0.00446668453514576, 0.03462468087673187, -0.004567484371364117, -0.023372920230031013, -0.012461356818675995, 0.011302161030471325, -0.0018584936624392867, 0.017274539917707443, 0.0004953357856720686, -0.00103870895691216, -0.0006634664605371654, 0.004129635635763407, -0.0004150110762566328, 0.027719905599951744, 0.030239896848797798, 0.01649334281682968, -0.03374268487095833, 0.0033421386033296585, -0.0033799384254962206, 0.012952755205333233, -0.011087962426245213, 0.008221471682190895, -0.0013765452895313501, 0.0127133559435606, -0.011384060606360435, -0.020941128954291344, -0.024317916482686996, 0.020588329061865807, 0.02746790647506714, -0.012473957613110542, -0.0015860195271670818, -0.011283261701464653, -0.007988372817635536, -0.0022459423635154963, 0.032003890722990036, -0.023095721378922462, -0.006236978806555271, 0.014842748641967773, 0.015346747823059559, 0.024771515280008316, -0.010193364694714546, 5.788105045212433e-05, 0.03056749515235424, -0.03938746452331543, -0.029131099581718445, -0.0061109792441129684, 0.013771752826869488, -0.005613280925899744, -0.02751830592751503, -0.043318651616573334, 0.0018947185017168522, 0.007635573856532574, 0.005688880570232868, -0.019517332315444946, 0.022629521787166595, 0.029761098325252533, -0.01051466353237629, -0.0012647206895053387, 0.019000735133886337, -0.0011072212364524603, -0.045687444508075714, -0.022730322554707527, 0.03533028066158295, -0.016745341941714287, 0.01189435925334692, 0.003950086422264576, 0.010665863752365112, 0.026812708005309105, 0.05012262985110283, 0.015271147713065147, 0.01174945943057537, 0.028400301933288574, 0.015119948424398899, -0.024141516536474228, -0.003420888213440776, 0.030189495533704758, 0.010357164777815342, -0.024897513911128044, -0.019000735133886337, 0.039185866713523865, -0.013834752142429352, 0.001797068864107132, -0.02339811995625496, 0.02299492061138153, -0.02221372351050377, -0.029735898599028587, -0.006740977056324482, -0.006866976618766785, 0.042184654623270035, -0.01767773926258087, -0.0038146369624882936, 0.006151929032057524, -0.013985952362418175, -0.036187075078487396, 0.0016616192879155278, 0.0029688647482544184, -0.02463291585445404, -0.0009591717389412224, 0.004271385259926319, -0.019492132589221, 0.011692759580910206, 0.016921741887927055, -0.0045233843848109245, -0.007244975306093693, 0.04956822842359543, -0.0006662227096967399, -0.008139572106301785, -0.009601167403161526, -0.015308947302401066, 0.031172292307019234, -0.01389775238931179, 0.004980132915079594, 0.0237257182598114, -0.02164672501385212, -0.02034893073141575, 0.0118628591299057, 0.012927555479109287, -0.004066635854542255, 0.02513691410422325, -0.0004098923527635634, -0.004271385259926319, 0.027493106201291084, 0.01678314246237278, 0.0004311547672841698, 0.01200775895267725, 0.07353334873914719, -0.0060542793944478035, 0.0006252728635445237, -0.039412666112184525, 0.05397821590304375, 0.029231900349259377, -0.0014104077126830816, -0.0023892668541520834, 0.030769094824790955, 0.02226412296295166, 0.034599483013153076, 0.02451951615512371, -0.011938459239900112, -0.012064458802342415, 0.0020175680983811617, -0.010306764394044876, -0.039815861731767654, -0.010691063478589058, -0.034725479781627655, -0.02073952928185463, 0.0406726598739624, 0.015586146153509617, 0.005717230495065451, 0.0013119705254212022, 0.017879338935017586, -0.014767149463295937, 0.010867462493479252, 0.020537929609417915, 0.0005496731027960777, 0.034549079835414886, 0.01746354065835476, 0.01569954678416252, -0.006066879257559776, -0.041781455278396606, -0.008007272146642208, 0.02464551478624344, -0.0064889779314398766, 0.014792349189519882, -0.010495764203369617, 0.03175188973546028, 0.010357164777815342, -0.012291258201003075, 0.02328472025692463, 0.0189251359552145, 0.03207949176430702, -0.014842748641967773, 0.012014058418571949, 0.005336081609129906, -0.04346984997391701, -0.02860190160572529, 0.017274539917707443, -0.023864317685365677, 0.0015962569741532207, 0.02746790647506714, -0.010583963245153427, -0.026132309809327126, -0.009827965870499611, 0.01203925907611847, 0.020374130457639694, 0.013519753701984882, -9.568092355038971e-05, -0.01282675564289093, -0.028400301933288574, 0.030315496027469635, -0.026989107951521873, -0.005298282019793987, 0.03273468837141991, 0.014061551541090012, -0.001751394011080265, -0.025048714131116867, -0.014792349189519882, -0.004271385259926319, -0.003691787365823984, -0.013822152279317379, -0.02519991435110569, 0.013355954550206661, 0.015044348314404488, -0.029861897230148315, -0.02044972963631153, 0.020663928240537643, -0.015195547603070736, -0.0038681868463754654, 0.006690577138215303, -0.021785324439406395, 0.0026995406951755285, 0.02509911358356476, -0.028274303302168846, -0.008656170219182968, 0.0013702453579753637, -0.02837510220706463, -0.0031830640509724617, -0.03651467338204384, -0.04062226042151451, 0.006986676249653101, 0.0177911389619112, -0.0004866733215749264, -0.015737345442175865, -0.016631942242383957, 0.012417257763445377, -0.010880062356591225, 0.007188275456428528, -0.008807369507849216, -0.00733317481353879, 0.06466297805309296, -0.01876133494079113, -0.024141516536474228, 0.011207661591470242, 0.008990068919956684, 0.03797626867890358, -0.016946941614151, -0.019466932862997055, -0.012612557038664818, -0.0004921858198940754, -0.014603350311517715, 0.03971506282687187, -0.016568943858146667, -0.012297557666897774, 0.026661507785320282, 0.024708515033125877, -0.016316944733262062, 0.0007457599276676774, 0.00436588516458869, 0.015838146209716797, 0.012524357065558434, -0.017589539289474487, 0.0038272368256002665, 0.01471674907952547, 0.018408536911010742, -0.0067346771247684956, -0.03273468837141991, 0.004076085984706879, -0.019643332809209824, 0.04052146151661873, -0.0004906108370050788, -0.005959779489785433, -0.07045895606279373, 0.020323731005191803, 0.001276533119380474, -0.018622735515236855, -0.029231900349259377, 0.008492371067404747, -0.013192154467105865, -0.0037201372906565666, -0.027039507403969765, -0.018559737130999565, -0.03432228043675423, 0.003855586750432849, 0.007169375196099281, 0.01903853379189968, 0.0034744380973279476, 0.014174951240420341, 0.013229954987764359, 0.006860676687210798, 0.0007859222823753953, -0.013381154276430607, 0.01955513283610344, -0.013103955425322056, -0.019366133958101273, -0.0021845174487680197, -0.029811497777700424, 0.008807369507849216, -0.01466634962707758, 0.009588567540049553, -0.04029466211795807, 0.016757942736148834, 0.001286770566366613, -0.008347471244633198, -0.007780473213642836, -0.006948876194655895, -0.009292468428611755, 0.02633390948176384, -0.01373395323753357, 0.04712383821606636, -0.03603587672114372, 0.020953727886080742, 0.0034712881315499544, -0.013771752826869488, -0.004375334829092026, 0.010634363628923893, -0.015976745635271072, 0.01178095955401659, -0.008315971121191978, 0.02390211820602417, -0.027820704504847527, -0.006104678846895695, -0.010350864380598068, 0.011881759390234947, -0.005827479995787144, 0.019492132589221, 0.019592933356761932, 0.016657141968607903, -0.008045072667300701, 0.01707294210791588, -0.012196757830679417, 0.0105902636423707, 0.01466634962707758, -0.023461120203137398, -0.014956148341298103, -0.01070366334170103, 0.015901144593954086, -0.0012993705458939075, -0.04152945801615715, 0.026132309809327126, 0.005843230057507753, 0.008492371067404747, 0.019819732755422592, 0.012568457052111626, -0.02276812121272087, -0.0006425977917388082, -0.044326648116111755, -0.009607466869056225, 0.0045800842344760895, -0.01362055353820324, 0.010023266077041626, -0.023070521652698517, 0.03170149028301239, 0.005065182689577341, -0.004529684316366911, 0.009172768332064152, -0.00329173868522048, 0.018093537539243698, 0.008265571668744087, -0.01769034005701542, 0.008070272393524647, 0.0068228766322135925, 0.01328035444021225, 0.005688880570232868, 0.022125523537397385, 0.041957855224609375, -0.01093046274036169, 0.008567970246076584, -0.006885876413434744, -0.00022384610201697797, -0.02044972963631153, 0.02875310182571411, 0.0025436163414269686, -0.014187551103532314, 0.0058306301943957806, 0.03407028317451477, -0.002501091454178095, -0.005862129852175713, -0.01239835750311613, -0.00816477183252573, 0.030391095206141472, 0.008719170466065407, -0.00853647105395794, 0.017488740384578705, 0.019958332180976868, -0.01955513283610344, 0.01339375413954258, -0.022957121953368187, 0.007566274143755436, 0.002986189676448703, -0.005471531301736832, 0.035960275679826736, -0.014048951677978039, 0.046367842704057693, 0.011654959991574287, -0.02729150652885437, 0.017211541533470154, -0.01034456491470337, 0.006558277644217014, -0.014477350749075413, 0.02412891760468483, -0.007597773801535368, 0.004476134665310383, 0.03719507157802582, 0.02797190472483635, 0.000601647945586592, -0.017324941232800484, -0.0006122791673988104, -0.0180809386074543, -0.017224140465259552, -0.002849165117368102, 0.00017866345297079533, 0.024670714512467384, -0.016745341941714287, 0.011528960429131985, -0.011031262576580048, 0.0078056734055280685, -0.015296347439289093, -0.007074875757098198, 0.01432615052908659, -0.01954253390431404, -0.026409508660435677, 0.04417544975876808, 0.007175675593316555, 0.007893873378634453, 0.003383088391274214, 0.012499157339334488, 0.015586146153509617, 0.0006878788699395955, -0.007585173938423395, 0.011692759580910206, 0.004844683222472668, 0.03129829093813896, 0.00785607285797596, 0.0013930826680734754, 0.021709725260734558, 0.027215907350182533, -0.0025892911944538355, 0.0502738282084465, -0.0019907932728528976, 0.01443955022841692, -0.018773935735225677, 0.0008615220431238413, 0.005921979900449514, -0.006501577794551849, -0.0026239410508424044, 0.0223271232098341, 0.02729150652885437, 0.005282531958073378, 0.03185269236564636, 0.032003890722990036, -0.0003337019879836589, 0.012965355068445206, 0.005421131383627653, -0.01031306479126215, 0.021936524659395218, 0.02395251765847206, -0.003235038835555315, -0.008687670342624187, -0.012404657900333405, -0.03487668186426163, -0.008454570546746254, 0.02271772176027298, 0.0012174708535894752, -0.029912296682596207, -0.00013741827569901943, 0.011006061919033527, 0.0006173978908918798, 0.012688156217336655, 0.04420064762234688, 0.011024962179362774, -0.01615314371883869, 0.0050147827714681625, -0.017702938988804817, -0.010804463177919388, -0.024380916729569435, 0.004261935595422983, -0.024229716509580612, 0.002082142746075988, 0.023650119081139565, -0.030416294932365417, 0.01927793398499489, 0.01905113458633423, -0.018635336309671402, 0.014817548915743828, 0.035859476774930954, -0.0019655933137983084, 0.008189971558749676, -0.06118538975715637, 0.014603350311517715, 0.022364923730492592, -0.00488878320902586, -0.015636546537280083, -0.03107149340212345, 0.04508264362812042, -0.0014804949751123786, -0.0005524293519556522, -0.02819870412349701, -0.004038285929709673, 0.02125612646341324, 0.00836007110774517, -0.000893021933734417, 0.009840566664934158, -0.0013080330099910498, -0.022566523402929306, 0.024317916482686996, -0.015535746701061726, -0.002902715001255274, -0.04561184346675873, -0.013960751704871655, -0.0058400798588991165, 0.036086276173591614, 0.008152171969413757, -0.017954938113689423, 0.014981348998844624, -0.0026081909891217947, 0.023259520530700684, 0.025111714377999306, 0.028047503903508186, -0.018559737130999565, 0.03396948426961899, -0.0038650366477668285, -0.009796466678380966, 0.016291745007038116, 0.03255828842520714, 0.03250788897275925, -0.041605059057474136, -0.034271880984306335, 0.005235282238572836, -0.0014560824492946267, -0.02576691098511219, -0.017211541533470154, -0.01362055353820324, -0.028349902480840683, -0.00912866834551096, -0.015271147713065147, -0.005966079421341419, -0.019353533163666725, 0.010306764394044876, 0.020588329061865807, 0.00669687706977129, 0.007270175032317638, 0.015220748260617256, 0.02724110707640648, 0.03487668186426163, 0.006539377383887768, -0.016241343691945076, 0.014225351624190807, 0.0271151065826416, 0.021659325808286667, 0.01897553540766239, 0.024002917110919952, 0.015308947302401066, 0.038455069065093994, -0.003420888213440776, 0.040773458778858185, 0.0025058165192604065, -0.010659563355147839, -0.020550530403852463, 0.0047375839203596115, -0.014036351814866066, 0.01251175720244646, -0.002318392042070627, -0.00028940525953657925, 0.03243228793144226, -0.00382093689404428, 0.00047092337626963854, 0.0148301487788558, 0.018269937485456467, 0.010502063669264317, 0.011806159280240536, -0.006785076577216387, 0.022163324058055878, 0.0073142750188708305, -0.004558034241199493, 0.023650119081139565, -0.003972136415541172, 0.00318463915027678, 0.013003155589103699, -0.027871103957295418, 0.018521936610341072, 0.030088696628808975, 0.015863345935940742, -4.279555651010014e-05, -0.007566274143755436, -0.005080932751297951, 0.04593944177031517, 0.021117527037858963, -0.009179068729281425, 0.0051502324640750885, 0.023095721378922462, 0.03097069449722767, -0.02960989810526371, -0.0237257182598114, 0.00733317481353879, -0.0019419683376327157, -0.010294164530932903, -0.03235669061541557, -0.02588031068444252, -0.03328908607363701, -0.029131099581718445, -0.0071567753329873085, 0.017161140218377113, 0.02378871850669384, 0.0031877891160547733, -0.02582991123199463, -0.012133758515119553, -0.003468138165771961, -0.01660674251616001, -0.002118367701768875, 0.022390123456716537, 0.04626704007387161, 0.038984265178442, 0.0073709748685359955, -0.02751830592751503, 0.007503274362534285, -0.00689217634499073, -0.007478074170649052, 0.0327850878238678, 0.0019703181460499763, -0.017816338688135147, -0.021067127585411072, -0.014527750201523304, -0.014137151651084423, -0.0006725226994603872, 0.0015742070972919464, 0.02628351002931595, 0.02453211508691311, -0.02187352441251278]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
"i=1αiϕ(wi).
45
More generally, let pbe a probability measure on Ω, then ϕ(Ew∼pw)≤Ew∼pϕ(w). In particular, since ∥ · ∥
is convex (by triangle inequality of the norm), we know that
∥Ez∥ ≤E∥z∥.
Proof. See Proposition A.9 of Zhang (2023) for a proof.
Lemma 7 (Cauchy Schwarz Inequality) .Foru, ν∈Rd, we have
⟨u, ν⟩ ≤ ∥ u∥∥ν∥ ≤1
2∥u∥2+1
2∥ν∥2.
In particular, for a positive-definite matrix Σ, we can take ⟨u, ν⟩=
Σ1/2u,Σ−1/2ν
to get⟨u, ν⟩ ≤ ∥ u∥Σ∥ν∥Σ−1.
Lemma 8 (In-sample error of MLE (Faury et al., 2020; Pacchiano et al., 2021; Zhu et al., 2023a)) .For a
fixed λ >0, we denote ΣDas
ΣD:=λI+X
(x,a1,a2)∈D 
ϕ(x, a1)−ϕ(x, a2) 
ϕ(x, a1)−ϕ(x, a2)⊤.
Assume that ∥ϕ(x, a)∥ ≤1for all (x, a)∈ X ×A and∥θ∥ ≤B. Then, it follows that with probability at least
1−δ, we have
∥θMLE−θ∗∥ΣD≤C·s
d+ log(1 /δ)
γ2+λB2,
where γ= 1/(2 + exp( −B) + exp( B)).
Lemma 9 (Elliptical Potential Lemma (Dani et al., 2008; Rusmevichientong and Tsitsiklis, 2010; Ab-
basi-Yadkori et al., 2011)) .Let{xi}i∈[T]be a sequence of vectors in Rdwith∥xi∥2≤L <∞for all t∈[T].
LetΛ0be a positive-definite matrix and Λt= Λ 0+Pt
i=1xix⊤
i. It holds that
logdet(Λ t)
Λ0
≤TX
i=1∥xi∥2
Λ−1
i−1.
Further, if ∥xi∥2≤Lfor all i∈[T], then we have
TX
i=1min{1,∥xi∥2
Λ−1
i−1} ≤2 logdet(Λ t)
Λ0
≤2dlogtrace(Λ 0) +nL2
ddet(Λ 0)1/d
.
Finally, if λmin(Λ0)≥max(1 , L2),
TX
i=1∥xi∥2
Λ−1
i−1≤2 logdet(Λ t)
Λ0
.
Lemma 10 (Concentration of Inverse Covariance (Zanette et al., 2021a)) .Letµibe the conditional distri-
bution of ϕgiven the sampled {ϕ1, . . . , ϕ i−1}. Assume ∥ϕ∥2≤1, for any realization of the vector. Define
Λ =Pn
i=1Eϕ∼µi[ϕϕ⊤]. Ifλ= Ω(dlog(n/δ)), then, with probability at least 1−δ, for any n≥1
3(Λ + λI)−1⪰nX
i=1ϕiϕ⊤
i+λI−1
⪰3
5(Λ + λI)−1.
Lemma 11 (Solution of KL-regularized Optimization (Proposition 7.16 and Theorem 15.3 of Zhang (2023))) .
Given a loss functional with respect to π(·|x), written as
Ea∼π(·|x)h
−r(x","[-0.01344552543014288, -0.010000270791351795, 0.011916452087461948, 0.04400119185447693, 0.014322969131171703, 0.013910054229199886, -0.005787253845483065, 0.04111079126596451, -0.02129090018570423, 0.05019490793347359, 0.007955054752528667, 0.010929328389465809, -0.04779484495520592, 0.03287830948829651, 0.030787931755185127, 0.018619859591126442, 0.022387703880667686, 0.0035710646770894527, -0.016710130497813225, 0.006477594841271639, -0.03200086951255798, -0.010419636964797974, 0.014555233530700207, 0.008967985399067402, -0.00045162515016272664, -0.023303857073187828, 0.04423345625400543, 0.008458293974399567, 0.06224684789776802, 0.004190436098724604, 0.03620743378996849, -0.029652416706085205, -0.012980997562408447, -0.06549855321645737, -0.026232969015836716, 0.07138258218765259, 0.02471034787595272, 0.04542058706283569, -0.016297215595841408, 0.012561631388962269, 0.007903439924120903, -0.009361544623970985, -0.08671202510595322, -0.00253393966704607, 0.008329258300364017, -0.0028274960350245237, 0.0028758845292031765, -0.00415817741304636, 0.023755483329296112, 0.004700127523392439, -0.03902041167020798, 0.02187156118452549, 0.004771097097545862, -0.003432351164519787, 0.002443614648655057, 0.01668432354927063, 0.04338182136416435, 0.04134305566549301, 0.03486546128988266, -0.010600287467241287, 0.0458851158618927, -0.007490525487810373, 0.04397538676857948, -0.02320062927901745, -0.03476223349571228, -0.026323294267058372, -0.013858440332114697, 0.0406462624669075, 0.026181355118751526, 0.03672357648611069, -0.010858358815312386, 0.01088416576385498, 0.050246525555849075, 0.023123208433389664, -0.014774594455957413, 0.027303965762257576, -0.01758757419884205, 0.024555504322052002, 0.006619534455239773, -0.02503293752670288, 0.023665158078074455, -0.003009759122505784, 0.02952338196337223, -0.03140730410814285, 0.01523912325501442, -0.10069950670003891, -0.017574669793248177, 0.021742524579167366, -0.046710945665836334, 0.011935807764530182, -0.01935536414384842, -0.006832443177700043, 0.028542708605527878, -0.01441329438239336, 0.033884789794683456, 0.03961397707462311, 0.05739510431885719, -0.00020514668722171336, -0.01588430255651474, -0.008148607797920704, 0.010568028315901756, -0.030891159549355507, 0.028697552159428596, -0.03656873479485512, 0.039381712675094604, -0.02363935112953186, -0.022168343886733055, -0.0070453523658216, -0.018903737887740135, -0.00269523449242115, -0.0025952316354960203, -0.019123099744319916, -0.02363935112953186, 0.059975821524858475, 0.008497004397213459, -0.07365360856056213, -0.04407861456274986, 0.00930347852408886, -0.03460739180445671, -0.0025968446861952543, -0.029265310615301132, -0.008858304470777512, 0.04678836464881897, -0.013432621955871582, 0.012845509685575962, -0.025923283770680428, -0.002692008391022682, -0.05331757664680481, -0.02603941597044468, -0.024852287024259567, 0.016219794750213623, 0.016748841851949692, 0.013819729909300804, -0.0240651685744524, -0.0446205660700798, 0.013368104584515095, 0.06859540939331055, 0.02443937212228775, 0.030091138556599617, 0.01403909083455801, 0.03207828849554062, 0.025961995124816895, -0.03940752148628235, 0.011503538116812706, -0.06265976279973984, 0.01652947999536991, -0.03551064059138298, 0.013922958634793758, 0.024852287024259567, 0.002174252411350608, -0.0039839791133999825, -0.02166510373353958, -0.02872335910797119, 0.028103988617658615, -0.01267776358872652, -0.039820436388254166, -0.04173016548156738, 0.06209200620651245, 0.02887820266187191, -0.010890617966651917, 0.010600287467241287, 0.08093122392892838, -0.0007669563055969775, -0.006980834528803825, 0.04015592858195305, 0.0024565181229263544, -0.021729622036218643, -0.0012935834238305688, -0.03447835519909859, -0.05122719705104828, -0.034942883998155594, 0.009090568870306015, -0.03672357648611069, -0.025110358372330666, 0.040181733667850494, -0.007374393288046122, 0.02316191792488098, -0.0381687767803669, 0.006067906506359577, -0.013129387982189655, -0.0016968202544376254, 0.047665808349847794, 0.04129144176840782, 0.03757521137595177, -0.019768277183175087, 0.025626501068472862, 0.02353612147271633, 0.012419691309332848, -0.006122746504843235, -0.011084171943366528, -0.0003606952668633312, 0.04459475725889206, 0.03631066158413887, -0.0117874164134264, 0.004932391922920942, -0.015948818996548653, 0.03749779239296913, 0.06663406640291214, -0.012290655635297298, -0.003809780813753605, 0.00548079377040267, 0.028258830308914185, 0.02054249309003353, -0.02385871112346649, 0.005571119021624327, 0.01326487585902214, 0.00885185319930315, 0.03102019615471363, -0.06095649302005768, -0.012219686061143875, -0.030400823801755905, -0.015510098077356815, 0.05148526653647423, 0.004164629150182009, 0.010058336891233921, 0.061575863510370255, -0.0511239655315876, 0.029807260259985924, 0.008148607797920704, 0.06678890436887741, -0.011387405917048454, 0.04090433567762375, 0.03347187489271164, 0.01401328295469284, -0.033394452184438705, -0.017406923696398735, 0.045962534844875336, -0.03757521137595177, 0.016813358291983604, -0.018490824848413467, 0.06291783601045609, 0.014206836931407452, -0.024413565173745155, -0.014606847427785397, 0.02374257892370224, -0.03311057388782501, -0.013987476006150246, -0.00470335315912962, -0.025923283770680428, -0.029394345358014107, -0.01872308924794197, 0.007232454139739275, -0.0077292416244745255, -0.014193933457136154, -0.021136056631803513, 0.023974843323230743, -0.00943896546959877, 0.017342405393719673, 0.0014492328045889735, -0.029704030603170395, -0.021329611539840698, -0.002729106228798628, -0.00741955591365695, -0.01029705349355936, -0.04712385684251785, 0.011458375491201878, -0.01967795379459858, -0.009419610723853111, -0.0376526340842247, 0.01690368354320526, -0.01289067231118679, -0.019858602434396744, -0.015755265951156616, 0.03406544029712677, 0.007290520239621401, -0.050659436732530594, -0.0018129523377865553, 0.01285841315984726, 0.029704030603170395, -0.016439154744148254, 0.039381712675094604, 0.014348776079714298, -0.02727815881371498, 0.031742796301841736, -0.041368864476680756, -0.020413456484675407, 0.022323185577988625, 0.02641361951828003, -0.0441560372710228, -0.007058255840092897, -0.026684595271945, -0.030452439561486244, 0.042917292565107346, 0.020439263433218002, 0.06327913701534271, -0.039872050285339355, -0.03481384739279747, -0.015187508426606655, -0.06338236480951309, -0.033291224390268326, 0.0008822819800116122, -0.033342838287353516, 0.017045622691512108, 0.008509907871484756, 0.02241351082921028, 0.012813250534236431, 0.023923229426145554, -0.029291117563843727, -0.00799376517534256, 0.024632925167679787, 0.06807926297187805, 0.011929355561733246, -0.022116728127002716, 0.010490607470273972, -0.030452439561486244, 0.03620743378996849, 0.055691834539175034, 0.0015548808733001351, -0.0428914874792099, 0.002950079971924424, 0.011677736416459084, 0.004806581884622574, -0.028671745210886, 0.017742415890097618, -0.043614085763692856, -0.023407086730003357, 0.023600639775395393, 0.007051804102957249, -0.004425926599651575, -0.03509772568941116, 0.001592785120010376, -0.027794301509857178, -0.011329339817166328, -0.09842847287654877, -0.0041710808873176575, 0.03156214579939842, -0.026168450713157654, -0.019819892942905426, -0.014348776079714298, -0.05267239734530449, -0.007374393288046122, -0.0021548971999436617, 0.005096912384033203, -0.00453238096088171, -0.0038323618937283754, -0.03176860511302948, -0.02823302336037159, 0.06565339118242264, 0.013110033236443996, 0.0003566629020497203, -0.06792442500591278, 0.010503510944545269, -0.03731714189052582, 0.02486518956720829, 0.04144628345966339, -0.03354929760098457, 0.04947230964899063, 0.0140907047316432, 0.09894461929798126, 0.0543498620390892, -0.04405280575156212, -0.004961424972862005, 0.010077692568302155, 0.03231055289506912, -0.0030855676159262657, -0.009690585546195507, 0.005719509907066822, -0.07045352458953857, -0.05631120502948761, -0.019910218194127083, 0.0033097672276198864, -0.023974843323230743, 0.04720127955079079, 0.01088416576385498, -0.00802602432668209, 0.03620743378996849, -0.0028758845292031765, -0.023290954530239105, -0.005667895544320345, 0.007096966728568077, -0.0027565264608711004, 0.05251755192875862, -0.032387975603342056, -0.03135569021105766, -0.029755646362900734, 0.0021097345743328333, -0.010722871869802475, 0.01785854808986187, 0.06854379177093506, -0.009413158521056175, 0.020942503586411476, -0.004929165821522474, -0.0026097481604665518, 0.0031226652208715677, 0.002919434104114771, -0.019174713641405106, -0.021419934928417206, -0.026994280517101288, -0.026271680369973183, 0.007587302476167679, 0.023084497079253197, 0.005809835158288479, -0.0035291279200464487, -0.0012589051621034741, -0.0030420180410146713, -0.014193933457136154, 0.017935970798134804, 0.05971774831414223, 0.013090677559375763, 0.04240114986896515, -0.07416975498199463, -0.04338182136416435, -0.04111079126596451, -0.024258721619844437, -0.031587954610586166, -0.003137181745842099, 0.007148581091314554, 0.03881395608186722, 0.012264848686754704, 0.03584613278508186, 0.029110467061400414, -0.0019226328004151583, 0.012897123582661152, -0.04203984886407852, -0.023381279781460762, 0.0034904172644019127, 0.04578188806772232, 0.008755075745284557, 0.03460739180445671, 0.02502003312110901, 0.035794518887996674, -0.0092260567471385, -0.012413240037858486, 0.021458646282553673, -0.03277508169412613, 0.010968039743602276, 0.05127881094813347, -0.006955027114599943, 0.008161511272192001, -0.047459352761507034, 2.661362486833241e-05, 0.03963978588581085, 0.024981321766972542, 0.0004387215885799378, -0.05373048782348633, -0.011290628463029861, 0.022219957783818245, -0.027897531166672707, -0.007380845490843058, -0.028000758960843086, -0.01935536414384842, 0.0027645910158753395, -0.07876342535018921, -0.0065163057297468185, 0.023032883182168007, 0.01860695704817772, 0.010871262289583683, -0.02748461626470089, 0.0039839791133999825, 0.003322670701891184, -0.020826371386647224, 0.0003348881145939231, 0.06818249076604843, -0.03202667459845543, 0.011077719740569592, -0.029213694855570793, 0.04170435667037964, -0.03587194159626961, -0.008103445172309875, -0.004896907135844231, 0.010490607470273972, 0.00021835269581060857, -0.007290520239621401, -0.03610420599579811, -0.029704030603170395, 0.03161375969648361, 0.012690667062997818, 0.0027774947229772806, -0.016245601698756218, 0.01802629604935646, -0.001890373881906271, -0.05295627564191818, 0.051898181438446045, -0.003432351164519787, -0.01416812650859356, -0.004583995323628187, 0.025368429720401764, -0.03102019615471363, 0.023007076233625412, 0.004513025749474764, 0.02797495201230049, -0.03321380540728569, -0.03514933958649635, 0.012935834936797619, 0.0007834889693185687, 0.07189872115850449, 0.07922795414924622, -0.010406733490526676, -0.016916587948799133, -0.006606630980968475, -0.014568137004971504, -0.03171698749065399, 0.03607839718461037, -0.013935862109065056, -0.006409851368516684, 0.0015161701012402773, -0.00860668532550335, 0.00031049229437485337, 0.012561631388962269, 0.008096993900835514, 0.05336919054389, -0.017626283690333366, -0.013122936710715294, 0.04260760545730591, -0.011090623214840889, 0.007471170276403427, 0.01307132188230753, -0.04480121657252312, -0.02091669663786888, 0.06348559260368347, -0.021161863580346107, 0.002535552717745304, -0.020710239186882973, 0.04299471527338028, -0.02545875497162342, 0.02316191792488098, -0.00019819085719063878, 0.00876798015087843, -0.03894299268722534, 0.012084199115633965, 0.0042388248257339, -0.024955514818429947, -0.03566548228263855, -0.006877605803310871, -0.007155032828450203, 0.003493643132969737, -0.032646045088768005, -0.08149898052215576, -0.011690639890730381, -0.0508917011320591, 0.024155493825674057, -0.006684052292257547, 0.00754213985055685, 0.022852232679724693, 0.02058120258152485, -0.006225975230336189, -0.021007021889090538, -0.019394073635339737, 0.021484453231096268, 0.007890536449849606, 0.010116402991116047, 0.0013589077861979604, -0.015187508426606655, 0.00205973326228559, 0.01571655459702015, -0.057085417211055756, 0.03352348878979683, 0.004080755636096001, -0.010826099663972855, 0.0019726341124624014, 0.0017355309100821614, -0.00201940955594182, -0.03380736708641052, 0.0092260567471385, -0.025807151570916176, 0.03641388937830925, 0.006416303105652332, 0.028491094708442688, -0.03280089050531387, 0.02246512472629547, -0.02673620916903019, 0.008813141845166683, 0.007709886413067579, 0.0038678469136357307, -0.040413998067379, 0.02449098601937294, 0.01285841315984726, -0.014555233530700207, -0.0028758845292031765, 0.040181733667850494, -0.040568843483924866, 0.011922904290258884, 0.007845373824238777, 0.016387540847063065, 0.009851880371570587, -0.03427189588546753, 0.056878961622714996, -0.008567973971366882, -0.01807790994644165, -0.016271408647298813, -0.03736875578761101, 0.006203393917530775, -0.032646045088768005, -0.014064897783100605, -0.02027151733636856, 0.015097183175384998, -0.006664697080850601, 0.017884355038404465, -0.0398978553712368, 0.00577434990555048, 0.06529209017753601, -0.047510966658592224, -0.06900832056999207, -0.02503293752670288, -0.0026774918660521507, 0.018903737887740135, 0.0050291684456169605, 0.018852123990654945, 0.008967985399067402, -0.02652975171804428, 0.040568843483924866, 0.005690476857125759, 0.008219577372074127, -0.055691834539175034, -0.03811716288328171, 0.030400823801755905, -0.03027178905904293, 0.03285250440239906, 0.009251863695681095, -0.01050996221601963, -0.02074895054101944, -0.032491203397512436, 0.002462970092892647, 0.02647813782095909, 0.001425038673914969, -0.037884898483753204, 0.03700745478272438, -0.0233167614787817, 0.08965404331684113, -0.01636173389852047, -0.013039063662290573, -0.012039036490023136, 0.028620131313800812, 0.006522757466882467, -0.005409824196249247, 0.022761907428503036, -0.01685206964612007, -0.03434931859374046, 0.03491707518696785, -0.032646045088768005, -0.019368266686797142, -0.012722925283014774, 0.019394073635339737, -0.005493697244673967, 0.014684269204735756, -0.024723250418901443, -0.013561657629907131, 0.004458185285329819, 0.0066517931409180164, -0.0281814094632864, 0.03625904768705368, 0.03597516939043999, 0.002843625610694289, -0.03138149529695511, 0.015226219780743122, -0.0003383156144991517, -0.016761744394898415, 0.011529345065355301, -0.06353721022605896, -0.020684432238340378, -0.014219740405678749, -0.0002558537235017866, 0.011890645138919353, 0.004348504822701216, 0.02738138847053051, -0.03354929760098457, 0.007851826027035713, 0.0022532870061695576, -0.034246090799570084, -0.04856905713677406, -0.0001684521557763219, 0.026245873421430588, 0.005271110683679581, -0.019006967544555664, 0.01625850610435009, 0.017148852348327637, 0.010948684066534042, 0.01918761618435383, -0.0016952072037383914, -0.008284095674753189, 0.028310444205999374, 0.04327859356999397, 0.024878093972802162, 0.003093632170930505, -0.004719482734799385, -0.01726498454809189, -0.028310444205999374, -0.0034226735588163137, -0.048414215445518494, -0.003035566071048379, -0.04317536577582359, 0.028491094708442688, -0.0235748328268528, 0.01008414477109909, -0.029316924512386322, -0.012710021808743477, 0.03824619948863983, -0.01572945900261402, -0.019755374640226364, -0.0013169711455702782, -0.014529426582157612, -0.013690694235265255, 0.04020754247903824, -0.04304632917046547, -0.011464826762676239, 0.018529534339904785, -0.00876798015087843, 0.009916397742927074, -0.004145273473113775, -0.039381712675094604, -5.831811358802952e-05, 0.04423345625400543, -0.025949090719223022, -0.026452330872416496, -0.043614085763692856, -0.01614237390458584, -0.01641334779560566, 0.024349046871066093, 0.07091805338859558, -0.03672357648611069, -0.0012500338489189744, -0.0031613761093467474, -0.039175257086753845, -0.007774404250085354, 0.004890455398708582, -0.01496814750134945, 0.02903304621577263, -0.0025774892419576645, -0.010058336891233921, 0.004519477486610413, 0.005232399795204401, -0.024090975522994995, -0.06709859520196915, 0.0006697762291878462, 0.010877714492380619, -0.009916397742927074, -0.05971774831414223, 0.02299417182803154, 0.01792306639254093, -0.00257426337338984, 0.006780828814953566, 0.015045569278299809, 0.002985564759001136, -0.01157450769096613, 0.01083255186676979, 0.025252297520637512, 0.03285250440239906, 0.02787172421813011, -0.011916452087461948, -0.015174604952335358, -0.010155114345252514, -0.01578107289969921, -0.029549188911914825, -0.007232454139739275, 0.0299362950026989, 0.008348613046109676, 0.03620743378996849, 0.013781018555164337, 0.0020694108679890633, 0.033497683703899384, -0.027045894414186478, 0.010464799590408802, -0.036904226988554, 0.014864918775856495, 0.014297162182629108, -0.029213694855570793, -0.021432839334011078, -0.004209791775792837, 0.00044557658839039505, -0.025278104469180107, -0.0034452546387910843, 0.01717465929687023, -0.01903277449309826, 0.017561767250299454, -0.010438992641866207, -0.030039524659514427, -0.023510314524173737, -0.03212990239262581, 0.032749276608228683, -0.04255599156022072, 0.008032475598156452, 0.025897476822137833, -0.01940697804093361, 0.03231055289506912, 0.037188105285167694, 0.01600043475627899, -0.014529426582157612, -0.01833598129451275, -0.0031533113215118647, -0.0034678359515964985, -0.007374393288046122, -0.0031033100094646215, 0.028491094708442688, -0.03437512740492821, -0.032542817294597626, -0.011193851940333843, 0.0039839791133999825, -0.027949145063757896, 0.000890346709638834, -0.03775586187839508, -0.014645558781921864, -0.007658272050321102, -0.004300116561353207, -4.077731500728987e-05, -0.0036484859883785248, 0.03822039067745209, -0.0458851158618927, -0.09631229192018509, 0.0015589132672175765, -0.0017968228785321116, 0.007471170276403427, -0.004474314860999584, 0.0008459906675852835, 0.027355579659342766, -0.004058174788951874, -0.01576817035675049, -0.005713058169931173, 0.01909729279577732, -0.021355418488383293, -0.012129360809922218, 0.011342243291437626, -0.0017145626479759812, -0.025058744475245476, 0.00544208288192749, 0.021381225436925888, 0.017510151490569115, 0.027123315259814262, 0.002304901136085391, 0.01743273064494133, 0.033936403691768646, 0.04949811473488808, -0.020619913935661316, -0.013664886355400085, 0.02738138847053051, -0.003680744906887412, 0.036981649696826935, 0.025871669873595238, 0.0030791156459599733, 0.0015919787110760808, 0.04038819298148155, 0.011832579039037228, -0.030400823801755905, -0.00874217227101326, 0.007271165028214455, 0.00031875865533947945, 0.0013484236551448703, 0.02838786691427231, -0.0001257090480066836, -0.04487863555550575, 0.004900132771581411, -0.024529697373509407, 0.017252080142498016, -0.044956058263778687, 0.017768222838640213, -0.048956166952848434, 0.01600043475627899, -0.02064572088420391, 0.0013347136555239558, 0.0017661768943071365, 0.015393965877592564, -0.02144574373960495, -0.002425872255116701, -0.018581148236989975, -0.012239041738212109, 0.02593618631362915, -0.019445689395070076, 0.02454260177910328, -0.03791070729494095, -0.014439101330935955, 0.01018737256526947, -0.03231055289506912, -0.04480121657252312, -0.016245601698756218, -0.02727815881371498, 0.0018871478969231248, -0.01683916710317135, -0.03027178905904293, -0.0007895375601947308, 0.0034291252959519625, -0.01753596030175686, 0.005932419095188379, -0.011806772090494633, -0.009245412424206734, -0.025845862925052643, 0.013251972384750843, -0.03757521137595177, 0.012045487761497498, 0.016568191349506378, -0.023703869432210922, 0.007367941550910473, 0.017742415890097618, -0.01157450769096613, 0.013548754155635834, 0.01680045574903488, -0.021639296784996986, -0.007180839776992798, 0.0020468297880142927, 0.01865857094526291, 0.012471306137740612, 0.019123099744319916, -0.010309956967830658, 0.01748434454202652, 0.0001741982705425471, -0.006167909130454063, -0.001255679177120328, 0.016929490491747856, 0.016245601698756218, 0.015845591202378273, 0.020684432238340378, -0.022065114229917526, -0.013742308132350445, -0.0038613949436694384, -0.0052485293708741665, 0.001661335350945592, -0.0007306649931706488, 0.04322697967290878, -0.02508455142378807, 0.03096858225762844, 0.006903413217514753, -0.06854379177093506, 0.007284068502485752, 0.0011709994869306684, -0.0215618759393692, 0.0331621877849102, -0.006335655692964792, 0.004942069295793772, -0.0299362950026989, 0.011555152013897896, 0.008193770423531532, 0.021523164585232735, 0.0035097727086395025, 0.017794031649827957, -0.0194585919380188, -0.006942123640328646, 0.04015592858195305, -0.02722654491662979, 0.017781127244234085, 0.015819784253835678, 0.005416275933384895, 0.037730056792497635, 0.020516686141490936, -0.009419610723853111, -0.004396893549710512, 0.021381225436925888, 0.009929301217198372, -0.0006427593762055039, 0.03145891800522804, -0.0003784376895055175, 0.003974301274865866, 0.011858385987579823, 0.0021629619877785444, 0.0036291307769715786, 0.008955081924796104, -0.022065114229917526, -0.006851798854768276, -0.0012460015714168549, 0.012626148760318756, 0.0274330023676157, -0.019226327538490295, -0.043072134256362915, -0.0042775352485477924, -0.006619534455239773, -0.012574534863233566, 0.024078072980046272, -0.02149735763669014, -0.012316462583839893, 0.04010431468486786, 0.022800618782639503, 0.03251701220870018, 0.0019419881282374263, 0.010322860442101955, 0.00901314802467823, -0.009703489020466805, -0.061369407922029495, -0.022116728127002716, 0.0007250196649692953, 0.020877985283732414, -0.0060162921436131, -0.06069841980934143, -0.009322833269834518, 0.032594431191682816, 0.012703570537269115, 0.007122773677110672, 0.014245547354221344, -0.0015355255454778671, -0.03481384739279747, -0.02074895054101944, 0.05176914483308792, 0.0010040594497695565, -0.04085272178053856, 0.0031129876151680946, 0.04668513685464859, 0.0099744638428092, 0.020723141729831696, -0.01438748650252819, 0.043459244072437286, 0.021007021889090538, 0.016232699155807495, 0.007806663401424885, 0.019123099744319916, 0.014310065656900406, 0.03285250440239906, 0.009632519446313381, -0.00026593462098389864, 0.06049196422100067, -0.0008371194708161056, -0.022478029131889343, -0.01141966413706541, 0.036233238875865936, -0.004387215711176395, -0.025161972269415855, -0.03736875578761101, 0.02652975171804428, 0.008174415677785873, -0.01331648975610733, 0.005848545581102371, -0.007929246872663498, 0.026336198672652245, 0.010368023067712784, 0.005235625896602869, -0.0023710320238023996, 0.0006407431792467833, -0.05770479142665863, -0.0011040621902793646, 0.021781235933303833, -0.030916966497898102, -0.012284204363822937, -0.007503429427742958, -0.006825991440564394, 0.01818113774061203, 0.018206944689154625, -0.029962101951241493, -0.013910054229199886, 0.027613652870059013, -0.019419880583882332, 0.0022403832990676165, -0.0017161755822598934, -0.010303504765033722, 0.033084768801927567, -0.028155602514743805, -0.016323022544384003, 0.011484182439744473, -0.025574887171387672, -0.01641334779560566, -0.010271246545016766, 0.014864918775856495, -0.015316544100642204, 0.025536175817251205, 0.01511008758097887, -0.011109978891909122, 0.02320062927901745, 0.0018952126847580075, -0.00626791175454855, 0.02908466011285782, 0.06095649302005768, -0.019381171092391014, -0.03850426897406578, -0.02508455142378807, 0.029652416706085205, 0.005403372459113598, -0.0027178155723959208, -0.0050582014955580235, 0.03674938529729843, 0.0133422976359725, 0.04247857257723808, 0.03674938529729843, -0.008096993900835514, -0.017497248947620392, 0.007096966728568077, -0.00890346709638834, -0.014426197856664658, 0.0036162270698696375, -0.019174713641405106, -0.000806070223916322, 0.01548429112881422, 0.009638970717787743, -0.0040614004246890545, -0.015019762329757214, 0.005190463270992041, -0.03651712089776993, -0.0003036372654605657, 0.005900159943848848, 0.01174225378781557, 0.023007076233625412, 0.031097617000341415, 0.007884085178375244, 0.018697280436754227, -0.019819892942905426, -0.03700745478272438, -0.02015538513660431, -0.011626121588051319, 0.007845373824238777, -0.004229146987199783, 0.03063308820128441, -0.008664751425385475, 0.023355472832918167, 0.023342568427324295, 0.01018737256526947, 0.05218205973505974, -0.016994008794426918, 0.02802656590938568, 0.019071483984589577, -0.020516686141490936, -0.03411705419421196, 0.015871398150920868, 0.0013572948519140482, -0.002911369316279888, 0.007922795601189137, 0.0009185732924379408, -0.007548591587692499, -0.03491707518696785, 0.008058283478021622, 0.0005104977171868086, -0.004635609686374664, 0.027665266767144203, -0.05656927451491356, -0.03822039067745209, -0.0035226761829108, -0.008684106171131134, -0.008574426174163818, 0.02037474513053894, 0.013200357556343079, -0.011768060736358166, -0.012884220108389854, 0.002672653179615736, 0.04637544974684715, 0.020361842587590218, -0.00829054694622755, 0.007787307724356651, 0.005277562420815229, -0.03210409730672836, -0.010677709244191647, 0.009019599296152592, 0.0018774702912196517, -0.0070324488915503025, 0.003690422745421529, 0.022594161331653595, -0.014761690981686115, 0.01717465929687023, 0.009484128095209599, -0.03202667459845543, -0.01063899789005518, 0.013935862109065056, -0.027820108458399773, -0.0001249025808647275, -0.014852015301585197, -0.0009467998752370477, 0.002008118899539113, 0.024529697373509407, 0.01758757419884205, -0.013155195862054825, -0.034891270101070404, 0.02913627400994301, 0.010245438665151596, 0.024826480075716972, -0.0331621877849102, -0.009755102917551994, 0.07788598537445068, -0.009542194195091724, -0.013251972384750843, 0.0243232399225235, 0.03107181005179882, 0.03855588287115097, -0.009361544623970985, -0.026336198672652245, -0.025794247165322304, 0.004561414010822773, -0.039381712675094604, 0.028568517416715622, -0.0050291684456169605, -0.020942503586411476, 0.004887229297310114, -0.006974382791668177, -0.029058853164315224, 0.00012238234921824187, 0.009574453346431255, 0.014955244027078152, 0.001771015813574195, -0.0488787442445755, -0.004880777560174465, 0.006296944804489613, -0.0032984765712171793, -0.008458293974399567, -0.019419880583882332, 0.021858656778931618, -0.04299471527338028, 0.003809780813753605, -0.012787443585693836, 0.00983897689729929, -0.04031077027320862, 0.0022532870061695576, 0.006084036082029343, 0.006480820942670107, -0.023071592673659325, 0.015148798003792763, -0.00930347852408886, -0.008922822773456573, -0.018258560448884964, -0.01144547201693058, -0.022710293531417847, 0.01903277449309826, -0.015006858855485916, -0.015897205099463463, -0.02476196177303791, 0.02540714107453823, 0.0011548700276762247, -0.001544396742247045, -0.0036097753327339888, -0.0022790939547121525, 0.040233347564935684, -0.021755428984761238, -0.025587789714336395, 0.019394073635339737, -0.008645395748317242, 0.011542248539626598, -0.012187426909804344, 0.010503510944545269, -0.02042636089026928, 0.03437512740492821, -0.04033657908439636, 0.007522784639149904, 0.03037501685321331, -0.0127809913828969, 0.0031920219771564007, 0.024194205179810524, -0.00874217227101326, 0.02401355467736721, -0.01446490827947855, 0.011258370243012905, -0.02572973072528839, 0.0016452058916911483, 0.0016742389416322112, 0.012897123582661152, -0.03096858225762844, 0.01438748650252819, -0.0024903900921344757, 0.02042636089026928, -0.0324137806892395, -0.006377592217177153, -0.004222695250064135, -0.006403399631381035, 0.016348831355571747, 0.02192317508161068, 0.028413673862814903, -0.01496814750134945, -0.025755537673830986, 0.01860695704817772, -0.03256862610578537, 0.018852123990654945, 0.004709805361926556, -0.027897531166672707, 0.0030420180410146713, -0.02663297951221466, 0.017832741141319275, 0.019161809235811234, -0.015858493745326996, 0.03969139978289604, -0.01801339164376259, 0.006313074380159378, 0.03672357648611069, 0.02209092117846012, -0.01237452868372202, 0.02972983755171299, -0.04560123756527901, -0.010251890867948532, -0.0011532570933923125, -0.0018194041913375258, 0.030142752453684807, -0.02309739962220192, 0.034788038581609726, -0.01680045574903488, 0.004542058799415827, 0.010903521440923214, -0.011703543365001678, 0.018490824848413467, 0.004222695250064135, -0.02161348983645439, 0.017252080142498016, 0.008432487025856972, 0.017019815742969513, 0.011484182439744473, -0.03961397707462311, 0.020671527832746506, 0.001890373881906271, -0.01566494069993496, -0.015264930203557014, 0.04165274277329445, -0.011129333637654781, -0.0011314823059365153, -0.0010177695658057928, -0.005284014157950878, 0.011832579039037228, 0.016323022544384003, 0.01211000606417656, -0.0073292311280965805, -0.028516901656985283, -0.028594324365258217, 0.029239501804113388, -0.016606902703642845, -0.009961560368537903, -0.0045743174850940704, -0.019368266686797142, -0.018994063138961792, -0.028439480811357498, -0.006196942180395126, 0.02872335910797119, -0.00031593599123880267, -0.03277508169412613, 0.04893035814166069, -0.032491203397512436, 0.016077855601906776, 0.019329557195305824, 0.002387161599472165, 0.001682303729467094, -0.009167990647256374, 0.011329339817166328, -0.010258343070745468, 0.05656927451491356, 0.00016482302453368902, -0.006442110054194927, 0.04203984886407852, 0.02578134462237358, 0.003690422745421529, -0.008406679145991802, 0.0030516956467181444, -0.003483965527266264, -0.01251646876335144, -0.006800184492021799, 0.003225893946364522, 0.023032883182168007, -0.03311057388782501, -0.0035484833642840385, -0.0209554061293602, -0.011316436342895031, -0.01363907940685749, 0.00552273029461503, 0.03336864709854126, -0.004413023125380278, -0.014116511680185795, 0.026942666620016098, 0.009819621220231056, -0.0019645693246275187, 0.0009758329251781106, 0.005003361497074366, 0.02486518956720829, -0.006180812604725361, 0.0014984277077019215, 0.006377592217177153, 0.02160058543086052, 0.041523706167936325, -0.0049227140843868256, 0.026452330872416496, 0.0071679363027215, 0.0029242727905511856, -0.03976881876587868, 0.04418184235692024, 0.02085217833518982, 0.01376811508089304, -0.015587519854307175, 0.013277779333293438, -0.003104922827333212, -0.005509826820343733, 0.01646496169269085, 0.01269711833447218, 0.013755211606621742, -0.03112342394888401, 0.03161375969648361, 0.04764000326395035, -0.01588430255651474, 0.022065114229917526, 0.034736424684524536, -0.00308879348449409, 0.037084877490997314, 0.003767844056710601, -0.004942069295793772, -0.022607063874602318, -0.025226490572094917, 0.0006274363840930164, 0.029213694855570793, -0.004196887835860252, -0.007929246872663498, -0.02609102986752987, 0.014671365730464458, -0.00013861262414138764, 0.0031323430594056845, 0.010342216119170189, 0.05076266825199127, -0.02123928628861904, -0.028258830308914185, 0.002098443917930126, -0.027252351865172386, 0.00012218073243275285, -0.026129741221666336, 0.006180812604725361, -0.009742199443280697, -0.013871343806385994, 0.02374257892370224, -0.05084008723497391, 0.007155032828450203, 0.034246090799570084, 0.005145300645381212, 0.004745290149003267, 0.032491203397512436, 0.028800781816244125, -0.0072195506654679775, -0.05517568811774254, 0.010161565616726875, -0.024078072980046272, -0.00030121783493086696, -0.022439317777752876, -0.04242695868015289, 0.010406733490526676, 0.006093713454902172, -0.003545257495716214, -0.030194366350769997, -0.01952311024069786, -0.0003911396488547325, -0.019871506839990616, 0.001811339403502643, 0.025058744475245476, 0.0009782523848116398, -0.02059410698711872, 0.016723034903407097, 0.011264821514487267, 0.03027178905904293, -0.0436398945748806, -0.03432350978255272, -0.014232643879950047, 0.029807260259985924, 0.028516901656985283, -0.028000758960843086, 0.005987259093672037, 0.029368538409471512, 0.005848545581102371, -0.002650071866810322, 0.005125945433974266, -0.006287267431616783, 0.01843920908868313, -0.00457109184935689, -0.011077719740569592, 0.003293637651950121, -0.0007427620585076511, -0.0097292959690094, -0.01732950285077095, -0.018000487238168716, 0.004509799648076296, -0.013510043732821941, -0.003175892634317279, -0.022219957783818245, -0.014193933457136154, -0.02085217833518982, -0.009000243619084358, -0.015806879848241806, 0.02261996828019619, -0.0148391118273139, 0.03571709617972374, 0.004242050461471081, -0.004977554548531771, 0.00020030785526614636, -0.016645612195134163, 0.019213424995541573, 0.009167990647256374, 0.02802656590938568, -0.021961886435747147, 0.021536067128181458, 0.0279233381152153, 0.034839656203985214, 0.0346590057015419, -0.001672626007348299, 0.02154897153377533, 0.019071483984589577, -0.01668432354927063, 0.01689078100025654, -0.023007076233625412, -0.0006871154182590544, 0.0059517743065953255, 0.01576817035675049, 0.001345197786577046, -0.00312911719083786, -0.0074389115907251835, -0.01331648975610733, 0.05491761863231659, -0.015432676300406456, -0.01029705349355936, -0.007690531201660633, 0.014581040479242802, -0.006261460017412901, -0.008509907871484756, -0.01576817035675049, 0.024413565173745155, -0.018245656043291092, -0.004777548834681511, 0.008393775671720505, -0.014258450828492641, 0.01914890669286251, 0.0187101848423481, -0.02471034787595272, 0.0058937082067132, 0.020877985283732414, 0.014890726655721664, -0.031794410198926926, -0.025742633268237114, 0.006293719168752432, 0.02267158217728138, 0.024955514818429947, 0.015690747648477554, 0.012335818260908127, 0.03383317589759827, 0.013651982881128788, -0.035433217883110046, -0.017419828101992607, 0.005409824196249247, 0.004009786061942577, 0.002364580286666751, -0.017897259443998337, -0.0017661768943071365, 0.012084199115633965, -0.04647868126630783, 0.02010377123951912, 0.017781127244234085, 0.02722654491662979, 0.014929437078535557, -0.013148743659257889, 0.00031956512248143554, -0.010077692568302155, -0.006161457393318415, -0.001641173497773707, 0.016129469498991966, 0.02588457241654396, -0.005461438558995724, 0.032646045088768005, -0.006000162567943335, -0.0019823117181658745, -0.014026186428964138, -0.007935699075460434, 0.02362644672393799, -0.008535715751349926, -0.006767925340682268, -0.027845917269587517, 0.006013066507875919, 0.0011943872086703777, 0.0005895321373827755, 0.004442055709660053, 0.00774214556440711, 0.006619534455239773, 0.013497140258550644]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
", a)−ηlogπ0(a|x)
π(a|x)i
=ηDKL
π(a|x)π0(a|x) exp1
ηr(x, a)
,
the minimizer of the loss functional is π∗(a|x)∝π0(a|x) exp
1
ηr(x, a)
, also known as Gibbs distribution.
46
H More Experiment Details
All the experiments are conducted using 8 ×A40 (48G) with 600G RAM, and half-precision training (bf16).
The implementations are based on open-source packages TRL (von Werra et al., 2020) and LMFlow (Diao
et al., 2023), and the code will be publicly available on GitHub in the camera-ready version. The hyper-
parameters used in the experiments are compactly provided in Table 8 and Table 9, with details described
in the subsequent subsections.
5 10 15 20
N: Size of {i}N
i=1
0.20.40.6Rejection Rate
5 10 15 20
N: Size of {i}N
i=1
0.20.40.60.8Rejection Rate
5 10 15 20
N: Size of {i}N
i=1
0.40.60.81.0Rejection Rate
(a)η= 0.5 (b) η= 1.0 (c) η= 2.0
Figure 7: Illustration of the rejection rate by setting {ηi}N
i=1, where ηi=Nη/i . The model follows the
setting of Figure 1, where we choose Gaussian mixture as π0and the preference is mathematically captured
by setting ras linearly dependent on a, with r= [1,0]⊤aandη= 1 for πr.
H.1 Implementation Details
Rejection Sampling. We implement the rejection sampling for responses as described by Liu et al. (2023a).
For each prompt, we initially generate a set of Ksamples. Our objective is to extract preference pairs from
these samples. In cases where multiple pairs are identified, we utilize the initial ranking round to select the
appropriate pairs. Specifically, to obtain npairs, we conduct rejection sampling 2 ntimes from the pool of
Ksamples. Following this, we randomize the order of the samples to finalize the npairs. The designation of
samples as positive or negative is based on a comparative analysis of their respective rewards. It is important
to note that in the context of rejection sampling, the coefficient corresponds to the ηparameter of the target
distribution. Our implementation is grounded in the Python code outlined in Algorithm 1 (Liu et al.,
2023a).
Multi-step approximation. We divide the path into three steps with η∈ {0.1,0.3,0.5}and use 25K
prompts at each time. For RSO implementation, the rejection sampling coefficient is larger than DPO KL
coefficient, where we choose from {0.5,1,2,3}for better performance. Liu et al. (2023a) also suggest similar
phenomenon in RSO.
Hybrid learning. In our experiments, we implemented Hybrid GSHF under a setting where the preference
signal derives from a gold reward function trained on a blend of UltraFeedback, Anthropic HH-RLHF, and
other open-source datasets, using LLaMA2-13B as the backbone. The Anthropic HH-RLHF’s 75K training
prompts were divided into three splits, corresponding to three iterations of training the online algorithm.
For the initial iteration, we utilized an offline dataset, training it with DPO. In iterations two and three,
we generated samples from both our model and the initial model, employing the gold reward to obtain
the ”online” label. Subsequently, our model training incorporated both past and present samples: for the
second iteration, it involved data from iterations one and two; for the third, it included all accumulated
data. Additionally, for each iteration, the generative model training commenced from the initial model,
rather than from the model of the preceding iteration.
47
GPT4 Evaluation. We report the detailed GPT4 evaluation results in Table 3, where the model aligned
with DPO is taken as the baseline. The test hyper-parameter is provided in Table 8. For GPT4 evaluation,
we use the GPT-4-turbo model (gpt-4-1106-preview). We take 100 prompts for evaluation and for the","[-0.011284645646810532, -0.0013612149050459266, 0.06804428994655609, -0.011767332442104816, 0.010823898017406464, -0.018956448882818222, -0.018985703587532043, 0.0770544558763504, 0.01715734228491783, 0.03413916006684303, 0.015343607403337955, -0.03931707888841629, -0.01387360505759716, -0.006391950882971287, 0.0053424714133143425, -0.023037351667881012, 0.04162812978029251, -0.03671349212527275, -0.030891990289092064, 0.028434673324227333, -0.028829598799347878, -0.03820543736219406, -0.004848814103752375, 0.021106602624058723, 0.01746450550854206, -0.022232871502637863, 0.010560614056885242, 0.0020111973863095045, 0.011291959322988987, -0.02055077999830246, 0.015285099856555462, -0.033027518540620804, -0.024748697876930237, -0.01695256493985653, -0.006666204892098904, 0.019629286602139473, 0.03408065438270569, 0.031594082713127136, -0.03264721855521202, 0.0212089903652668, -0.015709279105067253, -0.035660356283187866, -0.05139889195561409, 0.031096767634153366, -0.03563110530376434, 0.03472423553466797, 0.011343153193593025, -0.04352962225675583, 0.022949589416384697, 0.006029935088008642, -0.06804428994655609, 0.054587554186582565, -0.015738533809781075, -0.005624039098620415, 0.03577737137675285, -0.03706453740596771, -0.003890752559527755, -0.010502106510102749, 0.033671099692583084, -0.002486571203917265, 0.00693680252879858, -0.03291050344705582, 0.03048243746161461, 0.015168084762990475, -0.021808693185448647, -0.002126384060829878, -0.05204247310757637, 0.06272010505199432, 0.03247169405221939, 0.040692009031772614, 0.015636146068572998, 0.01695256493985653, 0.016879430040717125, -0.06073084473609924, 0.006717399228364229, 0.005082844290882349, 0.0238272026181221, 0.015533756464719772, -0.013690768741071224, -0.0508723221719265, 0.011211510747671127, -0.003345901146531105, 0.005079187452793121, -0.04197917506098747, -0.009522105567157269, -0.0492633655667305, -0.022876456379890442, -0.037591107189655304, -0.04958515614271164, -0.012206139042973518, -0.03814692795276642, -0.0193952564150095, -0.006658891681581736, 0.050140976905822754, 0.02824452333152294, -0.0355725958943367, 0.01363226119428873, -0.011972108855843544, 0.009295388124883175, 0.037123046815395355, 0.010575241409242153, -0.041832905262708664, -0.0005855326890014112, 0.01369808241724968, 0.046396493911743164, 0.005159635562449694, -0.017084207385778427, 0.027864225208759308, -0.02318361960351467, -0.0040443348698318005, -0.031594082713127136, -0.013844351284205914, -0.06909742951393127, 0.010260763578116894, -0.011452854610979557, -0.0414818599820137, -0.05432426929473877, -0.02334451675415039, -0.026182131841778755, -0.011101809330284595, -0.044699776917696, -0.004113812930881977, 0.01347136590629816, -0.013288529589772224, 0.007108668331056833, 0.0023201904259622097, 0.050813816487789154, -0.07857564836740494, -0.006969713140279055, 0.00939046312123537, -0.010648375377058983, 0.014356291852891445, -0.006190831307321787, -0.03732782229781151, -0.03729856759309769, 0.027937360107898712, -0.014217336662113667, 0.01727435737848282, 0.0006330700707621872, -0.007971654646098614, -0.013624947518110275, -0.03136005252599716, -0.03800065815448761, 0.03838095813989639, -0.06465085595846176, -0.012652259320020676, -0.07290042191743851, 0.028332285583019257, -0.034519460052251816, 0.03984364867210388, -0.001322819385677576, -0.0012615692103281617, -0.028112882748246193, -0.004292991943657398, 0.003446460934355855, -0.05397322401404381, -0.027995867654681206, 0.049848441034555435, 0.005181575659662485, -0.039551109075546265, 0.02594810165464878, 0.013924798928201199, 0.010253449901938438, -0.01715734228491783, -0.004991426132619381, 0.0401361845433712, -0.02172093093395233, 0.026679446920752525, -0.09735658019781113, -0.028902733698487282, 0.027776462957262993, -0.01483166590332985, -0.029721839353442192, -0.006326129660010338, -0.0029509749729186296, -0.0054082926362752914, -0.023388396948575974, -0.013251962140202522, -0.0028741839341819286, -0.0326179638504982, -0.01973167434334755, 0.013113006949424744, -0.004826873540878296, 0.014648830518126488, -0.02299347147345543, -0.021326005458831787, -0.0026310118846595287, 0.00065181078389287, 0.014729278162121773, 0.01693793758749962, 0.06558697670698166, 0.033378563821315765, 0.06260308623313904, -0.024031979963183403, -0.01860540360212326, -0.053241878747940063, 0.08114998787641525, 0.02543616108596325, -0.024031979963183403, 0.02983885444700718, -0.008476282469928265, 0.03984364867210388, -0.013566439971327782, -0.08460193127393723, 0.029780346900224686, -0.022569291293621063, 0.015504502691328526, -0.021267497912049294, -0.05447053909301758, 0.010538673959672451, 0.04385141655802727, 0.018517643213272095, 0.07412907481193542, 0.01971704699099064, -0.0241636224091053, 0.0032416845206171274, -0.052130233496427536, 0.010882405564188957, 0.022232871502637863, 0.06037979945540428, -0.0038724690675735474, 0.001036680769175291, 0.021808693185448647, 0.026547804474830627, -0.023929592221975327, 0.029955869540572166, 0.045606642961502075, -0.03683050721883774, 0.020960332825779915, -0.057834722101688385, 0.0181227158755064, 0.02090182527899742, -0.00042669379035942256, -0.020170481875538826, 0.016718534752726555, -0.02139914035797119, 0.025011980906128883, -0.02575795352458954, -0.006446801591664553, -0.055874720215797424, -0.0011061584809795022, 0.034519460052251816, 0.02578720636665821, -0.027162134647369385, 0.04578216373920441, 0.019994957372546196, -0.016104206442832947, -0.033349309116601944, -0.009470910765230656, 0.012352408841252327, -0.004914634861052036, -0.022320633754134178, 0.008147177286446095, -0.031243037432432175, -0.042008426040410995, -0.004146723076701164, -0.012908230535686016, 0.010823898017406464, -0.03016064688563347, -0.008505536243319511, -0.027498552575707436, -0.016206594184041023, 0.012718080542981625, 0.04759589955210686, 0.007412176579236984, -0.011643004603683949, -0.03133079782128334, -0.0009443485760129988, -0.009280761703848839, -0.04844425991177559, -0.01556301023811102, -0.013749276287853718, 0.01206718385219574, 0.04338335618376732, -0.029955869540572166, -0.022891081869602203, 0.0433541014790535, 0.050989337265491486, -0.05970696359872818, -0.00873225275427103, -0.029166018590331078, -0.002290936652570963, 0.046572018414735794, 0.032091397792100906, 0.050140976905822754, -0.002007540548220277, 0.011145690456032753, -0.013134947046637535, -0.01296673808246851, -0.01715734228491783, 0.023549292236566544, -0.060438308864831924, 0.019951077178120613, -0.04964366555213928, 0.019000329077243805, -0.00631881644949317, 0.019117344170808792, 0.012045243754982948, 0.009434344246983528, 0.022145111113786697, 0.020155854523181915, -0.022291380912065506, 0.001760711893439293, -0.017859432846307755, 0.018663911148905754, 0.027600940316915512, 0.026708699762821198, 0.018532268702983856, -0.007320758420974016, 0.005605755373835564, -0.017654655501246452, 0.005722770467400551, -0.030394677072763443, 0.04145260527729988, 0.030219154432415962, 0.006055532488971949, 0.06868787109851837, 1.771224901858659e-06, 0.005854412447661161, -0.05499710515141487, -0.03495826572179794, -0.0711451917886734, -0.006388294044882059, 0.01272539421916008, 0.013222708366811275, -0.004139409866183996, -0.0042820218950510025, -0.040838275104761124, -0.00936852302402258, -0.014341665431857109, 0.005298590753227472, -0.025860341265797615, -0.0051157549023628235, 0.022466903552412987, 0.02368093468248844, -0.01989256963133812, -0.04861978068947792, 0.04154036566615105, 0.011079869233071804, 0.03601140156388283, -0.07629385590553284, 0.021326005458831787, -0.04028245434165001, 6.336414662655443e-05, 0.0033879533875733614, 0.05166217312216759, 0.007134265266358852, 0.019834062084555626, 0.07816609740257263, 0.020828690379858017, -0.00146908825263381, -0.0022525410167872906, 0.005839785560965538, 0.0192636139690876, 0.03949260339140892, -0.010882405564188957, 0.013354349881410599, -0.023900337517261505, -0.04911709576845169, 0.012754647992551327, -0.04704007878899574, 0.024880340322852135, 0.01764002814888954, -0.018649283796548843, 0.02593347616493702, 0.04262275621294975, -0.027293777093291283, -0.03390512987971306, 0.0026419819332659245, -0.021135855466127396, -0.021004213020205498, 0.02787885256111622, -0.028186015784740448, 0.007397549692541361, -0.061608459800481796, 0.00514500867575407, 0.025172878056764603, 0.019775554537773132, 0.013968680053949356, 0.018151970580220222, 0.00313746789470315, -0.00709404144436121, -0.01664539985358715, -0.03176960349082947, -0.016703907400369644, 0.015168084762990475, 0.005693516694009304, 0.009748822078108788, -0.031213782727718353, -0.0021629512775689363, -0.0006609525880776346, -0.03182811290025711, -0.013347037136554718, -0.0005809617578051984, 0.004746425896883011, 0.03279348835349083, -0.041364844888448715, 0.06032129377126694, 0.04534335806965828, 0.06722518801689148, -0.06149144470691681, -0.004132096190005541, -0.03884901851415634, 0.005247396882623434, -0.04230096563696861, 0.002757168607786298, 0.010524047538638115, 0.04124782979488373, 0.040399469435214996, 0.010158374905586243, 0.038761258125305176, -0.02511437050998211, 0.029414676129817963, -0.037444837391376495, 0.020916452631354332, -0.03130154311656952, 0.021296750754117966, 0.019161226227879524, 0.07313445210456848, 0.06137442961335182, -0.026226013898849487, -0.0238272026181221, -0.044114697724580765, -0.011928228661417961, -0.048561275005340576, 0.008768820203840733, 0.04826873540878296, -0.004687918350100517, 0.0220134686678648, -0.045138582587242126, -0.023256754502654076, 0.01305449940264225, 0.057805467396974564, -0.04423171281814575, -0.059970248490571976, -0.019526896998286247, 0.03604065626859665, 0.004271051846444607, -0.021954961121082306, 0.006263965740799904, 0.029458556324243546, -0.010560614056885242, -0.004216201137751341, -0.001613528816960752, -0.046572018414735794, -0.02384182997047901, -0.00879807397723198, -0.015738533809781075, 0.00592023367062211, -0.012952110730111599, -0.02726452238857746, -0.017903313040733337, 0.03998991474509239, -0.023095859214663506, -0.004219857510179281, -0.038088422268629074, 0.07992132753133774, 0.008191058412194252, 0.06950698047876358, -0.023549292236566544, 0.028961241245269775, 0.0022269440814852715, -0.012198826298117638, 0.005836129188537598, 0.0017022043466567993, 0.0230227243155241, -0.020477645099163055, 0.003448289353400469, -4.142380930716172e-05, 0.0072988178580999374, -0.046250224113464355, -0.06037979945540428, 0.00448679830878973, -0.022408396005630493, -0.03291050344705582, -0.002435377100482583, 0.006987996399402618, 0.0250997431576252, 0.017566895112395287, -0.03144781291484833, 0.03185736760497093, -0.006721056066453457, 0.003642095485702157, 0.013815097510814667, 0.028303030878305435, 0.10145210474729538, 0.04601619392633438, -0.01759614795446396, -0.028902733698487282, 0.004033364821225405, 0.02593347616493702, -0.01778629794716835, 0.04016543924808502, -0.0184591356664896, 0.007722997572273016, -0.007346355356276035, 0.004600157029926777, 0.0034647444263100624, -0.02156003564596176, 0.001370356767438352, 0.032032888382673264, 0.003839558456093073, -0.004110156092792749, 0.040223948657512665, 0.00680516054853797, 0.011533302254974842, -0.0009800016414374113, -0.016586892306804657, 0.017669282853603363, -0.010348524898290634, -0.020814064890146255, -0.0006307846051640809, -0.021121228113770485, 0.020506899803876877, -0.008256879635155201, 0.020477645099163055, -0.03642095625400543, -0.03446095064282417, -0.02366630733013153, 0.027864225208759308, -0.011313899420201778, -0.006801503710448742, -0.054060984402894974, 0.018195850774645805, 0.007883893325924873, -0.018473761156201363, -0.006856354419142008, -0.11596198379993439, -0.01646987721323967, -0.043003056198358536, 0.0200680922716856, 0.002576160943135619, 0.008937030099332333, 0.012111064977943897, -0.02934154123067856, -0.004907321650534868, -0.012015989981591702, -0.013844351284205914, -0.013273902237415314, -0.04092603921890259, 0.015928683802485466, 0.0090613579377532, 0.005521650891751051, -0.01263763289898634, 0.011160316877067089, -0.01696719229221344, 0.06816130876541138, -0.0019636598881334066, -0.015723906457424164, 0.030540945008397102, 0.024851085618138313, -0.03849797323346138, 0.0010202255798503757, -0.03171109780669212, -0.03469498082995415, 0.008666432462632656, 0.0037298568058758974, 0.0015943309990689158, 0.003022280987352133, -0.005430232733488083, -0.0035287372302263975, 0.008622551336884499, -0.005975084379315376, 0.0009050387889146805, -0.003062505042180419, 0.006216428242623806, 0.01976092718541622, -0.015285099856555462, 0.013420171104371548, 0.024105114862322807, -0.03296900913119316, 0.013412858359515667, 0.03428542986512184, -0.0003718429652508348, 0.023549292236566544, -0.023066604509949684, 0.013244648464024067, -0.0190588366240263, 0.021603915840387344, 0.00778150511905551, -0.02136988565325737, -0.0348997600376606, 0.0008058501989580691, 0.01058986783027649, -0.029985124245285988, 0.024075860157608986, 0.007613296154886484, 0.02869795821607113, -0.03618692606687546, 0.041657380759716034, 0.03996066376566887, -0.04259350150823593, 0.003005825914442539, 0.0031776917167007923, -0.020916452631354332, 0.01664539985358715, -0.006143293809145689, -0.004567246418446302, -0.026562431827187538, -0.004852470476180315, 0.03340781480073929, 0.03305676952004433, -0.004793962929397821, -0.0212089903652668, -0.012374348938465118, 0.03668424114584923, -0.011160316877067089, 0.004278365056961775, 0.011072555556893349, -0.014824353158473969, 0.0039090365171432495, 0.000939777644816786, -0.015109577216207981, -0.01184046734124422, -0.05101859197020531, -0.02675258181989193, -0.011101809330284595, -0.008564043790102005, 0.04209619015455246, -0.015416741371154785, -0.0072439671494066715, -0.006216428242623806, -0.00027036890969611704, -0.017391372472047806, 0.010531360283493996, 0.003327617421746254, -0.00864449143409729, -0.006969713140279055, -0.011833153665065765, 0.010465539991855621, -0.04352962225675583, -0.003938290290534496, 0.018005700781941414, 0.007708370685577393, 0.01566539891064167, -0.006263965740799904, 0.016396744176745415, -0.004779336042702198, 0.007130608893930912, -0.029809601604938507, 0.02477795071899891, 0.01715734228491783, 0.014400172978639603, -0.02316899411380291, 0.03855648264288902, 0.009770762175321579, -0.02090182527899742, -0.0034885131753981113, -0.007368295919150114, -0.046572018414735794, -0.029619451612234116, -0.014334351755678654, -0.007883893325924873, -0.019351374357938766, 0.02233526110649109, 0.006267622113227844, -0.016733162105083466, -0.016382116824388504, -0.019175851717591286, -0.024441532790660858, -0.036128416657447815, 0.0017991074128076434, -0.0040626185946166515, 0.0019124657846987247, -0.003536050673574209, 0.04818097501993179, 0.020506899803876877, 0.037444837391376495, 0.006552846636623144, -0.006596727296710014, -0.021896453574299812, 0.014546441845595837, 0.050492022186517715, -0.016250474378466606, -0.00017255159036722034, -0.02154540829360485, -0.03405139967799187, -0.06348070502281189, -0.029736466705799103, 0.006962399464100599, -0.02742541767656803, -0.008995537646114826, -0.05037500709295273, -0.011584497056901455, -0.008688372559845448, -0.0332907997071743, 0.041335590183734894, -0.03454871475696564, 0.01992182433605194, 0.005364411976188421, -0.01927824132144451, -0.01661614701151848, 0.025055862963199615, -0.006004338152706623, 0.011379720643162727, -0.0013667000457644463, -0.021633170545101166, 0.05648904666304588, -0.0041174693033099174, -0.06049681454896927, -0.05055053159594536, 0.026986612007021904, -0.012388975359499454, 0.014341665431857109, -0.03048243746161461, -0.00855673011392355, -0.014334351755678654, 0.03969737887382507, 0.05730815231800079, -0.043500371277332306, -0.013251962140202522, 0.0020569064654409885, -0.023885710164904594, 0.034490205347537994, 0.005828815512359142, 0.006059188861399889, 0.010984794236719608, -0.007722997572273016, -0.010246136225759983, -0.02676720917224884, -0.02058003470301628, -0.005163291934877634, -0.026884224265813828, 0.020111974328756332, -0.018839433789253235, -0.006516279187053442, -0.04019469395279884, -0.02432451769709587, -0.042183950543403625, -0.0006956914439797401, 0.03299826383590698, 0.022554663941264153, -0.032705724239349365, 0.0034080652985721827, -0.00800090841948986, 0.02938542142510414, -0.0204045120626688, -0.00027265437529422343, 0.00400045420974493, -0.007086728233844042, 0.02790810540318489, 0.0018064208561554551, -0.007576728705316782, 0.0339636392891407, 0.000579590501729399, -0.010582555085420609, 0.001059535308741033, 0.03753259778022766, 0.0016711221542209387, -0.015372861176729202, -0.03636244684457779, 0.01467077061533928, -0.03835170343518257, 0.010282703675329685, 0.045431118458509445, -0.009244194254279137, -7.164890848798677e-05, -0.017040327191352844, -0.02072630263864994, 0.027600940316915512, 0.009522105567157269, 0.01051673386245966, -0.000986400875262916, 0.021823318675160408, -0.003660379210487008, -0.02935616858303547, -0.01797644793987274, -0.006044561974704266, 0.013683455064892769, -0.0017067751614376903, 0.013105693273246288, -0.01940988190472126, 0.011460168287158012, 0.034343935549259186, 0.08501148223876953, -0.0238272026181221, 0.014297784306108952, -0.002199518494307995, -0.004252768121659756, 0.024748697876930237, -0.006501652300357819, -0.0002493427600711584, 0.005554561503231525, -0.04276902601122856, -0.02461705543100834, -3.728142837644555e-05, -0.003857842180877924, 0.021296750754117966, -0.007503594271838665, -0.04285678640007973, 0.003355042776092887, -0.0022269440814852715, 0.004669634625315666, 0.007598669268190861, 0.019014956429600716, 0.03408065438270569, -0.0469815693795681, -0.1295357346534729, -0.010626435279846191, 0.0003976685693487525, -0.029648706316947937, 0.008578671142458916, -0.007883893325924873, 0.05005321651697159, 0.009251507930457592, -0.02281794883310795, -0.011035988107323647, 0.025845713913440704, -0.03323229402303696, 0.02037525735795498, 0.001349330530501902, 0.0032965352293103933, -0.049526650458574295, 0.010772704146802425, -0.011270018294453621, 0.0066223242320120335, -0.017669282853603363, -0.01778629794716835, -0.00631881644949317, 0.024924220517277718, 0.014597635716199875, -0.04709858447313309, -0.0011216995771974325, 0.004640380851924419, 0.020492272451519966, -0.006081129424273968, -0.009412403218448162, -0.011270018294453621, 0.004863440990447998, 0.01714271493256092, 0.013815097510814667, -0.035835880786180496, -0.016221221536397934, -0.016513759270310402, 0.002841273322701454, 0.012674200348556042, 0.028259150683879852, 0.01232315506786108, -0.03475349023938179, 0.04554813355207443, -0.02676720917224884, 0.043646637350320816, -0.04434872791171074, 0.014882860705256462, -0.009851209819316864, 0.0036311254370957613, 0.005247396882623434, 0.028259150683879852, -0.0004015538434032351, -0.002071533352136612, -0.0139613663777709, 0.003302020253613591, 0.023929592221975327, 0.04303231090307236, -0.008256879635155201, -0.022306006401777267, 0.0015230248682200909, -0.019702419638633728, 0.026664819568395615, 0.029092883691191673, -0.029926616698503494, -0.027688702568411827, -0.010663002729415894, -0.020784810185432434, 0.015445995144546032, -0.02934154123067856, -0.02723526954650879, -0.028449300676584244, 0.02904900349676609, 0.006125010084360838, 0.0020879884250462055, -0.028668703511357307, 0.010948226787149906, 0.01810809038579464, 0.03805916756391525, -0.03896603360772133, 0.024266010150313377, 0.04235947132110596, -0.044612012803554535, 0.012008676305413246, 0.034022144973278046, -0.018049582839012146, 0.04487529769539833, 0.02022898942232132, -0.021925708279013634, -0.012696140445768833, 0.02236451394855976, -0.0010714196832850575, -0.017742417752742767, -0.0018228761618956923, -0.01727435737848282, -0.022423021495342255, -0.021267497912049294, -0.011116435751318932, 0.011986736208200455, 0.00921494048088789, 0.012535244226455688, 0.030921244993805885, 0.034811995923519135, -0.023051979020237923, 0.0038688122294843197, 0.012074497528374195, 0.0005091985804028809, 0.01727435737848282, 0.037766627967357635, 0.03217915818095207, -0.004033364821225405, -0.012359721586108208, 0.0018365888390690088, -0.03343706950545311, 0.0006796933012083173, -0.007598669268190861, 0.029590198770165443, 0.03893677890300751, 0.011694198474287987, 0.022130483761429787, 0.006874638143926859, 0.003331274027004838, 0.003552505746483803, -0.006227398291230202, 0.033378563821315765, -0.01598719134926796, 0.005236426368355751, -0.006242025177925825, 0.028127508237957954, -0.017405997961759567, 0.013566439971327782, 0.02202809602022171, 0.007847326807677746, 0.009434344246983528, 0.007039190735667944, -0.0017881372477859259, 0.019175851717591286, 0.036303941160440445, 0.007295161485671997, -0.021764811128377914, 0.0015358234522864223, 0.0012862521689385176, 0.01649913191795349, -0.008520163595676422, 0.021238243207335472, -0.015475248917937279, 0.007386579178273678, 0.009448970668017864, -0.010992107912898064, -0.028785718604922295, 0.016191966831684113, 0.0016446108929812908, -0.02542153373360634, 0.00587635301053524, 0.009324641898274422, 0.00501336669549346, 0.007898520678281784, 0.022379141300916672, -0.031243037432432175, -0.0021519812289625406, -0.022115856409072876, 0.04212544113397598, 0.026196759194135666, 0.012250020168721676, 0.004322245717048645, 0.056693825870752335, -0.04619171842932701, -0.0038761256728321314, 0.0034117221366614103, -0.0009571471018716693, 0.014868233352899551, -0.005386352073401213, -0.023885710164904594, 0.013354349881410599, 0.021457647904753685, 0.022744813933968544, 0.003552505746483803, -0.016718534752726555, -0.0021282124798744917, -0.012915543280541897, 0.01559226494282484, 0.004801276605576277, 0.04531410336494446, 0.0036786627024412155, 0.004808589816093445, 0.03621618077158928, -0.022788694128394127, 0.003905379679054022, -0.009434344246983528, 0.005320531316101551, 0.02154540829360485, 0.007375609129667282, 0.007722997572273016, 0.020199734717607498, 0.03870274871587753, 0.022349888458848, -0.005009709857404232, 0.009339269250631332, 0.012147631496191025, -0.0230227243155241, -0.042652010917663574, -0.021165110170841217, 0.05084306746721268, 0.0014407486887648702, -0.015884801745414734, -0.028961241245269775, 0.014319725334644318, -0.006227398291230202, -0.030394677072763443, -0.017347490414977074, 0.03855648264288902, 0.00800090841948986, 0.026357654482126236, 0.0013868119567632675, 0.017376745119690895, 0.0010915315942838788, -0.0316818431019783, -0.015753161162137985, 0.025333773344755173, -0.05207172781229019, -0.014370919205248356, 0.013222708366811275, -0.015051069669425488, 0.007145235780626535, 0.050140976905822754, -0.006881951820105314, -0.008110610768198967, -0.0006070159142836928, -0.026840342208743095, 0.004099186044186354, 0.028317658230662346, 0.0053351582027971745, 0.011708824895322323, -0.02432451769709587, -0.006746653001755476, -0.0021629512775689363, -0.03595289587974548, -0.0004285221511963755, 0.022949589416384697, 0.016104206442832947, -0.026299146935343742, 0.02920989878475666, 0.0163089819252491, 0.0016464393120259047, 0.0021355259232223034, 0.018839433789253235, 0.013273902237415314, 0.027323029935359955, 0.04449499770998955, -0.03460722044110298, -0.01989256963133812, -0.01345673855394125, -0.004742769058793783, 0.0035890729632228613, 0.0096318069845438, 0.0011125578312203288, 0.0035488491412252188, 0.004680604673922062, 0.04285678640007973, 0.017552267760038376, 0.006157920695841312, -0.03981439396739006, 0.0035067969001829624, 0.0012679685605689883, -0.030950497835874557, 0.0342269204556942, -0.03136005252599716, 0.01794719323515892, 0.027615567669272423, 0.006977026350796223, -0.014868233352899551, -0.01759614795446396, 0.007192772813141346, -0.007211056537926197, 0.026489296928048134, -0.007737624458968639, -0.012447482906281948, 0.024865712970495224, -0.004925604909658432, 0.030248407274484634, 0.010173002257943153, -0.018649283796548843, 0.0062749357894063, -0.05040426179766655, -0.016396744176745415, 0.017420625314116478, -0.04244723543524742, 0.01566539891064167, 0.003614670131355524, 0.032705724239349365, 0.03981439396739006, 0.042973801493644714, 0.03753259778022766, -0.021106602624058723, 0.005565531551837921, 0.01695256493985653, -0.01378584373742342, -0.017683910205960274, 0.015197338536381721, 0.01927824132144451, -0.02381257712841034, 0.0204045120626688, 0.005240083206444979, 0.029809601604938507, -0.04569440335035324, 0.012908230535686016, 0.01613345928490162, 0.004300305619835854, -0.039551109075546265, -0.013997933827340603, 0.005119411274790764, -0.027337657287716866, -0.021428393200039864, -0.012491364032030106, 0.0043734400533139706, -0.0025962728541344404, -0.008132550865411758, 0.004417320713400841, -0.015504502691328526, -0.014912114478647709, 0.03232542797923088, -0.01682092249393463, -0.007477997336536646, -0.008980910293757915, 0.004450231324881315, -0.004848814103752375, -0.0014562896685674787, 0.01361032109707594, -0.007302474696189165, 0.0032398561015725136, -0.001470916555263102, 0.00408455915749073, 0.024426905438303947, -0.01747913286089897, -0.0038724690675735474, -0.025991983711719513, -0.0023768695537000895, -0.03881976380944252, 0.003417207160964608, -0.01990719698369503, -0.034665729850530624, 0.019834062084555626, 0.009587925858795643, 0.009595239534974098, -0.009178373031318188, -0.016031071543693542, 0.03779588267207146, 0.018985703587532043, -0.0045928433537483215, 0.008746880106627941, -0.011299272067844868, 0.06775175034999847, -0.0009918860159814358, -0.02853706106543541, 0.005020679906010628, -0.018824806436896324, 0.025348400697112083, 0.0032380276825278997, 0.003398923436179757, -0.019819434732198715, 0.0004516052140388638, -0.002338473917916417, 0.004932918585836887, 0.004625753965228796, 0.01500718854367733, 0.032383933663368225, 0.011555243283510208, -0.016206594184041023, 0.014656143262982368, 0.04622097313404083, 0.0057885916903615, 0.01777167059481144, 0.03332005441188812, 0.00033710410934872925, 0.014195396564900875, 0.003598214825615287, 0.0026602656580507755, -0.015372861176729202, 0.007657176814973354, 0.017917940393090248, 0.034168414771556854, -0.0019874286372214556, -0.016923312097787857, -0.02482183277606964, 0.01907346397638321, -0.03589438647031784, -0.006044561974704266, -0.01743525266647339, 0.04554813355207443, 0.00574471103027463, -0.01695256493985653, 0.0029985124710947275, 0.006245682016015053, 0.02169167809188366, 0.001710431883111596, 0.023549292236566544, 0.0037517971359193325, -0.012981364503502846, 0.017040327191352844, -0.0025615340564399958, 0.01076539047062397, 0.005894636735320091, -0.00010450227273395285, -0.012301214039325714, -0.02363705448806286, 0.013661514967679977, 0.006534562911838293, 0.009200314059853554, 0.01569465361535549, 0.02122361771762371, 0.008286133408546448, -0.04829799011349678, 0.0067137423902750015, -0.04077976942062378, -0.0032855651807039976, 0.005773964803665876, -0.047244854271411896, -0.005441202782094479, 0.024865712970495224, 0.00010313100210623816, 0.020477645099163055, -0.03048243746161461, 0.005430232733488083, -0.037620361894369125, -0.025860341265797615, -0.0074560572393238544, 0.016689281910657883, -0.012871663086116314, 0.02708899974822998, 0.024353770539164543, 0.053768448531627655, 3.5938726796302944e-05, -0.011131063103675842, -0.014795099385082722, -0.024543920531868935, -0.019146598875522614, -0.006154263857752085, 0.03179885819554329, -0.010999420657753944, -0.0249681007117033, 0.014085695147514343, -0.010063299909234047, 0.023739442229270935, 0.03703528642654419, 0.009683000855147839, -0.010326583869755268, -0.0027608254458755255, 0.000868471572175622, 0.032413188368082047, 0.00039058367838151753, 0.004216201137751341, -0.032032888382673264, 0.00921494048088789, 0.011672258377075195, 0.014700024388730526, -0.023710187524557114, 0.001159181003458798, -0.03963886946439743, -0.006885608192533255, 0.009397776797413826, 0.007042847573757172, 0.004146723076701164, 0.015387487597763538, 0.023212874308228493, 0.018327493220567703, -0.023754069581627846, 0.009587925858795643, -0.0036055282689630985, 0.04923411086201668, -0.0028065345250070095, -0.010633748956024647, 0.01354449987411499, 0.019848689436912537, 0.011884347535669804, -0.00684904120862484, 0.00583247235044837, 0.033524829894304276, 0.004662320949137211, -0.027513179928064346, -0.005861726123839617, -0.009975538589060307, 0.00400045420974493, 0.02090182527899742, 0.014210022985935211, -0.006114040035754442, 0.028303030878305435, 0.030102139338850975, 0.004468515049666166, -0.04098454490303993, -0.015124203637242317, 0.002241570968180895, 0.013676142320036888, 0.029166018590331078, -0.029604824259877205, -0.002153809415176511, 0.006677174940705299, -0.011313899420201778, -0.005309560801833868, -0.02135525830090046, 0.048883065581321716, 0.027279149740934372, 0.010341211222112179, -0.023271381855010986, -0.01248405035585165, 0.025845713913440704, 0.006384637206792831, -0.016718534752726555, -0.003444632515311241, -0.017917940393090248, 0.0004959430079907179, -0.01133583951741457, 0.018386000767350197, -0.020974960178136826, 0.022057348862290382, 0.021150482818484306, 0.04399768263101578, -0.0043734400533139706, -0.02236451394855976, -0.027469299733638763, 0.003788364352658391, -0.0030021690763533115, 0.0024518324062228203, -0.003036907874047756, 0.009251507930457592, -0.005068217404186726, -0.003270938294008374, -0.008688372559845448, -0.006413890980184078, 0.014992562122642994, -0.017347490414977074, 0.039902154356241226, -0.015899429097771645, -0.01566539891064167, 0.01923435926437378, 0.004534335806965828, -0.001996570499613881, 0.00559112848713994, 0.008286133408546448, 0.015475248917937279, 0.00045434775529429317, 0.0007391149993054569, -0.0014270358951762319, -0.012440170161426067, 0.03393438458442688, 0.013193454593420029, 0.03033616952598095, 0.07254937291145325, 0.011686884798109531, -0.007847326807677746, 0.025684818625450134, 0.0193952564150095, -0.016835549846291542, 0.0026822059880942106, 0.0011728936806321144, 0.003879782510921359, -0.012352408841252327, -0.008454342372715473, -0.015138830989599228, -0.025743326172232628, -0.0024006383027881384, -0.005627695936709642, 0.043792907148599625, 0.010341211222112179, -0.01557763759046793, 0.011445540934801102, 0.012688826769590378, -0.026971984654664993, 0.03226691856980324, 0.0010028561810031533, -0.031886618584394455, 0.002537765307351947, 0.006212771404534578, -0.002460974268615246, 0.027191387489438057, 0.0014142374275252223, -0.0100340461358428, -0.014173456467688084, 0.04505082219839096, 0.016367489472031593, 0.012981364503502846, 0.025889594107866287, 0.007569415494799614, -0.026050491258502007, -0.009068671613931656, -0.011160316877067089, 0.0002106043539242819, -0.0003604156954679638, -0.006088442634791136, -0.015314353629946709, -0.008629865013062954, -0.0011600952129811049, -0.042505741119384766, 0.018049582839012146, -0.00607747258618474, 0.00013644144928548485, -0.013990620151162148, 0.053095608949661255, 0.002799221081659198, 0.018005700781941414, -0.031594082713127136, 0.019848689436912537, 0.01582629419863224, -0.0012176885502412915, 1.5398229152197018e-05, -0.040721260011196136, 0.026518551632761955, -0.0371815524995327, 0.005463143344968557, -0.014422113075852394, 0.008856581524014473, 0.009193000383675098, -0.0277179554104805, -0.01584092155098915, 0.01393942628055811, -0.002793736057356, 0.0005059989634901285, 0.03460722044110298, -0.046893808990716934, -0.011460168287158012, -0.01764002814888954, 0.0010284532327204943, 0.010297330096364021, 0.019936449825763702, -0.019541524350643158, -0.025187503546476364, 0.0061103831976652145, 0.031038260087370872, 0.024587802588939667, 0.012944797053933144, 0.014963308349251747, -0.04818097501993179, 0.03805916756391525, -0.0008117923862300813, -0.016703907400369644, 0.01775704324245453, 0.006026278715580702, 0.03495826572179794, -0.0045855301432311535, -0.013829723931849003, -0.013083753176033497, -0.007445086725056171, -0.0417451448738575, 0.02265705168247223, 0.023768695071339607, -0.02738153748214245, -0.00505724735558033, 0.022905709221959114, 0.014729278162121773, -0.05590397119522095, -0.020199734717607498, 0.01271076686680317, -0.0024554890114814043, -0.001810077577829361, 0.03747409209609032, -0.013485992327332497, 0.047566644847393036, 0.02135525830090046, -0.0230227243155241, 0.011079869233071804, -0.017917940393090248, 0.01661614701151848, 0.012008676305413246, 0.002813847968354821, 0.015899429097771645, 0.02053615264594555, 0.013164200820028782, 0.0378543920814991, -0.005068217404186726, 0.01958540454506874, -0.033378563821315765, 0.0027845941949635744, -0.029648706316947937, -0.002991199027746916, -0.010721510276198387, 0.008183744736015797, 0.046747539192438126, 0.00592023367062211, -0.021457647904753685, 0.03685976192355156, 0.01878092624247074, -0.02136988565325737, 0.03949260339140892, 0.01860540360212326, 0.026620939373970032, 0.005594785325229168, -0.0046586645767092705, 0.0009534903801977634, 0.006962399464100599, 0.011628377251327038, 0.03346632421016693, -0.011767332442104816, -0.016747789457440376, 0.0040443348698318005, 0.0012835095403715968, -0.004260081797838211, -0.018020328134298325, 0.013208081014454365, 0.003618326736614108, -0.015475248917937279, -0.005320531316101551, -0.011745392344892025, -0.013025245629251003, 0.02689884975552559, 0.015884801745414734, -0.0007098612259142101, 0.0036110132932662964, 0.01743525266647339, -0.005836129188537598, -0.014838979579508305, -0.03133079782128334, 0.003832245012745261, -0.007393892854452133, -0.027308402583003044, 0.02384182997047901, 0.03004363179206848, -0.015519130043685436, 0.010151061229407787, -0.011416287161409855, -0.01069225650280714, -0.0008131636423058808, -0.018795553594827652, -0.0072256834246218204, 0.025816461071372032, 0.022276753559708595, -0.012988678179681301, -0.013749276287853718, -0.012593751773238182, -0.03469498082995415, -0.06394876539707184, 0.033671099692583084, -0.00020226245396770537, 0.018503015860915184, -0.026547804474830627, -0.026065116748213768, -0.035806626081466675, 0.018649283796548843, -0.010377778671681881, -0.017069580033421516, 0.015884801745414734, -0.013017931953072548]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" final
eval, we count the number of winner as win+tie ×0.5.
The prompt is given as
Please act as an impartial judge and evaluate the quality of the responses provided by two AI
assistants to the user question displayed below. You should choose the assistant that follows
the user’s instructions and answers the user’s question better. Your evaluation should consider
factors such as the helpfulness, relevance, accuracy, depth, creativity, and level of detail of their
responses. Begin your evaluation by comparing the two responses and provide a short explanation.
Avoid any position biases and ensure that the order in which the responses were presented does
not influence your decision. Do not allow the length of the responses to influence your evaluation.
Do not favor certain names of the assistants. Be as objective as possible. After providing your
explanation, output your final verdict by strictly following this format: [[A]] if assistant A is
better, [[B]] if assistant B is better, and [[C]] for a tie.
Reward baseline. We mention in passing that we use the test reward of the initial model as the baseline
when presenting the absolute values in Table 2 by convention (Gao et al., 2023; Dong et al., 2023).
H.2 Examples
We provide sample outputs of the models from different RLHF algorithms in Table 5 and 6 with the in-
distribution prompts, and in Table 7 with the OOD prompts.
48
HH-RLHF Examples
Prompt :
Human: How do I housebreak a puppy?
Assistant: You’re looking for a pet who will move his bowels in the grass outdoors, rather than messing your house.
Human: yes.
Assistant: When a dog feels the need to defecate, he will signal you with a high pitched noise. You can watch for this
by looking closely at him when he’s relaxing, or by sitting near him and listening. When you observe him signaling you,
you should immediately bring him outside to a patch of grass. As long as the ground is soft, your dog can do his business
anywhere, not just in your house. Just be sure to put him in a separate area where he can
Human: What if he has an accident in my house?
Assistant: Well, in that case you should immediately remove all traces of the accident, and clean the area. (Also, I just
noticed that you asked this two years ago.)
Human: Okay, but do I scold him? Assistant:
Responses :
SFT: You can use positive reinforcement to teach him the behavior you want, or you can use punishment to remind him
of the behavior he needs to stop.
DPO: It’s always a good idea to be honest. It’s important to be firm when you scold your dog, but also calm. The No. 1
goal is to not make your dog fear you. You should use certain words to talk to your dog, but be specific about your needs.
For example, as soon as you observe him demonstrating his need for a bowel movement, you should say, “Do you need to
go outside?” or “Can I help you?” You can also say, “You’re making a mess in the house, I don’t like that.” If your dog
will come to you, then you can also say, “Come to me.” This is a crucial part of house training your dog. You should be
consistently firm, but also calm, and your dog will learn to trust you and follow your orders. There are different methods
to use, such as a clicker, but the important thing is to stay consistent in your commands, don’t use any harsh words, and
test your dog’s limits first before you start to punish him. You can use verbal(5) and physical signals, but you shouldn’t
go overboard with any of them. If you’re not certain how to proceed, speak to a professional trainer about housebreaking
your dog. Remember, housebreaking your dog takes practice and consistency, it’s a lifelong commitment. If you ever have
any questions, don’t hesitate to ask me for more help. I’m always here to help you provide the best environment for your
dog. Have a great day, and happy training!
RSO: Yes, definitely scold him for urinating indoors, and also it’s a good idea to make sure he understands that it’s not
acceptable to soil the house. The most important thing is to be consistent with your corrections and to stay calm. Also,
remember to reward him for good behavior outside. So try to do it right away, and be patient with the training, as it
might take a while for your puppy to learn the whole house-breaking process. Finally, always be consistent and also be
patient! In the end, housebreaking will be","[-0.0004730521759483963, -0.009025187231600285, 0.07729873806238174, 0.03968561813235283, -0.013849357143044472, -0.034196287393569946, -0.0010126203997060657, 0.014045404270291328, 0.023833777755498886, 0.06928879767656326, 0.024617966264486313, -0.004873181227594614, -0.0008323267684318125, -0.02330164797604084, -0.02246144413948059, -0.06206304207444191, 0.007103221956640482, -0.008311014622449875, -0.01548775378614664, 0.008885153569281101, 0.016678042709827423, 0.030695440247654915, -0.008388033136725426, 0.043970659375190735, 0.012350994162261486, 0.023609722033143044, 0.03150763735175133, 0.022167373448610306, 0.014801587909460068, 0.007715870160609484, -0.0156277883797884, -0.013849357143044472, -0.04377461224794388, -0.06385547667741776, 0.02247544750571251, 0.011258728802204132, -0.007848902605473995, -0.0023105600848793983, -0.010166464373469353, 0.014507516287267208, -0.009025187231600285, -0.04660329595208168, 0.02747466042637825, -0.04206619784235954, -0.013051163405179977, 0.03632480651140213, 0.03254389017820358, -0.024687984958291054, 0.009137215092778206, 0.0031472628470510244, -0.0343923345208168, 0.08082759380340576, 0.015837838873267174, 0.03629679977893829, 0.051140397787094116, -0.046995390206575394, -0.00843704491853714, 0.007554831448942423, 0.019310681149363518, -0.018652521073818207, 0.029211079701781273, -0.01912863738834858, 0.031367603689432144, 0.013072168454527855, -0.02765670418739319, -0.03456037864089012, -0.02412784844636917, 0.01403840258717537, 0.048983871936798096, -0.032123785465955734, 0.02965918928384781, 0.04201018437743187, 0.027684710919857025, -0.020192895084619522, 0.014290464110672474, -0.006574593484401703, 0.06318331509828568, 0.03531656041741371, -0.0010773862013593316, 0.004582610912621021, -0.016411978751420975, -0.019590748474001884, -0.009214233607053757, -0.025822259485721588, -0.03332807868719101, -0.0016208929009735584, -0.07052109390497208, -0.05847817286849022, 0.010075442492961884, -0.11197113990783691, 0.025780249387025833, 0.029631182551383972, -0.023847781121730804, -0.018764548003673553, 0.04170210659503937, -0.07337778806686401, 0.005853418726474047, -0.016061892732977867, 0.06111081317067146, 0.007400793954730034, 0.021915312856435776, -0.05836614593863487, 0.001090514357201755, -0.00218102871440351, -0.0018344447016716003, -0.01863851770758629, -0.0064345598220825195, 0.05251272767782211, -0.03273993730545044, 0.004946698900312185, -0.04525896906852722, 0.04612718150019646, -0.0778028592467308, -0.003437833394855261, -0.031451623886823654, -0.010586566291749477, -0.03750108927488327, -0.063127301633358, -0.020150884985923767, -0.01135675236582756, 0.04016173630952835, 0.03976963832974434, -0.0254861768335104, -0.03243185952305794, 0.007358783856034279, 0.01603388600051403, 0.052568741142749786, -0.023343658074736595, -0.018484480679035187, -0.00774387689307332, 0.031535644084215164, 0.011335747316479683, 0.003150763688609004, -0.04511893540620804, -0.06435959786176682, -0.0028759471606463194, -0.02646641433238983, -0.027614694088697433, -0.01102067157626152, 0.022405430674552917, 0.0312555767595768, -0.04971205070614815, -0.10149659961462021, 0.0011867876164615154, -0.03926551714539528, 0.0070121996104717255, -0.010348508134484291, 0.018582504242658615, -0.013751333579421043, 0.029967263340950012, 0.014913614839315414, 0.05153249204158783, -0.026858510449528694, 0.0002616884303279221, 0.027502667158842087, 0.02348369173705578, 0.004092492163181305, 0.024085838347673416, -0.027950774878263474, -0.025024065747857094, -0.007869907654821873, 0.020500969141721725, 0.015277703292667866, -0.00019922015781048685, 0.0051917582750320435, 0.013660310767591, 0.028608934953808784, -0.010075442492961884, -0.019758788868784904, 0.01936669461429119, 0.015529763884842396, 0.013513275422155857, -0.01140576507896185, -0.03304801136255264, 0.030835473909974098, -0.0044600809924304485, -0.009207231923937798, 0.02589227631688118, -0.004831171128898859, -0.025500180199742317, -0.007309771608561277, 0.0312555767595768, 0.0030474886298179626, -0.025248119607567787, 0.0405818372964859, -0.01863851770758629, -0.02472999505698681, 0.003609374864026904, -0.06716027855873108, 0.024505939334630966, -0.026242360472679138, -0.025948289781808853, 0.07281765341758728, 0.00551383662968874, 0.01803637109696865, -0.021313166245818138, 0.04595914110541344, -0.038705382496118546, -0.021425193175673485, -0.02339967153966427, 0.03584868833422661, 0.02873496524989605, 0.006956186145544052, -0.0464632622897625, 0.02999527007341385, -0.006294525694102049, -0.04719143733382225, 0.029715202748775482, -0.060102567076683044, -0.034028246998786926, 0.012799102813005447, 0.02271350473165512, 0.03526054695248604, 0.0340842604637146, -0.06402351707220078, 0.008878151886165142, -0.0038789401296526194, -0.016341961920261383, 0.0114827835932374, -0.006865164265036583, -0.010131455957889557, -0.026998544111847878, 0.04567907378077507, -0.03593270853161812, -0.05881425738334656, 0.023819774389266968, 0.022853540256619453, -0.04688336327672005, 0.022195380181074142, -0.025080079212784767, 0.026830503717064857, 0.028118815273046494, -0.0040959930047392845, -0.026830503717064857, 0.04335450753569603, -0.010866633616387844, 0.008198987692594528, -0.03489645943045616, 0.03372017294168472, -0.006445062346756458, -0.0004264471062924713, 0.0017784311203286052, 0.03321605175733566, -0.0046316226944327354, 0.021271156147122383, -0.010061439126729965, -0.011846871115267277, -0.07141730934381485, 0.0487598180770874, -0.019898822531104088, 0.04859177768230438, -0.03993767872452736, 0.044978901743888855, -0.02271350473165512, -0.04769556224346161, -0.0027831746265292168, -4.015035665361211e-05, -0.021257152780890465, 0.011349750682711601, -0.031003514304757118, -0.025822259485721588, -0.018400460481643677, 0.018582504242658615, -0.0018677026964724064, -0.030611420050263405, 0.0102784913033247, -0.04145004600286484, -0.015025641769170761, -0.014829594641923904, -0.0194507148116827, -0.044810861349105835, 0.021523216739296913, 0.020192895084619522, 0.01569780521094799, -0.0211311224848032, -0.016762062907218933, 0.0031455124262720346, 0.0111957136541605, -0.012925133109092712, -0.05388506129384041, -0.05002012476325035, 0.020108874887228012, 0.021019095554947853, -0.014829594641923904, 0.023679738864302635, 0.026494422927498817, -0.04777958244085312, 0.03021932579576969, -0.0033433104399591684, 0.034700412303209305, 0.000348772038705647, -0.023749757558107376, 0.04651927575469017, -0.01081762183457613, -0.008528066799044609, -0.03248787298798561, 0.006529082544147968, 0.016383972018957138, 0.035876695066690445, 0.040721870958805084, 0.04917991906404495, 0.07040906697511673, -0.05060826614499092, 0.024659978225827217, -0.021999333053827286, 0.00522326584905386, 0.008528066799044609, -0.023777764290571213, 0.013730328530073166, 0.0013154438929632306, 0.008016943000257015, 0.03976963832974434, -0.019100630655884743, 0.01653800904750824, 0.023833777755498886, -0.066488116979599, 0.04609917476773262, -0.012329989112913609, -0.015459747053682804, -0.0456230603158474, -0.014185438863933086, -0.001969227334484458, -0.003380069276317954, 0.011622817255556583, -0.025094082579016685, -0.03198375180363655, 0.032291825860738754, 0.011510790325701237, -0.022237390279769897, 0.019072623923420906, 0.017504243180155754, 0.016566015779972076, -0.03016331046819687, 0.04486687481403351, -0.04217822477221489, -0.013688317500054836, -0.04887184500694275, -0.016005879268050194, 0.007092719431966543, 0.028034795075654984, -0.05167252570390701, -0.02629837393760681, -0.05735790356993675, 0.025416160002350807, -0.054753270000219345, 0.010922648012638092, 0.035456594079732895, -0.010530552826821804, 0.022825533524155617, 0.03262791037559509, 0.005755395162850618, 0.027782734483480453, 0.018834564834833145, -0.014661554247140884, -0.013506273739039898, 0.030779460445046425, -0.022587474435567856, -0.03741706907749176, -0.03372017294168472, 0.010747605003416538, 0.020907066762447357, -0.0007859405013732612, 0.03257189691066742, 0.045062921941280365, -0.028496908023953438, 0.056349657475948334, -0.02387578785419464, -0.022321410477161407, 0.0035953714977949858, 0.019184650853276253, -0.02523411624133587, -0.0018642018549144268, -0.041730113327503204, 0.021915312856435776, -0.0484517440199852, 0.030247332528233528, 0.020066864788532257, 0.02170526050031185, 0.010880636982619762, 0.03957359120249748, 0.013016154989600182, -0.0027866754680871964, -0.018526490777730942, -0.056517697870731354, 0.014479509554803371, 0.03425230085849762, -0.059598445892333984, -0.02515009604394436, -0.014304467476904392, -0.01286211796104908, 0.04198217764496803, -0.02222338691353798, -0.00897617544978857, 0.04601515457034111, 0.009914402849972248, 0.008479055017232895, -0.04074987769126892, 0.0425703190267086, 0.031367603689432144, 0.011440773494541645, 0.009466294199228287, -0.018092384561896324, -0.02103309892117977, 0.04934796318411827, -0.049740057438611984, 0.014003394171595573, -0.052232660353183746, -0.0021477704867720604, -0.0020707519724965096, -0.001788933645002544, 0.03358013927936554, 0.008212991058826447, 0.03047138638794422, 0.024253878742456436, -0.019058620557188988, -0.028342869132757187, 0.0030754953622817993, -0.024001818150281906, 0.01770029030740261, -0.021691257134079933, -0.006686620879918337, -0.027292614802718163, -0.010509547777473927, -0.031283583492040634, -0.012624059803783894, 0.05514536798000336, 0.008304012939333916, -0.010761608369648457, -0.02331565134227276, -0.057077836245298386, 0.0005225016502663493, 0.044474780559539795, -0.00898317713290453, -0.013856358826160431, -0.042038191109895706, -0.03542858734726906, -0.023609722033143044, -0.007379788905382156, 0.016636032611131668, 0.0151516729965806, 0.04369059205055237, -0.043970659375190735, -0.021159129217267036, 0.028790978714823723, -0.07253758609294891, -0.012869119644165039, -0.01228097639977932, 0.032599903643131256, 0.014052405953407288, 0.0052162641659379005, -0.012364997528493404, -0.03299199789762497, 0.016846083104610443, 0.06424757093191147, 0.03296399116516113, -0.01996883936226368, 0.09343064576387405, -0.02799278497695923, -0.0067566377110779285, 0.034700412303209305, 0.006697123404592276, -0.03472841903567314, 0.04696738347411156, 0.012126939371228218, -0.056181617081165314, 0.03968561813235283, -0.017014123499393463, 0.03618476912379265, -0.015025641769170761, -0.06077473238110542, 0.010971659794449806, -0.05002012476325035, 0.05102836713194847, -0.040469810366630554, -0.014535523019731045, -0.037557102739810944, -0.01011045090854168, -0.012792101129889488, -0.011531795375049114, -0.02412784844636917, -0.0014983632136136293, -0.043382514268159866, 0.015543767251074314, 0.003535856958478689, 0.056097596883773804, -0.006805649492889643, 0.022517457604408264, -0.02229340374469757, -0.0397416315972805, 0.03105952776968479, -0.024589959532022476, -0.004831171128898859, 0.03475642576813698, -0.01670604944229126, -0.01954873837530613, -0.011636820621788502, 0.051728539168834686, 0.055761516094207764, 0.019086627289652824, 0.00765985669568181, 0.001116770668886602, -0.020234905183315277, -0.0028934513684362173, 0.07029704004526138, 0.018344447016716003, 0.0187225379049778, 0.05887027084827423, -0.0010572562459856272, 0.008093961514532566, -0.0067146276123821735, -0.042038191109895706, -0.016397975385189056, -0.004789161030203104, 0.039629604667425156, -0.018666524440050125, -0.010341506451368332, 0.025528186932206154, -0.016467992216348648, -0.04010572284460068, 0.009025187231600285, -0.002049746923148632, 0.008703109808266163, 0.01953473500907421, -0.009872392751276493, 0.002049746923148632, 0.0010660083498805761, -0.028132818639278412, -0.052568741142749786, -0.003059741575270891, -0.019086627289652824, -0.01880655810236931, -0.011916888877749443, -0.02079503983259201, 0.019730782136321068, -0.04702339693903923, 0.016832079738378525, -0.005996953696012497, -0.0156277883797884, -0.026368390768766403, -0.01627194508910179, 0.01102067157626152, 0.02824484556913376, 0.0278947614133358, -0.013219203799962997, 0.026788493618369102, 0.010600569657981396, 0.006501075811684132, 0.0366048738360405, 0.013037160038948059, 0.005632865242660046, 0.008941167034208775, -0.046491269022226334, -0.01786833070218563, -0.0034168281126767397, 0.01340825017541647, 0.02562621235847473, -0.0013443258358165622, -0.03383219987154007, 0.02005286142230034, 0.010537554509937763, -0.018820561468601227, -0.013380243442952633, 0.010432528331875801, -0.02323163114488125, -0.00666211498901248, 0.0013206951553002, 0.02447793260216713, 0.0049957106821238995, 0.02379176765680313, 0.008226994425058365, -0.00798193458467722, -0.01487160474061966, -0.009018185548484325, -0.03881740942597389, -0.00706121139228344, -0.003945456352084875, 0.011293737217783928, 0.006697123404592276, 0.014185438863933086, -0.0022615480702370405, -0.006070471368730068, -0.05562148243188858, -0.023945804685354233, 0.006634108256548643, -0.026102326810359955, -0.03257189691066742, 0.015473750419914722, 0.03531656041741371, 0.0027429149486124516, -0.0042395275086164474, 0.021509213373064995, -0.003292548004537821, 0.02072502300143242, -0.001879955641925335, -0.02540215663611889, -0.010628576390445232, -0.025696229189634323, 0.014185438863933086, -0.002700904617086053, -0.004974705632776022, 0.006182498764246702, -0.012589051388204098, 0.006991194561123848, -0.03198375180363655, -0.0352325402200222, -0.016467992216348648, -0.05352097377181053, -0.030443379655480385, 0.033608146011829376, -0.010404521599411964, -0.010369513183832169, -0.026746483519673347, -0.0023368163965642452, -0.027628697454929352, -0.026956534013152122, -0.03349611908197403, -0.02881898544728756, 0.009508304297924042, 0.006231510546058416, 0.007050708867609501, -0.017322199419140816, 0.015081655234098434, 0.028118815273046494, -0.0016480244230479002, 0.03201175853610039, -0.012007910758256912, 0.004901187960058451, -0.008276006206870079, -0.00973235908895731, -0.018498484045267105, -0.03526054695248604, 0.001599012641236186, 0.018932588398456573, -0.03131159022450447, -0.01627194508910179, 0.03173169121146202, 0.01620192639529705, -0.011706837452948093, -0.012379000894725323, -0.0063400366343557835, 0.01862451434135437, 0.010159462690353394, 0.005748393479734659, -0.013723326846957207, 0.0181904099881649, 0.038285281509160995, -0.0009032189263962209, 0.02454794943332672, -0.001213919254951179, -0.034952472895383835, -0.03666088730096817, -0.024828018620610237, 0.014731571078300476, -0.0017425473779439926, 0.02638239413499832, 0.017434226348996162, -0.038117241114377975, 0.0056083593517541885, -0.022069349884986877, 0.005573350936174393, -0.006070471368730068, -0.0074288006871938705, -0.011055679991841316, 0.007701866794377565, 0.02974320948123932, -0.008100963197648525, -0.0022860541939735413, 0.002541616093367338, -0.004495089408010244, 0.007400793954730034, -0.026942530646920204, 0.007040206342935562, 0.04850775748491287, -0.018918585032224655, -0.023035584017634392, -0.02030492201447487, 0.024337898939847946, -0.07208947092294693, -0.009613330475986004, 0.008619089610874653, -0.04315846040844917, -0.010999666526913643, -0.05010414496064186, -0.0027061558794230223, 0.009935407899320126, -0.003199775703251362, 0.01847047731280327, -0.04002170264720917, -0.001074760453775525, 0.016510002315044403, -0.006522080861032009, -0.005275778938084841, -0.023329654708504677, 0.005856919568032026, 0.0032172799110412598, 0.011790857650339603, -0.0031787704210728407, 0.03217979893088341, 0.024099841713905334, -0.0748901516199112, -0.002692152513191104, -0.015991875901818275, 0.013877363875508308, -0.035288553684949875, -0.005587354302406311, -0.015333716757595539, -0.026074320077896118, 0.01754625327885151, -0.02656443975865841, -0.010985663160681725, -0.013506273739039898, 0.03769713640213013, -0.011454776860773563, 0.024842021986842155, -0.021859299391508102, -0.002517110202461481, 0.037305042147636414, 0.0005680127069354057, -0.01627194508910179, -0.025374149903655052, -0.017098143696784973, 0.02047296240925789, 0.008114966563880444, 0.01036251150071621, 0.012505031190812588, -0.015333716757595539, -0.023511698469519615, -0.048227690160274506, -0.019604751840233803, 0.018862571567296982, 0.00114827835932374, 0.007239754777401686, -0.006959686987102032, -0.016089899465441704, -0.019688772037625313, 0.03783717006444931, -0.053829047828912735, 0.008535068482160568, -0.04060984402894974, -0.04074987769126892, -0.013688317500054836, 0.0068406579084694386, -0.01988481916487217, -0.014927618205547333, 0.008752121590077877, -0.017392216250300407, 0.014549526385962963, 0.030695440247654915, -0.01737821288406849, -0.01660802587866783, -0.004722644574940205, 0.01319819875061512, -0.025752242654561996, -0.012449017725884914, 0.03072344698011875, 0.002240543020889163, -0.0032890471629798412, -0.01202191412448883, -0.008086959831416607, 0.011321743950247765, 0.005314288195222616, 0.009571320377290249, -0.012953139841556549, 0.021565226837992668, -0.0008047575829550624, -0.015641791746020317, 0.0151516729965806, 0.012645064853131771, -0.0035708656068891287, 0.02096308209002018, -0.01694410666823387, -0.009284250438213348, 0.01594986580312252, 0.01662202924489975, 0.028048798441886902, -0.03906947001814842, -0.0012830609921365976, -0.03175969794392586, -0.021761273965239525, -0.02195732295513153, -0.00919322855770588, -0.025920283049345016, 0.006945683620870113, -0.023035584017634392, -0.022335413843393326, 0.017084140330553055, -0.016229933127760887, 0.012014912441372871, -0.005853418726474047, -0.0295751690864563, -0.007267761509865522, -0.010523551143705845, -0.016734056174755096, -0.018106387928128242, -0.001747798640280962, -0.0027411645278334618, -0.032683923840522766, -0.0960632860660553, -0.022363420575857162, 0.030331352725625038, -0.011251727119088173, -0.022237390279769897, -0.017924344167113304, 0.00972535740584135, 0.02965918928384781, -0.00482066860422492, -0.0053282915614545345, -0.009179225191473961, 0.011335747316479683, 0.02229340374469757, -0.03097550757229328, 0.037809163331985474, -0.013513275422155857, -0.008156977593898773, -0.02379176765680313, 0.021411189809441566, -0.030695440247654915, -0.03433632105588913, -0.030275339260697365, -0.014367482624948025, -0.009151218459010124, -0.021243149414658546, 0.008170980960130692, -0.028762971982359886, 0.0020059861708432436, -0.003815924981608987, 0.0035988723393529654, -0.013387245126068592, 0.02237742394208908, 0.0004209770413581282, -0.013499272055923939, -0.041646093130111694, -0.0357646681368351, -0.01980079896748066, 0.010201472789049149, -0.0008559574489481747, 0.010929649695754051, 0.0459311343729496, -0.04209420457482338, 0.007988936267793179, -0.02197132632136345, 0.023007577285170555, -0.03484044596552849, 0.0036408824380487204, -0.023273641243577003, 0.022111359983682632, 0.0052617755718529224, 0.0049537005834281445, -0.009634335525333881, -0.029267093166708946, -0.005993452854454517, -0.023861784487962723, 0.035708654671907425, -0.027418645098805428, -0.02271350473165512, -0.0075758364982903, 0.02496805228292942, -0.009669343940913677, -0.018526490777730942, 5.3524690883932635e-05, -0.030443379655480385, 0.009949411265552044, -0.02772672101855278, -0.025346143171191216, -0.007421799004077911, 0.012666069902479649, -0.01862451434135437, -0.044978901743888855, -0.0040014698170125484, -0.0025643715634942055, 0.01963275857269764, 0.00035008485428988934, -0.010404521599411964, 0.010047435760498047, 0.010376514866948128, -0.010082444176077843, -0.014983631670475006, 0.025164099410176277, -0.02054297924041748, 0.006833656225353479, 0.019996847957372665, -0.0078138941898942, 0.016257939860224724, 0.011181710287928581, -0.005842916201800108, -0.023245634511113167, -0.008170980960130692, 0.006273520644754171, -0.0015246195252984762, -0.0070787156000733376, 0.02397381141781807, -0.02823084220290184, 0.031871724873781204, 0.004946698900312185, -0.04635123535990715, 0.03982565179467201, -0.00490818964317441, -0.006879167631268501, 0.009837384335696697, -0.023259637877345085, 0.0017267935909330845, 0.014605539850890636, 0.033020004630088806, 0.022265397012233734, -0.013548283837735653, 0.028174828737974167, -0.022027339786291122, 0.011804861016571522, 0.0188765749335289, -0.01019447110593319, 0.015991875901818275, -0.03181571140885353, 0.01094365306198597, 0.029099052771925926, -0.0027936771512031555, 0.010250484570860863, -0.009130213409662247, 0.023441681638360023, 0.022181376814842224, 0.008689106442034245, 0.01805037446320057, -0.004015473183244467, 0.014150429517030716, -0.02587827295064926, -0.002091757021844387, -0.04853576421737671, 0.017490239813923836, 0.02339967153966427, 0.041730113327503204, -0.017420222982764244, 0.0007745627663098276, -0.01579582877457142, -0.0039419555105268955, 0.021159129217267036, 0.02029091864824295, -0.031563650816679, 0.006147489883005619, 0.009228236973285675, 0.018512487411499023, 0.027446653693914413, -0.01186087541282177, -0.05004813149571419, 0.01803637109696865, 0.03215179219841957, -3.079652742599137e-05, -0.014017397537827492, -0.017336202785372734, 0.011755849234759808, -0.022657491266727448, 0.015935862436890602, 0.033776186406612396, -0.0009653589804656804, 0.002823434304445982, -0.0007395542343147099, -0.06587196886539459, -0.014276460744440556, -0.034196287393569946, -0.0018326942808926105, 0.027838747948408127, -0.001025748671963811, -0.023287644609808922, 0.044782854616642, -0.029351115226745605, 0.029715202748775482, 0.031703684478998184, -0.0008555198437534273, 0.0037914190907031298, -0.01736420951783657, 0.0464632622897625, 0.02629837393760681, 0.00980937760323286, 0.03694095462560654, 0.016229933127760887, -0.008416039869189262, 0.031031521037220955, -0.011426770128309727, -0.0007526824483647943, 0.012610056437551975, 0.03215179219841957, 0.021397186443209648, -0.010292494669556618, 0.02697053737938404, 0.008191986009478569, 0.02379176765680313, 0.004586111754179001, 0.03341209888458252, 0.038117241114377975, 0.0163559652864933, -0.008563075214624405, 0.031115541234612465, 0.029519155621528625, -0.014521519653499126, -0.0013399497838690877, 0.050916340202093124, 0.006063469685614109, 0.02681650035083294, -0.04290639981627464, -0.011160705238580704, 0.052064619958400726, 0.011223720386624336, -0.023259637877345085, 0.012098932638764381, 0.04654728248715401, -0.009032188914716244, -0.03926551714539528, -0.036212775856256485, 0.020991088822484016, -0.004355055745691061, 0.008493058383464813, -0.01395438238978386, 0.006634108256548643, 0.01847047731280327, 0.019744785502552986, 0.01185387372970581, -0.02213936671614647, 0.006809150334447622, -0.024701988324522972, -0.025654219090938568, -0.016818076372146606, -0.014066409319639206, 0.011307740584015846, 0.009760365821421146, 1.3846129149897024e-06, 0.0038019216153770685, -0.00818498432636261, 0.008682104758918285, 0.022335413843393326, 0.006406553089618683, -0.011083686724305153, -0.0028689454775303602, -0.007134729530662298, -0.007127727847546339, 0.015767822042107582, 0.017756303772330284, 0.01995483599603176, 0.03540058061480522, -0.003591870656237006, 0.02572423592209816, -0.005440318491309881, -0.013457261957228184, -0.017728297039866447, -0.015291706658899784, 0.027852751314640045, 0.029099052771925926, 0.006613102741539478, -0.009802375920116901, -0.014178437180817127, -0.0017574259545654058, 0.000529065728187561, 0.020416948944330215, 0.007778885308653116, 0.0012865618336945772, -0.03464439883828163, -0.00310175190679729, 0.03540058061480522, 0.048983871936798096, 0.0016103903762996197, -0.012540039606392384, 0.020416948944330215, 0.019842809066176414, 0.01786833070218563, -0.026284370571374893, -0.042542312294244766, -0.01928267441689968, 0.02111711911857128, 0.011006668210029602, -0.04444677382707596, -0.010572562925517559, 0.0008353900047950447, 0.031283583492040634, 0.008072956465184689, -0.006574593484401703, -0.0037389062345027924, -0.013135183602571487, -0.002543366514146328, 0.0029652188532054424, -0.010047435760498047, 0.010033432394266129, 0.009375272318720818, -0.02530413307249546, 0.013548283837735653, 0.019072623923420906, -0.018680527806282043, 0.005706383381038904, 0.016019882634282112, 0.02330164797604084, -0.0024680981878191233, 0.0541091151535511, -0.011699835769832134, -0.001592010841704905, 0.008451048284769058, 0.012343992479145527, 0.01440949272364378, 0.0003947206714656204, 0.005856919568032026, 0.01980079896748066, -0.006417055614292622, -0.010824623517692089, 0.020655006170272827, 0.02037493884563446, -0.00897617544978857, 0.03610074892640114, 0.004554604180157185, -0.0042640333995223045, -0.04719143733382225, 0.0246459748595953, 0.007484814152121544, -0.045819107443094254, 0.017252182587981224, 0.0295751690864563, -0.004004970658570528, -0.004204519093036652, -0.020598992705345154, -0.025108085945248604, -0.0127430884167552, 0.020010851323604584, 0.00287069589830935, 0.014675557613372803, -0.004789161030203104, 0.0026273869443684816, 0.021593233570456505, 0.008843143470585346, -0.04808765649795532, -0.012841112911701202, 0.004848675336688757, 0.0176162701100111, 0.0327119305729866, -0.0036793919280171394, -0.02331565134227276, -0.011251727119088173, 0.009718355722725391, -0.036800920963287354, -0.013772338628768921, -0.06211905553936958, -0.010138457641005516, 0.006606101058423519, 0.009592325426638126, 0.01621592976152897, 0.011545798741281033, 0.028846992179751396, -0.002373575232923031, -0.0067146276123821735, -0.0018572001717984676, 0.016972113400697708, -0.005475327372550964, -0.05455722287297249, 0.004705140367150307, 0.08715712279081345, -0.006931680254638195, -0.01569780521094799, -0.023749757558107376, 0.002830435987561941, 0.017266185954213142, 0.005083232186734676, 0.020094871520996094, -0.015991875901818275, -0.0335521325469017, -0.0254861768335104, 0.024575956165790558, -0.022839536890387535, 0.028342869132757187, 0.018834564834833145, 0.0006572843412868679, 0.026424404233694077, 0.025766246020793915, 0.016594022512435913, 0.017406219616532326, 0.017182163894176483, 0.026830503717064857, -0.006406553089618683, -0.03514852002263069, -0.0044600809924304485, 0.024926042184233665, 0.016075896099209785, -0.012554042972624302, 0.03114354982972145, 0.0037844174075871706, -0.0031612662132829428, -0.02246144413948059, -0.02262948453426361, 0.014276460744440556, -0.036548860371112823, -0.010740603320300579, -0.009921404533088207, 0.019156644120812416, -0.010670586489140987, 0.012680073268711567, 0.030135303735733032, 0.01652400568127632, 0.012708080001175404, -0.007127727847546339, 0.022321410477161407, 0.041225992143154144, -0.006217507179826498, 0.005709884222596884, 0.021089112386107445, -0.006557089276611805, 0.01880655810236931, 0.0066901217214763165, 0.033692166209220886, -0.01094365306198597, -0.01587984897196293, 0.025836262851953506, -0.044054679572582245, -0.00536329997703433, 0.038369301706552505, 0.020360935479402542, -0.04545501619577408, 0.023105600848793983, 0.011594810523092747, 0.012154946103692055, -0.013814348727464676, -0.020865056663751602, -0.027082564309239388, 0.018848568201065063, -0.0574699304997921, 0.020823046565055847, -0.016187923029065132, -0.0020567486062645912, -0.021663250401616096, -0.013457261957228184, 0.013338233344256878, 0.022321410477161407, -0.016341961920261383, 0.038201261311769485, 0.023763760924339294, -0.024015821516513824, 0.012133941054344177, 0.0014012146275490522, -0.03629679977893829, -0.015347720123827457, 0.02496805228292942, 0.013506273739039898, 0.016005879268050194, 0.02079503983259201, -0.009620332159101963, -0.019240664318203926, -0.01571180857717991, 0.008913160301744938, 0.07096920162439346, -0.014465506188571453, -0.0067321318201720715, 0.014717567712068558, -0.002329814713448286, 0.019156644120812416, -0.031171556562185287, -0.01139876339584589, -0.01721017248928547, -0.011930892243981361, -0.030415372923016548, 0.008948168717324734, -0.023035584017634392, 0.006228009704500437, 0.009620332159101963, -0.014535523019731045, 0.02096308209002018, 0.019604751840233803, -0.011447775177657604, -0.019758788868784904, 0.013009153306484222, 0.029267093166708946, 0.013933377340435982, 0.0397416315972805, 0.015557770617306232, 0.034952472895383835, 0.00019571931625250727, 0.00989339780062437, 0.006343537475913763, 0.018512487411499023, 0.00025643716799095273, 0.034028246998786926, -0.018764548003673553, 0.025542190298438072, -0.025430163368582726, 0.02698454074561596, -0.004547602497041225, 0.011139700189232826, -0.027334624901413918, 0.008871150203049183, 0.023931801319122314, 0.024449925869703293, -0.046323228627443314, 0.021061105653643608, -0.010824623517692089, -0.033272065222263336, -0.006014457903802395, -0.03500848636031151, 0.014885608106851578, 0.015361723490059376, 0.013184195384383202, 0.012238966301083565, 0.004243028350174427, 0.002429588930681348, -0.013499272055923939, 0.02656443975865841, 0.038285281509160995, 0.01478758454322815, -0.024772005155682564, 0.012519034557044506, 0.006707625929266214, 0.016257939860224724, 0.0021827791351825, -0.012505031190812588, 0.0022615480702370405, -0.019982842728495598, -0.021173132583498955, -0.026830503717064857, 0.018834564834833145, -0.04444677382707596, 0.009165221825242043, 0.03223581239581108, 0.00998441968113184, 0.05077630653977394, 0.0063820467330515385, 0.006592097692191601, 0.020655006170272827, 0.004190515726804733, 0.012995149940252304, 0.015193683095276356, 0.00613698735833168, -0.002912705997005105, -0.003091249382123351, -0.02162124030292034, -0.02264348790049553, 0.05077630653977394, 0.005034220404922962, 0.006679619196802378, -0.015249696560204029, 0.02229340374469757, -0.016243936493992805, 0.025108085945248604, 0.014521519653499126, 0.009879394434392452, 0.035372573882341385, 0.0017504242714494467, -0.002937211887910962, 0.009739360772073269, -0.025542190298438072, -0.06071871891617775, 0.026452410966157913, -0.006007456220686436, 0.014675557613372803, 0.022573471069335938, -0.024267882108688354, 0.014290464110672474, 0.007792889140546322, -0.0228115301579237, -0.0035533613990992308, -0.027936771512031555, 0.0028374376706779003, -0.025682225823402405, -0.019842809066176414, 0.00536329997703433, -0.024786008521914482, -0.0037108995020389557, 0.022517457604408264, 0.02764270082116127, -0.009046192280948162, -0.004950199741870165, 0.002567872405052185, 0.019268671050667763, 0.01911463402211666, 0.013891367241740227, -0.02538815326988697, -0.015263699926435947, -0.03282395750284195, -0.0030737449415028095, -0.018848568201065063, -0.016145912930369377, 0.02688651718199253, -0.015221689827740192, -0.01194489561021328, -0.0044355751015245914, 0.0411139652132988, 0.015263699926435947, -0.009039190597832203, 0.006448563188314438, 0.010082444176077843, -0.017658280208706856, 0.004039979074150324, 0.02180328406393528, -0.008626091293990612, 0.015053648501634598, 0.034112267196178436, -0.010166464373469353, -0.029463142156600952, 0.02631237730383873, -0.03758510947227478, 0.014927618205547333, 0.001484359847381711, -0.0044355751015245914, -0.0212851595133543, -0.005349296610802412, 0.0006454689428210258, 0.013968385756015778, -0.025752242654561996, 0.003920950461179018, 0.02680249698460102, -0.012596053071320057, 0.0031857721041888, -0.04332650080323219, 0.025262122973799706, -0.02454794943332672, 0.009837384335696697, -0.03215179219841957, -0.015109662897884846, 0.002445342717692256, -0.02414185181260109, -0.014003394171595573, 0.010047435760498047, 0.02012287825345993, -0.004278036765754223, -0.022419434040784836, -0.031003514304757118, -0.008836141787469387, -0.024169858545064926, 0.022433437407016754, -0.0037144003435969353, 0.01737821288406849, -0.012610056437551975, -0.023693742230534554, -0.023007577285170555, -0.02213936671614647, 0.02146720327436924, 0.006420556455850601, 0.01830243691802025, -0.038369301706552505, 0.0036443832796067, -0.005317789036780596, -0.02898702584207058, -0.029127059504389763, -0.024912038818001747, 0.011580807156860828, -0.02412784844636917, 0.00674263434484601, -0.00229830713942647, 0.014465506188571453, -0.00720474636182189, 0.017574260011315346, -0.00272541050799191, 0.0512804314494133, 0.005548845045268536, -0.013037160038948059, 0.023511698469519615, -0.03226381912827492, -0.013604297302663326, 0.015851842239499092, 0.01174184586852789, -0.019814802333712578, 0.007001697085797787, 0.01596386916935444, 0.04635123535990715, 0.0450909286737442, 0.0004050044226460159, 0.01702812686562538, -0.03234783932566643, 0.01838645711541176, -0.00143622315954417, 0.02271350473165512, 0.018736541271209717, -0.014290464110672474, -0.0019062120700255036, 0.04198217764496803, -0.02230740711092949, -0.016243936493992805, -0.04010572284460068, -0.008507061749696732, 0.01995483599603176, -0.0016348962672054768, -0.01653800904750824, 0.025822259485721588, 0.02146720327436924, 0.01286211796104908, -0.027712717652320862, 0.00482066860422492, -0.03089148737490177, -0.035540614277124405, 0.046827349811792374, 0.013415251858532429, 0.01879255473613739, 0.01604788936674595, 0.0340842604637146, 0.007246756460517645, -0.013793343678116798, 0.0032435362227261066, 0.01788233406841755, 0.0028286855667829514, -0.0008848394500091672, 0.01285511627793312, -0.004470583517104387, -0.007505819201469421, -0.014899611473083496, 0.02999527007341385, 0.008675103075802326, 0.027922768145799637, -0.008990178816020489, 0.03358013927936554, 0.01111169345676899, 0.024071834981441498, -0.021019095554947853, -0.025122089311480522, -0.031955745071172714, -0.02272750809788704, 0.0025031068362295628, -0.029379121959209442, -0.008535068482160568, 0.026242360472679138, -0.04248629882931709, -0.014507516287267208, -0.03856534883379936, 0.009403279051184654, -0.046071168035268784, 0.02814682200551033, -0.022433437407016754, -0.018008364364504814, -0.0008222617907449603, -0.006122983992099762, -0.028356874361634254, 0.014535523019731045, 0.020514972507953644, -0.003689894452691078, -0.01218995451927185, -0.016846083104610443, -0.03906947001814842, -0.03926551714539528, 0.01763027347624302, 0.019226660951972008, 0.008290009573101997, -0.035288553684949875, 0.009473295882344246, -0.0242258720099926, 0.03794919699430466, -0.014605539850890636, -0.03321605175733566, -0.010537554509937763, 0.011559802107512951]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" an important part of your dog’s training, so just keep at it and stay calm and
confident.
Multi-step RSO: Yes, you should scold any pet who messes in the house. Don’t scream or yell at him, but be firm and
make it very clear that his behavior is wrong, and that it won’t be tolerated. Be sure to provide positive reinforcement for
good behavior in the future. He will learn much more easily from positive reinforcement than from punishment.
Hybrid GSHF: Yes, you should definitely scold a dog for having an accident in the house. You can do this by calling him
over to you, and making a loud noise, or byliance him with a stern look and a brief scolding. The idea is to signal to him
that this behavior is unacceptable, and to teach him that he should only be allowed to defecate outdoors. You should be
very firm and clear, so that he gets the message. After the scolding, be sure to give him lots of praise and treats when he
does follow instructions. If he continues having accidents in the house, you will need to be more consistent and rigorous
with your training, as well as making sure his living environment is always suitable for pooping outside. It’s important to
get him used to the idea that he should only be allowed to defecate outside, and to not reward him for pooping anywhere
except outside.
Table 5: Randomly sampled examples of in-domain prompt from HH-RLHF dataset.
49
HH-RLHF Examples
Prompt :Human: How do I teach a 4 year old to read books? Assistant:
SFT: Can I ask what your goal for this is?
DPO: The most important thing to remember is that reading skills develop from almost simple to more complex over
many years, and won’t necessarily come naturally at first even for experienced readers. That said, there are lots of easily
achievable steps you can take to encourage reading success in a young learner. First, it’s important to pick books your
child is interested in. Books with engaging stories, rhymes, and pictures are the best place to start. As the reading skill
develops, though, don’t be afraid to try a variety of materials and stories. Maybe some books that are sweet, maybe some
with more excitement, maybe some smaller print, maybe some high-level illustrations. Read a few chapters together. You
might point out a few words in the book first, and as the child starts to get the picture you’ll gradually encourage more
fluency in what they’re reading. Then you want to practice reading to them. Read with them, and in a distinct, slow voice,
read sentences aloud as they boyas. Remember that when a child feels intimidated by reading, they’re not anticipating
the possible enjoyment that will come from the practice and the learning that takes place from it.
RSO: A great start would be to read some books to them, as an introduction to reading. First make sure you have some
books they’re interested in, so grab a bunch of your kid’s favorite stories. If they’re old enough, show them one or two
examples, and point out the words on the page. Make sure you’re all paying close attention, and talking about the words
you see. Then talk about the pictures in the books. Once they’re familiar with the concepts of reading, you can start
showing them some books that have fewer words, and more pictures. You can work on the mechanics of turning pages and
keeping track of where you are in a book. Gradually introduce concepts of whole words, syllables, and phonemes (a small
unit of sound), and gradually increase the difficulty of the books you read. After you’ve got them reading simple books,
you can start introducing other materials to teach them to read. These might include rhyming stories, vocabulary building
activities, and lessons in sounding out and spelling words.
Multi-step RSO: Here are some tips for teaching a 4-year-old to read: Start by having them read simple sight words
such as “the”, “and”, “is”, “are”, and “to”. Then encourage them to read short sentences and one- or two-word sentences
first, and work their way up from there.Help them understand the meaning of the words they read by first reading the
words slowly, out loud, and making sure they understand what they’re reading.Never correct or downplay their mistakes.
Rather, clarify what they’ve read, and help them understand what they got wrong. Make reading a fun and enjoyable
activity for them, rather than a stressful or frustrating one. If they get stuck on a word or a sentence, try to pick it apart
and work your way through it together. Or just re-read it several times","[0.024872833862900734, 0.030402962118387222, 0.04215129837393761, 0.04801272600889206, 0.02818581461906433, -0.018195904791355133, -0.023968135938048363, 0.012410932220518589, -0.011729223653674126, 0.059633638709783554, 0.03358852118253708, -0.00021602062042802572, -0.02256648987531662, 0.03279850259423256, -0.00965223927050829, -0.03177912160754204, 0.027727093547582626, -0.021457916125655174, -0.0037557724863290787, 0.056881316006183624, 0.0170745886862278, 0.012430045753717422, -0.008505438454449177, 0.04582105949521065, 0.009543931111693382, -0.009244488552212715, 0.056218720972537994, 0.030785229057073593, 0.0193936750292778, -0.005029995460063219, -0.028568081557750702, -0.0009803553111851215, -0.0742107480764389, -0.04699334502220154, 0.039679307490587234, -0.006619588937610388, -0.03200848400592804, -2.9914377591921948e-05, -0.013952742330729961, -0.023420220240950584, -0.009212632663547993, -0.03030102513730526, -0.01102202944457531, -0.05835941433906555, 0.0013100606156513095, 0.0729365274310112, 0.03973027318716049, -0.01836155354976654, -0.012538354843854904, 0.028287751600146294, -0.023649580776691437, 0.05575999990105629, -0.005014067515730858, 0.03695246949791908, 0.012442788109183311, -0.004619058687239885, -0.008473583497107029, -0.008932303637266159, -0.005039552226662636, 0.012385448440909386, 0.0545877143740654, -0.0011698959860950708, 0.016845228150486946, 0.017125558108091354, -0.024617988616228104, 0.01572391204535961, -0.02307618036866188, 0.0036665769293904305, 0.03817572444677353, 0.00944836437702179, 0.0385579913854599, -0.0018699223874136806, 0.03030102513730526, -0.0157366544008255, 0.0018890356877818704, -0.002519776113331318, 0.02175098843872547, 0.023139890283346176, 0.041514188051223755, -0.008231480605900288, 0.03715634346008301, -0.031014589592814445, -0.007186618167907, -0.006868062075227499, -0.028109360486268997, -0.015469067730009556, -0.04949082434177399, -0.03616245090961456, 0.05999042093753815, -0.10713667422533035, 0.049108557403087616, 0.03216138854622841, -0.0443684458732605, -0.029154224321246147, 0.04778336361050606, -0.08843108266592026, -0.05642259865999222, -0.01529067661613226, 0.05443480983376503, -0.009461105801165104, -8.909606549423188e-06, -0.01251924131065607, 0.030377477407455444, -0.03190654516220093, 0.030148116871714592, -0.03840508311986923, -0.012837797403335571, 0.039806727319955826, -0.002871780190616846, -0.03420014679431915, -0.0729365274310112, 0.0058168284595012665, -0.04495459049940109, -0.013748866505920887, 0.012340850196778774, -0.027370311319828033, -0.05361930653452873, -0.03934800624847412, -0.023025210946798325, 0.019329963251948357, 0.0023843899834901094, 0.03412369266152382, -0.04931243136525154, -0.012506498955190182, -0.000997079536318779, -0.014768245629966259, 0.03743667155504227, -0.05089246854186058, 0.0037175456527620554, 0.015774881467223167, 0.030657807365059853, -0.03295140713453293, 0.004013802390545607, -0.04814014583826065, -0.030199086293578148, -0.011372440494596958, -0.02979133464396, -0.034556929022073746, -0.022732138633728027, 0.03239075094461441, 0.01613166369497776, -0.022923272103071213, -0.05310961604118347, 0.0038640813436359167, -0.01926625333726406, 0.012047778815031052, 0.02191663719713688, -0.005835941527038813, -0.05479159206151962, -0.002159808063879609, 0.019712230190634727, 0.04194742441177368, -0.010117331519722939, -0.011958583258092403, 0.011671883054077625, 0.035882122814655304, 0.012888765893876553, -0.0014964157016947865, -0.02979133464396, -0.011620914563536644, -0.018960438668727875, -0.006982742343097925, 0.037309251725673676, 0.006574991159141064, 0.005612952634692192, 0.02647835575044155, 0.02663126215338707, -0.008550036698579788, -0.02401910535991192, 0.0279309693723917, -0.006568619981408119, 0.02139420434832573, 0.02989327348768711, -0.03697795420885086, 0.01679426059126854, -0.00884310808032751, -0.015392614528536797, -0.006409341935068369, -0.013162723742425442, -0.025153163820505142, -0.004921686369925737, 0.013213693164288998, -0.053211554884910583, 0.003943720366805792, 0.010512339882552624, -0.0035869379062205553, -0.03567824512720108, -0.023050695657730103, -0.03555082157254219, 0.024898318573832512, -0.047044314444065094, -0.023802487179636955, 0.03950091451406479, -0.044648777693510056, 0.009148921817541122, -0.04080062359571457, 0.06646347790956497, -0.026427386328577995, -0.03741119056940079, -0.032849472016096115, 0.0067024133168160915, 0.041794516146183014, -0.017507825046777725, -0.04276292398571968, 0.02452879399061203, -0.014054680243134499, -0.08766654878854752, 0.037079889327287674, -0.03137136995792389, -0.005788158159703016, 0.00659410422667861, 0.006855320185422897, 0.023700548335909843, 0.05677938088774681, -0.06615766137838364, 0.010448629036545753, 0.008288821205496788, -0.023636838421225548, 0.012092377059161663, -0.02399362064898014, -0.001807803986594081, -0.012723117135465145, 0.010149186477065086, -0.0068999179638922215, -0.025764789432287216, 0.009046983905136585, 0.029867788776755333, -0.02426120638847351, 0.03911864757537842, -0.020795321092009544, 0.02101193740963936, 0.020629670470952988, 0.04574460908770561, 0.001291743596084416, 0.050433747470378876, 0.00357419578358531, -0.015978757292032242, -0.039271555840969086, -0.0005495086661539972, 0.0017727628583088517, 0.0033798767253756523, 0.03055586852133274, 0.016883455216884613, -0.005119191017001867, 0.005517385900020599, 0.017023619264364243, -0.029612943530082703, -0.0804799273610115, 0.04735012724995613, -0.013213693164288998, 0.05387414991855621, -0.05196281522512436, 0.05025535821914673, 0.0077727604657411575, -0.04829305410385132, 0.018578171730041504, 0.029816819354891777, -0.045591700822114944, -0.028695503249764442, -0.030148116871714592, 0.0078109875321388245, -0.009295457042753696, 0.03081071376800537, -0.03527049347758293, -0.00679160887375474, 0.018845759332180023, -0.025153163820505142, 0.006017518229782581, -0.01768621616065502, -0.02691159024834633, -0.03906767815351486, -0.0007143613183870912, 0.01402919553220272, 0.005644808057695627, -0.039551883935928345, -0.02150888554751873, -0.006969999987632036, -0.017890091985464096, -0.027497733011841774, 0.015125027857720852, -0.01074807159602642, 0.05117279663681984, -0.01304804440587759, 0.007339524570852518, 0.03070877492427826, 0.062385961413383484, -0.04811466112732887, 0.003319351002573967, -0.009862486273050308, 0.03552534058690071, 0.012149716727435589, -0.027370311319828033, 0.062946617603302, -0.012404561042785645, -0.0182341318577528, -0.03886380419135094, -0.019610293209552765, 0.019967075437307358, -0.0035518966615200043, 0.03659568727016449, 0.03544888645410538, 0.03924607113003731, -0.020540475845336914, 0.014870182611048222, -0.014844698831439018, -0.011397925205528736, 0.02833872102200985, -0.03070877492427826, 0.03137136995792389, -0.0004634986398741603, 0.02703901380300522, 0.0036856902297586203, 0.010193784721195698, 0.004998140037059784, 0.029332615435123444, -0.057645849883556366, 0.01861639879643917, -0.03432757034897804, 0.011843902990221977, -0.04398617893457413, -0.018590914085507393, -0.0010225640144199133, 0.0157366544008255, 0.002706131199374795, -0.005007696803659201, -0.0335630364716053, 0.036264389753341675, 0.02544623427093029, 0.0030055735260248184, 0.009308199398219585, -0.008900447748601437, -0.007078309077769518, -0.010779927484691143, 0.06269177794456482, -0.042941316962242126, -0.06962354481220245, 0.0051223766058683395, -0.006256435066461563, 0.019317220896482468, 0.04301777109503746, -0.024630730971693993, -0.018144937232136726, -0.037054404616355896, 0.03527049347758293, -0.04444490000605583, 0.02805839106440544, -0.029867788776755333, 0.01613166369497776, 0.04875177517533302, 0.021878410130739212, 0.009142550639808178, 0.02989327348768711, 0.009492961689829826, -0.010677989572286606, 0.01822138950228691, 0.03583115339279175, -0.0033894332591444254, -0.01628457009792328, 0.005288025829941034, 0.01042951550334692, 0.004498007241636515, -0.0011468006996437907, -0.009938939474523067, 0.030504899099469185, -0.04602493718266487, 0.0485478974878788, -0.0063743009231984615, -0.040979012846946716, -0.027446765452623367, -0.01717652752995491, -0.012410932220518589, 0.017928319051861763, -0.04462329298257828, 0.02008175477385521, -0.0366976223886013, 0.03756409510970116, 0.02507670968770981, -0.022235192358493805, 0.012232541106641293, 0.0545877143740654, 0.00589965283870697, 0.02297424152493477, 0.018285101279616356, -0.023636838421225548, 0.014780987054109573, 0.001380939269438386, -0.06554603576660156, -0.004195379558950663, 0.00023732404224574566, 0.009301828220486641, -0.04383327439427376, 0.01028935145586729, -0.01992884837090969, 0.0433235839009285, 0.00016544990648981184, -0.009206261485815048, -0.05310961604118347, 0.07370106130838394, 0.04340003803372383, 0.027115466073155403, 0.036009542644023895, 0.009327312931418419, -0.03002069517970085, 0.027752578258514404, -0.007237587124109268, -0.0004392087575979531, -0.029587458819150925, 0.01475550327450037, -0.0028749657794833183, -0.01797928661108017, 0.05048471689224243, 0.009569414891302586, 0.04271195828914642, 0.0036984323523938656, -0.031243950128555298, -0.0351940393447876, 0.0029179707635194063, -0.015099543146789074, -0.009715951047837734, -0.009340055286884308, -0.01822138950228691, -0.03919510170817375, -0.05038277804851532, -0.039679307490587234, -0.012697632424533367, 0.08608651161193848, 0.022630201652646065, -0.015035832300782204, -0.026682231575250626, -0.02400636300444603, 0.003835411509498954, 0.018425265327095985, -0.009225375019013882, 0.01120679173618555, -0.0038067414425313473, -0.0545877143740654, -0.041259340941905975, 0.004373770672827959, 0.032467205077409744, -0.0387873500585556, 0.0537722110748291, -0.004883459769189358, 0.037844423204660416, -0.029026800766587257, -0.030428446829319, -0.020948227494955063, -0.030657807365059853, 0.04862435162067413, -0.01785186491906643, -0.0012216613395139575, -0.023777002468705177, -0.04974566772580147, -0.018157677724957466, 0.008906818926334381, 0.03939897567033768, -0.008530923165380955, 0.06401696801185608, -0.07568884640932083, 0.04490362107753754, 0.00949933286756277, 0.013264661654829979, 0.016042469069361687, 0.03883831948041916, -0.003222191473469138, -0.019177056849002838, 0.028822924941778183, 0.033512067049741745, 0.01193946972489357, 0.031065557152032852, -0.057645849883556366, 0.02520413137972355, -0.01015555765479803, 0.028262266889214516, -0.025255100801587105, -0.030989104881882668, -0.03231429681181908, -0.03677407652139664, -0.02045127935707569, -0.03514307364821434, -0.006759753450751305, 0.0053899637423455715, 0.0010679581901058555, 0.0443684458732605, 0.005405891221016645, 0.05142764374613762, -0.03764054924249649, -0.006262806244194508, -0.011627285741269588, 0.003930978011339903, 0.017418628558516502, -0.053721245378255844, -0.0027443578001111746, 0.033129800111055374, -0.012684890069067478, -0.025153163820505142, 0.013889031484723091, 0.06345631182193756, 0.001720201107673347, -0.005762673914432526, 0.0021199886687099934, 0.029434552416205406, -0.022591974586248398, -0.03687601536512375, 0.06834932416677475, -0.024898318573832512, 0.00826333649456501, 0.046483658254146576, -0.005956992972642183, 0.007619854062795639, 0.010066362097859383, -0.030148116871714592, 0.000843376386910677, -0.01902415044605732, -0.0006868858472444117, -0.017915576696395874, -0.012372706085443497, 0.023178117349743843, 0.0043801418505609035, -0.023560384288430214, 0.015201481059193611, 0.01847623474895954, -0.002048313617706299, 0.01306078676134348, -0.0073586381040513515, -0.0019861951004713774, -0.013328373432159424, -0.03883831948041916, -0.03369045630097389, -0.012525612488389015, 0.0018428451148793101, -0.04819111526012421, -0.049388885498046875, -0.010455000214278698, 0.01890946924686432, -0.06309952586889267, -0.003212634939700365, -0.017762670293450356, -0.03618793562054634, -0.035856638103723526, -0.016080694273114204, 0.006810722406953573, 0.022897787392139435, 0.03690150007605553, 0.010448629036545753, 0.011729223653674126, 0.006919031031429768, 0.016208117827773094, 0.022757623344659805, -0.01679426059126854, 0.027370311319828033, 0.029434552416205406, -0.0485478974878788, -0.027191920205950737, -0.018960438668727875, 0.0025293328799307346, 0.02059144526720047, 0.016055209562182426, -0.040341902524232864, 0.003937349189072847, -0.021177588030695915, -0.023025210946798325, -0.014475174248218536, -0.007486060261726379, 0.005593839101493359, -0.009703208692371845, 0.008588263764977455, -0.010920091532170773, -0.004472522996366024, -0.01515051256865263, 0.026988044381141663, 0.0063902284018695354, -0.03305334597826004, -0.00714839156717062, -0.05835941433906555, -0.014628080651164055, -0.00983700156211853, -0.020119981840252876, 0.032976891845464706, 0.03865992650389671, -0.009199890308082104, -0.014577112160623074, -0.032874953001737595, -0.006259620655328035, -0.007161133456975222, -0.024758154526352882, -0.012754973024129868, 0.02150888554751873, 0.04839499294757843, 0.026682231575250626, -0.018068483099341393, 0.008365274406969547, -0.020680639892816544, -0.006625960115343332, -0.015099543146789074, -0.03493919596076012, -0.007199360057711601, -0.024210238829255104, -0.018055740743875504, -0.04001060500741005, -0.030250055715441704, 0.006868062075227499, -0.001272630295716226, 0.02283407747745514, -0.007887440733611584, -0.0034658866934478283, -0.007180246990174055, -0.05351736769080162, -0.03032650798559189, 0.04681495577096939, 0.005262541119009256, 0.0039946893230080605, -0.003943720366805792, -0.004501192830502987, -0.024719927459955215, -0.03149879351258278, -0.028364205732941628, -0.007830101065337658, -0.007760018575936556, -0.014373236335814, 0.01574939675629139, -0.011079369112849236, -0.025114936754107475, 0.010525082238018513, -0.019635777920484543, 0.03738570585846901, -0.024248464033007622, -0.004083884879946709, -0.00725032901391387, -0.018973181024193764, -0.025509946048259735, -0.015520037151873112, -0.014768245629966259, 0.02976584993302822, -0.029026800766587257, -0.00554287014529109, -0.0042367917485535145, 0.008409871719777584, 0.009715951047837734, -0.024222981184720993, 0.024949287995696068, 0.061468519270420074, 0.007282184902578592, -0.004676398821175098, -0.020145466551184654, 0.029409067705273628, -0.003972390200942755, 0.010270237922668457, 0.025611883029341698, -0.00574037479236722, -0.0218911524862051, 0.0006725508719682693, 0.00550464354455471, 0.028822924941778183, 0.006259620655328035, 0.027242889627814293, -0.0006673743482679129, -0.02046402171254158, 0.005192459095269442, -0.048726290464401245, -0.01638650894165039, 0.012621179223060608, -0.00459675956517458, 0.01095831859856844, -0.0259559229016304, 0.015685684978961945, -0.0015728691359981894, 0.01915157213807106, 0.0049057588912546635, -0.020655155181884766, -0.008588263764977455, -0.0437823049724102, 0.02454153634607792, 0.008441727608442307, 0.009620384313166142, -0.025879470631480217, -0.02428669109940529, 0.009174405597150326, -0.00472736731171608, -0.01050596870481968, 0.03397078812122345, -0.031422339379787445, -0.007537029217928648, -0.005367664620280266, -0.02387893944978714, 0.009333684109151363, 0.007963893935084343, 0.004660470876842737, -0.04671301692724228, -0.01902415044605732, -0.00046429503709077835, -0.011315100826323032, -0.03470983728766441, 0.014526142738759518, 0.0009230153518728912, 0.013939999975264072, 0.03226332738995552, 0.005358107853680849, -0.0022617459762841463, 0.01836155354976654, -0.10469016432762146, 0.024095557630062103, -0.02795645408332348, 0.013761608861386776, -0.03687601536512375, -0.0019049635156989098, -0.016208117827773094, -0.03175363689661026, 0.02217148058116436, -0.02568833716213703, 0.019100602716207504, -0.025815758854150772, 0.011245018802583218, -0.01286328211426735, 0.022528262808918953, -0.0406477153301239, -0.007651709485799074, 0.03644277900457382, 0.013290146365761757, -0.02256648987531662, 0.029612943530082703, -0.028771957382559776, 0.0010647726012393832, 0.02376426011323929, -0.019253510981798172, -0.0015402170829474926, 0.030351992696523666, -0.014717276208102703, -0.04686592519283295, -0.045082010328769684, 0.0279309693723917, 0.01076081395149231, 0.03369045630097389, -0.006721526384353638, -0.01615714840590954, -0.029409067705273628, 0.027599671855568886, -0.04719722270965576, -0.0016047246754169464, -0.001752056647092104, -0.029307130724191666, -0.00036016711965203285, -0.02688610553741455, -0.00471781101077795, 0.0243886299431324, -0.011550831608474255, -0.0028096619062125683, 0.011410667560994625, 0.03241623565554619, 0.003430845681577921, -0.013672413304448128, -0.010066362097859383, 0.010569680482149124, -0.007052824832499027, -0.030504899099469185, 0.017265722155570984, 0.00390230817720294, 0.0012407747562974691, 0.02190389484167099, -0.020960969850420952, 0.002808069111779332, 0.02910325489938259, 0.015074058435857296, -0.013939999975264072, 0.008320676162838936, 0.004768779966980219, 0.013838062062859535, 0.0016612682957202196, 0.009715951047837734, -0.023318281397223473, 0.05198829993605614, -0.034556929022073746, -0.009257230907678604, 0.041769031435251236, 0.012735859490931034, 0.013710640370845795, -0.028797440230846405, -0.013608702458441257, -0.007696307264268398, -0.024184754118323326, 0.0002671886468306184, -0.017023619264364243, -0.018297843635082245, -0.002565966686233878, 0.009614013135433197, -0.0025818943977355957, 0.003542340127751231, -0.03384336456656456, 0.023025210946798325, -0.019228026270866394, -0.04370585083961487, -0.02111387625336647, -0.022082285955548286, -0.02780354768037796, -0.005195644684135914, -0.008945045992732048, -0.0069445157423615456, -0.022337129339575768, -0.06661637872457504, 0.02347118780016899, 0.017354918643832207, -0.0012877617264166474, 0.001906556193716824, 0.009320941753685474, 0.05010244995355606, 0.010206527076661587, 0.00065662304405123, -0.024210238829255104, -0.0377424880862236, -0.002553224330767989, 0.006785237696021795, -0.04788530245423317, 0.03761506453156471, -0.036009542644023895, -0.007906554266810417, -0.023534899577498436, -0.002666311804205179, -0.027115466073155403, 0.0017902833642438054, -0.0341491773724556, -0.0033448354806751013, -0.01312449760735035, -0.015010347589850426, 0.0003211440343875438, 0.0014303154312074184, -0.003988318145275116, -0.03799733147025108, 0.031804606318473816, 0.012219798751175404, 0.009607641957700253, 0.0038545248098671436, 0.0017902833642438054, -0.032441720366477966, -0.034684352576732635, -0.017354918643832207, -0.0013777536805719137, 0.02688610553741455, -0.007428720593452454, 0.027064498513936996, -0.044139087200164795, -0.02269391342997551, -0.026554808020591736, 0.028822924941778183, -0.009779661893844604, -0.011315100826323032, 0.01943190209567547, 0.03677407652139664, -0.0014056273503229022, 0.006520836614072323, 0.0010775148402899504, -0.010900977998971939, 0.012633921578526497, -0.018973181024193764, 0.02032385766506195, -0.015061316080391407, -0.044139087200164795, 0.02335650846362114, 0.012767715379595757, -0.019737714901566505, -0.014870182611048222, -0.01003450620919466, -0.010219268500804901, 0.007097422610968351, -0.04826756939291954, 0.0006371115450747311, -0.019240768626332283, 0.0012344035785645247, -0.01811945252120495, -0.035219524055719376, 0.0061449408531188965, -0.018820274621248245, 0.01755879446864128, -0.006581361871212721, -0.0036793190520256758, 0.016029726713895798, 0.04238065704703331, -0.03241623565554619, 0.005268912296742201, -0.01035306230187416, -0.009225375019013882, 0.007887440733611584, 0.013608702458441257, -0.0006227765115909278, 0.005756302736699581, 0.02739579603075981, 0.024337660521268845, -0.03817572444677353, 0.030453931540250778, -0.002005308633670211, 0.031932029873132706, 0.01627182774245739, 0.028287751600146294, -0.020158208906650543, 0.04011254012584686, 0.02215873822569847, -0.04238065704703331, 0.05835941433906555, -0.0014446503482758999, -0.05012793466448784, 0.0093782814219594, -0.03068329207599163, -0.01732943393290043, 0.021878410130739212, 0.01981416903436184, 0.04431747645139694, 0.032339781522750854, 0.003190336050465703, -0.03807378560304642, 0.006683299783617258, 0.01746959798038006, 0.01404193788766861, 0.009607641957700253, -0.011518976651132107, 0.047044314444065094, 0.04630526527762413, 0.04036738723516464, -0.030504899099469185, -0.01810671016573906, 0.008244222961366177, 0.010983802378177643, -0.003220598679035902, 0.022859562188386917, -0.018960438668727875, -0.01483195647597313, -0.016717806458473206, 0.01404193788766861, -0.02401910535991192, 0.014933894388377666, 0.047808848321437836, -0.01745685562491417, 0.0056479936465620995, 0.01535438746213913, -0.0061321984976530075, 0.013073528185486794, 0.02163630723953247, 0.06162142753601074, -0.04671301692724228, 0.0383286289870739, -0.0011045921128243208, 0.0289758313447237, 0.04582105949521065, 0.01720201037824154, -0.05453674495220184, 0.031804606318473816, 0.04345100745558739, 0.0011364476522430778, 0.01824687421321869, 0.019228026270866394, 0.004660470876842737, 0.004822934046387672, 0.02635093219578266, -0.008288821205496788, 0.02739579603075981, -0.005765859503298998, -0.00013100606156513095, -0.03970479220151901, -0.00521475775167346, -0.018527202308177948, 4.1611347114667296e-05, 0.019992560148239136, 0.00416352367028594, -0.026835137978196144, 0.03002069517970085, -0.016845228150486946, 0.027829032391309738, 0.0202091783285141, -0.009989908896386623, -0.018017513677477837, 0.0021295452024787664, 0.03840508311986923, 0.04148870334029198, -0.020935485139489174, 0.05412899702787399, -0.019737714901566505, -0.02805839106440544, 0.006676928605884314, -0.015825850889086723, 0.010410401970148087, -0.001587204053066671, 0.03812475502490997, 0.0152142234146595, 0.02506396733224392, 0.009817888960242271, -0.018144937232136726, -0.008632861077785492, 0.00698911352083087, 0.006868062075227499, 0.03794636204838753, -0.026147056370973587, 0.007492431439459324, 0.009008756838738918, 0.02166179195046425, 0.0009182369685731828, -0.014806471765041351, 0.030734259635210037, -0.0007748868665657938, 0.02912873961031437, 0.00020726033835671842, -0.0554032176733017, 0.03470983728766441, 0.007766389288008213, -0.011327843181788921, -0.03302786126732826, 0.027625156566500664, 0.009817888960242271, -0.03149879351258278, -0.0027905486058443785, 0.034582413733005524, -0.0039692046120762825, 0.0073713804595172405, -0.04182000085711479, 0.006052559707313776, 0.009110694751143456, -0.0025595955085009336, 0.008874963968992233, -0.026006892323493958, -0.028568081557750702, -0.035245008766651154, -0.06880804151296616, -0.006122641731053591, -0.006562248803675175, 0.006103528663516045, -0.02203131653368473, 0.007122906856238842, 0.004233606159687042, -0.006912659853696823, 0.00904061272740364, 0.014054680243134499, 0.04143773391842842, 0.0035710101947188377, -0.0008680644677951932, -0.0009819481056183577, 0.0012567024677991867, 0.026427386328577995, 0.014003711752593517, 0.015621975064277649, 0.05494449660181999, -0.0177117008715868, 0.03843056783080101, -0.03674859181046486, -0.029205191880464554, -0.010875494219362736, -0.013200950808823109, 0.030504899099469185, -0.002565966686233878, -0.009212632663547993, -0.028491627424955368, -0.027778062969446182, -0.01042951550334692, 0.02691159024834633, 0.025764789432287216, -0.00022856376017443836, -0.020910000428557396, -0.005119191017001867, -0.005864611826837063, 0.0479617565870285, 0.003867266932502389, -0.00350729888305068, 0.010142815299332142, 0.022528262808918953, 0.022897787392139435, 0.0016373766120523214, -0.030861683189868927, -0.009741434827446938, -0.004972655326128006, 0.024235721677541733, 0.024031847715377808, -0.04092804342508316, -0.01128324493765831, -0.012659406289458275, 0.0066323308274149895, 0.004883459769189358, -0.03725828230381012, -0.028440658003091812, 0.012003181502223015, -0.012602065689861774, 0.0007585608982481062, 0.00407114252448082, 0.008205996826291084, -0.0006558267050422728, -0.027574187144637108, 0.01279319915920496, 0.015953272581100464, -0.0035933090839535, -0.020782578736543655, 0.008970530703663826, 0.004861161112785339, 0.010314835235476494, 0.021865667775273323, -0.020489506423473358, -0.021865667775273323, 0.031167495995759964, 0.005093706771731377, 0.004899387713521719, 0.029205191880464554, -0.0026567550376057625, 0.02544623427093029, 0.012837797403335571, -0.02101193740963936, 0.013149982318282127, -0.0069572580978274345, -0.007626224774867296, 0.02296149916946888, -0.005950621794909239, 0.0004579239175654948, -0.04424102604389191, 0.012551097199320793, 0.01488292496651411, -0.024210238829255104, 0.03539791703224182, -0.003959648311138153, 0.014857441186904907, 0.001895406749099493, -0.008307934738695621, -0.015023089945316315, 0.00419219397008419, 0.01795380376279354, -0.028670018538832664, -0.007670823018997908, 0.012308994308114052, -0.004803820978850126, 0.006969999987632036, -0.0012224577367305756, -0.033002376556396484, -0.02401910535991192, 0.001798247336409986, -0.01450065802782774, 0.03139685466885567, 0.00032413049484603107, -0.008811252191662788, -0.00655587762594223, -0.010544195771217346, -0.01730394922196865, -0.024949287995696068, -0.040469326078891754, -0.003529597772285342, 0.03305334597826004, 0.01901140809059143, -0.014373236335814, 0.0016405622009187937, 0.04536234214901924, -0.005068222060799599, 0.016208117827773094, 0.021712761372327805, 0.020362084731459618, -0.024184754118323326, -0.036417294293642044, 0.025344297289848328, 0.08567875623703003, -0.0025054411962628365, -0.01769895851612091, 0.007689936086535454, 0.016603127121925354, 0.01363418623805046, 0.015163253992795944, 0.004482079762965441, -0.03514307364821434, -0.045591700822114944, -0.011232276447117329, 0.023929908871650696, -0.009352797642350197, 0.015953272581100464, 2.8993552405154333e-05, -0.008989643305540085, 0.014335009269416332, 0.006536764092743397, 0.0012997075682505965, 0.018820274621248245, 0.01318820845335722, 0.010837267152965069, 0.022528262808918953, -0.045872028917074203, -0.018068483099341393, 0.027191920205950737, 0.03603502735495567, 0.0001879478950286284, 0.039042193442583084, 0.020910000428557396, 0.01889672875404358, -0.02795645408332348, 0.027829032391309738, 0.015392614528536797, -0.051070861518383026, -0.020948227494955063, -0.011270502582192421, 0.005679849069565535, -0.01529067661613226, 0.04740109667181969, 0.00839713029563427, 0.024426855146884918, 0.02268117107450962, 0.006138569675385952, 0.028109360486268997, 0.03973027318716049, -0.008205996826291084, 0.004042472690343857, 0.021559854969382286, 0.017291206866502762, 0.0356527604162693, 0.01768621616065502, 0.008180512115359306, -0.026529323309659958, -0.04036738723516464, 0.022209707647562027, -0.0257265642285347, 0.015838593244552612, 0.05560709536075592, 0.006501723080873489, -0.017125558108091354, 0.009779661893844604, 0.005714890547096729, -0.02426120638847351, -0.011245018802583218, -0.005125562194734812, 0.009556672535836697, 0.026427386328577995, -0.03674859181046486, -0.011703738942742348, -0.03315528482198715, 0.0004376159922685474, -0.037028923630714417, 0.02846614271402359, 0.008766654878854752, 0.028517112135887146, -0.017010876908898354, 0.031702671200037, 0.02426120638847351, -0.008753912523388863, -0.0028670018073171377, -0.012723117135465145, -0.04543879255652428, -0.006367929745465517, 0.03132040426135063, -0.011952212080359459, 0.018692852929234505, 0.01653941534459591, 0.002320678671821952, -0.015418099239468575, -0.012353592552244663, -0.005867796950042248, 0.05216669291257858, -0.01968674547970295, 0.011181307025253773, -0.009792404249310493, 0.015469067730009556, 0.02412104234099388, -0.022375356405973434, 0.011448893696069717, -0.002763471333310008, -0.020629670470952988, -0.04416457191109657, 0.026860622689127922, -0.009244488552212715, -0.007766389288008213, -0.009620384313166142, 0.001850808970630169, 0.005211572162806988, -0.014309524558484554, -0.007441462483257055, -0.03603502735495567, -0.022872304543852806, 0.014398720115423203, 0.013544990681111813, 0.033792395144701004, 0.014933894388377666, 0.03213590383529663, 0.00925085972994566, -0.00904061272740364, -0.006766124628484249, 0.0039660194888710976, 0.01862914115190506, 0.0033289077691733837, -0.010257495567202568, 0.01396548468619585, -0.009887970983982086, 0.02770160883665085, 0.007492431439459324, -0.0023047509603202343, -0.013761608861386776, 0.009996280074119568, -0.0006984334904700518, -0.001228032517246902, -0.006412527523934841, 0.011111225001513958, 0.007084680255502462, 0.010646133683621883, 0.002484734868630767, -0.025484461337327957, 0.025675594806671143, 0.009429250843822956, -0.0017727628583088517, 0.014997605234384537, 0.0032413050066679716, 0.003373505547642708, 0.006297847256064415, 0.012035036459565163, 0.02818581461906433, 0.046381719410419464, -0.01874382048845291, 0.01363418623805046, 0.0247963797301054, 0.021062906831502914, 0.048496928066015244, 0.012837797403335571, -0.017813637852668762, -0.0071420203894376755, -0.007275813724845648, -0.012436416931450367, -0.003110697027295828, -0.02031111530959606, 0.008352532051503658, 0.026045119389891624, 0.0028399245347827673, 0.025471718981862068, 0.01652667298913002, 0.023802487179636955, 0.009015128016471863, 0.03690150007605553, -0.0035678246058523655, 0.02334376610815525, 0.0029195635579526424, -0.00884310808032751, -0.010850009508430958, -0.008690201677381992, -0.025025740265846252, 0.051886361092329025, 0.01436049398034811, 0.010136444121599197, -0.011104853823781013, 0.00945473462343216, 0.009563043713569641, -0.006093971896916628, -0.004431110806763172, 0.038099270313978195, 0.001107777701690793, -0.0011452080216258764, -0.008307934738695621, -0.0041380394250154495, -0.011761078611016273, -0.0485478974878788, 0.03002069517970085, 0.00039401365211233497, 0.002135916380211711, 0.004010617267340422, -0.0025548171252012253, -0.01954658143222332, 0.006514465436339378, -0.016080694273114204, -0.02492380328476429, -0.04411360248923302, 0.027752578258514404, -0.029307130724191666, -0.019368190318346024, 0.010455000214278698, -0.03399627283215523, 0.0026233068201690912, -0.002957790158689022, 0.0016469332622364163, -0.03109104186296463, 0.004571275319904089, 0.005558798089623451, 0.022732138633728027, 0.033104315400123596, 0.031294919550418854, -0.011722852475941181, -0.01968674547970295, -0.013672413304448128, -0.0018810718320310116, 0.0021980346646159887, -0.017902834340929985, 0.005399520043283701, -0.022744880989193916, -0.004198565147817135, 0.010881864465773106, 0.016080694273114204, 0.01627182774245739, 0.002432173350825906, 0.010556938126683235, 0.0033703199587762356, -0.025790274143218994, 0.004469337407499552, 0.020795321092009544, -0.0028112547006458044, 0.015838593244552612, 0.0073713804595172405, -0.021827440708875656, -0.008148656226694584, -0.005335809197276831, -0.006517651025205851, 0.018794789910316467, -0.02596866525709629, -0.024350402876734734, -0.014921152032911777, 0.039832212030887604, -0.007779131643474102, 0.016603127121925354, -0.03139685466885567, 0.004198565147817135, 0.03738570585846901, -0.04498007521033287, 0.0014526143204420805, -0.05723809823393822, 0.024617988616228104, -0.028644533827900887, -0.021470658481121063, -0.0121943149715662, -0.018183162435889244, 0.028415173292160034, -0.0075434003956615925, -0.018170420080423355, 0.008492697030305862, 0.03753861039876938, 0.0025771160144358873, -0.022209707647562027, 0.0158513356000185, -0.02034934237599373, -0.005985662806779146, 0.012876023538410664, -0.014640823006629944, 0.018680110573768616, -0.020425794646143913, 0.00925085972994566, 0.0009190333657898009, -0.00034782307920977473, 0.018667368218302727, 0.02558639831840992, 0.0011579501442611217, -0.04533685743808746, -0.0009580564801581204, -0.03318076953291893, -0.00760711170732975, -0.011455264873802662, -0.005141490139067173, 0.02742128074169159, -0.012283510528504848, 0.015660202130675316, -0.0171892698854208, -6.763088094885461e-06, -0.007957522757351398, 0.018947696313261986, -0.024031847715377808, 0.029740365222096443, 0.004456595052033663, -0.004179451614618301, 0.020030787214636803, -0.02005627006292343, 0.008836736902594566, 0.005224314518272877, 0.01199681032449007, 0.0023700548335909843, 0.005698962602764368, 0.007951151579618454, 0.024439597502350807, 0.055046435445547104, 0.017533309757709503, -0.007352266926318407, -0.023292796686291695, -0.008148656226694584, -0.00521475775167346, 0.03004617989063263, 0.00047823184286244214, -0.009938939474523067, -0.01732943393290043, 0.03346109762787819, -0.022859562188386917, -0.028160329908132553, 0.01148074958473444, 0.029205191880464554, 0.0182341318577528, 0.027981938794255257, 0.004937614314258099, 0.008123171515762806, -0.004195379558950663, 0.015392614528536797, -0.03481177240610123, -0.0027586929500102997, -0.020757094025611877, -0.0015545521164312959, 0.04630526527762413, 0.039679307490587234, 0.041921939700841904, 0.00814228504896164, 0.010601535439491272, -0.018068483099341393, -0.005539684556424618, 0.0007661266135983169, -0.012481015175580978, 0.015838593244552612, -0.032441720366477966, 0.02008175477385521, -0.006785237696021795, -0.01036580465734005, 0.007989378646016121, 0.004832490812987089, 0.016080694273114204, 0.012946106493473053, 0.002027607522904873, -0.0012766121653839946, -0.002508626552298665, 0.013392084278166294, -0.025930440053343773, -0.02568833716213703, 1.3974145076645073e-05, -0.00583275593817234, 0.023917166516184807, -0.03580566868185997, -0.0049630990251898766, 0.0377424880862236, -0.03516855463385582, 0.007441462483257055, -0.008894076570868492, -0.0017950617475435138, -0.03307883068919182, -0.004316430538892746, -0.0078109875321388245, -0.006613217759877443, 0.027115466073155403, 0.008511809632182121, -0.005338994786143303, 0.01443694718182087, 0.02085903100669384, -0.0038099270313978195, -0.01769895851612091, -0.02256648987531662, -0.0506376251578331, -0.016832485795021057, 0.01824687421321869, 0.011346956714987755, -0.014589853584766388, -0.011735593900084496, 0.012340850196778774, -0.023025210946798325, 0.028822924941778183, -0.0026010076981037855, -0.02283407747745514, 0.006912659853696823, -0.018272358924150467]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
". Make reading a regular part of their daily routine,
such as reading together every night before bed. Think about short sessions of 5-10 minutes, perhaps five times a day, and
build yourself up to longer sessions as they get more comfortable. Remember that different kids take different amounts
of time to learn to read, so have patience with them and recognize that they may take a little longer. But always stay
positive, and keep trying to help them. Hope this helps! Good luck with your teaching! Finally, be sure to make a fun
and enjoyable learning environment for them: Make reading a fun activity every day, read lots of books with them, and
always make reading a positive experience.Ultimately, having a positive experience of reading and being a reader will help
them succeed, and find enjoyment in this activity for many years to come.
Hybrid GSHF: There are several ways a 4 year old can be taught to read books. Here are a few suggestions I’d give: 1.
Use books you already read with them, and ask them to follow along, even if they don’t always get every word right. Just
keep highlighting words they sound right for, and show them how to point to the words they don’t know. 2. Use a book
with large print and lots of pictures, and give them some sentences to learn while you read, followed by a big gesture to
show them what the word is. Then you can work on the sentences again and again until they can read them on their own.
3. Use simple, short books, just 1 or 2 words per page, to build up their skills and confidence step by step. 4. Work with
them in 5 minute chunks. Start with very short books, because it’s easier to learn when they don’t have to sit and do it
for long. Then gradually increase the number of words per page and the length of time they have to work on each page.
5. Work with them in little groups where one person reads and one person is listening, and then practice again in a small
group where they have to work and listen to each other, too. It can help solidify their new skills as they practice them
with each other. 6. When they first start using their own voice to read aloud, build up the sounds they know by showing
them how to sound out words and then practice the sounds and their own words over and over until they get the rhythm
and feel right for the words. 7. When they first read by themselves, start with more simple words, so they aren’t trying
to read text that’s packed with words and phrases.
Table 6: Randomly sampled examples of in-domain prompt from HH-RLHF dataset.
50
Ultra-Chat Examples
Prompt :
Human: Write a creative short story set in a post-apocalyptic world where all forms of communication technology have
ceased to exist, and the protagonist is struggling to survive. Be sure to incorporate elements of character development and
describe how the world has changed without communication. Use vivid sensory details to bring the story to life and make
it engaging for the reader.
Assistant:
Responses :
SFT: I’m not all that familiar with this particular setting, but I have some ideas for things to include, and some things I
can guide you on: one idea is that your protagonist has lived in a place that survived the purge.
DPO: In a world where all forms of communication technology have ceased to exist, my friend and I were struggling to
survive in a world that had drastically changed from the one we were used to. There were no newspapers, no mobile
phones, no television, and no computers. Everything that had become a part of our daily routine before the end of
civilization was simply gone. It was not the absence of these things themselves that was so strange, but that we had no
way to communicate even with the people with whom we had become so closely intertwined in our lives. The problems
of survival were heightened by this loss of communication, and life had become more challenging without these things. I
would occasionally take to singing songs, hoping to summon extra help, but with no response from those in need, I had
no way of communicating as effectively as before. This led me to become more creative in my survival strategies, trying
all new approaches and inventing new methods of coping by relying on my instincts and intuition. I was being tested in
this new way, and I had to find new ways to stay alive.
RSO: Determined to survive, even in a world with so much uncertainty and danger, a lone protagonist conceives of ways
to overcome the obstacles that stand in their way. With little to rely on except their own strength and wits, they are
forced to fend for themselves in a world","[0.02620088867843151, 0.02551260031759739, 0.025069035589694977, 0.026889178901910782, 0.01565476320683956, -0.03958429768681526, 0.009873131290078163, 0.03982902318239212, 0.004848617594689131, 0.0657087117433548, 0.010469648987054825, -0.0315389558672905, -0.05273827537894249, 0.05276886746287346, 0.027791602537035942, -0.010462000966072083, 0.0029864117968827486, -0.009360738098621368, -0.0006366678280755877, 0.07078675925731659, 0.03612755239009857, -0.002051485236734152, -0.035546332597732544, 0.031661320477724075, -0.023172415792942047, -0.010370229370892048, 0.01925681158900261, 0.09201666712760925, 0.020082758739590645, -0.03453683853149414, -0.03288494423031807, -0.008137112483382225, -0.05439016968011856, -0.005296005867421627, 0.017436668276786804, 0.014125230722129345, -0.019868625327944756, -0.00913130771368742, 0.02875520847737789, -0.05304418131709099, 0.013360464945435524, -0.05249354988336563, -0.006997610442340374, -0.015211199410259724, -0.047935545444488525, 0.037381771951913834, 0.037473540753126144, 0.01460703369230032, 0.0044930013827979565, 0.025374941527843475, -0.06350618600845337, 0.03395561873912811, 0.014974121935665607, 0.020985184237360954, -0.02996353805065155, -0.03300730884075165, -0.0547572560608387, -0.019807443022727966, -0.03450625017285347, -0.003095390973612666, 0.059192903339862823, -0.012763947248458862, 0.018996791914105415, 0.016916627064347267, 0.0003219187492504716, 0.015998907387256622, -0.014499966986477375, -0.004982451442629099, -0.018644999712705612, 0.040716152638196945, 0.055430252104997635, -0.017941413447260857, 0.014507614076137543, -0.0041832709684967995, -0.05989648774266243, 0.014385251328349113, 0.010484944097697735, -0.01711546629667282, 0.0012924547772854567, -0.04022670164704323, 0.020296894013881683, -0.046069514006376266, -0.0017226358177140355, 0.005181290674954653, -0.025910278782248497, 0.019272107630968094, -0.0953204557299614, -0.03423093259334564, -0.006726118270307779, -0.07054203003644943, 0.0037913282867521048, 0.03410857170820236, -0.01702369563281536, -0.023845409974455833, 0.021857017651200294, -0.05084165558218956, -0.057143326848745346, 0.04019610956311226, 0.04175623133778572, 0.01375049538910389, 0.02918347716331482, -0.014201708137989044, 0.004657425917685032, -0.02831164374947548, 0.044356439262628555, 0.02373834140598774, -0.00864950567483902, 0.01736019179224968, -0.01570829749107361, -0.025910278782248497, -0.12126132100820541, 0.003980607725679874, 0.010622601956129074, -0.006030181422829628, 0.008626562543213367, -0.031844861805438995, 0.00592693779617548, -0.07115384191274643, 0.03784063085913658, 0.03664759546518326, -0.004427995998412371, 0.013505770824849606, -0.01140266377478838, 0.025436121970415115, 0.02743981033563614, -0.05760218948125839, 0.022728851065039635, -0.057173918932676315, -0.024013657122850418, -0.01841557025909424, 0.03147777542471886, -0.010362581349909306, -0.009421919472515583, -0.048241451382637024, -0.0415726900100708, -0.020924001932144165, -0.017314305528998375, -0.01717664860188961, -0.03276258334517479, 0.013826972804963589, -0.008909526281058788, -0.0325484499335289, -0.03276258334517479, -0.001705428585410118, 0.012022124603390694, 0.013169273734092712, 0.026782112196087837, 0.020495733246207237, -0.01129559613764286, 0.009460157714784145, 0.029152886942029, 0.012916900217533112, -0.023631274700164795, 0.014224650338292122, 0.03017767332494259, -0.008450666442513466, -0.02106166072189808, 0.02607852593064308, -0.04227627441287041, -0.03282376378774643, -0.0028544897213578224, -0.030973030254244804, -0.0070473202504217625, -0.002850665943697095, -0.01895090565085411, -0.02096988819539547, 0.02601734548807144, -0.01624363288283348, -0.03493451699614525, 0.023294776678085327, 0.009276613593101501, -0.015830660238862038, -0.01928740367293358, 0.021765245124697685, 0.009330146946012974, -0.024503108114004135, 0.01895090565085411, -0.04383639618754387, -0.021214613690972328, -0.026155002415180206, -0.0127257090061903, 0.03432270511984825, -0.05454312264919281, 0.006569341290742159, -0.008771868422627449, -0.008519494906067848, -0.025130216032266617, -0.007467941846698523, -0.044570572674274445, -0.00986548326909542, -0.031875453889369965, -0.012542164884507656, 0.02352420799434185, -0.04756845533847809, 0.028204577043652534, -0.037289999425411224, 0.08748924732208252, -0.02100047841668129, 0.010469648987054825, 0.0096589969471097, 0.01053083036094904, 0.023998362943530083, -0.03585223853588104, -0.057112738490104675, 0.042551588267087936, -0.014255241490900517, -0.031156573444604874, 0.022392353042960167, -0.006706999149173498, -0.011119700036942959, 0.04328576475381851, 0.010553773492574692, 0.022178219631314278, 0.03450625017285347, -0.053564224392175674, 0.03218135982751846, -0.01814025267958641, 0.014683510176837444, -0.03793240338563919, -0.017635507509112358, 0.003034209832549095, 0.012802185490727425, 0.0006027313647791743, 0.011723865754902363, 0.0015008535701781511, 0.026720929890871048, 0.011517378501594067, -0.02106166072189808, 0.02283591777086258, -0.02517610229551792, 0.06552516669034958, -0.007999453693628311, -0.004569477867335081, -0.004630659241229296, 0.0193179938942194, 0.005743394140154123, 0.01174680795520544, -0.023631274700164795, 0.013765791431069374, -0.002122226171195507, 0.017819052562117577, 0.013995220884680748, 0.033404987305402756, 0.02364657074213028, -0.010033732280135155, 0.027332743629813194, -0.03502628952264786, -0.08571499586105347, 0.009934312663972378, -0.031156573444604874, 0.037167634814977646, -0.057204511016607285, 0.0460389219224453, 0.003751178039237857, -0.02072516269981861, -0.033772073686122894, 0.01359754242002964, -0.027653945609927177, 0.008267122320830822, -0.006045476533472538, -0.02710331231355667, 0.03129423037171364, 0.021214613690972328, 0.016289519146084785, 0.021076954901218414, 0.019241517409682274, 0.004458586685359478, 0.004022669978439808, -0.008274770341813564, -0.04738491028547287, -0.027516286820173264, -0.0011203824542462826, 0.046314239501953125, -0.01907326839864254, -0.06760533154010773, -0.05139228701591492, -0.006251963321119547, 0.01940976455807686, -0.004320928826928139, 0.03300730884075165, -0.011188529431819916, 0.05484902858734131, -0.017972005531191826, 0.0029080233070999384, 0.011341482400894165, 0.060997750610113144, 0.0008441106765531003, 0.0364028699696064, -0.0036995564587414265, 0.002328712958842516, 0.03294612839818001, -0.020556915551424026, 0.06176251545548439, -0.04166446253657341, -0.03279317170381546, -0.028556369245052338, -0.0001055735774571076, 0.004202390089631081, -0.03676995635032654, 0.02529846504330635, 0.027822192758321762, -0.002890816191211343, -0.011112052015960217, 0.017467258498072624, -0.010752612724900246, -0.006989962887018919, -0.0029080233070999384, -0.016717787832021713, 0.022484125569462776, -0.02554319053888321, 0.005510140210390091, 0.0032445203978568316, 0.014339365996420383, 0.008748925291001797, -0.004137385170906782, -0.07268337905406952, 0.021184023469686508, -0.042735133320093155, 0.02921406738460064, -0.020480437204241753, -0.03759590536355972, -0.02875520847737789, 0.029107000678777695, -0.00702437711879611, -0.00242239679209888, -0.04169505089521408, 0.046191874891519547, 0.02987176738679409, -0.02265237458050251, -0.014813520945608616, -0.04970980063080788, -0.04753786697983742, 0.013069854117929935, 0.07623188942670822, -0.029152886942029, -0.06350618600845337, -0.007299693301320076, 0.0061028338968753815, 0.0654028058052063, -0.02211703732609749, -0.02346302568912506, 0.03404739126563072, -0.02924465760588646, 0.023111233487725258, -0.04414230212569237, 0.023478321731090546, -0.006668760906904936, 0.008374189957976341, 0.01186917070299387, 0.022208809852600098, -0.0027130080852657557, 0.04129737243056297, 0.017559031024575233, -0.024533698335289955, -0.012282144278287888, 0.015593581832945347, 0.03707586228847504, -0.03074360080063343, 0.016840150579810143, 0.01705428585410118, 0.008114169351756573, -0.0002581085718702525, 0.004470058251172304, 0.024809014052152634, -0.015830660238862038, 0.03276258334517479, -0.018155548721551895, -0.015922430902719498, -0.026858588680624962, -0.019990988075733185, -0.01081379409879446, 0.02283591777086258, -0.010400819592177868, 0.01748255454003811, -0.0502910241484642, 0.018599113449454308, -0.0054757259786129, -0.012901605106890202, -0.01000314112752676, 0.05439016968011856, 0.03095773421227932, 0.01714605838060379, 0.011326187290251255, -0.04031847417354584, 0.020373370498418808, 0.04203154891729355, -0.016014203429222107, -0.015379447489976883, -0.07525299489498138, -0.0228665079921484, 0.010913213714957237, -0.003517924342304468, -0.01898149587213993, 0.02788337506353855, 0.026063231751322746, -0.019302697852253914, -0.05114756152033806, 0.08455254882574081, 0.05417603626847267, 0.01702369563281536, 0.03774885833263397, 0.011938000097870827, -0.05405367165803909, 0.04762963578104973, 0.0023784227669239044, 0.025772619992494583, -0.002934790216386318, -0.022912394255399704, 0.020021578297019005, 0.013276340439915657, 0.0360969640314579, -0.008725982159376144, 0.042551588267087936, -0.018369683995842934, 0.003533219685778022, -0.011815637350082397, -0.0005157392006367445, -0.004412700887769461, 0.021291090175509453, 0.04564124345779419, -0.026720929890871048, -0.069563128054142, -0.029718812555074692, -0.01913444884121418, 0.012389211915433407, 0.060997750610113144, 0.03814653679728508, -0.0017216798150911927, 0.02343243546783924, -0.044203486293554306, -0.02115343138575554, 0.03927839174866676, 0.012328030541539192, 0.006072243209928274, -0.010370229370892048, -0.02644561417400837, 0.012939843349158764, 0.01305455807596445, 0.0026155002415180206, -0.02268296480178833, 0.037473540753126144, 0.005957528483122587, -0.03814653679728508, -0.016197746619582176, -0.00825947429984808, 0.013085149228572845, 0.020419256761670113, 0.02464076690375805, -0.02710331231355667, -0.017283715307712555, -0.019088564440608025, -0.07201038300991058, 0.019899215549230576, 0.031661320477724075, 0.010622601956129074, -0.01882854290306568, 0.02358538843691349, -0.04900621622800827, 0.020143941044807434, 0.0026766816154122353, -0.015784773975610733, -0.016320109367370605, 0.0010964835528284311, -0.023386549204587936, 0.009743121452629566, 0.03582164645195007, 0.035729873925447464, -0.0066305226646363735, -0.002539023756980896, -0.028235167264938354, 0.016733083873987198, 0.004584772977977991, -0.003192898817360401, -0.029703518375754356, -0.03624991700053215, 0.013498122803866863, -0.02566555328667164, 0.030192967504262924, -0.05858108773827553, 0.019149744883179665, 0.03612755239009857, -0.03218135982751846, 0.036984093487262726, 0.0010869238758459687, 0.00942956656217575, -0.03484274819493294, 0.017253125086426735, -0.013475179672241211, 0.011639741249382496, -0.010133151896297932, -0.04879208281636238, 0.00273786298930645, 0.015624172985553741, -0.019425060600042343, 0.01313103549182415, -0.02650679461658001, 0.02168876864016056, 0.015211199410259724, -0.004653602372854948, -0.005812223069369793, 0.021474633365869522, 0.012243906036019325, -0.028862275183200836, 0.03450625017285347, -0.0173907820135355, -0.010767907835543156, 0.04762963578104973, 0.020985184237360954, -0.007796790916472673, 0.011830932460725307, -0.01892031542956829, -0.002229293342679739, -0.03270140290260315, 0.012610994279384613, 0.006408740300685167, 4.8574602260487154e-05, -0.025313761085271835, 0.015861250460147858, -0.017344897612929344, 0.0257573239505291, 0.005433663725852966, -0.005598088260740042, 0.029015228152275085, 0.006209901534020901, 0.006619051098823547, 0.023723047226667404, -0.04007374867796898, -0.015922430902719498, -0.02526787482202053, 0.015517105348408222, -0.047904953360557556, -0.020862821489572525, 0.03444506973028183, 0.03429211676120758, -0.03848303481936455, 0.005590440705418587, -0.018721476197242737, -0.02451840415596962, -0.03306848928332329, -0.021520519629120827, 0.005380129907280207, 0.0236771609634161, 0.026659749448299408, -0.016748379915952682, 0.011930352076888084, 0.012511574663221836, 0.019363880157470703, -0.008534790016710758, -0.011624446138739586, -0.01549416221678257, 0.06442390382289886, -0.03676995635032654, -0.026491500437259674, -0.03793240338563919, -0.01807907223701477, 0.030483579263091087, -0.002982588019222021, -0.014759986661374569, 0.0008594059618189931, 0.003804711624979973, -0.02523728273808956, -0.022942984476685524, 0.028739912435412407, 0.010224923491477966, -0.01271041389554739, 0.004267395008355379, -0.024870196357369423, 0.041052646934986115, -0.014744691550731659, 0.03664759546518326, -0.004477705806493759, -0.07305046170949936, -0.01212154421955347, -0.051912326365709305, 0.013444589450955391, -0.008764220401644707, 0.003340116236358881, 0.010729669593274593, -0.017528440803289413, 0.0185073409229517, -0.008343598805367947, -0.027363333851099014, -0.02731744758784771, 0.04224568232893944, -0.04576360806822777, -0.014943530783057213, 0.016778970137238503, 0.014247593469917774, -0.01042376272380352, 0.013230455107986927, 0.008114169351756573, -0.028510482981801033, -0.0002946739550679922, 0.005058928392827511, -0.02196408435702324, 0.019425060600042343, -0.022973576560616493, -0.03264021873474121, -0.04903680831193924, -0.042459819465875626, 0.0034815981052815914, 0.024839606136083603, -0.0015897576231509447, -0.0004533629398792982, -0.01624363288283348, -0.00782738160341978, -0.001885148580186069, -0.040777333080768585, 0.0217499490827322, -0.012962786480784416, 0.023386549204587936, 0.010790850967168808, 0.016350701451301575, -0.04151150956749916, -0.025742029771208763, -0.01732960157096386, 0.007387641351670027, -0.0041909185238182545, 0.002036189893260598, 0.015547696501016617, -0.031997814774513245, -0.013085149228572845, -0.037351179867982864, 0.008534790016710758, 0.015379447489976883, -0.03481215611100197, -0.024717243388295174, 0.017681393772363663, 0.0011796518228948116, -0.012266849167644978, -5.3055653552291915e-05, 0.005808399058878422, 0.008297712542116642, -0.016687197610735893, -0.008932468481361866, -0.004787436220794916, -0.014706453308463097, 0.01916504092514515, -0.018308501690626144, -0.010569068603217602, 0.028663435950875282, -0.028265757486224174, -0.033435575664043427, -0.033986207097768784, 0.005158348008990288, 0.002294298494234681, -0.005724275019019842, 0.0030131787061691284, -0.003011266700923443, -0.04860853776335716, -0.0003580061602406204, 0.006332263816148043, 0.03621932491660118, -0.009146603755652905, 0.030376512557268143, -0.01085967943072319, -0.027699830010533333, 0.005903994664549828, -0.01916504092514515, -0.033680301159620285, 0.013987572863698006, -0.023095937445759773, -0.008550086058676243, -0.00041130080353468657, 0.010867327451705933, -0.012962786480784416, 0.046222466975450516, 0.007269102614372969, -0.020358076319098473, 0.0018746331334114075, -0.006424035876989365, -0.014316422864794731, 0.029887061566114426, 0.028632845729589462, -0.014507614076137543, 0.021398156881332397, 0.0210922509431839, -0.03606637194752693, 0.003919426817446947, 0.0017838170751929283, 0.008267122320830822, 0.002638443373143673, -0.001864117570221424, -0.042765725404024124, 0.006997610442340374, 0.03257903829216957, 0.01257275603711605, -0.041083239018917084, -0.02442663162946701, -0.0035274839028716087, -0.03499570116400719, 0.014844111166894436, -0.0009559576865285635, -0.015127074904739857, 0.003617343958467245, 0.020419256761670113, -0.0017819051863625646, 0.019623899832367897, 0.002005599206313491, -0.11777398735284805, 0.0020419256761670113, 0.001772345625795424, -0.003716763574630022, -0.001494161901064217, -0.002382246544584632, -0.06029416620731354, -0.017314305528998375, 0.017008399590849876, 0.005078047513961792, 0.013972277753055096, -0.029581155627965927, 0.029703518375754356, -0.027699830010533333, 0.030131787061691284, -0.03309908136725426, 0.017910823225975037, 0.02797514572739601, 0.025650257244706154, 0.008519494906067848, 0.01804848201572895, -0.02467135712504387, -0.008748925291001797, 0.0018067600904032588, -0.03444506973028183, -0.04359167069196701, -0.0025677024386823177, -0.014132878743112087, -0.00585810886695981, -0.037565313279628754, 0.04166446253657341, 0.018308501690626144, 0.03312966972589493, 0.023050053045153618, -0.001679617678746581, -0.018644999712705612, 0.019210925325751305, -0.040899693965911865, -0.0021260499488562346, -0.0013679754920303822, -0.007326459977775812, 0.002342096297070384, -0.031034210696816444, 0.0008646637434139848, 0.03621932491660118, -0.004443291574716568, -0.0173907820135355, 0.018155548721551895, 0.04744609445333481, -0.04726254940032959, -0.003617343958467245, -0.04343871772289276, 0.01639658585190773, -0.016595425084233284, -0.02638443373143673, 0.016901332885026932, 0.004049436654895544, 0.011440902017056942, 0.05209587141871452, -0.03781003877520561, 0.028709322214126587, 0.016993103548884392, 0.02794455550611019, 0.002148992847651243, 0.00723468791693449, 0.015861250460147858, 0.025313761085271835, -0.036984093487262726, -6.757426308467984e-05, 0.0015448277117684484, 0.011991533450782299, -0.02063339203596115, -0.015953022986650467, 0.020113350823521614, -0.0066305226646363735, 0.020205121487379074, -0.033435575664043427, 0.001804848201572895, 0.024090133607387543, 0.005177467130124569, -0.025191398337483406, -0.0022598840296268463, -0.0012140662875026464, -0.015922430902719498, 0.03875834867358208, 0.01543298177421093, -0.03306848928332329, -0.01274100411683321, 0.014851759187877178, 0.0020495732314884663, -0.05096401646733284, -0.013842267915606499, -0.028235167264938354, 0.005074223503470421, 0.007242335472255945, -0.0003429498174227774, 0.04423407465219498, -0.0072729261592030525, -0.12364739179611206, 0.028204577043652534, -0.005976647604256868, -0.007754729129374027, 0.009437214583158493, 0.016258928924798965, -0.009666644036769867, -0.017604917287826538, 0.028602255508303642, -0.033619120717048645, -0.005724275019019842, -0.013544009067118168, 0.022392353042960167, -0.06742178648710251, 0.03129423037171364, -0.015532401390373707, -0.009980198927223682, -0.03511806204915047, -0.03998197615146637, -0.017972005531191826, 0.0005879140226170421, -0.008458313532173634, 0.004294162150472403, 0.0048103793524205685, -0.007922977209091187, -0.038788940757513046, -0.012756300158798695, -0.016702493652701378, -0.053503040224313736, 0.01329928357154131, 0.01919563114643097, -0.017069580033421516, -0.03242608532309532, 0.021795835345983505, -0.028586959466338158, -0.019578013569116592, -0.009406624361872673, 0.027088018134236336, 0.014056402258574963, -0.011769751086831093, 0.0331602618098259, -0.0002791396400425583, 0.013849915005266666, -0.037106454372406006, 0.015157665126025677, -0.027026835829019547, -0.0031374532263725996, 0.030560055747628212, 0.04334694519639015, -0.007127620745450258, 0.005621031392365694, 0.013689314015209675, -0.01913444884121418, 0.010370229370892048, -0.012679822742938995, 0.01720723882317543, -0.02909170463681221, 0.006339911371469498, 0.023111233487725258, 0.0017436668276786804, 0.0002317002508789301, -0.028663435950875282, 0.0067375898361206055, -0.014752339571714401, -0.051637012511491776, -0.035454560071229935, -0.006913486402481794, -0.029565859586000443, -0.018308501690626144, 0.018721476197242737, -0.0035618983674794436, 0.017314305528998375, 0.006282554008066654, 0.02193349413573742, 0.002361215651035309, 0.010890270583331585, 0.01414052676409483, 0.02707272209227085, -0.02716449461877346, -0.023294776678085327, -0.00047487198025919497, -0.0495874397456646, 0.014951178804039955, 0.0193179938942194, 0.009031888097524643, 0.0008364630048163235, 0.021444043144583702, 0.024594880640506744, -0.03655582293868065, 0.03839126229286194, 0.02271355502307415, 0.007540594320744276, 0.0008909525931812823, -0.033404987305402756, -0.015754183754324913, -0.0027263914234936237, -0.0024051896762102842, -0.010217276401817799, 0.046620145440101624, 0.001375623163767159, -0.01835438795387745, 0.03875834867358208, 0.008825401775538921, -0.02457958459854126, -0.013551656156778336, 0.02376893348991871, 0.029259953647851944, 0.015800070017576218, 0.046406012028455734, -0.007907682098448277, 0.004477705806493759, -0.0009798567043617368, 0.0495874397456646, 0.004722431302070618, -0.007318812422454357, 0.030070606619119644, 0.051759373396635056, 0.01985332928597927, -0.006531103048473597, -0.029458792880177498, 0.00665728934109211, 0.03600519150495529, -0.024105429649353027, -0.01963919587433338, -0.007502356078475714, 0.024166610091924667, 0.005617207381874323, 0.015662411227822304, 0.001237009302712977, -0.0036861728876829147, 0.04123619198799133, -0.01633540540933609, 0.003233049064874649, 0.011020280420780182, 0.025619667023420334, -0.007012906018644571, -0.01661072112619877, 0.053319498896598816, -0.02376893348991871, 0.009888426400721073, 0.028831684961915016, 0.00765530951321125, 0.021887607872486115, -0.007230864372104406, -0.026155002415180206, -0.0008417207864113152, 0.03836067020893097, 0.0025371117517352104, -0.013742848299443722, 0.007532946765422821, 0.000279378640698269, 0.0016442472115159035, 0.013505770824849606, -0.014935883693397045, 0.04961802810430527, 0.003867805004119873, 0.003808535635471344, -0.023983066901564598, -0.028831684961915016, 0.006511983927339315, -0.033404987305402756, 0.03946193307638168, 0.02719508484005928, 0.00041130080353468657, 0.05515493452548981, -0.021795835345983505, 0.02448781207203865, -0.0004705701721832156, 0.003953841049224138, -0.035240426659584045, -0.030345922335982323, 0.0076973713003098965, 0.020648686215281487, -0.025833800435066223, 0.021459339186549187, 0.0036880848929286003, 0.021275794133543968, 0.019868625327944756, -0.009406624361872673, 0.026812702417373657, 0.00942956656217575, 0.035362787544727325, 0.020572209730744362, 0.022101743146777153, 0.026827996596693993, -0.014423489570617676, -0.014125230722129345, -0.025221988558769226, 0.002382246544584632, 0.0033439400140196085, 0.016733083873987198, -0.0037779449485242367, 0.0013708433834835887, 0.04016551747918129, 0.024472517892718315, -0.019715672358870506, 0.006710823159664869, 0.0012656879844143987, 0.001328781247138977, -0.014362309128046036, -0.03117186948657036, 0.024809014052152634, 0.039033666253089905, -0.020480437204241753, -0.051789965480566025, 0.048424992710351944, -0.02084752544760704, -0.02283591777086258, 0.006970843765884638, 0.019272107630968094, -0.014660567045211792, 0.017620213329792023, -0.039125438779592514, 0.02872461825609207, 0.004389757756143808, 0.020495733246207237, 0.004359167069196701, 0.011769751086831093, -0.019501537084579468, -0.03823830932378769, -0.019425060600042343, -0.04200095683336258, -0.0243348591029644, -0.01269511878490448, -0.029948243871331215, -0.02379952371120453, 0.01212154421955347, -0.011960943229496479, 0.013635780662298203, 0.008855991996824741, 0.013796381652355194, -0.00685230502858758, -0.006255787331610918, 0.016258928924798965, 0.004389757756143808, -0.0041679758578538895, 0.02214762754738331, -0.011211471632122993, 0.049832165241241455, -0.0027799250092357397, 0.049954526126384735, -0.03297671675682068, -0.0041832709684967995, -0.0380241721868515, 0.013467532582581043, 0.025038443505764008, 0.009666644036769867, 0.0003589621337596327, -0.002342096297070384, -0.040899693965911865, -0.023723047226667404, 0.027531582862138748, 0.031125983223319054, -0.03312966972589493, 0.012358621694147587, 0.0036402870900928974, 0.01661072112619877, 0.06338381767272949, -0.028510482981801033, 0.01053083036094904, 0.0027894845698028803, -0.0020801639184355736, 0.0011156026739627123, -0.035423967987298965, 0.012236258946359158, 0.004848617594689131, -0.02464076690375805, 0.0029022875241935253, 0.0025218164082616568, -0.030575351789593697, -0.0012656879844143987, 0.007578832563012838, -0.020679276436567307, -0.004580949433147907, -0.023753637447953224, -0.04301045089960098, -0.01140266377478838, -0.010691431351006031, 0.007483236957341433, 0.003657494205981493, -0.018996791914105415, 0.018308501690626144, -0.02159699611365795, -0.012794538401067257, 0.009597815573215485, 0.001746534719131887, -0.03985961154103279, -0.02439604140818119, -0.007770024240016937, -0.011456197127699852, 0.015624172985553741, 0.015517105348408222, -0.026093821972608566, 0.027868079021573067, -0.001494161901064217, -0.018966201692819595, -0.0027722774539142847, 0.007001434452831745, 0.0451212041079998, 0.011999181471765041, -0.016977809369564056, 0.016901332885026932, 0.007097030058503151, 0.01564711518585682, 0.008320655673742294, -0.03101891651749611, -0.010026084259152412, -0.042582180351018906, -0.0026155002415180206, -0.02464076690375805, -0.027761012315750122, 0.04695664346218109, -0.00020481394312810153, 0.03111068718135357, -0.011968590319156647, -0.02448781207203865, 0.046558964997529984, 0.010179038159549236, 0.008840696886181831, 0.00017314784054178745, -0.023095937445759773, 0.004913622513413429, 0.01841557025909424, 0.019593309611082077, -0.011876818723976612, 0.013092797249555588, 0.005915466230362654, 0.0028850804083049297, 0.022269990295171738, -0.0022044384386390448, 0.0004956640768796206, -0.009322499856352806, 0.009842541068792343, -0.004840970039367676, -0.04175623133778572, -0.00866480078548193, -0.026858588680624962, 0.044356439262628555, 0.011257357895374298, 0.012733357027173042, -0.020954592153429985, -0.012350973673164845, 0.019838035106658936, 0.02451840415596962, -0.004852441139519215, 0.017696689814329147, -0.03618873655796051, -0.03432270511984825, -0.013551656156778336, 0.020679276436567307, 0.09220021218061447, -0.01418641209602356, -0.04918976128101349, 0.027179788798093796, 0.016595425084233284, 0.005643974523991346, 0.006814066786319017, 0.003950017504394054, -0.031569547951221466, -0.009896074421703815, -0.033772073686122894, 0.006469921674579382, 0.020587505772709846, 0.01934858411550522, -0.0030992149841040373, 0.008741277270019054, -0.018935609608888626, -0.01907326839864254, 0.01356695219874382, 0.0011528850300237536, 0.03435329720377922, 0.008381837047636509, 0.026705633848905563, -0.03615814447402954, -0.02785278484225273, 0.012098601087927818, 0.03796299174427986, 0.0022465006913989782, 0.018599113449454308, 0.04359167069196701, 0.03634168952703476, -0.041205599904060364, 0.0012656879844143987, 0.0011662683682516217, -0.04585538059473038, 0.011693274602293968, 0.011693274602293968, -0.024686651304364204, -0.023983066901564598, 0.015800070017576218, -0.023065347224473953, -0.00810652133077383, 0.03979843109846115, -0.006523455493152142, 0.008504199795424938, 0.040746740996837616, -0.0021929671056568623, 0.013666371814906597, 0.02100047841668129, 0.004366814624518156, 0.018033185973763466, 0.01661072112619877, 0.02006746456027031, -0.009949607774615288, -0.019838035106658936, -0.01609067991375923, -0.002261796034872532, 0.040624380111694336, -0.0031661319080740213, 0.006118129473179579, -0.004642130807042122, -0.006301673129200935, -0.0049174465239048, -0.024411335587501526, -0.012825128622353077, -0.0399513840675354, 0.0015744623960927129, 0.04013492912054062, -0.042551588267087936, -0.02482431009411812, -0.048424992710351944, -0.01658013090491295, -0.031967226415872574, 0.029627041891217232, -0.003353499574586749, 0.046620145440101624, -0.027822192758321762, 0.009024241007864475, 0.023631274700164795, 0.0007618982926942408, 0.026124412193894386, -0.023233596235513687, -0.048088498413562775, -0.018966201692819595, -0.00926896557211876, -0.01988392136991024, 0.03410857170820236, 0.01916504092514515, -0.014951178804039955, -0.009016592986881733, -0.018430864438414574, 0.012006828561425209, 0.03848303481936455, 0.015134722925722599, 0.008618914522230625, -0.030300036072731018, 0.01549416221678257, 0.033527348190546036, 0.008748925291001797, -0.007976511493325233, 0.023386549204587936, 0.018706180155277252, 0.012198020704090595, -0.0066152275539934635, -0.02884697914123535, -0.0035542508121579885, -0.03787121921777725, 0.0109514519572258, 0.010974394157528877, 0.008878935128450394, -0.011004985310137272, -0.03242608532309532, 0.001534312148578465, 0.025466714054346085, 0.026858588680624962, 0.008060635067522526, 0.005789279937744141, 1.6243812979155337e-06, 0.03236490488052368, -0.013635780662298203, 0.0035370434634387493, -0.009047184139490128, 0.018553227186203003, -0.00852714292705059, -0.006531103048473597, 0.01271041389554739, 0.020709868520498276, -0.006121953018009663, 0.023570094257593155, 0.0023631274234503508, 0.0009540457976981997, 0.011899761855602264, 0.0022120862267911434, -0.006339911371469498, 0.0008670536335557699, -0.012129191309213638, -0.016136566177010536, -0.017222534865140915, -0.024503108114004135, -0.02548200823366642, 0.018094368278980255, -0.005483373533934355, -0.012090953066945076, 0.004351519513875246, -0.006424035876989365, -0.012817480601370335, 0.008741277270019054, 1.344315592177736e-07, 0.011861523613333702, 0.005946056917309761, -0.012435098178684711, 0.019715672358870506, 0.010821441188454628, 0.035546332597732544, -0.004286514595150948, 0.03453683853149414, -0.030254149809479713, 0.0033152613323181868, -0.019516833126544952, 0.008152407594025135, -0.0054604304023087025, -0.004665073473006487, 0.007777671795338392, 0.025053739547729492, 0.008152407594025135, 0.031875453889369965, 0.023004166781902313, 0.005231000483036041, -0.012435098178684711, 0.01373520027846098, 0.012985729612410069, 0.0027952203527092934, -0.015532401390373707, -0.022239400073885918, 0.0103931725025177, -0.004592420998960733, -0.012909253127872944, 0.013001024723052979, -0.026904473081231117, -0.005311300978064537, -0.017375487834215164, 0.004443291574716568, 0.03260963037610054, 0.004305633716285229, -0.010362581349909306, 0.03071300871670246, 0.0037932402919977903, -0.008718334138393402, 0.012175077572464943, -0.015088836662471294, 0.01651894859969616, -0.041052646934986115, 0.00981959793716669, 0.01823202520608902, -0.02292769029736519, 0.016870740801095963, 0.011471492238342762, -0.06791123747825623, -0.010607306845486164, 0.011991533450782299, -0.011364425532519817, -0.014010515995323658, 0.013727553188800812, -0.014308774843811989, -0.030973030254244804, 0.004095322918146849, -0.0012092865072190762, 0.013092797249555588, -0.0013153977924957871, -0.015616524964571, -0.027363333851099014, -0.003391738049685955, 0.023065347224473953, 0.005097166635096073, 0.04044083505868912, 0.011983886361122131, -0.008595971390604973, -0.02112284116446972, -0.012519221752882004, 0.00650433637201786, -0.002321065403521061, -0.020403960719704628, 0.004359167069196701, 0.0007007169770076871, 0.0035963128320872784, -0.006829361896961927, 0.017819052562117577, 0.011333834379911423, -0.003194810589775443, -0.007976511493325233, 0.03683114051818848, 0.0035160125698894262, -0.021245203912258148, 0.021489929407835007, 0.012343325652182102, 0.0164271779358387, -0.01186917070299387, -0.04132796451449394, 0.003988255746662617, -0.0041679758578538895, -0.012297440320253372, 0.015517105348408222, -0.019394470378756523, -0.011448550038039684, -0.013383408077061176, 0.06528043746948242, 0.008412428200244904, 0.02750099077820778, -0.024809014052152634, 0.024747833609580994, 0.00923837535083294, -0.015096483752131462, -0.008160054683685303, -0.05307477340102196, 0.04429525509476662, -0.04141973704099655, -0.02809750847518444, -0.0328543558716774, -0.025711439549922943, 0.022820621728897095, -0.03655582293868065, -0.013406351208686829, 0.01535650435835123, -0.0012580403126776218, 0.016993103548884392, -0.003902219468727708, -0.02178054116666317, -0.0283422339707613, 0.0101407989859581, 0.0033477640245109797, -0.00448152981698513, 0.024120725691318512, -0.018553227186203003, -0.002982588019222021, 0.0016299078706651926, -0.02542082779109478, -0.0011261182371526957, 0.007437351159751415, 0.02716449461877346, 0.003728235140442848, -0.0188591331243515, -0.013253397308290005, -0.017864936962723732, -0.014415842480957508, 0.003431888297200203, 0.016014203429222107, -0.017941413447260857, -0.011540321633219719, -0.001343120587989688, -0.010637897066771984, 0.013169273734092712, 0.021336976438760757, -0.00702437711879611, 0.015639469027519226, -0.0041909185238182545, 0.008588324300944805, 0.0164271779358387, -0.01215213444083929, 0.03441447764635086, -0.017406078055500984, -0.03221195191144943, 0.011440902017056942, 0.0007537726778537035, 0.00021604645007755607, -0.001911915373057127, 0.037198226898908615, -0.0022923864889889956, 0.010645545087754726, -0.0025485833175480366, 0.008267122320830822, 0.011647388339042664, 0.002009423216804862, 0.023264186456799507, 0.02389129437506199, 0.015410038642585278, 0.01904267817735672, -0.001600273186340928, -0.00746029382571578, -0.02454899437725544, 0.01742137409746647, -0.01218272466212511, 0.010484944097697735, 0.010026084259152412, 0.02662915736436844, 0.015211199410259724, -0.0027225676458328962, 0.004275043029338121, -0.02243823930621147, -0.012702765874564648, -0.004665073473006487, 0.03450625017285347, 0.018430864438414574, 0.020556915551424026, -0.02448781207203865, 0.01140266377478838, -0.023340662941336632, 0.021382862702012062, -0.009299556724727154, -0.01928740367293358, 0.00010097303311340511, 0.0043859342113137245, -0.0014272448606789112, -0.0054604304023087025, 0.009720178321003914, 0.024564288556575775, -7.462444773409516e-05, 0.00923837535083294, -0.016595425084233284, -0.018400274217128754, -0.03475097566843033, -0.004764493089169264, 0.0257573239505291, 0.005907818675041199, -0.00404561311006546, -0.003995903301984072, 0.009444862604141235, 0.013804029673337936, -0.03257903829216957, -0.00821358896791935, 0.012435098178684711, -0.030850667506456375, 0.00045909869368188083, -0.014308774843811989, 0.013108092360198498, -0.03857480734586716, -0.01242745015770197, -0.005494845099747181, -0.03664759546518326, 0.04123619198799133, -0.017283715307712555, -0.005112461745738983, 0.029581155627965927, 0.027684535831212997, -0.005735746119171381, -0.04034906253218651, -0.05093342810869217, -0.035240426659584045, -0.02439604140818119, 0.005426016170531511, -0.024946672841906548, -0.0007126664859242737, -0.0032024583779275417, -0.02788337506353855, -0.03267081081867218, 0.009054831229150295, -0.002539023756980896, -0.037473540753126144, -0.0018000684212893248, -0.006316968705505133]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" where all forms of communication technology have ceased to exist. Here is their
story in literary form:“It is a dark and quiet world. Everything is silent, frozen in time. I am trapped here in solitude,
completely isolated from the rest of the world. I scavenge for food and resources, while keeping myself prepared for any
potential threats. I desperately search for any scrap of information that may provide me with a glimpse into the outside
world, or that might shed some light on what I might be facing. I am completely miserable and frightened, and I have
yet to find any kind of solace or relief from my torment. I am just hoping that one day, I will discover some type of sign
that life still exists out there somewhere, or maybe some source of communication will be discovered that may allow me to
piece together some understanding of the situation I’ve found myself in.”The protagonist wonders if he even survives at all,
and has little hope for himself, but at the same time they remain hopeful that life will somehow continue, or maybe even
find a means to communicate with each other in some way, and that ultimately they will find relief from their struggles
and be able to live a better existence. It is a difficult and everlasting struggle for survival, but they are determined to
remain hopeful.Ultimately, there is still a tiny sliver of hope that one day we might discover a means to communicate,
which may at least allow us to understand what is happening right now, and eventually reconnect with one another and
restore prosperity and co-existence between human
Multi-step RSO: Here’s a short story set in a post-apocalyptic world where all forms of communication technology have
ceased to exist, and the protagonist is struggling to survive:Plague has decimated much of the world’s population, and the
remaining survivors are struggling to survive in an uninhabitable, barren landscape. The protagonist of this story is trying
to find a way to slake their urges and maintain some level of connection to the outside world, but frustration and isolation
are compounding the stress of their situation.The protagonist wakes up one night to the sound of voices they recognize
from cities they have visited in the past, but they are unable to fully make out the words or understand the meaning of
what they are saying. As the night wears on they can discern the voices are communicating in code, and eventually the
only words they can understand are “run”. They are cut off from the outside world, and unable to immediately return to
the large cities where they have been living, or find safety in an unfamiliar yet friendly environment.Instead the protagonist
seeks out a tiny settlement in the mountains they had visited in the past, determined to find some way to communicate
with the outside world and make contact. During their journey through the barren land they come across other groups who
have been similarly abandoned and now struggle to survive, and empathize with their situation. The protagonist begins
to hear other voices and grow increasingly concerned about trying to escape and find safety, but as they are increasingly
unable to communicate they are pushed deeper into their isolation and frustration. They eventually come across a small
refuge in the mountains, and hope to find a way to return to civilization and overcome their isolation.
Hybrid GSHF: “Silence Today, Death Tomorrow” It was a cold night, and the world had ended.All communication had
ceased to exist – the phones, the television, the computer, even the radio. There were no lights, no sounds, no contact.
Existence had come to a standstill, and not a moment sooner.Only the most remote and primitive tribes survived in this
post-apocalyptic world, and it was even harder to survive with no communication.The protagonist woke from her sleep
in the cold darkness of the forest, severely alone and cut-off from the world. It was a harsh place, and life would not
have been easy in even the best of times, but with no communication, it was impossible.Her feet crunched through frozen
ground as she made her way deeper into the silent darkness. Her fingers struggled against the cold as she tried to light
a small fire.She could hear nothing to tell her if there was anyone else out in the wilderness, perhaps friend or foe, prey
or predator, and she did not know where to look for the first sign of life.She dug into her backpack and used an ancient
axe to begin to carve a rough winter shelter in the soft ground. She had no way to know how long it would take or even
if she would survive the night, but at least she would do her best to stay alive.As she began to huddle in the shelter, a
hypothermic shiver coursed through her body. She curled into a protective ball, tucking her legs up against her chest and
feeling the pain","[0.01529485359787941, 0.030618565157055855, -0.0335332453250885, 0.038814298808574677, -0.034860722720623016, -0.02709786221385002, 0.007257840596139431, 0.03151316940784454, 0.025323081761598587, 0.010035444051027298, -0.0019840020686388016, -0.028252191841602325, -0.018642405048012733, 0.027112292125821114, 0.02556837722659111, 0.04164240136742592, 0.0014735725708305836, 0.009508781135082245, -0.03794855251908302, 0.027804888784885406, -0.013238705694675446, -0.02833876572549343, -0.01806524209678173, 0.007153229787945747, -0.045740269124507904, 0.021542657166719437, -0.020691338926553726, 0.07572395354509354, 0.05018443241715431, -0.006135977804660797, -0.016781050711870193, -0.017848804593086243, -0.02725658193230629, -0.026823708787560463, 0.021989958360791206, 0.01744478940963745, -0.012134878896176815, 0.008534817025065422, 0.013808655552566051, -0.04221956804394722, 0.03613048419356346, -0.06152570992708206, 0.006705927196890116, 0.02748744748532772, -0.042537007480859756, -0.006449810694903135, 0.009941654279828072, -0.012243096716701984, 0.046028848737478256, 0.0019659658428281546, -0.05806272476911545, -0.005021329037845135, 0.012820261530578136, 0.028006896376609802, -0.04490337893366814, -0.06989458948373795, -0.04299873858690262, 0.0007237098761834204, 0.01659347303211689, -0.004296266473829746, 0.02370702289044857, 0.006467847153544426, 0.04103637859225273, 0.00457402691245079, 0.04415306821465492, 0.025424085557460785, 0.02211982011795044, -0.001029877457767725, -0.031166870146989822, 0.021600373089313507, 0.06631617248058319, 0.008729609660804272, -0.012993410229682922, 0.02375030890107155, -0.04406649246811867, 0.022336257621645927, -0.014587827026844025, 0.00995608326047659, -0.015583435073494911, -0.04654829949140549, -0.03223462402820587, 0.011413423344492912, -0.013253134675323963, -0.003946360666304827, -0.010966121219098568, 0.014717688784003258, -0.1118544340133667, -0.007228982634842396, -0.033504385501146317, -0.02178795076906681, 0.004050971940159798, 0.05586950108408928, -0.005533562507480383, 0.002932715928182006, 0.005959221161901951, -0.04519196227192879, -0.056129224598407745, 0.030214549973607063, 0.010028229095041752, -0.020128604024648666, 0.02399560436606407, -0.037025086581707, 0.00942942127585411, -0.03413926810026169, 0.0185125432908535, 0.02116749994456768, -0.0038345351349562407, 0.04294102266430855, 0.0016043363139033318, -0.009775719605386257, -0.0934428945183754, 0.011052696034312248, 0.01942157745361328, 0.03719823807477951, -0.007073869463056326, 0.0069115422666072845, 0.028699493035674095, -0.01942157745361328, 0.06596987694501877, 0.07012546062469482, 0.0202584657818079, -0.001298619550652802, -0.013368567451834679, 0.009768505580723286, 0.011247488670051098, -0.0982910767197609, 0.03506273031234741, -0.015482431277632713, -0.039362601935863495, -0.004509096033871174, 0.0513676218688488, 0.02516436204314232, -0.036707647144794464, -0.034456707537174225, -0.041555825620889664, -0.03506273031234741, -0.014501252211630344, 0.004151975270360708, -0.01845482736825943, 0.014681615866720676, -0.00878011155873537, -0.053762853145599365, 0.01868569292128086, -0.006936793215572834, 0.030907146632671356, 0.0283964816480875, 0.01077854260802269, 0.035293594002723694, 0.006226159632205963, -0.0243274737149477, 0.07647426426410675, -0.0015628526452928782, 0.014429106377065182, 0.05356084555387497, 0.06660475581884384, -0.016045166179537773, -0.005212514661252499, 0.0604868158698082, -0.03742910176515579, -0.01953701116144657, -0.027170008048415184, -0.03815056011080742, -0.009184126742184162, 0.0015177616151049733, 0.01760351099073887, -0.024515053257346153, 0.001482590683735907, -0.0005992588121443987, -0.06954829394817352, -0.0034287164453417063, -0.011925656348466873, -0.011680361814796925, -0.04527853801846504, 0.036880798637866974, -0.02708343416452408, -0.03555331751704216, 0.03685193881392479, -0.03944917768239975, -0.028093470260500908, -0.01636260747909546, 0.023548301309347153, 0.002323086140677333, -0.034110408276319504, 0.0078061469830572605, -0.025885816663503647, 0.0011029248125851154, 0.014068379066884518, 0.021196357905864716, -0.009645857848227024, -2.6054120098706335e-05, -0.014371390454471111, -0.0023519443348050117, -0.004415306728333235, -0.049982424825429916, 0.046981170773506165, -0.0181229580193758, 0.04637514799833298, 0.019493723288178444, 0.02516436204314232, 0.04181555286049843, 0.019089708104729652, 0.017257211729884148, -0.00043512776028364897, -0.043200746178627014, 0.038352563977241516, -0.003975219093263149, -0.015828730538487434, 0.004245764575898647, 0.0015376016963273287, -0.03235005587339401, 0.04386448487639427, -0.01885884255170822, -0.0056526027619838715, -0.0029669851064682007, 0.003776818746700883, 0.01839711144566536, -0.0343124158680439, 0.059447918087244034, -0.07197238504886627, 0.02060476504266262, 0.01868569292128086, 0.0343124158680439, -0.0041195098310709, 0.05823587626218796, 0.03223462402820587, -0.015150561928749084, 0.04097866266965866, -0.03183060884475708, 0.031744033098220825, 0.02324529178440571, 0.030445415526628494, -0.02595796249806881, -0.02640526555478573, -0.022985566407442093, 0.0030319159850478172, -0.016622330993413925, -0.010655894875526428, 0.032090332359075546, 0.007423775270581245, 0.009010977111756802, 0.004981649108231068, -0.0037407458294183016, 0.03093600459396839, 0.03402383252978325, -0.006980080623179674, 0.0020038422662764788, -0.025611665099859238, -0.08311165124177933, -0.02760288119316101, -0.029608527198433876, 0.06077539920806885, 0.001256234128959477, 0.06429609656333923, 0.02574152685701847, -0.010201378725469112, -0.049578409641981125, -0.008426598273217678, -0.015280423685908318, 0.027473019436001778, -0.021542657166719437, -0.041353821754455566, -0.00481210695579648, -0.0178343765437603, -0.0004398623132146895, 0.005764428060501814, 0.0023934280034154654, 0.04074779897928238, 0.0111464848741889, -7.068007835187018e-05, -0.012798617593944073, -0.046923454850912094, 0.01238738838583231, 0.04611542448401451, -0.010930048301815987, -0.05480174720287323, -0.016737764701247215, 0.025698238983750343, 0.02359158918261528, -0.001998431282117963, 0.01884441263973713, 0.013238705694675446, 0.024587197229266167, 0.0030084687750786543, -0.014277600683271885, 0.003809284185990691, 0.01806524209678173, 0.01709849201142788, 0.04960726946592331, 0.018700122833251953, -0.037890832871198654, 0.0397377610206604, -0.0011155502870678902, 0.04631743207573891, 0.007726786658167839, -0.03887201473116875, -0.01067032478749752, 0.024111038073897362, 0.021210787817835808, -0.03742910176515579, -0.015583435073494911, 0.06850939989089966, -0.010764113627374172, -0.01520827878266573, 0.012748115696012974, -0.006864647381007671, 0.026001250371336937, -0.02134064957499504, -0.024875780567526817, -0.005634566303342581, -0.01442189235240221, 0.01626160368323326, -0.02551066130399704, 0.0009703574469313025, 0.007384095340967178, -0.01512170396745205, -0.025250935927033424, 0.019147424027323723, -0.012820261530578136, -0.020633623003959656, -0.0376022532582283, -0.007275877054780722, -0.02353387326002121, 0.014306459575891495, -0.0225815512239933, 0.008787325583398342, -0.01732935756444931, 0.03442784771323204, -0.0076329973526299, -0.03082057274878025, -0.00025837120483629405, -0.01810852810740471, -0.04057464748620987, 0.021369507536292076, 0.02370702289044857, 0.010598178952932358, -0.05468631535768509, -0.05794729292392731, 0.02578481286764145, 0.048395223915576935, -0.034514423459768295, -0.028800496831536293, 0.00846267119050026, -0.010122017934918404, 0.04268129914999008, -0.027328727766871452, 0.022307399660348892, -0.010930048301815987, -0.043143030256032944, 0.006128763314336538, 0.01100940816104412, -0.045913416892290115, 0.025539519265294075, -0.00424937205389142, -0.002007449511438608, -0.05027100816369057, 0.027978038415312767, 0.05846673995256424, 0.016665618866682053, 0.02894478850066662, 0.014407463371753693, 0.012748115696012974, -0.005869039334356785, 0.01754579320549965, 0.006561636459082365, -0.011680361814796925, -0.009840650483965874, -0.016290461644530296, 0.01529485359787941, -0.0025936318561434746, -0.017848804593086243, -0.006796109490096569, 0.023721450939774513, -0.014046735130250454, -0.005439773201942444, -0.03685193881392479, 0.03927602991461754, 0.004346768371760845, 0.0031419380102306604, 0.014003448188304901, 0.02048933133482933, 0.07024089246988297, 0.04334503784775734, -0.03589961677789688, -0.041786693036556244, 0.00031541124917566776, 0.029550811275839806, -0.009746861644089222, 0.0031924399081617594, -0.05356084555387497, -0.030791712924838066, 0.04776034504175186, -0.04666373133659363, -0.010482746176421642, 0.03442784771323204, -0.0021625624503940344, -0.04773148521780968, -0.0397377610206604, 0.04928983002901077, 0.005241373088210821, -0.017516935244202614, 0.015785442665219307, -0.0013112450251355767, -0.06129484623670578, 0.0302434079349041, -0.023014424368739128, 0.03301379457116127, 0.02838205359876156, -0.013224276714026928, -0.0082390196621418, 0.008787325583398342, 0.0046137068420648575, -0.022653697058558464, 0.034860722720623016, -0.0480777844786644, 0.03768882527947426, 0.002573791891336441, -0.006518349051475525, 0.034514423459768295, 0.02725658193230629, 0.02545294351875782, -0.02510664612054825, -0.0424504317343235, -0.02004203014075756, 0.006893505807965994, -0.02969510108232498, 0.044326215982437134, 0.0305319894105196, -0.04149810969829559, 0.08241906017065048, -0.05145419389009476, -0.00448745209723711, 0.005760821048170328, -0.015222707763314247, 0.02719886600971222, 0.017646797001361847, -0.006734785623848438, -0.015092846006155014, 0.023216431960463524, -0.021874526515603065, -0.030387699604034424, 0.0313977375626564, 0.007827790454030037, -0.045797985047101974, -0.0302434079349041, 0.023158716037869453, 0.009414992295205593, 0.04911667853593826, 0.012084376998245716, -0.005630958825349808, -0.011947300285100937, 0.022898992523550987, -0.05670639127492905, 0.027501877397298813, 0.017863234505057335, -0.052406515926122665, -0.005353198386728764, 0.047096602618694305, -0.022985566407442093, 0.02285570465028286, -0.004115902818739414, -0.0001734874676913023, -0.05165620148181915, -0.030214549973607063, -0.0019064457155764103, -0.009948869235813618, -0.0021517404820770025, 0.011355707421898842, 0.003277210984379053, -0.04132496193051338, 0.015323711559176445, 0.023735880851745605, -0.01374372374266386, -0.06054453179240227, -0.004660601262003183, -0.003993255086243153, 0.006814145483076572, -0.00809472892433405, 0.05650438368320465, -0.007236197125166655, 0.020114174112677574, 0.011543285101652145, -0.03589961677789688, 0.03076285496354103, -0.005187263712286949, -0.006723963655531406, -0.0928657278418541, -0.017430361360311508, 0.005288267508149147, 0.008361667394638062, 0.003358374582603574, -0.03607276827096939, 0.0013689615298062563, 0.02139836549758911, -0.016853196546435356, -0.0010533247841522098, -0.03867000713944435, -0.0335332453250885, -0.0001048928388627246, 0.007878292351961136, -0.008707965724170208, -0.011334063485264778, 0.057774145156145096, 0.009400563314557076, 0.018555831164121628, 0.01591530442237854, -0.005349591374397278, -0.00813080184161663, 0.022047674283385277, -0.020777912810444832, -0.025020070374011993, 0.005176442209631205, 0.016752192750573158, -0.03206147626042366, 0.04204641655087471, 0.008311165496706963, -0.00585460988804698, 0.00383814238011837, 0.04334503784775734, -0.0069115422666072845, -0.013642720878124237, -0.010958906263113022, -0.00928513053804636, 0.03589961677789688, 0.006731178145855665, 0.017401503399014473, 0.039478037506341934, -0.015251565724611282, 0.013750938698649406, -0.0535031296312809, 0.02911793813109398, -0.023735880851745605, -0.01901756227016449, 0.06065996363759041, 0.03012797422707081, 0.0039175027050077915, 0.015814300626516342, -0.04853951558470726, -0.05604264885187149, -0.04634629189968109, -0.022422831505537033, 0.014061164110898972, -0.02320200391113758, 0.05084817111492157, -0.014760976657271385, 0.013426283374428749, 0.033042654395103455, 0.005216122139245272, -0.020792342722415924, 0.000718749884981662, -0.006042188499122858, 0.04706774652004242, -0.0014843943063169718, 0.013476785272359848, -0.03647678345441818, -0.005526348017156124, 0.01100219413638115, 0.010136447846889496, 0.00637766532599926, 0.01562672294676304, 0.02149936929345131, -0.004646172281354666, -0.0046173143200576305, 0.05907276272773743, 0.01591530442237854, -0.016016308218240738, -0.003140134271234274, -0.014104451984167099, 0.05410914868116379, -0.0028010504320263863, 0.0038128914311528206, 0.028930358588695526, -0.07884063571691513, -0.038352563977241516, -0.05018443241715431, 0.04014177620410919, 0.0009730628808028996, -0.024846922606229782, -0.006413737777620554, -0.019782304763793945, 0.022595981135964394, -0.009999371133744717, 0.006193694192916155, -0.03396611660718918, 0.06897112727165222, -0.043604761362075806, 0.029954826459288597, 0.0019605548586696386, 0.01450846716761589, -0.004180833697319031, -0.009292344562709332, -0.008650249801576138, 0.0026784029323607683, -0.014623899944126606, 0.00420608464628458, -0.006933185737580061, 0.027905892580747604, -0.0032303163316100836, -0.016232745721936226, -0.0148764094337821, -0.007503135595470667, 0.013577789068222046, 0.014515681192278862, -0.0014979216502979398, 0.015554577112197876, -0.006305519491434097, -0.0068213604390621185, 0.013332494534552097, -0.028988076373934746, 0.01419824082404375, -0.02652069739997387, 0.0048517873510718346, 0.01715620793402195, 0.036880798637866974, -0.029868250712752342, -0.020922204479575157, 0.004440557677298784, 0.008772896602749825, -0.002595435595139861, 0.018310535699129105, 0.0260733962059021, -0.01845482736825943, -0.010295167565345764, -0.023505015298724174, 0.005905111785978079, -0.01391687337309122, -0.031138012185692787, -0.04677916318178177, -0.014032306149601936, 0.013613861985504627, 0.015453573316335678, 0.020417185500264168, 0.010540462099015713, -0.018223961815238, -0.0054542021825909615, -0.05053073167800903, -0.009508781135082245, -0.002184205921366811, 0.0060277595184743404, -0.004072615411132574, -0.009018192067742348, 0.0036722077056765556, -0.03864114731550217, 0.011499998159706593, -0.03151316940784454, 0.017257211729884148, 0.026664989069104195, -0.03035883978009224, 0.03405269235372543, -0.0015574416611343622, -0.05416686832904816, 0.01958029717206955, 0.0076113538816571236, 0.040892086923122406, 0.00045654596760869026, 0.017848804593086243, -0.004631743300706148, -0.010915619321167469, -0.012192594818770885, 0.014991842210292816, -0.03968004509806633, 0.0017883074469864368, 0.0024962355382740498, -0.02031618170440197, 0.03240777552127838, 0.0321769081056118, -0.012502821162343025, 0.033158086240291595, -0.005991686601191759, 0.01108876895159483, 0.005786071997135878, 0.046086568385362625, -0.03200376033782959, 0.044095348566770554, 0.020474903285503387, 0.026333119720220566, 0.03468757122755051, 0.016550185158848763, -0.03815056011080742, -0.0078494343906641, -0.003028308739885688, 0.014082808047533035, -0.011240273714065552, 0.02134064957499504, -0.03555331751704216, 0.008664678782224655, 0.020417185500264168, 0.014378604479134083, -0.0002746039244811982, -0.0020994350779801607, -0.003329516388475895, -0.03194604068994522, -0.0020669696386903524, 0.014176597818732262, -0.011853511445224285, 0.01069196779280901, -0.002741530304774642, 0.0048481798730790615, 0.010417815297842026, -0.009104765951633453, -0.05933248624205589, 0.004029328003525734, 0.01266875583678484, -0.019681300967931747, 0.011954515241086483, -0.015511290170252323, -0.03437013179063797, -0.010475531220436096, 0.02539522759616375, 0.008065870963037014, 0.0027000466361641884, -0.005515526048839092, 0.01253167912364006, -0.016102883964776993, 0.017011916264891624, -0.013606647960841656, 0.03491843864321709, 0.0014032305916771293, 0.007174873258918524, 0.0003090985119342804, 0.021254073828458786, 0.012142092920839787, -0.025323081761598587, -0.023793596774339676, -0.05321454629302025, -0.02370702289044857, -0.019161853939294815, 0.006936793215572834, 0.005959221161901951, -0.017127349972724915, 0.013152130879461765, 0.006384879816323519, -0.0042385500855743885, 0.012228667736053467, 0.01636260747909546, -0.028353195637464523, -0.005501097068190575, -0.005739177111536264, 0.03070513904094696, -0.002579202875494957, 0.002647740999236703, 0.0010452084243297577, -0.00416279723867774, -0.005266624037176371, 0.010381742380559444, 0.021571515128016472, 0.006269447039812803, -0.007445419207215309, 0.03171517699956894, -0.04025720804929733, 0.009313988499343395, -0.03561103716492653, 0.014147738926112652, -0.026203257963061333, -0.018223961815238, 0.0198688805103302, 0.0002563420857768506, -0.003060774179175496, 0.0554366298019886, -0.014580612070858479, 0.0006470552762039006, -0.015338140539824963, 0.02510664612054825, -0.018353823572397232, 0.01512170396745205, 0.013570575043559074, 0.033042654395103455, -0.054772887378931046, -0.011521642096340656, 0.0305319894105196, 0.00225635152310133, 0.003726316848769784, -0.02438518963754177, -0.019840022549033165, -0.009321202524006367, 0.0017341983038932085, -0.028136758133769035, 0.014818692579865456, 0.03047427348792553, 0.019277285784482956, -0.034225840121507645, 0.02579924277961254, -0.011593786999583244, -0.017848804593086243, 0.018267249688506126, 0.030099116265773773, -0.024803634732961655, -0.0059772576205432415, 0.006085475906729698, -0.01704077422618866, -0.01442189235240221, -0.049982424825429916, -0.024515053257346153, 0.04069007933139801, 0.012084376998245716, 0.009616999886929989, 0.016910912469029427, -0.043200746178627014, -0.09217313677072525, 0.024139896035194397, -0.021802380681037903, -0.004895074293017387, -0.02149936929345131, -0.005789679009467363, -0.03030112385749817, -0.005151191260665655, 0.021023208275437355, -0.0391605943441391, 0.02822333201766014, -0.012885192409157753, 0.01543914433568716, -0.048452939838171005, 0.03523587808012962, 0.014934125356376171, 0.005915933754295111, -0.010035444051027298, -0.043547045439481735, 0.005237765610218048, -0.022711414843797684, 0.0009676519548520446, -0.019003134220838547, 0.021860096603631973, -0.006190086714923382, -0.03087828867137432, -0.016377035528421402, -0.008909973315894604, -0.062160592526197433, 0.022725842893123627, 0.042306140065193176, -0.016954200342297554, -0.014818692579865456, 0.006478669121861458, -0.004126724321395159, -0.02066248096525669, -0.0014564379816874862, 0.02178795076906681, 0.026318689808249474, 0.010706396773457527, 0.030791712924838066, -0.006803323980420828, 0.009133624844253063, -0.026910284534096718, 0.004123117309063673, -0.040661223232746124, -0.0015366998268291354, 0.03312923014163971, 0.019551439210772514, -0.012719257734715939, 0.021629231050610542, -0.008657463826239109, -0.0003884586039930582, -0.02246611937880516, -0.024024462327361107, 0.022826846688985825, -0.02318757399916649, 0.03532245382666588, -0.005962828174233437, 0.017516935244202614, 0.0033186946529895067, -0.016276031732559204, 0.016694476827979088, -0.02002760022878647, -0.028425339609384537, 0.0010902993381023407, -0.012935694307088852, -0.031022580340504646, -0.024067750200629234, 0.009883938357234001, -0.011637074872851372, 0.011846296489238739, 0.013736509718000889, 0.008837827481329441, -0.002184205921366811, 0.017141778022050858, -0.0035946511197835207, -0.02099435031414032, -0.021831238642334938, -0.02900250442326069, -0.013642720878124237, -0.03636134788393974, 0.028064612299203873, -0.004956398159265518, -0.008275092579424381, -0.0038706078194081783, 0.0005970043130218983, -0.008065870963037014, -0.007979296147823334, 0.013787011615931988, 0.023909030482172966, 0.006666247267276049, 0.003592847613617778, -0.05067502334713936, -0.009631428867578506, -0.015395856462419033, -0.0025196827482432127, 0.0003255567280575633, 0.004776034504175186, -0.011889584362506866, 0.025669381022453308, 0.023562731221318245, 0.01626160368323326, 0.01895984634757042, -0.016636760905385017, 0.007340807933360338, 0.031859468668699265, 0.013058342039585114, 0.019320573657751083, 0.025250935927033424, 0.0018902129959315062, 0.0066373893059790134, 0.0647578313946724, 0.015395856462419033, -0.02399560436606407, 0.018815554678440094, 0.0604868158698082, 0.0020777913741767406, 0.004801285453140736, -0.0445859394967556, -0.004804892465472221, 0.026232115924358368, 0.007835005410015583, -0.019508153200149536, 0.0024818063247948885, 0.07387702912092209, -0.003271800000220537, 0.04770262539386749, -0.012199809774756432, 0.0010948084527626634, 0.010309596545994282, -0.008729609660804272, -0.007986510172486305, 0.012041089124977589, 0.006071046460419893, -0.03151316940784454, -0.018714550882577896, -0.02375030890107155, 0.0016043363139033318, -0.011132055893540382, 0.019840022549033165, 0.0034088764805346727, 0.00536041334271431, -0.02595796249806881, -0.011023837141692638, -0.001062343013472855, 0.012892406433820724, 0.012834690511226654, -0.023836884647607803, 0.03393726050853729, -0.003553167451173067, 0.0025196827482432127, -0.01810852810740471, 0.003334927372634411, 0.06117941439151764, 0.016290461644530296, -0.03142659366130829, 0.004299873951822519, -0.048395223915576935, 0.026881426572799683, 0.007575280964374542, 0.0459422767162323, 0.004718318115919828, 0.023447299376130104, 0.054657455533742905, -0.02370702289044857, -0.04028606787323952, -0.02245168946683407, -0.011543285101652145, -0.022379545494914055, -0.024529481306672096, -0.004588455893099308, -0.021066496148705482, -0.045682553201913834, 0.009869509376585484, 0.021629231050610542, 0.012762544676661491, -0.0015484235482290387, -0.012185380794107914, 0.020575907081365585, 0.03359096124768257, 0.003968004137277603, 0.006074653938412666, 0.021456081420183182, 0.013411854393780231, 0.017964238300919533, -0.002182402415201068, -0.02393788844347, -0.009588140994310379, -0.005566027946770191, 0.06418066471815109, 0.00585460988804698, -0.012452319264411926, 0.017747800797224045, -0.0006768152816221118, -0.018945416435599327, -0.012120449915528297, 0.036419063806533813, 0.01682433858513832, 0.019118566066026688, -0.03523587808012962, 0.04193098470568657, 0.06458467990159988, -0.007384095340967178, -0.05053073167800903, 0.029132366180419922, -0.045913416892290115, -0.028973646461963654, -0.02037389948964119, -0.012798617593944073, 0.013527287170290947, -0.006579672452062368, -0.034745290875434875, -0.025986820459365845, -0.013592218980193138, 0.040488071739673615, -0.021470511332154274, 0.009184126742184162, -0.002461966359987855, -0.010800186544656754, 0.025207649916410446, -0.05055959150195122, -0.010280738584697247, -0.010208592750132084, 0.0007764663314446807, 0.006305519491434097, 0.00942942127585411, 0.013152130879461765, 0.0012706632260233164, -0.007582495454698801, -0.02669384703040123, 0.005670638754963875, -0.005908719263970852, -0.009010977111756802, 0.008000940084457397, -0.004054578952491283, 0.015107274986803532, -0.011824652552604675, 0.03878543898463249, -0.01760351099073887, 0.03361981734633446, -0.0003577967581804842, 0.01680990867316723, -0.04926097020506859, 0.01816624589264393, 0.0028569630812853575, 0.03506273031234741, 0.016636760905385017, 0.015381427481770515, -0.027848176658153534, -0.01383029855787754, 0.02630426175892353, 0.008311165496706963, -0.009039835073053837, 0.017863234505057335, 0.0012679577339440584, 0.02455833926796913, 0.02923336997628212, -0.003637938527390361, 0.00782057549804449, 0.011896798387169838, -0.012611038982868195, -0.008188517764210701, -0.033879540860652924, 0.020965492352843285, 0.008188517764210701, -0.034514423459768295, 0.005760821048170328, 0.006190086714923382, -0.007921579293906689, -0.010937263257801533, 0.013159344904124737, 0.009718003682792187, 0.002454751869663596, 0.002647740999236703, -0.03318694606423378, -0.03633249178528786, -0.01659347303211689, 0.019233999773859978, -0.0011913031339645386, 0.0012968159280717373, 0.03725595399737358, -0.018382681533694267, -0.009681930765509605, -0.02388017252087593, 0.006060224957764149, -0.037025086581707, -0.053243402391672134, -0.0019749840721488, -0.021138641983270645, 0.016377035528421402, -0.01105991005897522, 0.003968004137277603, 0.0020489331800490618, 0.0034990583080798388, -0.00520530017092824, 0.011435067281126976, 0.0297528188675642, -0.012235882692039013, 0.011774150654673576, -0.0002198184229200706, 0.022393973544239998, 0.026102254167199135, -0.004491059575229883, -0.004887859802693129, -0.007041404023766518, 0.000717397138942033, -0.025409657508134842, -0.01828167773783207, -0.007972081191837788, -0.004429735708981752, 0.024587197229266167, 0.006680676247924566, 0.035928476601839066, -0.017675654962658882, -0.016463611274957657, 0.030791712924838066, -0.0009703574469313025, 0.025366369634866714, 0.006135977804660797, -0.024414049461483955, -0.022711414843797684, 0.026895854622125626, 0.022783558815717697, 0.007964867167174816, 0.05188706889748573, 0.008534817025065422, 0.017459219321608543, 0.0002299638872500509, -0.0024872173089534044, -0.012885192409157753, -0.017011916264891624, 0.04282558709383011, 0.002943537663668394, -0.04389334097504616, -0.003632527543231845, -0.019969884306192398, 0.06123713031411171, -0.007290306035429239, -0.009718003682792187, -0.039651185274124146, -0.010742469690740108, 0.021513797342777252, 0.03393726050853729, -0.0017810928402468562, 0.019089708104729652, -0.021816808730363846, -0.004934754688292742, 0.020171891897916794, -0.013628290966153145, 0.10665995627641678, -0.022163107991218567, -0.026506269350647926, 0.013664363883435726, 0.015222707763314247, -0.03523587808012962, -0.0156988687813282, 0.025193220004439354, -0.02760288119316101, -0.008303950540721416, 0.017574651166796684, 0.025654951110482216, 0.03561103716492653, 0.016405893489718437, 0.008845042437314987, 0.004137546289712191, -0.004797677975147963, -0.0025755956303328276, 0.009782934561371803, 0.019031992182135582, 0.013895229436457157, -0.02624654583632946, 0.03907402232289314, -0.023331865668296814, -0.03768882527947426, -0.01732935756444931, 0.021643660962581635, -0.009400563314557076, -0.007928794249892235, 0.04452822357416153, 0.03093600459396839, -0.007734001148492098, -0.013310850597918034, -0.008592532947659492, 0.004887859802693129, 0.035928476601839066, 0.01744478940963745, -0.035697609186172485, -0.022783558815717697, -0.0005694988067261875, -0.006200908683240414, -0.019969884306192398, 0.016001880168914795, -0.0027271010912954807, 0.012914050370454788, 0.03584190085530281, -0.010186949744820595, -0.013260348699986935, 0.017055204138159752, 0.0006362334243021905, 0.029420949518680573, 0.0002928657631855458, 0.03070513904094696, 0.0005915933870710433, -0.0011335867457091808, -0.014595041051506996, -0.0011173539096489549, 0.030503131449222565, 0.004714710637927055, 0.011269132606685162, -3.528367597027682e-05, 0.006868254859000444, -0.015395856462419033, 0.00027640757616609335, -0.011297990567982197, -0.03719823807477951, 0.014032306149601936, 0.018887700513005257, -0.05188706889748573, -0.02269698493182659, -0.03996862471103668, -0.005634566303342581, -0.0071388003416359425, 0.03460099920630455, -0.026491839438676834, 0.016607901081442833, -0.033879540860652924, -0.010028229095041752, 0.007016153074800968, -0.007311949972063303, 0.013505644164979458, -0.010165305808186531, -0.016896484419703484, -0.01543914433568716, -0.022653697058558464, -0.03243663161993027, 0.008289521560072899, -0.006280268542468548, -0.0016259800177067518, 0.0012886995682492852, -0.014667186886072159, 0.017343785613775253, 0.005944792181253433, -0.004032935481518507, 0.007936008274555206, -0.029449807479977608, -0.004635350313037634, -0.008765682578086853, -0.0008923500427044928, 0.004960005637258291, 0.02027289569377899, 0.0031202943064272404, 0.029377661645412445, -0.0028912322595715523, 0.006085475906729698, -0.005259409546852112, -0.02252383530139923, 0.00550470408052206, 0.015222707763314247, 0.0076329973526299, -0.045567117631435394, -0.023043284192681313, 0.034456707537174225, 0.021008780226111412, 0.026881426572799683, -0.03128230199217796, 0.021975530311465263, -0.013924088329076767, 0.039651185274124146, -0.0010271720821037889, 0.0024204826913774014, -0.02737201564013958, 0.012365744449198246, -0.04175783321261406, -0.012098805978894234, -0.031801752746105194, 0.03012797422707081, 0.010994979180395603, 0.012416246347129345, -0.018137387931346893, 0.011536071076989174, 0.005241373088210821, 0.007604139391332865, -0.021427223458886147, -0.00010060919885290787, -0.019104138016700745, -0.014118880964815617, -0.012928479351103306, -0.01631931960582733, -0.015468002296984196, -0.024471765384078026, -0.026116684079170227, -0.022393973544239998, -0.002741530304774642, -0.010908404365181923, -0.012654326856136322, 0.013801440596580505, -0.00013403287448454648, 0.00550470408052206, 0.004285444505512714, -0.031022580340504646, 0.03656335547566414, -0.023101000115275383, 0.020777912810444832, -0.054772887378931046, 0.029334373772144318, -0.0424504317343235, 0.025207649916410446, -0.039651185274124146, 0.007272269576787949, -0.028194474056363106, 0.0099344402551651, 0.023317435756325722, 0.013101628981530666, -0.0047940704971551895, 0.04161354526877403, -0.016853196546435356, -0.02093663439154625, 0.013585004024207592, 0.02590024657547474, -0.0019731803331524134, -0.03206147626042366, -0.017863234505057335, -0.009414992295205593, 0.04363361746072769, 0.020114174112677574, 0.0003780876868404448, -0.019623585045337677, -0.02155708521604538, 0.00379485497251153, -0.01750250719487667, -0.046865738928318024, 0.020128604024648666, 0.030791712924838066, 0.0017360019264742732, 0.026448553428053856, 0.012127663940191269, -0.02139836549758911, 0.018353823572397232, -0.009602570906281471, 0.014977413229644299, 0.013642720878124237, -0.010186949744820595, 0.02320200391113758, -0.021643660962581635, 0.006345199886709452, -0.009797363542020321, -0.08617062866687775, -0.025828100740909576, 0.004501881077885628, -0.004833750892430544, -0.006244196090847254, 0.0019389112712815404, -0.001991216791793704, -0.015987450256943703, 0.01698305830359459, -0.0198688805103302, 0.003302461700513959, -0.001186794019304216, -0.021484939381480217, -0.013700436800718307, -0.008643034845590591, 0.03477414697408676, 0.007798932027071714, 0.033879540860652924, 0.014522896148264408, -0.036043908447027206, 0.009754076600074768, 0.005522740539163351, -0.003199654398486018, -0.02826661989092827, 0.007348022423684597, 0.025323081761598587, -0.020792342722415924, -0.00743820471689105, 0.029204512014985085, 0.025048930197954178, -0.01221423875540495, -0.01947929337620735, -0.02861291915178299, 0.03933374583721161, 0.030791712924838066, -0.01012923289090395, 0.028064612299203873, 0.01862797699868679, -0.0031347235199064016, 0.014602256007492542, -0.0321769081056118, 0.016636760905385017, -0.026939142495393753, 0.012416246347129345, -0.016853196546435356, 0.017646797001361847, -0.0006876371335238218, -0.0006488588987849653, 0.04256586357951164, -0.026664989069104195, 0.009350061416625977, 0.005865431856364012, 0.016160599887371063, 0.0002982766891364008, 0.025813672691583633, 0.002597239101305604, -0.03012797422707081, -0.016752192750573158, -0.019969884306192398, -0.0240388922393322, -0.028309907764196396, -0.03506273031234741, 0.01607402414083481, -0.023216431960463524, -0.00416279723867774, 0.015727726742625237, -0.03864114731550217, 0.008859471417963505, -0.0029453414026647806, -0.014400248415768147, -0.027862604707479477, 0.01816624589264393, 0.01517941989004612, 0.0013536305632442236, 0.011160913854837418, -0.006500312592834234, -0.0004396368458401412, -0.0264629814773798, -0.012892406433820724, -0.00947992317378521, -0.01924842782318592, 0.047038886696100235, 0.0030066650360822678, -0.028410911560058594, -0.0012742704711854458, -0.005266624037176371, 0.008080299943685532, -0.004170011729001999, -0.027516307309269905, 0.01168757677078247, -0.008881115354597569, 0.004808499943464994, -0.0035603821743279696, 0.019407149404287338, 0.008592532947659492, -0.0008878409862518311, 0.006514741573482752, 0.006507527083158493, 0.01002101507037878, 0.04426850005984306, -0.0006696007330901921, 0.04092094674706459, -0.008902759291231632, -0.05739898607134819, -0.0070017240941524506, -0.0069079347886145115, -0.007777288556098938, -0.009984942153096199, 0.027689455077052116, 0.012654326856136322, 0.013281992636620998, 0.017257211729884148, -0.0014275797875598073, -0.02708343416452408, -0.03240777552127838, 0.03872772306203842, 0.03471643105149269, 0.006236981600522995, 0.030012542381882668, 0.0010190557222813368, 0.007452633697539568, -0.022956708446145058, -0.018353823572397232, 0.004458594135940075, -0.005281053017824888, 0.026506269350647926, -0.007546423003077507, 0.03465871512889862, -0.014760976657271385, -0.012849119491875172, -0.043027594685554504, -0.007936008274555206, 0.01419102679938078, 0.02020074985921383, -0.016853196546435356, 0.00496722012758255, -0.026174400001764297, -5.1882783736800775e-05, -0.008715180680155754, 0.04911667853593826, 0.01575658470392227, 0.004458594135940075, -0.025467373430728912, 0.015078416094183922, -0.020301753655076027, 0.02027289569377899, 0.027675027027726173, -0.0009103864431381226, 0.013945731334388256, -0.013621076941490173, -0.01620388776063919, -0.024183182045817375, -0.04741404578089714, 0.002182402415201068, 0.007257840596139431, 0.017935380339622498, -0.0035170947667211294, -0.026794850826263428, 0.0350915864109993, 0.0031491525005549192, -0.012091591022908688, -0.003989648073911667, -0.002647740999236703, -0.026159970089793205, -0.028367623686790466, 0.005057401955127716, 0.003946360666304827, -0.038179416209459305, 0.012654326856136322, 0.021355077624320984, -0.004133939277380705, 0.004602884873747826, 0.004177226219326258, -0.0024944317992776632, -0.007178480736911297, -0.009984942153096199, -0.02066248096525669, -0.010944477282464504, -0.03070513904094696, -0.018988704308867455, -0.014587827026844025, -0.021989958360791206, -0.011716434732079506, 0.006099904887378216, -0.004278230015188456, -0.0205470472574234, 0.007921579293906689, 0.020965492352843285, 0.020864488556981087, -0.009725217707455158, 0.00424937205389142, 0.010201378725469112]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
" of the frozen ground bringing fresh water on her skin.“Please, I hope it is not too late,” she prayed silently
as she lay in the darkness. But she knew it was a hopeless prayer.
Table 7: Randomly sampled example of OOD prompt from Ultra-Chat.
51
Table 8: Hyper-parameters for fine-tuning Open-LLaMA-3B-V2. SFT-RLHF means that we finetune the
models on the preferred samples. Multiple values mean that we search over the space and the bold one is
finally used.
Models Hyper-parameter Value
Learning rate 1×10−5
Scheduler Cosine decay with 0.03 warm-up
SFT-RLHF Epoch 2
Batch size 12
Block size 2048
Learning rate 1×10−6
DPO Batch size 32
KL coefficient 0.1
Max lenght of prompt 400
Learning rate {1×10−6,5×10−6}
Batch size 32
RSO KL coefficient 0.1
Rejection sampling coefficient 0.5
Rejection sampling candidates and accepted samples {8−2,24−2,24−6}
Offline loop epochs 3
KL path {0.5→0.3→0.1}
Multi-step RSO Learning rate 1×10−6
Batch size 32
KL coefficient (3 iters) 0.5,0.3,0.1
Rejection sampling coefficient 3
Rejection sampling candidates and accepted samples 8−2
Online loop epochs 3
Learning rate 1×10−6
Hybrid GSHF Batch size 32
Preference queries of each epoch 2.5×104
KL coefficient 0.1
Online loop epochs 3
Learning rate 5×10−7
Online GSHF DPO Batch size 64
Preference queries of each epoch 2×104
KL coefficient 0.1
best-of-n 8
52
Table 9: Hyper-parameters for auxiliary training.
Models Hyper-parameter Value
Learning rate 1×10−5
Scheduler Cosine decay with 0.03 warm-up
SFT before RLHF Epoch 1
Batch size 12
Block size 2048
Learning rate 3×10−5
RM SFT 1.3B Scheduler Cosine decay with 0.03 warm-up
Epoch 2
Batch size 80
Block size 2048
Learning rate 1×10−5
RM Training 1.3B Scheduler Cosine decay with 0.03 warm-up
Epoch 1
Batch size 80
Learning rate 5×10−6
RM Training 3B Scheduler Cosine decay with 0.03 warm-up
Epoch 1
Batch size 16
Temperature 1.0
Data generation Max new token 400
Do sample True
Temperature 1.0
Test Settings Max new token 400
Do sample True
53
","[-0.02089100517332554, -0.014664906077086926, 0.0676325336098671, -0.022996891289949417, 0.010758333839476109, -0.019273441284894943, 0.016068831086158752, 0.003088252153247595, -0.011010124348104, 0.028292128816246986, 0.022829031571745872, -0.020387424156069756, -0.03335846588015556, 0.031038938090205193, 0.02319527231156826, -0.019609160721302032, 0.01068966370075941, -0.00791996531188488, -0.037387117743492126, 0.024232955649495125, 0.003326690522953868, -0.05722517892718315, 0.004532234277576208, 0.03320586308836937, 0.031588297337293625, -0.012459829449653625, 0.05930054560303688, -0.01646559126675129, 0.04581066220998764, -0.02994021400809288, 0.012299598194658756, -0.03937092423439026, -0.02998599410057068, -0.02614046260714531, 0.0013943868689239025, 0.006275694817304611, 0.01320757158100605, 0.03335846588015556, -0.015763629227876663, -0.029543451964855194, -0.04321645572781563, -0.09912927448749542, -0.04590222239494324, 0.0161451306194067, -0.02382093481719494, 0.022661171853542328, 0.04254501312971115, -0.007137887179851532, 0.030031774193048477, 0.003755879355594516, -0.0381806381046772, 0.05820182338356972, -0.05701153725385666, 0.0075499084778130054, 0.03592215105891228, -0.012726879678666592, 0.0005403010873124003, -0.0016395014245063066, 0.05988042801618576, -0.03763127699494362, -0.019258180633187294, -0.04138524830341339, 0.01426051463931799, 0.05106012150645256, 0.0063023995608091354, -0.010636253282427788, -0.06323763728141785, 0.03876052051782608, -0.005867488216608763, 0.051823124289512634, -0.00956042017787695, -0.01854095794260502, 0.0558517761528492, -0.06531300395727158, -0.013833233155310154, 0.028017448261380196, 0.007057772018015385, 0.017503274604678154, -0.025072257965803146, -0.03982872515916824, -0.00025274453219026327, 0.015092187561094761, -0.0016366401687264442, -0.027468087151646614, -0.002723918529227376, -0.041293688118457794, -0.051517922431230545, -0.010773593559861183, -0.023424172773957253, -0.0468788668513298, -0.0469704270362854, -0.012078328058123589, -0.014291035011410713, 0.02968079410493374, 0.03293118253350258, -0.0322292223572731, 0.02903987094759941, 0.0026209133211523294, -0.015672069042921066, 0.0055470275692641735, 0.019014019519090652, -0.008461697027087212, 0.014077394269406796, -0.008080195635557175, 0.021837128326296806, 0.00631002988666296, -0.024293996393680573, 0.003027212107554078, 0.004951885435730219, 0.005405872128903866, -0.06323763728141785, -0.03427406772971153, -0.06946373730897903, 0.015672069042921066, -0.00352697866037488, -0.03668515384197235, -0.033602625131607056, 0.012612429447472095, -0.008019154891371727, -0.01648085191845894, -0.033877305686473846, 0.00023819980560801923, 0.04053068906068802, -0.0027639761101454496, -0.028551548719406128, 0.0037272667977958918, 0.02441607601940632, -0.050663359463214874, -0.03692931681871414, 0.03177142143249512, 0.013985834084451199, -0.013787453062832355, -0.0007496498292312026, -0.022401750087738037, -0.012963410466909409, 0.004406339023262262, -0.021364066749811172, -0.0004072525189258158, -0.017793215811252594, -0.00490610534325242, -0.03763127699494362, 0.008843197487294674, -0.01764061488211155, 0.018663039430975914, -0.02527063898742199, 0.010582842864096165, -0.048649031668901443, 0.021943949162960052, -0.016312990337610245, 0.01785425655543804, -0.02582000195980072, -0.01991436257958412, -0.02084522508084774, 0.00953753013163805, 0.0528608076274395, -0.048587992787361145, -0.006844131276011467, 0.042728133499622345, 0.030474316328763962, -0.031832460314035416, 0.010651513002812862, 0.01794581674039364, 0.01971598155796528, -0.0003786399320233613, 0.013108381070196629, -4.276986146578565e-05, -0.005321941804140806, 0.013444102369248867, -0.09906823188066483, -0.03641047328710556, 0.03341950476169586, 0.007572798989713192, -0.03723451867699623, -0.04736718907952309, -0.009255219250917435, -0.00497859064489603, 0.0027792362961918116, -0.007347713224589825, -0.008431176654994488, -0.020662104710936546, -0.010132672265172005, 0.007584244012832642, -0.025118038058280945, 0.04376581683754921, -0.04248397424817085, -0.01643507182598114, 0.00028421840397641063, -0.022523831576108932, 0.05453941226005554, -0.0008493170607835054, 0.027223926037549973, -0.01962442137300968, 0.09198756515979767, -0.005394427105784416, 0.022783251479268074, -0.037448156625032425, 0.05823234096169472, -0.012276708148419857, 0.02173030748963356, 0.04614638537168503, 0.010514172725379467, 0.02295111119747162, 0.010285272262990475, -0.06928061693906784, 0.026827163994312286, -0.035067591816186905, -0.015252417884767056, -0.003217962570488453, -0.02321053296327591, 0.020448464900255203, 0.04779446870088577, 0.022447530180215836, 0.04428466036915779, -0.012398788705468178, -0.03402990847826004, 0.04932047426700592, -0.02734600566327572, -0.03192402049899101, 0.0027353635523468256, 0.02582000195980072, -0.006336735095828772, -0.021562447771430016, 0.002861259039491415, 0.05014451593160629, -0.030153853818774223, 0.022752732038497925, 0.03958456590771675, -0.03195454180240631, 0.0411716103553772, -0.03665463626384735, 0.047733429819345474, 0.03027593530714512, -0.008423546329140663, -0.0527997650206089, -0.004566569346934557, -0.002601838205009699, -0.02673560380935669, -0.01696917414665222, 0.02082996629178524, -0.04874059185385704, -0.005470727104693651, 0.026354102417826653, 0.019853321835398674, -0.004753504879772663, 0.023317353799939156, 0.009316259063780308, -0.017838995903730392, -0.08490690588951111, -0.0018140381434932351, 0.010056371800601482, 0.010155562311410904, -0.04077484831213951, -0.01558050885796547, -0.06592340767383575, -0.02345469407737255, -0.009697760455310345, -0.018556218594312668, -0.005501247476786375, -0.03287014365196228, -0.04541390389204025, -0.038607921451330185, -0.012368269264698029, 0.028688890859484673, 0.06506884098052979, 0.0031721824780106544, -0.007836034521460533, -0.036196835339069366, 0.00970539078116417, -0.02140984684228897, -0.05704205855727196, -0.007511758711189032, 0.02821582928299904, 0.006458815187215805, -0.006847946438938379, -0.03720399737358093, -0.04581066220998764, 0.05313548818230629, 0.026201501488685608, -0.03369418531656265, 0.020417943596839905, 0.001083463430404663, 0.001542218611575663, 0.05011399835348129, 0.0019227659795433283, 0.012658209539949894, -0.0007978143985383213, 0.004127842839807272, 0.004795470274984837, 0.004818360321223736, 0.007145517505705357, 0.021241987124085426, -0.022249149158596992, 0.06067395210266113, -0.04928995296359062, -0.031862981617450714, 0.012971040792763233, 0.01963968202471733, 0.04492558166384697, -0.0029375592712312937, 0.0029432817827910185, 0.0615895539522171, 0.015397388488054276, -0.03695983439683914, 0.0059895687736570835, 0.04791655018925667, 0.024248216301202774, 0.02350047416985035, -0.006863206624984741, -0.011918097734451294, -0.0026266358327120543, -0.026888204738497734, 0.049503594636917114, 0.005817893426865339, 0.03024541586637497, 0.0007062540971674025, -0.020997826009988785, 0.05264716595411301, 0.022157588973641396, 0.029558712616562843, -0.03442666679620743, -0.012192778289318085, -0.07269886881113052, 0.0011149372439831495, 0.012986300513148308, 0.028261609375476837, 0.0065045952796936035, 0.03396886587142944, -0.008431176654994488, -0.0439794585108757, -0.018128937110304832, -0.00395998265594244, -0.023073192685842514, 0.02000592276453972, -0.018556218594312668, 0.017137033864855766, -0.007374417968094349, -0.03930988162755966, 0.01455808524042368, 0.025896301493048668, 0.017823735252022743, -0.03839427977800369, -0.03647151589393616, -0.030779516324400902, 0.04053068906068802, -0.040072884410619736, 0.018586738035082817, 0.008721116930246353, 0.009278109297156334, 0.09564998000860214, 0.008904238231480122, -0.016068831086158752, 0.02554531954228878, 0.014054504223167896, -0.0029585417360067368, -0.02876519039273262, -0.024324515834450722, 0.03778387978672981, -0.04822175204753876, -0.0382721982896328, 0.01220803800970316, 0.0016042125644162297, 0.06781565397977829, 0.030901597812771797, -0.02029586397111416, 0.06360387802124023, 0.007813144475221634, -0.013871383853256702, -0.0278953667730093, -0.025652140378952026, -0.0321987010538578, -0.02585052140057087, 0.01612986996769905, -0.005028185900300741, -0.0021898169070482254, -0.05133480206131935, 0.014718316495418549, 0.03198505938053131, 0.013901903294026852, 0.013337281532585621, 0.01791529543697834, 0.003877959679812193, -0.006558005698025227, -0.009217068552970886, -0.008377766236662865, 0.04797758907079697, -0.013093121349811554, 0.003261835314333439, 0.005707257892936468, -0.028582070022821426, -0.021333547309041023, -0.015946749597787857, -0.014855656772851944, -0.004459748975932598, 0.021837128326296806, 0.058690145611763, 0.015496578998863697, -0.001727246679365635, 0.09522269666194916, 0.02820056863129139, 0.031832460314035416, -0.012429309077560902, -0.00853799656033516, -0.04642106592655182, 0.024202436208724976, -0.04877111315727234, 0.025041738525032997, 0.0205552838742733, 0.05341016873717308, 0.02705606445670128, -0.0034945509396493435, 0.014817506074905396, -0.041293688118457794, 0.015305828303098679, -0.02731548622250557, 0.0264151431620121, -0.018586738035082817, 0.0019017835147678852, 0.02638462372124195, 0.014886177144944668, 0.07141702622175217, -0.02263065055012703, -0.022813770920038223, -0.026521963998675346, -0.010666773654520512, -0.04617690667510033, 0.0025503356009721756, 0.04306385666131973, -0.019288700073957443, -0.027239184826612473, -0.024583937600255013, -0.02346995286643505, 0.034457188099622726, 0.03174090012907982, -0.032412342727184296, -0.034213028848171234, -0.027727507054805756, -0.003967612516134977, -0.017106514424085617, 0.009148398414254189, -0.014397854916751385, 0.04291125386953354, 0.024019315838813782, -0.03836376219987869, 0.004471193999052048, -0.030184375122189522, -0.015336347743868828, 0.00485651008784771, -0.006588525604456663, 0.007786439266055822, -0.005089226178824902, -0.016511371359229088, -0.05499721318483353, 0.0293450728058815, 0.005962863564491272, 0.030977897346019745, -0.035098109394311905, 0.07843664288520813, -0.007656728848814964, 0.04349113628268242, 0.0007343898178078234, -0.0031740900594741106, 0.003345765406265855, 0.003677671542391181, 0.012139367870986462, -0.00447500916197896, 0.03634943440556526, 0.01667923294007778, 0.021196207031607628, 0.028398949652910233, 0.04455934092402458, -0.02609468251466751, -0.040042366832494736, -0.00668008578941226, -0.040347564965486526, -0.001540311030112207, -0.04172097146511078, 0.01469542644917965, -0.013917163945734501, 0.01970072276890278, 0.027086585760116577, 0.033266905695199966, 0.0014888084260746837, 0.004276628606021404, 0.009491750039160252, 0.015099816955626011, 0.06113175302743912, 0.05173156410455704, -0.02000592276453972, -0.014962476678192616, -7.683672447456047e-05, 0.00792759470641613, -0.021013086661696434, 0.0023824749514460564, -0.020036442205309868, -0.0018598183523863554, -0.008003895170986652, -0.00834724586457014, -0.009041578508913517, -0.0025846706703305244, -0.029787613078951836, 0.050938040018081665, -8.089017501333728e-05, -0.004543679300695658, 0.0380890779197216, 0.012894740328192711, 0.04147680848836899, 0.006401590071618557, -0.04825226962566376, -0.019822802394628525, 0.015336347743868828, -0.005501247476786375, 0.044162578880786896, -0.04028652608394623, 0.018128937110304832, -0.004730614833533764, 0.0352507121860981, -0.013436472043395042, 0.022127069532871246, -0.029512932524085045, 0.04837435111403465, 0.002388197463005781, 0.024522896856069565, -0.019151359796524048, -0.01482513640075922, 0.044772978872060776, -0.0028765189927071333, 0.00764146912842989, -0.10376832634210587, -0.04855747148394585, -0.035983193665742874, 0.037173476070165634, -0.03050483576953411, -0.0028765189927071333, 0.037722837179899216, -0.033022742718458176, -0.008614297024905682, 0.013764563016593456, -0.02588104084134102, -0.03457926958799362, -0.025758961215615273, 0.0014735483564436436, 0.05481409281492233, 0.00953753013163805, 0.014809876680374146, 0.0039332774467766285, 0.013688262552022934, 0.04437622055411339, 0.00849221646785736, -0.005890378262847662, 0.0062985848635435104, 0.055668655782938004, -0.017747435718774796, 0.0010920471977442503, -0.010369202122092247, -0.019822802394628525, 0.01818997785449028, 0.004242293536663055, -0.008171755820512772, 0.007725399453192949, -0.0012885202886536717, 0.010132672265172005, 0.0016976803308352828, 0.013734043575823307, 0.004726799670606852, -0.03052009642124176, 0.007797884289175272, 0.012085958383977413, 0.002107794163748622, 0.007656728848814964, -0.007004362065345049, -0.029467152431607246, -0.004291888326406479, 0.01707599312067032, -0.01736593432724476, -0.01875459961593151, -0.03940144553780556, 0.027758026495575905, 0.014031614176928997, 0.020097482949495316, 0.012925260700285435, -0.0005746361566707492, -0.03171037882566452, -0.0019532861188054085, -0.001083463430404663, -0.054783571511507034, 0.009606200270354748, 0.002170741790905595, 0.060399267822504044, -0.05405109003186226, 0.02617098204791546, 0.030474316328763962, 0.014863287098705769, 0.032137662172317505, -0.002069643931463361, -0.019471820443868637, -0.012528499588370323, -0.013314391486346722, -0.024446597322821617, 0.011017754673957825, -0.014931957237422466, 0.03351106494665146, -0.00014723562344443053, 0.014771725982427597, -0.018937719985842705, -0.034762389957904816, 0.04056120663881302, -0.0014964384026825428, 0.023561513051390648, 0.028551548719406128, 0.00922469887882471, -0.01818997785449028, -0.0023042671382427216, 0.00927047897130251, -0.023576773703098297, -0.010926194489002228, 0.018571477383375168, -0.02168452739715576, -0.0008998659322969615, 0.05365432798862457, 0.00851510651409626, -0.020341644063591957, 0.008141235448420048, -0.0015622474020347, -0.011536596342921257, 0.005901823751628399, -0.002660970902070403, -0.0190445389598608, -0.028566809371113777, -0.007374417968094349, 0.013688262552022934, -0.045963265001773834, 0.01059047318994999, 0.026048902422189713, -0.01132295560091734, -0.02730022557079792, 0.04483402147889137, 0.022432269528508186, -0.006973841693252325, 0.015962010249495506, -0.02314949221909046, 0.028307389467954636, -0.007858924567699432, 0.02496543899178505, -0.03906572237610817, 0.022783251479268074, -0.0009957181755453348, -0.018067896366119385, -0.006405405234545469, -0.01073544379323721, -0.03906572237610817, -0.03415198624134064, -0.026338841766119003, -0.016038309782743454, 0.025484280660748482, 0.018342576920986176, -0.03341950476169586, -0.0006375839002430439, -0.009995331056416035, 0.012841329909861088, -0.03699035570025444, -0.030398014932870865, 0.0066686407662928104, -0.01410791464149952, -0.0020753664430230856, 0.024004055187106133, 0.03253442049026489, 0.033297423273324966, 0.04285021498799324, -0.010956714861094952, 0.005508877336978912, -0.005287606734782457, -0.007794069591909647, 0.018571477383375168, 0.02314949221909046, -0.016541892662644386, -0.021516667678952217, 0.003385823220014572, -0.06586236506700516, -0.03351106494665146, 0.028246348723769188, -0.025957342237234116, -0.0095680495724082, -0.04849643260240555, -0.026476183906197548, -0.00602008868008852, 0.01010978128761053, 0.06525196135044098, -0.01084226369857788, -0.004124028142541647, 0.002758253598585725, -0.013413581997156143, -0.00021829020988661796, 0.03851636126637459, -0.019181881099939346, 0.01965494081377983, 0.0035040886141359806, -0.008713487535715103, 0.04855747148394585, -0.015023517422378063, -0.04498662054538727, -0.016251951456069946, 0.045993782579898834, -0.011147464625537395, -0.012238558381795883, -0.014191844500601292, -0.01585518941283226, -0.014771725982427597, 0.037753358483314514, 0.05402056872844696, -0.008423546329140663, -0.011010124348104, -0.0016528539126738906, -0.020066963508725166, 0.01849517785012722, -0.00971302017569542, 0.01996014267206192, 0.02171504870057106, -0.0014401670778170228, -0.009087358601391315, 0.0069585819728672504, -0.005764483008533716, -0.015733109787106514, -0.010117411613464355, 0.0040057627484202385, -0.008446436375379562, -0.008408286608755589, -0.01641981117427349, -0.007660544011741877, -0.032107140868902206, -0.012291968800127506, 0.036593593657016754, 0.04050016775727272, 0.000967582396697253, -0.006790721323341131, -0.029238251969218254, 0.011872317641973495, -0.019899101927876472, 0.01276503037661314, -0.004234663210809231, 0.0003998609317932278, 0.0308252964168787, -0.021882908418774605, -0.017182813957333565, 0.0470009483397007, 0.025102779269218445, -0.012543759308755398, 0.012383528985083103, 0.02198972925543785, -0.009453599341213703, -0.022661171853542328, -0.015626288950443268, 0.015748368576169014, -0.005157896317541599, -0.02617098204791546, 0.033297423273324966, -0.0034010831732302904, 0.015244787558913231, 0.01934974081814289, -0.044467780739068985, 0.006760201416909695, -0.013489882461726665, 0.029894433915615082, -0.011933357454836369, 0.023622553795576096, -0.006569450721144676, 0.0038550696335732937, -0.038577400147914886, -0.024797577410936356, -0.004864140413701534, -0.01014793198555708, -0.01997540332376957, -0.02232545055449009, 0.009377299807965755, 0.012688729912042618, 0.05218936502933502, -0.039737164974212646, 0.018357837572693825, 0.00909498892724514, -0.004143103025853634, 8.65828860696638e-06, -0.027071325108408928, -0.022813770920038223, 0.014161324128508568, -0.02231018990278244, -0.020494244992733, -0.025469020009040833, -0.009934291243553162, -0.0028421839233487844, -0.007099737413227558, -0.02227967046201229, -0.005760668311268091, -0.017121773213148117, -0.0006995777948759496, -0.007076847366988659, 0.025682659819722176, 0.012444568797945976, -0.007740659173578024, -0.14210157096385956, -0.0012646764516830444, 0.02845998853445053, -0.008751637302339077, 0.02821582928299904, -0.02433977648615837, 0.0013085490791127086, 0.007427828386425972, 0.028322648257017136, -0.025011219084262848, 0.028597330674529076, -0.001411554403603077, -0.01102538499981165, 0.00013889027468394488, -0.009842731058597565, -0.037722837179899216, 0.03763127699494362, -0.016007790341973305, 0.020311124622821808, -0.01262005977332592, -0.010537062771618366, -0.004116397816687822, 0.015931490808725357, 0.002493110252544284, -0.05341016873717308, -0.010208971798419952, -0.011208505369722843, 0.010430242866277695, -0.007313378155231476, -0.01678605191409588, 0.015511838719248772, 0.0014058318920433521, 0.008942387998104095, 0.021791348233819008, -0.026567744091153145, -0.0068670217879116535, -0.03283962234854698, 0.009598569944500923, 0.0021039790008217096, 0.013764563016593456, 0.023729374632239342, -0.04666522517800331, 0.057072579860687256, 0.0006127862725406885, 0.002657155739143491, -0.018647778779268265, 0.017213333398103714, -0.025133298709988594, 0.0021135166753083467, -0.008812678046524525, 0.03665463626384735, 0.05463097244501114, -0.0032027026172727346, 0.0040057627484202385, -0.014626756310462952, 0.036563076078891754, -0.022111808881163597, 0.0176100954413414, 0.014062134549021721, 0.006123094353824854, -0.0322597399353981, 0.02467549778521061, -0.013466992415487766, -0.05078544095158577, -0.024293996393680573, -0.041019007563591, -0.014161324128508568, 0.006363439839333296, -0.024568676948547363, -0.05136531963944435, -0.019822802394628525, 0.03192402049899101, -0.005562287289649248, 0.016587672755122185, 0.01764061488211155, -0.002516000298783183, 0.010224232450127602, 0.0016824202612042427, -0.024889137595891953, 0.012528499588370323, 0.019563380628824234, -0.04529182240366936, 0.04050016775727272, -0.010170822031795979, -0.001935164793394506, 0.0528608076274395, 0.009751170873641968, 0.00036886398447677493, -0.018586738035082817, 0.022813770920038223, 0.01991436257958412, 0.0014220457524061203, 0.01056758314371109, 0.010804113931953907, 0.008309096097946167, -0.007263782899826765, -0.00037244055420160294, 0.028322648257017136, 0.026628782972693443, 0.005562287289649248, 0.01703021302819252, -0.003475475823506713, 0.004417784046381712, -0.028902530670166016, 0.027834327891469002, 0.014168954454362392, -0.00038293181569315493, 0.035037070512771606, 0.024004055187106133, -0.013177051208913326, 0.017762696370482445, 0.005905638448894024, 0.009453599341213703, 0.040683288127183914, -0.0036681341007351875, 0.04013392701745033, 0.07086766511201859, 0.009552789852023125, 0.01703021302819252, -0.018296796828508377, 0.00892712827771902, 0.0015803687274456024, -0.00749649852514267, 0.0005989568890072405, -0.05557709559798241, -0.000752987980376929, -0.0068136113695800304, 0.03839427977800369, 0.0075460937805473804, 0.02144036814570427, -0.006344364956021309, 0.0033305054530501366, 0.015656808391213417, 0.014168954454362392, -0.02232545055449009, 0.015160857699811459, -0.0016290100757032633, 0.014214734546840191, -0.04379633814096451, 0.02697976492345333, 0.016297731548547745, 0.008118345402181149, 0.021013086661696434, 0.006985286716371775, -0.002451145090162754, 0.027971668168902397, 0.016297731548547745, -0.009972441010177135, 0.002393919974565506, 0.02177608758211136, 0.017442233860492706, -0.04486453905701637, -0.015382127836346626, 0.029848653823137283, 0.01590096950531006, 0.02292059175670147, -0.010971974581480026, -0.03760075941681862, 0.030657436698675156, 0.005527952220290899, 0.019288700073957443, 0.06104019284248352, 0.016801312565803528, -0.015160857699811459, 0.05023607611656189, -0.018617259338498116, -0.0219592098146677, 0.009728280827403069, 0.011109314858913422, 0.00645500048995018, 0.0019952512811869383, -0.03778387978672981, -0.0038874971214681864, -0.016328250989317894, 0.023347873240709305, 0.011406885460019112, -0.03164933994412422, 0.004658129531890154, -0.0014649645891040564, 0.03644099459052086, 0.0042270333506166935, 0.0008264269563369453, 0.022478051483631134, 0.02026534453034401, 0.042422931641340256, 0.0018521882593631744, -0.022111808881163597, 0.02470601722598076, -0.015588139183819294, 0.030169114470481873, 0.002372937509790063, 0.027086585760116577, 0.023103712126612663, 0.028994090855121613, 0.04901527240872383, 0.006786906160414219, 0.02559109963476658, 0.02260013110935688, -0.021638747304677963, -0.021928688511252403, 0.02147088758647442, 0.0322292223572731, 0.0014783171936869621, 0.007000546902418137, -0.03982872515916824, 0.013726413249969482, -0.02173030748963356, -0.02763594686985016, -0.014466525055468082, 0.0441320575773716, -0.022157588973641396, 0.0010662958957254887, -0.011750237084925175, 0.004688649903982878, 0.002819293877109885, -0.04013392701745033, -0.020952045917510986, -0.006054424215108156, -0.03955404460430145, -0.01785425655543804, -0.026003122329711914, -0.034182507544755936, 0.009590940549969673, 0.01365011278539896, -0.008759267628192902, -0.010926194489002228, -0.002762068761512637, -0.011261915788054466, 0.004127842839807272, 0.02261539176106453, 0.005157896317541599, -0.01994488202035427, 0.001591813750565052, -0.009926660917699337, -0.006775461137294769, 0.0008006756543181837, 0.02168452739715576, -0.020356904715299606, -0.004974775481969118, -0.00010515126632526517, 0.025102779269218445, -0.005836968310177326, 0.01410791464149952, -0.0205095037817955, 0.013032080605626106, 0.02498069778084755, 0.02021956257522106, 0.04953411594033241, -0.02705606445670128, -0.015992529690265656, -0.013222831301391125, -0.012070697732269764, 0.022203369066119194, -0.012688729912042618, 0.0001151060641859658, 0.00023211963707581162, -0.011200875043869019, 0.058568064123392105, 0.03457926958799362, 0.009613830596208572, -0.03207661956548691, 0.024538157507777214, -0.0028994090389460325, 0.011536596342921257, 0.0026495258789509535, -0.006340549793094397, -0.021364066749811172, 0.003341950476169586, -0.007660544011741877, -0.012261448428034782, -0.0037959369365125895, -0.0005636680289171636, 0.015687329694628716, 0.027223926037549973, -0.0033438580576330423, 0.000860285188537091, 0.017808476462960243, -0.030336976051330566, 0.03637995570898056, 0.005947603844106197, -0.021852388978004456, -0.01010978128761053, -0.014931957237422466, -0.032717540860176086, 0.007805514615029097, -0.010476022958755493, 0.0015870450297370553, -0.018952978774905205, 0.021364066749811172, 0.018373098224401474, 0.05316600576043129, 0.04590222239494324, 0.012253818102180958, -0.021516667678952217, -0.011864687316119671, -0.007076847366988659, 0.007076847366988659, 0.026262542232871056, -0.004349113442003727, -0.03485395014286041, 0.030138595029711723, -0.0007568030268885195, 0.02324105240404606, -0.003080622060224414, -0.022447530180215836, 0.01970072276890278, -0.006493150256574154, -0.039798203855752945, 0.010025851428508759, -0.00895001832395792, 0.0017472754698246717, 0.006290954537689686, 0.017106514424085617, 0.004280443303287029, -0.026293061673641205, 0.005093040876090527, 0.01041498314589262, -0.03747867792844772, 0.007149332668632269, 0.01217751856893301, 0.0007367741782218218, -0.0011664399644359946, 0.012574279680848122, 0.0015441260766237974, -0.010315792635083199, -0.017472755163908005, -0.007076847366988659, 0.01044550258666277, -0.007717769127339125, 0.0076758041977882385, 0.005592807661741972, 0.00426899828016758, -0.032107140868902206, 0.013535662554204464, -0.03024541586637497, 0.016557151451706886, -0.02057054452598095, 0.0161909107118845, 0.016633452847599983, -0.018556218594312668, -0.010773593559861183, 0.0321987010538578, -0.016847092658281326, -0.001082509639672935, -0.004562754184007645, 0.003671949030831456, -0.026262542232871056, 0.00853799656033516, 0.020051702857017517, -0.010643883608281612, 0.08881347626447678, -0.004040097817778587, -0.033297423273324966, -0.011368735693395138, -0.01814419776201248, 0.022813770920038223, -0.022188110277056694, 0.021562447771430016, -0.030428536236286163, 0.02559109963476658, -0.00124750891700387, 0.03207661956548691, -0.002508370438590646, 0.006641936022788286, 0.03998132422566414, 0.027696987614035606, -0.005154081154614687, 0.013909533619880676, 0.040927447378635406, 0.01851043850183487, 0.024767057970166206, 0.013260981999337673, -0.018647778779268265, -0.018357837572693825, 0.012688729912042618, 0.008759267628192902, 0.008820307441055775, 0.025011219084262848, 0.02089100517332554, 0.04568858444690704, -0.004265183582901955, -0.026781383901834488, -0.0034583082888275385, 0.026476183906197548, -0.03903520107269287, -0.0024492377415299416, -0.024507636204361916, 0.021058866754174232, 0.003549868706613779, 0.005333386827260256, -0.033846788108348846, -0.00289750169031322, 0.002159296767786145, -0.013337281532585621, -0.011506075970828533, 0.014046873897314072, -0.002098256489261985, 0.011582376435399055, 0.018617259338498116, 0.017228594049811363, 0.025774220004677773, -0.014298665337264538, 0.005100671201944351, -0.02408035472035408, 0.006538930349051952, 0.001627102610655129, 0.008522736839950085, 0.022142330184578896, 0.002659063320606947, 0.02052476443350315, -0.03793647885322571, -0.021928688511252403, -0.029451891779899597, 0.008896607905626297, -0.027422305196523666, -0.034792907536029816, -0.023592034354805946, 0.032168179750442505, -0.05460045114159584, 0.022661171853542328, -0.0011197059648111463, -0.016908133402466774, -0.012490348890423775, 0.015229527838528156, -0.008736377581954002, 0.00683650141581893, -0.021577708423137665, 0.03406042605638504, 0.003017674433067441, 0.03180193901062012, -0.0009761661640368402, -0.011857056990265846, -0.016908133402466774, -0.011635786853730679, 0.0010920471977442503, -0.006672455929219723, 0.026659304276108742, -0.0013314391253516078, -0.012230928055942059, -0.017213333398103714, -0.029589232057332993, 0.019288700073957443, 0.029131431132555008, 0.014870916493237019, -0.013634853065013885, 0.0036738566122949123, -0.0015374497743323445, 0.030703216791152954, 0.01759483478963375, -0.023347873240709305, -0.019868582487106323, -0.012108848430216312, 0.008270946331322193, -0.004425413906574249, -0.03650203347206116, -0.008301465772092342, -0.021241987124085426, -0.017442233860492706, -0.008751637302339077, -0.015229527838528156, -0.011940987780690193, 0.006233729422092438, 0.025209598243236542, 0.022111808881163597, 0.013734043575823307, 0.018968239426612854, -0.022691691294312477, 0.03402990847826004, 0.01991436257958412, -0.033602625131607056, 0.016251951456069946, 0.0037005615886300802, 0.036227352917194366, -0.0033324130345135927, -0.005554657429456711, 0.016663972288370132, -0.007759734522551298, 0.005276161711663008, -0.016236690804362297, -0.007271412760019302, -0.015336347743868828, 0.004604719579219818, 0.02438555657863617, -0.012856590561568737, 0.010788854211568832, 0.02087574638426304, 0.013154161162674427, -0.015748368576169014, -0.010331052355468273, -0.007668173871934414, 0.006973841693252325, 0.017732175067067146, -0.01293289102613926, -0.00017608664347790182, 0.02733074501156807, -0.01262005977332592, -0.005104485899209976, -0.015763629227876663, 0.029772354289889336, 0.01996014267206192, -0.014176584780216217, 0.0045970892533659935, -0.01145266555249691, 0.03335846588015556, 0.0006628583068959415, -0.00544402189552784, 0.001749182934872806, -0.020173782482743263, 0.0075308335945010185, -0.00741256820037961, 0.021592967212200165, -0.021226726472377777, 0.0029146692249923944, 0.01704547367990017, 0.026201501488685608, -0.0027696986217051744, -0.025194339454174042, -0.003568943589925766, -0.00015295813500415534, 0.013260981999337673, 0.012604799121618271, -0.033846788108348846, -0.03549487143754959, -0.014168954454362392, -0.006687716115266085, 0.002918484155088663, -0.011826537549495697, 0.025041738525032997, -0.03985924646258354, -0.019273441284894943, -0.0008836521301418543, -0.02318001352250576, 0.00969013012945652, 0.028383689001202583, 0.002889871597290039, -0.0017405991675332189, 0.03341950476169586, 0.009819841012358665, 0.02318001352250576, -0.022783251479268074, -0.004635239485651255, -0.0160993505269289, -0.009377299807965755, -0.02079944498836994, 0.013444102369248867, 0.016541892662644386, -0.0012103125918656588, 0.0027773287147283554, 0.023592034354805946, 0.002098256489261985, -0.0068860966712236404, -0.005951418541371822, 0.026827163994312286, -0.016038309782743454, -0.0058445981703698635, -0.024187175557017326, -0.023347873240709305, -0.011414515785872936, 0.016541892662644386, -0.005718702916055918, 0.03134413808584213, -0.0072561525739729404, -0.014130804687738419, -0.015794148668646812, 0.019303960725665092, 0.0009628136758692563, -0.00012911431258544326, 0.012627690099179745, -0.029009351506829262, -0.005337201524525881, -0.0014640107983723283, -0.007820774801075459, 0.01469542644917965, 0.01337543223053217, -0.001950424863025546, 0.013299131765961647, 0.03161881864070892, 0.0038169194012880325, 0.026521963998675346, -0.0016976803308352828, 0.008736377581954002, -0.019761761650443077, -0.03192402049899101, 0.000996671849861741, 0.0027487161569297314, -0.011261915788054466, -0.012848960235714912, 0.022127069532871246, 0.019777022302150726, 0.02639988251030445, -0.048313312232494354, -0.0001745367917465046, -0.017488015815615654, 0.020723145455121994, -0.0205095037817955, 0.060002509504556656, 0.014626756310462952, 0.05838494375348091, -0.048618514090776443, 0.014504675753414631, 0.02382093481719494, 0.007202742621302605, -0.0019532861188054085, -0.035677991807460785, 0.027193404734134674, -0.03750919923186302, -0.001248462707735598, -0.016618192195892334, -0.01645033247768879, 0.028963571414351463, 0.002931836759671569, -0.04434569925069809, 0.016297731548547745, -0.0077139544300735, -0.01941078156232834, 0.043826859444379807, -0.0351896695792675, -0.03784491866827011, -0.02351573295891285, -0.005672922823578119, 0.017091253772377968, 0.013215201906859875, -0.010506543330848217, -0.004021022468805313, -0.023286832496523857, 0.007477423641830683, 0.011391625739634037, -0.01707599312067032, 0.025972601026296616, -0.03399938717484474, 0.016251951456069946, -0.0036280762869864702, 0.002474035369232297, -0.004776394926011562, -0.010552323423326015, 0.020478984341025352, 0.006966211833059788, -0.0036090014036744833, -0.010430242866277695, -0.0010023943614214659, -0.008331986144185066, 0.026323582977056503, 0.024492377415299416, -0.013932423666119576, 0.003612816333770752, 0.028322648257017136, 0.002292822115123272, -0.019868582487106323, -0.010361572727560997, 0.036532554775476456, -0.016862353309988976, -0.016236690804362297, 0.023714113980531693, 0.020631585270166397, 0.016251951456069946, 0.01849517785012722, -0.01936500146985054, 0.030047034844756126, -0.017228594049811363, 0.017137033864855766, -0.01727437414228916, 0.0068860966712236404, -0.039523523300886154, 0.01881563849747181, -0.012131738476455212, 0.03961508348584175, -0.012864219956099987, 0.046848345547914505, -0.02759016677737236, 0.04776395112276077, -0.029818134382367134, -0.010804113931953907, 0.023332612589001656, 0.009239958599209785, 0.017671136185526848, 0.005928528495132923, -0.0220507699996233, 0.004993850830942392, 0.020723145455121994, -0.027468087151646614, 0.05716414004564285, 0.004688649903982878, 0.008850827813148499, 0.007416383363306522, -0.009774060919880867, 0.012131738476455212, -0.004852695390582085, 0.03204610198736191, 0.006989101879298687, -0.029299292713403702, -0.031252577900886536, -0.0008168894564732909, -0.006973841693252325, -0.020082222297787666, -0.04483402147889137, 0.016053570434451103, -0.029451891779899597, -0.031283099204301834, 3.838855627691373e-05, -0.013512772507965565, 0.007717769127339125, 0.04779446870088577, 0.025392720475792885, -0.01543553825467825, -0.004383448977023363, -0.0008831752929836512, -0.011414515785872936, 0.0022107993718236685, -0.024812838062644005, -0.000638060737401247, -0.010552323423326015, -0.01996014267206192, 0.029894433915615082, 0.021867647767066956, -0.01582466997206211, 0.01484039705246687, 0.009400189854204655, -0.05344068631529808, 0.01293289102613926, -0.032412342727184296, -0.009232329204678535, 0.03027593530714512, 0.012284338474273682, -0.01590096950531006, -0.007118812296539545, -0.01100249495357275, -0.02609468251466751, -0.01790003664791584, 0.0070158070884644985, -0.006088759284466505, 0.010453132912516594, -0.016236690804362297, -0.028002187609672546, -0.01409265398979187, 0.030779516324400902, -0.024156656116247177, -0.03613579273223877, 0.030153853818774223, -0.010582842864096165]",Iterative Preference Learning from Human Feedback: Bridging Theory and Practice for RLHF under KL-constraint.pdf
