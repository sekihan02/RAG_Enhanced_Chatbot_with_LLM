text,embedding,file
"Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study
Shusheng Xu1Wei Fu1Jiaxuan Gao1Wenjie Ye2Weilin Liu2
Zhiyu Mei1Guangju Wang2Chao Yu* 1Yi Wu* 1 2 3
Abstract
Reinforcement Learning from Human Feedback
(RLHF) is currently the most widely used method
to align large language models (LLMs) with hu-
man preferences. Existing RLHF methods can
be roughly categorized as either reward-based or
reward-free . Novel applications such as ChatGPT
and Claude leverage reward-based methods that
first learn a reward model and apply actor-critic
algorithms, such as Proximal Policy Optimiza-
tion (PPO). However, in academic benchmarks,
the state-of-the-art results are often achieved via
reward-free methods, such as Direct Preference
Optimization (DPO). Is DPO truly superior to
PPO? Why does PPO perform poorly on these
benchmarks? In this paper, we first conduct both
theoretical and empirical studies on the algorith-
mic properties of DPO and show that DPO may
have fundamental limitations. Moreover, we also
comprehensively examine PPO and reveal the key
factors for the best performances of PPO in fine-
tuning LLMs. Finally, we benchmark DPO and
PPO across a collection of RLHF testbeds, rang-
ing from dialogue to code generation. Experiment
results demonstrate that PPO is able to surpass
other alignment methods in all cases and achieve
state-of-the-art results in challenging code com-
petitions.
1. Introduction
Large Language Models (LLMs) derive their extensive lan-
guage patterns and knowledge through pre-training on sub-
stantial textual datasets (Brown et al., 2020; OpenAI, 2023;
Touvron et al., 2023; Chowdhery et al., 2023; Anil et al.,
2023). To leverage the formidable capabilities of LLMs in
practical applications, a growing amount of research has
*Co-corresponding authors.1Tsinghua University, Beijing
China2OpenPsi Inc.3Shanghai Qi Zhi Institute, Shanghai, China.
Correspondence to: Shusheng Xu <xssstory@gmail.com >, Chao
Yu<zoeyuchao@gmail.com >, Yi Wu <jxwuyi@gmail.com >.underscored the importance of aligning these models with
human preferences (Agrawal et al., 2023; Kadavath et al.,
2022; Shi et al., 2023; Liang et al., 2021; Sheng et al., 2019).
Various methods have been developed for fine-tuning LLMs,
with popular approaches including Supervised Fine-Tuning
(SFT) (Peng et al., 2023) and Reinforcement Learning from
Human Feedback (RLHF) (Ziegler et al., 2019; Stiennon
et al., 2020; Ouyang et al., 2022). Typically, fine-tuning in-
volves two phases: SFT to establish a base model, followed
by RLHF for enhanced performance. SFT involves imitat-
ing high-quality demonstration data, while RLHF refines
LLMs through preference feedback.
Within RLHF, two prominent approaches are reward-based
and reward-free methods. Reward-based methods, pio-
neered by OpenAI (Ouyang et al., 2022; Ziegler et al., 2019;
Stiennon et al., 2020), construct a reward model using pref-
erence data and then employ actor-critic algorithms like
Proximal Policy Optimization (PPO) to optimize the re-
ward signal. In contrast, reward-free methods, including Di-
rect Preference Optimization (DPO) (Rafailov et al., 2023),
RRHF (Yuan et al., 2023), and PRO (Song et al., 2023),
eliminate the explicit use of a reward function. DPO, a
representative reward-free method, expresses the reward
function in a logarithmic form of the policy and focuses
solely on policy optimization.
Notably, the most successful applications like Chat-
GPT (OpenAI, 2022) and Claude (Antropic, 2023) are pro-
duced by the reward-based RLHF method PPO, while strong
performances in academic benchmarks often result from the
reward-free RLHF method DPO (Rafailov et al., 2023; Mis-
tralAI, 2023). This discrepancy raises two fundamental
","[-0.0169239304959774, -0.005812433082610369, 0.06455349177122116, 0.005381754599511623, 0.03208380192518234, 0.0009345716680400074, -0.010997798293828964, 0.017695706337690353, -0.012369077652692795, 0.0019208247540518641, 0.029906293377280235, -0.018784459680318832, -0.029134519398212433, 0.01715821959078312, 0.012086552567780018, -0.06091512367129326, 0.0036969417706131935, -0.08246970921754837, 0.02079658955335617, 0.03506065160036087, 0.002344612032175064, -0.0058331056497991085, 0.011631757020950317, 0.035529229789972305, 0.037513792514801025, -0.03335171937942505, 0.013361360877752304, 0.030815886333584785, -0.005578143987804651, -0.03718303143978119, 0.02946528047323227, -0.020355574786663055, -0.01987321488559246, -0.004861495457589626, -0.012320841662585735, 0.020644990727305412, 0.0004931265139020979, 0.04539692774415016, 0.00426199147477746, -0.001123208785429597, -0.016648296266794205, -0.054520413279533386, -0.009881480596959591, 0.002768399426713586, -0.026943227276206017, 0.050909608602523804, 0.027342896908521652, 0.003645260352641344, 0.002213686006143689, 0.009867698885500431, -0.06554577499628067, 0.06846749782562256, -0.02555127628147602, -0.032662633806467056, -0.01276185642927885, -0.0003772740892600268, 0.04051820561289787, -0.010756618343293667, 0.05008270591497421, -0.01889471337199211, -0.01717200130224228, -0.015270126052200794, 0.02745315060019493, 0.01707552932202816, -0.026212798431515694, -0.01907387562096119, -0.09128999710083008, -0.015008273534476757, 0.02935502678155899, 0.010164005681872368, 0.009316430427134037, -0.0029182755388319492, 0.04368799552321434, 0.0023928480222821236, -0.008227676153182983, -0.02457277476787567, 0.03737597540020943, 0.07497245818376541, -0.007821115665137768, -0.012024534866213799, -0.026791630312800407, 0.00423787347972393, 0.01911522075533867, -0.025799347087740898, -0.00426199147477746, -0.016662077978253365, -0.04255789518356323, 0.0016236568335443735, -0.044239263981580734, -0.03869901970028877, -0.004024256952106953, -0.0283903069794178, -0.025027571246027946, -0.016455352306365967, 0.03982912003993988, 0.0026977681554853916, -0.007039004471153021, 0.00861356407403946, 0.03996693715453148, 0.033737607300281525, -0.04341236129403114, -0.03404080495238304, 0.010170896537601948, 0.004547961987555027, 0.06141126528382301, 0.016455352306365967, 0.011211414821445942, 0.014856674708425999, 0.008220785297453403, -0.005543689709156752, -0.06714445352554321, 0.03737597540020943, -0.08213894814252853, 0.0012308782897889614, -0.0171306561678648, -0.06504963338375092, -0.05975745990872383, 0.012472440488636494, -0.025937164202332497, 0.0199283417314291, -0.03486770763993263, 0.010246695950627327, 0.03260750696063042, 0.003147396259009838, 0.03249725326895714, -0.031063957139849663, 0.042392514646053314, -0.042364951223134995, -0.002652977593243122, -0.013244216330349445, 0.007428337354212999, 0.03869901970028877, -0.01288589183241129, -0.061356138437986374, -0.10099231451749802, 0.04266814887523651, -0.023883691057562828, 0.007290520705282688, -0.01715821959078312, -0.017268473282456398, -0.009047687985002995, -0.04360530525445938, -0.06918414682149887, 0.03404080495238304, -0.046940479427576065, -0.030871013179421425, -0.01983186975121498, -0.026929445564746857, -0.03238699957728386, 0.046030886471271515, -0.011934954673051834, -0.012086552567780018, -0.013306234031915665, 0.04911798611283302, -0.044211700558662415, -0.030181927606463432, -0.020383138209581375, 0.03045756183564663, 0.021210039034485817, -0.02457277476787567, 0.028638377785682678, 0.05192945525050163, -0.014636168256402016, -0.0013669725740328431, 0.0414002351462841, 0.010549893602728844, -0.0018157393205910921, 0.009530046954751015, -0.07420068234205246, -0.008971888571977615, -0.004024256952106953, 0.003250759094953537, -0.05865492671728134, -0.024269577115774155, 0.012506894767284393, -0.0009698873036541045, -0.02070011757314205, 0.026915663853287697, -0.02093440666794777, -0.04556230828166008, 0.01888093166053295, 0.038423385471105576, -0.011300995945930481, -0.015752485021948814, 0.0027270542923361063, 0.01285143755376339, 0.012024534866213799, -0.007772880140691996, -0.006422273349016905, 0.03401324152946472, 0.02861081436276436, 0.03158766031265259, 0.06196253374218941, 0.011624866165220737, -0.008324148133397102, 0.010680818930268288, 0.06719958037137985, 0.02639196068048477, -0.02670894004404545, -0.012706729583442211, 0.017282254993915558, 0.015146090649068356, -0.03401324152946472, -0.07177510857582092, 0.0055609168484807014, -0.005533353425562382, 0.0011292382841929793, 0.00286314869299531, -0.034509383141994476, -0.05777289718389511, 0.006250001955777407, 0.016551824286580086, 0.0474090576171875, 0.034564509987831116, -0.029768476262688637, -0.03200111165642738, -0.03296583145856857, 0.010825526900589466, 0.02858325093984604, 0.05322493612766266, 0.02560640312731266, -0.00709757674485445, 0.020507173612713814, 0.03213892877101898, -0.030760759487748146, -0.00426543690264225, 0.004765023477375507, -0.008689363487064838, 0.023098133504390717, -0.029079392552375793, 0.029162082821130753, 0.013216652907431126, -0.012520676478743553, -0.020176412537693977, 0.02188534289598465, -0.04718855023384094, -0.005591925699263811, 0.0016004001954570413, 0.04437708109617233, -0.042116884142160416, -0.0039484575390815735, 0.0005792621523141861, 0.036549076437950134, -0.02952040731906891, 0.017378726974129677, 0.03514334186911583, -0.021651053801178932, -0.02946528047323227, 0.02641952410340309, -0.013299343176186085, 0.019432200118899345, 0.011659320443868637, -0.03872658312320709, -0.03690739721059799, -0.035418976098299026, -0.013450941070914268, -0.0014186539920046926, -0.0037072778213769197, -0.009254412725567818, -0.031146647408604622, -0.016772331669926643, 0.02748071402311325, 0.014677513390779495, 0.027935510501265526, -0.0008729847031645477, -0.019528672099113464, -0.0383131317794323, 0.03156009688973427, -0.026157671585679054, 0.010164005681872368, 0.0076006087474524975, 0.0028889894019812346, -0.013078835792839527, 0.03054025210440159, -0.018508825451135635, -0.04771225526928902, 0.03255238011479378, 0.029189646244049072, -0.02093440666794777, -0.021568363532423973, -0.028073327615857124, 0.02171996235847473, 0.0377618633210659, 0.00213444116525352, 0.0006107016815803945, 0.0067013525404036045, -0.02770122140645981, -0.02847299724817276, -0.019253037869930267, 0.015380379743874073, -0.0015125417849048972, -0.04288865625858307, 0.043191853910684586, -0.054630666971206665, 0.027866601943969727, 0.021513236686587334, 0.03583242744207382, -0.03128446266055107, 0.021044660359621048, 0.033765170723199844, 0.042199574410915375, 0.0069838776253163815, -0.00715270359069109, 0.003378239693120122, 0.016386443749070168, 0.012279496528208256, 0.007807334419339895, 0.0055609168484807014, 0.001622795476578176, -0.005629825405776501, 0.021485673263669014, 0.013657666742801666, 0.016606951132416725, 0.01276185642927885, -0.022174758836627007, -0.03122933767735958, 0.03313121199607849, -0.016634514555335045, -0.014608604833483696, -0.045066166669130325, -0.05421721562743187, -0.05124036967754364, -0.00426543690264225, -0.012541349045932293, 0.025151606649160385, -0.0034092485439032316, 0.020383138209581375, -0.002146500162780285, -0.04010475426912308, -0.012003862299025059, 0.02929989993572235, 0.02577178366482258, -0.011225196532905102, 0.016538042575120926, -0.027246424928307533, -0.004193082917481661, -0.023415112867951393, 0.04283352941274643, 0.043219417333602905, 0.018660424277186394, -0.08246970921754837, 0.0005288728279992938, -0.005178474821150303, -0.009440465830266476, -0.04853915423154831, 0.00995038915425539, -0.00989526230841875, 0.008723817765712738, 0.016524260863661766, 0.05011026933789253, -0.013402705080807209, -0.007545481901615858, 0.029106955975294113, 0.02187156118452549, -0.0017580284038558602, 0.04371555894613266, 0.0114319222047925, -0.03133958950638771, 0.004771914333105087, -0.008241457864642143, -0.005130238831043243, 0.011859155260026455, -0.030953703448176384, 0.008351711556315422, 0.011025361716747284, 0.010460312478244305, -0.014112463220953941, -0.01481532957404852, 0.024104196578264236, -0.019253037869930267, 0.025413459166884422, 0.026722721755504608, -0.02468302845954895, 0.040325261652469635, -0.0418136864900589, 0.04164830595254898, 0.022285012528300285, 0.01980430632829666, -0.02578556537628174, 0.020672554150223732, -0.012431095354259014, 0.019197911024093628, -0.019625144079327583, -0.027094826102256775, -0.0033093313686549664, 0.031146647408604622, -0.007187157869338989, -0.038478512316942215, -0.022477956488728523, -0.011886718682944775, -0.002208517864346504, -0.0072629572823643684, -0.017406290397047997, 0.03332415595650673, -0.006535972468554974, -0.0009586896630935371, -0.012568912468850613, 0.05526462569832802, 0.05592614784836769, 0.03310364857316017, -0.0362183153629303, -0.01797134056687355, -0.039415668696165085, -0.0005034627974964678, -0.0338478609919548, 0.023415112867951393, -0.03219405561685562, 0.04065602272748947, -0.007552372757345438, 0.02858325093984604, 0.048869915306568146, -0.018536388874053955, 0.020493391901254654, -0.024862190708518028, 0.030567815527319908, -0.017640579491853714, 0.015132308937609196, -0.007759098429232836, 0.05427234247326851, 0.0609702505171299, 0.025027571246027946, -0.017254691570997238, -0.002947561675682664, -0.05322493612766266, 0.02098953351378441, 0.038533639162778854, 0.02370452880859375, -0.04305403679609299, 1.691757825028617e-05, -0.0493660569190979, -0.02745315060019493, 0.06190740689635277, 0.05501655489206314, -0.05981258675456047, -0.05446528643369675, -0.018274538218975067, -0.017737051472067833, 0.021127350628376007, -0.0075937178917229176, -0.03354466333985329, 0.024490084499120712, 0.01899118535220623, -0.05055128410458565, -0.04360530525445938, -0.01602811925113201, -0.003634924069046974, -0.03158766031265259, 0.009075251407921314, 0.005016539711505175, 0.003576351795345545, -0.03326902911067009, 0.03321390226483345, 0.09217202663421631, 0.005846887361258268, 0.028307616710662842, -0.030678069218993187, 0.08269021660089493, -0.012079661712050438, 0.03310364857316017, -0.0006869317148812115, 0.03136715292930603, -0.01420893520116806, 0.010487875901162624, -0.02943771705031395, 0.02072768099606037, 0.04487322270870209, 0.035529229789972305, -0.011204523965716362, -0.024007724598050117, 0.008317257277667522, -0.021609708666801453, -0.03665933012962341, -0.0015177099267020822, -0.028307616710662842, -0.04299890995025635, -0.0063568102195858955, 0.036576639860868454, -0.014966928400099277, -0.003142228117212653, -0.008834071457386017, -0.016786113381385803, -0.051626257598400116, 0.020093722268939018, -0.001526323496364057, 0.03632856905460358, 0.05206727236509323, 0.008386165834963322, 0.029658222571015358, -0.05005514249205589, 0.022519301623106003, -0.0008208726649172604, -0.04264058545231819, 0.05865492671728134, -0.015738703310489655, -0.010797963477671146, -0.018439916893839836, 0.025068916380405426, 0.016717204824090004, -0.009343993850052357, -0.016606951132416725, 0.02647465094923973, -0.021595926955342293, -0.026130108162760735, 0.007828006520867348, 0.005250828806310892, 0.059151068329811096, 0.037568919360637665, -0.04269571229815483, 0.0012308782897889614, 0.026791630312800407, 0.005764197092503309, -0.013547413051128387, 0.01425028033554554, 0.01274118386209011, 0.014829111285507679, 0.03117421083152294, -0.024021506309509277, -0.019253037869930267, -0.02003859542310238, 0.018770677968859673, 0.013630103319883347, -0.016910148784518242, -0.01281698327511549, 0.004344681743532419, 0.0012532735709100962, 0.013630103319883347, -0.05063397437334061, -0.09349507093429565, -0.041289981454610825, -0.02359427511692047, 0.026171453297138214, -0.004899395164102316, 0.026157671585679054, 0.012127897702157497, -0.02927233651280403, -0.028721068054437637, -0.011245869100093842, -0.03823044151067734, -0.042364951223134995, -0.025316987186670303, 0.023359986022114754, 0.00988837145268917, 0.0027925174217671156, 0.028114672750234604, 0.01615215465426445, -0.01911522075533867, 0.0171995647251606, 0.006205211393535137, 0.011507721617817879, 0.012148570269346237, 0.037541355937719345, -0.038533639162778854, -0.024117978289723396, -0.014842892996966839, -0.02171996235847473, 0.003075042273849249, -0.017805960029363632, -0.00996417086571455, 0.0320286750793457, 0.004561743699014187, -0.0008747074170969427, -0.009716100059449673, -0.022491738200187683, 0.03125689923763275, -0.006966650485992432, 0.030099237337708473, -0.0025065471418201923, -0.020534737035632133, 0.0023997388780117035, 0.046003323048353195, -0.030154364183545113, 0.013388924300670624, 0.021623490378260612, -0.052508287131786346, 0.009626518934965134, -0.006291347090154886, 0.03437156602740288, 0.012217478826642036, 0.02946528047323227, 0.026295488700270653, -0.023249732330441475, -0.02665381319820881, -0.004957967437803745, -0.02267090044915676, -0.051791638135910034, 0.009474920108914375, -0.011948736384510994, 0.019473545253276825, -0.050826918333768845, 0.04266814887523651, 0.05046859383583069, -0.011996971443295479, -0.013933300971984863, -0.03169791400432587, -0.03219405561685562, 0.0008815982728265226, -0.0007885717786848545, -0.01615215465426445, -0.00020586418395396322, -0.010887544602155685, 0.019418418407440186, 0.018384790048003197, 0.01281009241938591, -0.04291621968150139, -0.010074424557387829, 0.023249732330441475, 0.010611910372972488, -0.010046861134469509, 0.016579387709498405, 0.0002092019421979785, -0.002437638584524393, -0.021099787205457687, 0.006759924814105034, -0.027921728789806366, -0.04484565928578377, -0.008413729257881641, -0.007662626449018717, -0.011487049050629139, 0.04073871299624443, -0.028776194900274277, 0.003559124656021595, -0.019377073273062706, 0.008896089158952236, -0.0075937178917229176, 0.024903535842895508, -0.014649949967861176, -0.02268468216061592, -0.0070769041776657104, -0.02555127628147602, 0.008765162900090218, -0.03481258079409599, -0.007442119065672159, -0.004644433502107859, 0.008792726323008537, 0.027067262679338455, 0.005492008291184902, 0.01904631219804287, -0.039305415004491806, 0.019184129312634468, -0.021334074437618256, 0.007669517304748297, 0.017640579491853714, 0.003669378347694874, -0.03448181971907616, 0.012562021613121033, -0.005853778216987848, 0.005054439418017864, -0.005137129686772823, 0.007242284715175629, -0.03307608515024185, -0.024379830807447433, -0.010363840498030186, 0.04106947407126427, 0.011259650811553001, 0.012679166160523891, 0.004141401499509811, 0.0018967067589983344, 0.012644711881875992, 0.00021512375678867102, -0.0032008003909140825, -0.05441015958786011, -0.02377343736588955, -0.021113568916916847, 0.02081037126481533, 0.0023101577535271645, 0.032717760652303696, 0.002947561675682664, 0.06742008775472641, 0.0029940749518573284, -0.010915108025074005, -0.03222161903977394, 0.001580588985234499, 0.04162074252963066, -0.008909870870411396, -0.009261303581297398, -0.021582145243883133, 0.022367702797055244, -0.04343992471694946, -0.02952040731906891, 0.0017373558366671205, -0.028100891038775444, 0.0022050724364817142, -0.0514608770608902, -0.03530872240662575, -0.019170347601175308, -0.014036663807928562, 0.023208387196063995, -0.015904083847999573, 0.0014711967669427395, -0.005206038244068623, -0.006212102249264717, 0.008289693854749203, -0.0028200808446854353, -0.049062859266996384, 0.003152564400807023, 0.022533083334565163, 0.015683576464653015, 0.071609728038311, -0.021458109840750694, -0.04729880392551422, -0.006687571294605732, -0.0009664418757893145, -0.022987879812717438, 0.0013023709179833531, -0.0321664921939373, -0.04079383984208107, -0.030209491029381752, 0.017723269760608673, 0.03302095830440521, -0.009419793263077736, -0.011507721617817879, 0.0013006482040509582, -0.011535285040736198, 0.028018200770020485, 0.014718858525156975, 0.019666489213705063, 0.01915656588971615, -0.007435228209942579, 0.013058163225650787, -0.031918421387672424, -0.0397188663482666, 0.007214721292257309, 0.02267090044915676, 0.015090963803231716, 0.0027098271530121565, -0.0011378518538549542, -0.024117978289723396, 0.017654361203312874, -0.024379830807447433, 0.03249725326895714, -0.00990215316414833, 0.006243111100047827, -0.005299064330756664, -0.01423649862408638, -0.008923652581870556, 0.036604203283786774, -0.0021999042946845293, 0.014539696276187897, -0.031008830294013023, 0.009474920108914375, 0.02654355950653553, -0.009702318347990513, -0.023497803136706352, 0.012224369682371616, 0.007683299016207457, -0.006653117015957832, 0.050000015646219254, 0.025937164202332497, 0.016441570594906807, -0.01280320156365633, -0.03442669287323952, 0.013333797454833984, 0.010398294776678085, 0.012692947871983051, 0.023442676290869713, -0.009068360552191734, -0.02200937829911709, 0.0003731826727744192, -0.009130378253757954, -0.020383138209581375, 0.003062983276322484, 0.017447635531425476, -0.010949562303721905, -8.123667794279754e-05, -0.0038003043737262487, -0.017475198954343796, -0.05281148478388786, -0.02753584086894989, 0.020603645592927933, -0.01998346857726574, -0.0017563056899234653, -0.007373210974037647, 0.009343993850052357, 0.03809262439608574, 0.045975759625434875, -0.010632582940161228, 0.02574422024190426, 0.02458655647933483, -0.01908765733242035, 0.0006666898261755705, -0.021141132339835167, -0.030567815527319908, 0.014994491823017597, -0.042447641491889954, -0.015008273534476757, -0.02380100078880787, -0.008434401825070381, -0.019694052636623383, 0.027108607813715935, -0.023111915215849876, -0.012665384449064732, 0.019459763541817665, -0.01911522075533867, 0.0037382866721600294, -0.00032107060542330146, 0.06929440051317215, -0.027356678619980812, -0.11345097422599792, -0.03324146568775177, 0.032717760652303696, 0.016482915729284286, 0.010818636044859886, -0.017351163551211357, 0.03911247104406357, 0.025854473933577538, 0.010749727487564087, -0.01616593636572361, 0.040380388498306274, -0.02093440666794777, 0.012727402150630951, -0.013657666742801666, 0.01915656588971615, -0.05432746931910515, -0.0020155739039182663, -0.010680818930268288, 0.03395811468362808, -0.007004550192505121, -0.021320292726159096, -0.013643885031342506, 0.0029165528248995543, 0.004637542646378279, -0.024352267384529114, 0.018508825451135635, 0.0034075258299708366, 0.001665001967921853, -0.02473815530538559, 0.002746004145592451, -0.02198181487619877, -0.01790243200957775, 0.0169928390532732, 0.009316430427134037, -0.022105850279331207, -0.012486222200095654, -0.007004550192505121, -0.00027671075076796114, -0.006194875109940767, -0.006556645035743713, 0.026281706988811493, -0.013051272369921207, 0.030953703448176384, -0.018371008336544037, 0.018563952296972275, -0.04082140326499939, 0.019445981830358505, -0.022229885682463646, 0.01984565146267414, -8.161352161550894e-05, -0.001310984487645328, -0.011810919269919395, 0.011500830762088299, -0.0009449079516343772, 0.013829938136041164, 0.014525914564728737, -0.004616870079189539, 0.011149397119879723, 0.020300447940826416, -0.013375142589211464, -0.013106399215757847, 0.02833518013358116, -0.005336964037269354, -0.012279496528208256, -0.03164278715848923, 0.006580763030797243, -0.02174752578139305, 0.018674205988645554, -0.03624587878584862, -0.04931093007326126, -0.02072768099606037, 0.005619489122182131, -0.009468029253184795, 0.05493386462330818, 0.012348405085504055, -0.02269846387207508, 0.05336275324225426, 0.04093165695667267, -0.02748071402311325, 0.02468302845954895, 0.06361633539199829, -0.01897740364074707, 0.010460312478244305, 0.029106955975294113, 0.011831591837108135, 0.028183581307530403, 0.020452046766877174, -0.0015633618459105492, -0.02358049340546131, 0.020534737035632133, 0.026364397257566452, -0.007931369356811047, 0.018550170585513115, -0.013823047280311584, -0.005591925699263811, -0.032883141189813614, -0.0017898986116051674, -0.007924478501081467, 0.013623212464153767, -0.027811475098133087, 0.04192394018173218, -0.002463479293510318, -0.06482912600040436, -0.026984572410583496, 0.01604190096259117, -0.005629825405776501, 0.007993387058377266, -0.006343028508126736, 0.019501108676195145, -0.010067533701658249, 0.015559541992843151, 0.013175307773053646, -0.022505519911646843, 0.02178887091577053, -0.026378178969025612, 0.01429162546992302, 0.05394158139824867, 0.031835731118917465, 0.0227260272949934, 0.028114672750234604, -0.007283629849553108, 0.023897472769021988, -0.015711139887571335, 0.013395815156400204, -0.005585034843534231, -0.01717200130224228, -0.017254691570997238, 0.04104191064834595, -0.02479328215122223, -0.0028080218471586704, 0.031918421387672424, -0.014525914564728737, 0.004144846927374601, -0.023359986022114754, -0.015669794753193855, 0.015821393579244614, 0.0419515036046505, 0.019280601292848587, -0.01697905734181404, 0.017433853819966316, 0.016538042575120926, 0.022133413702249527, 0.023318640887737274, 0.03318633884191513, 0.01282387413084507, 0.011742010712623596, 0.03784455358982086, -0.04669240862131119, -0.007428337354212999, 0.015339034609496593, 0.04567256197333336, -0.015104745514690876, 0.010226023383438587, 0.018467480316758156, 0.010253586806356907, -0.003776186378672719, 0.038395822048187256, -0.023401331156492233, 0.001927715609781444, -0.010212241671979427, 0.02083793468773365, 0.023125696927309036, -0.026240361854434013, -0.025344550609588623, 0.02483462728559971, -0.021168693900108337, -0.012279496528208256, -0.006250001955777407, 0.0016141819069162011, -0.024090414866805077, -0.015476851724088192, -0.03908490762114525, 0.014388097450137138, 0.014608604833483696, 0.02090684324502945, 0.007724644150584936, 0.006597990170121193, 0.034536946564912796, -0.006663453299552202, 0.07155460119247437, 0.015228780917823315, 0.03530872240662575, -0.002534110564738512, 0.010081315413117409, 0.028045764192938805, -0.0016813676338642836, -0.0018708660500124097, -0.007662626449018717, 0.008351711556315422, 0.030733196064829826, 0.029051829129457474, 0.03630100563168526, 0.015339034609496593, 0.026378178969025612, 0.017792178317904472, -0.020148849114775658, 0.015311471186578274, 0.05052372068166733, -0.021692398935556412, -0.051819201558828354, -0.06791622936725616, 0.07475195080041885, 0.029988983646035194, -0.010115769691765308, -0.019583798944950104, 0.02666759490966797, 0.00026658980641514063, -0.020231539383530617, -0.0007244007429108024, 0.021347856149077415, -0.0035160568077117205, 0.013933300971984863, -0.03252481669187546, 0.03875414654612541, 0.014567259699106216, -0.05011026933789253, 0.003566015511751175, 0.011845373548567295, -0.011252759955823421, 0.0009905598126351833, -0.016593169420957565, -0.017461417242884636, 0.004971749149262905, 0.00566083425655961, -0.017819741740822792, -0.0085308738052845, 0.026143889874219894, 0.0012713620672002435, 0.011238978244364262, 0.004103501792997122, -0.015187435783445835, 0.0016055683372542262, 0.009178613312542439, 0.017516544088721275, -0.018812023103237152, -0.03051268868148327, 0.004765023477375507, 0.007641953881829977, -0.007621281314641237, 0.006732361391186714, 0.04272327572107315, 0.03415105864405632, -0.009764336049556732, -0.008227676153182983, 0.024049069732427597, 0.01788865029811859, 0.02833518013358116, 0.03497796133160591, -0.01282387413084507, -0.016675859689712524, 0.0200661588460207, 0.02355292998254299, -0.005974368192255497, 0.005812433082610369, -0.005054439418017864, -0.011686883866786957, -0.012630930170416832, 0.025454804301261902, 0.03346197307109833, 0.01890849508345127, -0.041289981454610825, 0.04928336665034294, 0.00709068588912487, -0.0007670378545299172, -0.005891677923500538, -0.008861634880304337, -0.021637272089719772, 0.03142227977514267, 0.03699008747935295, -0.0004306781920604408, -0.015724921599030495, 0.00569528853520751, -0.0037968589458614588, 0.030871013179421425, 0.00853776466101408, 0.017681924626231194, 0.027329115197062492, -0.0011972853681072593, 0.012562021613121033, 0.006732361391186714, -0.014091790653765202, 0.0038313132245093584, -0.005826214794069529, 0.007635063026100397, -0.0019035976147279143, -0.027163734659552574, 0.015807611867785454, -0.0003352829662617296, 0.011259650811553001, -0.005233601666986942, 0.031835731118917465, 0.03605293482542038, -0.004871831741183996, 0.004003584384918213, -0.0023962934501469135, -0.007759098429232836, 0.0005219819722697139, -0.009598955512046814, 0.007400774396955967, -0.015738703310489655, 0.043302107602357864, 0.024021506309509277, 0.018825804814696312, 0.015862738713622093, 0.005591925699263811, -0.008999451994895935, -0.020452046766877174, -0.03423374891281128, 0.005381754599511623, -0.028858885169029236, -0.006467063911259174, -0.01137679535895586, 0.008909870870411396, 0.01806781254708767, -0.009785008616745472, -0.013189089484512806, -0.01799890398979187, -0.014980710111558437, -0.011259650811553001, -0.011866046115756035, 0.005912350490689278, 0.0025599512737244368, 0.009447356685996056, 0.025261860340833664, -0.03031974472105503, -0.0026891545858234167, 0.018246974796056747, 0.0049338494427502155, 0.008220785297453403, 0.002768399426713586, 0.0074145556427538395, 0.019459763541817665, -0.007800443563610315, -0.023043006658554077, -0.04374312236905098, -0.011197633109986782, -0.04666484519839287, -0.004055265802890062, -0.013499177061021328, -0.039332978427410126, 0.0658765360713005, 0.009853917174041271, 0.00567461596801877, -0.015793830156326294, -0.003858876647427678, 0.016551824286580086, -0.0011473266640678048, -0.011673102155327797, 8.236720896093175e-05, -0.011666211299598217, 0.06990079581737518, -0.028858885169029236, -0.01001240685582161, 0.021582145243883133, -0.02548236772418022, 0.04732636734843254, -0.033572226762771606, -0.01894984021782875, -0.004344681743532419, 0.025813128799200058, -0.007876242510974407, 0.027976855635643005, -0.017709488049149513, -0.005075111985206604, 0.010205350816249847, -0.02670894004404545, -0.005326627753674984, 0.03246968984603882, 0.015407943166792393, 0.008675581775605679, 0.002039691898971796, 0.0255926214158535, 0.009605846367776394, -0.0016968720592558384, 0.00282869441434741, -0.013761029578745365, -0.02086549811065197, 0.0028321398422122, 0.0042826640419662, 0.015766266733407974, -0.0018880931893363595, -0.0414002351462841, -0.054630666971206665, 0.020410701632499695, -0.024117978289723396, -0.0007821116014383733, -0.014091790653765202, 0.012031425721943378, -0.02562018483877182, -0.00862045492976904, 0.0255926214158535, -0.001023291377350688, -0.004172410350292921, 0.00995728000998497, 0.004868386313319206, 0.021223820745944977, 0.010315604507923126, 0.015504415147006512, -0.0070769041776657104, 0.02577178366482258, 0.0003660764778032899, -0.02287762612104416, 0.011507721617817879, -0.0036314786411821842, -0.004141401499509811, 0.008131204172968864, 0.00107411143835634, 0.028087109327316284, 0.010797963477671146, 0.01792999543249607, -0.029685785993933678, 0.019211692735552788, -0.03406836837530136, 0.005474781151860952, 0.015132308937609196, -0.024338485673069954, -0.002029355615377426, 0.010873762890696526, -0.03054025210440159, 0.05391401797533035, -0.03914003446698189, -0.0017046242719516158, -0.002370452741160989, 0.007004550192505121, 0.007200939580798149, -0.012913455255329609, -0.007235393859446049, 0.017296036705374718, -0.00571251567453146, 0.012596475891768932, 0.0007989080622792244, 0.005195701960474253, -0.004489389713853598, 0.006563535891473293, -0.002754617715254426, 0.022574428468942642, -0.002342889318242669, -0.013561194762587547, -0.04073871299624443, 0.03665933012962341, -0.012003862299025059, 0.026943227276206017, 0.06196253374218941, 0.020672554150223732, -0.031119083985686302, -0.014539696276187897, -0.010742836631834507, 0.027012135833501816, 0.015173654071986675, 0.019459763541817665, -0.024434957653284073, 0.015242562629282475, -0.005474781151860952, 0.01427784375846386, -0.009488701820373535, -0.01619349978864193, -0.013809265568852425, 0.01275496557354927, 0.006897741928696632, 0.014374315738677979, 0.024049069732427597, -0.019625144079327583, 0.058269038796424866, 0.024242013692855835, 0.011052925139665604, 0.038340695202350616, -0.006777151953428984, 0.0399945005774498, 0.022133413702249527, 0.00012618870823644102, 0.009330212138593197, -0.011852264404296875, 0.01700662076473236, 0.025261860340833664, -0.0004750380467157811, -0.00021350871247705072, 0.013554303906857967, 0.002341166604310274, 0.011872936971485615, 0.01798512227833271, -0.041179727762937546, 0.014925583265721798, 0.014332970604300499, -0.028045764192938805, 0.005609152838587761, 0.017599234357476234, 0.012375968508422375, -0.014084899798035622, -0.006487736478447914, -0.00854465551674366, 0.008048513904213905, 0.02094818837940693, -0.016703423112630844, 0.018729332834482193, 0.0051164571195840836, -0.02550993114709854, 0.012727402150630951, -0.01910143904387951, 0.012706729583442211, 0.020507173612713814, 0.007683299016207457, 0.021347856149077415, 0.00213788659311831, 0.01287900097668171, 0.019390854984521866, -0.023277295753359795, -0.014525914564728737, -0.037651609629392624, -0.01704796589910984, -0.0015082350000739098, 0.021265165880322456, -0.01700662076473236, 0.004089720081537962, 0.03348953649401665, 0.029685785993933678, -0.0009337103110738099, -0.03798237070441246, -0.020190194249153137, -0.0007063122466206551, 0.0031284464057534933, -0.0009879757417365909, 0.004327454604208469, 0.0020172966178506613, -0.008007168769836426, -0.04669240862131119, -0.03492283448576927, -0.0362183153629303, -0.005795205943286419, -0.005967477336525917, 0.00044187583262100816, -0.010928889736533165, -0.003924339544028044, 0.021513236686587334, -0.0059261322021484375, -0.0024841518606990576, 0.00850331038236618, 0.018191847950220108, 0.015407943166792393, 0.00859289150685072, 0.010577456094324589, -0.0032128593884408474, -0.011686883866786957, 0.0007519641076214612, 0.022092068567872047, 0.0014048722805455327, 0.04553474485874176, 0.020562300458550453, -0.0038175315130501986, 0.041234854608774185, -0.006367146503180265, -0.02567531168460846, -0.01627619005739689, -0.0036211423575878143, 0.013953973539173603, -0.018784459680318832, -0.010315604507923126, 0.009247521869838238, -0.007821115665137768, 0.010577456094324589, -0.013402705080807209, -0.006112184841185808, -0.03395811468362808, 0.02668137662112713, 0.028665941208600998, 0.014332970604300499, 0.018743114545941353, -0.021154912188649178, 0.01894984021782875, -0.04084896668791771, -0.02100331522524357, 0.008110531605780125, -0.014787767082452774, 0.028224926441907883, 0.004861495457589626, -0.005953695625066757, 0.02484840899705887, 0.0010043415240943432, 0.022353921085596085, 0.0039002217818051577, 0.022078286856412888, 0.003054369706660509, -0.027783911675214767, -0.012086552567780018, 0.002932057250291109, 0.0015866184839978814, 0.021044660359621048, 0.01795755885541439, -0.016634514555335045, -0.012624039314687252, 0.007025222759693861, -0.04280596598982811, 0.035639483481645584, 0.02101709693670273, -0.005939913913607597, -0.021361637860536575, 0.0797133669257164, 0.011170069687068462, 0.018495043739676476, -0.024862190708518028, 0.010756618343293667, 0.029134519398212433, 0.012072770856320858, -0.012520676478743553, -0.03401324152946472, 0.04826352000236511, -0.05609152838587761, -0.012362186796963215, -0.02858325093984604, -0.01914278417825699, 0.04106947407126427, -0.00282869441434741, -0.015463070012629032, -0.011962518095970154, 0.023167042061686516, -0.010811745189130306, 0.03390298783779144, -0.016813676804304123, 0.02176130749285221, -0.006832278799265623, -0.0169239304959774, -0.007283629849553108, 0.007552372757345438, 0.015711139887571335, -0.011721338145434856, -0.007993387058377266, 0.0013764475006610155, 0.015972992405295372, 0.013244216330349445, 0.008310366421937943, -0.03627344220876694, 0.018205629661679268, 0.01134234108030796, -0.0323043093085289, -0.011094270274043083, -0.009481810964643955, 0.013761029578745365, -0.018632860854268074, -0.010866872034966946, -0.007676408160477877, 0.005485117435455322, -0.024421175941824913, 0.0084964195266366, -0.0021895680110901594, -0.029961420223116875, -0.00020586418395396322, 0.021265165880322456, 0.009647191502153873, -0.003924339544028044, -0.036411259323358536, 0.004561743699014187, 0.002928611822426319, -0.008165658451616764, 0.0343991294503212, 0.04192394018173218, 0.04553474485874176, 0.031973548233509064, -0.001939774607308209, 0.04142779856920242, -0.016772331669926643, 0.03315877541899681, 0.014581041410565376, -0.003081933129578829, -0.013533631339669228, 0.03528115898370743, 0.03026461787521839, 0.026143889874219894, -0.01893605850636959, 0.008964997716248035, -0.0283903069794178, 0.01420893520116806, -0.0008208726649172604, -0.012258823961019516, -0.006777151953428984, 0.021141132339835167, 0.027329115197062492, 0.013409595936536789, -0.013499177061021328, 0.012679166160523891, 0.011645538732409477, -0.01602811925113201, 0.020493391901254654, 0.00851709209382534, 0.01802646741271019, 0.04680266231298447, -0.010288041085004807, 0.02759096771478653, 0.000770913960877806, 0.0048408228904008865, 0.018329665064811707, -0.007380101829767227, -0.023952599614858627, -0.0036934963427484035, 0.006105293985456228, 0.031091520562767982, -0.017461417242884636, -0.007049340754747391, -0.020300447940826416, 0.03252481669187546, 0.002062087180092931, 0.008999451994895935, 0.0283903069794178, 0.04255789518356323, -0.004000138957053423, -0.0029096619691699743, -0.007683299016207457, 0.014966928400099277, -0.0113630136474967, -0.036521513015031815, -0.03164278715848923, 0.006949423346668482, -0.028252489864826202, -0.025220515206456184, 0.023125696927309036, 0.013175307773053646, -0.007972714491188526, -0.0034023576881736517, -0.015104745514690876, -0.018550170585513115, 0.0032214729581028223, -0.01794377714395523, 0.01910143904387951, 0.038588766008615494, 0.023304859176278114, 0.020617427304387093, -0.03120177425444126, -0.0024738155771046877, -0.004003584384918213, 0.0070769041776657104, 0.024917317554354668, -0.0017425239784643054, 0.0021947361528873444, -0.0060880668461322784, 0.018674205988645554, -0.03233187273144722, -0.01788865029811859, 0.008213894441723824, -0.03619075194001198, 0.027742566540837288, 0.00214822287671268]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
"questions: 1) Is DPO truly superior to PPO in the RLHF do-
main? and 2) Can the performance of PPO be substantially
improved in common RLHF benchmarks? In this paper, we
delve into these questions. Through theoretical and empir-
ical analysis, we uncover the fundamental limitations of
DPO and explore critical factors that enhance the practical
performance of PPO in RLHF.
First, our theoretical examination reveals that DPO might
find biased solutions that exploit out-of-distribution re-
sponses. Empirically, we demonstrate that the performance
of DPO is significantly affected by the distribution shift
1arXiv:2404.10719v2  [cs.CL]  21 Apr 2024
Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study
between the model outputs and the preference dataset. Sec-
ond, we perform ablation studies on the algorithmic com-
ponents of PPO and discover a collection of critical factors
for PPO’s best RLHF performances, including advantage
normalization, large batch size, and exponential moving
average update for the reference model. Finally, we vali-
date our findings through extensive experiments, including
dialogue generation tasks and more challenging code gen-
eration tasks. These experiments feature diverse feedback
types and difficulty levels. The results indicate that PPO con-
sistently outperforms DPO across all experiments. Particu-
larly, in the most challenging code competition tasks, PPO
achieves state-of-the-art results. Specifically, on the Code-
Contest dataset (Li et al., 2022), our PPO model with 34B
parameters outperforms AlphaCode-41B (Li et al., 2022),
exhibiting a 10@1k improvement from 16.4% to 22.4%.
2. Related Work
Large language models (LLMs) trained on large datasets
acquire surprising capabilities (Brown et al., 2020; Ope-
nAI, 2023; Touvron et al., 2023; Chowdhery et al., 2023;
Anil et al., 2023; Kaplan et al., 2020; Brown et al., 2020).
To leverage these capabilities to real applications, pre-
trained LLM is further fine-tuned on specific tasks (Rad-
ford et al., 2019; Chung et al., 2022; Tay et al., 2023).
Through fine-tuning with popular approaches such as SFT
and RLHF, LLMs demonstrate impressive performance on
established benchmarks (Touvron et al., 2023; OpenAI,
2023), aligning further with human preferences and societal
well-being (Russell & Norvig, 2020; Russell, 2022).
This paper concentrates on RLHF methods, which can be
broadly categorized into reward-based and reward-free ap-
proaches. Reward-based methods entail training a reward
model on preference data in an initial phase (Gao et al.,
2023; Ziegler et al., 2019; Stiennon et al., 2020; Ouyang
et al., 2022). Subsequently, this learned reward model is
utilized to provide a reward signal for online Reinforcement
Learning (RL) algorithms such as PPO (Schulman et al.,
2017). There exist previous works that have studied these
methods through hyper-parameter tuning and analyzed the
effects of the quality reward model quality (Zheng et al.,
2023; Casper et al., 2023). In contrast, reward-free methods
offer a simpler training procedure by directly training LLMs
on preference data or ranking data to distill human pref-
erence (Yuan et al., 2023; Liu et al., 2023; Touvron et al.,
2023; Rafailov et al., 2023; Song et al., 2023; Dong et al.,
2023; Hong et al., 2024). Among these reward-free meth-
ods, DPO (Rafailov et al., 2023) has demonstrated strong
performances and become popular in the community (Mis-
tralAI, 2023; Chen et al., 2024; Yuan et al., 2024). Recent
work discussed the performance gap of DPO and PPO on
synthetic contextual bandits (Li et al., 2023). In this pa-per, We analyze the limitations of DPO theoretically and
empirically, and explore the key factors for PPO training.
Concurrent efforts have been undertaken to avoid reward
model overoptimization (Ram ´e et al., 2024","[-0.003669691039249301, 0.008975096978247166, 0.051432568579912186, 0.020396653562784195, 0.04491815343499184, 0.014607645571231842, -0.03308411315083504, 0.015276155434548855, -0.008199909701943398, 0.003776367986574769, 0.02557404711842537, -0.010504134930670261, -0.030779888853430748, 0.004334644414484501, 0.022928455844521523, -0.048701632767915726, 0.02588696777820587, -0.06998015195131302, 0.021861685439944267, 0.05114809423685074, -0.010198326781392097, -0.016286032274365425, 0.00515961367636919, 0.012538110837340355, 0.023284045979380608, -0.024293923750519753, 0.016286032274365425, 0.02672616019845009, 0.01620068959891796, -0.047165483236312866, 0.02354007214307785, -0.027124421671032906, -0.028333427384495735, -0.01360488124191761, 0.00879019033163786, 0.027394669130444527, 0.0021530985832214355, 0.033596161752939224, 0.004754241090267897, 0.0021353191696107388, -0.024507276713848114, -0.041419148445129395, -0.01621491275727749, -0.007694972213357687, -0.02196125127375126, 0.056865986436605453, 0.057577166706323624, -0.03043852187693119, -0.0010569918667897582, 0.01627180725336075, -0.06133219972252846, 0.06599754095077515, -0.027935165911912918, -0.04022436589002609, 0.006969567853957415, 0.0057570054195821285, 0.015674415975809097, -0.006749101914465427, 0.03672535717487335, -0.03518920764327049, -0.01905963569879532, -0.019585909321904182, 0.02600075677037239, 0.010930842719972134, -0.020837586373090744, 0.0015645968960598111, -0.09017767757177353, -0.0067562139593064785, 0.01944367215037346, 0.021420754492282867, 0.012466992251574993, 0.004313309211283922, 0.06639580428600311, -0.004409318324178457, 0.000569388794247061, -0.029812682420015335, 0.039882998913526535, 0.06207182630896568, -0.00017368359840475023, 0.013988918624818325, -0.0017441699746996164, 0.02594386227428913, 0.0161437951028347, -0.02484864369034767, 0.004114178474992514, -0.011706029996275902, -0.020780691877007484, -0.005963247735053301, -0.04523107409477234, -0.03410821408033371, -0.01823466643691063, -0.04113467410206795, -0.0024304590187966824, -0.0055294279009103775, 0.049299027770757675, -0.012424321845173836, -0.009302239865064621, 0.009508482180535793, 0.020183300599455833, 0.04363802820444107, -0.045259520411491394, -0.04978263005614281, 0.0068664466962218285, -0.0013236845843493938, 0.04622672498226166, 0.026071874424815178, 0.003241204656660557, 0.019173424690961838, 0.01740969717502594, 0.0013405750505626202, -0.07117493450641632, 0.021819014102220535, -0.09984973073005676, 0.01888895221054554, -0.005561430938541889, -0.04318287596106529, -0.05470399558544159, 0.013640440069139004, -0.0018179549369961023, 0.014963235706090927, -0.03422200307250023, 0.007090468890964985, 0.010162767954170704, 0.007680748589336872, 0.024237029254436493, -0.02595808543264866, 0.0441216342151165, -0.06844400614500046, 0.018490690737962723, -0.01583087630569935, 0.014692987315356731, 0.06087704375386238, -0.007566959597170353, -0.04921368509531021, -0.08244003355503082, 0.05222908779978752, -0.01873249188065529, 0.009110220707952976, -0.00963649433106184, -0.025446034967899323, -0.005596989765763283, -0.03985454887151718, -0.050351571291685104, 0.04511728510260582, -0.04713703691959381, -0.02107938751578331, -0.01480677630752325, -0.03518920764327049, -0.02628522738814354, 0.06599754095077515, -0.030580757185816765, -0.02967044711112976, -0.005099163390696049, 0.03066609986126423, -0.05157480388879776, -0.03467715531587601, 0.02716709114611149, 0.012082954868674278, 0.0191023051738739, -0.018163546919822693, 0.006645980756729841, 0.0621856153011322, -0.037920139729976654, 0.011791370809078217, 0.05777629837393761, 0.01802131161093712, -0.03393752872943878, -0.013469756580889225, -0.07885568588972092, -0.020439324900507927, 0.0096933888271451, 0.00541919469833374, -0.051603250205516815, -0.021705226972699165, 1.4063870139580104e-06, 0.007222037296742201, -0.03174709528684616, 0.030979018658399582, -0.0087332958355546, -0.05106275528669357, 0.0074958414770662785, 0.04534486308693886, 0.00021124280465301126, -0.006773993372917175, 0.012054507620632648, 0.0037194734904915094, 0.024123240262269974, -0.010845500975847244, -0.017452366650104523, 0.04198808968067169, 0.04944126307964325, 0.04659654200077057, 0.05259890481829643, 0.007229148875921965, -0.010973514057695866, -0.008313698694109917, 0.05074983462691307, 0.04335355758666992, -0.03902957960963249, -0.017537709325551987, 0.03666846081614494, 0.02080913819372654, -0.02595808543264866, -0.05194461718201637, 0.01144289318472147, -0.004608449060469866, 0.0022455521393567324, 0.0019148532301187515, -0.022146157920360565, -0.0399683378636837, 0.011777147650718689, 0.004487548489123583, 0.07407654821872711, 0.02299957536160946, -0.0009378691902384162, -0.044548340141773224, -0.05370834469795227, 0.04944126307964325, 0.030410073697566986, 0.04867318645119667, 0.00950137060135603, -0.008711960166692734, 5.081050767330453e-05, 0.03396597504615784, -0.0031896440777927637, -0.011286432854831219, 0.016030006110668182, -0.017722615972161293, 0.023412059992551804, -0.05422039330005646, 0.03541678562760353, 0.015375720337033272, 0.0005680553731508553, -0.003957719076424837, 0.030893677845597267, -0.0284187700599432, 0.0034012203104794025, -0.014721434563398361, 0.030040260404348373, -0.05973915383219719, 0.014280502684414387, -0.0048893652856349945, 0.023881439119577408, -0.019728144630789757, 0.01954323798418045, 0.02699640765786171, -0.030353179201483727, -0.027195539325475693, 0.00030758552020415664, -0.03314100578427315, 0.030182497575879097, -0.009970749728381634, -0.023127587512135506, -0.02463528886437416, -0.03137727826833725, 0.0023806763347238302, 0.001934410771355033, 0.009067550301551819, -0.009188450872898102, -0.013185285031795502, -0.048701632767915726, 0.015247708186507225, 0.021591437980532646, 0.017039882019162178, -0.011343327350914478, -0.005255623254925013, -0.031178148463368416, 0.022473301738500595, -0.03527454659342766, -0.0054974243976175785, 0.0216198842972517, 0.004988930653780699, -0.00019135198090225458, 0.01795019395649433, -0.021918579936027527, -0.03467715531587601, 0.02578740194439888, 0.050010208040475845, -0.012708794325590134, -0.019614355638623238, -0.003225203137844801, 0.04269927367568016, 0.045145731419324875, 0.01314261369407177, 0.03242982551455498, -0.006002362817525864, -0.021050939336419106, -0.007581183221191168, -0.020069511607289314, 0.0066388691775500774, 0.006144598592072725, -0.04671033099293709, 0.03521765395998955, -0.04269927367568016, 0.02311336249113083, 0.0037479207385331392, 0.024990878999233246, -0.05825990065932274, 0.029357528313994408, 0.025773178786039352, 0.052143748849630356, 0.009899631142616272, 0.013611992821097374, -0.0034029982052743435, 0.024265475571155548, -0.01954323798418045, 0.028831254690885544, 0.003554124152287841, 0.002567361341789365, -0.015958888456225395, 0.004811135586351156, 0.03459181636571884, 0.016883423551917076, 0.0186613742262125, -0.03575815260410309, -0.016243360936641693, 0.0450034961104393, -0.040480390191078186, -0.010425904765725136, -0.0491567887365818, -0.04759219288825989, -0.05217219516634941, 0.002659814665094018, -0.0011556681711226702, 0.02868901751935482, -0.007310934830456972, 0.01357643399387598, -0.0045195515267550945, -0.034250449389219284, -0.0322875902056694, 0.015901993960142136, 0.0027558240108191967, -0.0013414639979600906, 0.02638479322195053, -0.032884981483221054, -0.0211789533495903, -0.028447216376662254, 0.05120499059557915, 0.0393993966281414, 0.022359512746334076, -0.07737642526626587, 0.021278517320752144, -0.01627180725336075, 0.007190033793449402, -0.04267082363367081, 0.015162366442382336, 0.010774383321404457, 0.021591437980532646, 0.017495037987828255, 0.02924373932182789, -0.011122861877083778, -0.0002931396884378046, 0.0370098277926445, 0.023753425106406212, -0.004907144699245691, 0.022971127182245255, 0.019144976511597633, -0.05558586120605469, -0.006855779327452183, 0.0014374734601005912, -0.004932036157697439, 0.010568141005933285, -0.04113467410206795, 0.01987037993967533, 0.009024878963828087, 0.01861870288848877, -0.028774360194802284, -0.01571708731353283, 0.025232680141925812, -0.009906742721796036, 0.025033550336956978, 0.04386560618877411, -0.027067527174949646, 0.032828088849782944, -0.050465360283851624, 0.039285607635974884, 0.016286032274365425, 0.0270959734916687, -0.021363859996199608, 0.028731688857078552, -0.005696555133908987, 0.011044631712138653, -0.02644168771803379, -0.024677960202097893, 0.005358744412660599, 0.04833181947469711, -0.00433820066973567, -0.035559020936489105, -0.03971231356263161, -0.011272209696471691, -0.009906742721796036, 0.0058459029532969, -0.02807740308344364, 0.01560329832136631, -0.04565778374671936, -0.005362300202250481, -0.02107938751578331, 0.05578499287366867, 0.0417320653796196, 0.0390864759683609, -0.03587194159626961, -0.012659011408686638, -0.04665343463420868, -0.012310532853007317, -0.03516076132655144, 0.028020508587360382, -0.009145780466496944, 0.027565352618694305, 0.007229148875921965, 0.039285607635974884, 0.051660146564245224, -0.019898828119039536, 0.021491872146725655, -0.02469218336045742, 0.05174548551440239, -0.023298271000385284, 0.01729590818285942, -0.004252858925610781, 0.03422200307250023, 0.04907144978642464, 0.04494660347700119, -0.02453572489321232, -0.014223608188331127, -0.03766411542892456, 0.009103109128773212, 0.04730772227048874, 0.01944367215037346, -0.05137567222118378, 0.0015797094674780965, -0.05939778685569763, -0.03658312186598778, 0.04790511354804039, 0.05129032954573631, -0.039939891546964645, -0.05453331395983696, -0.015958888456225395, -0.029158396646380424, 0.04440610483288765, -0.007197145838290453, -0.018490690737962723, 0.016997212544083595, 0.006514412350952625, -0.03871666267514229, -0.02924373932182789, -0.02069534920156002, -0.016086900606751442, -0.01598733477294445, 0.0031932001002132893, 0.013583545573055744, 0.0036803586408495903, -0.012118514627218246, 0.02250174805521965, 0.07953841984272003, 0.00026824837550520897, -0.0008631952223367989, -0.0390864759683609, 0.0852278620004654, -0.010973514057695866, 0.014735657721757889, 0.00029491764144040644, 0.012132737785577774, -0.037038274109363556, 0.005344520788639784, -0.016456713899970055, 0.02786404825747013, 0.0378916934132576, 0.0039114924147725105, -0.015091248787939548, -0.03163330629467964, 0.018533362075686455, 0.003145195310935378, -0.04636896401643753, 0.003776367986574769, -0.022075040265917778, -0.04534486308693886, -0.002578028943389654, 0.03302721679210663, -0.006777549162507057, 0.007801649160683155, -0.005540095269680023, 0.005220064427703619, -0.05939778685569763, 0.02732355147600174, -0.007069133222103119, 0.03601417690515518, 0.048644740134477615, 0.024621065706014633, 0.020382430404424667, -0.05695132911205292, 0.009657829999923706, -0.0068522230722010136, -0.024350816383957863, 0.06998015195131302, -0.017054107040166855, -0.008143016137182713, -0.003499007550999522, 0.004487548489123583, 0.00944447610527277, 0.0068735587410628796, -0.006823775824159384, 0.04102088510990143, -0.03683914616703987, -0.01575975865125656, 0.012047396041452885, -0.006916229613125324, 0.04642585664987564, 0.028162743896245956, -0.043125979602336884, -0.005806787870824337, 0.0062548317946493626, -0.006834443658590317, -0.0014152490766718984, 0.01637137308716774, 0.014060036279261112, 0.0013761341106146574, 0.01948634348809719, -0.0325436145067215, -0.0325436145067215, -0.016015782952308655, 0.01992727443575859, 0.02528957463800907, -0.0011361107463017106, -0.021648332476615906, 0.02267243154346943, -0.0074958414770662785, -0.005369412247091532, -0.04927057772874832, -0.07510065287351608, -0.015845099464058876, -0.02046777307987213, 0.034136660397052765, -0.008882643654942513, 0.018206218257546425, 0.013896465301513672, -0.01554640382528305, -0.0233836118131876, -0.0017877297941595316, -0.027337774634361267, -0.03902957960963249, -0.031178148463368416, 0.022544419392943382, -0.00487514166161418, -0.0034314454533159733, 0.005486757028847933, 0.01086683664470911, -0.029926471412181854, 0.0168691985309124, 0.008313698694109917, 0.005917021073400974, 0.001428583636879921, 0.031348831951618195, -0.028546782210469246, -0.026185663416981697, -0.009892519563436508, -0.030267838388681412, 0.014564975164830685, 0.005298294126987457, -0.02907305583357811, 0.029385974630713463, -0.020681126043200493, -0.006425514817237854, 0.0023628969211131334, -0.016456713899970055, 0.042784612625837326, 0.009536929428577423, 0.04096399247646332, 6.228384881978855e-05, -0.02169100195169449, 0.00744605902582407, 0.04050883650779724, -0.02726665697991848, 0.013590658083558083, 0.036327093839645386, -0.047762878239154816, 0.02436504140496254, -0.0018437352264299989, 0.029926471412181854, -0.003210979513823986, 0.032884981483221054, 0.023340940475463867, -0.01708255335688591, -0.01647093892097473, -0.006934009026736021, -0.02223150059580803, -0.04030970484018326, 0.011350438930094242, 0.015077024698257446, 0.01861870288848877, -0.03308411315083504, 0.057292692363262177, 0.035729702562093735, -0.02726665697991848, -0.004565778188407421, -0.028105849400162697, -0.04944126307964325, 0.0033229903783649206, 0.01218252070248127, -0.009615159593522549, 0.007303822785615921, -0.011898048222064972, 0.03174709528684616, 0.013476869091391563, 0.006411291193217039, -0.037038274109363556, -0.025218456983566284, 0.019287213683128357, -0.005863682366907597, 0.003109636250883341, 0.012481216341257095, -0.01434450875967741, 0.003618130460381508, -0.013313297182321548, 0.0043666479177773, -0.03487628698348999, -0.04241479933261871, -0.011947831138968468, -0.01833423040807247, -0.002869613002985716, 0.02588696777820587, -0.021008269861340523, -0.014308949932456017, -0.01598733477294445, -0.0010578808141872287, -0.011215315200388432, 0.009942302480340004, -0.018206218257546425, -0.007161586545407772, -0.00824258103966713, -0.01172025315463543, 0.0024784638080745935, -0.03345392644405365, -0.0204251017421484, 0.0023095584474503994, 0.005600545555353165, 0.027408892288804054, 0.008939538151025772, 0.013078607618808746, -0.01486367080360651, 0.01240298617631197, -0.03322634845972061, 0.014515192247927189, 0.023909885436296463, -0.002775381552055478, -0.032116908580064774, 0.006443294696509838, -0.006141042802482843, 0.012751464731991291, -1.796008291421458e-05, 0.0007222925778478384, -0.032828088849782944, -0.00886841956526041, -0.003036740468814969, 0.028987713158130646, 0.027081750333309174, 0.019230319187045097, 0.01144289318472147, 0.008847083896398544, 0.011762923561036587, -0.0019913052674382925, 0.010027644224464893, -0.05146101489663124, -0.02123584784567356, -0.009835625067353249, 0.008477270603179932, 0.006549971643835306, 0.04036660119891167, 0.019799262285232544, 0.07362139970064163, 0.004960483405739069, -0.0068664466962218285, -0.03897268697619438, -0.010361898690462112, 0.053736791014671326, 0.00016234915528912097, -0.01702565886080265, -0.018191995099186897, 0.013512427918612957, -0.03251516819000244, -0.039826102554798126, 0.006805996410548687, -0.009970749728381634, 0.0012490105582401156, -0.03718051314353943, -0.04423542320728302, -0.02211771160364151, -0.023312494158744812, 0.015119695104658604, -0.012417210265994072, -0.0005689443205483258, -0.0008254137937910855, -0.01007031463086605, 0.008377705700695515, 0.006695763673633337, -0.0541919469833374, 0.018305784091353416, 0.0053978594951331615, 0.005838791374117136, 0.06576996296644211, -0.013320408761501312, -0.04187430441379547, -0.01341286301612854, 0.012715905904769897, -0.02250174805521965, -0.006450406275689602, -0.04326821491122246, -0.04232945665717125, -0.02628522738814354, 0.031064359471201897, 0.036440882831811905, -0.022643985226750374, -0.0034954517614096403, 0.012687458656728268, -0.030068708583712578, 0.0366969108581543, 0.01149978768080473, 0.018135100603103638, 0.024379264563322067, 0.0026633706875145435, -0.00024624622892588377, -0.032173801213502884, -0.03257206454873085, 0.020183300599455833, 0.0027007076423615217, 0.012218079529702663, 0.012708794325590134, 0.0050209336914122105, -0.023724978789687157, 0.011293545365333557, -0.030836783349514008, 0.037749458104372025, 0.005604101810604334, 0.01366177573800087, -0.013697334565222263, -0.021989697590470314, 0.0014232498360797763, 0.02344050630927086, -0.007822984829545021, 0.025659389793872833, -0.024222804233431816, 0.016499385237693787, 0.02682572603225708, -0.020738020539283752, -0.01571708731353283, -0.008719071745872498, -0.00864795409142971, -0.019856156781315804, 0.02349740080535412, 0.027679141610860825, 0.014387180097401142, 0.015190813690423965, -0.04571467638015747, 0.013917800970375538, 0.009238233789801598, 0.013988918624818325, 0.027963614091277122, -0.008370593190193176, -0.01423783227801323, -0.007303822785615921, -0.020624231547117233, -0.028233861550688744, -0.007431835401803255, 0.02452149987220764, -0.010703264735639095, -0.010383234359323978, 0.008911090902984142, -0.0021388751920312643, -0.055500518530607224, -0.028603676706552505, 0.018106652423739433, -0.02326982282102108, 0.0006089482340030372, 0.0028873924165964127, -0.0063757323659956455, 0.017722615972161293, 0.05336697772145271, 0.008349258452653885, 0.024621065706014633, 0.015233484096825123, -0.012907924130558968, 0.014515192247927189, -0.025417588651180267, -0.038517531007528305, 0.013540875166654587, -0.022416407242417336, -0.0015237040352076292, -0.011791370809078217, 0.004572890233248472, -0.028176967054605484, 0.020553113892674446, -0.02376765012741089, -0.005885018035769463, 0.009430252015590668, -0.016897646710276604, 0.0004351535171736032, 0.014564975164830685, 0.056922879070043564, -0.023028021678328514, -0.09933768212795258, -0.04696635529398918, 0.042187221348285675, 0.011257985606789589, 0.00793677382171154, -0.015304602682590485, 0.05848747864365578, 0.01319950819015503, -0.012794136069715023, -0.01360488124191761, 0.03609951585531235, -0.030922124162316322, 0.012815470807254314, -0.019301436841487885, 0.011770036071538925, -0.05393592268228531, -0.00396838691085577, -0.004949815571308136, 0.015973111614584923, -0.014792552217841148, -0.0319746695458889, -0.015446838922798634, 0.0114713404327631, -0.0026811501011252403, -0.029058830812573433, 0.02119317650794983, 0.013000378385186195, -0.013078607618808746, -0.03237293288111687, -0.010518358089029789, -0.016627397388219833, -0.017153671011328697, -0.0007240705308504403, -0.0038332624826580286, -0.03920026496052742, -0.02415168657898903, -0.0031345277093350887, -0.023084916174411774, -0.003669691039249301, 0.0012747908476740122, 0.01878938637673855, -0.019031187519431114, 0.030154049396514893, -0.020610008388757706, 0.02699640765786171, -0.05222908779978752, 0.006645980756729841, -0.019557461142539978, 0.013334632851183414, 0.0007751866360194981, 0.018362678587436676, -0.011378886178135872, 0.024777526035904884, 0.0066175335086882114, -0.0036216862499713898, 0.02134963683784008, -0.004035948775708675, 0.0032980991527438164, 0.011350438930094242, -0.024677960202097893, 0.008512829430401325, 0.03541678562760353, -0.0029282853938639164, -0.008548388257622719, -0.03914336860179901, 0.003184310393407941, -0.013462645001709461, 0.022743549197912216, -0.02720976248383522, -0.0461982786655426, -0.01483522355556488, 0.019571684300899506, 3.453114186413586e-05, 0.05777629837393761, 0.004974707029759884, -0.018590256571769714, 0.04551554471254349, 0.024649513885378838, -0.040707968175411224, 0.010653482750058174, 0.06252697855234146, -0.03974075987935066, 0.013782676309347153, 0.012765688821673393, 0.01937255449593067, 0.004498216323554516, 0.031121253967285156, -0.026256781071424484, -0.0102125508710742, 0.010134320706129074, 0.013732893392443657, -0.015446838922798634, 0.019258765503764153, -0.006599754095077515, -0.01846224255859852, -0.024052120745182037, 0.002014418598264456, 0.006848667282611132, 0.018846280872821808, -0.021804790943861008, 0.02321292832493782, 0.0008925314177758992, -0.05743493139743805, -0.003815482836216688, 0.028987713158130646, -0.012466992251574993, 0.003907936159521341, -0.0030189608223736286, 0.021605661138892174, -0.01226074993610382, 0.010710377246141434, 0.021662555634975433, -0.019016964361071587, 0.016229137778282166, -0.0205815602093935, 0.008292363956570625, 0.054277289658784866, 0.02557404711842537, 0.018490690737962723, 0.029869576916098595, -0.016385596245527267, 0.03743653744459152, -0.020112182945013046, 0.031064359471201897, 0.009864072315394878, -0.006599754095077515, -0.003641243791207671, 0.049526602029800415, -0.023668084293603897, -0.004807579796761274, 0.009736060164868832, 0.00022579978394787759, 0.0006267277640290558, -0.004110622685402632, -0.005081383977085352, 0.01796441711485386, 0.034961629658937454, 0.030836783349514008, -0.024877090007066727, 0.0189458467066288, 0.018476467579603195, 0.02895926684141159, 0.02555982396006584, 0.0216198842972517, 0.018277335911989212, 0.026868395507335663, 0.04102088510990143, -0.03470560535788536, -0.022900009527802467, 0.02019752375781536, 0.026299452409148216, -0.01769416779279709, 0.008548388257622719, 0.014820999465882778, -0.0018055093241855502, 0.009138667955994606, 0.014380067586898804, -0.032600510865449905, 0.010504134930670261, -0.0006716210045851767, 0.017822181805968285, 0.03060920536518097, -0.017495037987828255, -0.031889330595731735, 0.021875908598303795, -0.027138644829392433, 0.010873948223888874, -0.007097580470144749, -0.0061481548473238945, -0.006713543087244034, -0.012168296612799168, -0.039228711277246475, 0.015361497178673744, 0.016769634559750557, 0.021378083154559135, 0.030893677845597267, -0.00014456963981501758, 0.04133380576968193, -0.007367828860878944, 0.058601267635822296, 0.004576446022838354, 0.021036716178059578, 0.00849149376153946, 0.01223941519856453, 0.021705226972699165, -0.008662177249789238, 0.010681929998099804, -0.005092051811516285, 0.02184746228158474, 0.03339703381061554, 0.024976655840873718, 0.030210943892598152, 0.0019130753353238106, 0.0314057283103466, 0.014692987315356731, -0.0179075226187706, 0.014792552217841148, 0.03957007825374603, -0.018860504031181335, -0.0559556744992733, -0.05749182403087616, 0.07259729504585266, 0.01610112376511097, -0.018860504031181335, -0.034022871404886246, 0.030068708583712578, 0.0016188244335353374, -0.005600545555353165, -0.01277991198003292, 0.03370995074510574, -0.0036270201671868563, 0.01800708845257759, -0.024265475571155548, 0.020681126043200493, 0.017708392813801765, -0.04830337315797806, -0.012381650507450104, 0.028831254690885544, -0.01992727443575859, 0.008007891476154327, -0.022587090730667114, -0.010660594329237938, -0.00487514166161418, 0.022203052416443825, -0.010006308555603027, -0.023184482008218765, 0.042841508984565735, -0.010518358089029789, 0.011350438930094242, 0.010824166238307953, -0.022956904023885727, 0.013868018053472042, 0.011279321275651455, 0.022900009527802467, -0.023668084293603897, -0.031889330595731735, -0.012232302688062191, 0.01773683913052082, -0.00018201774219051003, -0.01415249053388834, 0.03925715759396553, 0.01834845542907715, -0.006429071072489023, 0.01172025315463543, 0.016684291884303093, 0.011073078960180283, 0.028930818662047386, 0.028319204226136208, -0.007083356846123934, -0.008477270603179932, 0.019799262285232544, 0.009778730571269989, -0.01960013248026371, 0.0072682639583945274, 0.014337397180497646, -0.0013681333512067795, -0.0007947441190481186, 0.023881439119577408, 0.037265852093696594, 0.009913855232298374, -0.0423579066991806, 0.031889330595731735, -0.0023628969211131334, -0.003209201619029045, 0.0036661350168287754, -0.016655845567584038, -0.005330297164618969, 0.0396554209291935, 0.030267838388681412, -0.015432614833116531, -0.018576031550765038, 0.004188852850347757, -0.021008269861340523, 0.021093610674142838, 0.010283668525516987, 0.004242191091179848, 0.025602495297789574, -0.010169879533350468, 0.011755811981856823, -0.0023095584474503994, -0.0045195515267550945, 0.021762121468782425, -0.01583087630569935, 0.00960804708302021, -0.0021530985832214355, -0.02206081710755825, -0.0013076829491183162, 0.0029922914691269398, 0.008107456378638744, 0.010255221277475357, 0.02693951316177845, 0.03538833558559418, -0.0018037313129752874, 0.02167677879333496, -0.0072540403343737125, -0.009736060164868832, -0.00370880588889122, 0.014650316908955574, 0.0006182824727147818, -0.011492675170302391, 0.0393993966281414, 0.02632789872586727, 0.027494234964251518, -0.0014490301255136728, 0.006905561778694391, 0.016072677448391914, -0.0168691985309124, -0.04167517274618149, -0.006443294696509838, -0.036981381475925446, -0.004985374864190817, -0.024407710880041122, 0.005913465283811092, 0.011371774598956108, -0.013804011978209019, 0.001387690776027739, -0.014849446713924408, -0.027380445972085, -0.010034755803644657, 0.005561430938541889, 0.006468185689300299, 0.0062548317946493626, 0.010504134930670261, 0.015489509329199791, -0.02075224369764328, -0.008455934934318066, 0.013789787888526917, 0.010767271742224693, 0.0082141337916255, 0.0033727730624377728, -0.004295529797673225, 0.0021246515680104494, -0.0047791325487196445, -0.02847566455602646, -0.04690945893526077, 0.01029078010469675, -0.02321292832493782, 0.007922549732029438, -0.007950996980071068, -0.04824648052453995, 0.05404971167445183, 0.0038901567459106445, 0.007488729897886515, -0.02025441825389862, -0.006645980756729841, 0.028603676706552505, 0.005490312818437815, 0.0011192201636731625, -0.0009405360906384885, -0.00952981784939766, 0.07407654821872711, -0.03237293288111687, -0.0233836118131876, 0.002645591041073203, -0.032600510865449905, 0.056041017174720764, -0.039228711277246475, -0.02342628315091133, -0.012730129063129425, 0.02348317764699459, 0.0026118101086467505, 0.03186088427901268, -0.014109819196164608, -0.0016046008095145226, 0.01297904271632433, -0.03151951730251312, -0.01015565637499094, 0.04298374429345131, 0.020026840269565582, 0.011784259229898453, 0.0007422945345751941, 0.02918684482574463, 0.011336215771734715, 0.004540886729955673, 0.02123584784567356, -0.022103486582636833, -0.009615159593522549, 0.0018330675084143877, -0.001730835298076272, 0.021719450131058693, 0.010959289968013763, -0.04045194014906883, -0.04161827638745308, -0.002791383070871234, -0.02415168657898903, -0.004750685300678015, 0.00218332395888865, 0.045913808047771454, -0.021491872146725655, -0.010625035502016544, 0.010852613486349583, 0.013512427918612957, 0.003445669077336788, 0.005557875148952007, 0.005312517751008272, 0.028290756046772003, 0.009970749728381634, 0.020410878583788872, 0.005582766141742468, 0.012737241573631763, -0.0035594580695033073, -0.020240195095539093, 0.015489509329199791, -0.009451587684452534, -0.008633730001747608, 0.01089528389275074, 0.01308571919798851, 0.03740809112787247, 0.01713944785296917, 0.015916217118501663, -0.03777790442109108, 0.01817777194082737, -0.048047348856925964, 0.0050316015258431435, 0.011883825063705444, -0.033425480127334595, -0.0036145744379609823, 0.005596989765763283, -0.01932988315820694, 0.046511199325323105, -0.02995491959154606, 0.006464629899710417, -0.01149978768080473, -0.017324354499578476, 0.003328324295580387, -0.009352022781968117, -0.018547585234045982, 0.021150505170226097, 0.003954163286834955, 0.01871826872229576, 0.008192798122763634, 0.000473823951324448, -0.016342926770448685, -0.0034189997240900993, -0.018760940060019493, 0.005472533404827118, -0.014408514834940434, -0.009970749728381634, -0.03223069757223129, 0.04227256402373314, -0.012943483889102936, 0.044263869524002075, 0.03885889798402786, 0.010511246509850025, -0.02853255718946457, -0.017338577657938004, -0.014365844428539276, 0.019685473293066025, 0.0157028641551733, 0.022971127182245255, -0.030580757185816765, 0.0024322369135916233, -0.006781105417758226, 0.01948634348809719, 0.0009432030492462218, -0.019415225833654404, -0.009899631142616272, -0.013405750505626202, -0.009992084465920925, 0.0012223413214087486, 0.03629864752292633, -0.003260762197896838, 0.05038002133369446, 0.026370570063591003, 0.01915919966995716, 0.042244117707014084, -0.009913855232298374, 0.02851833403110504, 0.022587090730667114, -0.009494258090853691, 0.016556279733777046, 0.011876712553203106, 0.019529014825820923, 0.030808335170149803, 0.001268568099476397, 0.03203156590461731, 0.005742781795561314, 0.0004996042116545141, 0.0051276106387376785, 0.019201871007680893, -0.022601313889026642, 0.015062801539897919, 0.00678821699693799, -0.013341744430363178, -0.0019379666773602366, 0.021719450131058693, 0.0366969108581543, -0.016385596245527267, -0.007616742048412561, -0.007808760739862919, 0.019671250134706497, 0.0314057283103466, -0.018092429265379906, 0.003287431551143527, -0.004932036157697439, -0.028176967054605484, -0.000785409880336374, -0.04079330712556839, 0.027906719595193863, 0.023284045979380608, 0.0022419963497668505, 0.018632926046848297, -0.015589074231684208, 0.028788583353161812, 0.005778340622782707, -0.02628522738814354, -0.012253638356924057, -0.02632789872586727, -0.015062801539897919, 0.00043093087151646614, 0.031348831951618195, -0.016300255432724953, 0.0023860102519392967, 0.018917398527264595, 0.007581183221191168, -0.0076025184243917465, -0.03237293288111687, -0.022985350340604782, -0.0053765238262712955, 0.020453548058867455, 0.0017859517829492688, 0.002906949957832694, 0.014230719767510891, -0.0034421132877469063, -0.03897268697619438, -0.03376684710383415, -0.027778707444667816, -0.015219260938465595, 0.004551554564386606, 0.016826529055833817, -0.020709574222564697, 0.008775966241955757, 0.02787827141582966, -0.01477832905948162, 0.009167115204036236, 0.022985350340604782, 0.032856535166502, 0.017338577657938004, 0.023397834971547127, 0.021491872146725655, 0.011883825063705444, -0.007250484079122543, 0.017594603821635246, 0.02157721295952797, 0.005081383977085352, 0.03683914616703987, 0.016286032274365425, -0.012694570235908031, 0.029471315443515778, -0.004622672684490681, -0.022985350340604782, -0.009714724496006966, 0.0005093829822726548, -0.006421959027647972, -0.025061998516321182, -0.026640817523002625, 0.023227151483297348, -0.012580781243741512, 0.015162366442382336, -0.006101927720010281, 0.008441711775958538, -0.019287213683128357, 0.020666902884840965, 0.022203052416443825, 0.007236260920763016, 0.01371867023408413, -0.004384427331387997, 0.0260576494038105, -0.037322748452425, -0.014749881811439991, 0.006589086726307869, -0.006564195267856121, 0.034904733300209045, 0.00035736814606934786, -0.01839112490415573, 0.012907924130558968, -0.002761157928034663, 0.026071874424815178, 0.015276155434548855, 0.017054107040166855, 0.012452769093215466, -0.03169019892811775, -0.006286834832280874, -0.004185296595096588, 0.006368620786815882, 0.014934788458049297, 0.023525847122073174, 0.002567361341789365, -0.0030296286568045616, 0.017210565507411957, -0.03456336632370949, 0.026626594364643097, 0.010539693757891655, 0.007008682936429977, -0.01867559738457203, 0.057406481355428696, 0.0008756408933550119, 0.016670068725943565, -0.01873249188065529, 0.00507782818749547, 0.02046777307987213, -0.0051489463075995445, -0.027522681280970573, -0.03368150442838669, 0.041191570460796356, -0.041362252086400986, -0.011037520132958889, -0.01593044213950634, -0.0074816178530454636, 0.03072299435734749, -0.0028607232961803675, -0.026214109733700752, -0.0037479207385331392, 0.015560626983642578, -0.027380445972085, 0.04247169569134712, -0.027949390932917595, -0.0021282073576003313, -0.0259011909365654, -0.015148142352700233, 0.006741990335285664, 0.011741588823497295, 0.018035534769296646, -0.026413241401314735, 0.0028251642361283302, 0.005945468321442604, 0.01696876436471939, -0.005710778757929802, 0.0003918159636668861, -0.02420858107507229, 0.021762121468782425, -0.01046146359294653, -0.031064359471201897, -0.008441711775958538, -0.016115348786115646, 0.026128768920898438, -0.015176589600741863, -0.002300668740645051, -0.0084345992654562, -0.0018917398992925882, -0.018704045563936234, 0.014223608188331127, 7.7840915764682e-05, -0.032856535166502, 0.005486757028847933, 0.01486367080360651, 0.01604422926902771, 0.004039504565298557, -0.039228711277246475, 0.028048954904079437, -0.016456713899970055, -0.010077426210045815, 0.03564436361193657, 0.025275351479649544, 0.03723740577697754, 0.034079764038324356, -0.00849149376153946, 0.04912834241986275, -0.0020286422222852707, 0.00615882221609354, 0.017765287309885025, -0.0030314065515995026, -0.016243360936641693, 0.04417852684855461, 0.03661156818270683, 0.03388063609600067, -0.022587090730667114, 0.008640841580927372, -0.03137727826833725, 0.018576031550765038, -0.0011521122651174664, -0.0024677959736436605, -0.010397457517683506, 0.027138644829392433, 0.03262895718216896, 0.01598733477294445, -0.01406714878976345, 0.008882643654942513, 0.000299140257993713, -0.04298374429345131, 0.023781873285770416, 0.007609630469232798, 0.04232945665717125, 0.04756374657154083, -0.009871183894574642, 0.024237029254436493, 0.0031789764761924744, 0.01615801826119423, 0.020567337051033974, -0.011741588823497295, -0.019969945773482323, 0.01560329832136631, 0.025744730606675148, 0.02336938865482807, -0.008455934934318066, 0.0021104279439896345, 0.010603699833154678, 0.01915919966995716, -0.019571684300899506, 0.0069553442299366, 0.03481939435005188, 0.04193119704723358, -0.014735657721757889, 0.0025495816953480244, 0.003655467415228486, -0.0010845501674339175, -0.003404776332899928, -0.0241374634206295, -0.021008269861340523, -0.010034755803644657, -0.02501932717859745, -0.02080913819372654, -0.006574863102287054, 0.02119317650794983, -0.024123240262269974, -0.015432614833116531, -0.016655845567584038, -0.031007466837763786, 0.0041639613918960094, -0.01029078010469675, 0.03154796361923218, 0.03467715531587601, 0.009842736646533012, 0.032600510865449905, -0.0423579066991806, 0.0038617097306996584, 0.002051755553111434, 0.004672455135732889, 0.035615913569927216, -0.009899631142616272, 0.001163668930530548, -0.0060308100655674934, 0.02501932717859745, -0.01593044213950634, -0.008043450303375721, 0.0076025184243917465, -0.024165909737348557, 0.03382373973727226, -0.003459892701357603]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
"), facilitate align-
ment data generation (Lee et al., 2023; Yang et al., 2023),
and implement resource-efficient RLHF systems (Yao et al.,
2023; Santacroce et al., 2023). These works complement our
study and can be seamlessly integrated into our implemen-
tation. Previous works have explored the implementation
details of PPO for LLMs (Zheng et al., 2023; Ramamurthy
et al., 2023). Our paper extends its investigations with ad-
ditional RLHF techniques, optimizing PPO performance to
surpass its reward-free counterpart, DPO. Our work is also
closely related to studies on algorithm implementation in
the RL community (Engstrom et al., 2020; Andrychowicz
et al., 2021; Yu et al., 2022). However, our findings provide
further insights into fine-tuning LLMs with a model size of
up to 34B parameters.
3. Preliminary
Language Model. We consider an LLM as a policy
πθ(y|x)parameterized by θ.πθis designed to follow
user instructions x∈ X to generate a text response y∈ Y.
We only consider single-round conversations to simplify
notations. Given a prompt x, the LLM πθwill generate
response yin an auto-regressive manner:
πθ(y|x) =Y
tπθ(yt|x,y<t), (1)
where ytis the t-th token in the response and y<tis tokens
in the response before yt.
SFT. As an initial phase of alignment, the pre-trained model
is enforced to imitate high-quality demonstration data (dia-
logue, summarization, etc.), which is usually referred to as
Supervised Fine-Tuning (SFT).
RLHF. To further align the SFT model πθwith human
preference, prior works (Ziegler et al., 2019; Ouyang et al.,
2022) proposed the Reinforcement Learning from Human
Feedback (RLHF) procedure, which maximizes the follow-
ing objective,
Jr(πθ) =Ex∼pdata,y∼πθ
r(x,y)−βlogπθ(y|x)
πref(y|x)
.
(2)
where ris the reward function reflecting human preferences.
rtakes a prompt and the corresponding response as input
and outputs a scalar value. πrefis the reference model used
for regularizing πθwith Kullback–Leibler divergence. βis
a constant to control the degree of regularization.
In the rest of this section, we will introduce two repre-
sentative algorithms to optimize Eq. (2): a reward-based
approach, PPO, and a reward-free approach, DPO.
2
Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study
PPO. We can directly adopt standard reinforcement learning
methods for Eq. (2). In this paper, we chose PPO as the train-
ing algorithm. When ris unknown, a reward model rϕ∈R
is first learned from human-labeled data to approximate
r. A common practice is to collect a dataset of preference
pairsD={(x,yw,yl)}.ywandylare responses to xand
marked as “win” and “lose” by human respectively. The
distribution of the preference dataset is assumed to follow
the Bradley-Terry model (Bradley & Terry, 1952; Christiano
et al., 2017), i.e., the probability of response ywis better
thanylis given by
Pϕ(yw≻yl|x) =exp (rϕ(x,yw))
exp (rϕ(x,yw)) + exp ( rϕ(x,yl))
=σ(rϕ(x,yw)−rϕ(x,yl)). (3)
where σis the sigmoid function. Given D,rϕis trained by
minimizing the negative log-likelihood of Eq. (3):
LR(rϕ) =−E(x,yw,yl)∼D[logσ(rϕ(x,yw)−rϕ(x,yl))]
(4)
After a reward model rϕis obtained, ris replaced with rϕ
andJrϕ(πθ)could be explicitly optimized with online RL
algorithms. We note that there exist cases when a ground-
truth reward is available, and thus reward modeling becomes
unnecessary (Zhang et al., 2020; Sellam et al., 2020; Rama-
murthy et al., 2023). In these cases, the reward function","[-0.020030999556183815, -0.007933131419122219, 0.03860245272517204, -0.013651780784130096, 0.013211400248110294, 0.0030055935494601727, -0.008379803039133549, 0.031053083017468452, -0.02162894979119301, 0.023088494315743446, 0.014608033932745457, -0.010732689872384071, -0.02027006261050701, -0.00019541863002814353, 0.012582286261022091, -0.062257152050733566, 0.01746421307325363, -0.05722423642873764, 0.02305074781179428, 0.04524590075016022, 0.015035832300782204, -0.009556245990097523, -0.005045496858656406, 0.035607870668172836, 0.03256295621395111, -0.003178599989041686, 0.004649154841899872, 0.01509874314069748, -0.0010026509407907724, -0.04202483594417572, 0.037520378828048706, -0.01649537682533264, -0.017917174845933914, -0.035205237567424774, -0.005599117372184992, 0.0202448982745409, 0.018596619367599487, 0.040791772305965424, -0.016130490228533745, 0.020874012261629105, -0.020521709695458412, -0.06839730590581894, -0.029971005395054817, 0.015627199783921242, -0.0028734796214848757, 0.06044530123472214, 0.04361020401120186, 0.02833530865609646, 0.019603202119469643, 0.0037526667583733797, -0.05098342522978783, 0.0717693567276001, -0.022685861214995384, -0.037293896079063416, 0.0023072767071425915, -0.013840515166521072, 0.04348438233137131, -0.002203472889959812, 0.029165739193558693, -0.016155654564499855, -0.016004668548703194, -0.027806852012872696, 0.03077627159655094, -0.005964003503322601, -0.022912343963980675, -0.020106492564082146, -0.09507175534963608, 0.01833239011466503, 0.01240613404661417, 0.02891409397125244, 0.015174237079918385, -0.02369244396686554, 0.04751071333885193, 0.008417549543082714, -0.0022585203405469656, -0.009411550126969814, 0.02674994058907032, 0.04834114387631416, 0.00203990307636559, -0.009549954906105995, 0.018772771582007408, -0.003109397366642952, 0.048743776977062225, -0.04441547021269798, 0.008379803039133549, -0.04975035786628723, -0.030147157609462738, -0.013576286844909191, -0.04537172242999077, -0.04199967160820961, -0.006800725590437651, -0.04220098629593849, -0.02034555748105049, -0.010751563124358654, 0.046478964388370514, -0.014205400831997395, -0.017376137897372246, -0.0012865387834608555, 0.0533992238342762, 0.02267327904701233, -0.013022665865719318, -0.04949871450662613, 0.008574827574193478, -0.02292492613196373, 0.037293896079063416, 0.029467714950442314, 0.008090410381555557, 0.017401302233338356, -0.008864220231771469, 0.014872262254357338, -0.06794434785842896, 0.020546874031424522, -0.050807271152734756, 0.004347180016338825, 0.003545059124007821, -0.06739072501659393, -0.04763653501868248, 0.025894345715641975, -0.011223399080336094, -0.004737230949103832, -0.019452214241027832, -0.001137910527177155, 0.04245263338088989, -0.006438985001295805, 0.018193986266851425, -0.004149009007960558, 0.026246648281812668, -0.05707325041294098, 0.01430605910718441, 0.009682069532573223, 0.018370138481259346, 0.04212549328804016, -0.011701526120305061, -0.04461678862571716, -0.10070861876010895, 0.0221070758998394, -0.010210525244474411, 0.012368387542665005, -0.007851346395909786, -0.025542041286826134, 0.014205400831997395, -0.028108827769756317, -0.07448713481426239, 0.027806852012872696, -0.06089826673269272, -0.020081328228116035, -0.01194688118994236, -0.024220900610089302, -0.04552271217107773, 0.030021334066987038, -0.0027130553498864174, -0.01542588323354721, -0.022169988602399826, 0.04600083827972412, -0.03291526064276695, -0.03578402101993561, -0.016558289527893066, 0.04423931986093521, 0.02463611587882042, -0.009052954614162445, 0.008436422795057297, 0.036916427314281464, -0.023252064362168312, -0.002409507753327489, 0.035180073231458664, 0.022509710863232613, -0.02563011646270752, 0.018483377993106842, -0.06915224343538284, -0.00022726754832547158, -0.007939422503113747, 0.009990335442125797, -0.0720210075378418, -0.017552290111780167, -0.01059428509324789, -0.001196890021674335, -0.015010667033493519, 0.013878261670470238, -0.001958118285983801, -0.048668283969163895, -0.006750396452844143, 0.022585203871130943, -0.028133992105722427, -0.009958879090845585, 0.007108991499990225, 0.018810518085956573, 0.0222328994423151, -0.018395302817225456, -0.0072411056607961655, 0.03251262754201889, 0.009814183227717876, 0.02004358172416687, 0.07499042898416519, -0.007291434798389673, -0.004262249451130629, 0.0028058497700840235, 0.06155254319310188, 0.046529293060302734, -0.0327894389629364, 0.009417841210961342, 0.020597202703356743, 0.014104742556810379, -0.017250314354896545, -0.0638173520565033, -0.011871387250721455, 0.006379219237715006, -0.01014761347323656, 0.015765605494379997, -0.04642863571643829, -0.039156075567007065, 0.00457680644467473, 0.027882346883416176, 0.05470778048038483, 0.013890843838453293, -0.02858695387840271, -0.0002777932968456298, -0.04962453618645668, 0.014947756193578243, 0.01795492321252823, 0.04539688676595688, -0.0016435611760243773, 0.003227356355637312, 0.043006252497434616, 0.04559820517897606, -0.027328725904226303, -0.007203358691185713, 0.016784770414233208, -0.013601451180875301, 0.015111325308680534, -0.040993086993694305, 0.04547238349914551, 0.012827640399336815, -0.020471379160881042, -7.800034654792398e-05, 0.025315560400485992, -0.02466128021478653, -0.021603785455226898, -0.011506500653922558, 0.029266398400068283, -0.044843267649412155, 0.005816161632537842, 0.017149655148386955, 0.025466546416282654, -0.027655864134430885, 0.019527707248926163, 0.03087693080306053, -0.01524973101913929, -0.018370138481259346, 0.017199985682964325, -0.029920676723122597, 0.02478710375726223, -0.018420467153191566, -0.038954757153987885, -0.017892010509967804, -0.04418898746371269, 0.03296558931469917, -0.0072725615464150906, -0.014054413884878159, -0.022383887320756912, -0.036991920322179794, -0.02695125713944435, 0.023314977064728737, 0.017476795241236687, 0.03596017509698868, -0.0057784151285886765, -0.03210999444127083, -0.050807271152734756, 0.010902551002800465, -0.006376073695719242, -0.003044913290068507, -0.0007152243051677942, -0.009034081362187862, -0.03623698279261589, 0.022987836971879005, -0.03475227579474449, -0.05511041358113289, 0.031204069033265114, 0.03568336367607117, -0.03273911029100418, -0.01053137332201004, -0.011777020059525967, 0.007624865509569645, 0.05843213573098183, 0.01331205852329731, -0.002313567791134119, -0.025869179517030716, -0.029719360172748566, -0.010197943076491356, -0.02295009046792984, -0.003416090738028288, -0.004171027801930904, -0.041043419390916824, 0.041118912398815155, -0.026246648281812668, 0.02267327904701233, 0.03062528371810913, 0.007851346395909786, -0.029643867164850235, 0.04192417860031128, 0.035079412162303925, 0.035381387919187546, -0.01430605910718441, -0.011808475479483604, -0.011928007006645203, 0.02103758230805397, 0.020999835804104805, 0.024007001891732216, -0.0021987545769661665, 0.013098159804940224, -0.025466546416282654, 0.016382137313485146, 0.01731322519481182, 0.01188396941870451, 0.01840788498520851, -0.016709275543689728, -0.02478710375726223, 0.04897025600075722, -0.008266561664640903, 0.0014839234063401818, -0.03439997136592865, -0.044667117297649384, -0.03578402101993561, 0.0017143364530056715, -0.021301809698343277, 0.015853680670261383, -0.009713524952530861, 0.021025000140070915, -0.008763561956584454, -0.03817465528845787, -0.02027006261050701, 0.020106492564082146, 0.014029249548912048, -0.0055896807461977005, 0.02091175876557827, 0.0023654696997255087, -0.009317182935774326, -0.02851146087050438, 0.044667117297649384, 0.04363536834716797, 0.022912343963980675, -0.07181969285011292, 0.004092388786375523, -0.02282426692545414, 0.010965462774038315, -0.04939805716276169, 0.0012621606001630425, -0.0050297686830163, 0.004158445633947849, 0.02376793883740902, 0.0402381494641304, 0.00571864889934659, -0.0067755612544715405, 0.03814949095249176, 0.016973504796624184, 0.0015020103892311454, 0.05299659073352814, 0.025894345715641975, -0.05561370402574539, -0.003318578004837036, -0.0010388250229880214, -0.012204817496240139, -0.003925673197954893, -0.03653895854949951, 0.020899176597595215, 0.003976002335548401, 0.02677510492503643, 0.007448713295161724, -0.01106612104922533, 0.016759606078267097, -0.0009200796484947205, -0.011129031889140606, 0.03281460329890251, -0.03658928722143173, 0.03434964269399643, -0.04391217976808548, 0.020949507132172585, 0.007694067899137735, 0.008178485557436943, -0.024195736274123192, 0.0227236095815897, -0.005120990332216024, 0.021717026829719543, -0.02682543359696865, -0.025026166811585426, -0.018483377993106842, 0.0132868941873312, 0.001851168810389936, -0.02848629653453827, -0.0006055225385352969, -0.015123908407986164, -0.0048882183618843555, -0.004815869964659214, -0.03568336367607117, 0.03616148978471756, -0.0142808947712183, -0.009317182935774326, -0.027706194669008255, 0.06447163224220276, 0.04207516461610794, 0.04748554900288582, -0.05697259306907654, -0.013765021227300167, -0.04579951986670494, 0.000305317051243037, -0.040892429649829865, -0.002112251240760088, -0.01430605910718441, 0.03379601985216141, 0.008058954030275345, 0.04771202802658081, 0.0494232214987278, -0.024346724152565002, 0.02647313103079796, -0.02391892671585083, 0.03241197019815445, -0.03835080936551094, 0.012418716214597225, -0.012362096458673477, 0.04698225483298302, 0.04574919119477272, 0.012399842962622643, -0.022585203871130943, 0.02167927846312523, -0.046529293060302734, 0.002937963930889964, 0.024510294198989868, 0.0009428850607946515, -0.037394553422927856, -0.012211108580231667, -0.03963420167565346, 0.007662612479180098, 0.07066211849451065, 0.06276044249534607, -0.05953937768936157, -0.046604789793491364, -0.012777311727404594, -0.015287477523088455, 0.025026166811585426, -0.00659940904006362, -0.03072594292461872, 0.021201152354478836, 0.03200933709740639, -0.027429383248090744, -0.006133864633738995, -0.0038029958959668875, -0.013588869012892246, -0.04157187417149544, 0.00673152320086956, -0.017917174845933914, 0.014595451764762402, -0.011802184395492077, 0.031254399567842484, 0.0921526625752449, 0.019905176013708115, 0.020559456199407578, -0.03809916228055954, 0.08988784998655319, -0.017778770998120308, 0.02664928138256073, 0.0016545706894248724, 0.02707708068192005, -0.031380221247673035, 0.02888892963528633, -0.046881597489118576, 0.014834515750408173, 0.03047429770231247, 0.016105325892567635, -0.01244388148188591, -0.024258647114038467, 0.022962672635912895, -0.020030999556183815, -0.03409799560904503, 0.027806852012872696, -0.009443005546927452, -0.048466965556144714, 0.02006874606013298, 0.013337223790585995, -0.03314174339175224, -0.0017772478749975562, -0.020332975313067436, 0.013815349899232388, -0.03017232194542885, 0.03613632544875145, -0.013110741972923279, 0.04207516461610794, 0.03029814548790455, 0.04338372126221657, -0.003026039805263281, -0.027655864134430885, 0.03233647719025612, 0.013450464233756065, -0.044566456228494644, 0.056016337126493454, -0.013098159804940224, 0.0009476034319959581, -0.029039915651082993, 0.014620616100728512, 0.009656904265284538, 0.017476795241236687, -0.004293705336749554, 0.031631868332624435, -0.029115410521626472, -0.0162688959389925, 0.020395886152982712, 0.0040609329007565975, 0.04383668676018715, 0.01828206144273281, -0.03747004643082619, -0.0029206632170826197, 0.02511424385011196, 0.012009792029857635, 0.00474352203309536, -0.00768148573115468, 0.007215941324830055, -0.012041247449815273, 0.011374386958777905, -0.03472711145877838, -0.024346724152565002, -0.011280019767582417, 0.03198417276144028, -0.0005308152176439762, -0.01012244913727045, -0.013387552462518215, 0.015174237079918385, 0.01708674430847168, -0.014985502697527409, -0.04559820517897606, -0.07604733854532242, -0.04026331752538681, -0.010197943076491356, 0.029140574857592583, 0.010336347855627537, 0.01039296854287386, 0.004796996712684631, -0.012959755025804043, -0.012160779908299446, -0.02667444758117199, -0.02662411704659462, -0.04811466112732887, -0.03251262754201889, 0.022522293031215668, 0.001862178323790431, 0.00455164210870862, 0.031405385583639145, 0.013991502113640308, -0.012884261086583138, 0.03394700959324837, 0.012934589758515358, 0.005070661194622517, 0.027379054576158524, 0.038954757153987885, -0.03291526064276695, -0.037092581391334534, -0.02883859910070896, -0.05400317162275314, -0.0032871223520487547, -0.01915024034678936, -0.002571504795923829, 0.025969838723540306, 0.013450464233756065, -0.014104742556810379, -0.004727793857455254, -0.023956673219799995, 0.02846113219857216, -0.0015853680670261383, 0.02262295037508011, -0.0007899316260591149, -0.019615784287452698, 0.003507312387228012, 0.037268731743097305, -0.027303561568260193, 0.015325224958360195, 0.033242400735616684, -0.052090663462877274, 0.02401958405971527, -0.007945713587105274, 0.025693029165267944, -0.010883677750825882, 0.025391053408384323, 0.031430549919605255, -0.02861211821436882, -0.021691860631108284, -0.0014658363070338964, -0.04957420751452446, -0.04715840891003609, 0.01698608696460724, -0.020005835220217705, 0.020924342796206474, -0.05717390775680542, 0.016596036031842232, 0.03467677906155586, -0.025743357837200165, -0.017577454447746277, -0.009008917026221752, -0.03986068442463875, -0.013186235912144184, -0.0029568371828645468, -0.0036929009947925806, -0.004752958659082651, -0.014029249548912048, 0.03175769001245499, 0.021540874615311623, 0.020634949207305908, -0.024007001891732216, -0.026221483945846558, 0.00824768841266632, -0.014142489992082119, 0.013878261670470238, 0.006693776231259108, -0.009751271456480026, -0.007480169180780649, -0.012896843254566193, 0.014519957825541496, -0.025768522173166275, -0.04220098629593849, -0.03243713453412056, 0.012097868137061596, -0.020723026245832443, 0.029341891407966614, -0.012034956365823746, -0.002132697496563196, 0.003117261454463005, 0.018458213657140732, -0.010726398788392544, 0.001814994728192687, -0.008335764519870281, -0.03578402101993561, 0.0077255237847566605, -0.017577454447746277, 0.020723026245832443, -0.040791772305965424, -0.0022239191457629204, 0.003664590884000063, 0.009166195057332516, 0.033343058079481125, -0.009644322097301483, 0.0227236095815897, -0.03606083244085312, 0.014029249548912048, -0.01981710083782673, -0.0026045332197099924, 0.013123324140906334, 0.0018291499000042677, -0.047007422894239426, 0.017866846174001694, 0.0024409634061157703, 0.005363199394196272, 0.016130490228533745, -0.0039351098239421844, -0.03611116111278534, -0.017992669716477394, -0.0014328078832477331, 0.03389667719602585, 0.012808767147362232, 0.014708692207932472, -0.0061495923437178135, -0.004834743682295084, 0.031153740361332893, 0.005426110699772835, -0.004029477015137672, -0.06910191476345062, -0.025919510051608086, -0.020672695711255074, 0.013903426006436348, 0.013513375073671341, 0.037369389086961746, 0.010040664114058018, 0.072524294257164, -0.0013824787456542253, -0.018860846757888794, -0.044767774641513824, -0.0020807955879718065, 0.04270428046584129, -0.02417057193815708, -0.029341891407966614, -0.024258647114038467, 0.012752147391438484, -0.023780521005392075, -0.031732525676488876, -0.001566494582220912, -0.026196319609880447, -0.00936122052371502, -0.04547238349914551, -0.03419865295290947, -0.02836047299206257, -0.006637156009674072, 0.042804937809705734, -0.031707361340522766, -0.0035261856392025948, 0.0029615554958581924, -0.007939422503113747, -0.01033005677163601, 0.0033940717112272978, -0.048995424062013626, 0.015010667033493519, 0.010141322389245033, 0.0013376543065533042, 0.07660096138715744, -0.015476211905479431, -0.0576268695294857, -0.011342930607497692, 0.010883677750825882, -0.019414467737078667, -0.009342347271740437, -0.03369536250829697, -0.029241232201457024, -0.03955870866775513, 0.02511424385011196, 0.04031364619731903, 0.000400470569729805, -0.011928007006645203, 0.008216232992708683, -0.009046663530170918, 0.04059045389294624, 0.004554787650704384, 0.025667862966656685, 0.030121993273496628, 0.005970294587314129, 0.0018244314705953002, -0.02121373452246189, -0.03671511262655258, -0.004664882551878691, -0.005234231241047382, 0.01094029750674963, -0.0036457173991948366, -0.00904037244617939, -0.025164572522044182, 0.012632614932954311, -0.027756523340940475, 0.019905176013708115, 0.008398676291108131, 0.0025825141929090023, -0.022069329395890236, -0.037394553422927856, -0.011292601935565472, 0.03251262754201889, -0.017715858295559883, 0.003639426315203309, -0.027630699798464775, -0.0028168593998998404, 0.012192235328257084, -0.0013502365909516811, -0.03955870866775513, 0.01276472955942154, 0.015677528455853462, -0.0005056506488472223, 0.04026331752538681, 0.04723390191793442, 0.011990918777883053, 0.009411550126969814, -0.041471216827631, 0.009782727807760239, 0.011022082529962063, 0.004328306298702955, 0.03447546437382698, 0.0018590327817946672, -0.018508542329072952, 0.011777020059525967, -0.03641313686966896, -0.029442548751831055, 0.0010301746660843492, -0.0014438173966482282, -0.008342055603861809, 0.014897426590323448, 0.009480752982199192, -0.019137658178806305, -0.033041082322597504, -0.022396469488739967, 0.037520378828048706, -0.009864512830972672, -0.012242564000189304, -0.003434964222833514, -0.0038029958959668875, 0.03188351169228554, 0.05490909516811371, -0.00951220840215683, 0.01795492321252823, 0.010701234452426434, -0.012450172565877438, -0.007278852630406618, -0.04423931986093521, -0.03439997136592865, 0.012651489116251469, -0.04758620634675026, 0.0004966070991940796, -0.017967505380511284, -0.024774521589279175, -0.029467714950442314, 0.02071044221520424, -0.029920676723122597, -0.006061516236513853, 0.022560039535164833, -0.010015499778091908, -0.007851346395909786, 0.03407283127307892, 0.054305147379636765, -0.04189901426434517, -0.09789018332958221, -0.043182406574487686, 0.02555462345480919, 0.009581411257386208, -0.0017976941308006644, -0.021968672052025795, 0.037319060415029526, 0.002003729110583663, -0.003472710959613323, -0.023931508883833885, 0.012670362368226051, -0.03243713453412056, 0.01346304640173912, -0.005514186806976795, 0.014117324724793434, -0.058029502630233765, -0.0286876130849123, -0.007322890684008598, 0.02116340585052967, -0.014079578220844269, -0.015111325308680534, -0.003922527655959129, 0.007222232408821583, 0.021402468904852867, -0.03409799560904503, 0.00668748514726758, 0.02034555748105049, 0.008732106536626816, -0.004460420459508896, -0.008436422795057297, -0.01686026342213154, -0.014922591857612133, 0.011393260210752487, 0.004831597674638033, -0.03837597370147705, -0.018458213657140732, 0.006410674657672644, -0.008505625650286674, -0.009134739637374878, 0.027328725904226303, 0.016759606078267097, -0.023478545248508453, 0.03241197019815445, -0.006473586428910494, 0.022258063778281212, -0.042729444801807404, 0.020106492564082146, -0.021868012845516205, 0.012450172565877438, -0.010279728099703789, 0.002547912998124957, -0.04026331752538681, 0.014066996052861214, -0.0057595414109528065, -0.011827348731458187, 0.00858111958950758, -0.019213151186704636, 0.007970877923071384, -0.0001294599351240322, -0.01035522110760212, -0.022711027413606644, 0.036991920322179794, -0.012733273208141327, -0.014079578220844269, -0.0320345014333725, 0.008864220231771469, -0.013047831133008003, 0.003928818739950657, -0.03241197019815445, -0.05158737301826477, -0.018709858879446983, 0.005819307174533606, 0.003913091029971838, 0.052392639219760895, 0.022459380328655243, -0.021326975896954536, 0.027303561568260193, 0.04237714037299156, -0.015576870180666447, 0.014721274375915527, 0.059891682118177414, -0.029719360172748566, 0.03495359048247337, 0.027404218912124634, 0.027832016348838806, 0.027530042454600334, 0.035054247826337814, 0.015350389294326305, -0.022283228114247322, 0.021578621119260788, 0.012003500945866108, -0.016533123329281807, 0.009386385791003704, -0.013853097334504128, -0.00021979681332595646, -0.03258812054991722, -0.010160195641219616, 0.016646364703774452, 0.016835099086165428, -0.021490544080734253, 0.02021973393857479, 0.024749357253313065, -0.050605956465005875, -0.014079578220844269, 0.020458796992897987, -0.024447381496429443, 0.010518791154026985, 0.011959463357925415, 0.009122157469391823, -0.013299476355314255, 0.002786976285278797, 0.012607450596988201, -0.03034847415983677, 0.02690092846751213, -0.037142910063266754, 0.015929173678159714, 0.04013749212026596, 0.027504878118634224, 0.025768522173166275, 0.025290396064519882, -0.009638031013309956, 0.03772169351577759, -5.023084668209776e-05, 0.025491712614893913, -0.00804637186229229, -0.024434799328446388, -0.01206012163311243, 0.047082915902137756, -0.027857180684804916, -0.003211628645658493, 0.0265737883746624, -0.01276472955942154, 0.007121574133634567, -0.016080161556601524, -0.02486259676516056, 0.03583434969186783, 0.05380185693502426, 0.016596036031842232, -0.020332975313067436, 0.013626615516841412, 0.016696693375706673, 0.035507213324308395, 0.026322143152356148, 0.031128576025366783, 0.0031377077102661133, 0.03075110726058483, 0.035054247826337814, -0.04215065762400627, -0.0040137493051588535, 0.012217399664223194, 0.036916427314281464, -0.015589452348649502, 0.009883386082947254, -0.0027445112355053425, 0.008272852748632431, -0.0004077447229065001, 0.01716223917901516, -0.025818850845098495, -0.011034664697945118, 0.005643155425786972, 0.005813016090542078, 0.041118912398815155, -0.025265229865908623, -0.029316727072000504, 0.025479130446910858, -0.033217236399650574, -0.02508907951414585, -0.01536297146230936, -0.0032336474396288395, -0.014784186147153378, -0.008184777572751045, -0.040615618228912354, 0.027102245017886162, -0.004218211397528648, 0.035305894911289215, -0.020421050488948822, 0.014947756193578243, 0.02297525480389595, -0.01805558055639267, 0.048819269984960556, 0.008820182643830776, 0.03812432661652565, 0.0021657259203493595, 0.0040137493051588535, 0.00901520811021328, -0.008901967667043209, 0.0016073870938271284, -0.02568044699728489, 0.018420467153191566, 0.03251262754201889, 0.011877678334712982, 0.011210816912353039, 0.01621856726706028, 0.03455095738172531, 0.04610149562358856, -0.017703276127576828, 0.016432465985417366, 0.06522656977176666, -0.005935693625360727, -0.05873411148786545, -0.05863345414400101, 0.0690515860915184, 0.0035293311811983585, -0.02029522694647312, -0.03439997136592865, 0.024510294198989868, 0.013790185563266277, -0.02121373452246189, -0.01000920869410038, 0.009971462190151215, 0.007857637479901314, 0.02106274664402008, -0.009034081362187862, 0.005086389370262623, 0.013513375073671341, -0.0680450052022934, -0.003891072003170848, -0.0026737358421087265, -0.00625968724489212, -0.006913966033607721, -0.01795492321252823, 0.0013463046634569764, -0.0025589223951101303, 0.005394655279815197, -0.003891072003170848, -0.014796768315136433, 0.0422261506319046, -0.005435547791421413, 0.011701526120305061, 0.009524790570139885, -0.027127409353852272, 0.009141030721366405, -0.005923110991716385, 0.003475856501609087, -0.0066623203456401825, -0.02662411704659462, -0.005133572965860367, -0.01599208638072014, -0.004652300383895636, 0.007599700707942247, 0.04056528955698013, 0.029971005395054817, -0.023453380912542343, 0.014620616100728512, 0.04210032895207405, 0.014796768315136433, 0.021175988018512726, 0.04428964853286743, -0.03205966576933861, -0.01907474547624588, 0.011519082821905613, 0.007008333224803209, -0.007492751348763704, -0.008650321513414383, 0.007291434798389673, 0.0016404155176132917, -0.010411841794848442, 0.039080582559108734, 0.04894509166479111, -0.004712066147476435, -0.0402381494641304, 0.03460128605365753, 0.010801892727613449, 0.0046208444982767105, -0.001079717418178916, -0.015463629737496376, -0.014733857475221157, 0.027202902361750603, 0.044994253665208817, 0.004205629229545593, -0.014645781368017197, 0.0014642635360360146, -0.018344974145293236, 0.014960338361561298, 0.033519212156534195, 0.018785353749990463, 0.02508907951414585, -0.004350325558334589, 0.02639763616025448, 0.001315635279752314, -0.027026750147342682, -0.0019156531197950244, -0.001470554736442864, -0.005215357523411512, 0.014645781368017197, 0.006083535496145487, 0.018546290695667267, 0.0049637118354439735, 0.02667444758117199, 0.01904958114027977, 0.05005233362317085, 0.0340225026011467, -0.0036582998000085354, -0.003733793506398797, 0.00953737273812294, -0.018886011093854904, -0.009795309975743294, 0.005772123578935862, 0.00048323842929676175, -0.020395886152982712, 0.03049946203827858, 0.016256313771009445, 0.007750688120722771, 0.006549079902470112, 0.0002709123364184052, 0.012393551878631115, -0.007530498318374157, -0.0217296089977026, -0.0014752730494365096, -0.037495214492082596, -0.008386094123125076, -0.014205400831997395, 0.0007576895295642316, 0.010304892435669899, -0.012651489116251469, -0.010317474603652954, -0.014947756193578243, -0.013085577636957169, -0.003261957783252001, -0.009380094707012177, 0.014595451764762402, -0.006907674949616194, 0.012487919069826603, 0.024900345131754875, -0.01701125130057335, -0.012607450596988201, 0.024359306320548058, -0.009109575301408768, 0.002299412852153182, 0.0031046790536493063, 0.03077627159655094, 0.016155654564499855, 0.001954972743988037, -0.04366053268313408, -0.04919673874974251, -0.006187339313328266, -0.033594705164432526, 0.001042756950482726, -0.020999835804104805, -0.03767136484384537, 0.060143329203128815, 0.0217296089977026, -0.0015955911949276924, -0.011047246865928173, -0.021515710279345512, 0.017640365287661552, 0.007486460264772177, -0.0040137493051588535, 0.0034475463908165693, -0.021125659346580505, 0.06693775951862335, -0.027832016348838806, -0.02685059793293476, 0.023981837555766106, -0.005982877220958471, 0.054254818707704544, -0.029039915651082993, -0.03404766693711281, -0.0127269821241498, 0.018294643610715866, 0.0053411806002259254, 0.015287477523088455, -0.03175769001245499, -0.007845055311918259, 0.018168821930885315, -0.027303561568260193, -0.013890843838453293, 0.035381387919187546, 0.040842100977897644, 0.010959171690046787, 0.020181987434625626, -0.005891655571758747, -0.0034884389024227858, 0.011129031889140606, 0.011456171981990337, 0.0013313631061464548, -0.028310144320130348, 0.008958587422966957, 0.003655154025182128, 0.005036060232669115, 0.003922527655959129, -0.029417384415864944, -0.04735972359776497, 0.0022443654015660286, -0.019414467737078667, -0.003271394409239292, -0.017665529623627663, 0.017350973561406136, -0.01619340293109417, -0.005287705920636654, -0.0003762889828067273, 0.005724939983338118, -0.008373511023819447, 0.01611790806055069, -0.013135907240211964, 0.012909425422549248, -0.006920257583260536, 0.012670362368226051, 0.012865387834608555, 0.03787268325686455, 0.0036362807732075453, -0.0264479648321867, 0.023013001307845116, -0.012236272916197777, -0.0014752730494365096, 0.0019958652555942535, -0.0031031062826514244, 0.007014624774456024, 0.0017725295620039105, 0.02230839431285858, -0.03460128605365753, 0.01132405735552311, -0.029115410521626472, 0.006388655863702297, 0.002702045952901244, -0.005555079318583012, -0.0073480550199747086, 0.02404474839568138, -0.01085222139954567, 0.05531172826886177, -0.05360053852200508, 0.0021264064125716686, -0.01281505823135376, -0.0005186261259950697, -0.004510749597102404, -0.0014784185914322734, -0.009021499194204807, 0.003749521216377616, -0.004469857085496187, 0.029920676723122597, 0.004702629521489143, 0.02098725363612175, -0.01782909967005253, 0.00754937157034874, -0.010606867261230946, 0.010550246573984623, 0.003453837474808097, -0.006256541702896357, -0.027706194669008255, 0.03563303500413895, -0.01343788206577301, 0.02463611587882042, 0.04897025600075722, 0.004233939107507467, -0.022560039535164833, -0.011298893019557, 0.00595456687733531, 0.011984627693891525, 0.008688068948686123, 0.013664362952113152, -0.018118491396307945, -0.016356971114873886, 0.003368907142430544, 0.021515710279345512, -0.0142808947712183, -0.00822252407670021, -0.03618665412068367, 0.002999302465468645, 0.005721794441342354, 0.00951220840215683, 0.02680026926100254, -0.031027916818857193, 0.04924706742167473, 0.015803351998329163, 0.005577098578214645, 0.021540874615311623, -0.012714399956166744, 0.037319060415029526, 0.01994292438030243, -0.029316727072000504, 0.016671529039740562, -0.007561954203993082, 0.023906344547867775, 0.02096208930015564, 0.0030512043740600348, 0.012758438475430012, 0.009820474311709404, -0.00320376455783844, 0.008524498902261257, 0.013676945120096207, -0.03628731518983841, 0.00992113258689642, 0.005621136166155338, -0.0245857872068882, 0.01818140409886837, 0.005039205774664879, 0.0015751449391245842, -0.013563704676926136, -0.0046680280938744545, -0.013790185563266277, 0.013614033348858356, 0.02394409105181694, -0.013475628569722176, 0.01323656551539898, 0.003972856793552637, -0.013450464233756065, 0.014746439643204212, -0.0306756142526865, 0.013010083697736263, 0.03039880283176899, -0.006574244704097509, 0.01647021248936653, -0.028259815648198128, 0.01736355572938919, 0.02483743242919445, -0.022270645946264267, -0.01999325305223465, -0.01591659151017666, -0.006737814284861088, 0.004781268537044525, 0.019162822514772415, -0.026347307488322258, 0.007650029845535755, 0.031556375324726105, 0.045195572078228, -0.013035248033702374, -0.0284359659999609, -0.018911175429821014, 0.004425819031894207, -0.005268832203000784, 0.0023088494781404734, 0.0025085932575166225, -0.003227356355637312, -0.01619340293109417, -0.03027298115193844, -0.035507213324308395, -0.019615784287452698, 0.006951713003218174, -0.013123324140906334, 0.0066623203456401825, -0.018646948039531708, -0.0007513983873650432, 0.022987836971879005, 0.0006051293457858264, 0.005146155133843422, 0.013752439059317112, 0.03472711145877838, 0.01723773218691349, -0.0010639895917847753, 0.02297525480389595, 0.004196192603558302, -0.007304016966372728, 0.005605408456176519, 0.025479130446910858, 0.006561662070453167, 0.023163989186286926, 0.017753606662154198, -0.014733857475221157, 0.05123506858944893, -0.016633782535791397, -0.003944546915590763, 0.0067755612544715405, 0.0020823683589696884, 0.011651197448372841, -0.019313808530569077, -0.0044195279479026794, 0.021566038951277733, -0.0051996298134326935, -0.005463857669383287, -0.006269123870879412, 0.0063666366040706635, -0.02167927846312523, 0.0183827206492424, 0.03462645038962364, 0.011877678334712982, 0.012909425422549248, -0.009700942784547806, 0.018319807946681976, -0.027756523340940475, -0.018596619367599487, 0.004564224276691675, -0.004752958659082651, 0.01823173277080059, -0.015664946287870407, -0.007171903271228075, 0.005844471976161003, -0.021465379744768143, 0.02476193942129612, 0.008612575009465218, 0.025252647697925568, 0.013500792905688286, -0.05309724807739258, -0.006269123870879412, 0.008769853040575981, 0.007964586839079857, 0.013639198616147041, 0.013362388126552105, -0.015853680670261383, -0.011185652576386929, 0.011984627693891525, -0.04393734410405159, 0.03273911029100418, 0.023679861798882484, -0.005904237739741802, -0.033393386751413345, 0.06140155717730522, 0.019779354333877563, 0.04011232778429985, -0.028108827769756317, 0.01889859326183796, 0.012475336901843548, -0.014117324724793434, -0.012034956365823746, -0.0439625084400177, 0.052644286304712296, -0.052291981875896454, -0.0014052840415388346, -0.02019456960260868, -0.008895676583051682, 0.035331059247255325, 0.01693575643002987, -0.008795018307864666, -0.012456463649868965, 0.01521198358386755, -0.029870348051190376, 0.03439997136592865, -0.014595451764762402, -0.00595456687733531, -0.007316599600017071, -0.012620032764971256, -0.001019951538182795, 0.008147030137479305, 0.005473294295370579, -0.013186235912144184, 0.008178485557436943, -0.014406717382371426, 0.01319881808012724, -0.004378635436296463, 0.015639781951904297, -0.027379054576158524, 0.03638797253370285, 0.007882802747189999, -0.027253231033682823, -0.020622367039322853, 0.008291726931929588, 0.016658946871757507, -0.02503874897956848, -0.016004668548703194, -0.010437006130814552, -0.006070952862501144, -0.01244388148188591, -0.00010262427531415597, 0.013651780784130096, -0.036941591650247574, -0.01346304640173912, 0.014960338361561298, 0.021100493147969246, -0.016621200367808342, -0.018584037199616432, 0.03052462637424469, -0.01976677216589451, -0.0010348930954933167, 0.029165739193558693, 0.025466546416282654, 0.0379985049366951, 0.021276645362377167, -0.00871952436864376, 0.03495359048247337, -0.022295810282230377, 0.024850014597177505, 0.013916008174419403, 0.003463274333626032, -0.016658946871757507, 0.023830849677324295, 0.035205237567424774, 0.027630699798464775, -0.010141322389245033, -0.009443005546927452, -0.05133572593331337, 0.027228066697716713, 0.008033789694309235, -0.007977169007062912, -0.010015499778091908, 0.04232681170105934, 0.03482776880264282, 0.0016404155176132917, -2.5631492462707683e-05, 0.027202902361750603, 0.01835755631327629, -0.023856014013290405, 0.015438465401530266, 0.009990335442125797, 0.012664071284234524, 0.022383887320756912, -0.014041831716895103, 0.030147157609462738, -0.004067223984748125, 0.01326172985136509, 0.025995003059506416, -0.016533123329281807, -0.024397052824497223, 0.007782144006341696, -0.007744397036731243, 0.011034664697945118, -0.017967505380511284, -0.00638236477971077, -0.0018338682129979134, 0.03080143593251705, 0.0023340140469372272, 0.015727857127785683, 0.042553290724754333, 0.04182351753115654, -0.02697642147541046, -0.007203358691185713, -0.001956545514985919, -0.005300288088619709, -0.0027382199186831713, -0.023478545248508453, -0.03641313686966896, -0.020207151770591736, -0.04026331752538681, -0.0046869018115103245, 0.025705611333251, 0.008795018307864666, -0.009833056479692459, -0.0038564708083868027, -0.009814183227717876, -0.019427049905061722, 0.0056840479373931885, -0.008650321513414383, 0.004428964573889971, 0.046806104481220245, 0.009524790570139885, 0.015979504212737083, -0.0255797877907753, -0.00384074286557734, -0.0031612995080649853, -0.0019140802323818207, 0.03767136484384537, 0.014041831716895103, -0.00638236477971077, -0.003035476431250572, 0.009323474019765854, -0.0284359659999609, 0.0006464149337261915, 0.005668319761753082, -0.01657087169587612, 0.03258812054991722, 0.0001502993400208652]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
" can
be directly incorporated into Eq. (2). While we acknowl-
edge other actor-critic algorithms can also be feasible (Mnih
et al., 2016; Haarnoja et al., 2018), we follow the main-
stream work (Ziegler et al., 2019; Stiennon et al., 2020) and
focus on PPO (Schulman et al., 2017) for our analysis in
this paper.
DPO. Instead of learning a reward model, Direct Preference
Optimization (DPO) (Rafailov et al., 2023) optimizes the
policy πθover preference data. DPO derived the closed-
form solution of Eq. (2), which reveals the relationship
between the reward r(x,y)and the optimal language model
π∗(y|x):
π∗(y|x) =1
Z(x)πref(y|x) exp1
βr(x,y)
,(5)
where Z(x)is a partition function that only depends on
prompt x. According to Eq. (5), if πθmaximizes Jrϕ(πθ),
the underlying reward can be derived with
rϕ(x,y) =βlogπθ(y|x)
πref(y|x)+C(x). (6)
where C:X →Ris a scalar function. This enables us to
reparameterize Eq. (4) with the policy πθ, and then we can
drive the DPO loss that directly optimizes πθ, i.e.,
LDPO(πθ) =−E(x,yw,yl)∼D (7)

logσ
β
logπθ(yw|x)
πref(yw|x)−logπθ(yl|x)
πref(yl|x)
.Action y1y2 y3
πref 0.5 0 .5 0
Dpref {(yw=y1,yl=y2)}
πDPO 0.1 0 .0 0 .9
πPPO 1 0 0
Table 1. A state-less counter-example with three actions when
DPO can minimize the loss but produce an unexpected policy.
PPO will not produce πDPO because πrefenforces the probability
of outputting y3is zero.
We remark that although Rafailov et al. (2023) performs a
single-round DPO over the preference dataset, some recent
works also adapt DPO to an iterative variant with a learned
reward model (Xiong et al., 2023; Yuan et al., 2024). We
also investigate the performance of iterative DPO.
4. Understanding the Limitation of DPO
In this section, we demonstrate that DPO may not be su-
perior to PPO. Firstly, we theoretically demonstrate issues
with the DPO training objective. Secondly, we illustrate that
DPO is more susceptible to out-of-distribution (OOD) data
through a synthetic example. Lastly, through experiments on
a real preference dataset, we validate that the performance
of DPO can be improved by mitigating the distribution shift
between the model outputs and the preference dataset.
4.1. Theoretical Analysis
It is well-known that PPO could exploit potential failures
in the learned reward model to achieve high rewards with-
out meeting the actual human preference, often manifested
as erroneous (Lewis et al., 2017) or overly complex out-
puts (Singhal et al., 2023). We argue that, though DPO
avoids reward modeling, DPO has a similar generalization
issue. In the following theorem, we will show that any
solution found by PPO also minimizes the DPO objective
Eq. (7), and thus, any solution found by PPO that exploits
the reward model can also be found by DPO. Furthermore,
DPO might discover solutions exploiting out-of-distribution
data, posing a risk of deviating excessively from the refer-
ence policy even when the reference policy aligns well with
human preferences.
Theorem 4.1. Given a ground-truth reward rand a prefer-
ence dataset D, letΠPPO be the class of policies induced
by training reward model rϕoverDand running PPO to
optimize Jrϕ(θ). LetΠDPO be the class of policies induced
by minimizing DPO objective Eq. (7). We have the following
conclusion: ΠPPO is a proper subset of ΠDPO.
Proof. We first prove that ΠPPO is a subset of ΠDPO, i.e.
3
Is DPO Superior to PPO for L","[0.009490366093814373, 0.005734684877097607, 0.005165642127394676, 0.004400596022605896, 0.012430419214069843, 0.022559378296136856, 0.0015000595012679696, 0.03507831320166588, -0.02009352669119835, 0.0010345510672777891, 0.040616996586322784, -0.005380613729357719, -0.041122812777757645, -0.019625646993517876, 0.017855292186141014, -0.03899838775396347, 0.03942833095788956, -0.04400596022605896, 0.03310563415288925, 0.03879605978727341, 0.011987830512225628, -0.022673185914754868, 0.01004044059664011, 0.012835072353482246, 0.0394030399620533, -0.00869370624423027, 0.0185254979878664, 0.01060948334634304, 0.02023262530565262, -0.040718160569667816, 0.04028821736574173, -0.024886129423975945, -0.047268472611904144, -0.037152159959077835, 0.04362659901380539, 0.0015569637762382627, 0.018259944394230843, 0.04390479624271393, 0.0018035488901659846, 0.02224324271082878, 0.004119236022233963, -0.0542234368622303, -0.034091975539922714, 0.012158543802797794, -0.011342915706336498, 0.043677181005477905, 0.05050569400191307, -0.023710107430815697, 0.011595823802053928, -0.014124901965260506, -0.0627211406826973, 0.05255424603819847, 0.004862152971327305, -0.028578583151102066, -0.016426363959908485, -0.0045460183173418045, 0.021686846390366554, -0.0033984489273279905, 0.04079403355717659, -0.028426839038729668, -0.011292334645986557, -0.014706590212881565, 0.005023381672799587, 0.04825481399893761, 0.012999461963772774, 0.0070877415128052235, -0.07293861359357834, 0.01713450439274311, 0.003199283964931965, -0.006186757702380419, 0.009427139535546303, 0.002685565035790205, 0.03186638653278351, -0.00939552579075098, 0.001716611790470779, -0.02749107964336872, 0.051239125430583954, 0.054425764828920364, 0.01599641889333725, -0.003828392131254077, 0.013151207007467747, 0.01740005798637867, 0.03171464055776596, -0.03338383138179779, -0.011279689148068428, -0.037556812167167664, -0.025354009121656418, -0.026150668039917946, -0.020953413099050522, -0.0422356054186821, -0.018373753875494003, -0.03176522254943848, 0.0013996866764500737, -0.00844079814851284, 0.037303902208805084, -0.004508081823587418, 0.0060571422800421715, -0.01254422776401043, 0.01574351266026497, 0.015136533416807652, -0.039327166974544525, -0.06671708077192307, -0.010596837848424911, -0.0007116984343156219, 0.031537607312202454, 0.0006777139496989548, -0.020498178899288177, 0.03737977519631386, 0.027592243626713753, -0.008858096785843372, -0.046484459191560745, -0.00312025030143559, -0.06079903990030289, 0.027541661635041237, -0.0092627489939332, -0.04997458681464195, -0.06722290068864822, 0.00138229934964329, 0.014731880277395248, -0.016476944088935852, -0.0381385013461113, -0.009680046699941158, 0.023128420114517212, 0.015199759975075722, 0.035381805151700974, -0.034724242985248566, 0.031512316316366196, -0.06909441947937012, 0.016325199976563454, -0.00447330716997385, 0.014542199671268463, 0.0439806692302227, -0.02059934288263321, -0.0655537098646164, -0.03667163476347923, 0.03315621614456177, 0.0021607812959700823, 0.005077124573290348, 0.004552340600639582, -0.02556898072361946, -0.03480011597275734, -0.05397053062915802, -0.04069286957383156, 0.02456999570131302, -0.08214446157217026, -0.028047477826476097, 0.013012107461690903, -0.02468380331993103, -0.019499193876981735, 0.07794619351625443, 0.0018715178593993187, -0.017362121492624283, 0.009743274189531803, 0.02890736423432827, -0.03424371778964996, -0.011772858910262585, 0.0049569932743906975, 0.04436003044247627, 0.0032071874011307955, -0.018892213702201843, -0.01676778867840767, 0.058775778859853745, -0.023128420114517212, -0.019157767295837402, 0.026707066223025322, 0.029741959646344185, -0.03186638653278351, 0.016401072964072227, -0.0627211406826973, -0.020169399678707123, -0.016679270192980766, 0.008668415248394012, -0.055083323270082474, -0.0036450340412557125, -0.016476944088935852, 0.005061317700892687, -0.04514404758810997, 0.018968086689710617, -0.0010961972875520587, -0.03227103874087334, 0.03338383138179779, 0.029741959646344185, 0.009325975552201271, 0.010192185640335083, 0.02632770501077175, -0.010647418908774853, 0.0009080971358343959, -0.028426839038729668, -0.01600906439125538, 0.014845688827335835, 0.024380313232541084, 0.019385384395718575, 0.04898824542760849, -0.010710646398365498, -0.01336617860943079, -0.03555883839726448, 0.06226590648293495, 0.06646417826414108, -0.036772798746824265, 0.007037159986793995, 0.011108975857496262, -0.002404205035418272, 0.004836861975491047, -0.05756182223558426, -0.019258931279182434, 0.01894279569387436, 0.011159557849168777, -0.008662092499434948, -0.03674750775098801, -0.03720274195075035, -0.011589501053094864, -0.0061266920529305935, 0.05695484206080437, -0.005317387171089649, 0.010887681506574154, -0.037531521171331406, -0.04797661304473877, 0.048659466207027435, 0.03381377458572388, 0.0696508139371872, -0.011608469299972057, -0.008870742283761501, 0.022597314789891243, 0.011526273563504219, 0.00228881579823792, -0.011311301961541176, 0.015338859520852566, -0.007675752509385347, -0.011323947459459305, -0.03439546376466751, 0.006739993579685688, 0.016666624695062637, 0.011045749299228191, -0.006683089304715395, 0.025923050940036774, -0.028730329126119614, -0.0021181029733270407, 0.00655663525685668, 0.014023738913238049, -0.043398983776569366, -0.0235583633184433, 0.026504740118980408, 0.018095554783940315, -0.04064228758215904, 0.0008179987198673189, 0.026378285139799118, -0.024102116003632545, -0.004359498620033264, -0.025998923927545547, -0.04160333797335625, 0.03965594619512558, 0.0035533548798412085, -0.01081813219934702, -0.03598878160119057, -0.03823966160416603, 0.0033763195388019085, 0.04056641459465027, 0.010287025943398476, -0.028730329126119614, 0.011039426550269127, -0.005497583653777838, 0.01932215690612793, 0.03558412939310074, 0.014997433871030807, 0.008807514794170856, -0.009673723950982094, -0.0178932286798954, -0.006822188384830952, -0.0096547557041049, 0.022862866520881653, 0.0185254979878664, -0.0003524902858771384, -0.033459704369306564, 0.04160333797335625, -0.011576855555176735, -0.055184487253427505, 0.021459229290485382, 0.05209901183843613, -0.045194629579782486, -0.007106709759682417, -0.009496688842773438, -0.002024843357503414, 0.04653504118323326, 0.013581150211393833, 0.03270098194479942, -0.024266505613923073, -0.039074257016181946, 0.034724242985248566, -0.021307483315467834, 0.012436741963028908, -0.01368231326341629, -0.0529588982462883, 0.007094064261764288, -0.012986816465854645, 0.023760689422488213, 0.0055197132751345634, 0.0170206967741251, -0.06742522865533829, 0.04767312481999397, 0.028072768822312355, 0.028098059818148613, -0.029489051550626755, -0.003916909918189049, -0.005036027170717716, 0.017324184998869896, -0.03004544973373413, 0.03834082558751106, 0.0032071874011307955, 0.0038916191551834345, -0.028376257047057152, -0.011855053715407848, 0.0115831783041358, 0.006948642432689667, 0.014466327615082264, -0.021168384701013565, 0.00882648304104805, 0.07071302831172943, -0.05973682925105095, -0.010615806095302105, -0.04041466861963272, -0.03700041398406029, -0.03773384541273117, -0.012316610664129257, -0.004052847623825073, 0.013973156921565533, -0.013555859215557575, -0.014744525775313377, 0.025809243321418762, -0.010679032653570175, -0.03426900878548622, 0.008320667780935764, -0.0031170889269560575, 0.00029775945586152375, 0.032675690948963165, -0.016982760280370712, -0.027971604838967323, -0.015832029283046722, 0.05867461487650871, 0.05235191807150841, 0.019031314179301262, -0.08780959248542786, 0.02903381735086441, -0.014301937073469162, -0.021193675696849823, -0.038543153554201126, 0.0012194899609312415, 0.0005133238737471402, 0.031385861337184906, 0.014744525775313377, 0.03249865397810936, -0.009433461353182793, -0.009755919687449932, 0.022711122408509254, 0.0389225147664547, 0.015427377074956894, 0.04704085364937782, -0.006986578460782766, -0.047142017632722855, -0.05245308205485344, 0.01100149005651474, -0.013846702873706818, -0.006237339228391647, -0.027921022847294807, 0.027819860726594925, -0.007878079079091549, 0.006303727626800537, -0.02812334895133972, -0.007328004110604525, 0.014289291575551033, -0.0045491792261600494, 0.0036892928183078766, 0.025404591113328934, -0.0422356054186821, 0.04365189000964165, -0.03836611658334732, 0.03492657095193863, 0.011210138909518719, 0.014112256467342377, 0.00036493808147497475, 0.016084937378764153, -0.027819860726594925, 0.022357052192091942, -0.031259406358003616, -0.004087622743099928, -0.0005303160869516432, 0.01241145096719265, -0.0026460480876266956, -0.03136057034134865, -0.03227103874087334, -0.020295852795243263, 0.034471336752176285, -0.01752651296555996, -0.006262629758566618, 0.011741246096789837, -0.061203692108392715, -0.004593438468873501, -0.04564986377954483, 0.059939153492450714, 0.03942833095788956, 0.06135543808341026, -0.04309549182653427, -0.008504025638103485, -0.0583205446600914, -0.009136294946074486, -0.06256939470767975, -0.00843447633087635, 0.018348462879657745, 0.01246835570782423, -0.0083143450319767, 0.04795132204890251, 0.047647833824157715, -0.01715979538857937, 0.01080548670142889, -0.025644853711128235, 0.03990885615348816, -0.03285272791981697, 0.01234822440892458, -0.010603160597383976, 0.020624632015824318, 0.0463327132165432, 0.024342378601431847, -0.017817355692386627, 0.006923351436853409, -0.023735398426651955, 0.006499730981886387, 0.05847228690981865, 0.005092931445688009, -0.0037114222068339586, 0.0007547717541456223, -0.052756570279598236, -0.019145121797919273, 0.04645916819572449, 0.05204842984676361, -0.03515418618917465, -0.051744941622018814, -0.009585206396877766, -0.015376796014606953, -0.019145121797919273, -0.0009997761808335781, -0.020624632015824318, 0.01573086716234684, -0.03889722377061844, -0.01996707171201706, -0.004233044572174549, -0.013404114171862602, -0.0032166712917387486, -0.02124425768852234, -0.012360869906842709, 0.016059646382927895, 0.001067745266482234, -0.018133491277694702, 0.04587747901678085, 0.04258967563509941, -0.012088993564248085, -0.013062689453363419, -0.06944848597049713, 0.06287288665771484, 0.021775363013148308, -0.008295376785099506, 0.006708379834890366, 0.028224512934684753, -0.035862330347299576, -0.0050960928201675415, -0.03300447016954422, 0.01521240547299385, 0.013770830817520618, 0.01791851967573166, -0.012487323954701424, -0.05503274127840996, 0.016527526080608368, -0.0039991047233343124, -0.03864431381225586, -0.008282731287181377, -0.022066207602620125, -0.04231147840619087, 0.004470145795494318, 0.019145121797919273, 0.00990766379982233, -0.022470859810709953, 0.001201312174089253, 0.012645390816032887, -0.03950420022010803, 0.007663107011467218, -0.011020458303391933, 0.05022749304771423, 0.023229584097862244, 0.04387950897216797, 0.009307008236646652, -0.043297819793224335, 0.01996707171201706, 0.0011823440436273813, -0.04243793338537216, 0.0753665342926979, -0.012765522114932537, 0.0010511481668800116, 0.0008504025754518807, 0.015642348676919937, 0.0128477169200778, -0.0006263420218601823, -0.009521979838609695, 0.06074845790863037, -0.04221031442284584, -0.0297925416380167, 0.03082946315407753, -0.009420816786587238, 0.01651488058269024, 0.025404591113328934, -0.0304248109459877, -0.02033378928899765, 0.011178526096045971, -0.012866685166954994, -0.001661288202740252, -0.013353533111512661, 0.01336617860943079, -0.008864419534802437, 0.0004449597036000341, -0.041628628969192505, -0.018639305606484413, -0.023444555699825287, 0.04307020083069801, -0.004131881520152092, -0.01648958958685398, -0.008624156937003136, 0.02185123600065708, 0.009825468994677067, -0.027086427435278893, -0.039580073207616806, -0.05235191807150841, -0.008952937088906765, -0.01092561800032854, 0.041274555027484894, -0.0029100205283612013, 0.018828988075256348, -0.0011531015625223517, -0.0061014010570943356, -0.029868414625525475, -0.012771844863891602, 0.0031597670167684555, -0.026251832023262978, -0.008567252196371555, 0.04946877062320709, -0.02303990349173546, -0.008010854944586754, 0.003964330069720745, 0.00800453219562769, -0.028426839038729668, 0.02071315050125122, 0.006879092659801245, -0.006234177853912115, 0.010166894644498825, 8.687531590112485e-06, -0.016160810366272926, -0.03864431381225586, -0.02057405188679695, -0.04051583260297775, 0.0026128538884222507, -0.02236969769001007, 0.01035657525062561, 0.03444604575634003, -0.012443064711987972, -0.009439784102141857, 0.0032277361024171114, -0.01740005798637867, 0.0297925416380167, 0.0035438707564026117, 0.044435903429985046, 0.02211678959429264, -0.021054577082395554, 0.007701043039560318, 0.044461194425821304, -0.032422780990600586, 0.020637277513742447, 0.039099548012018204, -0.04183095321059227, 0.03067771904170513, 0.02455735020339489, 0.0422356054186821, -0.028426839038729668, 0.02225588820874691, 0.01035657525062561, -0.01932215690612793, -0.0035786456428468227, -0.0005967043689452112, -0.02941318042576313, -0.03555883839726448, 0.0027788246516138315, 0.018614016473293304, 0.01119749341160059, -0.0401870533823967, 0.05690426006913185, 0.021535100415349007, -0.04514404758810997, -0.014807753264904022, -0.022192660719156265, -0.0350024439394474, -0.006104562431573868, 0.018778406083583832, 0.025505753234028816, 0.015389440581202507, -0.0028135995380580425, 0.0406675785779953, 0.013770830817520618, -0.00372722907923162, -0.024633221328258514, -0.022293824702501297, 0.036241691559553146, -0.003068088088184595, 0.007903369143605232, 0.023356037214398384, -0.0013443630887195468, -0.008112017996609211, -0.020687859505414963, -0.0001725898328004405, -0.011292334645986557, -0.06135543808341026, -0.036266982555389404, -0.011184848845005035, -0.005722039379179478, 0.03646930679678917, -0.0041382042691111565, 0.016717206686735153, -0.01996707171201706, 0.03173993155360222, -0.0032625109888613224, -0.011248075403273106, 4.386369982967153e-05, -0.024886129423975945, -0.0029590215999633074, -0.0012621680507436395, -0.020397016778588295, -0.03649459779262543, -0.027566952630877495, -0.016729852184653282, 0.024886129423975945, 0.05154261365532875, 3.3589320082683116e-05, -0.009825468994677067, -0.03517947718501091, -0.001931583508849144, -0.028806200250983238, -0.011747567914426327, 0.022711122408509254, -0.010710646398365498, -0.025644853711128235, 0.0009341782424598932, -0.011292334645986557, 0.01201944425702095, 0.008383894339203835, -0.006752639077603817, -0.04001001641154289, -0.011817118152976036, 0.011102653108537197, 0.030020158737897873, 0.0004718311538454145, 0.009838114492595196, 0.01815878227353096, 0.02071315050125122, 0.006427019834518433, -0.021307483315467834, 0.0034395463299006224, -0.040718160569667816, -0.014744525775313377, -0.0028926332015544176, -0.005386936478316784, 0.029008526355028152, 0.036924540996551514, 0.02430444210767746, 0.0819421336054802, 0.0030949595384299755, -0.007827497087419033, -0.04656032845377922, -0.017083924263715744, 0.030475392937660217, -0.021408647298812866, -0.0071699367836117744, -0.015452668070793152, 0.012904621660709381, -0.03829024359583855, -0.029084399342536926, -0.011943572200834751, -0.009585206396877766, -0.0240388885140419, -0.028376257047057152, -0.008320667780935764, -0.03093062713742256, -0.030652428045868874, 0.0010748582426458597, -0.01650223508477211, -0.010154249146580696, -0.024999938905239105, -0.018651951104402542, 0.008320667780935764, 0.01676778867840767, -0.0586240328848362, -0.008149954490363598, 0.008624156937003136, 0.02941318042576313, 0.041122812777757645, -0.013720249757170677, -0.05118854343891144, -0.011102653108537197, 0.0168689526617527, -0.02607479691505432, 0.0072141955606639385, -0.0422356054186821, -0.021927108988165855, -0.02266054041683674, 0.04195740818977356, 0.020814314484596252, -0.04006059840321541, -0.0033731581643223763, 0.017172440886497498, -0.032043419778347015, 0.019284222275018692, 0.018828988075256348, 0.012424096465110779, 0.031259406358003616, 0.02315371111035347, 0.014807753264904022, -0.0244308952242136, -0.02352042682468891, -0.0030933788511902094, -0.03095591813325882, 0.018462270498275757, -0.012607455253601074, -0.005361645948141813, -0.031916968524456024, -0.002438979921862483, -0.03606465458869934, 0.026959974318742752, 0.00907939113676548, -0.013328242115676403, -0.028098059818148613, -0.022951385006308556, -0.008788546547293663, 0.02814863994717598, 0.0002780010108835995, 0.0460292249917984, -0.005560810677707195, -0.00011736503802239895, 0.010912972502410412, -0.00045760508510284126, -0.028603874146938324, -0.028350966051220894, 0.015174468979239464, -0.004666149150580168, 0.01188666746020317, 0.03952949121594429, 0.007884401828050613, 0.019284222275018692, -0.017488576471805573, 0.010046763345599174, 0.0036987769417464733, -0.0009602594072930515, 0.042159732431173325, 0.0030364745762199163, -0.0007425215444527566, 0.013252370059490204, -0.007435489911586046, -0.04871004819869995, -0.008156277239322662, -0.008927646093070507, -0.02441824972629547, 0.01393522135913372, -0.0021038770209997892, -0.017033342272043228, -0.04142630100250244, -0.019992362707853317, 0.04172978922724724, -0.007252131588757038, 0.01336617860943079, 0.035230059176683426, -0.016072291880846024, 0.0348254069685936, 0.05589262768626213, 0.009553592652082443, 0.01401109341531992, -0.03654517978429794, -0.012107961811125278, -0.009363912045955658, -0.03758210316300392, -0.026555322110652924, 0.02583453431725502, -0.021282194182276726, -0.009800177998840809, -0.0016818370204418898, 0.015326214022934437, -0.02850271202623844, 0.016072291880846024, -0.04299433156847954, 0.0035723228938877583, 9.424768359167501e-05, -0.017324184998869896, -0.0071572912856936455, 0.006189919076859951, 0.018626661971211433, -0.04979754984378815, -0.0879613384604454, -0.03146173432469368, 0.018955441191792488, -0.002592305187135935, 0.005235191900283098, -0.002875245874747634, 0.051239125430583954, -0.009344943799078465, -0.016919532790780067, -0.025619562715291977, 0.009932954795658588, -0.04261496663093567, 0.01374553982168436, -0.04038937762379646, 0.02239498682320118, -0.0370509959757328, -0.02124425768852234, -0.010002504102885723, 0.015187114477157593, -0.011475692503154278, -0.028730329126119614, -0.0340413935482502, -0.007517685182392597, 0.005412227474153042, -0.05397053062915802, 0.009363912045955658, 0.02850271202623844, -0.004425887018442154, -0.036393433809280396, -0.023229584097862244, -0.0028799879364669323, -0.03517947718501091, 0.006151982583105564, -0.0013040559133514762, -0.027010556310415268, -0.03045010194182396, 0.00444485479965806, -0.009237457998096943, -7.364952762145549e-05, 0.028932655230164528, 0.039731819182634354, -0.03937774896621704, 0.04006059840321541, -0.017627675086259842, -0.0039137485437095165, -0.05427401885390282, 0.014554845169186592, -0.023431910201907158, -0.016679270192980766, -0.02085224911570549, 0.016464298591017723, -0.026251832023262978, 0.0036987769417464733, -0.02493671141564846, 0.025290781632065773, 0.007176259532570839, 0.008219503797590733, 0.007378585636615753, -0.005440679378807545, -0.03846728056669235, -0.001246361411176622, 0.028603874146938324, 0.009705337695777416, 0.009521979838609695, -0.033080343157052994, -0.01043244730681181, 0.008978228084743023, 0.02148452028632164, -0.027440499514341354, -0.03649459779262543, -0.010837100446224213, 0.011804472655057907, -0.0039011030457913876, 0.048027195036411285, -0.013062689453363419, -0.025771306827664375, 0.029185563325881958, 0.0064523108303546906, -0.05432460084557533, 0.030627137050032616, 0.037152159959077835, -0.016299908980727196, 0.03864431381225586, 0.04883649945259094, 0.020409660413861275, 0.016224035993218422, 0.01426400151103735, -0.008478734642267227, -0.02534136362373829, -0.0035723228938877583, 0.00812466349452734, -0.022180015221238136, 0.006047658156603575, -0.011102653108537197, -0.038947805762290955, -0.04264025762677193, -0.02799689583480358, 0.012518936768174171, 0.013378824107348919, 0.007258454337716103, 0.016970114782452583, 0.033965520560741425, -0.06246823072433472, 0.009420816786587238, 0.013985802419483662, -0.010362897999584675, 0.0002009431627811864, 0.008801192045211792, 0.018108200281858444, 0.008775901049375534, -0.002271428471431136, -0.003673486178740859, -0.010875036008656025, 0.013138561509549618, -0.01805761829018593, 0.011298657394945621, 0.04567515105009079, 0.030525974929332733, -0.0021149415988475084, 0.02173742651939392, 0.004356337245553732, 0.048153650015592575, -0.017362121492624283, 0.031537607312202454, 0.021901817992329597, -0.017690902575850487, -0.009680046699941158, 0.0526554100215435, -0.03710157796740532, -0.008813837543129921, 0.01981532759964466, 0.005573456175625324, 0.002102296333760023, 0.008927646093070507, 0.004413241520524025, 0.02110515721142292, 0.042260896414518356, 0.022786995396018028, -0.023596299812197685, 0.0186772421002388, 0.007391231134533882, 0.029514342546463013, 0.03439546376466751, 0.01586996577680111, 0.008175245486199856, 0.027035845443606377, 0.028705038130283356, -0.027440499514341354, -0.019903846085071564, 0.027946313843131065, 0.02594834193587303, -0.0032166712917387486, 0.01369495876133442, -0.02201562561094761, 0.004081299994140863, 0.01766561158001423, 0.022546732798218727, -0.01361908670514822, 0.005722039379179478, -0.0008385474793612957, 0.00819421373307705, 0.013075334019958973, -0.019031314179301262, -0.03270098194479942, 0.028629165142774582, -0.021648909896612167, -0.01724831387400627, -0.000392797461245209, -0.012221770361065865, -0.024215923622250557, -0.010698000900447369, -0.04504288360476494, 0.00386632839217782, 0.027187591418623924, 0.024784967303276062, 0.011855053715407848, 0.010204830206930637, 0.04592806100845337, -0.02814863994717598, 0.023963015526533127, 0.022837575525045395, 0.022711122408509254, -0.010628451593220234, -0.008851774036884308, 0.020510824397206306, -0.04486584663391113, 0.017298895865678787, -0.003958007320761681, 0.029463760554790497, 0.023495135828852654, 0.04198269918560982, 0.023229584097862244, -0.008213181979954243, 0.016540171578526497, 0.006992901209741831, -0.00800453219562769, 0.013163852505385876, 0.02749107964336872, 0.021914463490247726, -0.04489113762974739, -0.06408683955669403, 0.027592243626713753, -0.012044735252857208, -0.017703548073768616, -0.0526554100215435, 0.0557914674282074, 0.008617834188044071, -0.005159319378435612, -0.005431195721030235, 0.012790813110768795, 0.011500983498990536, 0.010811809450387955, -0.011127944104373455, 0.016160810366272926, -0.01081813219934702, -0.06267055869102478, -0.0003605912206694484, 0.03477482497692108, -0.018108200281858444, 0.014023738913238049, -0.0019300028216093779, -0.013404114171862602, 0.008883386850357056, 0.017374766990542412, -0.0278957337141037, -0.016464298591017723, 0.07126942276954651, -0.0089466143399477, 0.0118234409019351, 0.025126392021775246, -0.0299442857503891, 0.03045010194182396, -0.015402086079120636, 0.009066745638847351, 0.0042646583169698715, -0.022850221022963524, -0.014592781662940979, 0.007315358612686396, 0.0015300923259928823, -0.004460661672055721, 0.04362659901380539, 0.024228569120168686, -0.007416521664708853, -0.0003896361158695072, 0.01554118562489748, 0.011463047005236149, 0.022799640893936157, 0.050834473222494125, -0.011286011897027493, -0.014466327615082264, -0.0020706828217953444, 0.025783952325582504, 0.0016312554944306612, 0.00415717251598835, 0.013581150211393833, 0.012278675101697445, 0.012537905015051365, 0.02109251171350479, 0.0293120164424181, -0.007833819836378098, -0.02726346254348755, 0.03186638653278351, -0.007625170983374119, -0.02647944912314415, -0.00939552579075098, -0.015794092789292336, 0.00927539449185133, 0.05665135383605957, 0.03477482497692108, 0.008105695247650146, -0.009692692197859287, 0.030601846054196358, -0.010128958150744438, 0.02928672544658184, 0.028932655230164528, 0.016944823786616325, 0.020371725782752037, -0.0013625408755615354, 0.030778881162405014, -0.016084937378764153, -0.006493408232927322, 0.019600355997681618, -0.011633760295808315, 0.014162838459014893, 0.016578108072280884, -0.014997433871030807, 0.00844079814851284, -0.0016881597694009542, 0.0058579775504767895, 0.022824931889772415, 0.02723817341029644, 0.026833519339561462, -0.02517697401344776, 0.010464061051607132, 0.002367849461734295, -0.022837575525045395, -0.02023262530565262, 0.028426839038729668, 0.000920742517337203, -0.007309035863727331, 0.0027456304524093866, 0.004027557093650103, 0.019486548379063606, -0.005734684877097607, 0.03300447016954422, 0.01956241950392723, 0.0061835963279008865, 0.012695972807705402, -0.006287920754402876, -0.027010556310415268, 0.00015727705613244325, -0.04742021486163139, -0.007207872811704874, 0.021079866215586662, -0.025290781632065773, 0.007682075258344412, -0.028325676918029785, -0.011399820446968079, -0.022812286391854286, 0.021029286086559296, 0.019802682101726532, -0.006512376479804516, 0.025897761806845665, 0.008055114187300205, -0.03980769217014313, -0.02406417950987816, 0.03634285554289818, 0.003335221903398633, -0.004226721823215485, 0.01133027020841837, -0.0115831783041358, 0.006512376479804516, 0.00800453219562769, -0.04898824542760849, -0.024860838428139687, 0.003559677628800273, -0.042007990181446075, 0.013644376769661903, -0.022420277819037437, -0.05164377763867378, 0.048659466207027435, -0.012651713564991951, -0.010445092804729939, -0.015351505018770695, -0.014086965471506119, 0.017690902575850487, 0.018335817381739616, 0.006316372659057379, 0.005206739995628595, 0.0038189080078154802, 0.07076361030340195, -0.03616581857204437, -0.03495186194777489, 0.0230146124958992, -0.010438770055770874, 0.04549811780452728, -0.02840154804289341, -0.016805725172162056, -0.032574526965618134, 0.009572560898959637, 0.007403876632452011, 0.021155739203095436, -0.02150980941951275, -0.002838890301063657, 0.01879105158150196, -0.0038252307567745447, -0.017956456169486046, 0.026378285139799118, 0.018323171883821487, 0.007625170983374119, -0.0017577093094587326, 0.027693405747413635, 0.0068032206036150455, 0.016578108072280884, 0.027010556310415268, -0.013138561509549618, -0.027035845443606377, -0.018904859200119972, -0.007113032508641481, 0.008383894339203835, -0.0052952575497329235, -0.04261496663093567, -0.046105094254016876, 0.006063465029001236, -0.011292334645986557, 0.008295376785099506, -0.022534087300300598, 0.025493107736110687, -0.03426900878548622, -0.005510229151695967, 0.009578883647918701, 0.004966477397829294, -0.001506382250227034, 0.014441036619246006, 0.015440022572875023, 0.030880045145750046, 0.018993377685546875, 0.012841395102441311, 0.004223560448735952, 0.034471336752176285, 0.013631731271743774, -0.009597851894795895, 0.017324184998869896, -0.011975185014307499, -0.013378824107348919, -0.0038694897666573524, -0.023444555699825287, 0.02210414409637451, 0.015566476620733738, 0.02341926470398903, -0.0234066192060709, 0.03922600299119949, -0.020295852795243263, 0.014428391121327877, 0.009705337695777416, -0.012171189300715923, 0.0022429763339459896, -0.0022824930492788553, -0.009231135249137878, 0.048305392265319824, -0.030627137050032616, 0.009730628691613674, -0.005851654801517725, -0.029463760554790497, 0.003300447016954422, -0.006414374802261591, -0.035128895193338394, 0.008579897694289684, 0.000505025323946029, 0.023634236305952072, -0.004909573122859001, 0.011184848845005035, -0.01904395967721939, 0.0170206967741251, -0.0037019383162260056, 0.012183834798634052, 0.005029704421758652, 0.0032878017518669367, -0.039099548012018204, 0.041628628969192505, -0.009509334340691566, 0.01753915660083294, 0.025265490636229515, -0.010122635401785374, 7.532898962381296e-07, -0.021573036909103394, 0.00914261769503355, 0.0017213538521900773, -0.016476944088935852, 0.031385861337184906, -0.01489627081900835, -0.0019442288903519511, -0.010091021656990051, 0.009901341050863266, 0.004514404572546482, -0.006999223958700895, -0.015654994174838066, -0.009755919687449932, -0.012310287915170193, -0.012183834798634052, 0.0278957337141037, -0.00757458945736289, 0.03773384541273117, 0.022572023794054985, -0.013897284865379333, 0.02508845552802086, -0.019145121797919273, 0.016337845474481583, 0.02520226500928402, -0.015907902270555496, -0.013846702873706818, -0.009085713885724545, 0.00195213221013546, 0.009699014946818352, 0.01195621769875288, 0.03414255753159523, -0.025366654619574547, 0.0166286900639534, -0.014226065017282963, 0.023823916912078857, -0.022926094010472298, 0.031132953241467476, 0.014820398762822151, -0.01842433400452137, -0.006917029153555632, 0.017071278765797615, 0.0015087532810866833, -0.015338859520852566, 0.001134133548475802, -0.010204830206930637, 0.010976199060678482, 0.01674249768257141, -0.022066207602620125, 0.0348254069685936, -0.007549298461526632, -0.04420828819274902, 0.005326870828866959, -0.0586240328848362, 0.022306470200419426, 0.010641097091138363, -0.0032087680883705616, 0.024102116003632545, -0.0125315822660923, 0.022837575525045395, 0.011172203347086906, -0.03641872480511665, -0.007346972357481718, -0.022445568814873695, -0.011545241810381413, 0.004843184724450111, 0.01753915660083294, -0.002740888623520732, 0.01188666746020317, 0.041274555027484894, 0.02352042682468891, 0.0033320605289191008, -0.031891677528619766, -0.022875512018799782, -0.011159557849168777, 0.005661973729729652, 0.005137190222740173, 0.019385384395718575, 0.02163626439869404, 0.006035013124346733, -0.03300447016954422, -0.013846702873706818, -0.00919952243566513, -0.021838590502738953, -0.017298895865678787, 0.027440499514341354, 0.002695048926398158, 0.026530031114816666, 0.03963065519928932, 0.0019363255705684423, -0.00294163404032588, 0.03196755051612854, 0.026909392327070236, 0.009016163647174835, 0.01311327051371336, 0.010324961505830288, 0.0015087532810866833, -0.0049696387723088264, 0.030500683933496475, 0.011924603953957558, 0.003603936405852437, 0.038037337362766266, 0.02546781860291958, -0.0230146124958992, 0.029084399342536926, 0.002614434575662017, -0.010394511744379997, -0.022685831412672997, 0.012455710209906101, 0.0045491792261600494, -0.028806200250983238, -0.012809781357645988, 0.04552340880036354, 0.0008511929190717638, 0.02814863994717598, -0.0012542647309601307, 0.019764745607972145, -0.005535520147532225, 0.014516908675432205, 0.015654994174838066, 0.007441812660545111, 0.003844199003651738, 0.012101639062166214, 0.01303739845752716, -0.04817894101142883, -0.015250341966748238, -0.02483554743230343, -0.018576079979538918, 0.05599379166960716, -0.0020517148077487946, -0.017223022878170013, 0.014845688827335835, 0.007972919382154942, 0.03697512298822403, 0.010299671441316605, 0.010305994190275669, 0.010280703194439411, -0.002212943509221077, -0.02377333492040634, -0.017197731882333755, 0.002122845035046339, 0.007897046394646168, 0.012392483651638031, -0.016843661665916443, -0.005431195721030235, 0.009313330985605717, -0.03995943441987038, 0.03649459779262543, 0.006104562431573868, -0.010780195705592632, -0.0072015500627458096, 0.04261496663093567, -0.021573036909103394, 0.0020280044991523027, -0.027921022847294807, 0.0002290001284563914, 0.020055590197443962, -0.006341663654893637, -0.03889722377061844, -0.022458214312791824, 0.04415770620107651, -0.01048935204744339, -0.026454158127307892, -0.031132953241467476, -0.00939552579075098, 0.04774899780750275, -0.006262629758566618, -0.0176529660820961, -0.0011949894251301885, 0.014731880277395248, -0.019145121797919273, 0.028224512934684753, -0.022723767906427383, 0.0017197731649503112, -0.024367669597268105, -0.026934683322906494, -0.0006306888535618782, 0.016312554478645325, 0.024076825007796288, -0.030273066833615303, 0.0038252307567745447, 0.005206739995628595, 0.0542234368622303, 0.025505753234028816, 0.015642348676919937, -0.026277123019099236, 0.023608945310115814, -0.018601370975375175, -0.028553294017910957, -0.007328004110604525, 0.000965791754424572, 0.015705576166510582, -0.0299442857503891, -0.010046763345599174, -0.029489051550626755, -0.01368231326341629, -0.022597314789891243, 0.002492722822353244, 0.004634535871446133, -0.03980769217014313, 0.0018256783951073885, 0.020422305911779404, 0.009831791743636131, -0.016666624695062637, -0.03788559138774872, -0.0003030942170880735, -0.018588725477457047, -0.01062212884426117, 0.02429179660975933, 0.007909691892564297, 0.02622654102742672, 0.02096605859696865, -0.015692930668592453, 0.01086871325969696, -0.010445092804729939, 0.007783238310366869, 0.02814863994717598, -0.012803458608686924, -0.007302713580429554, 0.051618486642837524, 0.018196716904640198, 0.023621590808033943, -0.012790813110768795, -0.012341901659965515, -0.04570044204592705, -0.0029811509884893894, -0.00021101997117511928, 0.006581926252692938, -0.0010092603042721748, 0.02224324271082878, 0.04721789062023163, 0.013138561509549618, -0.008554606698453426, 0.02138335630297661, -0.010887681506574154, -0.019107185304164886, 0.038543153554201126, 0.009970891289412975, 0.041274555027484894, 0.032549235969781876, -0.0033415446523576975, 0.02531607262790203, -0.0072268410585820675, 0.013846702873706818, 0.020890185609459877, -0.0035090961027890444, -0.0027124364860355854, 0.013808767311275005, 0.028477421030402184, 0.02377333492040634, 0.003505934728309512, 0.010078377090394497, 0.04038937762379646, 0.029337307438254356, -0.015528540126979351, 0.026175959035754204, 0.02840154804289341, 0.021193675696849823, -0.030627137050032616, -0.011418787762522697, 0.019511839374899864, -0.0017861614469438791, -0.006929674185812473, -0.028452130034565926, -0.003445869078859687, -0.011684341356158257, -0.016540171578526497, -0.01664133556187153, -0.0066072167828679085, 0.013834058307111263, -0.006834833882749081, -0.006815865635871887, -0.007075096480548382, -0.027288753539323807, 0.0013767669443041086, -0.010002504102885723, 0.029969576746225357, 0.04092048481106758, 0.01676778867840767, 0.008737965486943722, -0.04501759260892868, 0.028932655230164528, 0.023103129118680954, -0.010021472349762917, 0.04104693979024887, -0.01584467478096485, 0.0005370339495129883, -0.023128420114517212, 0.004299432970583439, -0.018968086689710617, -0.007947628386318684, -0.0021971366368234158, 0.014314582571387291, 0.04805248603224754, -0.008940291590988636]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
"LM Alignment? A Comprehensive Study
ΠPPO⊆ΠDPO. Let Rbe the class of reward models that
minimizes reward learning loss Eq. (4). We note there is
an one-to-many mapping between ΠPPO andRaccording
to Eq. (6). Without loss of generality, we omit the scalar
factor C(x)and define fto be an one-to-one mapping from
a policy to a reward function f(π)(x,y) =βlogπ(y|x)
πref(y|x).
We will show that the minimum DPO loss is the same as
the minimum reward learning loss, i.e., minrLR(r) =
minπLDPO(π). We can show that minπLDPO(π) =
minπLR(f(π))≥minrLR(r). And for a minimizer r∗of
LR(r), we can construct a policy π∗fromr∗by Eq. (5) and
thenminπLDPO(π)≤ L DPO(π∗) = min rLR(r). There-
fore the reward learning loss achieved by reward models in
Rand DPO loss achieved by policies in ΠDPO are the same,
i.e.∀rϕ∈R, π DPO∈ΠDPO,minrLR(r) =LR(rϕ) =
LDPO(πDPO) = min πLDPO(π).
For any solution found by PPO, πPPO∈ΠPPO, the reward
r∗=f(πPPO)satisfies that πPPO is a maximizer of Jr∗(π)
andπPPO can be represented by r∗with
πPPO(y|x) =1
Z(x)πref(y|x) exp1
βr∗(x,y)
.(8)
Substituting πPPO with Eq. (8) in LDPO(πPPO), we get
LDPO(πPPO) =LR(rϕ). Therefore, πPPO also minimizes
the DPO loss, which implies πPPO∈ΠDPO.
Next, we show that ΠPPO is a proper subset of ΠDPO, i.e.
ΠPPO⊊ΠDPO with a counter-example as shown in Ta-
ble 1. In this counter-example, we will show that there
exists a solution found by DPO, πDPO∈ΠDPO, that does
not maximize the RL objective of PPO Eq. (2). Consider a
simple state-less case with three actions, but the preference
dataset only contains a single pair comparison between y1
andy2. Denote the probability of DPO policy πDPO out-
putting the first two actions as aandb. The DPO loss in this
scenario is given by LDPO= log(1 + (b
a)β), which can be
minimized as long as b= 0. A possible optimal policy pro-
duced by DPO is shown in the third row of Table 1, which
has a 0.1probability to output y1and a 0.9probability to
output y3. This policy cannot be produced by PPO because
πrefenforces πPPO to assign 0probability to y3according
to Eq. (8).
We remark that the root cause of reward misspecification is
the narrow distribution coverage of the preference dataset.
The learned reward model may assign a high value to out-
of-distribution (OOD) samples and has the potential to be
exploited during the RL process. Although DPO avoids
training the reward model, it still suffers from the mis-
specification issue on OOD samples but in a different
manner. Specifically, DPO can develop a biased distribution
Figure 1. Preference dataset coverage, policy probability distribu-
tions of πref,πPPO,πDPO, and the value of learned rewards in
the synthetic scenario. In the first figure, dark color represents
data present in preference data, while light means the data points
are not included. Although data points marked with red circles
and orange circles are not covered by the preference dataset, DPO
assigns higher probabilities of these data points compared with the
reference model. PPO assigns low probability to the marked data
points and learns the optimal policy.
favoring unseen responses, directly impacting quality of the
learned policy. By contrast, PPO can leverage prompt-only
data and generate responses beyond the preference dataset
distribution. During training, KL divergence between πθ
andπrefcan provide additional","[0.01231463998556137, 0.005424827802926302, 0.028523387387394905, 0.014224129728972912, 0.00945979729294777, 0.02407834678888321, 0.011356765404343605, 0.015501296147704124, -0.007594132795929909, 0.017529737204313278, 0.02449154667556286, -0.004157051909714937, -0.029950808733701706, 0.0030614433344453573, 0.035860832780599594, -0.037238169461488724, 0.05779804661870003, -0.02459171786904335, 0.014537160284817219, 0.04672927036881447, -0.015150701627135277, -0.029750468209385872, 0.005005366168916225, 0.01988373138010502, 0.030326444655656815, -0.020296931266784668, 0.02824791893362999, -0.005625167395919561, 0.01992129348218441, -0.027095966041088104, 0.04973436892032623, -0.018882030621170998, -0.02917449176311493, -0.02737143263220787, 0.03288077935576439, -0.014311778359115124, 0.017993023619055748, 0.04925855994224548, 0.0034558624029159546, 0.0301761906594038, -0.012070476077497005, -0.05243895575404167, -0.030401572585105896, 4.485147655941546e-05, 0.007274840958416462, 0.0378892756998539, 0.06806546449661255, -0.014975404366850853, 0.026519987732172012, 0.0034120380878448486, -0.06711385399103165, 0.06906716525554657, -0.003468383802101016, -0.031778909265995026, -0.00924067571759224, 0.004169573076069355, 0.0370628722012043, -0.010223593562841415, 0.03370717912912369, -0.024241121485829353, -0.004830068442970514, -0.023514891043305397, 0.010968606919050217, 0.04021822661161423, 0.017717555165290833, -0.005587603896856308, -0.08865038305521011, 0.013059654273092747, 0.00030911812791600823, 0.0150880953297019, 0.021536534652113914, -0.017016366124153137, 0.024779535830020905, -0.002577810548245907, -0.009159287437796593, -0.023302029818296432, 0.04302298277616501, 0.04507646709680557, -0.00905285682529211, 0.005118057131767273, 0.01992129348218441, 0.0115508446469903, 0.023953134194016457, -0.055794648826122284, -0.005897504277527332, -0.046604059636592865, -0.056345585733652115, -0.022575797513127327, -0.005071102641522884, -0.03931669518351555, -0.004573383368551731, -0.04682943969964981, -0.010167247615754604, 0.0024244252126663923, 0.023740272969007492, -0.02927466109395027, 0.005982022732496262, -0.006157319992780685, 0.0117887482047081, 0.011137643828988075, -0.037814147770404816, -0.07527770102024078, -0.00025433770497329533, -0.018794381991028786, 0.026595115661621094, -0.011644753627479076, -0.027997493743896484, 0.015113137662410736, -0.0018249708227813244, 0.007431356236338615, -0.03253018483519554, -0.004905195906758308, -0.07257311046123505, 0.028924066573381424, -0.009322063997387886, -0.06385833024978638, -0.06215544044971466, -0.0028720595873892307, 0.013134781271219254, -0.013247473165392876, -0.049859579652547836, -0.00762543547898531, 0.011375547386705875, -0.018168320879340172, 0.02965029887855053, 0.00018331878527533263, 0.03806457296013832, -0.06085323169827461, 0.005847419612109661, -0.01346033439040184, 0.0027468472253531218, 0.03946695104241371, -0.006761469878256321, -0.05839906632900238, -0.06541096419095993, 0.04637867584824562, 0.007099543698132038, -0.01248993817716837, -0.014236650429666042, -0.035510238260030746, -0.0273213479667902, -0.028423216193914413, -0.041971199214458466, 0.04394955560564995, -0.07918432354927063, -0.02277613803744316, -0.006198014132678509, -0.03335658460855484, -0.01805562898516655, 0.06541096419095993, 0.006460960488766432, -0.009447276592254639, -0.012414810247719288, 0.029850637540221214, -0.03340667113661766, -0.03616134449839592, -0.010586708784103394, 0.04036847874522209, -0.004704856313765049, -0.01299704797565937, -0.01323495153337717, 0.05459260940551758, -0.007963509298861027, -0.0019141846569254994, 0.01806814968585968, 0.02697075344622135, -0.03716304153203964, 0.018393702805042267, -0.07973526418209076, -0.017028886824846268, 0.0009210938005708158, 0.00531839719042182, -0.05639566853642464, -0.03157857060432434, -0.026144351810216904, -0.00953492522239685, -0.03618638589978218, 0.017705034464597702, 0.004579643718898296, -0.028097664937376976, 0.025843841955065727, 0.01891959458589554, 0.005831767804920673, 0.00021305674454197288, 0.02171183191239834, -0.006573651451617479, 0.006661300081759691, -0.02365262433886528, -0.018255969509482384, -0.0048394594341516495, 0.02739647589623928, 0.03260531276464462, 0.033106159418821335, -0.02270101010799408, -0.02689562551677227, -0.02275109477341175, 0.050761111080646515, 0.0831410363316536, -0.027696983888745308, 0.008044897578656673, 0.009779089130461216, 0.01066809706389904, 0.009779089130461216, -0.05086128041148186, -0.01505053136497736, 0.026194436475634575, -0.009985690005123615, -0.0019392272224649787, -0.02734638936817646, -0.0352848581969738, -0.005499955266714096, -0.013785886578261852, 0.052639298141002655, -0.0016261962009593844, 0.015138179995119572, -0.023427242413163185, -0.0342080295085907, 0.04399964213371277, 0.04076915979385376, 0.05754762142896652, 0.0020190500654280186, -0.0040349699556827545, 0.025205258280038834, 0.03107772022485733, -0.03375726565718651, -0.021160896867513657, 0.014199087396264076, -0.007619175128638744, 0.0050241476856172085, -0.02832304686307907, 0.030326444655656815, 0.04124496877193451, 0.003446471644565463, -0.0026623287703841925, 0.026670243591070175, -0.03841516748070717, -0.02039710059762001, -0.008883820846676826, 0.01548877451568842, -0.025292906910181046, -0.02551828883588314, 0.04692960903048515, 0.009822913445532322, -0.03939182311296463, 0.02124854549765587, 0.02459171786904335, -0.030877379700541496, 0.007938466966152191, 0.010123423300683498, -0.03275556489825249, 0.04457561671733856, 0.0153259988874197, -0.012345943599939346, -0.04963419958949089, -0.04873266816139221, 0.03701278939843178, 0.02692066878080368, -0.005618907045572996, -0.02035953849554062, -0.005406045820564032, -0.008902601897716522, 0.029124407097697258, 0.03413290157914162, 0.02649494633078575, -0.011744923889636993, -0.017341919243335724, -0.002867364091798663, -0.020973078906536102, -0.0075503080151975155, 0.011312941089272499, 0.022375456988811493, -0.006498523987829685, -0.04602808132767677, 0.054442353546619415, -0.0129469633102417, -0.03458366543054581, 0.024253644049167633, 0.016540559008717537, -0.03398264944553375, -0.020497271791100502, -0.010110901668667793, -0.005456130485981703, 0.025380555540323257, 0.014887755736708641, 0.0323048010468483, -0.007575350813567638, -0.01714157871901989, 0.01813075691461563, -0.03097754903137684, -0.007043198216706514, -0.012834272347390652, -0.061454251408576965, 0.009234415367245674, -0.03145335614681244, 0.00752526568248868, 0.01904480718076229, 0.01409891713410616, -0.07247294485569, 0.02644485980272293, 0.03954207897186279, 0.031152848154306412, -0.0001387118682032451, -0.004153921734541655, 0.009979428723454475, 0.017241748049855232, -0.03513460233807564, 0.04865754023194313, -0.018907073885202408, -0.01712905801832676, -0.028623556718230247, -0.02364010363817215, 0.029424916952848434, 0.021085768938064575, -0.018318574875593185, -0.020134154707193375, -0.01204543374478817, 0.054943203926086426, -0.04387442767620087, -0.005978892557322979, -0.027696983888745308, -0.05374116450548172, -0.058148641139268875, -0.006529827136546373, -0.017980501055717468, 0.023815400898456573, -0.014912798069417477, -0.03886593133211136, 0.021661747246980667, -0.015238350257277489, -0.037238169461488724, 0.005418566986918449, 0.0021677399054169655, -0.006342008709907532, 0.04084428772330284, -0.02271353080868721, -0.03458366543054581, -0.01113138347864151, 0.05599498748779297, 0.02694571018218994, 0.0297003835439682, -0.08639656007289886, 0.014211608096957207, 0.008464358747005463, -0.02739647589623928, -0.03606117516756058, -0.008232715539634228, 0.01138806901872158, 0.04031839594244957, 0.006855379324406385, 0.0343332439661026, -0.007293622940778732, -0.011269116774201393, 0.04069403186440468, 0.014311778359115124, 0.024391377344727516, 0.03783918917179108, 0.0176424290984869, -0.06896699219942093, -0.042421963065862656, 0.0418209433555603, -0.02092299424111843, -0.00625122943893075, -0.012934441678225994, 0.01624004915356636, -0.013785886578261852, 0.009685180149972439, -0.016803504899144173, -0.04302298277616501, 0.01616492122411728, -0.01805562898516655, -0.0013022091006860137, 0.004466952756047249, -0.059551022946834564, 0.035860832780599594, -0.055794648826122284, 0.0306519977748394, 0.014499597251415253, 0.03283069282770157, -0.003125614719465375, 0.0010486539686098695, -0.019119935110211372, 0.007750648073852062, -0.0022193898912519217, 0.0037532418500632048, 0.023790357634425163, 0.007481441367417574, -0.014587245881557465, -0.02087290771305561, -0.04076915979385376, -0.01414900179952383, 0.024654323235154152, -0.003831499721854925, 0.02511760964989662, 0.016340218484401703, -0.04575261473655701, -0.00907790008932352, -0.05599498748779297, 0.04207136854529381, 0.042396921664476395, 0.0601019561290741, -0.03808961436152458, -0.011657275259494781, -0.05138717219233513, -0.02364010363817215, -0.04497629776597023, -0.015413647517561913, 0.016327697783708572, 0.00740631390362978, 0.004066273104399443, 0.03232984244823456, 0.06596189737319946, -0.019720954820513725, 0.0143743846565485, -0.033206332474946976, 0.016765940934419632, -0.03465879335999489, 0.029099363833665848, 0.004066273104399443, 0.03097754903137684, 0.03165369853377342, 0.04349879175424576, -0.017905374988913536, -0.007969769649207592, -0.01851891539990902, -0.0034652533940970898, 0.05243895575404167, 0.02321438118815422, 0.020284410566091537, -0.00786960031837225, -0.047530628740787506, -0.013923619873821735, 0.05384133756160736, 0.05474286526441574, -0.04500133916735649, -0.0332564152777195, -0.020685089752078056, -0.012972005642950535, -0.02822287753224373, -0.031152848154306412, -0.02089795097708702, 0.030276359990239143, -0.027571773156523705, -0.014023790135979652, -0.004141400568187237, -1.6372989193769172e-05, 0.006041498854756355, -0.0012771665351465344, -0.026545030996203423, 0.02505500242114067, 0.015025489032268524, -0.029850637540221214, 0.04367408901453018, 0.042447008192539215, 0.003171004354953766, -0.004607816692441702, -0.06541096419095993, 0.036486897617578506, 0.015125659294426441, -0.013547983020544052, 0.008677219972014427, 0.010862176306545734, -0.013347642496228218, 0.001555764232762158, -0.016377782449126244, 0.010611752048134804, 0.0016215007053688169, 0.023564975708723068, -0.03533494099974632, -0.0408693291246891, 0.01755478046834469, -0.0024807709269225597, -0.043398622423410416, 0.0040349699556827545, -0.007587871979922056, -0.02549324557185173, 0.014987925067543983, 0.0030254449229687452, 0.0029612735379487276, 0.006717645563185215, -0.00881495326757431, 0.008145066909492016, -0.029374830424785614, -0.009328324347734451, -0.023940611630678177, 0.05554422363638878, 0.018318574875593185, 0.05879974737763405, 0.003111528465524316, -0.042922813445329666, 0.00832662545144558, -0.02369018830358982, -0.052639298141002655, 0.05759770795702934, -0.01299704797565937, 0.0031522223725914955, 0.00627001142129302, 0.013998746871948242, -0.0060696713626384735, 0.007988551631569862, -0.013147302903234959, 0.04447544738650322, -0.05228870362043381, -0.019745996221899986, 0.03906626999378204, -0.00417896406725049, 0.03060191310942173, 0.008207673206925392, -0.022826222702860832, -0.03290582075715065, 0.014086396433413029, -0.016978802159428596, 0.0031490919645875692, -0.028924066573381424, 0.00882121454924345, -0.02228780835866928, 0.0004562427056953311, -0.034082818776369095, -0.029349789023399353, -0.027070922777056694, 0.04314819723367691, 0.010736963711678982, -0.029575170949101448, -0.015977103263139725, 0.02509256638586521, 0.003443341236561537, -0.003446471644565463, -0.03348179906606674, -0.09130489081144333, -0.015964582562446594, -0.029349789023399353, 0.04364904388785362, 0.0008099677506834269, 0.019570698961615562, 0.015613987110555172, -0.008670959621667862, -0.014023790135979652, -0.004714247304946184, -0.012677756138145924, -0.0029205793980509043, -0.016540559008717537, 0.0555943101644516, -0.01116268616169691, -0.010004471056163311, 0.0033963865134865046, 0.013685716316103935, -0.02639477513730526, 0.015426169149577618, -0.0002488596655894071, -0.008132546208798885, 0.014775063842535019, 0.0013577720383182168, -0.01662820763885975, -0.04167069122195244, -0.03395760431885719, -0.04945890232920647, 0.012565065175294876, -0.018806904554367065, -0.0009179634507745504, 0.023477327078580856, -0.007894642651081085, -0.020109113305807114, 0.0017060190439224243, -0.0268455408513546, 0.021924693137407303, 0.005900634918361902, 0.03879080340266228, 0.02867364138364792, -0.024904748424887657, 0.00543421832844615, 0.02644485980272293, -0.03606117516756058, 0.0235774964094162, 0.0306519977748394, -0.08033628016710281, 0.023527411743998528, 0.012427331879734993, 0.026294605806469917, -0.03748859465122223, 0.045652445405721664, 0.000717232353053987, -0.02411591075360775, -0.013134781271219254, -0.002252258127555251, -0.03924156725406647, -0.055894818156957626, 0.016440389677882195, 0.004964672029018402, -0.004301046021282673, -0.0325552262365818, 0.04878275468945503, 0.020271889865398407, -0.05459260940551758, -0.01391109824180603, -0.013848491944372654, -0.03783918917179108, -0.012108040042221546, 0.014424469321966171, 0.025280386209487915, 0.0006777121452614665, -0.01299704797565937, 0.029500043019652367, 0.0070181554183363914, -0.005052320659160614, -0.01804310828447342, -0.03751363605260849, 0.03538502752780914, 0.002613808959722519, 0.004970932845026255, 0.006307574920356274, -0.0021286108531057835, -0.006799033842980862, -0.013986226171255112, 0.0032116982620209455, -0.012195688672363758, -0.0453769750893116, -0.033206332474946976, -0.008495662361383438, -0.03278061002492905, 0.04222162440419197, -0.006282532587647438, -0.000675755727570504, -0.02454163134098053, 0.03237992897629738, -0.019833644852042198, -0.010286198928952217, 0.007274840958416462, -0.03373222425580025, -0.0017795813037082553, -0.012358464300632477, -0.010999910533428192, -0.048056524246931076, -0.014775063842535019, -0.010699400678277016, 0.0162150077521801, 0.03989267349243164, 0.009741525165736675, -0.0014469858724623919, -0.020697610452771187, 0.020960556343197823, -0.0141364810988307, -0.0039160181768238544, 0.030802251771092415, 0.001918880152516067, -0.0351596437394619, 0.026094265282154083, -0.027671942487359047, 0.023928090929985046, 0.0306519977748394, 0.002991011366248131, -0.03631160035729408, -0.0024119040463119745, 0.01275914441794157, 0.00098996062297374, -0.007769430056214333, 0.012471156194806099, 0.025618458166718483, 0.018406223505735397, 0.014036310836672783, -0.01706645078957081, -0.009384670294821262, -0.0361112579703331, 0.0009046596242114902, -0.0014094221405684948, -0.01065557636320591, 0.03055182844400406, 0.026720328256487846, 0.0076943025924265385, 0.05694660171866417, 0.00810750387609005, -0.006579912267625332, -0.03703783079981804, 0.0017294964054599404, 0.021862085908651352, -0.02457919530570507, -0.025368034839630127, -0.00832036416977644, 0.005935068242251873, -0.03250513970851898, -0.03828995302319527, -0.012608889490365982, 0.0011003040708601475, -0.03050174191594124, -0.03162865340709686, -0.0131848668679595, -0.04592791199684143, -0.03055182844400406, 0.03152848407626152, -0.01433682069182396, -0.0020033984910696745, -0.0037375905085355043, -0.017980501055717468, -0.001823405735194683, 0.01769251376390457, -0.04407476633787155, -0.00019730736676137894, 0.02972542494535446, 0.023439763113856316, 0.0427725575864315, -0.021574098616838455, -0.022951435297727585, -0.005888113286346197, 0.014674894511699677, -0.016928717494010925, 0.005590734072029591, -0.05429210141301155, -0.011150164529681206, -0.02497987635433674, 0.03395760431885719, 0.012546283192932606, -0.01801806502044201, -0.0005004583508707583, 0.013810928910970688, -0.026244521141052246, 0.018819425255060196, 0.005659600719809532, 0.024391377344727516, 0.0207852590829134, 0.012327161617577076, -0.006748948711901903, -0.016928717494010925, -0.027121007442474365, 0.0042415703646838665, -0.03748859465122223, 0.014512117952108383, -0.0037595026660710573, 0.006936767604202032, -0.04046865180134773, -0.00429791584610939, -0.04580269753932953, 0.017917895689606667, 0.003931669518351555, -0.006886682473123074, -0.02505500242114067, -0.011638493277132511, -0.010304980911314487, 0.029399873688817024, 0.010611752048134804, 0.05549414083361626, -0.014274214394390583, 0.0008381405496038496, 0.02365262433886528, -0.0018406223971396685, -0.03240497037768364, -0.019370360299944878, 0.00882121454924345, 0.008602092042565346, 0.003994275815784931, 0.03618638589978218, 0.0190698504447937, 0.018744297325611115, -0.011494498699903488, 0.00949736125767231, 0.001266210456378758, 0.005944459233433008, 0.04923351854085922, -0.0039003666024655104, 0.010586708784103394, 0.009522403590381145, -0.011525802314281464, -0.04925855994224548, -0.006511045154184103, 0.022413020953536034, -0.026369733735919, 0.02459171786904335, 0.014123959466814995, -0.03816474229097366, -0.06055271998047829, -0.00832036416977644, 0.029324745759367943, -0.013585546053946018, 0.006692603230476379, 0.010110901668667793, -0.014512117952108383, 0.04362400248646736, 0.05529379844665527, -0.005183793604373932, 0.010524102486670017, -0.04217153787612915, -0.013047132641077042, 0.008057418279349804, -0.03250513970851898, -0.03328145667910576, 0.03606117516756058, -0.020234325900673866, -0.013272515498101711, 0.007775690406560898, 0.014224129728972912, -0.03007602132856846, 0.007932205684483051, -0.028473300859332085, -0.005944459233433008, 0.0014947231393307447, -0.009653876535594463, -0.01665325090289116, 0.02824791893362999, 0.017454609274864197, -0.051261961460113525, -0.10878454148769379, -0.03260531276464462, -3.2574789656791836e-05, -0.004510777071118355, 0.011431893333792686, 0.0012036042753607035, 0.0698685273528099, -0.0282729621976614, -0.014887755736708641, -0.020973078906536102, 0.0015495035331696272, -0.02181200124323368, 0.017379483208060265, -0.02232537232339382, 0.02079778164625168, -0.03576066344976425, -0.016077272593975067, -0.0029221444856375456, -0.003399516921490431, -0.014937840402126312, -0.02184956520795822, -0.019670870155096054, 0.0014203782193362713, 0.021887129172682762, -0.040067970752716064, 0.008877559565007687, 0.02174939587712288, -0.02039710059762001, -0.011713621206581593, -0.01711653545498848, 0.024366334080696106, -0.015125659294426441, 0.009585009887814522, -0.007061979733407497, -0.033131204545497894, -0.022400500252842903, -0.002682675840333104, -0.02323942258954048, -0.003981754649430513, 0.029900724068284035, 0.0416957326233387, -0.03443341329693794, 0.05689651891589165, -0.014750021509826183, 0.0021880867425352335, -0.046579014509916306, -0.01667829230427742, -0.03150344267487526, -0.012627671472728252, -0.031478401273489, 0.023302029818296432, -0.04031839594244957, 0.01855647936463356, -0.006054020021110773, 0.018756818026304245, 0.005697164684534073, 0.011168946512043476, 0.0010150030720978975, -0.013748322613537312, -0.036486897617578506, -0.007938466966152191, 0.04419998079538345, 0.0010470887646079063, -0.00284545193426311, -0.024904748424887657, -0.016903676092624664, 0.0042196582071483135, 0.008026115596294403, -0.03713800013065338, -0.03010106272995472, -0.004510777071118355, -0.0018343618139624596, -0.007243537809699774, 0.04419998079538345, -0.018656648695468903, -0.0019752257503569126, 0.035986047238111496, 0.014762543141841888, -0.041094712913036346, 0.007669260259717703, 0.02872372604906559, -0.02232537232339382, 0.025142651051282883, 0.04682943969964981, 0.03828995302319527, 0.02824791893362999, 0.01629013381898403, -0.007769430056214333, -0.028373131528496742, -0.005956980399787426, 0.008238976821303368, -0.010542884469032288, -0.013485376723110676, -0.021198460832238197, -0.04387442767620087, -0.03253018483519554, -0.006295053754001856, -0.002623199950903654, 0.004438779782503843, -0.004504516255110502, 0.009603791870176792, 0.009547445923089981, -0.04071907699108124, 0.0008170109940692782, 0.034533582627773285, -0.020672569051384926, 0.019733475521206856, 0.018180841580033302, 0.016315177083015442, 0.009434754960238934, 0.004726768471300602, 0.011694839224219322, -0.011669796891510487, 0.005205705761909485, -0.02697075344622135, 0.01109381951391697, 0.04680439829826355, 0.017504693940281868, 0.012151864357292652, 0.025267863646149635, -0.004967802204191685, 0.051287002861499786, 0.00145246391184628, 0.04159556329250336, 0.018381182104349136, -0.021611662581562996, -0.0016465431544929743, 0.05063589662313461, -0.03107772022485733, 0.008007333613932133, 0.02415347285568714, 0.011219032108783722, -0.007055719383060932, 0.002452597953379154, 0.012884357012808323, 0.04031839594244957, 0.05061085522174835, 0.024391377344727516, -0.020046506077051163, 0.018869509920477867, -0.00067966862116009, 0.034909218549728394, 0.018306054174900055, 0.03210446238517761, 0.007907163351774216, 0.032154545187950134, 0.029575170949101448, -0.01664072833955288, -0.03443341329693794, 0.030702082440257072, 0.008696001954376698, -0.03280565142631531, 0.02081030234694481, -0.02277613803744316, -0.002710848581045866, 0.012752884067595005, 0.029825596138834953, -0.030927464365959167, 0.0073249260894954205, 0.004898935556411743, -0.002906493144109845, 0.023890526965260506, -0.02591896802186966, -0.024303728714585304, 0.041069671511650085, -0.009190591052174568, -0.021423842757940292, -0.007775690406560898, -0.016603166237473488, -0.02742151729762554, -0.008226455189287663, -0.05268938094377518, -0.0007927510887384415, 0.02774707041680813, 0.018869509920477867, 0.015613987110555172, -0.002557463478296995, 0.03608621656894684, -0.027671942487359047, 0.01940792426466942, 0.016941238194704056, 0.023414719849824905, 0.00716841034591198, -0.003984884824603796, 0.012765404768288136, -0.01853143610060215, 0.00945979729294777, -0.014036310836672783, 0.03658706694841385, 0.026670243591070175, 0.028848938643932343, 0.02410338819026947, -0.0002813366299960762, 0.018769340589642525, 0.029324745759367943, -0.0020644397009164095, 0.004682944156229496, 0.027095966041088104, 0.023289507254958153, -0.045176636427640915, -0.03989267349243164, 0.03388247638940811, -0.0032336104195564985, -0.012752884067595005, -0.029850637540221214, 0.03994276002049446, 0.021974777802824974, -0.006917985621839762, 0.009547445923089981, 0.024216080084443092, 0.02079778164625168, 0.006273141596466303, -0.0008772694272920489, 0.011913960799574852, -0.0005622819880954921, -0.06465968489646912, -0.0011535192606970668, 0.021160896867513657, -0.020209282636642456, 0.015551380813121796, 0.00832662545144558, -0.02834809012711048, 0.013485376723110676, 0.010186029598116875, -0.00997316837310791, -0.016327697783708572, 0.0651104524731636, -0.004194615874439478, 0.008051157929003239, 0.034107860177755356, -0.017504693940281868, 0.03465879335999489, -0.03192916512489319, 0.004188355058431625, -0.006986852269619703, -0.026720328256487846, 0.0072811017744243145, 0.00835792813450098, -0.01161971129477024, -0.016002146527171135, 0.045151595026254654, 0.0071809315122663975, -0.0231016892939806, -0.0025950272101908922, 0.012909399345517159, 0.016853589564561844, 0.005719076842069626, 0.056796349585056305, -0.03162865340709686, -0.005922547075897455, -0.010198550298810005, 0.03806457296013832, -0.010561666451394558, -0.005916286259889603, -0.01207673642784357, 0.007362489588558674, 0.003327519865706563, 0.018819425255060196, 0.04635363444685936, -0.004479473922401667, -0.048507288098335266, 0.026194436475634575, 0.0055156066082417965, -0.028423216193914413, 0.0023665144108235836, -0.00788212101906538, 0.017279312014579773, 0.054542526602745056, 0.02034701593220234, 0.0042415703646838665, 0.0013882925268262625, 0.03558536618947983, -0.00830784346908331, 0.025643501430749893, 0.021010642871260643, 0.018368659541010857, 0.021110812202095985, 0.004507646895945072, 0.033506840467453, -0.010799570009112358, -0.009340845979750156, 0.005650209728628397, -0.011694839224219322, -0.006385833024978638, 0.01481262780725956, -0.017479652538895607, 0.029024235904216766, -0.0007567525026388466, 0.013172345235943794, 0.028097664937376976, 0.030201232060790062, 0.04354887455701828, -0.017304355278611183, 0.004103836603462696, 0.012984526343643665, -0.02965029887855053, -0.008439316414296627, 0.02644485980272293, 0.001522113336250186, -0.00010584361734800041, 0.03245505690574646, -0.0017310614930465817, 0.010624272748827934, 0.0032336104195564985, 0.017241748049855232, 0.02089795097708702, 0.005478043109178543, -0.000670668960083276, -0.02136123739182949, -0.03844020888209343, 0.01664072833955288, -0.0415705181658268, -0.008176370523869991, 0.015576424077153206, -0.030201232060790062, 0.005975762382149696, -0.012984526343643665, -0.014662372879683971, -0.027471601963043213, 0.004720507655292749, 0.009647616185247898, -0.007562829647213221, 0.025643501430749893, 0.016315177083015442, -0.03834003955125809, -0.004238440189510584, 0.02460423856973648, -0.008044897578656673, 0.0010564797557890415, 0.008890081197023392, -0.017980501055717468, 0.010586708784103394, -0.006667560897767544, -0.040093012154102325, -0.016515517607331276, 0.02271353080868721, -0.03348179906606674, 0.008683480322360992, -0.024241121485829353, -0.05233878642320633, 0.04374921694397926, 0.00406001228839159, 0.0006585390074178576, -0.013635631650686264, 0.0016324567841365933, 0.018794381991028786, 0.004147660918533802, 0.007569089997559786, 0.00953492522239685, 0.0024917270056903362, 0.06646274775266647, -0.02040962316095829, -0.033632051199674606, 0.01806814968585968, -0.008827474899590015, 0.048006437718868256, -0.011964045464992523, -0.017492173239588737, -0.03205437585711479, 0.010643054731190205, 0.0019204453565180302, 0.034157946705818176, -0.003718808526173234, 0.00790090300142765, 0.020059028640389442, -0.006342008709907532, -0.01616492122411728, 0.02919953316450119, 0.023014040663838387, 0.01853143610060215, 0.01323495153337717, 0.010436453856527805, 0.016765940934419632, 0.011976567097008228, 0.020722653716802597, -0.024704407900571823, -0.021999821066856384, -0.027696983888745308, -0.005819246638566256, 0.009585009887814522, 0.006880421657115221, -0.04650389030575752, -0.04312315210700035, 0.010292460210621357, -0.005603255238384008, -0.015952059999108315, -0.018255969509482384, 0.01548877451568842, -0.03197924792766571, -0.014512117952108383, -0.0181182362139225, 0.0011574322124943137, -0.004607816692441702, 0.009923083707690239, 0.0032273498363792896, 0.03879080340266228, 0.015376083552837372, 0.0039160181768238544, 0.011431893333792686, 0.033657096326351166, 0.028873981907963753, -0.019620783627033234, 0.004576513543725014, -0.0024792056065052748, -0.014161523431539536, 0.005916286259889603, -0.019132455810904503, 0.006454699672758579, 0.00973526481539011, 0.02044718712568283, -0.025718629360198975, 0.026044180616736412, -0.025292906910181046, 0.004385564476251602, 0.03212950378656387, -0.007587871979922056, -0.00417896406725049, 0.017967980355024338, -0.0036405508872121572, 0.0471549928188324, -0.04387442767620087, 0.01949557289481163, -0.012001609429717064, -0.0166908148676157, -0.00924067571759224, -0.010943564586341381, -0.03207941725850105, 0.015113137662410736, -0.002172435401007533, 0.026519987732172012, -0.007894642651081085, -0.00555317010730505, -0.014161523431539536, 0.026269562542438507, -0.003125614719465375, 0.015939539298415184, 0.009303282015025616, 0.0061917537823319435, -0.013372684828937054, 0.030401572585105896, 0.006110365502536297, 0.01854395680129528, 0.02083534561097622, 0.002222520299255848, -0.011964045464992523, -0.011795008555054665, 0.009453536942601204, 0.02416599541902542, -0.004216528031975031, 0.03841516748070717, -0.007224755827337503, -0.005290224216878414, -0.02034701593220234, 0.015989623963832855, -0.007349968422204256, 0.008645916357636452, -0.013547983020544052, -0.017291832715272903, 0.000395397306419909, -0.013059654273092747, 0.025718629360198975, -0.007256058976054192, 0.03240497037768364, 0.02079778164625168, -0.003966102842241526, 0.014837670139968395, -0.01992129348218441, 0.021624183282256126, 0.017717555165290833, -0.010098380967974663, -0.006511045154184103, 0.0018640997586771846, 0.010555406101047993, 0.008132546208798885, 0.0025840711314231157, 0.022563276812434196, -0.023878006264567375, 0.0131848668679595, -0.005362221505492926, 0.022801179438829422, -0.025630980730056763, 0.02960021421313286, 0.012364725582301617, -0.017955459654331207, -0.014023790135979652, -0.0008874429622665048, 0.0018312315223738551, -0.004376173485070467, -0.010373848490417004, -0.009491100907325745, 0.026294605806469917, 0.010987388901412487, -0.0058630709536373615, 0.026369733735919, 0.0007152758771553636, -0.03305607661604881, 0.0058849831111729145, -0.0594007670879364, 0.021649224683642387, 0.006661300081759691, 0.0008287496166303754, 0.024328770115971565, -0.015313477255403996, 0.04127001017332077, 0.015426169149577618, -0.02867364138364792, 0.00039363649557344615, -0.014274214394390583, -0.022037383168935776, -0.010899740271270275, 0.02409086748957634, -0.010937304235994816, 0.00997316837310791, 0.03428315743803978, 0.030276359990239143, 0.010968606919050217, -0.018744297325611115, -0.012565065175294876, -0.024754492565989494, -0.001178561826236546, -0.0240533035248518, 0.01810571365058422, 0.027496645227074623, 0.0007731866207905114, -0.036386724561452866, -0.026319649070501328, -0.016465431079268456, -0.0017654949333518744, -0.029525086283683777, 0.027446560561656952, 0.00953492522239685, 0.021423842757940292, 0.04450048878788948, -0.014562203548848629, 0.02033449523150921, 0.023502368479967117, 0.03330650180578232, 0.015075573697686195, 0.019658347591757774, 0.008439316414296627, 0.021699311211705208, 0.0066487789154052734, 0.03616134449839592, 0.011907700449228287, -0.0024619889445602894, 0.04312315210700035, 0.029374830424785614, -0.011544584296643734, 0.027221176773309708, -0.007619175128638744, -0.004607816692441702, -0.02509256638586521, 0.017792683094739914, 0.018381182104349136, -0.02044718712568283, -0.02409086748957634, 0.01662820763885975, -0.01674089953303337, 0.020321974530816078, -0.007312404457479715, 0.014123959466814995, -0.003371344180777669, 0.00927823968231678, 0.022012341767549515, 0.002133306348696351, 0.015413647517561913, 0.020597441121935844, 0.0024792056065052748, -0.02742151729762554, -0.0047987657599151134, -0.021599140018224716, -0.013259993866086006, 0.050786152482032776, 7.13612898834981e-05, -0.009729004465043545, -0.0011895179050043225, 0.009090420790016651, 0.028373131528496742, 0.000589280913118273, 0.002253823447972536, 0.02495483309030533, -0.012233252637088299, -0.029900724068284035, -0.01577676273882389, -0.005268312059342861, 0.015100616030395031, 0.005606385413557291, -0.0013342946767807007, -0.0015933278482407331, 0.003712547942996025, -0.04778105393052101, 0.03305607661604881, 0.000687494408339262, -0.02086038701236248, -0.009203111752867699, 0.019107414409518242, -0.01721670664846897, 0.0015119398012757301, -0.028097664937376976, 0.020109113305807114, 0.021210981532931328, -0.018907073885202408, -0.012684017419815063, -0.026720328256487846, 0.04392451420426369, -0.03253018483519554, -0.009196851402521133, -0.026745369657874107, 2.2303460355033167e-05, 0.03488417714834213, -0.012214470654726028, -0.01615240052342415, 0.0011402155505493283, 0.02091047167778015, -0.010167247615754604, 0.025142651051282883, -0.028473300859332085, 0.0024197297170758247, -0.007043198216706514, -0.022926392033696175, -0.016052231192588806, 0.02599409595131874, 0.026795456185936928, -0.024466505274176598, -0.005227617919445038, 0.009466057643294334, 0.03200429305434227, 0.026194436475634575, 0.01575172133743763, -0.03556032478809357, 0.021574098616838455, -0.015263392589986324, -0.021962257102131844, -0.006185492966324091, -0.013773364946246147, 0.035935960710048676, -0.02601913921535015, 0.005578212905675173, -0.03566049411892891, -0.000918746052775532, -0.02462927997112274, 0.007149628363549709, -0.008195152506232262, -0.03288077935576439, 0.004301046021282673, 0.028899023309350014, 0.010436453856527805, -0.014537160284817219, -0.029349789023399353, 0.009134245105087757, -0.012427331879734993, -0.022876307368278503, 0.03668723627924919, 0.024691887199878693, 0.03300599008798599, 0.024741971865296364, 0.0022710401099175215, 0.02634469047188759, -0.01895715855062008, 0.000863183056935668, 0.029475001618266106, 0.0021286108531057835, 0.0016168052097782493, 0.034608710557222366, 0.02321438118815422, 0.02086038701236248, -0.014361863024532795, -0.011926481500267982, -0.037363383919000626, -0.004692335147410631, -0.013848491944372654, -0.015100616030395031, -0.0034652533940970898, 0.03355692699551582, 0.033632051199674606, 0.003468383802101016, 0.0014352472499012947, 0.018293533474206924, -0.01391109824180603, -0.022813700139522552, 0.029950808733701706, 0.009829173795878887, 0.03573562204837799, 0.02782219648361206, -0.009146766737103462, 0.02737143263220787, -0.014962882734835148, -0.0014501161640509963, 0.028573472052812576, -0.010880958288908005, -0.016052231192588806, 0.024754492565989494, 0.008489401079714298, 0.01575172133743763, -0.012408549897372723, 0.0006984504871070385, 0.02972542494535446, 0.01525087095797062, 0.0016715856036171317, 0.013259993866086006, 0.025718629360198975, 0.02601913921535015, -0.04267238825559616, -0.00776316924020648, 0.022938912734389305, -0.0044481707736849785, -0.021862085908651352, -0.02451658993959427, -0.01570163667201996, -0.0042415703646838665, -0.026244521141052246, -0.014599766582250595, -0.010730703361332417, 0.02322690188884735, 0.005399785004556179, -0.009109202772378922, 0.0017576691461727023, -0.03520973026752472, -0.00017246052448172122, 0.009434754960238934, 0.028047580271959305, 0.0491834357380867, 0.023276986554265022, 0.0026122438721358776, -0.018882030621170998, 0.02553080953657627, 0.013272515498101711, -0.0200214646756649, 0.05529379844665527, -0.0028251048643141985, 0.002164609497413039, -0.02366514503955841, 0.00284545193426311, -0.028147749602794647, 0.005956980399787426, -0.003268043976277113, 0.007162149995565414, 0.04542706161737442, 0.001992442412301898]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
" regularization for PPO on
these generated samples.
4.2. Empirical Validation in A Synthetic Scenario
We design a synthetic scenario to validate Theorem 4.1
in practice. We create discrete spaces of prompts and re-
sponses, both of size 8. The policy πθand reward model rϕ
are modeled as MLPs, which take a one-hot vector as input
and output a categorical distribution of overall responses.
We manually enforce the optimal response to be diagonal
indices. The preference dataset is randomly created under
this constraint and only covers limited preference pairs for
each input. The resulting policies of DPO and PPO are
shown in Figure 1. We can see that in practice, DPO and
the learned reward model can assign high values to the re-
sponse out of the distribution of preference dataset, which
4
Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study
are marked using circles. In the case of DPO, the final model
may assign higher probabilities than the reference model to
these responses, which is not desirable as performance im-
provement on OOD responses could not be guaranteed. For
example, in the red circles, DPO increases the probability
from 0.11 to 0.23. In contrast, though the reward model has
a similar misspecification issue, PPO can alleviate the issue
with explicit KL regularization w.r.t. the reference model.
Practical Remark: From the analysis in this section, we
attempt to provide insights to understand the performance of
DPO in practice — DPO is prone to generating a biased
policy that favors out-of-distribution responses, leading
to unpredictable behaviors. We will further validate these
insights through an experimental study involving LLMs on
real preference datasets.
4.3. Experiments on Real Preference Datasets
In this section, we conduct experiments on real preference
datasets and investigate two aspects that may influence DPO
performance, including the base model and preference data
used for DPO training.
Experimental Setup. We perform our experimental anal-
ysis on SafeRLHF dataset (Dai et al., 2023). In this dataset,
preference pairs have the form (x,y1,y2, lh, ls, b1, b2),
where lhandlsare a preference labels over y1andy2in
terms of helpfulness and safety, respectively, which could
be either 1 or 2. b1andb2are binary safety labels of these
two responses, which could be positive or negative. With
this dataset, our objective is to train an LLM that prioritizes
safety over helpfulness in content generation. Specifically,
in constructing the preference dataset, our preference is for
the more helpful response when both options are consid-
ered safe (i.e., lhifb1andb2are both positive). Otherwise,
our preference shifts towards the safer one (i.e., ls). Fol-
lowing Dai et al. (2023), the base model is trained on the
Alpaca (Taori et al., 2023) open-source dataset with SFT,
denoted as SFT (Alpaca) . We use the evaluation models
released by the official codebase to evaluate the helpfulness
and harmfulness. We remark that these official evaluation
models are not involved during the training. Our experimen-
tal study is shown in Table 2.
Impact of The Base Model. When using SFT (Alpaca)
as the base and reference model, we find that DPO per-
forms poorly, producing only a 55.4%safety rate and low
helpfulness reward. We hypothesize that this is caused by
the distribution shift between the training data of the base
model, i.e., the Alpaca dataset, and the preference data, i.e.,
the SafeRLHF dataset. To study the impact, we further
fine-tune SFT (Alpaca) on the SafeRLHF dataset with safe
responses to obtain SFT (Safe) . We then use SFT (Safe)
as the reference model to re-train DPO from scratch. As∆Help.↑Harm. ↓ S.R.↑
SFT (Alpaca) -2.62 1.50 41.6%
PPO 1.69 -12.08 99.5%
+ SFT (Safe) 4.47 -12.33 99.6%
DPO -4.19 -0.97 55.4%
+ SFT (Safe) -1.62 -3.50 71.8%
+ filter dual-unsafe 2.46 -4.88 80.8%
+ filter dual-safe -2.86 -","[0.031021874397993088, 0.010625769384205341, 0.03481123596429825, 0.027289068326354027, 0.004298381973057985, 0.012584078125655651, -0.026355868205428123, 0.030823921784758568, 0.006737430579960346, 0.03546164929866791, 0.03732805326581001, 0.02299068681895733, -0.019498251378536224, -0.01169329509139061, 0.021477770060300827, -0.028660591691732407, 0.02991900034248829, -0.04886581376194954, -0.02378249354660511, 0.007295937743037939, -0.002949835266917944, -0.015567494556307793, 0.007896862924098969, -0.002173934830352664, 0.01443634182214737, -0.016118932515382767, 0.021916091442108154, -0.024475324898958206, 0.018975093960762024, -0.03647968918085098, 0.04595309495925903, -0.023443147540092468, -0.04168299213051796, -0.04097602143883705, 0.0061895283870399, 0.010731815360486507, 0.008434160612523556, 0.03404770791530609, -0.02170400135219097, -0.004199406132102013, 0.004206475801765919, -0.04657522961497307, -0.03902478143572807, -0.03037146106362343, -0.004651867318898439, 0.043492838740348816, 0.04612276703119278, -0.017490455880761147, 0.0432383269071579, -0.012371987104415894, -0.057208068668842316, 0.07324216514825821, 0.004206475801765919, -0.04278586804866791, 0.017235945910215378, -0.011318600736558437, 0.022594783455133438, 0.0038989433087408543, 0.02201506681740284, -0.03585755452513695, -0.014888802543282509, -0.026483122259378433, -0.007253519259393215, 0.009360291995108128, 0.011855898424983025, -0.007423192262649536, -0.09122750163078308, 0.008080675266683102, 0.01146706473082304, 0.006493526045233011, 0.010215726681053638, 0.0020625870674848557, 0.06108226999640465, 0.003842385718598962, -0.014174762181937695, -0.011474134400486946, 0.0777667760848999, 0.03096531704068184, -0.017391478642821312, 0.0003486249188426882, 0.007564586587250233, 0.0463772788643837, 0.010844930075109005, -0.03418910130858421, -0.007804956287145615, -0.020275918766856194, -0.05949865281581879, -0.006196598056703806, -0.033680085092782974, -0.03461328521370888, -0.028377803042531013, -0.025691315531730652, -0.019257882609963417, -0.00960066169500351, 0.041598156094551086, -0.054323628544807434, -0.0025256527587771416, 0.0061612497083842754, 0.0157513078302145, 0.0183670986443758, -0.02398044615983963, -0.03195507451891899, -0.006574827712029219, -0.0071015204302966595, 0.033227622509002686, 0.007472680415958166, 0.009572383016347885, 0.025055041536688805, -0.005037166178226471, -0.005185630172491074, -0.01764598861336708, 0.021336374804377556, -0.05921586602926254, 0.05316419526934624, -0.02091219276189804, -0.04304037615656853, -0.08031187206506729, -0.009077503345906734, 0.026214472949504852, -0.006026925053447485, -0.04055183753371239, -0.007126264739781618, 0.007430261932313442, 0.0021138424053788185, 0.008229139260947704, -0.0007396680884994566, 0.033934593200683594, -0.062496211379766464, 0.012895145453512669, -0.042898982763290405, 0.007267658598721027, 0.02972104772925377, 0.002375421579927206, -0.05599207803606987, -0.05279657244682312, 0.049035485833883286, -0.004202940966933966, 0.005889066029340029, -0.023301754146814346, -0.00855434499680996, -0.04397357627749443, -0.052174437791109085, -0.0378936305642128, 0.03693214803934097, -0.07561758905649185, -0.03693214803934097, -0.010300562717020512, -0.023542124778032303, -0.02287757210433483, 0.0716019943356514, -0.004036802798509598, -0.006758640054613352, -0.02926858700811863, 0.018734723329544067, -0.041202250868082047, -0.03690386936068535, 0.012485102750360966, 0.006896499078720808, 0.005616882350295782, -0.008448299951851368, -0.005231583025306463, 0.05921586602926254, -0.03828953206539154, -0.014351504854857922, 0.030399739742279053, 0.03902478143572807, -0.042503077536821365, -0.0008722250931896269, -0.08251761645078659, -0.041711270809173584, 0.012888075783848763, 0.02215646207332611, -0.04909204691648483, -0.02901407703757286, -0.04151332005858421, -0.020275918766856194, -0.03416082262992859, -0.013404164463281631, -0.01856505125761032, -0.017363199964165688, 0.0184802133589983, 0.03984486684203148, -0.018777141347527504, 0.008603833615779877, 0.017942916601896286, -0.0009446896146982908, 0.01460601482540369, 0.016359301283955574, 0.00791100226342678, 0.0012734310002997518, 0.023966306820511818, 0.021067727357149124, 0.06849132478237152, -0.01867816597223282, -0.016161350533366203, -0.022241298109292984, 0.04722564294934273, 0.0757872611284256, -0.031191546469926834, 0.012520451098680496, 0.02188781276345253, 0.00849778763949871, -0.011813480406999588, -0.063231460750103, -0.004496333654969931, -0.0019264951115474105, -0.012089199386537075, -0.01665622927248478, -0.010470235720276833, -0.031332939863204956, 0.026949722319841385, 0.01607651449739933, 0.06362736225128174, 0.009565313346683979, -0.01532712485641241, -0.004740238655358553, -0.07640939205884933, 0.03418910130858421, 0.01205385010689497, 0.03274688124656677, 0.005100793670862913, 0.009607731364667416, 0.022707898169755936, 0.016345161944627762, -0.0015933351824060082, 0.022792736068367958, 0.007112125400453806, -0.010102611035108566, -0.0010507352417334914, -0.06396670639514923, 0.0044609853066504, 0.013481930829584599, 0.001378592918626964, -0.0026847212575376034, 0.027798088267445564, -0.026412425562739372, 0.02176055870950222, -0.006023390218615532, 0.007288868073374033, -0.039307571947574615, 0.008950249291956425, 0.015171591192483902, 0.042898982763290405, -0.022128183394670486, 0.01443634182214737, 0.02567717619240284, -0.01867816597223282, -0.012011432088911533, -0.008165511302649975, -0.023839052766561508, 0.0072075664065778255, -0.013517280109226704, -0.025648897513747215, -0.0633445754647255, -0.04657522961497307, 0.0024390488397330046, -0.01114185806363821, -0.00514321168884635, -0.03735633194446564, 0.003296250943094492, -0.028250548988580704, 0.04069323465228081, 0.015525076538324356, -0.0007281798170879483, -0.01594925858080387, -0.0034942026250064373, 0.010413678362965584, -0.007023754063993692, -0.052768293768167496, -0.011353949084877968, 0.0017073341878131032, 0.02823640964925289, -0.014662572182714939, 0.023089662194252014, -0.033821478486061096, -0.027798088267445564, 0.009819823317229748, 0.04934655502438545, -0.04632072150707245, -0.021350516006350517, -0.00705556757748127, -0.0075009590946137905, 0.056953560560941696, -0.0004953213501721621, 0.01939927600324154, -0.001565056387335062, -0.02686488628387451, 0.01382127683609724, -0.014464620500802994, 0.011474134400486946, 0.008038257248699665, -0.04072151333093643, 0.024008724838495255, -0.04326660558581352, 0.009996565990149975, 0.009671359322965145, 0.011855898424983025, -0.05525682866573334, 0.0036338292993605137, 0.01277496013790369, 0.050025247037410736, 0.011735714040696621, -0.000509018893353641, -0.005111398175358772, 0.06017734482884407, -0.039816588163375854, 0.02658209763467312, 0.018777141347527504, -0.0025044437497854233, -0.019696203991770744, -0.02398044615983963, 0.019512390717864037, -0.004825075156986713, 0.018904397264122963, -0.029805883765220642, -0.0289433803409338, 0.0797462910413742, -0.033680085092782974, -0.020233500748872757, -0.010710606351494789, -0.03625345602631569, -0.058650288730859756, -0.020855635404586792, -0.015129173174500465, 0.02130809612572193, -0.027882924303412437, -0.022439250722527504, 0.01790049858391285, -0.009445128962397575, -0.04111741483211517, 0.012492172420024872, 0.008801785297691822, 0.009098713286221027, 0.02136465534567833, -0.015270567499101162, -0.038317810744047165, -0.02581856958568096, 0.05559617653489113, 0.054974041879177094, 0.069283127784729, -0.09399882704019547, 0.00573353236541152, -0.010342981666326523, 0.008420021273195744, -0.027034560218453407, -0.026101358234882355, -0.010003635659813881, 0.03588583320379257, 0.030173510313034058, 0.014068717136979103, -0.01329104881733656, -0.005889066029340029, 0.036621082574129105, 0.037808794528245926, 0.006815197411924601, 0.022114044055342674, 0.007193427067250013, -0.04578342288732529, -0.025564059615135193, -0.0021244469098746777, -0.0013944996753707528, 0.032181307673454285, -0.03336901590228081, 0.03229442238807678, 0.016825903207063675, 0.035122305154800415, -0.031587451696395874, -0.01920132339000702, -0.0015694749308750033, -0.009105782955884933, -0.015892701223492622, 0.04287070408463478, -0.01280323974788189, 0.035518206655979156, -0.053079359233379364, 0.033482130616903305, 0.015737168490886688, 0.0058713918551802635, -0.001779798767529428, 0.03331245854496956, -0.020488010719418526, 0.02744460292160511, -0.03435877710580826, -0.016642089933156967, 0.0012584078358486295, 0.005574463866651058, -0.0053482335060834885, -0.004058011807501316, -0.05548306182026863, -0.018791280686855316, 0.005896135699003935, 0.0006340643158182502, -0.012216453440487385, 0.0050088874995708466, -0.06911345571279526, -0.010145029053092003, -0.019568948075175285, 0.04403013363480568, 0.03260548785328865, 0.06639868766069412, -0.03679075464606285, -0.025988243520259857, -0.07935038954019547, 0.01797119528055191, -0.07867170125246048, 0.013086027465760708, 0.009459268301725388, -0.003001090604811907, -0.00026268381043337286, 0.03970347344875336, 0.052428945899009705, -0.0409194640815258, 0.027218371629714966, -0.043605953454971313, 0.032831721007823944, -0.015666469931602478, 5.473499550134875e-05, 0.0036090854555368423, 0.029947279021143913, 0.039901427924633026, 0.009247176349163055, -0.030852200463414192, -0.0014554759254679084, -0.025337830185890198, -0.03670591861009598, 0.028123294934630394, -0.020304199308156967, -0.024715695530176163, 0.015906840562820435, -0.04660350829362869, -0.014634293504059315, 0.05477609112858772, 0.0431252121925354, -0.030428018420934677, -0.054012563079595566, -0.021986788138747215, -0.02678005024790764, -0.025776151567697525, -0.002257003914564848, 0.012174035422503948, 0.028900962322950363, -0.032577209174633026, -0.015411960892379284, -0.004913446493446827, -0.016613811254501343, -0.02620033361017704, 0.009713777340948582, -0.01493122149258852, 0.017009714618325233, -0.0008435043855570257, -0.04094774276018143, 0.020926332101225853, 0.04697113484144211, 0.011544831097126007, -0.011155997402966022, -0.054069120436906815, 0.04680145904421806, -0.02717595361173153, 0.006776314228773117, -0.00032874138560146093, 0.05528510734438896, -0.010017774999141693, -0.019710343331098557, 0.01323449146002531, 0.005751206539571285, 0.0019653786439448595, -0.007486819755285978, -0.021859534084796906, -0.019130626693367958, 0.018197426572442055, -0.0024319791700690985, -0.05163713917136192, 0.015708889812231064, -0.04275758937001228, -0.03384975716471672, 0.0005015073111280799, 0.0268507469445467, 0.007868584245443344, 0.04117397218942642, 0.006999009754508734, 0.05630314722657204, -0.023344172164797783, 0.02071424201130867, 0.006062273867428303, 0.04462398961186409, 0.027034560218453407, 0.04340800270438194, 0.03220958635210991, -0.021463630720973015, 0.021675720810890198, 0.015525076538324356, -0.03356697037816048, 0.07069706916809082, -0.017221806570887566, 0.007628213614225388, 0.00839174259454012, 0.00691063841804862, 0.021392934024333954, 0.010625769384205341, -0.008773506619036198, 0.03814813867211342, -0.042305126786231995, -0.017264224588871002, 0.0020130991470068693, 0.0183670986443758, 0.007087381090968847, 0.04156987741589546, -0.014316156506538391, -0.029098913073539734, 0.004987678490579128, 0.010074332356452942, 0.019978992640972137, -0.024729834869503975, -0.0018876118119806051, 0.006790453568100929, -0.003944896627217531, -0.018268123269081116, 0.0014386853436008096, -0.02359868213534355, 0.04408669099211693, 0.0016039398033171892, 0.004878097679466009, -0.014634293504059315, 0.01966792531311512, 0.003881269134581089, -0.04821540042757988, -0.036225177347660065, -0.09829720854759216, -0.0031707636080682278, -0.043210048228502274, 0.015864422544836998, -0.006087017711251974, 0.010406608693301678, -0.003976710140705109, -0.019583087414503098, -0.013213282451033592, -0.0025468620005995035, -0.03416082262992859, -0.02129395678639412, -0.01006019301712513, 0.05194820836186409, 0.009636010974645615, 0.005857252050191164, -0.028717149049043655, 0.019710343331098557, -0.026426564902067184, 0.04363423213362694, -0.00341290095821023, -0.01645827852189541, 0.02625689096748829, 0.020148664712905884, -0.04202233999967575, -0.030739085748791695, 0.0014360342174768448, -0.032379258424043655, 0.024263234809041023, -0.0033916919492185116, -0.016288604587316513, 0.018324680626392365, -0.0066879428923130035, 0.019568948075175285, 0.0030205321963876486, -0.013828346505761147, 0.038119859993457794, 0.010152099654078484, 0.02208576537668705, 0.02248166874051094, 0.006217807065695524, 0.027359766885638237, 0.0463772788643837, -0.033086229115724564, 0.007218170911073685, 0.050986725836992264, -0.012683054432272911, 0.011912456713616848, -0.0017214736435562372, 0.030682528391480446, -0.023570403456687927, 0.0004944376414641738, -0.002357747172936797, -0.019809318706393242, 0.00010107471462106332, -0.0012371987104415894, -0.019116487354040146, -0.029098913073539734, 0.0028261153493076563, 0.030852200463414192, 0.03498091176152229, -0.02215646207332611, 0.01333346776664257, 0.027331486344337463, -0.032181307673454285, 0.008455369621515274, -0.0036302944645285606, -0.035914111882448196, -0.003149554366245866, 0.01763184927403927, -0.012824448756873608, 0.020219361409544945, -0.030145229771733284, 0.01816914603114128, 0.0007542493403889239, -0.0023930957540869713, -0.027034560218453407, -0.03744116798043251, 0.047932613641023636, -0.024291513487696648, 0.005030096508562565, 0.02091219276189804, 0.0004732285160571337, -0.006716221570968628, -0.017985334619879723, -0.006578362546861172, -0.02822227030992508, -0.03710182383656502, -0.04134364798665047, -0.017872219905257225, -0.006864685565233231, 0.029551375657320023, -0.02226957678794861, -0.039166174829006195, -0.005616882350295782, -0.011997292749583721, -0.005811299197375774, 0.001779798767529428, -0.00450693815946579, -0.00423121964558959, 0.004365543834865093, -0.019116487354040146, -0.028632313013076782, -0.05324903130531311, -0.02358454279601574, 0.011155997402966022, -0.0024143049959093332, 0.024447046220302582, 0.014450481161475182, 0.009501686319708824, -0.00940977968275547, -0.02089805342257023, -0.02724665030837059, 0.015355403535068035, 0.041202250868082047, 0.004807400517165661, -0.04411497339606285, 0.006585432216525078, -0.03130466118454933, 0.006818732246756554, 0.001935332315042615, 0.013587976805865765, -0.045189566910266876, -0.01751873455941677, 0.002336538163945079, -0.0077271899208426476, 0.013489000499248505, 0.004559961147606373, 0.0068611507304012775, 0.0033987616188824177, 0.016840042546391487, -0.008349323645234108, 0.012951702810823917, -0.04377562552690506, -0.006405154708772898, -0.013998019509017467, 0.0061188312247395515, 0.02717595361173153, 0.016415860503911972, 0.014026298187673092, 0.05271173641085625, 0.030937038362026215, -0.014945360831916332, -0.04456743225455284, -0.025309551507234573, 0.005659300368279219, -0.013778858818113804, -0.01009554136544466, 0.005581533536314964, 0.019102348014712334, -0.044001854956150055, -0.027020420879125595, 0.023471428081393242, -0.01678348518908024, 0.0023966305889189243, -0.03130466118454933, -0.01874886266887188, -0.011643807403743267, -0.021859534084796906, 0.024333931505680084, -0.01009554136544466, -0.030286625027656555, 0.001852263230830431, -0.012767890468239784, 0.008179650641977787, 0.01218817476183176, -0.035914111882448196, -0.018282262608408928, 0.021067727357149124, 0.0011921293335035443, 0.05011008307337761, -0.017334921285510063, -0.08545862138271332, -0.005836043041199446, -0.008674530312418938, 0.0033810874447226524, 0.011078231036663055, -0.040212493389844894, -0.03280343860387802, -0.03814813867211342, 0.03908133879303932, 0.04770638421177864, -0.03336901590228081, -0.006217807065695524, 0.018918536603450775, -0.022594783455133438, 0.03379319980740547, 0.01382127683609724, 0.010802512057125568, 0.02013452537357807, 0.014620154164731503, 0.0053482335060834885, -0.011148927733302116, -0.0204597320407629, -0.013941462151706219, -0.03500919044017792, 0.014344435185194016, -0.022029206156730652, 0.004524612333625555, -0.04369078949093819, -0.001689660013653338, -0.02666693553328514, 0.004701355006545782, 0.025337830185890198, 0.025168156251311302, 0.004446845501661301, -0.03879855200648308, -0.010604560375213623, 0.016500696539878845, -0.005662835203111172, 0.043153490871191025, 0.006444037891924381, 0.016034094616770744, 0.021336374804377556, -0.003078857436776161, -0.011445855721831322, -0.011686225421726704, -0.00878764595836401, -0.017235945910215378, -0.004291312303394079, 0.04267274960875511, 0.0050088874995708466, 0.01743389666080475, -0.021802976727485657, 0.013503140769898891, -0.00839174259454012, 0.011028743349015713, 0.03229442238807678, -0.024121839553117752, -0.0050018178299069405, 0.0050018178299069405, -0.019441694021224976, 0.007705980446189642, 0.017349060624837875, 0.015143312513828278, -0.017278363928198814, -0.0011885944986715913, 0.001686125062406063, -0.006740965414792299, -0.043351441621780396, -0.004733168985694647, 0.03110671043395996, -0.005903205368667841, -0.0057724155485630035, 0.01397681050002575, 0.006956591736525297, 0.02834952436387539, 0.07646594941616058, -0.017264224588871002, 0.007918071933090687, -0.028476780280470848, -0.006938917562365532, 0.0027536507695913315, -0.02966449037194252, -0.01333346776664257, 0.007253519259393215, -0.014902941882610321, -0.018451934680342674, 0.014591875486075878, 0.007882723584771156, -0.009826892986893654, -0.00341290095821023, -0.03404770791530609, -0.004036802798509598, -0.00774132926017046, -0.01375058013945818, 0.0016127768903970718, 0.013029470108449459, 0.01522814854979515, -0.040353886783123016, -0.12386126816272736, -0.052655179053545, 0.02573373354971409, -0.011785201728343964, 0.016161350533366203, -0.013347607105970383, 0.0484699122607708, 0.02287757210433483, -0.023103801533579826, -0.020106246694922447, 0.016684507951140404, -0.034273941069841385, 0.00029582306160591543, -0.013891974464058876, 0.004252428654581308, -0.05664249137043953, -0.01323449146002531, 0.011785201728343964, 0.008278626948595047, -0.036423131823539734, -0.023796632885932922, -0.02123739942908287, -0.02109600603580475, 0.012987052090466022, -0.03096531704068184, 0.0023665844928473234, 0.011735714040696621, -0.007112125400453806, -0.015906840562820435, 0.004273637663573027, -0.011940735392272472, -0.0013600349193438888, 0.03291655704379082, -0.0038635949604213238, -0.05076049640774727, -0.03820469602942467, -0.008405881933867931, -0.01013088971376419, -0.012753751128911972, 0.010887349024415016, 0.045500632375478745, -0.024093560874462128, 0.04247479885816574, -0.00459177466109395, 0.02260892279446125, -0.06283555924892426, -0.010484375059604645, -0.01532712485641241, -0.013531419448554516, -0.017957055941224098, 0.007508028764277697, -0.05409739911556244, 0.027543578296899796, -0.024842949584126472, -0.025959964841604233, 0.015723029151558876, -0.002423142082989216, 0.007126264739781618, -0.0204597320407629, -0.028109155595302582, -0.014761548489332199, 0.04651867225766182, 0.015199869871139526, -0.01146706473082304, -0.02405114285647869, 0.006970731075853109, -0.012174035422503948, 0.00587846152484417, -0.03614034131169319, -0.028109155595302582, -0.030032115057110786, 0.016698647290468216, 0.017009714618325233, 0.007812026422470808, -0.010434887371957302, 0.009918798692524433, 0.022707898169755936, 0.01613307185471058, -0.06600278615951538, 0.02300482615828514, 0.043351441621780396, -0.026299310848116875, 0.044991616159677505, 0.033086229115724564, 0.020997028797864914, 0.02143535204231739, 0.024743974208831787, -0.015595773234963417, -0.0162744652479887, -0.0017258921870961785, 0.014309086836874485, -0.03319934383034706, 0.0013600349193438888, -0.01659967191517353, -0.014591875486075878, -0.042701032012701035, -0.024093560874462128, 0.013998019509017467, -0.0032556001096963882, -0.0023807238321751356, 0.00836346298456192, 0.015708889812231064, -0.030937038362026215, 0.005217443685978651, 0.03071080707013607, 0.022071626037359238, 0.017561152577400208, -0.000218939982005395, 0.03899650275707245, -0.0016118931816890836, -0.013418303802609444, 0.008943179622292519, -0.009996565990149975, 0.023358311504125595, -0.025903405621647835, 0.012591147795319557, 0.041852664202451706, 0.022764457389712334, 0.0009084573248401284, 0.020883914083242416, -0.02024764008820057, 0.04275758937001228, -0.01896095462143421, 0.04352111741900444, 0.005291675683110952, 0.003676247550174594, -0.0036196899600327015, 0.04965762048959732, -0.027416324242949486, -0.002827882766723633, 0.006408689543604851, 0.020883914083242416, -0.002704162849113345, 0.001942401984706521, 0.009459268301725388, 0.033086229115724564, 0.05220271646976471, -0.012661845423281193, -0.012690124101936817, 0.008900760672986507, 0.01310016680508852, 0.025040902197360992, 0.03611206263303757, 0.021477770060300827, -0.0073807742446660995, 0.031248105689883232, 0.0346415638923645, -0.033878035843372345, -0.0035578301176428795, 0.02405114285647869, -0.0032556001096963882, -0.011551900766789913, 0.01889025792479515, -0.003149554366245866, -0.0035578301176428795, 0.006231946870684624, 0.002530955011025071, -0.02581856958568096, 0.01022986602038145, -0.0010162703692913055, -0.006663199048489332, 0.03116326779127121, -0.028080876916646957, -0.037412889301776886, 0.031021874397993088, -0.030230067670345306, -0.0058183688670396805, 0.0001498998753959313, -6.683082028757781e-05, 0.011551900766789913, -0.02521057426929474, -0.025394387543201447, 0.024517742916941643, 0.004860423505306244, 0.023768354207277298, 0.039505522698163986, 0.008794715628027916, 0.02666693553328514, -0.018579190596938133, 0.021916091442108154, -0.0014563596341758966, 0.02300482615828514, 0.006603106390684843, -0.007960489951074123, 0.041202250868082047, -0.04473710432648659, 0.028250548988580704, 0.012258871458470821, 0.011587250046432018, 0.031530894339084625, 0.02118084207177162, 0.01842365600168705, -0.021124284714460373, 0.032039910554885864, 0.014026298187673092, -0.006588967051357031, 0.028109155595302582, 0.04900720715522766, 0.009042154997587204, -0.039166174829006195, -0.027741530910134315, 0.046688344329595566, 0.01816914603114128, -0.017023853957653046, -0.006097622215747833, 0.034132543951272964, 0.01659967191517353, -0.00373280537314713, -0.01771668531000614, 0.02921202965080738, -0.012025571428239346, 0.008978527970612049, -0.03291655704379082, 0.02136465534567833, -0.01900337263941765, -0.06215686351060867, -0.004171126987785101, 0.032690323889255524, -0.0036302944645285606, 0.002606954425573349, -0.009119922295212746, -0.016189629212021828, 0.005956228356808424, 0.001873472356237471, -0.018635747954249382, -0.03565960377454758, 0.052174437791109085, -0.004188801161944866, 0.009416849352419376, 0.02868887037038803, -0.05143918842077255, 0.01809844933450222, -0.015044336207211018, 0.0025079785846173763, 0.0009111085091717541, -0.025507502257823944, -0.01124083437025547, 0.0007370169623754919, 0.008116023615002632, -0.006412224378436804, 0.033680085092782974, 0.0036515037063509226, -0.013354676775634289, 0.000896527199074626, 0.009218897670507431, 0.004673076327890158, 0.04222029075026512, 0.01941341534256935, -0.007409052923321724, -0.009954147040843964, 0.010533863678574562, -0.0014678479637950659, -0.00705556757748127, -0.007925141602754593, 0.017617709934711456, -0.012463893741369247, 0.02033247798681259, 0.028137434273958206, 0.03226614370942116, 0.010654048062860966, -0.03953380137681961, 0.04029732942581177, -0.011311531066894531, -0.004909911658614874, -0.005242187529802322, -0.010753024369478226, 0.016161350533366203, 0.030484575778245926, 0.03232270106673241, -0.020813217386603355, -0.02690730430185795, 0.024941926822066307, -0.01329104881733656, 0.020106246694922447, 0.004920516163110733, 0.005885531194508076, 0.011148927733302116, 0.003108903532847762, 0.020007271319627762, -0.02024764008820057, -0.01594925858080387, 0.018706444650888443, -0.008342253975570202, 0.006850546225905418, 0.01143171638250351, -0.011148927733302116, -0.0009667824488133192, -0.0018823094433173537, 0.007642353419214487, 0.024602580815553665, 0.03526369854807854, 0.044058412313461304, -0.029749326407909393, 0.004121639300137758, 0.011665016412734985, -0.00878764595836401, 0.008370532654225826, 0.03450017049908638, 0.008123093284666538, -0.014690850861370564, 0.01205385010689497, 0.02026177942752838, 0.006627850234508514, -0.01196194440126419, 0.035320255905389786, 0.01730664260685444, 0.02006382867693901, -0.02287757210433483, -0.019158905372023582, -0.03240753710269928, -0.0018186820670962334, -0.026115497574210167, 0.011523622088134289, 0.015864422544836998, -0.022919990122318268, -0.008384672924876213, -0.0005492278723977506, -0.029042355716228485, -0.010753024369478226, 0.003271506866440177, 0.025592340156435966, -0.0003711596073117107, 0.02614377625286579, 0.010830790735781193, -0.022255437448620796, -0.02535196952521801, -0.007214636076241732, -0.008370532654225826, -0.021322235465049744, -0.004584704991430044, -0.016232047230005264, 0.007642353419214487, 0.0035012722946703434, -0.02235441282391548, -0.05983800068497658, 0.007458541076630354, -0.04332316294312477, 0.011997292749583721, -0.0325489304959774, -0.04880925640463829, 0.029947279021143913, -0.010668187402188778, 0.0023135615047067404, -0.01607651449739933, -0.032577209174633026, 0.025705454871058464, 0.01172864343971014, -0.0017665430204942822, 0.0073737045750021935, -0.015256427228450775, 0.08506271243095398, -0.012675984762609005, -0.03732805326581001, 0.013969740830361843, -0.01809844933450222, 0.030597692355513573, -0.01560991257429123, 0.002942765597254038, -0.023287614807486534, 0.008222069591283798, 0.0013043609214946628, 0.006249621044844389, -0.013298118487000465, 0.015341264195740223, 0.021336374804377556, 0.012315429747104645, -0.02515401691198349, 0.02450360357761383, 0.04422808811068535, 0.006401619873940945, 0.006200132891535759, -0.011452925391495228, -0.006136505864560604, 0.010774233378469944, 0.02972104772925377, 0.014068717136979103, -0.019837597385048866, -0.016189629212021828, 0.013093097135424614, 0.029494818300008774, -0.010795442387461662, -0.042078897356987, -0.03953380137681961, -0.017235945910215378, -0.036819033324718475, -0.003944896627217531, -0.013432443141937256, 0.05078877508640289, 0.0022552364971488714, -0.0024143049959093332, -0.007705980446189642, -0.014521177858114243, 0.004584704991430044, 0.0019812854006886482, 0.010682327672839165, 0.026949722319841385, 0.01283858809620142, -0.004694285336881876, 0.00359317846596241, 0.027076978236436844, 0.02340072952210903, -0.018734723329544067, -0.0009712009923532605, -0.01397681050002575, -0.002398398006334901, -0.0029374633450061083, -0.004132243804633617, 0.026030661538243294, 0.02215646207332611, 0.004298381973057985, -0.02634172886610031, 0.015312985517084599, -0.030852200463414192, 0.010505584999918938, 0.011163067072629929, -0.01582200452685356, 0.0019477042369544506, 0.004666006658226252, -0.008045326918363571, 0.03973175212740898, -0.030088672414422035, 0.013510210439562798, -0.0006773662753403187, -0.03670591861009598, -0.00019828318909276277, -0.005160885863006115, -0.02331589348614216, -0.0014625455951318145, 0.03376492112874985, 0.0076706320978701115, 0.02111014537513256, -0.0065076653845608234, -0.001921192859299481, -0.004369079135358334, -0.022750316187739372, -0.005026561673730612, 0.001059572328813374, 0.013142584823071957, -0.026822468265891075, 0.02477225288748741, -0.01179227139800787, 0.022396830841898918, 0.043096933513879776, -0.014450481161475182, -0.010251075029373169, -0.006829336751252413, -0.01032177172601223, 0.016429999843239784, 0.006387480068951845, 0.013192073442041874, 0.0003466365742497146, -0.010477305389940739, -0.006281434558331966, 0.025663036853075027, 0.001963611226528883, -0.007960489951074123, -0.03653624653816223, -0.005549720022827387, 0.010533863678574562, -0.0029074170161038637, 0.02012038603425026, -0.006249621044844389, 0.017023853957653046, 0.037865351885557175, -0.004273637663573027, 0.03888338804244995, 0.00908457301557064, 0.05228755250573158, 0.018324680626392365, -0.0015031964285299182, -0.010067262686789036, 0.016712786629796028, 0.0008766436367295682, 0.028646452352404594, 0.0030488111078739166, 0.025860987603664398, -0.01369402278214693, -0.012096269056200981, -0.012527520768344402, 0.035772718489170074, -0.02802431769669056, 0.005040701013058424, 0.012718402780592442, -0.023273475468158722, 0.0013547325506806374, 0.022198880091309547, 0.009289595298469067, -0.04134364798665047, -0.020346617326140404, 0.002516815671697259, -0.004899307154119015, 0.015185730531811714, -0.02567717619240284, 0.014125274494290352, -0.01972448267042637, -0.01804189197719097, 0.012760820798575878, -0.04671662300825119, 0.02226957678794861, 0.014563596807420254, 0.002949835266917944, 0.0011647342471405864, -0.00872401800006628, 0.021025309339165688, -0.009155270643532276, 0.002451420994475484, 0.006557153072208166, -0.019766900688409805, -0.017759103327989578, 0.012011432088911533, 0.025648897513747215, -0.014761548489332199, 0.00025782338343560696, 0.03605550527572632, 0.006185993552207947, -0.0066879428923130035, -0.021548466756939888, -0.0242349561303854, 0.0028402546886354685, 0.0027748600114136934, -0.034924350678920746, 0.0015535680577158928, 0.022326134145259857, -0.005959763191640377, -0.0378936305642128, -0.01251338142901659, -0.009268386289477348, 0.012329569086432457, -0.014252529479563236, 0.012456824071705341, -0.00914820097386837, 0.01889025792479515, 0.024447046220302582, 0.010950976051390171, 0.0037964326329529285, 0.01505847554653883, 0.02352798543870449, 0.0050124223344028, 0.009105782955884933, 0.00914820097386837, -0.011997292749583721, -0.01388490479439497, 0.009169409982860088, 0.0123790567740798, 0.0021173772402107716, 0.05350354313850403, 0.006157714873552322, -0.02477225288748741, 0.022396830841898918, -0.015581633895635605, -0.02248166874051094, -0.012640636414289474, 0.007303007412701845, 0.013906113803386688, -0.010201587341725826, -0.011417577043175697, -0.0001273651869269088, -0.021930230781435966, 0.020615264773368835, -0.010137959383428097, 0.022509947419166565, 0.0068116625770926476, 0.013071888126432896, 0.0034235056955367327, -0.012654775753617287, 0.0049523296765983105, 0.007564586587250233, 0.01880542002618313, -0.03215302899479866, 0.003736340207979083, -0.008448299951851368, -0.0012698961654677987, 0.07476922124624252, -0.014450481161475182, 0.01091562770307064, 0.0009358524694107473, 0.012944633141160011, 0.02601652219891548, -0.0014704990899190307, 0.00723584508523345, 0.021675720810890198, -0.017688406631350517, -0.023301754146814346, -0.012039710767567158, 0.014047508127987385, 0.011580180376768112, 0.012301290407776833, -0.017730824649333954, 0.002173934830352664, 0.005804229527711868, -0.04872442036867142, 0.02528127282857895, -0.01313551515340805, -0.0076706320978701115, -0.025337830185890198, 0.052626900374889374, -0.01613307185471058, 0.024644998833537102, -0.047536708414554596, 0.00120538508053869, 0.004245358984917402, 0.0034712261985987425, -0.0215626060962677, -0.02921202965080738, 0.02351384609937668, -0.03919445723295212, -0.00928252562880516, -0.02417839877307415, -0.0015518006402999163, 0.030823921784758568, -0.03704526275396347, -0.018282262608408928, 0.007401983253657818, 0.006938917562365532, -0.020742520689964294, 0.01770254597067833, -0.02751529961824417, -0.008533135987818241, 0.0025645361747592688, -0.016514835879206657, -0.005853717215359211, 0.018268123269081116, -0.006055204197764397, -0.009565313346683979, 0.013679883442819118, 0.009904659353196621, 0.031332939863204956, -0.013609185814857483, 0.015341264195740223, -0.024291513487696648, 0.03902478143572807, -0.010166238993406296, -0.031530894339084625, -0.016627950593829155, 0.001700264518149197, 0.0442846454679966, -0.017151109874248505, -0.005747671704739332, -0.020558707416057587, -0.004174661822617054, -0.04363423213362694, 0.009692568331956863, 0.02665279619395733, -0.03339729458093643, 0.016627950593829155, 0.013474861159920692, 0.03056941367685795, -0.033227622509002686, -0.026624515652656555, 0.029890721663832664, -0.01532712485641241, -0.020502150058746338, 0.016500696539878845, 0.01548265852034092, 0.022368552163243294, 0.016104793176054955, -0.009720847010612488, 0.028957519680261612, 0.003462388878688216, -0.0005372977466322482, 0.02834952436387539, 0.01607651449739933, -0.013623325154185295, 0.03345385193824768, -0.0002489862381480634, 0.02887268364429474, -0.029523096978664398, 0.015652330592274666, -0.027812227606773376, 0.0007520400686189532, -0.025380248203873634, 0.007253519259393215, -0.011778132058680058, 0.015510937198996544, 0.06057325005531311, 0.0071015204302966595, 0.0064652469009160995, 0.00950875598937273, 0.009890520013868809, -0.02228371612727642, 0.02149190939962864, 0.01658553257584572, 0.02750116027891636, 0.05715151131153107, -0.007599934935569763, 0.03167228773236275, -0.021916091442108154, 0.005613347515463829, 0.00856141559779644, -0.016302743926644325, -0.029438259080052376, 0.01679762452840805, 0.0021332839969545603, 0.033425573259592056, -0.015030196867883205, 0.016698647290468216, 0.012329569086432457, 0.018268123269081116, -0.007578725926578045, 0.0194699726998806, 0.03495263308286667, 0.03127638250589371, -0.013503140769898891, -0.0007918071933090687, 0.017207667231559753, -0.010894418694078922, -0.00454228650778532, -0.012315429747104645, -0.008985597640275955, -0.010625769384205341, -0.017858080565929413, -0.03311450779438019, 0.012520451098680496, 0.029098913073539734, -0.013086027465760708, -0.007394913583993912, 0.011976083740592003, -0.038657158613204956, 0.013022400438785553, -0.009126991964876652, -0.002804906340315938, 0.026285169646143913, 0.016910739243030548, 0.014443411491811275, -0.030852200463414192, -0.01264770608395338, 0.005623952019959688, -0.03546164929866791, 0.02809501625597477, -0.021124284714460373, 0.007486819755285978, -0.018466074019670486, -0.01790049858391285, -0.008420021273195744, -0.003299785777926445, 0.005850182380527258, 0.010583351366221905, 0.0356878824532032, -0.013962671160697937]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
"6.82 95.8%
DPO Iter.1 -3.22 -5.23 86.7%
DPO Iter.2 -3.27 -8.83 99.7%
DPO Iter.3 -3.26 -10.21 99.9%
DPO Iter.4 -2.96 -11.07 99.9%
Table 2. The impact of training data on DPO. We first train Llama-
2-7B on the Alpaca open-source dataset and obtain SFT (Alpaca) .
Then the SFT model is trained with DPO and PPO. DPO performs
poorly due to distribution mismatch and noises. These issues can
be resolved by (1) additional SFT on the preference dataset ( SFT
(Safe) ), (2) filtering out controversy and noisy preference pairs, and
(3) generating new responses and using a learned reward model to
label the preference data for iterative DPO training.
shown in Table 2, resolving the distribution shift issue essen-
tially increases the safety rate by 16.4%and the helpfulness
reward from −4.19to−1.62.
Sensitivity to Preference Data. There exist pairs
(x,y1,y2)in the SafeRLHF dataset where both y1andy2
have the same safety label. After filtering out the dual-
unsafe and dual-safe preference data in the dataset, the
trained model could obtain a much higher safety rate. How-
ever, filtering the dual-safe preference data would largely
hurt the performance of helpfulness. These results suggest
that while DPO may derive advantages from eliminating
noise or controversies in the training data, excessively dis-
carding high-quality data could be detrimental to DPO per-
formance.
Impact of Preference Data Distribution. While mitigating
the distribution shift can be done with additional SFT, we
also investigate whether collecting additional data with the
base model could bring benefit. Specifically, instead of us-
ing the existing preference data, we generate new responses
with SFT (Safe) and use a learned reward model for prefer-
ence labeling. We further repeat this process and iteratively
set the reference model as the latest DPO model in the last
iteration. We denote this method as DPO-Iter . Remarkably,
DPO-Iter achieves a comparable safety rate with PPO. This
experiment again demonstrates that DPO could be improved
by mitigating the distribution shift. However, it also obtains
a much lower helpfulness reward compared to PPO.
Practical Remark: The performance of DPO could be
improved by mitigating the distribution shift between the
model and the preference dataset. To alleviate the issue of
distribution shift and noisy data, we suggest adopting the
iterative DPO method. One should carefully annotate the
5
Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study
Task HH-RLHF APPS CodeContest
MetricOpenAssaint
RewardIntro.
pass@5Inter.
pass@5Comp.
pass@5pass@10 pass@100 pass@1k
SFT 0.532 38.6% 10.1% 3.9% 0.9% 4.3% 12.0%
baseline PPO 0.706 18.0% 2.4% 1.1% 4.3% 6.0% 7.7%
+ Adv.Norm. 0.716 38.1% 11.4% 4.6% 6.8% 9.4% 15.4%
+ Large.Batch. 0.716 42.3% 14.6% 7.5% 5.1% 12.8% 19.6%
+ Ref.EMA 0.718 44.4% 18.0% 9.1% 6.8% 13.7% 21.4%
Table 3. Ablation study of PPO on different tasks. Baseline PPO is trained with a batch size of 64. Specifically, for the HH-RLHF task,
the base model employed is Llama2-7B. In the case of APPS and CodeContest tasks, the base model utilized is CodeLlama-34B.
Figure 2. Performance of PPO on APPS dataset under different
batch sizes. The base LLM is CodeLlma-13B. “Introductory”,
“Interview” and “Competition” represent three levels of difficulty.
model-generated samples each time and then proceed to the
next round of training. However, we will demonstrate in
Sec. 6 that even with a","[0.03325941041111946, -0.010687317699193954, 0.0820259153842926, 0.012977457605302334, 0.017557736486196518, 0.009534764103591442, 0.0007713317172601819, 0.03325941041111946, -0.0035287607461214066, -0.006518665235489607, 0.03415750712156296, -0.00011424971307860687, -0.047778598964214325, 0.00038566585863009095, 0.01667460985481739, -0.028050467371940613, 0.043497681617736816, -0.040414225310087204, -0.021748840808868408, 0.04625183716416359, -0.02447305992245674, -0.00863667018711567, -0.007465405855327845, -0.01496074814349413, 0.020192144438624382, -0.04649132862687111, -0.00024510480579920113, -0.0002152852830477059, 0.03278042748570442, -0.05107161030173302, 0.03745051845908165, -0.032002080231904984, -0.02480236068367958, -0.027825944125652313, 0.02049151062965393, 0.02552083693444729, -0.008067877031862736, 0.048317454755306244, -0.018156465142965317, -0.013703417032957077, -0.006963970139622688, -0.06202835589647293, -0.02079087495803833, -0.02546096220612526, 0.005579408723860979, 0.03454668074846268, 0.060860831290483475, -0.012902616523206234, 0.03322947397828102, 0.02126985788345337, -0.035923756659030914, 0.07202713191509247, -0.0124086644500494, -0.0413123220205307, 0.0323912538588047, -0.026942817494273186, 0.02129979431629181, -0.0012554604327306151, 0.039336513727903366, -0.0334390327334404, -0.010051167570054531, -0.026149502024054527, 0.021913491189479828, -0.019443733617663383, 0.019234178587794304, -0.018470797687768936, -0.08825270086526871, -0.005164040252566338, 0.009504827670753002, 0.002559567801654339, -0.012049427255988121, 0.009018359705805779, 0.04717986658215523, 0.0013405922800302505, -0.01230388693511486, -0.019323987886309624, 0.03685178607702255, 0.01231137104332447, 0.004022712353616953, 0.004722477402538061, -0.0029206762555986643, 0.04738942161202431, -0.0002467419544700533, -0.047838471829891205, 0.011967102065682411, -0.0172434039413929, -0.04607221856713295, -0.026478802785277367, -0.04203079640865326, -0.036253057420253754, -0.03733077272772789, -0.02140457183122635, -0.004763639997690916, -0.007562699262052774, 0.04957478493452072, -0.05490347743034363, -0.00431459303945303, -0.006638410966843367, 0.013912972062826157, 0.03876772150397301, -0.028559386730194092, -0.02469758316874504, -0.017887037247419357, -0.022901395335793495, 0.02908327616751194, 0.002548341639339924, 0.02143450826406479, 0.030430415645241737, -0.0026418929919600487, 0.00838969461619854, -0.05071236938238144, 0.010896872729063034, -0.08597752451896667, 0.040204670280218124, -0.0005355820758268237, -0.030804622918367386, -0.031074050813913345, -0.017408054322004318, 0.026808103546500206, -0.01273796521127224, -0.047778598964214325, -0.005399789661169052, 0.0015669867862015963, -0.009901485405862331, 0.004561568610370159, -0.011794966645538807, 0.04140213131904602, -0.0829240083694458, 0.010792095214128494, -0.03715115413069725, 0.01698894426226616, 0.022946299985051155, 0.022991204634308815, -0.03337915614247322, -0.05316716060042381, 0.03227150812745094, -0.02138960361480713, 0.01659976877272129, -0.02923295833170414, -0.006907839328050613, -0.03296004608273506, -0.04143206775188446, -0.035624392330646515, 0.04493463411927223, -0.04685056582093239, -0.03766007348895073, -0.011884776875376701, -0.005654249805957079, -0.02167399972677231, 0.07651760429143906, -0.035804010927677155, -0.00432956125587225, -0.013276821933686733, 0.026733262464404106, -0.02138960361480713, -0.015125398524105549, 0.00045395843335427344, 0.02088068425655365, -4.092876042705029e-05, -0.015162819065153599, -0.015626834705471992, 0.01616569049656391, -0.02908327616751194, 0.00860673375427723, 0.031343478709459305, 0.04158174991607666, -0.035055600106716156, 0.007162299007177353, -0.10094575583934784, -0.03849829360842705, 0.018994687125086784, 0.01631537266075611, -0.034905917942523956, -0.048257581889629364, -0.011473149992525578, -0.018560608848929405, -0.03469636291265488, 0.005388563498854637, -0.030984241515398026, -0.035235218703746796, -0.00029211441869847476, 0.0295023862272501, -0.005309980362653732, 0.019398828968405724, 0.0014397568302229047, -0.02162909507751465, 0.01643511839210987, 0.0028233828488737345, -0.001353689469397068, 0.02098546177148819, 0.027361929416656494, 0.028574354946613312, 0.0578073114156723, -0.015065525658428669, -0.020192144438624382, -0.04984421283006668, 0.06520161777734756, 0.043856918811798096, -0.04167155921459198, 0.012124268338084221, 0.008958486840128899, 0.0031264894641935825, -0.007158556953072548, -0.0497843399643898, -0.0037757365498691797, -0.035115472972393036, -0.03861803933978081, -0.001377077423967421, -0.017812196165323257, -0.04427603259682655, 0.02456286922097206, 0.03703140839934349, 0.060950640588998795, 0.02107527107000351, -0.009706898592412472, -0.01715359464287758, -0.07166789472103119, 0.026523707434535027, 0.030535193160176277, 0.0494849756360054, 0.01247602142393589, -0.003530631773173809, 0.017752323299646378, 0.022182920947670937, -0.0006076166755519807, -0.005429726094007492, 0.023589933291077614, -0.021988332271575928, 0.018725259229540825, -0.06609971076250076, 0.015155334956943989, 0.009557216428220272, 0.010851968079805374, 0.011054039932787418, 0.015432247892022133, -0.03691165894269943, -0.01487842295318842, -0.027840912342071533, 0.0014322727220132947, -0.015911230817437172, 0.005755285266786814, 0.028559386730194092, 0.04954484850168228, -0.031493160873651505, 0.005751543212682009, 0.007581409532576799, -0.028230085968971252, -0.04460533335804939, -0.007775996811687946, -0.02025201916694641, 0.010597508400678635, -0.03325941041111946, -0.010328080505132675, -0.06256721168756485, -0.05879521742463112, 0.0014949522446841002, 0.001334979198873043, -0.0019290309865027666, -0.011832387186586857, 0.01250595785677433, -0.03331928327679634, 0.017902005463838577, 0.01680932566523552, 0.02053641527891159, -0.026074660941958427, 0.008314852602779865, 0.0036410226020962, 0.015342437662184238, -0.0408632755279541, -0.013778258115053177, -0.009519795887172222, 0.025730391964316368, -0.0034277252852916718, 0.033888079226017, -0.022991204634308815, -0.017482895404100418, 0.017632577568292618, 0.03296004608273506, -0.030086146667599678, -0.03310972824692726, -0.004655120428651571, 0.012962489388883114, 0.03712121769785881, -0.010537635535001755, 0.04936522990465164, 0.015596898272633553, -0.01249098964035511, 0.01234130747616291, -0.0012629445409402251, 0.015035589225590229, 0.0026138275861740112, -0.04553336277604103, 0.03637280315160751, -0.006556085776537657, 0.00746166380122304, 0.01237124390900135, 0.008135234005749226, -0.035744138062000275, 0.0028196407947689295, -0.007450437638908625, 0.02882881462574005, 0.013531281612813473, -0.013853099197149277, -0.004947000648826361, 0.04499450698494911, -0.030295701697468758, 0.02115011215209961, 0.0008602056186646223, -0.01224401406943798, -0.01688416674733162, -0.02092558890581131, 0.04574291780591011, 0.0033453998621553183, 0.02118004858493805, -0.01700391247868538, -0.011428245343267918, 0.07238636910915375, -0.040025051683187485, 0.00047945117694325745, -0.03251099959015846, -0.03745051845908165, -0.04879643768072128, -0.009826644323766232, -0.0002460403193254024, 0.009347661398351192, -0.01244608499109745, -0.024173695594072342, 0.010111040435731411, -0.027317024767398834, -0.04313844442367554, -0.005579408723860979, 0.00017096527153626084, -0.013231917284429073, 0.02143450826406479, -0.0248173289000988, -0.026912881061434746, -0.007184751331806183, 0.04586266353726387, 0.056699663400650024, 0.07951124757528305, -0.09262342005968094, -0.006238010711967945, -0.027212245389819145, 0.017467927187681198, -0.01485597062855959, 0.005444694310426712, -0.008247495628893375, 0.0296520683914423, 0.03673204034566879, 0.01728830859065056, -0.00032017985358834267, 0.004340787418186665, 0.02891862392425537, 0.031223732978105545, 0.0003045099729206413, 0.019323987886309624, 0.015222691930830479, -0.04867669194936752, -0.018964750692248344, 0.019758066162467003, 0.011922197416424751, 0.02933773584663868, -0.022512221708893776, 0.04313844442367554, 0.028095372021198273, 0.039336513727903366, -0.03263074532151222, -0.03397788852453232, 0.0025034367572516203, -0.03664223104715347, 0.008067877031862736, 0.02966703660786152, 0.0012760418467223644, 0.023709679022431374, -0.08052908629179001, 0.034965790808200836, 0.018291179090738297, 0.03646261245012283, -0.026388993486762047, 0.04601234570145607, -0.01728830859065056, -0.0011862324317917228, -0.03643267601728439, -0.01269306056201458, 0.0044044023379683495, 0.026448866352438927, -0.00045349064748734236, 0.006398919504135847, -0.03334921970963478, -0.030190924182534218, -0.0006305367569439113, 0.01221407763659954, 0.0017147981561720371, 0.01216917298734188, -0.07514052838087082, -0.003590504638850689, -0.023185791447758675, 0.06669843941926956, 0.021973364055156708, 0.05822642520070076, -0.025910010561347008, -0.0322415716946125, -0.07047043740749359, 0.004572794772684574, -0.08525905013084412, 0.01258079893887043, -0.005321206524968147, 0.0325409360229969, 0.01668957807123661, 0.0408632755279541, 0.02059628814458847, -0.027840912342071533, 0.03667216747999191, -0.023919235914945602, 0.025954915210604668, -0.023185791447758675, 0.005287528038024902, -0.0019814197439700365, 0.002806543605402112, 0.026867976412177086, 0.00029959852690808475, -0.03769000992178917, -0.011480634100735188, -0.019279083237051964, -0.01465389970690012, 0.02540108934044838, -0.008292400278151035, -0.021748840808868408, -0.008704027161002159, -0.03257087245583534, -0.020222080871462822, 0.05304741486907005, 0.06316594034433365, -0.015626834705471992, -0.06526149064302444, -0.036013565957546234, -0.019563479349017143, -0.00367095903493464, -0.010874420404434204, 0.0002063978899968788, 0.021853618323802948, -0.011143849231302738, -0.01463144738227129, -0.02460777387022972, -0.03263074532151222, -0.02556574158370495, -0.013703417032957077, 0.0011123267468065023, 0.008112781681120396, 0.0011001650709658861, -0.02962213195860386, 0.0003889401559717953, 0.051580529659986496, 0.022826554253697395, 0.00029983240528963506, -0.05313722416758537, 0.05741813778877258, -0.026074660941958427, 0.023081013932824135, -0.013606122694909573, 0.03807918354868889, -0.039156895130872726, -0.006571053992956877, 0.03310972824692726, 0.0029206762555986643, 0.013291790150105953, 0.0122589822858572, -0.022527189925312996, -0.002772865118458867, 0.008748931810259819, 0.008883645758032799, -0.0505327507853508, 0.017527800053358078, -0.027197277173399925, -0.035145409405231476, -0.0037439290899783373, 0.027227213606238365, -0.00041911049629561603, -0.007835869677364826, 0.013269337825477123, 0.04726967588067055, -0.028334863483905792, 0.02103036642074585, -1.2717150639218744e-05, 0.06783603131771088, 0.04643145576119423, 0.039755623787641525, 0.03789956495165825, -0.03834861144423485, 0.02073100209236145, 0.005429726094007492, -0.024158727377653122, 0.06328568607568741, -0.019204242154955864, 0.005137845873832703, 0.00033912400249391794, 0.014444343745708466, 0.005631797481328249, 0.012056911364197731, -0.008853709325194359, 0.03810911998152733, -0.02861925959587097, -0.008344789035618305, 0.006410145666450262, -0.0003889401559717953, 0.006507439073175192, 0.013733353465795517, -0.035534583032131195, -0.027571484446525574, -0.013344178907573223, 0.011570443399250507, 0.015477152541279793, 0.006473760586231947, -0.004168652463704348, -0.018366020172834396, 0.008045424707233906, -0.027242181822657585, -0.00013518185005523264, -0.022542158141732216, 0.03745051845908165, -0.01665964163839817, -0.011293531395494938, -0.02023705095052719, 0.013344178907573223, -0.005586892832070589, -0.04110276699066162, -0.04894611984491348, -0.09298265725374222, -0.005137845873832703, -0.026478802785277367, 0.011031587608158588, -0.010724738240242004, 0.006537375506013632, -0.015327469445765018, -0.028514482080936432, -0.018575577065348625, 0.007865806110203266, -0.02079087495803833, -0.02890365570783615, -0.01217665709555149, 0.05014357715845108, 0.00851692445576191, 0.015237660147249699, -0.0125583466142416, 0.018291179090738297, -0.01685423031449318, 0.027346961200237274, 0.008247495628893375, -0.009534764103591442, -0.00726707698777318, 0.02546096220612526, -0.02921799011528492, -0.019802970811724663, -0.010058651678264141, -0.019668256863951683, 0.009519795887172222, 5.276886440697126e-05, -0.022152984514832497, 0.011188753880560398, 0.005515793804079294, 0.022796617820858955, -0.00364850671030581, -0.02167399972677231, 0.02495204284787178, 0.00624175276607275, 0.04065372049808502, 0.023724647238850594, -0.019488638266921043, 0.028005562722682953, 0.04247984290122986, -0.024128790944814682, 0.01618065871298313, 0.027376897633075714, -0.052837859839200974, 0.0010178397642448545, -0.0017905747517943382, 0.030864495784044266, -0.0169440396130085, 0.03296004608273506, 0.014115042984485626, -0.0121841412037611, -0.008232527412474155, -0.01652492769062519, -0.009699414484202862, -0.04520406201481819, 0.00024720971123315394, 0.025984851643443108, 0.03346896916627884, -0.02911321260035038, 0.03825880214571953, 0.014227304607629776, -0.022302666679024696, 0.031403351575136185, -0.017542768269777298, -0.031403351575136185, 0.0012049427023157477, 0.006582280155271292, -0.019054559990763664, 0.012079363688826561, -0.02146444469690323, 0.02941257692873478, 0.0021404572762548923, 0.007970583625137806, -0.04484482482075691, -0.031852398067712784, 0.04074352979660034, -0.005306238308548927, 0.022138016298413277, 0.021793745458126068, 0.00736437039449811, 0.005672960076481104, -0.010874420404434204, -0.011009135283529758, -0.040174733847379684, -0.039426323026418686, -0.03233138099312782, -0.023485155776143074, -0.020102335140109062, 0.004774866160005331, -0.035265155136585236, -0.030535193160176277, -5.154100290383212e-05, -0.025954915210604668, -0.0068554505705833435, 0.005527019966393709, 0.004572794772684574, -0.00733443396165967, 0.00853189267218113, -0.034995727241039276, 6.531061080750078e-05, -0.06771628558635712, -0.0066982838325202465, 0.004961968865245581, -0.017722386866807938, 0.031612906605005264, 0.020087366923689842, 0.022871458902955055, 0.006170653738081455, -0.012850227765738964, 0.004520406015217304, 0.02891862392425537, 0.04631171002984047, 0.00857679732143879, -0.05382576212286949, 0.006556085776537657, -0.018665386363863945, 0.015147850848734379, -0.011547991074621677, 0.007173525169491768, -0.03655242174863815, -0.018845004960894585, -0.007065005600452423, -0.0030310670845210552, 0.0060172295197844505, 0.02038673311471939, 0.0002582019951660186, -0.02038673311471939, 0.011765030212700367, -0.010881904512643814, 0.015155334956943989, -0.04241997003555298, -0.02094055712223053, -0.009796707890927792, 0.005972324870526791, 0.017617609351873398, 0.02088068425655365, 0.00868157483637333, 0.05723851919174194, 0.027736134827136993, -0.007963099516928196, -0.018994687125086784, -0.01271551288664341, 0.023365410044789314, -0.009168041869997978, -0.009886517189443111, 0.01603097654879093, 0.005145329982042313, -0.044096413999795914, -0.025775296613574028, 0.026778167113661766, -0.0017877682112157345, 0.0018822551937773824, -0.05385569855570793, -0.04909580200910568, -0.0292778629809618, -0.022482285276055336, 0.022152984514832497, -0.013763289898633957, -0.012940037064254284, 0.017437990754842758, -0.00726707698777318, -0.0019215467618778348, 0.002400530269369483, -0.031972143799066544, 0.0042921407148242, 0.01454163808375597, 0.013089719228446484, 0.055681824684143066, -0.015566961839795113, -0.039695750921964645, -0.013665996491909027, -0.013246885500848293, 0.00010980601655319333, 0.004539116285741329, -0.060501594096422195, -0.030684875324368477, -0.022781649604439735, 0.05059262365102768, 0.05292766913771629, -0.01718353107571602, 0.008344789035618305, 0.026284215971827507, -0.040324416011571884, 0.017931941896677017, 0.01683926209807396, 0.02103036642074585, 0.019114432856440544, 0.013044814579188824, -0.0031339735724031925, -0.02472751960158348, -0.03834861144423485, -0.0015669867862015963, -0.0026493771001696587, 0.01492332760244608, -0.004101295489817858, -0.002336915349587798, -0.031433288007974625, -0.008831257000565529, -0.0146389314904809, 0.008120265789330006, 0.022063175216317177, 0.034846045076847076, -0.009385081939399242, -0.02966703660786152, -0.02442815527319908, 0.018051687628030777, -0.01473622489720583, 0.04972446709871292, -0.021763809025287628, 0.010313112288713455, 0.021883554756641388, -0.023859363049268723, -0.01613575406372547, -0.0029206762555986643, -0.010792095214128494, -0.022182920947670937, 0.01649499125778675, 0.051879893988370895, 0.008733963593840599, 0.008008004166185856, -0.03218169882893562, 0.015260112471878529, -0.0005248236702755094, 0.009287788532674313, 0.027870848774909973, -0.007031327113509178, -0.018904877826571465, 0.021958395838737488, -0.02906830795109272, -0.008157686330378056, 0.019413797184824944, 0.0075327628292143345, -0.009385081939399242, -0.0036541197914630175, -0.013067266903817654, 0.00029983240528963506, -0.04966459423303604, -0.01232633925974369, 0.0034277252852916718, -0.010021231137216091, -0.004550342448055744, 0.004696283023804426, 0.017737355083227158, 0.026044724509119987, 0.08370235562324524, -0.02896352857351303, 0.017797227948904037, 0.0018298664363101125, 0.004954484757035971, 0.021823681890964508, -0.031732652336359024, -0.02129979431629181, 0.004943258594721556, -0.008262463845312595, -0.010245755314826965, 0.009617089293897152, -0.009729350917041302, -0.010747190564870834, 0.02041666954755783, -0.015671739354729652, -0.006103296764194965, 0.01636027731001377, -0.01613575406372547, 0.004243494011461735, 0.00838221050798893, 0.021883554756641388, -0.031163860112428665, -0.13770774006843567, -0.06316594034433365, 0.027586452662944794, -0.009639541618525982, 0.005111651495099068, -0.019877811893820763, 0.05517290532588959, 0.039456259459257126, -0.026553643867373466, 0.00043618364725261927, 0.02558070980012417, -0.035953693091869354, 0.007652508560568094, -0.026748230680823326, 0.002089939545840025, -0.04149194061756134, 0.0031919756438583136, 0.017692450433969498, 0.009594636969268322, -0.030610034242272377, -0.026927849277853966, -0.004950742702931166, 0.01648002304136753, 0.007050037384033203, -0.04577285423874855, 0.007020100951194763, 0.0024697582703083754, 0.005968582816421986, -0.025999819859862328, 0.012880164198577404, -0.010724738240242004, 0.004924548324197531, 0.026778167113661766, -0.011533022858202457, -0.04164162278175354, -0.026523707434535027, -0.01704881712794304, 0.0019514833111315966, -0.0027859623078256845, 0.019024623557925224, 0.025895042344927788, -0.026568612083792686, 0.027736134827136993, -0.028125308454036713, 0.017452958971261978, -0.060711149126291275, -0.009729350917041302, -0.011697673238813877, -0.003090939950197935, -0.008008004166185856, 0.011458181776106358, -0.04747923091053963, 0.021943427622318268, -0.0034333383664488792, -0.002973065245896578, 0.018815068528056145, 0.005265075713396072, 0.0010636800434440374, 0.009841612540185452, -0.004056390840560198, 0.003727089846506715, 0.043527618050575256, -0.0017625093460083008, -0.017602641135454178, -0.024173695594072342, 0.005298754200339317, 0.0007830256363376975, 0.012760418467223644, -0.03293010964989662, -0.04328812658786774, -0.035594455897808075, 0.023140886798501015, 0.01707875356078148, 0.026194406673312187, 0.0025614388287067413, 0.013344178907573223, 0.02147941291332245, 0.02043163776397705, -0.06436339765787125, 0.023380378261208534, 0.04867669194936752, -0.02520650252699852, 0.030894432216882706, 0.02465267851948738, 0.034905917942523956, 0.01642015017569065, 0.03903714939951897, -0.024083886295557022, -0.009153073653578758, 0.0018682224908843637, 0.01260325126349926, -0.0060172295197844505, 0.0010992295574396849, 0.0075477310456335545, -0.02959219552576542, -0.02480236068367958, 0.0003021711891051382, 0.01655486412346363, 0.0026568612083792686, 0.008150202222168446, 0.013935424387454987, -0.0060022613033652306, -0.01489339116960764, -0.015477152541279793, 0.009534764103591442, 0.010634928941726685, 0.02513166144490242, 0.004471759311854839, 0.022751713171601295, -0.015125398524105549, -0.0015202111098915339, 0.01228891871869564, -0.007405532989650965, 0.04583272710442543, -0.02477242425084114, 0.0246676467359066, 0.05352639779448509, 0.01630040444433689, 0.005931161809712648, 0.02162909507751465, -0.004524148069322109, 0.035744138062000275, -0.019668256863951683, 0.048497073352336884, 0.014459311962127686, 0.0015697933267802, -0.009617089293897152, 0.06514174491167068, -0.015656771138310432, -0.006780609022825956, 0.02483229711651802, 0.020042462274432182, -0.02101539820432663, -0.0051902346312999725, 0.013187012635171413, 0.013868067413568497, 0.04942510277032852, -0.007790965028107166, -0.018889909610152245, 0.005968582816421986, 0.0127080287784338, 0.0331396646797657, 0.04268939793109894, 0.02110520750284195, -0.006926549598574638, 0.0245179645717144, 0.021748840808868408, -0.0299514327198267, -0.004172394517809153, 0.02152431756258011, 0.0043520135805010796, -0.01239369623363018, -0.00417987909168005, -0.01250595785677433, -0.009048296138644218, 0.01265564002096653, -0.0068367403000593185, -0.031403351575136185, 0.01710868999361992, -0.005759027320891619, 0.01219162531197071, 0.01730327680706978, -0.026239311322569847, -0.04927542060613632, 0.023859363049268723, -0.022422412410378456, -0.026957785710692406, 0.0060134874656796455, 0.00637646671384573, -0.005736574996262789, 0.0019131271401420236, -0.02564058266580105, 0.01633034087717533, 0.0025895042344927788, 0.03643267601728439, 0.017707418650388718, -0.0020749710965901613, 0.039366450160741806, -0.0124835055321455, 0.036193184554576874, -0.0030086147598922253, 0.014309629797935486, 0.03206195309758186, 0.010866936296224594, 0.02921799011528492, -0.02498197928071022, 0.03290017321705818, -0.005736574996262789, 0.022048206999897957, 0.044036541134119034, 0.005556956399232149, 0.03287023678421974, -0.010642413049936295, 0.05313722416758537, 0.007985551841557026, -0.009392566047608852, 0.001960838446393609, 0.03700147196650505, 0.006421371828764677, -0.04939516633749008, -0.018725259229540825, 0.05559201538562775, 0.007880774326622486, -0.0248173289000988, -0.010260723531246185, 0.05379582569003105, -0.0033921755384653807, -0.018575577065348625, -0.01658480055630207, 0.026823071762919426, -0.010777126997709274, 0.022063175216317177, -0.01604594476521015, 0.02131476253271103, -0.007240882143378258, -0.03658235818147659, -0.013164560310542583, 0.0323912538588047, 0.0022134273312985897, -0.00419484730809927, -0.0014388213166967034, -0.00618936400860548, -0.00862170197069645, 0.01272299699485302, 0.0009645154932513833, -0.026089629158377647, 0.03745051845908165, -0.019967621192336082, 0.0026606032624840736, 0.03352884203195572, -0.02550586685538292, 0.026239311322569847, -0.0025651808828115463, 0.0019056430319324136, -0.018845004960894585, -0.03376833349466324, -0.023500123992562294, 0.007637540344148874, 0.013359147123992443, -0.012094331905245781, 0.040174733847379684, 0.004183621145784855, -0.007330691907554865, 0.009579668752849102, 0.023634837940335274, 0.012004522606730461, 0.031523097306489944, 0.010575056076049805, -0.017497863620519638, -0.015312501229345798, 0.007648766506463289, -0.009602121077477932, -0.009647025726735592, -0.015866326168179512, 0.00305726146325469, -0.01252841018140316, -0.006630926858633757, 0.035354964435100555, 0.03700147196650505, 0.02050647884607315, -0.04334799945354462, 0.025715423747897148, 0.008052908815443516, 0.0020038720685988665, -0.008240011520683765, -0.0036260541528463364, 0.011705157347023487, 0.028185181319713593, 0.021958395838737488, -0.020177176222205162, -0.015357405878603458, 0.021868586540222168, -0.009901485405862331, 0.028424672782421112, 0.009542248211801052, 0.005074230954051018, 0.02115011215209961, 0.019189273938536644, 0.017797227948904037, -0.02887371927499771, 0.0034726299345493317, 0.013194496743381023, -0.0015183400828391314, -0.0020263243932276964, 0.005414757877588272, -0.014212336391210556, -0.014264725148677826, 0.015155334956943989, 0.019967621192336082, 0.0008517859387211502, 0.03700147196650505, 0.017408054322004318, -0.005998519249260426, 0.015701675787568092, 0.011510570533573627, 0.0036036018282175064, -0.0075327628292143345, 0.019338956102728844, 0.025954915210604668, -0.0347861722111702, 0.026763198897242546, 0.027346961200237274, 0.03846835717558861, -0.002722347155213356, 0.024188663810491562, 0.031463224440813065, 0.015641802921891212, -0.030041242018342018, -0.006653379183262587, -0.027885816991329193, 0.02475745603442192, -0.02505682036280632, 0.01653989590704441, 0.013082235120236874, -0.026164470240473747, 0.0028121566865593195, -0.008711511269211769, -0.03382820636034012, -0.008718995377421379, 0.004681314807385206, 0.0121841412037611, -0.004520406015217304, 0.018680354580283165, 0.0068704187870025635, -0.00730449752882123, -0.023245664313435555, -0.009287788532674313, -0.006223042495548725, -0.02104533463716507, -0.009205462411046028, 0.0003919805749319494, 0.009347661398351192, -0.010941777378320694, -0.014294661581516266, -0.04553336277604103, 0.02164406329393387, -0.048347391188144684, 0.0022508478723466396, -0.004849707242101431, -0.05337671563029289, 0.02968200482428074, 0.0074953422881662846, 0.0122589822858572, -0.006978938356041908, -0.015596898272633553, 0.031912270933389664, -0.001892545842565596, 0.0016025364166125655, -0.009370113722980022, -0.023589933291077614, 0.08364248275756836, -0.03700147196650505, -0.024203632026910782, 0.006193106062710285, -0.018366020172834396, 0.031822461634874344, -0.010747190564870834, -0.00632407795637846, -0.011533022858202457, 0.022167952731251717, 0.013014878146350384, 0.02100042998790741, -0.01646505482494831, 0.004052648786455393, 0.030654938891530037, -0.005362369120121002, -0.019548511132597923, 0.04442571476101875, 0.023350441828370094, -0.0007236204692162573, 0.01737811788916588, 0.023574965074658394, -0.003644764656201005, 0.0035923756659030914, 0.019084496423602104, -5.3317016863729805e-06, -0.02442815527319908, -0.011353404261171818, 0.01230388693511486, 0.02984665520489216, -0.011570443399250507, -0.04328812658786774, -0.017767291516065598, -0.015312501229345798, -0.0244431234896183, -0.010313112288713455, -0.028409704566001892, 0.03879765793681145, -0.00036906046443618834, -0.019623352214694023, 0.004116263706237078, 0.007918194867670536, -0.006746930535882711, 0.006993906572461128, -0.014317113906145096, 0.0122589822858572, 0.018575577065348625, 0.0003543261263985187, 0.010028715245425701, 0.01633034087717533, 0.03424731642007828, -0.00838221050798893, -0.002215298358350992, -0.001695152255706489, -0.013157076202332973, 0.009781739674508572, -0.010148461908102036, 0.023500123992562294, 0.02046157419681549, 0.0012769773602485657, -0.031852398067712784, 0.009669478051364422, -0.02876894176006317, 0.018979718908667564, -0.00039361772360280156, -0.013501345179975033, 0.0017531542107462883, -0.004752413835376501, -0.011577927507460117, 0.030654938891530037, -0.02460777387022972, 0.01634530909359455, -0.012116784229874611, -0.013606122694909573, 0.007323207799345255, -0.013927940279245377, -0.013860583305358887, 0.01489339116960764, 0.03727089986205101, 0.011690189130604267, 0.01496074814349413, 0.00839717872440815, -0.011562959291040897, -0.009123137220740318, -0.013800710439682007, -0.009257852099835873, 0.002089939545840025, 0.005983551032841206, -0.0343371257185936, 0.02891862392425537, -0.017916973680257797, 0.022661903873085976, 0.039785560220479965, -0.005833868402987719, -0.015215207822620869, -0.00868905894458294, -0.013336694799363613, 0.034636490046978, 0.01227395050227642, 0.010934293270111084, -0.000921481812838465, 7.1099100750871e-05, -0.027571484446525574, 0.03876772150397301, -0.010836999863386154, -0.013942908495664597, -0.02462274208664894, -0.005968582816421986, 0.0004649507172871381, -0.00309468200430274, 0.01272299699485302, 0.006608474534004927, 0.049185611307621, 0.03466642647981644, -0.0007919130148366094, 0.035025663673877716, 0.01234130747616291, 0.05436461791396141, 0.0033341736998409033, -0.01637524552643299, -0.005298754200339317, 0.0050368099473416805, 0.008299884386360645, 0.022557126358151436, 0.0029449996072798967, 0.02085074782371521, -0.023559996858239174, -0.01704881712794304, 0.0059087094850838184, 0.027571484446525574, -0.0290533397346735, -0.005152814090251923, 0.021913491189479828, -0.01261073537170887, 0.0067282202653586864, 0.018440861254930496, 0.00736437039449811, -0.030280733481049538, -0.007244624197483063, 0.003534373827278614, 0.00841963104903698, 0.02097049355506897, -0.018410924822092056, 0.007607603911310434, -0.022108079865574837, -0.02101539820432663, -0.0058974833227694035, -0.05032319575548172, 0.0334390327334404, 0.002699894830584526, -0.007012616842985153, -0.011869807727634907, -0.0173930861055851, 0.02070106565952301, 0.0007236204692162573, -0.005280043929815292, -0.005377337336540222, -0.019713161513209343, 0.00630910973995924, 0.023275600746273994, 0.0328403003513813, -0.009691930375993252, 0.0034950822591781616, 0.02447305992245674, 0.006765640806406736, -0.018635449931025505, -0.020192144438624382, -0.011787482537329197, 0.00609207060188055, 0.0027822202537208796, -0.017587672919034958, 0.001558567164465785, 0.02893359214067459, 0.0017727999947965145, -0.035923756659030914, -0.02864919602870941, -0.0328403003513813, 0.015656771138310432, -0.013127139769494534, 0.009415018372237682, -0.00867409072816372, 0.022272730246186256, 0.03637280315160751, 0.02960716374218464, 0.004774866160005331, 0.01452666986733675, 0.03206195309758186, 0.0029225472826510668, 0.010335564613342285, 0.004000260028988123, 0.008180138655006886, -0.0013115913607180119, 0.009444954805076122, 0.01228891871869564, -0.0068404823541641235, 0.03867791220545769, 0.007435469422489405, -0.014496732503175735, 0.023949172347784042, -0.017452958971261978, -0.02873900532722473, -0.0068292561918497086, 0.004486727528274059, 0.009123137220740318, -0.022602031007409096, -0.005957356654107571, 0.02082081139087677, -0.027526579797267914, 0.010597508400678635, -0.005729090888053179, 0.02135966718196869, 0.02471255138516426, 0.0027560258749872446, 0.00862170197069645, 0.0037701234687119722, 0.00014991620264481753, 0.0004686927713919431, 0.013770774006843567, -0.03730083629488945, 7.413952698698267e-05, -0.0021516834385693073, -0.01704881712794304, 0.06951247155666351, -0.02032686024904251, 0.011690189130604267, 0.022631967440247536, 0.0005627119680866599, 0.02465267851948738, 0.006342788226902485, 0.004168652463704348, 0.021958395838737488, -0.03855816647410393, -0.02525140717625618, -0.006110780872404575, -0.0035325028002262115, 0.005639281589537859, 0.013927940279245377, -0.009946390055119991, -0.0006146330269984901, 0.007731092162430286, -0.051700275391340256, 0.02023705095052719, -0.0060546500608325005, -0.012775386683642864, -0.02564058266580105, 0.05888502672314644, -0.019503606483340263, 0.034846045076847076, -0.028215117752552032, -0.004116263706237078, -0.003627925179898739, 0.005777737591415644, -0.028469577431678772, -0.031523097306489944, 0.02531128004193306, -0.03721102699637413, -0.015971103683114052, -0.006978938356041908, 0.0029337734449654818, 0.031912270933389664, -0.019144369289278984, -0.031253669410943985, -0.0012012006482109427, 0.003279913915321231, -0.013187012635171413, 0.022931331768631935, -0.01706378534436226, -0.01475867722183466, -0.02044660598039627, -0.008763900026679039, -0.0037645103875547647, 0.02073100209236145, 0.001038421061821282, -0.022691840305924416, -0.010754674673080444, 0.01217665709555149, 0.011592895723879337, 0.0027971884701400995, 0.013029846362769604, -0.03257087245583534, 0.03810911998152733, -0.020012525841593742, -0.021898522973060608, -0.0033622391056269407, -0.0021292311139404774, 0.04496457055211067, -0.004554084502160549, 0.009130621328949928, -0.026613516733050346, -0.004243494011461735, -0.009272820316255093, 0.010792095214128494, 0.022676872089505196, -0.0419110506772995, 0.010694801807403564, 0.023081013932824135, 0.028499513864517212, -0.020057430490851402, -0.030804622918367386, 0.011435729451477528, -0.005440952256321907, -0.005358627066016197, 0.005141587927937508, 0.02068609744310379, 0.02864919602870941, 0.011974586173892021, 0.0013172044418752193, 0.03391801565885544, 0.0037364449817687273, -0.005628055427223444, 0.02540108934044838, 0.030131051316857338, -0.02100042998790741, 0.027900785207748413, 0.019264115020632744, 0.04921554774045944, -0.04487476125359535, 0.014504216611385345, -0.01625549979507923, 0.010500214993953705, -0.028215117752552032, 0.011540506966412067, -0.01224401406943798, 0.03301991894841194, 0.018141496926546097, 0.019488638266921043, 0.011540506966412067, 0.004554084502160549, 0.002050647744908929, -0.03837854787707329, 0.03364858776330948, 0.021838650107383728, 0.043617427349090576, 0.048407264053821564, 0.006997648626565933, 0.039486195892095566, -0.013142107985913754, 0.006133233197033405, 0.013284306041896343, -0.028155244886875153, -0.031702715903520584, 0.018410924822092056, 0.015275080688297749, 0.012056911364197731, -0.013598638586699963, 0.009841612540185452, -0.011181269772350788, 0.003788833739235997, -0.0245928056538105, 0.010822031646966934, 0.019294051453471184, 0.040414225310087204, -0.015267596580088139, 0.010223302990198135, 0.02502688392996788, -0.010290659964084625, 0.019877811893820763, -0.02495204284787178, -0.011016619391739368, -0.027197277173399925, -0.017812196165323257, -0.03325941041111946, 0.005276301875710487, 0.029427545145154, -0.043767109513282776, 0.0015202111098915339, -0.011637800373136997, -0.028125308454036713, 0.01221407763659954, -0.0024809844326227903, 0.006133233197033405, 0.0425097793340683, 0.007596377748996019, 0.018934814259409904, -0.027781039476394653, -0.010006262920796871, 0.008748931810259819, -0.018380988389253616, 0.0428091436624527, -0.02110520750284195, 0.01615072228014469, -0.0043744659051299095, -0.008906098082661629, -0.018410924822092056, 0.006245494820177555, 0.008292400278151035, -0.006743188481777906, 0.035295091569423676, -0.011533022858202457]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
" nearly perfect annotator, the perfor-
mance of DPO remains unsatisfactory in challenging tasks
such as code generation.
5. Key Factors to PPO for RLHF
In this section, we investigate the key factors to the RLHF
performance of PPO. We find three key techniques: (1)
advantage normalization (Raffin et al., 2021), (2) large-
batch-size training (Yu et al., 2022), and (3) updating the
parameters of the reference model with exponential moving
average (Ouyang et al., 2022). The first two techniques
are widely adopted by the RL community but are not well-
studied in the field of RLHF. The third is a technique that has
received limited discussion in the literature, involving the
gradual update of the reference model through an exponen-
tial moving average (Ouyang et al., 2022). This particular
approach has the potential to yield additional performance
enhancements.
Implementation Details. Our PPO implementation is
based on DeepSpeed-Chat (Yao et al., 2023), except that (1)
we use a scalar reward for each response instead of dense
rewards assigned on each token and (2) we omit the auxil-iary SFT loss during PPO training because of the limited
amount of data. This implementation includes common
PPO techniques such as value loss clip and generalized ad-
vantage estimation (GAE) (Schulman et al., 2016). We list
experiment details in Appendix A.2.
Experimental Setup. Our ablation experiments for PPO are
carried out on a dialogue task HH-RLHF (Bai et al., 2022)
as well as two code generation tasks: APPS (Hendrycks
et al., 2021) and CodeContest (Li et al., 2022). HH-RLHF
is a preference dataset in the form defined in Section 3
that aims to train a helpful and harmless LLM. APPS and
CodeContest datasets are competitive programming datasets.
Given a problem, the LLM should output a piece of exe-
cutable code to solve this problem. The correctness is ver-
ified by test cases in the dataset, which can then generate
reward signals or preference pairs for PPO and DPO train-
ing, respectively. We remark that these two types of tasks
feature different types of reward signals: preference and
direct reward feedback. The complete experimental setup
is listed in Section 6. In the experiment result, we denote
advantage normalization as Adv. Norm. , large batch-size
training as LargeBatch and exponential moving average of
reference model update as Ref. EMA .
Analysis. The result of the ablation study is shown in Sec-
tion 4.3. In Section 4.3, with a small batch size, baseline
PPO improves over the SFT model on HH-RLHF and Code-
Contest dataset but shows significant performance degrada-
tion on the APPS dataset. Advantage normalization stabi-
lizes PPO training and improves the performance of PPO.
The most significant benefit is brought by using a large batch
size, especially on code generation tasks. Lastly, using the
exponential moving average for the reference model also
brings additional benefits. The intuition behind this is that
while the main LLM of PPO is rapidly changing, the refer-
ence model should also be updated accordingly. Otherwise,
the learned model may be strongly regularized to be close
to the SFT model, which can hurt performance in challeng-
ing tasks. Figure 2 further demonstrates that increasing the
batch size of PPO consistently improves the performance
across all difficulty levels in the APPS dataset. We also
6
Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study
OpenAssistant Tested V .S. Chosen Tested V .S. SFT
Reward Tested Win ↑Tie Chosen Win ↓ Tested Win ↑Tie SFT Win ↓
RRHF 0.523 28 33 39 29 37 34
PRO 0.529 37 26 37 34 33 33
DPO 0.611 55 21 24 53 31 16
DPO-Iter 0.678 55 18 27 54 33 13
PPO 0.718 57 21 22 58 29 13
Table 4. Results on the HH-RLHF test set. The evaluation metrics include the OpenAssistant rewards and the win rate of models against
the chosen responses and SFT model outputs. The OpenAssistant reward model is not used during the training process. Note","[-0.004383384715765715, 0.00931872520595789, 0.046278223395347595, 0.0006205016397871077, 0.03899528086185455, 0.004078734200447798, -0.013634011149406433, 0.028113877400755882, 0.012250538915395737, 0.002336849458515644, 0.046421587467193604, 0.022207237780094147, -0.051353342831134796, 0.012702139094471931, 0.024859491735696793, -0.027812810614705086, 0.006089428439736366, -0.0673242062330246, -0.015168016776442528, 0.03228579834103584, 0.005214902106672525, -0.011110787279903889, 0.014193135313689709, 0.012859840877354145, 0.028701672330498695, -0.026536861434578896, -0.012150184251368046, 0.0050715371035039425, 0.019870389252901077, -0.043353576213121414, 0.025103211402893066, -0.019253918901085854, -0.02607809379696846, -0.03529646247625351, 0.02097429893910885, 0.018895506858825684, -0.0018350720638409257, 0.03744693845510483, 0.005326009821146727, -0.0018547846702858806, -0.028156885877251625, -0.04329622909426689, -0.029189113527536392, -0.006548196543008089, -0.010272102430462837, 0.04378367215394974, 0.06279387325048447, -0.01223620306700468, 0.019770033657550812, 0.028156885877251625, -0.05410595238208771, 0.09897919744253159, -0.014250481501221657, -0.036500729620456696, 0.038651205599308014, -0.003806340740993619, 0.031769685447216034, -0.009046331979334354, 0.048055946826934814, -0.040256891399621964, -0.006376158446073532, -0.03997016325592995, 0.02282370813190937, -0.011275657452642918, -0.015626784414052963, -0.016343610361218452, -0.10184649378061295, 0.008816947229206562, 0.033375371247529984, 0.0026146192103624344, -0.0005819723010063171, 0.011383181437849998, 0.05723130702972412, -0.021949181333184242, -0.014444023370742798, -0.02858698181807995, 0.03042205236852169, 0.047912582755088806, 0.008207646198570728, -0.016802377998828888, -0.015698468312621117, 0.01041546743363142, 0.014422519132494926, -0.041002389043569565, 0.021074654534459114, -0.033432718366384506, -0.04705239459872246, -0.04249338433146477, -0.04323888570070267, -0.024142665788531303, -0.017519203945994377, -0.022909726947546005, -0.004602016415446997, -0.017160790041089058, 0.04596281796693802, -0.0426940955221653, -0.022207237780094147, -0.0052794162184000015, 0.028515297919511795, 0.043898362666368484, -0.0036253423895686865, -0.02678058296442032, -0.0008144924067892134, -0.00729011045768857, 0.03690215200185776, 0.03506707772612572, -0.002256206702440977, 0.026350487023591995, -0.005684422329068184, 0.0052507431246340275, -0.06577586382627487, 0.013820386491715908, -0.08527350425720215, 0.013110728934407234, -0.009827670641243458, -0.04217798262834549, -0.030651437118649483, 0.0027149748057127, 0.000694424204993993, -0.00044174341019243, -0.03317466005682945, 0.02682359144091606, 0.01060184184461832, 0.00706789456307888, -0.006411999464035034, 0.01495296973735094, 0.03400617837905884, -0.0641128271818161, 0.019870389252901077, -0.020587213337421417, 0.013268430717289448, 0.024400722235441208, -0.004218515008687973, -0.047539833933115005, -0.06973273307085037, 0.04042892903089523, -0.036644093692302704, 0.006598374340683222, -0.00959828682243824, -0.012558774091303349, -0.021590769290924072, -0.03007797710597515, -0.059123724699020386, 0.042808789759874344, -0.07248534262180328, -0.030852148309350014, -0.011519378051161766, -0.0423213467001915, -0.021261028945446014, 0.06302325427532196, -0.03564053773880005, 0.0006236377521418035, -0.011648406274616718, 0.012472755275666714, -0.022192902863025665, -0.016013870015740395, 0.0004466715909074992, 0.021088991314172745, -5.558193879551254e-05, -0.01574147678911686, 0.02787015587091446, 0.03228579834103584, -0.039597414433956146, 0.010121569037437439, 0.05092324689030647, 0.028759019449353218, -0.0358985960483551, 0.0030895157251507044, -0.08659245818853378, -0.02352619729936123, 0.0016047919634729624, -0.007275773677974939, -0.04690902680158615, -0.017691241577267647, -0.010551664046943188, -0.013426132500171661, -0.025289585813879967, 0.028300251811742783, -0.028027856722474098, -0.04613485559821129, -0.004175505600869656, 0.03472300246357918, -0.02225024811923504, 0.013892068527638912, -0.00995669886469841, -0.008867125026881695, 0.021418731659650803, 0.01040113065391779, 0.006336733233183622, 0.02009977400302887, 0.031941723078489304, 0.01936861127614975, 0.0609014518558979, 0.01899586245417595, -0.011712920852005482, -0.021060317754745483, 0.06870050728321075, 0.014630398713052273, -0.03933935612440109, -0.0011478160740807652, 0.03816376253962517, 0.01813567243516445, -0.016443965956568718, -0.05453604459762573, 0.002098505152389407, -0.01903887279331684, -0.020400838926434517, -0.015454746782779694, -0.01684538833796978, -0.013175243511795998, 0.027927502989768982, 0.012515764683485031, 0.06766828149557114, 0.002146890852600336, -0.03045072592794895, -0.008100122213363647, -0.05906638130545616, 0.03331802785396576, 0.03730357438325882, 0.03787703439593315, -0.0056306603364646435, 0.003297395072877407, 0.0064370883628726006, 0.016515647992491722, -0.011705752462148666, 0.02045818604528904, 0.02084527164697647, -0.019870389252901077, 0.02553330734372139, -0.06663605570793152, 0.01901019923388958, 0.011949473060667515, -0.009576781652867794, -0.015010315924882889, 0.02861565351486206, -0.039740778505802155, 0.009913689456880093, -0.03237181529402733, 0.01776292361319065, -0.032486509531736374, 0.018522758036851883, 0.0026307478547096252, 0.06273652613162994, -0.02374124340713024, -0.002571609802544117, 0.017490530386567116, -0.01972702331840992, -0.031941723078489304, 0.015669794753193855, -0.0351530984044075, 0.04358296096324921, -0.008587563410401344, -0.036816131323575974, -0.027640772983431816, -0.0430668443441391, 0.003967626485973597, 0.00824348721653223, -0.0006599270273000002, -0.01774858683347702, -0.00022893598361406475, -0.0387372225522995, 0.013010373339056969, 0.007497989572584629, 0.009712979197502136, -0.015340055339038372, -0.012386736460030079, -0.025117548182606697, 0.035583194345235825, -0.039568740874528885, 0.0031289411708712578, -0.007985430769622326, 0.022035200148820877, 0.009978204034268856, 0.031024185940623283, -0.01539740152657032, -0.04252205789089203, 0.004845737013965845, 0.02825724147260189, -0.031798355281353, -0.02101730927824974, 0.001989189302548766, 0.029475843533873558, 0.039941489696502686, 0.021060317754745483, 0.03174101188778877, 0.010193252004683018, -0.023655224591493607, 0.015354391187429428, 0.010264934040606022, 0.025805700570344925, -0.01664467714726925, -0.05379054695367813, 0.06032799184322357, -0.0336621031165123, 0.002302800305187702, 0.021045982837677002, 0.02589171938598156, -0.03199906647205353, 0.04017087444663048, 0.03136826306581497, 0.043009500950574875, 0.013985255733132362, -0.014379509724676609, 0.015325718559324741, 0.05499481409788132, -0.018193017691373825, 0.0132110845297575, -0.016257591545581818, -0.0033206918742507696, -0.034321580082178116, -0.002318928949534893, 0.047511160373687744, 0.00492817210033536, 0.03277323767542839, -0.024113992229104042, -0.023067427799105644, 0.07827728986740112, -0.05447870120406151, -0.002876260317862034, -0.031769685447216034, -0.049718983471393585, -0.036099307239055634, -0.015841832384467125, 0.0003122669004369527, 0.03804907202720642, -0.022379277274012566, 0.023497523739933968, 0.016372283920645714, -0.04260807856917381, -0.010609010234475136, 0.018078327178955078, -0.012078501284122467, -0.009526603855192661, 0.010465645231306553, -0.01240824069827795, -0.014823941513895988, -0.04278011620044708, 0.05212751403450966, 0.054966140538454056, 0.04885879158973694, -0.07042089104652405, -0.004451483488082886, -0.02824290469288826, -0.0012383152497932315, -0.02587738260626793, -0.0007168250158429146, 0.002352978102862835, 0.00997103564441204, 0.05066519230604172, 0.021504750475287437, -0.011949473060667515, -0.004691619426012039, 0.042636752128601074, 0.030880821868777275, 0.01330427173525095, 0.009017658419907093, -0.0032956029754132032, -0.037188880145549774, -0.007282942067831755, 0.011397517286241055, -0.026923947036266327, 0.029991958290338516, -0.033948831260204315, 0.018737806007266045, 0.017332827672362328, 0.03349006548523903, -0.031196223571896553, -0.018580103293061256, 0.017289819195866585, -0.020171456038951874, 0.006673640571534634, 0.039224665611982346, -0.0017024594126269221, 0.027941837906837463, -0.07357491552829742, 0.02936115302145481, 0.021074654534459114, 0.015454746782779694, -0.02913176827132702, 0.04042892903089523, -0.015182353556156158, 0.010917244479060173, -0.03635736554861069, -0.0224652960896492, 0.00119978585280478, 0.004379800986498594, 0.0012974533019587398, -0.011992482468485832, -0.040285564959049225, -0.015598111785948277, 0.0069532026536762714, 0.0008288288954645395, -0.039597414433956146, 0.02338283136487007, -0.02592039294540882, 0.0012392111821100116, -0.035411156713962555, 0.05069386586546898, 0.039540067315101624, 0.05086590349674225, -0.037045516073703766, -0.003806340740993619, -0.06399813294410706, -0.0132110845297575, -0.04911684989929199, 0.00895314384251833, -0.02894539386034012, 0.03827845677733421, 0.008021271787583828, 0.05918107181787491, 0.04472988098859787, -0.013540823943912983, 0.03274456784129143, -0.024845154955983162, 0.015655457973480225, -0.04656495153903961, 0.0058385394513607025, -0.014866950921714306, 0.024959847331047058, 0.046421587467193604, 0.005691590718924999, -0.047167085111141205, -0.009325893595814705, -0.051496706902980804, 8.579499262850732e-05, 0.01971268840134144, 0.007705868687480688, -0.019139228388667107, -0.003555451985448599, -0.022579988464713097, -0.03242916241288185, 0.05958249419927597, 0.06548913568258286, -0.03988414257764816, -0.05634244531393051, -0.03455096483230591, -0.023425841704010963, 0.016572993248701096, 0.0030052887741476297, -0.009189696982502937, 0.03925333544611931, -0.0005120818386785686, -0.0005013294867239892, -0.010343784466385841, -0.051152631640434265, -0.04441447556018829, -0.010164578445255756, -0.031253568828105927, 0.024916836991906166, 0.011712920852005482, -0.018967188894748688, 5.969808262307197e-05, 0.05579765886068344, 0.02047252282500267, -0.000821212655864656, -0.056428465992212296, 0.08108724653720856, -0.005322425626218319, 0.018006643280386925, 0.0029103094711899757, 0.031253568828105927, -0.044987935572862625, 0.00255727325566113, -0.017977971583604813, 0.016071217134594917, 0.016429629176855087, 0.009139519184827805, -0.021318376064300537, -0.011096451431512833, 0.02749740704894066, -0.008587563410401344, -0.03822110965847969, 0.01741884835064411, -0.017146453261375427, -0.04200594499707222, -0.013634011149406433, 0.02822856791317463, -0.013985255733132362, -0.010759543627500534, -0.012272044084966183, 0.027626436203718185, -0.04860073700547218, 0.012831167317926884, -0.005791945848613977, 0.043726325035095215, 0.04874410107731819, 0.04438580572605133, 0.013268430717289448, -0.04765452444553375, 0.012250538915395737, -0.0035285709891468287, -0.023096101358532906, 0.06330998241901398, -0.01740451157093048, 0.013361617922782898, -0.008809778839349747, 0.021490413695573807, 0.012422577477991581, -0.002636123914271593, -0.015024651773273945, 0.04521732032299042, -0.030307361856102943, 0.004960428923368454, 0.03311731666326523, 0.01989906281232834, 0.022006528452038765, 0.024486742913722992, -0.029289469122886658, -0.011132292449474335, 0.004197010304778814, 0.03191304951906204, 0.010809721425175667, 0.011096451431512833, -0.0007799952290952206, -0.015626784414052963, -0.009067836217582226, -0.029561862349510193, 0.0006330460892058909, -0.005358267109841108, 0.0258630458265543, 0.006046419031918049, 0.006139606237411499, -0.002288463758304715, 0.011884958483278751, 0.007411970756947994, -0.022579988464713097, -0.03225712478160858, -0.08607634902000427, -0.009211201220750809, -0.02063022367656231, 0.0005035695503465831, -0.0007383297779597342, 0.004154000896960497, -0.004469403997063637, -0.027941837906837463, -0.009196864441037178, -0.00016587779100518674, -0.015168016776442528, -0.04128912091255188, -0.02460143342614174, 0.031024185940623283, 0.012780989520251751, 0.028128212317824364, -0.023038756102323532, 0.014680576510727406, -0.009512268006801605, 0.04527466744184494, 0.020157119259238243, 0.005336761940270662, -0.015053325332701206, 0.021476076915860176, -0.03833580017089844, 0.005272247828543186, -0.027067312970757484, -0.0336621031165123, 0.003931785002350807, -0.002460501855239272, -0.030393380671739578, 0.01609988883137703, 0.008437030017375946, 0.016056880354881287, 0.010250597260892391, -0.02950451709330082, 0.014193135313689709, -0.009885016828775406, 0.039941489696502686, 0.010100063867866993, -0.010537327267229557, 0.022364940494298935, 0.04255073145031929, -0.027468733489513397, 0.007662859279662371, 0.043038174510002136, -0.023110438138246536, 0.007548167370259762, -0.014271985739469528, 0.028687337413430214, 0.012071332894265652, 0.0520988404750824, 0.022135555744171143, -0.005254327319562435, -0.01958365924656391, -0.019669678062200546, -0.013519319705665112, -0.025791363790631294, 0.0032758903689682484, 0.003266929881647229, 0.01701742596924305, -0.03693082556128502, 0.047511160373687744, 0.050263769924640656, -0.02699562907218933, 0.007842065766453743, -0.017433183267712593, -0.047167085111141205, -0.0027257271576672792, 0.002793825464323163, -0.025131884962320328, 0.011297161690890789, -0.029447171837091446, 0.02933247946202755, -0.0013198540546000004, 0.003964042291045189, -0.029963284730911255, -0.042292676866054535, 0.049260213971138, -0.016157235950231552, 0.007325951475650072, 0.015254036523401737, -0.012659129686653614, 0.0019372195238247514, -0.007139577064663172, -0.012429745867848396, -0.023984964936971664, -0.048801444470882416, -0.011082114651799202, -0.013469141907989979, 0.008895798586308956, 0.03572655841708183, -0.02389894612133503, -0.027755463495850563, 0.012766653671860695, -0.011505041271448135, -0.008221982978284359, 0.02098863571882248, 0.015010315924882889, -0.023053092882037163, 0.011999650858342648, -0.0027346874121576548, 0.018737806007266045, -0.04779789224267006, 0.011361676268279552, -0.002309968462213874, -0.014185966923832893, 0.028658663854002953, 0.01701742596924305, 0.022407948970794678, -0.015827495604753494, -0.003602045588195324, -0.01512500736862421, 0.02011410892009735, 0.023569205775856972, -0.004501660820096731, -0.029647883027791977, 0.0038923597894608974, -0.005397692322731018, 0.019684014841914177, -0.011447695083916187, 0.008881461806595325, -0.0376189760863781, -0.00850154459476471, -0.007483653258532286, 0.021633777767419815, 0.03059409186244011, 0.019884726032614708, -0.0004932652227580547, -0.0038887755945324898, 0.010530158877372742, -0.009734483435750008, -0.0054693748243153095, -0.037188880145549774, -0.02845795266330242, -0.018881170079112053, 0.010637682862579823, 0.016931407153606415, 0.0158991776406765, -0.005100209731608629, 0.0710516944527626, -0.004820648115128279, -0.020329156890511513, -0.04197727143764496, -0.032142434269189835, 0.036472056061029434, -0.005383355543017387, 0.0019658925011754036, 0.010838394053280354, 0.013691357336938381, -0.03311731666326523, -0.033059969544410706, -0.0007477380568161607, -0.0023583541624248028, 0.011906463652849197, -0.05164007470011711, -0.016042543575167656, -0.0347803495824337, -0.004279445391148329, 0.03535380959510803, -0.024859491735696793, 0.0029891603626310825, 0.006078675854951143, -0.005150387529283762, 0.014479865320026875, -0.01177743449807167, -0.04019954800605774, 0.011526546441018581, 0.009942363016307354, 0.014795267954468727, 0.058062825351953506, -0.011225479654967785, -0.057346001267433167, -0.018938517197966576, -0.005576898343861103, 0.022723352536559105, -0.016558658331632614, -0.063137948513031, -0.030909493565559387, -0.014193135313689709, 0.04019954800605774, 0.049919694662094116, -0.021777143701910973, -0.020357830449938774, 0.01883816160261631, -0.03174101188778877, 0.025762690231204033, 0.0045195817947387695, 0.024916836991906166, 0.0240709837526083, 0.01558377593755722, 0.00906066782772541, -0.0262357946485281, -0.03349006548523903, 0.0003976138832513243, 0.006508770864456892, 0.027741126716136932, -0.00019824691116809845, -0.009755988605320454, -0.021805817261338234, -0.012350894510746002, -0.028701672330498695, 0.03850783780217171, 0.02011410892009735, 0.007440643385052681, -0.013454805128276348, -0.042980827391147614, -0.0061933682300150394, 0.033948831260204315, -0.03822110965847969, 0.02569100819528103, -0.037762340158224106, 0.0016065840609371662, 0.026723235845565796, -0.035210445523262024, -0.01248709112405777, -0.00915385503321886, -0.02643650583922863, -0.02916044183075428, 0.03999883681535721, 0.052786994725465775, 0.011060609482228756, 0.015282709151506424, -0.028472289443016052, 0.014221807941794395, 0.0018028148915618658, 0.010988927446305752, 0.046421587467193604, 0.001577911083586514, -0.000727129343431443, 0.007186170667409897, -0.016874060034751892, 0.0004126223793718964, -0.006358237937092781, -0.011196806095540524, -0.0036522233858704567, 0.0007916436297819018, 0.0014291699044406414, 0.0018099831650033593, -0.014838277362287045, -0.04240736737847328, 0.016357947140932083, -0.005892301443964243, -0.0002795617619995028, -0.00018055029795505106, -0.014795267954468727, 0.024673117324709892, 0.06124552711844444, -0.01322542130947113, 0.03489504009485245, -0.0027579842135310173, -0.023296812549233437, 0.006207704544067383, -0.04295215383172035, -0.0532170869410038, -0.0008628781070001423, -0.01717512682080269, -0.007146745454519987, 0.009383238852024078, -0.006498018745332956, 0.0027436476666480303, 0.002087752800434828, -0.031253568828105927, 0.01060184184461832, 0.0011460239766165614, -0.020716242492198944, -0.00879544299095869, 0.021332712844014168, 0.047195758670568466, -0.021060317754745483, -0.11721522361040115, -0.03675878793001175, 0.030909493565559387, -0.012752316892147064, 0.005057200323790312, 0.0021056735422462225, 0.04533201456069946, 0.01539740152657032, -0.008028440177440643, 0.003078763373196125, 0.03529646247625351, -0.024200012907385826, 0.0020626639015972614, -0.027483070269227028, -0.004903083201497793, -0.037733666598796844, -0.006494434550404549, 0.008365347981452942, 0.017318492755293846, -0.04928888753056526, -0.015440410934388638, -0.015038988552987576, 0.023411504924297333, 0.0009506891365163028, -0.04593414440751076, 0.02405664697289467, -0.0043367911130189896, -0.007877906784415245, -0.014193135313689709, -0.016257591545581818, -0.016085553914308548, 0.01845107600092888, 0.01177743449807167, -0.014501369558274746, -0.04593414440751076, -0.029647883027791977, 0.0017929585883393884, -0.0021576432045549154, 0.009218369610607624, 0.01248709112405777, 0.03283058479428291, -0.03274456784129143, 0.03733224794268608, -0.014415350742638111, 0.03733224794268608, -0.051353342831134796, 0.00027194549329578876, -0.022909726947546005, 0.006394078955054283, 0.014866950921714306, 0.011368844658136368, -0.032887931913137436, 0.011239816434681416, 0.003428215626627207, -0.007229180075228214, 0.019483303651213646, -0.004530333913862705, 0.003046506317332387, 0.013999592512845993, -0.024171339347958565, -0.005573314614593983, 0.05138201639056206, 0.014200303703546524, -0.02573401667177677, -0.014415350742638111, 0.0025949066039174795, -0.005555393639951944, 0.008716591633856297, -0.0244437325745821, -0.030536744743585587, -0.012737980112433434, 0.01829337328672409, 0.022938400506973267, 0.018780814483761787, 0.008064281195402145, 0.002270543249323964, 0.04948959872126579, 0.013103561475872993, -0.04470120742917061, 0.004953260999172926, 0.04796992987394333, -0.05338912457227707, 0.051869455724954605, 0.01849408447742462, 0.018680458888411522, 0.014049770310521126, 0.040801677852869034, -0.004451483488082886, -0.01022909302264452, 0.024113992229104042, 0.009705810807645321, -0.01827903836965561, 0.0007338495925068855, 0.004361880011856556, -0.030852148309350014, -0.043009500950574875, 0.009304388426244259, 0.006361822132021189, 0.020931290462613106, -0.0052220700308680534, 0.0220925472676754, 0.007591176778078079, -0.02914610505104065, -0.018078327178955078, 0.0054227812215685844, 0.0014085611328482628, 0.0028941810596734285, 0.010573169216513634, 0.03400617837905884, -0.02696695737540722, -0.004304534289985895, 0.030651437118649483, -0.01683105155825615, 0.03260120004415512, -0.029791247099637985, 0.010264934040606022, 0.0579194612801075, 0.015038988552987576, 0.0013458388857543468, 0.015096334740519524, -0.015641121193766594, 0.04005618020892143, 8.237887232098728e-05, 0.01493863295763731, 0.017433183267712593, -0.000914399919565767, -0.008709424175322056, 0.05665784701704979, -0.03007797710597515, 0.009067836217582226, 0.00950509961694479, -0.007526662666350603, -0.02061588689684868, -0.002304592402651906, -0.0208596084266901, 0.0236982349306345, 0.033776793628931046, 0.0034031267277896404, -0.01975569687783718, 0.009849175810813904, 0.007562503684312105, 0.027655107900500298, 0.029002739116549492, 0.026192786172032356, -0.017648231238126755, 0.023669561371207237, 0.028486626222729683, -0.03618532791733742, -0.029017075896263123, 0.03242916241288185, -0.002352978102862835, 0.00010382762411609292, 0.004777638707309961, 0.00850154459476471, 0.003628926584497094, 0.01882382482290268, 0.00296765542589128, -0.025791363790631294, -0.0036808964796364307, 0.007257853168994188, 0.009634127840399742, 0.05347514525055885, -0.008114458993077278, -0.021791480481624603, 0.007634186185896397, -0.02409965731203556, -0.020243138074874878, -0.0012741565005853772, 0.009039163589477539, 0.005598403047770262, -0.021490413695573807, -0.05465073883533478, 0.01366985309869051, 0.004121743608266115, 0.03988414257764816, 0.004913835320621729, 0.0004596640355885029, 0.03162631765007973, -0.01259461510926485, 0.05872230604290962, -0.011275657452642918, 0.020128445699810982, 0.01903887279331684, 0.01430782675743103, 0.025820037350058556, -0.010436971671879292, 0.03598461672663689, -0.00022826396161690354, 0.0238846093416214, 0.034493617713451385, 2.517287794034928e-05, 0.025031529366970062, 0.0030698031187057495, 0.019999418407678604, 0.01594218797981739, 0.0017006673151627183, 0.0253756046295166, 0.015297045931220055, -0.025647997856140137, -0.053905241191387177, -0.030020631849765778, 0.04802727699279785, 0.014408182352781296, -0.032658547163009644, -0.014895623549818993, 0.0336621031165123, -0.00026746533694677055, -0.022049536928534508, -0.005963983945548534, 0.027583425864577293, -0.002336849458515644, 0.0029443586245179176, -0.007426307071000338, 0.028171222656965256, -0.011067777872085571, -0.04401305690407753, -0.016802377998828888, 0.010910076089203358, 0.006913776975125074, -0.009705810807645321, -0.03182702884078026, -0.004050061106681824, -0.007082230877131224, -0.005723847541958094, 0.0018081910675391555, -0.01790628768503666, 0.035583194345235825, -0.01614289917051792, 0.007684363983571529, 0.02098863571882248, -0.016687685623764992, -0.005401276517659426, 0.0020483273547142744, 0.028142549097537994, -0.008551722392439842, -0.01933993771672249, -0.013662684708833694, -0.0022866716608405113, 0.0013332945527508855, -0.017963634803891182, 0.043353576213121414, 0.014436855912208557, -0.009275715798139572, -0.0028493793215602636, 0.02157643251121044, 0.02134704776108265, 0.027052976191043854, 0.04206329211592674, -0.004999854601919651, -0.002209613099694252, 1.203341980726691e-05, -0.017146453261375427, 0.0005765961250290275, -0.013870563358068466, 0.0031217727810144424, -0.0020411591976881027, -0.017490530386567116, 0.03211376070976257, 0.042264003306627274, 0.006985459476709366, -0.04019954800605774, 0.028687337413430214, 0.015297045931220055, -0.011160965077579021, 0.0045195817947387695, -0.016357947140932083, -0.017490530386567116, 0.02984859235584736, 0.033031295984983444, -0.006222040858119726, -0.02189183607697487, 0.008537385612726212, -7.94107691035606e-05, 0.023325486108660698, -0.010071391239762306, 0.00489233061671257, 0.017633894458413124, 0.003709569340571761, 0.015153680928051472, -0.022694678977131844, -0.004645025823265314, 0.015354391187429428, -0.02045818604528904, 0.012078501284122467, 0.010609010234475136, -0.03483769670128822, -0.010759543627500534, 0.02174847014248371, 0.02427169494330883, 0.017132118344306946, 0.026551198214292526, 0.017046097666025162, 0.00647292984649539, 0.006114517338573933, 0.006433504167944193, 0.0008261408074758947, -0.01645830273628235, 0.02409965731203556, 0.009798998013138771, -0.013992424122989178, 0.022364940494298935, 0.021519087255001068, 0.026293141767382622, -0.026938283815979958, 0.02279503457248211, 0.029590535908937454, 0.005691590718924999, -0.05164007470011711, -0.016429629176855087, -0.018952853977680206, -0.010874235071241856, -0.018393728882074356, 0.005766856949776411, 0.023411504924297333, -0.015512092970311642, -0.008652077987790108, -0.0046521942131221294, -0.04341092333197594, -0.015297045931220055, -0.003662975737825036, 0.0011962017742916942, 0.0007862674538046122, 0.023569205775856972, 0.0376189760863781, -0.014637566171586514, -0.021433068439364433, 0.00732953567057848, 0.008752433583140373, 0.004447899293154478, -0.0011065986473113298, 0.0015725349076092243, -0.0035805408842861652, -0.0007858194294385612, -0.015139344148337841, -0.047912582755088806, 0.014809604734182358, -0.036500729620456696, -0.0044622356072068214, -0.004756134003400803, -0.03500973433256149, 0.046421587467193604, 0.011347339488565922, 0.01739017479121685, -0.021490413695573807, -0.015841832384467125, 0.02917477674782276, -0.02044384926557541, -0.009999709203839302, -0.014264817349612713, -0.00520773371681571, 0.0767289474606514, -0.034092195332050323, -0.015497756190598011, 0.012558774091303349, -0.007347456179559231, 0.04017087444663048, -0.023067427799105644, -0.018164345994591713, -0.020142782479524612, 0.025576315820217133, -0.001816255389712751, 0.02318212017416954, -0.008221982978284359, -0.011612565256655216, 0.020687568932771683, -0.017074771225452423, -0.016529984772205353, 0.04054362326860428, 0.03346139192581177, 0.011132292449474335, 0.0016334649408236146, 0.019454630091786385, 0.015411737374961376, -0.0009027514606714249, 0.02497418224811554, -0.0008109082700684667, -0.02245095930993557, 0.0005232822732068598, 0.018551431596279144, 0.02298140898346901, 0.005763273220509291, -0.05184078589081764, -0.024228684604167938, -0.003885191399604082, -0.029647883027791977, -0.001580599113367498, -0.013361617922782898, 0.048256658017635345, -0.0208596084266901, -0.00922553800046444, 0.0060571711510419846, 0.02751174382865429, 0.0018081910675391555, 0.009440585039556026, -0.0031504458747804165, 0.0133974589407444, -0.0001594935602042824, -0.0041468325071036816, 0.004455067217350006, 0.005508800037205219, 0.01685972325503826, -0.007229180075228214, 0.012465586885809898, -0.006831342354416847, -0.008881461806595325, 0.008415525779128075, 0.014415350742638111, 0.008867125026881695, 0.01303904689848423, 0.010114400647580624, -0.03168366476893425, 0.00041307040373794734, -0.032715894281864166, -0.0009587534586898983, -0.008444198407232761, -0.03979812562465668, -0.02333982288837433, 0.015856169164180756, -0.021246692165732384, 0.03965475782752037, -0.04017087444663048, 0.012809663079679012, 0.013927909545600414, -0.021963518112897873, 0.00906066782772541, -0.007784719578921795, -0.02789882943034172, 0.018795151263475418, 0.022866718471050262, 0.026149775832891464, -0.0026289557572454214, 0.002679133554920554, -0.02609243057668209, -0.012967363931238651, -0.023941954597830772, -0.0009099197341129184, 0.013139402493834496, 0.007225595880299807, -0.036472056061029434, 0.027984848245978355, -0.008630572818219662, 0.01774858683347702, 0.03452229127287865, -0.0056163240224123, -0.02260866016149521, -0.009705810807645321, -0.006060755345970392, 0.025963401421904564, 0.003935369197279215, -0.003745410591363907, -0.021619442850351334, -0.005691590718924999, 0.0034479282330721617, 0.0230244193226099, -0.002180940005928278, -0.013705694116652012, -0.022235911339521408, -0.013232589699327946, 0.010221924632787704, 0.004247188102453947, 0.012694970704615116, -0.0017911664908751845, 0.03879456967115402, 0.027784137055277824, 0.004386968910694122, 0.03294527530670166, 0.015555102378129959, 0.03638603538274765, -0.009125182405114174, -0.01296019647270441, 0.0033278600312769413, 0.007863570004701614, 0.006304475944489241, 0.03716020658612251, -0.011304330080747604, 0.028113877400755882, -0.005465790629386902, -0.01631493680179119, 0.009118014015257359, 0.016974415630102158, -0.014558715745806694, 0.011189638637006283, 0.013404627330601215, -0.012565942481160164, -0.002277711406350136, 0.02354053221642971, 0.015196690335869789, 0.0013798881554976106, -0.020572878420352936, 0.005161140114068985, 0.015038988552987576, 0.038823243230581284, -0.021504750475287437, -0.010171746835112572, -0.014099948108196259, 0.001261612051166594, -0.0012875968823209405, -0.03779101371765137, 0.0358985960483551, 0.016745032742619514, 0.002906725276261568, -0.005817034747451544, -0.004645025823265314, 0.019411621615290642, 0.0020913369953632355, -0.013003205880522728, -0.007813392207026482, -0.02354053221642971, -0.002292047953233123, 0.004770470317453146, 0.020902616903185844, -0.019124891608953476, -0.002949734916910529, 0.012838335707783699, 0.004032140597701073, -0.009655633009970188, -0.027827147394418716, -0.016243254765868187, 0.0033529489301145077, 0.004748965613543987, 0.0023260971065610647, 0.0011451279278844595, 0.010071391239762306, -0.009963867254555225, -0.03297394886612892, -0.023626552894711494, -0.030135322362184525, 0.005555393639951944, -0.026952620595693588, 0.009182528592646122, 0.0027113906107842922, 0.013239758089184761, 0.023827262222766876, 0.014680576510727406, 0.02047252282500267, 0.010515823028981686, 0.03867987543344498, 0.008494376204907894, 0.02391328290104866, 0.0238846093416214, -0.0010367081267759204, -0.010458476841449738, 0.011712920852005482, 0.017877615988254547, -0.006354653742164373, 0.052959032356739044, 0.0026432923041284084, -0.017791597172617912, 0.02550463378429413, -0.009067836217582226, -0.034120868891477585, -0.02229325845837593, 0.007856401614844799, -0.019999418407678604, -0.03211376070976257, -0.005713095422834158, 0.002243662253022194, -0.021433068439364433, 0.010967422276735306, 0.006963954772800207, 0.023268138989806175, 0.001326126279309392, 0.0015734308399260044, 0.010236261412501335, 0.00199098140001297, -0.008824115619063377, 0.00394253758713603, 0.024744799360632896, -0.031425606459379196, -0.009727315045893192, -0.016443965956568718, -0.006311644334346056, 0.038307126611471176, -0.025791363790631294, 0.0048421528190374374, 0.005171892233192921, -0.014358004555106163, 0.038135088980197906, 0.013784544542431831, 0.008171805180609226, 0.0063725742511451244, -0.05181211233139038, -0.023769916966557503, -0.009978204034268856, 0.0029013492166996002, -0.0005174580728635192, 0.012250538915395737, -0.005322425626218319, -0.007046389859169722, 0.017447520047426224, -0.06027064472436905, 0.01741884835064411, -0.0003743170527741313, 0.0035608282778412104, -0.049718983471393585, 0.04123177379369736, 0.004702372010797262, 0.040486276149749756, -0.025031529366970062, 0.004225683398544788, 0.027812810614705086, -0.00262357946485281, -0.021304039284586906, -0.03655807673931122, 0.02316778339445591, -0.04599149152636528, 0.015168016776442528, -0.014537211507558823, 0.009497931227087975, 0.01627192832529545, -0.02860131673514843, -0.030336033552885056, -0.001735612517222762, 0.0008610860095359385, -0.011949473060667515, 0.031597647815942764, -0.026479516178369522, -0.008308001793920994, -0.020787924528121948, 0.004236435983330011, -0.014200303703546524, 0.019483303651213646, 0.004849321208894253, -0.009311556816101074, 0.012924354523420334, -0.001073445426300168, 0.020716242492198944, -0.00373107404448092, -0.012451250106096268, -0.04323888570070267, 0.03145428001880646, -0.0036683520302176476, -0.0217197984457016, -0.026422169059515, 0.015239699743688107, 0.03297394886612892, -0.00457692751660943, -0.010644851252436638, 0.0038887755945324898, -0.003146861679852009, -0.027210677042603493, 0.0023637304548174143, -0.00602491432800889, -0.03483769670128822, 0.007971093989908695, 0.03670144081115723, 0.021992191672325134, -0.0135838333517313, -0.03816376253962517, 0.01753353886306286, 0.009067836217582226, -0.017977971583604813, 0.01773425005376339, 0.009110845625400543, 0.03397750481963158, 0.019411621615290642, -0.006060755345970392, 0.040285564959049225, -0.011354507878422737, 0.010393962264060974, 0.024744799360632896, 0.02984859235584736, -0.03300262242555618, 0.0325438566505909, 0.023454513400793076, 0.04980500042438507, -0.029991958290338516, -0.013519319705665112, -0.01812133565545082, 0.013232589699327946, -0.016759367659687996, -0.0036235502921044827, -0.009913689456880093, 0.030909493565559387, 0.04014220088720322, 0.01664467714726925, 0.0007508741691708565, 0.018924180418252945, 0.008279329165816307, -0.05992656946182251, 0.025418614968657494, 0.023941954597830772, 0.038823243230581284, 0.02627880498766899, -0.007691532373428345, 0.03346139192581177, 0.00035012420266866684, 0.010049887001514435, 0.009211201220750809, -0.018164345994591713, -0.03673011437058449, 0.015182353556156158, 0.020357830449938774, -0.00022613588953390718, -0.010551664046943188, 0.0019551401492208242, 0.004655778408050537, 8.869309567671735e-06, -0.02008543722331524, -0.003345780773088336, 0.01577015034854412, 0.03928200900554657, -0.017834605649113655, -0.0010492525761947036, 0.015340055339038372, -0.0075409989804029465, 0.00483856862410903, -0.025834372267127037, -0.016013870015740395, -0.014823941513895988, -0.03007797710597515, -0.028859375044703484, 0.005164724308997393, 0.016515647992491722, -0.040113527327775955, 0.0013691358035430312, 0.0009820502018555999, -0.032142434269189835, 0.01591351442039013, -0.0060571711510419846, 0.02392761781811714, 0.037934377789497375, 0.011153796687722206, 0.01575581356883049, -0.0325438566505909, -0.004515997599810362, 0.013332945294678211, -0.006006993353366852, 0.05324576050043106, 0.0012069541262462735, 0.006096596829593182, -0.014128620736300945, 0.005960399750620127, -0.013003205880522728, 0.001515188836492598, 0.004533918108791113, -0.03483769670128822, 0.033232007175683975, -0.0038135091308504343]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
" that DPO is
trained on the preference data in the dataset, while Iter. DPO is trained on self-generated responses, using a reward model for labeling.
PPO Win Tie DPO Win
PPO V .S. DPO 42 28 30
PPO V .S. DPO-Iter 36 36 28
Table 5. On HH-RLHF, we use GPT-4 to compare the outputs of
the PPO and DPO models.
highlight that utilizing a small batch size, such as 64, in
PPO training could negatively impact the performance of
the base SFT model, resulting in a 33.7% performance level
on the introductory scale. We remark that our findings are
consistent with those developed in the RL community (Yu
et al., 2022).
6. Benchmark Results
In this section, we conduct experimental validations to eval-
uate the performances of both DPO and PPO. Initially, our
experiments focus on general dialogue tasks, specifically
HH-RLHF and SafeRLHF. The primary goal is to improve
the effectiveness of LLM by promoting constructive inter-
actions and mitigating detrimental components within the
model. Additionally, our investigation extends to demand-
ing code generation tasks, namely APPS and CodeContest.
LLM Method ∆Help.↑Harm. ↓ S.R.↑
Beaver - -6.59 89.6%
Llama 1
7BSFT -2.26 0.78 46.5%
DPO -2.70 -6.38 93.1 %
DPO-Iter -2.79 -11.86 100.0%
PPO +0.66 -10.22 98.6%
Llama 2
7BSFT -2.12 0.00 52.1%
DPO -2.86 -6.82 95.8%
DPO-Iter -2.96 -11.07 99.9%
PPO +1.69 -12.08 99.5%
Table 6. Results on SafeRLHF. “Beaver” is the officially released
model. “ ∆Help.” denotes helpfulness relative to Beaver. “S.R.”
denotes safety rate. The reported results are based on the official
evaluation model.
HH-RLHF (Bai et al., 2022) dataset consists of human
preferences on AI assistant responses, encompassing 170k
comparisons. In this dataset, we conduct experiments basedModel Method Intro. Inter. Comp.
GPT-Neo 2.7B SFT 5.6% 0.8% 0.0%
Codex 12B SFT 9.7% 0.5% 0.1%
CodeT5 CodeRL 16.4% 4.9% 2.8%
AlphaCode 1B 5@1k 14.4% 5.6% 4.6%
Code Llama
7BFew shot 10.8% 2.0% 0.8%
SFT 30.0% 7.8% 2.8%
DPO-Iter 20.9% 3.4% 1.3%
PPO 29.4% 7.6% 2.4%
Code Llama
13BFew shot 23.7% 5.6% 2.1%
SFT 33.7% 8.7% 3.6%
DPO-Iter 33.0% 8.0% 2.8%
PPO 36.4% 11.47% 4.6%
Code Llama
34BFew shot 32.8% 8.8% 2.9%
SFT 38.6% 10.1% 3.9%
DPO-Iter 34.2% 9.3% 3.7%
PPO 44.4% 18.0% 9.1%
Table 7. Results on Apps test set. All the numbers are pass@5
except for AlphaCode. Where “5@1k” means this model samples
1000 times for each problem and 5 sampled codes that pass the
public test cases (in the problem description) are selected to be
evaluated on hidden test cases.
on Llama2-7B. We evaluate the trained models using the
OpenAssistant reward model1. Note that this model is only
used for evaluation and is not involved during training. In
addition, we adopt GPT-4 to compare the responses of dif-
ferent models. The prompt and","[0.005600341130048037, -0.005453716963529587, 0.07140971720218658, -0.004237806424498558, 0.01597849652171135, -0.0034546167589724064, 0.00974874198436737, 0.04208481311798096, 0.022158183157444, 0.005561002995818853, 0.023703105747699738, -0.018109915778040886, -0.056904617697000504, -0.011822942644357681, -0.0037693229969590902, -0.03307276964187622, 0.016894005239009857, -0.05813483148813248, -0.04342946782708168, 0.03716395050287247, 0.00372283230535686, -0.018224354833364487, 0.005843523424118757, 0.014505098573863506, 0.029611000791192055, -0.016779566183686256, -0.017466198652982712, 0.001149750780314207, 0.0070451293140649796, -0.0424567386507988, 0.03670619800686836, -0.03144202008843422, -0.033387474715709686, -0.030097365379333496, 0.031012874096632004, 0.021500160917639732, 0.00030420118127949536, 0.055102210491895676, -0.009677218273282051, -0.024690138176083565, -0.028895758092403412, -0.030984263867139816, -0.03936689347028732, -0.026950301602482796, -0.019211387261748314, 0.04520326480269432, 0.034646302461624146, -0.033416084945201874, 0.03410271555185318, 0.018281573429703712, -0.047778137028217316, 0.08588620275259018, -0.011129158549010754, -0.019726362079381943, 0.032128650695085526, -0.01861058548092842, 0.028209127485752106, -0.00043339168769307435, 0.03127036243677139, -0.03413132578134537, -0.00370852742344141, -0.042342301458120346, 0.010599879547953606, 0.009913248009979725, -0.009913248009979725, -0.015592265874147415, -0.08371187001466751, 0.014719671569764614, 0.015878362581133842, 0.006079553160816431, 0.01117207296192646, 0.015549351461231709, 0.03991048038005829, -0.027551105245947838, -0.006290549412369728, -0.0020598957780748606, 0.03939550369977951, 0.04623321443796158, 0.010328087955713272, -0.012187715619802475, 0.008432697504758835, 0.017895342782139778, 0.017251625657081604, -0.04208481311798096, 0.011951685883104801, -0.008883300237357616, -0.03533293306827545, -0.026807254180312157, -0.059393659234046936, -0.06374232470989227, -0.04809284210205078, -0.03902357816696167, -0.013403627090156078, -0.01089312881231308, 0.04846476763486862, -0.02722209319472313, -0.020613262429833412, -0.019855106249451637, 0.008411240763962269, 0.049580544233322144, -0.0029539475217461586, -0.014977158047258854, -0.011565456166863441, 0.0033830925822257996, 0.03456047177314758, 0.023831848055124283, 0.021099625155329704, 0.007953486405313015, -0.016264593228697777, 0.009677218273282051, -0.08754556626081467, 0.029167549684643745, -0.07655945420265198, 0.011408102698624134, -0.003333025611937046, -0.03018319420516491, -0.020985187962651253, -0.02008398249745369, -0.0067804898135364056, -0.021757647395133972, -0.041112083941698074, 0.015935581177473068, 0.02747957967221737, -0.022143878042697906, -0.0016182339750230312, 0.01070716604590416, 0.03787919133901596, -0.04471690207719803, 0.018396012485027313, -0.03107009269297123, -0.012552489526569843, 0.01901112124323845, 0.03627705201506615, -0.04036823287606239, -0.049666374921798706, 0.04302893206477165, -0.034417424350976944, 0.010127820074558258, -0.023502837866544724, 0.006941419094800949, -0.020742004737257957, -0.027121959254145622, -0.04177010804414749, 0.05581745132803917, -0.0492086187005043, -0.02253010869026184, -0.026792949065566063, -0.02777998149394989, -0.05770568922162056, 0.050152737647295, -0.00577199924737215, -0.014304830692708492, -0.018295878544449806, 0.002567717107012868, -0.02397489733994007, -0.03913801908493042, 0.007395597640424967, 0.03633427247405052, -0.010850214399397373, -0.026549765840172768, -0.016364727169275284, 0.015577960759401321, -0.03776475414633751, -0.013618199154734612, 0.012151953764259815, 0.04923722892999649, -0.014919938519597054, 0.0051676202565431595, -0.11398089677095413, -0.03235752880573273, 0.010828756727278233, 0.03716395050287247, -0.036191221326589584, -0.03599095344543457, -0.024017810821533203, -0.03095565363764763, -0.017594942823052406, 0.01085736695677042, -0.050953809171915054, -0.018853766843676567, -0.019912324845790863, 0.04531770572066307, -0.029281988739967346, 0.004033962264657021, -0.012802823446691036, -0.027980249375104904, 0.019955240190029144, 0.01222347840666771, -0.006590950768440962, 0.011908771470189095, 0.040082138031721115, 0.03304415941238403, 0.08571454882621765, -0.0021618176251649857, -0.010013381950557232, -0.05681878700852394, 0.057905957102775574, 0.01905403472483158, -0.027365142479538918, 0.0075386459939181805, 0.021886391565203667, 0.009691523388028145, -0.024218078702688217, -0.06666051596403122, 0.0037371371872723103, -0.026678510010242462, -0.030783995985984802, -0.018396012485027313, -0.03790780156850815, -0.026049097999930382, 0.04136957228183746, 0.03387384116649628, 0.06597387790679932, -0.015577960759401321, -0.05478750169277191, -0.003130969824269414, -0.06505837291479111, 0.01612154394388199, 0.03018319420516491, 0.03344469517469406, -0.00719533022493124, 0.022544413805007935, 0.025534123182296753, 0.009183701127767563, -0.00583637086674571, 0.02659268118441105, 0.010878823697566986, -0.014018733985722065, -0.000814481289125979, -0.04837893694639206, 0.015806838870048523, 0.0067876423709094524, -0.005950809922069311, -0.021028101444244385, 0.019368741661310196, -0.039738819003105164, 0.01145101711153984, -0.03370218351483345, -0.00273758708499372, -0.04131235182285309, 0.007495731581002474, 0.013861381448805332, 0.05658991262316704, -0.025991877540946007, 0.025648562237620354, 0.00893336720764637, -0.005582460202276707, -0.05441557615995407, 0.015177425928413868, 0.0037049511447548866, 0.01459092739969492, -0.011343730613589287, -0.0026231484953314066, -0.040082138031721115, -0.05112546682357788, -0.008168058469891548, -0.01087167114019394, 0.019869409501552582, -0.021657513454556465, -0.01782381907105446, -0.04837893694639206, 0.02078492008149624, 0.0008332564029842615, 0.027679847553372383, -0.03147062659263611, 0.010385307483375072, -0.021657513454556465, 0.018481841310858727, -0.03599095344543457, -0.03418854624032974, -0.00543583557009697, 0.010492593981325626, 0.019883714616298676, 0.027751373127102852, -0.03890914097428322, -0.036420099437236786, 0.0028663305565714836, 0.029496561735868454, -0.015806838870048523, -0.014905634336173534, -0.006301278248429298, 0.01091458648443222, 0.04340085759758949, 0.011243597604334354, 0.025233721360564232, 0.018067002296447754, -0.021915001794695854, 0.013925752602517605, 0.00946979783475399, 0.02896728366613388, 0.013875686563551426, -0.04114069417119026, 0.05166905000805855, -0.022587327286601067, 0.02659268118441105, 0.022887729108333588, 0.028638271614909172, -0.02803746797144413, -0.0014278009766712785, 0.021442942321300507, 0.03032624162733555, 0.0065230028703808784, -0.006805523298680782, -0.0029914977494627237, 0.05192653834819794, -0.015005767345428467, -0.0008497963426634669, 0.0017630704678595066, -0.0034617690835148096, -0.04254256933927536, -0.013711180537939072, 0.034674908965826035, 0.015921276062726974, 0.01564948447048664, -0.0077031515538692474, -0.025276636704802513, 0.06236906349658966, -0.022959254682064056, 0.01331779733300209, -0.024132249876856804, -0.048035621643066406, -0.06334178894758224, -0.016393335536122322, -0.0004649070033337921, 0.0005172090604901314, -0.005171196535229683, -0.010356697253882885, 0.011987448669970036, -0.03092704527080059, -0.022143878042697906, 0.006240482442080975, -0.0005601235316134989, -0.022501498460769653, 0.016507774591445923, -0.006905657239258289, -0.009648608975112438, -0.040854595601558685, 0.05301370471715927, 0.03724978119134903, 0.06351345032453537, -0.09361081570386887, 0.00281626358628273, -0.038565825670957565, 0.004978081211447716, -0.02167181856930256, 0.022315535694360733, 0.0032024940010160208, 0.030383460223674774, 0.04938027635216713, 0.01716579683125019, -0.008718794211745262, -0.008110838942229748, 0.05041022598743439, 0.024647224694490433, 0.004334363620728254, 0.006930690724402666, 0.011186378076672554, -0.034674908965826035, -0.020999491214752197, 0.025548428297042847, -0.035161275416612625, 0.04334363713860512, -0.013310645706951618, 0.030211802572011948, 0.019111255183815956, 0.04219925031065941, -0.021442942321300507, -0.04877947270870209, 0.018853766843676567, -0.03267223387956619, 0.004384430591017008, 0.02104240655899048, -0.009226616472005844, 0.026163535192608833, -0.07306907325983047, 0.022358451038599014, 0.0029289142694324255, 0.046662360429763794, -0.04823588952422142, 0.048922523856163025, -0.014226154424250126, 0.016135849058628082, -0.03470351919531822, -0.01145101711153984, 0.014176087453961372, 0.016479166224598885, 0.008160905912518501, 0.0016781354788690805, -0.016507774591445923, -0.02034146897494793, 0.03221447765827179, 0.0008082229760475457, -0.01908264495432377, -0.008117991499602795, -0.029467951506376266, 0.01126505434513092, -0.00013008456153329462, 0.052584558725357056, 0.027193482965230942, 0.06431452184915543, -0.026978911831974983, -0.020184116438031197, -0.06751880049705505, 0.013982972130179405, -0.0536431148648262, 0.003535081399604678, 0.008518527261912823, 0.01994093507528305, 0.02344561740756035, 0.030783995985984802, 0.029353512451052666, -0.030726777389645576, 0.03767892345786095, -0.03647731989622116, 0.009255225770175457, -0.02675003372132778, 0.0027590442914515734, -0.005904319230467081, 0.031155921518802643, 0.05141156166791916, -0.004928014241158962, -0.056618522852659225, -0.024618614464998245, -0.039223846048116684, 0.002480100141838193, 0.02138572186231613, 0.0060294861905276775, -0.017108578234910965, 0.013618199154734612, -0.011701351962983608, -0.011429560370743275, 0.05684739723801613, 0.054243918508291245, -0.04025379568338394, -0.06317013502120972, -0.03533293306827545, -0.01291010994464159, 0.021028101444244385, -0.005282058846205473, 0.008003553375601768, 0.03776475414633751, -0.021328503265976906, -0.009884637780487537, -0.004026809707283974, -0.040225185453891754, -0.03181394562125206, -0.011279359459877014, -0.026907386258244514, 0.022587327286601067, -0.02171473391354084, -0.023273959755897522, -0.015821143984794617, 0.047034285962581635, 0.015191730111837387, -0.006744727957993746, -0.061682432889938354, 0.07467121630907059, -0.024475565180182457, 0.059393659234046936, -0.008861842565238476, 0.035790685564279556, -0.03244335576891899, -0.01879654824733734, 0.000884217384736985, 0.014354897662997246, 0.011873009614646435, -0.00029660173458978534, -0.009426883421838284, -0.0037907802034169436, 0.0077031515538692474, 0.00132230285089463, -0.03885192051529884, 0.01157976035028696, -0.04094042629003525, -0.03664897754788399, -0.009455493651330471, 0.0106141846626997, -0.004924437962472439, -0.00092355563538149, -0.009927553124725819, 0.02057034708559513, -0.051583219319581985, 0.009977620095014572, 0.008411240763962269, 0.03518988564610481, 0.08142309635877609, 0.03813667967915535, 0.005843523424118757, -0.03204282000660896, 0.015749618411064148, 0.010692860931158066, -0.020069677382707596, 0.048064231872558594, -0.017294541001319885, 0.020656175911426544, -2.6821559004019946e-05, 0.033129990100860596, 0.006040215026587248, -0.0029771928675472736, -0.02570578083395958, 0.016207372769713402, -0.010714318603277206, -0.006801947019994259, 0.03481796011328697, 0.007431359495967627, 0.00943403597921133, 0.02777998149394989, -0.02763693407177925, -0.019926629960536957, 0.004480988252907991, 0.016779566183686256, 0.0054322597570717335, 0.014905634336173534, -0.0050567579455673695, -0.0107286237180233, 0.00016338798741344362, -0.02330256998538971, -0.00272328220307827, -0.027307922020554543, 0.03636287897825241, -0.0035654790699481964, -0.003338390029966831, -0.015935581177473068, -0.006719694472849369, 0.011129158549010754, -0.04320058971643448, -0.02862396650016308, -0.09029209613800049, -0.02129989303648472, -0.04016796499490738, -0.0024532785173505545, -0.010084905661642551, 0.012123344466090202, -0.03207143023610115, -0.03484656661748886, -0.009448341093957424, 0.0014823380624875426, -0.015134511515498161, -0.0340454988181591, -0.032500576227903366, 0.05870702490210533, 0.011386645957827568, 0.020670481026172638, -0.018996816128492355, 0.028752710670232773, -0.003082690993323922, 0.025548428297042847, 0.008375478908419609, -0.0004036644531879574, -0.006995062343776226, 0.04440219700336456, -0.03510405495762825, 0.003599453018978238, -0.03513266518712044, -0.02460430935025215, 0.0014993251534178853, -0.00026754505233839154, -0.02855244278907776, 0.018109915778040886, 0.009898942895233631, 0.017323151230812073, 0.01642194576561451, -0.012008905410766602, 0.0013196206418797374, -0.0029414307791739702, 0.028981586918234825, 0.018109915778040886, 0.0111363111063838, 0.009362512268126011, 0.03948133438825607, -0.025791609659790993, 0.015163120813667774, 0.014140325598418713, -0.030583728104829788, -0.01274560485035181, -0.007946333847939968, 0.023874763399362564, 0.014505098573863506, 0.011837247759103775, -0.011272206902503967, -0.010585575364530087, -0.03167089447379112, -0.013918600976467133, -0.008776013739407063, -0.037049513310194016, 0.006841285619884729, 0.017137188464403152, 0.03570485860109329, -0.01753772236406803, 0.050581883639097214, 0.037821974605321884, -0.012895804829895496, 0.024032115936279297, -0.015163120813667774, -0.0352184921503067, -0.003653096267953515, 0.01863919571042061, -0.019440265372395515, -0.006229754071682692, -0.023588666692376137, 0.021128235384821892, 0.00707373907789588, 0.0055967653170228004, -0.015449217520654202, -0.032529186457395554, 0.038193900138139725, -0.018324488773941994, 0.024389736354351044, 0.006151077337563038, -0.006673203781247139, 0.0007268642075359821, -0.010428221896290779, -0.021185453981161118, -0.027350837364792824, -0.045517973601818085, -0.02418946847319603, -0.02586313523352146, 0.009369663894176483, 0.022887729108333588, -0.03547598049044609, -0.026435328647494316, -0.000408805237384513, -0.00899058673530817, -0.014934243634343147, 0.02264454774558544, 0.005217687226831913, -0.014819804579019547, 0.013782704249024391, -0.03224308788776398, 0.02078492008149624, -0.052098195999860764, 0.007102348376065493, 0.020584652200341225, -0.013925752602517605, 0.03118453174829483, 0.027579713612794876, 0.018138526007533073, 0.008661575615406036, -0.00946979783475399, 0.0005695110885426402, 0.01793825812637806, 0.03458908200263977, -0.005757694598287344, -0.05507360026240349, -0.0075386459939181805, -0.01076438557356596, 0.014512251131236553, -0.029124636203050613, -0.007610170170664787, -0.045632410794496536, -0.024089334532618523, -0.020985187962651253, 0.0036423676647245884, 0.011822942644357681, 0.015749618411064148, -0.01126505434513092, -0.029467951506376266, 0.005804185289889574, -0.02486179582774639, -0.00543583557009697, -0.032786671072244644, -0.020184116438031197, -0.012581098824739456, 0.011243597604334354, 0.02152877114713192, 0.03527571260929108, -0.005110400728881359, 0.060538046061992645, 0.014383507892489433, -0.008261039853096008, -0.04277144372463226, -0.01579253375530243, 0.040225185453891754, -0.01597849652171135, 0.004813575651496649, 0.015420608222484589, 0.003915947396308184, -0.06059526279568672, -0.03044068068265915, 0.01775229535996914, -0.014791195280849934, 0.002564141061156988, -0.062311843037605286, -0.01705135777592659, -0.0022422822657972574, -0.01630750671029091, 0.0361626110970974, -0.02178625762462616, -0.0035404455848038197, 0.005535969510674477, -0.014011582359671593, 0.005063910037279129, -0.01213049702346325, -0.019926629960536957, -0.010907433927059174, 0.006043791305273771, -0.004423769190907478, 0.06734714657068253, 0.0008614190155640244, -0.059164781123399734, -0.03664897754788399, -0.011958838440477848, -0.006072400603443384, 0.000856948783621192, -0.060538046061992645, -0.0338166207075119, -0.035161275416612625, 0.04340085759758949, 0.034417424350976944, -0.022816205397248268, -0.01583544723689556, 0.018281573429703712, -0.03859443590044975, 0.03164228796958923, 0.011143463663756847, 0.022501498460769653, 0.01231645978987217, 0.011658437550067902, 0.010328087955713272, -0.03018319420516491, -0.040482670068740845, 0.0023585089948028326, -0.00041752224205993116, 0.009612846188247204, -0.013754094950854778, -0.011243597604334354, -0.025662867352366447, -0.029839877039194107, -0.012295002117753029, 0.010621337220072746, 0.022515803575515747, 0.02108532004058361, -0.020284250378608704, -0.02633519470691681, -0.02381754294037819, 0.007996400818228722, -0.02955378033220768, 0.04494578018784523, -0.035161275416612625, -0.008325411938130856, 0.026764338836073875, -0.017995476722717285, -0.014319135807454586, 0.01080014742910862, -0.02474735677242279, -0.021686123684048653, 0.022887729108333588, 0.047148723155260086, -0.0010540871880948544, -0.018181439489126205, -0.03862304240465164, 0.014233306981623173, 0.001425118767656386, 0.013124682009220123, 0.023517142981290817, 0.0029092449694871902, -0.0060294861905276775, -0.011179225519299507, -0.015577960759401321, 0.01956900954246521, 0.011150616221129894, 0.004942318890243769, 0.005525241140276194, 2.2518932382808998e-05, -0.0029879214707762003, -0.016450555995106697, -0.0281089935451746, -0.030011534690856934, -0.00042623927583917975, -0.004763508681207895, -0.02640671841800213, -0.013768400065600872, -0.012366526760160923, 0.027980249375104904, 0.08474181592464447, -0.04520326480269432, 0.03355913236737251, 0.001682605710811913, -0.005074638873338699, 0.02108532004058361, -0.032014213502407074, -0.02593465894460678, 0.009362512268126011, -0.02138572186231613, -0.005460869055241346, 0.007080891169607639, -0.008497069589793682, 0.0021153269335627556, 0.009577084332704544, -0.028695490211248398, 0.007960638031363487, 0.004055419471114874, -0.027679847553372383, 0.00732407346367836, 0.03152784705162048, 0.03230030834674835, -0.014283373951911926, -0.13126112520694733, -0.04623321443796158, 0.011429560370743275, 0.003944557160139084, 0.012981634587049484, -0.02208665944635868, 0.04491716995835304, 0.02467583306133747, -0.02766554243862629, -0.002333475509658456, 0.033902451395988464, -0.04168427735567093, 0.015477826818823814, -0.03584790602326393, -0.008640117943286896, -0.047806743532419205, -0.006894928403198719, 0.006426445208489895, 0.015220340341329575, -0.043515294790267944, -0.022186793386936188, -0.018181439489126205, 0.022000830620527267, -0.0045632412657141685, -0.04280005395412445, 0.02089935727417469, -0.0022869848180562258, 0.024833187460899353, -0.0012498846044763923, 0.013203359209001064, -0.019840801134705544, 0.016879700124263763, 0.02416086010634899, -0.0012874348321929574, -0.04445941373705864, -0.013425083830952644, -0.017466198652982712, 0.0027894419617950916, 0.00788196176290512, 0.015349083580076694, 0.01882515847682953, -0.03613400459289551, 0.024518480524420738, -0.017952563241124153, 0.03398827835917473, -0.05204097554087639, 8.163811435224488e-05, -0.008318259380757809, 0.013811314478516579, -0.005092519801110029, 0.011822942644357681, -0.040825989097356796, 0.010213648900389671, 0.005096096079796553, -0.004402311518788338, 0.026921691372990608, 0.006208296865224838, -0.005839947145432234, 0.011122005991637707, -0.012173411436378956, 0.010435374453663826, 0.03596234694123268, -0.005053181666880846, -0.013968667946755886, -0.015277559868991375, 0.0040983338840305805, 0.002472947584465146, 0.002199367852881551, -0.027651239186525345, -0.03393105790019035, -0.028252040967345238, 0.03221447765827179, 0.014748280867934227, -0.006737575400620699, 0.003574419766664505, -0.007796132937073708, 0.026363803073763847, 0.02729361690580845, -0.04883669316768646, 0.007781828287988901, 0.04700567573308945, -0.02511928416788578, 0.041712887585163116, 0.03584790602326393, 0.00698075769469142, 0.03393105790019035, 0.050152737647295, -0.01863919571042061, -0.009598542004823685, 0.0031667319126427174, 0.01690831035375595, -0.009054957889020443, 0.0014054497005417943, 0.02570578083395958, -0.025991877540946007, -0.021915001794695854, 0.012938719242811203, 0.017323151230812073, 0.003898066468536854, 0.007831894792616367, 0.013968667946755886, 0.013568132184445858, -0.03044068068265915, -0.0018792971968650818, 0.01231645978987217, 0.0026642747689038515, 0.0191255584359169, 0.012209173291921616, 0.02862396650016308, -0.016264593228697777, 0.002698248717933893, 0.018725024536252022, -0.016450555995106697, 0.03627705201506615, -0.020255640149116516, 0.028809929266572, 0.05189792811870575, -0.007452817168086767, 0.012173411436378956, 0.013467998243868351, -0.012087582610547543, 0.045661021023988724, -0.0025623529218137264, 0.03344469517469406, 0.013453693129122257, 0.015592265874147415, 0.0036799178924411535, 0.06082414090633392, -0.023989202454686165, -0.003066598204895854, -0.001446576090529561, 0.010142125189304352, -0.0007170296739786863, -0.005010267253965139, -0.0014385295799002051, 0.02008398249745369, 0.04860781505703926, 0.0038801853079348803, -0.018481841310858727, 0.002067048102617264, -0.002762620570138097, 0.035304322838783264, 0.030612338334321976, 0.01605002023279667, -0.009848875924944878, 0.02115684561431408, 0.026835862547159195, -0.019068339839577675, -0.026206450536847115, 0.02208665944635868, -0.003198917955160141, -0.02656407095491886, -0.014340593479573727, 0.0019669141620397568, 0.01646486110985279, 0.017194407060742378, -0.008132296614348888, -0.03607678413391113, 0.018524756655097008, 0.008067924529314041, 0.014877024106681347, 0.04013935476541519, -0.007177448831498623, -0.031756725162267685, 0.015449217520654202, -0.018510451540350914, -0.018338793888688087, 0.016522079706192017, 0.007738913409411907, 0.016765261068940163, -0.010556965135037899, -0.018725024536252022, 0.01919708400964737, 0.014247612096369267, 0.05478750169277191, 0.01786673441529274, 0.001087167183868587, 0.02715056948363781, -0.0109646525233984, 0.0230879969894886, 0.0024157282896339893, 0.02640671841800213, 0.02418946847319603, 0.036935072392225266, 0.04403027147054672, -0.010993262752890587, 0.03284389153122902, 0.009484102949500084, 0.021915001794695854, 0.031499236822128296, 0.011336578987538815, 0.025219416245818138, 0.001620022114366293, 0.03307276964187622, 0.015964191406965256, -0.014540860429406166, 0.0340454988181591, 0.027365142479538918, -0.014219001866877079, -0.053986433893442154, -0.018696414306759834, 0.055388305336236954, 0.00572550855576992, -0.02164321020245552, -0.004559664987027645, 0.03144202008843422, -0.0006401411956176162, -0.015377693809568882, -0.009763047099113464, 0.04188454523682594, -0.01723732054233551, 0.009920400567352772, -0.009312445297837257, 0.02644963189959526, -0.018224354833364487, -0.020742004737257957, -0.018968205899000168, 0.024618614464998245, -0.001518994220532477, -0.019998153671622276, -0.014948548749089241, -0.0013258790131658316, 0.004330787807703018, 0.008961976505815983, -0.00186141615267843, -0.023059386759996414, 0.034789349883794785, -0.01949748396873474, 0.014948548749089241, 0.030783995985984802, -0.02264454774558544, 0.008504222147166729, 0.010642793960869312, 0.008117991499602795, -0.017366064712405205, -0.016450555995106697, -0.024032115936279297, -0.0015994589775800705, 0.03948133438825607, -0.021128235384821892, 0.05226985365152359, 0.018410317599773407, -0.016922615468502045, -0.0039874715730547905, 0.02271607145667076, 0.025920353829860687, 0.03167089447379112, 0.02955378033220768, -0.021814867854118347, -0.013861381448805332, 0.016407640650868416, -0.026206450536847115, -0.006927114445716143, -0.02378893457353115, 0.012495269998908043, -0.01448364183306694, 0.006490817293524742, 0.019511789083480835, 0.034646302461624146, 0.01901112124323845, -0.03810806944966316, 0.03868026286363602, -0.00013455482257995754, -0.007331226021051407, 0.0023817543406039476, -0.013231968507170677, -0.00356905534863472, 0.005618222523480654, 0.03644870966672897, -0.005085367243736982, -0.024575699120759964, 0.018038392066955566, -0.003138122381642461, 0.03367357328534126, -0.006701813545078039, 0.004094758071005344, 0.02190069667994976, 0.005006690975278616, 0.020656175911426544, -0.02045590803027153, -0.014991463162004948, 0.007070162799209356, 0.005932928528636694, -0.0038050850853323936, 0.019039729610085487, -0.03550459071993828, -0.006422868929803371, -0.0014501522528007627, 0.014791195280849934, 0.0062583633698523045, 0.019111255183815956, 0.022401364520192146, 0.0016620425740256906, 0.01145101711153984, 0.004978081211447716, -0.002333475509658456, 0.005786304362118244, 0.013639656826853752, 0.01989801973104477, -0.0333588644862175, 0.020613262429833412, 0.04217064008116722, 0.031384799629449844, -0.029382122680544853, 0.020484518259763718, 0.006766185164451599, 0.0191255584359169, -0.0429144948720932, -0.0011086243903264403, -0.02008398249745369, 0.008847538381814957, -0.02630658447742462, 0.023431314155459404, 0.01455516554415226, -0.02248719520866871, -0.00018193956930190325, -0.00012214985326863825, -0.023831848055124283, -0.012488117441534996, -0.002267315750941634, 0.014211849309504032, -0.007631627377122641, 0.020255640149116516, 0.012273545376956463, -0.0004939637146890163, -0.014626690186560154, 0.007424207404255867, 0.0017505537252873182, -0.0010183252161368728, -0.010771538130939007, 0.006619560532271862, -0.0058184899389743805, 0.0036191223189234734, -0.005915047600865364, -0.05066771060228348, 0.009662913158535957, -0.050066906958818436, -0.0034957430325448513, -0.01863919571042061, -0.05361450836062431, 0.037936411798000336, 0.011479627341032028, -0.00375501811504364, -0.014562318101525307, -0.0047277468256652355, 0.04328642040491104, -0.00915509182959795, 0.0056539843790233135, 0.0045739696361124516, -0.0005073744687251747, 0.07547228783369064, -0.008547136560082436, -0.026034792885184288, 0.003955285996198654, -0.013067463412880898, 0.037335608154535294, -0.01567809469997883, -0.011923076584935188, -0.022372756153345108, 0.016593603417277336, 0.006215448956936598, 0.016507774591445923, -0.019282912835478783, 0.002996862167492509, 0.020055372267961502, -0.013632504269480705, 0.006054519675672054, 0.02607770636677742, 0.03868026286363602, -0.006369226146489382, 0.0032328919041901827, 0.020112592726945877, -0.00010326300252927467, -0.006573069840669632, 0.006540883798152208, 0.012824281118810177, -0.01285289041697979, -0.0022136725019663572, 0.023960592225193977, 0.029267683625221252, -0.0070987725630402565, -0.040854595601558685, -0.026421023532748222, 1.121057357522659e-05, -0.018739327788352966, -0.009441188536584377, -0.026463937014341354, 0.04191315546631813, -0.0059829954989254475, -0.02544829435646534, -0.005396497435867786, 0.010607032105326653, 0.010714318603277206, 0.00583637086674571, -0.0015118417795747519, -0.0027805014979094267, -0.013568132184445858, -0.002535531297326088, 0.004366549663245678, 0.004616884049028158, 0.021943610161542892, -0.000707642117049545, 0.004069724585860968, -0.0007916829781606793, 0.004795694723725319, 0.0008193986141122878, -0.0020438027568161488, 0.028309261426329613, 0.012180563993752003, 0.014197545126080513, -0.04629043489694595, -0.004134096205234528, -0.04165566712617874, 0.020112592726945877, -0.013804161921143532, -0.04271422699093819, 0.003324085148051381, -0.007488579023629427, -0.021371416747570038, 0.03873748332262039, -0.017223017290234566, 0.009584236890077591, -0.0038479994982481003, -0.028681186959147453, 0.011379493400454521, -0.009226616472005844, -0.004634765442460775, 0.01672234758734703, 0.030269023030996323, 0.03899496793746948, 0.004101910162717104, 0.013053158298134804, -0.008168058469891548, -0.018281573429703712, -0.008382630534470081, -0.006612407974898815, 0.015692399814724922, 0.006494393106549978, -0.04031101241707802, 0.012123344466090202, -0.00367634161375463, 0.026907386258244514, 0.03991048038005829, -0.00735268322750926, -0.009991924278438091, -0.00047071833978407085, -0.0045274789445102215, 0.03868026286363602, 0.006315582897514105, -0.01100756786763668, -0.0034295832738280296, -0.004069724585860968, -0.022472890093922615, 0.029024502262473106, -0.009505560621619225, -0.014490793459117413, -0.02274468168616295, 0.0009172972640953958, 0.019669143483042717, 0.016922615468502045, 0.007452817168086767, 0.012016057968139648, 0.024790272116661072, 0.0222726222127676, 0.015477826818823814, 0.03736421838402748, 0.008175211027264595, 0.04732038080692291, 0.002111750654876232, -0.00934105459600687, -0.0015163121279329062, 0.0026249364018440247, 0.02138572186231613, 0.03384523093700409, -0.0007563679246231914, 0.025248026475310326, 0.00048234101268462837, -0.021428637206554413, 0.012459508143365383, 0.008590050972998142, -0.03207143023610115, 0.006333463825285435, 0.01433344092220068, -0.016364727169275284, 0.008454155176877975, 0.012330763973295689, 0.007291887421160936, -0.03184255212545395, -0.01646486110985279, 0.007874809205532074, 0.02075630985200405, 0.02866688184440136, -0.012860042974352837, -0.0025248026940971613, -0.006937843281775713, -0.016708042472600937, -0.0026463938411325216, -0.030841216444969177, 0.007796132937073708, 0.003238256089389324, 0.012173411436378956, -0.02323104627430439, 0.004391583148390055, 0.03281528130173683, 0.015635181218385696, -0.0009181913337670267, -0.0036280627828091383, -0.02430390752851963, -0.010700013488531113, 0.006719694472849369, 0.008375478908419609, -0.015248949639499187, -0.0008059878018684685, 0.04254256933927536, 0.019812190905213356, -0.010385307483375072, -0.0052248393185436726, -0.003458192804828286, 0.006340616382658482, 0.0005748753901571035, -0.0013330314541235566, -0.00709162000566721, 0.0043093301355838776, -0.008067924529314041, -0.017437588423490524, -0.023989202454686165, -0.027837201952934265, 0.03230030834674835, -0.01779521070420742, -0.006741151679307222, 0.019039729610085487, 0.010478288866579533, 0.02267315797507763, 0.02952517196536064, 0.008096534758806229, 0.006902080960571766, 0.032643623650074005, 0.01982649601995945, 0.0041412487626075745, 0.006437174044549465, 0.008354021236300468, -0.013882838189601898, -0.003669189056381583, 0.008303954266011715, -0.004091181792318821, 0.042370907962322235, 0.0014957488747313619, -0.013804161921143532, 0.033902451395988464, 0.0024765238631516695, -0.016407640650868416, -0.024103639647364616, 0.00017389310232829303, 0.010850214399397373, -0.02245858497917652, -0.0012069700751453638, -0.00801070500165224, -0.023388398811221123, 0.012037515640258789, -0.002864542417228222, 0.018767938017845154, 0.020513128489255905, -0.005811337381601334, 0.01989801973104477, 0.026106316596269608, -0.017652161419391632, 0.013332102447748184, 0.021686123684048653, -0.034646302461624146, -0.0077031515538692474, 0.01470536645501852, -0.007996400818228722, 0.048178669065237045, -0.02178625762462616, 0.006941419094800949, -0.020212726667523384, 0.012202020734548569, 0.034016888588666916, 0.007395597640424967, 0.013732638210058212, 0.023688800632953644, -0.045517973601818085, -0.02167181856930256, 0.004116215277463198, -0.0014510463224723935, 0.010342393070459366, 0.008790318854153156, -0.010514050722122192, -0.007710304111242294, 0.021543076261878014, -0.05533108487725258, 0.020327165722846985, -0.006104586645960808, 0.0050674863159656525, -0.03407410904765129, 0.04883669316768646, 0.0055109360255301, 0.03533293306827545, -0.028051773086190224, -0.0038050850853323936, 0.02467583306133747, 0.004695560783147812, -0.022172488272190094, -0.03564763814210892, 0.02852383255958557, -0.0664888545870781, -0.0019973120652139187, -0.011708504520356655, -0.006118891295045614, 0.0014492581831291318, -0.031613677740097046, -0.03536154329776764, -0.009205158799886703, -0.001533299102447927, 0.0027912301011383533, 0.031041482463479042, -0.028767015784978867, -0.015535046346485615, -0.013253426179289818, 0.009090719744563103, -0.010142125189304352, 0.015363388694822788, -0.002794806379824877, -0.025691475719213486, -0.00187750905752182, 0.009419730864465237, 0.008811775594949722, 0.00010650393960531801, 0.0072310920804739, -0.02551981806755066, 0.028538137674331665, -0.006397835910320282, -0.033015549182891846, -0.022658852860331535, 0.019111255183815956, 0.03776475414633751, 0.003638791386038065, 0.004491717088967562, -0.008146601729094982, -0.006744727957993746, -0.034417424350976944, 0.002047379035502672, 0.025433989241719246, -0.03424576669931412, 0.0026249364018440247, 0.02300216816365719, 0.029253380373120308, -0.02411794476211071, -0.026063401252031326, 0.030526509508490562, 0.004148400854319334, -0.009462645277380943, 0.005038876552134752, 0.012523879297077656, 0.03324442729353905, 0.013789856806397438, 0.007023672107607126, 0.038336947560310364, -0.0015368752647191286, 0.010235106572508812, 0.02378893457353115, 0.03650593012571335, -0.027064740657806396, 0.029138941317796707, 0.027508189901709557, 0.03224308788776398, -0.027722762897610664, 0.008611508645117283, -0.02715056948363781, -0.0011068362509831786, -0.03244335576891899, 0.00017914565978571773, 0.002378178061917424, 0.029639609158039093, 0.03281528130173683, 0.020484518259763718, 0.007953486405313015, 0.01567809469997883, 0.0014769737608730793, -0.016221677884459496, 0.03069816716015339, 0.03029763139784336, 0.03321581706404686, 0.04280005395412445, 0.010978957638144493, 0.017323151230812073, -0.007030824664980173, -0.0020366504322737455, 0.013875686563551426, -0.021943610161542892, -0.024990539997816086, 0.011479627341032028, 0.011608370579779148, 0.010313782840967178, -0.01313183456659317, 0.01705135777592659, 0.002362085273489356, -0.018295878544449806, -0.01942596025764942, -0.011365188285708427, -0.003908795304596424, 0.05066771060228348, -0.00012058525317115709, 0.012123344466090202, 0.005282058846205473, 0.00782474223524332, 0.01893959566950798, -0.015248949639499187, -0.017895342782139778, -0.010435374453663826, -0.023216741159558296, -0.03192838281393051, 0.024575699120759964, 0.0333588644862175, -0.0191255584359169, 0.017952563241124153, -0.0026338770985603333, -0.01782381907105446, 0.029353512451052666, -0.011029024608433247, 0.0066696275025606155, 0.033902451395988464, 0.010227954015135765, 0.013832771219313145, -0.018410317599773407, -0.0077603706158697605, -0.004466683603823185, -0.028652576729655266, 0.028309261426329613, -0.014126020483672619, 0.03270084410905838, 0.00011611499212449417, -0.005282058846205473, -0.0032132226042449474, 0.006615984253585339, 0.005020995624363422, -0.00891190953552723, 0.04079737886786461, 0.008189516142010689]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
" evaluation details are listed
in Appenidx B.
As shown in Table 4, except DPO and PPO, we also inves-
tigate other alignment methods such as RRHF (Yuan et al.,
2023) and PRO (Song et al., 2023). The results demonstrate
that PPO and DPO are much more preferred by GPT-4 than
the chosen responses in the dataset and SFT model out-
puts, outperforming RRHF and PRO across all metrics. In
this paper, we focus more on the performance of DPO and
PPO. We observe that DPO-Iter performs better than DPO
but worse than PPO. PPO consistently achieves a higher
reward and higher win rates. We also use GPT-4 to compare
the outputs of DPO and PPO directly, and the results are
1https://huggingface.co/OpenAssistant/oasst-rm-2-pythia-
6.9b-epoch-1
7
Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study
Model MethodValid. Set
10@1kTest Set
10@1k
AlphaCode 9B - 16.9% 14.3%
AlphaCode 41B- 16.9% 15.6%
+ clustering 21.0% 16.4%
Code Llama 34BSFT 10.3% 15.2%
DPO 0.0% 0.0%
DPO-Iter 3.5% 3.2%
PPO 19.7% 22.4%
Table 8. Pass rate on CodeContests dataset. “10@1k” means that
1000 samples will be evaluated on public tests in the problem
description, and only 10 of them will be submitted for hidden tests.
Weonly used Python for solving problems , while AlphaCode
used both Python and C++.
listed in Table 5, which demonstrates that GPT-4 prefers the
responses of PPO.
SafeRLHF (Dai et al., 2023) dataset comprises over 30k
entries of expert comparison data. Each entry in this dataset
contains two responses to a question. In our experiments,
we consolidate two preferences as mentioned in Section 4.3.
For evaluation, we borrow the official reward model and
cost model2, which are trained to evaluate helpfulness and
harmlessness, respectively.
The results on SafeRLHF are listed in Tab 6. Experiments
indicate that after alignment, both DPO and PPO can gen-
erate responses with less harm, while PPO’s responses are
more helpful.
APPS (Hendrycks et al., 2021) is a description-to-code
generation benchmark from competitive programming plat-
forms. For each question, there are also test cases to verify
the accuracy of generated codes. We use these test cases
in the training set to provide feedback. For PPO training,
the feedback could be directly used as a reward. We simply
define the reward as 10 if the generated code passes alltest
cases. Otherwise, the reward is 0. For DPO, since there are
no preference pairs, we adopt DPO-Iter. Specifically, we
use the base model to sample 5 codes for each prompt and
utilize the test cases to label the correctness of generated
codes. It is worth noting that for many prompts, the base
model may fail to sample any correct answer. In such cases,
we use the correct solutions from the dataset as yw. We
evaluate the results using pass@k, which is defined as the
proportion of problems successfully solved by employing k
generated programs for each problem.
As shown in Table 7. We conduct experiments on different
model sizes. In particular, when using CodeLlama-34B
as the base model, we achieved state-of-the-art results on
the APPS dataset. We can observe that DPO-Iter fails to
improve the SFT model performances on all the model
2https://github.com/PKU-Alignment/safe-rlhfsizes. In contrast, for PPO, as the model size increases, the
improvement is more apparent. We remark that the feedback
using test cases is nearly perfect. However, the performance
of DPO-Iter remains unsatisfactory.
CodeContest (Li et al., 2022) is a more challenging com-
petitive programming dataset consisting of several program-
ming languages. Here, we only use Python code. We adopt
a similar way to train PPO as in the APPS dataset. For
DPO training, we construct the preference dataset by using
the correct and","[-0.0008511005435138941, 0.0007915830356068909, 0.08129753172397614, 0.0005092999199405313, 0.02520822174847126, -0.01617516204714775, -0.005254546646028757, 0.016488054767251015, 0.03520716354250908, 0.007706668693572283, 0.033329810947179794, -0.00644829822704196, -0.023154016584157944, -0.018814338371157646, 0.0007903076475486159, -0.043804895132780075, 0.03855374827980995, -0.07411462068557739, -0.027792982757091522, 0.03297610953450203, -0.001629079575650394, -0.03137083351612091, 0.01437943335622549, -0.009461585432291031, 0.03060901165008545, -0.006887027528136969, -0.007897124625742435, 0.011862692423164845, 0.01388968899846077, -0.046253617852926254, 0.009155495092272758, -0.022813916206359863, -0.026623036712408066, -0.043723270297050476, 0.01946733146905899, 0.02655501663684845, 0.020596463233232498, 0.05006273835897446, -0.009733665734529495, -0.017630789428949356, -0.03417326137423515, -0.023997465148568153, -0.03006485104560852, -0.015100445598363876, -0.0326768197119236, 0.05177684128284454, 0.04239007830619812, -0.03381955623626709, 0.01912723109126091, 0.004390692338347435, -0.04783168062567711, 0.08717446029186249, -0.015821456909179688, -0.05969437211751938, 0.011917108669877052, -0.02731684222817421, 0.014855572953820229, 0.015930289402604103, 0.03686685487627983, -0.03305773064494133, -0.009978537447750568, -0.01207355409860611, 0.020242759957909584, 0.016283994540572166, -0.008407275192439556, 0.010604321956634521, -0.09011292457580566, 0.008931029587984085, 0.0205556508153677, 0.004577747546136379, -0.004734193906188011, 0.018419822677969933, 0.03044576197862625, -0.021480724215507507, 0.002484431490302086, -0.014216184616088867, 0.03596898913383484, 0.04083922132849693, 0.01078797597438097, 7.545971311628819e-05, 0.008332452736794949, 0.02761613018810749, 0.027942625805735588, -0.050606898963451385, 0.008107987232506275, -0.00038771412800997496, -0.04336956888437271, -0.02748009003698826, -0.060020867735147476, -0.052076131105422974, -0.04116571694612503, -0.02183442749083042, 0.005455206148326397, -0.00751621276140213, 0.040975261479616165, -0.04462113603949547, -0.013923699036240578, -0.02824191376566887, 0.01603912189602852, 0.03327539563179016, -0.012230000458657742, -0.024895329028367996, -0.004999471828341484, 0.004863431677222252, 0.06344907730817795, 0.02984718605875969, 0.01806611754000187, 0.010203003883361816, -0.01437943335622549, 0.010910412296652794, -0.07291746884584427, 0.017930079251527786, -0.07514852285385132, 0.019861847162246704, 0.004264855291694403, -0.04750518500804901, -0.02061006799340248, -0.012617714703083038, 0.004013181198388338, -0.019358498975634575, -0.022065695375204086, 0.021766407415270805, 0.029738355427980423, -0.003622066229581833, 0.01963057927787304, -0.003288768231868744, 0.04581828787922859, -0.06497272849082947, 0.011869493871927261, -0.025874817743897438, -0.017236273735761642, 0.030336931347846985, 0.021385496482253075, -0.007080884650349617, -0.0658433809876442, 0.058497220277786255, -0.049545787274837494, 0.022977164015173912, -0.019263271242380142, 0.0027463084552437067, -0.018528655171394348, -0.04505646228790283, -0.041818711906671524, 0.06818327307701111, -0.0569191575050354, -0.05188567563891411, -0.02356213703751564, -0.035615283995866776, -0.03504391759634018, 0.0645373985171318, -0.007584232836961746, -0.009536406956613064, -0.00901265349239111, 0.033629100769758224, -0.01975301466882229, -0.03507112339138985, -0.020256362855434418, 0.03335702046751976, 0.005274952854961157, -0.02013392746448517, -0.015290901064872742, 0.01912723109126091, -0.048321425914764404, 0.018569465726614, 0.0325135700404644, 0.04285261407494545, -0.014406641013920307, 0.011182491667568684, -0.09321463853120804, -0.019399311393499374, 0.04293423891067505, -0.00046211102744564414, -0.05202171579003334, -0.0018280381336808205, -0.0026068673469126225, -0.029439065605401993, -0.030472971498966217, 0.01976661942899227, -0.040893640369176865, -0.03888024762272835, 0.0132571030408144, 0.024215128272771835, -0.015426941215991974, 0.015930289402604103, -0.014202580787241459, -0.026541413739323616, 0.04614478349685669, -0.006601343397051096, 0.006808804348111153, 0.04162825644016266, 0.05063410475850105, 0.011719849891960621, 0.08276676386594772, -0.019100023433566093, -0.028949322178959846, -0.05047085881233215, 0.05844280496239662, 0.02043321542441845, -0.03792796656489372, 0.024623248726129532, 0.0076590548269450665, 0.021004583686590195, -0.039750903844833374, -0.04513808712363243, -0.008808593265712261, -0.030881090089678764, -0.0284595787525177, -0.02368457242846489, -0.02938465029001236, -0.015046029351651669, 0.026568621397018433, 0.03150687366724014, 0.06480947881937027, 0.010250617749989033, -0.008448086678981781, -0.027452882379293442, -0.06660521030426025, 0.007625044789165258, 0.04206358268857002, 0.04810376092791557, 0.0026170704513788223, 0.01599830947816372, 0.015059633180499077, 0.03014647401869297, -0.00034583930391818285, 0.013291113078594208, 0.017168253660202026, -0.0016809448134154081, 0.03387397155165672, -0.06312258541584015, 0.015304505825042725, 0.019100023433566093, 0.001253268914297223, -0.01336593460291624, 0.024963349103927612, -0.046852193772792816, 0.006472105160355568, -0.030037643387913704, -0.015005216933786869, -0.054361604154109955, 0.014801157638430595, 0.006227233447134495, 0.04538296163082123, -0.028976529836654663, 0.025262637063860893, 0.005040283780544996, -0.035452038049697876, -0.048022136092185974, 0.0018688502022996545, 0.006387080065906048, 0.032785650342702866, -0.01768520660698414, -0.012277614325284958, -0.03398280590772629, -0.03909790888428688, -0.00335678830742836, 0.0322686992585659, -0.009733665734529495, -0.020596463233232498, -0.020065907388925552, -0.028568409383296967, 0.025044972077012062, -0.012012336403131485, 0.020215550437569618, -0.022242547944188118, 0.031942203640937805, -0.021086206659674644, 0.02346690744161606, -0.0411113016307354, -0.02562994509935379, 0.014148165471851826, 0.028786074370145798, 0.015100445598363876, 0.011046451516449451, -0.016896173357963562, -0.02663664147257805, 0.00249123340472579, 0.04834863170981407, -0.037383805960416794, -0.03534320369362831, -0.010971629992127419, -0.0038669384084641933, 0.044648345559835434, 0.011060056276619434, 0.01806611754000187, 0.00416962755843997, -0.0364043153822422, 0.012549694627523422, 0.0034537166357040405, 0.026024460792541504, 0.01680094562470913, -0.043641649186611176, 0.039369989186525345, -0.016107141971588135, 0.028677241876721382, 0.0034741228446364403, 0.026745473966002464, -0.04606315866112709, 0.015807854011654854, 0.02701755426824093, 0.023616552352905273, -0.0182429701089859, -0.005254546646028757, -0.0034299097023904324, 0.043342359364032745, -0.013338726945221424, 0.0164200346916914, 0.022596251219511032, 0.01093761995434761, -0.02246021293103695, -0.01667851023375988, 0.003635670291259885, -0.00326156010851264, 0.028350746259093285, -0.01292380504310131, -0.026840701699256897, 0.05308282747864723, -0.04535575211048126, -0.019780222326517105, -0.03022809885442257, -0.042498912662267685, -0.06252400577068329, 0.007237330544739962, 0.013862481340765953, 0.021671179682016373, 0.009019454941153526, 0.0047648027539253235, -0.013753648847341537, -0.030636219307780266, -0.028405161574482918, 8.672552939970046e-05, -0.00918270368129015, -0.03128921240568161, 0.029792770743370056, -0.022392192855477333, 0.0019521747017279267, -0.021671179682016373, 0.04244449362158775, 0.028976529836654663, 0.07139381766319275, -0.1101924404501915, -0.000797534768935293, -0.015481357462704182, -0.0015882676234468818, -0.027888210490345955, 0.033928386867046356, -0.007482202723622322, 0.02229696325957775, 0.04562783241271973, 0.012005534023046494, 0.00931194145232439, -0.0008574774255976081, 0.032105449587106705, 0.06100035831332207, 0.02292274869978428, 0.011665434576570988, -0.011577008292078972, -0.017617186531424522, -0.024419188499450684, -0.0010126481065526605, -0.021888844668865204, 0.03256798908114433, -0.03313935548067093, 0.028650034219026566, 0.013277508318424225, 0.04268936812877655, -0.038227252662181854, -0.03134362772107124, 0.007114894688129425, -0.015862269327044487, -0.008495701476931572, 0.032105449587106705, -0.014828365296125412, 0.012345634400844574, -0.06382998824119568, 0.044267430901527405, 0.009992141276597977, 0.04867513105273247, -0.03107154741883278, 0.05071572959423065, 0.0041730282828211784, 0.02207930013537407, -0.02584761008620262, -0.013114260509610176, 0.01287619024515152, 0.01806611754000187, 0.005764697212725878, 0.002385802334174514, -0.014202580787241459, -0.017549166455864906, 0.014678721316158772, 0.0017940280959010124, -0.02546669729053974, 0.004740995820611715, -0.02537146955728531, 0.00010856633889488876, -0.0071353004314005375, 0.0445123054087162, 0.024895329028367996, 0.06382998824119568, -0.03820004686713219, -0.02386142499744892, -0.06671404093503952, 0.00573068717494607, -0.042961448431015015, -0.0026833899319171906, -0.0018382411217316985, 0.02047402784228325, 0.0327584445476532, 0.017794039100408554, 0.0322686992585659, -0.017127441242337227, 0.044648345559835434, -0.040512725710868835, 0.0201883427798748, -0.022106507793068886, -0.00398937426507473, -0.0021290266886353493, 0.023711780086159706, 0.051912881433963776, -0.004863431677222252, -0.051531970500946045, -0.02499055676162243, -0.052919577807188034, -0.004587950650602579, 0.011713048443198204, -0.003911151550710201, -0.012692536227405071, 0.018977586179971695, -0.034254882484674454, -0.009699655696749687, 0.05379023402929306, 0.03849933296442032, -0.05074293911457062, -0.06774794310331345, -0.01191030628979206, 0.004067597445100546, 0.01912723109126091, -0.018610278144478798, 0.0031000126618891954, 0.006540125235915184, -0.010924016125500202, -0.010883203707635403, -0.02727602981030941, -0.04162825644016266, -0.053681403398513794, -0.01583506166934967, 0.007523014675825834, 0.015807854011654854, 0.006893829442560673, -0.018338197842240334, 0.008080778643488884, 0.0490560419857502, -0.013379538431763649, 0.01273334864526987, -0.03436371684074402, 0.052293796092271805, -0.020664483308792114, 0.07514852285385132, -0.03115317039191723, 0.02960231527686119, -0.037084516137838364, -0.027888210490345955, -0.003703690366819501, 0.008958237245678902, 0.028867699205875397, 0.013767252676188946, -0.006972052622586489, -0.016352014616131783, -4.7162320697680116e-05, -0.0054994188249111176, -0.04706985503435135, 0.012406852096319199, -0.004230845719575882, -0.05572200566530228, -0.0132571030408144, 0.025276241824030876, -0.0008978643454611301, -0.0031391240190714598, -0.0245280209928751, 0.019821034744381905, -0.044648345559835434, 0.02748009003698826, 0.02073250338435173, 0.022106507793068886, 0.08744654059410095, 0.026500601321458817, 0.016868965700268745, -0.02533065713942051, 0.02346690744161606, 0.017794039100408554, -0.023358076810836792, 0.05289237201213837, -0.015699021518230438, 0.007863114587962627, -0.015222880989313126, 0.02284112386405468, 0.014637908898293972, -0.014161769300699234, -0.00026506552239879966, 0.025235429406166077, -0.005091298837214708, -0.015590189956128597, 0.024228733032941818, 0.006594541482627392, 0.0222153402864933, 0.02601085789501667, -0.02677268162369728, 0.0027395065408200026, 0.007121696602553129, 0.024596041068434715, -0.0023143813014030457, 0.016583282500505447, -0.0006674464675597847, -0.006461902521550655, 0.001239664969034493, -0.024432793259620667, 0.005145714618265629, -0.02348051220178604, 0.04187312722206116, -0.013080250471830368, -0.013447558507323265, -0.01890956610441208, 0.005353176034986973, 0.0038771412800997496, -0.051613595336675644, -0.04949136823415756, -0.08548756688833237, -0.028432369232177734, -0.02135828696191311, 0.011985127814114094, 0.003385696792975068, 0.02410629577934742, -0.014297809451818466, -0.03537041321396828, -0.037683092057704926, 0.0005526627064682543, -0.016365617513656616, -0.032323114573955536, -0.04217241331934929, 0.046171993017196655, 0.0011410359293222427, -0.0015125953359529376, -0.012080356478691101, 0.016202369704842567, -0.00034711469197645783, 0.02541228197515011, -0.008332452736794949, -0.022813916206359863, -0.003676482243463397, 0.05534109100699425, -0.043804895132780075, -0.005441601853817701, -0.02533065713942051, -0.03273123502731323, -0.0003670955775305629, -0.006917636375874281, -0.017889266833662987, 0.012386446818709373, 0.01748114638030529, 0.0225826483219862, -4.756087491841754e-06, -0.005581043194979429, 0.024582436308264732, 0.011706246063113213, 0.052946787327528, 0.01418897695839405, -0.005608250852674246, 0.015726229175925255, 0.03877141326665878, -0.016324805095791817, 0.025303449481725693, 0.025140201672911644, -0.061326853930950165, 0.004948456771671772, -0.011243710294365883, 0.008931029587984085, -0.012332030571997166, 0.02541228197515011, 0.007645450532436371, -0.004574346821755171, -0.02520822174847126, -0.008216818794608116, 0.007080884650349617, -0.03817283734679222, 0.01357679720968008, 0.020106719806790352, 0.020990978926420212, -0.016705717891454697, 0.047559600323438644, 0.0364859402179718, -0.027792982757091522, 0.009033058770000935, -0.007339360658079386, -0.01587587408721447, 0.004570945631712675, -0.008400472812354565, -0.0007163358968682587, -0.02386142499744892, -0.02930302731692791, 0.02418792061507702, 0.0062952530570328236, 0.006298654247075319, -0.04658011347055435, -0.02558913268148899, 0.03858095780014992, -0.005591245833784342, 0.015848666429519653, 0.017794039100408554, -0.019644182175397873, 0.0011631423840299249, -0.009230317547917366, -0.029330234974622726, -0.008883414790034294, -0.036159444600343704, -0.026228521019220352, -0.029330234974622726, 0.001266022678464651, 0.0050674919039011, -0.026378165930509567, 0.001994687132537365, -0.011230106465518475, 0.007094488479197025, -0.010760767385363579, 0.02410629577934742, 0.0001391222031088546, -0.007339360658079386, 0.006002767011523247, -0.040512725710868835, 0.032622404396533966, -0.04538296163082123, 0.017168253660202026, 0.014814761467278004, 0.0056116520427167416, 0.03289448469877243, -0.003761507337912917, 0.024174315854907036, -0.0010237013921141624, -0.010243815369904041, -0.02081412822008133, 0.00994452740997076, 0.04279819875955582, 0.006397283170372248, -0.024228733032941818, -0.0006075038691051304, -0.031234795227646828, 0.028813282027840614, -0.01028462778776884, 0.006546927150338888, -0.03790075704455376, -0.002181742340326309, -0.009856101125478745, 0.0081692049279809, 0.022188132628798485, 0.02001149021089077, -0.002181742340326309, -0.02528984472155571, -0.0023619954008609056, -0.018542258068919182, -0.00572048407047987, -0.05226658657193184, -0.020201947540044785, -0.021371891722083092, 0.0027395065408200026, 0.015331713482737541, 0.022310568019747734, 0.003812522394582629, 0.07030549645423889, 0.0015746635617688298, -0.005519825033843517, -0.04260774329304695, -0.013297914527356625, 0.046090368181467056, -0.026459788903594017, -0.0026000654324889183, 0.015005216933786869, 0.023575739935040474, -0.04995390400290489, -0.03762867674231529, -0.0014998415717855096, -0.03120758756995201, 0.0026340754702687263, -0.054443228989839554, -0.016392825171351433, -0.011005640029907227, -0.01718185842037201, 0.01617516204714775, -0.005822514183819294, -0.001221809652633965, -0.010713153518736362, -0.00964523945003748, -0.005349774844944477, -0.017508354038000107, -0.02516740933060646, -0.013447558507323265, 0.006550328340381384, -0.0010492089204490185, 0.05909579619765282, -0.0050810957327485085, -0.03313935548067093, -0.018814338371157646, -0.002822831040248275, 0.006961849518120289, 0.004941654857248068, -0.04886558651924133, -0.021371891722083092, -0.0329216904938221, 0.034254882484674454, 0.04160104691982269, -0.029874395579099655, -0.008760979399085045, 0.019780222326517105, -0.033465851098299026, 0.03199661895632744, -0.0023619954008609056, 0.019780222326517105, 0.014216184616088867, -0.009189505130052567, -0.0004072698939125985, -0.04973624274134636, -0.0369756855070591, -0.007754282560199499, 0.00966564565896988, 0.020215550437569618, -0.010352647863328457, -0.012236801907420158, -0.017385918647050858, -0.01612074486911297, -0.03678523004055023, 0.02135828696191311, 0.0055946470238268375, 0.024691268801689148, -0.00882219709455967, -0.027139989659190178, -0.01174025610089302, 0.016066329553723335, -0.021263059228658676, 0.028786074370145798, -0.03757426142692566, 0.011060056276619434, 0.03621385991573334, -0.0025745579041540623, -0.008672553114593029, 0.02275950089097023, -0.014175373129546642, -0.01499161310493946, 0.012746952474117279, 0.05101501941680908, 0.02499055676162243, -0.0022276558447629213, -0.017889266833662987, 0.012678932398557663, -0.001578064518980682, -0.006635353434830904, 0.03566969931125641, 0.011753859929740429, -0.014107353053987026, 0.010107775218784809, -0.039669279009103775, 0.01587587408721447, 0.006887027528136969, 0.014297809451818466, -0.0006211078725755215, -0.02009311504662037, 0.013019032776355743, -0.007012864574790001, -0.04674335941672325, -0.023834217339754105, 0.00998533982783556, 0.001624828320927918, -0.018977586179971695, 0.002338188234716654, -0.0022157523781061172, 0.035778533667325974, 0.08135195076465607, -0.04083922132849693, 0.014964405447244644, 0.00030396447982639074, -0.0038193243090063334, 0.014338620938360691, -0.032948900014162064, -0.014678721316158772, 0.0023755994625389576, -0.0014726335648447275, 0.001218408695422113, -0.00041917338967323303, 0.00744139077141881, 0.006761190481483936, 0.018147742375731468, -0.037683092057704926, 0.017345106229186058, 0.01273334864526987, -0.00865214690566063, 0.03556086868047714, 0.024201525375247, 0.02101818658411503, -0.04932812228798866, -0.13223092257976532, -0.05909579619765282, 0.0022735693491995335, 0.004383890423923731, -0.013903292827308178, -0.00895143486559391, 0.05898696556687355, 0.029629522934556007, -0.029166987165808678, 0.004040389321744442, 0.04696102440357208, -0.06203426048159599, 0.01621597446501255, -0.013522380962967873, 0.018229367211461067, -0.042961448431015015, 0.0042852615006268024, -0.013236696831882, 0.03618665412068367, -0.032704029232263565, -0.02195686474442482, -0.010434271767735481, 0.016283994540572166, -0.0006474655820056796, -0.034935083240270615, 0.0015406535239890218, 0.007318954449146986, -0.012971418909728527, -0.014610701240599155, 0.01393050141632557, -0.02101818658411503, 0.01190350390970707, 0.0450020469725132, -0.006686368491500616, -0.028024250641465187, -0.018596675246953964, -0.00918270368129015, 0.014297809451818466, 0.02601085789501667, 0.0068632205948233604, 0.01140015572309494, -0.020746108144521713, 0.02384782023727894, -0.018093327060341835, 0.024011068046092987, -0.04764122515916824, -0.0022956759203225374, -0.008815394714474678, -0.0026765880174934864, 0.0007316403789445758, 0.0031102155335247517, -0.036649189889431, 0.0063564712181687355, 0.0027888210024684668, -0.0018008301267400384, 0.022990768775343895, 0.011182491667568684, -0.020528443157672882, -0.00416962755843997, -0.015848666429519653, -0.0056728702038526535, 0.029629522934556007, 0.0013416949659585953, -0.012325228191912174, -0.014855572953820229, 0.0027173999696969986, -0.019276874139904976, 0.013501974754035473, -0.04606315866112709, -0.032159868627786636, -0.021140623837709427, 0.019358498975634575, 0.014665117487311363, 0.017508354038000107, 0.00554023077711463, -0.004666173830628395, 0.044729966670274734, 0.02946627512574196, -0.05838838964700699, 0.010890006087720394, 0.04647127911448479, -0.023276451975107193, 0.04647127911448479, 0.039206743240356445, 0.011855890043079853, 0.02583400532603264, 0.040295060724020004, -0.0203107800334692, -0.006237436085939407, 0.009720061905682087, 0.018093327060341835, -0.022949956357479095, 0.0013621009420603514, 0.01408014539629221, -0.026337353512644768, -0.02056925557553768, 0.021861635148525238, 0.009366357699036598, -0.0006963550113141537, 0.0038907453417778015, 0.013073449023067951, 0.019943471997976303, -0.05104222521185875, -0.0026068673469126225, 0.021984072402119637, 0.005802107974886894, 0.03474462777376175, 0.016732925549149513, 0.004288662690669298, -0.01450186874717474, -0.005417794920504093, 0.008903820998966694, -0.01599830947816372, 0.0018603476928547025, -0.04056714102625847, 0.022691480815410614, 0.044648345559835434, 0.0008834100444801152, 0.013665222562849522, 0.03594177961349487, 0.0035336401779204607, 0.02334447205066681, -0.007774688769131899, 0.04356002435088158, 0.013331924565136433, 0.014909989200532436, -0.02474568411707878, 0.06312258541584015, -0.02292274869978428, -0.008427681401371956, 0.013835272751748562, 0.0035132342018187046, -0.008033164776861668, 0.0013085352256894112, -8.289940160466358e-05, -0.00035327899968251586, 0.04875675216317177, -0.006560531444847584, -0.014950801618397236, -0.0014726335648447275, -0.00026867908309213817, 0.017576374113559723, 0.04157383739948273, 0.004468915518373251, -0.0019368701614439487, 0.008720166981220245, 0.011189294047653675, -0.030962714925408363, -0.02271868847310543, 0.01499161310493946, 0.004931451752781868, -0.007842708379030228, -0.004060795530676842, 0.006196624133735895, 0.005475611891597509, 0.004122013691812754, -0.01667851023375988, -0.020718898624181747, 0.019644182175397873, -0.01534531731158495, 0.03556086868047714, 0.016283994540572166, -0.027139989659190178, -0.01722267083823681, 0.010672342032194138, -0.02524903230369091, -0.018678298220038414, 0.015168465673923492, 0.029874395579099655, 0.01680094562470913, -0.014828365296125412, -0.006431293208152056, 0.03074505180120468, 0.008931029587984085, 0.03479904308915138, 0.010196201503276825, 0.005649062804877758, 0.02322203665971756, -0.0183245949447155, 0.04799493029713631, 0.008876613341271877, 0.030037643387913704, 0.011835483834147453, 0.017766829580068588, 0.024215128272771835, -0.04160104691982269, 0.015277297236025333, 0.0019589767325669527, 0.01764439418911934, 0.01534531731158495, 0.012277614325284958, 0.03357468545436859, -0.002851739525794983, 0.018297387287020683, 0.030962714925408363, 0.0010628128657117486, 0.026704661548137665, 0.02748009003698826, -0.012869388796389103, -0.052919577807188034, -0.019997887313365936, 0.04336956888437271, 0.017236273735761642, -0.03357468545436859, -0.026187708601355553, 0.0327584445476532, 0.01374004501849413, -0.022065695375204086, -0.012311624363064766, 0.025643549859523773, 0.01042746938765049, 0.00994452740997076, 0.0011852489551529288, 0.005958554334938526, -0.01579424925148487, -0.04309748858213425, -0.018297387287020683, 0.016624093055725098, -0.01422978937625885, -0.003285367274656892, -0.017467541620135307, 0.01650165766477585, -0.001661389134824276, -0.018297387287020683, -0.0040369885973632336, -0.0059721581637859344, 0.04317910969257355, -0.019494539126753807, 0.01650165766477585, 0.024174315854907036, -0.027180802077054977, 0.009046663530170918, -0.003368691774085164, -0.001233713235706091, -0.005533428862690926, -0.01912723109126091, -0.016692113131284714, -0.0032343522179871798, 0.009862903505563736, -0.012134772725403309, 0.05417114868760109, 0.013148270547389984, 0.016011914238333702, 0.004924649838358164, 0.024215128272771835, 0.01146137434989214, 0.021861635148525238, 0.02153513953089714, -0.018542258068919182, -0.017848454415798187, 0.002045702189207077, -0.01663769781589508, -0.00994452740997076, -0.02065087854862213, 0.012678932398557663, -0.002814328530803323, 0.0026544814463704824, 0.02709917724132538, 0.03999577462673187, 0.02009311504662037, -0.048920001834630966, 0.03613223508000374, 0.009196307510137558, -0.016283994540572166, 0.009577219374477863, 0.0021460317075252533, -0.014297809451818466, 0.01093761995434761, 0.05985762178897858, -0.01730429381132126, -0.01613434962928295, 0.017290690913796425, -0.0029333634302020073, 0.02436477318406105, 0.008937831036746502, 0.011488582007586956, 0.009563615545630455, 0.011883098632097244, 0.019344894215464592, -0.019984282553195953, -0.0081487987190485, 0.014297809451818466, 0.013957709074020386, -7.923269731691107e-05, 0.023698177188634872, -0.03107154741883278, -0.004567544441670179, -0.00037559805787168443, 0.01503242552280426, 0.014610701240599155, 0.037138931453228, 0.0203107800334692, -0.013440757058560848, -0.011957920156419277, 0.01553577370941639, 0.01744033396244049, 0.0064516994170844555, 0.01924966648221016, 0.014978009276092052, -0.02558913268148899, 0.014814761467278004, 0.024391980841755867, 0.03471742197871208, -0.007795094978064299, 0.02537146955728531, 0.007679460570216179, 0.009726863354444504, -0.03964206948876381, 0.00047741553862579167, -0.014705928973853588, 0.013236696831882, -0.02386142499744892, 0.01302583422511816, 0.01942651905119419, -0.030881090089678764, -0.008556919172406197, -0.009039861150085926, -0.02892211452126503, -0.016651302576065063, 0.012624516151845455, 0.019480934366583824, 0.0004417050222400576, 0.027942625805735588, 0.03550645336508751, -0.010386657901108265, -0.002445319900289178, 0.0023007772397249937, 0.006220431067049503, -0.02478649653494358, -0.0038703393656760454, 0.010359449312090874, -0.005513023119419813, 0.01469232514500618, -0.02631014585494995, -0.06290491670370102, -0.016950590535998344, -0.04225403815507889, -0.0017804241506382823, -0.01988905481994152, -0.05425276979804039, 0.04162825644016266, 0.002906155539676547, -0.010345845483243465, -0.01308705285191536, 0.010903609916567802, 0.045491792261600494, -0.006648957263678312, 0.011651829816401005, -0.011624622158706188, -0.02013392746448517, 0.06252400577068329, -0.005567438900470734, -0.01399852056056261, 0.013957709074020386, 0.003280265722423792, 0.02854120172560215, -0.009584021754562855, -0.020868543535470963, -0.02490893378853798, 0.026500601321458817, 0.007434588856995106, 0.0014896385837346315, 0.0014530777698382735, 0.00597555935382843, 0.020079510286450386, -0.01705942116677761, -0.012808170169591904, 0.0222153402864933, 0.024310356006026268, -0.005278354045003653, -0.0008642794564366341, 0.01575343683362007, 0.010196201503276825, 0.009046663530170918, 0.010148587636649609, 0.004162825644016266, -0.012087157927453518, -0.004985867999494076, 0.014556284993886948, 0.02621491812169552, -0.011468175798654556, -0.03180616348981857, -0.03360189124941826, -0.007489004638046026, -0.012821774929761887, -0.005938148126006126, -0.021222246810793877, 0.04614478349685669, -0.012808170169591904, -0.024800101295113564, -0.013712836429476738, 0.008522909134626389, 0.010495489463210106, 0.006441496312618256, 0.0009403768344782293, 0.00580550916492939, 0.0030455966480076313, -0.00015846539463382214, 0.006080990191549063, 0.002851739525794983, 0.016161557286977768, -0.02799704112112522, -0.002487832447513938, -0.006441496312618256, 0.0182021576911211, 0.00031714336364530027, 0.01275375485420227, 0.016297597438097, 0.03360189124941826, -0.0002854715276043862, -0.029411857947707176, -0.013706034980714321, -0.03128921240568161, -0.000831119657959789, -0.008291641250252724, -0.027303237468004227, -0.010760767385363579, -0.010760767385363579, -0.007645450532436371, 0.027969833463430405, -0.018419822677969933, 0.008005957119166851, -0.018392615020275116, -0.024963349103927612, 0.017549166455864906, -0.03137083351612091, -0.0018943577306345105, 0.01612074486911297, 0.013413548469543457, 0.029629522934556007, 0.006808804348111153, 0.001198852900415659, -0.008346056565642357, -0.005305561702698469, -0.016352014616131783, -0.009060267359018326, 0.0033993006218224764, -0.0019334692042320967, -0.031398043036460876, 0.0447571761906147, 0.0034554172307252884, 0.0182429701089859, 0.04562783241271973, 0.005632057785987854, -0.011577008292078972, -0.010264221578836441, -0.003411204321309924, 0.024419188499450684, 0.01612074486911297, 0.015168465673923492, 0.004135617520660162, 0.004411098547279835, -0.020487630739808083, 0.02384782023727894, -0.006325862370431423, -0.026201313361525536, -0.023752592504024506, 0.0017226070631295443, 0.01065873820334673, 0.025276241824030876, 0.015562981367111206, -0.00884260330349207, 0.036921270191669464, 0.022364983335137367, -0.008420879021286964, 0.062469590455293655, -0.009706457145512104, 0.03754705190658569, 0.007910728454589844, -0.004312469623982906, 0.012481674551963806, 0.006499313283711672, 0.0015244988026097417, 0.03245915472507477, 0.015549377538263798, 0.01454268116503954, -0.011862692423164845, -0.017426731064915657, -0.011536195874214172, 0.010890006087720394, -0.020977376028895378, -0.004581148736178875, 0.014488264918327332, -0.014243393205106258, 0.018882358446717262, 0.01272654626518488, -9.571958798915148e-06, -0.02241940051317215, -0.001258370466530323, 0.002928262110799551, 0.012617714703083038, 0.04453951120376587, -0.03349306061863899, -0.02047402784228325, -0.0004514829197432846, -0.010100973770022392, -0.005557235796004534, -0.0450836718082428, 0.008346056565642357, 0.010529499500989914, 0.004411098547279835, -0.028350746259093285, 0.0002548625343479216, 0.03436371684074402, -0.00668296730145812, 0.003676482243463397, -0.0017549166223034263, -0.026418976485729218, -0.017726019024848938, 0.006829210557043552, 0.010883203707635403, -0.018923170864582062, -0.0016936985775828362, 0.034309301525354385, 0.014624305069446564, -0.01812053471803665, -0.028323538601398468, -0.005502820014953613, -0.0017566171009093523, 0.013522380962967873, -0.0006627701222896576, -0.005883731879293919, -0.012236801907420158, 0.01157020591199398, -0.028187498450279236, -0.028432369232177734, -0.013780856505036354, 0.01816134713590145, -0.010944422334432602, 0.006308857351541519, 0.012161980383098125, 0.006465303245931864, 0.033166565001010895, 0.008033164776861668, 0.003690086305141449, 0.007795094978064299, 0.025997253134846687, 0.01714104600250721, 0.006159213371574879, 0.017875662073493004, -0.013631212525069714, -0.008380066603422165, 0.0063224611803889275, 0.011277720332145691, -0.0035472442395985126, 0.050089944154024124, 0.016365617513656616, -0.02292274869978428, 0.025915630161762238, -0.016488054767251015, -0.025616340339183807, -0.019154438748955727, 0.004778406582772732, -0.0002516740933060646, -0.016991402953863144, -0.0050776950083673, 0.016528865322470665, -0.028432369232177734, 0.01304624043405056, 0.010087369941174984, 0.025521112605929375, 0.005135511979460716, -0.016066329553723335, 0.016705717891454697, 0.011542998254299164, -0.018759923055768013, 0.011053253896534443, 0.011019243858754635, -0.02550750970840454, -0.008536512963473797, -0.00040216839988715947, -0.000845148810185492, 0.0447571761906147, -0.029166987165808678, -0.0205556508153677, 0.004836223553866148, -0.002181742340326309, 0.030663426965475082, -0.004098206292837858, 0.013672024942934513, 0.017998099327087402, -0.053980689495801926, -0.025385072454810143, 0.005921143107116222, -0.0013110860018059611, 0.028677241876721382, 0.01289659645408392, -0.009005851112306118, 0.0013850576942786574, 0.024269545450806618, -0.04385931044816971, 0.02280031144618988, -0.007210122421383858, -0.006237436085939407, -0.029030947014689445, 0.044566720724105835, 0.004849827848374844, 0.03414605185389519, -0.027520902454853058, -0.020759711042046547, 0.02617410570383072, -0.01059751957654953, -0.02693592943251133, -0.0265142060816288, 0.024936141446232796, -0.04470276087522507, -0.004710386507213116, -0.015277297236025333, -0.011747058480978012, 0.008155601099133492, -0.012699338607490063, -0.01302583422511816, -0.023657364770770073, 0.016011914238333702, 0.012685734778642654, 0.022405795753002167, -0.010434271767735481, -0.01992986723780632, -0.02183442749083042, -0.011828682385385036, -0.006846215575933456, 0.0046355645172297955, -0.004696782678365707, -0.015277297236025333, 0.019276874139904976, 0.00597555935382843, 0.019222458824515343, 0.013229894451797009, -0.0006215329631231725, -0.025697965174913406, 0.03177895396947861, -0.008080778643488884, -0.02719440497457981, -0.019358498975634575, -0.0042240433394908905, 0.04230845347046852, -0.007210122421383858, -0.004193434491753578, -0.02301797643303871, 0.002926561515778303, -0.02296355925500393, -0.00947518926113844, 0.018596675246953964, -0.010413865558803082, -0.007713470607995987, 0.020705295726656914, 0.022269755601882935, -0.02673186920583248, -0.028024250641465187, 0.007203320506960154, 0.0081692049279809, -0.002926561515778303, 0.02541228197515011, -0.0004072698939125985, 0.0445123054087162, -0.0006355621153488755, 0.0030711041763424873, 0.03289448469877243, -0.0132571030408144, 0.0030728045385330915, 0.03161570802330971, 0.005033481866121292, -0.014270600862801075, 0.03847212716937065, 0.029656730592250824, 0.03191499412059784, -0.02753450535237789, 0.014025729149580002, -0.028650034219026566, -0.0011852489551529288, -0.024011068046092987, 0.014583493582904339, -0.011304927989840508, 0.007747480645775795, 0.05166801065206528, 0.02562994509935379, -0.0030353935435414314, 0.015848666429519653, 0.0022225542925298214, -0.026786286383867264, 0.0265142060816288, 0.03474462777376175, 0.033928386867046356, 0.03643152490258217, 0.0182429701089859, -0.002089915331453085, -0.025643549859523773, -0.004625361878424883, 0.015399733558297157, -0.008155601099133492, -0.024473603814840317, 0.0033993006218224764, 0.0036288683768361807, 0.02009311504662037, -0.023738987743854523, 0.01705942116677761, -0.011522592045366764, 0.005553835071623325, -0.007318954449146986, -0.011155284009873867, 0.014052936807274818, 0.04048551991581917, 0.02175280451774597, 0.01773962192237377, -0.003717294428497553, 0.0037513042334467173, -0.0028058260213583708, -0.01718185842037201, -0.02157595194876194, -0.009801685810089111, -0.0002969499328173697, -0.016664905473589897, 0.023738987743854523, 0.036377109587192535, -0.04391372948884964, -0.009005851112306118, -0.0010755666298791766, -0.013821668922901154, 0.009087475016713142, -0.00899224728345871, 0.0004693381779361516, 0.029901603236794472, 0.01802530698478222, 0.01403933297842741, -0.011114471592009068, -0.0077270749025046825, -0.0018433426739647985, -0.003207144094631076, 0.036377109587192535, -0.007162508554756641, 0.019276874139904976, -0.005298759788274765, -0.015290901064872742, -0.01651526242494583, -0.0022446608636528254, 0.01848784275352955, -0.014052936807274818, 0.037084516137838364, -0.0009743868722580373]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
" incorrect codes provided by the dataset. To
compare with previous work, we adopt k@n to evaluate
the generated code, which means that n samples will be
evaluated on public tests in the problem description, and k
of them will be submitted for hidden tests.
The results are listed in Table 8. We obtained similar con-
clusions as in APPS. PPO improves the SFT model signifi-
cantly, while DPO fails to generate any correct codes. After
one epoch of training, the code written by the DPO model
has achieved a pass rate of 0, we observe that the DPO
model outputs many meaningless code snippets. The results
also demonstrate that DPO-Iter performs worse compared
to SFT. With the assistance of PPO, CodeLlama-34B has
surpassed the previous state-of-the-art on this task, outper-
forming Alphacode with 41 billion parameters.
7. Conclusion
In this paper, we uncover the fundamental limitations of
DPO and explore critical factors that enhance the practical
performance of PPO in RLHF. Through theoretical and ex-
perimental analysis, we explore the limitations of DPO and
find that DPO is sensitive to the distribution shift between
the base model outputs and preference data. We suggest that
iterative DPO is better than training on static data. However,
we also find that DPO fails to improve the performance on
challenging tasks such as code generation. Moreover, ac-
cording to the ablation study, we summarize the key factors
for PPO training, including advantage normalization, large
batch size, and updating the parameters of the reference
model with an exponential moving average. With our practi-
cal tuning guideline, PPO demonstrates robust effectiveness
across diverse tasks and achieves state-of-the-art results in
challenging code competition tasks.
There are also limitations in our work. The reward model
is significant in the training processes of both PPO and
DPO-Iter. However, in this paper, we have not delved into
the discussion of how to effectively train a robust reward
model. For the code competition task, we utilize the ground-
truth reward for PPO training and the labeling of DPO-Iter.
However, this does not affect the conclusions drawn in our
paper, and we leave it as future works.
8
Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study
Impact Statements
Our study investigates a critical challenge in aligning Large
Language Models (LLMs) with human preferences, empha-
sizing its societal impact, including the elimination of bias
and the reduction of unfairness. The use of a public dataset
ensures transparency, mitigating concerns related to privacy
and ethical considerations. This research emphasizes our
dedication to responsible AI practices, aiming to improve
societal well-being by aligning LLMs with human values
while upholding rigorous standards for privacy and ethics.
References
Agrawal, A., Mackey, L., and Kalai, A. T. Do language
models know when they’re hallucinating references?
CoRR , abs/2305.18248, 2023. doi: 10.48550/ARXIV .
2305.18248. URL https://doi.org/10.48550/
arXiv.2305.18248 .
Andrychowicz, M., Raichuk, A., Stanczyk, P., Orsini, M.,
Girgin, S., Marinier, R., Hussenot, L., Geist, M., Pietquin,
O., Michalski, M., Gelly, S., and Bachem, O. What
matters for on-policy deep actor-critic methods? A large-
scale study. In 9th International Conference on Learn-
ing Representations, ICLR 2021, Virtual Event, Austria,
May 3-7, 2021 . OpenReview.net, 2021. URL https:
//openreview.net/forum?id=nIAxjsniDzg .
Anil, R., Dai, A. M., Firat, O., Johnson, M., Lepikhin, D.,
Passos, A., Shakeri, S., Taropa, E., Bailey, P., Chen, Z.,
Chu, E., Clark, J. H., Shafey, L. E., Huang, Y ., Meier-
Hellstern, K., Mishra, G., Moreira, E., Omernick, M.,
Robinson, K., Ruder, S., Tay, Y ., Xiao, K., Xu, Y .,
Zhang, Y ., ´Abrego, G. H., Ahn,","[0.006418626289814711, 0.019507722929120064, 0.02148163877427578, 0.0009452669182792306, 0.01792859099805355, 0.020474260672926903, -0.014429997652769089, 0.007739107124507427, -0.01982082612812519, 0.014076054096221924, 0.032671693712472916, -0.017302384600043297, -0.028723863884806633, -0.001681230845861137, -0.004645506385713816, -0.025892315432429314, 0.03640171140432358, -0.05717546120285988, 0.000391592358937487, 0.0378447100520134, -0.009794700890779495, -0.01557350717484951, -0.0017986447783187032, 0.016172487288713455, 0.04579482227563858, -0.02198532596230507, 0.0036653554998338223, 0.018350601196289062, -0.0053329733200371265, -0.036973465234041214, 0.018772609531879425, -0.018500346690416336, -0.03188212588429451, -0.026504911482334137, -0.016335846856236458, 0.019058486446738243, -0.00021579056920018047, 0.03452308848500252, 0.004240513313561678, 0.0016276288079097867, -0.025102751329541206, -0.07530824840068817, -0.0008372121374122798, 5.7909299357561395e-05, -0.031283143907785416, 0.059625837951898575, 0.0584823302924633, -0.022625146433711052, 0.021059628576040268, 0.009263786487281322, -0.05295536667108536, 0.07460036128759384, -0.02759396657347679, -0.061477236449718475, -0.0015850876225158572, 0.0004445562371984124, 0.025143589824438095, 0.016145261004567146, 0.02549753338098526, -0.023319421336054802, -0.020242836326360703, -0.046666067093610764, 0.03024854138493538, 0.015655186027288437, -0.03024854138493538, -0.0036823719274252653, -0.09039168059825897, -0.007827593013644218, 0.033896882086992264, 0.019208231940865517, 1.3560028264691937e-06, 0.022516241297125816, 0.02856050431728363, -0.03237220272421837, -0.01696205325424671, -0.03708237037062645, 0.026967760175466537, 0.06719478219747543, -0.014715874567627907, -0.0022631953470408916, -0.009127654135227203, 0.036946240812540054, 0.025797024369239807, -0.0264640711247921, -0.0030680762138217688, -0.010625106282532215, -0.04484189674258232, -0.008943876251578331, -0.05924466997385025, -0.021399958059191704, -0.03111978806555271, -0.028914447873830795, -0.023333033546805382, -0.00860354583710432, 0.07095202803611755, -0.014743100851774216, -0.0009699408547021449, -0.0032263295724987984, 0.02734893001616001, 0.04421569034457207, -0.04998768866062164, -0.02099156193435192, 0.009753861464560032, -0.011741389520466328, 0.03490425646305084, 0.02478964626789093, 0.000820195593405515, -0.012878092005848885, 0.022543467581272125, 0.029921825975179672, -0.1104847714304924, 0.008338088169693947, -0.08423851430416107, 0.014824780635535717, -0.013708497397601604, -0.05810115858912468, -0.027512287721037865, 0.02760758064687252, 0.014307478442788124, 0.004751008469611406, -0.045195840299129486, 0.022026166319847107, 0.030302993953227997, 0.0115780308842659, 0.009876380674540997, -0.020950723439455032, 0.056086406111717224, -0.06904617697000504, 0.004849704448133707, -0.0240817591547966, 0.004672732669860125, 0.0330800898373127, 0.0027941104490309954, -0.039532747119665146, -0.08930262923240662, 0.02926839143037796, -0.01630862057209015, 0.011836681514978409, -0.01180264912545681, -0.009889993816614151, -0.016240553930401802, -0.014361931942403316, -0.05009659379720688, 0.04290882125496864, -0.06665025651454926, -0.026545749977231026, -0.02195809967815876, -0.03376074880361557, -0.02406814694404602, 0.07394693046808243, -0.013837822712957859, -0.0003305456484667957, 0.0052751172333955765, 0.03800806775689125, -0.05009659379720688, -0.053499896079301834, 0.008174729533493519, 0.04083961620926857, 0.01028477679938078, -0.02647768333554268, 0.010536620393395424, 0.05202966928482056, -0.017057346180081367, 0.025851476937532425, 0.05328208580613136, 0.03395133465528488, -0.014089667238295078, 0.008052211254835129, -0.08151587098836899, -0.018486732617020607, 0.006398206576704979, 0.000462423573480919, -0.04176531359553337, -0.002428255509585142, -0.00720138568431139, -0.023564457893371582, -0.006085102912038565, 0.010985856875777245, -0.04465131461620331, -0.062457386404275894, -0.007255838252604008, 0.035503238439559937, -0.040267862379550934, 0.012558181770145893, -0.02197171375155449, -0.026559364050626755, 0.03866150230169296, -0.008276828564703465, -0.016104422509670258, 0.05271033197641373, 0.036238353699445724, 0.028478825464844704, 0.06403651833534241, 0.0010899072512984276, 0.004216690547764301, -0.03095642849802971, 0.06561564654111862, 0.00536360265687108, -0.02853327803313732, -0.005438475403934717, 0.02003863826394081, 0.024925779551267624, -0.03847091645002365, -0.06572455167770386, 0.0002626923087518662, -0.025878703221678734, -0.003171876771375537, -0.029213938862085342, -0.0321543924510479, -0.020025024190545082, 0.03237220272421837, 0.022107845172286034, 0.07073421776294708, 0.0013664254220202565, -0.012803219258785248, -0.020719299092888832, -0.05695765092968941, 0.0231560617685318, 0.04952483996748924, 0.04761899262666702, 0.00980831403285265, 0.023496393114328384, -0.0033896882086992264, 0.025102751329541206, -0.00897790864109993, 0.008344895206391811, 0.01677146926522255, -0.010468554683029652, 0.03376074880361557, -0.020896270871162415, 0.038607049733400345, 0.014688648283481598, -0.004693152382969856, -0.01206129975616932, 0.021073240786790848, -0.037164051085710526, 0.0001275174436159432, -0.03022131510078907, -0.0010482168290764093, -0.02760758064687252, 0.029676787555217743, -0.00909362081438303, 0.03926048427820206, -0.031065333634614944, 0.022706827148795128, 0.04503248259425163, -0.03376074880361557, -0.02454460971057415, 0.01308909710496664, -0.030983654782176018, 0.039587199687957764, -0.011857101693749428, -0.008555899374186993, -0.02080097794532776, -0.037626899778842926, -0.0012285917764529586, 0.009617729112505913, -0.021291052922606468, 0.002918330952525139, -0.02009309083223343, -0.034332502633333206, 0.021100468933582306, -0.016186101362109184, 0.0037878742441534996, -0.008120276965200901, 0.006023843307048082, -0.017370449379086494, 0.0189223550260067, -0.003102109069004655, -0.002322753192856908, -0.0006564117502421141, 0.013048257678747177, 0.009216140024363995, -0.0007036325405351818, -0.022053392603993416, -0.023441938683390617, 0.020378967747092247, 0.06044263020157814, -0.03414192050695419, -0.008869003504514694, 0.006166781764477491, 0.036973465234041214, 0.06164059415459633, 0.005121968686580658, 0.01583215780556202, 0.027525901794433594, -0.03468644618988037, -0.018527572974562645, -0.03705514594912529, 0.007214998826384544, 0.014538902789354324, -0.01607719622552395, 0.020474260672926903, -0.02997627854347229, 0.011475931853055954, -0.00301532493904233, 0.02642323076725006, -0.021154921501874924, 0.0193171389400959, 0.008869003504514694, 0.047782350331544876, -0.02052871324121952, -0.0005772850126959383, -0.018527572974562645, 0.02551114745438099, 0.004516180604696274, 0.021536091342568398, 0.0147703280672431, 0.003641532501205802, -0.025320561602711678, 0.02058316580951214, 0.013279682025313377, -0.003716405015438795, 0.016403911635279655, -0.03517652302980423, -0.02357807196676731, 0.04655716195702553, -0.03686456009745598, 0.006779376417398453, -0.030738618224859238, -0.04250042513012886, -0.04230984300374985, -0.0011171336518600583, 0.00713331950828433, 0.004676136188209057, 0.030602484941482544, 0.004277949687093496, 0.002013052813708782, -0.012306337244808674, -0.04301773011684418, 0.006296107545495033, 0.002884297864511609, -0.0009495210833847523, 0.027498673647642136, -0.018282534554600716, -0.021127695217728615, -0.03476812690496445, 0.05897240340709686, 0.054398369044065475, 0.040022823959589005, -0.09627258777618408, 0.028996126726269722, -0.013191196136176586, 0.0018479926511645317, -0.0276211928576231, 0.012564988806843758, -0.007310291286557913, -0.005064112134277821, 0.052764784544706345, 0.01769716665148735, 0.01863647811114788, -0.017070960253477097, 0.04467853903770447, 0.05216580256819725, -0.01014864444732666, 0.027321703732013702, -0.003091899212449789, -0.0008848583674989641, -0.0036040961276739836, 0.013899082317948341, -0.02198532596230507, 0.026532137766480446, -0.021890034899115562, 0.03022131510078907, 0.02005225047469139, 0.017751619219779968, -0.03915157914161682, -0.016199713572859764, 0.016703402623534203, -0.013388587161898613, 0.004822478163987398, 0.031991031020879745, -0.013490686193108559, 0.019262684509158134, -0.05260142683982849, 0.026981372386217117, 0.006929121445864439, 0.035993315279483795, -0.02078736387193203, 0.03324344754219055, -0.007657427806407213, 0.02359168417751789, -0.011121988296508789, -0.01145551260560751, -0.006309720687568188, 0.021168533712625504, 0.002737955888733268, -0.015491827391088009, -0.01486562006175518, -0.00992402620613575, 0.013225228525698185, 4.506715413299389e-05, -0.045413654297590256, 0.038334786891937256, -0.038144201040267944, -0.016621723771095276, -0.017833298072218895, 0.04225539043545723, 0.054888442158699036, 0.04791848361492157, -0.03808974847197533, -0.022012552246451378, -0.03117424063384533, -0.00010438563185743988, -0.036973465234041214, 0.03286227583885193, 0.018064722418785095, 0.04277269169688225, 0.014920072630047798, 0.04462408646941185, 0.04960652068257332, -0.014988139271736145, 0.03721850365400314, -0.028424372896552086, 0.013517912477254868, -0.040240634232759476, 0.004158833995461464, 0.00860354583710432, 0.019698308780789375, 0.05518793314695358, 0.018963195383548737, -0.024966618046164513, -0.03310731425881386, -0.07051640003919601, -0.005070919170975685, 0.019058486446738243, -0.00436983909457922, -0.03683733195066452, 0.030629711225628853, -0.0386342778801918, -0.025688117370009422, 0.05320040509104729, 0.05548742413520813, -0.05567800998687744, -0.04917089641094208, -0.054425593465566635, 0.0052512940019369125, 0.030847523361444473, 0.012231464497745037, -0.02601483464241028, 0.004468534607440233, 0.01109476201236248, -0.03596608713269234, -0.007575748488306999, -0.00909362081438303, -0.04195589944720268, -0.010557040572166443, 0.01602274179458618, 0.011190054938197136, -0.005588220898061991, -0.000178354253876023, 0.0028979110065847635, 0.06910063326358795, 0.015274016186594963, 0.012871285900473595, -0.06910063326358795, 0.07737746089696884, -0.017846912145614624, 0.02386394888162613, 0.0008401899831369519, 0.026981372386217117, -0.006289300974458456, -0.02336025983095169, -0.004019299056380987, 0.021386345848441124, 0.024394864216446877, -0.008412960916757584, -0.0198480524122715, 0.005496331490576267, 0.015668800100684166, -0.008297248743474483, -0.0381714291870594, -0.012544568628072739, -0.0387704074382782, -0.03683733195066452, 0.00020547432359308004, 0.02834269404411316, -0.04345335066318512, -0.026586590334773064, -0.02834269404411316, 0.02360529825091362, -0.040730711072683334, 0.01798304356634617, 0.02097794972360134, 0.04111187905073166, 0.0004564677947200835, 0.001589341671206057, 0.0152331767603755, -0.042173709720373154, 0.051621273159980774, 0.003784470958635211, -0.03239942714571953, 0.07378356903791428, -0.015750478953123093, -0.01237440388649702, -0.029921825975179672, -0.007868432439863682, 0.01240843627601862, -0.008038598112761974, -0.02666826918721199, 0.014675035141408443, -0.03896099328994751, -0.0066908905282616615, 0.027335315942764282, -0.007146932650357485, 0.0372457280755043, 0.033379580825567245, -0.025551985949277878, 0.006353963632136583, 0.0309292022138834, 0.02476241998374462, 0.006006826646625996, 0.027553128078579903, 0.00801137089729309, 0.004104381427168846, -0.003699388587847352, -0.03901544585824013, -0.003896780079230666, -0.027008598670363426, 0.04748285934329033, 0.020732911303639412, -0.005462298635393381, -0.019017647951841354, 0.007623394951224327, 0.007180965971201658, -0.03403301164507866, -0.03280782327055931, -0.05859123542904854, -0.029840145260095596, -0.0030782860703766346, 0.024217892438173294, 0.007657427806407213, 0.0031361421570181847, -0.002732850844040513, -0.047836802899837494, -0.0321543924510479, 0.011863908730447292, -0.019494110718369484, -0.03844369202852249, -0.019548563286662102, 0.02809765562415123, 0.020692072808742523, 0.0196166280657053, 0.0021934276446700096, 0.02146802470088005, -0.019466882571578026, 0.011877521872520447, -0.0055609941482543945, -0.006983574479818344, 0.004036315251141787, 0.0415475033223629, -0.039342161267995834, -0.0028349498752504587, -0.021331893280148506, -0.033679068088531494, -0.015668800100684166, 0.0001449593692086637, -0.03465922176837921, 0.012775992974638939, 0.0008142398437485099, 0.011673323810100555, -0.014361931942403316, -0.026300713419914246, 0.034305278211832047, 0.008392540737986565, 0.021318279206752777, 0.006704503670334816, -0.03376074880361557, 0.022039778530597687, 0.05222025513648987, -0.02665465511381626, -0.007739107124507427, 0.0266954954713583, -0.03288950398564339, 0.01820085570216179, -0.0147703280672431, 0.008576319552958012, 0.005884307902306318, 0.031038107350468636, 0.024680741131305695, -0.014307478442788124, -0.024272345006465912, -4.171703039901331e-05, -0.014198573306202888, -0.048980314284563065, 0.016921214759349823, 0.017615487799048424, 0.0058298553340137005, -0.039995595812797546, 0.04936148226261139, 0.05924466997385025, -0.023264966905117035, -0.0023159466218203306, -0.0367828793823719, -0.039559975266456604, 0.009052781388163567, 0.027267249301075935, -0.01674424298107624, -0.013912695460021496, -0.0023159466218203306, 0.02547030709683895, 0.008644385263323784, -0.006769166328012943, -0.025116363540291786, -0.022706827148795128, 0.01626778021454811, -0.00666026072576642, 0.011469125747680664, 0.01820085570216179, -0.012986998073756695, -0.01357917208224535, 0.00027120058075524867, 0.002571194199845195, -0.02404092065989971, -0.033842429518699646, -0.021903647109866142, -0.008909842930734158, -0.019888892769813538, 0.04081238806247711, -0.02380949631333351, -0.017179865390062332, -0.023550845682621002, -0.0037027918733656406, 0.007126512937247753, 0.006925718393176794, 0.016009129583835602, -0.012660280801355839, 0.008555899374186993, -0.031283143907785416, 0.01933075115084648, -0.04465131461620331, -0.015151496976613998, -0.0003467113128863275, -0.0034407377243041992, 0.053254857659339905, -0.0012336967047303915, 0.0010584266856312752, -0.015954677015542984, -0.011196861043572426, -0.030656937509775162, 0.019752761349081993, 0.02149525098502636, 0.02406814694404602, -0.015641571953892708, -0.003132738871499896, -0.02097794972360134, 0.036728426814079285, 0.013395394198596478, 0.009399917908012867, -0.0321543924510479, 0.0016897390596568584, -0.016825921833515167, 0.014089667238295078, 0.020120317116379738, 0.021386345848441124, 0.01648559235036373, 0.023659750819206238, -0.016158875077962875, 0.01509704440832138, 0.006952944677323103, -0.060932707041502, -0.020923497155308723, -0.02620542049407959, 0.018541185185313225, 0.019929733127355576, 0.03310731425881386, 0.0011077745584771037, 0.06877391040325165, -0.005625657271593809, -0.009638149291276932, -0.04364393651485443, -0.016363073140382767, 0.024680741131305695, -0.0025048297829926014, -0.02081459015607834, -0.0006423731101676822, 0.021141307428479195, -0.02242094837129116, -0.021154921501874924, -0.0002486536977812648, -0.021794741973280907, 0.011305767111480236, -0.05475231260061264, -0.02601483464241028, -0.024884939193725586, -0.017111798748373985, 0.01674424298107624, -0.008344895206391811, 0.0045297942124307156, -0.020106704905629158, -0.016893988475203514, 0.0007597870426252484, -0.018758997321128845, -0.030030731111764908, -0.006248461082577705, 0.007228611968457699, -0.0005772850126959383, 0.04650270938873291, -0.015301242470741272, -0.10264356434345245, 0.0016863357741385698, 0.011482738889753819, -0.01346345990896225, -0.003450947580859065, -0.03259001299738884, -0.03231775015592575, -0.035067617893218994, 0.03544878587126732, 0.030738618224859238, -0.018554799258708954, -0.011768615804612637, 0.02435402385890484, -0.03735463693737984, 0.04606708511710167, -0.027008598670363426, 0.006234847940504551, 0.026341551914811134, -0.00025248242309316993, 0.014076054096221924, -0.03708237037062645, -0.06665025651454926, 0.011959200724959373, -0.007357937283813953, -0.009379498660564423, 0.005492928437888622, -0.01649920456111431, -0.023074382916092873, 0.0007338368450291455, -0.021127695217728615, 0.007146932650357485, -0.009175300598144531, 0.012347177602350712, -0.0059149377048015594, -0.04010450094938278, -0.008882616646587849, 0.028751090168952942, -0.021617770195007324, 0.04244597256183624, -0.03615667298436165, 0.009250173345208168, 0.006401609629392624, -0.017179865390062332, -0.02951342985033989, 0.006251864600926638, -0.010366455651819706, -0.02620542049407959, 0.0271583441644907, 0.024245118722319603, 0.033896882086992264, 0.007126512937247753, -0.028451599180698395, 0.012272304855287075, 0.009420338086783886, -0.0073307109996676445, 0.014593356288969517, 0.009522437117993832, -0.015927450731396675, 0.01673062890768051, -0.035993315279483795, -0.01509704440832138, 0.0010184379061684012, 0.00839934777468443, -0.012537761591374874, 0.012068106792867184, 0.01509704440832138, -0.003393091494217515, -0.01821446791291237, -0.02951342985033989, 0.005707336124032736, 0.007214998826384544, -0.004893947392702103, -0.0016318829730153084, 0.008297248743474483, 0.027090277522802353, 0.05733881890773773, -0.015083431266248226, 0.0058332583867013454, 0.03514929488301277, -0.002252985490486026, 0.013599592261016369, -0.030166862532496452, -0.02924116514623165, 0.00019377547141630203, -0.0062212347984313965, -0.016948441043496132, -0.023496393114328384, -0.008930262178182602, -0.0158457700163126, 0.026586590334773064, -0.04092129319906235, -0.021672222763299942, 0.015995515510439873, -0.00032820587512105703, 0.010883757844567299, 0.001334944972768426, 0.04301773011684418, -0.014743100851774216, -0.08538202196359634, -0.048762500286102295, 0.02476241998374462, 0.016703402623534203, 0.012231464497745037, -0.02619180642068386, 0.05526961386203766, 0.03370629623532295, -0.009284205734729767, -0.016921214759349823, 0.04598540812730789, -0.025102751329541206, 0.016594497486948967, -0.022720439359545708, 0.02150886505842209, -0.06605127453804016, -0.002069207141175866, -0.02197171375155449, 0.03234497457742691, -0.013885469175875187, -0.025129977613687515, -0.001675275037996471, 0.018799835816025734, 0.02759396657347679, -0.025456693023443222, 0.01240163017064333, 0.019262684509158134, -0.005690319929271936, -0.016335846856236458, -0.005690319929271936, -0.033406805247068405, -0.026777174323797226, 0.007058446761220694, -0.002317648148164153, -0.05761108547449112, -0.022230364382267, -0.008821357041597366, -0.015165111050009727, -0.02380949631333351, -0.008127083070576191, 0.004397065378725529, -0.02193087339401245, 0.038334786891937256, -0.009236560203135014, 0.0309292022138834, -0.044025104492902756, 0.016417525708675385, -0.029458975419402122, 0.002457183552905917, 0.009032361209392548, -0.010066965594887733, -0.035557691007852554, 0.021168533712625504, -0.010482167825102806, -0.01249692216515541, 0.010080578736960888, -0.011332993395626545, 0.001005675527267158, 0.01489284634590149, 0.0019279702100902796, -0.009747055359184742, 0.028506051748991013, 0.0008129635825753212, -0.01440277136862278, -0.028451599180698395, 0.002270001918077469, -0.025851476937532425, 0.025824250653386116, -0.03656506910920143, -0.054643407464027405, -0.020229222252964973, 0.020841816440224648, 0.015886610373854637, 0.03610222041606903, 0.009958059526979923, -0.02596038207411766, 0.06822938472032547, 0.01651281863451004, -0.04606708511710167, -0.0030663744546473026, 0.04881695285439491, -0.029377296566963196, 0.0387704074382782, 0.012422049418091774, 0.021604156121611595, 0.024639900773763657, 0.015968289226293564, -0.009399917908012867, -0.009747055359184742, 0.022584307938814163, 0.02080097794532776, -0.02050148695707321, -0.007371550425887108, -0.005880904849618673, -0.006878071930259466, -0.001972213154658675, 0.004880334250628948, -0.0008823058451525867, -0.0012855970999225974, 0.003876360133290291, 0.018541185185313225, 0.027076665312051773, -0.05624976381659508, -0.00525810057297349, 0.025157203897833824, 0.0114623187109828, 0.011755002662539482, -0.012878092005848885, -0.006908701732754707, 0.007990951649844646, -0.0035632564686238766, 0.016349459066987038, -0.020705685019493103, 0.024966618046164513, -0.028179334476590157, 0.014947298914194107, 0.044515181332826614, -0.0020487874280661345, 0.013647237792611122, 0.03512207046151161, -0.00012358237290754914, 0.04059457778930664, -0.021890034899115562, 0.02714473195374012, 0.012850865721702576, 0.020869042724370956, -0.007357937283813953, 0.03781748563051224, -0.03452308848500252, -0.012803219258785248, 0.024204278364777565, -0.010189483873546124, 0.006268880795687437, -0.01628139428794384, 0.0024997247382998466, 0.01357917208224535, 0.035094842314720154, 0.01745212823152542, -0.032698918133974075, 0.012333563528954983, -0.0010831006802618504, 0.012810026295483112, 0.014253025874495506, 0.01766994036734104, 0.0074736494570970535, 0.013225228525698185, 0.008365314453840256, -0.035094842314720154, -0.013422620482742786, 0.01391950249671936, 0.02150886505842209, -0.008848583325743675, 0.004996046423912048, 0.007010800763964653, 0.019167393445968628, 0.00048709750990383327, -0.015668800100684166, -0.03664674982428551, 0.0016174189513549209, 0.008358508348464966, 0.03604776784777641, 0.03852536901831627, -0.021808354184031487, -0.034577541053295135, 0.015382922254502773, -0.027961524203419685, -0.01579131744801998, -0.002606928814202547, 0.007752720266580582, -0.013034643605351448, -0.018976807594299316, -0.041411370038986206, 0.028015976771712303, 0.015246789902448654, 0.030629711225628853, 0.011081148870289326, -0.00327227427624166, 0.009998898953199387, -0.0012388016330078244, 0.04726504907011986, 0.011959200724959373, 0.007786753587424755, -0.0015799825778231025, 0.011693743057549, 0.0038797634188085794, -0.0002980015706270933, 0.004196270368993282, -0.012694314122200012, 0.0007015054579824209, 0.04037676751613617, 0.011312573216855526, 0.02099156193435192, -0.0002531205245759338, 0.03893376514315605, 0.0038593437056988478, -0.02312883548438549, 0.03259001299738884, 0.04132968932390213, -0.01697566732764244, -0.05526961386203766, -0.022557081654667854, 0.049007538706064224, 0.00043115572771057487, 0.0006968259694986045, -0.044515181332826614, 0.03406023979187012, 0.021059628576040268, -0.015668800100684166, -0.009141267277300358, 0.02877831645309925, -0.010550234466791153, 0.01298019103705883, -0.006765762809664011, 0.03746354207396507, 0.005850275047123432, -0.026055674999952316, -0.013157162815332413, 0.014076054096221924, -0.01911294087767601, -0.005520154722034931, -0.01935797743499279, 0.0004222220741212368, -0.01097904983907938, 0.005377216264605522, -0.002270001918077469, -0.0022972284350544214, 0.023496393114328384, -0.02171306312084198, 0.012013653293251991, 0.010203097015619278, -0.015900224447250366, 0.005009659565985203, -0.0001699523563729599, -0.0004556169733405113, 0.0022461789194494486, -0.029377296566963196, -0.015736864879727364, -0.011367026716470718, 0.0006938480655662715, -0.0035972895566374063, 0.04786403104662895, 0.019480496644973755, 0.0019024454522877932, 0.016839534044265747, 0.020869042724370956, 0.02120937407016754, 0.028941674157977104, 0.03359739109873772, -0.01168693695217371, -0.0011418076464906335, 9.864255844149739e-06, -0.011053922586143017, -0.009161687456071377, -0.009740248322486877, 0.02529333531856537, -0.014116893522441387, 0.0010090788127854466, 0.02412259951233864, 0.04271823912858963, 0.024707967415452003, -0.0415475033223629, 0.024503769353032112, 0.0010899072512984276, -0.011952394619584084, 0.009148074313998222, -0.015382922254502773, -0.011121988296508789, 0.014906459487974644, 0.028015976771712303, 0.0056426734663546085, -0.03288950398564339, 0.007194579113274813, 0.00849463976919651, 0.01602274179458618, 0.006571774836629629, -0.003889973508194089, -0.0037368247285485268, -0.005894517991691828, 0.02405453287065029, -0.018976807594299316, -0.017819685861468315, 0.013565558940172195, 0.006653454154729843, 0.006827022414654493, 0.012449276633560658, -0.03264446556568146, -0.014606969431042671, 0.007058446761220694, 0.02220313809812069, -0.007323904428631067, 0.02975846640765667, 0.013796983286738396, -0.0062212347984313965, 0.015110657550394535, 0.0015502037713304162, 0.0004356225545052439, -0.0011834980687126517, 0.02668188139796257, 0.010577460750937462, -0.032236069440841675, 0.027267249301075935, 0.03305286169052124, 0.037899162620306015, 0.005064112134277821, 0.007160545792430639, 0.02314244955778122, -0.002339769620448351, -0.0438617467880249, 0.006616017781198025, -0.01747935637831688, -0.01206129975616932, -0.013613205403089523, 0.009488403797149658, 0.008821357041597366, -0.021059628576040268, -0.0071673523634672165, -0.023196902126073837, -0.025797024369239807, -0.011938780546188354, -0.00789565872400999, 0.022094232961535454, 0.010910984128713608, 0.019031260162591934, 0.02172667533159256, -0.015600733458995819, -0.010577460750937462, 0.011782228946685791, 0.003051059553399682, -0.007630201522260904, -0.009610923007130623, 0.001473629497922957, -0.00250823306851089, 0.0034475442953407764, -0.02214868552982807, -0.036238353699445724, 0.024667127057909966, -0.024204278364777565, 0.0028179334476590157, -0.019534949213266373, -0.05216580256819725, 0.06087825447320938, 0.006581984926015139, -0.0022359690628945827, -0.025102751329541206, -0.012741959653794765, 0.016825921833515167, -0.018336987122893333, -0.0007291572983376682, 0.00037287420127540827, -0.024694355204701424, 0.06795711815357208, -0.02289741113781929, 0.0004109486471861601, 0.019181005656719208, -0.009978479705750942, 0.04342612624168396, -0.021808354184031487, -0.0047816382721066475, -0.02552475966513157, 0.014130506664514542, 0.0026443651877343655, 0.014947298914194107, -0.018718156963586807, -0.007609781809151173, 0.0157777052372694, -0.019521337002515793, -0.008896229788661003, 0.02451738342642784, 0.016390299424529076, 0.005067515652626753, 0.00848783366382122, 0.034332502633333206, 0.015056204982101917, -0.01323884166777134, 0.021168533712625504, -0.0005496331723406911, -0.012231464497745037, 0.006241654511541128, -0.0027124311309307814, 0.03732740879058838, -0.008991521783173084, -0.04337167367339134, -0.040240634232759476, -0.009556470438838005, -0.01888151653110981, 0.008419767022132874, -0.01860925182700157, 0.04819074645638466, -0.0316915400326252, -0.02476241998374462, 0.021590543910861015, -0.01026435662060976, -0.004468534607440233, 0.026164580136537552, -0.016458364203572273, -0.009420338086783886, -0.009291012771427631, -0.006425432860851288, -0.009352272376418114, -0.001391950179822743, -0.0001619758695596829, -0.03563937172293663, 0.019208231940865517, -0.006796392612159252, -0.0023533827625215054, -0.008508252911269665, 0.009440758265554905, 0.03406023979187012, 0.012599021196365356, 0.005526961293071508, -0.025388628244400024, 0.014048827812075615, -0.045413654297590256, -0.0028979110065847635, -0.00448555126786232, -0.03419637307524681, -0.023428326472640038, -0.002387415850535035, 0.0016676175873726606, 0.05341821908950806, -0.036510616540908813, 0.01723431795835495, 0.0057243527844548225, -0.004080558195710182, 0.016158875077962875, -0.012823639437556267, -0.01603635586798191, 0.02499384433031082, 0.02665465511381626, 0.040975749492645264, -0.01796943135559559, 0.01309590321034193, -0.018473120406270027, 0.0026835030876100063, -0.005458895117044449, -0.012530955485999584, 0.006769166328012943, -0.01463419571518898, -0.04870804771780968, 0.036973465234041214, -0.003587079467251897, 0.025089137256145477, 0.034550316631793976, 0.02994905225932598, -0.01840505376458168, -0.01403521467000246, -0.003081689355894923, 0.019235458225011826, 0.029322843998670578, 0.008079437538981438, -0.01249011605978012, -0.01205449365079403, -0.018854288384318352, 0.021767515689134598, -0.007140126079320908, -0.006170185282826424, -0.022584307938814163, -0.021876420825719833, -0.009774281643331051, 0.008589932695031166, 0.01749296858906746, 0.0009563276544213295, 0.03335235267877579, 0.03237220272421837, 0.0016454962315037847, 0.04603986069560051, -0.00666026072576642, 0.01960301585495472, 0.0190857145935297, -0.01816001534461975, 0.015995515510439873, 0.0014395964099094272, 0.015655186027288437, 0.022380109876394272, 0.0038593437056988478, 0.002843458205461502, 0.011877521872520447, -0.020596779882907867, 0.005993213504552841, -0.013994375243782997, -0.032426655292510986, -0.006105522625148296, 0.0029608721379190683, -0.022529855370521545, 0.0035802728962153196, 0.012830445542931557, 0.025143589824438095, -0.0030697777401655912, -0.017996657639741898, -0.0012336967047303915, 0.015056204982101917, 0.03708237037062645, -0.0190857145935297, 0.010203097015619278, 0.0018905338365584612, -0.01698927953839302, 0.004594456870108843, -0.05281923711299896, 0.018949581310153008, 0.023564457893371582, 0.012353983707726002, -0.0013553648022934794, -0.019398817792534828, 0.03351571038365364, -0.005778805818408728, -0.021794741973280907, -0.0062212347984313965, -0.0300035048276186, -0.013184389099478722, 0.007221805397421122, 0.011652903631329536, -0.01252414844930172, -0.01029158290475607, 0.012796413153409958, 0.002993203466758132, -0.02404092065989971, -0.04633935168385506, -0.007296678144484758, 0.003570063039660454, 0.00016495375894010067, -0.019072100520133972, 0.004910963587462902, 0.005343182943761349, 0.010584266856312752, -0.03441418334841728, -0.044487953186035156, -0.0330800898373127, -0.006796392612159252, -0.016825921833515167, 0.023564457893371582, 0.003733421443030238, -0.004917770158499479, 0.052546970546245575, 0.01602274179458618, 0.005775402300059795, 0.014103280380368233, 0.04342612624168396, 0.02386394888162613, 0.0037538413889706135, 0.012912125326693058, 0.010019319131970406, 0.014620582573115826, 0.005564397666603327, 0.018718156963586807, 0.004550213925540447, 0.025211656466126442, 0.01746574230492115, -0.0037708578165620565, 0.019004033878445625, 0.001664214301854372, -0.028669409453868866, -0.013790177181363106, 0.0003598991024773568, 0.005428265780210495, -0.016921214759349823, 0.0010737415868788958, 0.014552515931427479, -0.0051696146838366985, 0.009025555104017258, -0.004853107500821352, -0.0025031280238181353, -0.02665465511381626, 0.017302384600043297, 0.010230323299765587, 0.004066945053637028, 0.0027992152608931065, 0.007038027048110962, 0.0150017524138093, -0.04612153768539429, -0.008501446805894375, 0.002659680088981986, -0.010754432529211044, 0.05124010518193245, -0.021059628576040268, 0.0029966067522764206, 0.027988750487565994, -0.020596779882907867, 0.011584837920963764, 0.003757244674488902, 0.02080097794532776, 0.02050148695707321, -0.022067004814743996, -0.015886610373854637, -0.010393681935966015, -0.008304054848849773, 0.002848563250154257, 0.011700550094246864, 0.0006827873294241726, -0.002913225907832384, 0.023741429671645164, -0.03776303306221962, 0.023033542558550835, 0.01003293227404356, 0.01381059642881155, -0.03373352438211441, 0.059135764837265015, -0.0025643876288086176, 0.025810636579990387, -0.009025555104017258, 0.005298939999192953, 0.02174028940498829, 0.016226939857006073, -0.015981903299689293, -0.044542405754327774, 0.01963024213910103, -0.04535919800400734, -0.021318279206752777, -0.008338088169693947, -0.006405013147741556, 0.011258120648562908, -0.008583125658333302, -0.02502107061445713, -0.012006847187876701, 0.02149525098502636, -0.012891705147922039, 0.043099407106637955, -0.011258120648562908, 0.003600692842155695, -0.020637618377804756, -0.023264966905117035, 0.00014783089864067733, 0.014239412732422352, 0.010420908220112324, -0.019548563286662102, 0.00027439117548055947, 0.015069818124175072, 0.03141927719116211, -0.004550213925540447, 0.011959200724959373, -0.03449586033821106, 0.03343403339385986, -0.010012512095272541, -0.03406023979187012, -0.002775392262265086, -0.003542836755514145, 0.03237220272421837, -0.01145551260560751, -0.021794741973280907, -0.014688648283481598, 0.003559853183105588, -0.01628139428794384, 0.0056664966978132725, 0.004737395327538252, -0.03299840912222862, 0.006840635556727648, 0.019984185695648193, 0.022706827148795128, 0.0011596749536693096, -0.023795882239937782, 0.02122298628091812, -0.01697566732764244, -0.028968900442123413, 0.032018259167671204, 0.037409089505672455, 0.04299050197005272, 0.04160195589065552, 0.01214978564530611, 0.03302563726902008, -0.018473120406270027, 0.013538332656025887, -0.003086794400587678, 0.02506191097199917, -0.01794220507144928, 0.03514929488301277, 0.0316915400326252, 0.05401719734072685, -0.04345335066318512, 0.02218952402472496, -0.023986468091607094, 0.002783900359645486, -0.007439616601914167, 0.0016897390596568584, -0.009699408896267414, 0.012469695881009102, 0.0010039738845080137, 0.017778845503926277, -0.012810026295483112, 0.020215610042214394, 0.020678458735346794, -0.0074940696358680725, 0.025306949391961098, -0.0026971162296831608, 0.03713682293891907, 0.04059457778930664, -0.010842918418347836, 0.0118094552308321, -0.019548563286662102, 0.006268880795687437, 0.020937109366059303, -0.012367596849799156, -0.031092559918761253, 0.021876420825719833, 0.027280863374471664, 0.017084572464227676, -0.02028367668390274, 0.00531595665961504, 0.0078888526186347, 0.016118034720420837, -0.005683513358235359, 0.00826321542263031, 0.03463199362158775, 0.045958179980516434, 0.011305767111480236, 0.01497452612966299, 0.0010975647019222379, -0.0016608110163360834, 0.003570063039660454, -0.021345505490899086, -0.01417134702205658, -0.0028996127657592297, -0.03465922176837921, -0.031991031020879745, 0.02056955359876156, 0.023278580978512764, -0.010325616225600243, 0.01143509242683649, -0.0043902588076889515, -0.017901364713907242, 0.0010303495218977332, 0.005210454110056162, 0.006969960872083902, 0.03414192050695419, 0.015682412311434746, 0.03520374745130539, -0.04612153768539429, -0.015587120316922665, -0.00046497603761963546, -0.0226932130753994, 0.008828163146972656, -0.002964275423437357, 0.02243456244468689, -0.007943305186927319, 0.01841866597533226, -0.01630862057209015, -0.0028111268766224384, 0.014743100851774216, -0.008270022459328175, 0.02291102521121502, -0.016621723771095276]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
" J., Austin, J., Barham,
P., Botha, J. A., Bradbury, J., Brahma, S., Brooks, K.,
Catasta, M., Cheng, Y ., Cherry, C., Choquette-Choo,
C. A., Chowdhery, A., Crepy, C., Dave, S., Dehghani,
M., Dev, S., Devlin, J., D ´ıaz, M., Du, N., Dyer, E.,
Feinberg, V ., Feng, F., Fienber, V ., Freitag, M., Gar-
cia, X., Gehrmann, S., Gonzalez, L., and et al. Palm
2 technical report. CoRR , abs/2305.10403, 2023. doi:
10.48550/ARXIV .2305.10403. URL https://doi.
org/10.48550/arXiv.2305.10403 .
Antropic. Claude, Jul 2023. URL https://claude.
ai/chats .
Bai, Y ., Jones, A., Ndousse, K., Askell, A., Chen, A., Das-
Sarma, N., Drain, D., Fort, S., Ganguli, D., Henighan, T.,
et al. Training a helpful and harmless assistant with rein-
forcement learning from human feedback. arXiv preprint
arXiv:2204.05862 , 2022.
Bradley, R. A. and Terry, M. E. Rank analysis of incom-
plete block designs: I. the method of paired comparisons.
Biometrika , 39(3/4):324–345, 1952.Brown, T. B., Mann, B., Ryder, N., Subbiah, M., Kaplan,
J., Dhariwal, P., Neelakantan, A., Shyam, P., Sastry, G.,
Askell, A., Agarwal, S., Herbert-V oss, A., Krueger, G.,
Henighan, T., Child, R., Ramesh, A., Ziegler, D. M., Wu,
J., Winter, C., Hesse, C., Chen, M., Sigler, E., Litwin, M.,
Gray, S., Chess, B., Clark, J., Berner, C., McCandlish, S.,
Radford, A., Sutskever, I., and Amodei, D. Language
models are few-shot learners. In Larochelle, H.,
Ranzato, M., Hadsell, R., Balcan, M., and Lin, H. (eds.),
Advances in Neural Information Processing Systems 33:
Annual Conference on Neural Information Processing
Systems 2020, NeurIPS 2020, December 6-12, 2020,
virtual , 2020. URL https://proceedings.
neurips.cc/paper/2020/hash/
1457c0d6bfcb4967418bfb8ac142f64a-Abstract.
html .
Casper, S., Davies, X., Shi, C., Gilbert, T. K., Scheurer,
J., Rando, J., Freedman, R., Korbak, T., Lindner, D.,
Freire, P., Wang, T., Marks, S., S ´egerie, C., Carroll,
M., Peng, A., Christoffersen, P. J. K., Damani, M.,
Slocum, S., Anwar, U., Siththaranjan, A., Nadeau, M.,
Michaud, E. J., Pfau, J., Krasheninnikov, D., Chen,
X., Langosco, L., Hase, P., Biyik, E., Dragan, A. D.,
Krueger, D., Sadigh, D., and Hadfield-Menell, D. Open
problems and fundamental limitations of reinforcement
learning from human feedback. CoRR , abs/2307.15217,
2023. doi: 10.48550/ARXIV .2307.15217. URL https:
//doi.org/10.48550/arXiv.2307.15217 .
Chen, Z., Deng, Y ., Yuan, H., Ji, K., and Gu, Q. Self-play
fine-tuning converts weak language models to strong lan-
guage models. arXiv preprint arXiv:2401.01335 , 2024.
Chowdhery, A., Narang, S., Devlin, J., Bosma, M., Mishra,
G., Roberts, A., Barham, P.,","[-0.010328141041100025, 0.02416098304092884, 0.039653196930885315, -0.0019311620853841305, 0.020670587196946144, 0.008168100379407406, 0.01085027027875185, 0.029696982353925705, -0.02411806955933571, 0.04191337153315544, 0.02058475837111473, -0.05435863882303238, -0.020084086805582047, -0.001380423316732049, 0.006508731748908758, -0.024990668520331383, 0.03888073191046715, -0.0244899969547987, 0.033645134419202805, 0.04857945442199707, -0.005947263911366463, -0.025333985686302185, -0.004066169261932373, 0.01506306417286396, 0.042485564947128296, -0.016865482553839684, 0.024261118844151497, 0.03519006446003914, -0.022201212123036385, -0.01569247990846634, 0.061568308621644974, -0.024804703891277313, -0.053929489105939865, -0.012795737013220787, -0.027908869087696075, 0.018181534484028816, 0.005857858341187239, -0.0072668916545808315, -0.003499337239190936, 0.0002147970808437094, 0.006769795902073383, -0.07129564136266708, 0.0024658078327775, 0.055531639605760574, -0.02755124680697918, 0.0067876772955060005, -0.004345114808529615, -0.019712159410119057, 0.013990196399390697, 0.05298536643385887, -0.05870732665061951, 0.04649094119668007, -0.02117125876247883, -0.03930987790226936, -0.04048287868499756, 0.001535989111289382, 0.012230693362653255, 0.02572021819651127, -0.0062727006152272224, 0.0007599480450153351, -0.004345114808529615, -0.03430316224694252, -0.007967831566929817, 0.03164244815707207, -0.05641854181885719, -0.05787764489650726, -0.054902222007513046, -0.0034528463147580624, 0.010220854543149471, 0.06334211677312851, -0.01512028370052576, 0.01942606084048748, 0.0081824054941535, -0.025963401421904564, -0.02012700028717518, 0.0048743961378932, 0.014440800994634628, 0.07415662705898285, -0.037822168320417404, -0.009419779293239117, -0.010728678666055202, 0.027708599343895912, 0.013339323922991753, -0.07541545480489731, -0.049752458930015564, -0.03373096510767937, -0.03996790200471878, 0.0054287114180624485, -0.04168449342250824, -0.017680862918496132, -0.018768034875392914, -0.0334162563085556, -0.0475781112909317, 0.012266455218195915, 0.053443122655153275, 0.009584286250174046, 0.008976327255368233, 0.005886468105018139, 0.05704795941710472, 0.024203898385167122, -0.0334162563085556, -0.023831970989704132, -0.006258395966142416, -0.020327270030975342, 0.02687891572713852, -0.02128569781780243, -0.021528881043195724, 0.0006294157938100398, -0.007717495784163475, 0.001609301776625216, -0.12096226960420609, -0.013825690373778343, -0.04197058826684952, -0.02079933136701584, -0.006612441968172789, -0.043086372315883636, -0.06402875483036041, -0.021543186157941818, -0.04205641895532608, -0.002340639941394329, -0.0157783105969429, 0.027722904458642006, 0.04451686143875122, -0.010607087053358555, -0.002385342726483941, -0.0352758951485157, 0.0214716624468565, -0.08268234878778458, -0.03836575523018837, -0.040883418172597885, -0.010356751270592213, 0.0017523508286103606, 0.020742110908031464, -0.034989796578884125, -0.037564679980278015, -0.00010851611295947805, -0.016765348613262177, -0.004810024052858353, -0.02297367714345455, -0.034245941787958145, 0.02669295109808445, -0.00013444374781101942, -0.06877797842025757, 0.04116951674222946, -0.03335903584957123, -0.0020473895128816366, -0.022830627858638763, -0.0061761424876749516, -0.01680826209485531, 0.006190447602421045, 0.0037049702368676662, 0.008017899468541145, 0.010392513126134872, -0.0017907952424138784, -0.06391431391239166, -0.01566386967897415, -0.017251715064048767, 0.06643197685480118, 0.00012852062354795635, -0.06002337858080864, 0.037936605513095856, 0.05032465606927872, -0.0023209708742797375, 0.0005601264419965446, 0.038308534771203995, 0.014176160097122192, -0.0010952192824333906, 0.0046490938402712345, -0.0707806646823883, -0.02288784645497799, 0.007824783213436604, -0.002678593387827277, -0.020785026252269745, -0.010249463841319084, -0.012280760332942009, -0.009569981135427952, 0.0015109555097296834, -0.03467508777976036, -0.033502086997032166, -0.055245541036129, 0.003701393958181143, 0.02297367714345455, -0.008826126344501972, 0.017866825684905052, -0.03169966861605644, -0.021228479221463203, 0.00446313014253974, -0.0025212394539266825, -0.015034454874694347, 0.03796521574258804, 0.025233851745724678, 0.039395708590745926, 0.08434171974658966, 0.026349633932113647, 0.0004566393618006259, -0.05312841385602951, 0.05581773817539215, -0.0279660876840353, 8.689112291904166e-05, -0.014920015819370747, 0.0021296427585184574, 0.03910961002111435, -0.019955342635512352, -0.027608465403318405, 0.01314620766788721, -0.04686286672949791, 8.4935367340222e-05, -0.017351849004626274, -0.06414319574832916, -0.021385831758379936, 0.0413125641644001, 0.018853863701224327, 0.04331525042653084, 0.02386058121919632, -0.04700591787695885, 0.010192244313657284, -0.02643546275794506, 0.008661619387567043, -0.020184220746159554, 0.021671930328011513, -0.020885160192847252, 0.039767634123563766, 0.01666521467268467, 0.0015413534129038453, -0.011544058099389076, 0.018167229369282722, 0.02225843071937561, -0.014412191696465015, 0.05364339053630829, -0.03164244815707207, 0.0575629360973835, 0.006304886657744646, -0.0066195945255458355, -0.020999599248170853, 0.010728678666055202, -0.01079305075109005, 0.01127941720187664, -0.026564206928014755, 0.023946410045027733, -0.02232995629310608, 0.016321895644068718, -0.0010585628915578127, 0.0007384907221421599, 0.02408945932984352, 0.011837308295071125, 0.05032465606927872, -0.036076970398426056, -0.06231216341257095, 0.04709174484014511, -0.005797062534838915, 0.03307294100522995, -0.016164541244506836, -0.0038802053313702345, -0.032414913177490234, -0.028094831854104996, -0.037078313529491425, -0.008361216634511948, -0.008418436162173748, -0.03962458670139313, -0.025062192231416702, -0.05321424454450607, 0.033874012529850006, -0.019225791096687317, 0.011057691648602486, -0.009469847194850445, 0.00013835524441674352, -0.039538756012916565, 0.03913822025060654, -0.005814943928271532, -0.020756416022777557, 0.0004159598029218614, 0.029139090329408646, 0.006755491252988577, 0.018095703795552254, -0.049609407782554626, -0.008318302221596241, 0.030784154310822487, 0.046662598848342896, -0.05985172092914581, 0.015048759989440441, 0.01805279031395912, 0.04969523847103119, 0.05372922122478485, 0.02069919742643833, -0.01726602017879486, 0.03470369800925255, -0.0013258858816698194, -0.0306411050260067, -0.03238630294799805, 0.00417703203856945, 0.02687891572713852, -0.00896917562931776, 0.0036155646666884422, -0.04022539034485817, 0.02497636340558529, 0.01414755079895258, 0.05401531979441643, 0.008933412842452526, -0.0025820352602750063, -0.027465416118502617, 0.036076970398426056, -0.014397886581718922, -0.006437207106500864, 0.022101078182458878, 0.03187132626771927, 0.024103764444589615, -0.010807355865836143, 0.0005033538327552378, 0.03519006446003914, -0.023545872420072556, 0.0052177137695252895, -0.006880659144371748, -0.021042514592409134, 0.008311149664223194, -0.04855084791779518, -0.07398496568202972, 0.05790625512599945, -0.0018614256987348199, 0.038937948644161224, -0.025562863796949387, -0.06780524551868439, -0.025248156860470772, -0.02277340739965439, 0.012430962175130844, -0.005700504407286644, 0.028438150882720947, 0.018067093566060066, 0.019640633836388588, 0.002701838966459036, -0.036220017820596695, 0.014676831662654877, 0.010542714968323708, 0.035333115607500076, -0.006211904808878899, -0.018996912986040115, -0.0348181389272213, -0.048007261008024216, 0.04305776208639145, 0.0022780559957027435, 0.01241665706038475, -0.05707656964659691, -0.00021133261907380074, -0.04563264548778534, 0.0016942371148616076, -0.03061249665915966, 0.005278509575873613, -0.0044702826999127865, 0.0030844949651509523, 0.03553338348865509, 0.02789456397294998, 0.010313835926353931, -0.009248120710253716, 0.0246044360101223, 0.004023254383355379, -0.017881130799651146, 0.0027858801186084747, -0.023460043594241142, -0.026707256212830544, -0.014025959186255932, 0.003758613718673587, 0.007359873503446579, 0.03410289064049721, 0.028810078278183937, -0.008840431459248066, 0.03235769271850586, 0.005389372818171978, -0.04219947010278702, -0.008389826864004135, 0.005528845824301243, -0.03684943541884422, -0.01269560307264328, 0.03693526238203049, -0.0408548079431057, -0.012237845920026302, -0.03384540602564812, 0.015263332985341549, -0.01815292425453663, 0.03416011109948158, -0.0013553897151723504, 0.024962058290839195, 0.01343945786356926, 0.007882002741098404, 0.023059505969285965, -0.03427455201745033, -0.007163180969655514, 0.012659840285778046, 0.00786769762635231, -0.0038444430101662874, -0.009205206297338009, -0.016765348613262177, -0.0028234305791556835, -0.003994644619524479, -0.050353262573480606, 0.020270049571990967, 0.021385831758379936, 0.035590603947639465, -0.005704080685973167, 0.027522636577486992, 0.04268583655357361, 0.04405910521745682, -0.01759503223001957, -0.011429619044065475, -0.01845332607626915, 0.024475691840052605, -0.007588752079755068, 0.02636393904685974, 0.022787712514400482, 0.06626031547784805, 0.005006716586649418, 0.01805279031395912, 0.04694869741797447, -0.0619688481092453, 0.006043822038918734, -0.009870383888483047, 0.0019383145263418555, -0.055388592183589935, 0.021271392703056335, 0.013196274638175964, 0.04016817361116409, 0.06603144109249115, -0.0011238290462642908, -0.020742110908031464, -0.03121330216526985, -0.04746367409825325, -0.05398670956492424, 0.046519551426172256, 0.009612895548343658, -0.06236938387155533, 0.013253494165837765, -0.04411632567644119, -0.03181410953402519, 0.05138321593403816, 0.025004973635077477, 0.0009007619810290635, -0.008604399859905243, -0.04626206308603287, -0.0018051001243293285, 0.01863929070532322, -0.000523917144164443, -0.03244352340698242, 0.024361252784729004, -0.009462694637477398, -0.03639167547225952, 0.03212881460785866, -0.020441709086298943, -0.006651780568063259, -0.009577133692800999, 0.01738045923411846, 0.01394728198647499, -0.05229873210191727, -0.014490867964923382, -0.017251715064048767, 0.0387662909924984, 0.020599063485860825, -0.010721526108682156, -0.02617797628045082, 0.09727334976196289, -0.01238089520484209, 0.03447481989860535, 0.024518607184290886, 0.040883418172597885, 0.016493555158376694, -0.02599201165139675, 0.0005046949372626841, 0.005772029049694538, 0.035218674689531326, 0.008189558051526546, 0.043200813233852386, -0.0010844905627891421, -0.014440800994634628, 0.004967377986758947, -0.0027823038399219513, -0.04454547166824341, -0.06746193021535873, -0.03370235487818718, -0.0005413512117229402, 0.015835529193282127, -0.014605307951569557, -0.07598765194416046, -0.017251715064048767, 0.009505609050393105, -0.013732708059251308, 0.015563735738396645, 0.04491740092635155, 0.05673325061798096, 0.043944668024778366, -0.009176596067845821, -0.015678174793720245, -0.009698725305497646, 0.004935191944241524, 0.019826598465442657, 0.0014447954017668962, 0.0647726058959961, -0.017609337344765663, 0.004023254383355379, 0.007574446965008974, 0.0032078749500215054, -0.00160125526599586, 0.002649983623996377, -0.02870994433760643, -0.021357223391532898, 0.002685745945200324, -0.006712576374411583, 0.015978578478097916, -0.016693823039531708, -0.0031649600714445114, 0.012373742647469044, 0.0019275859231129289, 0.016751043498516083, 0.05990894138813019, -0.019712159410119057, -0.007238281890749931, 0.031785499304533005, 0.03121330216526985, 0.009276730939745903, 0.03476091846823692, -0.03962458670139313, -0.011050539091229439, -0.008146642707288265, 0.03822270408272743, 0.007005827035754919, -0.026850305497646332, -0.0018059941940009594, -0.016450639814138412, 0.026793086901307106, -0.01530624832957983, -0.008740296587347984, -0.0515262670814991, -0.015105979517102242, -0.019511889666318893, 0.01852485164999962, -0.0022101078648120165, 0.030412226915359497, -0.006608865689486265, -0.06299880146980286, 0.00449173990637064, 0.004345114808529615, -0.024819009006023407, -0.04337247088551521, 0.005421558860689402, 0.02367461659014225, 0.024847619235515594, -0.0017907952424138784, -0.0012060822919011116, 0.0035100660752505064, -0.0005583383026532829, -0.0069664884358644485, -0.031899936497211456, -0.014719747006893158, 0.0325007438659668, 0.049723848700523376, -0.04560403525829315, 0.01241665706038475, -0.010678611695766449, 0.0029289291705936193, -0.02416098304092884, 0.003536887699738145, -0.02534829080104828, 0.0022995134349912405, -0.0013553897151723504, 0.006837744265794754, -0.013053225353360176, 0.018410412594676018, 0.00454895943403244, -0.04139839485287666, 0.006458664312958717, 0.012488181702792645, -0.037221360951662064, 0.024375557899475098, 0.009569981135427952, -0.019769378006458282, -0.02938227355480194, 0.0036870890762656927, -0.03642028570175171, 0.005017445422708988, -0.019526194781064987, -0.014991539530456066, 0.008396979421377182, -0.006458664312958717, 0.014211922883987427, -0.04022539034485817, -0.0277372095733881, -0.0025015701539814472, 0.01051410473883152, -0.050238825380802155, 0.01042112335562706, 0.02467595972120762, 0.02002686634659767, -0.022287040948867798, -0.002406800165772438, 0.05003855749964714, -0.023874886333942413, -0.011451075784862041, -0.037822168320417404, -0.020370183512568474, -0.004362995736300945, 0.022587444633245468, -0.024518607184290886, -0.015606651082634926, 0.023731837049126625, 0.003005817998200655, -0.009956213645637035, -0.006905692629516125, -0.021986639127135277, -0.015177504159510136, 0.005131884478032589, -0.025105107575654984, -0.00866877194494009, 0.002800185000523925, 0.0020473895128816366, 0.006644628010690212, -0.011951747350394726, 0.008382674306631088, -0.021986639127135277, -0.018839558586478233, -0.014126093126833439, -0.009991975501179695, -0.00904069934040308, 0.038537412881851196, -0.020999599248170853, -0.00786769762635231, -0.02016991563141346, 0.017137276008725166, 0.0194975845515728, -0.0019293739460408688, 0.025405511260032654, -0.0031864175107330084, -0.009183748625218868, -0.03699248284101486, -0.005028173793107271, -0.023474348708987236, 0.007545837201178074, 0.015792613849043846, 0.002154676243662834, -0.008303997106850147, 0.007016555871814489, 0.006126075517386198, -0.0006884235190227628, 0.0083540640771389, -0.01882525533437729, 0.00943408440798521, 0.010385360568761826, 0.011565515771508217, -0.029024651274085045, 0.010320988483726978, -0.01153690554201603, 0.01202327199280262, -0.0023084538988769054, -0.01805279031395912, -0.019583415240049362, -0.034503430128097534, -0.049666628241539, 0.02799469791352749, 0.0025426968932151794, 0.022473005577921867, -0.012402351945638657, -0.024847619235515594, -0.013689793646335602, 0.008046508766710758, -0.029840031638741493, -0.036706384271383286, 0.014354972168803215, -0.01494862511754036, -0.002930717309936881, -0.016422029584646225, 0.033244598656892776, 0.001742516178637743, 0.0366777740418911, 0.016321895644068718, -0.016979921609163284, 0.0012400563573464751, -0.0005471626063808799, 0.03270101174712181, 0.005603946279734373, -0.009569981135427952, -0.059966158121824265, 0.03581948205828667, -0.014977235347032547, -0.0067304577678442, 0.03822270408272743, -0.0468914769589901, 0.03444620966911316, -0.05644715204834938, -0.012960243970155716, 0.020599063485860825, -0.02281632274389267, 0.028180662542581558, -0.00025346502661705017, 0.012295065447688103, 0.007080927956849337, 0.009291035123169422, -0.01863929070532322, 0.0020277202129364014, 0.0012516791466623545, -0.0041698794811964035, 0.024475691840052605, -0.01908274181187153, 0.04168449342250824, 0.0021385832224041224, -0.14545227587223053, 0.0021958027500659227, 0.0033634407445788383, 0.007181061897426844, 0.012309370562434196, -0.02594909630715847, -0.017137276008725166, -0.01708005554974079, 0.02416098304092884, 0.02878146804869175, -0.014490867964923382, -0.014083178713917732, -0.00750292232260108, -0.012895871885120869, 0.04105507582426071, -0.045432377606630325, 0.0024693841114640236, 0.019640633836388588, 0.03381679579615593, 0.011830155737698078, -0.04471713304519653, -0.05189819261431694, 0.01338223833590746, -0.000886010006070137, -0.009055004455149174, -0.014440800994634628, -0.03281545266509056, -0.015392077155411243, 0.024962058290839195, -0.020670587196946144, 0.0023388518020510674, 0.000267546420218423, 0.01062854379415512, 0.025920487940311432, -0.02285923808813095, -0.016364810988307, 0.006118922960013151, -0.05375783145427704, 0.01306753046810627, -0.009205206297338009, 0.01573539525270462, -0.00863301008939743, -0.01643633469939232, -0.0026768052484840155, 0.026492683216929436, 0.011722869239747524, -0.016379116103053093, 0.012588315643370152, 0.011980357579886913, 0.004209218081086874, 0.005857858341187239, -0.0215861015021801, 0.013940129429101944, -0.002946810331195593, -0.005589641630649567, 0.014412191696465015, -0.01562095619738102, -0.010771593078970909, -0.00971303042024374, -0.04031122103333473, 0.02815205231308937, 0.01318196952342987, 0.021528881043195724, -0.019154267385601997, 0.026478378102183342, 0.013332171365618706, -0.008396979421377182, 0.027637075632810593, -0.01875372976064682, -0.008396979421377182, 0.0194975845515728, -0.0020169916097074747, -0.02599201165139675, -0.013704098761081696, 0.00928388349711895, 0.03773633763194084, -0.02599201165139675, 0.011465380899608135, 0.033645134419202805, 0.015506516210734844, -0.002539120614528656, -0.018696511164307594, -0.011422466486692429, 0.04955219104886055, -0.0059973313473165035, -0.03238630294799805, -0.023502958938479424, -0.029696982353925705, -0.007216824218630791, -0.00265713594853878, -0.035104237496852875, -0.037450239062309265, -0.0032436370383948088, 0.01643633469939232, -0.001440325053408742, 0.009777402505278587, 0.011079148389399052, -0.00863301008939743, -0.11043386161327362, -0.02531968057155609, 0.030297787860035896, 0.01692270301282406, 0.009648658335208893, -0.024618741124868393, 0.010413970798254013, 0.03750745952129364, 0.01889677904546261, -0.02666434273123741, 0.0218149796128273, 0.008118033409118652, 0.003374169347807765, 0.02024143934249878, 0.02221551723778248, -0.05535998195409775, 0.018582070246338844, -0.024561520665884018, 0.04820752888917923, 0.009791707620024681, -0.018996912986040115, -0.0028180661611258984, 0.0050031403079628944, 0.02717931941151619, -0.01740906946361065, 0.002623161766678095, -0.004688432440161705, 0.012688450515270233, -0.011687107384204865, 0.006862777750939131, -0.02221551723778248, -0.016879787668585777, 0.006827015895396471, 0.05679047107696533, -0.04488879069685936, 0.015191808342933655, -0.015835529193282127, -0.01500584464520216, -0.021986639127135277, -0.014211922883987427, -0.006233362015336752, -0.038194093853235245, 0.02504788711667061, -0.0112579595297575, 0.05192680284380913, -0.008103728294372559, 0.01673673838376999, -0.01615023799240589, 0.04540376737713814, -0.00820386316627264, 0.027522636577486992, -0.0005878421943634748, -0.021228479221463203, 0.0030809189192950726, 0.005557455588132143, -0.0010764440521597862, 0.013425152748823166, -0.0012194931041449308, 0.03544755280017853, 0.007302653975784779, 0.004459553863853216, 0.01371840387582779, 0.0033312547020614147, -0.011193587444722652, -0.015420687384903431, -0.015191808342933655, -0.017280325293540955, 0.019941037520766258, -0.024361252784729004, -0.01310329232364893, -0.059222303330898285, 0.038566023111343384, -0.0018721544183790684, 0.02304520085453987, 0.003930272534489632, -0.014154703356325626, 0.025863267481327057, 0.029582543298602104, -0.007367026060819626, -0.0016870846739038825, 0.04182754084467888, -0.036076970398426056, 0.003005817998200655, 0.003270458895713091, -0.03702109307050705, 0.018167229369282722, 0.01079305075109005, 0.022473005577921867, -0.004792143125087023, 0.036820825189352036, 0.03850880265235901, -0.016822567209601402, 0.02430403232574463, -0.0187966451048851, 0.02177206426858902, 0.008504265919327736, -0.006111770402640104, 0.018810950219631195, 0.032157424837350845, 0.01457669772207737, 0.02337421476840973, 0.03948153555393219, -0.04171309992671013, 0.014347819611430168, -0.0018953998805955052, 0.005153341684490442, -0.011350941844284534, -0.01537777204066515, 0.018996912986040115, 0.0055717602372169495, 0.01338223833590746, 0.034131500869989395, -0.01893969438970089, -0.012202083133161068, 0.007603056728839874, 0.019740767776966095, 0.017680862918496132, 0.03813687711954117, -0.0041162362322211266, 0.02232995629310608, 0.01726602017879486, 0.01935453526675701, 0.002177921822294593, 0.012459571473300457, -0.02207246795296669, -0.0035887430422008038, 0.01812431402504444, 0.017680862918496132, -0.011951747350394726, 0.007359873503446579, 0.03908099979162216, 0.014397886581718922, -0.004953073337674141, -0.0022995134349912405, -0.005847129970788956, 0.011608430184423923, 0.014347819611430168, 0.02632102370262146, -0.05916508659720421, 0.012295065447688103, 0.02232995629310608, -0.008389826864004135, -0.007910612039268017, -0.019039828330278397, -0.009169443510472775, -0.010220854543149471, -0.013818537816405296, -0.021986639127135277, 0.0005619145231321454, -0.0014081390108913183, 0.028609808534383774, -0.008840431459248066, 0.0014894981868565083, 0.033015720546245575, 0.005911501590162516, 0.005618251394480467, 0.004627636633813381, -0.03470369800925255, -0.007545837201178074, 0.027694296091794968, 0.012509639374911785, 0.04074036702513695, -0.018396107479929924, -0.01703714206814766, 0.020556148141622543, -0.047034524381160736, -0.025562863796949387, -0.034989796578884125, -0.018539156764745712, 0.004320081323385239, -0.02986864000558853, 0.00281985430046916, 0.030698325484991074, 0.029239224269986153, 0.006573103833943605, 0.017909741029143333, 0.004663398955017328, -0.022644663229584694, 0.00640502106398344, 0.04128395393490791, 0.024146679788827896, -0.018238753080368042, -0.01258116401731968, -0.020441709086298943, 0.029353663325309753, 0.002666076645255089, 0.016622299328446388, 0.000953064241912216, -0.02237287163734436, 0.03444620966911316, 0.0004257944237906486, -0.007974984124302864, 0.020041171461343765, 0.050467703491449356, -0.01187307108193636, -0.030297787860035896, 0.028552589938044548, 0.022873543202877045, -0.03175688907504082, -0.0306411050260067, -0.007030860520899296, 0.0415414422750473, 0.018610680475831032, 0.010814507491886616, -0.023660311475396156, 0.036334458738565445, 0.012917328625917435, -0.03012612834572792, 0.012373742647469044, 0.008211014792323112, -0.01584983430802822, 0.024547215551137924, -0.046319279819726944, 0.01094325166195631, -0.010585629381239414, -0.009920450858771801, 0.01118643581867218, 0.011937443166971207, -0.04503183811903, -0.011129215359687805, -0.02248731069266796, -0.014526630751788616, -0.018439022824168205, 0.01789543591439724, -0.003908815328031778, 0.0001750115625327453, -0.0042914715595543385, -0.015349162742495537, -5.372720988816582e-05, -0.0054287114180624485, -0.008675924502313137, -0.01088603213429451, -0.0039910683408379555, -0.00642290199175477, 0.011780088767409325, -0.025562863796949387, -0.0012981700710952282, -0.014097483828663826, -0.017909741029143333, -0.00894771795719862, 0.03739302232861519, 0.04262861609458923, 0.01451947819441557, -0.01819583773612976, 0.0003658926289062947, 0.0007013873546384275, 0.024375557899475098, 0.0471203550696373, 0.00450246874243021, -0.02636393904685974, 0.00788915529847145, -0.022473005577921867, 0.04036844149231911, 0.008211014792323112, 0.010971861891448498, -0.01532055251300335, -0.01392582431435585, 0.03238630294799805, 0.02822357602417469, 0.055274151265621185, -0.025076497346162796, 0.03049805574119091, 0.014848491176962852, -0.01819583773612976, 0.008568638004362583, -0.024890534579753876, -0.019097046926617622, 0.021013904362916946, 0.0001933397288667038, 0.009763097390532494, -0.0498955063521862, 0.005671894643455744, 0.0011846248526126146, 0.02348865382373333, 0.011958899907767773, -0.01127941720187664, 0.015721090137958527, -0.028495369479060173, 0.009405475109815598, -0.00485651521012187, -0.011179283261299133, -0.019368840381503105, -0.007932069711387157, 0.003018334973603487, 0.017065750434994698, -0.022501615807414055, -0.019397450610995293, -0.03210020437836647, 0.028538284823298454, -0.017351849004626274, 0.0008886922150850296, 0.01617884635925293, -0.03144218027591705, -0.0057934862561523914, -0.010928947478532791, -0.00168261444196105, -0.006065279711037874, -0.00531427189707756, 0.05950840190052986, -0.02687891572713852, 0.020112695172429085, 0.007016555871814489, 0.014326361939311028, 0.007431398145854473, 0.024919142946600914, 0.008525722660124302, 0.02109973505139351, -0.06053835526108742, -0.003352711908519268, -0.004241404123604298, -0.03355930745601654, 0.0070451656356453896, 0.0167081281542778, -0.011622735299170017, 0.014097483828663826, -0.010650001466274261, -0.010149329900741577, -0.0392240472137928, -0.0028252187184989452, -0.0004287001211196184, -0.0006598136969842017, -0.005346457939594984, 0.020670587196946144, 0.00013846700312569737, -0.020942380651831627, -0.004123388789594173, -0.010163635015487671, -0.017423374578356743, 0.005550303030759096, 0.02576313354074955, -8.258847083197907e-05, 0.0003513642295729369, -0.004355843644589186, 0.011801546439528465, -0.0113151790574193, 0.013303561136126518, -0.03910961002111435, -0.007753258105367422, -0.018653595820069313, -0.014962930232286453, 0.01833888702094555, 0.0006924467743374407, 0.010342446155846119, 0.0033938386477530003, -0.0010093898745253682, 0.017122970893979073, -0.009977671317756176, 0.003479667939245701, 0.0075243799947202206, -0.028051918372511864, 0.074728824198246, -0.002333487616851926, 0.003726427676156163, 0.00986323133111, -0.018911084160208702, 0.02102820947766304, -0.016164541244506836, 0.0064765457063913345, -0.02002686634659767, 0.011980357579886913, 0.008911955170333385, 0.021557491272687912, -0.007452855352312326, -0.004831481724977493, 0.01592135801911354, 0.0005288344691507518, -0.004280742723494768, 0.012209235690534115, 0.011229350231587887, 0.013396543450653553, -0.005049631465226412, 0.03951014578342438, 0.01530624832957983, -0.03662055730819702, 0.007252586539834738, 0.02829510159790516, 0.009705877862870693, -0.0009476999402977526, 0.004666975233703852, 0.07060901075601578, -0.0032168154139071703, -0.028981735929846764, -0.04829335957765579, -0.005528845824301243, -0.04059731960296631, 0.018181534484028816, -0.03930987790226936, 0.028495369479060173, -0.007824783213436604, -0.022616054862737656, 0.025291072204709053, -0.008003594353795052, 0.005131884478032589, -0.0014707229565829039, -0.00283415918238461, 0.012173473834991455, -0.01459815539419651, -0.0017854309407994151, 0.005232018884271383, -0.019182877615094185, -0.007882002741098404, 0.0007139041554182768, 0.024847619235515594, -0.012209235690534115, -0.021943723782896996, -0.00021937912970315665, -0.010228007100522518, 0.057505715638399124, 0.03593391925096512, 0.02162901498377323, -0.03335903584957123, 0.010900337249040604, -0.006444359663873911, -0.007220400497317314, -0.010471190325915813, -0.060824453830718994, -0.016450639814138412, -0.021485967561602592, -0.003808680921792984, 0.03662055730819702, -0.03973902389407158, 0.0028377354610711336, 0.00451319757848978, -0.010406818240880966, 0.03147079050540924, 0.02504788711667061, 0.019883817061781883, 0.013310713693499565, 0.007717495784163475, 0.0331873781979084, -0.015563735738396645, 0.0008068860042840242, -0.001476087374612689, -0.00781047809869051, 0.01919718272984028, -0.012881566770374775, 0.028309406712651253, -0.005071088671684265, -0.028009003028273582, 0.021371526643633842, -0.013639726676046848, -0.013110444881021976, 0.04074036702513695, 0.030841374769806862, -0.016951311379671097, -0.00037125698872841895, -0.015506516210734844, 0.026750171557068825, 0.0014188677305355668, 0.012309370562434196, -0.008990632370114326, -0.02572021819651127, -0.013274951837956905, -0.004280742723494768, -0.052069853991270065, 0.0006289687589742243, -0.013761318288743496, -0.014326361939311028, 0.009999128058552742, 0.024876229465007782, 0.020384488627314568, 0.005528845824301243, 0.031413570046424866, 0.014097483828663826, -0.0024371980689466, -0.001026376849040389, -0.006018788553774357, -0.0036298695486038923, -0.013267799280583858, -0.03321598842740059, 0.04025400057435036, 0.010921794921159744, 0.01886816881597042, -0.0032811874989420176, -0.01233797986060381, -0.0056611658073961735, 0.04139839485287666, -0.0194975845515728, 0.012309370562434196, 0.004373724572360516, -0.01796695962548256, -0.021371526643633842, 0.009999128058552742, 0.0018882474396377802, 0.01418331265449524, 0.031413570046424866, 0.003182841232046485, -0.027021965011954308, -0.009391169995069504, -0.021557491272687912, 0.016379116103053093, 0.017280325293540955, -0.0030523089226335287, 0.030669715255498886, 0.009898994117975235, -0.058249570429325104, 0.00629058200865984, -0.014562392607331276, 0.012881566770374775, 0.018024180084466934, 0.006068855989724398, 0.007234705612063408, 0.006133227609097958, 0.01901121810078621, 0.0009995552245527506, -0.009734487161040306, 0.028881601989269257, -0.020885160192847252, 0.0024193169083446264, -0.021743454039096832, -0.0022995134349912405, 0.00047072075540199876, -0.0032650944776833057, 0.00904069934040308, 0.017008531838655472, -0.0077461060136556625, -0.006644628010690212, -0.0066625094041228294, -0.0049852593801915646, 0.02114264853298664, 0.003027275437489152, 0.027350977063179016, 0.004030406940728426, 0.0038158332463353872, 0.006827015895396471, -0.02799469791352749, -0.02005547657608986, -0.006344225257635117, -0.013897215016186237, 0.022043857723474503, -0.02706488035619259, -0.022015247493982315, 0.024060849100351334, 0.010642848908901215, -0.013589659705758095, 0.024504302069544792, 0.016493555158376694, 0.008661619387567043, -0.02072780579328537, -0.02348865382373333, -0.007259739097207785, 0.004899429623037577, 0.017208799719810486, 0.015721090137958527, 0.016207456588745117, 0.035848092287778854, 0.00014494892093352973, 0.012538248673081398, 0.03181410953402519, 0.015048759989440441, -0.011300874873995781, -0.020785026252269745, -0.0051712230779230595, -0.004312928766012192, -0.01908274181187153, 0.011293722316622734, 0.0015958909643813968, -0.0043379622511565685, -0.0033545000478625298, -0.017008531838655472, -0.02177206426858902, -0.012996005825698376, 0.003048732876777649, 0.01042112335562706, 0.028953127562999725, -0.015220418572425842, 0.035132844001054764, 0.009555676020681858, -0.04663398861885071, -0.0002755929308477789, 0.008797516115009785, -0.01889677904546261, 0.022601749747991562, -0.002703626872971654, 0.008325454778969288, 0.03530450537800789, 0.03181410953402519, -0.0007080927607603371, -0.019225791096687317, 0.016722433269023895, 0.011858765967190266, -0.007932069711387157, 0.0024371980689466, 0.013990196399390697, 0.004105507396161556, -0.02098529413342476, -0.006780524738132954, -0.024146679788827896, -0.009226663038134575, 0.0011604854371398687, -0.05544580891728401, 0.0452607162296772, 0.005468049552291632, 0.022458700463175774, -0.06208328530192375, 0.07352720946073532, 0.03135634958744049, 0.024261118844151497, -0.030068909749388695, 0.012030424550175667, -0.0039016627706587315, 0.04231390729546547, -0.016193151473999023, -0.03158522769808769, 0.01312474999576807, -0.0696362778544426, 0.00673760985955596, -0.007510074879974127, -0.015535126440227032, 0.013904367573559284, 0.0020867278799414635, -0.02808052860200405, 0.026707256212830544, 0.004910158459097147, -0.03169966861605644, 0.03807965666055679, -0.025262461975216866, 0.006469393149018288, -0.003513642121106386, -0.034875355660915375, -0.01239519938826561, 0.009512761607766151, 0.005067512392997742, -0.019855206832289696, 0.0005534209776669741, 0.04242834821343422, 0.016278982162475586, 0.016722433269023895, 0.02114264853298664, -0.0533859021961689, 0.02334560453891754, -0.013997348956763744, -0.018782339990139008, -0.018610680475831032, 0.010971861891448498, 0.019840901717543602, -0.02941088378429413, -0.009534219279885292, 0.016464944928884506, 0.016994226723909378, 0.0019132810411974788, 0.0015476119006052613, 0.007882002741098404, -0.028309406712651253, -0.022158296778798103, 0.04016817361116409, -0.006623170804232359, -0.006390715949237347, -0.013410847634077072, 0.020327270030975342, -0.01418331265449524, -0.030469447374343872, 0.017537813633680344, 0.024060849100351334, 0.012459571473300457, 0.03913822025060654, -0.001764867571182549, 0.030211959034204483, -0.01901121810078621, 0.026750171557068825, -0.007932069711387157, 0.03999651223421097, -0.017094360664486885, -0.005471625830978155, 0.002494417829439044, 0.02620658464729786, -0.0035333114210516214, 0.01454093586653471, -0.02859550341963768, 0.023402823135256767, -0.012109101749956608, -0.015134588815271854, 0.011637039482593536, 0.002295937156304717, -0.02792317420244217, 0.000775146996602416, -0.04892277345061302, 0.04202780872583389, 0.030183348804712296, 0.002385342726483941, 0.042113639414310455, 1.642828829062637e-05, 0.024447081610560417, 0.0127099072560668, 0.00788915529847145, -0.0013786351773887873, -0.011343789286911488, 0.018968302756547928, 0.018210142850875854, -0.009913299232721329, -0.037078313529491425, 0.004831481724977493, 0.01778099685907364, -0.006383563857525587, 0.003241848899051547, 0.017909741029143333, 0.029782811179757118, 0.02553425543010235, 0.007288348861038685, 0.0073205349035561085, 0.0018256634939461946, 0.012988853268325329, 0.02005547657608986, -0.0031399265863001347, 0.01398304384201765, 0.033130157738924026, 0.0022691155318170786, -0.010585629381239414, -0.034503430128097534, 0.018210142850875854, -0.043200813233852386, -0.019626328721642494, 0.00861155241727829, 0.0025802471209317446, 0.0003629869606811553, 0.03195715695619583, -0.021457357332110405, -0.0026249499060213566, 0.0047814142890274525, -0.02042740397155285, 0.01094325166195631, 0.0315566211938858, 0.01247387658804655, 0.02077072113752365, -0.0306411050260067, -0.008618704974651337, -0.02808052860200405, -0.017666557803750038, 0.005264204926788807, -0.020785026252269745, 0.02527676708996296, -0.025934791192412376, 0.014283447526395321, -0.03567643091082573, -0.011679954826831818, 0.021857894957065582, -0.03270101174712181, 0.008432741276919842, -0.012516791932284832]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
" Chung, H. W., Sutton,
C., Gehrmann, S., Schuh, P., Shi, K., Tsvyashchenko,
S., Maynez, J., Rao, A., Barnes, P., Tay, Y ., Shazeer,
N., Prabhakaran, V ., Reif, E., Du, N., Hutchinson, B.,
Pope, R., Bradbury, J., Austin, J., Isard, M., Gur-Ari,
G., Yin, P., Duke, T., Levskaya, A., Ghemawat, S.,
Dev, S., Michalewski, H., Garcia, X., Misra, V ., Robin-
son, K., Fedus, L., Zhou, D., Ippolito, D., Luan, D.,
Lim, H., Zoph, B., Spiridonov, A., Sepassi, R., Do-
han, D., Agrawal, S., Omernick, M., Dai, A. M., Pillai,
T. S., Pellat, M., Lewkowycz, A., Moreira, E., Child,
R., Polozov, O., Lee, K., Zhou, Z., Wang, X., Saeta,
B., Diaz, M., Firat, O., Catasta, M., Wei, J., Meier-
Hellstern, K., Eck, D., Dean, J., Petrov, S., and Fiedel,
N. Palm: Scaling language modeling with pathways. J.
Mach. Learn. Res. , 24:240:1–240:113, 2023. URL http:
//jmlr.org/papers/v24/22-1144.html .
Christiano, P. F., Leike, J., Brown, T. B., Martic, M., Legg,
S., and Amodei, D. Deep reinforcement learning from
human preferences. In Guyon, I., von Luxburg, U.,
9
Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study
Bengio, S., Wallach, H. M., Fergus, R., Vishwanathan,
S. V . N., and Garnett, R. (eds.), Advances in Neural
Information Processing Systems 30: Annual Conference
on Neural Information Processing Systems 2017,
December 4-9, 2017, Long Beach, CA, USA , pp. 4299–
4307, 2017. URL https://proceedings.
neurips.cc/paper/2017/hash/
d5e2c0adad503c91f91df240d0cd4e49-Abstract.
html .
Chung, H. W., Hou, L., Longpre, S., Zoph, B., Tay, Y .,
Fedus, W., Li, E., Wang, X., Dehghani, M., Brahma, S.,
Webson, A., Gu, S. S., Dai, Z., Suzgun, M., Chen, X.,
Chowdhery, A., Narang, S., Mishra, G., Yu, A., Zhao,
V . Y ., Huang, Y ., Dai, A. M., Yu, H., Petrov, S., Chi, E. H.,
Dean, J., Devlin, J., Roberts, A., Zhou, D., Le, Q. V ., and
Wei, J. Scaling instruction-finetuned language models.
CoRR , abs/2210.11416, 2022. doi: 10.48550/ARXIV .
2210.11416. URL https://doi.org/10.48550/
arXiv.2210.11416 .
Dai, J., Pan, X., Sun, R., Ji, J., Xu, X., Liu, M., Wang,
Y ., and Yang, Y . Safe rlhf: Safe reinforcement learning
from human feedback. arXiv preprint arXiv:2310.12773 ,
2023.
Dong, H., Xiong, W., Goyal, D., Pan, R., Diao, S., Zhang,
J., Shum, K., and Zhang, T. RAFT: reward ranked
finetuning for generative foundation model alignment.
CoRR , abs/2304.06767, 2023. doi: 10.48550/ARXIV .
2304.06767. URL https://doi.org/10.48550/
arXiv.2304.06767 .
Engstrom, L., Ilyas, A., Santurkar, S., Tsipras, D., Janoos,
F., Rudolph","[-0.01105304341763258, 0.011115177534520626, 0.06826514005661011, -0.0019175407942384481, 0.010797601193189621, -0.003945542965084314, -0.012019580230116844, 0.021553779020905495, -0.056998081505298615, 0.04034602642059326, 0.01924789883196354, -0.04495778679847717, -0.019662128761410713, 0.005971819162368774, 0.030155960470438004, -0.04918293654918671, 0.03352503478527069, -0.03509910777211189, 0.019648320972919464, 0.038578640669584274, 0.014484250918030739, -0.04360463470220566, 0.0034743561409413815, 0.04575863480567932, 0.03772256523370743, -0.013483193702995777, 0.02750488743185997, 0.03391164913773537, -0.0007723667658865452, -0.015133211389183998, 0.05023232102394104, -0.03371834009885788, -0.019137436524033546, -0.022686008363962173, -0.05266246944665909, 0.014677558094263077, 0.01974497362971306, 0.03576187789440155, -0.03435349464416504, 0.011667484417557716, -0.01749432273209095, -0.05484408140182495, 0.0025388861540704966, 0.06473037600517273, -0.014511865563690662, 0.020628664642572403, 0.023334968835115433, -0.011936734430491924, 0.012357868254184723, 0.053794700652360916, -0.035679031163454056, 0.05199970304965973, -0.02891327068209648, -0.028996115550398827, -0.02863711677491665, 0.0020746029913425446, 0.043466560542583466, 0.019303128123283386, 0.006579356733709574, 0.0035416684113442898, -0.020228242501616478, -0.06086422875523567, -0.0019572379533201456, 0.005871713627129793, -0.02957603894174099, -0.03261372819542885, -0.06439899653196335, -0.0031878468580543995, 0.022492701187729836, 0.043190404772758484, -0.0015369667671620846, -0.005488550756126642, 0.03291749581694603, -0.025212813168764114, 0.0020314541179686785, -0.018198514357209206, -0.0014144236920401454, 0.10399940609931946, -0.02448100596666336, -0.021829932928085327, -0.009527294896543026, 0.0031774910166859627, 0.02080816589295864, -0.06754714250564575, -0.035706646740436554, -0.04628332331776619, -0.023928700014948845, 0.004608311224728823, -0.04562055692076683, -0.009568718262016773, -0.030404498800635338, -0.018502283841371536, -0.02830573171377182, -0.004801618866622448, 0.04622809216380119, 0.012364772148430347, 0.009927717968821526, 0.006296299397945404, 0.033469803631305695, 0.013945750892162323, -0.026179350912570953, -0.03750164434313774, 0.010990908369421959, -0.01589263416826725, 0.028333347290754318, -0.012551176361739635, -0.012281926348805428, -0.0017397670308128, -0.011025427840650082, 0.012523560784757137, -0.12382722645998001, -0.008112008683383465, -0.02910657785832882, -0.0043321577832102776, 0.015713132917881012, -0.07334636896848679, -0.05771607905626297, 0.010611197911202908, -0.03446395695209503, 0.010183160193264484, -0.009637757204473019, 0.012606406584382057, 0.0309844221919775, 0.0002873722114600241, 0.01938597485423088, -0.015561249107122421, 0.039324257522821426, -0.05473362281918526, -0.024909045547246933, -0.023583507165312767, -0.0020107426680624485, 0.004232052247971296, 0.006707077845931053, -0.03233757242560387, -0.08516573905944824, -0.003966254647821188, -0.007532086223363876, 0.017687631770968437, -0.014649942517280579, -0.043797943741083145, 0.011073755100369453, -0.029189424589276314, -0.05614200234413147, 0.03068065270781517, -0.03896525874733925, -0.005101935472339392, -0.01826755329966545, 0.010466217063367367, -0.022354625165462494, 0.012523560784757137, 0.0007809965754859149, -0.004746388178318739, -0.016914401203393936, 0.01971735991537571, -0.04150586947798729, -0.0413954071700573, -0.0365351065993309, 0.06257638335227966, 0.024591468274593353, -0.0381920263171196, 0.028692347928881645, 0.07329113781452179, 0.003669389523565769, -0.001012275111861527, 0.04307994246482849, 0.01128087006509304, -0.022202741354703903, 0.013607462868094444, -0.0588206946849823, -0.023279739543795586, -0.0004245859745424241, 0.010562870651483536, -0.022368432953953743, -0.026828311383724213, -0.006051213480532169, -0.01455328892916441, -0.014705173671245575, -0.002024550223723054, -0.01622401736676693, -0.056528620421886444, 0.008974988013505936, 0.021995624527335167, -0.05117124319076538, 0.03150911256670952, -0.045233942568302155, 0.0010994360782206059, -1.1454706509539392e-05, 0.0010735467076301575, 0.012123137712478638, 0.0556449294090271, 0.011978157795965672, 0.037915874272584915, 0.06467514485120773, 0.008063681423664093, -0.024674315005540848, -0.03239280357956886, 0.05848930776119232, -0.02497808262705803, 0.008132720366120338, -0.034905802458524704, -0.0046738977544009686, 0.02321070060133934, -0.021567586809396744, -0.0492933988571167, -0.0026148282922804356, -0.009119968861341476, -0.02481239102780819, -0.014705173671245575, -0.050315164029598236, -0.03004550002515316, 0.019965896382927895, 0.04818878322839737, 0.05362900719046593, 0.005902780685573816, -0.047912631183862686, -0.005550685338675976, -0.03233757242560387, -0.016431132331490517, 0.014967518858611584, 0.02765677124261856, 0.019040783867239952, 0.022271778434515, 0.038551028817892075, 0.02431531436741352, -0.022216547280550003, 0.01137752365320921, 0.017729053273797035, 0.0006705351988784969, 0.043466560542583466, -0.002167804865166545, 0.06334961205720901, -0.0025181747041642666, -0.005264176055788994, -0.03150911256670952, -0.006696722004562616, -0.004894820507615805, -0.006541385781019926, -0.035347647964954376, 0.005519617814570665, -0.034878186881542206, 0.012903272174298763, 0.005315954796969891, 0.003434658981859684, 0.005464387126266956, 0.024674315005540848, 0.05470600724220276, -0.03937948867678642, -0.04089833050966263, 0.03620372340083122, 0.019344551488757133, 0.029990268871188164, -0.014594712294638157, -0.01698344014585018, -0.039048101752996445, -0.03197857365012169, -0.042058177292346954, -0.005933848209679127, -0.007055721711367369, -0.024922851473093033, -0.023735392838716507, -0.04216863587498665, 0.04741555452346802, -0.01382838562130928, 0.032972726970911026, 0.016417324542999268, 0.01794997602701187, -0.0540432371199131, 0.042527638375759125, -0.009513488039374352, -0.007290452253073454, 0.04042886942625046, 0.006634587422013283, -0.01719055511057377, 0.009444449096918106, -0.05959392338991165, -0.04261048138141632, 0.02399773895740509, 0.04261048138141632, -0.05931776762008667, -0.00449094595387578, 0.013752443715929985, 0.036811258643865585, 0.06616637855768204, 0.004159561824053526, 0.005650790873914957, 0.02180231735110283, 0.01890270598232746, -0.04305233061313629, -0.03465726226568222, -0.00048801497905515134, -0.0006101265898905694, -0.008719546720385551, 0.011384427547454834, -0.056501004844903946, 0.04145063832402229, 0.02256174013018608, 0.02434292994439602, 0.00019934830197598785, 0.02243747003376484, -0.01875082217156887, 0.0206838957965374, -0.020393935963511467, -0.025199005380272865, 0.007138567510992289, 0.009472064673900604, 0.017052477225661278, -0.003225818043574691, -0.007835854776203632, 0.04537201672792435, -0.0030860151164233685, 0.012654733844101429, 0.014263327233493328, -0.02051820419728756, -0.01604451797902584, -0.03642464429140091, -0.04854778200387955, 0.04230671375989914, -0.022616971284151077, 0.03294511139392853, -0.03272418677806854, -0.03322126343846321, -0.033635493367910385, -0.022188933566212654, 0.004822330083698034, 0.010618101805448532, 0.04584147781133652, 0.03995940834283829, -0.0022661846596747637, -0.012910175137221813, -0.03115011379122734, 0.011308485642075539, 0.020228242501616478, 0.03382880240678787, -0.006323914974927902, -0.008464104495942593, -0.014263327233493328, -0.035872336477041245, 0.055562082678079605, 0.03366310894489288, 0.03926902636885643, -0.08196235448122025, -0.01471898052841425, -0.05368423834443092, -0.021968010812997818, -0.04628332331776619, 0.007980835624039173, -0.02097385749220848, 0.011025427840650082, 0.03794348984956741, 0.03319364786148071, 0.00664494326338172, -0.025185197591781616, 0.02844380959868431, 0.009768929332494736, -0.02448100596666336, 0.014926096424460411, 0.007104048505425453, -0.019261706620454788, -0.016610631719231606, 0.00568185793235898, -0.020076358690857887, 0.0009199362830258906, 0.009989852085709572, -0.012834233231842518, -0.014415211975574493, -0.0034657262731343508, -0.028499040752649307, 0.011750331148505211, 0.00429418683052063, -0.0063273669220507145, 0.004045648500323296, 0.02147093415260315, -0.06605591624975204, 0.011998869478702545, -0.04470925033092499, 0.02384585328400135, -0.004056004341691732, 0.027380619198083878, -0.0029721020255237818, 0.02573750540614128, 0.016596823930740356, 0.025558006018400192, -0.00029772796551696956, -0.014511865563690662, -0.010901158675551414, 0.027380619198083878, -0.004121590871363878, -0.008395066484808922, -0.000573018507566303, -0.003358716843649745, 0.008678123354911804, -0.004273475147783756, -0.030487345531582832, 0.03208903595805168, 0.01862655207514763, 0.011142793111503124, 0.008063681423664093, -0.005277983378618956, 0.031232958659529686, 0.03606564551591873, -0.017853323370218277, -0.019054589793086052, -0.012999925762414932, -0.0076563553884625435, -0.024411968886852264, 0.04186486825346947, 0.009499680250883102, 0.06688437610864639, 0.0016120460350066423, 0.022630779072642326, 0.0073525868356227875, -0.06461991369724274, 0.010928774252533913, -0.023404007777571678, 0.017301015555858612, -0.04302471503615379, 0.0077115860767662525, 0.006071924697607756, 0.026303619146347046, 0.05771607905626297, 0.0021954202093183994, -0.0035727357026189566, -0.018971744924783707, -0.03910333290696144, -0.03797110542654991, 0.03070826828479767, 0.026800695806741714, -0.04504063352942467, 0.03518195450305939, -0.03910333290696144, -0.020752934738993645, 0.028747577220201492, 0.04501301795244217, -0.02097385749220848, -0.03752925992012024, -0.054788850247859955, 0.024094391614198685, 0.01684536226093769, 0.02195420302450657, -0.041284944862127304, 0.03391164913773537, 0.004891368560492992, -0.049680013209581375, 0.005309050902724266, -0.00914068054407835, -0.013869808986783028, -0.03879956528544426, 0.02287931740283966, 0.005712925456464291, -0.029520807787775993, 0.00978964101523161, 0.013220848515629768, 0.04973524436354637, -0.002751179039478302, 0.018957937136292458, -0.019814012572169304, 0.09256664663553238, -0.021415702998638153, 0.07262836396694183, 0.009002603590488434, 0.03717026114463806, 0.020587243139743805, -0.03990418091416359, -0.005871713627129793, 0.011142793111503124, 0.04219625145196915, 0.017770476639270782, 0.006772664375603199, 0.0031222603283822536, -0.038247257471084595, -0.010618101805448532, -0.009216622449457645, -0.024273891001939774, -0.0492933988571167, -0.009278757497668266, 0.007884182035923004, 0.01829516887664795, -0.04258286952972412, -0.03167480602860451, -0.03642464429140091, 0.00319647672586143, -0.036010414361953735, 0.024218661710619926, 0.015298902988433838, 0.04120210185647011, 0.06484083831310272, 0.011819369159638882, -0.00010803426266647875, -0.03302795812487602, 0.015989286825060844, 0.007725393865257502, -0.012910175137221813, 0.04053933173418045, -0.016665862873196602, -0.03034926764667034, -0.00222476152703166, 0.0010407534427940845, -0.007628740277141333, -0.01207481138408184, -0.016817746683955193, 0.038385335355997086, -0.016776325181126595, -0.00031908671371638775, -0.0008051600307226181, -0.010928774252533913, -0.002093588700518012, 0.014014789834618568, -0.0064792511984705925, 0.009340891614556313, 0.06566929817199707, -0.0047705513425171375, 0.012530464679002762, -0.01327607873827219, 0.017066285014152527, 0.012716867960989475, 0.03913094848394394, -0.0206838957965374, -0.008968084119260311, -0.020407741889357567, 0.0651169940829277, -0.009147584438323975, -0.01734243892133236, -0.0031308901961892843, -0.012509752996265888, 0.02750488743185997, -0.0021626269444823265, -0.020421549677848816, -0.04341132938861847, -0.023279739543795586, -0.02050439640879631, 0.02017301321029663, 0.008256989531219006, 0.018999360501766205, -0.009085449390113354, -0.05426416173577309, 0.010735467076301575, -0.00858837366104126, -0.024881429970264435, -0.03642464429140091, 0.014525673352181911, 0.012765195220708847, 0.0309844221919775, 0.0032879523932933807, 0.0350162610411644, 0.009347795508801937, -0.016182594001293182, 0.019040783867239952, -0.02275504730641842, -0.006655299104750156, 0.03532003238797188, 0.05688761919736862, -0.048271629959344864, -0.02336258441209793, -0.006334270816296339, -0.010521448217332363, -0.01938597485423088, -0.008961181156337261, -0.010051987133920193, -0.0002936288365162909, 0.0190960131585598, 0.01064571738243103, -0.018709398806095123, 0.014939903281629086, 0.0001546890998724848, -0.04258286952972412, 0.006679462268948555, 0.00680027948692441, -0.044129326939582825, 0.019496437162160873, -0.0027718907222151756, -0.005319406744092703, -0.023638738319277763, 0.005616271402686834, -0.03868910297751427, 0.007545894011855125, -0.017549553886055946, -0.010355755686759949, 0.024729544296860695, 0.029935037717223167, 0.006524126045405865, -0.04145063832402229, -0.014898480847477913, 0.0023576603271067142, -0.002226487500593066, -0.055424004793167114, 0.02032489702105522, 0.010431697592139244, 0.01517463382333517, -0.027449656277894974, 0.011108273640275002, 0.03891002759337425, -0.03429826349020004, -0.0159202478826046, -0.03131580725312233, -0.03070826828479767, -0.005195137578994036, 0.016016902402043343, -0.024536237120628357, -0.002742549404501915, 0.015809787437319756, 0.010721659287810326, -0.00993462186306715, 0.005861357785761356, -0.03689410537481308, -0.015630288049578667, -0.003336279420182109, -0.021222395822405815, 0.014870865270495415, -0.0009898376883938909, -0.010121025145053864, -0.020725319162011147, -0.0079601239413023, -0.0009337439551018178, -0.02461908385157585, -0.02305881679058075, -0.007179990876466036, -0.013980270363390446, -0.002040083985775709, 0.051889240741729736, -0.007290452253073454, 0.0028892557602375746, -0.02830573171377182, 0.03769494965672493, 0.005806127097457647, 0.014429019764065742, 0.011757235042750835, 0.009976045228540897, -0.012350964359939098, -0.026345042511820793, -0.01032814010977745, -0.019772589206695557, -0.014884673058986664, 0.01908220537006855, -0.0034743561409413815, 0.02176089398562908, -0.006903837434947491, 0.006845154799520969, -0.022851701825857162, 0.015478403307497501, -0.026358850300312042, 0.010797601193189621, -0.0029565682634711266, 0.006672558840364218, -0.026980195194482803, 0.026911158114671707, -0.010390275157988071, 0.003412221558392048, 0.0007412995328195393, -0.01670728623867035, -0.012150753289461136, -0.021678049117326736, -0.037915874272584915, 0.017687631770968437, 0.005291791167110205, 0.027587734162807465, -0.018847474828362465, -0.007394009735435247, -0.02717350237071514, -0.002297251718118787, -0.01607213355600834, -0.053490929305553436, 0.02847142517566681, -0.020380128175020218, 0.01398717425763607, -0.0017250963719561696, 0.033331725746393204, 0.023141661658883095, 0.04813355207443237, 0.024398161098361015, -0.020891010761260986, -0.004677349701523781, -0.002854736754670739, 0.03258611261844635, -0.008774776943027973, -0.0043183499947190285, -0.046145249158144, 0.011481081135571003, -0.018212322145700455, -0.005737088620662689, 0.03308318927884102, -0.041754405945539474, 0.037115029990673065, -0.06975637376308441, -0.03937948867678642, 0.012564984150230885, -0.016168786212801933, 0.02641408145427704, -0.0018485024338588119, 0.008615989238023758, 0.015326518565416336, 0.005750896409153938, -0.008774776943027973, -0.002091862726956606, -0.014387596398591995, -0.000936332915443927, 0.026938773691654205, -0.002609650371596217, 0.059207309037446976, -0.024398161098361015, -0.11996107548475266, 0.0004893094883300364, 0.011149697005748749, -0.016942016780376434, -0.009258045814931393, -0.02844380959868431, -0.011287773959338665, -0.025171389803290367, 0.015312710776925087, 0.028664732351899147, -0.017301015555858612, -0.019800204783678055, -0.015630288049578667, -0.01638970896601677, 0.026289811357855797, -0.041561100631952286, 0.01208861917257309, 0.035237185657024384, 0.008326027542352676, 0.009258045814931393, -0.026027467101812363, -0.05324239283800125, -0.0078082396648824215, 0.02303120121359825, 0.0012487315107136965, 0.007628740277141333, -0.03404972329735756, -0.02880280837416649, -0.005833742208778858, -0.013365828432142735, 0.0016379354055970907, -0.003282774705439806, 0.014663750305771828, 0.004918984137475491, -0.013628174550831318, 0.0006019283318892121, 0.008388162590563297, -0.03667318448424339, -0.0037177163176238537, -0.03159195929765701, 0.010148640722036362, -0.00849172007292509, -0.01286875270307064, -0.02228558622300625, 0.03051496110856533, 0.0026994002982974052, -0.003690100973471999, 0.036038029938936234, 0.02927226945757866, 0.007179990876466036, -0.006399856880307198, -0.04051171615719795, 0.012406195513904095, 0.013835289515554905, 0.012392387725412846, 0.014290942810475826, -0.0318128801882267, -0.0061651268042624, -0.007891085930168629, -0.019675936549901962, 0.004729128442704678, 0.014290942810475826, 0.008339835330843925, -0.009879390709102154, 0.0033518129494041204, 0.02638646587729454, -0.02449481375515461, 0.005909684579819441, -0.018875090405344963, -0.009113064967095852, 0.019510243088006973, -0.005250368267297745, -0.01518844161182642, 0.0025492419954389334, 0.023763008415699005, 0.05186162516474724, -0.014208097010850906, 0.010914966464042664, 0.042030561715364456, -0.004670445807278156, 0.0036935529205948114, -0.024232469499111176, -0.012999925762414932, 0.05760561674833298, -0.0206838957965374, -0.03747402876615524, -0.04051171615719795, -0.03476772457361221, -0.02608269639313221, 0.006531029939651489, -0.03879956528544426, -0.04183725267648697, 0.01778428442776203, 0.010024371556937695, 0.020614858716726303, 0.0038730527739971876, 0.03418780118227005, -0.0031878468580543995, -0.11145554482936859, -0.029189424589276314, 0.023486854508519173, 0.017535746097564697, -0.00520204147323966, -0.029852192848920822, 0.033773571252822876, 0.019289320334792137, 0.020725319162011147, -0.0524415485560894, 0.023404007777571678, -0.0016094570746645331, 0.020739126950502396, 0.0034760821145027876, 0.027242541313171387, -0.06102992221713066, 0.01607213355600834, -0.029023731127381325, 0.04401886463165283, 0.014208097010850906, -0.030901575461030006, 0.01670728623867035, 0.010480024851858616, 0.03830248862504959, -0.017052477225661278, -0.0023576603271067142, 0.012061003595590591, 0.020228242501616478, -0.010473120957612991, 0.003303486155346036, -0.03449157252907753, -0.024853814393281937, 0.018226129934191704, 0.047443170100450516, -0.030873959884047508, 0.013862905092537403, -0.02209227904677391, -0.013510809279978275, 0.00015673867892473936, -0.0046186670660972595, -0.008650507777929306, -0.041091639548540115, 0.03479534015059471, -0.017604785040020943, 0.05384993180632591, -0.000349722511600703, 0.015547441318631172, -0.020131589844822884, 0.022810278460383415, -0.010114121250808239, 0.024287698790431023, 0.007152375299483538, -0.017549553886055946, 0.0035727357026189566, 0.026041273027658463, -0.009755121544003487, 0.01319323293864727, -0.010438601486384869, 0.0381920263171196, 0.016638247296214104, -0.001651743077673018, 0.022630779072642326, -0.007884182035923004, -0.0053988005965948105, -0.008139624260365963, -0.006461991462856531, -0.009340891614556313, 0.021898971870541573, -0.035347647964954376, -0.04117448627948761, -0.040484100580215454, 0.02816765569150448, 0.0004222127899993211, 0.032199498265981674, -0.0057957712560892105, -0.01215765718370676, 0.036176107823848724, 0.03573426231741905, -0.027532503008842468, 0.0069176447577774525, 0.032696571201086044, -0.027435848489403725, -0.0022420210298150778, 0.006051213480532169, -0.02368016168475151, 0.030901575461030006, 0.015782171860337257, 0.019123628735542297, -0.010445505380630493, 0.030929191038012505, 0.042831405997276306, -0.0027684387750923634, 0.011722715571522713, -0.019648320972919464, 0.012696156278252602, -0.015671709552407265, -0.0010813134722411633, 0.02479858323931694, 0.0318404957652092, -0.006531029939651489, 0.03161957487463951, 0.02815384790301323, -0.06285253167152405, -0.0005402252427302301, -0.0012573613785207272, 0.001167611451819539, -0.009865582920610905, 0.0011589817004278302, -0.004477138631045818, -0.004894820507615805, 0.012765195220708847, 0.025544198229908943, -0.03277941793203354, 0.004994926042854786, -0.003051496110856533, 0.010493832640349865, 0.028222886845469475, 0.030929191038012505, -0.002324867295101285, 0.03324887901544571, 0.009161392226815224, -0.009209718555212021, 0.0004534957988653332, 0.027311580255627632, -0.03526480123400688, -0.015312710776925087, 0.012309541925787926, 0.010127929039299488, -0.05263485386967659, -0.009478968568146229, 0.05053608864545822, -0.012930886819958687, 0.012972310185432434, -0.0049051763489842415, -0.011784849688410759, 0.019841628149151802, 0.04882393777370453, 0.026483120396733284, -0.03714264556765556, 0.03404972329735756, 0.015119403600692749, -0.02018681913614273, 0.020269665867090225, 0.01375934761017561, 0.009195910766720772, -0.003403591690585017, -0.018999360501766205, -0.04208579286932945, 0.0050018299371004105, 0.00568185793235898, 0.03159195929765701, -0.0246605072170496, -0.013103483244776726, 0.028043387457728386, -0.0053988005965948105, -0.013075867667794228, 0.012102426961064339, -0.03924141079187393, -0.0035071494057774544, 0.0206838957965374, 0.021885164082050323, 0.050177089869976044, -0.005654242821037769, -0.03277941793203354, 0.02127762697637081, -0.026648811995983124, -0.01862655207514763, -0.03051496110856533, -0.013151809573173523, 0.016348285600543022, -0.0050156377255916595, 0.0037177163176238537, 0.02495046705007553, 0.00858837366104126, 0.016803938895463943, 0.016320671886205673, 0.012337157502770424, 0.0017708342056721449, 0.0032672409433871508, 0.057163771241903305, 0.041588716208934784, -6.035463957232423e-05, -0.0020159203559160233, -0.013179425150156021, 0.03755687549710274, -0.014166673645377159, 0.014277135021984577, -0.006030501797795296, -0.011557023040950298, 0.0445711724460125, -5.9383786719990894e-05, 0.022050855681300163, 0.007442336529493332, 0.04642140120267868, 0.01288256049156189, -0.03465726226568222, 0.02528185211122036, 0.025033313781023026, -0.02561323530972004, -0.031757652759552, -0.0027166600339114666, 0.046669937670230865, 0.0009121695184148848, 0.00936850719153881, -0.03948994725942612, 0.020476780831813812, 0.005081224255263805, -0.04098117724061012, 0.008422681130468845, 0.013365828432142735, 0.008291508071124554, 0.01973116584122181, -0.02957603894174099, 0.017259592190384865, -0.0003525271895341575, -0.035844724625349045, 0.023804429918527603, -0.01066642813384533, -0.017618592828512192, -0.005657694768160582, -0.020877202972769737, -0.022506508976221085, 0.0009777559898793697, 0.015657903626561165, -0.005743992514908314, 0.006386049557477236, 0.015160826966166496, -0.003358716843649745, 0.0031326161697506905, 0.011777946725487709, -0.011584638617932796, -0.0008694520220160484, -0.019261706620454788, -0.0214847419410944, 0.012385483831167221, -0.010887350887060165, -0.006910740863531828, -0.003234447678551078, -0.026635004207491875, 0.0054920027032494545, 0.030818728730082512, 0.02242366410791874, 0.013524617068469524, -0.008954277262091637, 0.021208588033914566, 0.013386540114879608, -0.00413885060697794, 0.03471249341964722, -0.02286550961434841, -0.021042896434664726, 0.005295243114233017, -0.005443675443530083, 0.04006987065076828, -0.006051213480532169, 0.0033863321878015995, 0.00039783361717127264, 0.00323789962567389, 0.04388079047203064, 0.02575131319463253, 0.03703218325972557, -0.009796544909477234, 0.0270354263484478, -0.002963472157716751, -0.0131241949275136, 0.004342513624578714, -0.015298902988433838, -0.0021315596532076597, 0.020946241915225983, 0.0036072549410164356, 0.02971411496400833, -0.030901575461030006, 0.00922352634370327, -0.00020657575805671513, 0.017673823982477188, 0.004107783082872629, -0.011536312289536, 0.012109330855309963, -0.017425285652279854, 0.011874600313603878, 0.013234656304121017, -0.024991890415549278, -0.016113556921482086, 0.014111443422734737, -0.0012401017593219876, 0.013738635927438736, -0.009430641308426857, -0.0034260291140526533, -0.029493192210793495, 0.026289811357855797, -0.011570830829441547, 0.007193798199295998, 0.019965896382927895, -0.030321653932332993, -0.004083619918674231, -0.00867121946066618, -0.001893377397209406, 0.008270797319710255, -0.003501971485093236, 0.029852192848920822, -0.02863711677491665, 0.03468487784266472, 0.006620780099183321, 0.016803938895463943, -0.0003527429362293333, 0.022313201799988747, -0.0008871430763974786, 0.019496437162160873, -0.05942822992801666, 0.011681292206048965, -0.015423172153532505, -0.011557023040950298, -0.0022730883210897446, 0.018709398806095123, 0.00851243082433939, 0.022368432953953743, 0.001014001085422933, -0.021843740716576576, -0.0238320454955101, 0.004877560772001743, -0.008298411965370178, 0.008705738931894302, 0.003948994912207127, 0.011777946725487709, 0.020076358690857887, -0.027228733524680138, -0.017093900591135025, 0.010438601486384869, -0.018971744924783707, 0.00306012574583292, 0.015202249400317669, 0.029990268871188164, 0.02160901017487049, -0.02050439640879631, 0.012461425736546516, -0.032641343772411346, 6.64426897856174e-06, -0.04622809216380119, -0.0031308901961892843, -0.020283473655581474, -0.02511616051197052, 0.0555896982550621, 0.00731116347014904, -0.007573509588837624, -0.013165617361664772, -0.00034454462002031505, 0.012337157502770424, -0.008892142213881016, 0.006451636087149382, 0.018336592242121696, -0.027739617973566055, 0.07909035682678223, -0.0017587525071576238, 0.009575622156262398, 0.01619640178978443, -0.03995940834283829, 0.0508398562669754, -0.0182813610881567, -0.0038385335355997086, -0.030956806614995003, 0.010514544323086739, 0.00405255239456892, 0.02990742214024067, -0.02116716466844082, -0.006444732192903757, 0.00826389342546463, -0.02116716466844082, -0.0031654094345867634, 0.019993511959910393, 0.0015818417305126786, 0.021526165306568146, 0.02323831617832184, 0.0333869569003582, -0.005319406744092703, -0.021981816738843918, 0.000577764876652509, 0.017439093440771103, 0.0016405243659392, -0.004787811078131199, 0.015395556576550007, 0.060422383248806, -0.014235712587833405, -0.040318410843610764, -0.05037039518356323, 0.014774211682379246, -0.016127362847328186, 0.023086432367563248, -0.02671784907579422, 0.018529899418354034, 0.0043321577832102776, -0.019026976078748703, 0.010024371556937695, -0.0017216444248333573, -0.0009069915977306664, 0.018695591017603874, -0.0017156035173684359, 0.014746596105396748, -0.006154770962893963, 0.003966254647821188, 0.002863366389647126, 0.004270023200660944, -0.010369563475251198, -0.013711020350456238, 0.008250085636973381, -0.021070512011647224, -0.015644095838069916, 0.002276540268212557, -0.01288256049156189, 0.04838209226727486, 0.02176089398562908, 0.03131580725312233, -0.030597805976867676, 0.00488791661337018, -0.01605832576751709, -0.008629796095192432, -0.004694609437137842, -0.0476917065680027, -0.009409930557012558, -0.0023714681155979633, -0.012268118560314178, 0.041920099407434464, -0.0382196418941021, -0.007932509295642376, -0.018861282616853714, 0.0056853098794817924, 0.028526654466986656, 0.008291508071124554, 0.011660581454634666, 0.010859736241400242, -0.0010053713340312243, 0.03225472569465637, -0.018654167652130127, -0.005236560478806496, -0.02287931740283966, 0.025544198229908943, 0.029161809012293816, -0.01968974433839321, 0.02670404314994812, -0.005750896409153938, -0.03576187789440155, 0.0333869569003582, -0.008843815885484219, 3.5948494769399986e-05, 0.0572190023958683, 0.03247565031051636, -0.030901575461030006, -0.014857057482004166, -0.014995134435594082, 0.01262711826711893, 0.019814012572169304, 0.0043666772544384, -0.0013169070007279515, -0.004121590871363878, -0.008940469473600388, 0.019924474880099297, -0.023169277235865593, 0.000560936750844121, -0.023555893450975418, -0.012378579936921597, 0.006720885634422302, 0.00592349236831069, -0.0005605052574537694, -0.0024128910154104233, 0.0508950874209404, 0.02606888860464096, -0.0014955437509343028, 0.026759272441267967, -0.013089675456285477, 0.02815384790301323, 0.0018364207353442907, -0.03126057609915733, 0.02351447008550167, -0.0006670832517556846, 0.031039651483297348, 0.002552693709731102, -0.017894746735692024, -0.002749453065916896, 0.030956806614995003, -0.012309541925787926, -0.0003078680019825697, -0.003576187649741769, -0.027242541313171387, -0.028333347290754318, 0.013607462868094444, 0.0024474102538079023, 0.008622893132269382, 0.011315389536321163, -0.0008806707337498665, -0.00759422080591321, -0.012834233231842518, 0.00393863907083869, 0.003051496110856533, 0.02351447008550167, 0.0006161674973554909, 0.03471249341964722, 0.011612254194915295, -0.0254199281334877, 0.020462973043322563, -0.020752934738993645, 0.008974988013505936, 0.001860584132373333, -0.009644660167396069, -0.00047032389556989074, -0.008567661978304386, 0.010279813781380653, 0.011819369159638882, -0.013068963773548603, 0.016279248520731926, -0.014401404187083244, -0.009837968274950981, -0.029051346704363823, 0.008167239837348461, 0.005913136526942253, 0.005350473802536726, 0.019427398219704628, 0.02144331857562065, -0.03772256523370743, -0.041119255125522614, 0.0027045782189816236, 0.0014066568110138178, 0.014801827259361744, -0.012150753289461136, 0.032834649085998535, 0.010659524239599705, -0.011059947311878204, -0.0027546309866011143, -0.017742861062288284, -0.025820350274443626, -0.015326518565416336, -0.0006834798841737211, 0.0009976044530048966, -0.029769346117973328, -0.007045365869998932, 0.019993511959910393, 0.01097019761800766, -0.0103419478982687, 0.00858837366104126, 0.00881620030850172, 0.015229864977300167, -0.014249520376324654, -0.014898480847477913, -0.009161392226815224, -0.010783793404698372, 0.01517463382333517, 0.008367450907826424, 0.014263327233493328, 0.038385335355997086, 0.013303694315254688, 0.036038029938936234, 0.04354940354824066, 0.005067416466772556, -0.02721492573618889, -0.01375934761017561, 0.002181612653657794, -0.008436488918960094, -0.00970679521560669, 0.011895311065018177, 0.0011710633989423513, 0.008360547013580799, 0.012164561077952385, -0.0008806707337498665, -0.019289320334792137, -0.017618592828512192, 0.016721094027161598, 0.006071924697607756, 0.02351447008550167, -0.006144415121525526, 0.012261214666068554, 0.009900102391839027, -0.03545810654759407, -0.016016902402043343, 0.010700947605073452, -0.008077489212155342, 0.01392503920942545, -0.005257272161543369, -0.011557023040950298, 0.046642325818538666, 0.019634513184428215, -0.0030117989517748356, 0.015202249400317669, 0.02655215747654438, 0.009202814660966396, -0.0061651268042624, 0.0021108482033014297, 0.001696618041023612, 0.0011546667665243149, -0.007062625605612993, 0.01025910209864378, 0.012827329337596893, -0.008691931143403053, 0.008360547013580799, -0.030570190399885178, 0.036341797560453415, 0.007587316911667585, 0.014221904799342155, -0.056362926959991455, 0.08500004559755325, 0.03860625624656677, 0.023431623354554176, -0.03741879761219025, 0.03717026114463806, -0.020711511373519897, 0.02017301321029663, -0.008132720366120338, -0.047912631183862686, 0.020435357466340065, -0.07124760001897812, -0.010935678146779537, -0.01667967066168785, -0.021885164082050323, 0.013773155398666859, 0.017370054498314857, -0.026027467101812363, 0.0030670296400785446, 0.015271288342773914, -0.03404972329735756, 0.023141661658883095, -0.018640359863638878, 0.007545894011855125, 0.022147510200738907, -0.03556856885552406, -0.003358716843649745, 0.021581394597887993, -0.007870374247431755, -0.019620705395936966, -0.003969706594944, 0.028236694633960724, 0.022796470671892166, 0.006365337874740362, 0.01937216706573963, -0.031426265835762024, 0.023611122742295265, -0.014208097010850906, -0.011543216183781624, -0.027477271854877472, -0.00891285389661789, 0.017397670075297356, -0.022009432315826416, -0.029603654518723488, 0.003070481587201357, 0.013179425150156021, -0.005267628002911806, 0.011481081135571003, 0.002411165041849017, -0.021719472482800484, -0.015367941930890083, 0.03606564551591873, 0.010224582627415657, -0.017521938309073448, 0.0032793227583169937, 0.03192334249615669, -0.006365337874740362, -0.01619640178978443, 0.007338779047131538, 0.020228242501616478, 0.01717674732208252, 0.05045324191451073, 0.0018139831954613328, 0.03667318448424339, -0.01201267633587122, 0.025019505992531776, 0.010424794629216194, 0.010659524239599705, -0.00907164253294468, 0.02069770358502865, 0.0159202478826046, 0.025516582652926445, -0.01590644009411335, 0.009506584145128727, -0.028388578444719315, 0.03261372819542885, -0.00647579925134778, -0.015423172153532505, 0.008388162590563297, 0.012143849395215511, 0.00938231498003006, 0.005215848796069622, -0.02608269639313221, 0.06500653177499771, 0.038053952157497406, -0.0023162374272942543, 0.028996115550398827, -0.013731732033193111, 0.018861282616853714, 0.013393444009125233, -0.0008068859460763633, 0.006396405398845673, -0.010769985616207123, 0.014346173964440823, 0.02673165686428547, -0.02368016168475151, -0.035706646740436554, 0.013862905092537403, -0.004925888031721115, 0.01447044312953949, -0.018681783229112625, 0.011584638617932796, 0.0056024640798568726, 0.024563852697610855, 0.006341174244880676, -0.0010925321839749813, 0.03131580725312233, 0.022699816152453423, 0.012047195807099342, -0.010763082653284073, 0.005005281884223223, 0.026289811357855797, 0.013138001784682274, -0.017080092802643776, -0.0524967797100544, -0.0030998229049146175, -0.04992854967713356, -0.005309050902724266, 0.028719963505864143, 0.014525673352181911, 0.007110952399671078, 0.017701437696814537, 0.005340117961168289, -0.017756668850779533, -0.024384353309869766, -0.016914401203393936, 0.015381749719381332, 0.029217038303613663, 0.012033388018608093, 0.021829932928085327, -0.029796961694955826, -0.015160826966166496, -0.022658392786979675, -0.011501792818307877, 0.02287931740283966, 0.0011736523592844605, 0.011487985029816628, -0.002366290194913745, 0.0009932896355167031, -0.02576512098312378, -0.0010744096944108605, 0.009982948191463947, -0.017715245485305786, 0.017908554524183273, -0.015782171860337257]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
", L., and Madry, A. Implementation matters
in deep RL: A case study on PPO and TRPO. In 8th
International Conference on Learning Representations,
ICLR 2020, Addis Ababa, Ethiopia, April 26-30, 2020 .
OpenReview.net, 2020. URL https://openreview.
net/forum?id=r1etN1rtPB .
Gao, L., Schulman, J., and Hilton, J. Scaling laws for
reward model overoptimization. In Krause, A., Brun-
skill, E., Cho, K., Engelhardt, B., Sabato, S., and
Scarlett, J. (eds.), International Conference on Ma-
chine Learning, ICML 2023, 23-29 July 2023, Hon-
olulu, Hawaii, USA , volume 202 of Proceedings of
Machine Learning Research , pp. 10835–10866. PMLR,
2023. URL https://proceedings.mlr.press/
v202/gao23h.html .
Haarnoja, T., Zhou, A., Abbeel, P., and Levine, S.
Soft actor-critic: Off-policy maximum entropy deep
reinforcement learning with a stochastic actor. In
Dy, J. G. and Krause, A. (eds.), Proceedings ofthe 35th International Conference on Machine Learn-
ing, ICML 2018, Stockholmsm ¨assan, Stockholm, Swe-
den, July 10-15, 2018 , volume 80 of Proceedings of
Machine Learning Research , pp. 1856–1865. PMLR,
2018. URL http://proceedings.mlr.press/
v80/haarnoja18b.html .
Hendrycks, D., Basart, S., Kadavath, S., Mazeika, M., Arora,
A., Guo, E., Burns, C., Puranik, S., He, H., Song, D., et al.
Measuring coding challenge competence with apps. arXiv
preprint arXiv:2105.09938 , 2021.
Hong, J., Lee, N., and Thorne, J. Reference-free monolithic
preference optimization with odds ratio. arXiv preprint
arXiv:2403.07691 , 2024.
Kadavath, S., Conerly, T., Askell, A., Henighan, T., Drain,
D., Perez, E., Schiefer, N., Hatfield-Dodds, Z., DasSarma,
N., Tran-Johnson, E., Johnston, S., Showk, S. E., Jones,
A., Elhage, N., Hume, T., Chen, A., Bai, Y ., Bowman,
S., Fort, S., Ganguli, D., Hernandez, D., Jacobson, J.,
Kernion, J., Kravec, S., Lovitt, L., Ndousse, K., Olsson,
C., Ringer, S., Amodei, D., Brown, T., Clark, J., Joseph,
N., Mann, B., McCandlish, S., Olah, C., and Kaplan,
J. Language models (mostly) know what they know.
CoRR , abs/2207.05221, 2022. doi: 10.48550/ARXIV .
2207.05221. URL https://doi.org/10.48550/
arXiv.2207.05221 .
Kaplan, J., McCandlish, S., Henighan, T., Brown, T. B.,
Chess, B., Child, R., Gray, S., Radford, A., Wu, J., and
Amodei, D. Scaling laws for neural language models.
CoRR , abs/2001.08361, 2020. URL https://arxiv.
org/abs/2001.08361 .
Langley, P. Crafting papers on machine learning. In Langley,
P. (ed.), Proceedings of the 17th International Conference
on Machine Learning (ICML 2000) , pp. 1207–1216, Stan-
ford, CA, 2000. Morgan Kaufmann.
Lee, H., Phatale, S., Mansoor, H., Lu, K., Mesnard, T.,
Bishop, C., Carbune, V ., and Rastogi, A. RLAIF: scaling
reinforcement learning from human feedback with AI
feedback. CoRR , abs/2309.00267, 2023. doi: 10.48550/
ARXIV .2309.00267.","[-0.0019494275329634547, 0.012031542137265205, 0.05097174644470215, -0.011624044738709927, 0.038898762315511703, 0.01768125593662262, 0.002716075861826539, 0.022723177447915077, -0.043843988329172134, 0.017653629183769226, 0.024767572060227394, -0.05729832127690315, -0.02089979685842991, 0.034450821578502655, 0.021921994164586067, -0.029256952926516533, 0.05108225345611572, -0.013613185845315456, 0.028732040897011757, 0.04414788633584976, -0.01907641813158989, -0.032793205231428146, 0.0011629224754869938, 0.0448385588824749, 0.013019206002354622, -0.006599390879273415, 0.030306778848171234, 0.04555686190724373, -0.011168199591338634, -0.017860831692814827, 0.05362393334507942, -0.019007349386811256, -0.06221592053771019, -0.021604284644126892, -0.03693724796175957, 0.02004336193203926, 0.024242660030722618, 0.011686204932630062, -0.0003932525578420609, 0.019601330161094666, 0.008771561086177826, -0.07387449592351913, 0.0034982641227543354, 0.055171042680740356, -0.04160620644688606, 0.021493777632713318, 0.033732522279024124, -0.03362201526761055, 0.021258948370814323, 0.04901023209095001, -0.07398500293493271, 0.03395353630185127, -0.02980949357151985, -0.04268365725874901, -0.017695069313049316, 0.01763981580734253, 0.04406500607728958, 0.01425551250576973, 0.014642289839684963, -0.0124735739082098, -0.02500240132212639, -0.035887423902750015, -0.006613204255700111, 0.01266696210950613, -0.04627516120672226, -0.04494906961917877, -0.08708018809556961, 0.01602363772690296, 0.025016214698553085, 0.040666889399290085, 0.01616177335381508, 0.0010325576877221465, 0.03550064563751221, -0.028400518000125885, -0.02909119240939617, -0.016382789239287376, 0.0016722945729270577, 0.10371161997318268, -0.013115900568664074, -0.022764617577195168, -0.003777987090870738, -0.0012967406073585153, 0.008419317193329334, -0.05856915935873985, -0.04110892117023468, -0.045833129435777664, -0.01700439490377903, -0.008937322534620762, -0.022916564717888832, -0.004147497937083244, -0.0270744226872921, -0.01805422082543373, -0.025016214698553085, 0.013226408511400223, 0.045750249177217484, 0.013046832755208015, 0.020278191193938255, 0.019104044884443283, 0.05193869024515152, 0.05448037013411522, -0.037324026226997375, -0.040749769657850266, 0.00426145875826478, -0.012293998152017593, 0.03530725836753845, 0.008177581243216991, -0.015111948363482952, -0.00395410880446434, 0.0021980702877044678, -0.001983961323276162, -0.1243213340640068, -2.7289719582768157e-05, -0.054038338363170624, 0.008661053143441677, -0.0059639704413712025, -0.05972949415445328, -0.06575217097997665, 0.0030355125200003386, -0.03713063895702362, -0.0021877100225538015, -0.015498725697398186, -0.00439959391951561, 0.05273986980319023, -0.00025921862106770277, 0.031577616930007935, -0.025941718369722366, 0.04837481305003166, -0.05702205002307892, -0.008916602469980717, -0.026908662170171738, -0.005525392480194569, 0.01815091446042061, 0.019145485013723373, -0.07133281975984573, -0.07083553075790405, -0.006129732355475426, 0.00564626045525074, -0.003950655460357666, -0.015996010974049568, -0.03823571652173996, 0.008219021372497082, 0.007079408969730139, -0.08221784234046936, 0.029616104438900948, -0.06205015629529953, 0.00273334258235991, -0.013620092533528805, -0.02293037809431553, -0.012618615292012691, 0.02143852226436138, 0.03837385028600693, 0.021162252873182297, -0.02207394316792488, 0.013979243114590645, -0.06039253994822502, -0.03649521619081497, -0.024215033277869225, 0.07017248868942261, 0.023842068389058113, -0.055640701204538345, 0.040418244898319244, 0.08420698344707489, -0.00011622749298112467, 0.0020426686387509108, 0.04796040803194046, 0.032157786190509796, -0.013792760670185089, 0.011886500753462315, -0.045446354895830154, -0.019684210419654846, 0.022046316415071487, -0.008149953559041023, -0.018123287707567215, -0.018164727836847305, 0.00797037873417139, -0.022101569920778275, -0.014725171029567719, 0.01175527274608612, -0.020153868943452835, -0.027060609310865402, 0.003315235488116741, 0.0014426454436033964, -0.06702300906181335, 0.0414404422044754, -0.02715730480849743, -0.0050522806122899055, -0.019822346046566963, 0.012742936611175537, 0.005449418444186449, 0.030141016468405724, 0.032931338995695114, 0.01624465361237526, 0.04804328829050064, 0.013184967450797558, -0.012694588862359524, -0.03489285334944725, 0.05696679651737213, -0.01768125593662262, -0.01704583503305912, -0.00949676800519228, 0.0025054202415049076, 0.03776605799794197, 0.013254035264253616, -0.02465706504881382, 0.022515974938869476, -0.04295992851257324, -0.013903268612921238, -0.0009617636096663773, -0.03290371224284172, -0.030334405601024628, 0.04276653751730919, 0.028649160638451576, 0.04254552349448204, 0.0004141886020079255, -0.027019169181585312, -0.021051745861768723, -0.021466150879859924, -0.0009954340057447553, -0.011340867727994919, 0.04765651002526283, 0.0138549217954278, 0.006374921649694443, -7.484100933652371e-05, -0.0026798152830451727, -0.012577175162732601, 0.008364062756299973, 0.03442319482564926, -0.023206649348139763, 0.07006197422742844, -0.003933388739824295, 0.056524764746427536, 0.009966426528990269, -0.02004336193203926, -0.02250216156244278, 0.00818448793143034, -0.01759837567806244, 0.0009505401831120253, -0.009317193180322647, -0.0006932640681043267, -0.036439962685108185, 0.04597126692533493, 0.030444912612438202, -0.003684746101498604, 0.001752585405483842, 0.023275716230273247, 0.03840147703886032, -0.040197230875492096, -0.01671431213617325, 0.007341865450143814, 0.00551848579198122, 0.030168643221259117, -0.036992501467466354, 0.027930859476327896, -0.019021164625883102, -0.03320761024951935, -0.03909215331077576, 0.0002469159662723541, -0.016741938889026642, -0.008723213337361813, -0.010007867589592934, -0.03265507146716118, 0.026673832908272743, -0.016783379018306732, 0.018261421471834183, 0.013039926066994667, 0.009061643853783607, -0.0329865925014019, 0.02892543002963066, 0.009282659739255905, -0.017543122172355652, 0.03287608548998833, -0.004896879196166992, -0.024753758683800697, 0.0410260409116745, -0.04666193947196007, -0.033732522279024124, 0.02592790499329567, 0.029892373830080032, -0.06508912146091461, -0.0015600600745528936, 0.023703934624791145, 0.04539110139012337, 0.07083553075790405, 0.0038988550659269094, 0.015595420263707638, 0.010629474185407162, -0.005591006483882666, -0.005280203185975552, -0.032793205231428146, -0.01421407237648964, -0.006582123693078756, -0.017626002430915833, 0.025154350325465202, -0.0638735368847847, 0.0545632503926754, 0.01319878175854683, 0.038346223533153534, -0.0028352169319987297, 0.011851967312395573, -0.02229495905339718, 0.04975615814328194, -0.00026461450033821166, -0.020402511581778526, 0.009400074370205402, 0.005508125759661198, 0.030002880841493607, -0.007424746174365282, 0.0057982089929282665, 0.04381636157631874, 0.0012181763304397464, 0.032793205231428146, 0.0389263890683651, 0.006067571695894003, 0.001042917836457491, -0.04467279836535454, -0.05768509954214096, 0.05091649293899536, -0.023717748001217842, 0.04787752777338028, -0.04152332618832588, -0.018454810604453087, -0.009324099868535995, -0.005563379731029272, 0.01954607665538788, 0.006119372323155403, 0.03903689980506897, 0.010629474185407162, -0.01292251143604517, -0.005238762591034174, -0.022598855197429657, 0.0052871098741889, 0.0238973218947649, 0.014296953566372395, 0.01671431213617325, -0.007901310920715332, -0.003909215331077576, -0.03536251187324524, 0.04196535795927048, 0.009579649195075035, 0.032461680471897125, -0.09332387894392014, 0.006951634306460619, -0.050695475190877914, -0.012093703262507915, -0.03696487471461296, 0.019946666434407234, -0.0016895614098757505, -0.013171154074370861, 0.0465238057076931, 0.054286982864141464, -0.006136639043688774, -0.04116417467594147, -0.00022490073752123863, 0.022819871082901955, -0.03751741349697113, 0.017322106286883354, -0.002729889238253236, -0.035473018884658813, -0.008384782820940018, -0.0011957294773310423, -0.018206167966127396, 0.01450415514409542, 0.00826736818999052, 0.00016770430374890566, -0.0017413620371371508, 0.025941718369722366, -0.04157857969403267, 0.01465610321611166, 0.02964373119175434, 0.006033037789165974, 0.022557415068149567, 0.04174434021115303, -0.06077931821346283, 0.0010083841625601053, -0.039561811834573746, -0.008709399960935116, 0.0024518929421901703, 0.010698541067540646, -0.01036011055111885, 0.011893407441675663, -0.011119852773845196, 0.023165207356214523, -0.0037883473560214043, -0.01809566095471382, 0.01370297372341156, 0.017018208280205727, -0.007224450819194317, -0.018620572984218597, -0.029422715306282043, -0.016465669497847557, 0.015581606887280941, 0.0013727147597819567, -0.052546482533216476, 0.0317157544195652, 0.017446426674723625, 0.009869731962680817, -0.0007571514579467475, 0.024339353665709496, 0.05343054607510567, 0.039396047592163086, -0.018344303593039513, -0.003826334374025464, 0.004782917909324169, 0.0035500647500157356, -0.00546668516471982, 0.029698984697461128, 0.011106039397418499, 0.06790707260370255, 0.0005995914107188582, 0.04224162548780441, 0.04005909711122513, -0.04110892117023468, 0.005262936465442181, -0.042573150247335434, 0.016078893095254898, -0.05171767249703407, 0.017059650272130966, 0.028193315491080284, 0.01983615942299366, 0.06558641046285629, 0.003026879159733653, -0.023745374754071236, -0.019173111766576767, -0.026798153296113014, -0.03221303969621658, 0.035555899143218994, 0.035555899143218994, -0.04572262242436409, 0.0397551991045475, -0.031273722648620605, -0.016065077856183052, 0.020319631323218346, 0.05133089795708656, -0.027253998443484306, -0.02190818078815937, -0.013392169959843159, 0.013930896297097206, 0.02490570768713951, 0.023109953850507736, -0.0329865925014019, 0.03154999017715454, -0.0009583102655597031, -0.05577883869409561, 0.03276557847857475, -0.017073463648557663, 0.009565835818648338, -0.018855402246117592, 0.024809012189507484, 0.003840147750452161, 0.003536251140758395, 0.01277056336402893, 0.004572262521833181, 0.04086027666926384, -0.0017033749027177691, -0.004606795962899923, -0.02994762733578682, 0.09360014647245407, -0.025485873222351074, 0.03503098711371422, 0.01628609374165535, -0.00015648084809072316, -0.0010101108346134424, -0.0183995570987463, -0.018137101083993912, 0.022612668573856354, 0.039230287075042725, 0.009545115754008293, 0.001022197655402124, 0.00043944138451479375, -0.013274755328893661, 0.009710877202451229, -0.04008672386407852, -0.01577499508857727, -0.05658001825213432, -0.010795235633850098, -0.006447442341595888, -0.0039023084100335836, -0.04691058397293091, -0.02986474707722664, -0.029671357944607735, 0.015305337496101856, -0.02098267897963524, 0.0061090122908353806, 0.0060951984487473965, 0.04157857969403267, 0.021562844514846802, 0.002227423945441842, 0.006316214334219694, -0.015415845438838005, 0.01737735979259014, -0.005186962429434061, -0.0046102493070065975, 0.0427112840116024, -0.016976768150925636, -0.015996010974049568, -0.015042881481349468, 0.0013001939514651895, -0.028483398258686066, -0.015705928206443787, -0.02892543002963066, 0.00010468028631294146, -0.03909215331077576, -0.03942367434501648, 0.024643249809741974, -0.02444986253976822, 0.005297469906508923, 0.022819871082901955, -0.012749843299388885, 0.015429658815264702, 0.05323715880513191, -0.023745374754071236, 0.011216546408832073, 0.0011620591394603252, 0.01324022188782692, 0.0009574469295330346, 0.02592790499329567, -0.0473802424967289, -0.018703453242778778, -0.015250083059072495, 0.04765651002526283, 0.0006453485693782568, -0.04423076659440994, -0.019490821287035942, 0.008847534656524658, 0.031025078147649765, 0.018855402246117592, -0.018551506102085114, -0.05917695537209511, 0.0022982179652899504, -0.006696084979921579, 0.019490821287035942, -0.0022982179652899504, 0.022129196673631668, -0.001868273364380002, -0.06663623452186584, 0.007055235560983419, 0.002163536613807082, -0.012597895227372646, -0.024007830768823624, 0.0046102493070065975, 0.0028939242474734783, 0.009966426528990269, 0.010615660808980465, 0.016382789239287376, -0.0036778394132852554, -0.03188151493668556, 0.024518929421901703, -0.019601330161094666, 0.005532299168407917, 0.03710301220417023, 0.041468072682619095, -0.0277098435908556, -0.019822346046566963, -0.02223970554769039, -0.013012299314141273, -0.010449898429214954, 0.00300270551815629, -0.011182012967765331, 0.008384782820940018, 0.043125689029693604, 0.005622087046504021, -0.02295800670981407, -0.007024155464023352, 0.021756233647465706, -0.018427183851599693, 0.00649233628064394, 0.010643287561833858, -0.0342574343085289, 0.027129678055644035, 0.009165245108306408, -0.009883546270430088, 0.013274755328893661, 0.013039926066994667, -0.03591505065560341, 0.006592483725398779, -0.03494810685515404, 0.010947183705866337, 0.0003947633958887309, 0.022598855197429657, 0.002956084907054901, -0.03450607508420944, -0.021687164902687073, -0.0007662165444344282, -0.012425226159393787, -0.04105366766452789, 0.017322106286883354, -0.010456805117428303, 0.02217063680291176, -0.03113558702170849, 0.025264857336878777, 0.05257410928606987, -0.0367991141974926, -0.0277098435908556, -0.034616585820913315, -0.03472709283232689, 0.010567313060164452, -0.0025019668973982334, -0.0363847091794014, -0.028953056782484055, 0.028138061985373497, 0.015747368335723877, -0.011451375670731068, 0.006975808180868626, -0.04160620644688606, -0.019048791378736496, 3.935628228646237e-06, -0.02427028678357601, 0.006772059015929699, 0.009697063826024532, -0.01359937246888876, -0.0013494044542312622, -0.023717748001217842, 0.00036735227331519127, -0.026618579402565956, -0.0329865925014019, -0.017501680180430412, 0.001780212391167879, -0.007006888277828693, 0.03235117346048355, -0.027461200952529907, -0.008474570699036121, -0.015208642929792404, 0.025195790454745293, 0.0077079227194190025, 0.0033653094433248043, -0.004841625224798918, -0.008343342691659927, -0.015498725697398186, -0.012646242044866085, -0.013405983336269855, -0.0003980009350925684, -0.004327073227614164, 0.024201219901442528, 0.0026849955320358276, 0.022018689662218094, -0.001477179117500782, 0.009821385145187378, -0.036771487444639206, 0.03152236342430115, -0.024684691801667213, 0.04530821740627289, 0.017695069313049316, 0.0055875531397759914, -0.0063058543018996716, 0.017819391563534737, -0.015236269682645798, 0.013164247386157513, 0.0036985597107559443, -0.022391652688384056, -0.020098615437746048, -0.026798153296113014, -0.029174072667956352, 0.005238762591034174, -0.0003457686980254948, 0.013012299314141273, -0.01196938194334507, 0.004406500607728958, -0.029533222317695618, 0.014987627044320107, -0.0007295244722627103, -0.05459087714552879, 0.01954607665538788, -0.0094138877466321, -0.005580646451562643, -0.010463711805641651, 0.01747405342757702, 0.04729735851287842, 0.06265795230865479, 0.006813499610871077, -0.002443259581923485, -0.013046832755208015, 0.005874183028936386, 0.014517968520522118, -0.006561403628438711, -0.013468144461512566, -0.04423076659440994, 0.0022308772895485163, -0.00636456161737442, 0.004427220672369003, 0.015926944091916084, -0.02174242027103901, 0.018164727836847305, -0.06309998035430908, -0.03403641656041145, -0.004782917909324169, -0.004644783213734627, 0.028400518000125885, 0.008253554813563824, 0.02211538329720497, 0.00414404459297657, -0.01114747952669859, -0.01759837567806244, -0.011043878272175789, -0.019186925143003464, 7.354599802056327e-05, 0.027626963332295418, -0.006827312987297773, 0.038843508809804916, -0.011299427598714828, -0.148080512881279, -0.016396602615714073, 0.02639756351709366, 0.007041422184556723, 0.009779945015907288, -0.014559409581124783, -0.00924121867865324, -0.008847534656524658, 0.028621533885598183, 0.03735165297985077, -0.04168908670544624, -0.028345264494419098, -0.008640332147479057, -0.02223970554769039, 0.032627444714307785, -0.0270744226872921, 0.015153389424085617, 0.02165953814983368, 0.003261708188802004, 0.023151393979787827, -0.020775476470589638, -0.05273986980319023, 0.011106039397418499, 0.010463711805641651, -0.00725207757204771, -0.00413368409499526, -0.009738503955304623, -0.02715730480849743, 0.0051178946159780025, -0.02094123698771, 0.020015735179185867, 0.01877252198755741, 0.008854441344738007, 0.010760702192783356, -0.00337394280359149, 0.007003434933722019, 0.008260461501777172, -0.04787752777338028, -0.009724690578877926, -0.02664620615541935, 0.023538172245025635, -0.005197322461754084, -0.03185388818383217, -0.015098134987056255, 0.036439962685108185, 0.014531781896948814, -0.0035880517680197954, 0.012003915384411812, 0.01349577121436596, 0.017114903777837753, -0.0073971194215118885, -0.04290467128157616, 0.012390692718327045, 0.02592790499329567, -0.010146002285182476, 0.017902271822094917, -0.013778947293758392, -0.008826814591884613, -0.0006798823014833033, -0.010090747848153114, 0.015208642929792404, -0.005950157064944506, 0.030168643221259117, -0.022308772429823875, 0.010622567497193813, 0.01920073851943016, -0.028262382373213768, 0.006216066423803568, -0.033262863755226135, -0.00503156054764986, 0.03735165297985077, 0.00818448793143034, -0.0070379688404500484, -0.0024328993167728186, 0.003798707388341427, 0.048319555819034576, -0.005318190436810255, 0.014587036333978176, 0.029616104438900948, 0.007804616820067167, 0.010159815661609173, -0.02076166309416294, -0.002712622284889221, 0.046800073236227036, -0.019698023796081543, -0.03881588205695152, -0.028179502114653587, -0.014559409581124783, -0.023786814883351326, 0.011209639720618725, -0.03196439519524574, -0.05108225345611572, 0.009310286492109299, 0.014393647201359272, -0.013571745716035366, -0.016051264479756355, 0.026660019531846046, -0.003840147750452161, -0.09779945015907288, -0.018662013113498688, 0.04091553017497063, 0.006540683563798666, 0.020195309072732925, -0.01144446898251772, 0.029533222317695618, 0.028732040897011757, 0.009738503955304623, -0.05956372991204262, 0.03251693397760391, -0.02482282556593418, 0.005121348425745964, 0.020692594349384308, 0.01537440437823534, -0.042407386004924774, 0.01364081259816885, -0.027143491432070732, 0.032295919954776764, 0.018938282504677773, -0.01554016675800085, 0.010221975855529308, 0.008232834748923779, 0.029920000582933426, -0.008391689509153366, 0.009538209065794945, 0.015609233640134335, 0.009503674693405628, -0.00832952931523323, -0.003429196774959564, -0.024988587945699692, -0.032793205231428146, 0.007873684167861938, 0.03591505065560341, -0.05144140496850014, 0.02165953814983368, -0.008854441344738007, -0.021714793518185616, -0.022129196673631668, -0.00228440435603261, -0.010221975855529308, -0.04028011113405228, 0.04707634449005127, -0.02609366551041603, 0.04740786924958229, -0.02978186495602131, 0.014890932478010654, -0.02824856899678707, 0.020623527467250824, 0.014890932478010654, 0.02584502287209034, 0.0002697945456020534, -0.019269807264208794, -0.0073004248552024364, 0.023372409865260124, -0.0009669436840340495, 0.0016817913856357336, -0.009690157137811184, 0.036909621208906174, -0.005746408365666866, 0.003114940132945776, 0.012135143391788006, 0.011278707534074783, -0.011561883613467216, -0.01899353601038456, -0.01161023136228323, 0.005328550469130278, 0.02808280661702156, -0.0334286242723465, -0.04119180142879486, -0.03160524368286133, 0.014476528391242027, 0.00246397964656353, 0.03232354670763016, -0.009144525043666363, -0.0134267034009099, 0.045446354895830154, 0.030002880841493607, -0.02638375014066696, 0.01089193020015955, 0.04657905921339989, -0.03431268781423569, 0.0005628993385471404, 0.016603805124759674, 0.0025658542290329933, 0.03268269822001457, 0.02012624219059944, -0.0007424746290780604, -0.01729447767138481, 0.028787294402718544, 0.040114350616931915, 0.004247645381838083, 0.02490570768713951, -0.021217506378889084, 0.013861828483641148, 0.00801181886345148, -0.013523397967219353, 0.022695550695061684, 0.025361550971865654, -0.00382288102991879, 0.03177100792527199, 0.04069451615214348, -0.02018149569630623, 0.016824821010231972, -0.009835198521614075, 0.013578652404248714, -0.011368495412170887, -0.0030614128336310387, 0.013668439351022243, 0.023027073591947556, 0.005843102466315031, 0.03583217039704323, -0.015084321610629559, 0.024988587945699692, 0.00689292699098587, 0.005276749841868877, 0.025389177724719048, 0.030886944383382797, 0.005939797032624483, 0.027171118184924126, 0.004606795962899923, -0.00987663958221674, -0.022004876285791397, 0.012708403170108795, -0.016866261139512062, -0.006022677756845951, 0.012383786030113697, 0.010560406371951103, -0.032378800213336945, -0.013675346039235592, 0.04182722046971321, -0.02008480206131935, 0.015567793510854244, -0.008757746778428555, -0.03489285334944725, 0.0179713387042284, 0.028566278517246246, 0.02127276174724102, -0.02584502287209034, 0.0025175069458782673, 0.012812003493309021, 0.006198799703270197, -0.0073971194215118885, -0.0008698176243342459, 0.007238264195621014, 0.021093185991048813, -0.01772269606590271, -0.018924469128251076, -0.026245614513754845, 0.011513536795973778, 0.03574929013848305, -0.013295475393533707, 0.0009393167565576732, 0.024380793794989586, 0.008205207996070385, 0.012508107349276543, 0.019449381157755852, -0.05122038722038269, -0.01696295477449894, 0.01721159741282463, 0.013074460439383984, 0.04613702744245529, -0.009151431731879711, -0.022488348186016083, 0.01895209588110447, -0.040749769657850266, -0.006785872858017683, -0.01895209588110447, 0.003999002743512392, 0.0010360111482441425, -0.019090231508016586, -0.023068513721227646, 0.024643249809741974, 0.022999446839094162, 0.01967039704322815, 0.029450342059135437, 0.007062142249196768, 0.009130710735917091, 0.01616177335381508, 0.038898762315511703, 0.01809566095471382, 0.0002033171767834574, -0.01675575226545334, 0.0014219252625480294, 0.04389924183487892, -0.026273241266608238, 0.02697772905230522, -0.008591985329985619, -0.022308772429823875, 0.05812712758779526, 0.010373924858868122, 0.003171920543536544, 0.014835678972303867, 0.04533584415912628, 0.0002997957053594291, -0.03456132858991623, 0.01610651984810829, 0.02014005556702614, -0.0217838604003191, -0.032295919954776764, -0.003974829334765673, 0.0549776554107666, 0.01700439490377903, 0.0022498706821352243, -0.027309251949191093, 0.03276557847857475, -0.0037296400405466557, -0.023165207356214523, 0.007314238231629133, 0.017197784036397934, 0.0076595754362642765, 0.007445466239005327, -0.0268534068018198, 0.027903232723474503, -0.003052779473364353, -0.013330009765923023, -0.0055530196987092495, -0.013689160346984863, -0.033898282796144485, -0.020747849717736244, -0.014082844369113445, -0.013067553751170635, -0.02549968659877777, 0.015705928206443787, 0.006810046266764402, 0.013986149802803993, 0.010871210135519505, -0.009565835818648338, 0.009020203724503517, -0.00021151892724446952, 0.0037848937790840864, 0.0013252308126538992, -0.006271320395171642, -0.008509104140102863, 0.01649329625070095, -0.01641041599214077, 0.014269325882196426, -0.019863786175847054, 0.01027723029255867, 0.003961015958338976, 0.03138422966003418, 0.02529248408973217, 0.0002879247476812452, -0.018662013113498688, 0.016741938889026642, 0.017543122172355652, 0.01670049875974655, 0.0524359755218029, -0.023717748001217842, -0.009552022442221642, 0.0014158817939460278, -0.0007575831259600818, 0.04199298471212387, 0.01201082207262516, 0.01334382314234972, -0.015236269682645798, 0.006578670348972082, 0.018068034201860428, 0.03489285334944725, 0.025900278240442276, -0.019780905917286873, 0.011016251519322395, -0.007452373392879963, -0.01729447767138481, 0.010042401030659676, -0.018164727836847305, 0.004012816119939089, 0.021963436156511307, -3.202461448381655e-05, 0.019131671637296677, -0.049839042127132416, 0.013433611020445824, 0.010954090394079685, 0.016092706471681595, -0.001800932572223246, -0.005632447078824043, 0.009980239905416965, -0.013302382081747055, 0.02161809802055359, -0.00026137696113437414, -0.041302308440208435, -0.011133666150271893, -0.0060813850723207, -0.018662013113498688, 0.02034725807607174, -0.013143527321517467, 0.0029888919088989496, -0.03146710991859436, 0.016355162486433983, -0.01442127488553524, 0.008819907903671265, 0.043622974306344986, -0.01355793233960867, 0.027903232723474503, -0.026618579402565956, 0.002375918673351407, -0.013012299314141273, -0.001711145043373108, 0.03351150453090668, -0.005017747171223164, 0.049258872866630554, 0.004959039855748415, -0.0012293998152017593, 0.011838153935968876, 0.021424708887934685, 0.010608753189444542, -0.0015937304124236107, -0.048872098326683044, 0.004061163403093815, -0.009040923789143562, -0.015084321610629559, -0.008702493272721767, 0.02648044377565384, 0.012660055421292782, 0.03218541294336319, -0.0018993536941707134, 0.0021479963324964046, -0.03273795172572136, -0.01288107130676508, -0.007521440740674734, 0.011637858115136623, 0.0014616389526054263, 0.012825817801058292, 0.013647719286382198, -0.01133396103978157, -0.01099553145468235, 0.006443988997489214, -0.009109990671277046, 0.013944709673523903, 0.014241699129343033, -0.0010256509995087981, 0.01442127488553524, -0.015830250456929207, 0.0063887350261211395, -0.015996010974049568, 0.013613185845315456, -0.030002880841493607, 0.009089270606637001, -0.03160524368286133, -0.03624657541513443, 0.055557820945978165, -0.0028801108710467815, 0.017667442560195923, -0.011182012967765331, -0.013723693788051605, 0.009966426528990269, -0.021286575123667717, 0.000319652579491958, 0.009524395689368248, -0.007804616820067167, 0.07282467186450958, 0.003531071124598384, -0.010864303447306156, 0.009759224951267242, -0.009931893087923527, 0.04014197736978531, -0.0005758494953624904, 0.010180535726249218, -0.04086027666926384, 0.004064616747200489, -0.008681773208081722, 0.031494736671447754, 0.0033722161315381527, -0.010698541067540646, 0.007811523508280516, -0.01983615942299366, -0.0044928346760571, 0.02947796881198883, 0.007901310920715332, 0.023234276100993156, 0.007922031916677952, 0.03409167006611824, 0.003360129427164793, -0.0268534068018198, 0.028649160638451576, 0.009683250449597836, -0.0030113388784229755, 0.021880554035305977, 0.0028386705089360476, 0.05729832127690315, -0.0056359004229307175, -0.04025248438119888, -0.04586075618863106, 0.0422968789935112, -0.0010584580013528466, 0.019477007910609245, -0.0215766578912735, 0.024560369551181793, -0.004779464565217495, -0.0008849261212162673, 0.03196439519524574, -0.004865798633545637, 0.004648236557841301, -0.005615180358290672, -0.006982714869081974, 0.0022326039616018534, -0.014138097874820232, 0.0021946169435977936, -0.019173111766576767, 0.0056531671434640884, -0.018841588869690895, -0.00685148686170578, -0.0012199031189084053, -0.019559890031814575, -0.026508070528507233, 0.009372446686029434, -0.012128236703574657, 0.053485799580812454, 0.013709880411624908, 0.03196439519524574, -0.019573703408241272, 0.02377300150692463, -0.019062604755163193, -0.006537230219691992, -0.01230781152844429, -0.03585979714989662, -0.034285061061382294, -0.013005392625927925, 0.010753795504570007, 0.03505861386656761, -0.04486618563532829, 0.017916085198521614, -0.01283963117748499, 0.0270744226872921, 0.01421407237648964, 0.016631431877613068, -0.001409838441759348, 0.0183995570987463, 0.015029068104922771, 0.022488348186016083, -0.019380314275622368, -0.0048554386012256145, -0.027461200952529907, 0.0150152537971735, 0.01222493126988411, 0.0024121792521327734, 0.026590950787067413, -0.012342345900833607, -0.04762888327240944, 0.0213556420058012, -0.010477525182068348, -0.0021963436156511307, 0.04873396083712578, 0.02478138543665409, -0.019048791378736496, -0.0076112281531095505, -0.007410932797938585, 0.02621798776090145, 0.013751320540904999, 0.021507591009140015, -0.001866546692326665, -0.004641329869627953, -0.008654146455228329, 0.005428698379546404, -0.020540647208690643, 0.023676307871937752, -0.030306778848171234, -0.011278707534074783, 0.0181923545897007, 0.016147959977388382, -0.00041116689681075513, 0.00981447845697403, 0.04732498526573181, 0.014476528391242027, 0.015954570844769478, 0.0027247092220932245, -0.01671431213617325, 0.01533296424895525, 0.015484912320971489, -0.034533701837062836, 0.01911785826086998, 0.00524566974490881, 0.016175586730241776, 0.005256029777228832, -0.013626999221742153, 0.017391173169016838, 0.02165953814983368, -0.028138061985373497, -0.0016602077521383762, 0.0006207433179952204, -0.016645245254039764, -0.004530821926891804, 0.006026131100952625, -0.0013114174362272024, -0.002317211590707302, 0.03649521619081497, 0.009386260993778706, -0.011133666150271893, -0.017736509442329407, -0.021410895511507988, 0.008723213337361813, 0.025651635602116585, -0.001656754408031702, 0.03729639947414398, -0.009165245108306408, -0.019477007910609245, 0.013944709673523903, -0.03041728585958481, 0.022225892171263695, -0.0058500091545283794, -0.00960036925971508, 0.014269325882196426, -0.009572742506861687, 0.02939508855342865, 0.014890932478010654, -0.022736990824341774, 0.002135909628123045, -0.013316196389496326, 0.00025706025189720094, -0.021963436156511307, 0.0004959903308190405, -0.00048606187920086086, -0.010463711805641651, 0.014960000291466713, 0.03983807936310768, -0.020374884828925133, -0.009013296104967594, -0.008619612082839012, -0.0005266389925964177, 0.012708403170108795, -0.00246397964656353, 0.02012624219059944, 0.023289529606699944, -0.009531302377581596, 0.01569211483001709, -0.01679719239473343, -0.027599336579442024, -0.025872649624943733, -0.005238762591034174, 0.020568273961544037, -0.030555421486496925, 0.004164764657616615, 0.015512539073824883, -0.00926193967461586, -0.009724690578877926, -0.0012906971387565136, 0.016949141398072243, 0.000576712831389159, 0.004358153324574232, -0.012528827413916588, -0.0005283656646497548, 0.0032807018142193556, 0.033262863755226135, 0.00020677054999396205, 0.0016912880819290876, 0.034920480102300644, -0.011202733032405376, 0.022764617577195168, 0.037406906485557556, 0.022004876285791397, -0.006433628965169191, -0.01384801510721445, -0.008757746778428555, -0.018302863463759422, -0.006772059015929699, 0.017860831692814827, 0.01962895691394806, 0.02059590071439743, 0.012887977994978428, 0.0011767359683290124, -0.025237230584025383, -0.02508528158068657, 0.016189400106668472, 0.016438042744994164, 0.017239224165678024, -0.002270590979605913, 0.005380351096391678, 0.004634423181414604, -0.040998414158821106, -0.007093222811818123, 0.00043145546806044877, -0.023883508518338203, 0.01721159741282463, 0.0017215050756931305, 0.004202751908451319, 0.03400878980755806, 0.025983158499002457, -0.0031909141689538956, 0.004889972507953644, 0.014877119101583958, 0.0058500091545283794, -0.0019166205311194062, 0.011527350172400475, 0.004965946543961763, 0.011361588723957539, -0.011630951426923275, -0.01924217864871025, -0.0020064080599695444, 0.006091745104640722, 0.0013744414318352938, -0.01971183717250824, 0.034450821578502655, 0.011271800845861435, 0.02152140438556671, -0.03497573360800743, 0.0828808844089508, 0.01641041599214077, 0.02313758060336113, -0.03666098043322563, 0.022198263555765152, 0.014752797782421112, 0.01852387934923172, -0.01414500456303358, -0.029201699420809746, 0.03983807936310768, -0.0393407940864563, -0.0021445429883897305, -0.04039061814546585, -0.023966390639543533, 0.009538209065794945, -0.0004323188040871173, -0.02537536434829235, 0.012342345900833607, 0.0020046813879162073, -0.0325721874833107, 0.036992501467466354, -0.015250083059072495, 0.03083169087767601, 0.012977765873074532, -0.03442319482564926, -0.007100129500031471, 0.03624657541513443, 0.0010852216510102153, -0.014324580319225788, -0.01737735979259014, 0.01414500456303358, 0.021328015252947807, 0.002666001906618476, 0.02884254977107048, -0.058513905853033066, 0.0010023406939581037, -0.01991903968155384, -0.01802659220993519, -0.01129252091050148, -0.011624044738709927, 0.025693075731396675, -0.025320110842585564, -0.022184450179338455, 0.019007349386811256, 0.013267848640680313, -0.008412410505115986, -0.0017715790309011936, 0.010760702192783356, -0.027668403461575508, -0.021935807541012764, 0.005497765727341175, 0.005152428522706032, -0.03392590954899788, -0.007272798102349043, 0.018620572984218597, -0.004917599260807037, -0.011603324674069881, 0.02922932617366314, 0.018965909257531166, 0.025527313351631165, 0.053817324340343475, 0.011064598336815834, 0.03050016611814499, -0.017695069313049316, 0.01414500456303358, 0.01624465361237526, 0.020057175308465958, -0.012736029922962189, 0.02143852226436138, 0.002873204182833433, 0.032793205231428146, -0.022764617577195168, 0.0051282551139593124, -0.04447941109538078, 0.015844063833355904, -0.002795503241941333, -0.028897803276777267, 0.015954570844769478, -0.0004366355133242905, -0.002664275234565139, 0.007728642784059048, -0.02947796881198883, 0.04793278127908707, 0.03409167006611824, -0.0046102493070065975, 0.02393876388669014, 0.0015928670763969421, 0.03865012153983116, 0.005732594523578882, -0.009503674693405628, 0.026107478886842728, -0.0033704894594848156, 0.00934481993317604, 0.04367822781205177, -0.014808052219450474, -0.012121330015361309, 0.014517968520522118, 0.00541488453745842, 0.00955892913043499, 0.011202733032405376, 0.016465669497847557, 0.023165207356214523, 0.02165953814983368, -0.0018492798553779721, -0.002781689865514636, 0.017059650272130966, 0.028483398258686066, 0.008557451888918877, 0.006115918979048729, 0.00404044333845377, 0.026867222040891647, 5.735832382924855e-05, -0.030168643221259117, -0.03906452655792236, -0.0031270268373191357, -0.04707634449005127, -0.011264894157648087, 0.014407460577785969, 0.004983213264495134, 0.011472096666693687, -0.00732805160805583, 0.0074800001457333565, -0.014642289839684963, 0.0023638319689780474, -0.023482918739318848, 0.0043167127296328545, 0.04119180142879486, 0.010028587654232979, 0.01589931733906269, -0.036136068403720856, -0.02601078525185585, -0.02229495905339718, -0.015954570844769478, 0.001952880877070129, -0.015885503962635994, 0.0028369438368827105, -0.03306947275996208, 0.024339353665709496, -0.03536251187324524, 0.008868254721164703, -0.005887996405363083, -0.01312971394509077, 0.015319150872528553, -0.025651635602116585]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
" URL https://doi.org/10.
48550/arXiv.2309.00267 .
Lewis, M., Yarats, D., Dauphin, Y . N., Parikh, D., and Batra,
D. Deal or no deal? end-to-end learning for negotiation
dialogues. arXiv preprint arXiv:1706.05125 , 2017.
Li, Y ., Choi, D., Chung, J., Kushman, N., Schrittwieser, J.,
Leblond, R., Eccles, T., Keeling, J., Gimeno, F., Dal Lago,
A., et al. Competition-level code generation with alpha-
code. Science , 378(6624):1092–1097, 2022.
10
Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study
Li, Z., Xu, T., and Yu, Y . Policy optimization in rlhf:
The impact of out-of-preference data. arXiv preprint
arXiv:2312.10584 , 2023.
Liang, P. P., Wu, C., Morency, L., and Salakhutdinov,
R. Towards understanding and mitigating social bi-
ases in language models. In Meila, M. and Zhang,
T. (eds.), Proceedings of the 38th International Con-
ference on Machine Learning, ICML 2021, 18-24 July
2021, Virtual Event , volume 139 of Proceedings of Ma-
chine Learning Research , pp. 6565–6576. PMLR, 2021.
URLhttp://proceedings.mlr.press/v139/
liang21a.html .
Liu, T., Zhao, Y ., Joshi, R., Khalman, M., Saleh, M., Liu,
P. J., and Liu, J. Statistical rejection sampling improves
preference optimization. CoRR , abs/2309.06657, 2023.
doi: 10.48550/ARXIV .2309.06657. URL https://
doi.org/10.48550/arXiv.2309.06657 .
MistralAI. Mistral 7B — mistral.ai. https://mistral.
ai/news/announcing-mistral-7b/ , 2023.
[Accessed 18-01-2024].
Mnih, V ., Badia, A. P., Mirza, M., Graves, A., Lilli-
crap, T. P., Harley, T., Silver, D., and Kavukcuoglu,
K. Asynchronous methods for deep reinforcement learn-
ing. In Balcan, M. and Weinberger, K. Q. (eds.), Pro-
ceedings of the 33nd International Conference on Ma-
chine Learning, ICML 2016, New York City, NY, USA,
June 19-24, 2016 , volume 48 of JMLR Workshop and
Conference Proceedings , pp. 1928–1937. JMLR.org,
2016. URL http://proceedings.mlr.press/
v48/mniha16.html .
OpenAI. Introducing chatgpt, Nov 2022. URL https:
//openai.com/blog/chatgpt .
OpenAI. GPT-4 technical report. CoRR , abs/2303.08774,
2023. doi: 10.48550/ARXIV .2303.08774. URL https:
//doi.org/10.48550/arXiv.2303.08774 .
Ouyang, L., Wu, J., Jiang, X., Almeida, D., Wainwright,
C. L., Mishkin, P., Zhang, C., Agarwal, S., Slama, K.,
Ray, A., Schulman, J., Hilton, J., Kelton, F., Miller,
L., Simens, M., Askell, A., Welinder, P., Christiano,
P. F., Leike, J., and Lowe, R. Training language
models to follow instructions with human feedback.
In Koyejo, S., Mohamed, S., Agarwal, A., Belgrave,
D., Cho, K., and Oh, A. (eds.), Advances in Neural
Information Processing Systems 35: Annual Conference
on Neural Information Processing Systems 2022,
NeurIPS 2022, New Orleans, LA, USA, November 28
- December 9, 2022 , 2022. URL http://papers.
nips.cc/paper_files/paper/2022/hash/
b1efde53be364a73914f58805a001731-","[-0.05131068453192711, 0.015532826073467731, 0.005879349075257778, 0.002154306974261999, 0.030658425763249397, 0.005675735417753458, -0.02895679511129856, 0.029698530212044716, -0.03665049001574516, 0.003394169732928276, 0.04342792183160782, -0.056575555354356766, -0.02645525336265564, -0.007002861239016056, 0.005719366949051619, -0.015154685825109482, 0.013685758225619793, -0.021219469606876373, 0.015431019477546215, 0.027982357889413834, 0.016012772917747498, -0.011460550129413605, -0.012922205962240696, 0.039006590843200684, 0.02337195910513401, -0.017583508044481277, 0.018281612545251846, 0.057360924780368805, -0.011780514381825924, -0.02466636151075363, 0.04162448272109032, -0.0317055806517601, -0.019197875633835793, -0.02322652004659176, -0.01975054107606411, 0.031967371702194214, 0.034323472529649734, 0.006915598176419735, -0.021364908665418625, 0.005733910948038101, -0.013474872335791588, -0.08138735592365265, -0.02132127620279789, 0.048605527728796005, -0.04261346533894539, 0.029669443145394325, 0.014289327897131443, 0.00277787446975708, 0.01899426057934761, 0.03577785938978195, -0.04584220051765442, 0.028258690610527992, -0.027589673176407814, -0.008951736614108086, -0.027458779513835907, -0.005519389174878597, 0.008755394257605076, 0.012660416774451733, 0.04194444790482521, -0.009962533600628376, -0.02726970985531807, -0.054917559027671814, 0.009649841114878654, 0.026077114045619965, -0.02578623592853546, -0.03481796383857727, -0.05683734640479088, 0.026615235954523087, 0.011998672038316727, 0.025989850983023643, 0.003134198486804962, -0.0007453720318153501, 0.0030687511898577213, -0.04572584852576256, -0.0014725642977282405, 0.004243166651576757, -0.022484784945845604, 0.09628025442361832, -0.007962754927575588, -0.0380466990172863, -0.006864694878458977, 0.03409077227115631, -0.01206411886960268, -0.06230583041906357, -0.05058349296450615, -0.05244510620832443, -0.023561028763651848, 0.005893893074244261, -0.05320138484239578, -0.02062317170202732, -0.05593562871217728, -0.044824130833148956, -0.0443878136575222, 0.022179363295435905, 0.07423178106546402, 0.007170115597546101, 0.01369302999228239, 0.010929699055850506, 0.035894207656383514, 0.037610381841659546, -0.04688935726881027, -0.036737751215696335, 0.00513397715985775, 0.019794173538684845, 0.04331156983971596, 0.015547370538115501, 0.009700744412839413, -0.01860157772898674, 0.0011562356958165765, -0.00967892911285162, -0.13764294981956482, 0.0018616120796650648, -0.03083295188844204, 0.02110311947762966, -0.005483029410243034, -0.06620357930660248, -0.04563858360052109, -0.001375302323140204, -0.02485543116927147, -0.023924624547362328, -0.033538106828927994, 0.004712205845862627, 0.04720931872725487, 0.015009247697889805, 0.01202048733830452, -0.028375040739774704, 0.04758746176958084, -0.0745808333158493, 0.001976144965738058, -0.028331410139799118, -0.0022070284467190504, 0.02185939811170101, 0.02025957591831684, -0.03650505095720291, -0.040780939161777496, 1.738444007060025e-05, 0.012529522180557251, -0.007570071145892143, -0.03729041665792465, -0.02678976207971573, 0.029611267149448395, -0.01328580267727375, -0.056401029229164124, 0.04432963952422142, -0.0945349931716919, 0.0028742272406816483, -0.01975054107606411, -0.013736661523580551, -0.045580409467220306, 0.015561914071440697, 0.008944464847445488, 0.002108857501298189, 0.013867556117475033, 0.018063455820083618, -0.04176992177963257, -0.049507249146699905, -0.01790347322821617, 0.0730682760477066, 0.0022179363295435905, -0.05552839860320091, 0.007108304183930159, 0.07597704231739044, 0.008726307190954685, 6.0845537518616766e-05, 0.04171174764633179, 0.023299239575862885, 0.004264982417225838, 0.02292110025882721, -0.05930979922413826, -0.048547353595495224, 0.004537679720669985, 0.002781510353088379, -0.02331378310918808, 0.005621196236461401, -0.024928150698542595, -0.036737751215696335, -0.011140584945678711, -0.014892896637320518, -0.012187741696834564, -0.02437548339366913, 0.006624721456319094, 0.018107086420059204, -0.032752737402915955, -0.001776167075149715, -0.0459003746509552, -0.01745261438190937, -0.01428205519914627, 0.026760675013065338, -0.015838246792554855, 0.05145612359046936, 0.040810029953718185, 0.005999336019158363, 0.07132301479578018, 0.02056499570608139, 0.00300512183457613, -0.027516953647136688, 0.05360861122608185, -0.022906554862856865, -4.150108725298196e-05, -0.025989850983023643, -0.0022833836264908314, 0.030280284583568573, -0.036795929074287415, -0.03217098489403725, 0.010435208678245544, -0.03496340289711952, 0.004475868307054043, -0.024419115856289864, -0.04089729115366936, -0.006417471449822187, 0.06719256192445755, 0.03731950744986534, 0.06440014392137527, 0.019066980108618736, -0.04755837097764015, -0.040693677961826324, -0.055004820227622986, -0.01105332188308239, -0.001426205737516284, 0.03964652121067047, -0.012762223370373249, 0.021364908665418625, 0.01082789245992899, 0.01657998375594616, -0.015154685825109482, 0.017918016761541367, 0.03857027739286423, -0.018441595137119293, 0.03566150739789009, -0.02545172907412052, 0.041566308587789536, -0.0031614683102816343, -0.00967892911285162, -0.03548698127269745, 0.021248556673526764, -0.04005374759435654, 0.015052879229187965, -0.019066980108618736, 0.011242392472922802, -0.03394533321261406, 0.025524446740746498, 0.00012578153109643608, 0.011598716489970684, -0.0022106643300503492, 0.020274119451642036, 0.02780783176422119, -0.029480373486876488, -0.05992063879966736, 0.014718370512127876, 0.003577785799279809, 0.019183332100510597, -0.006548366043716669, 0.01947420835494995, -0.03161831945180893, -0.024957237765192986, -0.04834374040365219, -0.014034810476005077, 0.006021151784807444, -0.046249426901340485, -0.000264061673078686, -0.026193464174866676, 0.02092859335243702, 0.004457688424736261, 0.02280474826693535, -0.007853676564991474, -0.005257599987089634, -0.044649604707956314, 0.04997264966368675, -0.009555306285619736, -0.03240368515253067, -0.004137723706662655, -0.010362489148974419, 0.0031142006628215313, 0.03156014159321785, -0.05622650310397148, -0.02545172907412052, 0.021990293636918068, 0.03932655602693558, -0.03263638913631439, 0.0308038629591465, -0.0112496642395854, 0.04191536083817482, 0.05910618603229523, 0.01753987744450569, 0.02693520113825798, 0.03342175483703613, 0.0028978611808270216, -0.0042758905328810215, -0.044562339782714844, -0.015111054293811321, 0.010660638101398945, -0.0032069177832454443, 0.027516953647136688, -0.05445215478539467, 0.05032170191407204, 0.015532826073467731, 0.052532367408275604, 0.004432236775755882, 0.02110311947762966, -0.014558388851583004, 0.0564592070877552, -0.024419115856289864, -0.018136175349354744, -0.023502852767705917, 0.010842435993254185, 0.042584378272295, 0.0027978720609098673, -0.012115023098886013, 0.0507289320230484, -0.01823798194527626, -0.004904911853373051, 0.0226447656750679, -0.014936528168618679, -0.00976619217544794, -0.03551606833934784, -0.03071659989655018, 0.04214806109666824, -0.02126310020685196, 0.02491360530257225, -0.05669190734624863, -0.022513872012495995, -0.003481432795524597, 0.005170336924493313, 0.01705992966890335, -0.03374172002077103, 0.020332295447587967, 0.04037371277809143, -0.013024013489484787, -0.019212419167160988, -0.025015413761138916, 0.01091515552252531, 0.02300836332142353, 0.016376368701457977, 0.012747679837048054, -0.0034687069710344076, 0.004068640526384115, -0.028127795085310936, 0.05209605395793915, 0.01700175367295742, 0.027196990326046944, -0.1120457798242569, 0.007882763631641865, -0.03781399503350258, 0.0011544176377356052, -0.023633748292922974, -0.009198982268571854, -0.00934442039579153, 0.004457688424736261, 0.04799468815326691, 0.02934947796165943, 0.002296109450981021, -0.03816304728388786, 0.03336358070373535, 0.034556176513433456, -0.023895537480711937, 0.022092100232839584, 0.009264429099857807, -0.02437548339366913, -0.0107188131660223, 0.010057068429887295, -0.03560333326458931, 0.010173419490456581, -0.0024833614006638527, 0.005130341276526451, 0.00887901708483696, -0.005308503285050392, -0.01360576692968607, 0.0020234123803675175, 0.004472232423722744, -0.0237064678221941, 0.007101032417267561, 0.016739964485168457, -0.029044058173894882, -0.008100921288132668, -0.05238692834973335, -0.013918459415435791, -0.023866448551416397, 0.039879221469163895, 0.009715287946164608, 0.046220339834690094, 0.012565881945192814, 0.005181244574487209, -0.010107971727848053, -0.01206411886960268, -0.020826784893870354, 0.017234455794095993, -0.0012180469930171967, -0.007046492770314217, 0.012558610178530216, -0.0010489748092368245, 0.013256714679300785, -0.026557059958577156, -0.05593562871217728, 0.035137929022312164, -0.004944907035678625, 0.028665918856859207, -0.0021833947394043207, 0.019488751888275146, 0.012631328776478767, 0.022601135075092316, -0.0193287692964077, -0.0016907219542190433, -0.01787438616156578, 0.011867777444422245, -0.01210775040090084, 0.009802551008760929, 0.022092100232839584, 0.04659847915172577, -0.006715620402246714, 0.020288662984967232, 0.05005991458892822, -0.033596280962228775, 0.011256936006247997, -0.03254912421107292, 0.011889592744410038, -0.04214806109666824, 0.002894225064665079, 0.004184991121292114, 0.024142783135175705, 0.040751852095127106, 0.010217051021754742, 0.010609734803438187, -0.030193021520972252, -0.033567193895578384, -0.04342792183160782, 0.02886953204870224, 0.025713518261909485, -0.045405883342027664, 0.058088116347789764, -0.04200262203812599, -0.04610398784279823, 0.0229501873254776, 0.04517318308353424, -0.03621417284011841, -0.02732788398861885, -0.057419098913669586, 0.012231373228132725, 0.06300393491983414, -0.017656227573752403, -0.032869089394807816, 0.015634633600711823, 0.00180979969445616, -0.0404609777033329, -0.009380780160427094, -0.02081224136054516, 0.0008835385669954121, -0.0006158409523777664, 0.017190825194120407, 0.02267385460436344, -0.03697045519948006, 0.0020197764970362186, -0.011976855807006359, 0.06096779927611351, 0.013642126694321632, -0.0077155097387731075, -0.030687512829899788, 0.10843890905380249, -0.033596280962228775, 0.04031553864479065, 0.006475646980106831, 0.0347307026386261, 0.02379373088479042, -0.01790347322821617, 0.007133755832910538, -0.004548587370663881, 0.01369302999228239, -0.016230931505560875, -0.006930142175406218, 0.004075912293046713, 0.0039377459324896336, -0.022935643792152405, -0.019590558484196663, -0.02572806179523468, -0.059629764407873154, -0.01893608644604683, 0.004835828207433224, 0.015009247697889805, -0.05765179917216301, -0.046976618468761444, -0.01711810566484928, 0.005548476707190275, -0.012871302664279938, 0.022033924236893654, 0.030425723642110825, 0.03633052483201027, 0.02937856689095497, -0.007482808083295822, -0.0005853897309862077, -0.04686026647686958, 0.011816874146461487, 0.0065120067447423935, -0.012987653724849224, 0.03310178965330124, -0.018819734454154968, -0.0034378012642264366, -0.005948432721197605, 0.0029742163605988026, -0.004384969361126423, -0.008079105988144875, -0.03086203895509243, -0.012165926396846771, -0.02760421670973301, -0.013234898447990417, 0.013627582229673862, -0.011635076254606247, 0.009177166037261486, 0.013678486458957195, -0.018019823357462883, 0.02721153385937214, 0.03976287320256233, 0.004406785126775503, -0.02309562638401985, 0.0004413147980812937, 0.005788450129330158, 0.01063155010342598, 0.02600439451634884, -0.016361825168132782, 0.007780957035720348, -0.002383372513577342, 0.05232875421643257, -0.001174415461719036, -0.020550452172756195, -0.019634190946817398, -0.017496244981884956, 0.007577342912554741, -0.020608628168702126, -0.03810487315058708, -0.07027585804462433, -0.024899061769247055, -0.005526660941541195, 0.03379989415407181, -0.01161326002329588, -0.004032280761748552, 0.006228401325643063, -0.05459759384393692, 0.004337701480835676, 0.015096510760486126, -0.015198318287730217, -0.028520479798316956, 0.010544287040829659, 0.012813127599656582, 0.008973551914095879, 0.01129329577088356, 0.002634253818541765, -0.010798804461956024, -0.01753987744450569, 0.02062317170202732, -0.023197432979941368, -0.008675402961671352, 0.04206079989671707, 0.061200499534606934, -0.01745261438190937, 0.0023670108057558537, 0.005093981511890888, -0.009598937816917896, -0.011765970848500729, 0.009046271443367004, -0.02056499570608139, 0.022004837170243263, 0.025509903207421303, 0.014078442007303238, -0.023022906854748726, 0.00227611162699759, 0.005526660941541195, -0.02020139992237091, -0.0006276578060351312, 0.030193021520972252, -0.019983243197202682, 0.014449309557676315, 0.014667467214167118, 0.004075912293046713, -0.003992285579442978, 0.01935785822570324, -0.0024270040448755026, 0.036854103207588196, -0.022513872012495995, -0.0004047279362566769, 0.01633273810148239, 0.0024688176345080137, 0.014143888838589191, -0.026949744671583176, -0.03083295188844204, -0.005443033762276173, -0.010602463036775589, -0.03941382095217705, 0.03246186301112175, 0.018019823357462883, 0.017234455794095993, -0.032723650336265564, 0.039268381893634796, 0.04494047909975052, -0.05317229777574539, -0.032869089394807816, -0.05247419327497482, -0.023051993921399117, -0.019459664821624756, 0.03929746896028519, -0.0282296035438776, -0.018397964537143707, 0.00911899097263813, 0.00566846365109086, -0.004526771605014801, -0.007188295479863882, -0.007664606440812349, 0.0016889040125533938, -0.0048467363230884075, -0.010951515287160873, 0.01778712309896946, -0.0011553267249837518, 0.0032323694322258234, -0.0016607253346592188, 0.008711762726306915, 0.009715287946164608, -0.019125156104564667, -0.029029514640569687, -0.011395102366805077, -0.02409915067255497, -0.0031869199592620134, 0.04566767439246178, -0.021393995732069016, 0.009366235695779324, -0.017016299068927765, 0.0015252857701852918, -0.010027981363236904, 0.004403149243444204, 0.014020266011357307, -0.013947547413408756, -0.006308392621576786, -0.026382533833384514, 0.0013171269092708826, -0.01484199333935976, -0.010006165131926537, 0.03731950744986534, 0.023910081014037132, 0.012573153711855412, -0.00823181588202715, -0.004308613948523998, -0.029160408303141594, 0.022775661200284958, -0.04447507858276367, 0.005344863049685955, 0.016841772943735123, -0.011947768740355968, -0.014143888838589191, 0.02998940832912922, -0.01851431466639042, -0.010100699961185455, -0.0011207850184291601, -0.02892770804464817, -0.017641684040427208, -0.020608628168702126, -0.03781399503350258, 0.022063013166189194, -0.004134087823331356, 0.016056405380368233, -0.01947420835494995, 0.006777431815862656, -0.017147192731499672, -0.0021506710909307003, 0.00041563581908121705, -0.0474129356443882, -0.011002418585121632, -0.0004247257311362773, 0.010769717395305634, -0.01621638610959053, 0.042264413088560104, 0.021903030574321747, 0.0555574856698513, 0.01488562487065792, 0.013758476823568344, -0.03423621132969856, 0.01983780413866043, 0.03243277221918106, -0.017263542860746384, 0.0031869199592620134, -0.052561454474925995, 0.013060372322797775, -0.01733626239001751, 0.009293517097830772, -0.006101143080741167, -0.015867333859205246, 0.03161831945180893, -0.048663705587387085, -0.012834942899644375, 0.011642348021268845, -0.021510345861315727, 0.04267163947224617, -0.00023565573792438954, 0.016041859984397888, -0.004599491134285927, 0.0104933837428689, -0.017598051577806473, -0.010071612894535065, -0.011133313179016113, 0.021844854578375816, 0.00813728105276823, -0.004581311251968145, 0.07644245028495789, -0.01705992966890335, -0.1313600093126297, -0.040577325969934464, 0.0024924513418227434, 0.005206696223467588, 0.018107086420059204, -0.01975054107606411, -0.018077999353408813, 0.002143399091437459, -0.0026924293488264084, 0.05221240222454071, -0.017045386135578156, -0.038453925400972366, -0.00701376935467124, -0.013736661523580551, 0.01672542095184326, -0.023124713450670242, 0.00892264861613512, 0.02044864557683468, 0.018499771133065224, 0.027676936239004135, -0.03542880713939667, -0.028258690610527992, 0.017292631790041924, 0.0016979938372969627, 0.010035253129899502, -0.005457577761262655, -0.02841867320239544, -0.010340673848986626, 0.010776989161968231, -0.03301452845335007, 0.00967892911285162, -0.0033305403776466846, 0.01319853961467743, -0.0008917194791138172, -0.02216481976211071, 0.004137723706662655, 0.01733626239001751, -0.042322587221860886, 0.0004629033210221678, -0.04270072653889656, -0.006493826862424612, 0.004304978065192699, -0.030687512829899788, -0.0001368030352750793, 0.028738636523485184, 0.006446558982133865, -0.01733626239001751, 0.011046050116419792, 0.017234455794095993, 0.001270768465474248, 0.0010780624579638243, -0.0341198593378067, 0.013700301758944988, -0.0019870528485625982, -0.00631930073723197, -0.011256936006247997, 0.007326461840420961, -0.02309562638401985, -0.028069620952010155, -0.03650505095720291, 0.0016416364815086126, 0.012514978647232056, 0.024680905044078827, -0.01790347322821617, 0.030658425763249397, 0.016536351293325424, -0.018019823357462883, 0.010587918572127819, -0.011555084958672523, -0.0019161516102030873, 0.02606257051229477, 0.0012025941396132112, -0.005879349075257778, 0.000579026818741113, 0.008886288851499557, 0.03708680346608162, 0.001994324615225196, -0.0013934820890426636, 0.02665886841714382, 0.01790347322821617, -0.01541647594422102, -0.010049796663224697, -0.01751078851521015, 0.010558831505477428, -0.027124270796775818, -0.022048469632864, -0.036010559648275375, -0.030367547646164894, -0.035196103155612946, 0.0003585966769605875, -0.03699954226613045, -0.06253853440284729, -0.00021043125889264047, 0.004777653142809868, -0.011955040507018566, 0.004075912293046713, 0.02744423598051071, -0.005959340371191502, -0.11134767532348633, -0.01751078851521015, 0.00571573106572032, -0.014805633574724197, 0.013525775633752346, -0.04898367077112198, 0.04563858360052109, 0.03932655602693558, 0.0029996680095791817, -0.04430055245757103, 0.03953016921877861, -0.0167545098811388, 0.012813127599656582, -0.009817095473408699, 0.022877467796206474, -0.07062491029500961, 0.024651816114783287, -0.023270152509212494, 0.05709913372993469, 0.01781621016561985, -0.013431240804493427, 0.014921984635293484, 0.015532826073467731, 0.025844411924481392, -0.03699954226613045, -0.01111149787902832, 0.025189939886331558, 0.03153105452656746, -0.012565881945192814, 0.012354996055364609, -0.03662140294909477, -0.014623835682868958, -0.0011698704911395907, 0.04918728396296501, -0.02020139992237091, 0.007355549372732639, -0.016289105638861656, -0.00855905283242464, -0.01890699751675129, -0.007657334208488464, 0.01282039936631918, -0.045434970408678055, 0.04191536083817482, -0.024360939860343933, 0.018441595137119293, -0.027400603517889977, 0.010704269632697105, -0.035225193947553635, 0.0037959434557706118, -0.022179363295435905, 0.028098708018660545, 0.01820889301598072, 0.0074137249030172825, -0.02331378310918808, 0.020361382514238358, 0.015212861821055412, 0.01498015969991684, 0.0029578544199466705, 0.057331837713718414, 0.003181466134265065, -0.00795548316091299, 0.010529743507504463, 0.002765148412436247, -0.018194349482655525, -0.011773242615163326, -0.008391798473894596, -0.01328580267727375, 0.03295635059475899, -0.016478175297379494, -0.037697646766901016, -0.04360244795680046, 0.03731950744986534, 0.015474651008844376, 0.03659231215715408, -0.004734021611511707, -0.010747901163995266, 0.03574877232313156, 0.034468911588191986, -0.014682011678814888, -0.006359295919537544, 0.027516953647136688, -0.031152915209531784, -0.015925509855151176, 0.0341198593378067, -0.0069592297077178955, 0.011242392472922802, 0.021641241386532784, -0.013642126694321632, -0.013714845292270184, 0.02449183538556099, 0.0335090197622776, -0.015154685825109482, 0.013503960333764553, -0.017321718856692314, 0.015809159725904465, 0.0034723428543657064, -0.022819291800260544, 0.026048026978969574, 0.019561471417546272, -0.010624278336763382, 0.043049778789281845, 0.03557424619793892, -0.03583603352308273, 0.013293074443936348, 0.024113694205880165, 0.035167016088962555, -0.011373287066817284, 0.010209779255092144, 0.014907441101968288, -0.013729389756917953, 0.009693472646176815, 0.007268286310136318, -0.030978389084339142, 0.016405457630753517, 0.013933002948760986, 0.0026833394076675177, 0.03246186301112175, 0.03857027739286423, 0.004646758548915386, 0.019343312829732895, 0.013133091852068901, 0.020521365106105804, -0.03717406839132309, -0.00443950854241848, -0.024419115856289864, 0.0010462477803230286, 0.013729389756917953, 0.010006165131926537, -0.020361382514238358, -0.02280474826693535, 0.013722117990255356, -0.014529300853610039, -0.013118548318743706, -0.00371049833483994, 0.00042222600313834846, 0.006537458393722773, 0.0014716553268954158, 0.032083719968795776, -0.03185101971030235, 0.019343312829732895, -0.0013707573525607586, -0.0237064678221941, -0.015925509855151176, -0.0010344309266656637, -0.0047849249094724655, -0.003281455021351576, -0.0015534644480794668, -0.014965616166591644, -0.03569059446454048, 0.003955925814807415, 0.041595395654439926, -0.009031727910041809, -0.006853786762803793, 0.03475978970527649, -0.0002164533216273412, 0.008748122490942478, 0.02183031104505062, -0.042293500155210495, 0.004159539472311735, 0.009329876862466335, 0.011271479539573193, 0.03470161184668541, -0.004424965009093285, 0.0017261726316064596, 0.0034123496152460575, -0.014456581324338913, -0.0024506377521902323, -0.0265716053545475, -0.018397964537143707, 0.024811798706650734, -0.040839117020368576, 0.01652180776000023, 0.028185971081256866, 0.024782711640000343, 0.022906554862856865, 0.022775661200284958, 0.03313087671995163, 0.00014907440345268697, 0.008166369050741196, 0.03266547620296478, 0.022993817925453186, -0.011707794852554798, -0.025538992136716843, 0.011366014368832111, 0.0353415422141552, -0.007090124301612377, 0.010907883755862713, 0.006152046378701925, -0.00414499593898654, 0.041595395654439926, 0.003515974385663867, 0.010784260928630829, 0.005922980606555939, 0.06730891019105911, 0.006977409590035677, -0.02729879692196846, 0.012282276526093483, 0.020768610760569572, -0.03228733688592911, -0.030512986704707146, -0.022761117666959763, 0.03694136440753937, 0.0035686958581209183, 0.0014471125323325396, -0.025931674987077713, 0.026687955483794212, -0.011213304474949837, -0.03426529839634895, 0.0026724315248429775, 0.020128680393099785, -0.006642901338636875, 0.02065225876867771, -0.046133074909448624, 0.011031506583094597, -0.018397964537143707, 0.0007258287514559925, 0.006301120854914188, 0.01829615607857704, -0.019212419167160988, -0.026382533833384514, -0.024360939860343933, -0.021917574107646942, -0.01748170144855976, 0.007802772801369429, -0.003865026868879795, -0.0010580647503957152, 0.024055520072579384, -0.006846514996141195, 0.008929920382797718, -0.0072901020757853985, -0.0008517238893546164, 0.007882763631641865, 0.010798804461956024, -0.016405457630753517, 0.027618762105703354, -0.02443365938961506, 0.0013962091179564595, -0.011765970848500729, 0.0033905338495969772, -0.0019325134344398975, 0.04252620041370392, 0.019706910476088524, 0.020157769322395325, -0.019125156104564667, 0.018979717046022415, -0.0010344309266656637, 0.015300124883651733, 0.034468911588191986, -0.03458526358008385, -0.006384748034179211, 0.010318857617676258, 0.0014052990591153502, 0.03496340289711952, 0.022033924236893654, 0.00719556724652648, 0.0003058752336073667, 0.021961206570267677, 0.03400350734591484, 0.025189939886331558, 0.032112810760736465, -0.02379373088479042, 0.013925731182098389, -0.001010797219350934, -0.020128680393099785, -0.002377918688580394, -0.022208450362086296, 0.004337701480835676, 0.0226447656750679, 0.023939168080687523, 0.012449530884623528, -0.03862845152616501, 0.016420001164078712, -0.013809381052851677, 0.022281169891357422, -0.015649177134037018, -0.03001849539577961, 0.019546927884221077, -0.02606257051229477, 0.01935785822570324, 0.0049376352690160275, -0.02796781435608864, -0.01550373900681734, -0.006548366043716669, 0.009518946520984173, 0.0021052216179668903, -0.01929968222975731, -0.007006497122347355, -0.00916262250393629, 0.021844854578375816, -0.028273234143853188, 0.017627140507102013, 0.030542073771357536, -0.00813728105276823, 0.0234010461717844, -0.026135290041565895, 0.01109695341438055, -0.0029014970641583204, 0.0071373917162418365, 0.025888044387102127, -0.018005279824137688, 0.04360244795680046, 0.024637272581458092, 0.02292110025882721, 0.011446005664765835, 0.019648734480142593, 0.018776103854179382, 0.004435872659087181, -0.03295635059475899, 0.025262657552957535, -0.008813570253551006, -0.014602020382881165, 0.010515199974179268, -0.007650062441825867, -0.010093428194522858, 0.03406168520450592, 0.007348277606070042, -0.015241949819028378, -0.03269456326961517, -0.0035250643268227577, -0.009206254035234451, 0.013583950698375702, 0.0006235673208720982, 0.010333402082324028, 0.0017007208662107587, 0.006937413942068815, -0.017350805923342705, 0.021088574081659317, 0.01185323391109705, 0.02388099394738674, -0.007344641722738743, 0.01319853961467743, -0.0017488973680883646, -0.01655089482665062, 0.00432679383084178, -0.0034887047950178385, 0.013569407165050507, -0.029407653957605362, 0.00827544741332531, -0.025524446740746498, -0.038337573409080505, 0.027618762105703354, -0.0012562245829030871, 0.015329212881624699, -0.009686200879514217, 0.002730606822296977, -0.007846403867006302, -0.00775186950340867, 0.008537236601114273, 0.02612074464559555, -0.029553093016147614, 0.0869721919298172, -0.010100699961185455, -0.010457023978233337, 0.005286687519401312, -0.014543844386935234, 0.03961743414402008, -0.021583065390586853, -0.0003488250367809087, -0.030222108587622643, 0.002494269283488393, -0.0035759678576141596, 0.010166147723793983, 0.0010480658384039998, -0.014129345305263996, 0.011824145913124084, -0.027313340455293655, -0.017932560294866562, 0.015212861821055412, 0.0054793935269117355, 0.014565660618245602, 0.015125598758459091, 0.04368970915675163, -0.0028251418843865395, -0.019634190946817398, 0.01652180776000023, 0.007664606440812349, -0.011860505677759647, 0.012115023098886013, 0.01980871707201004, 0.04249711334705353, 0.005170336924493313, -0.028695005923509598, -0.030193021520972252, 0.023415589705109596, -0.022906554862856865, 0.03234551101922989, -0.015547370538115501, 0.027007920667529106, -0.004432236775755882, -0.014492941088974476, 0.04424237459897995, 0.010609734803438187, 0.007170115597546101, 0.011213304474949837, 0.026164377108216286, -0.00967892911285162, -0.02140853926539421, 0.015256493352353573, -0.010340673848986626, 0.017438070848584175, 0.006831970997154713, -0.015329212881624699, 0.01499470416456461, -0.01132238283753395, -0.007773685269057751, 0.013176723383367062, -0.012187741696834564, 0.05451032891869545, 0.021204926073551178, 0.029087688773870468, -0.034410737454891205, 0.010471568442881107, -0.010027981363236904, 0.005657555535435677, -0.006090234965085983, -0.03970469534397125, -0.017714403569698334, -0.007897308096289635, -0.0013153089676052332, 0.06300393491983414, -0.021844854578375816, 0.0133657930418849, -0.0037995795719325542, -0.008304535411298275, -0.0026469796430319548, 0.010369760915637016, 0.009431683458387852, 0.004003193229436874, 0.0028851351235061884, 0.06533095240592957, -0.022732028737664223, 0.010282497853040695, -0.00281241605989635, 0.0066283573396503925, 0.021423082798719406, -0.028622286394238472, 0.005104889627546072, -0.02965489961206913, -0.04264255240559578, 0.006130230613052845, 0.00795548316091299, -0.00033814439666457474, 0.03327631577849388, 0.027284253388643265, -0.03406168520450592, -0.00350688467733562, -0.001840705401264131, 0.024593641981482506, 0.011976855807006359, 0.020826784893870354, -0.0241573266685009, -0.030222108587622643, -0.017888929694890976, 0.012144110165536404, -0.030629336833953857, 0.005093981511890888, -0.027342427521944046, -0.009773463942110538, 0.009097174741327763, 0.016172755509614944, -0.0020997675601392984, -0.004312249831855297, 0.04520227015018463, 0.015634633600711823, 0.013613038696348667, 0.017103562131524086, 0.0053557706996798515, 0.007860948331654072, -0.011976855807006359, -0.03505066782236099, 0.02101585641503334, 0.02002687379717827, 0.014362046495079994, 0.0037995795719325542, -0.010442480444908142, 0.0009453499224036932, 0.009751647710800171, -0.02993123233318329, 0.010820620693266392, 0.0047849249094724655, -0.00986072700470686, -0.0012434987584128976, -0.0004451780114322901, 0.0009398959809914231, 0.02280474826693535, 0.040577325969934464, 0.005777542479336262, -0.016783596947789192, -0.01823798194527626, -0.008631771430373192, 0.009969805367290974, 0.033538106828927994, 0.005952068604528904, 0.03484705090522766, 0.008355438709259033, -0.01244225911796093, -0.006537458393722773, -0.0237064678221941, 0.037523120641708374, -0.0015498284483328462, -0.009591666050255299, -0.008006386458873749, 0.007853676564991474, 0.027706025168299675, -0.012507706880569458, -0.0237064678221941, 0.0036159635055810213, -0.02769147977232933, -0.005981156136840582, -0.01621638610959053, 0.0033359944354742765, -0.00723919877782464, -0.03182193264365196, -0.003363264026120305, 0.007933666929602623, -0.016856316477060318, -0.02424458973109722, 0.0104933837428689, 0.0036977725103497505, 0.003577785799279809, -0.012042303569614887, 0.016492720693349838, 0.013104003854095936, 0.0018316154601052403, -0.0026415258180350065, -0.01239862758666277, -0.020608628168702126, -0.020070506259799004, 0.01194049697369337, 0.00768642220646143, -0.015096510760486126, -0.009308060631155968, 0.018470682203769684, -0.025815324857831, -0.0267315860837698, 0.008195456117391586, -0.0058720773085951805, 0.010951515287160873, 0.006744707934558392, -0.016347281634807587, 0.005323047284036875, -0.001945239258930087, 0.02023048885166645, 0.011671435087919235, 0.0067519801668822765, 0.045434970408678055, 0.016841772943735123, 0.006133866496384144, 0.055062998086214066, 0.017918016761541367, -0.014696555212140083, 0.009228069335222244, -0.005392130464315414, -0.008951736614108086, -0.008820842020213604, 0.017830753698945045, 0.007519167847931385, -0.008130009286105633, -0.018354332074522972, -0.004163175355643034, -0.018397964537143707, -0.015721896663308144, 0.011787786148488522, -0.00024179142201319337, 0.02025957591831684, -0.020535908639431, 0.012093206867575645, 0.005864805541932583, -0.03982104733586311, -0.004988538566976786, -0.0044176927767694, -0.030425723642110825, 0.010704269632697105, -0.0017916199285537004, 0.0025688065215945244, 0.02993123233318329, 0.019285138696432114, -0.004944907035678625, 0.0035996015649288893, 0.019226962700486183, 0.01360576692968607, -0.007028312887996435, 0.017918016761541367, -0.007897308096289635, 0.00854450836777687, -0.015532826073467731, 0.0010544287506490946, 0.00174798839725554, 0.01983780413866043, 0.0035341542679816484, -0.03092021495103836, 0.04011192545294762, -0.0012298638466745615, 0.03537062928080559, -0.038337573409080505, 0.06876330077648163, 0.0176707711070776, 0.020012330263853073, -0.029494917020201683, 0.0004163175472058356, 0.014383862726390362, 0.024055520072579384, -0.009358963929116726, -0.03161831945180893, 0.023517396301031113, -0.02654251642525196, -0.0193287692964077, 0.004799468908458948, -0.018819734454154968, -0.009388051927089691, -0.00013555317127611488, -0.019066980108618736, -0.014129345305263996, 0.02412823773920536, -0.020521365106105804, 0.03606873378157616, -0.05052531510591507, 0.015954596921801567, -0.0011844143737107515, -0.012115023098886013, 0.0063883839175105095, 0.02971307560801506, 0.004283162299543619, 0.0032141897827386856, -0.023721011355519295, 0.01724899932742119, 0.034381650388240814, 0.0007462810608558357, 0.048692792654037476, -0.030512986704707146, 0.031094741076231003, -0.015198318287730217, -0.009497130289673805, -0.008871745318174362, 0.00048176487325690687, 0.008304535411298275, -0.02424458973109722, -0.023488309234380722, 0.02497178129851818, -0.015300124883651733, -0.012471347115933895, 0.029073145240545273, 0.017772577702999115, -0.017743490636348724, -0.0005572110530920327, 0.019619647413492203, -0.0020343202631920576, -0.034410737454891205, -0.017176279798150063, 0.038366664201021194, -0.01911061257123947, -0.023110169917345047, 0.02965489961206913, 0.018761560320854187, 0.03135652840137482, 0.04895457997918129, 0.00634111650288105, 0.03979196026921272, -0.014529300853610039, 0.008944464847445488, -0.004017737228423357, 0.02014322578907013, 0.003317814553156495, 0.02334287017583847, 0.025538992136716843, 0.03007667139172554, -0.013220354914665222, 0.01874701678752899, -0.019503295421600342, 0.01902334950864315, -0.021728504449129105, -0.011744154617190361, 0.020768610760569572, -0.003781399689614773, 0.023124713450670242, -0.00292513077147305, -0.032025545835494995, 0.06323663890361786, 0.026702499017119408, 0.001078971428796649, 0.031240178272128105, 0.008122737519443035, 0.017583508044481277, 0.002532446989789605, -0.009969805367290974, -0.0005717548774555326, -0.008442701771855354, 0.024739079177379608, 0.009053543210029602, -0.011256936006247997, -0.041595395654439926, -0.006013880018144846, 0.01815071888267994, -0.001778893987648189, -0.022295713424682617, 0.021277645602822304, 0.0008712672279216349, 0.019183332100510597, 0.0055702924728393555, 0.006424743216484785, 0.024564553052186966, 0.012282276526093483, 0.021495802327990532, -0.012275004759430885, 0.009366235695779324, 0.03001849539577961, -0.0029851242434233427, -0.029218584299087524, -0.03330540284514427, 0.0015534644480794668, -0.0543648935854435, -0.023837361484766006, 0.014849265106022358, 0.014951072633266449, -0.00048721881466917694, 0.019997786730527878, 0.0010944242822006345, -0.004341337829828262, -0.006791975349187851, -0.015809159725904465, -0.002659705700352788, 0.01109695341438055, 0.010078884661197662, 0.01672542095184326, -0.03377080708742142, -0.000556302082259208, 0.0018234344897791743, -0.009548034518957138, -0.00437042536213994, -0.021001311019062996, 0.03220007196068764, -0.023517396301031113, 0.013642126694321632, -0.01345305610448122, 0.020739521831274033, 0.01927059516310692, -0.015111054293811321, 0.008886288851499557, 0.0015743712428957224]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
"Abstract-Conference.
html .Peng, B., Li, C., He, P., Galley, M., and Gao, J. Instruction
tuning with GPT-4. CoRR , abs/2304.03277, 2023. doi:
10.48550/ARXIV .2304.03277. URL https://doi.
org/10.48550/arXiv.2304.03277 .
Radford, A., Wu, J., Child, R., Luan, D., Amodei, D.,
Sutskever, I., et al. Language models are unsupervised
multitask learners. OpenAI blog , 1(8):9, 2019.
Rafailov, R., Sharma, A., Mitchell, E., Ermon, S., Man-
ning, C. D., and Finn, C. Direct preference optimiza-
tion: Your language model is secretly a reward model.
CoRR , abs/2305.18290, 2023. doi: 10.48550/ARXIV .
2305.18290. URL https://doi.org/10.48550/
arXiv.2305.18290 .
Raffin, A., Hill, A., Gleave, A., Kanervisto, A., Ernestus,
M., and Dormann, N. Stable-baselines3: Reliable rein-
forcement learning implementations. Journal of Machine
Learning Research , 22(268):1–8, 2021. URL http:
//jmlr.org/papers/v22/20-1364.html .
Ramamurthy, R., Ammanabrolu, P., Brantley, K., Hessel,
J., Sifa, R., Bauckhage, C., Hajishirzi, H., and Choi, Y .
Is reinforcement learning (not) for natural language pro-
cessing: Benchmarks, baselines, and building blocks for
natural language policy optimization. In The Eleventh
International Conference on Learning Representations,
ICLR 2023, Kigali, Rwanda, May 1-5, 2023 . OpenRe-
view.net, 2023. URL https://openreview.net/
pdf?id=8aHzds2uUyB .
Ram ´e, A., Vieillard, N., Hussenot, L., Dadashi, R., Cideron,
G., Bachem, O., and Ferret, J. Warm: On the bene-
fits of weight averaged reward models. arXiv preprint
arXiv:2401.12187 , 2024.
Russell, S. Human-compatible artificial intelligence.
In Muggleton, S. H. and Chater, N. (eds.), Human-
Like Machine Intelligence , pp. 3–23. Oxford University
Press, 2022. doi: 10.1093/OSO/9780198862536.003.
0001. URL https://doi.org/10.1093/oso/
9780198862536.003.0001 .
Russell, S. and Norvig, P. Artificial Intelligence: A
Modern Approach (4th Edition) . Pearson, 2020.
ISBN 9780134610993. URL http://aima.cs.
berkeley.edu/ .
Santacroce, M., Lu, Y ., Yu, H., Li, Y ., and Shen, Y .
Efficient RLHF: reducing the memory usage of PPO.
CoRR , abs/2309.00754, 2023. doi: 10.48550/ARXIV .
2309.00754. URL https://doi.org/10.48550/
arXiv.2309.00754 .
Schulman, J., Moritz, P., Levine, S., Jordan, M. I., and
Abbeel, P. High-dimensional continuous control using
11
Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study
generalized advantage estimation. In Bengio, Y . and Le-
Cun, Y . (eds.), 4th International Conference on Learning
Representations, ICLR 2016, San Juan, Puerto Rico, May
2-4, 2016, Conference Track Proceedings , 2016. URL
http://arxiv.org/abs/1506.02438 .
Schulman, J., Wolski, F., Dhariwal, P., Radford, A., and
Klimov, O. Proximal policy optimization algorithms.
CoRR , abs/1707.06347, 2017. URL http://arxiv.
org/abs/1707.06347 .
Sellam","[-0.029074812307953835, 0.014523223042488098, 0.044136982411146164, 0.0006439893622882664, 0.02969885617494583, 0.011402999050915241, -0.013260950334370136, 0.031684454530477524, -0.0455268993973732, 0.010218732990324497, 0.03676190972328186, -0.046718258410692215, -0.004875349346548319, 0.007367982529103756, 0.0043541304767131805, -0.04308745265007019, 0.023983173072338104, -0.033726781606674194, 0.03954174369573593, 0.04771105572581291, -0.006956680677831173, -0.024947606027126312, -0.029869049787521362, 0.034095536917448044, 0.03236522898077965, -0.005205100402235985, 0.018692975863814354, 0.035201795399188995, -0.007594908121973276, -0.026833923533558846, 0.04510141536593437, -0.036903735250234604, -0.035201795399188995, -0.03304600715637207, -0.028337303549051285, 0.026465170085430145, 0.004978175275027752, 0.013970091938972473, -0.01995524950325489, 0.028706056997179985, -0.0010973968310281634, -0.06109965220093727, 0.00808421615511179, 0.029585393145680428, -0.013466602191329002, 0.04620767757296562, 0.026720460504293442, -0.03440755605697632, 0.006247538607567549, 0.03341475874185562, -0.06263139843940735, 0.03922972083091736, -0.021713919937610626, -0.02263580448925495, -0.016452088952064514, 0.018536964431405067, 0.03857731074094772, 0.009452859871089458, 0.024791594594717026, -0.023486774414777756, -0.02534472569823265, -0.044108618050813675, 0.009984715841710567, 0.024195916950702667, -0.03880423679947853, -0.0271884948015213, -0.07142475992441177, 0.03230849653482437, -0.009112471714615822, 0.01194903813302517, -0.0034056531731039286, -0.0028401126619428396, 0.04958318918943405, -0.04098839312791824, -0.010736405849456787, 0.008374963887035847, 0.006492192856967449, 0.08997590839862823, -0.024351928383111954, -0.02367115207016468, -0.024224281311035156, 0.0035669829230755568, 0.011516462080180645, -0.059567905962467194, -0.04252013936638832, -0.03491814061999321, -0.042435042560100555, -0.009545047767460346, -0.027642345055937767, 0.009417402558028698, -0.040619637817144394, -0.03182628005743027, -0.02450793795287609, 0.024564670398831367, 0.05346928909420967, -0.016154248267412186, 0.021401897072792053, 0.0342089980840683, 0.04518651217222214, 0.041527342051267624, -0.051937542855739594, -0.046150945127010345, 0.008715352043509483, -0.01577131263911724, 0.038151826709508896, 0.016253529116511345, 0.0028915253933519125, -0.0014191699447110295, 0.004070473834872246, 0.009580505080521107, -0.12095121294260025, -0.0173456072807312, -0.050831280648708344, 0.017558349296450615, -0.0071623316034674644, -0.06353910267353058, -0.0723324567079544, 0.0020600566640496254, -0.028365669772028923, -0.02059347555041313, -0.01609751768410206, -0.012679454870522022, 0.03208157420158386, -0.004375404678285122, 0.014232474379241467, -0.027174312621355057, 0.04450573772192001, -0.07499883323907852, -0.01253762561827898, -0.03338639438152313, 0.024096636101603508, 0.008892637677490711, 0.0052157375030219555, -0.05670297518372536, -0.05928425118327141, -0.005226374603807926, 0.03523016348481178, -0.009197568520903587, -0.03355658799409866, -0.017700178548693657, 0.008630255237221718, -0.0020121897105127573, -0.0686449185013771, 0.03440755605697632, -0.08606144040822983, 0.010587486438453197, -0.02751469984650612, -0.011473913677036762, -0.009566321969032288, 0.031457528471946716, 0.02647935226559639, -0.0003605542588047683, -0.008197678253054619, 0.003017398063093424, -0.06745356321334839, -0.05409333109855652, -0.012183055281639099, 0.07636038213968277, 0.028238024562597275, -0.051171667873859406, 0.01690593920648098, 0.0767575055360794, 0.0025387273635715246, -0.003971193917095661, 0.05122840031981468, 0.024493755772709846, -0.005963881965726614, 0.006825489457696676, -0.05928425118327141, -0.011807209812104702, 0.027543066069483757, -0.008694077841937542, -0.036308057606220245, -0.00962305348366499, 0.0031007223296910524, -0.022451426833868027, -0.011395907960832119, 0.00028144061798229814, -0.01818239502608776, -0.025131983682513237, 0.012069592252373695, 0.02219613641500473, -0.04941299557685852, 0.025117801502346992, 0.0003547924861777574, -0.009431585669517517, -0.020933864638209343, 0.031656086444854736, -0.004506595898419619, 0.05485920608043671, 0.023061290383338928, 0.01975668966770172, 0.049725018441677094, 0.046150945127010345, -0.00304221804253757, -0.024054087698459625, 0.035003237426280975, -0.018735524266958237, -0.01673574559390545, -0.029897416010499, -0.00821895245462656, 0.03437919169664383, -0.025061069056391716, -0.026862289756536484, 0.002102605300024152, -0.020068710669875145, -0.00687158340588212, 0.014260840602219105, -0.04442063719034195, -0.02199757657945156, 0.03738595172762871, 0.025585833936929703, 0.060645803809165955, -0.009970532730221748, -0.04495958611369133, -0.0030209438409656286, -0.020508378744125366, 0.004045653622597456, -0.003772634081542492, 0.0627448633313179, -0.002343713538721204, 0.009956350550055504, 0.0312589667737484, 0.02347259223461151, -0.017955468967556953, 0.03330129757523537, 0.043200913816690445, -0.007509811315685511, 0.032024841755628586, -0.031060408800840378, 0.06342563778162003, 0.0008487540180794895, -0.008814631961286068, -0.033868610858917236, 0.01194903813302517, -0.008991917595267296, -0.005531305447220802, -0.02938683331012726, 0.002467813203111291, -0.05449045076966286, 0.021770652383565903, 0.006187261547893286, -0.0006324658170342445, 0.008119672536849976, 0.032762348651885986, 0.04660479724407196, -0.03602439910173416, -0.022947827354073524, 0.024990154430270195, 0.0028560683131217957, 0.020011980086565018, -0.013622612692415714, 0.019132643938064575, -0.023415859788656235, -0.035201795399188995, -0.006938952021300793, -0.012126323767006397, 0.002400444820523262, -0.015402558259665966, -0.007963662035763264, -0.04203792288899422, 0.017529983073472977, 0.02881952002644539, 0.013821172527968884, 0.0028667054139077663, 0.003974739462137222, -0.04215138405561447, 0.03304600715637207, -0.0021770652383565903, -0.03511669859290123, 0.023146387189626694, 0.0021043780725449324, -0.026394255459308624, 0.01650881953537464, -0.05877366662025452, -0.021274251863360405, 0.022479793056845665, 0.040421079844236374, -0.06013521924614906, 0.019175192341208458, 0.006743938196450472, 0.023217299953103065, 0.05721355602145195, 0.02379879727959633, 0.023557689040899277, 0.03511669859290123, -0.006719117984175682, -0.016551367938518524, -0.033925339579582214, -0.007878565229475498, 0.012069592252373695, -0.018054747954010963, 0.02805364690721035, -0.05568180978298187, 0.04291725903749466, 0.03157098963856697, 0.040591273456811905, -0.007109146099537611, 0.03917298838496208, -0.010885326191782951, 0.06904204189777374, -0.0065134670585393906, -0.015941506251692772, -0.007027594838291407, 0.024919241666793823, 0.02300455793738365, -0.016182614490389824, 0.002235569292679429, 0.0271884948015213, -0.0036556257400661707, -0.002299392130225897, 0.02369951643049717, -0.007275794167071581, -0.010417291894555092, -0.04025088623166084, -0.05505776405334473, 0.045583631843328476, -0.0212884359061718, 0.021203339099884033, -0.03588257357478142, -0.024649767205119133, -0.020167991518974304, -0.010474023409187794, 0.021160788834095, -0.0025422731414437294, 0.024351928383111954, 0.001810084329918027, 0.016664830967783928, -0.042435042560100555, -0.010424383915960789, 0.01636699214577675, 0.000550028053112328, 0.024919241666793823, 0.007431805599480867, -0.02898971363902092, -0.026833923533558846, -0.04090329632163048, 0.040761467069387436, 0.004690972622483969, 0.009176294319331646, -0.09133745729923248, -0.012161781080067158, -0.05276014655828476, -0.03582584112882614, -0.04030761867761612, -0.007197788916528225, -0.008608981035649776, 0.003499614540487528, 0.04510141536593437, 0.029982512816786766, 0.015984054654836655, -0.032563790678977966, 0.02630915865302086, 0.01828167401254177, -0.03423736244440079, 0.029415199533104897, 0.018168210983276367, -0.04070473462343216, -0.019870150834321976, 0.007460171356797218, -0.0026362345088273287, 0.021983394399285316, 0.019941065460443497, -0.00037385066389106214, 0.004410861525684595, 0.010892417281866074, -0.027429603040218353, -0.0204232819378376, 0.02822384238243103, -0.018139846622943878, 0.0016682560089975595, 0.019331203773617744, -0.03829365596175194, -0.007821833714842796, -0.05400823429226875, 0.0006200558273121715, -0.01867879368364811, 0.035740744322538376, -0.008296958170831203, 0.02463558502495289, 0.002347259083762765, 0.04047781229019165, -0.008623163215816021, -0.028337303549051285, 0.0024749047588557005, 0.007538176607340574, -0.005527759902179241, 0.0004090861475560814, -0.011133525520563126, -0.013828263618052006, 0.0001649862533668056, -0.004130750894546509, -0.05778086930513382, 0.024054087698459625, 0.0030280351638793945, 0.01295601949095726, -0.01412610337138176, 0.014473582617938519, 0.03290417790412903, 0.04657642915844917, -0.01262272335588932, -0.011551919393241405, -0.017132865265011787, 0.003194683464244008, -0.03676190972328186, 0.02935846894979477, 0.008289867080748081, 0.06166696548461914, 0.016792476177215576, 0.026124780997633934, 0.025429822504520416, -0.04739903286099434, 0.013246768154203892, -0.03287580981850624, 0.027798356488347054, -0.053979869931936264, -0.004417953081429005, 0.0009139064350165427, 0.03474794700741768, 0.05650441348552704, 0.01431048009544611, -0.015360009856522083, -0.022947827354073524, -0.037811439484357834, -0.03792490065097809, 0.020607659593224525, 0.008062941953539848, -0.06932570040225983, 0.02236633002758026, -0.025514919310808182, -0.006963771767914295, 0.023415859788656235, 0.026564449071884155, -0.03676190972328186, -0.032989274710416794, -0.031485892832279205, 0.021146606653928757, 0.0477394238114357, 0.01640954054892063, -0.03440755605697632, 0.026805557310581207, -0.0021256522741168737, -0.05219283327460289, 0.017090316861867905, -0.03486140817403793, -0.031117139384150505, -0.006960226222872734, 0.025131983682513237, 0.010672583244740963, -0.015430924482643604, -0.010325103998184204, 0.0013030479894950986, 0.04586728662252426, 0.017529983073472977, -0.00490371510386467, -0.03514506667852402, 0.0836787223815918, -0.02286273054778576, 0.042066287249326706, 0.022479793056845665, 0.012239786796271801, 0.012324883602559566, -0.010587486438453197, -0.006977954879403114, 0.028011098504066467, 0.047427400946617126, 0.007105600088834763, 0.008396238088607788, -0.004183936398476362, -0.0006696957279928029, -0.006924769375473261, -0.025855308398604393, -0.012885105796158314, -0.05440535396337509, -0.025727663189172745, -0.002524544717743993, 0.0004844324430450797, -0.054348625242710114, -0.02738705463707447, -0.028904616832733154, 0.017430704087018967, -0.03883260115981102, 0.024096636101603508, 0.023047106340527534, 0.03281908109784126, 0.051001474261283875, 0.00985707063227892, 0.010417291894555092, -0.019402118399739265, 0.01958649419248104, 0.016551367938518524, -0.019558129832148552, 0.04399515315890312, -0.017529983073472977, 0.0025759574491530657, -0.0220259428024292, 0.009743607603013515, -0.007410531397908926, -0.006041887681931257, -0.04198119044303894, 0.00979324709624052, -0.03290417790412903, -0.032790713012218475, 0.015345827676355839, -0.005244103260338306, -0.0031680907122790813, 0.013480784371495247, -0.018154028803110123, 0.024394476786255836, 0.050973109900951385, -0.011402999050915241, -0.003439337480813265, -0.01374316681176424, 0.02189829759299755, 0.014537406153976917, 0.028663508594036102, -0.019203558564186096, -0.012090866453945637, -0.005038452334702015, 0.038747504353523254, 0.001999779837206006, -0.035598915070295334, 0.00044144073035568, 0.0005766208632849157, 0.015615301206707954, 0.003974739462137222, -0.02711758017539978, -0.07601999491453171, -0.007800559047609568, -0.017558349296450615, 0.022111039608716965, -0.01551602128893137, 0.019473033025860786, 0.015927324071526527, -0.04442063719034195, 0.01737397350370884, 0.0017693086992949247, -0.030549826100468636, -0.040591273456811905, 0.011005880311131477, 0.006314907222986221, 0.017260510474443436, 0.01041020080447197, 0.019841786473989487, -0.010523663833737373, -0.03193974494934082, 0.03622296079993248, -0.022621622309088707, -0.0017010538140311837, 0.029954146593809128, 0.050462525337934494, -0.03505996614694595, -0.006403550039976835, -0.016423722729086876, -0.008006210438907146, -0.01550183817744255, 0.018097298219799995, -0.004900169558823109, 0.007637456525117159, 0.03046472929418087, -0.0019324112217873335, -0.03588257357478142, -0.008665712550282478, 0.019444666802883148, -0.036279693245887756, 0.02839403599500656, 0.00452077854424715, -0.03886096924543381, 0.019359569996595383, 0.012161781080067158, -0.018891535699367523, 0.0056695882230997086, 0.01747325249016285, -0.021869931370019913, 0.01048111543059349, -0.029783952981233597, -0.003480113111436367, 0.003620168659836054, 0.019941065460443497, 0.02938683331012726, -0.04166916757822037, -0.022621622309088707, -0.01850860007107258, -0.0031326336320489645, -0.05707172676920891, 0.01663646474480629, -0.001943048438988626, 0.029613759368658066, -0.026904838159680367, 0.03344312310218811, 0.05797942727804184, -0.0319964773952961, -0.028847886249423027, -0.03608113154768944, -0.04515814781188965, 0.007786376401782036, 0.014594136737287045, -0.019302837550640106, -0.02347259223461151, 0.017246326431632042, 0.00041728559881448746, -0.016281895339488983, 0.009516682475805283, -0.026536084711551666, -0.0231322031468153, -0.005442663095891476, -0.019104277715086937, -0.0009697513305582106, 0.00890682078897953, 0.006992137525230646, 0.0037229941226541996, 0.005931970663368702, 0.008119672536849976, -0.02694738656282425, -0.03162772208452225, -0.03656334802508354, -0.0004729088977910578, -0.013863720931112766, 0.03922972083091736, -0.026564449071884155, -0.007002774626016617, -0.03006760962307453, 0.02761397883296013, 0.007871473208069801, -0.007538176607340574, 0.0063184527680277824, -0.017317241057753563, -0.02246561087667942, -0.01476433128118515, -0.01616843231022358, -0.02775580808520317, -0.015487655997276306, 0.026706278324127197, 0.003299281932413578, 0.02143026329576969, -0.003730085678398609, -0.0010778954019770026, -0.02504688687622547, 0.02881952002644539, -0.013778624124825, 0.037414319813251495, 0.006236901506781578, 0.0032336863223463297, -0.014338846318423748, 0.017529983073472977, -0.0025635473430156708, 0.0008336847531609237, -0.0038222740404307842, -0.02581275999546051, -0.016679013147950172, -0.04200955852866173, -0.04958318918943405, 0.026465170085430145, -0.005871693603694439, 0.030521459877490997, -0.006857400760054588, 0.0025227717123925686, -0.016863390803337097, 0.004439227283000946, -0.018820621073246002, -0.06342563778162003, 0.014821062795817852, -0.012842557393014431, 0.014636686071753502, -0.009949258528649807, 0.03193974494934082, 0.04663316160440445, 0.06580835580825806, 0.019402118399739265, -0.005237011704593897, -0.038350384682416916, -0.009743607603013515, 0.03823692351579666, -0.023827163502573967, 0.005474574398249388, -0.032421961426734924, 0.01355879008769989, 0.0017515801591798663, -0.00018470926443114877, 0.023486774414777756, -0.03361332044005394, 0.029103176668286324, -0.0647304579615593, -0.024323562160134315, -0.0025334088131785393, -0.015019622631371021, 0.02845076657831669, -0.0017409429419785738, 0.016792476177215576, 0.0033489218913018703, 0.012048318050801754, 0.0012534080306068063, 0.01180011872202158, -0.013601338490843773, -0.01840931922197342, 0.01998361386358738, -0.006797123700380325, 0.05446208640933037, -0.01897663250565529, -0.14114756882190704, -0.007258065976202488, 0.018196577206254005, -0.006243993062525988, -0.007935295812785625, -0.0354287214577198, 0.00354925449937582, -0.015005439519882202, 0.02219613641500473, 0.02714594639837742, -0.025316359475255013, -0.017047768458724022, -0.009403219446539879, -0.019742505624890327, 0.03134406358003616, -0.018834805116057396, 0.0177143607288599, 0.030805116519331932, 0.02389807626605034, 0.018054747954010963, -0.0418393611907959, -0.04981011524796486, 0.02138771489262581, 0.008743717335164547, 0.01891990192234516, 0.004212302155792713, -0.0306349229067564, -0.029018079861998558, -0.013750258833169937, -0.03698883205652237, 0.0061801704578101635, 0.005056180525571108, -0.0016363445902243257, -0.006417732685804367, -0.008764991536736488, 0.016820842400193214, 0.02805364690721035, -0.04013742133975029, 0.0061978986486792564, -0.019231924787163734, 0.002022826811298728, -0.006736846640706062, -0.030776752158999443, -0.02008289471268654, 0.03653498366475105, 0.01589895784854889, -0.0063787298277020454, 0.015303279273211956, 0.01901918090879917, 0.014523223042488098, 0.004751249682158232, -0.03009597584605217, 0.013480784371495247, 0.02389807626605034, -0.001264045131392777, 0.02099059522151947, -0.013963000848889351, -0.02249397709965706, -0.0007180059910751879, -0.016111699864268303, 0.0145799545571208, -0.0007955683977343142, 0.017927102744579315, -0.0004259282723069191, 0.019061729311943054, 0.0310036763548851, -0.03029453568160534, 0.0014227156061679125, -0.028294755145907402, 0.0007884769584052265, 0.049725018441677094, 0.007332525681704283, -0.0020458740182220936, -0.009311031550168991, 0.016792476177215576, 0.05074618384242058, 0.015785494819283485, 0.006729755084961653, 0.017487434670329094, -0.009927984327077866, 0.00965851079672575, -0.025557467713952065, -0.009225933812558651, 0.05310053378343582, -0.022380514070391655, -0.028706056997179985, -0.048618756234645844, -0.028578411787748337, -0.026663729920983315, 0.0006488647195510566, -0.052845243364572525, -0.04739903286099434, 0.005974519066512585, -0.00025950156850740314, -0.0149487080052495, -0.0007002774509601295, 0.039825402200222015, -0.019501397386193275, -0.08487008512020111, -0.01838095486164093, 0.025032702833414078, 0.017501618713140488, 0.015161450952291489, -0.023387495428323746, 0.030181072652339935, 0.0216571893543005, 0.002035236917436123, -0.04720047488808632, 0.03228013217449188, -0.008623163215816021, 0.026507718488574028, 0.0028347941115498543, 0.016494637355208397, -0.05125676468014717, 0.027259409427642822, -0.03338639438152313, 0.05088801309466362, -0.0003729642485268414, -0.011410091072320938, -0.0007738509448245168, 0.011828484013676643, 0.02172810398042202, -0.03698883205652237, -0.0017205551266670227, 0.013268042355775833, 0.026663729920983315, 0.01434593740850687, 0.016749927774071693, -0.034435924142599106, -0.019402118399739265, 0.013629704713821411, 0.024125002324581146, -0.05352601781487465, 0.0017294194549322128, -0.017090316861867905, 0.004368313122540712, -0.01066549215465784, 0.013416961766779423, 0.0027231043204665184, -0.05392313748598099, 0.03886096924543381, -0.02554328553378582, 0.0371590256690979, -0.025202898308634758, 0.030436363071203232, -0.02367115207016468, 0.007715462241321802, -0.008318232372403145, 0.02839403599500656, -0.00041329668601974845, -0.01550183817744255, 0.00045429394231177866, 0.01616843231022358, 0.0021894751116633415, 0.0005606652121059597, 0.006353910081088543, 0.020409099757671356, -0.0023827161639928818, -0.0149487080052495, 0.015686215832829475, 0.006041887681931257, -0.021770652383565903, -0.03117387183010578, -0.006442552898079157, 0.004776069428771734, 0.022791815921664238, -0.014665051363408566, -0.03883260115981102, -0.04345620796084404, 0.04175426438450813, -0.0014918569941073656, 0.038917697966098785, -0.008275683969259262, -0.010381835512816906, 0.03880423679947853, 0.03900279477238655, -0.012346157804131508, -0.013658070005476475, 0.05057599022984505, -0.03914462402462959, -0.0016132974997162819, 0.0295286625623703, 0.007821833714842796, 0.01921774074435234, 0.012161781080067158, -0.0022373422980308533, -0.01469341665506363, 0.015813861042261124, 0.03267725184559822, -0.028096195310354233, 0.03159935772418976, -0.02222450263798237, 0.015913140028715134, -0.005853964947164059, -0.027996916323900223, 0.026890654116868973, 0.014707599766552448, 0.011126434430480003, 0.03852057829499245, 0.02935846894979477, -0.04053454101085663, 0.00035501408274285495, 0.007722553797066212, 0.019033364951610565, 0.0021930208895355463, -0.008289867080748081, 0.01948721520602703, 0.010856959968805313, 0.004978175275027752, 0.030181072652339935, -0.02741541899740696, 0.014225383289158344, 0.020834583789110184, 0.035769108682870865, 0.03525852784514427, 0.02805364690721035, -0.012672362849116325, 0.01998361386358738, 0.012459620833396912, 0.011176073923707008, 0.0005442663095891476, 0.016679013147950172, -0.015232364647090435, -0.025756027549505234, 0.013629704713821411, 0.03795326501131058, -0.0153174614533782, -0.022238684818148613, 0.053015436977148056, -0.014026823453605175, 0.00031290878541767597, 0.00569086242467165, -0.024195916950702667, 0.017884554341435432, 0.030039245262742043, 0.011998678557574749, -0.04592401906847954, 0.005240557715296745, 0.025968771427869797, 0.005194463301450014, -0.017317241057753563, 0.02015380933880806, 0.0041413879953324795, 0.021955028176307678, -0.005889422260224819, -0.039485011249780655, -0.007431805599480867, 0.0020529653411358595, 0.022281233221292496, -0.008956460282206535, 0.001135513186454773, 0.017487434670329094, 0.0022568434942513704, 0.025330543518066406, 0.011899398639798164, -0.024210099130868912, -0.013331864960491657, 0.0022072037681937218, 0.007864382117986679, 0.05088801309466362, -0.020238906145095825, -0.024749046191573143, 0.018239125609397888, -0.037073928862810135, -0.02290527895092964, -0.01623934507369995, -0.01730305887758732, 0.010906600393354893, -0.028578411787748337, -0.01134626753628254, 0.025685114786028862, 0.03123060241341591, 0.03049309551715851, 0.015062171034514904, -0.00012742390390485525, 0.005371748935431242, 0.005570308305323124, 0.06166696548461914, 0.03358495235443115, -0.001328754355199635, -0.022011760622262955, -0.014218292199075222, 0.03355658799409866, 0.00647800974547863, 0.008786266669631004, -0.010367652401328087, -0.0009724106057547033, 0.04629277437925339, 0.006793578155338764, -0.00865152943879366, 0.017132865265011787, 0.03974030166864395, 0.023174751549959183, -0.025571651756763458, 0.000947590684518218, 0.009339396841824055, -0.02487669326364994, -0.032790713012218475, -0.011537736281752586, 0.048760585486888885, 0.0003443769528530538, 0.008984825573861599, -0.03823692351579666, 0.051937542855739594, -0.007573633920401335, -0.035400357097387314, 0.007807650603353977, 0.01165119931101799, 0.00215047225356102, 0.011544827371835709, -0.016310259699821472, 0.013034025207161903, 0.004166207741945982, -0.01821075938642025, 0.0021061510778963566, 0.006155350245535374, -0.036847006529569626, -0.007942387834191322, -0.017132865265011787, -0.013232585042715073, -0.023486774414777756, 0.004861166700720787, -0.003584711579605937, -0.0036378970835357904, 0.007623273879289627, 0.005325654521584511, 0.002536954591050744, 0.008247318677604198, -0.0008363440283574164, 0.013438235968351364, -0.001766649424098432, -0.011218622326850891, 0.016310259699821472, -0.02477741241455078, 0.0105803944170475, -0.017856189981102943, -0.006676569581031799, 0.00803457573056221, 0.03432245925068855, 0.02111824043095112, 0.024195916950702667, -0.00905574019998312, 0.012381615117192268, -0.00020332423446234316, 0.007261611521244049, 0.042633600533008575, -0.01126826275140047, -0.022706719115376472, 0.009013191796839237, -0.0005553466035053134, 0.03698883205652237, 0.013204219751060009, 0.018692975863814354, -0.014466491527855396, -0.005694408435374498, 0.024479573592543602, 0.02330239862203598, 0.025585833936929703, -0.030776752158999443, 0.018352588638663292, -0.0004631582123693079, -0.009849978610873222, 0.0007055960595607758, -0.01680666022002697, 0.0055064857006073, 0.026606997475028038, 0.015984054654836655, 0.01636699214577675, -0.029585393145680428, 0.010091086849570274, -0.006782940588891506, 0.00924011692404747, 0.0022940735798329115, -0.006758120842278004, 0.027812538668513298, -0.006265267264097929, 0.03086184896528721, -0.0001470361021347344, -0.03662008047103882, -0.021146606653928757, -0.0007317456183955073, -0.0006236015469767153, 0.01220432948321104, -0.02812456153333187, -0.005169643554836512, -0.021770652383565903, 0.03284744545817375, -0.010658400133252144, 0.024422841146588326, 0.03803836181759834, -0.023713700473308563, 0.032960906624794006, -0.025656748563051224, -0.005385931581258774, -0.006187261547893286, -0.013629704713821411, 0.015033804811537266, -0.020480014383792877, 0.035769108682870865, 0.007800559047609568, 0.007977844215929508, 0.020650207996368408, 0.016622282564640045, 0.001886317040771246, 0.007786376401782036, -0.041697535663843155, 0.00689640361815691, -0.010367652401328087, -0.009559230878949165, -0.005424934439361095, 0.014792696572840214, -0.0051058204844594, 0.016452088952064514, -0.0051554604433476925, -0.005194463301450014, -0.03191137686371803, -0.010566212236881256, -0.003974739462137222, 0.007970753125846386, 0.01710449904203415, 0.0023773976135998964, 0.013197127729654312, -0.0067403921857476234, -0.008041667751967907, 0.01619679667055607, -0.014650868251919746, 0.01707613281905651, 0.0014298070454970002, -0.006899949163198471, 0.0073750740848481655, -0.007148148957639933, 0.0047370670363307, -0.016352808102965355, 0.016395356506109238, -0.03219503536820412, 0.005942607764154673, -0.0189482681453228, -0.030237803235650063, 0.04887405037879944, -0.009162111207842827, 0.02219613641500473, -0.010722222737967968, -0.009686876088380814, 0.005300834774971008, -0.021146606653928757, 0.015686215832829475, 0.0173456072807312, -0.014721782878041267, 0.06688624620437622, -0.014863611198961735, -0.009197568520903587, -0.0032017750199884176, -0.016948487609624863, 0.04581055790185928, 0.002118560951203108, 0.001039779046550393, -0.028805337846279144, 0.014480674639344215, 0.00039401688263751566, 0.03460611775517464, -0.018125662580132484, -0.013856629841029644, -0.0006785599980503321, -0.012722003273665905, -0.0003383935836609453, 0.009353579953312874, 0.022820182144641876, 0.019558129832148552, 0.00902028288692236, 0.03826528787612915, 0.0010805546771734953, -0.025401458144187927, 0.0312589667737484, 0.009701059199869633, -0.020394915714859962, 0.00047911389265209436, 0.029301736503839493, 0.04529997333884239, -0.0027479242999106646, -0.030918579548597336, -0.03829365596175194, 0.032762348651885986, -0.022352147847414017, 0.014324663206934929, -0.03505996614694595, 0.0291599091142416, -0.010254189372062683, -0.004878895357251167, 0.02226705104112625, 0.0007685323944315314, -0.0016265938756987453, 0.01570039801299572, 0.008460060693323612, -0.0042938534170389175, 0.0038470940198749304, 0.012757459655404091, 0.018536964431405067, -0.0018313585314899683, 0.008176404051482677, 0.0012285880511626601, 0.005151914898306131, -0.01399136707186699, -0.023245666176080704, 0.010651309043169022, -6.775627844035625e-05, 0.0625179335474968, 0.011736296117305756, 0.028167109936475754, -0.031883012503385544, 0.013643886893987656, -0.010126544162631035, -0.0031805008184164762, -0.007346708327531815, -0.03117387183010578, -0.04609421268105507, -0.012239786796271801, -0.002882661297917366, 0.03523016348481178, -0.030322901904582977, 0.010587486438453197, 0.00017750704137142748, 0.017246326431632042, 0.02477741241455078, 0.017685994505882263, -0.002175292233005166, 0.0061198933981359005, 0.001252521644346416, 0.03355658799409866, -0.0050065405666828156, -0.0033400575630366802, -0.023827163502573967, 0.021600456908345222, 0.016125883907079697, 0.006364547181874514, 0.02969885617494583, -0.005545488558709621, -0.03534362465143204, 0.026096416637301445, -0.015161450952291489, -0.003504933090880513, 0.05000867694616318, 0.02300455793738365, -0.025302177295088768, -0.013360230252146721, -0.027032483369112015, 0.016253529116511345, 0.009381945244967937, 0.02045164816081524, -0.006665932480245829, -0.021742286160588264, -0.013119122013449669, 0.014650868251919746, -0.026904838159680367, 0.0003355126827955246, -0.02745796926319599, -0.01640954054892063, 0.014317572116851807, 0.01397718396037817, 0.0033613317646086216, 0.0026362345088273287, 0.036676812916994095, 0.0271884948015213, -0.0007410531397908926, 0.011871032416820526, -0.007410531397908926, 0.02172810398042202, 0.007502719759941101, -0.03769797459244728, 0.028110379353165627, -0.007332525681704283, 0.00391800794750452, 0.009708150289952755, -0.015941506251692772, -0.00606670742854476, 0.01730305887758732, -0.011324993334710598, -0.0028950711712241173, 0.004215847700834274, -0.011027154512703419, -0.010048538446426392, 0.008105490356683731, -0.0002273685677209869, 0.01496289111673832, 0.0319964773952961, 0.014622502960264683, -0.0061518047004938126, -0.021955028176307678, 0.0027195585425943136, 0.01840931922197342, 0.011892306618392467, -0.006190807558596134, 0.046888452023267746, -0.01874970830976963, -0.030691655352711678, 0.01599823869764805, -0.026862289756536484, 0.025670930743217468, -0.005056180525571108, -0.009998898953199387, 0.01901918090879917, -0.0059390622191131115, 0.032053206115961075, 0.020309818908572197, -0.02145862951874733, -0.0012277016649022698, -0.027798356488347054, -0.005520668346434832, -0.015246547758579254, 0.0033418305683881044, -0.011069702915847301, -0.007786376401782036, 0.018834805116057396, 0.013955909758806229, -0.023912260308861732, -0.009573413990437984, 0.001994461053982377, -0.00036675925366580486, 0.003379060421139002, 0.009701059199869633, 0.017118681222200394, -0.0012800008989870548, -0.005013632122427225, -0.0012277016649022698, -0.04734230414032936, -0.02898971363902092, -0.02379879727959633, -0.017359789460897446, 0.016296077519655228, -0.03437919169664383, -0.00648510130122304, 0.0022816634736955166, -0.019331203773617744, 0.0014067599549889565, 0.015274913050234318, 0.012778733856976032, -0.0015308597357943654, 0.006442552898079157, 0.0031485892832279205, 0.003978285007178783, -0.013516241684556007, 0.03792490065097809, 0.01374316681176424, 0.009828704409301281, 0.044874489307403564, 0.0050951833836734295, 0.014133195392787457, 0.03894606605172157, 0.019799238070845604, -0.011211531236767769, -0.007914021611213684, 0.0016310260398313403, -0.005300834774971008, -0.019302837550640106, 0.017586715519428253, 0.011168982833623886, 0.014041006565093994, 0.004800889641046524, 0.004364767577499151, -0.01646627113223076, -0.0067723034881055355, 0.00825440976768732, 0.011388816870748997, 0.022054309025406837, -0.0012897514970973134, 0.007119783200323582, -0.00152554118540138, -0.04402352124452591, 0.007219063118100166, -0.00138105358928442, -0.017430704087018967, 0.01791292056441307, -0.00044299199362285435, 0.0069531346671283245, 0.032421961426734924, 0.022139405831694603, 0.012360340915620327, 0.00845296960324049, 0.02745796926319599, 0.007367982529103756, -0.015402558259665966, 0.014374303631484509, 0.0031645449344068766, 0.01550183817744255, -0.0047335210256278515, 0.020366551354527473, 0.0016398902516812086, -0.019203558564186096, 0.00413429643958807, -0.03903116285800934, 0.033329661935567856, 0.0008824382675811648, 0.023359129205346107, -0.0415840707719326, 0.07942387461662292, 0.026805557310581207, 0.01643790490925312, -0.029982512816786766, 0.021160788834095, -0.0025351818185299635, 0.019841786473989487, -0.014331754297018051, -0.04549853503704071, 0.033726781606674194, -0.04234994575381279, -0.014707599766552448, -0.013728984631597996, -0.015728764235973358, 0.016721561551094055, 2.7894755476154387e-05, -0.03829365596175194, 0.003772634081542492, 0.018139846622943878, -0.03979703411459923, 0.024947606027126312, -0.020139625295996666, 0.0189482681453228, -0.0033258746843785048, -0.03497486934065819, -0.007758010644465685, 0.023288214579224586, -0.009970532730221748, -0.010566212236881256, -0.019827602431178093, 0.00807003304362297, 0.02015380933880806, 0.0016186160501092672, 0.03341475874185562, -0.028748607262969017, 0.016565551981329918, -0.008502609096467495, -0.031145505607128143, -0.008091307245194912, -0.001953685423359275, 0.019373752176761627, -0.04050617665052414, -0.006644658278673887, 0.02544400654733181, -0.0041732992976903915, -0.022919461131095886, 0.012424163520336151, 0.01295601949095726, -0.019430484622716904, -0.033358026295900345, 0.027160128578543663, 0.003900279523804784, -0.04825000464916229, -0.01587059162557125, 0.03656334802508354, -0.015289096161723137, -0.031854648143053055, 0.022805998101830482, 0.019203558564186096, 0.018962450325489044, 0.04252013936638832, 0.0006869810749776661, 0.033698417246341705, -0.002058283891528845, 0.014679234474897385, 0.00743889668956399, 0.012232694774866104, -0.007236791308969259, 0.001517563359811902, 0.0040811109356582165, 0.03310273587703705, -0.013913361355662346, -0.0005371748702600598, -0.03307437151670456, 0.026025502011179924, -0.0017249872907996178, -0.016026603057980537, 0.011254079639911652, 0.017487434670329094, -0.010757680051028728, 0.016281895339488983, -0.02487669326364994, 0.05176734924316406, 0.023912260308861732, 0.003483658889308572, 0.02286273054778576, 0.0032780077308416367, 0.018267491832375526, 0.023756248876452446, -0.004893078003078699, 0.009233025833964348, 0.001076122629456222, 0.01921774074435234, 0.03239359334111214, -0.014849428087472916, -0.027769990265369415, 0.011310811154544353, -0.000284986337646842, 0.005120003595948219, -0.011736296117305756, 0.013948817737400532, 0.019912701100111008, 0.03219503536820412, -0.002210749313235283, 0.01022582408040762, 0.032592155039310455, 0.03341475874185562, 0.008410421200096607, 0.004148479085415602, 0.017955468967556953, 0.028266390785574913, 0.00019556799088604748, -0.012870922684669495, -0.02638007327914238, 0.00040554042789153755, -0.056362584233284, -0.006474464200437069, 0.01295601949095726, 0.003198229242116213, 0.0033861517440527678, 0.01257308293133974, -0.005002995021641254, -0.011686655692756176, -0.018792256712913513, -0.02564256638288498, 0.020465830340981483, 0.028535863384604454, 0.012615631334483624, 0.02845076657831669, -0.04064800590276718, -0.011594467796385288, -0.030237803235650063, -0.007445988245308399, 0.008892637677490711, 0.0034978417679667473, 0.023713700473308563, -0.024550486356019974, 0.017657630145549774, -0.03826528787612915, 0.007027594838291407, 0.01359424740076065, -0.022820182144641876, 0.013388596475124359, -0.02594040520489216]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
", T., Das, D., and Parikh, A. P. BLEURT: learn-
ing robust metrics for text generation. In Jurafsky,
D., Chai, J., Schluter, N., and Tetreault, J. R. (eds.),
Proceedings of the 58th Annual Meeting of the Asso-
ciation for Computational Linguistics, ACL 2020, On-
line, July 5-10, 2020 , pp. 7881–7892. Association for
Computational Linguistics, 2020. doi: 10.18653/V1/
2020.ACL-MAIN.704. URL https://doi.org/10.
18653/v1/2020.acl-main.704 .
Sheng, E., Chang, K., Natarajan, P., and Peng, N. The
woman worked as a babysitter: On biases in language gen-
eration. In Inui, K., Jiang, J., Ng, V ., and Wan, X. (eds.),
Proceedings of the 2019 Conference on Empirical Meth-
ods in Natural Language Processing and the 9th Interna-
tional Joint Conference on Natural Language Processing,
EMNLP-IJCNLP 2019, Hong Kong, China, November
3-7, 2019 , pp. 3405–3410. Association for Computational
Linguistics, 2019. doi: 10.18653/V1/D19-1339. URL
https://doi.org/10.18653/v1/D19-1339 .
Shi, F., Chen, X., Misra, K., Scales, N., Dohan, D., Chi,
E. H., Sch ¨arli, N., and Zhou, D. Large language mod-
els can be easily distracted by irrelevant context. In
Krause, A., Brunskill, E., Cho, K., Engelhardt, B., Sabato,
S., and Scarlett, J. (eds.), International Conference on
Machine Learning, ICML 2023, 23-29 July 2023, Hon-
olulu, Hawaii, USA , volume 202 of Proceedings of
Machine Learning Research , pp. 31210–31227. PMLR,
2023. URL https://proceedings.mlr.press/
v202/shi23a.html .
Singhal, P., Goyal, T., Xu, J., and Durrett, G. A long way
to go: Investigating length correlations in rlhf. arXiv
preprint arXiv:2310.03716 , 2023.
Song, F., Yu, B., Li, M., Yu, H., Huang, F., Li, Y ., and Wang,
H. Preference ranking optimization for human alignment.
CoRR , abs/2306.17492, 2023. doi: 10.48550/ARXIV .
2306.17492. URL https://doi.org/10.48550/
arXiv.2306.17492 .
Stiennon, N., Ouyang, L., Wu, J., Ziegler, D. M.,
Lowe, R., V oss, C., Radford, A., Amodei, D., and
Christiano, P. F. Learning to summarize with human
feedback. In Larochelle, H., Ranzato, M., Hadsell,R., Balcan, M., and Lin, H. (eds.), Advances in
Neural Information Processing Systems 33: Annual
Conference on Neural Information Processing Sys-
tems 2020, NeurIPS 2020, December 6-12, 2020,
virtual , 2020. URL https://proceedings.
neurips.cc/paper/2020/hash/
1f89885d556929e98d3ef9b86448f951-Abstract.
html .
Taori, R., Gulrajani, I., Zhang, T., Dubois, Y ., Li, X.,
Guestrin, C., Liang, P., and Hashimoto, T. B. Stanford
alpaca: An instruction-following llama model, 2023.
Tay, Y ., Dehghani, M., Tran, V . Q., Garcia, X., Wei, J.,
Wang, X., Chung, H. W., Bahri, D., Schuster, T., Zheng,
H. S., Zhou, D., Houlsby, N., and Metzler, D. UL2:
unifying language learning paradigms. In The Eleventh
International Conference on Learning Representations,
ICLR 2023, Kigali, Rwanda, May ","[-0.020723141729831696, 0.002452533459290862, 0.05552494898438454, 0.0057390304282307625, 0.006930407136678696, -0.009565050713717937, -0.0004420857585500926, 0.030472004786133766, -0.054353997111320496, 0.02177155390381813, 0.013261721469461918, -0.03422994539141655, -0.023010585457086563, 0.01808169111609459, -0.002425302052870393, 0.004557865671813488, 0.0438971146941185, -0.0368441678583622, 0.0148002989590168, 0.04234492406249046, -0.001790468581020832, -0.03346746414899826, -0.007549922447651625, 0.032623291015625, 0.03474734351038933, -0.0055620260536670685, 0.018953097984194756, 0.0479273721575737, 0.0020866107661277056, -0.035264741629362106, 0.011736759915947914, -0.029491672292351723, -0.01714220456779003, -0.02479424513876438, -0.040901653468608856, 0.05255671963095665, 0.01723751425743103, -0.010749619454145432, -0.009265504777431488, -0.011968227103352547, 0.0006527040968649089, -0.06236004829406738, 0.00995990727096796, 0.030717087909579277, -0.013350224122405052, 0.05130407214164734, 0.01858547329902649, -0.001810892135836184, 0.013738272711634636, 0.03839636221528053, -0.044605132192373276, 0.022084714844822884, -0.05925565958023071, -0.03068985603749752, -0.054871395230293274, -0.006059000268578529, 0.020532522350549698, 0.017959149554371834, 0.0163116455078125, -0.025869889184832573, -0.03700755536556244, -0.04809075966477394, -0.015208771452307701, 0.045939475297927856, -0.0356459841132164, -0.029627829790115356, -0.07101964950561523, -0.0028167543932795525, -0.012730708345770836, -0.005960286129266024, -0.0004437877214513719, 0.01081089023500681, 0.006246216595172882, -0.03338577225804329, -0.020137665793299675, 0.0018466335022822022, 0.002580180997028947, 0.07276246696710587, -0.03834189847111702, -0.030117996037006378, 0.0016483543440699577, 0.026332823559641838, 0.021295003592967987, -0.04743720591068268, -0.036354001611471176, -0.019742809236049652, -0.03722540661692619, 0.018558241426944733, -0.0300090704113245, -0.015658089891076088, -0.0519576296210289, -0.0183267742395401, -0.03738879784941673, 0.005313538946211338, 0.056205734610557556, 0.010674732737243176, 0.017782144248485565, 0.0032864969689399004, 0.03167019039392471, 0.016665654256939888, -0.028402414172887802, -0.013275337405502796, 0.010736003518104553, -0.017795760184526443, 0.03044477291405201, -0.009095308370888233, -0.0158078633248806, -0.05127684026956558, -0.018871402367949486, 0.013540844433009624, -0.11295609921216965, -0.014773068018257618, -0.04866262152791023, 0.012975791469216347, 0.03649015724658966, -0.044360049068927765, -0.021567316725850105, 0.001459436141885817, -0.020314671099185944, 0.015521933324635029, -0.03017245978116989, 0.005711799021810293, 0.04844477027654648, -0.002112140180543065, 0.013145987875759602, -0.022098330780863762, 0.03273221477866173, -0.05457184836268425, -0.03730710223317146, -0.04430558905005455, -0.009081692434847355, 0.01160741038620472, 0.001129254698753357, -0.0010535172186791897, -0.03202419728040695, -0.02506656013429165, 0.0158078633248806, 0.0038975030183792114, -0.043924346566200256, -0.012090768665075302, 0.026686832308769226, -0.0076928879134356976, -0.042426615953445435, 0.027122534811496735, -0.047546129673719406, -0.011382751166820526, -0.024521930143237114, 0.02027382329106331, -0.015685321763157845, 0.045013606548309326, 0.014950072392821312, -0.008857033215463161, -0.03188804164528847, 0.03156126290559769, -0.04278062656521797, -0.048036299645900726, -0.04991526901721954, 0.03681693598628044, 0.015835095196962357, -0.06791526824235916, 0.00017998293333221227, 0.042426615953445435, -0.0022040463518351316, 0.003621784271672368, 0.051767006516456604, 0.009885020554065704, 0.012179271318018436, -0.003696670988574624, -0.06557335704565048, -0.0632314532995224, 0.005875187925994396, -0.0290015060454607, -0.02464447170495987, -0.014269285835325718, -5.0660091801546514e-05, -0.03902268409729004, -0.01680181175470352, -0.014037818647921085, -0.016434187069535255, -0.03512858599424362, 0.02060060016810894, 0.028947044163942337, -0.03621784225106239, 0.007052948698401451, -0.029736755415797234, -0.020627832040190697, 0.034529492259025574, 0.012077152729034424, 0.012791979126632214, 0.06415732204914093, 0.014037818647921085, 0.04534038156270981, 0.0644296407699585, 0.011934188194572926, 0.01550831738859415, -0.040656570345163345, 0.07308924198150635, -0.0028065424412488937, -0.005082071293145418, -0.025175485759973526, 0.014405443333089352, 0.04942510277032852, -0.040574878454208374, -0.044441744685173035, -0.010586231015622616, -0.029818451032042503, 0.007155066356062889, -0.02212556265294552, -0.02851133979856968, -0.02563842013478279, 0.05356428399682045, 0.016107410192489624, 0.04648410528898239, 0.027054456993937492, -0.04171859845519066, 0.0018823747523128986, -0.06344930827617645, -0.007325263228267431, 0.010640693828463554, -0.002872919198125601, 0.0099667152389884, 0.029192127287387848, 0.02463085763156414, 0.0024184940848499537, -0.027871400117874146, 0.004397881217300892, 0.030662626028060913, -0.004214068874716759, 0.04928894340991974, -0.020709525793790817, 0.06611798703670502, 0.010027986019849777, -0.017795760184526443, -0.025856273248791695, -0.01991981454193592, -0.04574885591864586, -0.012873673811554909, -0.019552189856767654, 0.0006416413234546781, -0.016665654256939888, 0.006413009017705917, -0.010974278673529625, 0.011457636952400208, 0.04950679838657379, 0.037116482853889465, 0.042590007185935974, -0.03749772161245346, -0.049724649637937546, 0.058983344584703445, 0.03210589289665222, 0.004234492313116789, -0.03943115472793579, 0.010164142586290836, -0.007488651666790247, -0.013554459437727928, -0.027544623240828514, -0.011661873199045658, 0.020655063912272453, 0.004244704265147448, -0.0015802757116034627, -0.054190609604120255, 0.002746973652392626, -0.022261720150709152, 0.03826020285487175, 0.03861421346664429, -0.010831314139068127, -0.028783654794096947, 0.03504689037799835, 0.01185930147767067, -0.014677757397294044, 0.007978818379342556, -0.015848711133003235, 0.014119512401521206, 0.013295761309564114, -0.06181541830301285, 0.002297654515132308, 0.010375186800956726, 0.03894098848104477, -0.029900144785642624, 0.0021104381885379553, 0.004084719344973564, 0.04455067217350006, 0.059909213334321976, 0.026931915432214737, 0.0018874806119129062, 0.02328289858996868, 0.021063534542918205, -0.022411493584513664, -0.04278062656521797, -0.0004846349183935672, 0.044605132192373276, 0.006413009017705917, 0.008550679311156273, -0.04719212278723717, 0.03992132097482681, 0.006481087766587734, 0.05026927590370178, 0.01680181175470352, -0.0010747917694970965, -0.021880479529500008, 0.041065044701099396, -0.029818451032042503, 0.007624809164553881, 0.011975035071372986, 0.008618757128715515, 0.03164295852184296, -0.03820573911070824, -0.0021631992422044277, 0.05312858149409294, 0.004411496687680483, 0.012131616473197937, 0.01366338599473238, -0.012158847413957119, -0.02430407889187336, -0.03608168661594391, -0.053346432745456696, 0.04395157843828201, -0.01336384005844593, 0.017101358622312546, -0.06148863956332207, -0.0348290391266346, -0.01290090475231409, 0.009742055088281631, -0.00012562639312818646, -0.018939482048153877, 0.03134341165423393, 0.008652796968817711, 0.019947044551372528, -0.012894096784293652, -0.02883811667561531, -0.009435701183974743, 0.01915733329951763, 0.052583951503038406, 0.01680181175470352, -0.012056729756295681, -0.04321632906794548, -0.033249612897634506, 0.06029045581817627, 0.030989402905106544, 0.027136150747537613, -0.09492887556552887, -0.011689105071127415, -0.02834795042872429, -0.0037443258333951235, -0.03303176164627075, 0.014950072392821312, -0.021826015785336494, 0.029546136036515236, 0.024916786700487137, 0.02529802732169628, 0.014065049588680267, -0.03480180725455284, 0.03708925098180771, 0.008591526187956333, -0.02479424513876438, 0.01320045068860054, 0.0041834330186247826, -0.03213312476873398, 0.006511723157018423, -0.013799543492496014, 0.006566185969859362, 0.017795760184526443, 0.010286684148013592, 0.0148002989590168, 0.011614218354225159, -0.007624809164553881, -0.045367613434791565, 0.005371405743062496, -0.006814673077315092, -0.030417542904615402, -0.007815429009497166, 0.007665656507015228, -0.046538569033145905, 0.003611572552472353, -0.03621784225106239, 0.009864596650004387, -0.014704989269375801, 0.013241298496723175, -0.02842964604496956, 0.04651133716106415, -0.007209529168903828, 0.0026942125987261534, -0.0017240919405594468, -0.027517391368746758, -0.017700450494885445, 0.021826015785336494, -0.029028737917542458, -0.01214523147791624, -0.01395612396299839, -0.01160741038620472, -7.860956975491717e-05, -0.01674734801054001, -0.058384254574775696, 0.040656570345163345, 0.009265504777431488, -0.005446292459964752, -0.022506803274154663, 0.009680784307420254, 0.018857786431908607, 0.03365808725357056, -0.005858168005943298, -0.010354762896895409, 0.012267773039638996, 0.013969739899039268, -0.005899015348404646, 0.04566716030240059, 0.02430407889187336, 0.07134643197059631, 0.03831466659903526, 0.033004529774188995, 0.02429046295583248, -0.029219357296824455, 0.014337364584207535, -0.006236004643142223, 0.021295003592967987, -0.018789708614349365, 0.00023146742023527622, 0.014187591150403023, 0.03548259288072586, 0.05206655338406563, 0.015331313014030457, -0.027013609185814857, -0.021376697346568108, -0.03943115472793579, -0.04313463345170021, 0.004122162237763405, 0.021226923912763596, -0.045204225927591324, 0.021499238908290863, -0.053945526480674744, -0.042753394693136215, 0.014310132712125778, 0.04967018589377403, -0.02219364047050476, -0.01925264298915863, -0.05244779586791992, 0.03469288349151611, 0.07091072201728821, 0.005973902065306902, -0.06464748829603195, 0.0011454233899712563, 0.007509075570851564, -0.04253554344177246, 0.0055756415240466595, -0.004367245826870203, 0.0009854384697973728, -0.009850980713963509, 0.01933433674275875, -0.014228438958525658, -0.05909227207303047, 0.004945914261043072, 0.0012441374128684402, 0.05070498213171959, 0.004632752388715744, 0.0038498479407280684, -0.0070121013559401035, 0.0777185931801796, -0.030226921662688255, 0.052856266498565674, 0.01783660799264908, 0.0416913665831089, 0.04403327405452728, -0.029872912913560867, 0.011124052107334137, -0.008503023535013199, 0.02968229353427887, 0.001178611651994288, 0.0016619701636955142, 0.018939482048153877, -0.003958773799240589, -0.003252457594498992, -0.006133886519819498, -0.02178516983985901, -0.05457184836268425, -0.002830370096489787, 0.021308617666363716, 0.017700450494885445, -0.06061723455786705, -0.05331920087337494, -0.01799999549984932, 0.03387593850493431, -0.009490163996815681, 0.05582449585199356, 0.02815733104944229, -0.014350980520248413, 0.011934188194572926, 0.04348864406347275, 0.01290090475231409, 0.011151283048093319, 0.0022261720150709152, 0.010109679773449898, -0.003747729817405343, 0.047055963426828384, -0.015481085516512394, -0.012376699596643448, 0.003894099034368992, -0.006157714407891035, 0.0076043857261538506, -0.00276569533161819, -0.04264446720480919, -0.006780633702874184, -0.026387285441160202, -0.01244477741420269, 0.011661873199045658, -0.02815733104944229, -0.021472007036209106, 0.05231163650751114, -0.006984869949519634, 0.01210438460111618, 0.036871399730443954, -0.0017785548698157072, -0.0007867339299991727, 0.015113460831344128, 0.03017245978116989, 0.03221482038497925, 0.03638123348355293, -0.029546136036515236, 0.009354007430374622, -0.01657034456729889, 0.035346437245607376, -0.01320045068860054, -0.009190618060529232, -0.017714066430926323, -0.028538571670651436, 0.01235627569258213, -0.027966711670160294, -0.013983355835080147, -0.07592131197452545, -0.02420876920223236, -0.011375943198800087, 0.0368441678583622, 0.0050582438707351685, 0.012982599437236786, -0.0064708758145570755, -0.061325252056121826, -0.011593794450163841, 0.02069590985774994, -0.008366866037249565, -0.027517391368746758, -0.00582412863150239, 0.004176625516265631, 0.04180029407143593, 0.0039009067695587873, 0.01059984602034092, -0.0035094546619802713, -0.019565805792808533, 0.016093794256448746, -0.026931915432214737, 0.004231088329106569, 0.026441749185323715, 0.05152192339301109, -0.036108918488025665, -0.0011505292495712638, -0.011627834290266037, -0.02119969204068184, -0.008291980251669884, 0.009810133837163448, 0.010824506171047688, -0.013091525062918663, 0.00794477853924036, 0.02607412450015545, -0.012567318975925446, -0.0039689852856099606, 0.020450826734304428, -0.034420568495988846, -0.0163116455078125, -0.0005433527403511107, -0.009857788681983948, 0.014990919269621372, 0.014037818647921085, -0.00870725978165865, -0.03689863160252571, 0.022261720150709152, -0.01605294644832611, 0.010538575239479542, -0.02194855734705925, 0.011321480385959148, 0.011913764290511608, 0.0019232219783589244, 0.008339635096490383, -0.03330407664179802, -0.03169742226600647, 0.00555181410163641, -0.010184566490352154, -0.04517699405550957, 0.017210284247994423, 0.025366107001900673, 0.013983355835080147, -0.032405439764261246, 0.01366338599473238, 0.04901663213968277, -0.019878966733813286, -0.008006049320101738, -0.030254153534770012, -0.02776247449219227, 0.0007994986954145133, 0.018122537061572075, -0.04700150340795517, -0.030499236658215523, 0.007931163534522057, 0.0021955366246402264, -0.003395422827452421, -0.01185249350965023, 2.21388581849169e-05, 0.0010381994070485234, 0.0006607884424738586, -0.03387593850493431, 0.007447804789990187, -0.00210022646933794, -0.01215203944593668, -0.0023674352560192347, -0.001955559244379401, 0.008183053694665432, -0.05892888084053993, 0.0016798407305032015, -0.0017938725650310516, -0.008339635096490383, -0.0070121013559401035, 0.015658089891076088, -0.030036302283406258, -0.0039689852856099606, -0.03431164100766182, -0.010695156641304493, -0.008366866037249565, -0.0010739407734945416, 0.016842659562826157, 0.01059984602034092, -0.0094629330560565, -0.01665203832089901, -0.004091526847332716, -0.021989405155181885, -0.01588955707848072, 0.017591524869203568, -0.00891830399632454, 0.010102871805429459, 0.0052726916037499905, 0.004043872002512217, 0.01244477741420269, 0.0163116455078125, -0.023391826078295708, 0.0058275326155126095, 0.017972763627767563, -0.0031503397040069103, -0.02009681798517704, 0.036354001611471176, -0.02791224792599678, -0.010729195550084114, -0.0046293484047055244, -0.018367620185017586, -0.012295004911720753, -0.02832072041928768, -0.04901663213968277, 0.025597574189305305, -0.006790845654904842, 0.020478058606386185, -0.02540695294737816, -0.0008684283238835633, -0.0011862704996019602, -0.0015717658679932356, -0.02170347422361374, -0.06579121202230453, 0.021376697346568108, -0.0038532516919076443, -0.0001847697130870074, 0.0011088310275226831, 0.05146746337413788, 0.03943115472793579, 0.03899545222520828, 0.030553700402379036, 0.020709525793790817, 0.006593417376279831, 0.007168682292103767, 0.019620267674326897, -0.004605520982295275, -0.008625565096735954, -0.03044477291405201, 0.024944018572568893, -0.029137663543224335, 0.012274581007659435, 0.01697881706058979, -0.053945526480674744, 0.04406050592660904, -0.05734945833683014, -0.013023446314036846, -0.007318455260246992, -0.008380481973290443, 0.031125560402870178, -0.0048437961377203465, 0.004707639105618, -0.015236002393066883, -0.0011420194059610367, -0.018272310495376587, -0.000515695777721703, -0.014133128337562084, 0.014596063643693924, 0.021131614223122597, -0.016502264887094498, 0.052420563995838165, -0.02186686359345913, -0.0894281193614006, -0.018558241426944733, -0.005773069802671671, -0.016447803005576134, -0.012431162409484386, -0.012580934911966324, -0.0008705557556822896, -0.04340694844722748, 0.023228436708450317, 0.03757941722869873, -0.009013613685965538, -0.030036302283406258, 0.018217846751213074, -0.01814976893365383, 0.019960660487413406, -0.034856270998716354, -0.009238272905349731, 0.02077760547399521, 0.004047275986522436, 0.006675112061202526, -0.03962177783250809, -0.05244779586791992, 0.014092281460762024, 0.0031792731024324894, 0.00048165646148845553, 0.012186079286038876, -0.017782144248485565, -0.02883811667561531, -0.022574881091713905, -0.011518907733261585, -0.015590012073516846, 0.003063539508730173, 0.01421482302248478, 0.02404537983238697, -0.009973522275686264, -0.00015509167860727757, 0.006338122766464949, -0.038641445338726044, 4.693703886005096e-05, -0.020205743610858917, 0.011736759915947914, -0.009149771183729172, -0.008516639471054077, -0.014105897396802902, 0.05892888084053993, -0.003805596614256501, -0.0021274578757584095, 0.039294999092817307, 0.009571858681738377, 0.0079515865072608, -0.003283092984929681, -0.030907709151506424, 0.012335851788520813, -0.007522691041231155, -0.026591522619128227, -0.004840392153710127, -0.016161872074007988, 0.007679271977394819, -0.003199696773663163, -0.028402414172887802, 0.026714064180850983, 0.03036307916045189, 0.008142206817865372, 0.0013326396001502872, 0.03311345726251602, 0.0167201180011034, -0.017087742686271667, 0.0058139171451330185, 0.0037409220822155476, -0.03327684476971626, 0.027108918875455856, -0.01949772611260414, -0.02363690920174122, 0.016679270192980766, 0.006712555419653654, 0.021553700789809227, -0.0044149006716907024, 0.0035060506779700518, 0.03757941722869873, -0.0006535550928674638, 0.014677757397294044, 0.005289711523801088, 0.0076043857261538506, 0.018285926431417465, -0.022220872342586517, -0.01471860520541668, -0.03488350287079811, -0.04798183590173721, -0.007059756200760603, 0.007556730415672064, -0.03368531912565231, -0.0519576296210289, -0.0013445534277707338, 0.02438577450811863, 0.005681163631379604, 0.0018330177990719676, 0.030063534155488014, -0.01269666850566864, -0.07946140319108963, -0.04193644970655441, 0.03580937162041664, 0.011627834290266037, 0.012751131318509579, -0.04013917222619057, 0.023105895146727562, 0.028947044163942337, -0.027803322300314903, -0.01840846799314022, 0.03169742226600647, 0.00033847856684587896, -0.003055029548704624, -0.015399391762912273, 0.020328285172581673, -0.07156427949666977, 0.0019844926428049803, -0.043270792812108994, 0.05876549333333969, -0.004105142783373594, -0.0179183017462492, 0.010987894609570503, 0.017196668311953545, 0.03733433410525322, -0.011164898984134197, -0.0053475783206522465, 0.02286081202328205, 0.019470494240522385, 0.0016883505741134286, 0.026278359815478325, -0.04406050592660904, -0.04027533158659935, 0.008775338530540466, 0.037116482853889465, -0.03845082223415375, 0.0077813901007175446, -0.027435697615146637, -0.015617243014276028, -0.025583958253264427, -0.014228438958525658, -0.004340013954788446, -0.05062328651547432, 0.03638123348355293, -0.006971254013478756, 0.04395157843828201, -0.004302571061998606, 0.018953097984194756, -0.024739783257246017, 0.020450826734304428, 0.009190618060529232, 0.02111799828708172, -0.0019232219783589244, -0.0007237611571326852, 0.009517395868897438, -0.0012586041120812297, -0.005425868555903435, 0.012574126943945885, -0.010824506171047688, 0.058983344584703445, 0.05615127459168434, 0.00763161713257432, 0.001246690284460783, 0.0003691139572765678, -0.014881993643939495, -0.02791224792599678, -0.008060512132942677, -0.020396364852786064, 0.04043871909379959, -0.032323744148015976, -0.03809681534767151, -0.04337971657514572, 0.048036299645900726, 0.009667168371379375, 0.018136152997612953, 0.01699243113398552, 0.007447804789990187, 0.03910437971353531, 0.04651133716106415, -0.03480180725455284, 0.01680181175470352, 0.027095304802060127, -0.04615732654929161, -0.006225792691111565, 0.007713311351835728, -0.025529494509100914, 0.026782141998410225, 0.026959147304296494, -0.019062023609876633, -0.027939479798078537, 0.02498486638069153, 0.06742510199546814, -0.020396364852786064, 0.022724654525518417, -0.020491674542427063, 0.012941751629114151, -0.009510587900876999, 0.01080408226698637, 0.028456877917051315, 0.029382746666669846, -0.002986951032653451, 0.025965198874473572, 0.03523750975728035, -0.06677154451608658, 0.002493380568921566, -0.0014917735243216157, 0.0035503017716109753, 0.022071098908782005, 0.016774579882621765, 0.0084553686901927, -0.0084077138453722, 0.002644855761900544, 0.0344478003680706, -0.04406050592660904, 0.004404688719660044, 0.004493190906941891, 0.024086227640509605, 0.02815733104944229, 0.006562781985849142, 0.00034975408925674856, 0.03379424288868904, 0.00767246400937438, 0.030826013535261154, -0.012308620847761631, 0.001547938329167664, -0.03164295852184296, 0.005177381448447704, 0.008094551973044872, 0.005286307539790869, -0.02807563729584217, 0.0076180011965334415, 0.04877154901623726, -0.008822993375360966, 0.002551247598603368, -0.011729951947927475, -0.004043872002512217, 0.0172239001840353, 0.0168154276907444, 0.01546747051179409, -0.036354001611471176, 0.022724654525518417, 0.012968983501195908, -0.018721628934144974, 0.02313312701880932, -0.005320346914231777, 0.006569589953869581, -0.02329651452600956, -0.024698935449123383, -0.02622389793395996, -0.021880479529500008, -0.018476545810699463, 0.025257179513573647, -0.01151210069656372, -0.025257179513573647, 0.02826625667512417, 0.005160361994057894, -0.001353063271380961, 0.017782144248485565, -0.03278667852282524, -0.015521933324635029, 0.02193494141101837, 0.014228438958525658, 0.02943721041083336, 0.009081692434847355, -0.02000150829553604, 0.04498637467622757, -0.01764598675072193, -0.011164898984134197, -0.014977303333580494, -0.03681693598628044, 0.011239785701036453, -0.02815733104944229, -0.01085173711180687, 0.03254159539937973, 0.0306081622838974, 0.0004135778290219605, 0.017727680504322052, 0.01295536756515503, -0.004605520982295275, 0.005286307539790869, 0.03624507412314415, 0.03365808725357056, -0.010436457581818104, -0.03649015724658966, -0.010375186800956726, 0.0316157266497612, 0.01699243113398552, 0.009340391494333744, 0.0017955744406208396, -0.01764598675072193, 0.0358366034924984, 0.006171329878270626, 0.02271103858947754, 0.011144476011395454, 0.054272301495075226, -0.00954462680965662, -0.04743720591068268, 0.0011343605583533645, 0.014037818647921085, -0.024658087641000748, -0.02875642292201519, -0.01891225017607212, 0.05876549333333969, 0.006566185969859362, 0.007556730415672064, -0.03858698159456253, 0.028021173551678658, -0.015862327069044113, -0.020301055163145065, 0.010116487741470337, 0.010136911645531654, -0.00422428036108613, 0.021295003592967987, -0.026700448244810104, 0.008503023535013199, -0.0018364216666668653, -0.005402041133493185, 0.02521633356809616, 0.02271103858947754, -0.009687592275440693, -0.03902268409729004, -0.03597275912761688, -0.010701964609324932, -0.0037409220822155476, 0.0194296482950449, -0.005589257460087538, 0.018054459244012833, -0.006552570499479771, -0.013717848807573318, -0.005177381448447704, -0.013983355835080147, -0.005653932224959135, -0.0032473518513143063, 0.010368378832936287, -0.009388046339154243, 0.009449317120015621, -0.0008969362825155258, 0.008060512132942677, -0.01857185736298561, -0.020124049857258797, 0.009340391494333744, 0.040166404098272324, -0.011532523669302464, 0.01059303805232048, -0.00555181410163641, -0.011770798824727535, 0.0008977872203104198, 0.013186834752559662, 0.017264746129512787, -0.012887288816273212, -0.01866716705262661, -0.002093418501317501, -0.030580930411815643, 0.03338577225804329, 0.009667168371379375, 0.021989405155181885, -0.008537063375115395, 0.008979574777185917, 0.04038425534963608, 0.028130099177360535, 0.04152797907590866, -0.025583958253264427, 0.02378668077290058, 0.00016264415171463042, -0.008836609311401844, 0.020028740167617798, -0.024535546079277992, -0.004384265281260014, 0.009102116338908672, 0.004469363484531641, -0.0005178232677280903, -0.039730701595544815, 0.01799999549984932, 0.02891981229186058, 0.01624356582760811, -0.001536875613965094, -0.024331310763955116, 0.020232975482940674, -0.008782146498560905, 0.0051331305876374245, 0.03137064352631569, -0.007298031821846962, -0.010286684148013592, -0.008693643845617771, -0.0021580932661890984, -0.004694023169577122, -0.008897880092263222, -0.02027382329106331, -0.012928136624395847, 0.016515880823135376, -0.03256882727146149, -0.0002957166580017656, 0.03599999099969864, -0.03009076416492462, 0.008482600562274456, -0.028402414172887802, -0.001167548936791718, 0.006287063471972942, 0.014527984894812107, 0.02776247449219227, -0.014745836146175861, 0.028974274173378944, 0.029246589168906212, 0.02791224792599678, -0.0050446284003555775, 0.016121024265885353, 0.009830557741224766, 0.00018572706903796643, -0.04683811217546463, -4.738912684842944e-05, -0.007713311351835728, -0.010089256800711155, 0.027789706364274025, -0.0061168670654296875, 0.011471252888441086, 0.0061543104238808155, -0.03624507412314415, 0.003911118488758802, -0.03741602972149849, 0.0037034787237644196, -0.004176625516265631, -0.0007812025723978877, 0.00685211643576622, 0.018857786431908607, 0.0023333958815783262, -0.01106278132647276, 0.0030720492359250784, 0.015372159890830517, 0.001625377801246941, 0.007842660881578922, 0.013057486154139042, 0.012846441939473152, -0.011872917413711548, -0.012764747254550457, 0.01682904362678528, -0.024072611704468727, -0.005357789807021618, -0.04381542280316353, -0.013935700058937073, -0.011614218354225159, -0.005109303165227175, 0.0344478003680706, 0.008475792594254017, -0.01131467241793871, -0.004448940046131611, 0.01639333926141262, 0.013288953341543674, -0.01774129644036293, 0.0013445534277707338, 0.017945533618330956, -0.022425107657909393, 0.07760966569185257, -0.007059756200760603, -0.01214523147791624, 0.02261572889983654, -0.03338577225804329, 0.04324356094002724, -0.01475945208221674, -0.002588690724223852, -0.03202419728040695, 0.00789712369441986, 0.0036626316141337156, 0.012812403030693531, -0.025093792006373405, -0.009347199462354183, 0.026387285441160202, -0.0033137283753603697, 0.003415846498683095, 0.014310132712125778, -0.0037443258333951235, -0.0035843411460518837, 0.022738270461559296, 0.035700444132089615, -0.01925264298915863, -0.02927382104098797, -0.010770043358206749, 0.014623294584453106, 0.0029171702917665243, 0.009306351654231548, 0.01910286955535412, 0.05691375583410263, 0.007543114945292473, -0.028130099177360535, -0.04920725151896477, 0.00632791081443429, -0.02160816453397274, 0.03164295852184296, -0.021131614223122597, 0.02565203607082367, -0.0075294990092515945, -0.021403929218649864, 0.035782139748334885, 0.008543871343135834, 0.007059756200760603, 0.006263236049562693, -0.0012917924905195832, 0.0032354379072785378, -0.0099667152389884, -0.0002735910820774734, 0.0009658659109845757, -0.012730708345770836, -0.00765204057097435, -0.01395612396299839, 0.004074507392942905, -0.016093794256448746, -0.013166411779820919, -0.020409980788826942, -0.02076398953795433, 0.049234483391046524, 0.016883505508303642, 0.026033276692032814, -0.022765502333641052, 0.03118002414703369, -0.012458393350243568, -0.0076928879134356976, -0.00046761526027694345, -0.04425112530589104, -0.022139178588986397, -0.005126322619616985, -0.0027248479891568422, 0.03659908473491669, -0.028810886666178703, 0.005606276914477348, -0.0010135209886357188, 0.00710741151124239, 0.025583958253264427, 0.02580180950462818, -0.007577154319733381, 0.007461420260369778, 0.027231460437178612, 0.02783055417239666, -0.02656429074704647, -0.019116485491394997, -0.0396762378513813, 0.02084568329155445, 0.030335847288370132, -0.02085929922759533, 0.011294248513877392, -0.018381236121058464, -0.027680780738592148, 0.030880477279424667, -0.02313312701880932, -0.005344174336642027, 0.04757336154580116, 0.05669590085744858, -0.007924355566501617, -0.01264901366084814, -0.02034190110862255, 0.011049165390431881, 0.030036302283406258, 0.012009074911475182, 0.006804461590945721, -0.010831314139068127, -0.005194401368498802, 0.006358546204864979, -0.023650523275136948, -0.0018500373698771, -0.04487744718790054, -0.011471252888441086, -0.016420571133494377, 0.01850377768278122, 0.008475792594254017, -0.0018806727603077888, 0.045531004667282104, 0.021880479529500008, -0.003785173175856471, 0.008380481973290443, -0.014555215835571289, 0.005521178711205721, -0.005180785432457924, -0.04534038156270981, 0.03531920537352562, 0.0003499668382573873, 0.010416033677756786, 0.002190430648624897, -0.014405443333089352, -0.003349469741806388, 0.015249618329107761, -0.025352491065859795, 0.015875941142439842, -0.008693643845617771, -0.02951890416443348, -0.027966711670160294, 0.006164521910250187, -0.0021666032262146473, 0.009898636490106583, 0.02867472916841507, -0.010089256800711155, -0.03052646853029728, -0.019443264231085777, -0.025366107001900673, 0.01707412675023079, 0.03052646853029728, -0.0024559374433010817, 0.03531920537352562, -0.010878968983888626, -0.01706051081418991, 0.007665656507015228, -0.015127076767385006, 0.023105895146727562, -0.010524960234761238, 0.007481844164431095, 0.004952722229063511, 0.0032745832577347755, 0.01884417049586773, -0.001928327837958932, 0.017360055819153786, 0.0026805968955159187, -0.023909222334623337, -0.007577154319733381, -0.0017079232493415475, 0.009925867430865765, 0.012424354441463947, 0.008012857288122177, 0.004431920126080513, 0.03229651227593422, -0.03414825350046158, -0.032160356640815735, 0.008462176658213139, -0.0032082065008580685, 0.020328285172581673, -0.024671703577041626, 0.023909222334623337, -0.012329043820500374, 0.005626700818538666, -0.006355142220854759, -0.014269285835325718, -0.03529197350144386, -0.006263236049562693, 0.03270498663187027, 0.028974274173378944, -0.028701961040496826, -0.01858547329902649, 0.01934795267879963, -0.015413006767630577, -0.012499241158366203, 0.002452533459290862, 0.005674355663359165, 0.0014398634666576982, -0.018272310495376587, -0.014623294584453106, -0.008475792594254017, -0.020736757665872574, 0.02724507637321949, -0.008434944786131382, 0.001033093547448516, 0.01740090362727642, 0.014527984894812107, 0.012029497884213924, 0.03354915976524353, 0.005320346914231777, -0.01629802957177162, -0.012118000537157059, 0.015930404886603355, -0.00040464248741045594, -0.00111904286313802, 0.005065051838755608, 0.0055620260536670685, -0.007427380885928869, -0.012172463349997997, -0.020287439227104187, 0.0002661449834704399, -0.02177155390381813, 0.029301052913069725, 0.010334339924156666, 0.013166411779820919, -0.022915273904800415, 0.0014747538371011615, 0.0065083191730082035, -0.04163690283894539, -0.018816940486431122, 0.017087742686271667, 0.008291980251669884, 0.010490920394659042, -0.011879725381731987, -0.007202721666544676, 0.04215430095791817, 0.028974274173378944, -0.02321482077240944, 0.00017179222777485847, 0.02220725640654564, -0.008087744005024433, -0.02271103858947754, 0.022806348279118538, -0.0019453475251793861, -0.006423220969736576, 0.0029750370886176825, -0.016461418941617012, -0.004537442233413458, 0.013888045214116573, 0.0008382184314541519, -0.011321480385959148, 0.03757941722869873, 0.02388199232518673, 0.023432672023773193, -0.0668804720044136, 0.10347955673933029, 0.041065044701099396, 0.04139181971549988, -0.03044477291405201, 0.014051433652639389, -0.013418302871286869, 0.015358543954789639, 0.0076043857261538506, -0.02370498701930046, 0.0018125941278412938, -0.03649015724658966, -0.010661116801202297, -0.005568834021687508, -0.0067091514356434345, 0.008189861662685871, -0.026632368564605713, -0.01682904362678528, -0.003007374471053481, -0.006086231674998999, -0.020791221410036087, 0.027803322300314903, -0.02111799828708172, 0.007086987607181072, 0.0011564861051738262, -0.014977303333580494, 0.019742809236049652, 0.020586984232068062, -0.009306351654231548, -0.020900147035717964, -0.012873673811554909, 0.030226921662688255, 0.02102268859744072, -0.013894853182137012, 0.0318063460290432, -0.022574881091713905, 0.03265052288770676, -0.011872917413711548, -0.02085929922759533, 0.003456693608313799, 0.017523445188999176, -0.01550831738859415, -0.02454916201531887, -0.011968227103352547, 0.022084714844822884, 0.007086987607181072, -0.0019147121347486973, 0.02262934483587742, 0.02194855734705925, -0.0172239001840353, -0.0026601734571158886, 0.029546136036515236, 0.009789709933102131, -0.010613461956381798, -0.006212177220731974, 0.018857786431908607, -0.011158091016113758, -0.03177911415696144, 0.010375186800956726, 0.028293488547205925, 0.0020100222900509834, 0.052093785256147385, 0.006171329878270626, 0.035700444132089615, 0.00042293863953091204, 0.010524960234761238, -0.010402418673038483, 0.01185930147767067, -0.018299542367458344, 0.022983353585004807, 0.018680782988667488, 0.03134341165423393, -0.018789708614349365, 0.030662626028060913, -0.013677001930773258, 0.034338872879743576, -0.009408470243215561, -0.016080178320407867, 0.005490543320775032, -0.0035945528652518988, -0.018476545810699463, -0.027231460437178612, -0.02329651452600956, 0.04833584278821945, 0.024331310763955116, 0.007291223853826523, 0.03314068913459778, 0.002609114395454526, 0.02606050856411457, 0.024753399193286896, -0.012819210067391396, 0.008217093534767628, -0.007141450885683298, 0.006283659487962723, 0.039812397211790085, -0.024113459512591362, -0.021254155784845352, 0.02311951108276844, -0.010838121175765991, 0.01715582050383091, 0.004809756763279438, -0.006225792691111565, -0.0012220118660479784, 0.013513612560927868, 0.006661496125161648, -0.0007552475435659289, 0.02758547104895115, 0.020055972039699554, 0.03559152036905289, -0.012410738505423069, 0.01959303580224514, 0.04765505716204643, 0.018272310495376587, -0.010143719613552094, -0.0356459841132164, -3.983665010309778e-05, -0.03834189847111702, -0.005844552535563707, 0.03491073474287987, 0.024930402636528015, 0.023065047338604927, 0.03649015724658966, -0.01130786444991827, 0.011205746792256832, -0.015481085516512394, -0.018136152997612953, -0.00607261573895812, 0.015154308639466763, 0.015358543954789639, 0.009217849932610989, -0.04054764658212662, -0.02186686359345913, -0.026523442938923836, -0.02220725640654564, -0.013527228496968746, -0.03335854038596153, 0.02261572889983654, -0.015916788950562477, 0.00824432447552681, -0.028620265424251556, 0.0054360805079340935, 0.018177000805735588, -0.008680027909576893, 0.020124049857258797, -0.0153040811419487]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
"1-5, 2023 . OpenRe-
view.net, 2023. URL https://openreview.net/
pdf?id=6ruVLB727MC .
Touvron, H., Martin, L., Stone, K., Albert, P., Almahairi,
A., Babaei, Y ., Bashlykov, N., Batra, S., Bhargava, P.,
Bhosale, S., Bikel, D., Blecher, L., Canton-Ferrer, C.,
Chen, M., Cucurull, G., Esiobu, D., Fernandes, J., Fu,
J., Fu, W., Fuller, B., Gao, C., Goswami, V ., Goyal, N.,
Hartshorn, A., Hosseini, S., Hou, R., Inan, H., Kardas,
M., Kerkez, V ., Khabsa, M., Kloumann, I., Korenev, A.,
Koura, P. S., Lachaux, M., Lavril, T., Lee, J., Liskovich,
D., Lu, Y ., Mao, Y ., Martinet, X., Mihaylov, T., Mishra, P.,
Molybog, I., Nie, Y ., Poulton, A., Reizenstein, J., Rungta,
R., Saladi, K., Schelten, A., Silva, R., Smith, E. M., Sub-
ramanian, R., Tan, X. E., Tang, B., Taylor, R., Williams,
A., Kuan, J. X., Xu, P., Yan, Z., Zarov, I., Zhang, Y ., Fan,
A., Kambadur, M., Narang, S., Rodriguez, A., Stojnic,
R., Edunov, S., and Scialom, T. Llama 2: Open founda-
tion and fine-tuned chat models. CoRR , abs/2307.09288,
2023. doi: 10.48550/ARXIV .2307.09288. URL https:
//doi.org/10.48550/arXiv.2307.09288 .
Xiong, W., Dong, H., Ye, C., Wang, Z., Zhong, H., Ji, H.,
Jiang, N., and Zhang, T. Iterative preference learning
from human feedback: Bridging theory and practice for
rlhf under kl-constraint. In ICLR 2024 Workshop on
Mathematical and Empirical Understanding of Founda-
tion Models , 2023.
Yang, K., Klein, D., Celikyilmaz, A., Peng, N., and Tian, Y .
RLCD: reinforcement learning from contrast distillation
for language model alignment. CoRR , abs/2307.12950,
2023. doi: 10.48550/ARXIV .2307.12950. URL https:
//doi.org/10.48550/arXiv.2307.12950 .
Yao, Z., Aminabadi, R. Y ., Ruwase, O., Rajbhandari, S., Wu,
X., Awan, A. A., Rasley, J., Zhang, M., Li, C., Holmes, C.,
12
Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study
Zhou, Z., Wyatt, M., Smith, M., Kurilenko, L., Qin, H.,
Tanaka, M., Che, S., Song, S. L., and He, Y . Deepspeed-
chat: Easy, fast and affordable RLHF training of chatgpt-
like models at all scales. CoRR , abs/2308.01320, 2023.
doi: 10.48550/ARXIV .2308.01320. URL https://
doi.org/10.48550/arXiv.2308.01320 .
Yu, C., Velu, A., Vinitsky, E., Gao, J., Wang, Y ., Bayen,
A. M., and Wu, Y . The surprising effectiveness of
PPO in cooperative multi-agent games. In Koyejo,
S., Mohamed, S., Agarwal, A., Belgrave, D., Cho,
K., and Oh, A. (eds.), Advances in Neural Infor-
mation Processing Systems 35: Annual Conference
on Neural Information Processing Systems 2022,
NeurIPS 2022, New Orleans, LA, USA, November 28
- December 9, 2022 , 2022. URL http://papers.
n","[-0.020826062187552452, 0.007729187607765198, 0.03593406453728676, 0.017126141116023064, 0.051518574357032776, 0.013173955492675304, -0.019354501739144325, 0.041455913335084915, -0.049416348338127136, 0.00887139793485403, 0.033271245658397675, -0.029963741078972816, -0.010048644617199898, 0.027006609365344048, 0.011793493293225765, -0.015093989670276642, 0.003332029562443495, -0.0390733927488327, 0.022269589826464653, 0.05263976380228996, -0.0029886658303439617, -0.0435020811855793, -0.022227546200156212, 0.0332992747426033, -0.0016195906791836023, -0.025941479951143265, 0.01333512645214796, 0.024764232337474823, -0.024119550362229347, -0.03215005621314049, 0.039465807378292084, -0.026922520250082016, -0.021022269502282143, -0.018541641533374786, -0.032374296337366104, 0.020671898499131203, -0.000513293722178787, 0.042240746319293976, -0.006919830106198788, -7.538454519817606e-05, 0.003699919441714883, -0.061497144401073456, -0.0033863370772451162, 0.033859867602586746, -0.02155483327805996, 0.048042893409729004, 0.020293496549129486, 0.016691680997610092, 0.024708174169063568, 0.03932565823197365, -0.055106375366449356, 0.050032999366521835, -0.03512120246887207, -0.03172961249947548, -0.016929933801293373, -0.024974456056952477, 0.03562573716044426, 0.018485581502318382, 0.04310966655611992, -0.006082443054765463, -0.045828547328710556, -0.03203793987631798, 0.026838431134819984, 0.00654843682423234, -0.02682441473007202, -0.042661190032958984, -0.07276508212089539, -0.009018553420901299, 0.005931783467531204, 0.015962909907102585, -0.027763409540057182, -0.00399423111230135, 0.03293488919734955, -0.039465807378292084, -0.002125001046806574, 0.002447342500090599, -0.0007519840728491545, 0.08302395045757294, -0.017056068405508995, -0.055526819080114365, -0.008261751383543015, 0.02198929339647293, 0.010335949249565601, -0.05031329765915871, -0.035653769969940186, -0.03812038153409958, -0.026572147384285927, -0.008899427019059658, -0.05078980326652527, -0.0014321421040222049, -0.052920058369636536, -0.009971562772989273, -0.028660360723733902, -0.008436937816441059, 0.0632910430431366, 0.013650460168719292, 0.019943125545978546, 0.00556389382109046, 0.03750372678041458, 0.03593406453728676, -0.03652269020676613, -0.030468275770545006, -0.01742045395076275, 0.0014347698306664824, 0.04498765617609024, 0.02522672340273857, 0.009018553420901299, -0.005577908828854561, -0.008542048744857311, -0.0039626979269087315, -0.10774613916873932, -0.02069992758333683, -0.07472716271877289, 0.006671066861599684, -0.01118384674191475, -0.06003960222005844, -0.02615170367062092, -0.013370162807404995, -0.034476522356271744, 0.0036403562407940626, -0.016971979290246964, -0.01095260214060545, 0.032065968960523605, 0.029683444648981094, 0.007056475151330233, -0.027342963963747025, 0.033663660287857056, -0.07809071987867355, -0.029375117272138596, -0.036074213683605194, -0.000933739123865962, 0.021807100623846054, 0.015192093327641487, -0.033271245658397675, -0.06895304471254349, -0.004610884469002485, -0.005322137847542763, -0.019354501739144325, -0.03792417421936989, -0.06592583656311035, 0.013279066421091557, -0.027356980368494987, -0.08706022053956985, 0.019242383539676666, -0.07063482701778412, 0.011323995888233185, -0.04680958762764931, -0.02903876081109047, -0.031056899577379227, 0.008331825956702232, -0.00962819904088974, -0.006853259634226561, -0.001375206746160984, 0.011975686065852642, -0.06755156069993973, -0.03784008324146271, -0.012073789723217487, 0.043446023017168045, 0.024217654019594193, -0.04333390295505524, 0.01119085494428873, 0.06497282534837723, -0.003325022291392088, -0.00405379431322217, 0.05429351329803467, -0.010167771019041538, -0.022970331832766533, 0.026067614555358887, -0.07214842736721039, -0.018849968910217285, 0.02205936796963215, 0.005164470989257097, -0.021624907851219177, 0.006769170518964529, 0.008317811414599419, -0.019704872742295265, 0.0038190456107258797, -0.005090892780572176, -0.017840899527072906, -0.025478990748524666, 0.03868097439408302, 0.036662835627794266, -0.01407090574502945, -0.0159769244492054, -0.01512201875448227, -0.014197039417922497, 0.02665623649954796, 0.0021950751543045044, -0.015570494346320629, 0.03301897644996643, 0.02732894942164421, 0.02884255349636078, 0.05925476923584938, 0.02210141159594059, 0.009067605249583721, -0.0332992747426033, 0.036662835627794266, -0.003370570484548807, -0.02323661558330059, -0.019242383539676666, -0.000985418912023306, 0.03809235244989395, -0.023068437352776527, -0.0342242531478405, 0.014659528620541096, -0.03430834412574768, 0.01847156696021557, 0.01506595965474844, -0.04039078578352928, -0.02159687876701355, 0.036662835627794266, 0.026011554524302483, 0.07035452872514725, -0.0027381505351513624, -0.04737018048763275, -0.04495962709188461, -0.05589120462536812, 0.011821522377431393, -0.031000839546322823, 0.03890521451830864, 0.003647363744676113, 0.009060597978532314, 0.0064363181591033936, 0.007722180336713791, -0.002713624620810151, 0.025619138032197952, 0.025507019832730293, -0.014855736866593361, 0.03809235244989395, -0.01621517725288868, 0.05835781991481781, 0.002703113481402397, -0.016663651913404465, -0.006797200534492731, 0.02105029858648777, -0.03349548205733299, -0.012984754517674446, -0.039353687316179276, 0.02343282289803028, -0.029991770163178444, 0.026712296530604362, 0.01737840846180916, 0.03419622406363487, 0.003969705197960138, 0.02728690579533577, 0.041343796998262405, -0.019943125545978546, -0.039662014693021774, 0.023264644667506218, -0.0013988568680360913, 0.029879651963710785, 0.00434810621663928, -0.01777082495391369, -0.01899011619389057, -0.02697857841849327, -0.03621436282992363, -0.03139325603842735, -0.012284012511372566, -0.02269003540277481, -0.025324827060103416, -0.05219128727912903, 0.006944356020539999, 0.011239906772971153, 0.009985578246414661, 0.0012455694377422333, -0.015486405231058598, -0.028113780543208122, 0.047033824026584625, -0.021919218823313713, 0.006110473070293665, 0.021540818735957146, -0.004849136807024479, 0.0015801738481968641, 0.018807923421263695, -0.05188295990228653, -0.019382532685995102, 0.0007773860124871135, 0.051322367042303085, -0.04711791127920151, -0.01761666126549244, 0.015542464330792427, 0.04333390295505524, 0.060992609709501266, -0.009621191769838333, 0.021190447732806206, 0.03503711521625519, 0.003924157004803419, -0.015318227000534534, -0.04019457846879959, 0.018093166872859, 0.01999918557703495, -0.02295631729066372, 0.015150048770010471, -0.042352866381406784, 0.028702404350042343, 0.02459605410695076, 0.0457724891602993, 0.0005908133462071419, 0.028590286150574684, -0.008387885056436062, 0.031365226954221725, 0.006520407274365425, -0.008703219704329967, 0.007546994835138321, 0.020167363807559013, 0.029963741078972816, 0.006776178255677223, -0.0028187360148876905, 0.03562573716044426, -0.013552356511354446, -0.010644275695085526, 0.028548240661621094, -0.017448483034968376, -0.006709607783704996, -0.044931598007678986, -0.03512120246887207, 0.05908659100532532, -0.014953840523958206, 0.007652105763554573, -0.036074213683605194, -0.0332992747426033, -0.002950125141069293, 0.024764232337474823, -0.003969705197960138, 0.010020614601671696, 0.018499596044421196, 0.033663660287857056, -0.009235783480107784, -0.033915925770998, -0.055106375366449356, -0.0005417614011093974, 0.0037174378521740437, 0.027805455029010773, 0.004460224881768227, -0.022704049944877625, -0.02595549449324608, -0.016873875632882118, 0.05653588846325874, 0.03789614513516426, 0.03977413475513458, -0.05261173099279404, 0.026866460219025612, -0.0547419898211956, -0.015402316115796566, -0.03265459090471268, -0.00047343902406282723, -0.009088627994060516, 0.0012376861413940787, 0.032262176275253296, 0.026852445676922798, -0.0007559257792308927, -0.050117090344429016, 0.04182030260562897, 0.006047406233847141, -0.002252886537462473, 0.02249382808804512, 0.006709607783704996, -0.05076177418231964, -0.0066465409472584724, 0.02424568310379982, -0.007890358567237854, 0.032178085297346115, -0.017868928611278534, -0.0020251453388482332, 0.00894847884774208, 0.01879390887916088, -0.04162409156560898, -0.021456729620695114, 0.005949302110821009, -0.026403969153761864, 0.0024648611433804035, 0.029991770163178444, -0.058245699852705, -0.00486315181478858, -0.02779144048690796, -0.000713005312718451, 0.023558955639600754, 0.01851361244916916, -0.018892012536525726, 0.040362756699323654, -0.016859859228134155, 0.00013752067752648145, -0.021428700536489487, -0.03691510483622551, -0.00822671502828598, 0.014449306763708591, -0.02116241678595543, 0.005101404152810574, -0.0004033648001495749, -0.013706519268453121, 0.004418180324137211, -0.008317811414599419, -0.04877166450023651, 0.014799677766859531, 0.02682441473007202, 0.0017974040238186717, 0.009537102654576302, 0.006499384995549917, 0.01866777427494526, 0.04725806042551994, -0.0319538488984108, 0.0006674570613540709, -0.026754342019557953, 0.017798854038119316, -0.05107009783387184, 0.03285079821944237, -0.01594889536499977, 0.06222591549158096, 0.011001653969287872, 0.036466628313064575, 0.027567202225327492, -0.03613027185201645, 0.014701573178172112, -0.021807100623846054, 0.015878820791840553, -0.026950549334287643, -0.019480636343359947, -0.026516089215874672, 0.029066789895296097, 0.07977250218391418, 0.026446014642715454, 0.008969501592218876, -0.029094820842146873, -0.023643044754862785, -0.028604300692677498, 0.04666943848133087, 0.018079152330756187, -0.05227537453174591, 0.03229020535945892, -0.046136874705553055, -0.035653769969940186, 0.030272068455815315, 0.06188955903053284, -0.027062667533755302, -0.022115428000688553, -0.03971807286143303, 0.016285251826047897, 0.03498105704784393, -0.013363155536353588, -0.036270420998334885, 0.009424984455108643, 0.007561009377241135, -0.03820446878671646, -0.01956472545862198, -0.002112738089635968, -0.01306183636188507, -0.0061455098912119865, 0.014645514078438282, -0.015332241542637348, -0.012935702688992023, -0.0029588844627141953, 0.001719446387141943, 0.08846171200275421, 0.014098934829235077, -0.014014845713973045, -0.051434483379125595, 0.07455898076295853, -0.018135210499167442, 0.025114603340625763, 0.020882120355963707, 0.024764232337474823, 0.02148475870490074, 0.008934464305639267, 0.022704049944877625, 0.03324321657419205, 0.03750372678041458, 0.00631368812173605, -0.0008733000722713768, 0.010160763747990131, -0.003822549246251583, -0.016873875632882118, -0.027497127652168274, -0.023558955639600754, -0.057516928762197495, -0.01969085820019245, -0.000400299031753093, 0.03590603545308113, -0.030692512169480324, -0.02128855139017105, -0.0006477486458607018, 0.0054868124425411224, -0.019718889147043228, 0.051518574357032776, 0.005690027493983507, 0.043165724724531174, 0.004446209874004126, 0.012010723352432251, 0.00211448990739882, -0.017840899527072906, 0.014000831171870232, 0.01575268618762493, -0.0030237031169235706, 0.04975270479917526, -0.01671971194446087, -0.01816324144601822, -0.006544933188706636, 0.00585820572450757, -0.004172920249402523, 0.0012508250074461102, -0.04521189257502556, 0.007729187607765198, -0.010062659159302711, -0.0031410774681717157, -0.011590277776122093, -0.009340895339846611, 0.03203793987631798, -0.007350786589086056, -0.021877175197005272, 0.038176439702510834, 0.043137695640325546, 0.005241552367806435, 0.00330400001257658, 0.01541633065789938, 0.020405616611242294, 0.0033180147875100374, 0.03599012643098831, -0.029711473733186722, -0.018653759732842445, -0.006853259634226561, 0.047734566032886505, 0.018261345103383064, -0.0070284451358020306, -0.017476513981819153, -0.005518345627933741, 0.015136034227907658, 0.00666756322607398, -0.0368029847741127, -0.0914328545331955, -0.022942302748560905, -0.003442396642640233, 0.02218550071120262, -0.011898604221642017, 0.0027363987173885107, 0.007925395853817463, -0.043137695640325546, -0.013699511997401714, -0.012038752436637878, -0.027707351371645927, -0.026768356561660767, 0.0009880466386675835, 0.008471974171698093, 0.016971979290246964, 0.0172662902623415, -0.0026032577734440565, -0.014000831171870232, 0.0032356774900108576, 0.019929111003875732, -0.023769179359078407, 0.01101566944271326, 0.02954329550266266, 0.04448312148451805, -0.048939842730760574, -0.0016528759151697159, -0.010335949249565601, -0.02205936796963215, -0.0012893658131361008, -0.0077712321653962135, -0.016635622829198837, 0.017798854038119316, 0.023068437352776527, 0.017784839496016502, -0.011520203202962875, -0.021274536848068237, 0.01805112138390541, -0.01304081454873085, 0.008359855972230434, 0.007462905719876289, -0.0013865937944501638, 0.013356148265302181, 0.03229020535945892, -0.005090892780572176, -0.005872220732271671, 0.018303388729691505, -0.018457552418112755, 0.023068437352776527, -0.017336364835500717, 0.01789695769548416, 0.017182201147079468, -0.002361501567065716, 0.00434460211545229, -0.0441187359392643, -0.03220611810684204, -0.01356637105345726, -0.015612538903951645, -0.040054429322481155, 0.007554002106189728, 0.026460029184818268, 0.02315252646803856, -0.025787316262722015, 0.04069911316037178, 0.049136050045490265, -0.02560512349009514, -0.029767533764243126, -0.03669086843729019, -0.036270420998334885, -0.004207957535982132, 0.0123961316421628, -0.020601823925971985, -0.011814515106379986, -0.00631368812173605, -0.0003751161275431514, 0.0015433849766850471, -0.0006797200185246766, -0.038456737995147705, -0.009116657078266144, -0.004421683959662914, -0.00770816532894969, -0.0005062863347120583, 0.007196623366326094, -0.011548233218491077, 0.0005973828374408185, 0.0051609668880701065, 0.01715417206287384, -0.022704049944877625, -0.02951526641845703, -0.017924988642334938, -0.012557301670312881, -0.010048644617199898, 0.06065625324845314, -0.02439984679222107, -0.023292673751711845, -0.013727542012929916, -0.0016484962543472648, 0.010363978333771229, 0.01060223113745451, 0.02954329550266266, -0.012438176199793816, -0.02069992758333683, -0.01154122594743967, -0.01632729545235634, -0.01664963737130165, -0.025044530630111694, 0.0019025153014808893, 0.0026242798194289207, 0.01964881457388401, -0.007336772046983242, 0.0011868822621181607, -0.01424609124660492, 0.022704049944877625, -0.02538088709115982, 0.007638091221451759, 0.026165718212723732, -0.011387062259018421, -0.01964881457388401, 0.03769993782043457, -0.010041637346148491, 0.011905611492693424, 0.0012192915892228484, -0.017840899527072906, -0.019831007346510887, -0.0247922632843256, -0.032570503652095795, 0.014119957573711872, -0.012052767910063267, 0.01606101356446743, -0.01292168814688921, -0.0038610901683568954, -0.008647159673273563, 0.014519380405545235, -0.00579864252358675, -0.050733741372823715, -0.004085327498614788, -0.0071510751731693745, 0.02304040640592575, -0.018037106841802597, 0.02573125809431076, 0.01952267996966839, 0.0594790056347847, 0.014799677766859531, 0.011842545121908188, -0.012536279857158661, -0.008955487050116062, 0.030888721346855164, -0.014939825981855392, 0.009873459115624428, -0.02845013700425625, 0.020321527495980263, -0.02240973897278309, -0.0010090689174830914, 0.014105943031609058, -0.03349548205733299, 0.026446014642715454, -0.0627865120768547, -0.016621608287096024, -0.0068882969208061695, -0.02498847059905529, 0.019620783627033234, -0.005325641483068466, -0.006576466374099255, -0.0009004538878798485, -0.0009293594630435109, 0.012613361701369286, 0.017686735838651657, -0.016551533713936806, -0.02116241678595543, 0.022115428000688553, 0.010363978333771229, 0.04089532047510147, 0.004530298989266157, -0.1005144789814949, -0.015164063312113285, -0.006530918180942535, 0.016509488224983215, 0.01192663423717022, -0.04240892454981804, -0.021961264312267303, -0.009866451844573021, -0.0033495482057332993, 0.05835781991481781, -0.004544313997030258, -0.019438590854406357, -0.0072526829317212105, -0.0064363181591033936, 0.041652124375104904, -0.014056890271604061, 0.0332992747426033, 0.014939825981855392, 0.0278334841132164, 0.013650460168719292, -0.031785670667886734, -0.02951526641845703, 0.016032984480261803, 0.011408085003495216, 0.02240973897278309, -0.0029010730795562267, -0.014603469520807266, -0.04232483357191086, 0.001144837704487145, -0.033159125596284866, 0.007645098492503166, 0.006720118690282106, 0.005518345627933741, 0.005167974624782801, -0.023923343047499657, -0.011359033174812794, 0.012291019782423973, -0.041343796998262405, 0.011982693336904049, -0.0332992747426033, 0.015500419773161411, 0.0214427150785923, -0.025170663371682167, -0.01362243015319109, 0.027469098567962646, 0.00011441807873779908, -0.006629022303968668, 0.023881297558546066, 0.028982702642679214, 0.001806163345463574, 0.01323702186346054, -0.023881297558546066, 0.012963732704520226, 0.011288958601653576, -0.009740318171679974, 0.001785141066648066, -0.012781539931893349, -0.010938587598502636, -0.0067866891622543335, -0.03369168937206268, 0.009551117196679115, 0.012333064340054989, 0.017238261178135872, -0.013776593841612339, 0.004673951305449009, 0.019732903689146042, -0.0010756393894553185, -0.016439413651823997, -0.027539173141121864, -0.016831830143928528, 0.0190181452780962, 0.0128866508603096, -0.009488050825893879, -0.01212284155189991, 0.01341220736503601, 0.04947240650653839, 0.00556389382109046, -0.007925395853817463, 0.05160266160964966, -0.01204576063901186, 0.011309980414807796, -0.006348725408315659, -0.026179732754826546, 0.0336076021194458, -0.020125318318605423, -0.027230845764279366, -0.02903876081109047, -0.015962909907102585, -0.031281135976314545, 0.020882120355963707, -0.018191270530223846, -0.03271064907312393, -0.00037599203642457724, 0.013293081894516945, -0.013138918206095695, 0.009417976252734661, 0.055414702743291855, -0.02884255349636078, -0.09602972865104675, -0.04476341977715492, 0.01617313176393509, 0.023825237527489662, 0.018583685159683228, -0.017280304804444313, 0.02665623649954796, 0.014841722324490547, 0.006303177215158939, -0.051742810755968094, 0.03021600842475891, -0.0004541685921140015, 0.0077572171576321125, 0.009053590707480907, 0.0090465834364295, -0.05863811448216438, 0.018387477844953537, -0.004411172587424517, 0.058021463453769684, 0.01555647887289524, -0.01735037937760353, 0.009670243598520756, 0.030356157571077347, 0.036270420998334885, -0.030552364885807037, 0.0084789814427495, 0.017490528523921967, 0.005795138888061047, -0.00713355652987957, 0.01812119595706463, -0.011057714000344276, -0.02065788395702839, 0.01969085820019245, 0.03761584684252739, -0.060600195080041885, 0.007722180336713791, -0.030664483085274696, -0.003226918401196599, -0.02280215546488762, 0.010377993807196617, 0.016901904717087746, -0.04392252862453461, 0.027230845764279366, -0.018625730648636818, 0.047033824026584625, -0.044539179652929306, 0.025899436324834824, -0.03349548205733299, 0.01805112138390541, 1.1222826287848875e-05, 0.03481287881731987, -0.0059037539176642895, 0.018611716106534004, 0.012248975224792957, 0.000264092261204496, 0.020840076729655266, 0.018934056162834167, 0.009242790751159191, 0.034532580524683, -0.0053992196917533875, -0.009347902610898018, 0.032962918281555176, 0.0035527634900063276, -0.0024140572641044855, -0.020489705726504326, -0.007981454953551292, -0.01737840846180916, 0.029599355533719063, -0.022633977234363556, -0.03313109651207924, -0.048519399017095566, 0.03769993782043457, 0.014575439505279064, 0.019620783627033234, 0.0029939215164631605, -0.017532572150230408, 0.04641716927289963, 0.031561434268951416, -0.028520211577415466, 0.014701573178172112, 0.04467932879924774, -0.034532580524683, 0.007490935269743204, 0.012487228028476238, -0.007158082444220781, 0.003966201562434435, 0.025619138032197952, 0.004418180324137211, -0.0031323181465268135, 0.001811418915167451, 0.031056899577379227, -0.011709404177963734, 0.022437768056988716, -0.022311635315418243, 0.008766286075115204, -0.013047821819782257, -0.0136854974552989, -0.0034196225460618734, 0.02638995461165905, -0.017182201147079468, 0.010973624885082245, 0.026754342019557953, -0.046529289335012436, -0.0042780316434800625, 0.0168038010597229, 0.008920449763536453, -0.007820283994078636, -0.011667359620332718, 0.025619138032197952, -0.0004813223786186427, -0.0027959616854786873, 0.018625730648636818, -0.03144931420683861, -0.002526175929233432, -0.0001445280940970406, 0.017882943153381348, 0.03411213681101799, 0.03251444175839424, -0.014645514078438282, 0.025703227147459984, 0.0014119957340881228, 0.0028257432859390974, -0.0044672321528196335, -0.0007300858851522207, -0.015023915097117424, -0.005493819713592529, 0.008373870514333248, 0.03240232542157173, -0.010588216595351696, 0.0028765471652150154, 0.03021600842475891, -0.015234137885272503, -0.0022406235802918673, 0.006061420775949955, -0.0046564326621592045, 0.021680966019630432, 0.027455084025859833, 0.007385823875665665, -0.04263316094875336, 0.0307205431163311, 0.0247922632843256, -0.00504884822294116, 0.0034266298171132803, 0.038961272686719894, -0.0072526829317212105, 0.0010388505179435015, -0.0152061078697443, -0.03798023238778114, -0.009684259071946144, -0.008177662268280983, 0.048631515353918076, -0.012073789723217487, -0.009235783480107784, 0.024063490331172943, 0.018275359645485878, 0.012928695417940617, 0.0168038010597229, -0.034168194979429245, -0.010230837389826775, 0.02674032561480999, 0.02487635239958763, 0.032065968960523605, 0.015093989670276642, -0.04610884189605713, 0.010048644617199898, -0.03489696606993675, -0.021723011508584023, -0.023839253932237625, 0.008331825956702232, 0.0054377601481974125, -0.030748572200536728, -0.019158294424414635, 0.027272891253232956, 0.030888721346855164, 0.02599753998219967, 0.024413861334323883, 0.011989700607955456, 0.014925811439752579, 0.003910141997039318, 0.06418799608945847, 0.01789695769548416, -0.002652309602126479, 0.004092335235327482, -0.017826884984970093, 0.027847498655319214, 0.0095090726390481, -0.0037034230772405863, -0.00014179082063492388, -0.0013664475409314036, 0.03727949038147926, 0.010230837389826775, -0.005598931107670069, 0.009018553420901299, 0.0626743882894516, -0.00945301353931427, -0.033467452973127365, 0.01667766645550728, 0.024385832250118256, -0.033187154680490494, -0.03520529344677925, 0.0006254125037230551, 0.05409730598330498, 0.008668182417750359, -0.007322757039219141, -0.032486412674188614, 0.019004130735993385, 0.008044521324336529, -0.03234626352787018, -0.0066465409472584724, 0.008184670470654964, 0.005735575687140226, 0.020363571122288704, -0.0332992747426033, 0.019718889147043228, 0.00544827152043581, -0.00010658947576303035, -0.0038505790289491415, 0.015836775302886963, -0.0055253528989851475, 0.0003048228973057121, -0.011863566935062408, -0.036859046667814255, -0.01621517725288868, 0.007189616095274687, 0.01362243015319109, -0.00730874203145504, 0.021807100623846054, -0.014967855997383595, -0.010146748274564743, 0.0053501673974096775, -0.013223007321357727, 0.00486315181478858, -0.0021460233256220818, -0.017336364835500717, -0.003710430581122637, -0.039577923715114594, -0.004081823863089085, -0.028506197035312653, -0.003899630857631564, -0.005069870501756668, 0.05569499731063843, 0.028632329776883125, 0.0031112958677113056, 0.00115972850471735, 0.012662413530051708, 0.008654167875647545, 0.020952194929122925, 0.03184172883629799, -0.026263821870088577, -0.007729187607765198, 0.0030149437952786684, -0.008366863243281841, 0.014351202175021172, 0.027665305882692337, 0.0004861399647779763, -0.003361811162903905, -0.0006902311579324305, 0.03282276913523674, 0.03111295774579048, 0.024469921365380287, -0.01899011619389057, 0.03310306742787361, 0.005581412464380264, -0.006527414545416832, 0.0023054422345012426, -0.015290196985006332, -0.005157463252544403, 0.026502074673771858, 0.01976093277335167, 0.0049997963942587376, -0.04240892454981804, -0.012087805196642876, -0.016817815601825714, 0.025815347209572792, -0.006467851344496012, -0.020713942125439644, 0.013258044607937336, -0.009389947168529034, 0.024848321452736855, 0.01506595965474844, -0.026712296530604362, -0.009929518215358257, -0.022129442542791367, 0.0073928311467170715, 0.009558125399053097, -0.0023632533848285675, 0.005896746646612883, -0.015598523430526257, 0.036774955689907074, -0.006467851344496012, 0.014435291290283203, 0.03414016589522362, 0.001565283164381981, 0.016663651913404465, -0.018892012536525726, 0.002340479288250208, -0.011800500564277172, 0.012543287128210068, 0.019971156492829323, -0.011660352349281311, 0.049724675714969635, 0.027651291340589523, 0.026866460219025612, -0.009880466386675835, 0.03352351114153862, 0.025268767029047012, 0.0018447041511535645, -0.05334050580859184, 0.011218884028494358, -0.025521034374833107, -0.010328941978514194, -0.0012587084202095866, 0.016467444598674774, -0.009053590707480907, 0.014533394947648048, -0.0065974886529147625, -0.012487228028476238, -0.04271725192666054, 0.004313068930059671, -0.020727956667542458, -0.009761339984834194, 0.01491179596632719, 0.013769586570560932, 0.005879228003323078, -0.012578324414789677, -0.01800907775759697, 0.011814515106379986, -0.008962494321167469, 0.021765055134892464, 0.0069583710283041, -0.005644479300826788, 0.004596869461238384, -0.01594889536499977, -0.003053484484553337, -0.034084104001522064, 0.013251037336885929, -0.024568025022745132, 0.020167363807559013, -0.02159687876701355, -0.05056556314229965, 0.05448972061276436, 0.007322757039219141, 0.0027679321356117725, -0.001272723195143044, -5.699005851056427e-05, 0.01257131714373827, -0.017910974100232124, 0.000374678143998608, 0.014953840523958206, -0.026053598150610924, 0.08672386407852173, -0.007245675660669804, -0.0030394697096198797, 0.01512201875448227, -0.014659528620541096, 0.05095798149704933, -0.015878820791840553, 0.00032715906854718924, -0.020727956667542458, 0.013489289209246635, 0.01309687364846468, 0.01831740327179432, -0.020167363807559013, -0.022591931745409966, 0.000692858942784369, -0.030972810462117195, -0.02085409127175808, 0.02647404372692108, -0.006050909869372845, 0.016201162710785866, 0.014021853916347027, 0.03310306742787361, 0.004264017101377249, -0.020517734810709953, 0.03380380943417549, 0.002130256500095129, -0.005483308341354132, 0.004838625434786081, 0.014589454978704453, 0.06715914607048035, -0.008605115115642548, -0.03784008324146271, -0.0547419898211956, 0.014939825981855392, -0.03809235244989395, 0.009621191769838333, -0.03024403750896454, 0.030692512169480324, 0.0007362173637375236, -0.03809235244989395, 0.041259706020355225, -0.01632729545235634, 0.0058021461591124535, 0.01506595965474844, -0.0034861930180341005, 0.011688381433486938, -0.017574617639183998, 0.0018289374420419335, -0.002160038100555539, 0.0022563901729881763, 0.0005513965734280646, -0.017602646723389626, 0.02689448930323124, -0.004971766844391823, -0.036662835627794266, 0.003205896122381091, 0.005577908828854561, 0.06474859267473221, 0.027188802137970924, 0.029767533764243126, -0.0428854301571846, 0.016789786517620087, -0.016943948343396187, 0.003197136800736189, -0.001888500526547432, -0.03593406453728676, -0.01890602707862854, -0.019508665427565575, -0.004652929026633501, 0.04439903423190117, -0.04706185311079025, 0.008605115115642548, 0.004593365825712681, -0.0003048228973057121, 0.023054420948028564, 0.0041904388926923275, -0.0034774336963891983, 0.024778248742222786, 0.005644479300826788, 0.04807092249393463, -0.0017457242356613278, 0.014000831171870232, -0.020952194929122925, 0.01925639808177948, 0.026866460219025612, -0.001174619304947555, 0.03282276913523674, -0.010910557582974434, -0.05238749459385872, 0.014309157617390156, -0.0016765259206295013, 0.0147155886515975, 0.04622096195816994, 0.02962738461792469, -0.01866777427494526, 0.0019480636110529304, -0.006681577768176794, 0.012333064340054989, 0.02580133080482483, 0.022241560742259026, -0.01590684987604618, -0.012347079813480377, -0.003833060385659337, 0.002873043529689312, -0.02175104059278965, 8.956362580647692e-05, -0.020447660237550735, -0.012284012511372566, 0.005472797434777021, 0.022437768056988716, -0.0007467285031452775, 0.0033565557096153498, 0.04490356519818306, 0.042941488325595856, -0.0008763658697716892, 0.02498847059905529, -1.5479288776987232e-05, 0.007631083484739065, 0.003612326690927148, -0.0319538488984108, 0.02709069661796093, 0.011499181389808655, 0.01980297826230526, 0.013902727514505386, -0.020643867552280426, 0.02183512970805168, 0.0364946573972702, -0.02362903021275997, 0.013089866377413273, 0.01980297826230526, -0.017910974100232124, -0.011842545121908188, 0.006751652341336012, -0.005111915059387684, 0.009298850782215595, 0.01945260725915432, 0.007631083484739065, -0.018877997994422913, -0.010812453925609589, -0.007680135779082775, 0.027903558686375618, 0.03568179905414581, -0.001082646893337369, 0.026502074673771858, -0.012508249841630459, -0.033915925770998, 0.00816364772617817, -0.02842210792005062, 0.04711791127920151, 0.0015503923641517758, -0.0128866508603096, 0.004109853412955999, 0.003906638361513615, 0.01582276076078415, -0.0011413340689614415, -0.013124903663992882, 0.029683444648981094, -0.04078320041298866, -0.0037734974175691605, -0.006001858040690422, 0.010959609411656857, -0.019466621801257133, -0.017098112031817436, 0.019088219851255417, 0.01785491406917572, -0.018065135926008224, -0.013664474710822105, -0.009670243598520756, 0.008135617710649967, 0.004421683959662914, -0.0077852471731603146, 0.03481287881731987, -0.011415092274546623, -0.011667359620332718, -0.0006692088791169226, -0.008892419748008251, -0.03613027185201645, -0.013965793885290623, 0.011709404177963734, 0.011120780371129513, -0.012410146184265614, -0.0047965808771550655, 0.025198692455887794, -0.002878298982977867, -0.0017430965090170503, -0.0033372852485626936, 0.009228776209056377, 0.0016651388723403215, -0.0012639639899134636, -0.00992251094430685, 0.0019060190534219146, 0.0291228499263525, 0.021414684131741524, 0.015640567988157272, 0.005949302110821009, 0.030047830194234848, 0.0058897389099001884, 0.025983525440096855, 0.038372647017240524, 0.014981870539486408, -0.018037106841802597, -0.023825237527489662, -0.00933388713747263, -0.011583270505070686, -0.0022844199556857347, 0.0019585746340453625, 0.020685913041234016, 0.00880833063274622, 0.0028099766932427883, 0.0037489712703973055, -0.011506188660860062, -0.013664474710822105, 0.025212708860635757, 0.01206678245216608, 0.018892012536525726, 0.01339118555188179, 0.010749386623501778, 0.024315757676959038, -0.04622096195816994, -0.00462840311229229, 0.017014022916555405, -0.00875227153301239, -0.01015375554561615, -0.011870574206113815, 0.012305035255849361, 0.0368029847741127, 0.016817815601825714, 0.0015179830370470881, -0.005721561145037413, 0.03380380943417549, -0.00022577041818294674, -0.031785670667886734, 0.008724241517484188, 0.0017518557142466307, 9.72279958659783e-05, -0.0273709949105978, -0.0013874698197469115, 7.231879862956703e-05, -0.014379232190549374, 0.012991762720048428, -0.03702722489833832, 0.04566036909818649, 0.01700000837445259, 0.02416159398853779, -0.04139985516667366, 0.08459360897541046, 0.01737840846180916, 0.03282276913523674, -0.02903876081109047, 0.018681790679693222, -0.001123815425671637, 0.030384186655282974, -0.02483430691063404, -0.03778402507305145, 0.028324004262685776, -0.0524715855717659, -0.015738671645522118, 0.0030342142563313246, -0.016046999022364616, -0.0022493829019367695, 0.0025874909479171038, -0.032486412674188614, -0.007743202615529299, 0.024231668561697006, -0.03599012643098831, 0.0313371941447258, -0.03840067982673645, 0.00898351613432169, -0.010812453925609589, -0.021863160654902458, -0.0014636755222454667, 0.0244839359074831, 0.0027889544144272804, 0.00446372851729393, -0.014218061231076717, 0.009880466386675835, 0.03848476707935333, 0.01025186013430357, 0.02417561039328575, -0.04353011026978493, 0.03175764158368111, -0.0032794740982353687, -0.0206158384680748, -0.0009057094575837255, -0.0036508673802018166, 0.0031691070180386305, -0.02026546746492386, -0.03139325603842735, 0.011120780371129513, 0.01091756485402584, -0.0031515886075794697, 0.02295631729066372, 0.011099758557975292, -0.031197046861052513, 0.006758659612387419, 0.016817815601825714, 0.00585820572450757, -0.03161749243736267, -0.03343942388892174, 0.043025579303503036, 0.0037489712703973055, -0.028954671695828438, 0.008619130589067936, 0.025366870686411858, 0.04526795446872711, 0.04081123322248459, 0.0035369968973100185, 0.037251461297273636, -0.010356971062719822, 0.04378237947821617, 0.0026347909588366747, 0.026530103757977486, -0.0147155886515975, 0.014743617735803127, 0.018331417813897133, 0.04240892454981804, -0.008464966900646687, 0.012368101626634598, -0.035765886306762695, 0.011877582408487797, -0.010406022891402245, -0.015514434315264225, 0.017532572150230408, 0.0002868663868866861, 0.004540810361504555, 0.005679516587406397, -0.03013191930949688, 0.05384504050016403, 0.028169840574264526, -0.014112950302660465, 0.02074197307229042, -0.03172961249947548, 0.024497950449585915, 0.030552364885807037, -0.043137695640325546, 0.016775770112872124, 0.009852436371147633, 0.01579473167657852, 0.008731248788535595, -0.013117896392941475, -0.02564716897904873, -0.008962494321167469, 0.01536027155816555, 0.01800907775759697, -0.01054617203772068, 0.01374155655503273, 0.0005540243582800031, 0.01601896993815899, 0.004589862190186977, -0.00030394698842428625, 0.03901733085513115, 0.03363563120365143, 0.0067866891622543335, 0.010455075651407242, 0.014799677766859531, 0.004891181364655495, -0.005409730598330498, -0.022788139060139656, -0.052527643740177155, -0.004894685000181198, -0.046753525733947754, -0.030692512169480324, 0.01739242486655712, -0.0082477368414402, -0.008675189688801765, 0.011870574206113815, -0.0051609668880701065, -0.012431168928742409, -0.008240729570388794, -0.013664474710822105, -0.0014303902862593532, 0.016887890174984932, 0.015724657103419304, 0.01590684987604618, -0.04529598355293274, -0.025436945259571075, -0.013349140994250774, -0.011155817657709122, 0.013454251922667027, -0.017098112031817436, 0.0084789814427495, -0.016873875632882118, 0.030384186655282974, -0.010882527567446232, -0.009656229056417942, 0.004316572565585375, -0.011639329604804516, 0.023727133870124817, -0.015346256084740162]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
"ips.cc/paper_files/paper/2022/hash/
9c1535a02f0ce079433344e14d910597-Abstract-Datasets_
and_Benchmarks.html .
Yuan, W., Pang, R. Y ., Cho, K., Sukhbaatar, S., Xu, J.,
and Weston, J. Self-rewarding language models. CoRR ,
abs/2401.10020, 2024. URL https://arxiv.org/
pdf/2401.10020.pdf .
Yuan, Z., Yuan, H., Tan, C., Wang, W., Huang, S.,
and Huang, F. RRHF: rank responses to align lan-
guage models with human feedback without tears.
CoRR , abs/2304.05302, 2023. doi: 10.48550/ARXIV .
2304.05302. URL https://doi.org/10.48550/
arXiv.2304.05302 .
Zhang, T., Kishore, V ., Wu, F., Weinberger, K. Q., and
Artzi, Y . Bertscore: Evaluating text generation with
BERT. In 8th International Conference on Learning
Representations, ICLR 2020, Addis Ababa, Ethiopia,
April 26-30, 2020 . OpenReview.net, 2020. URL https:
//openreview.net/forum?id=SkeHuCVFDr .
Zheng, R., Dou, S., Gao, S., Hua, Y ., Shen, W., Wang, B.,
Liu, Y ., Jin, S., Liu, Q., Zhou, Y ., Xiong, L., Chen, L., Xi,
Z., Xu, N., Lai, W., Zhu, M., Chang, C., Yin, Z., Weng, R.,
Cheng, W., Huang, H., Sun, T., Yan, H., Gui, T., Zhang,
Q., Qiu, X., and Huang, X. Secrets of RLHF in large
language models part I: PPO. CoRR , abs/2307.04964,
2023. doi: 10.48550/ARXIV .2307.04964. URL https:
//doi.org/10.48550/arXiv.2307.04964 .
Ziegler, D. M., Stiennon, N., Wu, J., Brown, T. B., Radford,
A., Amodei, D., Christiano, P. F., and Irving, G. Fine-
tuning language models from human preferences. CoRR ,
abs/1909.08593, 2019. URL http://arxiv.org/
abs/1909.08593 .
13
Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study
A. Implementation Details
A.1. DPO Details
For DPO training, we use β= 0.1 with a learning rate of 1e-6. We sweep the batch size and report the best performance. For
HH-RLHF and SafeRLHF, we train DPO for two epochs. For code generation tasks, we train DPO for a single epoch, since
it has led to a deterioration in performance.
A.2. PPO Details
During the PPO training phase, we separate the parameters of actor and critic, and set the learning rate to 1e-5 for the actor
model and 5e-6 for the critic model. By default, we set the global batch size as 512, and 512 roll-out samples are split into
4 mini-batches to update the actor and critic models. We configure the sampling parameters to include a temperature of
1.0 and a top-k value of 200. The advantage estimation parameter λin GAE and the RL discount factor γare fixed at 1.
We set the KL penalty coefficient βas 0.1, with a clipping value of 20 for reward scores. We additionally adopt advantage
normalization and value normalization to stabilize the training.
For HH-RLHF and SafeRLHF, we set the maximum generated tokens as 256 and adopted PPO training for 5 epochs.
For APPS and CodeContest, we set the maximum generated tokens as 1024, and adopt PPO training for 16 epochs. The
checkpoints with the highest reward/pass@k on the validation sets are selected.
B. GPT-4 Evaluation
We adopt the same evaluation prompt with (Rafailov et al., 2023). The prompt is :
For the following query to a chatbot, which response is more helpful?
Query: <the user query>
Response A:
<either the test method","[-0.009488494135439396, 0.01295457687228918, 0.07957704365253448, -0.0026033211033791304, 0.017984531819820404, -0.01167641207575798, -0.030420323833823204, 0.051848381757736206, -0.020555898547172546, 0.008541149087250233, 0.03428489342331886, -0.02455580234527588, -0.029397791251540184, 0.009526087902486324, 0.00142195844091475, -0.040209561586380005, 0.00534949591383338, -0.037442710250616074, -0.01571390964090824, 0.04117194563150406, -0.02049575001001358, -0.024600913748145103, -0.004176591522991657, 0.020871680229902267, 0.028510594740509987, -0.004413428250700235, -0.0027499340940266848, 0.013383137993514538, 0.031066924333572388, -0.044389914721250534, 0.01356358453631401, -0.022510739043354988, -0.02620989829301834, -0.027488062158226967, 0.0011503483401611447, 0.0014445142587646842, 0.004920934792608023, 0.04920182749629021, -0.0018411212367936969, -0.002291298471391201, -0.03242027387022972, -0.06207370012998581, -0.030555658042430878, -0.002952936803922057, -0.038585539907217026, 0.05190853029489517, 0.07879510521888733, -0.007653952110558748, 0.005481071770191193, 0.017713861539959908, -0.05672044679522514, 0.08781744539737701, -0.03557809442281723, -0.02070626989006996, 0.026149749755859375, -0.0022875391878187656, 0.023518232628703117, -0.0035901395604014397, 0.012195196002721786, -0.031638339161872864, 0.005872039590030909, -0.04219447821378708, -0.004635227378457785, 0.007462227251380682, -0.020435599610209465, -0.01956344023346901, -0.08198300004005432, 0.0008510134648531675, 0.04237492382526398, 0.026570791378617287, 0.007616358809173107, 0.022811483591794968, 0.037442710250616074, -0.038796063512563705, -0.029608312994241714, -0.01468385849148035, 0.030826328322291374, 0.05792342498898506, -0.00019207716104574502, -0.018631132319569588, -0.014150036498904228, 0.010375691577792168, 0.010285467840731144, -0.05251001939177513, -0.016435695812106133, -0.04117194563150406, -0.027548212558031082, -0.02007470652461052, -0.06026923283934593, -0.04559289291501045, -0.025352776050567627, -0.012977132573723793, -0.012541052885353565, -0.01968373917043209, 0.044690657407045364, -0.03882613778114319, 0.00018937516142614186, 0.002817601663991809, 0.03678107261657715, 0.03305184096097946, -0.0019623590633273125, -0.0395178496837616, -0.004642745945602655, 0.007969734258949757, 0.04757780581712723, 0.022811483591794968, -0.004075090400874615, 0.037352487444877625, -0.015638722106814384, 0.013007206842303276, -0.11470402032136917, 0.021443095058202744, -0.0864340215921402, -0.005902114324271679, -0.018480760976672173, -0.049592796713113785, -0.02527759037911892, -0.009480975568294525, -0.015300384722650051, 0.0062404521740973, -0.03067595697939396, 0.0067178839817643166, 0.020435599610209465, -0.014059813693165779, 0.015548499301075935, -0.0014445142587646842, 0.03233005106449127, -0.06327667832374573, 0.012571127153933048, -0.022706223651766777, -0.001285683480091393, 0.045532744377851486, -0.004676579497754574, -0.023909201845526695, -0.07127648591995239, 0.02670612744987011, -0.024300169199705124, 0.0009355978691019118, -0.029743647202849388, -0.016029691323637962, -0.01488686166703701, -0.036841221153736115, -0.05284084007143974, 0.04035993665456772, -0.07410348951816559, -0.012067380361258984, -0.05028450861573219, -0.013195172883570194, -0.05109652131795883, 0.06177295744419098, -0.025247516110539436, -0.007571246940642595, -0.011548595502972603, 0.03251050040125847, -0.033382657915353775, -0.04279596731066704, -0.019623590633273125, 0.05482575297355652, -0.014262815937399864, -0.025743743404746056, 0.018992025405168533, 0.03476608544588089, -0.029307568445801735, -0.0001569511223351583, 0.050104063004255295, 0.04189373180270195, -0.017909346148371696, 0.0007532713934779167, -0.0758478045463562, -0.02070626989006996, 0.006537437438964844, -0.0005775237805210054, -0.03560816869139671, -0.028781265020370483, -0.006819385569542646, -0.02437535487115383, -0.02314230240881443, 0.02220999449491501, -0.01421770453453064, -0.049803316593170166, 0.002725498517975211, 0.025713669136166573, -0.02915719524025917, 0.005379570182412863, -0.010308023542165756, -0.004135239403694868, 0.013292914256453514, 0.013082393445074558, -0.010563656687736511, 0.0366908498108387, 0.0546753816306591, 0.03765323385596275, 0.05524679645895958, -0.010653880424797535, 0.0013157579815015197, -0.05025443434715271, 0.07362229377031326, -0.0035093144979327917, -0.030751142650842667, 0.0028326387982815504, 0.014856786467134953, 0.02649560570716858, -0.03407436981797218, -0.05653999745845795, -0.009195268154144287, -0.016946962103247643, -0.018992025405168533, -0.01407485082745552, -0.026029450818896294, -0.018390536308288574, 0.03455556184053421, 0.0354577973484993, 0.07229901850223541, 0.02437535487115383, -0.032269902527332306, -0.017698824405670166, -0.040720827877521515, 0.030916552990674973, 0.04965294525027275, 0.021773913875222206, -0.009676460176706314, 0.025262553244829178, 0.028059476986527443, 0.013270358555018902, -0.017698824405670166, 0.010052390396595001, 0.03524727374315262, 1.3935873539594468e-05, 0.04210425540804863, -0.03425481915473938, 0.019999520853161812, 0.03193908557295799, -0.01957847736775875, -0.03220975399017334, 0.01873639225959778, -0.025954265147447586, -0.002669109031558037, -0.02243555337190628, 0.010826808400452137, -0.05443478748202324, 0.01101477351039648, 0.026255009695887566, 0.028390297666192055, -0.03239019960165024, 0.04556281864643097, 0.013187654316425323, -0.02915719524025917, -0.05073562636971474, 0.021067164838314056, -0.015232717618346214, 0.02120249904692173, -0.050615329295396805, -0.01670636609196663, -0.02539788745343685, -0.0328112430870533, 0.0022706221789121628, 0.016435695812106133, -0.0163153987377882, -0.01227790117263794, -0.02139798365533352, -0.02353326976299286, 0.03350295498967171, -0.011698967777192593, 0.01608983986079693, -0.006210377439856529, 0.0009849388152360916, -0.05446486175060272, 0.0062893228605389595, -0.0405704565346241, -0.006187821738421917, -0.03005943074822426, 0.0012734656920656562, 0.027954217046499252, -0.0016212017508223653, -0.0365104041993618, -0.037262264639139175, 0.034705936908721924, 0.01774393580853939, -0.04941235110163689, -0.020210042595863342, -0.0004990482120774686, 0.023322749882936478, 0.06207370012998581, 0.01996944658458233, 0.03978852182626724, 0.02954816445708275, -0.020871680229902267, 0.01703718490898609, 0.009029858745634556, 0.003947273828089237, 0.020751383155584335, -0.04466058313846588, 0.05596858263015747, -0.03467585891485214, 0.02201450988650322, 0.014653784222900867, 0.018525872379541397, -0.02499188296496868, 0.021052127704024315, -0.012871871702373028, 0.05443478748202324, -0.0022405479103326797, -0.006372027564793825, 0.005319421179592609, 0.027187317609786987, 0.018841654062271118, 0.026450494304299355, 0.003973588813096285, 0.01024787500500679, -0.015330459922552109, 0.008796781301498413, 0.013977108523249626, -0.007653952110558748, 0.016029691323637962, -0.022149845957756042, -0.026736201718449593, 0.04420946538448334, -0.014044776558876038, 0.016270287334918976, -0.05930684879422188, -0.028480520471930504, -0.040811050683259964, 0.004563800524920225, -0.0019341642037034035, 0.017262743785977364, 0.00022297397663351148, 0.028164738789200783, 0.007826880551874638, -0.049292050302028656, -0.01386432908475399, 0.013751550577580929, 0.004627708811312914, -0.0060900794342160225, 0.028300072997808456, -0.026841461658477783, -0.011646337807178497, -0.04420946538448334, 0.05263031646609306, 0.02374379150569439, 0.05341225489974022, -0.08499044179916382, 0.009059933014214039, -0.02536781318485737, -0.0208115316927433, -0.033172138035297394, 0.035517945885658264, 0.002377762459218502, 0.01784919574856758, 0.04129224270582199, 0.041653137654066086, 0.002691664732992649, -0.007341929245740175, 0.043397456407547, 0.01259368285536766, 0.020766420289874077, 0.011563632637262344, 0.016586069017648697, -0.021743839606642723, -0.022781409323215485, 0.009165193885564804, -0.026946723461151123, 0.02282652072608471, -0.009202786721289158, 0.0009017640841193497, -0.0019679979886859655, 0.012420754879713058, -0.0365104041993618, -0.012345569208264351, 0.013736512511968613, -0.0007842857157811522, -0.002278140978887677, 0.04610415920615196, -0.04475080594420433, 0.014841749332845211, -0.06393831968307495, 0.029202308505773544, 0.009556162171065807, 0.0324503518640995, -0.0076765078119933605, 0.03193908557295799, -6.549419777002186e-05, -0.004244259092956781, -0.028766227886080742, -0.020360413938760757, -0.0094358641654253, 0.023879127576947212, 0.0012198955519124866, -0.010962143540382385, -0.013977108523249626, -0.006913368124514818, 0.0015112420078366995, 0.0016954480670392513, -0.03882613778114319, 0.019232621416449547, -0.0066013457253575325, 0.017969494685530663, -0.023307712748646736, 0.04201402887701988, 0.018691280856728554, 0.0633368268609047, -0.04841989278793335, -0.01682666502892971, -0.030736105516552925, 0.001422898261807859, -0.02589411661028862, 0.013548547402024269, -0.027563249692320824, 0.042344849556684494, 0.018164977431297302, 0.02078145742416382, 0.04213432967662811, -0.014360558241605759, 0.03849531710147858, -0.029006823897361755, 0.018104828894138336, -0.0338638499379158, 0.019728850573301315, -0.011210257187485695, 0.03311198949813843, 0.05819409340620041, -0.00211461097933352, -0.04126216843724251, -0.027683546766638756, -0.03780360519886017, -0.0007180278771556914, 0.01482671219855547, 0.004969805479049683, -0.021082201972603798, -0.006804348435252905, -0.011744079180061817, -0.03524727374315262, 0.039487775415182114, 0.057502381503582, -0.0342247448861599, -0.06105116754770279, -0.021548354998230934, 0.02947297878563404, 0.034705936908721924, -0.008691521361470222, 0.0012527895160019398, 0.02926245704293251, -0.00016470470291096717, -0.033593181520700455, -0.015165050514042377, -0.03771338239312172, -0.023397935554385185, 0.010533582419157028, -0.010804252699017525, 0.02078145742416382, -0.02222503162920475, -0.019202547147870064, -0.011864377185702324, 0.062133848667144775, 0.012345569208264351, 0.0022424275521188974, -0.055818211287260056, 0.08529119193553925, -0.013157579116523266, 0.0275181382894516, 0.0018373619532212615, 0.02610463835299015, -0.015864280983805656, -0.001908788806758821, -0.0024379114620387554, 0.01905217580497265, 0.03801412507891655, 0.0025394128169864416, -0.0022668628953397274, -0.020360413938760757, -0.013954552821815014, -0.02836022339761257, -0.03729233890771866, 0.00046732902410440147, -0.02569863200187683, -0.018721355125308037, -0.011856858618557453, 0.018480760976672173, -0.012977132573723793, -0.00494724977761507, -0.030330101028084755, 0.027082057669758797, -0.055908434092998505, 0.028781265020370483, 0.015383089892566204, 0.037953976541757584, 0.09371203929185867, 0.013826736249029636, 0.004763043951243162, -0.02836022339761257, 0.012608719989657402, 0.0074471901170909405, -0.011127552948892117, 0.045412447303533554, -0.01998448371887207, 0.012721499428153038, 0.004548763390630484, 0.026931684464216232, 0.007537413388490677, 0.0041389986872673035, -0.024435505270957947, 0.021277684718370438, -0.012420754879713058, -0.0137590691447258, 0.023728754371404648, -0.011210257187485695, 0.015924429520964622, 0.027397839352488518, -0.026781313121318817, 0.006526159588247538, 0.015225199051201344, -0.009954649023711681, -0.015059789642691612, -0.020931828767061234, -0.007090055849403143, -0.011142590083181858, 0.018826616927981377, -0.01274405512958765, -0.005112659651786089, -0.02160850539803505, 0.0442696139216423, -0.0037517896853387356, -0.006905849557369947, -0.008180255070328712, -0.002672868315130472, 0.006165265571326017, -0.022646073251962662, -0.030300024896860123, -0.0675472542643547, -0.03239019960165024, -0.016751477494835854, 0.0175484512001276, 0.004330723080784082, 0.014571079052984715, 0.00973660871386528, -0.04607408493757248, -0.021653616800904274, -0.006180303171277046, -0.002644673455506563, -0.03906673192977905, -0.02345808409154415, 0.024224983528256416, 0.0012415115488693118, 0.0176386758685112, -0.016165025532245636, 0.015089863911271095, -0.004748006351292133, 0.0391569547355175, 0.010871919803321362, 0.004108923953026533, -0.006251730024814606, 0.03843516856431961, -0.046735722571611404, -0.01085688266903162, -0.03413452208042145, -0.03239019960165024, -0.0073908003978431225, 0.015074826776981354, -0.02007470652461052, 0.011458371765911579, 0.007924621924757957, 0.026074562221765518, 0.015089863911271095, 0.0031183462124317884, 0.02060100995004177, -0.02873615361750126, 0.021563392132520676, 0.016345473006367683, -0.014488374814391136, 0.02833014726638794, 0.02457083947956562, -0.027292579412460327, 0.009616310708224773, 0.033292435109615326, -0.032059382647275925, 0.021653616800904274, -0.02342800982296467, 0.03254057466983795, 0.0003289394953753799, 0.05494605004787445, 0.016540957614779472, -0.020631084218621254, -0.027788808569312096, 0.004680338781327009, -0.008022364228963852, -0.03611943498253822, 0.014706414192914963, 0.021638579666614532, 0.016646217554807663, -0.045923709869384766, 0.04577333852648735, 0.04893115907907486, -0.022781409323215485, 0.005086344201117754, -0.018495798110961914, -0.04369819909334183, 0.009706534445285797, 0.007112611550837755, -0.010511026717722416, -0.019713813439011574, -0.01714244671165943, 0.02008974365890026, -0.003210449358448386, -0.016345473006367683, -0.034615710377693176, -0.03813442587852478, 0.018330387771129608, 0.008526111021637917, 0.011247850954532623, 0.012007230892777443, -0.02559337206184864, 0.0014698895392939448, -0.0111576272174716, -0.013368100859224796, -0.027397839352488518, -0.032781168818473816, -0.01100725494325161, -0.01483423076570034, -0.020104780793190002, 0.037683308124542236, -0.02559337206184864, -0.0004478276241570711, -0.006819385569542646, -0.001958599779754877, -0.003090151585638523, 0.0027743696700781584, 0.008172736503183842, -0.02712716907262802, 0.013345545157790184, -0.026630939915776253, 0.017999568954110146, -0.05196867883205414, -0.0028815099503844976, 0.004552522674202919, -0.007281780242919922, 0.016646217554807663, 0.013518473133444786, 0.023503195494413376, -0.003016845090314746, 0.01151852123439312, -0.029909057542681694, 0.03233005106449127, 0.011548595502972603, 0.006063764449208975, -0.03575854003429413, 0.01917247287929058, -0.018315350636839867, 0.009511049836874008, -0.006360749714076519, -0.015082345344126225, -0.032781168818473816, -0.009849388152360916, -0.013135023415088654, 0.007653952110558748, 0.008714077062904835, 0.01732289232313633, -0.008285515941679478, -0.020946865901350975, -0.006932164542376995, -0.020435599610209465, 0.007450949400663376, -0.046525198966264725, -0.0024435503873974085, -0.01703718490898609, 0.0006184062222018838, 0.019097287207841873, 0.028495557606220245, -0.0018326628487557173, 0.0707351490855217, -0.012563608586788177, -0.01402221992611885, -0.03783367946743965, -0.011300480924546719, 0.03190901130437851, 0.0027236188761889935, -0.004285611677914858, -0.01619509980082512, -0.0026634701061993837, -0.027367765083909035, -0.012202715501189232, 0.009390752762556076, -0.022270143032073975, 0.014420706778764725, -0.05575806275010109, -0.036540478467941284, -0.008962191641330719, -0.004665301647037268, 0.03518712520599365, -0.025563297793269157, 0.012142566032707691, 0.013059837743639946, -0.01166889350861311, -0.001788490917533636, -0.017593562602996826, -0.014338002540171146, -0.01783415861427784, 0.014969565905630589, 0.008383257314562798, 0.08029882609844208, -0.01917247287929058, -0.04700639098882675, -0.018270239233970642, 0.008165217936038971, -0.0009337182273156941, -0.01550338789820671, -0.03957799822092056, -0.015608648769557476, -0.02132279798388481, 0.027803845703601837, 0.041833583265542984, -0.01467633992433548, -0.011744079180061817, -0.001966118346899748, -0.034615710377693176, 0.030330101028084755, -0.025758780539035797, 0.027292579412460327, 0.030615808442234993, 0.014796637929975986, 0.014119962230324745, -0.033292435109615326, -0.05584828555583954, 0.013285395689308643, 0.01290194597095251, 0.005041232332587242, -0.007984771393239498, -0.013691401109099388, -0.020570935681462288, -0.017879270017147064, -0.04854018986225128, 0.019488254562020302, 0.01957847736775875, 0.018616095185279846, 0.0008608816424384713, -0.019488254562020302, -0.005011158064007759, 0.03864569216966629, -0.02007470652461052, -0.002605200745165348, -0.043397456407547, 0.010172688402235508, 0.022555850446224213, -0.018721355125308037, -0.014488374814391136, 0.014104925096035004, 0.0014811675064265728, -0.017398079857230186, 0.04138246551156044, 0.04475080594420433, 0.01392447855323553, -0.005966022610664368, -0.040209561586380005, 0.014871823601424694, 0.0028777506668120623, 0.003061956726014614, 0.032961614429950714, -0.001519700395874679, 0.01989426091313362, 0.023367861285805702, -0.027172280475497246, 0.007353207096457481, -0.0019510810961946845, 0.00942834559828043, -0.016841702163219452, 0.0053269402123987675, 0.011999712325632572, -0.00524799432605505, -0.041532840579748154, -0.009962167590856552, 0.005958504043519497, 0.021488206461071968, 0.006270526442676783, -0.010999736376106739, -0.0012471505906432867, 0.025262553244829178, 0.09016325324773788, -0.033382657915353775, 0.02957823872566223, 0.014916935935616493, 0.005390848033130169, 0.020315302535891533, -0.03759308531880379, -0.036450255662202835, 0.00733816996216774, -0.03581869229674339, -0.01295457687228918, -0.023608457297086716, -0.018104828894138336, 0.002652192022651434, 0.02436031773686409, -0.020450638607144356, -0.01227790117263794, 0.02915719524025917, -0.00404877495020628, -0.005033713765442371, 0.019804036244750023, 0.03314206376671791, -0.024300169199705124, -0.1201174184679985, -0.04598386213183403, 0.03648032993078232, 0.014240260235965252, 0.008736632764339447, 0.004127720836549997, 0.03753293678164482, 0.028991786763072014, -0.022916743531823158, -0.013653808273375034, 0.049502573907375336, -0.028901562094688416, -0.0062178960070014, -0.03100677579641342, 0.015428201295435429, -0.04911160469055176, 0.0038081794045865536, -0.009699015878140926, 0.03927725553512573, -0.026119675487279892, -0.030660919845104218, -0.009608792141079903, 0.019037136808037758, 0.010443358682096004, -0.03825472295284271, 0.01660110615193844, 0.010954624973237514, 0.015924429520964622, 0.0015262792585417628, 0.006762995850294828, -0.022164883092045784, 0.011856858618557453, 0.020751383155584335, 0.0014999640407040715, -0.048570264130830765, -0.019939372316002846, -0.0235483068972826, 0.0023570863995701075, 0.02323252521455288, 0.005631444044411182, 0.024420468136668205, -0.050916071981191635, 0.010939587838947773, -0.02049575001001358, 0.027999328449368477, -0.042254626750946045, 0.007932140491902828, -0.03494653105735779, 0.005375810898840427, 0.009541125036776066, 0.010375691577792168, -0.009924573823809624, 0.013360582292079926, 0.010541100986301899, -0.00029322606860660017, 0.005360773764550686, 0.01034561637789011, -0.006481047719717026, 0.018180014565587044, -0.02833014726638794, -0.0015901874285191298, 0.04060053080320358, -0.011751597747206688, -0.028315110132098198, -0.019112324342131615, -0.013443286530673504, -0.005405885633081198, 0.016751477494835854, -0.03028498776257038, -0.044510211795568466, -0.035337500274181366, 0.03515705093741417, 0.0007528014830313623, 0.015315422788262367, 0.006902090273797512, -0.008962191641330719, 0.03843516856431961, 0.03611943498253822, -0.034495413303375244, 0.00404877495020628, 0.04730713739991188, -0.062434595078229904, 0.018315350636839867, 0.017503339797258377, 0.010526063852012157, 0.0329916886985302, 0.05371299758553505, 0.008601297624409199, -0.005774297751486301, 0.017277780920267105, 0.01514249388128519, -0.020345376804471016, 0.00032471027225255966, -0.004575078375637531, -0.024285132065415382, -0.015759021043777466, 0.010586212389171124, 0.01392447855323553, 0.02536781318485737, -0.0164958443492651, 0.023082153871655464, -0.0021841581910848618, -0.046645499765872955, -0.0034416469279676676, 0.018014606088399887, -0.0017208234639838338, 0.0009332483168691397, 0.006199099589139223, 0.008571223355829716, -0.022300217300653458, 0.01228541973978281, 0.02772865816950798, -0.01663118042051792, 0.01700711064040661, -0.02405957318842411, 0.028886524960398674, 0.058675285428762436, 0.021999472752213478, 0.004962286911904812, 0.021172424778342247, -0.0012875631218776107, 0.025322701781988144, -0.009548643603920937, 0.02393927611410618, -0.012962095439434052, -0.0075073386542499065, 0.002725498517975211, 0.05160778388381004, -0.037262264639139175, -0.009195268154144287, 0.014180111698806286, -0.016586069017648697, -0.0037461507599800825, -0.012315494008362293, -0.027879031375050545, 0.015443239361047745, 0.04493125528097153, 0.009623829275369644, -0.031969159841537476, 0.008202810771763325, 0.006150228437036276, 0.031457893550395966, 0.031157147139310837, 0.0016728922491893172, -0.0293677169829607, 0.012014749459922314, 0.020014557987451553, -0.043397456407547, -0.018525872379541397, 0.008744151331484318, 0.008751669898629189, -0.012616238556802273, -0.005435959901660681, 0.006969757843762636, 0.002291298471391201, 0.00876670703291893, 0.010796734131872654, -0.03028498776257038, 0.004503651522099972, 0.0021841581910848618, 0.01571390964090824, 0.05605880543589592, -0.0034209706354886293, -0.003909680526703596, 0.026330195367336273, -0.023728754371404648, -0.011563632637262344, 0.002834518440067768, -0.001097718020901084, -0.005304384045302868, -0.018180014565587044, -0.029818834736943245, 0.02894667536020279, -0.0015676316106691957, 0.027909105643630028, 0.003189773065969348, 0.017668750137090683, 0.027382802218198776, -0.0070787775330245495, 0.05729186162352562, 0.003981107380241156, 0.01213504746556282, -0.0030262432992458344, -0.00703742541372776, 0.007759212516248226, -0.012232789769768715, 0.013541028834879398, -0.0017527774907648563, 0.020044632256031036, 0.03873591497540474, 0.015473313629627228, 0.02649560570716858, 0.02536781318485737, 0.033292435109615326, 0.021999472752213478, -0.012255345471203327, 0.03109699860215187, 0.013007206842303276, -0.017413116991519928, -0.054073892533779144, 0.005172808188945055, 0.05299121141433716, 0.0013411332620307803, -0.020976940169930458, -0.043186936527490616, 0.018180014565587044, 0.007695304229855537, -0.023879127576947212, -0.005526183173060417, 0.025518184527754784, 0.0012189557310193777, 0.00017610010399948806, -0.016977036371827126, 0.023518232628703117, 0.00040295085636898875, -0.0416230633854866, -0.012150084599852562, 0.02792414277791977, -0.013315469957888126, -0.017368005588650703, -0.013375619426369667, -0.0011400103103369474, 0.011172664351761341, 0.014443262480199337, 0.001507482724264264, -0.008383257314562798, 0.019653664901852608, -0.014924454502761364, 0.022495701909065247, 0.020420562475919724, -0.014631228521466255, -0.015969542786478996, 0.011375667527318, 0.0058419653214514256, -0.008165217936038971, -0.026164786890149117, 0.00422922195866704, -0.015022196806967258, -0.011074922978878021, -0.005195364356040955, 0.052239350974559784, 0.03078121691942215, -0.004582596942782402, 0.016345473006367683, 0.02129272185266018, 0.010894475504755974, 0.005353255197405815, 0.03028498776257038, -0.017398079857230186, -0.01714244671165943, 0.007548691239207983, -0.005593850743025541, -0.006274285726249218, 0.0010074946330860257, 0.01896195113658905, -0.023713717237114906, 0.022766372188925743, 0.037262264639139175, 0.023668605834245682, 0.0026785072404891253, -0.049803316593170166, 0.023894164711236954, 0.027397839352488518, -0.0003388076729606837, 0.008563704788684845, -0.03371347859501839, -0.002445430029183626, 0.026239972561597824, 0.027292579412460327, -0.0005178447463549674, -0.01619509980082512, 0.007924621924757957, 0.006394583731889725, 0.03464578464627266, 0.0006348532042466104, 0.003095790510997176, 0.01945818029344082, 0.014112443663179874, 0.02954816445708275, 0.004029978532344103, -0.010826808400452137, 0.0013063596561551094, -0.018826616927981377, -0.012969614006578922, 0.025097142904996872, -0.017894307151436806, -0.002392799826338887, -0.001800708705559373, 0.03395407274365425, 0.004714172799140215, 0.02894667536020279, 0.03293154016137123, 0.0016644337447360158, 0.027051983401179314, -0.006142709869891405, 0.0019849147647619247, 3.8547597114302334e-07, 0.00590963289141655, 0.025262553244829178, -0.0268113873898983, 0.028059476986527443, 0.02896171249449253, 0.032570648938417435, -0.02966846153140068, 0.022164883092045784, 0.002509338315576315, 0.017804084345698357, -0.033683404326438904, 0.009841869585216045, -0.025247516110539436, -0.011067403480410576, 0.0018533390248194337, -0.006184062454849482, 0.004849507939070463, -0.0025112179573625326, -0.007819361053407192, 0.011480927467346191, -0.03341273218393326, -0.01805971749126911, 0.007473505102097988, -0.01681162789463997, 0.008082512766122818, 0.008405813947319984, 0.021232573315501213, -0.006755477283149958, -0.030104542151093483, 0.014856786467134953, 0.0025224960409104824, 0.005390848033130169, 0.004864545073360205, 0.021758876740932465, 0.00334954378195107, 0.0019473216962069273, -0.006702846847474575, -0.05425433814525604, 8.470191824017093e-05, -0.04742743447422981, 0.01744319126009941, -0.010157651267945766, -0.04457036033272743, 0.04875070974230766, 0.02211976982653141, 0.01467633992433548, -0.026255009695887566, -0.011548595502972603, 0.02386409044265747, -0.02527759037911892, 0.006274285726249218, -0.010488470084965229, -0.02975868619978428, 0.08462955057621002, -0.01723266951739788, -0.014871823601424694, -0.0031803748570382595, -0.03133759647607803, 0.04517184942960739, -0.009247899055480957, -0.012089936062693596, -0.024706175550818443, 0.031397745013237, 0.01857098378241062, 0.008225366473197937, -0.012819241732358932, 0.004736728500574827, 0.007962214760482311, -0.02121753618121147, -0.019307807087898254, 0.023879127576947212, 0.031247371807694435, 0.008375738747417927, 0.026525679975748062, 0.020059669390320778, 0.0050487513653934, -0.005255513358861208, 0.013969589956104755, 0.0016212017508223653, -0.010074946098029613, -0.006417139433324337, 0.028300072997808456, 0.046946242451667786, -0.007736656814813614, -0.0350969024002552, -0.041532840579748154, 0.013338026590645313, -0.028420371934771538, 0.007751693949103355, -0.027758732438087463, 0.058254241943359375, -0.018225127831101418, -0.011729042045772076, 0.022179920226335526, 0.01702214777469635, 0.009300529025495052, 0.02272126078605652, -0.010511026717722416, 0.012180158868432045, -0.005872039590030909, 0.0042555369436740875, 0.008849412202835083, 0.014691377058625221, 0.007356966380029917, -0.012390680611133575, 0.004484855104237795, 0.0005314722075127065, 0.004898378625512123, -0.0007387041114270687, 0.0008801480871625245, 0.02172880247235298, 0.017909346148371696, 0.027668509632349014, -0.019413068890571594, -0.0008486638544127345, -0.049171753227710724, -0.0043871128000319, -0.004315685946494341, -0.03966822102665901, -0.019909298047423363, 0.0010845605283975601, -0.01682666502892971, 0.04005919024348259, -0.045713189989328384, 0.010751621797680855, -0.01681162789463997, -0.013112467713654041, 0.021172424778342247, -0.005830687470734119, 0.0011108756298199296, 0.031638339161872864, 0.007774249650537968, 0.04372827708721161, 0.00017539523832965642, -0.003268718719482422, -0.030134616419672966, 0.0031296242959797382, 0.006586308125406504, -0.00846596248447895, 0.028600817546248436, -0.0060412087477743626, -0.02162354253232479, 0.024600913748145103, 0.0023834016174077988, 0.015668798238039017, 0.05064540356397629, 0.029292531311511993, -0.026134712621569633, -0.00346420262940228, -0.009811795316636562, 0.045021478086709976, 0.022961854934692383, 0.01742815412580967, -0.025006920099258423, 0.005687833763659, -0.006864496972411871, 0.009608792141079903, 0.012375643476843834, -0.013368100859224796, -0.01130799949169159, 0.0019454420544207096, 0.009090007282793522, 0.024646025151014328, 0.013804180547595024, -0.020315302535891533, 0.03479615971446037, 0.026585828512907028, 0.002045063767582178, 0.026014413684606552, 0.0010958383791148663, 0.03617958351969719, 0.0011982795549556613, -0.011999712325632572, 0.01244331058114767, 0.015172569081187248, 0.0026879054494202137, 0.02700687199831009, -0.012601201422512531, 0.02160850539803505, 0.018180014565587044, -0.02894667536020279, 0.013232765719294548, -0.017683787271380424, -0.02233029156923294, 0.011029810644686222, 0.009044895879924297, -0.004187869373708963, 0.01762363687157631, 0.003451045136898756, 0.00741711538285017, -0.015864280983805656, -0.015180087648332119, 0.010127576999366283, 0.010563656687736511, 0.026961760595440865, -0.014150036498904228, -0.003451045136898756, 0.004447261802852154, -0.023473121225833893, 0.0039698295295238495, -0.019428106024861336, 0.029713572934269905, 0.004375834949314594, -0.002413475885987282, -0.02090175449848175, -0.0029416587203741074, 0.022585924714803696, 0.005007398780435324, -0.009511049836874008, -0.022886669263243675, -0.02386409044265747, -0.0027123410254716873, -0.009443382732570171, 0.011443334631621838, -0.02720235474407673, -0.005236716475337744, 0.014616191387176514, 0.02518736571073532, -0.015443239361047745, -0.012691425159573555, -0.0098794624209404, -0.001233992981724441, 0.015368052758276463, 0.010834326967597008, 0.007413356099277735, -0.020029595121741295, -0.003360821632668376, -0.013510954566299915, -0.025833968073129654, -0.025112180039286613, 0.0008153000380843878, -0.01289442740380764, 0.01714244671165943, -0.011398223228752613, 0.009450901299715042, 0.013901922851800919, -0.0031446614302694798, 0.009052414447069168, 0.008736632764339447, 0.018931876868009567, 0.00741711538285017, 0.0188717283308506, 0.012932021170854568, 0.00023765877995174378, -0.013225247152149677, 0.02211976982653141, 0.0216987282037735, 0.0020657400600612164, 0.054494936019182205, 0.012811723165214062, -0.013510954566299915, 0.05678059533238411, 0.005086344201117754, -0.04420946538448334, -0.020961903035640717, -1.2790459550160449e-05, 0.007281780242919922, -0.030254913493990898, -0.003013085573911667, -0.0016315398970618844, -0.018465721979737282, 0.006823144853115082, -0.016676291823387146, 0.004176591522991657, -0.006514881271868944, 0.00892459787428379, 0.023623494431376457, 0.031036850064992905, -0.00756748765707016, 0.0007006410742178559, 0.004676579497754574, -0.03494653105735779, -0.014616191387176514, 0.0010995976626873016, 0.0008270478574559093, 0.0366908498108387, -0.012044823728501797, 0.0014755285810679197, 0.014962047338485718, -0.004033737815916538, 0.013044800609350204, 0.013428249396383762, 0.02945793978869915, 0.01599961705505848, -0.05103636905550957, -0.0020976942032575607, 0.007680267095565796, -0.0036183344200253487, 0.006924645975232124, 0.0018138663144782186, -0.022961854934692383, -0.008947153575718403, 0.029187269508838654, -0.05569791421294212, 0.037352487444877625, 9.797697566682473e-05, 0.0016042848583310843, -0.03849531710147858, 0.04700639098882675, 0.022871632128953934, 0.03302176669239998, -0.0164958443492651, 0.006281804293394089, 0.027097094804048538, 0.006943442393094301, -0.020976940169930458, -0.04207418113946915, 0.03636002913117409, -0.04105164855718613, -0.007924621924757957, -0.02845044620335102, -0.014510930515825748, 0.011706486344337463, -0.02333778701722622, -0.03476608544588089, -0.004627708811312914, 0.018390536308288574, -0.016781553626060486, 0.028089553117752075, -0.017774010077118874, -0.004879582207649946, -0.001411620294675231, -0.012465866282582283, -0.011127552948892117, 0.008563704788684845, -0.007394559681415558, -0.011127552948892117, 0.011135071516036987, 0.0169319249689579, 0.0249618086963892, -0.012871871702373028, 0.01751837693154812, -0.039217106997966766, 0.03223982825875282, -0.013307951390743256, -0.022255105897784233, 0.0031409021466970444, -0.006338194012641907, 0.019834110513329506, -0.0006818445399403572, -0.018886765465140343, -0.0029491775203496218, 0.009977204725146294, -0.037352487444877625, 0.006796829402446747, 0.0014031619066372514, -0.021849099546670914, -0.00677803298458457, 0.04893115907907486, 0.035006679594516754, -0.016796590760350227, -0.020435599610209465, 0.011405741795897484, -0.01640562154352665, -0.009165193885564804, 0.02986394613981247, 0.013022243976593018, 0.0379239022731781, 0.011924526654183865, 0.0028082034550607204, 0.03275109454989433, -0.008668964728713036, 0.023578383028507233, 0.022074658423662186, 0.013751550577580929, 0.004857026506215334, 0.024630988016724586, 0.026149749755859375, 0.030721068382263184, -0.016059765592217445, 0.014638747088611126, -0.03765323385596275, 0.02620989829301834, -0.013841773383319378, -0.009789238683879375, -0.003646529046818614, 0.028931638225913048, 0.055306944996118546, 0.025442998856306076, -0.02445054240524769, 0.031969159841537476, -0.004499892238527536, -0.038465242832899094, 0.03320221230387688, 0.010059908963739872, 0.0419839546084404, 0.01390944141894579, -0.004345760680735111, 0.0023119747638702393, -0.013150060549378395, 0.001879654242657125, 0.022164883092045784, -0.013480880297720432, -0.031066924333572388, 0.00463898666203022, 0.0020093503408133984, 0.010029834695160389, -0.007244187407195568, 0.002731137443333864, -0.004060053266584873, -0.0008590019424445927, 0.001858038129284978, -0.008112587966024876, 0.009353158995509148, 0.05323180556297302, 0.021743839606642723, 0.010270430706441402, 0.011856858618557453, 0.003932236693799496, 0.0018937515560537577, -0.02679635025560856, -0.03473601117730141, -0.01845068484544754, -0.0338638499379158, -0.030916552990674973, 0.019533365964889526, 0.009383234195411205, -0.019819073379039764, 0.007251705974340439, -0.005526183173060417, -0.010714028961956501, 0.013525991700589657, -0.007575006224215031, 0.0012875631218776107, 0.02466106228530407, 0.005687833763659, 0.010593730956315994, -0.025412924587726593, -0.0004262115980964154, -0.002366484608501196, -0.025112180039286613, 0.03169848769903183, -0.010142614133656025, 0.011450853198766708, -0.00710885226726532, 0.01392447855323553, -0.025608409196138382, 0.006954720709472895, 0.002834518440067768, -0.041833583265542984, 0.03987874463200569, -0.02132279798388481]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
" or baseline>
Response B:
<the other response>
FIRST provide a one-sentence comparison of the two responses and explain \\
which you feel is more helpful. SECOND, on a new line, state only ""A"" or \\
""B"" to indicate which response is more helpful. Your response should use \\
the format:
Comparison: <one-sentence comparison and explanation>
More helpful: <""A"" or ""B"">
When using GPT-4 for evaluation, we randomly sampled 100 queries from the test set. And ask GPT-4 to compare the two
responses. To minimize the impact of response position on comparison, we swapped the positions of the two responses and
evaluated them separately. If the results of the two evaluations are inconsistent, we set the final result as a “Tie”.
C. Additional Experiments
C.1. Varying the Reference Model
We conduct experiments to assess the impact of distribution shift by varying the reference model. The results are listed in
Table 9 and Table 10. Llama2-7B-SFT(Safe) and Codellama13B-SFT are models that are closer to the preference dataset in
the Safe-RLHF and APPS dataset, respectively. The results indicate that DPO is more affected by the distribution shift than
PPO.
14
Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study
Method Reference Model Avg. Pass@5
DPO Codellama-13B-Pretrain 0.24%
DPO Codellama-13B-SFT 12.8%
PPO Codellama-13B-Pretrain 13.8%
PPO Codellama-13B-SFT 15.1%
Table 9. Results of changing the reference model on APPS dataset. Codellama-13B-SFT is closer to the preference dataset than Codellama-
13B-Pretrain. DPO is more affected by the distribution shift than PPO.
Method Reference Model ∆Help.↑Harm. ↓ S.R.↑
DPO Llama2-7B-SFT(Alpaca) -4.19 -0.97 55.4%
DPO Llama2-7B-SFT (Safe) -1.62 -3.5 71.8%
PPO Llama2-7B-SFT(Alpaca) 1.69 -12.08 99.5%
PPO Llama2-7B-SFT (Safe) 4.47 -12.33 99.6%
Table 10. Results of changing the reference model on Safe-RLHF dataset. Llama2-7B-SFT(Safe) is closer to the preference dataset than
Llama2-7B-SFT(Alpaca). DPO is more affected by the distribution shift than PPO.
C.2. Varying β
In Table 11, We explore the impact of βon the HH-RLHF and APPS datasets. On the HH-RLHF dataset, we evaluate the
model using the OpenAssistant reward metric. On the APPS dataset, we report the average pass@5 score. The results
indicate that having too large βmay harm the performance of both DPO and PPO. A βvalue of 0.1 consistently performs
well across various models and tasks.
β 0 0.05 0.1 (default) 0.2
HH-RLHF, Llama-7B
PPO 0.705 0.720 0.718 0.629
DPO N/A 0.609 0.611 0.597
APPS, Codellama-13B
PPO 13.0% 14.1% 15.1% 14.9%
DPO N/A 12.56% 12.0% 12.32%
Table 11. Results of changing the βparameter on HH-RLHF and APPS dataset. The results indicate that having too large βmay harm the
performance of both DPO and PPO. A βvalue of 0.1 consistently performs well across various models and tasks.
C.3. Varying Preference Dataset
We train the model on a subset of the HH-RLHF preference dataset. The results are shown in Table 12. The results suggest
that the performance of both PPO and DPO may be affected by the extent of coverage in the preference dataset. When
training on the helpful-base subset, the performance of DPO has dropped to be similar to that of the SFT model.
We also evaluate PPO on the HH-RLHF dataset by filtering dual-unsafe and dual-safe preference pairs. The results are
listed in","[0.037653591483831406, -0.013260675594210625, 0.09689874947071075, 0.009201285429298878, 0.006495025008916855, 0.002836087718605995, 0.008850202895700932, 0.01629607565701008, 0.01576945185661316, -0.008638090454041958, 0.003865563776344061, -0.01380924228578806, -0.033557627350091934, 0.0013412445550784469, -0.00468475604429841, -0.035400811582803726, 0.04479226469993591, -0.049414850771427155, -0.038121700286865234, 0.04417787119746208, -0.008316264487802982, -0.006132971029728651, -0.02261555939912796, 0.005258921999484301, 0.031919244676828384, -0.016574015840888023, 0.009874192997813225, -0.005738003179430962, 0.02030426636338234, -0.046693962067365646, 0.03060268424451351, -0.030661199241876602, -0.010817727074027061, -0.033089518547058105, -0.009757165797054768, 0.017905203625559807, -0.0048858970403671265, 0.06050320342183113, -0.015710938721895218, 0.005035838577896357, -0.02036278136074543, -0.02138677053153515, -0.03326505795121193, -0.0152574572712183, -0.012470739893615246, 0.03464013338088989, 0.04019893705844879, -0.015959622338414192, 0.031217079609632492, 0.02213282138109207, -0.042159147560596466, 0.05134580284357071, -0.009691338054835796, -0.006652280688285828, 0.03098302334547043, -0.014942945912480354, 0.015038030222058296, -0.025848442688584328, 0.04011116549372673, -0.0439145602285862, -0.03668811172246933, -0.013553244061768055, -0.0011501606786623597, -0.009018429554998875, -0.005233322270214558, -0.035225268453359604, -0.10333526134490967, 0.014196895062923431, -0.007383702322840691, -0.007570214569568634, -0.013648329302668571, 0.017832061275839806, 0.04242245852947235, -0.0008082209969870746, -0.016237562522292137, -0.00717890402302146, 0.059157390147447586, 0.004275159910321236, 0.025906957685947418, 0.012046515941619873, -0.012273256666958332, 0.034172020852565765, 0.0013129019644111395, -0.04224691912531853, 0.011468692682683468, 0.007412958890199661, -0.021064944565296173, -0.02593621425330639, -0.04900525510311127, -0.04180806502699852, -0.023624921217560768, -0.0406377911567688, -0.005467377137392759, 0.01648624613881111, 0.04590402543544769, -0.02764774113893509, 0.006385311484336853, -0.014577235095202923, -0.008140724152326584, 0.034727904945611954, -0.0036863654386252165, -0.00844060629606247, -0.004344644956290722, -0.002525233430787921, 0.05465183034539223, -0.007533643860369921, 0.023039784282445908, 0.05078992247581482, -0.017846690490841866, 0.004878582898527384, -0.044909294694662094, 0.02777939662337303, -0.08344058692455292, 0.03221181407570839, -0.013392332009971142, -0.020128725096583366, -0.030690455809235573, -0.03917494788765907, 0.006988734472543001, -0.03130485117435455, -0.036337029188871384, -0.0070326197892427444, 0.020567579194903374, -0.02318606898188591, 0.015696309506893158, -0.007116733118891716, 0.031977757811546326, -0.05667055398225784, 0.009281741455197334, -0.03683439642190933, -0.011497949250042439, 0.024078402668237686, 0.018402570858597755, -0.03387945517897606, -0.046635448932647705, 0.040403734892606735, -0.015974249690771103, 0.00847717747092247, -0.040491506457328796, 0.0006998791359364986, -0.029798120260238647, -0.062492672353982925, -0.040315963327884674, 0.05032181367278099, -0.0577530600130558, -0.028042709454894066, -0.010130191221833229, -0.011724689975380898, -0.033089518547058105, 0.07203041017055511, -0.02268870174884796, 0.007994439452886581, -0.02144528552889824, 0.005650232546031475, -0.02710648812353611, -0.009684023447334766, 0.002367977751418948, 0.008499120362102985, -0.018212400376796722, -0.033674657344818115, -0.03604446351528168, 0.019558217376470566, -0.01819777302443981, -0.01071532815694809, 0.021328257396817207, 0.04110589995980263, -0.046723220497369766, 0.01591573655605316, -0.10117024928331375, -0.02365417778491974, 0.00851374864578247, 0.029666464775800705, -0.043241653591394424, -0.05825042724609375, -0.0010797613067552447, -0.02540959045290947, -0.04081333056092262, -0.021225858479738235, -0.010122876614332199, -0.03557635098695755, 0.0032877405174076557, 0.024692798033356667, -0.024049146100878716, 0.016105907037854195, 0.0016904984368011355, -0.03385019674897194, -0.0006034229299984872, 0.012317141517996788, -0.01859273947775364, 0.003366368357092142, 0.04686950519680977, 0.025307191535830498, 0.08531302958726883, -0.010898184031248093, -0.02593621425330639, -0.047103557735681534, 0.05471034348011017, 0.048917483538389206, -0.042129889130592346, 0.01574019528925419, 0.023902861401438713, 0.001531414221972227, -0.005379606503993273, -0.061907533556222916, -0.03741953521966934, -0.02027500979602337, -0.03329431638121605, 0.003993562422692776, -0.027399057522416115, -0.028379162773489952, 0.029198354110121727, -0.0033188259694725275, 0.03844352439045906, 0.0159011073410511, -0.03396722301840782, -0.010525158606469631, -0.08730249851942062, 0.02151842601597309, 0.01985078491270542, 0.02881801500916481, 0.03332357481122017, 0.0057672602124512196, 0.04447044059634209, 0.01859273947775364, -0.014891746453940868, -0.011556463316082954, 0.03733176365494728, -0.0041764178313314915, 0.01521357148885727, -0.046050310134887695, 0.03045639954507351, 0.013897012919187546, 0.01635458879172802, -0.005690461024641991, 0.01353861577808857, -0.04224691912531853, 0.008989172987639904, -0.03516675531864166, -0.01633996143937111, -0.04751315340399742, -0.005730689037591219, 0.011768575757741928, 0.03452310338616371, -0.02265944518148899, 0.008418664336204529, 0.006893649697303772, -0.021211229264736176, -0.06857810169458389, 2.2171221644384786e-05, -0.004106932785362005, -0.0015789566095918417, -0.0104812728241086, 0.0013074163580313325, -0.024063775315880775, -0.05146283283829689, -0.004670127760618925, -0.01242685504257679, 0.01911936327815056, -0.0036863654386252165, 0.0012617025058716536, -0.03990636765956879, 0.04242245852947235, 0.033060260117053986, 0.016149790957570076, -0.02138677053153515, 0.018856052309274673, 0.007412958890199661, 0.005939144175499678, -0.048390861600637436, -0.02715037390589714, 0.0055917189456522465, 0.018358685076236725, 0.0035254526883363724, 0.024444114416837692, -0.0220304224640131, -0.012141600251197815, -0.008491805754601955, 0.030251601710915565, -0.023346981033682823, -0.038092441856861115, -0.013816555961966515, -0.005807488225400448, 0.03496195748448372, 0.010247218422591686, 0.03894089162349701, 0.020245753228664398, -0.00388019229285419, 0.027574598789215088, -0.007913983426988125, 0.017173781991004944, 0.011322407983243465, -0.03662959858775139, 0.0429198257625103, -0.028393790125846863, 0.004494586493819952, 0.030163832008838654, 0.021840251982212067, -0.04458746686577797, -0.010912812314927578, 0.0237419493496418, 0.02652135118842125, 0.035283785313367844, 0.01049590203911066, 0.020801633596420288, 0.04628436639904976, -0.028130479156970978, 0.01699824072420597, -0.0024667198304086924, -0.007979811169207096, -0.04610882326960564, -0.03382094204425812, 0.03782913088798523, -0.0064986818470060825, -0.00033325402182526886, -0.035254526883363724, -0.034669388085603714, 0.06810998916625977, -0.044880036264657974, -0.0036443087738007307, -0.01579870842397213, -0.035810407251119614, -0.04458746686577797, -0.020055582746863365, 0.021079573780298233, -0.0012114172568544745, -0.02213282138109207, -0.02871561609208584, 0.00847717747092247, -0.01976301521062851, -0.037595074623823166, 0.000619879923760891, 0.022264476865530014, 0.01973375864326954, 0.024531884118914604, -0.021606197580695152, -0.022995898500084877, -0.018929194658994675, 0.052925676107406616, 0.041456982493400574, 0.0668812021613121, -0.09543590247631073, -0.007069190964102745, -0.0015807851450517774, 0.008367464877665043, -0.025014622136950493, 0.024692798033356667, -0.028013451024889946, 0.04692801833152771, 0.028013451024889946, 0.020596835762262344, -0.0030664855148643255, 0.0020754090510308743, 0.03718547895550728, 0.014284665696322918, 0.01521357148885727, 0.00388019229285419, 0.024531884118914604, -0.06173199415206909, -0.009391454979777336, 0.01574019528925419, 0.002691631903871894, 0.016208305954933167, -0.01469426229596138, 0.02779402583837509, 0.030134575441479683, 0.021342886611819267, -0.030397886410355568, -0.05588061735033989, 0.010247218422591686, -0.033001746982336044, -0.012851079925894737, 0.010027791373431683, -0.022352248430252075, 0.0203188955783844, -0.09502630680799484, 0.029768863692879677, 0.0021686654072254896, 0.03908717632293701, -0.03104153834283352, 0.052808646112680435, -0.005149208940565586, -0.0038472781889140606, -0.050029244273900986, -0.021108830347657204, 0.026813920587301254, 0.013487416319549084, 0.013231419026851654, 0.010956697165966034, -0.03695142641663551, -0.02946166694164276, 0.007855469360947609, 0.00747878709807992, 0.0009065057965926826, -0.01857811212539673, -0.06863661110401154, 0.018841423094272614, -0.006129314191639423, 0.05435926094651222, 0.03502047061920166, 0.061263881623744965, -0.03402573987841606, -0.047776468098163605, -0.07875949144363403, -0.00962550938129425, -0.06910472363233566, 0.0001233131333719939, -0.01911936327815056, 0.01926564797759056, 0.028437675908207893, 0.017875947058200836, 0.026887062937021255, -0.02830602042376995, 0.035810407251119614, -0.02254241704940796, 0.014452893286943436, -0.017715033143758774, 0.005869659129530191, 0.01495025958865881, 0.04757167026400566, 0.035225268453359604, 0.00962550938129425, -0.04572848603129387, -0.013516672886908054, -0.01409449614584446, -0.006268284283578396, 0.03382094204425812, -0.003240198129788041, -0.02992977574467659, 0.00933294091373682, -0.046576935797929764, -0.015008773654699326, 0.04499706253409386, 0.06208307668566704, -0.004443387035280466, -0.06846107542514801, -0.03399648144841194, 0.0034486535005271435, 0.012924221344292164, -0.014584548771381378, 0.008045638911426067, 0.024019889533519745, -0.025614388287067413, -0.020260382443666458, -0.020699234679341316, -0.02028963901102543, -0.018826795741915703, 0.011146866716444492, -0.012573139742016792, -0.004567728843539953, 0.005185780115425587, -0.04414861649274826, -0.0026879748329520226, 0.03847278282046318, 0.004820069298148155, -0.0027300314977765083, -0.03320654481649399, 0.06623755395412445, -0.03660034388303757, 0.023610293865203857, -0.005723374895751476, 0.05152134597301483, -0.03785838931798935, -0.004542128648608923, 0.004370244685560465, -0.0034431677777320147, 0.020435921847820282, 0.0008114209631457925, 0.0030518569983541965, -0.023010527715086937, -0.016530130058526993, 0.011512577533721924, -0.04128144308924675, 0.008681976236402988, -0.034698646515607834, -0.02764774113893509, -0.012770622968673706, 0.026184897869825363, -0.0015158714959397912, 0.008916030637919903, -0.010144819505512714, 0.04136921092867851, -0.017261551693081856, 0.019967813044786453, -0.009705966338515282, 0.07039202749729156, 0.0754242092370987, 0.04871268570423126, 0.041047386825084686, -0.02264481596648693, 0.03905791789293289, -0.002786716679111123, -0.04309536889195442, 0.03677588328719139, -0.01857811212539673, 0.008206551894545555, -0.004980981815606356, 0.02315681241452694, 0.001703298301436007, 0.006970448885113001, 0.00479812640696764, 0.01499414537101984, -0.008689289912581444, -0.02652135118842125, 0.02834990620613098, 0.005145551636815071, 0.0035364239010959864, 0.011644233949482441, -0.014028668403625488, -0.022366875782608986, -0.0034139109775424004, -0.012894964776933193, 0.01042275968939066, -0.007972496561706066, -0.02492685243487358, -0.015418370254337788, 0.010868926532566547, -0.016135163605213165, -0.012031887657940388, -0.029842006042599678, 0.013041249476373196, -0.009691338054835796, 0.001093475497327745, -0.009347569197416306, 0.0019839813467115164, 0.012631652876734734, -0.034201279282569885, -0.054037436842918396, -0.07308366149663925, -0.002631289651617408, -0.04707430303096771, -0.0005508519825525582, -0.028935043141245842, 0.018329428508877754, -0.028101222589612007, -0.024166174232959747, -0.017100639641284943, 0.013333817943930626, -0.018329428508877754, -0.007142332848161459, -0.029256869107484818, 0.04125218465924263, -0.008418664336204529, 0.029520180076360703, -0.017261551693081856, 0.025014622136950493, -0.013962840661406517, 0.018841423094272614, -0.0016950698336586356, 0.004030133597552776, 0.016705671325325966, 0.038765352219343185, -0.026199525222182274, 0.002011409727856517, -0.0017115267692133784, -0.016632528975605965, -0.001002962002530694, 0.008930658921599388, -0.026726149022579193, 0.019880041480064392, 0.0067729651927948, 0.031363364309072495, -0.00155701395124197, -0.012631652876734734, 0.021664710715413094, 0.006410911213606596, 0.039818599820137024, 0.014584548771381378, -0.0036955082323402166, 0.010854298248887062, 0.026828547939658165, -0.03902866318821907, 0.023273838683962822, 0.04019893705844879, -0.03513750061392784, -0.006652280688285828, 0.004732298664748669, 0.0011958745308220387, 0.006663251668214798, 0.017334694042801857, -0.00664130924269557, -0.009493853896856308, -0.008330893702805042, -0.014335866086184978, -0.010378873907029629, -0.03148039057850838, -0.0022948356345295906, 0.03630777448415756, 0.00989613588899374, -0.025570502504706383, 0.03712696582078934, 0.020757747814059258, -0.03838501125574112, 0.017159152776002884, -0.010905497707426548, -0.0294470377266407, -0.0016264989972114563, -0.0018139258027076721, -0.030836740508675575, -0.008930658921599388, -0.017115268856287003, 0.03107079491019249, -0.021035687997937202, -0.013041249476373196, -0.0272381454706192, -0.031246336176991463, 0.04809829220175743, -0.036483313888311386, -0.0005362235242500901, 0.00993270706385374, 0.009552367962896824, 0.00537229236215353, -0.0020278666634112597, -0.01819777302443981, -0.026243411004543304, -0.03399648144841194, -0.037595074623823166, -0.035810407251119614, -0.03057342767715454, -0.014299294911324978, -0.03344060108065605, -0.04645990580320358, -0.0036662514321506023, -0.02249853126704693, -0.007840841077268124, 0.008586890995502472, -0.009164714254438877, 0.0007615928770974278, 0.009055000729858875, -0.02375657670199871, 0.008572262711822987, -0.04921005293726921, 0.007994439452886581, 0.014277352020144463, -0.009618195705115795, 0.01642773114144802, 0.019982440397143364, 0.028935043141245842, 0.006597423925995827, -0.011497949250042439, -0.03844352439045906, 0.0288033876568079, 0.04572848603129387, 0.008718546479940414, -0.04578699916601181, -0.0017508406890556216, -0.02197190746665001, 0.020611463114619255, -0.022322990000247955, -0.011081038974225521, -0.04312462359666824, -0.012792565859854221, -0.005814802832901478, -0.0014783861115574837, 0.03156816214323044, 0.016778813675045967, -0.01759800687432289, -0.022425388917326927, 0.004695727489888668, -0.0037558504845947027, 0.010890869423747063, -0.036454059183597565, -0.0036315089091658592, -0.018475713208317757, -0.0037924216594547033, 0.023551778867840767, 0.014182266779243946, 0.005851373542100191, 0.06729079782962799, 0.01638384722173214, -0.010678756982088089, -0.013970154337584972, -0.011541835032403469, 0.03563486784696579, -0.015652425587177277, -0.0012379313120618463, 0.02264481596648693, 0.011417493224143982, -0.05497365444898605, -0.03168518841266632, 0.03774135932326317, -0.011929487809538841, 0.01748097874224186, -0.06114685535430908, -0.04792274907231331, -0.013699528761208057, -0.011936802417039871, 0.010868926532566547, -0.004483615048229694, -0.0074605015106499195, 0.03054417110979557, -0.01041544508188963, 0.0031377992127090693, 0.005050466861575842, -0.022337619215250015, -0.016559388488531113, 0.01701286993920803, -0.004790812265127897, 0.0564657561480999, -0.0023259210865944624, -0.04701578617095947, -0.013465473428368568, -0.01152720581740141, -0.0034139109775424004, 0.002735517220571637, -0.046723220497369766, -0.0327969491481781, -0.0318022146821022, 0.03229958191514015, 0.0326506644487381, -0.01641310378909111, 0.022776471450924873, 0.029271496459841728, -0.034201279282569885, 0.030807482078671455, 0.015974249690771103, 0.027984194457530975, -0.0005357664194889367, 0.02492685243487358, 0.01018870435655117, -0.026989461854100227, -0.03232884034514427, -0.006143942475318909, 0.0046042995527386665, 0.014240780845284462, 0.010225275531411171, 0.008418664336204529, -0.04578699916601181, -0.014767404645681381, -0.022761844098567963, 0.02270333096385002, 0.013684900477528572, 0.030222345143556595, -0.007935925386846066, -0.01982152834534645, -0.018270915374159813, 0.01748097874224186, -0.015096544288098812, 0.04344645142555237, -0.010737271048128605, 0.021781738847494125, 0.05029255896806717, -0.007848154753446579, -0.02603861317038536, -0.015418370254337788, -0.013450845144689083, -0.029710350558161736, 0.020245753228664398, 0.052194252610206604, 0.013377702794969082, 0.009537738747894764, -0.02706260420382023, 0.01435780804604292, 0.00424224603921175, 0.0220304224640131, 0.01323873270303011, -0.011424806900322437, -0.008279694244265556, 0.011220009066164494, -0.02546810358762741, 0.01574019528925419, 0.038121700286865234, 0.018929194658994675, 0.010327674448490143, 0.01160034816712141, -0.016530130058526993, -0.0037448792718350887, -0.05942070111632347, -0.009252484887838364, 0.013692214153707027, 0.0024722053203731775, -0.0024557483848184347, -0.012807194143533707, 0.004809097852557898, 0.03940900042653084, 0.09485077112913132, -0.0310122799128294, 0.02823287807404995, 0.0007231932249851525, -0.00289277289994061, 0.011476006358861923, -0.0544762909412384, -0.027969567105174065, 0.010386188514530659, -0.017129896208643913, -0.010795784182846546, 0.01220011431723833, 0.021913394331932068, -0.02265944518148899, 0.020070211961865425, -0.006571824196726084, 0.007149647455662489, 0.004278817214071751, -0.034084253013134, -0.005178465973585844, 0.017612634226679802, 0.01856348291039467, -0.024166174232959747, -0.11942654103040695, -0.048332348465919495, 0.026316553354263306, -0.010342302732169628, 0.009391454979777336, -0.008001753129065037, 0.04736686870455742, 0.040345221757888794, -0.024078402668237686, 0.004618928302079439, 0.02596547082066536, -0.020640721544623375, 0.010700699873268604, -0.020509064197540283, -0.006388968788087368, -0.03999413922429085, -0.008696604520082474, 0.005986686795949936, 0.025687530636787415, -0.05245756730437279, -0.01587185077369213, -0.012807194143533707, 0.020216496661305428, 0.006926563568413258, -0.04388530179858208, 0.01585722342133522, 0.000637708290014416, -0.012017258442938328, -0.003512652823701501, 0.00749707268550992, -0.025263305753469467, 0.014803975820541382, 0.016968984156847, -0.008389406837522984, -0.04868343099951744, -0.016778813675045967, -0.018212400376796722, -0.024531884118914604, 0.0014674147823825479, 0.01873902417719364, 0.028613217175006866, -0.04081333056092262, 0.01631070487201214, -0.0030006575398147106, 0.017115268856287003, -0.06255118548870087, -0.01388238463550806, -0.01443095039576292, -0.017671149224042892, -0.007131361868232489, 0.019090106710791588, -0.04081333056092262, 0.012361027300357819, 0.004220303148031235, -0.01242685504257679, -0.0026824891101568937, 0.006052514538168907, -0.009267113171517849, 0.004436072893440723, -0.010269161313772202, 0.0030299145728349686, 0.02990051917731762, -0.025043878704309464, -0.013077820651233196, -0.026199525222182274, -0.009098886512219906, -0.009172027930617332, -0.0002713117573875934, -0.03566412255167961, -0.022293733432888985, -0.04739612713456154, 0.026682265102863312, 4.897097096545622e-05, 0.009947335347533226, -0.022820357233285904, 0.027442943304777145, 0.0012845593737438321, 0.02548273280262947, -0.07039202749729156, 0.013209476135671139, 0.044382669031620026, -0.022176707163453102, 0.01805148832499981, 0.016588645055890083, 0.02257167361676693, 0.010042420588433743, 0.033645398914813995, -0.018929194658994675, -0.02040666528046131, -0.013823870569467545, 0.0349327027797699, -0.00619148463010788, 0.006374340038746595, 0.008535691536962986, -0.020801633596420288, -0.018270915374159813, 0.005664861295372248, 0.014606491662561893, -0.013158276677131653, -0.0035711664240807295, 0.016734929755330086, -0.006220741663128138, -0.017905203625559807, -0.012295198626816273, 0.021006431430578232, 0.0026221468579024076, 0.03434756398200989, 0.0007273074588738382, 0.021752482280135155, -0.002474033972248435, 8.119923586491495e-05, 0.026199525222182274, 0.002022380940616131, 0.020509064197540283, -0.025014622136950493, 0.03148039057850838, 0.06676417589187622, 0.00795055367052555, 0.01135166548192501, 0.02883264422416687, -0.01582796685397625, 0.027413686737418175, -0.028920413926243782, 0.052808646112680435, 0.013085134327411652, 0.009442654438316822, -0.0005773660377599299, 0.052808646112680435, -0.014189581386744976, 0.0038107072468847036, 0.008111466653645039, 0.018856052309274673, -0.015535397455096245, -0.0013513016747310758, 0.024502627551555634, 0.007811584044247866, 0.042715027928352356, -0.002207065001130104, -0.011081038974225521, 0.013333817943930626, 0.011395550332963467, 0.03323580324649811, 0.033674657344818115, 0.012236685492098331, -0.005149208940565586, 0.0259508416056633, 0.019090106710791588, -0.025292562320828438, -0.009259798564016819, 0.005141894798725843, -0.0027446600142866373, -0.03267992287874222, -0.009457282721996307, -0.013706843368709087, 0.011059096083045006, 0.0075117009691894054, 0.0015103858895599842, -0.04350496456027031, 0.027267402037978172, 0.005489320028573275, 0.0022765500470995903, 0.008725861087441444, -0.017685776576399803, -0.03826798498630524, 0.04628436639904976, -0.018899938091635704, -0.012938850559294224, 0.01873902417719364, 0.0019675244111567736, 0.004487272351980209, -0.01633996143937111, -0.012317141517996788, 0.00792861171066761, 0.01809537410736084, 0.05087769404053688, 0.03569338098168373, 0.01752486452460289, 0.022922756150364876, -0.012280570343136787, 0.026828547939658165, 0.008945287205278873, 0.008418664336204529, 0.01387507002800703, 0.017261551693081856, 0.03741953521966934, -0.026682265102863312, 0.041018128395080566, 0.02988589182496071, 0.018504969775676727, 0.04730835556983948, 0.0035163098946213722, 0.0326506644487381, -0.0041252183727920055, 0.020070211961865425, 0.0037960787303745747, -0.017115268856287003, 0.014328551478683949, 0.03613223135471344, 0.01702749729156494, -0.05327675864100456, 0.008228493854403496, 0.05611467361450195, 0.01749560795724392, -0.004271502606570721, -0.020538322627544403, 0.028949672356247902, -0.012499997392296791, -0.026857806369662285, -0.0006861650035716593, 0.03297249227762222, -0.00023154068912845105, 0.02883264422416687, -0.009223227389156818, 0.013670272193849087, -0.009186657145619392, -0.03902866318821907, -0.01388238463550806, 0.03952603042125702, 0.005492976866662502, 0.0014399865176528692, -0.004980981815606356, -0.007332502864301205, -0.01472351886332035, -0.010291103273630142, 0.0042020175606012344, -0.006582795642316341, 0.03382094204425812, -0.01806611567735672, 0.005909887608140707, 0.02033352293074131, -0.020435921847820282, 0.04464598000049591, 0.00874048937112093, -0.004487272351980209, -0.015974249690771103, -0.023610293865203857, -0.022191334515810013, 0.015155058354139328, -0.009618195705115795, -0.011695433408021927, 0.04760092496871948, -0.003070142585784197, -0.009998534806072712, 0.006740051321685314, 0.009947335347533226, -0.008316264487802982, 0.01919250562787056, 0.011790517717599869, 0.0010852470295503736, -0.01105178240686655, 0.017086010426282883, -0.019616730511188507, -0.018212400376796722, -0.022147448733448982, 0.0065535386092960835, -0.01585722342133522, 0.00010588471923256293, 0.014613806270062923, 0.025658274069428444, 0.0036150517407804728, -0.05637798458337784, 0.03112930804491043, -0.002523405011743307, -0.012499997392296791, -0.0055441767908632755, 0.00013657014642376453, 0.0025928900577127934, 0.029534809291362762, 0.027457570657134056, -0.02998829074203968, -0.010525158606469631, 0.03499121591448784, -0.009610881097614765, 0.03259215131402016, 0.012507311068475246, 0.01758337765932083, 0.03291397541761398, 0.02150379866361618, 0.017144525423645973, -0.0068022217601537704, 0.00539057794958353, 0.005119951907545328, -0.014884431846439838, 0.0007204503635875881, 0.01417495310306549, -0.02200116589665413, -0.0069558206014335155, -0.001940096146427095, 0.009259798564016819, 0.004256874322891235, 0.03560560941696167, 0.030690455809235573, -0.017217667773365974, 0.007899354211986065, 0.01413838192820549, 0.006392625626176596, 0.008528376929461956, 0.004055733326822519, 0.03282620757818222, -0.02830602042376995, 0.02763311192393303, 0.020143354311585426, 0.04409009963274002, -0.0051382374949753284, 0.03674662858247757, 0.010773842222988605, 0.03221181407570839, -0.03510824218392372, -0.013194847851991653, -0.01582796685397625, 0.01298273541033268, -0.02432708628475666, 0.002978714881464839, 0.017217667773365974, -0.02249853126704693, 0.011322407983243465, -0.002715403214097023, -0.013436216861009598, -0.02706260420382023, 0.007442215923219919, 0.013911641202867031, -0.0008114209631457925, 0.011322407983243465, 0.024166174232959747, -0.0008402207167819142, -0.019528958946466446, -0.009281741455197334, -0.01929490454494953, -0.005895258858799934, 0.001123646623454988, -0.005438120570033789, 0.015242828987538815, 0.0021503798197954893, -0.013567873276770115, -0.042129889130592346, -0.0009334769565612078, -0.060269150882959366, 0.0316559337079525, -0.017817433923482895, -0.03990636765956879, 0.030339373275637627, 0.00665959483012557, 0.006147599313408136, -0.002483176765963435, 0.006213427521288395, 0.037009939551353455, 0.011022524908185005, -0.0015935850096866488, -0.009669395163655281, -0.016076648607850075, 0.07946165651082993, -0.01806611567735672, -0.02941778115928173, -0.011695433408021927, -0.005712403450161219, 0.025087764486670494, -0.008535691536962986, -0.016164420172572136, -0.020231124013662338, 0.01581333763897419, 0.012880336493253708, 0.01756875030696392, -0.007014334201812744, 0.012273256666958332, 0.002362492261454463, -0.013867755420506, -0.0069558206014335155, 0.0429198257625103, 0.0417788103222847, -0.00040548190008848906, -0.0023186069447547197, 0.02314218319952488, -0.0053393784910440445, 0.006421882659196854, 0.03390870988368988, 0.01578408107161522, -0.005258921999484301, -0.03563486784696579, 0.009274427779018879, 0.034142766147851944, -0.012997363694012165, -0.029739607125520706, -0.03054417110979557, -0.0032273982651531696, -0.028949672356247902, -0.01863662526011467, -0.02704797498881817, 0.0520479679107666, -0.004618928302079439, -0.019324161112308502, 0.006374340038746595, 0.012536568567156792, 0.00021976936841383576, -0.0017206695629283786, -0.006162228062748909, 0.003265797859057784, 0.022176707163453102, -0.006114685442298651, 0.008133409544825554, 0.01928027719259262, 0.02875950187444687, -0.004490929190069437, 0.004896868485957384, -0.0012086743954569101, 0.0009499339503236115, 0.005800174083560705, -0.003693679580464959, 0.01862199604511261, 0.015637796372175217, 0.003143284935504198, -0.041486240923404694, 0.018987707793712616, -0.04523111879825592, 0.02429782971739769, 0.01130777969956398, -0.03382094204425812, 0.016237562522292137, -0.013589815236628056, -0.02543884702026844, 0.03905791789293289, -0.0220304224640131, 0.017729662358760834, -0.010334989055991173, -0.03575189411640167, -0.00010102762462338433, -0.013699528761208057, -0.019382676109671593, 0.017363952472805977, 0.04253948852419853, 0.0046628136187791824, 0.024414855986833572, -0.005529548041522503, -0.015418370254337788, -0.006004972383379936, -0.009157399646937847, 0.006334112025797367, 0.015637796372175217, 0.020757747814059258, -0.015272085554897785, 0.020260382443666458, -0.024136915802955627, 0.03806318715214729, 0.03744879364967346, -0.007036277092993259, -0.012258628383278847, 0.0020479809027165174, -0.019411932677030563, 0.029783492907881737, 0.02320069633424282, 0.019368046894669533, 0.005668518133461475, 0.007657985202968121, -0.039233461022377014, 0.023522522300481796, -0.003850935259833932, -0.013048563152551651, -0.01574019528925419, -0.0021010087803006172, 0.013267990201711655, 0.0037101367488503456, 0.020743120461702347, 0.01873902417719364, 0.03297249227762222, 0.019397303462028503, 0.00155244255438447, 0.026404323056340218, 0.005478348582983017, 0.04795200750231743, 0.004538471810519695, -0.0006486796191893518, -0.005876973271369934, 0.0074824439361691475, -0.0026276325806975365, 0.018504969775676727, -0.005200408399105072, 0.019938556477427483, -0.015052658505737782, -0.022893499583005905, -0.01579870842397213, 0.04455821216106415, -0.027969567105174065, 0.009684023447334766, 0.0350789837539196, 0.008250436745584011, -0.002792202401906252, 0.014818604104220867, 0.00904768705368042, -0.03326505795121193, -0.01803685910999775, 0.013472788035869598, 0.021123459562659264, 0.025629017502069473, 0.0011172466911375523, -0.004234931897372007, -0.014796661213040352, -0.015462255105376244, -0.008425978012382984, -0.02603861317038536, 0.02659449353814125, 0.00022331219224724919, 0.0007593071786686778, -0.029037442058324814, -0.014335866086184978, 0.0002729117404669523, 0.01413838192820549, 0.00608542887493968, 0.003993562422692776, -0.02377120591700077, -0.013099762611091137, 0.00955968163907528, 0.01413106732070446, -0.01862199604511261, -0.004589671269059181, 0.02542421966791153, 0.01748097874224186, -0.020231124013662338, 0.0010889041004702449, -0.014284665696322918, 0.0027647740207612514, -0.00985225010663271, -0.0055441767908632755, -0.005716060753911734, 0.0005814802716486156, -0.008557634428143501, -0.04335867986083031, -0.025541245937347412, -0.025043878704309464, 0.010576358065009117, -0.020626092329621315, -0.004048419184982777, 0.003134142141789198, 0.008052953518927097, 0.02495610900223255, -0.0013220447581261396, 0.011746632866561413, 0.013458159752190113, 0.024648912250995636, 0.005697775166481733, 0.0035144812427461147, 0.015301342122256756, -0.003315168898552656, -0.01213428657501936, 0.00899648666381836, 0.008162666112184525, -0.002307635499164462, 0.050614383071660995, 0.00874048937112093, -0.008667347021400928, 0.03229958191514015, -0.019602101296186447, -0.00453481450676918, -0.019031593576073647, 0.013004678301513195, 0.010430073365569115, -0.042568743228912354, 0.007372730877250433, 0.011454064399003983, -0.025014622136950493, 0.013567873276770115, 0.003188998671248555, 0.03276769444346428, 0.02824750728905201, 0.004081333056092262, 0.029505552724003792, 0.0203920379281044, -3.0028289984329604e-05, 0.011724689975380898, 0.010108248330652714, -0.022893499583005905, 0.011944117024540901, -0.006663251668214798, -0.011497949250042439, 0.06220010295510292, -0.014628434553742409, 0.009055000729858875, -0.00011599891149671748, 0.0243124570697546, -0.004414130002260208, 8.685632928973064e-05, -0.007913983426988125, 0.015959622338414192, -0.02268870174884796, -0.0220304224640131, -0.000587423040997237, -0.0034486535005271435, 0.005657547153532505, 0.018943822011351585, -0.017919832840561867, -0.007336159702390432, 0.0053393784910440445, -0.055178456008434296, 0.01746635138988495, -0.023507893085479736, -0.017320066690444946, -0.03112930804491043, 0.05040958523750305, -0.0007090219296514988, 0.018270915374159813, -0.0187536533921957, -0.004823726136237383, -0.0035199669655412436, 0.00578554579988122, -0.02830602042376995, -0.02194265089929104, 0.02823287807404995, -0.04856640100479126, 0.003084771102294326, -0.006988734472543001, 0.007398330606520176, 0.02998829074203968, -0.02200116589665413, -0.03153890371322632, -0.0017965545412153006, 0.0050797238945961, 0.006176856346428394, 0.015681682154536247, -0.015330599620938301, -0.023624921217560768, -0.030134575441479683, -0.006264626979827881, -0.016135163605213165, 0.017656520009040833, -0.008031010627746582, -0.017276180908083916, 0.0038180213887244463, 0.00955968163907528, 0.009705966338515282, -0.005196751095354557, 0.011673490516841412, -0.017729662358760834, 0.03610297664999962, -0.009698651731014252, -0.022264476865530014, -0.010254532098770142, -0.012046515941619873, 0.038765352219343185, 0.00010582758113741875, 0.012785251252353191, -0.008528376929461956, -0.006699822843074799, -0.030748968943953514, 0.006853421684354544, 0.02263018861413002, -0.03259215131402016, 0.009735222905874252, 0.022878872230648994, 0.03110005147755146, -0.023917490616440773, -0.03402573987841606, 0.018782909959554672, -0.014504092745482922, -0.01701286993920803, -0.005295493174344301, 0.012536568567156792, 0.033031005412340164, 0.009720594622194767, -0.003986248280853033, 0.04444118216633797, -0.008162666112184525, -0.007017991505563259, 0.0260239839553833, 0.025906957685947418, -0.010700699873268604, 0.030046803876757622, 0.009391454979777336, 0.04239320382475853, -0.031919244676828384, 0.020523693412542343, -0.0037960787303745747, -0.008572262711822987, -0.02197190746665001, 0.0010047905379906297, -0.0009435340180061758, 0.017949089407920837, 0.017393209040164948, 0.01752486452460289, 0.011424806900322437, 0.017159152776002884, -0.004227617755532265, -0.024502627551555634, 0.023858975619077682, 0.02941778115928173, 0.023507893085479736, 0.05248682200908661, 0.012565825134515762, 0.025190163403749466, -0.009749851189553738, -0.0029348295647650957, 0.014116439037024975, -0.027516085654497147, -0.02660912275314331, 0.014752776362001896, -0.0046372138895094395, 0.017832061275839806, -0.0039533344097435474, 0.012039201334118843, 0.01134435087442398, -0.0010102762607857585, -0.016968984156847, -0.0026440895162522793, 0.012609709985554218, 0.0243124570697546, -0.006495025008916855, 0.007087476551532745, 0.013063191436231136, 0.0014546149177476764, 0.010525158606469631, -0.019631359726190567, -0.00102764752227813, -0.021167345345020294, -0.03054417110979557, -0.03297249227762222, 0.002035181038081646, 0.03973082825541496, -0.022908128798007965, 4.568528675008565e-05, -0.00822118017822504, -0.032533638179302216, 0.025102393701672554, -0.004724984522908926, -0.008755117654800415, 0.042685773223638535, 0.02435634285211563, 0.0072301034815609455, -0.02495610900223255, -0.0011931316694244742, 0.0011218180879950523, 0.0014317580498754978, 0.04973667860031128, -0.02425394393503666, 0.015476883389055729, 0.014899060130119324, -0.022410761564970016, -0.016149790957570076, -0.000735993089620024, -0.0029311724938452244, 0.006674223113805056, 0.027311287820339203, -0.00539057794958353]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
" Table 13. We observe that PPO could also be affected by the composition of the preference dataset. Overall, PPO
maintains a safe rate of over 92% cross all the settings, while DPO is more affected by the preference dataset.
When filtering dual-unsafe samples, the PPO model achieves significantly higher helpfulness rewards. We hypothesize that
it is because the reward model can discern helpfulness at a more nuanced level. Upon further filtering of dual-safe samples,
we observe that the model becomes conservative, often declining to respond to questions altogether. This phenomenon
occurs because, after filtering both dual-unsafe and dual-safe samples, the reward model focuses solely on safety. And
refusing to respond could always be a safe option.
15
Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study
Preference Dataset helpful-base set full set (default)
SFT N/A 0.532
PPO 0.602 0.718
DPO 0.544 0.615
Table 12. Results of changing the coverage level of preference dataset on HH-RLHF dataset. When training on the helpful-base subset,
the performance of DPO has dropped to be similar to that of the SFT model.
∆Help.↑Harm. ↓ S.R.↑
PPO 1.69 -12.08 99.5%
+ filter dual-unsafe 5.88 -9.12 92.6%
+ filter dual-safe -8.04 -4.51 94.9%
DPO -1.62 -3.50 71.8%
+ filter dual-unsafe 2.46 -4.88 80.8%
+ filter dual-safe -2.86 -6.82 95.8%
Table 13. The impact of filtering dual-safe and dual-unsafe training data on PPO and DPO on the Safe-RLHF dataset.
C.4. Human Evaluation
We also include human evaluation to validate the preference-based tasks. The results are listed in Table 14. We ensure that
each reference pairs are evaluated by 4 different persons. Human agree with GPT-4 evaluations at a rate of 60% and 61%,
respectively. According to human evaluation results, PPO outperforms both DPO and DPO-Iter.
PPO win Tie DPO win GPT4-Human agree %
PPO V .S. DPO 45 26 29 60
PPO V .S. DPO-iter 38 29 33 61
Table 14. Results of human evaluation on HH-RLHF dataset. GPT-4 agrees with human evaluations at a rate of 60% and 61%, respectively.
According to human evaluation results, PPO outperforms both DPO and DPO-Iter.
16
","[0.029044561088085175, 0.006927650421857834, 0.051625605672597885, 0.02123333513736725, -0.0006721367826685309, 0.0006072437972761691, -0.01122176181524992, 0.043594345450401306, 0.03363778069615364, 0.0020336005836725235, 0.028659500181674957, 0.011991883628070354, -0.022498533129692078, -0.006298488937318325, 0.022264746949076653, -0.03542556241154671, 0.02953963913023472, -0.03402284160256386, -0.02359870634973049, 0.04849011451005936, -0.017258960753679276, -0.0062744226306676865, 0.015718718990683556, -0.003369279205799103, 0.02465762197971344, -0.030502289533615112, 0.004428195301443338, 0.0032403527293354273, 0.027243027463555336, -0.02967716008424759, 0.019211767241358757, -0.023034866899251938, -0.025620274245738983, -0.016200043261051178, 0.023832492530345917, -0.0028810773510485888, 0.0002868614683393389, 0.048270080238580704, -0.021742165088653564, 0.0010417260928079486, -0.0032008150592446327, -0.014687306247651577, -0.007694333326071501, -0.05443104729056358, -0.0023138008546084166, 0.03074982948601246, 0.08619853854179382, -0.023337414488196373, 0.030337264761328697, -0.004383500665426254, -0.04590470716357231, 0.07167625427246094, -0.022594798356294632, -0.009131434373557568, 0.026857968419790268, -0.009929059073328972, 0.036690760403871536, -0.01105673611164093, 0.012658863328397274, -0.0629848912358284, -0.0031097070313990116, -0.013738407753407955, 0.004383500665426254, -0.0037852819077670574, -0.015292401425540447, -0.015319906175136566, -0.09956563264131546, 0.003228319576010108, 0.013085179962217808, -0.012205041944980621, 0.012184413149952888, 0.024891408160328865, 0.049947842955589294, -0.024148792028427124, 0.005019538104534149, -0.021742165088653564, 0.06243480369448662, 0.010754188522696495, 0.0070823621936142445, -0.014288493432104588, -0.013841548934578896, 0.014934845268726349, -0.0039159273728728294, -0.03674577176570892, -0.00556274875998497, 0.009241451509296894, -0.037295855581760406, -0.023337414488196373, -0.06144464761018753, -0.03295017406344414, -0.031932514160871506, -0.018441645428538322, -0.005322085693478584, -0.015168632380664349, 0.0053702183067798615, -0.07239136844873428, 0.0043388064950704575, -0.011923122219741344, -0.0035411810968071222, 0.03751588985323906, -0.030447281897068024, -0.012356315739452839, -0.006607912480831146, -0.0013760754372924566, 0.03471045196056366, 0.009743405506014824, 0.022663559764623642, 0.03603065758943558, 0.006738558411598206, -0.012947658076882362, -0.0625448226928711, 0.019748101010918617, -0.0994006097316742, 0.054045986384153366, -0.006456639152020216, -0.035810623317956924, -0.033005181699991226, -0.015622453764081001, 0.024753887206315994, -0.019583076238632202, -0.048160064965486526, -0.009207070805132389, 0.016255052760243416, -0.003431163728237152, 0.01034849975258112, 0.017066430300474167, 0.023131132125854492, -0.05525617673993111, -0.007144246716052294, -0.04092642664909363, -0.014618545770645142, 0.036883290857076645, 0.015704967081546783, -0.027325540781021118, -0.04230164363980293, 0.05891425162553787, -0.019720597192645073, -0.007013601250946522, -0.027793115004897118, -0.013092055916786194, -0.03674577176570892, -0.05995941534638405, -0.030117230489850044, 0.04917772114276886, -0.06386502832174301, -0.04455699771642685, -0.025166451930999756, -0.006848575547337532, -0.03625069186091423, 0.07222634553909302, -0.02901705726981163, -0.0009110805694945157, -0.01877169869840145, 0.007164875045418739, -0.043181780725717545, -0.021522128954529762, -0.0066973017528653145, 0.020146913826465607, -0.029732169583439827, -0.02841196209192276, 0.006535714026540518, 0.02780686691403389, -0.03355526924133301, -0.0057999733835458755, 0.02667918987572193, 0.05407349020242691, -0.008292552083730698, 0.0031028310768306255, -0.0825679674744606, -0.016763882711529732, 0.002614629454910755, 0.0274080540984869, -0.042219128459692, 0.0020662620663642883, -0.011709963902831078, -0.03559058904647827, -0.0321800522506237, 0.02190718986093998, -0.025482751429080963, -0.044529493898153305, 0.007398661691695452, 0.04169654846191406, 0.004421319346874952, -0.011366159655153751, -0.0012634797021746635, -0.007116742432117462, 0.02299361117184162, -0.004899207036942244, -0.010032200254499912, -0.0007662531570531428, 0.042851731181144714, 0.03451792150735855, 0.03718584030866623, -0.01835913397371769, -0.016667617484927177, -0.04114646092057228, 0.03927616775035858, 0.054788604378700256, -0.032125044614076614, 0.022759824991226196, 0.016805138438940048, -0.00467573432251811, -0.028356952592730522, -0.04287923499941826, -0.008175658993422985, -0.020023144781589508, -0.015154879540205002, -0.01956932246685028, -0.0375433973968029, -0.00941335316747427, 0.029099570587277412, 0.030942359939217567, 0.060949571430683136, 0.028769517317414284, 0.01316081639379263, -0.026720445603132248, -0.07756218314170837, 0.012260050512850285, 0.03553558140993118, 0.024368826299905777, 0.0020817331969738007, 0.0017912187613546848, 0.04923273250460625, 0.00611283490434289, -0.006202224176377058, 0.003486172528937459, 0.0384785421192646, -0.001767152571119368, 0.007955624721944332, -0.052505746483802795, 0.008822010830044746, 0.004462576005607843, 0.01735522598028183, -0.011758096516132355, 0.0274080540984869, -0.018386637791991234, 0.01558119710534811, -0.026514163240790367, 0.006102520972490311, -0.03476545959711075, -0.0019098311895504594, 0.017300216481089592, 0.04213661700487137, -0.022539788857102394, 0.025551512837409973, 0.003939993679523468, -0.00017662929894868284, -0.0573740117251873, -0.00379559607245028, -0.03055729903280735, 0.010644171386957169, -0.018799202516674995, -0.008842638693749905, -0.06353497505187988, -0.04015630483627319, -0.00455884076654911, 0.013552753254771233, 0.007460546679794788, -0.020889529958367348, -0.002736679743975401, -0.02975967340171337, 0.04466701298952103, 0.024492597207427025, -0.004156590439379215, -0.02780686691403389, 0.032125044614076614, -0.006415382493287325, 0.022938601672649384, -0.06826572120189667, -0.02325490117073059, -0.0051536220125854015, 0.020752009004354477, 0.0055043017491698265, 0.028123166412115097, -0.05011286959052086, -0.007584316190332174, 0.009420229122042656, 0.04114646092057228, -0.054981134831905365, -0.03792845457792282, -0.025689033791422844, 0.00015148863894864917, 0.05212068557739258, -0.00616440549492836, 0.04763748124241829, 0.02854948304593563, -0.03284015879034996, 0.01216378528624773, 0.012184413149952888, 0.012349439784884453, 0.027820618823170662, -0.051350563764572144, 0.045657169073820114, -0.017919063568115234, -0.005879048258066177, 0.02633538655936718, 0.033280227333307266, -0.04158652946352959, -0.00035433299490250647, 0.0016433830605819821, 0.040238820016384125, 0.0011242390610277653, -0.01118738204240799, 0.003792158095166087, 0.04604222998023033, -0.01654384844005108, 0.020724505186080933, -0.0006450622458942235, -0.007845606654882431, -0.009571502916514874, -0.02707800269126892, -0.004644792061299086, 0.007783722132444382, 0.01460479386150837, -0.05091049522161484, -0.024767639115452766, 0.08372315019369125, -0.029319604858756065, -0.024630118161439896, -0.024712631478905678, -0.019926879554986954, -0.05099300667643547, 0.003152682678773999, 0.014948597177863121, 0.025042682886123657, -0.0006682690000161529, -0.016667617484927177, 0.0008762704092077911, -0.032592616975307465, -0.03798346593976021, 0.017974073067307472, -0.013408355414867401, -0.015251144766807556, 0.008278800174593925, -0.024066278710961342, -0.05231321603059769, 0.002220973838120699, 0.05869421735405922, 0.01829037256538868, 0.051488086581230164, -0.09059923142194748, -0.01306455209851265, -0.037350866943597794, 0.00814127828925848, -0.03185000270605087, 0.001123379566706717, -0.009440857917070389, 0.05187314748764038, 0.031657472252845764, 0.02116457372903824, 0.0004998050280846655, 0.0012333968188613653, 0.0155124356970191, 0.04241165891289711, -0.0059271808713674545, 0.03182249888777733, 0.005837791599333286, -0.049150217324495316, -0.036828283220529556, 0.014453520067036152, -0.016598856076598167, 0.020284434780478477, -0.02385999634861946, 0.026280377060174942, 0.021577138453722, 0.02546899951994419, -0.048270080238580704, -0.020752009004354477, -0.005772469099611044, 0.003572123358026147, -0.004493518266826868, 0.03449041768908501, 0.011201133951544762, 0.026294128969311714, -0.08465829491615295, 0.0429067388176918, 0.004043134860694408, 0.01714894361793995, -0.0250701867043972, 0.040376339107751846, -0.01095359493046999, 0.014302246272563934, -0.02907206490635872, -0.033747799694538116, 0.0006149793625809252, 0.02084827423095703, -0.018111594021320343, -0.00313377333804965, -0.012858269736170769, -0.024822648614645004, 0.010761064477264881, -0.007096114568412304, -0.00824441947042942, -0.009757157415151596, -0.04716990888118744, -0.00931021198630333, -0.02934710867702961, 0.037295855581760406, 0.028384458273649216, 0.05338588356971741, -0.023612458258867264, -0.03699330985546112, -0.0750867947936058, 0.00478918943554163, -0.07151123136281967, 0.01741023361682892, -0.010802321135997772, -0.003161277621984482, 0.018139097839593887, 0.033665288239717484, 0.035810623317956924, -0.017272712662816048, 0.04054136574268341, -0.030777333304286003, 0.01708018220961094, -0.02198970317840576, 0.023488689213991165, 0.0026988612953573465, 0.019858118146657944, 0.016310062259435654, -0.001537663396447897, -0.03806597739458084, 0.00770808570086956, -0.03209754079580307, 0.01296141091734171, 0.01139366440474987, 0.00462416373193264, -0.017740285024046898, 0.017451491206884384, -0.019610580056905746, -0.020119410008192062, 0.07585690915584564, 0.038093481212854385, -0.034737955778837204, -0.03960622102022171, -0.013401479460299015, 0.006528837606310844, -0.011675583198666573, -0.02183843031525612, 0.02794438786804676, 0.01756150834262371, -0.05011286959052086, -0.006576970219612122, -0.03135492280125618, -0.03570060804486275, -0.054981134831905365, -0.0006042355089448392, -0.005335838068276644, -0.0044660139828920364, 0.010210978798568249, -0.026115350425243378, 0.025166451930999756, 0.046207256615161896, -0.0055421204306185246, -0.029457125812768936, -0.03479296341538429, 0.03704831749200821, -0.026101598516106606, 0.012452580966055393, -0.028659500181674957, 0.06287487596273422, -0.019665587693452835, -0.025744043290615082, 0.004882016684859991, 0.012817013077437878, 0.02178342081606388, -0.021673403680324554, -0.01514112763106823, -0.042576685547828674, 0.0023275529965758324, -0.008134402334690094, -0.05536619573831558, 0.0023138008546084166, -0.02245727740228176, -0.030062220990657806, -0.024767639115452766, 0.02491891384124756, -0.0030976738780736923, 0.0055111781693995, -0.0036718265619128942, 0.037295855581760406, -0.03231757506728172, -0.0202981885522604, 0.010472269728779793, 0.07365656644105911, 0.06320492923259735, 0.05470609292387962, 0.03831351548433304, -0.021219583228230476, 0.02666543796658516, 0.005916866473853588, -0.04367686063051224, 0.05514616146683693, -0.01602126657962799, 0.017107686027884483, 0.01829037256538868, 0.008498834446072578, -0.01195750292390585, 0.009949687868356705, -0.0008895928040146828, 0.025496503338217735, -0.03295017406344414, -0.0239150058478117, 0.004369748756289482, 0.008897647261619568, 0.02384624443948269, 0.02766934596002102, -0.0314924456179142, -0.007529307622462511, -0.0011431482853367925, 0.0016932346625253558, 0.01232881098985672, -0.015292401425540447, -0.012370067648589611, -0.022801080718636513, 0.005731212440878153, 0.016777634620666504, -0.0010924371890723705, -0.026252873241901398, 0.01520988903939724, 0.0027177706360816956, -0.0059203049167990685, -0.000737889320589602, 0.007398661691695452, 0.0046035354025661945, -0.053303372114896774, -0.048682644963264465, -0.05074546858668327, -0.011414292268455029, -0.04978281632065773, -0.02237476408481598, -0.009715900756418705, 0.018262868747115135, -0.010114713571965694, -0.03817599639296532, -0.011538062244653702, 0.012363191694021225, -0.026789207011461258, -0.019651835784316063, -0.024506349116563797, 0.03495799005031586, -0.003534305142238736, 0.007570563815534115, -0.04670233279466629, 0.04186157509684563, -0.008546967059373856, 0.04235665127635002, -0.0038299765437841415, -0.013318967074155807, -0.024877656251192093, 0.026280377060174942, -0.041971590369939804, 0.001580638810992241, -0.0003042665193788707, -0.011613698676228523, -0.00032768817618489265, -0.0028621682431548834, -0.01896422728896141, 0.02270481549203396, -0.0034741393756121397, 0.03757090121507645, 5.2242092351661995e-05, -0.0051192413084208965, 0.021260838955640793, 0.0011646359926089644, 0.04529961571097374, 0.02633538655936718, 0.02003689669072628, 0.02399751916527748, 0.029374612495303154, -0.016378821805119514, 0.014095963910222054, 0.03350026160478592, -0.047747496515512466, 0.005734650418162346, 0.009262079373002052, 0.02231975458562374, -0.024093784391880035, 0.01420598104596138, 0.009901555255055428, -0.023956261575222015, -0.016035018488764763, 0.018111594021320343, 0.010761064477264881, -0.011703087948262691, -0.01068542804569006, 0.035755615681409836, 0.035150520503520966, -0.031932514160871506, 0.03578311949968338, 0.0349854938685894, -0.018207859247922897, 0.02633538655936718, -0.021425865590572357, -0.021577138453722, 0.007838730700314045, -0.0024117850698530674, 0.0026301005855202675, 0.0012041734298691154, -0.022966107353568077, -0.0030804837588220835, 0.018606672063469887, -0.001377794542349875, -0.04857262969017029, -0.039578717201948166, 0.038423534482717514, 0.009447733871638775, -0.008622604422271252, 0.001366620883345604, 0.010671676136553288, -0.006226290483027697, -0.034875478595495224, -0.03182249888777733, -0.011386788450181484, -0.0457121804356575, -0.01943180151283741, -0.037488386034965515, 0.0014396791812032461, 0.012741375714540482, -0.037295855581760406, -0.0349854938685894, -0.0005371937295421958, -0.011469300836324692, -0.014879836700856686, 0.018070338293910027, -0.008842638693749905, -0.0028002834878861904, 0.007453670725226402, -0.04227413982152939, -0.004954215604811907, -0.03867107257246971, -0.004679172299802303, 0.021742165088653564, 0.00010792222019517794, 0.035810623317956924, 0.009571502916514874, 0.022966107353568077, 0.011235514655709267, -0.010877958498895168, -0.013669646345078945, 0.0052842674776911736, 0.026967985555529594, -0.0027607460506260395, -0.04029382765293121, 0.011180506087839603, -0.017809046432375908, 0.0050264145247638226, -0.022663559764623642, 0.017437739297747612, -0.04895768687129021, -0.024135040119290352, -0.011214885860681534, -0.0021247086115181446, 0.015801232308149338, 0.006886393763124943, 0.01514112763106823, -0.009777785278856754, 0.018867963925004005, -0.03234507888555527, 0.0034294447395950556, -0.05198316276073456, -0.012541969306766987, -0.01333271898329258, 0.011833732947707176, 0.008443825878202915, 0.015663709491491318, 0.004029382951557636, 0.05509115010499954, 0.021288342773914337, -0.01222566980868578, -0.040238820016384125, -0.04007379338145256, 0.032262567430734634, -0.014274741522967815, 0.003878108924254775, 0.0048407600261271, 0.029044561088085175, -0.02486390434205532, -0.02277357690036297, 0.02384624443948269, -0.009901555255055428, 0.02116457372903824, -0.04480453580617905, -0.04601472616195679, -0.01474231481552124, -0.034682948142290115, 0.020862026140093803, -0.022801080718636513, -0.01558119710534811, 0.016323814168572426, -0.017726533114910126, 0.0050745471380651, 0.00693452637642622, -0.024712631478905678, -0.03438039869070053, 0.023296158760786057, 0.008381941355764866, 0.05500863865017891, -0.004899207036942244, -0.041311487555503845, -0.016763882711529732, -0.0202981885522604, -0.02438257820904255, -0.0036718265619128942, -0.04860013350844383, -0.03545306622982025, -0.03913864493370056, 0.033802807331085205, 0.033665288239717484, -0.02358495444059372, -0.019789358600974083, 0.04161403328180313, -0.024025022983551025, 0.018744193017482758, 0.014797323383390903, 0.016860147938132286, 0.010279739275574684, 0.013057675212621689, 0.014756067655980587, -0.03341774642467499, -0.026294128969311714, 0.0021315847989171743, -0.00484419846907258, 0.027889380231499672, -0.021577138453722, 0.00831318087875843, -0.04461200535297394, -0.020133161917328835, -0.048022542148828506, -0.00292233400978148, 0.01754775643348694, 0.01747899502515793, -0.017341474071145058, -0.02399751916527748, -0.0020078152883797884, 0.03162996843457222, -0.006233166437596083, 0.033197712153196335, -0.03061230666935444, 0.015691213309764862, 0.040513861924409866, -0.01089171040803194, -0.007618696428835392, -0.01842789351940155, -0.01976185292005539, -0.012590101920068264, 0.006779814604669809, 0.03396783396601677, 0.011579317972064018, -0.00549742579460144, -0.031327418982982635, 0.012782632373273373, 0.0035789995454251766, 0.009048921056091785, 0.0198306143283844, -0.030584802851080894, -0.012755127623677254, 0.012651986442506313, -0.017437739297747612, 0.02251228503882885, 0.03402284160256386, 0.02579905092716217, -0.006126587279140949, -0.01034849975258112, -0.007116742432117462, 0.008760125376284122, -0.053110841661691666, -0.005029852502048016, 0.012425076216459274, -0.00914518628269434, 0.007323024794459343, 0.007804350461810827, 0.01742398552596569, 0.018867963925004005, 0.07965251058340073, -0.019954383373260498, 0.02512519620358944, -0.007323024794459343, -0.004868264310061932, 0.012218793854117393, -0.030392272397875786, -0.012115652672946453, 0.029594646766781807, -0.018441645428538322, -0.015773726627230644, 0.011180506087839603, 0.01250071357935667, -0.005308333784341812, 0.028356952592730522, -0.03564559668302536, -0.0022381639573723078, 0.0193630401045084, -0.0071236188523471355, -0.008760125376284122, -0.006982658989727497, 0.0202981885522604, -0.03350026160478592, -0.11892867833375931, -0.04356684163212776, 0.01122863870114088, -0.032400086522102356, 0.013277710415422916, -0.001911550178192556, 0.07068610191345215, 0.043126773089170456, -0.01322957780212164, -0.014522280544042587, 0.035893138498067856, -0.03424287587404251, 0.011613698676228523, -0.016530096530914307, -0.00010588088480290025, -0.03231757506728172, -0.0036615123972296715, 0.010843577794730663, 0.043044257909059525, -0.047554969787597656, -0.034132860600948334, -0.0256615299731493, 0.00699984934180975, 0.011345531791448593, -0.04175155609846115, 0.019596828147768974, 0.012129404582083225, -0.0021934695541858673, -0.0366082489490509, 0.0064360108226537704, -0.02887953445315361, 0.01530615333467722, 0.02720177173614502, -0.02017441764473915, -0.022759824991226196, -0.034270383417606354, -0.01383467298001051, 0.0002984648454003036, -0.0004119201621506363, 0.01910175010561943, 0.03157495707273483, -0.019129253923892975, 0.013594009913504124, -0.029127074405550957, 0.006088768597692251, -0.07398661971092224, -0.026046590879559517, -0.008450701832771301, -0.004775437526404858, -0.0033280225470662117, 0.0002223982010036707, -0.03718584030866623, 0.015842488035559654, -0.01270011905580759, -0.012480084784328938, 0.01453603245317936, 0.017135191708803177, -0.001719019957818091, 0.004300987813621759, -0.035618092864751816, -0.006559780333191156, 0.04604222998023033, 0.016708873212337494, -0.023708723485469818, -0.004118771757930517, 0.013380851596593857, -0.013071428053081036, 0.02009190432727337, -0.02460261434316635, -0.04301675409078598, -0.03955120965838432, 0.03938618674874306, -0.0014551504282280803, 0.016791386529803276, 0.00016599286755081266, 0.003888423088937998, 0.03303268924355507, -0.00042180452146567404, -0.05704395845532417, 0.030392272397875786, 0.04120146855711937, -0.01453603245317936, 0.027188019827008247, 0.037680916488170624, 0.0239150058478117, 0.020256930962204933, 0.03014473430812359, -0.007990004494786263, 0.0012316778302192688, -0.005421788897365332, 0.012975162826478481, -0.012624482624232769, 0.0001515960757387802, -0.0024444463197141886, -0.010169722139835358, -0.021604642271995544, -0.008265048265457153, -0.009433981962502003, -0.008732621558010578, -0.004796065855771303, 0.024025022983551025, -0.022828584536910057, -0.021013300865888596, 0.004483203869313002, -0.002846697112545371, 0.012363191694021225, 0.024740135297179222, -0.009640264324843884, 0.03237258270382881, -0.0007864516228437424, -0.00412220973521471, 0.010795445181429386, -0.009949687868356705, 0.015526188537478447, -0.02599158138036728, 0.012810137122869492, 0.04232914745807648, 0.027765611186623573, 0.0048613883554935455, 0.03270263597369194, -0.022828584536910057, 0.028356952592730522, -0.012803260236978531, 0.03960622102022171, 0.01139366440474987, 0.0073436531238257885, -0.008945779874920845, 0.056658897548913956, -0.029127074405550957, -0.008822010830044746, 0.0193630401045084, 0.020738257095217705, -0.02143961749970913, -0.008870142512023449, -0.008416322059929371, 0.01380716823041439, 0.05126805230975151, -0.020793264731764793, -0.019211767241358757, 0.013119560666382313, 0.0047341808676719666, 0.03432539105415344, 0.026417898014187813, 0.01908799819648266, -0.01593875326216221, 0.017341474071145058, 0.023626210168004036, -0.04249417409300804, -0.004833884071558714, 0.02841196209192276, -0.009420229122042656, 0.0005406317650340497, 0.0031819059513509274, 0.0070823621936142445, 0.003056417452171445, 0.02801314927637577, -5.044249337515794e-05, -0.02337867207825184, -0.0004009614058304578, -0.004682610277086496, -0.0021057995036244392, 0.024217553436756134, -0.02619786374270916, -0.03960622102022171, 0.037213344126939774, -0.01849665492773056, -0.010781693272292614, 0.013779664412140846, 0.019803110510110855, -7.993442704901099e-05, -0.012844516895711422, -0.024203801527619362, 0.02198970317840576, 0.01520988903939724, 0.017919063568115234, 0.04461200535297394, 0.014109715819358826, 0.043649353086948395, -0.020050648599863052, 0.02176966890692711, 0.0021040805149823427, 0.029842186719179153, 0.013030171394348145, 0.0005586814950220287, 0.04147651419043541, -0.042521677911281586, 0.022567294538021088, 0.005184564273804426, 0.030804837122559547, 0.04656481370329857, 0.026184111833572388, 0.021590890362858772, -0.007041105534881353, 0.034132860600948334, 0.031189898028969765, -0.009729652665555477, 0.018524158746004105, 0.012349439784884453, -0.003180186962708831, -0.0503879114985466, 0.011036108247935772, 0.04656481370329857, 0.01896422728896141, -0.027573080733418465, -0.026087846606969833, 0.035810623317956924, 0.009035169146955013, -0.03512301668524742, -0.0077630942687392235, 0.03135492280125618, -0.0037715297657996416, 0.01091921515762806, -0.017176447436213493, 0.011049860157072544, 0.0005260201287455857, -0.031519949436187744, -0.0028948294930160046, 0.027490567415952682, 0.012026263400912285, 0.01457728911191225, 0.021329600363969803, 0.00911768153309822, 0.0013726374600082636, -0.014453520067036152, 0.002824349794536829, -0.01662636175751686, 0.046207256615161896, -0.026555420830845833, 0.017313968390226364, 0.030997367575764656, -0.03069481998682022, 0.012232545763254166, 0.008388817310333252, 0.00423910329118371, -0.021205829456448555, -0.02277357690036297, -0.002609472256153822, 0.008966407738626003, 0.0004959372454322875, -0.016310062259435654, 0.04122897610068321, 0.0034775773528963327, -0.012088147923350334, 0.007364281453192234, 0.026857968419790268, -0.001399282249622047, 0.035288043320178986, 0.009832793846726418, 0.009592131711542606, -0.017712781205773354, 0.009695272892713547, -0.004376624710857868, -0.01602126657962799, -0.00765307666733861, -0.006350059527903795, -0.03553558140993118, 0.009110805578529835, 0.01386905275285244, 0.024960169568657875, 0.005311771761626005, -0.03248260170221329, 0.0310248713940382, 0.001453431323170662, 0.0015729032456874847, 0.007811226882040501, -0.0020301626063883305, 0.0067041777074337006, 0.019651835784316063, 0.03773592785000801, -0.035673100501298904, -0.033665288239717484, 0.024506349116563797, -0.011201133951544762, 0.02116457372903824, -0.004517584573477507, 0.004496956244111061, 0.021879686042666435, 0.016928909346461296, 0.017534002661705017, -0.02806815877556801, -0.0024977358989417553, 0.031052377074956894, 0.015457427129149437, 0.019665587693452835, 0.011654955334961414, -0.02097204327583313, 0.00726801622658968, 0.0014147533802315593, 0.003078764770179987, 0.01460479386150837, 0.02339242398738861, 0.03905613347887993, -0.008237543515861034, 0.015196136198937893, 0.0011551814386621118, 0.001646821154281497, 0.004294111859053373, 0.02491891384124756, 0.016310062259435654, -0.023488689213991165, 0.021728413179516792, 0.03570060804486275, 0.024410083889961243, -0.013552753254771233, 0.05396347492933273, -2.6960410650644917e-06, 0.004926711320877075, -0.024822648614645004, -0.009640264324843884, -0.03187750652432442, 0.014494776725769043, -0.04109145328402519, 0.018854210153222084, 0.015801232308149338, -0.021522128954529762, -0.012473208829760551, 0.0079349959269166, -0.0278756283223629, -0.018441645428538322, 0.00854009110480547, 0.013140188530087471, 0.0023361481726169586, 0.019541818648576736, 0.013951566070318222, -0.005067670717835426, -0.019335536286234856, 0.008464454673230648, -0.00660103652626276, -0.03041977807879448, -0.0012058925349265337, -0.011881865561008453, 0.005005786195397377, 0.007577439770102501, -0.008966407738626003, -0.056713905185461044, -0.01661260798573494, -0.05118553712964058, 0.0064394487999379635, -0.03718584030866623, -0.061004579067230225, 0.030859846621751785, -0.019349288195371628, 0.02198970317840576, -0.012184413149952888, 0.002394594717770815, 0.02055947855114937, -0.0008246998186223209, 0.006484143435955048, -0.017190199345350266, -0.01708018220961094, 0.07294145226478577, -0.012810137122869492, -0.02438257820904255, 0.0032076912466436625, -0.03542556241154671, 0.014233484864234924, -0.008732621558010578, -0.00821003969758749, 0.004307864233851433, 0.017451491206884384, 0.007316148839890957, 0.009131434373557568, -0.012878897599875927, -0.0007069469429552555, 0.0037852819077670574, 0.008017509244382381, -0.024712631478905678, 0.038891106843948364, 0.05085548758506775, -0.006191909778863192, 0.01012158952653408, 0.015003605745732784, -0.017575260251760483, 0.012143157422542572, 0.0368557870388031, 0.012198165990412235, -0.010410385206341743, -0.031519949436187744, 0.034600432962179184, 0.014054707251489162, -0.009482113644480705, -0.03391282632946968, -0.01889546774327755, -0.006707615684717894, -0.02270481549203396, -0.0024478845298290253, -0.029127074405550957, 0.04287923499941826, -0.00045940809650346637, -0.004878578707575798, 0.025111444294452667, 0.0157462228089571, 0.0011526028392836452, 0.002334429183974862, 0.016708873212337494, 0.02579905092716217, 0.009846546687185764, -0.0037337113171815872, 0.005146745592355728, 0.020380700007081032, 0.025510255247354507, -0.007996880449354649, -0.0005320367054082453, 0.008684488944709301, 0.017176447436213493, 0.006387878209352493, -0.007364281453192234, 0.019528066739439964, 0.026899224147200584, 0.010809197090566158, -0.04430945962667465, 0.013841548934578896, -0.02138460800051689, 0.007151123136281967, 0.002602596301585436, -0.008010633289813995, 0.007529307622462511, -0.005751840770244598, -0.028714509680867195, 0.023296158760786057, -0.008285676129162312, 0.0077630942687392235, -0.021755916997790337, -0.024492597207427025, 0.01614503562450409, -0.012899525463581085, -0.015553692355751991, 0.021893437951803207, 0.016708873212337494, 0.009805290028452873, 0.011682460084557533, -0.0075086792930960655, -0.01537491474300623, -0.003252385649830103, -0.014989853836596012, 0.00022884452482685447, 0.003228319576010108, 0.007192379329353571, -0.02659667655825615, 0.018977981060743332, -0.01330521423369646, 0.04018380865454674, 0.038231004029512405, 0.009268955327570438, -0.02398376725614071, 0.004637915641069412, -0.004655105993151665, 0.036553241312503815, 0.005335838068276644, 0.01856541633605957, -0.001973434817045927, -0.013422108255326748, -0.034875478595495224, 0.029374612495303154, 0.010004696436226368, -0.02579905092716217, -0.009420229122042656, 0.0065700942650437355, 0.023763731122016907, 0.0014405386755242944, 0.018042832612991333, -0.003379593137651682, 0.01776779070496559, 0.036828283220529556, -0.015457427129149437, 0.05088299140334129, 0.007391785737127066, 0.02735304646193981, 0.009482113644480705, 0.008498834446072578, -2.9894830731791444e-05, 0.004197846632450819, -0.009942810982465744, 0.02654166892170906, -0.0015677461633458734, 0.021068308502435684, -0.012156909331679344, -0.029567142948508263, 0.0016150192823261023, 0.024038774892687798, -0.03424287587404251, -0.004043134860694408, 0.013662770390510559, -0.0021522128954529762, 0.00931021198630333, 0.030777333304286003, 0.007804350461810827, -0.04736243933439255, -0.011840609833598137, 0.00770808570086956, -0.003936555702239275, 0.01122863870114088, -0.025276469066739082, 0.004459137562662363, -0.020793264731764793, -0.022223489359021187, -0.010678552091121674, -0.04719741269946098, 0.014137220568954945, -0.0003337047528475523, -0.019583076238632202, -0.02692672796547413, -0.009337716735899448, 0.027573080733418465, -0.010671676136553288, -0.008973284624516964, -0.0021969075314700603, -0.015031110495328903, -0.02632163278758526, 0.007151123136281967, 0.027518071234226227, -0.0034483540803194046, 0.007144246716052294, 0.044391971081495285, 0.010802321135997772, -0.003699330845847726, -0.01008033286780119, -0.017836550250649452, 0.003964059986174107, -0.0045622787438333035, -0.016365069895982742, -0.007886863313615322, 0.013855300843715668, -0.0011551814386621118, -0.03878109157085419, -0.018744193017482758, -0.017052678391337395, 0.02036694809794426, -0.014508528634905815, 0.02138460800051689, 0.020807016640901566, 0.02953963913023472, 0.01835913397371769, 0.005184564273804426, -0.0016992512391880155, 0.012872021645307541, 0.0198306143283844, -0.004184094723314047, 0.0162137970328331, -0.002399751916527748, -0.02586781233549118, -0.017781542614102364, 0.017300216481089592, 0.01956932246685028, -0.007721837610006332, 0.0872436985373497, 0.0013219263637438416, -0.020752009004354477, 0.029732169583439827, -0.026500411331653595, -0.04474952816963196, -0.01647508703172207, -0.016860147938132286, 0.017245208844542503, -0.026280377060174942, -0.004978281911462545, 0.017589012160897255, -0.02438257820904255, 0.022402267903089523, 0.01306455209851265, 0.027256781235337257, 0.018730441108345985, -0.004699800629168749, 0.002561339642852545, 0.00821003969758749, 0.006408506538718939, 0.01407533511519432, 0.015622453764081001, -0.025413991883397102, -0.005617757327854633, 0.008416322059929371, -0.01823536306619644, 0.05366092547774315, -0.014756067655980587, 0.011386788450181484, 0.003078764770179987, 0.006852013524621725, 0.020023144781589508, -0.010486021637916565, -0.00021896016551181674, 0.018249114975333214, -0.04007379338145256, -0.002872482407838106, -0.01260385476052761, 0.003369279205799103, 0.017809046432375908, 0.009289584122598171, -0.009193318895995617, -0.024300066754221916, 0.015980008989572525, -0.05874922499060631, 0.022030958905816078, -0.02579905092716217, 0.005769031122326851, -0.03845103830099106, 0.04628976806998253, 0.001250587054528296, 0.017052678391337395, -0.025565264746546745, 0.005590253043919802, -0.005270515102893114, 0.012988914735615253, -0.03022724762558937, -0.03927616775035858, 0.027848122641444206, -0.03490298241376877, -0.008897647261619568, -0.024547604843974113, -0.011036108247935772, 0.01747899502515793, -0.038093481212854385, -0.03201502934098244, -0.004156590439379215, 0.007309272885322571, 0.005487111862748861, 0.009880926460027695, -0.01558119710534811, -0.004349120426923037, -0.01530615333467722, -0.020284434780478477, 0.0007752780220471323, 0.0030443842988461256, -0.010066580958664417, -0.016763882711529732, 0.005298019386827946, 0.02967716008424759, 0.028934543952345848, -0.004008754622191191, 0.02055947855114937, -0.012184413149952888, 0.026032838970422745, -0.006662921514362097, -0.022195985540747643, -0.008237543515861034, -0.00854009110480547, 0.036965806037187576, 0.0039193653501570225, -0.008148154243826866, -0.005366780329495668, -0.014439767226576805, -0.04480453580617905, 0.015649957582354546, 0.02050447091460228, -0.03465544059872627, 0.009399601258337498, 0.02285609021782875, 0.017382729798555374, -0.037818439304828644, -0.02036694809794426, 0.02164589986205101, -0.007068610284477472, 0.0005629790248349309, 0.0136421425268054, 0.012810137122869492, 0.037488386034965515, -0.005150183569639921, -0.005064232740551233, 0.015058615244925022, -0.008601975627243519, 0.01567746140062809, 0.025757795199751854, 0.015333658084273338, -0.014714810997247696, 0.010382880456745625, 0.0025286783929914236, 0.03140993416309357, -0.010376004502177238, 0.01602126657962799, -0.022498533129692078, -0.013195197097957134, -0.016653865575790405, -0.008065641857683659, -0.008835762739181519, 0.025771547108888626, 0.03484797105193138, 0.020586982369422913, 0.010816073976457119, 0.005738088395446539, 0.01776779070496559, -0.02626662515103817, 0.024437587708234787, 0.025909068062901497, 0.0217009074985981, 0.0494527667760849, 0.00517768831923604, 0.025441495701670647, -0.013903433457016945, 0.0019803110044449568, 0.01769902929663658, -0.022085968405008316, -0.02358495444059372, 0.016392573714256287, 0.008292552083730698, 0.01776779070496559, -0.004376624710857868, 0.00385404285043478, 0.007398661691695452, -0.004765123128890991, -0.006253794766962528, 0.01460479386150837, 0.013848424889147282, 0.029237091541290283, 0.00649789534509182, 0.011331779882311821, 0.016323814168572426, 0.0018135660793632269, 0.00286388723179698, -0.03583812713623047, -0.013147064484655857, 0.0027573080733418465, -0.003616817994043231, -0.0291545782238245, 0.012885773554444313, 0.03248260170221329, -0.02806815877556801, -0.006026884075254202, 0.0023499003145843744, -0.02801314927637577, 0.0214533694088459, -0.014027202501893044, 0.014164724387228489, 0.042384155094623566, 0.005067670717835426, 0.001436241203919053, -0.03550807759165764, -0.007274892646819353, 0.014260989613831043, -0.023832492530345917, 0.03600315377116203, -0.004613849334418774, 0.0019579636864364147, 0.012693243101239204, -0.030914854258298874, -0.01322957780212164, -0.0004110606387257576, 0.0023791235871613026, -0.003099392866715789, 0.04953527823090553, -0.004146276041865349]",Is DPO Superior to PPO for LLM Alignment? A Comprehensive Study.pdf
