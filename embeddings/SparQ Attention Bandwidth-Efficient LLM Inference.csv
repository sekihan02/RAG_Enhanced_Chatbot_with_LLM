text,embedding,file
"SparQ Attention: Bandwidth-Efficient LLM Inference
Luka Ribar*Ivan Chelombiev*Luke Hudlass-Galley*Charlie Blake Carlo Luschi Douglas Orr
Abstract
The computational difficulties of large language
model (LLM) inference remains a significant ob-
stacle to their widespread deployment. The need
for many applications to support long input se-
quences and process them in large batches typi-
cally causes token-generation to be bottlenecked
by data-transfer. For this reason, we introduce
SparQ Attention , a technique for increasing
the inference throughput of LLMs by utilising
memory bandwidth more efficiently within the
attention layers, through selective fetching of the
cached history. Our proposed technique can be
applied directly to off-the-shelf LLMs during in-
ference, without requiring any modification to the
pre-training setup or additional fine-tuning. We
show that SparQ Attention brings up to 8×sav-
ings in attention data-transfers without substantial
drops in accuracy, by evaluating Llama 2, Mistral
and Pythia models on a wide range of downstream
tasks.
1. Introduction
Transformer models trained on large corpora of text have
recently shown remarkable performance on complex natural
language processing tasks (Achiam et al., 2023; Touvron
et al., 2023). This has been attributed to the in-context
learning capabilities that emerge with large-scale training,
enabling arbitrary textual information (e.g. long instructions,
chat histories, relevant documents) to be incorporated at
inference-time (Wei et al., 2022).
To leverage the benefits of in-context learning there has
been demand for LLMs to support increasingly long input
sequences. However, the standard inference optimisation
used to support in-context learning, key-value (KV) caching
* Equal contribution.
Graphcore Research, UK. Correspondence to Luka Ribar, Ivan
Chelombiev, Luke Hudlass-Galley, Douglas Orr {lukar, ivanc,
lukehg, douglaso }@graphcore.ai.
Code available here: https://github.com/
graphcore-research/llm-inference-research/
tree/2024-01-paper
dense
transfers1
21
41
8128 MB 256 MB 512 MB
Attention transfers per token0.20.40.60.8SQuAD Accuracy
Dense
SparQ AttentionH2O
LM-InﬁniteFlexGen (16-bit)Figure 1: Llama 2 13B SQuAD 1-shot performance versus
attention transfers over a range of compression ratios. SparQ
Attention achieves matching performance, while transfer-
ring between 1/8and1/4as much data as the original dense
model. The curves show the mean ±one standard error eval-
uated over 4000 examples. This pattern is representative of
the performance across multiple models and tasks, shown
in Figures A1 and A2.
(Pope et al., 2023), is constrained by the need to fetch a large
amount of data from memory when processing batches of
long sequences. This in turn limits the speed at which tokens
can be generated—a key usability metric for LLMs.
This bottleneck can be attributed to the auto-regressive na-
ture of transformer generation. For each token generated,
the full KV cache must be re-fetched from memory. The size
of the KV cache scales linearly with the sequence length,
as well as the batch size, thus rendering generation for long
batched sequences increasingly memory bandwidth limited.
Despite this expensive cache-fetch at each step, tokens gen-
erally only attend to a small part of the sequence at a time
(Vig, 2019; Yun et al., 2020). If it were possible to efficiently
predict which tokens will have high attention scores, mem-
ory bandwidth efficiency could be significantly increased by
only transferring the key-value pairs of high-scoring tokens.
Building upon this idea, we present SparQ (Sparse Query)
Attention , a technique for significantly improving the mem-
ory bandwidth efficiency of transformer inference. By ap-
proximating attention scores using a subset of query and
1arXiv:2312.04985v3  [cs.LG]  12 Mar 2024
SparQ Attention: Bandwidth-Efficient LLM Inference
key components, we fetch only the most relevant tokens
for each generation step, reducing the amount of data trans-
ferred without degrading the model.
We also provide a new set of challenging downstream task
variants which we use to evaluate SparQ Attention. These
are based on existing tasks, modified to assess the model’s
ability to utilise information from long input sequences
for multi","[0.028939692303538322, 0.033767495304346085, 0.007716346997767687, -0.006082217209041119, 0.003729341784492135, 0.007167116738855839, -0.022348927333950996, 0.024518726393580437, -0.04206697642803192, 0.01531064324080944, 0.013723977841436863, -0.035286352038383484, -0.039653073996305466, 0.027719181030988693, -0.0031021342147141695, -0.01950106769800186, 0.0401955246925354, -0.04491483420133591, 0.0028987156692892313, 0.017209216952323914, -0.018606025725603104, 0.0030614505521953106, 0.01181184221059084, 0.014958051033318043, 0.00842153187841177, -0.022186193615198135, 0.01718209497630596, 0.026647841557860374, 0.029482141137123108, -0.04665067419409752, 0.057716649025678635, -0.033008065074682236, -0.05825909972190857, -0.023203285411000252, -0.005492303520441055, 0.08635799586772919, 0.0016307394253090024, 0.03167906403541565, -0.04564714431762695, 0.003186892019584775, -0.004756605718284845, -0.043341733515262604, -0.05332280695438385, 0.018172064796090126, 0.006411077454686165, 0.033143676817417145, 0.026620719581842422, 0.010564208030700684, -0.015798848122358322, 0.0541093572974205, -0.0324656143784523, 0.015500500798225403, -0.07496654987335205, 0.042717915028333664, 0.0027614079881459475, -0.019121352583169937, 0.0022087874822318554, 0.032682593911886215, 0.01531064324080944, 0.009479308500885963, 0.015676796436309814, -0.030567040666937828, 0.013256114907562733, -0.014347794465720654, -0.04290777072310448, 0.012788251973688602, -0.03477102518081665, 0.032709717750549316, -0.003247917629778385, 0.01437491737306118, -0.009458966553211212, 0.0448605902493, 0.04708463326096535, -0.027095362544059753, -0.0040887147188186646, 0.006458541844040155, 0.005197346210479736, 0.05733693391084671, 0.010143809951841831, -0.0025851118844002485, 0.029644876718521118, -0.017209216952323914, 0.03319792076945305, -0.017873717471957207, -0.012923864647746086, -0.03493376076221466, -0.023135479539632797, -0.008530021645128727, -0.02040966972708702, 0.007390877231955528, -0.03195028752088547, 0.025251034647226334, -0.02701399475336075, 0.004112446680665016, 0.05071904882788658, 0.04605397954583168, 0.04553865268826485, -0.029427897185087204, 0.02614607661962509, 0.05421784892678261, 0.034988004714250565, 0.007173897232860327, 0.033631883561611176, -0.05777089297771454, 0.031001001596450806, -0.014157937839627266, -0.001232377951964736, 0.009330134838819504, 0.003661535447463393, -0.012815373949706554, -0.06612461805343628, -0.01034722849726677, -0.058042120188474655, 0.032384246587753296, 0.01452409103512764, -0.07192882895469666, -0.05551972612738609, -0.003178416285663843, 0.012218679301440716, 0.04526742920279503, -0.013337481766939163, 0.024179695174098015, 0.027909036725759506, -0.012781471014022827, 0.021128416061401367, -0.026390178129076958, 0.02643086202442646, -0.050746168941259384, 0.023555878549814224, -0.005156662780791521, 0.04665067419409752, -0.00048142412560991943, 0.048766229301691055, -0.0024037302937358618, -0.01794152334332466, -0.033279288560152054, -0.039625950157642365, 0.009621702134609222, -0.03230287879705429, -0.020179128274321556, 0.0013552766758948565, -0.0009865803876891732, -0.0015315728960558772, 0.009940390475094318, -0.028966814279556274, 0.0032394418958574533, -0.0007026419043540955, 0.012937425635755062, -0.007723127957433462, 0.03306230902671814, -0.0135341202840209, -0.019745169207453728, -0.06612461805343628, 0.015554745681583881, -0.02594265714287758, -0.01898573897778988, -0.025264594703912735, 0.01050318218767643, 0.013825686648488045, -0.04263654723763466, -0.00068569032009691, 0.030702654272317886, 0.00950643140822649, -0.00780449528247118, -0.0011560959974303842, 0.0223896112293005, -0.06834866106510162, 0.011845745146274567, -0.06986752152442932, -0.06091710180044174, -0.036533989012241364, -0.05128861963748932, -0.018646709620952606, -0.022037019953131676, 0.01636842079460621, -0.0146732646971941, -0.02812601812183857, -0.002747846767306328, -0.00548552256077528, -0.06010342761874199, -0.016314174979925156, 0.030675530433654785, -0.022796448320150375, -0.007397657725960016, -0.0309196338057518, 0.0028156531043350697, -0.05614354461431503, 0.02997034601867199, 0.00842153187841177, 0.043992672115564346, -0.03409296274185181, 0.04979688301682472, 0.060645878314971924, 0.04130754619836807, 0.0021460666321218014, -0.019853658974170685, 0.0432332418859005, 0.03336065635085106, 0.0035767778754234314, -0.012856057845056057, 0.026661403477191925, 0.027081802487373352, 0.01825343258678913, -0.0711693987250328, 0.05668599531054497, 0.018050014972686768, -0.009452186524868011, -0.012618736363947392, -0.05012235417962074, -0.048006799072027206, 0.035177864134311676, 0.0068314759992063046, 0.07019299268722534, -0.01560899056494236, -0.025712115690112114, 0.010618452914059162, -0.019039984792470932, 0.03539484366774559, 0.018429728224873543, 0.029563508927822113, 0.020355425775051117, -0.02196921408176422, 0.008177429437637329, 0.035774558782577515, -0.05058343708515167, 0.04220258817076683, 0.030105959624052048, -0.019853658974170685, 0.006756889168173075, -0.015514061786234379, 0.01948750577867031, 0.014334233477711678, -0.00023753364803269506, -0.03664247691631317, 0.012266144156455994, -0.03539484366774559, 0.03970731794834137, -0.007912985049188137, 0.01668032817542553, -0.052454885095357895, 0.00246984139084816, -0.01574460230767727, 0.026620719581842422, 0.013900273479521275, -0.02780054695904255, 0.03279108554124832, -0.01499873399734497, -0.037456151098012924, 0.06162228807806969, 0.03742903098464012, -0.02350163273513317, -0.025590065866708755, -0.06319539248943329, -0.0062754652462899685, -0.05180394649505615, -0.004692189861088991, -0.03138071671128273, 0.0355033352971077, 0.0037937576416879892, 0.008414750918745995, -0.00664500892162323, -0.006000849884003401, -0.00629919720813632, 0.01715497113764286, 0.005299055483192205, -0.01933833211660385, 0.010686259716749191, 0.03512362018227577, -0.021874284371733665, -0.00958779826760292, 0.018741637468338013, -0.010645575821399689, 0.0024579751770943403, -0.021603059023618698, -0.04654218629002571, -0.013785003684461117, 0.01718209497630596, -0.01899930089712143, 0.0008772428845986724, 0.06015767157077789, -2.0924573618685827e-05, 0.0015561525942757726, 0.06579914689064026, 0.0185246579349041, -0.008977542631328106, 0.006536519154906273, 0.028532855212688446, -0.03197741135954857, -0.00429552374407649, -0.02629525028169155, 0.022470979019999504, -0.012306828051805496, 0.03789011389017105, 0.005112588405609131, 0.02207770384848118, 0.022986305877566338, -0.013052696362137794, -0.035910170525312424, 0.01244922075420618, 0.007628199178725481, 0.03460828959941864, 0.023989837616682053, 0.04510469362139702, -0.028993936255574226, 0.0033750543370842934, 0.044291019439697266, -0.013622268103063107, -0.011527055874466896, -0.02485775761306286, 0.02828875184059143, -0.005271933041512966, 0.012394975870847702, -0.010225176811218262, 0.03799860179424286, -0.048006799072027206, -0.042880650609731674, 0.018633147701621056, -0.048142410814762115, 0.024464482441544533, -0.03496088460087776, -0.024925563484430313, -0.06384632736444473, 0.0017680469900369644, -0.01823987066745758, 0.045999735593795776, -0.05576382949948311, -0.01608363352715969, 0.0032394418958574533, -0.01963667944073677, 0.0016620998503640294, 0.06200200319290161, 0.021277589723467827, 0.006573812570422888, -0.013791783712804317, -0.07024724036455154, -0.016639644280076027, -0.010543866083025932, -0.009709849953651428, 0.021874284371733665, 0.02347451075911522, -0.05907277390360832, 0.0055702803656458855, -0.007072187960147858, -0.015025856904685497, -0.03167906403541565, 0.009255548007786274, 0.025318840518593788, -0.005241420120000839, 0.04068372771143913, -0.003115695435553789, 0.010496402159333229, 0.012923864647746086, 0.05454332008957863, -0.05334992706775665, 0.0208843145519495, -0.002568160416558385, 0.022904938086867332, -0.05204804986715317, 0.008401189930737019, 0.0022070922423154116, -0.02918379381299019, 0.024355992674827576, 0.004237888380885124, 0.0004072610754519701, 0.008116403594613075, -0.008170648477971554, -0.007818056270480156, 0.04513181746006012, 0.02130471169948578, -0.02672920934855938, 0.03487951681017876, 0.049390047788619995, 0.0027953111566603184, -0.02842436544597149, -0.026946188881993294, -0.013459533452987671, -0.003247917629778385, 0.03889364376664162, -0.003015681402757764, 0.03216726705431938, 0.006482273805886507, 0.02225399948656559, -0.006441590376198292, -0.013954518362879753, 0.03753751888871193, 0.0036242420319467783, 0.007004382088780403, 0.0060178013518452644, -0.0680231899023056, -0.006360223051160574, -0.041958484798669815, 0.010286202654242516, -0.018361922353506088, 0.02150813117623329, 0.020938558503985405, 0.03789011389017105, -9.286272688768804e-05, 0.026634281501173973, 0.04393842816352844, 0.05055631324648857, -0.004312475211918354, 0.0058279442600905895, -0.0062822457402944565, 0.005234639625996351, 0.01745332032442093, -0.007933326996862888, 0.014510530047118664, 0.03688658028841019, 0.011486372910439968, -0.014605458825826645, 0.05394662544131279, -0.049851126968860626, 0.018917933106422424, -0.025400208309292793, 0.02274220436811447, -0.03165194019675255, -0.00926910899579525, 0.0025240862742066383, -0.0034072622656822205, 0.0634123682975769, -0.006326319649815559, -0.0417143814265728, -0.01993502676486969, -0.042717915028333664, -0.002361351391300559, -0.013106941245496273, 0.02594265714287758, -0.08163867890834808, 0.032546982169151306, -0.046759165823459625, -0.048440758138895035, 0.012320389039814472, 0.02874983474612236, -0.020816506817936897, -0.042446691542863846, -0.02488487958908081, -0.012767910026013851, 0.053214315325021744, -0.0021426763851195574, -0.09444049745798111, 0.0092826709151268, -0.034228578209877014, -0.03295382112264633, 0.029482141137123108, -0.020599527284502983, -0.010482840240001678, -0.015514061786234379, -0.001995197730138898, -0.0039802249521017075, -0.0432332418859005, -0.008496118709445, -0.016273491084575653, 0.06905385106801987, 0.04437238723039627, -0.017900841310620308, -0.05733693391084671, 0.09292163699865341, -0.01212375145405531, 0.015297082252800465, -0.01521571446210146, 0.03195028752088547, -0.012923864647746086, -0.03463541343808174, -0.003936150576919317, 0.01913491263985634, -0.017209216952323914, 0.046298082917928696, 0.008733440190553665, 0.04776269569993019, 0.00865207239985466, 0.011411786079406738, -0.05080041661858559, -0.01151349488645792, -0.02441023662686348, -0.034526925534009933, 0.002563074929639697, 0.018633147701621056, -0.026932628825306892, -0.0216437429189682, -0.023460950702428818, 0.022647274658083916, -0.027312342077493668, 0.035638947039842606, 0.02845148742198944, 0.014605458825826645, 0.04233819991350174, 0.04575563222169876, -0.010313325561583042, -0.016910869628190994, -0.013723977841436863, -0.029943224042654037, -0.0201113224029541, 0.02752932347357273, -0.015446255914866924, 0.00842831190675497, -0.01714141108095646, -0.007736688945442438, -0.026837699115276337, 0.03647974133491516, -0.03585592657327652, 0.022932061925530434, -0.005766918417066336, 0.014307111501693726, 0.0031597695779055357, -0.03235712647438049, 0.006950136739760637, 0.045999735593795776, 0.019880780950188637, -0.013764661736786366, 0.01383246760815382, 0.01422574371099472, 0.0012501770397648215, 0.017195655032992363, 0.04773557558655739, 0.004478600341826677, 0.02888544648885727, -0.018131380900740623, 0.022525224834680557, -0.006858598440885544, 0.00281734811142087, 0.011425347067415714, -0.01792796328663826, -0.01536488812416792, -0.010564208030700684, 0.005716064013540745, 0.0008636816637590528, -0.07089817523956299, -0.11163614690303802, -0.019433259963989258, -0.059560976922512054, 0.011655888520181179, -0.02796328254044056, -0.010177712887525558, -0.002605453832075, -0.05454332008957863, -0.00246984139084816, -0.01762961596250534, -0.03751039877533913, -0.06769772619009018, 0.016490470618009567, 0.008543582633137703, 0.01731770671904087, 0.005234639625996351, 0.03585592657327652, -0.001270518871024251, -0.024288184940814972, 0.038242705166339874, -0.029319407418370247, -0.02226756140589714, 0.02828875184059143, 0.041199054569005966, -0.042717915028333664, 0.0051295398734509945, -0.015690358355641365, 0.003310638479888439, -0.0029241428710520267, -9.3975177151151e-05, 0.03214014694094658, -0.04296201840043068, -0.006309368181973696, 0.025223910808563232, -0.0017299060709774494, -0.037483274936676025, -0.024640778079628944, -0.019392577931284904, 0.022796448320150375, 0.0023121919948607683, -0.044887714087963104, 0.0073027294129133224, 0.02997034601867199, -0.015080101788043976, -0.010638794861733913, 0.02658003568649292, -0.013954518362879753, 0.02379998192191124, -0.00941828265786171, -0.020355425775051117, 0.019582433626055717, -0.010014977306127548, 0.019731607288122177, -0.044453755021095276, -0.027773424983024597, -0.02286425605416298, -0.013649391010403633, -0.04453512281179428, 0.010801529511809349, -0.024613656103610992, 0.01868739165365696, -0.033442024141550064, 0.017643176019191742, 0.029265161603689194, -0.018321238458156586, 0.007431561127305031, -0.023121919482946396, -0.05394662544131279, -0.01929764822125435, 0.010618452914059162, -0.026200320571660995, -0.039463214576244354, 0.015514061786234379, 0.005343129858374596, -0.006126291584223509, -0.014971612021327019, -0.0015468292403966188, -0.01096426509320736, 0.03753751888871193, -0.04778981953859329, 0.012998451478779316, 0.026457984000444412, -0.01718209497630596, -0.006848427467048168, -0.013113721273839474, -0.010638794861733913, -0.03371324762701988, -0.06254445016384125, 0.0020443573594093323, -0.035910170525312424, -0.018972178921103477, 0.02363724634051323, -0.007790933828800917, 0.00871987920254469, -0.017900841310620308, -0.005516035482287407, 0.024952687323093414, -0.013547681272029877, 0.025874851271510124, -0.009926829487085342, -0.0270682405680418, -0.03197741135954857, -0.0055702803656458855, -0.057553913444280624, -0.006899282336235046, 0.016165001317858696, 0.008299480192363262, -0.028993936255574226, 0.03026869334280491, 0.0038819056935608387, 0.005241420120000839, 0.02796328254044056, 0.021440325304865837, 0.020667333155870438, 0.022470979019999504, 0.005177004262804985, -0.010611672885715961, 0.04464361071586609, 0.0027987014036625624, -0.015554745681583881, 0.003330980194732547, 0.015581867657601833, -0.007295948453247547, -0.02595621906220913, -0.0463252067565918, 0.05668599531054497, 0.027583567425608635, 0.04377569258213043, -0.011106657795608044, -0.016354858875274658, -0.024450920522212982, 0.031434960663318634, 0.007621418219059706, -0.06151379644870758, 0.002956350799649954, -0.009784436784684658, -0.010937142185866833, -0.005671989638358355, 0.019582433626055717, 0.01536488812416792, 0.011574520729482174, 0.0036411937326192856, -0.00150614557787776, 0.015690358355641365, -0.0025478184688836336, 0.04038538038730621, -0.006082217209041119, -0.01383246760815382, -0.018904373049736023, -0.022525224834680557, -0.030377183109521866, -0.016897307708859444, 0.03930048272013664, -0.03837831690907478, 0.013886712491512299, -0.046135347336530685, -0.02487131953239441, -0.0016765085747465491, 0.004817631561309099, 0.03384886309504509, 0.01065235584974289, 0.022037019953131676, 0.016951553523540497, -0.008787685073912144, 0.0045430161990225315, 0.04374856874346733, -0.06428029388189316, -0.006367003545165062, 0.004153130576014519, -0.009987855330109596, 0.058964282274246216, -0.02195565216243267, -0.04095495119690895, -0.014741070568561554, 0.016314174979925156, -0.02211838774383068, -0.015297082252800465, -0.01035400852560997, -0.03675096854567528, -0.01091002020984888, -0.009560676291584969, 0.030350061133503914, -0.002973302500322461, -0.006658570375293493, 0.02363724634051323, 0.003188587259501219, -0.00143918686080724, -0.008604608476161957, 0.014198620803654194, -0.00452267425134778, 0.008584266528487206, -0.02130471169948578, 0.0035394844599068165, -0.037022192031145096, 0.017534686252474785, -0.025861289352178574, -0.022769326344132423, 0.012476343661546707, -0.02548157423734665, -0.005872018169611692, 0.020274057984352112, 0.03420145437121391, 0.04130754619836807, 0.013954518362879753, 0.025874851271510124, 0.016585400328040123, -0.04106344282627106, -0.01960955746471882, -0.014849560335278511, -0.05166833475232124, -0.006031362805515528, -0.02350163273513317, -0.03200453147292137, 0.009275889955461025, -0.04993249475955963, -0.00018244108650833368, 0.060211919248104095, 0.0018087307689711452, 0.009784436784684658, 0.013405288569629192, 0.03368612751364708, -0.002083346014842391, -0.011933893896639347, -0.046108223497867584, 0.012517026625573635, 0.04111768677830696, 0.0270682405680418, -0.001677356194704771, -0.044426631182432175, 0.016422664746642113, -0.01965024136006832, 0.012727226130664349, 0.0081028426066041, 0.006048314273357391, -0.01104563195258379, 0.002159627852961421, 0.0208843145519495, 0.004929511807858944, -0.017399074509739876, 0.0014510529581457376, -0.025549381971359253, 0.021535253152251244, -0.0003867073100991547, -0.02441023662686348, -0.014198620803654194, 0.014849560335278511, 0.013995202258229256, 0.01762961596250534, -0.01653115451335907, 0.021982774138450623, 0.00444469740614295, 0.029590630903840065, 0.023284653201699257, 0.0068552084267139435, -0.027746303007006645, -0.015419133007526398, -0.03843256086111069, -0.005468571092933416, -0.02809889428317547, -0.045837000012397766, -0.016015827655792236, -0.02426106296479702, -0.022199753671884537, -0.03265547379851341, -0.0013145930133759975, -0.013412068597972393, -0.024152573198080063, 0.013527339324355125, 0.02826162986457348, 0.00772990845143795, -0.08896175026893616, -0.035340599715709686, 0.054000869393348694, 0.005522815976291895, 0.017046481370925903, -0.0014654617989435792, -0.007363754790276289, -0.005492303520441055, 0.030648408457636833, -0.03412008658051491, 0.0032733450643718243, -0.023379582911729813, -0.01267298124730587, -0.015120785683393478, 0.007865521125495434, -0.05004098638892174, -0.014117253944277763, 0.009167400188744068, 0.04553865268826485, -0.012564491480588913, -0.018429728224873543, 0.003959883004426956, 0.004454868379980326, 0.026010463014245033, 0.015636112540960312, -0.03851392865180969, -0.0020680895540863276, 0.02026049606502056, 0.004936292301863432, 0.017277022823691368, 0.00493968278169632, -0.003831051057204604, 0.012761129066348076, 0.03371324762701988, -0.03447267785668373, -0.01589377596974373, -0.0208436306566, 0.01636842079460621, -6.510456296382472e-05, 0.007356974296271801, -0.004688799846917391, -0.03542196750640869, 0.04423677548766136, 0.003563216421753168, 0.027881914749741554, -0.0030207668896764517, 0.0324384942650795, 0.009743752889335155, 0.006997601129114628, 0.003637803252786398, -0.02980761229991913, -0.0024783171247690916, 0.0254951361566782, 0.03509649634361267, -0.007831617258489132, 0.016571838408708572, -0.009309792891144753, 0.0008585961768403649, 0.016029389575123787, 0.01947394385933876, -0.010164150968194008, 0.016626084223389626, 0.02472214587032795, -0.015812408179044724, -0.030051713809370995, -0.0061059496365487576, 0.015853092074394226, 0.009743752889335155, 0.017399074509739876, -0.026227442547678947, -0.016015827655792236, -0.012666200287640095, 0.011310076341032982, 0.02455941028892994, 0.017344828695058823, 0.016314174979925156, 0.0108150914311409, 0.03832407295703888, -0.03938185051083565, 0.0018019501585513353, 0.027746303007006645, -0.04545728489756584, -0.006339881103485823, -0.030973877757787704, 0.010998168028891087, 0.004759996198117733, 0.03954458236694336, -0.014103692024946213, -0.02148100920021534, 0.06162228807806969, 0.039625950157642365, -0.007289167959243059, 0.023230409249663353, -0.023718614131212234, 0.0009967513615265489, -0.0073095099069178104, 0.01621924713253975, -0.005146491806954145, 0.03753751888871193, 0.001474785152822733, 0.039815809577703476, 0.024912003427743912, -0.0042480593547225, -0.05652325972914696, 0.013249333947896957, -0.016504032537341118, 0.010082784108817577, 0.0006293264450505376, 0.03770025447010994, -0.01013024803251028, 0.012483123689889908, 0.014958051033318043, 0.011079534888267517, 0.020477475598454475, 0.016124317422509193, -0.000717474496923387, 0.03308943286538124, 0.003347931895405054, 0.027909036725759506, 0.00819777138531208, 0.01718209497630596, 0.03398447483778, -0.02024693600833416, 0.009153839200735092, 0.005010879132896662, -0.05221078544855118, 0.0010170931927859783, 0.00950643140822649, 0.030105959624052048, -0.007323070894926786, -0.0018748417496681213, 0.042555179446935654, 0.00956745631992817, 0.005163443274796009, -0.007295948453247547, 0.016639644280076027, 0.009696288965642452, 0.03420145437121391, -0.044399507343769073, 0.052753232419490814, -0.011425347067415714, 0.020599527284502983, 0.06243596225976944, 0.01712784916162491, -0.011330418288707733, 0.0016875271685421467, 0.022796448320150375, -0.018877249211072922, -0.019568873569369316, 0.009689508005976677, 0.021277589723467827, -0.016598960384726524, 0.0029834734741598368, 0.010014977306127548, -0.006072046235203743, 0.023677930235862732, -0.01791440136730671, -0.015446255914866924, 0.01065235584974289, 0.020599527284502983, 0.01150671485811472, 0.01044215727597475, 0.000614070042502135, -0.0005060038529336452, -0.0016281966818496585, -0.010008197277784348, -0.02687838301062584, -0.01944682188332081, -0.016273491084575653, 0.02564430981874466, -0.0025478184688836336, -0.01575816422700882, 0.05842183530330658, 0.04510469362139702, 0.007899424061179161, 0.02488487958908081, 0.011594862677156925, -0.0065602511167526245, 0.03460828959941864, 0.029563508927822113, 0.005204126704484224, 0.007709566503763199, -0.007085749413818121, 0.04035825654864311, 0.02723097614943981, 0.039788685739040375, 0.015663234516978264, 0.030702654272317886, 0.029102426022291183, 0.02301342971622944, 0.014320672489702702, 0.035638947039842606, -0.030377183109521866, 0.016815941780805588, 0.0008454587077721953, -0.036723844707012177, 0.03154345229268074, 0.02256590873003006, -0.03016020357608795, -0.0037225610576570034, -0.05364827439188957, 0.05608930066227913, -0.0013468009419739246, 0.026607157662510872, -0.013425630517303944, 0.02038254775106907, -0.020762262865900993, -0.008238455280661583, 0.0008772428845986724, 0.020816506817936897, -0.00272750505246222, -0.0088961748406291, -0.02177935652434826, 0.03357763588428497, -0.0005360928480513394, -0.019704485312104225, -0.0003379716072231531, -0.00819777138531208, -0.0324384942650795, -0.011459250003099442, -0.04203985258936882, -0.009004665538668633, -0.014958051033318043, 0.0029275333508849144, -0.01729058474302292, 0.0012459391728043556, 0.013717196881771088, -0.01119480561465025, -0.014144375920295715, 0.016287053003907204, 7.00311065884307e-05, 0.019107790663838387, -0.005231249611824751, 0.010760846547782421, -0.013181528076529503, -0.0239627156406641, -0.0017078689998015761, -0.026051146909594536, 0.0025529039558023214, 0.026200320571660995, 0.014713948592543602, -0.003112305188551545, 0.01150671485811472, -0.00768244406208396, 0.0017197350971400738, -0.01437491737306118, 0.012544149532914162, 0.020680895075201988, -0.001440034480765462, -0.01821274869143963, 0.009926829487085342, 0.020613089203834534, 0.00987936556339264, -0.01351377833634615, 0.028044650331139565, -0.007201019674539566, 0.02257946878671646, 0.04157876968383789, 0.04312475025653839, 0.006072046235203743, -0.016626084223389626, 0.013635830022394657, -0.006261903792619705, -0.02377285808324814, 0.021060610190033913, -0.012313608080148697, -0.01531064324080944, -0.01289674174040556, 0.001818901626393199, 0.020029954612255096, -0.035015128552913666, 0.01407657004892826, 0.004644725471735001, 0.019080668687820435, 0.00795366894453764, 0.012157654389739037, -0.0024037302937358618, -0.0025885021314024925, 0.002976692747324705, 0.00030279712518677115, -0.029102426022291183, -0.005624525249004364, -0.011418566107749939, -0.014781754463911057, -0.007099310401827097, 0.018470412120223045, -0.040087033063173294, 0.014700386673212051, 0.03325216844677925, -0.02812601812183857, 0.02365080639719963, 0.044589366763830185, 0.008713098242878914, -0.019365454092621803, -0.01589377596974373, -0.002674955176189542, -0.014049447141587734, 0.010659136809408665, 0.029400773346424103, -0.035313475877046585, 0.023243969306349754, 0.012659420259296894, 0.038866519927978516, 0.016639644280076027, 0.024355992674827576, 0.019894342869520187, -0.016598960384726524, -0.042717915028333664, -0.0003739936510100961, 0.00405142130330205, -0.010523524135351181, 0.032221511006355286, 0.00711287185549736, 0.006753498688340187, 0.0033360656816512346, 0.013839248567819595, -0.0020630040671676397, -0.029482141137123108, 0.013561243191361427, -0.030675530433654785, -0.00644837087020278, 0.02335245907306671, -0.011011729016900063, -0.007397657725960016, -0.012835715897381306, -0.014808877371251583, 0.009953952394425869, -0.009255548007786274, -0.007180678192526102, 0.018755199387669563, 0.02054528333246708, 0.024681461974978447, -0.011669449508190155, 0.0216301828622818, -0.03322504460811615, -0.0029919492080807686, -0.01822631061077118, -0.01699223741889, 0.0036039003171026707, -0.010611672885715961, 0.02738014981150627, 0.017833033576607704, -0.004627774003893137, -0.004339597653597593, -0.003736122278496623, 0.022050580009818077, -0.002193531021475792, -0.018660269677639008, -0.01806357502937317, -0.0021867502946406603, 0.07078968733549118, -0.0009145363001152873, -0.02457297220826149, -0.01748044230043888, -0.03631700947880745, 0.04364008083939552, -0.020355425775051117, -0.01189999096095562, -0.02304055169224739, 2.545381721574813e-05, 0.0112083675339818, 0.01929764822125435, -0.00871987920254469, 0.0035089715383946896, 0.023216847330331802, -0.036859456449747086, -0.006773840636014938, 0.026851261034607887, 0.00733663234859705, 0.0024427189491689205, 0.032682593911886215, 0.019351894035935402, -0.01791440136730671, 0.00857070554047823, -0.01745332032442093, 0.0025868071243166924, -0.015161469578742981, 0.012537368573248386, 0.015012295916676521, 0.035015128552913666, 0.025142544880509377, -0.030865387991070747, -0.04556577652692795, 0.0012145787477493286, -0.013412068597972393, 0.030512796714901924, -0.013120502233505249, 0.018917933106422424, -0.005516035482287407, 0.011486372910439968, 0.005868627689778805, 0.03043142892420292, -0.01944682188332081, 0.03233000263571739, -0.025698555633425713, -0.021128416061401367, 0.009214864112436771, 0.01733126863837242, -0.012103409506380558, 0.013669732958078384, -0.009628482162952423, -0.014293549582362175, 0.03379461541771889, -0.017385512590408325, 0.03016020357608795, -0.024925563484430313, 0.012666200287640095, 0.03604578226804733, 0.011852526105940342, 0.01044215727597475, -0.05313294753432274, -0.00011145646567456424, -0.02103348821401596, -0.012503465637564659, -0.022023458033800125, -0.04694902151823044, 0.0038140995893627405, 0.023379582911729813, 0.005516035482287407, 0.020613089203834534, -0.015337765216827393, -0.0017299060709774494, 0.0031326471362262964, 0.03029581718146801, 0.014944489113986492, 0.01173725537955761, 0.007634979672729969, 0.029400773346424103, 0.013147625140845776, 0.017100727185606956, -0.015134346671402454, 0.0007293405942618847, -0.005343129858374596, 0.013730757869780064, 0.005705893039703369, 0.001579037168994546, 0.019826536998152733, -0.018592463806271553, -0.008190990425646305, 0.044453755021095276, -0.013378165662288666, -0.01917559653520584, 0.036398377269506454, -0.006929795257747173, -0.0062517328187823296, -0.002373217372223735, -0.02999746799468994, -0.014727509580552578, 0.031245103105902672, -0.013839248567819595, -0.03984292969107628, -0.0011399919167160988, -0.022131947800517082, -0.005685551092028618, 0.0061195106245577335, 0.010320105589926243, -0.047220248728990555, -0.017710983753204346, 0.024301746860146523, 0.02748863957822323, -0.01398164127022028, -0.00432264618575573, -0.009689508005976677, 0.00857070554047823, 0.008096061646938324, 0.018483974039554596, -0.008597827516496181, 0.02145388536155224, -0.014822438359260559, -0.030105959624052048, 0.02165730483829975, 0.011954235844314098, 0.023745736107230186, 0.016788817942142487, -0.009947171434760094, -0.022226877510547638, -0.011025290004909039, -0.0008399494690820575, -0.01992146484553814, -0.014293549582362175, 0.007709566503763199, 0.0008535106899216771, 0.003997176419943571, -0.0008196075796149671, 0.0340115949511528, 0.03289957344532013, -0.01072694268077612, 0.009391160681843758, 0.019243404269218445, -0.009994636289775372, -0.006655179895460606, 0.026986872777342796, 0.00020331269479356706, 0.024491604417562485, 0.020124884322285652, 0.002332533709704876, 0.013554462231695652, 0.0037191708106547594, 0.0053804232738912106, -0.0055702803656458855, 0.008509679697453976, 0.00552959693595767, 0.008468995802104473, 0.01791440136730671, 0.005888969637453556, 0.01578528620302677, 0.001952818944118917, 0.011845745146274567, -0.012550930492579937, 0.013249333947896957, 0.004298913758248091, -0.009675947017967701, -0.004678628873080015, 0.010848994366824627, 0.05546548217535019, -0.0162056852132082, -0.030973877757787704, 0.012347511947154999, 0.008211332373321056, 0.01158808171749115, 0.008597827516496181, -0.01158130168914795, -0.017344828695058823, -0.0018256823532283306, -0.027881914749741554, -0.013913835398852825, -0.02704111859202385, 0.024139011278748512, -0.01960955746471882, 0.006892501842230558, -0.014252865687012672, 0.008062158711254597, 0.006489054765552282, -0.007940107956528664, -0.005326177924871445, -0.0015222495421767235, -0.009397941641509533, 0.0017053262563422322, -0.0012789947213605046, 0.0001238522818312049, 0.00903856847435236, -0.019392577931284904, 0.008170648477971554, 0.003925979603081942, 0.03072977624833584, 0.03216726705431938, 0.015500500798225403, 0.046596430242061615, 0.05457044020295143, 0.007343412842601538, -0.016666768118739128, -0.018470412120223045, -0.0027241145726293325, -0.01870095357298851, -0.004587090574204922, 0.017236338928341866, -0.011337199248373508, -0.006041533779352903, -0.001297641429118812, -0.007221361622214317, 0.009499650448560715, -0.021074172109365463, 0.005488913040608168, 0.005112588405609131, -0.0028563367668539286, 0.0016358249122276902, -0.007974010892212391, 0.02268795855343342, -0.025752799585461617, -0.01993502676486969, 0.011859307065606117, 0.006624666973948479, 0.003114000428467989, 0.005349910352379084, -0.03447267785668373, 0.014903806149959564, 0.0030716215260326862, -0.006000849884003401, -0.012801812961697578, 0.00501765962690115, -0.006889111362397671, -0.007438341621309519, -0.005495693534612656, -0.01437491737306118, 0.014659703709185123, 0.007255265023559332, 0.026539351791143417, -0.013018793426454067, 0.0011408395366743207, 0.010916800238192081, 0.015961581841111183, 0.005434668157249689, 0.018782321363687515, 0.01687018573284149, 0.005126149859279394, 0.03374037146568298, 0.02057240530848503, 0.048440758138895035, -0.02983473427593708, 0.004620993509888649, -0.029021060094237328, 0.01668032817542553, 0.017236338928341866, -0.031299348920583725, -0.014741070568561554, -0.030567040666937828, -0.014198620803654194, 0.0007971468148753047, 0.02644442394375801, 0.022782888263463974, -0.0006475493428297341, -0.0054177166894078255, -0.004620993509888649, 0.016910869628190994, -0.04925443232059479, 0.02891257032752037, -0.026037586852908134, 0.028966814279556274, 0.003770025447010994, -0.019989272579550743, -0.0017883889377117157, -0.013106941245496273, -0.010720162652432919, -0.005099027417600155, -0.013032354414463043, 0.008936858735978603, 0.0013849418610334396, 0.010150589980185032, -0.008679195307195187, 0.003422518726438284, 0.03355051577091217, 0.011771158315241337, 0.0006462779711000621, -0.02674277126789093, -0.00494307279586792, 0.03493376076221466, -0.008475776761770248, 0.01051674410700798, 0.0162463691085577, 0.003695438615977764, 0.015554745681583881, 0.015066540800035, 0.007329851854592562, -0.017399074509739876, -0.01604294963181019, 0.011635546572506428, -0.00018116972933057696, -0.00506173400208354, -0.04749147221446037, 0.011615204624831676, -0.010882897302508354, -0.006319539155811071, 0.0006721290992572904, 0.024979809299111366, 0.006668740883469582, 0.03441843390464783, -0.012944206595420837, 0.06937931478023529, 0.013879931531846523, 0.024518726393580437, -0.005760137923061848, -0.022823572158813477, -0.018578901886940002, 0.022525224834680557, 0.027122486382722855, 0.0003708152216859162, 0.011567739769816399, 0.009859023615717888, -0.029753366485238075, 0.04654218629002571, 0.005716064013540745, 0.025440892204642296, 0.019067106768488884, -0.004078543744981289, 0.025101860985159874, -0.0201113224029541, 0.02828875184059143, -0.004932901822030544, 0.013574804179370403, -0.008747001178562641, 0.007797714788466692, -0.008367286995053291, 0.009852242656052113, -0.007221361622214317, -0.018592463806271553, 0.023610124364495277, 0.018307678401470184, 0.030377183109521866, 0.027936160564422607, -0.03845968469977379, -0.03441843390464783, 0.013127283193171024, -0.035286352038383484, -0.013995202258229256, 0.002496963832527399, 0.006597544532269239, -0.03260122612118721, 0.01760249398648739, -0.015147908590734005, -4.555729901767336e-05, 0.048576369881629944, 0.04049387201666832, 0.024057645350694656, -0.005421106703579426, -0.004651506431400776, 0.0247492678463459, 0.006350052077323198, -0.019745169207453728, -0.027136046439409256, 0.00733663234859705, -0.023406704887747765, 0.002812262624502182, 0.0293465293943882, 0.009865803644061089, 0.010679478757083416, -0.01590733788907528, -0.0185382179915905, -0.011228708550333977, -0.02347451075911522, -0.025427330285310745, 0.007872301153838634, 0.02180647850036621, 0.019216280430555344, 0.02719029225409031, -0.03699507191777229, -0.04046674817800522, -0.0004831192782148719, -0.018321238458156586, 0.011744036339223385, -0.02146744728088379, 0.033143676817417145, -0.03414721041917801, 0.01314084418118, -0.03829694911837578, -0.016354858875274658, -0.009906487539410591, -0.0032750400714576244, 0.054787419736385345, -0.004261620342731476]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
"-token generation. We show that SparQ Atten-
tion performs favourably compared to other state-of-the-art
methods, giving up to 8×compression without substantial
loss in accuracy. SparQ Attention is robust across tasks and
models, demonstrated by evaluation on Llama 2, Mistral
and Pythia. We also provide benchmarks measured on IPU
and GPU, showing the practical computational benefits of
our approach.
2. Background
In this section we provide a straightforward framework to
understand the computational efficiency of sequence gen-
eration using transformer models (similar to the modelling
introduced by Kaplan et al. (2020)) and use it to motivate
transfer-efficient attention mechanisms.
Arithmetic intensity A compute unit capable of rAscalar
arithmetic operations per second is connected to a memory
via an interface that can transfer rMscalar elements per
second, processing a workload requiring Aarithmetic op-
erations and Mtransfers. Assuming concurrent compute
and data transfer, when the arithmetic intensity A/Mof
the workload is less than the ratio rA/rM, execution time
is limited by rM.
Sequence generation Consider a full transformer layer,
with Nparameters, batch size B, and Celements in
the attention KV cache per batch element. We assume
Grouped Query Attention (GQA) (Ainslie et al., 2023) with
ggrouped-query heads ( g=1for standard multi-head atten-
tion). This implies the arithmetic intensity:
A
M=BN+BCg
N+BC=N+Cg
N/B +C(1)
We can increase arithmetic intensity by making Blarge,
causing A/Mto approach N/C +g. Hence the limiting
factor for large-batch transformer inference is the ratio of
the KV cache size per-item to the size of the model.
We can alternatively express this in terms of the model’s
basic hyperparameters. A standard transformer with model
dimension dmand sequence-length S, has N= 12( dm)2
andC= 2S dm/g, giving:
A
M=6 +ρ g
6/B+ρ(2)Table 1: Excess correlation ratio η(Roche et al., 1998)
along axes of V(excess: subtract d−0.5, so uniform random
data= 0.0). This demonstrates substantial auto-correlation
along the sequence axis. Calculated for Llama 7B over 40
SQuAD examples.
B S Layer Head dh
η−d−0.50.143 0.256 0.0 0 .0 0 .0
where ρ=S/(gdm). The value ρunderlies the KV cache-
model size relationship outlined above, determining the
point at which the model becomes memory bandwidth
bound.
For typical examples (see Appendix C), sequence genera-
tion exhibits a large-batch arithmetic intensity of just 7for
multi-head attention with S=dm, up to 100for grouped-
query attention with S≪dm, while ML hardware can
provide rA/rM>200. This means that data transfer is
the performance-limiting factor, motivating the search for
transfer-efficient alternatives to full attention.
3. Approximating Attention
In this section we examine several properties of the attention
operation that enable us to introduce an accurate bandwidth-
efficient approximation.
Consider a single attention query head with the head dimen-
siondh, processing an input token sequence of length S.
During autoregressive generation, the output of the attention
head is calculated as:
y= softmaxq·K⊤
√dh
·V (3)
where qis the query, and K∈RS×dhandV∈RS×dhare
the key and value caches respectively. When using GQA
(Ainslie et al., 2023), KandVare shared across gquery
heads.
For each forward pass, we need to fetch the key and value
matrices from memory, as well as write (append) kand
vvectors for the current token, giving a total number of
elements transferred per attention head:
Mbase= 2S dh|{z}
1⃝+ 2dh|{z}
2⃝(4)
where 1⃝corresponds to reading the KandVcaches and
2⃝corresponds to writing the current kandvto memory.
Attention scores sparsity First, consider the attention
scores s∈(0,1)Sin Equation (3):
s= softmaxq·K⊤
√dh
(5)
2
SparQ Attention: Bandwidth-Efficient LLM Inference
q[i","[0.04612963646650314, 0.030821697786450386, 0.027297012507915497, 0.010824899189174175, -0.004415504168719053, -0.02351505123078823, -0.000333655159920454, 0.027554288506507874, -0.05173825845122337, -0.0014737106394022703, 0.0035825720988214016, -0.01925712823867798, -0.02693682536482811, 0.02639654465019703, -0.00862518697977066, -0.02561185322701931, 0.036893416196107864, -0.047544654458761215, 0.02703973650932312, -0.003473229706287384, -0.03298281878232956, -0.015423712320625782, 0.01869112066924572, 0.03496384620666504, 0.010020910762250423, -0.015282210893929005, -0.0011633711401373148, 0.0002144638856407255, 0.03959481790661812, -0.03838561847805977, 0.047441743314266205, -0.030075596645474434, -0.031053245067596436, -0.06298123300075531, 0.01258724182844162, 0.07918963581323624, -0.01054832711815834, 0.04232194647192955, -0.04118993133306503, 0.018716849386692047, 0.009744338691234589, -0.041498661041259766, -0.05122370645403862, 0.020517783239483833, 0.01834379881620407, 0.004910761024802923, 0.008264999836683273, -0.021508296951651573, -0.006026696413755417, 0.052690181881189346, -0.012233486399054527, 0.050837792456150055, -0.06735492497682571, 0.03161925449967384, 0.016774412244558334, -0.0029007899574935436, -0.014523245394229889, 0.03398619592189789, 0.023695144802331924, 0.01924426481127739, 0.025984903797507286, -0.03933754190802574, 0.007325941696763039, 0.009744338691234589, -0.02243449166417122, 0.01422737818211317, -0.01725037395954132, 0.03972345590591431, -0.009834385477006435, 0.015565214678645134, -0.030178505927324295, 0.05011741816997528, 0.05768134072422981, -0.020813649520277977, 0.004302945453673601, 0.013043906539678574, 0.00414857966825366, 0.04782765731215477, 0.011423066258430481, 0.01016884483397007, 0.04476607218384743, -0.016529999673366547, 0.049860142171382904, -0.024029603227972984, -0.01879403181374073, -0.0404181033372879, -0.018845487385988235, -0.039414726197719574, -0.0367390513420105, -0.005158389452844858, -0.028120296075940132, 0.05871044471859932, -0.022241532802581787, 0.006103879306465387, 0.035452671349048615, 0.05022032931447029, 0.0299984123557806, -0.005917354021221399, 0.013442684896290302, 0.024891478940844536, 0.03910599276423454, 0.012915268540382385, 0.03452647477388382, -0.04991159588098526, 0.02374660037457943, -0.016761548817157745, -0.008818143978714943, 0.002957069082185626, -0.01813797652721405, 0.0019360039150342345, -0.028866397216916084, -0.00590449059382081, -0.014973479323089123, 0.024685658514499664, 0.020311960950493813, -0.04823930189013481, -0.017096007242798805, -0.012883109040558338, -0.007248758804053068, 0.050194598734378815, -0.024158241227269173, 0.0012686935951933265, 0.020144732668995857, -0.012066257186233997, 0.006689182948321104, -0.022048575803637505, 0.020749330520629883, -0.0560862272977829, 0.011095039546489716, 0.005077990237623453, 0.05186689645051956, 0.005312754772603512, 0.022280124947428703, -0.0017446547280997038, 0.017070280387997627, -0.04913976788520813, -0.02791447564959526, 0.019964639097452164, -0.04690146446228027, 0.030384328216314316, 0.0005539479898288846, 0.003370319027453661, -0.025264529511332512, 0.015012070536613464, -0.04010936990380287, 0.04612963646650314, -0.039646271616220474, 0.0253931675106287, -0.020402008667588234, 0.029509589076042175, -0.023708008229732513, -0.021572615951299667, -0.08232840895652771, -0.014626155607402325, -0.006097447592765093, -0.05240717530250549, -0.060202647000551224, 0.032596904784440994, 0.023450732231140137, -0.03926035761833191, 0.017211781814694405, 0.0069207316264510155, 0.026576638221740723, -0.027194101363420486, -0.019089899957180023, 0.021289611235260963, -0.07352955639362335, -0.004630973096936941, -0.06246667727828026, -0.04736456274986267, -0.01892266981303692, -0.03174789249897003, -0.02087796851992607, -0.056137681007385254, 0.013378365896642208, -0.0005499280523508787, -0.037536606192588806, -0.02781156450510025, -0.03208234906196594, -0.05454256758093834, 0.0032272092066705227, 0.020710740238428116, 0.0012783415149897337, 0.009988751262426376, 0.007158712018281221, 0.002077505923807621, -0.025225939229130745, 0.0013659761752933264, 0.006094231735914946, 0.008380774408578873, -0.02637081779539585, 0.036558959633111954, 0.04234767332673073, 0.009551381692290306, -0.023913828656077385, -0.05768134072422981, 0.03223671764135361, 0.03738224133849144, 0.019437221810221672, -0.008194249123334885, 0.040726833045482635, 0.009313400834798813, 0.021302474662661552, -0.05582895129919052, 0.0367390513420105, 0.011583863757550716, -0.004891464952379465, -0.020749330520629883, -0.05871044471859932, -0.03164498135447502, 0.013584187254309654, -0.018613938242197037, 0.03637886419892311, -0.016131222248077393, -0.02474997751414776, 0.0206721480935812, -0.031825073063373566, 0.03290563449263573, 0.021366793662309647, 0.036996327340602875, -0.0007549450383521616, 0.007036506198346615, -0.009171899408102036, 0.030307143926620483, -0.06416469812393188, 0.05361637473106384, 0.02405533194541931, -0.021456841379404068, 0.012323533184826374, -0.032931361347436905, 0.008117066696286201, 0.045229166746139526, 0.011204381473362446, -0.027888746932148933, 0.0006484165787696838, -0.04947422817349434, 0.047776203602552414, -0.015127845108509064, -0.0029297336004674435, -0.05145525559782982, -0.02935522235929966, 0.0038269844371825457, 0.015758171677589417, 0.016903050243854523, 0.0041389320977032185, 0.03282845392823219, -0.012188463471829891, -0.01902558095753193, 0.04209039732813835, 0.04965431988239288, -0.025097299367189407, -0.02639654465019703, -0.060305558145046234, 0.03573567420244217, -0.051403798162937164, 0.002863806439563632, -0.01912849023938179, 0.0652967169880867, -0.01856248266994953, 0.022678902372717857, -0.024544157087802887, -0.015655260533094406, -0.009622132405638695, -0.007679696660488844, 0.0033928307238966227, -0.016645774245262146, 0.005917354021221399, -0.016980234533548355, -0.019282856956124306, -0.012040529400110245, -0.012715879827737808, 0.0051390933804214, 0.0037594495806843042, -0.011841140687465668, -0.04957713559269905, -0.027785837650299072, 0.00599453691393137, -0.004142147954553366, -0.03056442178785801, 0.025547534227371216, -0.005930217914283276, 0.0014302952913567424, 0.09678733348846436, 0.024261152371764183, 0.0012582417111843824, -0.026962552219629288, 0.022357307374477386, 0.005258083809167147, -0.016452817246317863, -0.037202149629592896, 0.04252776876091957, -0.02233158051967621, 0.05531439930200577, -0.024685658514499664, 0.0012646736577153206, 0.011468090116977692, -0.02727128379046917, -0.025097299367189407, 0.007042937912046909, -0.00536099448800087, 0.0369706004858017, 0.009268377907574177, 0.031181883066892624, -0.008483684621751308, 0.0010966401314362884, 0.03035859949886799, -0.01925712823867798, 0.018974125385284424, -0.014806249178946018, 0.026448000222444534, 0.002272071084007621, 0.024222560226917267, -0.025020116940140724, 0.042939409613609314, -0.03987782076001167, -0.0015766212018206716, -0.004949352238327265, -0.03658468648791313, 0.028068840503692627, -0.02989550307393074, -0.020517783239483833, -0.06709764897823334, -0.013880054466426373, -0.02164979837834835, 0.023270638659596443, -0.03342018648982048, -0.050065960735082626, 0.009216922335326672, -0.008670209906995296, -0.015217890962958336, 0.04957713559269905, 0.007583218161016703, 0.00530310720205307, -0.005615054629743099, -0.04155011847615242, -0.012420011684298515, -0.0067342063412070274, 0.02077505923807621, -0.0027367763686925173, 0.01869112066924572, -0.07044224441051483, -0.013777144253253937, -0.019758816808462143, -0.024042466655373573, -0.04867666959762573, 0.018047930672764778, 0.029149401932954788, -0.00749960308894515, 0.06694328784942627, -0.028274662792682648, 0.012477898970246315, 0.00453770998865366, 0.062157947570085526, -0.04420006275177002, 0.020620692521333694, 0.0038012568838894367, -7.03992263879627e-05, -0.039955005049705505, -0.023720871657133102, -0.0056182704865932465, -0.024557020515203476, 0.024454109370708466, 0.05814443528652191, -0.02750283293426037, 0.014253105036914349, 0.021135246381163597, 0.002916869707405567, 0.05173825845122337, 0.0064962259493768215, -0.01991318352520466, -0.011519544757902622, 0.04993732273578644, 0.004013509955257177, -0.042502038180828094, -0.017546242102980614, -0.044585976749658585, -0.025689035654067993, 0.02750283293426037, -0.0017173191299661994, 0.02131533809006214, -0.01856248266994953, 0.02616499736905098, -0.022678902372717857, -0.021058062091469765, 0.051506709307432175, 0.0015581294428557158, -0.005213060416281223, -0.0006230909493751824, -0.06838402897119522, -0.01736614853143692, -0.016079766675829887, 8.929295290727168e-05, -0.004209682811051607, 0.01933431252837181, 0.0070236423052847385, 0.04152439162135124, 0.026345090940594673, 0.02571476250886917, 0.0382312536239624, 0.054130926728248596, 0.018099386245012283, 0.0024023172445595264, -0.008946781978011131, -0.010496871545910835, 0.039414726197719574, -0.016298452392220497, -0.0030133482068777084, 0.02925231121480465, 0.026074949651956558, 0.0033317278139293194, 0.06478216499090195, -0.007242327090352774, 0.030204234644770622, -0.02056923694908619, 0.01813797652721405, -0.027297012507915497, -0.025972040370106697, -0.002429652726277709, -0.002222223673015833, 0.0585046224296093, -0.05768134072422981, -0.027451377362012863, -0.03244253620505333, 0.010400393046438694, -0.05495421215891838, -0.010374665260314941, 0.0036436752416193485, -0.04741601645946503, 0.02693682536482811, -0.022498810663819313, -0.04968004673719406, 0.007017210125923157, -0.0036758347414433956, -0.028120296075940132, -0.000391140318242833, -0.0006922339671291411, -0.002773759886622429, 0.030976062640547752, -0.0032561528496444225, -0.06354723870754242, 0.010959968902170658, -0.04494616389274597, -0.013725688681006432, -0.00957067683339119, -0.03856571391224861, 0.015565214678645134, 0.006007400806993246, -0.026345090940594673, 0.010728420689702034, -0.046464093029499054, -0.0340891070663929, 0.008933918550610542, 0.050529059022665024, 0.008432229980826378, -0.02208716794848442, -0.04206467047333717, 0.08520989865064621, -0.0019585154950618744, 0.0012518098810687661, -0.037227876484394073, 0.032596904784440994, -0.02000322937965393, -0.024376926943659782, -0.019836001098155975, -0.014201650395989418, -0.022717494517564774, 0.03684196248650551, -0.01012382097542286, 0.04144720733165741, 0.013146817684173584, -0.004476607311517, -0.020517783239483833, 0.009776498191058636, -0.006882140412926674, -0.016298452392220497, -0.004032805562019348, 0.04275931790471077, -0.004540926311165094, -0.0067663658410310745, -0.03179934620857239, 0.02703973650932312, -0.03344591334462166, 0.026422273367643356, 0.016581455245614052, -0.00019044474174734205, 0.06488507241010666, 0.06467925757169724, -0.038076888769865036, 0.03835989162325859, -0.014639019966125488, -0.008605890907347202, -0.025920584797859192, 0.03378037363290787, -0.013429821468889713, 0.023656552657485008, 0.006830684840679169, -0.0025277393870055676, -0.006164982449263334, -0.001989067066460848, -0.045254897326231, 0.04389133304357529, -0.008631618693470955, 0.02373373508453369, 0.012722311541438103, -0.019462950527668, -0.006197141949087381, 0.0479048416018486, 0.03442356362938881, -0.020517783239483833, 0.015256483107805252, 0.008734529837965965, -0.018536755815148354, -0.01671009324491024, 0.04602672532200813, -0.005508928094059229, 0.02724555693566799, 0.010072366334497929, 0.01182184461504221, -0.008882462978363037, 0.013597050681710243, -0.004650268703699112, -0.009358424693346024, -0.025328848510980606, -0.007081529125571251, -0.010355370119214058, -0.016684366390109062, -0.03802543133497238, -0.12133149057626724, -0.021276747807860374, -0.07677123695611954, 0.01647854596376419, -0.005418881308287382, -0.0302299614995718, 0.020594965666532516, -0.027760108932852745, -0.007814766839146614, -0.002243127441033721, -0.028866397216916084, -0.059636641293764114, 0.040057916194200516, -0.021353930234909058, 0.00862518697977066, 0.016221268102526665, 0.01835666224360466, 0.01307606603950262, -0.03169643506407738, 0.011847572401165962, -0.019655907526612282, -0.016465680673718452, 0.02363082580268383, -0.004106772597879171, -0.013275455683469772, 0.0014190394431352615, -0.0027287364937365055, -0.048753853887319565, 0.004376912489533424, 0.008078474551439285, 0.03141343221068382, -0.008445093408226967, -0.02143111266195774, 0.03637886419892311, 0.003987782169133425, -0.028300389647483826, -0.02626790665090084, -0.037202149629592896, 0.044122882187366486, 0.0024425166193395853, -0.03972345590591431, 0.01856248266994953, -0.0023733736015856266, -0.015205027535557747, 9.301140380557626e-05, 0.02891785278916359, -0.03360028192400932, 0.0003455139813013375, -0.01248433068394661, 0.006300052627921104, 0.03241680935025215, -0.028995035216212273, 0.02199712023139, -0.0430680476129055, -0.010747715830802917, -0.009969455190002918, -0.010265323333442211, -0.055674586445093155, 0.013494140468537807, -0.019179945811629295, 0.032159533351659775, -0.023991012945771217, 0.01647854596376419, 0.020504917949438095, -0.011262268759310246, 0.00829715933650732, -0.007049369625747204, -0.03717642277479172, -0.025586124509572983, -0.02386237494647503, -0.022357307374477386, -0.03933754190802574, -0.003942758776247501, 0.03805116191506386, 0.021418249234557152, -0.0051937648095190525, 0.010413257405161858, -0.010676965117454529, 0.02329636551439762, -0.036893416196107864, 0.020157596096396446, 0.025534668937325478, -0.002037306549027562, -0.0045955972746014595, -0.000428927771281451, -0.01770060695707798, -0.019643044099211693, -0.021263884380459785, -0.009763634763658047, -0.04528062418103218, -0.0010572447208687663, 0.035787127912044525, -0.000647612614557147, 0.02750283293426037, -0.017121735960245132, 0.02068501152098179, 0.03645604848861694, -0.007390260696411133, 0.03527257591485977, 0.001592700951732695, -0.033265821635723114, -0.02637081779539585, -0.006222869735211134, -0.06786947697401047, -0.006483362056314945, 0.002109665423631668, 0.011262268759310246, -0.025457486510276794, 0.02716837450861931, -0.002289758762344718, -0.01287024561315775, 0.03473229706287384, -0.006251813378185034, 0.0006202770164236426, 0.014934887178242207, -0.00019315819372422993, -0.01847243681550026, 0.03233962878584862, 0.02374660037457943, -0.014034420251846313, 0.0023122704587876797, -0.01671009324491024, -0.024042466655373573, -0.048985403031110764, -0.040932655334472656, 0.04365978389978409, 0.005270947702229023, 0.04757038131356239, -0.024325471371412277, -0.03210807964205742, -0.036095861345529556, 0.013982965610921383, 0.004907544702291489, -0.05266445130109787, -0.022588856518268585, -0.014471789821982384, -0.03573567420244217, 0.01901271566748619, 0.02968968078494072, 0.025341711938381195, 0.01155170425772667, -0.02375946380198002, -0.02274322137236595, -0.011455225758254528, 0.017893563956022263, 0.025367440655827522, 0.01988745480775833, 0.0034764455631375313, -0.007203735411167145, -0.0157195795327425, -0.03406337648630142, -0.003534332849085331, 0.044791799038648605, -0.03342018648982048, -0.005927002057433128, -0.04800775274634361, 0.004495902918279171, 0.013507003895938396, 0.009191194549202919, 0.02035055309534073, -0.0017993259243667126, 0.030641604214906693, -0.00213217712007463, -0.02428687922656536, 0.02230585180222988, 0.048419393599033356, -0.03146488964557648, 0.0032738405279815197, -0.007846926338970661, 0.0004940508515574038, 0.06061428785324097, -0.02485288679599762, -0.018163705244660378, -0.03496384620666504, 0.02770865522325039, -0.013635641895234585, 0.005010455381125212, -0.018652530387043953, -0.04708155617117882, -0.01555235031992197, 0.027065463364124298, 0.04543498903512955, -0.020517783239483833, -0.01615694910287857, 0.0355813093483448, -0.00847082119435072, 0.005000807344913483, -0.006895003840327263, 0.011583863757550716, 0.002998876618221402, 0.013455549255013466, -0.024338334798812866, -0.0021804163698107004, -0.022794676944613457, 0.011275132186710835, -0.03792252391576767, -0.02529025822877884, -0.00906255654990673, -0.03367746248841286, -0.023219183087348938, 0.010085229761898518, 0.023579370230436325, 0.028300389647483826, 0.018819758668541908, 0.029046490788459778, 0.006605568341910839, -0.04108702018857002, -0.023656552657485008, 0.0019440437899902463, -0.04615536332130432, -0.004257922060787678, -0.03254544734954834, -0.0302299614995718, 0.00656697666272521, -0.013777144253253937, -0.005258083809167147, 0.045769449323415756, 0.009017533622682095, 0.0411127470433712, 0.004126068204641342, 0.025907719507813454, 0.0059688095934689045, -0.01925712823867798, -0.031284794211387634, 0.01081846747547388, 0.022370170801877975, 0.006004184950143099, 0.01131372433155775, -0.01467761117964983, 0.028531938791275024, -0.025200210511684418, 0.017752062529325485, -0.0012075904523953795, 0.004740315489470959, -0.03342018648982048, -0.018974125385284424, 0.030204234644770622, 0.0007758487481623888, -0.023347821086645126, 0.012021233327686787, -0.01968163438141346, 0.03002414107322693, 0.024248288944363594, -0.01098569668829441, 0.008959646336734295, 0.020826514810323715, 0.027554288506507874, 0.036790505051612854, -0.029741136357188225, 0.023476459085941315, -0.02670527622103691, 0.017854973673820496, 0.016234133392572403, 0.008612323552370071, -0.006914299912750721, -0.03552985191345215, -0.010554758831858635, -0.024209696799516678, -0.006721342448145151, -0.03519539535045624, 0.008605890907347202, -0.01647854596376419, -0.03267408534884453, -0.018601074814796448, -0.003910599276423454, -0.002071073977276683, -0.028171751648187637, 0.011487385258078575, 0.017945019528269768, -0.003778745187446475, -0.10100666433572769, -0.04847085103392601, 0.04317095875740051, -0.013121089898049831, 0.03177361935377121, -0.005978457164019346, -0.010432552546262741, 0.0006166590610519052, 0.03774242848157883, -0.012998883612453938, -0.0047789067029953, -0.009017533622682095, -0.003492525313049555, 0.010419689118862152, 0.026100678369402885, -0.07033932954072952, -0.012272078543901443, 0.005894842557609081, 0.04533207789063454, -0.024698521941900253, -0.005068342667073011, -0.003746585687622428, 0.014703338965773582, 0.005717965308576822, -0.009544949978590012, -0.018511027097702026, -0.0006194729940034449, 0.003138770582154393, 0.01098569668829441, 0.020916560664772987, 0.024441245943307877, 0.006612000055611134, 0.01889694295823574, 0.057012420147657394, -0.04605245217680931, -0.00014984332665335387, -0.011140062473714352, 0.03002414107322693, 0.03100179135799408, -0.0004860109474975616, -0.006502657663077116, -0.05984245985746384, 0.02463420294225216, -0.01066410169005394, 0.0014069796307012439, -0.0017028473084792495, 0.026988280937075615, -0.017546242102980614, 0.02561185322701931, 0.01582249067723751, -0.009242650121450424, -0.01867825724184513, 0.01357132289558649, 0.030281417071819305, -0.0024730681907385588, 0.0001693400408839807, 0.0007364533375948668, -0.015217890962958336, 0.004746747203171253, -0.004547358024865389, -0.012490763328969479, 0.027682926505804062, 0.031953711062669754, -0.02143111266195774, -0.013764280825853348, -0.029844047501683235, 0.03540121391415596, 0.008052747696638107, 0.01889694295823574, -0.020607829093933105, 0.0018459572456777096, -0.012362124398350716, -0.004766042809933424, -0.006689182948321104, 0.006438338663429022, 0.006663455627858639, 0.012265645898878574, 0.02737419493496418, -0.02639654465019703, 0.0007308254134841263, 0.019167082384228706, -0.04517771303653717, -0.0007163535919971764, -0.0070043462328612804, 0.0018604290671646595, 0.018755439668893814, 0.015256483107805252, -0.01759769767522812, -0.010567623190581799, 0.057887159287929535, 0.01614408567547798, -0.04211612418293953, 0.026731004938483238, -0.004499118775129318, 0.01625986024737358, -0.0027930554933845997, 0.0017141031567007303, 0.0002719490439631045, 0.05696096643805504, 0.012188463471829891, 0.03607013449072838, 0.011455225758254528, -0.018536755815148354, -0.07075097411870956, -0.005894842557609081, -0.020749330520629883, -0.012291373685002327, -0.022138623520731926, 0.03805116191506386, -0.036095861345529556, 0.003781961277127266, 0.017121735960245132, 0.014253105036914349, 0.014613292180001736, 0.03079596906900406, 0.0384628027677536, 0.027631470933556557, 0.01340409368276596, 0.03792252391576767, -0.01714746281504631, 0.017867837101221085, 0.032596904784440994, -0.003492525313049555, 0.011461657471954823, -0.005579679273068905, -0.05099215731024742, 0.015102117322385311, 0.02144397795200348, 0.020942287519574165, -0.015899673104286194, 0.004322241526097059, 0.03272554278373718, 0.011468090116977692, -0.02208716794848442, -0.006435122806578875, 0.021469704806804657, 0.017739199101924896, 0.014047284610569477, -0.061849214136600494, 0.019424358382821083, -0.020504917949438095, 0.003949190955609083, 0.042167581617832184, -0.005399585701525211, -0.042810771614313126, -0.005097286310046911, 0.028223207220435143, -0.014034420251846313, -0.012773767113685608, 0.010914945974946022, 0.042270492762327194, -0.022383036091923714, 0.017391875386238098, 0.03100179135799408, 0.014690474607050419, 0.020620692521333694, -0.028223207220435143, -0.02274322137236595, -0.0005720377084799111, 0.04108702018857002, 0.017186054959893227, 0.011230109259486198, 0.021366793662309647, 0.007647537160664797, 0.0027834076900035143, -0.0022077520843595266, -0.026679549366235733, 0.006573408842086792, -0.02121242880821228, 0.027760108932852745, 0.002145041013136506, -0.005653645843267441, 0.042604949325323105, 0.053256187587976456, 0.008805280551314354, -0.011249405331909657, 0.005853035021573305, -0.013288319110870361, 0.01692877896130085, 0.02065928466618061, -0.004746747203171253, 0.01440747082233429, -0.005952729843556881, 0.01615694910287857, 0.0239524208009243, 0.03789679333567619, 0.013661369681358337, 0.022588856518268585, 0.044997621327638626, 0.022846132516860962, 0.016671502962708473, 0.02922658436000347, -0.030487237498164177, 0.01680014096200466, 0.011082175187766552, -0.01479338575154543, 0.029483860358595848, 0.023566506803035736, -0.03365173563361168, -0.01748192310333252, -0.008708802051842213, 0.041833121329545975, 0.0070236423052847385, -0.006351507734507322, -0.04612963646650314, 0.02956104278564453, -0.007814766839146614, -0.008194249123334885, -0.0026467295829206705, 0.004598813131451607, -0.0007079117349348962, -0.01672295667231083, -0.03002414107322693, 0.019154218956828117, -0.026010630652308464, -0.0268339142203331, -0.018549619242548943, 0.008721665479242802, -0.015205027535557747, -0.02647372893989086, -0.05716678872704506, -0.024994390085339546, -0.03077024221420288, -0.017893563956022263, -0.01968163438141346, 0.015526622533798218, 0.010567623190581799, -0.006454418413341045, -0.033574555069208145, 0.023900965228676796, 0.013378365896642208, 0.007428852375596762, -0.014484654180705547, -0.0014327071839943528, 0.00033285116660408676, -0.0036983464378863573, -0.00755749037489295, -0.027657199651002884, -0.004859305452555418, 0.011204381473362446, 0.014484654180705547, -0.005479984451085329, 0.02375946380198002, 0.010471143759787083, -0.003527900902554393, -0.025444623082876205, 0.010432552546262741, 0.039955005049705505, -0.0008224800694733858, -0.017224647104740143, -0.011628887616097927, 0.0020180107094347477, 0.019810272380709648, -0.0018990205135196447, 0.018974125385284424, 0.0036726186517626047, 0.02737419493496418, 0.03792252391576767, 0.03851425647735596, -0.00972504261881113, -0.006348291877657175, 0.01869112066924572, -0.007763311266899109, -0.03298281878232956, 0.022936180233955383, -0.04327386990189552, -0.007660401053726673, -0.021817028522491455, 0.016903050243854523, 0.02781156450510025, -0.023347821086645126, 0.007042937912046909, 0.0007533370517194271, 0.012516490183770657, 0.017674880102276802, 0.004724235739558935, 0.002410357119515538, 0.005373857915401459, 0.021353930234909058, -0.006676319055259228, -0.024222560226917267, -0.01824088767170906, -0.014626155607402325, -0.03933754190802574, 0.005190548952668905, 0.014548973180353642, -0.044251520186662674, 0.0319022573530674, 0.04543498903512955, -0.021572615951299667, 0.013931510038673878, 0.03002414107322693, 0.0010845803190022707, -0.028429027646780014, 0.002630649833008647, -0.0005020907265134156, -0.01605403982102871, 0.02320631965994835, 0.028506210073828697, -0.04309377446770668, 0.002328350208699703, 0.011011424474418163, 0.03859144076704979, -0.007145848590880632, 0.0253931675106287, 0.028429027646780014, -0.010850626975297928, -0.037871066480875015, -0.005988105200231075, 0.008348614908754826, -0.007801902946084738, 0.03179934620857239, -0.0007183635607361794, 0.019167082384228706, 0.016079766675829887, 0.030615875497460365, 0.01768774352967739, -0.030538693070411682, 0.0032272092066705227, -0.024672795087099075, -0.005656862165778875, 0.011275132186710835, -0.02837757207453251, -0.006605568341910839, -0.008290727622807026, -0.040829744189977646, -0.013892918825149536, -0.024865752086043358, -0.0005193764809519053, 0.025676172226667404, 0.012838086113333702, 0.014986342750489712, 0.0038913036696612835, 0.01628558710217476, -0.02714264579117298, 0.00012934162805322558, -0.01694164238870144, -0.01945008523762226, 0.021276747807860374, -0.022228669375181198, -5.899264579056762e-05, -0.004582733381539583, -0.03308572992682457, -0.00387522391974926, 0.008541571907699108, 0.03251972049474716, -0.0027625039219856262, -0.005515360273420811, -0.0009712179307825863, -0.016632910817861557, 0.05814443528652191, -0.020054684951901436, -0.01182184461504221, -0.009043260477483273, -0.005849819164723158, 0.032468266785144806, -0.012497195042669773, -0.01357132289558649, -0.03388328477740288, -0.010934241116046906, 0.003251328831538558, 0.018639665096998215, -0.01880689524114132, 0.007891949266195297, 0.032493993639945984, -0.01539798453450203, -0.029972685500979424, 0.008882462978363037, 0.011796116828918457, 0.00978292990475893, 0.04257922247052193, 0.020196186378598213, -0.025972040370106697, 0.004917192738503218, -0.01115292590111494, -0.010496871545910835, -0.0009631780558265746, 0.025200210511684418, 0.014922023750841618, 0.0192314013838768, 0.007814766839146614, -0.044457338750362396, -0.04257922247052193, -0.00178003020118922, -0.005544303450733423, 0.03771670162677765, -0.018060794100165367, 0.02639654465019703, -0.0193471759557724, 0.008451525121927261, 0.0020549942273646593, 0.027116918936371803, -0.009930863976478577, 0.034346383064985275, -0.023875238373875618, -0.02252453751862049, -0.004721019417047501, 0.011995506472885609, -0.012709448114037514, 0.004589165560901165, -0.012117712758481503, 0.012310669757425785, 0.022717494517564774, -0.030410055071115494, 0.04046955704689026, -0.04592381417751312, 0.00912044383585453, 0.030435781925916672, 0.00748030748218298, 0.011474521830677986, -0.03033287264406681, -0.00922978576272726, -0.004560221917927265, -0.013429821468889713, -0.043016593903303146, -0.038642894476652145, -0.012239918112754822, 0.011866867542266846, -0.004817498382180929, 0.016118358820676804, -0.01258724182844162, -0.011995506472885609, 0.011185085400938988, 0.005824091378599405, 0.019707363098859787, 0.013275455683469772, 0.020376279950141907, 0.028866397216916084, 0.003926679026335478, 0.04661846160888672, -0.013867191039025784, 0.0031210826709866524, -0.020260505378246307, 0.01225921418517828, 0.003178969956934452, -0.003373535117134452, 0.018395252525806427, -0.013262591324746609, -0.024672795087099075, 0.04893394559621811, -0.016349906101822853, -0.010072366334497929, 0.028171751648187637, -0.005502496380358934, 0.006345076020807028, -0.022383036091923714, -0.03987782076001167, -0.02770865522325039, 0.017507649958133698, -0.0072937821969389915, -0.028506210073828697, -0.005862683057785034, -0.01867825724184513, -0.011686774902045727, -0.020504917949438095, 0.016195541247725487, -0.0442257896065712, -0.02881494164466858, 0.034243471920490265, 0.013391230255365372, -0.007055801805108786, -0.015063525177538395, -0.016980234533548355, 0.005074774380773306, -0.010625509545207024, 0.022498810663819313, -0.002624217886477709, 0.03640459105372429, -0.0012823614524677396, -0.025984903797507286, 0.037433698773384094, 0.008663778193295002, 0.019411494955420494, 0.011770389042794704, -0.02164979837834835, -0.014214513823390007, -0.005354562308639288, -0.0026290419045835733, -0.0172761008143425, -0.01683873124420643, 0.007017210125923157, -0.005762988235801458, 0.02814602479338646, -0.008573731407523155, 0.018935533240437508, 0.026988280937075615, -0.0206721480935812, 0.013609915040433407, 0.00874096155166626, 0.004959000274538994, -0.0025454270653426647, 0.01209198497235775, -0.023836646229028702, 0.0257404912263155, 0.015320802107453346, 0.001976203406229615, 0.017237510532140732, -0.004155011847615242, -0.001995499012991786, -0.023463595658540726, 0.02363082580268383, -0.0015975248534232378, -0.0066827512346208096, 0.01979740895330906, -0.0015661693178117275, -0.001238142023794353, 0.020196186378598213, -0.0065573290921747684, 0.006843548733741045, -5.175674959900789e-05, 0.009499926120042801, 0.0014809465501457453, -0.005978457164019346, 0.00407139677554369, 0.05256154388189316, -0.02617786079645157, -0.03285418078303337, 7.03992263879627e-05, 0.015282210893929005, 0.015243618749082088, 0.03241680935025215, 0.016131222248077393, -0.039852093905210495, -0.01341695711016655, -0.032056622207164764, -0.0021739844232797623, -0.016015447676181793, 0.017443330958485603, -0.024569883942604065, 0.01912849023938179, 0.0006158550968393683, 0.013442684896290302, -0.015680989250540733, -0.011571000330150127, 0.0061553348787128925, 0.005734045058488846, 0.0015259698266163468, 0.017288966104388237, -0.016414226964116096, 0.02163693495094776, 0.001008201390504837, -0.04407142475247383, 0.029741136357188225, -0.012973155826330185, 0.02131533809006214, 0.02210003137588501, 0.005885194521397352, 0.024930071085691452, 0.04793056845664978, 0.02639654465019703, -0.01290883682668209, -0.000322198320645839, -0.011004992760717869, -0.01880689524114132, 0.0026419057976454496, -0.006541249342262745, -0.01759769767522812, -0.008946781978011131, 0.012104848399758339, 0.0026901450473815203, 0.022910451516509056, -0.015140708535909653, -0.015012070536613464, 0.0030085244216024876, -0.017726335674524307, -0.005981673486530781, 0.020311960950493813, 0.015976855531334877, -0.01969449780881405, -0.01088921818882227, 0.002016402781009674, 0.02013186737895012, 0.0159511286765337, -0.0026322577614337206, -0.0242997445166111, 0.004560221917927265, -0.0102781867608428, 0.00742242019623518, -0.003807688830420375, 0.02979259192943573, -0.0003782765124924481, -0.013288319110870361, -0.004656700417399406, -0.018768303096294403, 0.017520513385534286, 0.008136361837387085, 0.0013000491308048368, -0.03267408534884453, 0.006631295662373304, 0.01570671610534191, 0.014806249178946018, 0.02584340050816536, -0.0034153424203395844, -0.004724235739558935, 0.007358101196587086, 0.016208404675126076, 0.014265969395637512, 0.0014576308894902468, -0.030255690217018127, 0.011686774902045727, -0.009641428478062153, 0.02453129179775715, -0.0028155671898275614, -0.03429492563009262, -0.03146488964557648, 0.0020694660488516092, -0.008001292124390602, 0.002662809332832694, 0.030204234644770622, 0.0251616183668375, -0.01834379881620407, 0.013056770898401737, -0.001550089567899704, 0.0041389320977032185, -0.03187653049826622, 0.03077024221420288, -0.035787127912044525, 0.011525976471602917, -0.009184762835502625, -0.016890186816453934, -0.010541895404458046, -0.02750283293426037, 0.0029345573857426643, -0.0104518486186862, 0.01770060695707798, 0.010741284117102623, 0.0018716849153861403, 0.02450556494295597, -0.028712032362818718, 0.017726335674524307, 0.039749182760715485, -0.006997914519160986, 0.014458926394581795, -0.030075596645474434, 0.0256247166544199, 0.00742242019623518, -0.012786630541086197, -0.00410034041851759, 0.024209696799516678, 0.009210490621626377, 0.003997430205345154, 0.007596082054078579, 0.006502657663077116, -0.027657199651002884, -0.030384328216314316, -0.0011287996312603354, -0.0017462626565247774, -0.003370319027453661, -0.0035761401522904634, 0.031490616500377655, 0.005071558523923159, 0.0048432257026433945, -0.007467443589121103, 0.0014142155414447188, 0.015745308250188828, 0.029946958646178246, -0.029818320646882057, 0.05881335586309433, 0.03977490961551666, 0.019205672666430473, -0.01615694910287857, -0.002916869707405567, -0.011693206615746021, 0.011191518045961857, -0.006033128593116999, -0.009467766620218754, -0.004360832739621401, -0.010361801832914352, -0.02889212593436241, 0.05618913844227791, 0.0011681950418278575, 0.01692877896130085, 0.017456194385886192, -0.021611206233501434, 0.03982636705040932, -0.015758171677589417, 0.011886163614690304, 0.011435930617153645, 0.013159681111574173, -0.021482568234205246, 0.0033252958673983812, 0.026679549366235733, 0.029200857505202293, -0.0006821841234341264, -0.012001938186585903, 0.018305206671357155, 0.006110311485826969, 0.03972345590591431, 0.01424024160951376, -0.03185080364346504, -0.030590148642659187, -0.0003384790907148272, -0.0192314013838768, -0.015153571963310242, 0.005840171128511429, -0.007769743446260691, -0.013854327611625195, 0.005920570343732834, -0.023463595658540726, -0.006849980913102627, 0.03872007876634598, 0.027657199651002884, 0.005004023667424917, -0.01225921418517828, 0.0177906546741724, 0.025457486510276794, -0.008779552765190601, 0.004029589705169201, -0.01153884083032608, 0.0010057893814519048, -0.0002337596088182181, -0.008522276766598225, 0.03264835849404335, -0.026679549366235733, 0.005052262917160988, -0.007435284089297056, 0.004560221917927265, -0.020196186378598213, -0.002910437760874629, -0.024428382515907288, -0.002858982654288411, 0.041730210185050964, 0.018716849386692047, 0.031439159065485, -0.035118211060762405, -0.035915765911340714, -0.0010813643457368016, -0.030178505927324295, 0.017314692959189415, -0.002307446440681815, 0.02594631165266037, -0.03828270733356476, -0.007145848590880632, -0.031825073063373566, -0.001252613845281303, -0.02253740094602108, -0.010143117047846317, 0.06462779641151428, -0.003441070206463337]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
"1]0.8
−0.2
−1.3
0.4⊗ K[i1,:]sequence dimension
approximate attention scores ˆsα=X
i∈i2ˆsi
q0.8
−0.2
−1.3
0.4⊗ K[:,i2]
sparse attention scores s
⊗
V[:,i2]¯v=mean (V)
⊕
y×(1−α) ×αAlgorithm 1 SparQ Attention
Input: q∈Rdh,K∈RS×dh,V∈RS×dh,v∈Rdh,
r∈N,k∈N,l∈N
# Indices of top relements of |q|
i1←argtopk ( |q|, r)
# Softmax temperature, weighted by L 1coverage
τ←s
dh·∥q[i1]∥1
∥q∥1
# Approximate attention scores (all positions)
ˆs←softmax 
q[i1]·K⊤
[i1,:]/τ
# Local mask of last lpositions
m←[1ifi > S−lelse0]S
i=1
# Indices of top kapproximate scores or local
i2←argtopk ( ˆs+m, k)
# Total approximate score of top k
α←sum 
ˆs[i2]
# Final attention scores (top kpositions)
s←softmax 
q·K⊤
[:,i2]/√dh
# Mixed scores and values, interpolating with v
y←αs·V[:,i2]+ (1−α)v
return y
Figure 2: SparQ Attention for a single attention head. The algorithm consists of three steps. First, we find the rlargest
components of the incoming query vector and gather the corresponding components along the hidden dimension of the key
cacheK. This allows us to approximate the full attention scores ( ˆs). In the second step, we identify the top- klargest scores
in the approximation and proceed to gather the corresponding full key and value vectors from the cache. As a final step, to
compensate for the missing value vectors, we additionally maintain and fetch the running mean value vector ¯vand reassign
it the leftover mass based on approximate score weightings. The attention output is then calculated as usual using the top- k
fetched key and value pairs, together with ¯v.
Due to the normalising effect of the softmax function, the
resulting svector is sparse (see Figures 3a and 3b), i.e. we
can find a boolean mask ms∈ {0,1}Scorresponding to
the top- kelements in s(k≪S) such that:
y1= (s◦ms)·V≈s·V (6)
As a result, only the values vicorresponding to the non-zero
elements of msneed to be fetched from memory. However,
the algorithm still requires fetching the full Kfrom memory
in order to calculate the attention scores s, limiting the
minimum amount of data transferred to1
2Mbase.
Mean value reallocation In order to further improve
the approximation in Equation (6), we note a further ob-
servation: vivectors within the sequence exhibit a high
degree of auto-correlation (see Table 1). Thus, an addi-
tional correction term using a running-mean value vector¯v=1
SPS
i=1vican be added as follows:
y2= (s◦ms)·V+ (1−s·ms)¯v (7)
This introduces a minimal additional overhead compared to
Equation (6) as the mean vector ¯vneeds to be updated and
written back to memory at each step.
Query sparsity In order to improve the lower bound on
memory transfers, we further consider efficiently approxi-
mating the mask msby calculating approximate attention
scores ˆswithout using the full matrix K. Here, we con-
sider the distribution of magnitudes of the components of the
query vector qand observe that it is highly heavy-tailed (see
Figures 3c and 3d). This observation allows us to efficiently
approximate the attention scores sby defining a per-query
boolean mask mq∈ {0,1}dhcorresponding to the top- r
3
SparQ Attention: Bandwidth-Efficient LLM Inference
components of q. The scores are then approximated as:
ˆs= softmax(q","[0.024035342037677765, 0.040384382009506226, 0.023522086441516876, 0.000650174799375236, -0.008825477212667465, -0.019265828654170036, -0.0069977897219359875, 0.03467598930001259, -0.06108982861042023, 0.029443293809890747, -0.0004088042478542775, -0.028742263093590736, -0.012149114161729813, 0.030019139871001244, 0.013382176868617535, 0.011153900995850563, 0.02676435373723507, -0.031245945021510124, -0.002714929636567831, -0.046192921698093414, -0.030645061284303665, -0.033774662762880325, 0.01693740487098694, 0.022583207115530968, -0.008187037892639637, -0.016824739053845406, 0.012718701735138893, -0.0063843876123428345, 0.045667149126529694, -0.013231956399977207, 0.029668625444173813, -0.039958756417036057, -0.03349925950169563, -0.05473047494888306, -0.0016602537361904979, 0.052627384662628174, -0.019165681675076485, 0.02834167331457138, -0.042462438344955444, -0.007129232864826918, 0.010077318176627159, -0.02389763854444027, -0.05883651226758957, 0.005285897292196751, 0.03545212745666504, -0.003570875618606806, 0.01702503301203251, -0.01791384071111679, -0.008706551976501942, 0.0443151630461216, -0.018189245834946632, 0.018013987690210342, -0.0469440259039402, 0.049247413873672485, 0.03184682875871658, -0.002232970902696252, -0.005201398395001888, 0.0352768711745739, 0.05064947530627251, 0.009726802818477154, 0.016737110912799835, -0.01693740487098694, 0.003664763644337654, 0.005542524624615908, -0.02242046780884266, 0.013332103379070759, -0.02451104111969471, 0.027014723047614098, 0.008024298585951328, 0.005073084495961666, -0.03870691359043121, 0.06419438868761063, 0.058986734598875046, 0.009895800612866879, 0.02113107219338417, 0.010077318176627159, 0.016849776729941368, 0.04744476452469826, 0.01404565293341875, -0.003962075803428888, 0.03067009709775448, -0.012230483815073967, 0.06129012256860733, -0.016361558809876442, -0.055681876838207245, -0.07125477492809296, -0.02573784440755844, -0.0032923410180956125, -0.05182620510458946, -0.01043409202247858, -0.03930779919028282, 0.06539615988731384, -0.0016320872819051147, 0.0109097920358181, 0.04381442442536354, 0.056883640587329865, 0.000395307841245085, 0.002930872142314911, -0.008118187077343464, 0.009833209216594696, 0.059337250888347626, -0.003943298477679491, 0.005730300676077604, -0.06649778038263321, 0.040384382009506226, -0.002248618984594941, -0.006847568787634373, 0.010365241207182407, 0.018051542341709137, -0.010315167717635632, -0.02806626819074154, 0.004030927084386349, -0.03482620790600777, 0.030645061284303665, 0.004046575166285038, -0.030269509181380272, -0.06339321285486221, -0.024686299264431, -0.011485639028251171, 0.03875698894262314, -0.015159791335463524, 0.02608836069703102, 0.012318112887442112, 0.00786781869828701, -0.017500733956694603, -0.03580264374613762, 0.03452576696872711, -0.06249189004302025, -0.009207288734614849, -0.014596463181078434, 0.04912222921848297, -0.013695137575268745, 0.045842405408620834, 0.003329896368086338, 0.018402058631181717, 0.004803938791155815, -0.02477392740547657, 0.023697344586253166, -0.028792336583137512, 0.017713546752929688, -0.006684829480946064, 0.01867746375501156, 0.011229011230170727, 0.015560380183160305, -0.029593514278531075, 0.029868919402360916, -0.03347422182559967, 0.023096460849046707, -0.005116899032145739, 0.03262297064065933, 0.013319585472345352, -0.02104344218969345, -0.059237103909254074, 0.036729007959365845, -0.0172002911567688, -0.04201177507638931, -0.006622237619012594, -0.012117817997932434, -0.00188558513764292, 0.006822532042860985, 0.008650219067931175, -0.020968332886695862, 0.05377907678484917, -0.055681876838207245, -0.02198232337832451, -0.005921206437051296, -0.07105448096990585, 0.013219437561929226, -0.0623917430639267, -0.049748148769140244, -0.02329675666987896, -0.04050956666469574, 0.005213916767388582, -0.03442561998963356, 0.014596463181078434, 0.0022110636346042156, 0.004156111273914576, -0.0014200567966327071, -0.01790132187306881, -0.0328483022749424, -0.01589837670326233, 0.0025318479165434837, 0.037329889833927155, 0.044891007244586945, -0.0015061208978295326, 0.01702503301203251, -0.017963914200663567, -0.004634940065443516, 0.0037398741114884615, 0.0121741509065032, -0.003940168768167496, 0.016899850219488144, 0.03274815157055855, 0.006753680761903524, -0.02781590074300766, -0.042712803930044174, 0.014696610160171986, 0.04511633887887001, -0.00601822417229414, 0.004929122980684042, 0.008406110107898712, 0.017087625339627266, 0.04273784160614014, -0.03600293770432472, 0.03144623711705208, 0.03267304226756096, -0.004850882571190596, -0.009100882336497307, -0.06023857370018959, -0.03139616549015045, 0.015385122038424015, 0.0030717041809111834, 0.0676494687795639, 0.0029762513004243374, -0.035477165132761, 0.052727531641721725, -0.03662886098027229, 0.018664944916963577, -0.0020201578736305237, 0.04444034397602081, 0.0012784423306584358, 0.014258465729653835, 0.02538732998073101, 0.026213545352220535, -0.08682767301797867, 0.05973783880472183, 0.054980844259262085, -0.021331366151571274, 0.013557435013353825, -0.028642116114497185, 0.027790863066911697, 0.013958023861050606, 0.005414211191236973, 0.004556700121611357, -0.014921941794455051, -0.05277760326862335, 0.013620027340948582, -0.03522679954767227, 0.004744476173073053, -0.04772016778588295, 0.011792339384555817, 0.0037680405657738447, 0.03144623711705208, 0.03274815157055855, 0.0041029080748558044, 0.015297493897378445, -0.002060842700302601, -0.020793074741959572, 0.03199704736471176, 0.007460970897227526, -0.005461154971271753, -0.02756553329527378, -0.04138585552573204, -0.00216099014505744, -0.05432988703250885, -0.0009036725386977196, -0.010183724574744701, 0.07240647077560425, -0.0040027606301009655, -0.007961707189679146, -0.04764505848288536, -0.04118555784225464, -0.02337186597287655, -0.03112076036632061, 0.007705079857259989, -0.006180963478982449, 0.007016567047685385, -0.0006090987590141594, -0.01772606372833252, -0.020993368700146675, -0.016186300665140152, 0.03277318924665451, -0.008618922904133797, -0.013519879430532455, 0.0010679765837267041, -0.023885121569037437, 0.007761412300169468, -0.007223120890557766, -0.03387480974197388, 0.009657951071858406, 0.010102354921400547, -0.0112978620454669, 0.07060381770133972, 0.009388805367052555, 0.01722532883286476, -0.030444765463471413, 1.3520857464754954e-05, -0.015372604131698608, -0.025424884632229805, -0.030795281752943993, 0.03257289528846741, -0.03505153954029083, 0.0590868815779686, -0.013795284554362297, -0.009651691652834415, -0.008525035344064236, -0.03144623711705208, -0.038381434977054596, 0.00730449054390192, 0.010152428410947323, 0.05823563039302826, 0.023622235283255577, 0.04103533923625946, 0.0011485638096928596, -0.0029731218237429857, 0.026539023965597153, 0.019591307267546654, 0.016849776729941368, -0.028917521238327026, -0.0018949739169329405, 0.0002838157524820417, 0.025011777877807617, -0.02382252924144268, 0.032047122716903687, -0.03955816850066185, -0.05417966470122337, 0.022145062685012817, -0.015284975059330463, 0.00916347373276949, -0.010628127492964268, -0.029918992891907692, -0.0670485869050026, 0.0005191226955503225, -0.023058906197547913, 0.03893224522471428, -0.051575835794210434, -0.049848295748233795, 0.011110085994005203, 0.007842781953513622, -0.034901320934295654, 0.06529600918292999, 0.011786079965531826, 0.00254280143417418, -0.02999410405755043, -0.06479527801275253, -0.012418259866535664, -0.012956551276147366, 0.021243736147880554, -0.01373269222676754, 0.01564800925552845, -0.05197642743587494, -0.032047122716903687, -0.02668924443423748, 0.008531294763088226, -0.008581368252635002, 0.01303166151046753, -0.005354748573154211, -0.03199704736471176, 0.07140499353408813, -0.0015374168287962675, -0.0026585967279970646, 0.007598672993481159, 0.0643446147441864, -0.053929299116134644, 0.02017967216670513, -0.02459866926074028, -0.0012557527516037226, -0.03580264374613762, -0.029318109154701233, 0.0009881717851385474, 0.0035959123633801937, 0.008318481966853142, 0.05583209544420242, -0.03955816850066185, 0.013920469209551811, 0.009313695132732391, -0.01748821511864662, 0.03172164410352707, 0.017588362097740173, 0.00582418916746974, -0.010747052729129791, 0.03512664884328842, -0.011704710312187672, -0.05468040332198143, -0.03485124558210373, -0.04163622111082077, -0.008162001147866249, 0.037755515426397324, -0.0011477814987301826, 0.026789391413331032, 0.01826435700058937, 0.019290866330266, -0.03700441122055054, -0.02348453179001808, 0.03935787081718445, -0.0005527659086510539, 0.024548595771193504, 0.0029981585685163736, -0.07496022433042526, -0.025525031611323357, -0.04108541086316109, -0.0023925804998725653, -0.020292337983846664, 0.0012721831444650888, 0.03600293770432472, 0.029418256133794785, -0.012969070114195347, 0.0476200208067894, 0.028016194701194763, 0.05387922376394272, 0.010020985268056393, -0.007216861937195063, -0.016887331381440163, -0.021969804540276527, 0.023071425035595894, -0.01134793646633625, -0.016324002295732498, 0.03405006602406502, 0.006409424357116222, -0.009019512683153152, 0.07921648025512695, -0.009676728397607803, 0.03112076036632061, -0.008086890913546085, 0.004997974261641502, -0.01582326740026474, 0.00860640499740839, 0.017863767221570015, -0.003038843395188451, 0.030219435691833496, -0.017513250932097435, -0.013156846165657043, -0.019240790978074074, 0.02026730217039585, -0.028116341680288315, -0.003068574471399188, 0.009801913052797318, -0.05998820811510086, 0.033674515783786774, -0.015497787855565548, -0.03570249676704407, 0.041586149483919144, -0.0044252569787204266, -0.03354933112859726, -0.020793074741959572, -0.010941088199615479, 0.006484535057097673, 0.033248890191316605, -0.0002384365361649543, -0.04774520546197891, 0.007529821712523699, -0.056032389402389526, -0.03903239220380783, -0.004293813835829496, -0.04156111180782318, 0.011185197159647942, -0.012192928232252598, -0.022445503622293472, 0.021681880578398705, -0.008844254538416862, -0.02119366265833378, 0.00595563231036067, 0.048371125012636185, 0.02234535664319992, 0.0026226062327623367, -0.056282758712768555, 0.07526066154241562, -0.023421939462423325, -0.005796022713184357, -0.01835198514163494, 0.039958756417036057, -0.006778717506676912, -0.038456548005342484, 0.003796207020059228, -0.005345359910279512, -0.021869657561182976, 0.010859718546271324, -0.015497787855565548, 0.02104344218969345, 0.04233725368976593, 0.01858983375132084, -0.02496170438826084, 0.025938140228390694, -0.020154636353254318, -0.03269807994365692, -0.008193297311663628, 0.04789542406797409, -0.04070986062288284, 0.009319954551756382, -0.013357140123844147, 0.0377054437994957, -0.04862149432301521, 0.002691457513719797, 0.008956920355558395, 0.031946975737810135, 0.010221279226243496, 0.07460970431566238, -0.0032453970052301884, 0.05252723768353462, -0.0038963542319834232, -0.03552724048495293, -0.03327392786741257, 0.035151686519384384, -0.012405741959810257, 0.038581732660532, 0.009726802818477154, 0.011842412874102592, 0.00916347373276949, 0.009420101530849934, -0.03242267295718193, 0.05147568881511688, 0.019666418433189392, 0.02304638735949993, 0.01842709630727768, -0.01091605145484209, 0.05713400989770889, 0.033248890191316605, 0.025512514635920525, -0.02339690364897251, 0.034801170229911804, -0.00024684733944013715, 0.03339910879731178, 0.0045379227958619595, 0.04899704456329346, -0.006231036968529224, 0.015522824600338936, -0.006209129933267832, -0.009501471184194088, -0.012562221847474575, 0.011698451824486256, -0.017363030463457108, -0.020104562863707542, -0.02904270403087139, 0.002771262312307954, -0.00015921848535072058, -0.023609716445207596, -0.054379962384700775, -0.11757288128137589, -0.0339248850941658, -0.08101913332939148, -0.0006783411954529583, -0.02451104111969471, -0.011541971005499363, 0.034375544637441635, -0.01034646388143301, 0.020229745656251907, 0.004944771062582731, -0.03853165730834007, -0.027590569108724594, 0.037430036813020706, 0.01896538771688938, 0.010615609586238861, 0.006772458087652922, 0.007260676007717848, 0.016386594623327255, -0.018639909103512764, 0.03435051068663597, 0.0066410149447619915, -0.016924886032938957, 0.02032989263534546, -0.018552279099822044, -0.016386594623327255, 0.0026883280370384455, 0.01186744961887598, -0.03329896181821823, 0.028366710990667343, -0.016011042520403862, 0.030319582670927048, -0.02155669778585434, -0.016724592074751854, 0.03387480974197388, 0.009082104079425335, -0.016812220215797424, -0.0050386590883135796, -0.0335242934525013, 0.014183355495333672, 0.031496312469244, -0.028667151927947998, 0.004071611911058426, 0.016912367194890976, -0.009557804092764854, -0.004772642627358437, 0.005796022713184357, -0.05503091961145401, 0.030795281752943993, -0.0010906662791967392, -0.007899114862084389, -0.012994106858968735, -0.006497053429484367, 0.03445065766572952, -0.03545212745666504, 0.0036084309685975313, -0.012124077416956425, -0.005939984228461981, -0.020029451698064804, -0.000320979772368446, -0.007642487529665232, 0.044815897941589355, -0.01772606372833252, 0.013482324779033661, 0.02886744774878025, -0.0022407949436455965, 0.02606332302093506, 0.01017746515572071, -0.033323999494314194, -0.03127098083496094, -0.033173780888319016, -0.025324737653136253, -0.024586152285337448, 0.010415314696729183, 0.025525031611323357, 0.016374075785279274, 0.003408136311918497, -0.011673415079712868, -0.02771575376391411, 0.036303382366895676, -0.007392119616270065, 0.01877761073410511, 0.03895728290081024, -0.007398378569632769, -0.0028009936213493347, -0.0016320872819051147, -0.02242046780884266, -0.010077318176627159, -0.034901320934295654, 0.0045285336673259735, -0.052977900952100754, -0.01868998259305954, 0.023008832708001137, -0.0005038658855482936, 0.006440720520913601, -0.020980849862098694, 0.020930776372551918, 0.06960234045982361, 0.004005890339612961, 0.01911560818552971, 0.010653164237737656, -0.050624437630176544, -0.0109097920358181, -0.0066410149447619915, -0.05573194846510887, 0.0006137931486591697, 0.015597935765981674, -0.005724041722714901, -0.024235635995864868, 0.02138143964111805, 0.01756332442164421, -0.010227538645267487, 0.06504564732313156, 0.015798229724168777, 0.010246315971016884, 0.02693961188197136, 0.014358612708747387, -0.04491604492068291, 0.0405346043407917, 0.006772458087652922, -0.023709863424301147, 0.018840203061699867, -0.017751101404428482, -0.024486005306243896, -0.035952866077423096, -0.04371427744626999, 0.04479086026549339, 0.004049704875797033, 0.034726060926914215, -0.01591089554131031, -0.004447164013981819, -0.00020968331955373287, 0.026388801634311676, -0.014245947822928429, -0.058035336434841156, -0.0012205446837469935, -0.01117267832159996, -0.058636218309402466, 0.024824000895023346, 0.008162001147866249, 0.02009204402565956, 0.012931514531373978, 0.004778902046382427, -0.015835784375667572, 0.006446979474276304, 0.011992634274065495, 0.026714280247688293, 0.007811486255377531, 0.014120763167738914, -0.024110451340675354, -0.015372604131698608, -0.03347422182559967, -0.020930776372551918, 0.026839464902877808, -0.01842709630727768, -0.011842412874102592, -0.036478638648986816, -0.0005081691197119653, -0.008806699886918068, -0.023497050628066063, 0.01974152773618698, -0.008162001147866249, 0.028541969135403633, -0.025662735104560852, -0.006991530302911997, -0.004994844552129507, 0.032297492027282715, -0.04373931512236595, 0.00660345982760191, 0.009319954551756382, -0.01191126462072134, 0.048371125012636185, -0.014583944343030453, -0.024298228323459625, -0.03425036370754242, 0.027139907702803612, -0.003174981102347374, -0.01116641890257597, -0.009188510477542877, -0.037079520523548126, 0.0007342828321270645, 0.017513250932097435, 0.05748452618718147, -0.024448448792099953, -0.012956551276147366, 0.013006624765694141, -0.0017384937964379787, -0.02729012817144394, -0.014383649453520775, 0.004218703135848045, 0.00667231110855937, 0.00458486657589674, -0.009808172471821308, -0.0029214832466095686, -0.04216199368238449, 0.010089836083352566, -0.04696906358003616, -0.02841678448021412, -0.01246833335608244, -0.013181882910430431, -0.02120618149638176, 0.0042593879625201225, 0.040384382009506226, 0.04213695973157883, 0.00452227471396327, 0.015460233204066753, -0.009670469909906387, -0.03848158195614815, -0.018702499568462372, -0.019766565412282944, -0.05913695693016052, 0.013945505954325199, -0.02452355995774269, -0.02563769742846489, 0.021619290113449097, -0.03447569161653519, 0.020041970536112785, 0.043589092791080475, -0.00643446110188961, 0.03622826933860779, 0.01286892220377922, -0.0012612295104190707, -0.03793077543377876, 0.0036021717824041843, -0.02711487002670765, 0.009920837357640266, 0.021256254985928535, 0.00877540372312069, 0.012718701735138893, -0.029067741706967354, 0.009395064786076546, -0.019002942368388176, 0.013795284554362297, 0.00804933626204729, 0.014145799912512302, -0.019678935408592224, -0.03222237899899483, 0.02337186597287655, 0.023334311321377754, -0.015122235752642155, 0.01221170648932457, -0.02313401736319065, 0.021231219172477722, 0.011811117641627789, 0.019403530284762383, 0.009751839563250542, 0.0005296851159073412, 0.020755518227815628, 0.02791604772210121, -0.02606332302093506, 0.006265462841838598, -0.03102061338722706, -0.005279638338834047, 0.026138434186577797, 0.02606332302093506, -0.033349037170410156, -0.0169624425470829, -0.01616126298904419, -0.01947864145040512, -0.00471630971878767, -0.04286302626132965, -0.0018636778695508838, -0.011122604832053185, -0.018201764672994614, -0.016586890444159508, 0.0057459487579762936, -0.024974223226308823, -0.03425036370754242, 0.024448448792099953, 0.003570875618606806, 0.0040027606301009655, -0.09328716993331909, -0.01782621257007122, 0.037404999136924744, -0.0071793063543736935, 0.031145796179771423, 0.004828975535929203, -0.008575108833611012, -0.013156846165657043, 0.037505146116018295, 0.021018406376242638, -0.009539025835692883, 0.01003976259380579, 0.010790866799652576, 0.01390795037150383, 0.0006114459247328341, -0.06815020740032196, -0.01962886191904545, 0.03169660642743111, 0.019416049122810364, -0.04288806393742561, -0.01747569628059864, 0.01264985091984272, -0.0043000727891922, 0.017162736505270004, -0.008668997325003147, -0.045692186802625656, -0.005329711828380823, -0.03705448657274246, 0.02189469337463379, 0.02034241147339344, 0.005598857533186674, 0.0037085781805217266, 0.012731220573186874, 0.05478055030107498, -0.03980853408575058, -0.01633652113378048, -0.007310749962925911, 0.03327392786741257, 0.025787917897105217, -0.0005026923026889563, -0.006105853244662285, -0.05678349360823631, 0.020617816597223282, -0.012893958948552608, 0.011660896241664886, -0.005298415664583445, 0.04131074249744415, -0.0005089514888823032, 0.024536078795790672, 0.017450660467147827, -0.029017668217420578, -0.029693661257624626, 0.016899850219488144, 0.013757729902863503, -0.008393592201173306, 0.003980853594839573, -0.007711338810622692, -0.016023561358451843, -0.01633652113378048, -0.007354564033448696, -0.019854193553328514, 0.00580228166654706, 0.05798526108264923, -0.030119286850094795, -0.007091677747666836, -0.03364947810769081, 0.008155742660164833, -0.0059243361465632915, 0.03222237899899483, -0.01825183816254139, -0.007122973911464214, -0.026488950476050377, -0.02206995151937008, -0.000551983539480716, 0.006835050415247679, 0.0041936663910746574, -0.00799926184117794, 0.024886593222618103, -0.027240054681897163, 0.013194400817155838, 0.01939101330935955, -0.049673039466142654, 0.01676214672625065, -0.0024614317808300257, -0.006597200408577919, -0.010189983062446117, 0.018114134669303894, 0.0066284965723752975, -0.0064720166847109795, 0.03705448657274246, 0.02252061478793621, -0.04371427744626999, 0.02408541552722454, -0.0020264170598238707, 0.020930776372551918, -0.02971869893372059, 0.03695433959364891, -0.0006587811512872577, 0.05913695693016052, 0.013682618737220764, 0.05588217079639435, -0.0017118921969085932, 0.023246681317687035, -0.04131074249744415, -0.02320912666618824, -0.0066410149447619915, -0.01581074856221676, -0.008794181048870087, 0.044815897941589355, -0.030144324526190758, -0.01447127852588892, -0.0050167515873909, 0.006199741270393133, -0.014058170840144157, -0.003138990607112646, 0.02095581404864788, 0.020442558452486992, 0.023935195058584213, 0.02964358776807785, -0.02826656401157379, 0.002495857421308756, 0.04726950451731682, 0.0010820598108693957, 0.010640646331012249, 0.012017671018838882, -0.03219734504818916, 0.007993003353476524, 0.011272825300693512, 0.009125919081270695, -0.0017431882442906499, 0.023171572014689445, 0.044114865362644196, 0.02824152633547783, -0.0010640645632520318, -0.006766199134290218, 0.031170833855867386, 0.008449925109744072, 0.020480114966630936, -0.037855662405490875, 0.021331366151571274, -0.027690716087818146, 0.01877761073410511, 0.0370294488966465, 0.03860676661133766, -0.021256254985928535, 0.010621868073940277, 0.018740056082606316, -0.025787917897105217, -0.0319720134139061, 0.034200288355350494, 0.029017668217420578, -0.030895428732037544, 0.020830629393458366, 0.028191452845931053, -0.0002689501561690122, 0.023246681317687035, -0.03227245435118675, -0.03930779919028282, 0.011667155660688877, 0.0392577238380909, 0.002514634979888797, 0.0075235627591609955, 0.033674515783786774, -0.010790866799652576, 0.002952779410406947, -0.0032923410180956125, -0.026964649558067322, -0.014709128066897392, -0.008443665690720081, 0.04877171292901039, 0.013795284554362297, -0.008575108833611012, 0.03174668177962303, 0.0707540363073349, 0.02981884591281414, 0.023597197607159615, 0.0053203231655061245, -0.027840938419103622, 0.006093334872275591, 0.009313695132732391, -0.011429306119680405, 0.009657951071858406, -0.0019184459233656526, 0.01517230924218893, 0.042562585324048996, 0.008725330233573914, -0.0020342411007732153, -0.01473416481167078, 0.009107140824198723, 0.004062223248183727, 0.04659351333975792, 0.012380704283714294, -0.025963176041841507, -0.012286816723644733, -0.004769512917846441, -0.007360823452472687, 0.013532398268580437, 0.014871867373585701, -0.012074003927409649, 0.017575843259692192, -0.013181882910430431, 0.007385860197246075, -0.0036272085271775723, 0.01566052809357643, -0.018877757713198662, 0.012674887664616108, -0.009351249784231186, -0.03930779919028282, 0.005792893003672361, -0.03122090734541416, -0.028842410072684288, -0.0012275862973183393, -0.026839464902877808, -0.012355667538940907, -0.002816641703248024, -0.016011042520403862, 0.007122973911464214, 0.00877540372312069, -0.04997348040342331, -0.028141379356384277, -0.014984533190727234, -0.016499260440468788, -5.261642945697531e-05, -0.009695506654679775, 0.0032986002042889595, 0.002514634979888797, 0.027840938419103622, -0.04113548621535301, -0.015760675072669983, 0.030920466408133507, 0.004778902046382427, 0.01320691965520382, -0.013219437561929226, 0.0012502758763730526, -0.02461118809878826, 0.0011610822984948754, -0.020542705431580544, -0.04469071328639984, 0.009019512683153152, 0.021068479865789413, 0.016649480909109116, 0.009570321999490261, 0.01634903997182846, 0.013795284554362297, 0.017976433038711548, -0.02383504807949066, -0.0009341861587017775, 0.03815610334277153, -0.0036491157952696085, -0.0168622937053442, 0.0032673042733222246, 0.01020876131951809, 0.040459491312503815, 0.008719070814549923, 0.0041686296463012695, 0.01290647778660059, -0.005116899032145739, 0.03222237899899483, 0.024536078795790672, 0.006318666040897369, -0.004997974261641502, -0.006816272623836994, -0.02399778738617897, -0.04278791695833206, 0.02111855335533619, -0.048821788281202316, 0.005314063746482134, -0.010327685624361038, -0.01868998259305954, 0.02113107219338417, -0.03174668177962303, -0.007310749962925911, 0.007949188351631165, 0.00760493241250515, 0.0056677088141441345, 0.02095581404864788, -0.02026730217039585, -0.0011117910034954548, 0.036303382366895676, -0.021356401965022087, -0.011147641576826572, -0.008550072088837624, 0.0005081691197119653, -0.029418256133794785, 0.0014865609118714929, 0.006093334872275591, -0.028291599825024605, 0.010027243755757809, 0.04444034397602081, -0.025963176041841507, 0.03169660642743111, 0.029443293809890747, 0.00767378369346261, -0.02563769742846489, 0.007279453799128532, -0.022570688277482986, -0.010840940289199352, 0.024824000895023346, 0.017776139080524445, -0.046468328684568405, 0.008925624191761017, -0.004731957800686359, 0.03875698894262314, 0.019053015857934952, 0.03532694652676582, 0.021181145682930946, -0.008005521260201931, -0.03435051068663597, -0.02711487002670765, -0.001677466556429863, 0.008950660936534405, 0.005655190441757441, 0.016987478360533714, 0.022232690826058388, 0.0067161256447434425, 0.007874078117311, 0.011291603557765484, -0.012217964977025986, 0.009194769896566868, -0.025187036022543907, -0.005382915027439594, 0.052276868373155594, -0.0056677088141441345, -0.013857876881957054, -0.0016696425154805183, -0.011992634274065495, -0.004118556156754494, -0.014959496445953846, -0.019703973084688187, 0.018477169796824455, 0.014371131546795368, 0.02389763854444027, 0.006753680761903524, 0.013857876881957054, -0.03517672419548035, 0.009682987816631794, -0.013958023861050606, -0.027865974232554436, -0.009326213039457798, -0.0031593330204486847, -0.0023487661965191364, 0.009057067334651947, 0.0080430768430233, -0.024385856464505196, -0.009789394214749336, 0.02676435373723507, 0.016474224627017975, 0.009413842111825943, -0.015385122038424015, -0.013657581992447376, 0.06489542126655579, -0.002057713223621249, -0.0013770248042419553, -0.016399113461375237, 0.002786910394206643, 0.01017120573669672, -0.01164837833493948, -0.03262297064065933, -0.024398375302553177, -0.00340187712572515, 0.0008301268680952489, 0.018051542341709137, -0.026814429089426994, 0.010409055277705193, 0.007116714492440224, -0.0053109340369701385, -0.008362296037375927, 0.03783062472939491, -0.003420654684305191, 0.0021281291265040636, 0.021756991744041443, -0.008656478486955166, -0.012543443590402603, 0.006634755991399288, -0.018389539793133736, 0.0010930134449154139, -0.00916973315179348, 0.020392484962940216, 0.004137333482503891, 0.023522086441516876, 0.011178937740623951, -0.041611187160015106, -0.04997348040342331, -0.02939322032034397, -0.009188510477542877, 0.012768775224685669, -0.01894035004079342, 0.016486741602420807, 0.02756553329527378, -0.002631995128467679, -0.020317375659942627, 0.023159053176641464, 0.007310749962925911, 0.037329889833927155, -0.019103089347481728, -0.027415310963988304, 0.012099040672183037, 0.03457584232091904, -0.026839464902877808, 0.005627023987472057, -0.022821055725216866, 0.007229380309581757, 0.03835640102624893, -0.028441820293664932, 0.010828422382473946, -0.040634751319885254, -0.007980484515428543, 0.027790863066911697, 0.004099778365343809, 0.009720543399453163, -0.026614133268594742, -0.017150217667222023, -0.019841674715280533, -0.007742634974420071, -0.011153900995850563, -0.02322164550423622, 0.005883651319891214, 0.013457288034260273, -0.006979011930525303, 0.02139395847916603, -0.032898373901844025, -0.0037273557391017675, 0.005661449860781431, 0.014220910146832466, 0.03963327780365944, 0.011241530068218708, 0.03314874321222305, 0.03327392786741257, -0.005896169692277908, 0.005520617589354515, -0.0024426542222499847, 0.017575843259692192, -0.011992634274065495, -0.0006016659317538142, 0.020542705431580544, 0.022107508033514023, 0.012368186376988888, -0.009883282706141472, -0.0013566823909059167, 0.04378938674926758, -0.04581737145781517, -0.006766199134290218, 0.025762882083654404, -0.02076803706586361, -0.010102354921400547, -0.010158687829971313, -0.01364506408572197, -0.028041232377290726, 0.016536815091967583, -0.02449852228164673, -0.016912367194890976, -0.005420470144599676, -0.0036929300986230373, -0.020129598677158356, -0.025262145325541496, 0.014396168291568756, -0.04461560398340225, -0.020317375659942627, 0.061240047216415405, 0.006703607272356749, -0.0076925610192120075, -0.008124446496367455, -0.016298966482281685, 0.00917599257081747, -0.025687770918011665, -0.0020968331955373287, -0.03717966750264168, 0.04336376115679741, -0.0060370019637048244, -0.020279819145798683, 0.02876729890704155, 0.009539025835692883, -0.0023487661965191364, -0.001463088789023459, 0.0004334498371463269, -0.002941825659945607, -0.02051766961812973, 0.0027071055956184864, -0.023083942010998726, -0.02139395847916603, 0.0015311576426029205, 0.014133282005786896, 0.030970539897680283, -0.0007620580145157874, 0.021794546395540237, 0.02756553329527378, -0.024198081344366074, 0.004440905060619116, 0.010083576664328575, -0.033349037170410156, -0.009927096776664257, 0.005379785317927599, -0.03192193806171417, 0.0280913058668375, -3.5134671634295955e-05, 0.004318850580602884, 0.006453238893300295, 0.01747569628059864, -0.002948084846138954, -0.010277612134814262, 0.016549333930015564, 0.01059683132916689, 0.010071058757603168, 0.025762882083654404, -0.006446979474276304, 0.021531660109758377, 0.0027008464094251394, 0.017162736505270004, 0.0100335031747818, 0.018477169796824455, 0.011998893693089485, -0.00977687630802393, -0.008756625466048717, -0.004287554416805506, 0.04226214438676834, -0.0002624953631311655, -0.04008394107222557, -0.012430778704583645, 0.011322899721562862, 0.009589100256562233, 0.0035176724195480347, 0.002243924420326948, -0.030369656160473824, -0.014709128066897392, -0.028016194701194763, 0.01378276664763689, -0.006528349127620459, 0.03670397028326988, -0.017137698829174042, 0.002239230088889599, -0.023008832708001137, 0.0022627022117376328, 0.005805411376059055, -0.02189469337463379, 0.044991154223680496, 0.0012557527516037226, 0.019165681675076485, 0.008800440467894077, -0.016148746013641357, 0.023684825748205185, 0.022007359191775322, -0.014934459701180458, 0.044290125370025635, 0.007849041372537613, 0.022983795031905174, 0.037505146116018295, 0.019015461206436157, 0.009814430959522724, 0.03765536844730377, 0.024373339489102364, -0.01920323632657528, -0.01229933463037014, -0.0018887147307395935, -0.032297492027282715, 0.03147127479314804, 0.003814984578639269, -0.01956626959145069, 0.0047976793721318245, 0.013432251289486885, 0.03470102325081825, 0.032898373901844025, -0.008018040098249912, -0.004362665116786957, 0.013382176868617535, -0.02876729890704155, 0.030494840815663338, 0.010859718546271324, 0.019541233777999878, 0.009495211765170097, -0.008011780679225922, -0.008593886159360409, 0.006093334872275591, 0.031596459448337555, -0.024223117157816887, -0.034650951623916626, 2.1882762666791677e-05, -0.0003714446211233735, 0.010427833534777164, -0.021669363602995872, -0.012048967182636261, 0.00817451998591423, -0.006753680761903524, 0.010991161689162254, -0.00991457886993885, 0.044991154223680496, 0.016849776729941368, 0.01191752403974533, -0.03102061338722706, -0.0005648931255564094, 0.02608836069703102, 0.02007952518761158, 0.010233798064291477, 0.003145249793305993, -0.021581733599305153, 0.006534608546644449, 0.023609716445207596, 0.029593514278531075, 0.01246833335608244, -0.03753018379211426, 0.0010898838518187404, -0.022270245477557182, 0.019278347492218018, -0.010953606106340885, -0.03923268988728523, 0.010265094228088856, -0.003107694676145911, 0.008324740454554558, -0.0005472890916280448, 0.042712803930044174, 0.012768775224685669, -0.012537185102701187, 0.015184828080236912, 0.007924151606857777, 0.012005152180790901, -0.027966121211647987, -0.00933873187750578, -0.025074370205402374, 0.034200288355350494, -0.01447127852588892, -0.04311339557170868, -0.02616347186267376, -0.009050808846950531, -0.003811855101957917, 0.0011595174437388778, 0.01868998259305954, 0.0020217227283865213, 0.008981957100331783, 0.0030122417956590652, -0.04716935753822327, 0.0295434407889843, 0.016724592074751854, -0.015059643425047398, 0.01860235258936882, -0.016198819503188133, 0.008719070814549923, 0.009983429685235023, -0.02173195406794548, 0.017062589526176453, 0.01981663890182972, 0.007742634974420071, 0.0255625881254673, 0.004400220233947039, 0.0023550253827124834, -0.01316936407238245, -0.0511251762509346, -0.027615606784820557, 0.007216861937195063, -0.015698082745075226, -0.034025032073259354, 0.010759570635855198, 0.002686763182282448, 0.0027008464094251394, -0.015022088773548603, -0.0009302741382271051, 0.009370028041303158, 0.02363475225865841, -0.006215389352291822, 0.03112076036632061, 0.019103089347481728, 0.034726060926914215, -0.005079343914985657, -0.022971278056502342, -0.007091677747666836, 0.017400585114955902, 0.006368739530444145, 0.0016148745780810714, -0.009833209216594696, -0.0005359443021006882, -0.03339910879731178, 0.05643298104405403, 0.006822532042860985, 0.023184090852737427, 0.01652429811656475, -0.005968150682747364, 0.008850513957440853, -0.04398968443274498, -0.002955908887088299, -0.0032860818319022655, 0.013269511982798576, -0.01116641890257597, 0.012568481266498566, 0.011692192405462265, 0.017438141629099846, 0.007260676007717848, -0.0032141010742634535, 0.015234901569783688, 0.013319585472345352, 0.02407289668917656, 0.009244843386113644, -0.029017668217420578, -0.016223855316638947, 0.01694992370903492, -0.03692930191755295, -0.027265090495347977, 0.01016494631767273, 0.0003585350059438497, -0.020455077290534973, 0.003123342525213957, -0.009770616888999939, -0.018715018406510353, 0.037430036813020706, 0.027615606784820557, 0.013670100830495358, -0.006991530302911997, 0.012818848714232445, 0.019866712391376495, -0.006174704525619745, -0.0006818620022386312, -0.03094550222158432, -0.002600699197500944, -0.005376656074076891, 0.007874078117311, 0.004838364198803902, 0.011554489843547344, 0.004725698847323656, -0.011028716340661049, -0.0023065165150910616, -0.004691272974014282, -0.008581368252635002, -0.0372297428548336, 0.0061277602799236774, 0.020405003800988197, 0.029268035665154457, 0.023784974589943886, -0.01464653667062521, -0.026138434186577797, -0.01534756738692522, -0.013532398268580437, 0.018289392814040184, -0.006184093188494444, 0.016148746013641357, -0.041586149483919144, -0.004644329193979502, -0.024974223226308823, -0.0007612756453454494, -0.003639726899564266, -0.0053703966550529, 0.043589092791080475, -0.02373489923775196]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
"◦mq)·K⊤
τ
(8)
where τis the softmax temperature. Due to the mask mq,
only the components of Kcorresponding to non-zero ele-
ments of the mask need to be fetched from memory. The
top-k mask mˆs∈ {0,1}Scan then be calculated using
ˆs(see Figure 3e) and the approximate attention output is
obtained as:
y3= softmaxq·K⊤
√dh+ log( mˆs+ϵ)
·V (9)
withϵ→0. Again, due to the mask mˆs, only the key-value
pairs corresponding to the non-masked elements need to be
fetched from the memory.
Mean value reallocation with query sparsity As a final
consideration, we look at combining the mean value reallo-
cation improvement of Equation (7) with the approach inEquation (9). As we do not have access to the full scores
s, we proceed to approximate the weighted sum using the
approximate scores in Equation (8). Note that, since the
query-key dot product is performed over only rdimensions,
care needs to be taken when choosing the appropriate soft-
max temperature τin Equation (8). If rcomponents were
chosen randomly, the appropriate temperature would be√r.
On the other hand, if the top- rcomponents were the only
non-zero elements of the query vector, the appropriate tem-
perature would remain√dh. As a balance between the two
extremes, we have found the following temperature to yield
a good approximation (see Figure 3f):
τ=s
dh∥q◦mq∥1
∥q∥1(10)
The final attention output can be then calculated as a
weighted sum:
y=αy3+ (1−α)¯v (11)
where α=mˆs·ˆsis the relative weight of the top- kterms.
0.0 0.2 0.4 0.6 0.8 1.0
Sum of top-32 attention scores050010001500200025003000Count
(a)
0 8 16 24
Layer0
8
16
24Head (sorted)
0.00.20.40.60.81.0
Sum of top-32 attention scores (b)
−10−5 0 5 10
Components of q(z-score)100
10−3
10−6
10−9
10−12DensityKDE per-head Unit Gaussian (c)
0 8 16 24
Layer0102030Kurtosis
(d)
8 16 32 64
r0.00.51.0Top-kagreement
k
64
128
256 (e)
 (f)
Figure 3: Statistics of Llama 7B, evaluated over 40 SQuAD queries, over all 32layers ×32heads unless noted. (a) Sum
softmax output allocated to the 32highest-scoring positions, demonstrating natural attention sparsity; (b) for each head.
(c) Kernel density estimate (Rosenblatt, 1956) of components of qin layer 16, showing heavy tails. (d) Fisher Kurtosis of
qcomponents, for each head, showing that the query vector is leptokurtic for most heads. (e) Top- kagreement between
approximate and true scores for multiple values of rselected from query vector. Top- kagreement is the proportion of the
top-kpositions that are correctly predicted by an approximated softmax, using a projection of q. (f) Agreement between the
coverage αbased on estimated scores versus the true mass of the top 128scores, for different softmax temperatures (a point
for each example ×head), showing the importance of correct temperature. Further analysis is presented in Appendix D.
4
SparQ Attention: Bandwidth-Efficient LLM Inference
4. SparQ Attention
Following the analysis in Section 3, we propose SparQ
Attention (see Algorithm 1) consisting of three steps:
Step 1: Find the indices of rlargest components of |q|and
only fetch Kalong the dimensions corresponding
to these indices. Calculate approximate attention
scores ˆsusing the sliced query and keys.
Step 2: Find the top- kpositions in the approximate atten-
tion scores and fetch the corresponding fullkey and
value vectors. Calculate the output of the attention
operation using the top- kkeys and values.
Step 3: Estimate the total score αassigned to the top- kpo-
s","[0.028534088283777237, 0.042468149214982986, 0.03429725766181946, -0.010002299211919308, 0.0010005501098930836, -0.02415408007800579, -0.045516226440668106, 0.014817746356129646, -0.060295552015304565, 0.0101239662617445, -0.008734402246773243, -0.030660057440400124, -0.0194154754281044, 0.028508473187685013, 0.016687575727701187, 0.012858269736170769, 0.03967621549963951, -0.045567452907562256, -0.016508275642991066, -0.023961974307894707, -0.05558256059885025, -0.04971693456172943, 0.024730397388339043, 0.013485814444720745, 0.004716192837804556, 0.0010621839901432395, 0.006176195573061705, -0.012717392295598984, 0.027944963425397873, -0.013473007827997208, 0.0416484996676445, -0.03831866756081581, -0.016405820846557617, -0.055377647280693054, -0.00048706779489293694, 0.01597038097679615, -0.014279850758612156, 0.052560098469257355, -0.06265204399824142, -0.030429530888795853, -0.0068901884369552135, -0.01308879628777504, -0.06229344755411148, 0.006704485975205898, 0.04508078470826149, -0.011212565004825592, -0.0003131721750833094, -0.022143375128507614, 0.006806942634284496, 0.046515174210071564, -0.010424931533634663, 0.035910945385694504, -0.04292920231819153, 0.04413306340575218, 0.033195849508047104, 0.006896591745316982, -0.003621191019192338, 0.04887166991829872, 0.07161697745323181, 0.002393315779045224, -0.002311670919880271, -0.014203009195625782, 0.0030768916476517916, 0.010777125135064125, -0.015675818547606468, -0.0057183438912034035, -0.043134115636348724, 0.02697162888944149, 0.04372324049472809, -0.0004830655816476792, -0.032068829983472824, 0.05686326324939728, 0.06050046160817146, -0.0008660761523060501, 0.02036319486796856, 0.019428281113505363, -0.00013237277744337916, 0.022924603894352913, 0.01658511906862259, -0.01771213859319687, 0.0376783162355423, -0.0020875476766377687, 0.06516222655773163, -0.0015472506638616323, -0.04152042791247368, -0.06546959280967712, -0.027099698781967163, -0.007005451712757349, -0.05496782064437866, -0.029200054705142975, -0.04756535217165947, 0.045900434255599976, -0.0029328125528991222, 0.0003674020117614418, 0.046463944017887115, 0.029148826375603676, 0.031018653884530067, 0.010693879798054695, -0.004799438640475273, 0.020696178078651428, 0.02284776233136654, -0.0020555302035063505, -0.02178477682173252, -0.055889926850795746, 0.03542427718639374, 0.0044088237918913364, -0.029046369716525078, 0.010617037303745747, 0.012678970582783222, -0.021771971136331558, -0.0181603841483593, 0.013703534379601479, -0.03844673931598663, 0.033195849508047104, 0.01196177676320076, -0.047488510608673096, -0.06623801589012146, -0.038959018886089325, -0.018083542585372925, 0.03025023080408573, -0.003477111691609025, 0.007825102657079697, 0.02183600515127182, 0.02668987400829792, -0.012064232490956783, -0.04405622184276581, 0.024051623418927193, -0.048897285014390945, -0.0031425277702510357, -0.0002879583335015923, 0.0389334037899971, 0.009246683679521084, 0.061422571539878845, -0.014074938371777534, 0.017199857160449028, 0.015509326942265034, 0.008574314415454865, 0.01531722117215395, -0.036371998488903046, -0.014510378241539001, 0.005455799400806427, 0.010937212966382504, -0.004101455211639404, 0.003521936247125268, -0.03690989315509796, 0.02973794937133789, -0.02702285721898079, 0.02246355079114437, -0.03457901254296303, 0.03939446061849594, 0.013857218436896801, -0.04687377065420151, -0.07187311351299286, 0.032017603516578674, -0.01258291769772768, -0.0389334037899971, -0.0014135772362351418, -0.019146526232361794, 0.00046985832159407437, -0.026151977479457855, 0.010175194591283798, -0.016495469957590103, 0.04956325143575668, -0.04423552006483078, 0.00198188959620893, 0.008036418817937374, -0.056965719908475876, 0.009938264265656471, -0.0751517191529274, -0.05399448797106743, -0.03662813827395439, -0.039471302181482315, 0.01822442002594471, -0.06075660511851311, -0.0035187345929443836, -0.001714542624540627, 0.009016157127916813, 0.009502824395895004, -0.01503546629101038, -0.020555300638079643, -0.025985486805438995, -0.004668166395276785, 0.021848812699317932, 0.020055826753377914, -0.0007392064435407519, 0.012384409084916115, -0.02013266831636429, 0.0001228675537277013, 0.015253186225891113, 0.006704485975205898, 0.008830455131828785, 0.03414357081055641, 0.034322869032621384, 0.0037044365890324116, -0.01996617764234543, -0.05089518055319786, 0.028277946636080742, 0.044209904968738556, -0.021541442722082138, 0.003902945900335908, -0.0034643046092242002, 0.030224617570638657, 0.046233419328927994, -0.07289768010377884, 0.0029168035835027695, 0.03076251409947872, 0.00374605949036777, -0.01997898519039154, -0.05788782611489296, -0.029661107808351517, 0.034553397446870804, -0.008004400879144669, 0.08452647179365158, 0.009855017997324467, -0.032862868160009384, 0.04531131312251091, -0.05066465586423874, 0.025601275265216827, -0.009919053874909878, 0.07064364105463028, 0.01709740050137043, 0.027355840429663658, 0.016124064102768898, 0.01930021122097969, -0.08473138511180878, 0.04474780336022377, 0.06992644816637039, -0.02607513591647148, 0.017929857596755028, -0.012614935636520386, 0.013959675095975399, 0.01844213902950287, 0.01122537162154913, -0.014484764076769352, -0.010687476024031639, -0.055941157042980194, 0.017020557075738907, -0.031172338873147964, -0.01365230605006218, -0.05460922420024872, 0.013703534379601479, 0.01653389073908329, 0.01880073733627796, 0.009522034786641598, -0.003301014890894294, 0.0097077377140522, -0.003355444874614477, -0.03498883545398712, 0.036243926733732224, -0.002423732541501522, -0.009995895437896252, -0.029917247593402863, -0.043646395206451416, -0.01472809724509716, -0.04876921325922012, 0.0032337778247892857, -0.021195653825998306, 0.026280049234628677, 0.0033458394464105368, -0.025088993832468987, -0.04789833351969719, -0.01509950216859579, -0.036935508251190186, -0.018237227573990822, -0.009381157346069813, -0.007287206593900919, -0.002659061923623085, -0.0009477210696786642, -0.01799389347434044, -0.01360107772052288, -0.032990939915180206, 0.014612833969295025, -0.008862472139298916, 0.004988342523574829, -0.004005402326583862, -0.00526369409635663, 0.02307828888297081, -0.025178642943501472, -0.026254434138536453, -0.013793183490633965, 0.016047222539782524, -0.02120845951139927, 0.046796929091215134, 0.0012294759508222342, 0.016956523060798645, -0.029661107808351517, 0.006819749716669321, -0.02302706055343151, -0.007466505281627178, -0.008190102875232697, 0.03573164343833923, -0.04146920144557953, 0.058605022728443146, -0.017750559374690056, -0.001653709216043353, 0.007626593112945557, -0.013985289260745049, -0.02645934745669365, -0.016431434080004692, 0.005321325734257698, 0.03437409922480583, 0.015227572061121464, 0.030147776007652283, -0.007639400195330381, -0.0004106257692910731, 0.007408873178064823, 0.02166951447725296, 0.016687575727701187, -0.025690924376249313, -0.008593524806201458, -0.004280753433704376, 0.022092146798968315, -0.0062370290979743, 0.03724287450313568, -0.04244253411889076, -0.05937344208359718, 0.03606462851166725, -3.529440436977893e-05, 0.00695422338321805, 0.006547600030899048, -0.002170793479308486, -0.06751871854066849, 0.0022220215760171413, 0.007504926063120365, 0.038959018886089325, -0.032248128205537796, -0.047309212386608124, 0.008702384307980537, 0.0015624590450897813, -0.05025482922792435, 0.04597727954387665, -0.000645955151412636, -0.002724698046222329, -0.021912848576903343, -0.05660712346434593, 0.008900893852114677, -0.008612735196948051, 0.027509525418281555, -0.02488408051431179, 0.03227374330163002, -0.03352883458137512, -0.01930021122097969, -0.03334953635931015, 0.003259391989558935, 0.005058781243860722, 0.05466045066714287, 0.01923617534339428, -0.015509326942265034, 0.04239130765199661, -0.009387561120092869, -0.006730100139975548, 0.002394916722550988, 0.05327729135751724, -0.04190463945269585, 0.043825697153806686, -0.02200249768793583, 0.020017405971884727, -0.04682254418730736, -0.023897938430309296, 0.005215667653828859, -0.007812295109033585, -0.004232726991176605, 0.06275450438261032, -0.034732695668935776, 0.02922566793859005, -0.004716192837804556, -0.011724846437573433, 0.012858269736170769, -0.004671368282288313, -0.006749310996383429, -0.020504072308540344, 0.02635689079761505, -0.016828453168272972, -0.054762907326221466, -0.03965060040354729, -0.024794431403279305, 0.006774924695491791, 0.04925588145852089, -0.0026334477588534355, 0.036192700266838074, 0.014433535747230053, 0.008824051357805729, -0.014535991474986076, -0.01239081285893917, 0.03076251409947872, 0.013870025984942913, 0.006281853653490543, 0.007229574955999851, -0.06531590968370438, -0.013447393663227558, -0.042288850992918015, -0.01641862653195858, -0.04013726860284805, -0.007325627841055393, 0.03752462938427925, 0.017058979719877243, -0.013460200279951096, 0.047027457505464554, 0.03119795210659504, 0.07259031385183334, -0.002284456044435501, 0.015355642884969711, -0.00023733048874419183, -0.03714042156934738, 0.02246355079114437, -0.021938461810350418, -0.009490017779171467, 0.019056877121329308, -0.00460092956200242, -0.01625213585793972, 0.0806843638420105, -0.028739001601934433, 0.013959675095975399, -0.009861421771347523, 0.006627643946558237, -0.013972481712698936, -0.000200310125364922, 0.014856168068945408, -0.00764580350369215, 0.013946867547929287, -0.015086694620549679, -0.013460200279951096, 0.002154784742742777, 0.026305662468075752, -0.03109549544751644, -0.009694930166006088, 0.0516636036336422, -0.0641888901591301, 0.017174242064356804, -0.02387232519686222, -0.02674110233783722, 0.018775122240185738, -0.01297993678599596, -0.04536253958940506, -0.03593655675649643, -0.014074938371777534, -0.005180448293685913, 0.05394325777888298, -0.010962827131152153, -0.04659201577305794, -0.000756015651859343, -0.021861620247364044, -0.04152042791247368, -0.015983186662197113, -0.06797977536916733, 0.009758965112268925, -0.0019786879420280457, -0.040649548172950745, 0.022591620683670044, 0.010911598801612854, -0.03358006104826927, -0.004293560516089201, 0.06111520156264305, 0.016943715512752533, -0.0009565259097144008, -0.03921515867114067, 0.07274399697780609, -0.0036724191159009933, 0.00981659721583128, -0.045849207788705826, 0.04485026001930237, -0.001730551477521658, -0.05517273396253586, 0.01935143955051899, -0.026613032445311546, -0.024294957518577576, 0.016277749091386795, -0.018864771351218224, 0.03142847865819931, 0.03409234434366226, -0.009035367518663406, -0.03685866668820381, 0.013095200061798096, -0.035680416971445084, -0.03939446061849594, -0.00736404862254858, 0.03171023353934288, -0.0320432186126709, 0.04006042703986168, -0.022860568016767502, 0.040316566824913025, -0.04930710792541504, -0.014676868915557861, 0.023449692875146866, 0.031505320221185684, 0.030096547678112984, 0.054301854223012924, 0.012256338261067867, 0.039240773767232895, 0.01900564879179001, -0.03542427718639374, -0.02725338377058506, 0.048717986792325974, -0.01334493700414896, 0.029302511364221573, 0.01951793022453785, 0.03785761445760727, 0.0018378103850409389, 0.007460101507604122, -0.020580915734171867, 0.04328779876232147, -0.0019434684654697776, 0.005990493576973677, 0.018237227573990822, 0.003544348757714033, 0.05440431088209152, 0.022425130009651184, 0.024051623418927193, -0.01787862926721573, 0.053123608231544495, 0.010027913376688957, 0.020555300638079643, -0.002050727605819702, 0.03288848325610161, -0.011724846437573433, 0.008094049990177155, -0.007965980097651482, -0.00478022824972868, -0.017673717811703682, 0.013332130387425423, -0.02302706055343151, -0.011782477609813213, -0.028457246720790863, -0.00998949259519577, -0.0004214317013975233, -0.012185899540781975, -0.04100814461708069, -0.09712859988212585, -0.030224617570638657, -0.057119403034448624, 0.01278142724186182, -0.06014186516404152, -0.02730461210012436, 0.015752660110592842, -0.02211776003241539, 0.013140024617314339, 0.0006919804727658629, -0.03104426898062229, -0.048154477030038834, 0.016790030524134636, 0.009246683679521084, 0.005257290322333574, 0.009931860491633415, 0.005158036015927792, 0.025037765502929688, -0.026817943900823593, 0.029020756483078003, 0.00355395395308733, -0.013741955161094666, 0.003646804951131344, -0.012960725463926792, -0.02041442319750786, 0.0027887332253158092, 0.03278602659702301, -0.03240181505680084, 0.0057631684467196465, -0.01992775686085224, 0.030506372451782227, -0.018608631566166878, -0.03788322955369949, 0.047360438853502274, 0.0015920753357931972, -0.035910945385694504, -0.00818369910120964, -0.02466636151075363, 0.0007884334772825241, 0.029200054705142975, -0.024563904851675034, 0.02188723348081112, 0.02645934745669365, -0.0152916070073843, -0.012685374356806278, -0.0017049374291673303, -0.03542427718639374, 0.027330225333571434, -0.0035827697720378637, 0.022476358339190483, -0.01585511676967144, -0.0044184294529259205, 0.015086694620549679, -0.03936884552240372, 0.0014696080470457673, -0.02640811912715435, 0.003890138817951083, -0.020286353304982185, -0.0009997496381402016, -0.006915802136063576, 0.026664260774850845, -0.023680219426751137, 0.02567811869084835, 0.04659201577305794, -0.013191252946853638, 0.02702285721898079, 0.00838220864534378, -0.032017603516578674, -0.020068634301424026, -0.04461973160505295, -0.0391383171081543, -0.020849863067269325, 0.02020951174199581, 0.02866215817630291, -0.001321526593528688, -0.02093951217830181, -0.013946867547929287, -0.015727046877145767, 0.03939446061849594, -0.010316072031855583, 0.05212465673685074, 0.029379352927207947, 0.0006723696715198457, -0.004706587642431259, -0.035296205431222916, -0.04841061681509018, -0.00751773314550519, -0.021964075043797493, -0.0014311869163066149, -0.04851307347416878, -0.028687773272395134, 0.013946867547929287, 0.00989984255284071, -0.006384310312569141, -0.0028399613220244646, 0.010168790817260742, 0.05056219920516014, 0.015240379609167576, 0.013011953793466091, 0.011129318736493587, -0.03142847865819931, -0.011615986004471779, -0.007857119664549828, -0.04756535217165947, 0.014740904793143272, 0.0027455093804746866, 0.008548700250685215, -0.02216898836195469, 0.02065775729715824, 0.015534941107034683, -0.0003213766904082149, 0.055736243724823, 0.020452845841646194, 0.024410219863057137, 0.03770393133163452, 0.017648102715611458, -0.04825692996382713, 0.04126428812742233, 0.014074938371777534, -0.04000919684767723, -0.008939314633607864, -0.014587219804525375, -0.018301261588931084, -0.024358993396162987, -0.05104886740446091, 0.021746356040239334, -0.008676770143210888, 0.02871338650584221, -0.021631093695759773, -0.014600027352571487, -0.018134770914912224, 0.023334428668022156, 0.009406771510839462, -0.06567450612783432, -0.019095297902822495, -0.01303756795823574, -0.056453436613082886, 0.022834954783320427, 0.03165900707244873, 0.011968180537223816, -0.009157034568488598, 0.0029376151505857706, -0.021118810400366783, -0.012935111299157143, 0.01421581581234932, 0.018659859895706177, 0.0035667610354721546, 0.009714140556752682, -0.008369401097297668, -0.02246355079114437, -0.02861092984676361, -0.022834954783320427, 0.02195126935839653, -0.02567811869084835, 0.007607382722198963, -0.0387284941971302, -0.01503546629101038, -0.008651155978441238, -0.022770918905735016, 0.02533232793211937, -0.022553199902176857, 0.02453829161822796, -0.022386707365512848, -0.015214765444397926, 0.004834658000618219, 0.0415460430085659, -0.049998689442873, -0.019543545320630074, 0.02861092984676361, -0.008106857538223267, 0.03273479640483856, -0.010111158713698387, -0.027919350191950798, -0.02528109960258007, 0.01986372098326683, -0.014382307417690754, -0.013793183490633965, -0.01531722117215395, -0.029148826375603676, -0.00667246850207448, 0.013613885268568993, 0.04633587598800659, -0.013818797655403614, -0.0012783028651028872, 0.0028703780844807625, -0.001387162716127932, -0.014894588850438595, -0.004536894615739584, 0.010002299211919308, -0.006570012308657169, 0.012339584529399872, -0.0038197000976651907, 0.002755114808678627, -0.0417509563267231, 0.004021410830318928, -0.054148171097040176, -0.022322673350572586, 0.027407068759202957, -0.005260492209345102, -0.029763564467430115, -0.004956325050443411, 0.014279850758612156, 0.02042723074555397, -0.00027315018814988434, 0.04254499077796936, 0.013434586115181446, -0.04047024995088577, -0.04113621637225151, -0.027074085548520088, -0.030506372451782227, 0.016162486746907234, -0.032017603516578674, -0.024563904851675034, 0.04961447790265083, -0.03578287363052368, 0.008113260380923748, 0.027432681992650032, 0.012538093142211437, 0.018096350133419037, 0.024051623418927193, -0.006634047254920006, -0.019172141328454018, -0.007133522070944309, -0.024679169058799744, 0.010501774027943611, 0.031402863562107086, 0.022322673350572586, 0.005558256059885025, -0.02077302150428295, 0.0006379507249221206, -0.02052968740463257, 0.012205109931528568, 0.009829403832554817, 0.006374704651534557, -0.01653389073908329, -0.02239951491355896, 0.02674110233783722, 0.009861421771347523, -0.0332983061671257, 0.03035268746316433, -0.022092146798968315, 0.021029161289334297, -0.005475010257214308, 0.006182599347084761, 0.001101405592635274, 0.022156180813908577, 0.029814792796969414, 0.0306856706738472, -0.02730461210012436, 0.010520984418690205, -0.012410023249685764, -0.0013111208099871874, 0.0373709462583065, 0.01280704140663147, -0.03921515867114067, -0.005116412881761789, -0.01498423796147108, -0.0051996586844325066, -0.005084395408630371, -0.03708919137716293, 0.014369500800967216, -0.007530540227890015, 0.004213516600430012, -0.01477932557463646, 0.0032770016696304083, -0.02725338377058506, -0.026587417349219322, 0.018826350569725037, 0.020452845841646194, 0.007434487342834473, -0.08703665435314178, -0.03250427171587944, 0.014395114034414291, -0.004476061090826988, 0.026715489104390144, 0.022335480898618698, 0.0010821949690580368, 0.0014560004929080606, 0.03025023080408573, 0.017481612041592598, 0.008330980315804482, 0.005074790213257074, 0.001387162716127932, 0.012819848023355007, -0.009035367518663406, -0.06582818925380707, -0.0030576810240745544, 0.036243926733732224, 0.008427033200860023, -0.03954814374446869, -0.007876330055296421, -0.025088993832468987, 0.004632947035133839, 0.015214765444397926, -0.014177395030856133, -0.0445685051381588, 0.00017269494128413498, -0.03842112421989441, 0.023039868101477623, 0.02064494974911213, 0.00374605949036777, 0.007293609902262688, 0.025076186284422874, 0.03542427718639374, -0.03690989315509796, -0.026254434138536453, -0.01602160930633545, 0.02651057578623295, 0.017814595252275467, -0.008932910859584808, 0.013216866180300713, -0.06260082125663757, 0.02809864841401577, -0.009726948104798794, 0.01219230331480503, -0.011014055460691452, 0.030045319348573685, 0.009688526391983032, 0.01447195652872324, 0.0024109254591166973, -0.01421581581234932, -0.03844673931598663, 0.01280704140663147, 0.021131617948412895, -0.0058111948892474174, 0.015509326942265034, -0.0030320670921355486, 0.0027423077262938023, 0.01040572114288807, 0.006678872276097536, -0.026766715571284294, 0.0013175243511795998, 0.04044463485479355, -0.03765270113945007, -0.01040572114288807, -0.03119795210659504, -0.021131617948412895, 0.009624491445720196, 0.0250505730509758, -0.011238179169595242, -0.019902141764760017, -0.02482004649937153, -0.009406771510839462, -0.003954173997044563, -0.01731511950492859, -0.004495271481573582, 0.023180745542049408, 0.013575463555753231, -0.03921515867114067, 0.0360133983194828, -0.002124367980286479, -0.03457901254296303, 0.009586070664227009, -0.001415178063325584, 0.000369803310604766, 0.001951472950167954, 0.036243926733732224, -0.0054878173395991325, -0.014689676463603973, 0.032299358397722244, 0.039240773767232895, -0.025601275265216827, 0.021579865366220474, 4.164789788774215e-05, 0.01681564562022686, -0.005516632925719023, 0.027355840429663658, -0.006493169814348221, 0.06424012035131454, 0.0008724796934984624, 0.03821621090173721, 0.01331932283937931, 0.021643899381160736, -0.05558256059885025, -0.02178477682173252, -0.02319355122745037, -0.006909398827701807, -0.0015976784052327275, 0.032478656619787216, -0.025985486805438995, -0.002910400042310357, -0.0070694866590201855, 0.00537255359813571, 0.0038357088342309, 0.014228623360395432, 0.019902141764760017, 0.026216013357043266, 0.022719690576195717, 0.04520885646343231, -0.02387232519686222, 0.012089846655726433, 0.040495865046978, -0.009720544330775738, 0.004293560516089201, 0.0037268490996211767, -0.03560357540845871, -0.007716242223978043, 0.02522987127304077, 0.023270394653081894, 0.0028271544724702835, 0.01306318212300539, 0.03967621549963951, -0.003569962689653039, -0.0036532084923237562, -0.007658610586076975, 0.014049324207007885, 0.0174303837120533, 0.022361094132065773, -0.036423224955797195, 0.02894391305744648, -0.01868547312915325, 0.027150927111506462, 0.054814137518405914, 0.031223567202687263, -0.0222842525690794, 0.013024761341512203, 0.001512031303718686, -0.018659859895706177, -0.017929857596755028, 0.016777224838733673, 0.021400565281510353, -0.04041902348399162, 0.029071982949972153, 0.021861620247364044, 0.0023340831976383924, 0.030839355662465096, -0.025972679257392883, -0.02070898562669754, 0.004693780560046434, 0.03885656222701073, 0.02239951491355896, 0.011071687564253807, 0.04423552006483078, -0.00682615302503109, 0.01703336462378502, -0.005705536808818579, -0.014331079088151455, -0.0056767212226986885, -0.007043872494250536, 0.036653753370046616, 0.022886183112859726, -0.009368350729346275, 0.029379352927207947, 0.05840010941028595, 0.0016873277490958571, 0.02488408051431179, -0.0028415622655302286, -0.01896722801029682, 0.005266895517706871, 0.006851767189800739, -0.006941416300833225, 0.021759163588285446, -0.006595626473426819, 0.0124740581959486, 0.05496782064437866, 0.006813345942646265, 0.008170892484486103, 0.0072167678736150265, -0.0011022059479728341, -0.0008868876029737294, 0.030224617570638657, 0.011558354832231998, -0.011942566372454166, 0.00012026612239424139, -0.013818797655403614, -0.018134770914912224, 0.017135821282863617, 0.01833968237042427, -0.018314069136977196, 0.0012839059345424175, -0.011724846437573433, 0.04344148561358452, -0.002878382569178939, 0.020273545756936073, -0.017353540286421776, 0.0152916070073843, -0.016277749091386795, -0.03626954182982445, 0.008318173699080944, -0.026817943900823593, -0.022924603894352913, -0.012205109931528568, -0.038344282656908035, -0.005334132816642523, 0.0053917644545435905, -0.026382505893707275, 0.0007135923369787633, 0.010802739299833775, -0.046079736202955246, -0.010597826912999153, -0.017673717811703682, -0.027176542207598686, -0.0057247476652264595, 0.001634498592466116, 0.022245829924941063, -0.013588271103799343, 0.015701431781053543, -0.03655129671096802, -0.016277749091386795, 0.028841456398367882, -0.006454749032855034, 0.03826744109392166, -0.0015720643568783998, 0.00820931326597929, -0.03673059493303299, -0.006371503230184317, -0.024794431403279305, -0.039240773767232895, 0.0030864968430250883, 0.020632144063711166, 0.010623441077768803, 0.021515829488635063, 0.015112308785319328, 0.02668987400829792, -0.014651255682110786, -0.014203009195625782, 0.016943715512752533, 0.033323921263217926, -0.013998095877468586, -0.022053726017475128, 0.000898093800060451, -0.004738605115562677, 0.035168133676052094, -0.0011750460835173726, -0.01562459021806717, -0.0002139176067430526, -0.012416426092386246, 0.03391304612159729, 0.027970578521490097, 0.0033426377922296524, -0.016328977420926094, 0.008106857538223267, -0.03626954182982445, -0.04044463485479355, 0.03007093258202076, -0.026817943900823593, 0.009067385457456112, -0.014420728199183941, -0.02465355396270752, 0.02549881860613823, -0.036704979836940765, -0.006048125214874744, 0.01913372054696083, 0.003509129397571087, 0.013498621992766857, 0.01883915811777115, 0.0015456498367711902, -0.025985486805438995, 0.03583410009741783, -0.0030496767722070217, -0.01199379377067089, 0.004165490157902241, -0.0221817959100008, -0.02927689626812935, 0.011942566372454166, 0.007793084718286991, -0.03575725853443146, 0.0014752111164852977, 0.0432109571993351, -0.02369302697479725, 0.027996191754937172, 0.03001970425248146, 0.004696982447057962, -0.023347236216068268, 0.019389860332012177, -0.00849106814712286, -0.017955472692847252, 0.0046073333360254765, 0.037268489599227905, -0.047360438853502274, 0.01232677698135376, -0.020273545756936073, 0.04157165437936783, 0.020798634737730026, 0.039522528648376465, 0.01771213859319687, -0.010988441295921803, -0.029020756483078003, -0.013703534379601479, 0.006086546462029219, 0.002404521917924285, 0.016124064102768898, 0.008907297626137733, 0.013460200279951096, 0.008049225434660912, 0.006144178099930286, 0.01148151233792305, -0.01636739820241928, 0.014279850758612156, -0.01360107772052288, -0.00488268444314599, 0.04131551459431648, -0.022028110921382904, -0.02065775729715824, -0.007722645998001099, -0.007767470553517342, -0.018775122240185738, -0.017699331045150757, -0.021938461810350418, 0.03158216550946236, 0.023462500423192978, 0.03775515779852867, 0.005679922644048929, 0.003541146870702505, -0.031735848635435104, -0.0053853606805205345, 0.004056630190461874, -0.022527584806084633, -0.013408971950411797, -0.003787682391703129, -0.00308169424533844, 0.00390934944152832, -0.00299044419080019, -0.033938661217689514, -0.023603377863764763, 0.024128464981913567, 0.00922747328877449, -0.010975634679198265, -0.0072167678736150265, -0.012403619475662708, 0.059270985424518585, 0.008843261748552322, -0.005321325734257698, -0.014010903425514698, -0.007300013676285744, 0.03967621549963951, -0.008311769925057888, -0.01703336462378502, -0.011078090406954288, 0.0007528138812631369, 0.0036051820497959852, 0.01726389117538929, -0.014126166701316833, 0.0008056429214775562, 0.014766518957912922, -0.0012879080604761839, -0.021016355603933334, 0.045900434255599976, 0.00537255359813571, 0.012704584747552872, 0.022527584806084633, -0.0058656251057982445, -0.007191153708845377, 0.026382505893707275, -0.016854066401720047, 0.005177246406674385, -0.018992843106389046, 0.009714140556752682, -0.011263792403042316, 0.02470478229224682, 0.0025518028996884823, -0.04333902895450592, -0.04848745837807655, -0.0004946719855070114, 0.0031985584646463394, 0.0022140173241496086, -0.015189151279628277, 0.007729049306362867, 0.015650205314159393, 0.010418527759611607, -0.0009845412569120526, 0.015880731865763664, 0.017865821719169617, 0.01885196566581726, -0.03463023900985718, -0.027944963425397873, 0.0028511674609035254, 0.02692040055990219, -0.01620090752840042, 0.0021323724649846554, -0.021771971136331558, -0.004312771372497082, 0.03222251683473587, -0.013152831234037876, 0.006012905854731798, -0.032145675271749496, -0.013754762709140778, 0.040086038410663605, 0.012153882533311844, 0.008619138970971107, -0.029071982949972153, -0.019377052783966064, -0.04023972526192665, 0.017276698723435402, -0.011942566372454166, -0.025255486369132996, 0.0010749910725280643, 0.009073789231479168, 0.0019882931374013424, -0.001400770153850317, -0.023398464545607567, 0.0152916070073843, 0.0021275696344673634, -0.0008444642880931497, 0.02561408281326294, 0.01052738819271326, 0.022015303373336792, 0.044491659849882126, 0.0101239662617445, 0.006249836180359125, 0.01608564332127571, 0.01810915581882, -0.015214765444397926, 0.004565710201859474, 0.014920203015208244, 0.012333180755376816, 0.006172993686050177, -0.0153428353369236, -0.00582720385864377, 0.026946015655994415, -0.02832917496562004, -0.0025117809418588877, 0.01693090796470642, -0.025293907150626183, -0.015278800390660763, -0.00478022824972868, -0.012595725245773792, -0.027074085548520088, 0.03816498443484306, -0.00987422838807106, -0.03240181505680084, 0.0007179947569966316, -0.0007027863757684827, -0.015675818547606468, -0.003762068459764123, 0.0006547599914483726, -0.04026533663272858, -0.01693090796470642, 0.037780772894620895, 0.00011446293501649052, 0.011058880016207695, 0.004636148922145367, -0.018493367359042168, 0.008010804653167725, -0.019492316991090775, -0.0007284004823304713, -0.027432681992650032, 0.0487435981631279, -0.03030145913362503, -0.03222251683473587, 0.031915146857500076, 0.033272694796323776, 0.015675818547606468, 0.004837859887629747, -0.005968081299215555, -0.005026763770729303, -0.011865723878145218, -0.0023564957082271576, -0.023488113656640053, -0.017161434516310692, 0.012422829866409302, 0.024307765066623688, 0.04118744656443596, -0.013767569325864315, 0.02622882090508938, 0.02036319486796856, -0.017520032823085785, 0.006595626473426819, 0.01449757069349289, -0.01498423796147108, -0.007504926063120365, 0.009208262898027897, -0.02036319486796856, 0.011859320104122162, 0.006685275584459305, -0.0035827697720378637, 0.006253038067370653, -0.0005743157817050815, -0.0026990838814526796, 0.011571161448955536, 0.004562508314847946, -0.01421581581234932, 0.01475371140986681, 0.02234828658401966, -0.004831456113606691, 0.012877480126917362, -0.002234828658401966, 0.005945669021457434, -0.0012310768943279982, 0.021310916170477867, 0.00790194422006607, -0.0076714176684618, -0.0017865822883322835, -0.003749261377379298, 0.0445685051381588, -0.0201967041939497, -0.03324707970023155, -0.01018159743398428, 0.013043971732258797, 0.027176542207598686, 0.012345987372100353, 0.00374605949036777, -0.031863920390605927, -0.01122537162154913, -0.02927689626812935, 0.004850666970014572, -0.02003021351993084, 0.031684618443250656, -0.02493530884385109, 0.010309668257832527, -0.020862670615315437, 0.012710988521575928, -0.0024925703182816505, -0.00042223214404657483, 0.041955865919589996, -0.0005138825508765876, 0.018467754125595093, 0.015176343731582165, -0.002819149987772107, 0.03491199389100075, 0.022412322461605072, -0.008132470771670341, 0.04080323502421379, -0.0007195956422947347, 0.02336004376411438, 0.047642193734645844, 0.020862670615315437, 0.02674110233783722, 0.027355840429663658, 0.020798634737730026, -0.013280902057886124, -0.013690726831555367, 0.0019866921938955784, -0.0335032194852829, 0.01908249221742153, 0.0010885985102504492, -0.0005450996686704457, -0.0067941355518996716, -0.009041771292686462, 0.027893735095858574, 0.038062527775764465, -0.008907297626137733, -0.014740904793143272, 0.025998294353485107, -0.01613687165081501, 0.020952319726347923, 0.01591915264725685, 0.03260672837495804, -0.005904045887291431, -0.01221791747957468, 0.010873178020119667, 0.014561605639755726, 0.03358006104826927, -0.012134671211242676, -0.019825300201773643, -0.005683124531060457, -0.007562557701021433, -0.004312771372497082, -0.02369302697479725, -0.03171023353934288, -0.011263792403042316, -0.012922304682433605, 0.009605281054973602, -0.0038805336225777864, 0.029046369716525078, 0.011782477609813213, -0.002803141251206398, -0.044670961797237396, -0.00790194422006607, 0.012858269736170769, 0.01032887864857912, 0.010431335307657719, 0.003304216545075178, -0.00450167478993535, 0.0029488212894648314, 0.019223369657993317, 0.04026533663272858, 0.029020756483078003, -0.03542427718639374, -0.0152916070073843, -0.021707935258746147, 0.007472908589988947, -0.0030977032147347927, -0.04605412110686302, 0.004722596611827612, -0.0020411221776157618, 7.374054257525131e-05, 0.00723597826436162, 0.041725341230630875, 0.012051425874233246, -0.022758113220334053, 0.006986240856349468, 0.0006891789380460978, 0.024166887626051903, -0.02668987400829792, 0.0023180744610726833, -0.01646985486149788, 0.03406672924757004, -0.013998095877468586, -0.03801129758358002, -0.032862868160009384, 0.0023020657245069742, -0.004210314713418484, -0.0027871322818100452, 0.0014079740503802896, 0.013524235226213932, -0.0010365699417889118, 0.0010805941419675946, -0.043928150087594986, 0.017404768615961075, 0.02415408007800579, 0.010898792184889317, 0.03521936386823654, -0.018647052347660065, -0.014113359153270721, 0.010341686196625233, 0.013754762709140778, 0.01563739776611328, 0.004818649496883154, -0.0008252537227235734, 0.03306778147816658, 0.018250033259391785, 0.010738704353570938, -0.023347236216068268, -0.042186394333839417, -0.02922566793859005, -0.0032657955307513475, -0.020849863067269325, -0.02544759027659893, 0.01681564562022686, 0.00195467472076416, -0.0030416722875088453, -0.0346558541059494, 0.008830455131828785, 0.015522134490311146, 0.02617759257555008, -0.007543347310274839, 0.030275845900177956, 0.009694930166006088, 0.0318383052945137, 0.010732300579547882, -0.02420530840754509, -0.0101239662617445, -0.006909398827701807, 0.005094000604003668, 0.00021191651467233896, -0.0037524630315601826, -0.0039381650276482105, -0.03268356993794441, 0.033938661217689514, -0.00708229374140501, -0.002660662867128849, 0.0019146526465192437, -0.022617235779762268, 0.00792755838483572, -0.049998689442873, -0.016264941543340683, 0.008260541595518589, -0.004335183650255203, -0.027944963425397873, 0.023552149534225464, 0.013056778348982334, 0.023846710100769997, 0.018237227573990822, -0.011295810341835022, 0.027048470452427864, 0.007652207277715206, 0.034220416098833084, 0.013396165333688259, -0.036756210029125214, -0.03096742555499077, 0.014792133122682571, -0.03199198842048645, -0.01331932283937931, 0.0072167678736150265, 0.010002299211919308, -0.0403934083878994, -0.0006171392742544413, -0.0006571612902916968, -0.006909398827701807, 0.03199198842048645, 0.02307828888297081, 0.01393406093120575, -0.009855017997324467, 0.0097077377140522, 0.02031196840107441, -0.009951070882380009, 0.011833705939352512, -0.04625903442502022, -0.011443091556429863, -0.010879581794142723, -0.00013767569907940924, 0.04190463945269585, 0.020798634737730026, -0.006653258111327887, -0.013703534379601479, -0.030147776007652283, -0.021003548055887222, -0.0031537339091300964, -0.03188953176140785, 0.0056254928931593895, 0.014587219804525375, 0.026151977479457855, 0.02522987127304077, -0.04333902895450592, -0.03808813914656639, -0.029942862689495087, -0.024563904851675034, 0.00478022824972868, -0.006704485975205898, 0.003960577305406332, -0.020734600722789764, -0.006288257427513599, -0.03452778235077858, 0.009464403614401817, -0.022271445021033287, 0.015650205314159393, 0.05850256606936455, -0.027791280299425125]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
"itions using the approximate attention scores. Use
this total score to interpolate between the attention
output from the top- kpositions, and a mean value
vector, v.
The memory transfer of the SparQ Attention algorithm for
a single attention head forward-pass:
MSparQ =S r|{z}
1⃝+ 2k dh|{z}
2⃝+ 4dh|{z}
3⃝(12)
where 1⃝corresponds to reading rrows of K,2⃝corre-
sponds to reading the top- kcolumns of KandVand 3⃝
corresponds to transfers associated with writing the current
kandv, in addition to reading and writing v.
By varying randk, we can tune the total amount of data
transferred by the scheme, trading-off approximation accu-
racy for token-generation speed-up. Since typically S≫dh,
ris the most important parameter controlling the data trans-
fer compression ratio. Typical ratios are given in Table F2.
Grouped Query Attention For models using GQA,
groups of gqueries access the same KV head. In order
to accommodate this, we modify Step 1 to sum |q|within
each group before selecting top- rcomponents. Similarly,
Step 2 is modified by summing the approximate attention
scores within each group before selecting top- kkeys and
values for each KV head. Note that Step 3 remains the same.
The full code can be found in Appendix B.
5. Experiments
5.1. Setup
Models We evaluate our method on three widely-used
open-source language model variants: Llama 2(Touvron
et al., 2023), Mistral (Jiang et al., 2023) and Pythia (Bider-
man et al., 2023), evaluating model sizes up to 13billionparameters. All models are decoder-only transformers (Rad-
ford et al., 2018), pre-trained on causal language modelling.
They share similar architectural components such as Ro-
tary positional encoding (Su et al., 2021), while also having
some notable differences such as different attention mecha-
nisms (Multi-Head and Grouped-Query), layer normalisa-
tion implementations, activation functions and execution of
modules in parallel.
Tasks In order to evaluate our method on a spectrum of rel-
evant NLP tasks that present a particular challenge to sparse
attention techniques, our evaluation setup consists of various
tasks requiring information retrieval and reasoning over long
input sequences. This includes question answering, sum-
marisation, perplexity/bits-per-character (BPC), and text
repetition. For this, we adapted standard downstream tasks
and datasets to generate examples of sequence lengths be-
tween 1k and 2k tokens.1
For question answering, we use the SQuAD (Rajpurkar
et al., 2016) and TriviaQA (Joshi et al., 2017) datasets in
theopen-book setting. In order to construct the SQuAD ex-
amples, we augment the provided context (i.e. the standard
SQuAD input sequence required to answer the question)
with seven additional “ confusion contexts ” from unrelated
questions. This ensures that the examples have a large se-
quence length, while making the task harder as the model
needs to distinguish the relevant information from the con-
text from the unrelated paragraphs. We use SQuAD v 1.1,
as it does not include unanswerable questions included in
SQuAD v 2.0, since we aim to measure the model’s abil-
ity to extract useful information from the KV cache. For
both question answering tasks we use exact string match
accuracy as the evaluation metric.
Summarisation is evaluated on the CNN/DailyMail dataset
(See et al., 2017) using the ROUGE-L F-score (Lin, 2004)
as the metric. We use the WikiText- 103dataset (Merity
et al., 2016) with bits per character (BPC) for evaluating
language modelling performance.2
Finally, we construct an artificial “Text Repetition” task
to evaluate the capability of the model to repeat sentences
from its context verbatim. Such a task can commonly ap-
pear in a dialogue setting where the LLM agent is required
to retrieve a piece of text from a possibly long context pro-
vided, and can be challenging for sparse attention techniques.
We construct examples using the Tiny-Shakespeare dataset
(Karpathy, 2015) by chunking the text into contexts of the
1As we wanted to define the tasks independently of the se-
lected models, our examples were chosen to have sequence","[0.02321525104343891, 0.05249350145459175, 0.05921266973018646, -0.01005906704813242, -0.014028888195753098, -0.01101051177829504, -0.0029609615448862314, 0.02771656960248947, -0.0246194526553154, 0.023818926885724068, -0.0009539054008200765, -0.03916015475988388, -0.040997426956892014, 0.044698216021060944, 0.00503281457349658, -0.021732309833168983, 0.04627302289009094, -0.03464571014046669, -0.002892063930630684, 0.005980978719890118, -0.01301838830113411, -0.00500984862446785, -0.012185053899884224, 0.014698180370032787, 0.01627298630774021, -0.023084018379449844, -0.0031233634799718857, 0.034225765615701675, 0.04916016384959221, -0.02761158160865307, 0.0484515018761158, -0.03183731064200401, -0.04774283990263939, -0.016233615577220917, 0.013713927939534187, 0.06335965543985367, -0.010839908383786678, 0.026797933503985405, -0.027690323069691658, -0.01397639513015747, 0.013740174472332, -0.04204729571938515, -0.06021004915237427, 0.011003950610756874, -0.014724427834153175, 0.01902889460325241, 0.004504598677158356, 0.007801847066730261, -0.012191615998744965, 0.06015755608677864, -0.03648298606276512, 0.04002629593014717, -0.036587972193956375, 0.004265096969902515, 0.04664047807455063, -0.013398966751992702, -0.00477362796664238, 0.05874022841453552, 0.03624676540493965, -0.02406827174127102, 0.019829420372843742, -0.04128614068031311, 0.01586616039276123, 0.007644366472959518, -0.04388456791639328, 0.00481627881526947, -0.03309715539216995, 0.013661433942615986, -0.015065635554492474, 0.001835632137954235, 0.006023629568517208, 0.07265100628137589, 0.04070871323347092, -0.030997414141893387, 0.016194244846701622, 0.004750662017613649, 0.002465554280206561, 0.039816323667764664, -0.0003586372477002442, -0.0011376326438039541, 0.03385831043124199, -0.035800568759441376, 0.03616802394390106, -0.013608940877020359, -0.03582681715488434, -0.01822836883366108, -0.011981641873717308, -0.01559056993573904, -0.04034125804901123, -0.013766421005129814, -0.03897642716765404, 0.05627303570508957, -0.0029265128541737795, 0.01263124868273735, 0.06750664114952087, 0.012729674577713013, 0.023884544149041176, -0.018097134307026863, 0.02423887513577938, 0.053149670362472534, 0.04110241308808327, 0.02446197159588337, 0.013792667537927628, -0.03086617961525917, 0.05380583927035332, -0.0013500673230737448, -0.010150930844247341, 0.009087937884032726, 0.016482960432767868, -0.008195548318326473, -0.0604725144803524, -0.001830710913054645, -0.04750661924481392, 0.0017913407646119595, 0.017900284379720688, -0.03740162029862404, -0.05448825657367706, -0.03992130979895592, -0.015209992416203022, 0.02675856277346611, -0.015341226011514664, 0.018451467156410217, 0.03370082750916481, -0.004478352144360542, 0.012618125416338444, -0.02335960790514946, 0.05354337394237518, -0.05028877407312393, 0.020406849682331085, -0.008523632772266865, 0.027034154161810875, 0.016837291419506073, 0.04931764677166939, 0.00978347659111023, -0.01330054085701704, -0.01877954974770546, -0.02636486105620861, 0.013110252097249031, -0.03700792044401169, 0.004094493109732866, -0.007946204394102097, 0.005610242951661348, -0.026955414563417435, 0.05115491896867752, -0.04181107506155968, -0.008070875890552998, -0.024343861266970634, 0.01246720738708973, -0.018438342958688736, 0.032467231154441833, -0.01570868119597435, 0.0018963278271257877, -0.06220480054616928, 0.027349114418029785, -0.044330764561891556, -0.03782156854867935, -0.04175858199596405, 0.00568242184817791, 0.020341232419013977, -0.04380582645535469, 0.029737569391727448, -0.021351732313632965, 0.01847771368920803, -0.025052525103092194, -0.017388472333550453, 0.020170629024505615, -0.06398957967758179, 0.022926537320017815, -0.0669817104935646, -0.03254597261548042, -0.030577465891838074, -0.01862207055091858, 0.009514447301626205, -0.024842550978064537, 0.0037106345407664776, -0.026640452444553375, -0.02337273210287094, 0.0033218543976545334, -0.0056758602149784565, -0.04761160537600517, -0.03440948948264122, -0.00436352239921689, -0.004858929663896561, 0.032467231154441833, -0.011154869571328163, -0.05013129487633705, -0.03364833444356918, 0.018293986096978188, -0.02241472527384758, 0.020616823807358742, 0.00840552244335413, 0.015813667327165604, 0.061837345361709595, 0.036640465259552, -0.028084024786949158, -0.05501319095492363, 0.04648299515247345, 0.029265128076076508, -0.015013141557574272, -0.009494761936366558, 0.010032820515334606, 0.038084037601947784, 0.009553817100822926, -0.0505249947309494, 0.05784783884882927, 0.010853031650185585, -0.0017191622173413634, -0.030419984832406044, -0.0434383749961853, -0.03708665817975998, 0.04188981652259827, 0.002619753824546933, 0.07695547491312027, 0.006384522188454866, -0.015419966541230679, 0.026220504194498062, -0.058215294033288956, 0.023385856300592422, 0.01187665481120348, 0.049763839691877365, 0.01425198558717966, 0.018254615366458893, 0.009560379199683666, 0.04430451616644859, -0.049685101956129074, 0.05351712554693222, 0.03551185503602028, -0.009652242995798588, 0.014488207176327705, -0.05202106013894081, 0.019160129129886627, 0.014278233051300049, -0.0025705411098897457, 0.007742791902273893, 0.0015838274266570807, -0.06110243871808052, 0.04582682624459267, -0.02976381592452526, -0.010649619624018669, -0.0345669724047184, 0.015616817399859428, 0.00546260504052043, 0.026076147332787514, 0.018845167011022568, 0.02517063543200493, 0.04301842674612999, -0.02534123882651329, -0.042021047323942184, 0.04524939879775047, 0.022060394287109375, 0.006584653630852699, -0.0222572460770607, -0.03498692065477371, 0.0035794007126241922, -0.05188982933759689, -0.0073950220830738544, -0.0317060761153698, 0.04133863374590874, -0.0314173623919487, 0.028005283325910568, -0.02706040069460869, -0.003999348729848862, -0.011587941087782383, 0.014120751991868019, -0.008720483630895615, 0.005380583927035332, -0.0003309551393613219, 0.005688983481377363, -0.0007111229351721704, -0.04167984053492546, -0.028451478108763695, 0.017650939524173737, 0.027270374819636345, -0.011220485903322697, -0.041233647614717484, -0.028241503983736038, 0.019212622195482254, -0.04965885356068611, -0.02337273210287094, -0.0031840589363127947, 0.029186388477683067, 0.009225733578205109, 0.061837345361709595, 0.026417355984449387, 0.010150930844247341, 0.010052505880594254, 0.01417324598878622, -0.014790044166147709, -0.0016879942268133163, 0.0056791407987475395, 0.02675856277346611, -0.017191622406244278, 0.06839903444051743, -0.0273753609508276, 0.01464568730443716, -0.010675866156816483, 0.005974416621029377, -0.014671933837234974, 0.025000030174851418, -0.004944231826812029, 0.04173233360052109, 0.016207369044423103, 0.02706040069460869, -0.004914704244583845, 0.006542002782225609, 0.014829414896667004, -0.001686353818513453, -0.000832514138892293, -0.010091875679790974, -0.003113520797342062, -0.00018485504551790655, 0.00825460348278284, -0.017545953392982483, 0.04682420566678047, -0.03354334831237793, -0.06141739711165428, 0.03472445160150528, -0.016916031017899513, 0.03632550314068794, -0.029238881543278694, -0.049763839691877365, -0.0724935308098793, 0.011417336761951447, 0.016771674156188965, 0.023175882175564766, -0.043307140469551086, -0.03110240027308464, 0.01160106435418129, -0.021902913227677345, 0.022952783852815628, 0.04094493389129639, 0.0027509876526892185, 0.008477700874209404, 0.0051706102676689625, -0.027086647227406502, 0.0009949159575626254, -0.010098437778651714, 0.020538082346320152, 0.03314964845776558, 0.036824192851781845, -0.09522321075201035, 0.002290029078722, -0.019002648070454597, -0.0033628649543970823, -0.03162733465433121, 0.0489501915872097, 0.005114835686981678, -0.001970146782696247, 0.07107619941234589, -0.02313651144504547, 0.0021784803830087185, 0.002547575393691659, 0.024803180247545242, -0.037139154970645905, 0.029422609135508537, -0.01425198558717966, -0.020380603149533272, -0.004025595728307962, -0.003782812971621752, -0.010078752413392067, -0.012132560834288597, 0.014816291630268097, 0.014658810570836067, -0.010866154916584492, 0.044461995363235474, -0.006368117872625589, -0.013845161534845829, 0.003500660415738821, 0.003357943845912814, -0.01298558060079813, 0.018110258504748344, 0.03892393410205841, -0.015485583804547787, -0.023097140714526176, -0.04249349236488342, -0.02185042016208172, -0.027165386825799942, 0.04650924354791641, -0.01918637566268444, 0.015209992416203022, 0.008576125837862492, 0.005387145560234785, -0.050708722323179245, -0.04887145012617111, 0.04511816427111626, 0.004484913777559996, 0.008339905180037022, -0.0009416022221557796, -0.07380586862564087, -0.01682416722178459, -0.02700790762901306, 0.005738195963203907, -0.018202122300863266, 0.014475082978606224, 0.02628612145781517, 0.045511867851018906, -0.0064173308201134205, 0.0473753847181797, 0.04454073682427406, 0.04506567120552063, 0.029737569391727448, -0.0016289390623569489, -0.01673230342566967, -0.006397645454853773, 0.014750674366950989, 0.02203414775431156, -0.01687666028738022, 0.031679827719926834, 0.00524606928229332, -0.0011245092609897256, 0.05485571175813675, -0.01388453133404255, 0.027664076536893845, 0.007650928106158972, -0.0006327927694655955, -0.029737569391727448, 0.002478677546605468, 0.024028901010751724, 0.03207353129982948, 0.04711291939020157, -0.038320258259773254, -0.049685101956129074, -0.023254621773958206, -0.00868111290037632, -0.044488243758678436, 0.005875991657376289, 0.017007894814014435, -0.0565355010330677, 0.022677192464470863, -0.03514439985156059, -0.044488243758678436, 0.0250131543725729, 0.03719164803624153, -0.03322838619351387, -0.015918655321002007, -0.003825464053079486, 0.034855686128139496, 0.049606360495090485, -0.024212628602981567, -0.05139113962650299, 0.002130908193066716, -0.05690295621752739, -0.025629952549934387, -0.008956704288721085, -0.04393706098198891, 0.019448842853307724, 0.0019225745927542448, -0.009022320620715618, 0.02761158160865307, -0.030918672680854797, -0.01026248000562191, -0.025131264701485634, 0.06650926917791367, 0.03354334831237793, -0.005567592103034258, -0.048031553626060486, 0.1112862229347229, -0.022388478741049767, 0.040367502719163895, -0.05312342569231987, 0.050315022468566895, 0.004160109907388687, -0.02305777184665203, -0.002531171077862382, 1.0335939805372618e-05, 0.010354343801736832, 0.040524985641241074, 0.012605002149939537, 0.0416535958647728, 0.004242131020873785, 0.022401602938771248, -0.015026264823973179, -0.00013923081860411912, -0.05532815307378769, -0.028320245444774628, -0.010721798054873943, 0.019947530701756477, -0.010682428255677223, -0.01640421897172928, -0.040839944034814835, 0.01140421349555254, -0.03921264782547951, 0.03078744001686573, 0.055748101323843, 0.002593507058918476, 0.047716595232486725, 0.050078801810741425, -0.008005259558558464, 0.0508137121796608, 0.01208006776869297, -0.017230993136763573, -0.014527576975524426, 0.000863682187628001, -0.014055135659873486, 0.026456724852323532, -0.019763803109526634, 0.00797245092689991, -0.0021489528007805347, -0.02219162881374359, -0.03188980370759964, 0.007696860004216433, -0.005364179611206055, 0.039186399430036545, 0.01326773315668106, -0.021640446037054062, 0.009028882719576359, 0.028530219569802284, 0.023792680352926254, -0.0011277900775894523, 0.04299217835068703, 0.02485567331314087, -0.01706038787961006, 0.03538062050938606, 0.0421522818505764, 0.01673230342566967, 0.021653570234775543, -0.009409460239112377, 0.012709989212453365, -0.0023490842431783676, 0.02471131645143032, -0.012657496146857738, -0.0132218012586236, -0.023084018379449844, 0.015721803531050682, -0.006443577352911234, -0.03648298606276512, -0.034776944667100906, -0.12986892461776733, -0.015301856212317944, -0.055853087455034256, -0.003249675966799259, 0.012178492732346058, -0.002124346559867263, 0.0020292019471526146, -0.047401633113622665, -0.0009973765118047595, -5.500539919012226e-05, -0.026627330109477043, -0.0385039858520031, 0.0026476411148905754, 0.0013344832696020603, 0.011345158331096172, -0.0006635506870225072, 0.001768374931998551, 0.010721798054873943, -0.013077443465590477, 0.042336009442806244, -0.023110264912247658, -0.025393731892108917, 0.022007901221513748, -0.0024606329388916492, -0.04299217835068703, 0.0023244780022650957, -0.01121392473578453, -0.02779530920088291, 0.005620085634291172, -0.014619440771639347, 0.004996725358068943, -0.027034154161810875, -0.027270374819636345, 0.018202122300863266, 0.004294624552130699, -0.0342782586812973, -0.015958024188876152, -0.026154886931180954, -0.006797908805310726, 0.01364831067621708, -0.0264436025172472, 0.006935704033821821, 0.009612872265279293, -0.026614205911755562, -0.030997414141893387, 0.00843833014369011, -0.054908204823732376, 0.012408151291310787, -0.014107628725469112, -0.02028873935341835, 0.0246194526553154, -0.0176771879196167, 0.03679794445633888, -0.0437270887196064, -0.007867463864386082, -0.012230985797941685, 0.007847778499126434, -0.04902893304824829, 0.007401583716273308, -0.010892401449382305, 0.01484253816306591, -0.023792680352926254, 0.03047247789800167, 0.05194232240319252, -0.015000018291175365, 0.018818920478224754, 0.0033694268204271793, -0.025472471490502357, 0.0033087311312556267, 0.017165375873446465, -0.0369291789829731, -0.05249350145459175, 0.018372725695371628, 0.015971148386597633, 0.024015776813030243, -0.016246739774942398, -0.001559221069328487, -0.015748050063848495, 0.030367491766810417, -0.027322867885231972, 0.006797908805310726, 0.029475102201104164, -0.009986888617277145, 0.014317602850496769, -0.009625996463000774, -0.028162764385342598, -0.008779538795351982, -0.02549871988594532, 0.005403549876064062, -0.030577465891838074, -0.023556459695100784, 0.0015124690253287554, -0.007709983270615339, -0.011338596232235432, -0.031233634799718857, 0.0020341232884675264, 0.023503966629505157, 0.013202115893363953, 0.0043208715505898, 0.004924546927213669, -0.034383244812488556, -0.011765106581151485, 0.018976401537656784, -0.05795282870531082, -0.004025595728307962, 0.01641734316945076, -0.013090567663311958, -0.036273010075092316, 0.02313651144504547, 0.007690298371016979, 0.020000023767352104, 0.031312376260757446, 0.009087937884032726, 0.016863537952303886, 0.024816302582621574, -0.011482954025268555, -0.0172834862023592, 0.0413648821413517, -0.007696860004216433, -0.013713927939534187, -0.012086628936231136, -0.007460638880729675, -0.020721809938549995, -0.037427868694067, -0.035406868904829025, 0.04986882954835892, 0.019448842853307724, 0.0405774787068367, -0.013339911587536335, -0.0547507219016552, -0.0045341262593865395, 0.011043320409953594, 0.02036747895181179, -0.07002633064985275, -0.007749353535473347, 0.0013656512601301074, -0.030813686549663544, 0.007860901765525341, 0.009921272285282612, 0.030813686549663544, 0.012611564248800278, 0.0008001158130355179, 0.0023507247678935528, -0.009409460239112377, -0.011122060939669609, 0.022847797721624374, 0.01555120013654232, 0.009658804163336754, -0.009206048212945461, -0.0005606142221949995, -0.04942263290286064, -0.00825460348278284, 0.026719193905591965, -0.03312340006232262, 0.013274294324219227, -0.06115493178367615, -0.026168011128902435, 0.00825460348278284, -0.010085314512252808, 0.019396349787712097, 0.0017076792428269982, 0.0317060761153698, 0.008818908594548702, 0.007257226854562759, -0.010511823929846287, 0.03146985545754433, -0.02866145223379135, 0.008477700874209404, 0.00342520116828382, -0.01641734316945076, 0.052519749850034714, -0.024724440649151802, -0.034147024154663086, -0.03162733465433121, -0.005364179611206055, -0.010190301574766636, -0.003382550086826086, -0.013090567663311958, -0.03136486932635307, 0.0017765769734978676, 0.02274280972778797, 0.03538062050938606, -0.025210004299879074, -0.014632564038038254, 0.02603677660226822, -0.0019225745927542448, 0.0021932441741228104, -0.01879267394542694, 0.019855666905641556, -0.010118123143911362, 0.004826121497899294, -0.01608925871551037, -0.016692934557795525, -0.0314173623919487, 0.019199497997760773, -0.01254594698548317, -0.006975074298679829, 0.003438324434682727, -0.027979036793112755, 0.0015428168699145317, 2.3081249310052954e-05, 0.030183764174580574, 0.02706040069460869, 0.0298425555229187, 0.03309715539216995, -0.010013136081397533, -0.04349086806178093, -0.01988191343843937, -0.018845167011022568, -0.05737539753317833, 0.006118773948401213, -0.018727056682109833, -0.020341232419013977, 0.02320212870836258, -0.03459321707487106, 0.001556760398671031, 0.05202106013894081, -0.006692921742796898, 0.01885829120874405, 0.026574835181236267, 0.022677192464470863, -0.02108926512300968, -0.011181116104125977, -0.03412077575922012, 0.011587941087782383, 0.008503947407007217, 0.00682415533810854, -0.005626647267490625, -0.034698206931352615, 0.011148307472467422, -0.0024327458813786507, -0.010603687725961208, 0.01745408959686756, 0.005216541700065136, -0.024291368201375008, -0.02068244107067585, 0.023503966629505157, -0.008608934469521046, -0.015328102745115757, 0.026981661096215248, -0.011850408278405666, 0.01666668802499771, 0.017585324123501778, -0.0048195598646998405, -0.015236238949000835, 0.010485577397048473, 0.042834699153900146, 0.05265098437666893, -0.028320245444774628, 0.0302362572401762, 0.020708687603473663, 0.020144382491707802, 0.02858271263539791, 0.013897654600441456, -0.02272968739271164, -0.0068044704385101795, -0.02795279026031494, 0.004524283576756716, -0.020774303004145622, -0.05186358094215393, 0.002252299338579178, -0.03039373829960823, -0.019829420372843742, 0.00708662299439311, -0.016456713899970055, -0.006715887691825628, -0.01909451186656952, 0.03695542737841606, 0.003303809789940715, -0.02074805647134781, -0.10194238275289536, -0.03566933423280716, 0.035406868904829025, -0.01706038787961006, 0.03162733465433121, -0.011312349699437618, -3.506401844788343e-05, -0.0056627364829182625, 0.02587929740548134, 0.009678489528596401, 0.0075262561440467834, -0.034383244812488556, -0.005807093810290098, 0.0011942271376028657, 0.00594160845503211, -0.06367462128400803, -0.02866145223379135, 0.003129925113171339, 0.036981672048568726, -0.03055121935904026, -0.007998697459697723, 0.013713927939534187, 0.002598428400233388, 0.0040485612116754055, -0.014081382192671299, -0.005137801636010408, -0.005475728306919336, 0.00033628649543970823, 0.005603681318461895, 0.02391079068183899, -0.020301861688494682, -0.016115505248308182, 0.014002641662955284, 0.04569559544324875, -0.03971133381128311, 0.008897649124264717, -0.0225065890699625, 0.029265128076076508, 0.009212609380483627, -0.020616823807358742, 0.0037106345407664776, -0.02249346673488617, 0.0334908552467823, -0.006797908805310726, 0.030026283115148544, -0.015879284590482712, 0.02937011420726776, 0.00907481461763382, 0.015157499350607395, 0.0022309739142656326, -0.01401576492935419, 0.0032562375999987125, 0.023018401116132736, 0.03892393410205841, 0.0013754938263446093, 0.010479015298187733, -0.0059153614565730095, -0.023149635642766953, 0.017099758610129356, -0.008648304268717766, -0.012992141768336296, 0.012677180580794811, 0.043753333389759064, -0.0155118303373456, -0.04359585419297218, -0.01745408959686756, -0.0007074319873936474, 0.01203413587063551, 0.020013147965073586, -0.012296603061258793, -0.0033481011632829905, 0.006863525602966547, -0.00365157937631011, -0.002954399911686778, -0.0012376983650028706, -0.002062010345980525, 0.02803152985870838, 0.03577432408928871, -0.03160108998417854, -0.005643051583319902, 0.01610238291323185, -0.05532815307378769, -0.013123375363647938, -0.014422589913010597, 0.0026377984322607517, 0.022624699398875237, 0.02921263501048088, -0.03396329656243324, -0.016154875978827477, 0.039737582206726074, 0.04070871323347092, -0.014986895024776459, 0.04031500965356827, -0.012276917695999146, -0.006230322644114494, -0.004507879726588726, 0.021049894392490387, 0.0056627364829182625, 0.04272971302270889, 0.010000011883676052, 0.02296590805053711, 0.01460631750524044, -0.00217027822509408, -0.030892426148056984, 0.022440971806645393, 0.01330054085701704, 0.005160767585039139, -0.0021227060351520777, 0.014120751991868019, -0.048582736402750015, 0.006916019134223461, 0.022992154583334923, 0.009461954236030579, 0.0034973795991390944, 0.015826791524887085, 0.03608928248286247, 0.05097119137644768, 0.01594490185379982, 0.03829400986433029, 0.002788717392832041, 0.001265585538931191, 0.04774283990263939, -0.02755908854305744, 0.014986895024776459, -0.004858929663896561, -0.03805778920650482, 0.005925204139202833, 0.01097770407795906, 0.006026910152286291, 0.009048567153513432, 0.026023654267191887, 0.03480319306254387, -0.004189637489616871, -0.003428481984883547, -0.0033448203466832638, 0.01377954427152872, 0.012618125416338444, 0.01933073252439499, -0.03955385461449623, 0.018818920478224754, -0.017086634412407875, 0.023097140714526176, 0.05958012491464615, 0.007532817777246237, 0.004822840448468924, 0.000760335591621697, 0.02968507632613182, -0.037060413509607315, -0.02677168697118759, 0.00029363553039729595, 0.0043175905011594296, -0.009921272285282612, 0.0168897844851017, 0.01948821358382702, 0.004274939652532339, 0.01846458949148655, -0.02400265447795391, -0.029973790049552917, 0.011889778077602386, 0.02124674618244171, -0.012775606475770473, -0.01297901850193739, 0.013923902064561844, 0.009540693834424019, 0.035328127443790436, -0.011870093643665314, -0.0105380704626441, -0.007828094065189362, -0.008320219814777374, 0.0345669724047184, -0.011056443676352501, -0.0057775662280619144, 0.06561687588691711, 0.03963259607553482, 0.018372725695371628, 0.005853025708347559, 0.008471138775348663, -0.038871437311172485, 0.008398960344493389, 0.02178480289876461, -0.004829402081668377, 0.01026248000562191, -0.016837291419506073, 0.010321535170078278, 0.05511817708611488, -0.0020800549536943436, 0.011272979900240898, 0.004215884488075972, 0.011122060939669609, 0.020734934136271477, 0.03309715539216995, 0.015905531123280525, -0.0268373042345047, 0.010748044587671757, 0.004517721943557262, -0.031049907207489014, 0.0332808792591095, 0.013333349488675594, -0.020656192675232887, -0.018674563616514206, -0.026141764596104622, 0.04514441266655922, 0.00237697153352201, 0.0027919982094317675, -0.029238881543278694, 0.01807088777422905, -0.013608940877020359, -0.01751970686018467, -0.005954731721431017, 0.004255254752933979, -0.03700792044401169, -0.006624023895710707, -0.03519689291715622, 0.015446213074028492, 0.011417336761951447, -0.009304473176598549, -0.006870087236166, 0.008694236166775227, -0.049212660640478134, -0.029081400483846664, -0.04601055383682251, -0.012217862531542778, -0.049370139837265015, -0.024330738931894302, 0.003438324434682727, 0.030734945088624954, 0.022375356405973434, -0.014763797633349895, 0.008622057735919952, 0.014580070041120052, 0.00919948611408472, 0.0012500014854595065, -0.01633860357105732, 0.013753297738730907, -0.002066931687295437, -0.013871408067643642, -0.0014156841207295656, -0.021443596109747887, 0.013398966751992702, 0.020564328879117966, 0.03157484158873558, -0.003923889249563217, 0.004353679716587067, 0.0022080079652369022, 0.006837278604507446, -0.0011269699316471815, -0.001034286106005311, 0.03971133381128311, 0.009521009400486946, -0.0016724101733416319, -0.0024704753886908293, -0.0066109006293118, 0.020695563405752182, -0.021259868517518044, 0.025839926674962044, -0.006935704033821821, 0.010341220535337925, 0.036902934312820435, 0.03790031000971794, 0.01989503763616085, -0.0066535514779388905, 0.023425225168466568, -0.021574828773736954, -0.02929137460887432, 0.01687666028738022, -0.03514439985156059, -0.016286108642816544, -0.024356985464692116, -0.005321528762578964, 0.01167980395257473, -0.03669295832514763, 0.011633872985839844, 0.013188992626965046, 0.006492790300399065, 0.0057972511276602745, 0.01578742079436779, 0.0015575806610286236, -0.0011540368432179093, 0.022952783852815628, -0.002222771756350994, -0.015249362215399742, -0.009665366262197495, 0.004330713767558336, -0.028057776391506195, 0.006171267479658127, -0.009251980111002922, -0.03637799620628357, -0.0017093196511268616, 0.020419972017407417, -0.0277690626680851, 0.012276917695999146, 0.04133863374590874, 0.010918648913502693, -0.03459321707487106, -0.006916019134223461, 0.004616147372871637, -0.004465228412300348, 0.004730977118015289, 0.030971167609095573, -0.047795332968235016, 0.027664076536893845, -0.010354343801736832, 0.0385039858520031, 0.00615486316382885, 0.038713958114385605, 0.0074081458151340485, -0.003963259514421225, -0.06173235923051834, 0.0055413455702364445, 0.005482290405780077, -0.006981635931879282, 0.017664063721895218, 0.01160106435418129, 0.01120736263692379, -0.00825460348278284, -0.0032677205745130777, 0.018215244635939598, -0.02635173872113228, -0.012972457334399223, -0.020472466945648193, -0.003047903999686241, 0.021745434030890465, -0.010485577397048473, 0.007946204394102097, -0.0034842563327401876, -0.02027561515569687, 0.013766421005129814, -0.01879267394542694, 0.001616635825484991, 0.008930456824600697, 0.015774298459291458, 0.028687698766589165, 0.0031676548533141613, 0.03797904774546623, -0.028057776391506195, -0.016771674156188965, -0.02447509579360485, -0.014776920899748802, 0.003310371423140168, -0.01846458949148655, 0.022244121879339218, -0.003956697881221771, -0.008280850015580654, -0.02011813409626484, -0.002130908193066716, 0.035249385982751846, 0.014776920899748802, -0.002124346559867263, -0.006492790300399065, 0.0009899946162477136, 0.05391082912683487, -0.0016084337839856744, -0.046141788363456726, -0.0010449488181620836, 0.00026000686921179295, 0.03433075174689293, -0.018530206754803658, -0.02541997842490673, -0.03228350356221199, -0.004327433183789253, -0.0034022352192550898, 0.021968530490994453, -0.019147004932165146, 0.014750674366950989, 0.013477707281708717, -0.025590581819415092, -0.0016404219204559922, 0.009895025752484798, 0.0056955451145768166, -0.012217862531542778, 0.01092521008104086, 0.030131271108984947, -0.0010752965463325381, 0.0006036752602085471, -0.018372725695371628, 0.0017158814007416368, -0.007611557841300964, 0.01640421897172928, 0.037139154970645905, 0.027664076536893845, 0.022467218339443207, -0.036745451390743256, -0.04267721623182297, -0.005357617978006601, -0.010472454130649567, 0.02217850461602211, -0.01570868119597435, 0.020065641030669212, -0.009258541278541088, -0.007198171690106392, 0.009317596442997456, 0.03708665817975998, 0.006250007543712854, 0.006443577352911234, -0.01854332908987999, -0.01704726554453373, 0.0006487868959084153, 0.03325463458895683, -0.010531509295105934, 0.022690316662192345, -0.021732309833168983, 0.02258533053100109, 0.02044621855020523, -0.023241497576236725, 0.025196881964802742, -0.039737582206726074, -0.017808420583605766, 0.042572230100631714, 0.022139135748147964, -0.002990489359945059, -0.03186355531215668, -0.021207375451922417, -0.014776920899748802, -0.007946204394102097, -0.025603706017136574, -0.04065621644258499, -0.004356960766017437, -0.00615814421325922, 0.002175199566408992, 0.014028888195753098, -0.033595841377973557, -0.0017076792428269982, 0.004589900840073824, -0.00018536768038757145, 0.03897642716765404, 0.01696852408349514, 0.03522314131259918, 0.023110264912247658, 0.0329921655356884, 0.027847804129123688, 0.005446200724691153, -0.006988197565078735, -0.026876673102378845, -0.01211287546902895, 0.012296603061258793, -0.006456701084971428, 0.016522329300642014, -0.011522323824465275, -0.024527588859200478, 0.05018378794193268, -0.02713914029300213, -0.002258860971778631, 0.045433126389980316, 0.002020999789237976, 0.0001454849261790514, 0.0038385873194783926, -0.03325463458895683, -0.009704736061394215, 0.03393704816699028, -0.03616802394390106, -0.012926525436341763, -0.009225733578205109, -0.02834649197757244, 0.006509194150567055, -0.029160140082240105, 0.021929161623120308, -0.06068249046802521, -0.010951456613838673, 0.04055123031139374, 0.02359583042562008, -0.00015973608242347836, -0.011620748788118362, -0.018897661939263344, 0.0030036126263439655, -0.007598434574902058, 0.019908161833882332, -0.01049213856458664, 0.030105024576187134, -0.02068244107067585, -0.030971167609095573, 0.012224424630403519, 0.0041633909568190575, 0.0015305137494578958, -0.004852368030697107, -0.01641734316945076, 0.007014444097876549, -0.004235569387674332, -0.014146999455988407, -0.00820210948586464, -0.013202115893363953, -0.010164054110646248, 0.011456706561148167, 0.00974410679191351, 0.006440296769142151, 0.022598452866077423, 0.038162775337696075, -0.016364850103855133, 0.006702763959765434, -0.0034842563327401876, -0.014291356317698956, -0.0027296622283756733, 0.024107640609145164, -0.02335960790514946, 0.021574828773736954, -0.00010744763858383521, -0.019435718655586243, 0.019317608326673508, 0.014501330442726612, -0.001405021408572793, -0.004993444308638573, 0.02597116120159626, -0.008307096548378468, 0.02296590805053711, 0.024501342326402664, 0.010951456613838673, 0.015301856212317944, -0.0054068309254944324, 0.005180452484637499, 0.004524283576756716, 0.02771656960248947, -0.01690290868282318, -0.004829402081668377, -0.015249362215399742, 0.009993450716137886, 0.05028877407312393, -0.0065387217327952385, -0.009580064564943314, 0.002465554280206561, 0.0002956860698759556, 0.01101707387715578, 0.022874044254422188, -0.01640421897172928, -0.03275594487786293, -0.011312349699437618, -0.03341211378574371, -0.005895676556974649, -0.025131264701485634, 0.034461986273527145, 0.0034612903837114573, -0.004983602091670036, -0.010341220535337925, 0.0034678520169109106, 0.007132554892450571, -0.018372725695371628, -0.0062828161753714085, 0.0018700810614973307, -0.005216541700065136, 0.011706051416695118, -0.02518375776708126, 0.014304479584097862, 0.0011564975138753653, -0.031916048377752304, 0.0310236606746912, 0.003366145770996809, 0.013753297738730907, 0.06015755608677864, 0.03000003658235073, 0.008234918117523193, 0.03755909949541092, 0.03443573787808418, -0.021364856511354446, -0.019763803109526634, 0.004639113321900368, -0.029186388477683067, -0.009278226643800735, 0.023897666484117508, -0.01972443424165249, -0.0037631280720233917, -0.02059057727456093, 0.003789374837651849, 0.032965920865535736, -0.015144375152885914, -0.008648304268717766, 0.022939661517739296, -0.004698168486356735, 0.002882221480831504, 0.014304479584097862, 0.023189004510641098, -0.02076118066906929, -0.0026410792488604784, 0.007198171690106392, 0.004261816386133432, 0.025144387036561966, -0.017952777445316315, -0.024816302582621574, 0.0011655198177322745, 0.008228356949985027, 0.0011532166972756386, -0.025472471490502357, 0.011496077291667461, 0.00522966543212533, -0.0314173623919487, -0.0023376012686640024, 0.0004074398020748049, 0.011542009189724922, 0.006961951032280922, 0.0011614187387749553, -0.014133875258266926, 0.020498713478446007, 0.004881895612925291, 0.013477707281708717, 0.028635205700993538, -0.004350399132817984, 0.006207356695085764, -0.012644372880458832, 0.029160140082240105, 0.015813667327165604, 0.03136486932635307, -0.03498692065477371, -0.010754606686532497, -0.0016387815121561289, 0.00781496986746788, -0.019356979057192802, -0.047952815890312195, 0.010249356739223003, -0.04301842674612999, -0.017650939524173737, -0.009324158541858196, 0.037217892706394196, -0.001265585538931191, -0.028530219569802284, -0.006053157150745392, -0.02297903038561344, 0.01656170003116131, -0.009068252518773079, 0.01632547937333584, -0.03139111399650574, 0.01640421897172928, -0.009757230058312416, -0.03921264782547951, -0.016850413754582405, -0.006663394160568714, -0.02019687555730343, -0.00907481461763382, -0.014291356317698956, 0.013241485692560673, 0.03031499870121479, 0.03412077575922012, -0.022296614944934845, 0.008280850015580654, 0.018018394708633423, -0.013858284801244736, -0.00037914252607151866, -0.015433089807629585, 0.023162757977843285, 0.01674542762339115, -0.012368781492114067, 0.001979989232495427, 0.028950165957212448, -0.001523131737485528, 0.0071784863248467445, 0.02219162881374359, -0.0024475096724927425, -0.025433102622628212, -0.029790062457323074, 0.000760335591621697, -0.016010519117116928, -0.018346479162573814, -0.02818901091814041, 0.00685040233656764, -0.01681104488670826, -0.014488207176327705, 0.02416013553738594, -0.012014450505375862, 0.01625986211001873, 0.018425218760967255, -0.0037729705218225718, 0.035328127443790436, 0.00318569946102798, 0.032231010496616364, -0.009416022337973118, -0.008740168064832687, -0.006364837288856506, 0.0222572460770607, 0.02178480289876461, 0.004445543512701988, -0.00868767499923706, -0.006594496313482523, -0.04482945054769516, 0.03375332057476044, -0.024055147543549538, 0.029265128076076508, 0.012867470271885395, -0.015105005353689194, 0.03986881673336029, -0.01917325146496296, -0.0029560404364019632, 0.0029773658607155085, 0.008280850015580654, -0.020406849682331085, 0.02098427712917328, 0.026955414563417435, 0.020721809938549995, 0.0015485583571717143, -0.009803161956369877, -0.0008050370961427689, 0.01603676564991474, 0.03608928248286247, 0.017480336129665375, -0.017782174050807953, -0.02858271263539791, -0.008070875890552998, -0.031128646805882454, -0.006692921742796898, 0.015839913859963417, -0.009265103377401829, -0.02479005604982376, 0.0028395703993737698, -0.019435718655586243, -0.010472454130649567, 0.02423887513577938, 0.023175882175564766, 0.029790062457323074, -0.00013164385745767504, 0.014711304567754269, 0.0260499007999897, 0.007139116525650024, -0.0025705411098897457, -0.02763783000409603, -0.0012229345738887787, -0.006496070884168148, 0.0014042011462152004, -0.000723015982657671, -0.005075465422123671, 0.004901580978184938, -0.007500009145587683, -0.0020456062629818916, -0.023175882175564766, -0.020328108221292496, -0.03039373829960823, -0.009770353324711323, 0.017729680985212326, 0.02408139407634735, 0.02589241974055767, -0.036115530878305435, -0.023884544149041176, -0.015813667327165604, -0.03553809970617294, 0.02612864039838314, -0.031522348523139954, 0.02606302499771118, -0.02937011420726776, -0.005803812760859728, -0.03356959670782089, -0.012696865946054459, 0.003087274031713605, -0.018818920478224754, 0.05611555278301239, -0.032231010496616364]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
" lengths
between 4000 and8000 characters, roughly giving the desired
lengths in tokens.
2We quote performance for sub-word language modelling in
BPC, to account for any differences in vocabulary across models.
5
SparQ Attention: Bandwidth-Efficient LLM Inference
Table 2: Results for the largest models tested are presented below. SQuAD and TriviaQA measure performance in accuracy.
CNN/DailyMail uses ROUGE-L score. Repetition counts the number of characters before the generation diverges and
WikiText task measures perplexity in bits per character (BPC). Values in bold represent the best score for a model, task
and sparsity setting. Median standard errors across all models and sparsity settings are: SQuAD 0.7, TriviaQA 0.7,
CNN/DailyMail 0.4, WikiText 0.006, Repetition 2.
Dataset Name SQuAD ↑ TriviaQA ↑ CNN/DailyMail ↑ WikiText ↓ Repetition ↑
Compression 1 1/2 1/8 1 1/2 1/8 1 1/2 1/8 1 1/2 1/8 1 1/21/8
Llama 2
13BLM-∞
80.850.0 32.4
78.773.4 69.0
22.116.8 15.1
0.610.64 0.69
22976 29
H2O 73.2 64.1 78.578.4 22.2 20.8 0.610.63 61 26
SparQ 80.778.0 78.878.2 22.522.2 0.61 0.64 227 190
Mistral
7BLM-∞
81.051.0 31.6
80.975.8 72.8
23.718.0 16.8
0.620.65 0.70
23181 20
H2O 71.2 59.2 80.880.6 23.523.4 0.630.65 38 14
SparQ 80.977.5 80.879.0 23.523.0 0.630.65 209 201
Pythia
6.9BLM-∞
57.838.5 18.9
52.641.6 32.0
20.214.9 14.1
0.680.71 0.77
15064 18
H2O 52.9 46.6 52.652.3 20.3 18.9 0.69 0.71 47 19
SparQ 58.057.1 52.4 51.7 20.620.6 0.680.70 151 144
appropriate size, appending them with the prompts con-
taining a subset of the context, and evaluating the output
exact character length match with the continuation from the
context.
Baselines We consider the cache eviction technique H 2O
(Zhang et al., 2023) and LM-Infinite, a local windowing
scheme with initial-tokens included proposed by Han et al.
(2023) as baselines. For consistency, we allocate a fixed KV
cache transfer budget kfor both techniques. With H 2O, we
set the local window size l=k/4(with 3k/4heavy hitters),
and for LM-Infinite we always include the first 16positions
(with k−16local positions).
5.2. Results
Our experiments span six distinct models: Llama 2with7
and13billion parameters, Mistral with 7billion parame-
ters, and three Pythia models with 1.4,2.8and6.9billion
parameters. Results from the largest models are presented
in Table 2, with further results in Figures A1 and A2. We
observe that:
•SparQ Attention performance is robust across all tasks
and model sizes tested. Compression ratios of 2×to
8×are readily achievable with little to no loss in task
performance.
•Certain tasks are more challenging for H 2O (Repeti-
tion, SQuAD), while others are more forgiving (Trivi-
aQA, WikiText- 103).
•LM-Infinite degrades performance across all tasks,
demonstrating that the tasks do not permit the trivial
solution of discarding the long input","[0.04072946310043335, 0.03757602348923683, 0.09383691102266312, -0.005150125827640295, -0.006332665216177702, 0.009077188558876514, -0.006104262080043554, 0.003179226303473115, -0.023031892254948616, 0.05466943234205246, 0.01377787534147501, -0.010948621667921543, -0.06519071757793427, 0.029721898958086967, 0.029736634343862534, -0.0005834414623677731, 0.02250140719115734, -0.018493298441171646, -0.02997240424156189, 0.04176096245646477, 0.005570093169808388, -0.013284229673445225, -0.05390317365527153, 0.01862591877579689, 0.02133728750050068, -0.008907727897167206, -0.025124361738562584, 0.03221223130822182, 0.065131776034832, -0.04632902890443802, 0.0411420613527298, -0.03209434449672699, -0.015081984922289848, -0.045179642736911774, 0.005253275390714407, 0.06359926611185074, 0.005275378935039043, 0.01522197388112545, 0.003326583420857787, -0.010278147645294666, -0.02913247048854828, -0.04358818754553795, -0.07874755561351776, -0.03056183271110058, 0.017992284148931503, 0.040375806391239166, -0.001818016404286027, 0.014662017114460468, 0.005864806938916445, 0.051574934273958206, -0.048981454223394394, 0.08092843741178513, -0.040051620453596115, -0.02345922775566578, 0.018169112503528595, -0.014905156567692757, -0.012893733568489552, 0.017874399200081825, 0.0041259946301579475, -0.049747709184885025, 0.012599020265042782, -0.0219561867415905, 0.016076644882559776, -0.03271324560046196, -0.010491815395653248, -0.002097994787618518, -0.009320328012108803, 0.001118070911616087, -0.0012792425695806742, 0.014743063598871231, -0.004453863948583603, 0.03121020272374153, 0.03312584385275841, -0.01865539140999317, 0.018286999315023422, -0.01414626743644476, 0.0021956185810267925, 0.01847856305539608, -0.006586856208741665, -0.0254632830619812, 0.004914354532957077, -0.0034628885332494974, 0.026214802637696266, -0.04190832003951073, -0.004394921474158764, -0.007338376250118017, 0.002247193595394492, 0.03666241094470024, -0.03669188171625137, -0.012923205271363258, -0.043823957443237305, 0.0009067057981155813, -0.011258071288466454, -0.0025879566092044115, 0.03209434449672699, -0.030797604471445084, 0.03271324560046196, -0.0241223331540823, 0.0010001853806897998, 0.06713583320379257, 0.007511520758271217, 0.022855063900351524, 0.010698115453124046, -0.006542649120092392, 0.026804231107234955, -0.00881931371986866, -0.029500862583518028, -0.016297679394483566, -0.0240781269967556, -0.017255499958992004, -0.06377609074115753, 0.02356237731873989, -0.0659569725394249, 0.008399346843361855, 0.031416501849889755, -0.045975372195243835, -0.056231413036584854, -0.016341887414455414, 0.008097264915704727, 0.0241223331540823, 0.005647455342113972, 0.04193779081106186, 0.00878247432410717, -0.05343163385987282, 0.02795361541211605, -0.03286060318350792, 0.02785046584904194, -0.03981585055589676, 0.022810857743024826, -0.024755969643592834, 0.01306319423019886, 0.013527369126677513, 0.04090629145503044, -0.0016098747728392482, -0.026686344295740128, -0.017226029187440872, -0.027128415182232857, 0.011714878492057323, -0.03406892716884613, -0.003864436177536845, -0.002785046584904194, -0.00311107374727726, -0.003974954131990671, 0.03041447512805462, -0.03878435119986534, 0.017903869971632957, -0.009231913834810257, 0.018419619649648666, -0.04240933060646057, -0.01401364617049694, -0.01951006054878235, -0.03424575552344322, -0.0488046258687973, 0.013018987141549587, -0.03168174624443054, -0.030797604471445084, -0.0057027144357562065, 0.025699052959680557, 0.03274271637201309, -0.045032285153865814, -0.01788913458585739, -0.010469711385667324, -0.00690735736861825, -0.022516142576932907, 0.011825395748019218, 0.004155466333031654, -0.040935762226581573, 0.007401003036648035, -0.09625356644392014, -0.05779339745640755, 0.010764425620436668, -0.021911978721618652, -0.026627402752637863, -0.0672537162899971, 0.0031294934451580048, -0.04924669489264488, -0.018375413492321968, -0.010793897323310375, -0.0445607453584671, -0.06253829598426819, -0.008480393327772617, 0.0060158479027450085, -0.010653908364474773, 0.02045314572751522, -0.010108686983585358, -0.04621114209294319, -0.023577112704515457, 0.021528851240873337, 0.0014947521267458797, 0.03766443952918053, 0.01657765731215477, 0.045356471091508865, 0.08134104311466217, 0.0022435097489506006, -0.003542092861607671, -0.03955060616135597, 0.04196726158261299, 0.004240196663886309, -0.0030152916442602873, -0.0018345940625295043, 0.015472480095922947, 0.044767044484615326, 0.012245363555848598, -0.06306877732276917, 0.016960786655545235, -0.02674528770148754, -0.014691488817334175, -0.013380011543631554, -0.04235038906335831, -0.03345002979040146, 0.018714332953095436, 0.04205567389726639, 0.057763926684856415, -0.025816939771175385, -0.06772525608539581, 0.013011619448661804, -0.04341135919094086, 0.02030578814446926, -0.015472480095922947, 0.03592562675476074, 0.019333232194185257, 0.0233413428068161, 0.021823564544320107, 0.027157887816429138, -0.04544488713145256, 0.05584828555583954, 0.04559224098920822, -0.01887642592191696, 0.010145526379346848, -0.029942933470010757, 0.04046421870589256, 0.004254932049661875, -0.029987141489982605, -0.02799782156944275, -0.009850812144577503, -0.065131776034832, 0.01741759292781353, 0.023768676444888115, -0.031003903597593307, -0.05658506974577904, -0.0051795970648527145, -0.0024516512639820576, 0.046122726052999496, 0.034452058374881744, 0.010484447702765465, 0.022221429273486137, -0.04022844880819321, -0.07344270497560501, 0.04358818754553795, -0.023989712819457054, 0.010521287098526955, -0.021528851240873337, -0.03392157331109047, -0.012761112302541733, -0.03560144081711769, -0.005864806938916445, -0.04131888970732689, 0.033361613750457764, -0.010779161006212234, 0.02368026226758957, -0.05514097213745117, -0.008576175197958946, -0.009541362524032593, 0.02898511290550232, -0.014919891953468323, -0.005463259294629097, -0.01234851311892271, 0.01847856305539608, -0.0062847742810845375, -0.07096710801124573, 0.00290845800191164, -0.014293625019490719, 0.024534933269023895, -0.027658900246024132, -0.014580970630049706, -0.02356237731873989, -0.0012654279125854373, -0.041554663330316544, -0.048834096640348434, 0.021926715970039368, -0.01507461629807949, 0.0005977166583761573, 0.024240219965577126, 0.016238735988736153, 0.005772708915174007, 0.010351826436817646, 0.05723344162106514, 0.01279058400541544, 0.030237646773457527, -0.013313701376318932, 0.025374868884682655, -0.00529748247936368, 0.009209809824824333, -0.009600305929780006, -0.014448349364101887, -0.002018790226429701, -7.172139157773927e-05, -0.030355533584952354, 0.006826310884207487, -0.01778598502278328, 0.03731078281998634, 0.029397713020443916, 0.00847302470356226, -0.03121020272374153, 0.013991543091833591, 0.04588695615530014, -0.007706768810749054, -0.00790570117533207, -0.02316451445221901, -0.008649853058159351, 0.004059683997184038, 0.0566440150141716, -0.03026711940765381, 0.020025810226798058, -0.07544676214456558, -0.05614300072193146, 0.016518715769052505, -0.011773820966482162, 0.037487611174583435, -0.05402106046676636, 0.004229144658893347, -0.05629035830497742, -0.004663847852498293, 7.42540942155756e-05, 0.0036194552667438984, -0.013402115553617477, -0.005290114786475897, 0.02565484680235386, -0.0184048842638731, -0.02730524353682995, 0.016666071489453316, 0.02857251465320587, 0.027644164860248566, 0.0014523869613185525, -0.035660382360219955, -0.01825752668082714, -0.015104088000953197, 0.03306690230965614, 0.022560350596904755, 0.0643065795302391, -0.10833683609962463, -0.013203183189034462, 0.0051538096740841866, 0.003234485164284706, -0.006988403853029013, 0.0247707050293684, 0.04450180009007454, 0.019642682746052742, 0.07745081931352615, 0.026111653074622154, -0.004505439195781946, 0.02674528770148754, 0.02807150036096573, -0.04871620982885361, 0.02575799636542797, -0.007069449871778488, 0.05484626069664955, -0.043087173253297806, -0.003770496230572462, 0.01419784314930439, -0.0038975914940238, 0.0008694060379639268, 0.008775106631219387, -0.006262670736759901, 0.028425157070159912, 0.002503226278349757, 0.008531968109309673, 0.009467684663832188, 0.00036056406679563224, -0.00370971136726439, -0.0011981962015852332, 0.03645611181855202, -0.0005438392981886864, -0.0018032807856798172, -0.039285365492105484, 0.00953399483114481, -0.04485545679926872, 0.04895197972655296, -0.030355533584952354, -7.592336623929441e-05, 0.02220669388771057, 0.0084877610206604, -0.012120109982788563, -0.019156403839588165, 0.036750826984643936, -0.008951934985816479, 0.020099489018321037, 0.011626464314758778, -0.0693756565451622, -0.011950649321079254, -0.008502496406435966, 0.021911978721618652, -0.011818028055131435, 0.0037170792929828167, 0.02173515036702156, 0.02985451929271221, 0.007478365674614906, 0.05405053123831749, 0.020939422771334648, 0.048067837953567505, 0.017226029187440872, -0.015384065918624401, -0.06071106716990471, -0.00176091562025249, -0.01650397852063179, 0.011368589475750923, 0.01514829508960247, 0.02163200080394745, 0.024181276559829712, 0.01086757518351078, 0.047036342322826385, -0.02316451445221901, 0.027688372880220413, -0.00537116127088666, -0.00776571175083518, -0.030709190294146538, -0.014057853259146214, 0.03736972436308861, 0.047478411346673965, 0.06807891279459, -0.02558116801083088, -0.05861859768629074, -0.05334321781992912, -0.01460307464003563, -0.019259553402662277, -0.004162834025919437, 0.016179794445633888, -0.06324560940265656, -0.013704197481274605, -0.016769221052527428, -0.03713395446538925, 0.043853431940078735, 0.06424763053655624, -0.012871630489826202, -0.0481562539935112, -0.032949015498161316, 0.009077188558876514, 0.05511150136590004, -0.02341501973569393, -0.028646191582083702, -0.015649309381842613, -0.029574541375041008, 0.012569548562169075, 0.016017701476812363, -0.01709340699017048, -0.0067894719541072845, 0.029265090823173523, 0.010698115453124046, 0.0010250518098473549, -0.05466943234205246, 0.0054669431410729885, -0.05136863514780998, 0.032300643622875214, 0.03896117955446243, -0.011604360304772854, -0.04957088083028793, 0.09094871580600739, -0.03904959186911583, 0.04128941893577576, -0.03197646141052246, 0.04674162715673447, -0.002453493420034647, 0.0170197281986475, -0.0013759456342086196, 0.014337832108139992, 0.031151261180639267, 0.028042029589414597, 0.031092317774891853, 0.038077037781476974, 0.0176681000739336, -0.013424218632280827, -0.05982692539691925, -0.0015472481027245522, -0.030856546014547348, -0.011604360304772854, -0.018375413492321968, 0.025920089334249496, -0.014676752500236034, -0.03698659688234329, -0.02869039960205555, 0.012252731248736382, -0.0502781942486763, 0.023356078192591667, 0.029736634343862534, -0.002646899316459894, 0.08953408896923065, 0.04924669489264488, -0.028454627841711044, 0.006524229422211647, -0.005396948661655188, -0.03197646141052246, -0.012127477675676346, 0.01931849680840969, -0.018463827669620514, 0.03510042652487755, -0.005301166325807571, -0.006557384505867958, 0.007139444351196289, 0.025271717458963394, -0.03604351356625557, 0.008590910583734512, -0.012319041416049004, 0.020246846601366997, 0.005489046685397625, -0.008590910583734512, -0.033096373081207275, 0.027599958702921867, -0.015560894273221493, -0.016341887414455414, -0.009143499657511711, 0.006940512917935848, -0.016857635229825974, 0.03554249927401543, 0.030797604471445084, 0.0011070191394537687, 0.02393076941370964, -0.006045319139957428, 0.026804231107234955, -0.003971269819885492, 0.022059336304664612, -0.010373929515480995, 0.004789100959897041, 0.005102234426885843, 0.004475967492908239, 0.00032832971191965044, -0.04774365574121475, -0.042615633457899094, -0.127316415309906, 0.006152153015136719, -0.033685799688100815, 0.014743063598871231, -0.025566432625055313, -0.008274093270301819, -0.006719477474689484, -0.058972254395484924, 0.0009688719874247909, -0.00048167305067181587, -0.0226487647742033, -0.02107204496860504, 0.004608588758856058, 0.013976807706058025, 0.023223455995321274, -0.010734953917562962, 0.0066236951388418674, 0.023282399401068687, 0.0036747141275554895, 0.05755762755870819, -0.011368589475750923, -0.012134845368564129, -0.002672686707228422, 0.029265090823173523, -0.01606190763413906, 0.021985657513141632, -0.02202986553311348, 0.0009136131266131997, -0.023916034027934074, -0.003746550530195236, 0.012156949378550053, -0.04258615896105766, -0.002792414277791977, 0.027349451556801796, 0.008318300358951092, 0.011294910684227943, -0.027644164860248566, -0.03498254343867302, -0.014219946227967739, 0.01862591877579689, -0.004534910432994366, 0.011066507548093796, 0.029338769614696503, -0.05228224769234657, -0.035365670919418335, 0.01385155413299799, -0.021278344094753265, 0.015384065918624401, -0.03589615598320961, 0.020482616499066353, 0.009740294888615608, -0.011972752399742603, -0.003414997598156333, -0.021676208823919296, -0.0043286108411848545, 0.01271690521389246, -0.004313874989748001, -0.044000785797834396, 0.017800720408558846, 0.008296196348965168, -0.0028310955967754126, -0.03919694945216179, 0.03987479209899902, 0.03772338107228279, -0.027025265619158745, 0.01759442128241062, -0.00837724283337593, -0.06483706086874008, 0.011862235143780708, 0.0368981808423996, -0.03439311310648918, -0.04759629815816879, -0.025478018447756767, 0.008480393327772617, -0.00954873114824295, -0.013453690335154533, -0.007224174682050943, -0.014116796664893627, 0.03241853043437004, -0.019863717257976532, 0.01976056769490242, -0.0003852002846542746, -0.02360658533871174, 0.006181624252349138, -0.0141610037535429, -0.020512089133262634, 0.010388665832579136, -0.03177015855908394, 0.014359935186803341, -0.04131888970732689, -0.04314611852169037, 0.05251802131533623, -0.026111653074622154, -0.02173515036702156, -0.012466398999094963, -0.022088807076215744, 0.006251618731766939, 0.0030300274956971407, 0.03601403906941414, -0.031092317774891853, -0.039904262870550156, -0.0031737005338072777, 0.035807739943265915, -0.03728131204843521, 0.01405048556625843, 0.025787467136979103, -0.005879542790353298, -0.02942718379199505, 0.02250140719115734, 0.005540621466934681, 0.035807739943265915, 0.003779705846682191, -0.00478541711345315, 0.04420708864927292, 0.005301166325807571, 0.009371902793645859, -0.03619086742401123, 0.016769221052527428, -0.01581140235066414, -0.028042029589414597, -0.012201156467199326, 0.000987291568890214, -0.01917113922536373, -0.012945308350026608, -0.018684862181544304, 0.046122726052999496, 0.053696874529123306, 0.01921534724533558, -0.03978637978434563, -0.014890420250594616, -0.011442267335951328, -0.009231913834810257, -0.023179249837994576, -0.03510042652487755, -0.017137615010142326, -0.001167803886346519, -0.03619086742401123, 0.01961321011185646, 0.017034463584423065, 0.020187903195619583, 0.004479651339352131, -0.016842899844050407, 0.021676208823919296, 0.03268377482891083, -0.00020123434660490602, 0.026907380670309067, 0.008244621567428112, -0.00858354289084673, -0.014293625019490719, -0.015192502178251743, -0.04727211222052574, -0.023149777203798294, 0.04662374034523964, -0.05319586023688316, 0.015443009324371815, -0.06395292282104492, -0.012554813176393509, -0.007861494086682796, 0.0037115532904863358, 0.040051620453596115, 0.02074785903096199, 0.01053602248430252, 0.01660712994635105, -0.002092468785122037, -7.816826109774411e-05, -0.010749690234661102, -0.0141610037535429, 0.0032565887086093426, -0.003945482429116964, -0.0169755220413208, 0.040523163974285126, -0.01902378350496292, -0.028823019936680794, -0.00949715543538332, 0.011280175298452377, -0.027541015297174454, -0.04606378450989723, -0.015398802235722542, -0.01993739604949951, 3.971730620833114e-05, 8.352145960088819e-05, 0.0510149784386158, -0.01275374460965395, -0.008502496406435966, 0.03804756700992584, -0.032949015498161316, -0.004759629722684622, -0.00677105225622654, 0.006498442031443119, 0.0040928395465016365, 0.00878247432410717, -0.024652818217873573, 0.0009384796139784157, -0.0184048842638731, 0.0018824851140379906, -0.028881963342428207, -0.007949908263981342, 0.001785782165825367, -0.020806802436709404, 0.0034942019265145063, -0.017432328313589096, 0.030532361939549446, 0.03418681398034096, 0.015855608507990837, 0.03333214297890663, 0.0054153683595359325, 0.0005300245829857886, 0.0005949537153355777, 0.0004821335314773023, -0.017609156668186188, 0.017756514251232147, -0.023400284349918365, -0.0054669431410729885, 0.008576175197958946, -0.059001725167036057, -0.017948077991604805, 0.03224170207977295, -0.00656106835231185, -0.013254757970571518, 0.003466572379693389, 0.042939815670251846, 0.0006967221270315349, -0.006748948711901903, -0.045945897698402405, 0.015369330532848835, 0.015649309381842613, -0.0017774932784959674, 0.007566779851913452, -0.03221223130822182, 0.01584087312221527, -0.007294169161468744, -0.011545417830348015, 0.016960786655545235, 0.018419619649648666, 0.015266180969774723, -0.023945504799485207, 0.0032436950132250786, -0.017903869971632957, 0.0057616569101810455, -0.029441919177770615, -0.009939226321876049, 0.030208176001906395, -0.022457201033830643, -0.03813597932457924, -0.009821341373026371, 0.0007137602660804987, 0.035218313336372375, 0.03630875423550606, -0.02807150036096573, 0.025109626352787018, 0.035807739943265915, 0.018670126795768738, 0.019480589777231216, -0.025419075042009354, -0.005857439246028662, 0.001972741214558482, -0.01781545579433441, -0.01388839352875948, -0.035483554005622864, -0.037487611174583435, -0.007165232207626104, -0.021853037178516388, -0.027054738253355026, -0.017623892053961754, -0.010690746828913689, -0.007750975899398327, -0.011987488716840744, 0.034157343208789825, -0.00745626213029027, -0.0063105616718530655, -0.13721880316734314, -0.02649478055536747, 0.036131925880908966, -0.013247390277683735, 0.013284229673445225, 0.015899816527962685, -0.0016531608998775482, 0.002665319014340639, -0.0076772975735366344, 0.002785046584904194, 0.037458136677742004, -0.03165227547287941, -0.01053602248430252, -0.007986746728420258, -0.006844730582088232, -0.0530485063791275, -0.0020151063799858093, -0.020335260778665543, 0.05402106046676636, -0.05982692539691925, -0.006829995196312666, 0.030768131837248802, -0.016666071489453316, 0.010919150896370411, -0.005411684047430754, -0.04420708864927292, -0.003553144633769989, 0.03241853043437004, -0.003553144633769989, 0.004892250988632441, -0.014654649421572685, 0.019804775714874268, -0.0041112592443823814, 0.035483554005622864, -0.02469702623784542, -0.012510606087744236, -0.027894672006368637, 0.0020998367108404636, 0.009150867350399494, -0.022088807076215744, 0.015251444652676582, -0.036426641047000885, 0.01825752668082714, -0.010351826436817646, 0.024137070402503014, -0.03601403906941414, 0.012193787842988968, 0.012724272906780243, -0.02360658533871174, -0.01620926521718502, -0.019451119005680084, 0.002097994787618518, 0.0212636087089777, 0.027570486068725586, -0.030944960191845894, -0.012768479995429516, -0.007485733367502689, -0.02261929214000702, 0.00852460041642189, 0.021926715970039368, -0.024903325363993645, 0.02568431757390499, -0.006089526228606701, -0.013939968310296535, -0.057321857661008835, -0.01603243686258793, 0.0071615478955209255, 0.01282742340117693, 0.010064479894936085, -0.02385709062218666, -0.017152350395917892, 0.009298224002122879, 0.013991543091833591, 0.008708796463906765, 0.029147205874323845, 0.03563091158866882, -0.005404316354542971, 0.00923928152769804, -0.057027142494916916, 0.021278344094753265, 0.011773820966482162, -0.047920484095811844, 0.008870888501405716, -0.022412993013858795, 0.01265796273946762, 0.00881931371986866, 0.03916747868061066, -0.028351478278636932, -0.01240745559334755, 0.014986202120780945, 0.04479651525616646, 0.0010775477858260274, 0.006133733317255974, -0.014278888702392578, -0.027025265619158745, 0.0031165997497737408, 0.02876407839357853, -0.011626464314758778, 0.009416109882295132, -0.002573220757767558, 0.035041484981775284, 0.0014201527228578925, -0.009688720107078552, -0.04559224098920822, 0.019303761422634125, -0.0020869430154561996, 0.006465286482125521, -0.009777134284377098, 0.01899431087076664, -0.017402857542037964, 0.015870343893766403, 0.026995794847607613, 0.01514829508960247, 0.021234137937426567, -0.003414997598156333, -0.007817286998033524, 0.0517517626285553, 0.019053254276514053, 0.03147544711828232, -0.0017038148362189531, -0.020512089133262634, 0.04347030073404312, -0.013674725778400898, 0.007500469218939543, -0.008495128713548183, 0.008288828656077385, 0.0034186814446002245, 0.044295500963926315, 0.016165059059858322, 0.016459772363305092, -0.015192502178251743, 0.038990650326013565, -0.02916194126009941, 0.013571576215326786, -0.01317371241748333, -0.0054669431410729885, 0.016091380268335342, 0.01778598502278328, -0.031740687787532806, 0.009747662581503391, -0.0019303761655464768, 0.02531592547893524, 0.06436552107334137, -0.013232654891908169, 0.0057800766080617905, -0.015560894273221493, -3.6465091397985816e-05, -0.023208720609545708, -0.008826681412756443, -0.016769221052527428, -0.00964451301842928, -0.013107401318848133, -0.01924481801688671, 0.014323095791041851, -0.039727434515953064, -0.031239675357937813, -0.03554249927401543, -0.029412448406219482, 0.019598474726080894, 0.04099470376968384, -0.010911782272160053, 0.02217722125351429, 0.004634376149624586, -0.007290485315024853, 0.03121020272374153, -0.01573772355914116, -0.02612638846039772, -0.007507836911827326, -0.026391630992293358, 0.02886722795665264, 0.0026247957721352577, -0.024092862382531166, 0.04299876093864441, 0.001961689442396164, 0.01306319423019886, 0.03492359817028046, 0.015560894273221493, -0.015310388058423996, 0.0021716731134802103, 0.013549472205340862, 0.009003509767353535, 0.007780447136610746, -0.01808069832623005, 0.02309083566069603, 0.020939422771334648, 0.015354595147073269, 0.024343369528651237, 0.04341135919094086, 0.026509515941143036, 0.028204120695590973, 0.007972011342644691, 0.019156403839588165, 0.0051795970648527145, 0.022928742691874504, 0.02561063878238201, -0.023503433912992477, 0.027968350797891617, 0.013490529730916023, -0.018021756783127785, -0.004277035593986511, -0.01830173470079899, 0.037782322615385056, 0.014477821066975594, 0.00708050187677145, -0.037340253591537476, 0.013984175398945808, -0.024903325363993645, 0.02444651909172535, -0.004133362788707018, 0.012341145426034927, 0.00478541711345315, 0.0014763325452804565, -0.01917113922536373, 0.015575630590319633, -0.015781929716467857, -0.005242223851382732, -0.006896305829286575, 0.01682816445827484, -0.02879354916512966, -0.029692426323890686, -0.032801657915115356, -0.004321242682635784, -0.004004425369203091, -0.005621667951345444, 0.00040431064553558826, -0.0027205778751522303, 0.017137615010142326, -0.007986746728420258, -0.007861494086682796, 0.012960044667124748, 0.0036139292642474174, 0.003396577900275588, 0.001317923772148788, 0.013497897423803806, -0.001211090013384819, -0.024608612060546875, 0.015052513219416142, -0.020291052758693695, 0.0020077384542673826, -0.005330638028681278, 0.026686344295740128, -0.019966866821050644, -0.016916578635573387, -0.006004795897752047, -0.009976065717637539, 0.007308905012905598, -0.02513909712433815, 0.032477471977472305, 0.004498071037232876, -0.02034999616444111, 0.010432872921228409, -0.009357166476547718, 0.010779161006212234, -0.009025613777339458, 0.041554663330316544, -0.02422548457980156, 0.022368786856532097, 0.0396684929728508, 0.030532361939549446, 0.013188447803258896, -0.02163200080394745, 0.017977548763155937, -0.0032013298477977514, -0.004299139138311148, 0.001374103594571352, -0.018832219764590263, -0.012871630489826202, -0.018581712618470192, 0.000530485063791275, 0.013402115553617477, -0.03810650855302811, 0.019333232194185257, 0.03790020942687988, 0.007669929414987564, 0.009172970429062843, 0.002549275290220976, 0.01763862743973732, 4.530075239017606e-05, 0.00947505235671997, 0.005183280911296606, -0.02645057439804077, 0.0025695369113236666, 0.012945308350026608, -0.03377421572804451, -0.0030079239513725042, -0.023518171161413193, -0.028999848291277885, -0.012098005972802639, 0.013077929615974426, -0.013844186440110207, 0.01591455191373825, 0.044767044484615326, 0.014964099042117596, 0.008915095590054989, -0.012024328112602234, -0.006428447086364031, 0.015030409209430218, 0.009401373565196991, 0.035070955753326416, -0.032330118119716644, 0.006343717221170664, 0.0027574170380830765, 0.03135756030678749, -0.016282944008708, 0.028719870373606682, 0.012665330432355404, 0.015487216413021088, -0.0390201210975647, -0.0170197281986475, -0.001623689429834485, 0.0034131554421037436, 0.019451119005680084, 0.01522197388112545, 0.02792414277791977, -0.02787993662059307, -0.003322899341583252, -0.0034757822286337614, -0.024652818217873573, -0.012488502077758312, -0.017108142375946045, -0.005330638028681278, -0.002724261721596122, 0.000855591322761029, -0.008141472004354, 0.006947880610823631, -0.007054714486002922, 0.005916381720453501, -0.008060425519943237, 0.010314987041056156, 0.02634742483496666, 0.028380949050188065, -0.006782103795558214, -0.010786529630422592, 0.01333580445498228, -0.03209434449672699, 0.008266725577414036, -0.027629429474473, -0.009924490936100483, -0.0005111444625072181, -0.018508033826947212, 0.019922660663723946, -0.0014275205321609974, -0.00817831140011549, -0.009637145325541496, 0.004299139138311148, 0.03530672565102577, -0.01265796273946762, -0.001961689442396164, 0.004638060461729765, -0.001254376140423119, 0.08234306424856186, -0.015796665102243423, -0.03380368649959564, -0.0017388120759278536, -0.0163271501660347, 0.028823019936680794, 0.010852839797735214, -0.02718735858798027, -0.024800175800919533, -0.0005263406201265752, 0.0063179293647408485, 0.03728131204843521, 0.002704000100493431, 0.011243335902690887, 0.018743805587291718, -0.0043286108411848545, -0.01690184324979782, 0.011059139855206013, 0.011891706846654415, -0.004744893871247768, 0.021853037178516388, -0.007297853473573923, 0.012355880811810493, -0.0018391989869996905, -0.03751708194613457, 0.002409286331385374, -0.016017701476812363, 0.005547989625483751, 0.02938297763466835, 0.03492359817028046, 0.0016209265450015664, -0.02447598986327648, -0.04845096915960312, 0.0067636845633387566, 0.006071106530725956, 0.003798125544562936, -0.017579685896635056, 0.029545070603489876, -0.008723531849682331, -0.009784501977264881, 0.00026639376301318407, 0.04482598602771759, -0.028734605759382248, 0.012923205271363258, 0.0030871282797306776, -0.0052569592371582985, 0.01595875807106495, 0.022265635430812836, 0.026951586827635765, -0.004575433675199747, 0.003864436177536845, -0.010919150896370411, 0.007662561722099781, -0.02558116801083088, 0.02279612049460411, -0.029191413894295692, 0.003496043849736452, 0.010440240614116192, 0.016562921926379204, 0.0028642509132623672, -0.030178705230355263, -0.019642682746052742, -0.021352022886276245, -0.018065962940454483, -0.011751716956496239, -0.06554437428712845, -0.0005829809815622866, 0.01906798966228962, -0.025153832510113716, 0.007529940456151962, -0.030178705230355263, 0.01419784314930439, -0.0007326403865590692, -0.005765340756624937, 0.008738267235457897, -0.000512065424118191, -0.013225287199020386, 0.02188250795006752, 0.03804756700992584, 0.036868710070848465, -0.00707313371822238, -0.016592392697930336, -0.019230082631111145, -0.003919695038348436, 0.02802729234099388, -0.018345940858125687, 0.02908826246857643, -0.0021864089649170637, -0.007157864049077034, 0.011530681513249874, -0.01553142350167036, -0.0012829265324398875, 0.04683003947138786, 0.011891706846654415, -0.01480200607329607, -0.00037092508864589036, -0.009180338121950626, -0.011538050137460232, 0.01130964607000351, -0.019200611859560013, -0.009423477575182915, -0.02067418023943901, -0.02294347807765007, -0.01022657286375761, -0.006719477474689484, 0.019259553402662277, -0.05290114879608154, -0.027717843651771545, -0.009821341373026371, 0.043706074357032776, -0.0014837003545835614, -0.014043117873370647, 0.034599412232637405, 0.004733842331916094, 0.020629974082112312, 0.022751914337277412, -0.009895019233226776, 0.010418136604130268, 0.017756514251232147, -0.020836273208260536, 0.030974432826042175, 0.012363248504698277, 0.03026711940765381, 0.011095979250967503, -0.01018973346799612, 0.0024682290386408567, -0.005956904962658882, -0.01070548314601183, -0.020408937707543373, -0.016769221052527428, -0.003974954131990671, -0.0008159891585819423, 0.011317014694213867, 0.010683379136025906, 0.002936087315902114, 0.0028550410643219948, 0.01447045337408781, 0.013984175398945808, -0.01545774471014738, -0.005916381720453501, 0.01476516667753458, 0.0268926452845335, -0.020025810226798058, -0.010757057927548885, 0.016371358186006546, -0.019554268568754196, -0.000967951025813818, -0.0184490904211998, 0.024579141288995743, -0.005301166325807571, -0.023768676444888115, -0.016960786655545235, 0.019569003954529762, 0.019716361537575722, 0.003584458027034998, 0.029662955552339554, 0.0006663297535851598, 0.03312584385275841, 0.0062589868903160095, 0.024137070402503014, 0.012599020265042782, 0.0025640111416578293, -0.00026224934845231473, 0.0036194552667438984, 0.041731491684913635, -0.0037078694440424442, -0.011773820966482162, -0.0009283488034270704, -0.0052238041535019875, 0.0018557766452431679, 0.002766626887023449, -0.01584087312221527, 0.006516861263662577, -0.007537308149039745, -0.006314245518296957, 0.0002258705790154636, -0.026833701878786087, 0.03456994146108627, -0.0035734062548726797, 0.005286430940032005, -0.01704920083284378, 0.009423477575182915, 0.004663847852498293, -0.0006069264491088688, -0.024019183591008186, -0.011736981570720673, 0.015015673823654652, 0.007032610941678286, 0.005559041164815426, -0.0026247957721352577, 0.00995396263897419, -0.005400632508099079, -0.0022840327583253384, 0.004232828505337238, 0.00841408222913742, 0.017476534470915794, 0.0002389945584582165, 0.008686692453920841, 0.04886356741189957, 0.01576719433069229, 0.00014160083082970232, -0.017211291939020157, -0.0024645451921969652, -0.01998160406947136, -0.029147205874323845, 0.01763862743973732, -0.01588507927954197, 0.0011263597989454865, -0.010307619348168373, -0.01815437711775303, 0.040375806391239166, -0.0028900383040308952, 0.013416850939393044, 0.02945665642619133, 0.015398802235722542, -0.0052053844556212425, -0.014308360405266285, 0.008531968109309673, -0.04220303148031235, -0.023208720609545708, -0.008576175197958946, -0.008333035744726658, 0.012702169828116894, -0.007504153065383434, -0.020040545612573624, -0.01746179908514023, 0.0052053844556212425, -0.010727586224675179, -0.00862038228660822, 0.006093210075050592, -0.03377421572804451, -0.02210354432463646, -0.02067418023943901, 0.005006452556699514, 0.018242791295051575, 0.012053798884153366, -0.013262126594781876, -0.02920614928007126, 0.00909192394465208, 0.01734391413629055, 0.005839019548147917, 0.0033063217997550964, -0.007714136503636837, -0.012488502077758312, -0.011862235143780708, 0.013232654891908169, 0.012495869770646095, 0.03209434449672699, -0.01343158632516861, -0.011876970529556274, -0.005242223851382732, 0.011722246184945107, -0.002910299925133586, -0.02390129864215851, 0.015487216413021088, -0.05481678992509842, -0.01716708578169346, -0.009268752299249172, 0.022560350596904755, 0.0029158256947994232, -0.02667160890996456, -0.009010878391563892, 0.013652621768414974, -0.004781733267009258, -0.008119367994368076, 0.030709190294146538, -0.021985657513141632, -0.01018973346799612, -0.022737178951501846, 0.02730524353682995, 0.009180338121950626, -0.004512806888669729, -0.01167067140340805, -0.016695544123649597, -0.008981406688690186, 0.0070768180303275585, 0.026686344295740128, 0.01418310683220625, -0.010565494187176228, -0.030974432826042175, 0.028454627841711044, -0.008156207390129566, -0.023665526881814003, -0.0025695369113236666, 0.015649309381842613, 0.040346335619688034, -0.007507836911827326, -0.0005355504690669477, 0.01268006581813097, -0.004048632457852364, 0.010138158686459064, -0.0005005531711503863, 0.02001107484102249, -0.0375465527176857, 0.00031451499671675265, 0.022118279710412025, -0.009592938236892223, 0.005260643549263477, -0.02141096629202366, 0.009865548461675644, -0.019848981872200966, 0.00495856162160635, 0.013822082430124283, 0.002635847544297576, 0.0021440437994897366, 0.026686344295740128, 0.014757798984646797, 0.05057290941476822, 0.005706398282200098, 0.03303743153810501, 0.0022066703531891108, -0.022339314222335815, 0.001935902051627636, 0.018242791295051575, -0.00025557223125360906, 0.021985657513141632, -0.013822082430124283, 0.042320918291807175, -0.026480045169591904, 0.03168174624443054, -0.03448152914643288, 0.01855224184691906, 0.00984344445168972, -0.008531968109309673, 0.020777331665158272, -0.019893189892172813, -0.005975324660539627, 0.016960786655545235, -0.01793334260582924, -0.00968135241419077, 0.03848963603377342, 0.013107401318848133, 0.0046233246102929115, -0.014676752500236034, -0.006984720006585121, 0.0035015696194022894, 0.027644164860248566, 0.021970922127366066, 0.0007662561838515103, -0.037782322615385056, -0.031858574599027634, -0.006509493570774794, 0.00885615311563015, -0.01803649216890335, 0.005610615946352482, 0.015081984922289848, -0.010057112202048302, -0.007051030173897743, -0.01958373934030533, -0.00847302470356226, 0.023400284349918365, 0.048067837953567505, 0.02225090004503727, 0.017948077991604805, 0.03200593218207359, 0.0017167085316032171, 0.0015573787968605757, -0.01329896505922079, -0.028896698728203773, 0.00533432187512517, -0.0023079784587025642, -0.0030558148864656687, 0.00920244213193655, 0.013262126594781876, 0.01015289407223463, -0.013799979351460934, 0.005555357318371534, -0.03787073865532875, -0.00700682308524847, -0.01815437711775303, -0.008325668051838875, 0.019053254276514053, 0.019745832309126854, 0.007213123142719269, -0.0001885708625195548, -0.011272807605564594, -0.009335063397884369, -0.003240011166781187, 0.014934627339243889, -0.001985634909942746, 0.019996339455246925, -0.023842355236411095, -0.010197101160883904, -0.023356078192591667, -0.0038386487867683172, 0.006782103795558214, -0.028410421684384346, 0.04759629815816879, -0.00988028384745121]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
" sequence.5.3. Ablations and Extensions
Key cache compression The first step in SparQ Attention
involves reading rcomponents of the key cache to approx-
imately determine which keys yield the highest attention
scores. To examine the practical trade-off of the approx-
imation we look at how SparQ Attention performs when
compared to a theoretical upper-bounding “ oracle ” which
provides the exact top- kkeys without any data transfer. The
results in Figure 4a show that SparQ Attention retains com-
parable performance to the oracle for a wide range of com-
pression ratios, and attains considerably higher performance
than a baseline compression scheme, in which a random low
rank projection of Kis transferred from memory.
Approximate softmax temperature To empirically sup-
port our statistical analysis of αagreement shown in Fig-
ure 3f, we evaluate a number of different viable temperature
settings, including the square root of the head dimension
(τ=√dh), the square root of the rank ( τ=√r), and the
temperature proposed in Equation (10). We also consider
the scenario where we do not reallocate mass to mean value
(α= 0), which corresponds to the limit of the temperature
tending towards 0. We find that our proposed temperature
performs best, as shown in Figure 4b.
Hyperparameter selection The reduction of data transfer
attained by SparQ Attention is controlled by its two hyper-
parameters, kandr. Reducing either of these variables will
improve the bandwidth efficiency, but can negatively impact
task performance. Figure 4c shows the relationship between
kandron both of these factors. Based on these results, we
propose a simple recipe of setting k= 128 and tuning r
to maintain a good trade-off between data transfer and task
performance for a range of models and tasks.
6
SparQ Attention: Bandwidth-Efficient LLM Inference
8 16 32 64 128 256
Attention transfers per token (MB)0.50.60.70.8SQuAD AccuracyOracle
SparQ
Low Rank
(a) Accuracy results of SparQ Attention and a random low rank
compression scheme against an oracle top- kselector.
k= 128,r= 32 k= 128,r= 640.650.700.75SQuAD Accuracylimx→0x√r/radicalBigg
dh/bardblq◦mq/bardbl1
/bardblq/bardbl1
√dh
(b) Comparison of different softmax temperatures for approximate
attention scores for two different hyperparameter configurations.
32 64 128
Transfers (MB)50100150200Repetition
match length
32 64 128
Transfers (MB)0.50.60.70.8SQuAD Accuracyk= 32
k= 64
k= 128
k= 256
(c) Results for Repetition and SQuAD tasks with r∈ {16,32,64}.
2000 4000 6000 8000 10000 12000
Sequence length S0.30.50.7SQuAD Accuracy
(train set)Dense
SparQ
H2O
(d) SQuAD performance vs input sequence length. The compres-
sion ratio is fixed at 1/4. Uses Vicuna 1.5 7B with 16k maximum
sequence length against our SQuAD (train) task with 7(default)
to63confusion contexts to increase the sequence length.
Figure 4: Results of ablations and extensions (Llama 2 7B
SQuAD 1-shot performance unless specified).
Sequence length scaling The sequence lengths of differ-
ent examples in our main tasks vary between 1k and 2k
tokens, whereas many LLMs support sequence lengths far
greater than this. We developed a variation of the SQuAD
task that increases the task difficulty, as well as the se-
quence length by increasing the number of confusion con-
texts present in the prompt in Figure 4d, which is akin to in-
creasing the number of retrieved documents with a retrieval
augmented generation system (Borgeaud et al., 2022). We
test SparQ Attention and H 2O in this setting using Vicuna
(Chiang et al., 2023), a descendent of Llama 2that has been
adapted and for longer sequences. Both SparQ Attention
2048 4096 8192 16384
Sequence length S100µs
25µs50µs75µs250µsTime per queryDense
S","[0.019068337976932526, 0.035452164709568024, 0.06752793490886688, -0.002139653079211712, 0.010405943728983402, 0.00447649322450161, 0.001252311049029231, 0.0019822493195533752, -0.02881007269024849, 0.02086723782122135, 0.019455794245004654, -0.012633811682462692, -0.04530460014939308, 0.020175354555249214, 0.018016673624515533, -0.013401803560554981, 0.03492633253335953, -0.029889412224292755, -0.0154428631067276, 0.00611971877515316, -0.035535190254449844, -0.03965882211923599, -0.020507458597421646, 0.031577613204717636, 0.01504157017916441, -0.021199343726038933, 0.005119945853948593, 0.022638462483882904, 0.06935451179742813, -0.045885782688856125, 0.0735611692070961, -0.03907763957977295, -0.03597799688577652, -0.030304543673992157, 0.010599671863019466, 0.05333046242594719, -0.014162876643240452, 0.031190156936645508, -0.052887655794620514, -0.008897635154426098, -0.008288777433335781, -0.053441163152456284, -0.06979731470346451, -0.01667441800236702, 0.010392106138169765, 0.003457693150267005, -0.009935461916029453, -0.011097827926278114, 0.007154086139053106, 0.03653150424361229, -0.041180968284606934, 0.077214315533638, -0.0627124160528183, 0.016356151551008224, 0.032906029373407364, 0.01143685169517994, -0.002779646310955286, 0.03049827180802822, 0.04654999449849129, -0.02753700502216816, 0.016619067639112473, -0.024105258285999298, 0.00812272448092699, -0.0027986729983240366, -0.02881007269024849, 0.016868146136403084, -0.0150000574067235, 0.02363477647304535, 0.025807294994592667, 0.01234322041273117, -0.011706686578691006, 0.04093189164996147, 0.055931948125362396, 0.002949157962575555, -0.0005893991328775883, 0.01062734704464674, -0.000926260428968817, -0.01249543484300375, 0.003244938561692834, -0.015027732588350773, 0.02088107541203499, 0.006147394422441721, 0.04870867356657982, -0.02086723782122135, -0.006275393068790436, -0.02928055450320244, -0.017532354220747948, 0.0015013895463198423, -0.015138434246182442, -0.01452957559376955, -0.049981739372015, 0.04209425672888756, -0.01591334491968155, -0.005808371119201183, 0.04253706336021423, 0.013699314557015896, 0.034760281443595886, -0.012938241474330425, -0.013796178624033928, 0.057288043200969696, 0.025253785774111748, 0.017670731991529465, -0.0018092781538143754, -0.05626405403017998, 0.01833494007587433, 0.0031065617222338915, -0.02409142069518566, 0.022181818261742592, 0.0023627858608961105, -0.012848296202719212, -0.014349685981869698, -4.237793109496124e-05, -0.044695742428302765, 0.03946509584784508, 0.019068337976932526, -0.05327511206269264, -0.0717899426817894, -0.011575228534638882, -0.005251403898000717, 0.02422979660332203, -0.01811353862285614, -0.00750002870336175, 0.018999150022864342, -0.01710338704288006, -0.0042654681019485, -0.03113480471074581, 0.029308229684829712, -0.04511087387800217, -0.006700901780277491, -0.003943741787225008, 0.05501865968108177, -0.0014624709729105234, 0.051144108176231384, 0.012488516047596931, 0.006984574720263481, -0.0290591511875391, -0.060609087347984314, -0.0014719844330102205, -0.032131120562553406, 0.004659842699766159, -0.0032622357830405235, -0.011229285970330238, 0.00716792419552803, 0.037140361964702606, -0.035701245069503784, 0.006707821041345596, -0.030996428802609444, 0.031411558389663696, -0.037444792687892914, 0.02036908082664013, -0.016660580411553383, -0.023731639608740807, -0.06642092019319534, 0.022596949711441994, -0.0062235016375780106, -0.037776898592710495, -0.029668010771274567, 0.00844099186360836, 0.007735269609838724, -0.022347871214151382, -0.007749107200652361, -0.008399478159844875, 0.04743560403585434, -0.029640333727002144, -0.00990778673440218, 0.0008458288502879441, -0.05548914149403572, 0.03121783211827278, -0.09437305480241776, -0.045332275331020355, -0.009084444493055344, -0.022251008078455925, -0.010606590658426285, -0.04840424284338951, 0.02380082942545414, -0.004410764202475548, -0.02842261828482151, 0.004853570368140936, -0.02413293346762657, -0.040156979113817215, -0.016176261007785797, 0.009229740127921104, -0.02281835302710533, 0.031411558389663696, -0.0005314538138918579, -0.027094200253486633, -0.039132989943027496, 0.0024337039794772863, 0.031411558389663696, 0.0014027958968654275, 0.0036773665342479944, 0.045498330146074295, 0.054243750870227814, 0.018445642665028572, -0.02562740445137024, -0.05230647325515747, 0.04887472465634346, 0.04309057071805, -0.030608972534537315, -0.004044065251946449, 0.01587183214724064, 0.011353825218975544, 0.02435433678328991, -0.055682867765426636, 0.0363101027905941, -0.008143480867147446, -0.02053513377904892, -0.0261393990367651, -0.06127329543232918, -0.010786480270326138, 0.05230647325515747, 0.021448422223329544, 0.07195599377155304, -0.012779108248651028, -0.06597810983657837, 0.02371780201792717, -0.018265752121806145, 0.00010745831968961284, -0.007486191112548113, 0.04713117703795433, 0.013339534401893616, 0.00859320629388094, 0.014308172278106213, 0.04107026755809784, -0.060055579990148544, 0.03750014305114746, 0.036752909421920776, -0.008773095905780792, 0.010855669155716896, -0.03049827180802822, 0.01168593019247055, 0.028477968648076057, -0.009603357873857021, -0.006617875769734383, -0.017892135307192802, -0.057841550558805466, 0.025378325954079628, -0.012848296202719212, -0.021697500720620155, -0.04508319869637489, 0.010502807796001434, -0.0011909062741324306, 0.04909612983465195, 0.018763909116387367, -0.009063688106834888, 0.03556286543607712, -0.016273124143481255, -0.031965065747499466, 0.045249249786138535, -0.001055123982951045, -0.036088697612285614, -0.028837747871875763, -0.04887472465634346, -0.02215414308011532, -0.04500017315149307, -0.01913752779364586, -0.030442921444773674, 0.05380094423890114, -0.009824761189520359, -0.005711507052183151, -0.04010162875056267, -0.01402449980378151, -0.02299824357032776, 0.018888449296355247, 0.001643225783482194, -0.01277218945324421, 0.00314980442635715, 0.015470539219677448, -0.0231642946600914, -0.03559054061770439, -0.0016328475903719664, 0.012613055296242237, 0.010357512161135674, -0.003346991492435336, -0.020036976784467697, -0.021918902173638344, 0.029501957818865776, -0.030221518129110336, -0.042952194809913635, 0.01624544896185398, 0.023344185203313828, 0.007887483574450016, 0.03921601548790932, 0.011042477563023567, -0.007098735775798559, 0.010648103430867195, 0.038330405950546265, -0.004895083140581846, 0.00604707095772028, -0.016231611371040344, 0.03174366429448128, -0.015221460722386837, 0.03365326672792435, -0.003791527356952429, -0.01710338704288006, 0.01836261712014675, -0.03293370455503464, -0.027481654658913612, -0.014557250775396824, -0.00950649380683899, 0.040073953568935394, 0.042786139994859695, 0.0463285893201828, -0.009499575011432171, 0.017172574996948242, 0.03207576647400856, -0.008025861345231533, 0.028367267921566963, -0.02994476445019245, 0.008828447200357914, 0.030858051031827927, 0.03763851895928383, -0.02341337315738201, 0.029972439631819725, -0.031190156936645508, -0.05468655750155449, 0.02936358004808426, -0.027301764115691185, 0.04107026755809784, -0.027606194838881493, -0.0003388072072993964, -0.06509249657392502, -0.009693303145468235, 0.004639085847884417, 0.03329348564147949, -0.04101491719484329, -0.028242727741599083, 0.03462190181016922, -0.01786446012556553, -0.009222821332514286, 0.03254624828696251, 0.0021967333741486073, 0.0190960131585598, -0.01124312449246645, -0.047490958124399185, -0.02829807810485363, 0.00046096809091977775, 0.025392163544893265, 0.002689701272174716, 0.06846889853477478, -0.06675302237272263, -0.03016616776585579, -0.001753927324898541, 0.019358929246664047, 0.0032847218681126833, 0.0076937563717365265, 0.017795270308852196, -0.022513924166560173, 0.07577519863843918, -0.008385640569031239, -0.0023748937528580427, 0.0121564120054245, 0.004902001935988665, -0.03080270066857338, 0.015456700697541237, -0.009485737420618534, 0.026097886264324188, -0.051310159265995026, -0.011865819804370403, 0.004123631864786148, 9.767463780008256e-05, 0.021019453182816505, 0.033404186367988586, -0.021988091990351677, 0.04785073548555374, -0.01850099302828312, 0.0018179266480728984, 0.015179947018623352, 0.008586287498474121, -0.020715024322271347, -0.01891612447798252, 0.034649576991796494, -0.015290648676455021, -0.030442921444773674, -0.06763863563537598, 0.018971474841237068, -0.02928055450320244, 0.034123744815588, -0.002653377363458276, 0.026194749400019646, 0.010405943728983402, 0.03105177916586399, -0.027301764115691185, -0.002854023827239871, 0.037859924137592316, -0.0014469035668298602, 0.015705779194831848, 0.023274997249245644, -0.08302614837884903, -0.022029604762792587, -0.021697500720620155, 0.02002313919365406, -0.004524925258010626, -0.0004458331095520407, 0.018763909116387367, 0.03916066512465477, 0.017975160852074623, 0.06105189397931099, 0.0403783842921257, 0.04832121729850769, -0.006040152162313461, -0.003310667583718896, -0.026789769530296326, 0.008005104027688503, -0.019787898287177086, 0.00979708507657051, 0.01973254792392254, 0.038496457040309906, 0.02172517590224743, 0.003625475103035569, 0.058395057916641235, -0.0335979126393795, 0.027675382792949677, -0.005334429908543825, 0.008856122381985188, -0.029086826369166374, -0.025599729269742966, 0.022832190617918968, 0.0065971193835139275, 0.0436164028942585, -0.04176215082406998, -0.04555368050932884, -0.023108944296836853, -0.01807202398777008, -0.038717858493328094, 0.011146260425448418, 0.01827958971261978, -0.06276776641607285, 0.02774457074701786, -0.015387512743473053, -0.03774922341108322, 0.04500017315149307, 0.051780641078948975, -0.03639312833547592, -0.041596099734306335, 0.00422049593180418, -0.0030045087914913893, 0.052749279886484146, -0.013989905826747417, -0.05072897672653198, -0.0014114445075392723, -0.021116316318511963, -0.009236658923327923, 0.008572449907660484, -0.04201123118400574, 0.005766857881098986, 0.005753020290285349, -0.010495889000594616, 0.01743549108505249, -0.004974650219082832, -0.020355243235826492, -0.0308857262134552, 0.02214030548930168, 0.03755549341440201, 0.012322464026510715, -0.07256485521793365, 0.09625498205423355, -0.028920775279402733, 0.04300754517316818, -0.03135620802640915, 0.050120119005441666, -0.025170760229229927, -0.02375931665301323, 0.009824761189520359, 0.0009098281734623015, 0.0029093746561557055, 0.012163330800831318, 0.01688198372721672, 0.04145772382616997, 0.012972835451364517, -0.003056399989873171, -0.01696500927209854, 0.003978336229920387, -0.03891158849000931, -0.03041524440050125, -0.029391257092356682, 0.043339647352695465, -0.02028605528175831, -0.005102648865431547, -0.001975330524146557, 0.020216867327690125, -0.03351488709449768, 0.02074269950389862, 0.02303975634276867, 0.020396756008267403, 0.05654080584645271, 0.07383792102336884, -0.004898542538285255, 0.016909658908843994, 0.005479725543409586, -0.035950321704149246, -0.022209495306015015, 0.018002836033701897, -0.016453014686703682, 0.043339647352695465, 0.017961323261260986, 0.019441956654191017, -0.00980400387197733, 0.004967730958014727, -0.04774003475904465, 0.030110815539956093, -0.027799921110272408, 0.052970681339502335, -0.009430386126041412, -0.003084075404331088, -0.0005353456945158541, 0.04386547952890396, -0.007250950206071138, -0.02630545012652874, 0.024340499192476273, 0.01367855817079544, -0.008807690814137459, 0.021780526265501976, 0.0270250104367733, -0.021517610177397728, 0.02833959087729454, 0.01132615003734827, -0.0008376127225346863, 0.015553564764559269, 0.01959417015314102, -0.015207622200250626, -0.013927636668086052, -0.008012022823095322, 0.007818295620381832, 0.0007615054491907358, -0.029391257092356682, -0.043588727712631226, -0.14867214858531952, -0.02566891722381115, -0.05590427294373512, 0.0105650769546628, -0.039990928024053574, -0.005669993814080954, 0.015332161448895931, -0.05189134180545807, 0.002957806456834078, 0.019801735877990723, -0.01989860087633133, -0.03564589098095894, 0.039990928024053574, 0.0005072378553450108, 0.005119945853948593, 0.011907333508133888, 0.02010616473853588, 0.01718641258776188, -0.018943799659609795, 0.04458504170179367, -0.009112119674682617, -0.019580332562327385, 0.00553853577002883, -0.0036566099151968956, -0.003884931793436408, 0.005583508405834436, 0.007043384946882725, -0.024036070331931114, 0.008323371410369873, -0.010143027640879154, 0.014038337394595146, -0.04610718786716461, -0.0011978251859545708, 0.03033221885561943, 0.005770317278802395, -0.026277774944901466, -0.01416979543864727, -0.024077583104372025, 0.016660580411553383, 0.028560994192957878, -0.023980718106031418, 0.009499575011432171, 0.03080270066857338, -0.04511087387800217, -0.015262973494827747, -0.00021740309603046626, -0.038330405950546265, 0.018224239349365234, -0.007915159687399864, 0.013595531694591045, 0.0176845695823431, -0.0022347872145473957, 0.011616742238402367, -0.030221518129110336, -0.009990813210606575, -0.008351046591997147, -0.003474990138784051, -0.04707582667469978, -0.004545681644231081, 0.006320365238934755, 0.033072080463171005, -0.03830273076891899, 0.007797539234161377, 0.04107026755809784, -0.006116259377449751, 0.037140361964702606, -0.0028436456341296434, -0.04289684444665909, -0.028187377378344536, -0.011132422834634781, -0.05706663802266121, -0.038607157766819, -0.0005595616530627012, 0.013899960555136204, -0.002534027211368084, -0.008371802978217602, -0.017255600541830063, -0.015636591240763664, 0.04574740678071976, -0.016217773780226707, 0.021282369270920753, 0.04419758543372154, -0.00033448293106630445, -0.0011139340931549668, -0.03041524440050125, -0.02100561559200287, -0.014917030930519104, -0.034649576991796494, -0.002345488639548421, -0.04273078963160515, -0.01998162642121315, 0.033321160823106766, -0.0024406227748841047, -0.007039925549179316, -0.007154086139053106, -0.026789769530296326, 0.03456655144691467, 0.005171837285161018, 0.01402449980378151, -0.031549934297800064, -0.05396699532866478, -0.0036566099151968956, 0.012931322678923607, -0.0476846843957901, 0.018473317846655846, -0.009963138028979301, -0.01769840717315674, -0.02095026522874832, 0.05532309040427208, 0.01245392207056284, 0.028948450461030006, 0.025530539453029633, 0.0045076278038322926, 0.022859865799546242, 0.033072080463171005, 0.008503261022269726, -0.050341520458459854, 0.03312743455171585, 0.004016390070319176, -0.012633811682462692, -0.013650882057845592, -0.008364884182810783, -0.028533319011330605, -0.03938207030296326, -0.053219761699438095, 0.037610843777656555, 0.008987580426037312, 0.02027221769094467, -0.03838575631380081, -0.03581194579601288, -0.03600567206740379, 0.0121564120054245, 0.0004938326310366392, -0.05197436735033989, 0.0017547921743243933, -0.0176845695823431, -0.047241877764463425, 0.020908750593662262, 0.020645834505558014, 0.016176261007785797, -0.002364515559747815, 0.016397664323449135, -0.007880564779043198, 0.014612602069973946, -0.004514546599239111, 0.03647615388035774, 0.01190041471272707, 0.009042930789291859, -0.03448352590203285, -0.00895298644900322, -0.029723361134529114, -0.016494527459144592, 0.03096875362098217, -0.03312743455171585, 0.0029041855596005917, -0.05161458998918533, -0.024298986420035362, -0.005320592317730188, 0.004874326754361391, 0.04187285527586937, 0.013291102834045887, 0.007762944791465998, 0.017407815903425217, -0.018127376213669777, 0.005552373826503754, 0.022901378571987152, -0.03149458393454552, 0.0074308402836322784, 0.02922520413994789, 6.6485779825598e-05, 0.060609087347984314, -0.016134748235344887, -0.04264776408672333, -0.011914252303540707, 0.03229717165231705, -0.014121363870799541, -0.02236170880496502, -0.006244258023798466, -0.04029535502195358, -0.005036919377744198, 0.015941020101308823, 0.051863666623830795, -0.004746328108012676, -0.011651336215436459, 0.014252821914851665, -0.018805421888828278, -0.0017798730405047536, 0.011568309739232063, 0.005327511113137007, -0.005600805394351482, 0.00010810696403495967, -0.02571042999625206, 0.009831679984927177, -0.027232576161623, 0.002706998260691762, -0.03940974548459053, 0.001757386839017272, 0.004237792920321226, -0.012177168391644955, 0.013823853805661201, -0.0020237623248249292, 0.04721420258283615, 0.0318266898393631, 0.018348777666687965, 0.03556286543607712, -0.0017046305583789945, -0.023358022794127464, -0.019995464012026787, -0.012363976798951626, -0.02554437890648842, 0.019068337976932526, -0.021074803546071053, -0.022167980670928955, 0.034981682896614075, -0.031799014657735825, 0.002354137133806944, 0.04353337734937668, -0.0068946294486522675, 0.00037102311034686863, 0.016148585826158524, 0.013159644789993763, -0.0030079681891947985, -0.01866704598069191, -0.0376661941409111, 0.01300742942839861, 0.007257869001477957, 0.004345035180449486, 0.005905234720557928, -0.01823807694017887, 0.0060747466050088406, -0.005839505698531866, 0.012945160269737244, 0.020009301602840424, 0.012135655619204044, -0.01684047095477581, -0.013761583715677261, 0.011879658326506615, 0.020424433052539825, -0.007112573366612196, 0.011962683871388435, -0.022500086575746536, 0.02176668867468834, 0.0004825894720852375, -0.0015126325888559222, -0.012737594544887543, -0.00797742884606123, 0.03417909890413284, 0.05142085999250412, -0.03218647092580795, 0.005334429908543825, -0.00018291697779204696, 0.008454829454421997, 0.028533319011330605, 0.0021621391642838717, -0.00823342613875866, -0.023441048339009285, -0.014723303727805614, -0.011817388236522675, -0.04109794273972511, -0.016660580411553383, -0.006168150808662176, -0.018404129892587662, -0.015221460722386837, -0.01981557346880436, -0.003231100970879197, -0.02651301585137844, -0.009963138028979301, 0.03135620802640915, 0.015152271836996078, 0.00231262412853539, -0.13217762112617493, -0.02685895934700966, 0.040627460926771164, 0.017463166266679764, 0.022942891344428062, 0.01331877801567316, -0.006590200588107109, -0.0010914478916674852, 0.0367252342402935, 0.009492656216025352, 0.01030907966196537, -0.020521296188235283, -0.01342947967350483, -0.010080758482217789, 0.013893041759729385, -0.07555379718542099, -0.0027865651063621044, 0.020798049867153168, 0.03398536890745163, -0.03655917942523956, -0.001000638003461063, -0.0018801962723955512, 0.013699314557015896, 0.024409687146544456, -0.007039925549179316, -0.04029535502195358, -0.00732013862580061, 0.005458969157189131, 0.018431805074214935, 0.024036070331931114, 0.0023264619521796703, 0.011049396358430386, 0.010516645386815071, 0.04129166901111603, -0.03559054061770439, -0.003660069312900305, -0.029889412224292755, 0.002833267208188772, 0.016190098598599434, -0.019843248650431633, -0.005967504344880581, -0.04109794273972511, 0.044142235070466995, -0.014501900412142277, 0.024257473647594452, -0.029252879321575165, 0.038883913308382034, 0.01671593077480793, 0.014142120257019997, -0.00037102311034686863, -0.013180401176214218, 0.0017150088679045439, 0.01675744354724884, 0.03273997828364372, -0.028367267921566963, -0.004268927965313196, 0.0009392332867719233, -0.015761129558086395, -0.006334203295409679, 0.015498214401304722, -0.007292463444173336, 0.015774967148900032, 0.05659615620970726, -0.0326569527387619, -0.024880168959498405, -0.030110815539956093, 0.004383088555186987, 0.014612602069973946, 0.030608972534537315, -0.0224862489849329, 0.00033361808164045215, -0.0038918505888432264, 0.00041707666241563857, 0.006559065543115139, 0.013886122964322567, 0.003481909167021513, 0.012114898301661015, 0.008371802978217602, -0.047407928854227066, 0.021393069997429848, 0.03309975564479828, -0.05645778030157089, 0.016093235462903976, -0.011831225827336311, -0.0060747466050088406, 0.013899960555136204, 0.007541541941463947, -0.008731583133339882, -0.027177225798368454, 0.035784270614385605, 0.04300754517316818, -0.006700901780277491, 0.01985708624124527, -0.01722792536020279, 0.002976833377033472, -0.013491748832166195, 0.015761129558086395, -0.011845063418149948, 0.04242636263370514, 0.01891612447798252, 0.04607951268553734, 0.0031307777389883995, 0.001285175560042262, -0.04107026755809784, 0.0034438553266227245, 0.004680599085986614, 0.006929223891347647, 0.0019943572115153074, 0.03334883600473404, -0.02741246670484543, 0.004016390070319176, 0.013920716941356659, 0.009042930789291859, 0.017726082354784012, 0.01883309707045555, 0.016231611371040344, 0.04610718786716461, 0.014667952433228493, 0.016217773780226707, -0.038966938853263855, 0.012038791552186012, 0.03971417248249054, -0.002886888338252902, 0.02214030548930168, -0.017878297716379166, -0.029806386679410934, 0.0028816992416977882, 0.014149039052426815, 0.010343674570322037, 0.015069245360791683, 0.008690070360898972, 0.04519389942288399, -0.012530029751360416, 0.012862133793532848, -0.004607951268553734, 0.012370895594358444, 0.02057664655148983, -0.0069603584706783295, -0.03381931781768799, 0.03678058460354805, -0.005445131566375494, 0.027080362662672997, 0.04879169911146164, 0.011409176513552666, -0.010689616203308105, 0.011097827926278114, 0.003556286683306098, 0.002345488639548421, -0.01973254792392254, 0.004711733665317297, -0.0032553167548030615, -0.0331827849149704, 0.0041443887166678905, 0.009464981034398079, -0.00553853577002883, 0.021711338311433792, -0.030110815539956093, -0.027481654658913612, 0.01967719756066799, 0.020382918417453766, -0.0006131826667115092, 0.007534622680395842, 0.00683927908539772, 0.010108433663845062, 0.012080304324626923, -0.016937334090471268, -0.013055861927568913, 0.0027952136006206274, -0.02049362100660801, 0.02088107541203499, 0.029003800824284554, -0.024022232741117477, 0.02180820144712925, 0.021794363856315613, 0.03143923357129097, 0.019538819789886475, 0.008676232770085335, -0.02673441916704178, 0.02595950849354267, 0.01073112990707159, 0.0007610730244778097, 0.012128736823797226, -0.014211309142410755, 0.01628696173429489, 0.0549909844994545, 0.019649522379040718, 0.015152271836996078, 0.019843248650431633, 0.00490892119705677, 0.011056315153837204, 0.001004097517579794, 0.014501900412142277, -0.005787614267319441, 0.015456700697541237, 0.007783701177686453, -0.0017253871774300933, 0.012474678456783295, -0.001165825524367392, -0.025572054088115692, -0.004898542538285255, -0.00920898374170065, 0.042869169265031815, -0.006389554124325514, 0.02944660745561123, -0.01798899844288826, 0.022583112120628357, -0.015968695282936096, -0.003445585025474429, -0.0048466515727341175, 0.009285090491175652, -0.0172694381326437, 0.011056315153837204, -0.020382918417453766, 0.0076453243382275105, 0.0061750696040689945, -0.01607939787209034, -0.021863551810383797, -0.00021372747141867876, -0.06343197822570801, -0.032435547560453415, -0.04234333336353302, -0.015553564764559269, -0.02129620686173439, -0.01866704598069191, 0.0010274485684931278, -0.007589973509311676, 0.04054443538188934, -0.01291748508810997, -0.016743605956435204, 0.020853400230407715, 0.017892135307192802, 0.009838598780333996, -0.013519424013793468, 0.006911926902830601, -0.025129247456789017, 0.0066455514170229435, -0.0050611356273293495, -0.018431805074214935, 0.006901548709720373, -0.0026827824767678976, 0.030996428802609444, -0.01764305680990219, -0.0035701242741197348, 0.003518233075737953, -0.006534849759191275, -0.004787841346114874, 0.01026756688952446, 0.035313788801431656, -0.008371802978217602, -0.006171610206365585, 0.0020652753300964832, -0.02714955061674118, 0.03202041611075401, -0.011699767783284187, 0.010717292316257954, -0.00965178944170475, 0.0032553167548030615, 0.0326569527387619, 0.034981682896614075, 0.004455736372619867, -0.03404071927070618, 0.027772245928645134, -0.015235298313200474, -0.00905676931142807, 0.024700278416275978, -0.031162479892373085, -0.005213350057601929, -0.01790597289800644, 0.000693181820679456, 0.027094200253486633, -0.037223391234874725, -0.002233057515695691, 0.020203029736876488, 0.04120864346623421, 0.022679975256323814, 0.026153236627578735, 0.008987580426037312, -0.012530029751360416, 0.038496457040309906, -0.027011172845959663, -0.005317132920026779, -0.007942834869027138, -0.00396795803681016, -0.03334883600473404, -0.0032553167548030615, -0.008932230062782764, -0.02804899960756302, 0.0011130692437291145, 0.033459536731243134, -0.011423014104366302, 0.01751851662993431, 0.029086826369166374, 0.006821981631219387, -0.003881472395732999, -0.007811376824975014, -0.0017262520268559456, 0.006911926902830601, 0.00971405953168869, 0.038634832948446274, -0.04663302004337311, -0.007707593962550163, -0.01879158429801464, 0.02858866937458515, 0.0071402485482394695, 0.041513074189424515, 0.02786911092698574, 0.01122236717492342, -0.039437420666217804, -0.015512051992118359, 0.008364884182810783, 0.0032466682605445385, 0.01607939787209034, 0.019884761422872543, 0.024921681731939316, -0.004037146456539631, -0.013982987031340599, -0.002001276006922126, -0.02086723782122135, -0.001864628866314888, -0.014861680567264557, -0.016231611371040344, 0.035618215799331665, -0.007548460736870766, 0.004542222246527672, -0.008475585840642452, -0.024672603234648705, -0.0014347955584526062, -0.02346872352063656, -0.02074269950389862, 0.031245507299900055, 0.007908240891993046, 0.003129048040136695, -0.015373675152659416, 0.041263993829488754, -0.034594226628541946, 0.0031809392385184765, -0.015498214401304722, -0.024119095876812935, -0.007133329752832651, -0.00513378344476223, -0.007361651863902807, 0.020424433052539825, -0.013180401176214218, -0.013982987031340599, 0.0041616857051849365, 0.02608404867351055, -0.004704814869910479, -0.00750002870336175, -0.002016843529418111, 0.007832133211195469, 0.0736718699336052, -0.006635172758251429, -0.038081325590610504, -0.015470539219677448, -0.02193273976445198, 0.03398536890745163, -0.0049642715603113174, -0.0047982195392251015, -0.013477911241352558, -0.002791754202917218, 0.0026966200675815344, 0.0254060011357069, -0.01887461170554161, 0.015027732588350773, 0.022707650437951088, -0.016577554866671562, -0.0065798223949968815, 0.028699371963739395, 0.01883309707045555, -0.005870640277862549, 0.026803607121109962, 0.008205750957131386, -0.007264787796884775, 2.118896554748062e-05, -0.01942811906337738, 0.007672999985516071, -0.01760154403746128, 0.012592298910021782, 0.01827958971261978, 0.023980718106031418, 0.004843191709369421, -0.03127318248152733, -0.04646696895360947, -0.017726082354784012, -0.0006884251488372684, 0.0005275619914755225, -0.014183633960783482, 0.026872796937823296, 0.021185506135225296, -0.004462655633687973, -0.005393240135163069, 0.03636545315384865, -0.0014218228170648217, 0.016563717275857925, -0.026374639943242073, -0.03362559154629707, 0.01266148779541254, 0.0095480065792799, 0.006237339228391647, 0.020203029736876488, -0.01870855875313282, 0.007012249901890755, 0.015373675152659416, -0.019926276057958603, 0.011118585243821144, -0.03492633253335953, 0.009423467330634594, 0.02922520413994789, 0.007368570659309626, 0.0025893780402839184, -0.038883913308382034, -0.003141155932098627, -0.02476946823298931, 0.019026825204491615, -0.026692906394600868, -0.04522157460451126, -0.0023524074349552393, 0.0176845695823431, -0.010046163573861122, 0.0021880848798900843, -0.03312743455171585, 0.007119492162019014, 0.016107073053717613, 0.007493109907954931, 0.030913401395082474, 0.008537855930626392, 0.032767653465270996, 0.032684627920389175, 0.018680883571505547, 0.043976183980703354, -0.0049123805947601795, -0.02647150307893753, -0.016217773780226707, -0.0046667614951729774, 0.01223943755030632, -0.0002447541628498584, 0.02353791333734989, 0.003992173820734024, -0.004556059837341309, 0.034677255898714066, -0.02766154520213604, -0.025004707276821136, 0.025945670902729034, 0.0009634492453187704, -0.025143085047602654, -0.013194238767027855, -0.027550842612981796, -0.005759939085692167, 0.021863551810383797, -0.02215414308011532, -0.010032325983047485, 0.0024042988661676645, -0.013083537109196186, 0.0012575001455843449, -0.014598764479160309, -0.013858447782695293, -0.04845959320664406, -0.02928055450320244, 0.028644021600484848, 0.02554437890648842, -0.0021137073636054993, -0.0011364204110577703, 0.012329382821917534, 0.005289457272738218, -0.006939602084457874, 0.014294334687292576, -0.017919810488820076, 0.019967788830399513, -0.014294334687292576, -0.01667441800236702, 0.020521296188235283, 0.01998162642121315, 0.014792491681873798, -0.0021413827780634165, -0.011831225827336311, 0.009748653508722782, -0.027523167431354523, -0.013221913948655128, -0.04782306030392647, 0.00833720900118351, 0.016868146136403084, 0.0003433477249927819, 0.022901378571987152, 0.00035610434133559465, 0.03940974548459053, 0.04522157460451126, -0.002414677059277892, -0.0020393298473209143, 0.011713605374097824, -0.0027242954820394516, -0.007963591255247593, 0.02727408893406391, -0.015456700697541237, 0.018168888986110687, 0.001371661201119423, -0.008662394247949123, 0.0033850453328341246, -0.007112573366612196, 3.848607957479544e-05, -0.00844099186360836, -0.004542222246527672, -0.0004683193692471832, 0.0013318777782842517, 0.039935577660799026, 0.013484830036759377, 0.0190960131585598, 0.0020635456312447786, 0.028394943103194237, 0.01179663185030222, 0.02197425439953804, 0.00971405953168869, -0.011270799674093723, -0.02566891722381115, 0.009195146150887012, 0.042398687452077866, -0.0010940424399450421, -0.025558216497302055, -0.01138842012733221, 0.008883797563612461, 0.013235751539468765, 0.012363976798951626, 0.0076453243382275105, -0.0005721020279452205, 0.010578914545476437, -0.02189122699201107, -0.0007377219153568149, -0.020908750593662262, 0.04937288165092468, -0.012280951254069805, -0.008171156980097294, -0.00935427937656641, -0.007887483574450016, 0.007354733068495989, -0.00732013862580061, -0.0013318777782842517, 0.010246810503304005, 0.018999150022864342, 0.004120172467082739, 0.01397606823593378, 0.001353499130345881, 0.018611695617437363, -0.017767595127224922, 0.026028696447610855, 0.008876878768205643, 0.04815516620874405, 0.027287926524877548, 0.01756002940237522, 0.03783224895596504, 0.03866250813007355, 0.018348777666687965, -0.02583497017621994, -0.019649522379040718, 0.004524925258010626, -0.0445573665201664, 0.0028886180371046066, 0.00787364598363638, -0.016812795773148537, -0.02936358004808426, 0.010648103430867195, -0.004822435323148966, 0.027592357248067856, 0.005247944500297308, 0.008247263729572296, 0.008468667045235634, -0.0071886805817484856, -0.005925991106778383, 0.014806329272687435, 0.024119095876812935, -0.028837747871875763, -0.0022123008966445923, -0.012668406590819359, 0.003428288036957383, 0.0354798398911953, -0.015761129558086395, -0.007569217123091221, -0.006185447797179222, -0.009582601487636566, 0.003843418788164854, -0.002800402697175741, 0.010807236656546593, -0.02150377258658409, -0.008496342226862907, -0.0014944706344977021, -0.008489423431456089, 0.03185436502099037, -0.010945613496005535, 0.0036808259319514036, -0.03326581045985222, -0.0018058187561109662, 0.013823853805661201, 0.003305478487163782, 0.012938241474330425, 0.006313446443527937, 0.0004205360892228782, -0.007105654571205378, 0.02786911092698574, 0.018570180982351303, 0.03071967512369156, -0.022901378571987152, 0.012433165684342384, -0.02944660745561123, 0.00884920358657837, -0.00637571606785059, -0.03990790247917175, 0.01969103515148163, -0.009077525697648525, 0.0017651704838499427, -0.01026756688952446, 0.037140361964702606, 0.02541983872652054, -0.016356151551008224, 0.011602903716266155, 0.007019168697297573, -0.0029924006666988134, -0.028477968648076057, 0.018044348806142807, -0.014806329272687435, 0.00818499457091093, -0.010744967497885227, -0.011568309739232063, -0.0261393990367651, 0.02014767751097679, -0.02418828383088112, -0.004255089908838272, -0.0034922873601317406, 0.004234333522617817, 0.021918902173638344, 0.016273124143481255, -0.03384699299931526, -0.004338116385042667, 0.02018919214606285, -0.009243577718734741, 0.011921171098947525, -0.02600102126598358, 0.0016501446953043342, 0.01591334491968155, 0.0011312313145026565, 0.0065313903614878654, 0.026762094348669052, -0.001655333791859448, 0.014626439660787582, 0.011049396358430386, 0.009534168988466263, -0.020036976784467697, -0.03899461403489113, 0.00903601199388504, -0.007209436967968941, -0.0020964101422578096, -0.027979811653494835, -9.924219193635508e-05, -0.0010464753722772002, 0.009125957265496254, -0.005818749312311411, -0.005434753373265266, 0.012903647497296333, 0.03747246786952019, -0.011056315153837204, 0.06415153294801712, 0.02150377258658409, 0.030055465176701546, -0.003725798334926367, -0.015318323858082294, -0.010087677277624607, 0.003260506084188819, -0.0024942439049482346, 0.03096875362098217, -0.022666137665510178, 0.026042534038424492, -0.04430828616023064, 0.048514947295188904, -0.02677593193948269, -0.0036531505174934864, 0.002049708040431142, -0.01603788323700428, 0.027772245928645134, 0.0032674248795956373, 0.004251630511134863, 0.022472411394119263, 0.009423467330634594, -0.023427210748195648, 0.025738105177879333, 0.023178132250905037, 0.014294334687292576, -0.003449044656008482, -0.006635172758251429, 0.039686497300863266, 0.015788806602358818, 0.04176215082406998, 0.023358022794127464, -0.048680998384952545, -0.04292451962828636, 0.018307264894247055, -0.015456700697541237, -0.018860772252082825, 0.008613962680101395, 0.005528157576918602, -0.03639312833547592, -0.016854308545589447, -0.004102875478565693, -0.01963568478822708, 0.030193842947483063, 0.03063664771616459, 0.03492633253335953, 0.017809107899665833, 0.032435547560453415, 0.013782340101897717, 0.00027026739553548396, -0.0016804146580398083, -0.021697500720620155, 0.002611864125356078, 0.011519878171384335, -0.009499575011432171, 0.02523994818329811, 0.022901378571987152, 0.009112119674682617, -0.02189122699201107, 0.0018040889408439398, -0.00538632133975625, -0.0041616857051849365, -0.029584983363747597, -0.003729257732629776, 0.03033221885561943, 0.022251008078455925, 0.018777746707201004, -0.013194238767027855, -0.027675382792949677, -0.028145864605903625, -0.007603811100125313, 0.0019528442062437534, -0.01300051063299179, 0.0068600354716181755, -0.02889310009777546, -0.018528668209910393, -0.01895763725042343, -0.011609822511672974, 0.004255089908838272, -0.022596949711441994, 0.06105189397931099, -0.021102478727698326]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
"parQ (Triton, 1×K)
SparQ (PyTorch)
SparQ (Triton)Figure 5: Microbenchmark results for batch size 64,32
heads, dh= 128 ,r= 32 ,k= 128 , A100(40GB).
and H 2O are configured to maintain a fixed compression
ratio versus the dense baseline (keeping r= 32 and modi-
fying kto maintain 1/4compression), showing that SparQ
Attention is scalable to large sequences.
6. Benchmarking
The results above use a theoretical cost model of total mem-
ory transfers, allowing us to evaluate SparQ Attention in-
dependently of a specific hardware setup. To validate this
approach, we performed a set of microbenchmarks of an
attention operation in isolation.
SparQ Attention benefits from two optimisations. The first
is to store Ktwice, in both dh-contiguous and S-contiguous
layouts, since this allows for an efficient gather (indexing)
on either axis, at the cost of 50% extra memory usage. The
second optimisation is to use a fused gather-then-matmul
operation to avoid writing the result of the gather to memory.
We tested multiple implementations of baseline and SparQ
Attention on IPU using the Poplar C++ interface and GPU
using PyTorch (Paszke et al., 2019). In all cases, we used
the Llama 7B shape parameters: 32heads, dh= 128 . The
implementations tested were: Dense baseline, choosing the
faster of a plain PyTorch implementation and the builtin
scaleddotproduct attention ,SparQ (Triton) ,
storing Ktwice & using fused gather-then-matmul kernels
written using Triton (Tillet et al., 2019), SparQ (PyTorch) ,
with no Triton and SparQ (Triton, 1×K), storing Kindh-
contiguous layout only, for no additional memory cost. In an
example configuration running on a single IPU from a Bow
Pod16, batch size 1, sequence length S= 16384 , the dense
baseline achieves 40.4 ms/query, while SparQ (r= 32 ,
k= 128 ) achieves 5.28 ms/query for a speedup of 7.41×
(the theoretical speedup of SparQ is 7.53×). This near-
perfect speedup is achieved because attention is strongly
memory bound when using remote memory. In contrast, the
baseline running in local SRAM takes 134µs for a 345×
speedup, but this is only practically achievable when the
whole model fits in SRAM.
7
SparQ Attention: Bandwidth-Efficient LLM Inference
Table 3: GPU performance with batch size 64, sequence
length S= 4096 ,r= 32 ,k= 128 . The theoretical speed-
up is 6.4×.
Kernel A100 (40GB) A10G
Dense 49 µs (1×) 128 µs (1×)
SparQ (Triton, 1×K) 38 µs (1.28×) 79 µs (1.63×)
SparQ (PyTorch) 37 µs (1.33×) 78 µs (1.63×)
SparQ (Triton) 16µs(3.02×)31µs(4.17×)
Our achieved GPU speed-ups are presented in Table 3, and
the performance trend with sequence length is shown in
Figure 5. Standard error for all results given is <1%of the
mean. See Appendix E for further details.
These microbenchmark results show that the theoretical ben-
efits of SparQ Attention can yield substantial wall-clock
time speedups on current hardware. Further work is needed
to show improvements for small batch size, and to investi-
gate alternatives to storing Ktwice.
7. Related Work
Efficient attention methods have been a very active area
of research (Tay et al., 2020b). Schemes such as Sparse
Transformers (Child et al., 2019), Combiner (Ren et al.,
2021), Longformer (Beltagy et al., 2020), BigBird (Zaheer
et al., 2020), Reformer (Kitaev et al., 2020) and Sparse
Sinkhorn Attention (Tay et al., 2020a) have been developed
to increase efficiency of the attention mechanism by ex-
","[0.020501356571912766, 0.027499916031956673, 0.051227375864982605, 0.013749958015978336, -0.013171081431210041, -0.005213146563619375, -0.006309110205620527, 0.026407204568386078, -0.019824916496872902, 0.0055871400982141495, -0.0006089592352509499, -0.016143517568707466, -0.0126052126288414, 0.026355169713497162, 0.01101167406886816, -0.01267675869166851, 0.01667686551809311, -0.058642204850912094, -0.0016081727808341384, 0.01596139930188656, -0.045191440731287, -0.004809883888810873, 0.0018390731420367956, 0.030257713049650192, 0.010452309623360634, -0.010452309623360634, -0.009840911254286766, 0.004195233341306448, 0.03585135564208031, -0.05401118844747543, 0.044541019946336746, -0.024104705080389977, -0.04199135676026344, -0.052085936069488525, 0.0008634375408291817, 0.07019373029470444, -0.01028319913893938, 0.02768203429877758, -0.04737686738371849, 0.0135548310354352, -0.0035383051726967096, -0.03520093485713005, -0.06140000373125076, 0.015402034856379032, 0.009177478961646557, -0.0073562925681471825, -0.0013032866409048438, -0.029503220692276955, 0.005772511009126902, 0.07414830476045609, -0.039467714726924896, 0.06030729040503502, -0.06400169432163239, 0.023155085742473602, 0.0367879681289196, 0.0027447883039712906, 0.004878178238868713, 0.029893476516008377, 0.0513574592769146, -0.007915657013654709, 0.03639771416783333, -0.01639067940413952, 0.0225957203656435, -0.00699205556884408, -0.03056991659104824, 0.017626482993364334, -0.0271096620708704, 0.03228703513741493, 0.01420525461435318, 0.004185476806014776, -0.0024960010778158903, 0.04956229031085968, 0.011649089865386486, -0.02158105932176113, 0.02755195088684559, -0.003034226829186082, 0.02086559496819973, 0.03592940792441368, 0.018498051911592484, 0.005756250116974115, 0.03837500140070915, -0.022673772647976875, 0.03496678173542023, -0.005200137849897146, -0.0016187421279028058, -0.03213093429803848, -0.02828042581677437, -0.028228390961885452, -0.018289916217327118, 0.004972489550709724, -0.022075382992625237, 0.021776188164949417, -0.016585806384682655, -0.010660445317626, 0.04110678285360336, 0.04857364669442177, 0.03132440894842148, -0.008722182363271713, 0.011616568081080914, 0.08320220559835434, 0.04162712022662163, 0.029945509508252144, 0.014959746040403843, -0.03954576328396797, 0.025717755779623985, -0.019096441566944122, 0.002309004310518503, 0.006621313747018576, 0.012774322181940079, 0.0072457208298146725, -0.05432339385151863, -0.013112543150782585, -0.037178222090005875, 0.03798474743962288, -0.0056814514100551605, -0.054687630385160446, -0.019889958202838898, 0.014153220690786839, -0.017171187326312065, 0.04144500195980072, -0.007993708364665508, 0.03603347763419151, 0.024807162582874298, 0.00416596420109272, 0.02882678061723709, -0.03132440894842148, 0.04750695079565048, -0.06254474818706512, 0.02335021272301674, -0.01780860312283039, 0.039467714726924896, 0.0020179396960884333, 0.03967585042119026, 0.012201949954032898, 0.038322966545820236, -0.04019618779420853, -0.052554238587617874, 0.02116478979587555, -0.03405618667602539, -0.009275042451918125, -0.0013341817539185286, 0.01094012800604105, 0.005873326677829027, 0.04105474799871445, -0.031376443803310394, 0.03686601668596268, -0.022374577820301056, 0.007473369129002094, -0.01232552994042635, 0.032391104847192764, 0.004087913315743208, -0.013580848462879658, -0.06639526039361954, -0.0021447723265737295, -0.023246144875884056, -0.018953347578644753, -0.025860847905278206, 0.03533101826906204, -0.012533665634691715, -0.0486777126789093, 0.014777627773582935, -0.003915551118552685, 0.004995254334062338, -0.009827902540564537, -0.0014415016630664468, 0.032547205686569214, -0.06457407027482986, -0.00438385596498847, -0.07971593737602234, -0.04651830717921257, 0.009528707712888718, -0.016143517568707466, -0.00941163208335638, -0.03184474632143974, 0.03207889944314957, -0.0026277119759470224, -0.05338678136467934, 0.02669339068233967, -0.03410822153091431, -0.056456781923770905, 0.0014284931821748614, 0.007200190797448158, -0.007661991752684116, 0.006156261079013348, -0.0004187102895230055, -0.018081780523061752, -0.04329220578074455, 1.364365471090423e-05, 0.01653377152979374, 0.02955525554716587, -0.010627924464643002, 0.03517491742968559, 0.023011991754174232, 0.030908137559890747, -0.009886440820991993, -0.041809238493442535, 0.046154070645570755, 0.02247864566743374, -0.01217593252658844, -0.020982669666409492, 0.0024927491322159767, 0.006091218441724777, 0.016052458435297012, -0.050941187888383865, 0.0455036461353302, -0.0003327323938719928, -0.010003517381846905, -0.01268976740539074, -0.0542193241417408, -0.02898288331925869, 0.02986745908856392, 0.03103822097182274, 0.044853221625089645, -0.012579195201396942, -0.031350426375865936, -0.014712585136294365, -0.021086737513542175, 0.017886653542518616, 0.011701123788952827, 0.04685652628540993, 0.02610800974071026, -0.0011236070422455668, 0.01843300834298134, 0.051955848932266235, -0.04815737530589104, 0.05869423970580101, 0.04623211920261383, -0.01057589054107666, -0.0012414962984621525, -0.03314559534192085, -0.016286611557006836, 0.007564428262412548, -0.006445699371397495, -0.013216610997915268, 0.001723622903227806, -0.05765356123447418, 0.046570342034101486, -0.015141865238547325, -0.0004935089964419603, -0.07487678527832031, 0.011232818476855755, -0.0178346186876297, 0.00453345337882638, -0.0020407044794410467, -0.016260594129562378, 0.014725593850016594, -0.0076164621859788895, -0.039467714726924896, 0.028956865891814232, 0.02316809445619583, -0.023103050887584686, -0.0252104252576828, -0.05567627400159836, -0.012728792615234852, -0.05380305275321007, -0.02755195088684559, -0.020345255732536316, 0.04308407008647919, -0.015180890448391438, 0.02435186505317688, -0.028488559648394585, -0.0047090682201087475, -0.012214957736432552, 0.006162764970213175, 0.006868474651128054, -0.0035773306153714657, 0.012917416170239449, 0.03465457633137703, -0.021385932341217995, -0.02041029743850231, 0.00591235188767314, 0.0039025426376610994, 0.025535637512803078, 0.011232818476855755, -0.021346908062696457, 0.011284852400422096, 0.0008040863904170692, -0.03197483345866203, -0.025249449536204338, 0.01813381351530552, 0.013359704054892063, 0.017769576981663704, 0.06790424138307571, 0.007265233434736729, -0.005252171773463488, -0.002014687517657876, 0.02345428057014942, -0.02958127297461033, -0.00921000074595213, -0.0010382388718426228, 0.024807162582874298, -0.026563305407762527, 0.02318110316991806, 0.0013431250117719173, 0.03634567931294441, -0.019382627680897713, 0.0006996120791882277, -0.016689874231815338, 0.0266413576900959, -0.02305101789534092, 0.032521188259124756, 0.006169269327074289, 0.06171220541000366, -0.027473898604512215, 0.01853707619011402, 0.006575784180313349, -0.055728308856487274, -0.0016512633301317692, -0.02146398462355137, 0.022985976189374924, -0.027630001306533813, -0.00984741561114788, -0.018758220598101616, 0.012702776119112968, -0.0353570356965065, -0.02669339068233967, 0.026134027168154716, -0.014738602563738823, 0.02638118714094162, -0.012670254334807396, -0.02565271221101284, -0.08200542628765106, -0.017171187326312065, 0.0169630516320467, 0.05723728984594345, -0.04141898453235626, -0.0271096620708704, 0.0023854291066527367, -0.0044066207483410835, 6.123130151536316e-05, 0.038635171949863434, -0.005756250116974115, 0.0009390492923557758, -0.01827690750360489, -0.05749746039509773, 0.028722712770104408, 0.009105932898819447, -0.01087508536875248, -0.0025642956607043743, 0.0271096620708704, -0.08112084865570068, -0.005502584856003523, -0.03579932451248169, 0.01753542385995388, -0.006169269327074289, 0.005239163525402546, 0.03468059375882149, -0.0016634587664157152, 0.055728308856487274, -0.012052352540194988, 0.016637839376926422, 0.012546674348413944, 0.051071275025606155, -0.06015118956565857, 0.014764619059860706, -0.010153114795684814, -0.005144851747900248, -0.0662911906838417, -0.018081780523061752, -0.002728527644649148, -0.029815424233675003, 0.03041381575167179, 0.03145449236035347, -0.017886653542518616, 0.042537715286016464, 0.013801991939544678, -0.05219000205397606, 0.06618712097406387, 0.022504661232233047, 0.003935063723474741, 0.033249661326408386, 0.06790424138307571, 0.00019634667842183262, -0.03452449291944504, -0.039493732154369354, -0.011603559367358685, 0.005707468371838331, 0.056456781923770905, -0.010823051445186138, 0.02156805247068405, -0.0012870259815827012, 0.04378652572631836, -0.010634428821504116, -0.010484831407666206, 0.04040432348847389, -0.007635974790900946, 0.025106357410550117, 0.007766059599816799, -0.10188237577676773, -0.009034385904669762, -0.017327288165688515, 0.0029334111604839563, -0.02390957809984684, 0.01001002173870802, -0.022218475118279457, 0.027213729918003082, 0.004468411207199097, 0.019798899069428444, 0.04464508593082428, 0.03925957903265953, -0.012624724768102169, 0.012670254334807396, -0.01094663143157959, -0.005983898416161537, 0.03808881342411041, 0.021633094176650047, 0.011844216845929623, 0.03954576328396797, 0.018341949209570885, -0.021802203729748726, 0.05713322386145592, -0.04274585098028183, 0.02550962008535862, -0.022244492545723915, 0.009853919968008995, -0.039623815566301346, -0.050056613981723785, 0.0169630516320467, -0.01566220447421074, 0.05765356123447418, -0.025587670505046844, -0.04526949301362038, -0.020462332293391228, 0.0034537501633167267, -0.04623211920261383, 0.015467076562345028, 0.015310974791646004, -0.07461661100387573, 0.05364695191383362, -0.014894704334437847, -0.0611918680369854, 0.029086951166391373, 0.0631171241402626, -0.02669339068233967, -0.05143551155924797, -0.0218802560120821, -0.023818517103791237, 0.0640537291765213, 0.0027789354790002108, -0.048651695251464844, -0.010484831407666206, -0.0356692373752594, 0.008897797204554081, 0.022556696087121964, -0.0333016961812973, -0.006039184518158436, -0.010055551305413246, -0.005427786149084568, 0.026042968034744263, -0.048599664121866226, -0.00034635065821930766, 0.014192245900630951, 0.04940618947148323, 0.017028093338012695, 0.0007406700751744211, -0.037906695157289505, 0.07732237875461578, -0.013671907596290112, 0.02446894161403179, -0.026875508949160576, 0.04927610233426094, -0.023376230150461197, -0.03837500140070915, -0.01275481004267931, 0.0027610487304627895, 0.008748199790716171, 0.035591188818216324, 0.03434237465262413, 0.028384491801261902, 0.018354957923293114, 0.021125763654708862, -0.015402034856379032, -0.013867034576833248, -0.04490525647997856, -0.03127237409353256, -0.003694406943395734, 0.020813560113310814, -0.00017632581875659525, 0.00197566207498312, -0.01463453471660614, 0.009905953891575336, -0.04292796924710274, 0.009366102516651154, 0.041653137654066086, 0.013171081431210041, 0.05510390177369118, 0.06686355918645859, -0.0007988016586750746, -0.016429703682661057, -0.0024992532562464476, -0.03244313597679138, -0.017730550840497017, 0.04071652889251709, -0.01325563620775938, 0.0135548310354352, -0.00018760660896077752, -0.023233136162161827, 0.008988856337964535, 0.017444364726543427, -0.03207889944314957, 0.041497036814689636, 0.005990402773022652, 0.03418627381324768, 0.006790424231439829, -0.010172627866268158, 0.005476567894220352, 0.033978138118982315, 0.016481738537549973, -0.03899940848350525, -0.004546462092548609, 0.01710614562034607, -0.0009146584197878838, 0.02955525554716587, 0.03983195126056671, 0.014530466869473457, 0.030908137559890747, 0.005375752225518227, -0.004988749977201223, -0.02246563695371151, 0.02113877236843109, -0.008136801421642303, -0.017613476142287254, -0.005687955766916275, 0.009938474744558334, 0.005372500047087669, -0.023883560672402382, -0.05333474650979042, -0.10073763132095337, -0.03028373047709465, -0.06780017167329788, 0.00040590506978332996, -0.028306441381573677, 0.005671695340424776, -0.013867034576833248, -0.056300681084394455, -0.023987628519535065, -0.004409872926771641, -0.02258271351456642, -0.0697774589061737, 0.015454068779945374, 0.017912670969963074, -0.0003278542135376483, -0.009541716426610947, 0.006234311498701572, 0.008722182363271713, -0.020033052191138268, 0.040950678288936615, -0.005057044792920351, -0.01217593252658844, 0.00819533970206976, 0.01094663143157959, -0.01754843257367611, 0.010907606221735477, 0.012084873393177986, -0.014725593850016594, -0.0026130774058401585, 0.00042927966569550335, 0.026719408109784126, -0.0169630516320467, -0.010387266986072063, 0.03421229124069214, -0.009938474744558334, -0.04409873113036156, -0.030231695622205734, -0.017145169898867607, 0.04940618947148323, 0.01391906850039959, -0.0539071224629879, -0.005606652703136206, 0.018615128472447395, -0.02436487376689911, 0.0010349868098273873, 0.010530360974371433, -0.03322364389896393, 0.005983898416161537, -0.012936928309500217, -0.013249131850898266, 0.008579089306294918, -0.02651127241551876, 0.019642798230051994, -0.03988398611545563, -0.023363221436738968, 0.0010967770358547568, 0.012611716985702515, -0.030752034857869148, 0.008026229217648506, -0.0059708901681005955, 0.024273814633488655, -0.02028021216392517, 0.04206940904259682, 0.03858313709497452, -0.009600254707038403, 0.028306441381573677, -0.0061887819319963455, -0.019343603402376175, -0.03301550820469856, -0.01564919576048851, -0.01856309361755848, -0.03938966244459152, 0.023675424978137016, -0.0030212183482944965, 0.0285405945032835, 0.009385614655911922, -0.022803856059908867, -0.02160707674920559, 0.04287593439221382, -0.02436487376689911, 0.014348347671329975, 0.009092924185097218, -0.00023964050342328846, -0.0026488506700843573, -0.010380763560533524, -0.02739584818482399, -0.0023008740972727537, -0.038765255361795425, 0.006914004683494568, -0.022348560392856598, -0.006257076747715473, 0.020748518407344818, -0.003791970433667302, 0.001443940680474043, -0.037022121250629425, -0.0041594598442316055, 0.030387798324227333, 0.00015091864042915404, 0.027291780337691307, -0.0018602119525894523, -0.037464410066604614, -0.010348241776227951, 0.00869616586714983, -0.04402067884802818, -0.008650636300444603, 0.0045594703406095505, 0.02012411132454872, -0.034290339797735214, 0.025769788771867752, 0.027031611651182175, 0.012514153495430946, 0.04607601836323738, 0.013762966729700565, 0.010491334833204746, 0.018927332013845444, -0.001155315199866891, -0.01607847586274147, 0.011681610718369484, 0.007018072530627251, -0.0183939840644598, 0.004204989410936832, -0.004783866927027702, -0.017444364726543427, -0.03421229124069214, -0.03912949189543724, 0.0634293258190155, 0.022231483832001686, 0.04271983355283737, -0.024885213002562523, -0.04350034147500992, -0.046752460300922394, 0.005850561894476414, -0.006283093709498644, -0.060203224420547485, 0.009301059879362583, -0.027499916031956673, -0.038635171949863434, 0.0024098199792206287, 0.010972648859024048, 0.01152550894767046, 0.011382415890693665, 0.010244173929095268, -0.03202686458826065, 0.018211865797638893, -0.012097882106900215, 0.04605000093579292, 0.0004719637508969754, 0.017886653542518616, -0.027343815192580223, 4.97726614412386e-05, -0.016468729823827744, 0.004683051258325577, 0.04087262973189354, -0.03382203355431557, 0.03314559534192085, -0.04857364669442177, 0.005076557397842407, -0.002380550839006901, 0.007863623090088367, -0.0009544968488626182, 0.02030622959136963, 0.021411949768662453, -0.00025224246201105416, 0.0020992427598685026, 0.004244015086442232, 0.032677289098501205, -0.032833389937877655, -0.008260381408035755, -0.0011049073655158281, 0.0022049364633858204, 0.06192034110426903, -0.025249449536204338, -0.06540661305189133, -0.010354746133089066, 0.03314559534192085, -0.010992161929607391, -0.01900538243353367, 0.021359916776418686, -0.04097669571638107, 0.013567839749157429, 0.022660763934254646, 0.04784516990184784, -0.006946525536477566, -0.030465848743915558, 0.0036228604149073362, -0.0013431250117719173, 0.006575784180313349, -0.009183983318507671, 0.004068400710821152, 0.004718824289739132, 0.015532119199633598, -0.019330594688653946, 0.011304364539682865, -0.018068771809339523, 7.073358574416488e-05, -0.011148262768983841, -0.018810255452990532, 0.022972967475652695, -0.0055871400982141495, 0.009749852120876312, -0.0027447883039712906, 0.025132374837994576, 0.0608796626329422, 0.02389656938612461, 0.02202334813773632, -0.003279761876910925, -0.0321829691529274, -0.015454068779945374, 0.004162712022662163, -0.05187780037522316, 0.004182224627584219, -0.0218802560120821, -0.007870127446949482, 0.028592627495527267, -0.031246356666088104, -0.001240683370269835, 0.04290195181965828, 0.004003358073532581, 0.004539957735687494, 0.00926203466951847, 0.020267203450202942, -0.0015350000467151403, -0.01900538243353367, -0.02232254296541214, 0.011831208132207394, 0.026042968034744263, 0.03197483345866203, -0.0014284931821748614, -0.0356692373752594, 0.011154767125844955, -0.026186060160398483, 0.017899662256240845, 0.029191019013524055, -0.014465424232184887, -0.015727246180176735, -0.018901314586400986, 0.004920455627143383, -0.006159512791782618, -0.01683296635746956, 0.014062161557376385, -0.03228703513741493, 0.004152955487370491, 0.009912458248436451, 0.0015837817918509245, -0.0028943857178092003, 0.010400275699794292, 0.021984323859214783, 0.03767254576086998, -0.013372712768614292, 0.013958093710243702, -0.004087913315743208, 0.01956474594771862, 0.03072601743042469, -0.0009463665774092078, -0.01319059357047081, -0.017769576981663704, -0.014777627773582935, -0.026459237560629845, -0.026719408109784126, -0.023246144875884056, 0.0029821929056197405, -0.027265764772892, -0.011284852400422096, -0.03416025638580322, -0.007213199511170387, -0.04097669571638107, 0.0028244650457054377, 0.010237669572234154, 0.004595243837684393, -0.0072522247210145, -0.10578492283821106, -0.024416908621788025, 0.035565171390771866, -0.028748730197548866, 0.021385932341217995, -0.008878284133970737, 0.005840805359184742, 0.013867034576833248, 0.024885213002562523, 0.001230926951393485, 0.030986187979578972, -0.03637169674038887, -0.017145169898867607, -0.005808284040540457, 0.01361987367272377, -0.027942204847931862, 0.0015691473381593823, -0.010692966170608997, 0.03777661174535751, -0.0304398313164711, -0.011538517661392689, -0.0003237890778109431, 0.0058473097160458565, 0.04464508593082428, -0.015675213187932968, -0.02087860181927681, -0.020462332293391228, 0.007785572204738855, 0.006068453658372164, 0.013801991939544678, -0.009515699930489063, 0.004331822041422129, 0.01784762740135193, 0.04206940904259682, -0.043994661420583725, 0.02015012875199318, -0.01826389878988266, 0.03827093541622162, 0.026875508949160576, 0.016911016777157784, -0.03579932451248169, -0.03145449236035347, 0.022140424698591232, -0.018810255452990532, 0.02190627157688141, -0.016898009926080704, 0.038921356201171875, 0.011447458527982235, 0.011519004590809345, 0.016338644549250603, 0.001354507519863546, -0.016468729823827744, 0.013867034576833248, 0.053100597113370895, -0.009957987815141678, -0.008429491892457008, -0.011505995877087116, -0.01752241514623165, 0.004221250303089619, 0.023714449256658554, -0.00710262730717659, 0.028072290122509003, 0.04651830717921257, 0.0031626855488866568, -0.020969662815332413, -0.030361780896782875, 0.01944766938686371, 0.012546674348413944, 0.026719408109784126, -0.013411737978458405, 0.009723834693431854, 0.004637521225959063, 0.0016764672473073006, -0.007031080778688192, 0.01086207665503025, -0.000717498711310327, -0.003668389981612563, 0.021685127168893814, -0.04175720363855362, -0.0007727846968919039, 0.02013712003827095, -0.05161762982606888, -0.00714165298268199, -0.021672120317816734, -0.0050798095762729645, -0.0025577915366739035, 0.019174491986632347, -0.013249131850898266, 0.010491334833204746, 0.0649903416633606, 0.025106357410550117, -0.011603559367358685, 0.0069855512119829655, -0.01795169524848461, 0.00021077794372104108, 0.007297754753381014, 0.016611821949481964, -0.003255371004343033, 0.05315262824296951, 0.0324951708316803, 0.05026474967598915, 0.021242840215563774, 0.006634322460740805, -0.048495594412088394, -0.013385720551013947, -0.014179238118231297, 0.007538411300629377, -0.022855890914797783, 0.035435087978839874, -0.03285940736532211, -0.0043253181502223015, 0.02159406803548336, 0.00956122949719429, 0.01492072083055973, 0.023948602378368378, -0.0009463665774092078, 0.01972084864974022, -0.014673559926450253, 0.010933623649179935, -0.024533983319997787, 0.016260594129562378, 0.030517881736159325, -0.012702776119112968, 0.001900863484479487, -0.005193633493036032, -0.0524761900305748, -0.016572797670960426, 0.014088178984820843, 0.01044580526649952, 0.02319411188364029, 0.013197097927331924, 0.04084661230444908, 0.010354746133089066, 0.0010918988846242428, 0.008865275420248508, -0.0023155086673796177, 0.039363645017147064, 0.007876631803810596, -0.02448195032775402, 0.03639771416783333, -0.022530678659677505, 0.0005935116787441075, 0.023298179730772972, 0.02653728984296322, 0.0013431250117719173, -0.01072548795491457, 0.022218475118279457, -0.028618644922971725, -0.01740534044802189, 0.008702670224010944, 0.025535637512803078, -0.02968534082174301, 0.01021165307611227, 0.0024212023708969355, -0.005424533970654011, 0.012618220411241055, -0.04110678285360336, -0.004552966449409723, -0.0029756887815892696, 0.03233906999230385, -0.019044406712055206, -0.005512341391295195, 0.03871322050690651, -0.005951377563178539, -0.013710932806134224, -0.007453856058418751, -0.020228179171681404, 0.0011618194403126836, -0.012865382246673107, 0.01427029725164175, 0.01102468278259039, -0.00727824168279767, 0.04128890112042427, 0.04503533989191055, 0.0217241533100605, 0.005769258830696344, 0.005850561894476414, -0.03220898285508156, 0.02215343341231346, 0.02160707674920559, 0.0020130614284425974, 0.006309110205620527, 0.009814894758164883, 0.027916187420487404, 0.03715220466256142, 0.02420877292752266, 0.009502691216766834, 0.0336138978600502, 0.028956865891814232, 0.0033366738352924585, 0.018953347578644753, 0.02939915470778942, -0.044541019946336746, -0.0007008315878920257, -0.0032342320773750544, -0.019603772088885307, 0.030465848743915558, -0.005300953518599272, -0.022725805640220642, 0.0034147247206419706, -0.029451187700033188, 0.033431779593229294, 0.00612699193879962, 0.019616780802607536, -0.017756568267941475, 0.01683296635746956, -0.0006577410385943949, -0.016260594129562378, -0.01211088988929987, 0.021242840215563774, -0.023675424978137016, 0.003359438618645072, -0.007421335205435753, 0.024833178147673607, -0.001767526613548398, 0.01007506437599659, 0.015753263607621193, -0.00489769084379077, -0.0649903416633606, -0.021542035043239594, -0.049796443432569504, -0.023818517103791237, -0.024729110300540924, -0.009255530312657356, 0.0120913777500391, 0.00518062524497509, 0.016156526282429695, -0.017210213467478752, -0.01724923774600029, 0.021411949768662453, 0.014608517289161682, 0.018472034484148026, -0.01008156780153513, 0.0285405945032835, -0.006660339422523975, -0.013697924092411995, -0.01094012800604105, -0.002335021272301674, -0.010699470527470112, 0.023428263142704964, 0.031350426375865936, 0.009899449534714222, 0.016260594129562378, 0.0007146531133912504, -0.003866769140586257, -0.002723649377003312, 0.017496399581432343, 0.016130508854985237, 0.022413602098822594, -0.001517113414593041, 0.001733379322104156, -0.006439195014536381, 0.018511060625314713, -0.013275149278342724, 0.020072076469659805, -0.022101398557424545, -0.006757902912795544, 0.0367879681289196, 0.023233136162161827, 0.015597161836922169, -0.024520976468920708, 0.012644237838685513, -0.017639491707086563, -0.01840699277818203, 0.022946950048208237, -0.005635921843349934, -0.006403421983122826, -0.031376443803310394, -0.007570932619273663, 0.00764247914776206, -0.02723974734544754, -0.00464077340438962, 0.011317373253405094, 0.012579195201396942, -0.006566027645021677, 0.02609500102698803, -0.0028797511477023363, 0.010530360974371433, 0.016000423580408096, 0.004588739480823278, -0.02142495848238468, -0.0038537606596946716, -0.009873433038592339, -0.0021659110207110643, -0.002762674819678068, -0.021359916776418686, -0.04360440745949745, -0.007128644268959761, 0.04831347614526749, -0.017574450001120567, 0.003122034016996622, 0.021776188164949417, 0.005018019117414951, -0.02158105932176113, -0.01723622903227806, -0.0028781250584870577, -0.01224097516387701, 0.011284852400422096, 0.04308407008647919, -0.030075594782829285, 0.000674814626108855, 0.019330594688653946, 0.03697008639574051, -0.006803432479500771, 0.028358476236462593, 0.037178222090005875, -0.005255423951894045, -0.05973491817712784, -0.01869317889213562, 0.013476780615746975, -0.008624618873000145, 0.02320711873471737, 0.002926906803622842, 0.019356610253453255, -0.012136907316744328, 0.004900943022221327, 0.03767254576086998, -0.03918152675032616, -0.0011504370486363769, -0.016780933365225792, 0.002572425873950124, 0.054115258157253265, -0.005918856244534254, 0.0026553550269454718, 0.003948071971535683, -0.010101080872118473, -0.01709313690662384, -0.004764353856444359, -0.020098093897104263, 0.01455648336559534, -0.00026565746520645916, 0.00899536069482565, -0.026550298556685448, 0.02809830568730831, -0.028748730197548866, 0.0027854398358613253, 0.0003061056777369231, -0.01196129247546196, 0.008975847624242306, 0.00941163208335638, 0.012058856897056103, 0.004618008621037006, -0.007915657013654709, -0.02609500102698803, 0.008071758784353733, 0.012871885672211647, -0.008130297064781189, -0.015740254893898964, -0.02129487320780754, 0.013632882386446, 0.05780966207385063, -0.0034017162397503853, -0.022712796926498413, -0.003034226829186082, -0.007811589166522026, 0.050941187888383865, -0.012813348323106766, -0.007037585135549307, -0.04222550988197327, 0.005395264830440283, 0.015115847811102867, 0.01624758541584015, -0.014829661697149277, 0.013567839749157429, 0.012312522158026695, 0.001983792521059513, -0.01809478923678398, 0.03345779702067375, 0.026029959321022034, -0.007564428262412548, 0.028722712770104408, 0.011434449814260006, -0.014504449442029, 0.026771441102027893, -0.02622508630156517, 0.00237404671497643, -0.010758008807897568, 0.011649089865386486, 0.015076822601258755, 0.024820171296596527, 0.033535849303007126, -0.042511697858572006, -0.028046272695064545, -0.01667686551809311, 0.016911016777157784, 0.02695356123149395, -0.03569525480270386, 0.017028093338012695, 0.007122139912098646, -0.009665297344326973, 0.0007561176316812634, 0.013262140564620495, -0.007083114702254534, 0.02262173779308796, -0.024546992033720016, -0.013008475303649902, 0.005951377563178539, 0.02230953425168991, -0.013067013584077358, -0.0021106251515448093, -0.01695004291832447, -0.00034614739706739783, 0.018498051911592484, -0.013060509227216244, 0.02070949226617813, -0.012878390029072762, -0.0009650662541389465, 0.03756847605109215, 0.020969662815332413, 0.0350448302924633, -0.05401118844747543, -0.020982669666409492, -0.014738602563738823, -0.011714131571352482, -0.01693703420460224, -0.04300601780414581, 0.0016065466916188598, 0.009593750350177288, 0.003775710007175803, 0.014075170271098614, -0.01354182232171297, 0.006130244117230177, -0.003694406943395734, 0.010562881827354431, 0.02288190834224224, 0.012650742195546627, 0.015323983505368233, 0.025561653077602386, 0.03670991584658623, 0.030673984438180923, -0.01750940829515457, -0.014010127633810043, -0.002609825227409601, 0.022426610812544823, 0.0012358051026239991, 0.015258940868079662, 0.023129068315029144, -0.01827690750360489, -0.017483390867710114, 0.05317864567041397, 0.006058697123080492, -0.029243052005767822, 0.02289491705596447, -0.006637574639171362, 0.002102494705468416, -0.006631070282310247, -0.04670042544603348, -0.029347119852900505, 0.01580529659986496, -0.025015298277139664, -0.00655952375382185, -0.0039285593666136265, -0.0072457208298146725, -0.008149809204041958, -0.016260594129562378, 0.0003321226395200938, -0.02320711873471737, -0.026160042732954025, 0.018341949209570885, 0.013606864959001541, 0.014439407736063004, 0.015024788677692413, -0.0044196294620633125, 0.009327076375484467, -0.003811483271420002, 0.012234470807015896, 0.009743347764015198, 0.03088212013244629, -0.017756568267941475, -0.028384491801261902, 0.06571881473064423, 0.013867034576833248, 0.011545022018253803, -0.009294555522501469, -0.006546515040099621, -0.0012813347857445478, -0.012260488234460354, -0.004764353856444359, -0.021555043756961823, 0.004878178238868713, 0.009691313840448856, 0.019031399860978127, 0.027942204847931862, -0.0009610010893084109, 0.02955525554716587, 0.054427459836006165, -0.022374577820301056, -0.006770911160856485, 0.01469957735389471, -0.024234788492321968, 0.0008634375408291817, 0.0318707637488842, 0.0005947312456555665, 0.02389656938612461, -0.0011561282444745302, 0.002447219332680106, -0.005935116671025753, -0.01754843257367611, -0.005483072251081467, 0.0013065387029200792, 0.006666843313723803, -0.004504184704273939, 0.004374099895358086, 0.04243364557623863, -0.007297754753381014, 0.006257076747715473, 0.0007321332232095301, -0.01469957735389471, 0.001265074242837727, 0.005115583073347807, 0.005801779683679342, -0.013997118920087814, 0.010257182642817497, -0.0009837659308686852, 0.03408220410346985, -0.01868017017841339, -0.020267203450202942, -0.008891292847692966, 0.012683263048529625, 0.02245262823998928, 0.04230356216430664, 0.012208454310894012, -0.032521188259124756, 0.013275149278342724, -0.03881729021668434, -0.005918856244534254, -0.033848050981760025, 0.02828042581677437, -0.05161762982606888, 0.018628137186169624, -0.021659111604094505, 0.01622156798839569, 0.007844110950827599, -0.015714237466454506, 0.01499877218157053, -0.010894597508013248, -0.004416377283632755, 0.009157966822385788, 0.009567733854055405, 0.00349602778442204, 0.006179025862365961, -0.015050806105136871, 0.033405765891075134, -0.002619581762701273, 0.03697008639574051, 0.04131491854786873, 0.016754915937781334, 0.05276237428188324, 0.027760086581110954, 0.021047713235020638, -0.019603772088885307, -0.030804069712758064, 0.00021585938520729542, -0.02345428057014942, -0.010270191356539726, 0.011519004590809345, -0.011284852400422096, 0.011057203635573387, 0.022855890914797783, -0.002432584762573242, 0.014413390308618546, -0.02089161053299904, -0.03213093429803848, -0.01607847586274147, 0.0001912652369355783, 0.010387266986072063, -0.002551287179812789, 0.03416025638580322, -0.026342162862420082, -0.022192457690835, 0.0035090362653136253, 0.0015959773445501924, 0.040534406900405884, -0.005083061754703522, -0.0328073725104332, 0.007570932619273663, 0.01390605978667736, 0.018081780523061752, -0.02466406859457493, -0.0005016393261030316, -0.028332458809018135, -0.02102169580757618, 0.01551911048591137, -0.007779068313539028, 0.0001797811855794862, -0.014517458155751228, 0.028306441381573677, -0.027577966451644897, -0.010790529660880566, 0.0192655511200428, 0.021281864494085312, 0.01152550894767046, -0.006113983225077391, -0.009418136440217495, -0.009229512885212898, 0.04248568043112755, 0.033535849303007126, 0.026485254988074303, -0.03468059375882149, 0.013424746692180634, -0.042251527309417725, 0.004536705557256937, -0.0037106676027178764, -0.024690086022019386, -0.0014211758971214294, -0.012384068220853806, 0.014803644269704819, -0.01882326416671276, 0.03972788155078888, 0.01914847455918789, -0.0188622884452343, -0.002497627167031169, 0.003136668587103486, 0.01551911048591137, -0.03738635778427124, 0.036007460206747055, -0.029763391241431236, 0.0285405945032835, -0.013450763188302517, -0.015753263607621193, -0.017002077773213387, 0.0009544968488626182, -0.0015179264592006803, -0.0052033900283277035, -0.0016041075577959418, 0.005538358353078365, -0.002146398415789008, 0.02796822227537632, -0.02203635685145855, 0.015441060066223145, 0.0405864417552948, -0.002393559319898486, -5.559090641327202e-05, -0.025301484391093254, 0.00926853809505701, 0.025535637512803078, 0.007213199511170387, 0.009827902540564537, 0.022413602098822594, -0.013034491799771786, 0.02258271351456642, 0.008286398835480213, -0.0020455827470868826, -0.020800551399588585, -0.02000703476369381, -0.006068453658372164, -0.0055871400982141495, -0.011115741916000843, -0.060203224420547485, 0.01390605978667736, -0.002473236294463277, -0.009769365191459656, -0.01853707619011402, -0.0031529292464256287, 0.01855008490383625, 0.01708012819290161, 0.0012764566345140338, 0.07076610624790192, 0.0022293273359537125, 0.030465848743915558, 0.0032391103450208902, -0.020033052191138268, -0.02305101789534092, 0.017860636115074158, 0.006276589352637529, 0.022842882201075554, -0.012123898603022099, 0.026849493384361267, -0.02215343341231346, 0.029659323394298553, -0.005083061754703522, 0.025834832340478897, 0.019798899069428444, -0.011258834972977638, 0.02015012875199318, -0.021255848929286003, 0.007037585135549307, 0.021984323859214783, 0.025535637512803078, -0.001866716193035245, 0.011479979380965233, 0.01914847455918789, 0.03871322050690651, -0.005330222658813, 0.007375805173069239, 0.015506102703511715, -0.003398464061319828, 0.02535351738333702, 0.03894737362861633, -0.03715220466256142, -0.006377405021339655, 0.011050699278712273, -0.025886865332722664, -0.01623457670211792, 0.007525403052568436, 0.007336779963225126, -0.015310974791646004, 0.005460307467728853, -0.012982457876205444, -0.00409766985103488, 0.02653728984296322, 0.01852406933903694, 0.026927543804049492, 0.003931811545044184, 0.017314281314611435, 0.030517881736159325, 0.01624758541584015, -0.006432691123336554, 0.0017984217265620828, 0.00027338124345988035, 0.004055391997098923, -0.0022228232119232416, 0.015545127913355827, 0.03244313597679138, -0.0036326167173683643, -0.01232552994042635, -0.0007927039405331016, 0.014777627773582935, -0.014751610346138477, -0.043266188353300095, 0.0025285223964601755, 0.033249661326408386, 0.014790636487305164, 0.03637169674038887, -0.041809238493442535, -0.04014415293931961, -0.001708988449536264, -0.0030813824851065874, 0.026563305407762527, -0.0009081541793420911, 0.01983792521059513, -0.02971135638654232, -0.01813381351530552, -0.005811536218971014, -0.022218475118279457, 0.00011443393304944038, -0.0002039688260992989, 0.06603101640939713, -0.008923813700675964]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
"tracting information from the most salient tokens in the
sequence or approximating dense attention maps. Two
schemes that reduce memory footprint and data transfer
of the attention operation, while maintaining quadratic com-
plexity are Multi-Query Attention (MQA) (Shazeer, 2019)
andGrouped-Query Attention (GQA) (Ainslie et al., 2023)
that share each KV head across multiple query heads. These
methods form part of the architecture: they must be imple-
mented during pre-training, carry varying task performance
trade-offs, and may affect model quality and stability.
An emerging area of research similar to SparQ Attention
aims to only adapt the inference procedure of a pre-trained
model. The simplest method of this category is part of
FlexGen (Sheng et al., 2023), and calculates exact attention
scores, retrieving only the values associated with the top-
kscores. This process uses the full key cache to produce
attention scores, limiting the asymptotic reduction of the
memory transfers to only 50%. LM-Infinite (Han et al.,
2023) and StreamingLLM (Xiao et al., 2023) employ a
fixed sparsity pattern preserving the most recent tokens and
a few initial tokens for better attention efficiency, but are
not selective in their cache lookup.Eviction schemes cache only a subset of keys and values, by
continually deleting tokens that are uninformative for future
outputs. By reducing the cache size itself, both the amount
of memory used and data transferred are reduced. H2O
(Zhang et al., 2023) and Scissorhands (Liu et al., 2023a)
are examples of such eviction methods. H 2O uses a greedy
eviction policy that maintains in memory the most salient
“Heavy Hitter” tokens that contribute most to the attention
scores. Scissorhands identifies and maintains “pivotal to-
kens” by counting when a token’s attention score exceeds
an importance threshold. While these methods reduce the
memory footprint of the KV cache as well as data trans-
fer, they also lead to permanent loss of information from
the context window, which can lead to mistakes for queries
seeking less-attended parts of the sequence.
IceFormer (Mao et al., 2023) uses multiple existing ap-
proximate nearest neighbour algorithms for approximating
attention scores of pre-trained models, but focuses solely
on improving CPU performance, while SparQ Attention
aims to be hardware-agnostic. Scatterbrain (Chen et al.,
2021) employs similar techniques, but for computer vision
applications.
An orthogonal line of work increases bandwidth efficiency
by compressing the KV cache with 4-bit number formats
(Liu et al., 2023b; Sheng et al., 2023). Liu et al. (2023a)
demonstrate that 4-bit compression is complementary to
techniques that reduce the number of transferred elements.
8. Discussion
In this work we have presented SparQ Attention, a novel
technique for unlocking faster inference for pre-trained
LLMs. Our proposed technique modifies the attention mech-
anism to access only the relevant tokens from the KV cache
on every generation step, leading to considerable data trans-
fer savings. This allows for pre-trained models to be exe-
cuted more efficiently, without any fine-tuning or modifica-
tions to the weights of the model.
One limitation of SparQ Attention is that it does not reduce
memory capacity, only the amount of data transferred. How-
ever, as no information is discarded from the input sequence,
it is more robust to performance degradation compared to
lossy alternatives.
LLM inference speed is often bottlenecked by memory trans-
fers rather than computation, especially in regimes of long
sequence lengths and limited memory bandwidth. SparQ At-
tention addresses this, increasing the arithmetic intensity of
LLMs with up to an eightfold compression of the transferred
KV cache data and little to no task performance degradation.
It is easy to implement on high-performance accelerators
and obtains substantial throughput improvements.
8
SparQ Attention: Bandwidth-Efficient LLM Inference
9. Broader Impact
This paper presents work whose goal is to advance the field
of Machine Learning. There are many potential societal
consequences of our work, none which we feel must be
specifically highlighted here.
References
Achiam, J., Adler, S., Agarwal, S., Ahmad, L., Akkaya, I.,
Aleman, F. L., Almeida, D., Altenschmidt, J., Altman, S.,
Anadkat, S., et al. GPT-4 technical report. arXiv preprint
ar","[0.02117224410176277, 0.04209210351109505, 0.022013526409864426, 0.031239576637744904, 0.005598025396466255, -0.005338630639016628, -0.014694378711283207, 0.030622636899352074, -0.03230519965291023, -0.0025764238089323044, 0.022966977208852768, -0.0168396458029747, -0.024186834692955017, 0.031099362298846245, -0.0016107030678540468, -0.023878365755081177, 0.0265424232929945, -0.061974383890628815, 0.015633810311555862, -0.001540596247650683, -0.02393445186316967, 0.003901441814377904, 0.001376721658743918, 0.0037086480297148228, 0.011441424489021301, -0.027075234800577164, 0.0029427316039800644, 0.013215126469731331, 0.033286694437265396, -0.05555260553956032, 0.05431872606277466, -0.027285555377602577, -0.04307359829545021, -0.03395972028374672, 0.011497510597109795, 0.07722961902618408, -0.020709538832306862, 0.0172883290797472, -0.03724071756005287, -0.011104912497103214, -0.003831334877759218, -0.03746505826711655, -0.05759972333908081, 0.01822775974869728, 0.02950092777609825, 0.008293630555272102, 0.009681744500994682, -0.008237545378506184, -0.028365198522806168, 0.06685381382703781, -0.025280501693487167, 0.01605444960296154, -0.07341580837965012, 0.025434736162424088, -0.007571530994027853, -0.01884469948709011, 0.009162954986095428, 0.015703916549682617, 0.0435783676803112, 0.03320256620645523, 0.03286605328321457, -0.012640250846743584, 0.01756875589489937, -0.0016028160462155938, -0.04800911620259285, 0.013881140388548374, -0.025841355323791504, 0.045933954417705536, -0.002180320443585515, 0.004234449006617069, -0.01947566121816635, 0.03639943525195122, 0.04540114477276802, -0.016012385487556458, 0.008630143478512764, 0.0065900362096726894, -0.0023976515512913465, 0.04697153717279434, 0.008749324828386307, 0.002751690801233053, 0.04189580678939819, -0.020415091887116432, 0.03724071756005287, -0.0036069932393729687, -0.020036514848470688, -0.029444843530654907, -0.024439219385385513, 0.003382651600986719, -0.02515430934727192, 3.8147940358612686e-05, -0.02579929120838642, 0.037913739681243896, -0.02595352567732334, 0.005766281858086586, 0.04570961371064186, 0.05661822855472565, 0.03721267357468605, -0.01696583814918995, 0.01866242289543152, 0.04896256700158119, 0.024270962923765182, -0.017232242971658707, 0.013775980100035667, -0.05715103819966316, 0.043297939002513885, -0.03395972028374672, -0.028827903792262077, -0.0005985365714877844, 0.018438080325722694, -0.018494166433811188, -0.06410562992095947, -0.00717893335968256, -0.05353352800011635, 0.05370178446173668, 0.01897089183330536, -0.05187901109457016, -0.06034790724515915, -0.020737582817673683, 0.01713409461081028, 0.0392037071287632, -0.020961923524737358, 0.024817796424031258, 0.03440840169787407, -0.011168008670210838, 0.024467263370752335, -0.04363445192575455, 0.06561993807554245, -0.06309609115123749, 0.025715162977576256, -0.03639943525195122, 0.05883359909057617, 0.03266975283622742, 0.051794882863759995, -0.0073401788249611855, 0.00153270922601223, -0.028519432991743088, -0.051009684801101685, 0.02703317068517208, -0.03968043252825737, -0.020457156002521515, 0.004641068167984486, 0.000704134872648865, 0.011259146966040134, 0.028182921931147575, -0.025827333331108093, 0.02344370447099209, -0.019097084179520607, 0.035922709852457047, -0.009296157397329807, 0.04753239080309868, -0.009275125339627266, -0.007199965417385101, -0.03623117879033089, 0.006221975665539503, -0.037268757820129395, 0.005738239269703627, -0.02251829393208027, 0.0022486746311187744, 0.004003096371889114, -0.0559171587228775, 0.01505893375724554, -0.0022995020262897015, 0.035277727991342545, -0.01867644302546978, 0.0024660055059939623, 0.02781836688518524, -0.07195758819580078, -0.011160997673869133, -0.0620865561068058, -0.036343351006507874, -0.01962989568710327, -0.04226035997271538, -0.01667138934135437, -0.013474521227180958, 0.006632100325077772, -0.004367651883512735, -0.02655644342303276, 0.005689164157956839, 0.001275943242944777, -0.05723516643047333, -0.013081923127174377, 0.002141761826351285, 0.008034235797822475, 0.021677013486623764, -0.031099362298846245, -0.010677261278033257, -0.03379146382212639, 0.019223276525735855, -0.012303737923502922, 0.06763900816440582, -0.028968116268515587, 0.026009611785411835, 0.06163787096738815, 0.034520573914051056, -0.004707669373601675, -0.02930462919175625, 0.03160412982106209, 0.027874451130628586, 0.002469511004164815, -0.04212014749646187, 0.008973666466772556, -0.0001829348475439474, 0.027215447276830673, -0.07369623333215714, 0.04517680034041405, 0.015703916549682617, 0.0005468328017741442, -0.010999752208590508, -0.04209210351109505, -0.020288899540901184, 0.026276016607880592, 0.012689325027167797, 0.08682022243738174, 0.011357296258211136, -0.0172883290797472, 0.012191567569971085, -0.02826705016195774, 0.016741497442126274, 0.007249040063470602, 0.043774668127298355, 0.025126265361905098, -0.029753312468528748, 0.01835395209491253, 0.04814932867884636, -0.055160004645586014, 0.03785765543580055, 0.007157901301980019, -0.03118349052965641, 0.023976515978574753, -0.016419004648923874, 0.011756905354559422, 0.012626228854060173, -0.0017561746062710881, -0.0024274468887597322, -0.0012224868405610323, -0.060740504413843155, 0.02685089223086834, -0.027411747723817825, 0.02282676473259926, -0.046074170619249344, 0.0037542174104601145, -0.011981246992945671, 0.006744271144270897, 0.0038804097566753626, -0.023682067170739174, 0.045288972556591034, -0.01835395209491253, -0.03177238628268242, 0.04399900883436203, 0.03129566088318825, -0.00745234964415431, -0.035586196929216385, -0.050729259848594666, -0.0018788614543154836, -0.04899061098694801, -0.01142039243131876, 0.004851388279348612, 0.04240057244896889, -0.004707669373601675, 0.008391779847443104, -0.025518864393234253, -0.02888398803770542, 0.025112245231866837, -0.0055419402197003365, -0.0014836344635114074, 0.01210743933916092, 0.00671973405405879, 0.01821373775601387, -0.029865482822060585, -0.011623702012002468, -0.003918968606740236, -0.0045709614641964436, -0.0018508187495172024, -0.01697986014187336, -0.038811106234788895, 0.022882848978042603, 0.01143441442400217, -0.017316371202468872, -0.02626199647784233, 0.03272584080696106, 0.0003954459971282631, -0.014820571057498455, 0.0925409346818924, 0.0027411747723817825, -0.010866548866033554, 0.004118772689253092, 0.0025659077800810337, -0.0026202404405921698, -0.037605270743370056, -0.001123460941016674, 0.021494735032320023, -0.04744826257228851, 0.04217623174190521, -0.00478128157556057, 0.021971462294459343, 0.012443951331079006, -0.01745658554136753, -0.035754453390836716, 0.008510962128639221, 0.004371156916022301, 0.06006747856736183, 0.023555874824523926, 0.01833993010222912, -0.03348299488425255, 0.0037542174104601145, 0.02500007301568985, -0.014484058134257793, 0.018311887979507446, -0.036511603742837906, 0.020569326356053352, -0.029725270345807076, 0.005110783502459526, -0.019181212410330772, 0.040353454649448395, -0.055160004645586014, -0.038530681282281876, 0.020737582817673683, -0.024733668193221092, 0.01637694053351879, -0.018872741609811783, -0.0065234350040555, -0.06393737345933914, 0.00535966269671917, -0.018325909972190857, 0.04758847504854202, -0.047756731510162354, -0.04102648049592972, 0.014848614111542702, -0.011988257989287376, -0.011139965616166592, 0.05330918729305267, -0.0009280383819714189, -0.003465027082711458, -0.028154877945780754, -0.048541925847530365, 0.0002738545590545982, 0.0028112814761698246, -0.0015511122765019536, 0.0036806054413318634, 0.00337914633564651, -0.08665196597576141, 0.01151153165847063, -0.01273138914257288, 0.009324200451374054, -0.01899893395602703, 0.03073480725288391, 0.013523595407605171, -0.006032687611877918, 0.040044985711574554, -0.009106868878006935, 0.01188309770077467, 0.010593133047223091, 0.04551331326365471, -0.05182292312383652, 0.016152599826455116, 0.02038704790174961, 0.002294244011864066, -0.03614705055952072, 0.005468328017741442, 0.012500036507844925, -0.01590021513402462, 0.01012341771274805, 0.027565982192754745, -0.017049966380000114, 0.03398776054382324, -0.0025606497656553984, -0.020022492855787277, 0.009969182312488556, 0.032052814960479736, -0.004069698043167591, 0.016026407480239868, 0.035922709852457047, 0.005356157198548317, -0.042204275727272034, -0.04526092857122421, 0.010887580923736095, 0.0005534053198061883, 0.0429333858191967, 0.014014342799782753, 0.03415601700544357, 0.003964537754654884, 0.027509896084666252, -0.025266479700803757, -0.030454380437731743, 0.04091431200504303, 0.004413221031427383, 0.006193933077156544, 0.00571019621565938, -0.09702777117490768, -0.0048619043081998825, -0.03244541212916374, 0.018802635371685028, -0.022966977208852768, 0.015563703142106533, 0.015689894556999207, 0.037577226758003235, -0.009611638262867928, 0.017989397048950195, 0.05832883343100548, 0.03208085894584656, -0.0038979363162070513, 0.016545196995139122, -0.012058364227414131, -0.0074102855287492275, 0.004739217460155487, -0.005096761975437403, 0.007613595109432936, 0.03163217380642891, 0.015717938542366028, -0.02174711972475052, 0.08569851517677307, -0.040998440235853195, 0.029669184237718582, -2.192205829487648e-05, -0.003412446938455105, -0.03785765543580055, -0.012668292969465256, 0.0024905430618673563, 0.007774840574711561, 0.0537298284471035, -0.0008785254321992397, -0.02868768945336342, -0.02317729778587818, -0.024313027039170265, -0.00656199362128973, 0.004967064596712589, 0.025967547670006752, -0.08760541677474976, 0.04938320815563202, -0.05384200066328049, -0.0460180826485157, 0.01651715487241745, 0.016615305095911026, -0.02191537618637085, -0.02888398803770542, 0.009625659324228764, -0.014708399772644043, 0.04094235226511955, -0.017246264964342117, -0.07240626960992813, -0.018157653510570526, -0.03345495089888573, -0.03429623320698738, 0.013705873861908913, -0.04969167709350586, 0.002376619493588805, -0.032641712576150894, 0.010530036874115467, 0.008237545378506184, -0.05067317187786102, -0.0004298421263229102, 0.016264770179986954, 0.06410562992095947, 0.037745483219623566, -0.00995516125112772, -0.05465523898601532, 0.10459929704666138, -0.045288972556591034, 0.02364000305533409, -0.031884558498859406, 0.03968043252825737, -0.013902172446250916, -0.031744346022605896, 0.010298684239387512, 0.021662991493940353, -0.012724379077553749, 0.016587261110544205, 0.020148685202002525, 0.03544598072767258, -0.0010875312145799398, 0.026808828115463257, -0.03794178366661072, 0.0022767172195017338, -0.0026237459387630224, -0.04921495169401169, -0.024775732308626175, 0.014680357649922371, -0.032809969037771225, -0.014308791607618332, -0.028042707592248917, 0.037885699421167374, -0.026430252939462662, 0.021873312070965767, 0.019419575110077858, 0.01181299053132534, 0.04663502424955368, 0.05737537890672684, -0.016110535711050034, 0.022924913093447685, 0.017176158726215363, -0.03384754806756973, -0.01634889841079712, 0.024425199255347252, -0.016643347218632698, 0.0018280340591445565, -0.015381425619125366, -0.010368791408836842, -0.024018580093979836, 0.02950092777609825, -0.02731359750032425, 0.027285555377602577, 0.006821388844400644, 0.013074912130832672, 0.003421210451051593, -0.017652884125709534, 0.011280179023742676, 0.045485273003578186, 0.014540144242346287, -0.008188470266759396, 0.01681160368025303, 0.012724379077553749, 0.010417865589261055, 0.010789431631565094, 0.048233456909656525, 0.012941709719598293, 0.03827829658985138, -0.0011795463506132364, 0.026318080723285675, -0.007213986478745937, 0.02839324064552784, -0.00648487638682127, -0.014273738488554955, -0.008952634409070015, 0.015072955749928951, -0.018031461164355278, -0.017526691779494286, -0.0700506865978241, -0.07767830044031143, -0.035894665867090225, -0.06017965078353882, 0.02237808145582676, -0.017218222841620445, -0.007858969271183014, 0.01714811660349369, -0.04506463184952736, -0.023541852831840515, -0.02084975317120552, -0.03376341983675957, -0.041615378111600876, 0.02502811700105667, 0.01211444940418005, 0.00616939552128315, 0.00980793684720993, 0.046719152480363846, -0.01633487641811371, -0.023233383893966675, 0.04355032369494438, -0.022448187693953514, -0.01634889841079712, 0.023429682478308678, 0.015816086903214455, -0.04102648049592972, 0.018732529133558273, -0.0019997956696897745, -0.003465027082711458, 0.013860108330845833, -0.004770765546709299, 0.01946163922548294, -0.02871573343873024, -0.01334832888096571, 0.022504273802042007, -0.0006134342402219772, -0.01808754727244377, -0.028631605207920074, -0.02394847199320793, 0.020022492855787277, 0.014245695434510708, -0.0469154492020607, 0.004388683941215277, 0.012612207792699337, -0.0336792916059494, -0.013839076273143291, 0.006309609394520521, -0.05429068207740784, 0.023499788716435432, -0.006632100325077772, -0.02066747471690178, 0.017526691779494286, -0.005591014865785837, 0.030903063714504242, -0.03782961145043373, -0.004024128429591656, -0.027103276923298836, -0.004963559098541737, -0.03241737186908722, 0.008230534382164478, -0.007157901301980019, 0.04570961371064186, -0.015072955749928951, 0.014350855723023415, 0.02225188910961151, -0.034829042851924896, 0.011027795262634754, -0.011869075708091259, -0.04371858015656471, -0.015970321372151375, 0.00010735099203884602, -0.007235018536448479, -0.049018654972314835, 0.013811033219099045, 0.00014985322195570916, 0.011974235996603966, -0.004644573666155338, -0.018592314794659615, 0.0007339302683249116, 0.059057943522930145, -0.04486833140254021, 0.009268115274608135, 0.03917566314339638, -0.011350286193192005, 0.0011515036458149552, -0.004542918875813484, -0.01772299036383629, -0.027257511392235756, -0.07650050520896912, 0.004416726529598236, -0.04887843877077103, -0.02823900617659092, 0.030005697160959244, -0.0037507121451199055, 0.015984343364834785, -0.0305945947766304, 0.014666336588561535, 0.032052814960479736, 0.013067902065813541, 0.011714841239154339, -0.011925161816179752, -0.0383063405752182, -0.02776228077709675, -0.006551477592438459, -0.05143032595515251, -0.017863204702734947, -0.006505907978862524, 0.016783559694886208, -0.009464413858950138, 0.025084201246500015, 0.014792528003454208, 0.008917581290006638, 0.029585056006908417, 0.022293953225016594, 0.016937796026468277, 0.021270394325256348, 0.013853097334504128, 0.0036210145335644484, 0.03224911540746689, -0.01653117686510086, -0.0017912279581651092, 0.008132385089993477, -0.0066285948269069195, -0.0018893774831667542, -0.024495305493474007, -0.03732484579086304, 0.07509837299585342, 0.021340500563383102, 0.039932817220687866, -0.01372690498828888, -0.01020053494721651, -0.017386479303240776, 0.013874129392206669, 0.006348168011754751, -0.04467203468084335, -0.02020477131009102, -0.022350037470459938, -0.02595352567732334, -0.0030443863943219185, 0.022321995347738266, 0.03390363231301308, 0.0003273109905421734, -0.00656199362128973, -0.008377758786082268, -0.008230534382164478, 0.0005091503844596446, 0.05168271064758301, 0.01126615796238184, 0.003359867027029395, -0.019798152148723602, -0.0051703741773962975, -0.02068149670958519, -0.02578526921570301, 0.01435786671936512, -0.03398776054382324, 0.009765872731804848, -0.05232769250869751, -0.03129566088318825, 0.008896549232304096, 0.016713453456759453, 0.023205339908599854, 0.01421064231544733, 0.03499729931354523, -0.009941140189766884, 0.0016667884774506092, 0.0012829538900405169, 0.04758847504854202, -0.039876729249954224, 0.0015011612558737397, 0.012682314962148666, -0.013677830807864666, 0.046999577432870865, -0.024299006909132004, -0.062142640352249146, -0.00401010736823082, 0.025995589792728424, -0.003373888321220875, -0.0013942483346909285, 6.34247189736925e-05, -0.042232315987348557, 0.0008062278502620757, 0.01713409461081028, 0.05328114330768585, -0.023527832701802254, -0.018129611387848854, 0.016783559694886208, 0.015437510795891285, 0.010340748354792595, -0.017078008502721786, 0.013102955184876919, -0.003929484635591507, 0.00609227828681469, -0.004634057637304068, -0.01057911105453968, -0.031407833099365234, 0.007901032455265522, -0.03488512709736824, -0.017316371202468872, 0.004241459537297487, -0.005282544996589422, -0.01790526881814003, 0.008665196597576141, 0.0323893278837204, 0.0447281189262867, 0.010621175169944763, 0.03025808185338974, 0.008861495181918144, -0.050392746925354004, -0.014042385853827, -0.007049235515296459, -0.05973096564412117, -0.013839076273143291, -0.012934698723256588, -0.023822279646992683, 0.013067902065813541, -0.03398776054382324, 0.025869397446513176, 0.03667986020445824, 0.0016720464918762445, 0.015998365357518196, 0.008370748721063137, 0.01426672749221325, -0.002339813392609358, -0.001096294610761106, -0.028996160253882408, 0.013383382000029087, 0.029557013884186745, 0.023864343762397766, 0.0008636277634650469, -0.03614705055952072, 0.004423737060278654, -0.01334832888096571, 0.008805410005152225, 0.0062500182539224625, 0.008973666466772556, -0.006463844329118729, -0.005776797886937857, 0.030230039730668068, 0.005878452677279711, -0.019181212410330772, 0.00326171750202775, -0.03353907912969589, 0.012829538434743881, 0.003768238937482238, 0.0018981407629325986, -0.002359092701226473, 0.015171105042099953, 0.013362349942326546, 0.01590021513402462, -0.03101523406803608, 0.03168825805187225, -0.014413951896131039, 0.019503703340888023, 0.026654593646526337, 0.011581637896597385, -0.014596229419112206, -0.02516832947731018, -0.03903545066714287, -0.015788044780492783, -0.029557013884186745, -0.024453241378068924, -0.0023187813349068165, -0.01758277788758278, -0.014526122249662876, -0.006123826373368502, -0.0014450757298618555, -0.013551638461649418, -0.022434165701270103, 0.011686798185110092, 0.01390918344259262, -0.004718185402452946, -0.09091445803642273, -0.030454380437731743, 0.04189580678939819, -0.007957118563354015, 0.01913914829492569, 0.0007799378363415599, 0.012794485315680504, -0.0032880075741559267, 0.051009684801101685, -0.024341071024537086, 0.0010761389276012778, -0.017414521425962448, 0.005664627067744732, -0.019055020064115524, 0.017316371202468872, -0.04697153717279434, -0.01381804421544075, 0.0024116728454828262, 0.028603561222553253, -0.014056406915187836, -0.026668615639209747, 0.006782829761505127, 0.005019644740968943, 0.005717207212001085, 0.0021032029762864113, -0.01218455657362938, -0.0035509078297764063, -0.008784377947449684, -0.0008469774038530886, 0.002813034225255251, -0.018788613379001617, 0.0004366337088868022, 0.008602100424468517, 0.05445893853902817, -0.034015804529190063, -0.01451210118830204, -0.013116976246237755, 0.03289409726858139, 0.01010939572006464, 0.0006953715346753597, -0.018115589395165443, -0.030230039730668068, 0.032809969037771225, -0.015605767257511616, 0.0074102855287492275, -0.015171105042099953, 0.044840291142463684, -0.0038243243470788, 0.005913505796343088, 0.030762851238250732, -0.009520499035716057, -0.011483488604426384, 0.0276360884308815, 0.028126835823059082, -0.011378328315913677, -0.006165890488773584, -9.382257849210873e-05, -0.014140535145998001, 0.004237954039126635, 0.01027064211666584, -0.031716302037239075, 0.0033721355721354485, 0.02776228077709675, -0.012450962327420712, -0.0246775820851326, -0.013993310742080212, 0.02361195906996727, 0.029276587069034576, 0.01912512630224228, -0.014014342799782753, -0.03494121506810188, 0.0008780873031355441, -0.005471833515912294, 0.025112245231866837, 0.029528971761465073, -0.01010238565504551, 0.03056655079126358, 0.029865482822060585, -0.03569836542010307, 0.003940000664442778, 0.04057779908180237, -0.04380270838737488, 0.0029988170135766268, 0.0005415747873485088, 0.019223276525735855, 0.01095067709684372, 0.039428047835826874, -0.021564843133091927, -0.017512671649456024, 0.041447121649980545, 0.02992156893014908, -0.012009290046989918, 0.028589541092514992, -0.0074172960594296455, 0.02516832947731018, 0.015830108895897865, 0.018592314794659615, -0.005156353116035461, 0.04985993355512619, 0.013145019300282001, 0.05002819001674652, 0.017049966380000114, 0.019195232540369034, -0.07072371244430542, -0.003436984261497855, 0.003382651600986719, 0.001903398777358234, -0.006477865390479565, 0.027215447276830673, -0.01591423712670803, 0.00717893335968256, 0.011371318250894547, 0.023359576240181923, 0.034324273467063904, 0.022602422162890434, 0.005559466779232025, 0.016573240980505943, 0.026360144838690758, 0.030230039730668068, -0.018438080325722694, 0.009457402862608433, 0.02438313513994217, -0.0211442019790411, 0.012500036507844925, 0.017190180718898773, -0.04043758288025856, 0.020877795293927193, 0.010747367516160011, 0.021536799147725105, 0.005321103613823652, 0.0073471893556416035, 0.045597441494464874, 0.003561423858627677, 0.01604042947292328, -0.020471176132559776, -0.001954226288944483, 0.003424715716391802, 0.01280850637704134, -0.03269779682159424, 0.046550896018743515, -0.014834592118859291, 0.01588619314134121, 0.03230519965291023, 0.00648487638682127, -0.004630552139133215, -0.0014626025222241879, 0.018956869840621948, -0.014238684438169003, -0.01151153165847063, 0.005363167729228735, 0.021256372332572937, -0.019405553117394447, 0.018634378910064697, 0.01819971762597561, -0.019209254533052444, 0.04186776280403137, -0.02607971802353859, -0.02163494937121868, 0.0032354274298995733, 0.026626551523804665, 0.01273138914257288, -0.008244556374847889, -0.013790001161396503, 0.0017780829221010208, -0.006842420902103186, -0.014035374857485294, -0.03827829658985138, -0.01745658554136753, -0.020737582817673683, 0.029837440699338913, -0.0012294974876567721, -0.03230519965291023, 0.05067317187786102, 0.045317016541957855, 0.031576089560985565, 0.031856514513492584, -0.00748039223253727, -0.03272584080696106, 0.020793667063117027, 0.015549681149423122, 0.0023345553781837225, 0.013481531292200089, -0.01634889841079712, 0.03283800929784775, 0.03272584080696106, 0.03244541212916374, 0.0036490573547780514, -0.004241459537297487, 0.026205910369753838, 0.02006455697119236, 0.017638863995671272, 0.031576089560985565, -0.03415601700544357, -0.006015160586684942, 0.00535966269671917, -0.027832387015223503, 0.008139396086335182, 0.023051105439662933, -0.02856149710714817, 0.0008675712742842734, -0.03962434455752373, 0.052552033215761185, -0.0005328114493750036, 0.010074342601001263, -0.009828968904912472, 0.021368542686104774, -0.006579520180821419, -0.014890678226947784, -0.0017912279581651092, 0.010396833531558514, -0.019251318648457527, -0.0011883097467944026, -0.02547680027782917, 0.02066747471690178, 0.002501059090718627, 0.00497758062556386, -0.015633810311555862, -0.006926548667252064, -0.030987191945314407, -0.019181212410330772, -0.046522852033376694, 0.0048198401927948, -0.02192939817905426, -0.0011182029265910387, -0.02282676473259926, 0.0014144040178507566, 0.01444199401885271, -0.034829042851924896, -0.007767830044031143, 0.022350037470459938, -0.008391779847443104, 0.03454861417412758, 0.0002916003577411175, 0.014112493023276329, -0.017512671649456024, -0.025098223239183426, -0.01618064194917679, -0.030033739283680916, 5.2853931265417486e-05, 0.015872173011302948, 0.021733097732067108, 0.010221567004919052, 0.01685366779565811, -0.0009525757050141692, -0.005941548850387335, -0.020961923524737358, 0.006667153909802437, 0.021410606801509857, -0.006481370888650417, -0.004907473921775818, 0.006979128811508417, 0.0036665841471403837, 0.019685979932546616, -0.008356726728379726, 0.004041655454784632, -0.0077818515710532665, 0.010985731147229671, 0.04352228343486786, 0.044531818479299545, 0.0002030905452556908, -0.017484627664089203, 0.02194341830909252, -0.018452102318406105, -0.023583916947245598, 0.016390962526202202, -0.011048826389014721, -0.010074342601001263, -0.008987687528133392, -0.005191406235098839, 0.010410855524241924, -0.027397725731134415, 0.006214965134859085, -0.0010253115324303508, 0.007634627167135477, 0.00501613924279809, 0.016797581687569618, -0.006583025678992271, 0.0017614326206967235, 0.01929338276386261, -0.025042137131094933, -0.015157083980739117, -0.009148932993412018, -0.012317758984863758, 0.0019209254533052444, -0.007936086505651474, -0.003068923717364669, -0.047924987971782684, -0.0015143061755225062, 0.051654666662216187, -0.018732529133558273, 0.018269823864102364, 0.04012911394238472, 0.009120890870690346, -0.012948720715939999, -0.01289964560419321, -0.008279609493911266, -0.00895964540541172, 0.01002526842057705, 0.034212104976177216, -0.05260812118649483, 0.020485198125243187, 0.014610250480473042, 0.04332598298788071, 0.02687893621623516, 0.025504842400550842, 0.01012341771274805, -0.028309114277362823, -0.047308046370744705, 0.003922473639249802, 0.02020477131009102, -0.012443951331079006, 0.026149824261665344, 0.013579681515693665, -0.004223932977765799, 0.004707669373601675, 0.015549681149423122, 0.016461068764328957, -0.030061783269047737, -0.0031460411846637726, -0.037408970296382904, -0.003911957610398531, 0.04786890372633934, -0.002504564356058836, 0.004367651883512735, 0.003771744202822447, -0.03241737186908722, 0.0013916193274781108, -0.01081747468560934, -0.0222378671169281, 0.008966655470430851, 0.0168396458029747, 0.025406694039702415, -0.0025098223704844713, 0.015030891634523869, -0.03160412982106209, 0.0002515080268494785, -0.03982064500451088, -0.019657937809824944, -0.008742313832044601, -0.003421210451051593, 0.032809969037771225, -0.0011926913866773248, 0.002390640787780285, -0.018297865986824036, -0.0013206362491473556, 0.02177516184747219, -0.0038453564047813416, -0.010929645039141178, -0.004858399275690317, -0.015563703142106533, 0.06483474373817444, -0.012913666665554047, -0.025112245231866837, -0.010207545943558216, -0.010852527804672718, 0.053477443754673004, -0.013986300677061081, -0.014182599261403084, -0.03227715566754341, -0.004651584196835756, 0.013404414057731628, 0.028463348746299744, -0.0028270555194467306, -0.0006778448005206883, 0.0010936656035482883, -0.020330963656306267, -0.019714023917913437, 0.029893526807427406, 0.008889538235962391, -0.007767830044031143, 0.017176158726215363, 0.016110535711050034, -0.006109804846346378, 0.0014959032414481044, -0.009976193308830261, 0.005584004335105419, 0.00466560572385788, 0.03269779682159424, 0.011827011592686176, 0.026500359177589417, 0.013656798750162125, -0.03811004012823105, -0.0370163731276989, -0.002211868530139327, 0.004413221031427383, 0.03345495089888573, -0.007957118563354015, 0.025546906515955925, -0.002231147838756442, -0.000666890642605722, 0.012689325027167797, 0.012591175734996796, -0.018592314794659615, 0.02471964620053768, -0.01881665736436844, -0.030286123976111412, 0.006302598398178816, 0.020274877548217773, -0.0098009267821908, 0.011918150819838047, -0.03544598072767258, -0.0007216615485958755, 0.028154877945780754, -0.012724379077553749, 0.02577124908566475, -0.039764560759067535, -0.011504520662128925, 0.0475604310631752, 0.01364978775382042, -0.0012592928251251578, -0.03670790418982506, -0.007957118563354015, -0.022490251809358597, -0.014554165303707123, -0.026219932362437248, -0.044531818479299545, -0.010642207227647305, 0.019840216264128685, -0.008700249716639519, 0.017162136733531952, -0.03892327845096588, 0.006859947461634874, 0.003414199687540531, 0.02055530436336994, 0.0031898580491542816, 0.016909752041101456, 0.004013612400740385, 0.037605270743370056, 0.021508757025003433, 0.006039698142558336, -0.002374866744503379, 0.007242029067128897, -0.014427972957491875, 0.0024554897099733353, -0.000704134872648865, 0.006439306773245335, 0.01550761703401804, -0.015661852434277534, -0.008244556374847889, 0.051935095340013504, -0.029080288484692574, -0.00548585457727313, 0.03135174885392189, -0.002087429165840149, -0.017106052488088608, -0.012675303965806961, -0.024018580093979836, -0.024172814562916756, 0.021803205832839012, -0.01573195867240429, -0.027103276923298836, 0.00018392072524875402, -0.019251318648457527, -0.002360845450311899, -0.008539004251360893, 0.0043220822699368, -0.045148760080337524, -0.015367403626441956, 0.03191260248422623, 0.03266975283622742, 0.009765872731804848, -0.012815517373383045, -0.01257715467363596, 0.0074032749980688095, -0.005731228273361921, 0.03721267357468605, 0.0086441645398736, 0.037408970296382904, -0.013712883926928043, -0.03424014523625374, 0.03771744295954704, 0.0028883989434689283, 0.020947903394699097, -0.005187900736927986, -0.0107964426279068, -0.013355339877307415, -0.006810872815549374, -0.005422758404165506, -0.02714534103870392, -0.011013773269951344, -0.013621745631098747, -0.01156761683523655, 0.019503703340888023, 0.005699680186808109, 0.006148363463580608, 0.03923174738883972, -0.0025150803849101067, 0.006698701996356249, 0.002651788527145982, -0.007936086505651474, -0.01490469928830862, 0.027720216661691666, -0.005878452677279711, 0.033875592052936554, -0.00256766052916646, 0.0008710765978321433, 0.0016133320750668645, -0.010459929704666138, 0.008875517174601555, -0.01776505447924137, -0.002504564356058836, 0.025897441431879997, 0.0030408811289817095, 0.026640571653842926, 0.002706121187657118, 0.020415091887116432, -0.006909022107720375, 0.0037051427643746138, 0.001341668306849897, 0.012464983388781548, -0.005938043352216482, -0.013404414057731628, -0.011939182877540588, 0.009969182312488556, 0.06483474373817444, -0.01667138934135437, -0.0394560880959034, 0.008454876020550728, 0.013488542288541794, 0.023219361901283264, 0.024495305493474007, 0.0009998978348448873, -0.02131245844066143, 0.0013793506659567356, -0.04276512935757637, -0.00811836402863264, -0.02687893621623516, 0.014918720349669456, -0.017232242971658707, 0.015591745264828205, -0.02054128423333168, 0.003940000664442778, 0.017246264964342117, -0.01374793704599142, 0.00674777664244175, -0.010487972758710384, 0.0026149824261665344, 0.007140374276787043, 0.007880001328885555, 0.005121299531310797, 0.009127900935709476, -0.023892387747764587, 0.0256450567394495, 0.006940570194274187, 0.029669184237718582, 0.04455986246466637, 0.00709831016138196, 0.043297939002513885, 0.04380270838737488, 0.03241737186908722, -0.015675874426960945, -0.011462456546723843, -0.011756905354559422, -0.04189580678939819, 0.011988257989287376, 0.014056406915187836, 0.004378167912364006, -0.004662100225687027, -0.0030724292155355215, 0.007494413759559393, 0.006165890488773584, -0.012100428342819214, 0.011153986677527428, 0.008335694670677185, -0.014638293534517288, 0.013993310742080212, -0.01374092698097229, 0.03182847425341606, -0.032333243638277054, -0.025518864393234253, 0.012556122615933418, -0.010242599062621593, 0.006278061307966709, 0.00933121144771576, -0.014470037072896957, -0.001338162925094366, 0.007228008005768061, 0.015157083980739117, -0.010523025877773762, 0.008384769782423973, -0.02082171104848385, -0.015311318449676037, 0.00811836402863264, -0.029108330607414246, 0.010389823466539383, 0.0011918151285499334, -0.0007812522817403078, -0.025364629924297333, -0.007669680751860142, 0.015241211280226707, 0.03292213752865791, 0.005405231844633818, 0.012079396285116673, 0.005342135671526194, -0.00826558843255043, 0.04728000611066818, 0.021060073748230934, 0.022125696763396263, -0.022812742739915848, 0.001704470836557448, -0.016643347218632698, 0.025981567800045013, -0.014806549996137619, -0.034352317452430725, 0.006127331871539354, -0.013418436050415039, -0.016166621819138527, 0.005033666267991066, 0.027047190815210342, 0.03135174885392189, -0.012394877150654793, -0.005096761975437403, -0.0030216018203645945, 0.023233383893966675, -0.04332598298788071, 0.035417940467596054, -0.028603561222553253, 0.04105452448129654, 0.00330027611926198, -0.034380361437797546, -0.023990536108613014, -0.010789431631565094, -0.015844129025936127, -0.025196373462677002, -0.012696336023509502, 0.017863204702734947, 0.008623132482171059, 0.021522779017686844, -0.02456541173160076, 0.004378167912364006, 0.03376341983675957, -0.008349716663360596, 0.0009192749857902527, -0.041138652712106705, 0.012317758984863758, 0.02222384512424469, -0.008805410005152225, 0.011749894358217716, 0.02100398764014244, -0.0009823711588978767, 0.026640571653842926, 0.01435786671936512, -0.005482349544763565, -0.007929075509309769, -0.0285334549844265, -0.009162954986095428, -0.01141338236629963, -0.03379146382212639, -0.03505338355898857, 0.0202468354254961, -0.00745234964415431, -0.004749733489006758, 0.0022802227176725864, 0.01605444960296154, 0.011560605838894844, 0.01930740475654602, -0.007985160686075687, 0.053673744201660156, -0.0035158544778823853, 0.02701914869248867, -0.013565659523010254, -0.014806549996137619, -0.03320256620645523, 0.02857551909983158, 0.0013740926515311003, 0.01212847139686346, -0.009436370804905891, 0.00767669128254056, -0.024186834692955017, 0.047139789909124374, 0.009022741578519344, 0.028224986046552658, 0.02208363264799118, -0.01604042947292328, 0.02748185396194458, -0.020653454586863518, 0.0202468354254961, 0.0012470241636037827, 0.014764485880732536, -0.00018151081167161465, 0.03625922277569771, 0.00941533874720335, 0.016545196995139122, 0.0029287103097885847, -0.020302919670939445, 0.022350037470459938, 0.024046622216701508, 0.027874451130628586, 0.012079396285116673, -0.013621745631098747, -0.029052244499325752, 0.003163567977026105, -0.041166696697473526, -0.022027546539902687, 0.0007361210882663727, 0.012605196796357632, -0.021508757025003433, 0.024649539962410927, -0.019419575110077858, 0.003911957610398531, 0.04018520191311836, 0.023373596370220184, 0.00260621914640069, 0.019559789448976517, -0.0031109878327697515, 0.015241211280226707, 0.010466940701007843, -0.014203631319105625, -0.0025624025147408247, -0.011020784266293049, -0.0074032749980688095, 0.0016124557005241513, -0.0030917085241526365, 0.014848614111542702, -0.004265997093170881, -0.01010238565504551, -0.03381950408220291, -0.01623672805726528, -0.030314167961478233, -0.03477295860648155, -0.007459360174834728, 0.013642777688801289, 0.03042633831501007, 0.022097652778029442, -0.029753312468528748, -0.025084201246500015, -0.011876086704432964, 0.004623541608452797, 0.020471176132559776, -0.012626228854060173, 0.02807074971497059, -0.029725270345807076, 0.007809894159436226, -0.024943988770246506, -0.01111893355846405, -0.00535966269671917, 0.0052580079063773155, 0.055664774030447006, 0.00191917282063514]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
"Xiv:2303.08774 , 2023.
Ainslie, J., Lee-Thorp, J., de Jong, M., Zemlyanskiy, Y .,
Lebr ´on, F., and Sanghai, S. GQA: Training generalized
multi-query transformer models from multi-head check-
points. arXiv preprint arXiv:2305.13245 , 2023.
Beltagy, I., Peters, M. E., and Cohan, A. Long-
former: The long-document transformer. arXiv preprint
arXiv:2004.05150 , 2020.
Biderman, S., Schoelkopf, H., Anthony, Q. G., Bradley,
H., O’Brien, K., Hallahan, E., Khan, M. A., Purohit, S.,
Prashanth, U. S., Raff, E., et al. Pythia: A suite for ana-
lyzing large language models across training and scaling.
InInternational Conference on Machine Learning , pp.
2397–2430. PMLR, 2023.
Borgeaud, S., Mensch, A., Hoffmann, J., Cai, T., Rutherford,
E., Millican, K., Van Den Driessche, G. B., Lespiau, J.-B.,
Damoc, B., Clark, A., et al. Improving language models
by retrieving from trillions of tokens. In International
conference on machine learning , pp. 2206–2240. PMLR,
2022.
Chen, B., Dao, T., Winsor, E., Song, Z., Rudra, A., and R ´e,
C. Scatterbrain: Unifying sparse and low-rank attention.
Advances in Neural Information Processing Systems , 34:
17413–17426, 2021.
Chiang, W.-L., Li, Z., Lin, Z., Sheng, Y ., Wu, Z., Zhang,
H., Zheng, L., Zhuang, S., Zhuang, Y ., Gonzalez, J. E.,
Stoica, I., and Xing, E. P. Vicuna: An open-source chatbot
impressing gpt-4 with 90%* chatgpt quality, March 2023.
Child, R., Gray, S., Radford, A., and Sutskever, I. Gen-
erating long sequences with sparse transformers. arXiv
preprint arXiv:1904.10509 , 2019.
Graphcore. Bow-2000 datasheet. (Online: ac-
cessed 25 January 2024), March 2023. URL
https://docs.graphcore.ai/projects/
bow-2000-datasheet .
Han, C., Wang, Q., Xiong, W., Chen, Y ., Ji, H., and Wang, S.
LM-infinite: Simple on-the-fly length generalization forlarge language models. arXiv preprint arXiv:2308.16137 ,
2023.
Jiang, A. Q., Sablayrolles, A., Mensch, A., Bamford, C.,
Chaplot, D. S., Casas, D. d. l., Bressand, F., Lengyel, G.,
Lample, G., Saulnier, L., et al. Mistral 7b. arXiv preprint
arXiv:2310.06825 , 2023.
Joshi, M., Choi, E., Weld, D. S., and Zettlemoyer, L.
TriviaQA: A large scale distantly supervised challenge
dataset for reading comprehension. arXiv preprint
arXiv:1705.03551 , 2017.
Kaplan, J., McCandlish, S., Henighan, T., Brown, T. B.,
Chess, B., Child, R., Gray, S., Radford, A., Wu, J., and
Amodei, D. Scaling laws for neural language models.
arXiv preprint arXiv:2001.08361 , 2020.
Karpathy, A. The unreasonable effectiveness of recurrent
neural networks. (Online: accessed 27 January 2024),
2015. URL https://github.com/karpathy/
char-rnn .
Kitaev, N., Kaiser, Ł., and Levskaya, A. Reformer: The
efficient transformer. arXiv preprint arXiv:2001.04451 ,
2020.
Lin, C.-Y . ROUGE: A package for automatic evaluation
of summaries. In Text Sum","[-0.02436598762869835, 0.040021032094955444, 0.029502157121896744, -0.020585767924785614, 0.01104618888348341, 0.003978819120675325, -0.02433859556913376, 0.04188375174999237, -0.07450869679450989, 0.02563975751399994, 0.025365829467773438, -0.04440389573574066, -0.03111833892762661, 0.024571435526013374, 0.013306102715432644, 0.0025954777374863625, 0.025954777374863625, -0.010922920890152454, 0.015312633477151394, 0.044294323772192, -0.0010922920191660523, -0.019202426075935364, -0.0016495664604008198, 0.007991880178451538, 0.03867878019809723, 0.014436060562729836, -0.006314064376056194, 0.039884068071842194, 0.007793281227350235, -0.03298105672001839, 0.012607583776116371, -0.0337754487991333, -0.0362682044506073, -0.020092694088816643, -0.0026331429835408926, 0.042595963925123215, 0.03563816845417023, 0.008752033114433289, 0.004054149612784386, 0.026735473424196243, 0.004615704528987408, -0.06431853771209717, -0.01973658800125122, 0.048238903284072876, -0.029392585158348083, 0.003557653399184346, 0.00786176323890686, -0.008300050161778927, -0.008190478198230267, 0.06661954522132874, -0.0285160131752491, 0.0354464165866375, -0.04711579531431198, -0.0056121209636330605, -0.027173761278390884, -0.002150343032553792, -0.03100876696407795, 0.007848067209124565, 0.016764456406235695, -0.03136487677693367, -0.010286035016179085, -0.04336296766996384, 0.010539419949054718, 0.021161017939448357, -0.05686767026782036, -0.009423159062862396, -0.04875936731696129, 0.00643733236938715, -0.017627334222197533, 0.012600735761225224, -0.0027752434834837914, 0.02580411545932293, 0.02317439578473568, -0.04380125179886818, 0.007724798750132322, 0.01577831245958805, -0.011176304891705513, 0.09740916639566422, -0.03084440901875496, -0.03314541280269623, -0.003787068882957101, -0.008663006126880646, 0.002218825276941061, -0.04908808320760727, -0.037528280168771744, -0.02602325938642025, 0.00012498012802097946, -0.0014227189822122455, -0.030597873032093048, -0.005803871434181929, -0.03221405670046806, -0.01655901037156582, -0.04114414006471634, -0.005951108410954475, 0.03618602454662323, 0.018777836114168167, 0.04404778778553009, 0.009436855092644691, 0.03706260025501251, 0.04213028773665428, -0.01553177647292614, -0.008245264180004597, 0.020161177963018417, -0.029529551044106483, 0.019805070012807846, 0.003372751409187913, 0.00643733236938715, -0.03807613626122475, -0.015093490481376648, 0.006697564851492643, -0.10842111706733704, -0.011929609812796116, -0.025393221527338028, 0.002051043789833784, 0.0008200750453397632, -0.053553126752376556, -0.018846318125724792, -0.027858583256602287, -0.02818729728460312, 0.00863561313599348, -0.02046249993145466, -0.010333972983062267, 0.020585767924785614, -0.008868453092873096, 0.032268840819597244, -0.015244151465594769, 0.022667627781629562, -0.016298778355121613, -0.009669695049524307, -0.009875142015516758, 0.012662369757890701, -0.0002711469423957169, 0.04988247901201248, -0.02355789765715599, -0.035172488540410995, -0.026680689305067062, -0.0321044847369194, -0.00527998199686408, -0.02303743176162243, -0.0006124881911091506, 0.02713267132639885, -0.008573979139328003, -0.050896015018224716, 0.027091581374406815, -0.05944260209798813, 0.0019294876838102937, -0.010484633967280388, 0.0037494036369025707, -0.018777836114168167, 0.020106391981244087, -0.0023506535217165947, 0.007882308214902878, -0.034624628722667694, 0.010690080933272839, -0.053251806646585464, -0.037665244191884995, -0.035473812371492386, 0.08300049602985382, 0.037829600274562836, -0.08031599223613739, 0.020010516047477722, 0.05358051881194115, -0.007539896760135889, -0.006396242883056402, 0.013271861709654331, 0.02876254916191101, -0.029776087030768394, -0.010970857925713062, -0.05927824229001999, -0.06278453767299652, 0.016928814351558685, -0.03221405670046806, -0.019558534026145935, -0.034597236663103104, -0.03361109271645546, -0.01724383234977722, -0.03917185217142105, -0.03840485215187073, -0.018668264150619507, -0.06667432934045792, 0.010409303940832615, 0.029776087030768394, -0.03410416468977928, 0.021503429859876633, -0.039884068071842194, -0.024461863562464714, -0.018640870228409767, 0.01899697817862034, 0.005372433457523584, 0.04667750746011734, 0.009108140133321285, 0.03591209650039673, 0.04344514384865761, 0.027173761278390884, 0.020996659994125366, -0.035309452563524246, 0.05752509832382202, -0.0387609601020813, 0.002162327291443944, -0.014011470600962639, -0.00029233365785330534, 0.06798918545246124, -0.04662272334098816, -0.055744558572769165, 0.008573979139328003, -0.029776087030768394, 0.007464566268026829, -0.002330108778551221, -0.0570320263504982, -0.02824208326637745, 0.053169626742601395, 0.02757095731794834, 0.032268840819597244, 0.026036955416202545, -0.024872757494449615, -0.02190062589943409, -0.050896015018224716, 0.020078998059034348, 0.017928656190633774, 0.025091899558901787, -0.00971763301640749, 0.027064189314842224, 0.013901898637413979, 0.004037029109895229, -0.03555598855018616, 0.04437650367617607, 0.03465202450752258, -0.02455773763358593, 0.032542768865823746, -0.012737700715661049, 0.05774424225091934, 0.0026417032349854708, -0.006581145338714123, -0.04911547526717186, -0.01226517278701067, -0.06064788997173309, 0.03865138813853264, -0.000919374346267432, -0.012806182727217674, -0.04977290704846382, 0.004410257562994957, 0.019065462052822113, -0.0019414720591157675, 0.03391241654753685, 0.021051445975899696, 0.04593789950013161, -0.027201153337955475, -0.06333239376544952, 0.06398982554674149, 0.025119293481111526, 0.015463294461369514, -0.019229818135499954, 0.0035371086560189724, -0.01103249192237854, -0.030214373022317886, -0.01766842231154442, -0.0182710662484169, 0.010512026958167553, -0.02757095731794834, 0.0062250373885035515, -0.020914481952786446, 0.02832426317036152, -0.023872915655374527, 0.010333972983062267, 0.01317598670721054, 0.013114352710545063, -0.026502635329961777, 0.04114414006471634, 0.010772259905934334, -0.019585926085710526, 0.003581622149795294, 0.0019431841792538762, 0.026872439309954643, 0.0066667478531599045, -0.055498022586107254, -0.010601053945720196, 0.03393980860710144, 0.026009561493992805, -0.0562102384865284, 0.029173443093895912, 0.023818129673600197, 0.034980736672878265, 0.05878517031669617, 0.03328237682580948, 0.009772418066859245, 0.03582991659641266, 0.01291575375944376, -0.007313905283808708, -0.027694225311279297, -0.020969267934560776, 0.04434911161661148, 0.0011248211376369, 0.005831264425069094, -0.06196274980902672, 0.032816700637340546, -0.005629241932183504, 0.024845363572239876, 0.02328396774828434, 0.02355789765715599, -0.04895111918449402, 0.030077408999204636, 0.0002561664441600442, 0.009772418066859245, 0.012395288795232773, -0.004964963998645544, 0.06590732932090759, -0.027447689324617386, -0.020832303911447525, 0.038048744201660156, 0.016339866444468498, -0.0005298815085552633, -0.006903011817485094, -0.03070744499564171, -0.0017839628271758556, -0.02873515710234642, -0.06004524603486061, 0.03374805673956871, -0.060867033898830414, 0.02707788534462452, -0.05418316274881363, -0.024174237623810768, -0.03807613626122475, -0.000512760947458446, 0.013114352710545063, -0.03807613626122475, 0.026598509401082993, -0.01572352647781372, 0.007409780286252499, -0.008313746191561222, -0.01777799427509308, 0.02754356525838375, -0.010525722987949848, 0.02815990522503853, -0.014586721546947956, -0.04889633506536484, -0.03402198851108551, -0.014874346554279327, 0.05774424225091934, -0.01794235222041607, 0.004667066037654877, -0.07839848846197128, 0.00949848908931017, -0.03577513247728348, -0.011374902911484241, -0.03922664001584053, 0.027310725301504135, 0.010292883962392807, 0.019065462052822113, 0.03172098100185394, 0.020024212077260017, 0.00771110225468874, -0.03925403207540512, 0.018873710185289383, -0.008169933222234249, 0.005276557989418507, 0.02027074806392193, -0.01420322060585022, -0.009238257072865963, 0.014682596549391747, 0.013114352710545063, -0.026530027389526367, 0.03613124042749405, 0.01175155583769083, -0.012730851769447327, -0.014860650524497032, 0.014436060562729836, -0.020092694088816643, 0.04689665138721466, 0.0051464419811964035, -0.015504383482038975, -0.000977584277279675, 0.03287148475646973, -0.03585731238126755, -0.03415895253419876, -0.011867975816130638, -0.010922920890152454, -0.025146685540676117, 0.010238097980618477, -0.027639439329504967, 0.04988247901201248, 0.008532889187335968, -0.004745820537209511, -0.004862240515649319, -0.0010803076438605785, 0.008204175159335136, 0.003403568407520652, -0.013217075727880001, 0.019805070012807846, -0.010128526017069817, 0.025598669424653053, -0.018284764140844345, 0.005910018924623728, -0.06623604148626328, 0.00827950518578291, 0.013963532634079456, 0.034980736672878265, -0.0099641690030694, 0.023105913773179054, 0.03911706805229187, 0.03410416468977928, -0.010607901960611343, 0.00023968791356310248, -0.022558055818080902, 0.017641030251979828, 0.023105913773179054, 0.04432171955704689, 0.040349747985601425, 0.050759050995111465, 0.01099140290170908, 0.013059566728770733, 0.05185476690530777, -0.037747420370578766, -0.0032392109278589487, -0.018613478168845177, 0.0083753801882267, -0.037720028311014175, -0.0009091019746847451, 0.025899991393089294, -0.00985459703952074, 0.07149548083543777, -0.04459564760327339, -0.0354464165866375, -0.06388024985790253, -0.032186660915613174, -0.058566030114889145, 0.017353404313325882, 0.04486957564949989, -0.05437491461634636, 0.022352609783411026, -0.03424112871289253, -0.020832303911447525, 0.002160615287721157, 0.04728015139698982, -0.03900749608874321, 0.014888043515384197, -0.05004683509469032, 0.04399300366640091, 0.03955535218119621, 0.005964804906398058, -0.022818289697170258, -0.016380956396460533, -0.02331136167049408, -0.03292626887559891, 0.018928496167063713, -0.017175350338220596, 0.0015887884655967355, -0.001672679209150374, -0.001407310483045876, 0.010861285962164402, -0.05492277070879936, 0.03446027263998985, 0.0021674635354429483, 0.0465131513774395, -0.017230136319994926, 0.006879042834043503, -0.03476159647107124, 0.08343878388404846, 0.0005649786326102912, 0.052731338888406754, 0.010587356984615326, 0.03703520447015762, 0.012744548730552197, -0.037829600274562836, -0.01927090808749199, 0.007423476781696081, 0.016572706401348114, 0.004793758038431406, 0.0008962615975178778, 0.035117704421281815, -0.008005576208233833, 0.005519669968634844, -0.030652659013867378, -0.004427378065884113, -0.032323624938726425, -0.0008012424223124981, 0.013518397696316242, 0.023626379668712616, -0.02688613533973694, -0.032707128673791885, -0.01658640243113041, 0.015367419458925724, -0.040349747985601425, 0.021832143887877464, 0.025338435545563698, 0.007683709729462862, 0.051087766885757446, 0.0025783570017665625, 0.0004592591430991888, 0.015819402411580086, 0.004276717081665993, 0.001876413938589394, -2.170834159187507e-05, 0.040678463876247406, -0.016093330457806587, 0.012518556788563728, 0.026228705421090126, 0.00894378311932087, -0.04188375174999237, -0.025297347456216812, -0.050402943044900894, 0.0005735389422625303, -0.015709830448031425, 0.009416311047971249, 0.018805228173732758, -0.029611729085445404, -0.02558497153222561, 0.050950802862644196, 0.02184584178030491, 0.010594205930829048, 0.029337799176573753, -3.5444918466964737e-05, -0.02433859556913376, 0.01112836692482233, 0.02095557190477848, 0.01929830014705658, 0.04481479153037071, -0.02881733514368534, 0.00431780656799674, -0.013169138692319393, 0.040349747985601425, 0.0059716529212892056, -0.02743399329483509, -0.007375539280474186, -0.02181844785809517, 0.0023797585163265467, -0.01175155583769083, -0.018558692187070847, -0.094122014939785, -0.015189365483820438, -0.019202426075935364, 0.007265967782586813, -0.011333813890814781, 0.0015476990956813097, -0.000233481710893102, -0.07412520051002502, -0.0007528768619522452, -0.007546745240688324, -0.01221038680523634, -0.0484580472111702, 0.027981851249933243, -0.010286035016179085, 0.01694251038134098, 0.010169615969061852, 0.0034943073987960815, 0.005053990986198187, -0.004454771056771278, 0.03161141276359558, -0.04391082376241684, -0.014422363601624966, 0.0269957073032856, 0.0545392706990242, -0.029063871130347252, 0.003312829416245222, -0.020777517929673195, -0.013518397696316242, -0.017230136319994926, 0.032816700637340546, 0.013086959719657898, -0.000853888166602701, -0.003978819120675325, 0.02431120164692402, -0.0274066012352705, -0.0013217076193541288, 0.01913394406437874, -0.043143823742866516, 0.002141782781109214, 0.0033111171796917915, -0.030241765081882477, -0.006163403391838074, -0.004009636119008064, -0.0044821640476584435, -0.02453034557402134, 0.02748877927660942, 0.014888043515384197, 0.001730889081954956, -0.02716006338596344, 0.01702469028532505, 0.004704731050878763, -0.027036795392632484, 0.004715003538876772, -0.04199331998825073, -0.04128110781311989, 0.0013516686158254743, 0.001612757216207683, -0.045335255563259125, 0.024626221507787704, -0.009751874022185802, 0.017599940299987793, -0.029913051053881645, 0.01588788442313671, 0.04481479153037071, -0.0030389002058655024, -0.03106355294585228, -0.047663651406764984, -0.02826947718858719, -0.001212136005051434, 0.01813410222530365, -0.03070744499564171, -0.05497755855321884, 0.00905335508286953, 0.0005050566396676004, -0.026776563376188278, -0.013477308675646782, 0.010005258023738861, 0.003917185124009848, -0.016627492383122444, -0.025365829467773438, 0.0005337336333468556, -0.011998091824352741, 0.005471732467412949, 0.0067009893245995045, -0.005485428962856531, -0.009971017017960548, -0.03835006430745125, -0.01921612210571766, -0.006913284305483103, -0.01783278025686741, -0.009765570051968098, 0.04108935594558716, -0.03131008893251419, 0.0033076931722462177, -0.03533684462308884, 0.010779107920825481, -0.0044992845505476, -0.009128685109317303, 0.0362682044506073, 0.005427218973636627, -0.025899991393089294, -0.04591050744056702, -0.005865505430847406, -0.029940443113446236, -0.02125689387321472, 0.040459319949150085, 0.008341139182448387, -0.0026742322370409966, 0.010279187001287937, 0.007943942211568356, -0.02361268363893032, 0.04237682372331619, -0.018709354102611542, 0.02027074806392193, 0.004732124041765928, -0.008532889187335968, 0.006896163336932659, 0.03300844877958298, -0.019996820017695427, -0.027872279286384583, 0.006793440319597721, 0.002417423762381077, -0.0024619372561573982, -0.03076223097741604, -0.04440389573574066, 0.030543087050318718, -0.010655839927494526, 0.020695338025689125, -0.016024848446249962, -0.02746138535439968, -0.029200835153460503, 0.000987856648862362, -0.011080429889261723, -0.06826311349868774, 0.008300050161778927, 0.003978819120675325, 4.246702758337051e-07, -0.03166619688272476, 0.045170899480581284, 0.040157996118068695, 0.03613124042749405, 0.014819560572504997, 0.010142222978174686, 0.012450074777007103, -0.0029310407117009163, 0.024379683658480644, 0.0013516686158254743, -0.00271018547937274, -0.032707128673791885, 0.010258642956614494, -0.004704731050878763, 0.02596847340464592, 0.027584653347730637, -0.04130849987268448, 0.0066427793353796005, -0.07467305660247803, -0.01379917562007904, 0.01677815429866314, -0.005488852970302105, 0.019996820017695427, 0.009471096098423004, 0.029392585158348083, 0.004824575036764145, -0.016874028369784355, 0.004841695539653301, -0.008861604146659374, -0.019339390099048615, -0.009334132075309753, 0.017147958278656006, -0.013374585658311844, 0.04656793549656868, -0.0057764784432947636, -0.10973597317934036, -0.003519988153129816, 0.009792963042855263, -0.030652659013867378, 0.00579359894618392, -0.030132194980978966, -0.012052877806127071, -0.014655203558504581, 0.006985190324485302, 0.04407518357038498, -0.037583064287900925, -0.026899831369519234, 0.01099140290170908, -0.0009587516542524099, 0.015326329506933689, -0.03081701695919037, 0.009621757082641125, 0.014655203558504581, 0.009977865032851696, -0.010073740035295486, -0.024817971512675285, -0.027981851249933243, 0.0019791373051702976, -0.0015160259790718555, -0.020640553906559944, 0.011374902911484241, -0.040240176022052765, -0.004639673046767712, -0.008978024125099182, -0.02303743176162243, 0.004701307043433189, 0.011820037849247456, 0.01363481767475605, 0.016079634428024292, -0.03070744499564171, -0.008615068159997463, 0.008197326213121414, -0.05270394682884216, 0.001720616826787591, -0.0308718029409647, -0.0014492558548226953, -0.04078803211450577, -0.0308718029409647, -0.016408350318670273, 0.04615704342722893, -0.009306739084422588, -0.005358736962080002, 0.007793281227350235, 0.002865982474759221, 0.009114989079535007, 0.0012557933805510402, -0.027749011293053627, 0.012552797794342041, 0.012004939839243889, -0.012354199774563313, -0.005187531001865864, -0.011915912851691246, 0.014901739545166492, 0.0007289080531336367, -0.010251794010400772, 0.008115148171782494, 0.0058072954416275024, 0.005656634457409382, -0.007334449794143438, 0.02876254916191101, 0.025324739515781403, -0.010751714929938316, 0.002718745730817318, -0.003293996676802635, -0.042842499911785126, 0.026639599353075027, -0.011210545897483826, -0.008156237192451954, 0.024681005626916885, 0.0019620168022811413, 0.015340026468038559, -0.0024431045167148113, -0.004964963998645544, 0.021434947848320007, 0.009916231036186218, 0.014004622586071491, -0.010491481982171535, 0.01932569406926632, 0.02439338155090809, -0.013449915684759617, -0.03303584083914757, -0.02748877927660942, -0.0398566760122776, -0.01899697817862034, -0.004680762533098459, -0.03158401697874069, -0.03089919500052929, -0.004300686065107584, 0.02868037112057209, -0.0025115867611020803, -0.0037117383908480406, 0.010785955935716629, -0.006064103916287422, -0.0894104391336441, -0.032405804842710495, 0.02101035788655281, -0.013847112655639648, 0.028009245172142982, -0.021106231957674026, -0.008950631134212017, 0.02081860788166523, 0.007683709729462862, -0.04396561160683632, 0.021434947848320007, -0.024708399549126625, -0.012587039731442928, 0.014066256582736969, 0.03689824044704437, -0.05774424225091934, 0.020750124007463455, -0.02640675939619541, 0.06305846571922302, -0.013045870698988438, 0.0031998336780816317, 0.015312633477151394, 0.020078998059034348, 0.02702309936285019, -0.00832059420645237, -0.007608379237353802, 0.025516489520668983, 0.022023893892765045, 0.006009318400174379, 0.026064347475767136, -0.017476672306656837, -0.027338117361068726, -0.002278747269883752, 0.050293371081352234, -0.035227272659540176, -0.0031998336780816317, -0.01713426224887371, 0.0015228742267936468, -0.005143017508089542, -0.018681960180401802, -0.004704731050878763, -0.05922345817089081, 0.034843772649765015, -0.021749965846538544, 0.040185388177633286, 0.011977546848356724, 0.019010676071047783, -0.001016961527056992, 0.042349427938461304, 0.004328078590333462, 0.02190062589943409, 0.007313905283808708, -0.01353894267231226, 0.020037909969687462, 0.013977229595184326, -0.02079121395945549, 0.019558534026145935, 0.00155026710126549, 0.04465043172240257, 0.02295525372028351, 0.0034669144079089165, 0.011217393912374973, 0.016572706401348114, -0.024817971512675285, -0.02829686924815178, -0.018339548259973526, -0.007423476781696081, 0.01677815429866314, 0.002063028048723936, -0.045554399490356445, -0.02355789765715599, 0.050649479031562805, -0.0039103371091187, 0.003478898899629712, -0.010648990981280804, 0.002064740052446723, 0.019695498049259186, 0.030570480972528458, -0.014066256582736969, -0.009293043054640293, 0.02231151983141899, -0.03826788812875748, 0.0014543919824063778, -0.007478262763470411, -0.012107663787901402, 0.01954483613371849, 0.022763503715395927, 0.004968388006091118, -0.0009253665339201689, 0.04747190326452255, 0.029748693108558655, -0.007183789275586605, 0.02837904915213585, -0.02854340523481369, 0.003490883158519864, 0.00516356248408556, 0.006183947902172804, 0.01288836169987917, 0.024681005626916885, -0.0009904246544465423, 0.027831191197037697, 0.03854181617498398, -0.04171939194202423, -0.014751078560948372, -0.01846281811594963, 0.015148275531828403, -0.009587516076862812, -0.0026091740000993013, -0.001056338893249631, -0.019257212057709694, 0.005937411915510893, 0.008656157180666924, -0.0016238855896517634, -0.008923238143324852, 0.006279823370277882, 0.008258960209786892, 0.040157996118068695, 0.03125530481338501, 0.010388758964836597, 0.011594046838581562, 0.010717473924160004, 0.007320753764361143, -0.023188093677163124, -0.0038932163733989, -0.040294960141181946, -0.03944578021764755, 0.016791850328445435, 0.006163403391838074, -0.010155919007956982, -0.005232044495642185, 0.022914163768291473, -0.012004939839243889, -0.01965440809726715, -0.0033367981668561697, -0.00843016617000103, 0.005071111489087343, 0.008416470140218735, 0.02610543742775917, -0.021106231957674026, 0.0274066012352705, 0.0040849666111171246, -0.0022342337761074305, 0.011059884913265705, -0.017819084227085114, 0.002847149968147278, -0.026817653328180313, -0.005855233408510685, -0.04366428777575493, -0.01894219219684601, -0.02632458135485649, 0.038021352142095566, 0.01699729636311531, -0.027858583256602287, 0.03851442411541939, 0.022489573806524277, 0.009265650063753128, -0.010060044005513191, -0.045773543417453766, -0.02594107948243618, 0.029666515067219734, 0.018202584236860275, 0.03662431240081787, 0.007649468258023262, -0.02201019786298275, 0.02201019786298275, -0.030241765081882477, -0.0134978536516428, -0.00623530987650156, -0.04670489951968193, 0.03662431240081787, -0.012176145799458027, 0.010690080933272839, 0.045170899480581284, 0.03393980860710144, 0.006495542358607054, 0.035062916576862335, 0.021585607901215553, -0.005091655999422073, 0.02558497153222561, 0.023914005607366562, 0.02751617133617401, -0.0008312034187838435, -0.006930404808372259, -0.0068037123419344425, 0.02843383513391018, 0.005622393451631069, 0.0012592175044119358, 0.002191432286053896, -0.0033607669174671173, 0.03698042035102844, -0.014860650524497032, 0.00424247607588768, 0.004239052068442106, 0.06037396192550659, 0.002689640736207366, -0.045307863503694534, 0.023598987609148026, 0.019640712067484856, -0.02217455580830574, -0.01547699049115181, 0.011415992863476276, 0.04903329908847809, 0.0020887090358883142, 0.0032820121850818396, -0.03678866848349571, 0.05960695818066597, -0.011511867865920067, -0.020640553906559944, -0.0031827129423618317, 0.016545314341783524, -0.004410257562994957, -0.0029036477208137512, -0.010792803950607777, 0.029776087030768394, -0.008382228203117847, 0.002778667723760009, 0.023763343691825867, 0.01046408899128437, -0.03111833892762661, -0.02635197341442108, -0.04958115518093109, -0.03703520447015762, -0.023571593686938286, 0.0039480021223425865, -0.01451823953539133, 0.009402614086866379, 0.0035165641456842422, -0.008875301107764244, 0.001956880558282137, -0.011484474875032902, -0.0020596040412783623, -0.006300367880612612, -0.007163244299590588, 0.0031073824502527714, 0.0420754998922348, -0.004721852019429207, 0.02168148383498192, -0.00913553312420845, -4.296191764296964e-05, 0.01588788442313671, 0.017627334222197533, 0.0069475253112614155, 0.018312156200408936, 0.0134293707087636, -0.0009407750330865383, 0.0019791373051702976, 0.029858265072107315, 0.034816380590200424, -0.02898169308900833, -0.015709830448031425, -0.005896322429180145, 0.004399985074996948, 0.0272696353495121, 0.009484793059527874, 0.02818729728460312, -0.005105352494865656, 0.021339071914553642, 0.032241448760032654, 0.026173919439315796, 0.04385603964328766, -0.0067146853543818, 0.02192801982164383, -0.006581145338714123, -0.0210377499461174, 0.02336614765226841, -0.014545631594955921, 0.002131510293111205, -0.001212136005051434, 0.006564024370163679, 0.025927383452653885, -0.07007104903459549, 0.02203759178519249, 0.004845120012760162, 0.02101035788655281, -0.018175192177295685, -0.03303584083914757, 0.009430007077753544, -0.016463134437799454, 0.01251170877367258, 0.016572706401348114, -0.03289887681603432, -0.029255621135234833, 0.01421691756695509, -0.018914800137281418, 0.0160522423684597, -0.0111420638859272, -0.03454245254397392, -0.015298936516046524, 0.04144546389579773, -0.04470521956682205, -0.019175032153725624, 0.02898169308900833, -0.01672336831688881, -0.006043559405952692, -0.024023577570915222, 0.019120246171951294, -0.0066085378639400005, 0.009806660003960133, 0.022325215861201286, -0.032570160925388336, 0.00847125519067049, 0.008717792108654976, 0.00975872203707695, -0.006283247377723455, 0.0156413484364748, 0.003684345632791519, -0.00708106579259038, -0.06656475365161896, 0.016408350318670273, 0.0029892507009208202, -0.019092854112386703, 0.020092694088816643, 0.012093966826796532, 0.00920401606708765, 0.01818888820707798, -0.021393857896327972, -0.00949848908931017, -0.030625266954302788, 0.0043965610675513744, -0.0027855159714818, -0.0003240066871512681, 0.0042287795804440975, 0.00894378311932087, -0.000547858071513474, -0.024242719635367393, -0.0032323626801371574, 0.02239369973540306, -0.002463649259880185, 0.02832426317036152, 0.015627652406692505, 0.00431780656799674, 0.00027692512958310544, -0.01766842231154442, 0.029173443093895912, -0.01173785887658596, 0.0017634182004258037, -0.01410734560340643, -0.01252540573477745, -0.0016196054639294744, -0.022777199745178223, 0.023653771728277206, -0.0061154658906161785, -0.01786017417907715, 0.00025766450562514365, 0.010436696000397205, -0.00356107740662992, -0.017682120203971863, 0.022558055818080902, 0.008991721086204052, -0.014614114537835121, 0.06842747330665588, 0.010690080933272839, -0.014066256582736969, 0.00712215481325984, -0.01981876604259014, 0.034734200686216354, -0.021749965846538544, 0.001799371326342225, -0.03133748099207878, 0.0037117383908480406, -0.004406833555549383, 0.009628606028854847, -0.024900149554014206, -0.0026280067395418882, 0.0206268560141325, -0.009532731026411057, -0.03070744499564171, -0.009347828105092049, -0.02206498384475708, 0.005416946951299906, 0.026173919439315796, 0.029940443113446236, -0.0003687341813929379, -0.025201471522450447, -0.0036124391481280327, -0.008149389177560806, 0.011025643907487392, 0.004893057513982058, 0.03393980860710144, 0.0683726891875267, 0.006762623321264982, -0.03180316090583801, -0.05223826691508293, 0.015326329506933689, -0.017175350338220596, 0.030625266954302788, -0.04087021201848984, 0.02453034557402134, -0.02179105579853058, -0.011347510851919651, 0.024023577570915222, 0.0027752434834837914, 0.00398566760122776, 0.023242879658937454, -0.014038863591849804, -0.012217234820127487, -0.005084807984530926, 0.0024431045167148113, -0.020914481952786446, -0.012443226762115955, -0.015025007538497448, -0.016983600333333015, 0.014942829497158527, -0.012758244760334492, 0.0031638804357498884, -0.015819402411580086, -0.01053257193416357, 0.04412996768951416, 0.02101035788655281, 0.026036955416202545, -0.029666515067219734, 0.011977546848356724, 0.004215083085000515, -0.007313905283808708, -0.0155728654935956, -0.04634879156947136, -0.021804751828312874, -0.006409939378499985, 0.010053195990622044, 0.024708399549126625, -0.01112836692482233, 0.007800129242241383, 0.0016803834587335587, -0.0007464566151611507, 0.02824208326637745, 0.021571911871433258, 0.01979137398302555, 0.0047287000343203545, 0.021297981962561607, 0.07127633690834045, -0.0354464165866375, -0.004362320061773062, -0.013011629693210125, 0.017956048250198364, 0.014340185560286045, -0.009594365023076534, 0.027365511283278465, -0.019558534026145935, -0.02181844785809517, 0.004629400558769703, 0.01650422438979149, -0.006635930854827166, 0.04174678400158882, 0.04095239192247391, -0.007265967782586813, -0.01385396160185337, -0.029228229075670242, 0.005427218973636627, 0.03374805673956871, 0.012744548730552197, -0.011347510851919651, -0.012621280737221241, -0.03643256053328514, -0.021558215841650963, -0.01940787211060524, 0.007943942211568356, -0.032570160925388336, 0.005814143922179937, 0.009224560111761093, 0.01976398006081581, -0.02209237776696682, -0.01276509277522564, 0.023859219625592232, 0.026762867346405983, 0.012648673728108406, -0.001159918261691928, -0.009457400068640709, 0.013244468718767166, -0.01669597439467907, -0.0365421324968338, 0.023872915655374527, 0.015463294461369514, 0.014764775522053242, 0.008039817214012146, -0.0167507603764534, -0.01103249192237854, 0.008594523184001446, -0.030159587040543556, -0.0018010834464803338, -0.006964645814150572, -0.012066573835909367, -0.009430007077753544, 0.01103249192237854, -0.012607583776116371, 0.03659692034125328, 0.02691352739930153, -3.103102471868624e-06, -0.002727305982261896, -0.011121518909931183, -0.00026280066231265664, 0.022297823801636696, 0.040514104068279266, 0.018901104107499123, 0.03374805673956871, 0.03120051696896553, -0.032570160925388336, 0.00832059420645237, -0.011265331879258156, 0.017298618331551552, -0.009875142015516758, -0.011833734810352325, -0.006735230330377817, 0.012854119762778282, 0.016243992373347282, 0.003288860432803631, -0.023105913773179054, 0.012299413792788982, -0.016819242388010025, 0.00658799335360527, -0.019339390099048615, -0.012648673728108406, 0.007348146289587021, -0.006793440319597721, 0.004732124041765928, 0.032761912792921066, -0.048101939260959625, -0.020051605999469757, 0.01414843462407589, 0.005273133981972933, 0.020887089893221855, -0.0034052804112434387, 0.032624948769807816, -0.021969109773635864, 0.0003263607795815915, 0.004954691510647535, -0.012867816723883152, 0.001276338123716414, -0.01046408899128437, 0.015408508479595184, 0.0272696353495121, -0.0089985691010952, -0.004588311538100243, 0.004290413577109575, -0.013100656680762768, -0.035035524517297745, 0.010279187001287937, -0.002610886236652732, 0.0006338889361359179, -0.02328396774828434, -0.016079634428024292, 0.0029053599573671818, -0.019750284031033516, 0.027091581374406815, 0.01849021017551422, 0.01440866757184267, 0.026365669444203377, 0.010060044005513191, 0.032953664660453796, 0.02558497153222561, 0.01047778595238924, -0.00769055774435401, -0.00852604117244482, 0.012189841829240322, -0.005303950980305672, -0.016367260366678238, 0.022777199745178223, 0.002593765500932932, 0.011785796843469143, -0.018846318125724792, -0.010566812939941883, -0.010306579992175102, -0.03347412869334221, 0.0061668273992836475, 0.011415992863476276, 0.008067210204899311, -0.022585449740290642, -0.010450392961502075, 0.008683550171554089, -0.047663651406764984, -0.01410734560340643, -0.013401978649199009, 0.01385396160185337, 0.006807136815041304, -0.00199283380061388, -0.007560441270470619, 0.020804909989237785, 0.002129798289388418, -0.027420297265052795, -0.009073899127542973, 0.03711738437414169, 0.0001749507791828364, 0.005345040466636419, -0.0033333739265799522, -0.006067528389394283, 0.003295708680525422, -0.01791495829820633, 0.005324495490640402, -0.011251634918153286, 0.015792008489370346, 0.003841854864731431, -0.007717950735241175, 0.016271384432911873, -0.0017154805827885866, 0.026721777394413948, -0.026228705421090126, 0.05763467028737068, 0.03089919500052929, 0.02322918176651001, -0.011532412841916084, 0.029173443093895912, -0.004218507092446089, 0.025324739515781403, 0.004992356523871422, -0.03413155674934387, -0.0037220108788460493, -0.04947158321738243, -0.01713426224887371, -0.016682278364896774, 0.01694251038134098, -0.023968791589140892, -0.029392585158348083, -0.02314700372517109, 0.0015845083398744464, -0.006772895343601704, -0.040349747985601425, 0.037500884383916855, -0.035117704421281815, 0.016257688403129578, -0.013100656680762768, -0.004564342554658651, -0.0006043559405952692, -0.009409462101757526, -0.0007729934877716005, 0.009977865032851696, 0.017682120203971863, 0.034597236663103104, 0.01957223005592823, 0.0012155601289123297, 0.022777199745178223, -0.017531458288431168, 0.01047778595238924, -0.01816149614751339, -0.020133784040808678, -0.003013219451531768, 0.025982169434428215, 0.01036821398884058, -0.01363481767475605, -0.02361268363893032, 0.029913051053881645, 0.02181844785809517, -0.013874505646526814, 0.018955890089273453, 0.01791495829820633, -0.037500884383916855, -0.010792803950607777, 0.005786750931292772, -0.013942987658083439, -0.018229978159070015, -0.015449597500264645, 0.023996183648705482, -0.017353404313325882, -0.020051605999469757, -5.3180756367510185e-05, -0.0007798417354933918, 0.008395925164222717, 0.07034497708082199, 0.0005487141315825284, 0.024763185530900955, -0.011532412841916084, 0.014970221556723118, -0.009786115027964115, 0.022900467738509178, -0.005327919963747263, 0.003247771179303527, -0.016148116439580917, 0.006409939378499985, -0.003756251884624362, 0.03287148475646973, -0.021270589902997017, 0.043034251779317856, -0.015449597500264645, -0.000576963066123426, 0.006906435824930668, 0.01409364864230156, 0.0016315898392349482, 0.030570480972528458, -0.034898560494184494, 0.05136169493198395, 0.02333875373005867, -0.00032464871765114367, 0.02859819121658802, -0.00021678915072698146, 0.019339390099048615, -0.004738972522318363, -0.012203538790345192, -0.005577879957854748, 0.0033094051759690046, 0.02474948950111866, 0.024174237623810768, -0.02322918176651001, -0.03887053206562996, -0.005396401975303888, -0.004221931099891663, -0.011669376865029335, -0.01553177647292614, -0.0024773457553237677, 0.012504860758781433, 0.005574455950409174, -0.008046665228903294, -0.011552956886589527, 0.04174678400158882, 0.024160541594028473, 0.03613124042749405, -0.004988932516425848, 0.03465202450752258, 0.0390348881483078, -0.010286035016179085, -0.02420162968337536, -0.02889951318502426, 0.012552797794342041, -0.029556943103671074, -0.011799493804574013, 0.032624948769807816, -0.003684345632791519, 0.005036870017647743, 0.021558215841650963, 0.01566874049603939, -0.014860650524497032, -0.023818129673600197, -0.03717217221856117, -0.01062844693660736, 0.024064665660262108, 0.010491481982171535, 0.03363848477602005, -0.04054149612784386, -0.011121518909931183, -0.0073892357759177685, -0.030159587040543556, -0.0036329838912934065, -0.026475241407752037, 0.026803957298398018, -0.013100656680762768, -0.001363652991130948, -0.03095398098230362, 0.0003428393101785332, 0.01414843462407589, -0.0034309611655771732, 0.0287899412214756, -0.017435584217309952]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
"marization Branches Out ,
pp. 74–81, Barcelona, Spain, July 2004. Association for
Computational Linguistics.
Liu, Z., Desai, A., Liao, F., Wang, W., Xie, V ., Xu, Z.,
Kyrillidis, A., and Shrivastava, A. Scissorhands: Ex-
ploiting the persistence of importance hypothesis for
llm kv cache compression at test time. arXiv preprint
arXiv:2305.17118 , 2023a.
Liu, Z., Oguz, B., Zhao, C., Chang, E., Stock, P., Mehdad,
Y ., Shi, Y ., Krishnamoorthi, R., and Chandra, V . LLM-
QAT: Data-free quantization aware training for large lan-
guage models. arXiv preprint arXiv:2305.17888 , 2023b.
Mao, Y ., Ester, M., and Li, K. Iceformer: Accelerated infer-
ence with long-sequence transformers on CPUs. In Third
Workshop on Efficient Natural Language and Speech Pro-
cessing (ENLSP-III): Towards the Future of Large Lan-
guage Models and their Emerging Descendants , 2023.
Merity, S., Xiong, C., Bradbury, J., and Socher, R.
Pointer sentinel mixture models. arXiv preprint
arXiv:1609.07843 , 2016.
NVIDIA. NVIDIA A10 datasheet. (Online: ac-
cessed 22 January 2024), March 2022. URL
https://www.nvidia.com/content/dam/
en-zz/Solutions/Data-Center/a10/pdf/
datasheet-new/nvidia-a10-datasheet.
pdf.
9
SparQ Attention: Bandwidth-Efficient LLM Inference
NVIDIA. NVIDIA H100 datasheet. (Online: accessed
22 January 2024), July 2023. URL https://www.
nvidia.com/en-gb/data-center/h100/ .
Paszke, A., Gross, S., Massa, F., Lerer, A., Bradbury, J.,
Chanan, G., Killeen, T., Lin, Z., Gimelshein, N., Antiga,
L., et al. Pytorch: An imperative style, high-performance
deep learning library. Advances in neural information
processing systems , 32, 2019.
Pope, R., Douglas, S., Chowdhery, A., Devlin, J., Bradbury,
J., Heek, J., Xiao, K., Agrawal, S., and Dean, J. Efficiently
scaling transformer inference. Proceedings of Machine
Learning and Systems , 5, 2023.
Radford, A., Narasimhan, K., Salimans, T., and Sutskever,
I. Improving language understanding by generative
pre-training. (Online: accessed 29 January 2024),
2018. URL https://openai.com/research/
language-unsupervised .
Rajpurkar, P., Zhang, J., Lopyrev, K., and Liang, P. SQuAD:
100,000+ questions for machine comprehension of text.
arXiv preprint arXiv:1606.05250 , 2016.
Ren, H., Dai, H., Dai, Z., Yang, M., Leskovec, J., Schuur-
mans, D., and Dai, B. Combiner: Full attention trans-
former with sparse computation cost. Advances in Neural
Information Processing Systems , 34:22470–22482, 2021.
Roche, A., Malandain, G., Pennec, X., and Ayache, N. The
correlation ratio as a new similarity measure for multi-
modal image registration. In Medical Image Computing
and Computer-Assisted Intervention — MICCAI’98: First
International Conference Cambridge, MA, USA, October
11–13, 1998 Proceedings 1 , pp. 1115–1124. Springer,
1998.
Rosenblatt, M. Remarks on Some Nonparametric Estimates
of a Density Function. The Annals of Mathematical Statis-
tics, 27(3):832 – 837, 1956.
See, A., Liu, P. J., and Manning, C. D. Get to the point:
Summarization with pointer-generator networks. arXiv
preprint arXiv:1704.04368 , 2017.
Shazeer, N. Fast transformer decoding: One write-head is
all","[-0.004212293308228254, 0.031117577105760574, 0.00931450817734003, -0.028077011927962303, 0.017872583121061325, 0.0022340728901326656, -0.022589165717363358, 0.04200427979230881, -0.061701200902462006, 0.005194914527237415, 0.031206568703055382, -0.015291811898350716, -0.016300389543175697, 0.027557892724871635, -0.004846362397074699, -0.006081128027290106, 0.04446639493107796, -0.029619542881846428, 0.03182951360940933, 0.04660220444202423, -0.0007230609189718962, -0.01597408391535282, 0.004557137843221426, 0.015380804426968098, 0.020023226737976074, 0.008439418859779835, 0.00972980447113514, 0.022129373624920845, 0.034677259624004364, -0.051852740347385406, -0.004657254088670015, -0.03464759886264801, -0.015588452108204365, -0.006811604835093021, -0.004542306065559387, 0.0486786887049675, 0.02211454138159752, 0.009151356294751167, -0.03263044357299805, 0.016700854524970055, 0.017012326046824455, -0.04847103729844093, -0.03298640996217728, 0.02379055880010128, 0.002844039583578706, -0.007720066234469414, 0.015262147411704063, -0.03417297080159187, 0.0009061436867341399, 0.052564676851034164, -0.04348748177289963, 0.03171085566282272, -0.036071471869945526, 0.02163991704583168, -0.034588269889354706, -0.009811380878090858, -0.01828788034617901, 0.04093637317419052, 0.03731736168265343, -0.011984271928668022, 0.014038505963981152, -0.07469405233860016, 0.0017650102963671088, 0.008239186368882656, -0.052831653505563736, 0.005402563139796257, -0.04698783531785011, 0.024932624772191048, -0.015677444636821747, 0.01500258781015873, 0.007301061414182186, 0.03737668693065643, 0.057755883783102036, -0.03586382418870926, -0.003952733241021633, 0.011175926774740219, -0.021580588072538376, 0.09183986485004425, -0.01119075808674097, -0.006359228398650885, 0.0071527413092553616, 0.0038377849850803614, 0.022411180660128593, -0.05520477518439293, -0.05013222619891167, -0.023212110623717308, 0.006051464006304741, -0.0014349978882819414, -0.04633522778749466, 0.0037673329934477806, -0.029397062957286835, -0.004260497633367777, -0.02031986601650715, -0.009522156789898872, 0.05167475342750549, 0.0024806552100926638, 0.011235254816710949, -0.0030832060147076845, 0.041737303137779236, 0.054166533052921295, -0.001153189456090331, 0.003138825995847583, 0.03663508594036102, -0.04796674847602844, 0.03156253695487976, -0.010716133750975132, -0.010627142153680325, -0.05953572690486908, -0.017561111599206924, 0.021461931988596916, -0.09937453269958496, -0.005647291429340839, -0.056272681802511215, 0.036071471869945526, 0.0007133274339139462, -0.03663508594036102, -0.03921585902571678, -0.03055395931005478, -0.032956745475530624, 0.029945846647024155, -0.04155931621789932, -0.011650551110506058, 0.041084691882133484, 0.02726125158369541, 0.02390921488404274, -0.0450003482401371, 0.0382072813808918, -0.053543590009212494, 0.016181733459234238, -0.03191850706934929, 0.02981235831975937, 0.0007114734034985304, 0.04559362679719925, -0.032482121139764786, -0.01609273999929428, -0.03325338661670685, 0.002209970960393548, -0.006885765120387077, -0.04298319295048714, 0.015914756804704666, 0.02766171656548977, -0.010456573218107224, -0.028818612918257713, 0.02043852210044861, -0.027765540406107903, 0.0003738132363650948, -0.022752316668629646, 0.008202106691896915, -0.012881608679890633, 0.006945093162357807, 0.0010336063569411635, -0.03046496771275997, -0.048619359731674194, -0.016241060569882393, -0.06092993542551994, -0.058616138994693756, 0.004831530153751373, 0.05630234628915787, 0.020186377689242363, -0.06437095999717712, -2.155277798010502e-05, 0.03239313140511513, 0.008038954809308052, -0.0014720779145136476, 0.03082093596458435, 0.03274909779429436, -0.03046496771275997, -0.022722654044628143, -0.0640743225812912, -0.06621013581752777, -0.005803027655929327, -0.05496746301651001, -0.008891795761883259, -0.0350925587117672, 0.003733960911631584, -0.01328207366168499, -0.025689058005809784, -0.044703707098960876, -0.0031406800262629986, -0.05028054490685463, -0.01177662331610918, 0.04066939651966095, -0.010575229302048683, 0.020720330998301506, -0.009536988101899624, -0.019800744950771332, 0.007367805577814579, 0.0413220040500164, 0.02082415483891964, 0.03171085566282272, -0.0003258409269619733, 0.052179042249917984, 0.03277876228094101, 0.03844459354877472, -0.014965507201850414, -0.036071471869945526, 0.04989491403102875, -0.03423229977488518, 0.01762043870985508, -0.05093315243721008, 0.009952285327017307, 0.03891921788454056, -0.003765478963032365, -0.0406397320330143, 0.01025634165853262, -0.0029608418699353933, -0.0026419535279273987, -0.006314732134342194, -0.03995746001601219, -0.02386471815407276, 0.05176374688744545, 0.018198886886239052, 0.05250534787774086, -0.001392355770803988, -0.023760894313454628, -0.010182181373238564, -0.03687239810824394, 0.02957504615187645, 0.0075532058253884315, 0.04161864519119263, -0.020809322595596313, 0.0283588208258152, 0.025333089753985405, 0.01219191960990429, -0.038029298186302185, 0.04695817455649376, 0.024665648117661476, -0.030331479385495186, 0.03316439688205719, -0.03660542517900467, 0.0640743225812912, 0.01937061734497547, -0.021165290847420692, -0.03613079711794853, -0.008135362528264523, -0.033609356731176376, 0.024947457015514374, -0.03304573893547058, -0.016745349392294884, -0.04894566535949707, -0.0078090582974255085, -0.006147872190922499, 0.02089831605553627, 0.016611861065030098, 0.015032251365482807, 0.03485524654388428, -0.02957504615187645, -0.05099248141050339, 0.03859291598200798, 0.010597477667033672, -0.006544628646224737, -0.023508749902248383, -0.02324177511036396, 0.004861194174736738, -0.042716216295957565, -0.032096490263938904, -0.020305033773183823, 0.0011392844608053565, 0.0078016421757638454, 0.023820223286747932, -0.026742130517959595, 0.012851945124566555, -0.009440580382943153, -0.0038859890773892403, 0.01621139794588089, 0.010760629549622536, -0.01862901635468006, 0.032867755740880966, -0.010634558275341988, -0.014394475147128105, 0.00668924069032073, 0.0003756672376766801, 0.017279302701354027, 0.017783591523766518, -0.05879412591457367, 0.004709166008979082, 0.030375976115465164, 0.021239452064037323, -0.03188884258270264, 0.026949778199195862, 0.02137294039130211, -0.0054062712006270885, 0.06466760486364365, 0.024191023781895638, -0.004434773698449135, 0.013600961305201054, 0.0067077805288136005, 0.010145100764930248, -0.03381700441241264, -0.019118472933769226, 0.030049670487642288, -0.019266793504357338, 0.02137294039130211, -0.05007289722561836, 0.044318072497844696, 0.012495975941419601, 0.017590774223208427, 0.002916345838457346, 0.021298779174685478, -0.021402603015303612, 0.04817439988255501, -0.02132844366133213, 0.03274909779429436, 0.0053914389573037624, -0.007516125682741404, 0.05867546796798706, -0.04055074229836464, -0.017561111599206924, 0.010345333255827427, 0.025926370173692703, -0.006070003844797611, 0.009225515648722649, -0.013971761800348759, -0.001018774346448481, -0.05742957815527916, -0.027646884322166443, 0.05579805746674538, -0.048738013952970505, 0.001144846435636282, -0.051437441259622574, -0.006700364872813225, -0.04698783531785011, 0.020186377689242363, -0.01007835753262043, -0.023968543857336044, 0.030375976115465164, -0.026193346828222275, 0.010871870443224907, 0.0012125176144763827, -0.025303425267338753, 0.03479591757059097, 0.00412330124527216, 0.02180306799709797, -0.005372899118810892, -0.04660220444202423, -0.03129556030035019, -0.013630625791847706, 0.027483731508255005, -0.02379055880010128, 0.02046818658709526, -0.06472693383693695, -0.020008394494652748, -0.048500701785087585, -0.008291099220514297, -0.019162969663739204, 0.047254811972379684, 0.0026734715793281794, 0.016982661560177803, 0.0450003482401371, -0.0016120551154017448, 0.0033946784678846598, -0.01340072974562645, 0.035329870879650116, -0.0010234093060716987, 0.030731944367289543, 0.030731944367289543, 0.0072269015945494175, -0.03251178562641144, 0.002886681817471981, 0.005191206932067871, -0.009017867967486382, 0.025956032797694206, 0.03277876228094101, -0.022959966212511063, -0.02789902873337269, 0.00632956437766552, -0.013667705468833447, 0.05167475342750549, 0.010345333255827427, -0.015514291822910309, 0.002525151241570711, 0.054908134043216705, -0.01738312654197216, -0.026000529527664185, -0.010834789834916592, -0.005131878890097141, -0.02675696276128292, 0.02120978757739067, 0.018688343465328217, 0.041499990969896317, -0.0004567798459902406, -0.0041603813879191875, -0.012785200960934162, 0.0028254997450858355, 0.0025585233233869076, 0.017397958785295486, 0.0014275818830356002, 0.02269298955798149, -0.016226228326559067, 0.0016546971164643764, -0.03411364555358887, -0.024902960285544395, -0.04796674847602844, 0.020542345941066742, 0.016344884410500526, 0.038503922522068024, 0.00845425110310316, 0.01750178262591362, 0.029515719041228294, 0.031206568703055382, -0.007434549741446972, 0.009900372475385666, -0.0037135668098926544, -0.008313346654176712, 0.015469796024262905, 0.052090052515268326, 0.03337204456329346, 0.040254101157188416, 0.022603997960686684, 0.014639203436672688, 0.04366546496748924, -0.06306574493646622, 0.011005357839167118, -0.032244808971881866, 0.012288328260183334, -0.055056456476449966, -0.0040046451613307, 0.009270012378692627, 0.007482753600925207, 0.047640446573495865, -0.016537701711058617, 0.012926104478538036, -0.04704716429114342, -0.016463540494441986, -0.06122657656669617, 0.01668602228164673, 0.034944236278533936, -0.06846459954977036, 0.046513210982084274, -0.032867755740880966, -0.0209428109228611, -0.023731231689453125, 0.026089521124958992, -0.01275553647428751, -0.009344171732664108, -0.04606825113296509, 0.01213259156793356, 0.0641336515545845, 0.026653138920664787, -0.03897854685783386, -0.031473543494939804, -0.0019226005533710122, -0.032452456653118134, -0.011695046909153461, -0.052208706736564636, -0.015870260074734688, 0.02620817720890045, 0.013778946362435818, 0.018881160765886307, -0.03082093596458435, 0.0169529989361763, -0.02183273248374462, 0.042834870517253876, 0.002009738702327013, -0.020052889361977577, -0.02417619153857231, 0.07309219241142273, -0.007556913886219263, 0.018376871943473816, -0.031117577105760574, 0.02312311716377735, 0.007705233991146088, -0.03399498760700226, -0.009581484831869602, -0.004130717366933823, 0.0013200497487559915, 0.006882057059556246, -0.002243342809379101, 0.05567939952015877, 0.0016445001820102334, 0.007964794524013996, -0.0227819811552763, -0.008142778649926186, -0.019682088866829872, 0.004861194174736738, 0.014149745926260948, 0.02297479845583439, -0.05211971700191498, -0.00592909986153245, -0.04630556330084801, 0.008083450607955456, -0.06294708698987961, 0.008038954809308052, 0.022010715678334236, 0.007823890075087547, 0.10038310289382935, 0.03280842676758766, 0.01459470670670271, 0.0039416090585291386, -0.011576390825212002, -0.002690157387405634, 0.003726544789969921, 0.06128590181469917, -0.01871800795197487, -0.005480431020259857, 0.0032463581301271915, -0.012310575693845749, -0.02871478907763958, -0.0011309414403513074, -0.03921585902571678, 0.002156204776838422, -0.016389381140470505, 0.02558523416519165, 0.016508037224411964, -0.012406984344124794, -0.009032699279487133, 0.042716216295957565, 0.023924047127366066, -0.021476764231920242, 0.04167797416448593, 0.02199588529765606, 0.007078581023961306, -0.019014649093151093, 0.037643663585186005, 0.0022359269205480814, 0.04161864519119263, -0.013489721342921257, 0.008276266977190971, -0.013526801951229572, 0.03227447345852852, 0.0030646659433841705, -0.039631154388189316, 0.013200497254729271, -0.013586129993200302, -0.0009835482342168689, -0.011109182611107826, -0.029397062957286835, -0.08199140429496765, -0.012940936721861362, -0.0505475215613842, 0.012473728507757187, -0.032600779086351395, -0.01914813742041588, 0.023063790053129196, -0.05704394727945328, 0.0011402114760130644, 0.007964794524013996, -0.03298640996217728, -0.06087060645222664, 0.000328853668179363, 0.0023397509939968586, 0.016537701711058617, -0.009826213121414185, 0.0020041766110807657, -0.0009320997050963342, -0.02223319746553898, 0.03770299255847931, -0.03710971400141716, -0.012488559819757938, 0.009870708920061588, 0.035804495215415955, -0.04138133302330971, 0.009714972227811813, -0.00542851909995079, -0.013141169212758541, -0.00253442139364779, 0.036902062594890594, 0.009410915896296501, -0.009054947644472122, -0.033846668899059296, 0.011220422573387623, -0.011650551110506058, -0.0022841310128569603, -0.0012913126265630126, -0.04461471363902092, -0.00886954739689827, 0.020987307652831078, -0.03464759886264801, 0.015914756804704666, -0.017412791028618813, 0.006444512400776148, -0.028610965237021446, 0.0172644704580307, -0.011101766489446163, -0.005113338585942984, -0.032452456653118134, 0.005602795165032148, -0.004093637224286795, -0.025956032797694206, 0.0029311778489500284, -0.04514866694808006, -0.025496240705251694, -0.022900637239217758, 0.0036746328696608543, -0.03438062220811844, 0.04052107781171799, 0.0035837865434587, 0.03835560008883476, -0.026341665536165237, 0.0008208595681935549, 0.05926875025033951, -0.018881160765886307, -0.033698346465826035, -0.04434773698449135, -0.017561111599206924, 0.0035949107259511948, 0.022603997960686684, -0.035685837268829346, -0.0517340824007988, 0.025288593024015427, 0.013074425049126148, -0.009017867967486382, -0.008157610893249512, 0.0006553898565471172, -0.0070118373259902, -0.007794226054102182, -0.02706843428313732, -0.0018345353892073035, 0.018139559775590897, -0.005736283492296934, -0.026667971163988113, 0.012355072423815727, -0.007690402213484049, -0.030375976115465164, -0.0203495305031538, 0.02758755534887314, -0.026593809947371483, -0.01668602228164673, 0.048233725130558014, -0.0157071091234684, -0.005443350877612829, -0.04847103729844093, -0.007026669103652239, 0.01937061734497547, -0.004282745532691479, 0.02417619153857231, -0.0077274818904697895, -0.03067261539399624, -0.05683629959821701, -0.009099443443119526, -0.036160461604595184, -0.004279037471860647, 0.0418856218457222, 0.045801274478435516, 0.009477660059928894, 0.0016129821306094527, 2.662231599970255e-05, -0.012792617082595825, 0.02706843428313732, -0.027632052078843117, 0.028062179684638977, 0.02675696276128292, -0.0024584070779383183, -0.004549721721559763, 0.034944236278533936, -0.014342562295496464, -0.027172259986400604, -0.006314732134342194, -0.025600064545869827, -0.005721451248973608, -0.024398671463131905, -0.044911354780197144, 0.040728725492954254, 0.009232931770384312, 0.013015097007155418, -0.003960149362683296, -0.01423873845487833, -0.039987124502658844, -0.009648228995501995, -0.030909927561879158, -0.04793708771467209, -0.008639651350677013, -0.01099794264882803, -0.007623658049851656, -0.025792881846427917, 0.041084691882133484, 0.04253823310136795, 0.03909720107913017, 0.022351853549480438, -0.017991239205002785, -0.013526801951229572, 0.022129373624920845, 0.029945846647024155, -0.015840597450733185, 0.012740704230964184, -0.03301607444882393, -0.0030776439234614372, -0.017041990533471107, 0.0077645620331168175, 0.016775013878941536, -0.043457817286252975, 0.021358108147978783, -0.05695495381951332, -0.020379194989800453, 0.00592909986153245, 0.007063749246299267, 0.03165153041481972, -0.003937900997698307, 0.015840597450733185, 0.009054947644472122, -0.023256605491042137, 0.010864454321563244, 0.021595420315861702, -0.03595281392335892, -0.013059592805802822, -0.003403948387131095, -0.000790732039604336, 0.04903465509414673, -0.003222256200388074, -0.07552464306354523, -0.020809322595596313, 0.014743027277290821, -0.020023226737976074, -0.004601634107530117, -0.02046818658709526, -0.03909720107913017, -0.02398337423801422, 0.016597028821706772, 0.052801989018917084, -0.04648355022072792, 0.0007958305068314075, 0.005346943158656359, -0.009633396752178669, 0.013905017636716366, -0.032838091254234314, 0.04224159196019173, 0.022826477885246277, 0.008387506939470768, 0.00012027840421069413, -0.030909927561879158, -0.02812150865793228, -0.004612757824361324, -0.01687883771955967, -0.008083450607955456, -0.012970601208508015, -0.04784809425473213, 9.513349505141377e-05, -0.017160646617412567, -0.004794450011104345, 0.04277554526925087, -0.005168958567082882, 0.03117690421640873, 0.015529124066233635, -0.012859360314905643, -0.006095959804952145, -0.00686722481623292, -0.04737346991896629, 0.009596316143870354, -0.03491457179188728, -0.021773403510451317, -0.03859291598200798, -0.04191528633236885, 0.005739991553127766, 0.05007289722561836, -0.009151356294751167, 0.0051726666279137135, -0.01676018163561821, -0.002289692871272564, 0.0023045248817652464, -0.010204428806900978, -0.04215259850025177, 0.015069331973791122, 0.01769459806382656, -0.004575678147375584, 0.006184951867908239, -0.022767148911952972, 0.01616690121591091, -0.010367581620812416, 0.017442455515265465, 0.020290201529860497, -0.010323085822165012, -0.00851357914507389, -0.030020007863640785, 0.03969048336148262, 0.025689058005809784, -0.01738312654197216, 0.002361999126151204, -0.021536091342568398, -0.01269620843231678, 0.03423229977488518, -0.004675793927162886, -0.010812542401254177, 0.023568078875541687, 0.003014607820659876, 0.028507141396403313, -0.0017789152916520834, 0.002308232942596078, 0.005673247389495373, -0.009863292798399925, -0.007697817869484425, -0.03343136981129646, -0.014312898740172386, 0.006110792048275471, -0.02347908727824688, -0.031117577105760574, -0.03417297080159187, -0.06270977854728699, -0.00753095792606473, 0.0022340728901326656, -0.040610067546367645, -0.038385264575481415, 0.01373444963246584, 0.02524409629404545, -0.020453354343771935, -0.0009937452850863338, 0.021224619820713997, -0.0026808874681591988, -0.10530733317136765, -0.038385264575481415, 0.019860073924064636, -0.033935658633708954, 0.02969370223581791, -0.020067721605300903, 0.013237576931715012, 0.018139559775590897, 0.03500356525182724, -0.02620817720890045, 0.014157162047922611, -0.005031762644648552, -0.00749016972258687, 0.006333272438496351, 0.009655644185841084, -0.048886336386203766, 0.024443168193101883, -0.017412791028618813, 0.044377401471138, -0.006440804339945316, -0.0051874988712370396, -0.001307071652263403, 0.025570401921868324, -0.0008463520789518952, -0.010864454321563244, -0.008202106691896915, 0.014683699235320091, 0.014045922085642815, 0.0025715013034641743, 0.023760894313454628, -0.00667070085182786, -0.026964610442519188, -0.006385184358805418, 0.03242279589176178, -0.02812150865793228, -0.006084836088120937, -0.011124014854431152, 0.000762458483222872, 0.014157162047922611, -0.003889697138220072, -0.011502230539917946, -0.0677526667714119, 0.012102928012609482, -0.016537701711058617, 0.05004323273897171, 0.009351587854325771, 0.009225515648722649, -0.008216938935220242, 0.03268976882100105, -0.0029905058909207582, 0.017486950382590294, 0.005858647637069225, -0.0033668684773147106, 0.029352566227316856, 0.008357842452824116, -0.016226228326559067, 0.012206751853227615, -0.0339059978723526, 0.03657576069235802, 0.01322274561971426, -0.016270725056529045, 0.022084876894950867, 0.02242601290345192, -0.02976786345243454, -0.015870260074734688, -0.005231994669884443, -0.004905690439045429, 0.01836203970015049, 0.013178248889744282, -0.04440706595778465, -0.046038586646318436, 0.031117577105760574, 0.007212069351226091, 0.0120139354839921, -0.0015870260540395975, 0.0026122895069420338, 0.037643663585186005, 0.03227447345852852, -0.03144387900829315, -0.004716582130640745, 0.041588980704545975, -0.03859291598200798, -0.0006498278235085309, 0.00018273510795552284, -0.010782877914607525, 0.026831122115254402, 0.010345333255827427, -0.00622944813221693, -0.01328207366168499, 0.04155931621789932, 0.04096603766083717, -0.010760629549622536, 0.01977108232676983, -0.03808862715959549, 0.0023100869730114937, -0.0034428825601935387, -0.015321475453674793, 0.018228551372885704, 0.01179887168109417, 0.0018957174615934491, 0.04737346991896629, 0.020927978679537773, -0.037139374762773514, -0.03292708098888397, -0.007275105454027653, 0.011183342896401882, 0.009106859564781189, -0.011376158334314823, 0.005309863016009331, -0.011242670938372612, -0.010486237704753876, -0.010219261050224304, -0.012762952595949173, 0.018302712589502335, 0.03473658859729767, 0.014705946668982506, 0.04695817455649376, 0.021654747426509857, 0.003261190140619874, -0.019088808447122574, 0.023419758304953575, 0.007308477535843849, -0.013482305221259594, -0.017412791028618813, -0.04342815279960632, -0.03983880206942558, 0.015425300225615501, 0.016226228326559067, -0.00703037716448307, -0.01013768557459116, 0.020171545445919037, 0.00234345905482769, -0.015870260074734688, -0.006552044302225113, 0.006874640937894583, 0.010745798237621784, 0.01085703819990158, 0.05766689032316208, -0.033579692244529724, 0.017664935439825058, 0.007367805577814579, 0.014268402941524982, 0.021906891837716103, 0.0026957194786518812, -0.021105963736772537, -0.008943707682192326, -0.023568078875541687, -0.028774118050932884, -0.01177662331610918, -0.0286702923476696, 0.018703175708651543, 0.021580588072538376, -0.002775441622361541, 0.025881873443722725, 0.0034744006115943193, 0.012822280637919903, -0.01498033944517374, -0.027691379189491272, -0.01730896718800068, 0.02598569728434086, 0.03684273734688759, 0.03589348495006561, 0.011005357839167118, -0.003528166562318802, 0.0025232972111552954, -0.01423873845487833, -0.01423873845487833, -0.01652286946773529, -0.04719548672437668, 0.031473543494939804, 0.00865448359400034, 0.0034947944805026054, 0.03194816783070564, 0.04802607744932175, 0.0160185806453228, 0.0175462793558836, 0.03194816783070564, 0.0015026689507067204, 0.005057718604803085, 0.0011708025122061372, 0.026356497779488564, -0.005424811039119959, -0.002838477725163102, 0.028699956834316254, 0.023924047127366066, 0.041855957359075546, 0.008439418859779835, -0.0014655889244750142, 0.0008078815299086273, 0.028818612918257713, -0.011635718867182732, 0.009685308672487736, 0.010374997742474079, 0.046424221247434616, 0.003057250054553151, -0.01179887168109417, 0.01702715829014778, 0.019326120615005493, -0.03586382418870926, -0.02250017412006855, 0.00674856873229146, 0.056272681802511215, 0.01859935186803341, 0.008268850855529308, -0.04176696762442589, 0.03105824813246727, -0.007601409684866667, -0.028180835768580437, 0.015618116594851017, 0.016359716653823853, -0.0012829697225242853, -0.018154392018914223, -0.03280842676758766, 0.027988020330667496, -0.011746958829462528, -0.016775013878941536, 0.007212069351226091, 0.023063790053129196, -0.019830409437417984, -0.014283234253525734, -0.024502495303750038, -0.034558605402708054, -0.03538919612765312, 0.016626693308353424, -0.021936556324362755, -0.00082873908104375, 0.00789063423871994, -0.0007063749362714589, -0.0160185806453228, 0.006247987970709801, -0.004104761406779289, -0.004968726541846991, 0.014090417884290218, 0.00951474066823721, 0.006451928522437811, -0.020527515560388565, -0.002819937653839588, -0.009714972227811813, 0.011405822820961475, -0.010671637952327728, 0.027750708162784576, -0.018851496279239655, 0.004957602359354496, -0.0020987307652831078, 0.006633620709180832, -0.0002630365779623389, 0.0320371612906456, 0.026400994509458542, 0.0004736976115964353, -0.007263981271535158, 0.004442189820110798, -0.0016723101725801826, 0.047907423228025436, 0.0006447293562814593, -0.012851945124566555, -0.006440804339945316, 0.005454475060105324, 0.037554673850536346, 0.05917975679039955, 0.022678157314658165, -0.010834789834916592, 0.019593097269535065, 0.012006519362330437, -0.030642950907349586, 0.023538414388895035, -0.02106146700680256, -0.0029534257482737303, -0.00863223522901535, -0.013430393300950527, 0.0025974572636187077, -0.0573405846953392, 0.027721043676137924, 0.007093413267284632, 0.003615304594859481, 0.008298514410853386, -0.025570401921868324, 0.017635270953178406, -0.005120754707604647, 0.016181733459234238, 0.01690850220620632, -0.03399498760700226, -0.03325338661670685, -0.00851357914507389, -0.01414233073592186, -0.0055731311440467834, -0.01271845679730177, -0.05443350970745087, 0.002000468550249934, 0.03894888237118721, -0.03856325149536133, -0.01005610916763544, 0.008394923061132431, -0.00594763970002532, -0.0053988550789654255, -0.032126154750585556, -0.0005358066991902888, -0.018495528027415276, 0.005955055821686983, 0.04253823310136795, -0.02821050025522709, 0.00118192657828331, 0.026104353368282318, 0.04707682877779007, -0.015870260074734688, 0.034588269889354706, 0.006700364872813225, -0.01334140170365572, -0.06365902721881866, -0.021817900240421295, 0.012896440923213959, -0.00588831165805459, 0.02972336672246456, 0.011264918372035027, 0.0092551801353693, 0.016508037224411964, 0.005658415146172047, -0.015128660015761852, -0.03277876228094101, 0.007682986091822386, -0.00018343036936130375, -0.007056333124637604, 0.015180571936070919, 0.012940936721861362, 0.0018734694458544254, -0.022322189062833786, -0.01019701361656189, 0.0172644704580307, -0.016122404485940933, 0.04052107781171799, 0.03687239810824394, -0.0047796182334423065, 0.004356905817985535, -0.003889697138220072, 0.02749856375157833, 0.006459344178438187, 0.0087731396779418, 0.009981948882341385, 0.0018753234762698412, -0.014283234253525734, -0.037139374762773514, 0.02046818658709526, 0.008120530284941196, 0.013044760562479496, -0.0019133305177092552, 0.0031425340566784143, 0.01476527564227581, -0.02223319746553898, 0.00581044377759099, 0.00958890002220869, -0.025407249107956886, 0.06947317719459534, -0.003185176057741046, 0.009596316143870354, -0.007423425558954477, -0.01408300269395113, 0.04043208435177803, -0.027528228238224983, -0.013244993053376675, -0.022989630699157715, -0.018139559775590897, 0.0036097427364438772, 0.011005357839167118, -0.026934947818517685, -0.017783591523766518, 0.031087912619113922, -0.02871478907763958, -0.021224619820713997, 0.006796773057430983, -0.013118920847773552, 0.011754374951124191, 0.020616507157683372, 0.020749995484948158, -0.0010855183936655521, -0.015247316099703312, 0.006103375926613808, 0.0160185806453228, -0.012177087366580963, 0.00853582751005888, 0.025926370173692703, 0.051437441259622574, 0.005154126789420843, -0.0456232912838459, -0.02582254633307457, 0.00741230184212327, -0.024131694808602333, 0.033579692244529724, -0.029426725581288338, 0.015618116594851017, -0.040728725492954254, -0.014253570698201656, 0.02195138856768608, 0.004082513507455587, -0.0140236746519804, 0.03171085566282272, -0.010374997742474079, -0.008469083346426487, -0.023775726556777954, 0.008736059069633484, -0.008780555799603462, 4.25551479565911e-05, -0.016270725056529045, -0.007682986091822386, 0.02250017412006855, -0.019934233278036118, 0.004538598004728556, -0.018273048102855682, 0.00640743225812912, 0.04482236132025719, 0.020245706662535667, 0.04384344816207886, -0.028002852573990822, 0.011086934246122837, -0.0175462793558836, -0.008298514410853386, -0.011613471433520317, -0.032363466918468475, -0.02692011557519436, 0.000252376077696681, 0.012970601208508015, 0.013838274404406548, -0.0028180836234241724, 0.004312409553676844, -0.008609986864030361, 0.00520603870972991, 0.02574838511645794, 0.028447812423110008, 0.010011613368988037, 0.019800744950771332, 0.038147952407598495, 0.023271437734365463, -0.012065847404301167, -0.005024346522986889, -0.008105698972940445, 0.03126589581370354, -0.00045793858589604497, -0.015840597450733185, 0.02023087441921234, -0.03708004951477051, -0.004490393679589033, 0.011027606204152107, -0.00013047542597632855, 0.008891795761883259, 0.042449239641427994, 0.027795204892754555, -0.016597028821706772, -0.01168021559715271, -0.037406351417303085, 0.006755984853953123, 0.031977832317352295, 0.004976142663508654, -0.035715501755476, 0.0009993072599172592, -0.02508094534277916, -0.013927266001701355, -0.006704072933644056, 0.02500678412616253, -0.044051095843315125, -0.007100829388946295, 0.03168119490146637, 0.0021469348575919867, -0.00806861836463213, -0.012740704230964184, 0.026534482836723328, 0.01498033944517374, 0.01273328810930252, 0.004679501987993717, -0.01776875928044319, 0.010152516886591911, -0.03405431658029556, -0.04853036627173424, 0.025214433670043945, 0.02890760637819767, 0.029827190563082695, 0.004835238214582205, -0.00047786912182345986, -0.021150458604097366, 0.028032517060637474, -0.025140272453427315, 0.006070003844797611, -0.0077348980121314526, 0.0013024366926401854, -0.013586129993200302, 0.02046818658709526, -0.008624819107353687, 0.016537701711058617, 0.03117690421640873, 0.00021703416132368147, 0.011598639190196991, -0.00783130619674921, -0.005817859433591366, 0.02089831605553627, 0.036427438259124756, 0.01859935186803341, 0.028418149799108505, 0.028492309153079987, -0.01506191585212946, -0.008194690570235252, 0.0026271215174347162, 0.01929645799100399, 0.0008797241607680917, -0.01219191960990429, -0.009092028252780437, 0.03200749680399895, 0.01625589281320572, 0.00707116536796093, -0.020067721605300903, -0.013422977179288864, -0.03969048336148262, -0.002538129221647978, -0.005461891181766987, 0.006374060176312923, -0.000886213150806725, -0.019014649093151093, 0.009447996504604816, 0.02754306048154831, -0.04167797416448593, -0.03159220144152641, 0.008328178897500038, 0.010271172970533371, 0.018881160765886307, -0.014646618627011776, 0.03782165050506592, -0.002180306939408183, -0.012896440923213959, -0.004230833612382412, -0.020853819325566292, -0.0286406297236681, -0.01609273999929428, -0.0006247988203540444, 0.02601536177098751, -0.010664221830666065, -0.006778232753276825, -0.010360165499150753, -0.0087731396779418, -0.006618788465857506, -0.011413238942623138, -0.01633005402982235, -0.01563294790685177, 0.00514671066775918, 0.004568262025713921, 0.012177087366580963, -0.008135362528264523, 0.022099709138274193, 0.037287697196006775, 0.007957378402352333, 0.049004990607500076, -0.0019114764872938395, 0.034202635288238525, 0.029678869992494583, 0.004460729658603668, 0.0014933989150449634, -0.010753214359283447, -0.007823890075087547, -0.009870708920061588, 0.014490882866084576, 0.014743027277290821, 0.010226677171885967, -0.0039008210878819227, -0.00540997926145792, 0.008298514410853386, -0.0037246907595545053, -0.03426196426153183, -0.0026957194786518812, 0.009848460555076599, 0.013267241418361664, 0.004141841549426317, -0.011568974703550339, 0.01769459806382656, -0.019237129017710686, 0.007493877783417702, 0.01503966748714447, 0.016938166692852974, -0.013207913376390934, -0.005599087104201317, -0.0019096224568784237, 0.01513607520610094, 0.021476764231920242, -0.015840597450733185, -0.0016927041579037905, 0.03710971400141716, -0.00978913251310587, -0.007352973334491253, 0.015870260074734688, -0.007898050360381603, 0.019622761756181717, -0.004271621350198984, 0.0037135668098926544, -0.0024454290978610516, 0.011850783601403236, 0.0032352341804653406, -0.011250087060034275, 0.00442364951595664, 0.01625589281320572, 0.0511704683303833, -0.036427438259124756, 0.05894244462251663, 0.046394556760787964, 0.007690402213484049, -0.023464255034923553, 0.017961574718356133, -0.007898050360381603, 0.022144204005599022, 0.008172442205250263, -0.031740520149469376, 0.013452641665935516, -0.03972014784812927, -0.016626693308353424, -0.017961574718356133, 0.022099709138274193, -0.004646129906177521, -0.03024248778820038, -0.027320578694343567, -0.01275553647428751, -0.007386345416307449, -0.024635983631014824, 0.030642950907349586, -0.03126589581370354, 0.029945846647024155, -0.004486685618758202, -0.0071824053302407265, -0.012911273166537285, -0.00520603870972991, -0.012807448394596577, -0.011487399227917194, 0.0021654749289155006, 0.017902247607707977, 0.015321475453674793, -0.015692276880145073, 0.01960792951285839, 0.003860033117234707, 0.022337021306157112, 0.018421368673443794, -0.01171729527413845, -0.0035800787154585123, 0.008899211883544922, 0.020186377689242363, -0.012555303983390331, -0.006151579786092043, 0.022396348416805267, 0.012584968470036983, -0.010515901260077953, 0.027394739910960197, 0.01671568490564823, -0.048115070909261703, -0.008965956047177315, 0.004831530153751373, -0.01776875928044319, -0.01824338361620903, -0.030613288283348083, 0.043962106108665466, 0.006392600480467081, -0.009981948882341385, 0.012562720105051994, 0.027483731508255005, 0.008580323308706284, 0.02976786345243454, -0.022396348416805267, 0.0363384485244751, -0.005454475060105324, 0.0062072002328932285, -0.007860969752073288, 0.008624819107353687, -0.010085772722959518, -0.0013515678001567721, -0.0038452011067420244, 0.007501293905079365, 0.0024250352289527655, 0.01914813742041588, -0.0051355864852666855, 0.05128912255167961, 0.008617402985692024, -0.00636664405465126, 0.027988020330667496, 0.012837112881243229, 0.010478821583092213, 0.005539759062230587, -0.013712202198803425, 0.02773587591946125, 0.019622761756181717, -0.007846138440072536, 0.022633660584688187, 0.0021487888880074024, 0.011339078657329082, 0.006537212524563074, -0.0031295560766011477, 0.013356233015656471, 0.013333985581994057, 0.03257111459970474, 0.03871157020330429, -0.04692851006984711, -0.015106411650776863, 0.011806287802755833, -0.01111659873276949, -0.02754306048154831, -0.0028180836234241724, 0.006281360052525997, 0.00853582751005888, 0.022351853549480438, -0.017917079851031303, -0.0007633854984305799, 0.044377401471138, 0.0363384485244751, 0.0143351461738348, -0.01486168336123228, 0.0252737607806921, 0.044703707098960876, 0.005484139081090689, -0.006277651991695166, -0.027394739910960197, 0.020646171644330025, -0.024042703211307526, -0.007249149493873119, 0.01742762327194214, 0.0016129821306094527, -0.0013265387387946248, 0.0024454290978610516, 0.009499908424913883, -0.018332375213503838, -0.03263044357299805, -0.03257111459970474, -0.02546657621860504, 0.03497390076518059, 0.015440132468938828, 0.024369006976485252, -0.0450003482401371, -0.015410467982292175, -0.008758307434618473, -0.021536091342568398, 0.00014136768004391342, -0.025184769183397293, 0.03521121293306351, -0.005632459186017513, 0.004672085866332054, -0.020171545445919037, 0.009937453083693981, -0.0018530754605308175, -0.0037747488822788, 0.023019293323159218, -0.017130982130765915]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
" you need. arXiv preprint arXiv:1911.02150 , 2019.
Sheng, Y ., Zheng, L., Yuan, B., Li, Z., Ryabinin, M., Chen,
B., Liang, P., R ´e, C., Stoica, I., and Zhang, C. FlexGen:
high-throughput generative inference of large language
models with a single GPU. In International Conference
on Machine Learning , pp. 31094–31116. PMLR, 2023.
Su, J., Lu, Y ., Pan, S., Wen, B., and Liu, Y . Roformer:
Enhanced transformer with rotary position embedding.
CoRR , abs/2104.09864, 2021. URL https://arxiv.
org/abs/2104.09864 .Tay, Y ., Bahri, D., Yang, L., Metzler, D., and Juan, D.-C.
Sparse sinkhorn attention. In International Conference
on Machine Learning , pp. 9438–9447. PMLR, 2020a.
Tay, Y ., Dehghani, M., Bahri, D., and Metzler, D. Efficient
transformers: A survey. CoRR , abs/2009.06732, 2020b.
URLhttps://arxiv.org/abs/2009.06732 .
Tillet, P., Kung, H.-T., and Cox, D. Triton: an intermediate
language and compiler for tiled neural network computa-
tions. In Proceedings of the 3rd ACM SIGPLAN Interna-
tional Workshop on Machine Learning and Programming
Languages , pp. 10–19, 2019.
Touvron, H., Martin, L., Stone, K., Albert, P., Almahairi,
A., Babaei, Y ., Bashlykov, N., Batra, S., Bhargava, P.,
Bhosale, S., et al. Llama 2: Open foundation and fine-
tuned chat models. arXiv preprint arXiv:2307.09288 ,
2023.
Vig, J. A multiscale visualization of attention in the trans-
former model. In Proceedings of the 57th Annual Meeting
of the Association for Computational Linguistics: System
Demonstrations , pp. 37–42, 01 2019.
Wei, J., Bosma, M., Zhao, V ., Guu, K., Yu, A. W., Lester,
B., Du, N., Dai, A. M., and Le, Q. V . Finetuned lan-
guage models are zero-shot learners. In International
Conference on Learning Representations , 2022.
Xiao, G., Tian, Y ., Chen, B., Han, S., and Lewis, M. Ef-
ficient streaming language models with attention sinks.
arXiv preprint arXiv:2309.17453 , 2023.
Yun, C., Chang, Y .-W., Bhojanapalli, S., Rawat, A. S.,
Reddi, S., and Kumar, S. O(n)connections are expressive
enough: Universal approximability of sparse transform-
ers.Advances in Neural Information Processing Systems ,
33:13783–13794, 2020.
Zaheer, M., Guruganesh, G., Dubey, K. A., Ainslie, J., Al-
berti, C., Ontanon, S., Pham, P., Ravula, A., Wang, Q.,
Yang, L., et al. Big bird: Transformers for longer se-
quences. Advances in Neural Information Processing
Systems , 33:17283–17297, 2020.
Zhang, Z., Sheng, Y ., Zhou, T., Chen, T., Zheng, L., Cai,
R., Song, Z., Tian, Y ., R ´e, C., Barrett, C., et al. H 2O:
Heavy-hitter oracle for efficient generative inference of
large language models. arXiv preprint arXiv:2306.14048 ,
2023.
10
SparQ Attention: Bandwidth-Efficient LLM Inference
A. Detailed Results
Figure A1 and Figure A2 report the compression/performance trade-off curves for all models and tasks that were evaluated.
128 MB 256 MB 512 MB0.50.60.70.8SQuAD AccuracyLlama 2 13B
64 MB 128 MB 256 MB0.40.50.60.70.8Llama 2","[0.007254291325807571, 0.0141242491081357, 0.022003082558512688, -0.014316416345536709, 0.009374987334012985, 0.003438410582020879, -0.014137975871562958, 0.04027264192700386, -0.06907019019126892, 0.00949852354824543, 0.00463602039963007, -0.017336178570985794, -0.041535452008247375, 0.024350261315703392, -0.006907705217599869, -0.02868773601949215, 0.023814938962459564, -0.05144575983285904, 0.002664596540853381, 0.04477483034133911, -0.010974088683724403, -0.02942895144224167, -0.02245604619383812, 0.019710808992385864, 0.032476164400577545, 0.004725240636616945, -0.02424045093357563, 0.00945048127323389, 0.03209182992577553, -0.027424927800893784, 0.0384058803319931, -0.041974689811468124, -0.02953875996172428, -0.04115111753344536, -0.024899307638406754, 0.030801570042967796, 0.02657390385866165, 0.003112413454800844, -0.02879754640161991, 0.011440779082477093, -0.0017655311385169625, -0.044308140873909, -0.018146023154258728, 0.020095141604542732, 0.008167082443833351, 0.021495213732123375, 0.022222701460123062, -0.004433559253811836, -0.022346237674355507, 0.05792452022433281, -0.03225654736161232, 0.05512437969446182, -0.04606509208679199, 0.02008141577243805, -0.007672939915210009, -0.0061733536422252655, -0.006839074194431305, 0.031240807846188545, 0.011337832547724247, -0.00769352912902832, 0.003481304971501231, -0.03615478426218033, 0.019999058917164803, 0.012744767591357231, -0.030609402805566788, -0.01770678535103798, -0.03793918713927269, 0.013197731226682663, -0.006310615688562393, 0.010541713796555996, -0.01588120125234127, 0.002935688942670822, 0.05509692430496216, -0.029868189245462418, 0.009011243470013142, 0.019765712320804596, -0.020163772627711296, 0.07417632639408112, 0.003060940420255065, -0.036923449486494064, -0.0012619515182450414, 0.0014815706526860595, 0.01994415372610092, -0.0319545716047287, -0.016704773530364037, -0.025901319459080696, -0.007343511562794447, -0.01511253509670496, -0.031982023268938065, -0.004893386736512184, -0.010226011276245117, 0.004145309329032898, -0.014330142177641392, -0.007940600626170635, 0.04362183064222336, 0.025091474875807762, 0.031927116215229034, -0.013980124145746231, 0.0083867022767663, 0.05847356840968132, 0.024967938661575317, 0.026395462453365326, 0.03813135623931885, -0.028879903256893158, 0.044006165117025375, -0.01137901097536087, -0.004910544492304325, -0.023760033771395683, -0.009189683943986893, 0.03373897448182106, -0.09449108690023422, -0.005315466783940792, -0.0209187138825655, 0.0009745594579726458, -0.011276064440608025, -0.04886523634195328, -0.03977849707007408, 0.009189683943986893, -0.026038581505417824, 0.024803224951028824, -0.010576029308140278, -0.000929949339479208, 0.035248856991529465, 0.0005584843456745148, 0.034013498574495316, -0.019999058917164803, 0.020204951986670494, -0.039641235023736954, 0.0026611650828272104, -0.010576029308140278, 0.014728201553225517, 0.01140646357089281, 0.03785683214664459, -0.008585731498897076, -0.00982108898460865, -0.03497433289885521, -0.025201285257935524, 0.0038330384995788336, -0.03793918713927269, 0.007240565028041601, 0.010836826637387276, -0.00011141805589431897, -0.028523022308945656, 0.01692439243197441, -0.046229805797338486, 0.008270028978586197, -0.022716844454407692, 0.01652633212506771, -0.038515686988830566, 0.019902974367141724, 0.0005897972150705755, -0.023032546043395996, -0.06588570773601532, 0.004364928230643272, -0.048261284828186035, -0.040492258965969086, -0.038652949035167694, 0.06500723212957382, 0.034644901752471924, -0.06242671236395836, 0.0017526628216728568, 0.046421974897384644, 0.002422672463580966, 0.0026234181132167578, 0.031103545799851418, 0.02004023641347885, -0.03516649827361107, 0.019216665998101234, -0.07340766489505768, -0.0557008795440197, 0.010246600955724716, 0.007178797386586666, -0.014728201553225517, -0.061273712664842606, 0.02281292714178562, -0.02122068963944912, -0.021042248234152794, -0.030801570042967796, -0.023471783846616745, -0.04315514117479324, -0.0027006277814507484, 0.021797189489006996, -0.04447285458445549, 0.004924270790070295, -0.033025212585926056, -0.02448752336204052, -0.02002651058137417, 0.04485718905925751, 0.03239380940794945, 0.03620968759059906, -0.024954212829470634, 0.044994451105594635, 0.0702780932188034, 0.05336742475628853, 0.015359606593847275, -0.030389783903956413, 0.04614745080471039, -0.016883213073015213, -0.0041212886571884155, -0.012312391772866249, 0.018832331523299217, 0.05012804642319679, 0.021055975928902626, -0.07620780915021896, 0.00738468999043107, -0.01616945117712021, 0.0032805593218654394, -0.013046743348240852, -0.03264087811112404, -0.012031005695462227, 0.04559840261936188, 0.035742998123168945, 0.050731997936964035, -0.028275951743125916, -0.04285316541790962, 0.015798844397068024, -0.054383162409067154, 0.027246486395597458, 0.002082949271425605, 0.05484985560178757, -0.0015030177310109138, 0.01785777322947979, 0.04241392761468887, 0.013081058859825134, -0.03384878486394882, 0.04611999914050102, 0.02513265423476696, -0.020095141604542732, 0.009745595045387745, -0.011729029007256031, 0.027246486395597458, 0.003812449285760522, -0.007782749366015196, -0.029895640909671783, -0.011955510824918747, -0.07834909111261368, 0.040739331394433975, -0.01958727277815342, 0.010678975842893124, -0.06824661791324615, -0.002146432874724269, -0.0344252847135067, 0.012449653819203377, -0.001612827298231423, 0.023911021649837494, 0.03467235714197159, -0.03620968759059906, -0.060285426676273346, 0.0637444257736206, 0.030801570042967796, -0.017734237015247345, -0.020740272477269173, -0.0408765934407711, -0.00015559923485852778, -0.03829606994986534, -0.01652633212506771, -0.04872797429561615, 0.014700748957693577, -0.024899307638406754, 0.02255212888121605, -0.021042248234152794, 0.005902261473238468, -0.0031535921152681112, 0.01855780929327011, 0.02146776020526886, 0.008647499606013298, -0.03585280850529671, 0.057155855000019073, -0.02013632096350193, -0.024405164644122124, 0.03417821228504181, -0.022716844454407692, 0.009786773473024368, -0.02082262933254242, -0.05748528242111206, -0.013568338938057423, 0.046174902468919754, 0.025599343702197075, -0.03102118894457817, 0.01820092834532261, -0.003812449285760522, -0.01219571940600872, 0.05062218755483627, 0.045186616480350494, -0.005404687020927668, -0.0096426485106349, 0.030142713338136673, -0.028660284355282784, -0.018873510882258415, -0.020740272477269173, 0.04579056799411774, -0.013232046738266945, 0.03461745008826256, -0.041178569197654724, 0.02078145183622837, 0.03178985416889191, 0.009134779684245586, -0.0012044731993228197, -0.009484796784818172, -0.019765712320804596, 0.031048640608787537, -0.012751630507409573, -0.0036683243233710527, 0.012202582322061062, -0.004440422169864178, 0.054190997034311295, -0.04540623724460602, 0.007178797386586666, 0.0013477402972057462, 0.016993023455142975, -0.018585260957479477, 0.016979297623038292, -0.010974088683724403, 0.00853769015520811, -0.052461497485637665, -0.012051594443619251, 0.02017749845981598, -0.05366940051317215, 0.026820974424481392, -0.05010059103369713, -0.02290900982916355, -0.032283999025821686, -0.02349923737347126, -0.0002758106274995953, -0.014007576741278172, 0.0022150638978928328, -0.02543462999165058, 0.006042954977601767, -0.03288795053958893, -0.016087094321846962, 0.040300093591213226, 0.020987344905734062, 0.03612733259797096, -0.002577092032879591, -0.015661582350730896, -0.027726903557777405, -0.04219430685043335, 0.03220164030790329, 0.024652237072587013, 0.03634694963693619, -0.10448375344276428, -0.004594841971993446, -0.03096628375351429, -0.011516273021697998, -0.026436641812324524, 0.03340954706072807, 0.02503656968474388, 0.0180087611079216, 0.07368218898773193, -0.022030534222722054, 0.01219571940600872, -0.030801570042967796, 0.0392843559384346, -0.017651880159974098, 0.0102397371083498, 0.03508413955569267, 0.011831975542008877, -0.0360175222158432, -0.0005108716432005167, 0.01219571940600872, -0.0147419273853302, 0.02458360604941845, 0.027740629389882088, -0.013863451778888702, 0.013499707914888859, 0.004001184366643429, -0.01627926155924797, 0.0589677095413208, 0.017281273379921913, -0.022716844454407692, 0.011344695463776588, 0.055179283022880554, -0.02424045093357563, -0.011028993874788284, -0.030636856332421303, -0.010219148360192776, -0.010397588834166527, 0.016745951026678085, -0.0006172495777718723, 0.03286049887537956, -0.004687493667006493, 0.029950546100735664, 6.090996612329036e-05, -0.0318722128868103, -0.02281292714178562, 0.004670335911214352, -0.0006571413250640035, 0.011207434348762035, -0.022003082558512688, 0.0047218091785907745, -0.0057855891063809395, 0.007583719678223133, -0.04798676073551178, 0.0008964917506091297, 0.033464450389146805, 0.030087808147072792, 0.009237725287675858, 0.012429065071046352, 0.013767368160188198, 0.04798676073551178, -0.004852208308875561, -0.012456516735255718, -0.019463736563920975, -0.00642042513936758, 0.002863626228645444, 0.038817666471004486, 0.025599343702197075, 0.04057461768388748, 0.03804899752140045, -0.007377827074378729, 0.03047214075922966, -0.03662147372961044, 0.012669272720813751, -0.030691759660840034, -0.0023814940359443426, -0.04040990397334099, 0.004536505788564682, -0.004471306223422289, 0.013053606264293194, 0.06830152124166489, -0.045186616480350494, -0.015853749588131905, -0.03725288063287735, -0.014007576741278172, -0.04562585428357124, -0.03159768879413605, 0.0151399876922369, -0.07862361520528793, 0.009409302845597267, -0.022730570286512375, -0.028577927500009537, 0.008523963391780853, 0.04021773487329483, -0.010521124117076397, -0.023581594228744507, -0.042715903371572495, 0.013232046738266945, 0.038268618285655975, 0.021687379106879234, -0.04815147444605827, 0.0016085378592833877, -0.005672347731888294, -0.022497225552797318, -0.018873510882258415, -0.02310117706656456, -0.0038193122018128633, 4.348413858679123e-05, 0.015441963449120522, -0.00851023755967617, -0.05545380711555481, 0.013980124145746231, -0.0009900014847517014, 0.03799409419298172, 0.009011243470013142, 0.0006545676733367145, -0.04257864132523537, 0.0769764706492424, -0.007844517007470131, 0.040437355637550354, 0.0011015267809852958, 0.033656615763902664, -0.004237961024045944, -0.053394876420497894, -0.017240094020962715, 0.009011243470013142, 0.00498260697349906, 0.05383411794900894, -0.0034298317041248083, 0.032476164400577545, 0.004646315239369869, -0.013087921775877476, -0.013794820755720139, -0.018365642055869102, -0.01968335546553135, 0.01998533308506012, 0.01120057050138712, 0.023375701159238815, -0.01671849936246872, -0.0012954091653227806, -0.05995599552989006, -0.0011521420674398541, -0.04507680609822273, 0.017885224893689156, -0.005222815088927746, -0.005867945961654186, 0.06857604533433914, 0.013135964050889015, -0.014083070680499077, -0.0006867384072393179, 0.0034658629447221756, -0.013108511455357075, -0.01283398736268282, 0.036182235926389694, -0.015647856518626213, 0.029840735718607903, -0.012442790903151035, -0.03664892539381981, -0.04238647222518921, -0.006694949232041836, -0.03785683214664459, 0.010322094894945621, -0.03843333199620247, 0.022236427292227745, 0.004759556148201227, 5.281365884002298e-05, -0.04285316541790962, 0.03733523562550545, -0.0015090230153873563, 0.00624541612342, 0.041974689811468124, 0.0014215185074135661, -0.0032582543790340424, 0.008057272993028164, 0.04329240322113037, 0.005088984966278076, 0.04115111753344536, -0.02760336734354496, 0.03165259212255478, 0.0015201754868030548, 0.02929168939590454, 0.0059811873361468315, -0.015249797143042088, 0.0029528464656323195, -0.01968335546553135, 0.021412856876850128, 0.012676136568188667, -0.01251828484237194, -0.12166894227266312, -0.012120225466787815, -0.04433559253811836, 0.018146023154258728, -0.01607336848974228, -0.007391553372144699, -0.015441963449120522, -0.06357970833778381, -0.01526352297514677, 0.0008008373552002013, -0.01008874922990799, -0.06517194956541061, 0.02266193926334381, 0.008880844339728355, 0.02532481960952282, 0.014439951628446579, 0.006293457932770252, 0.0002710922562982887, -0.012456516735255718, 0.03437037765979767, -0.026011129841208458, -0.001062063965946436, 0.008256303146481514, 0.04996332898736, -0.03933925926685333, 0.00967010110616684, -0.013101648539304733, -0.02281292714178562, -0.024913033470511436, -0.013403624296188354, 0.022524677217006683, -0.022373689338564873, 0.002628565300256014, 0.03615478426218033, 0.0034298317041248083, -0.0024037989787757397, -0.005514496937394142, -0.036731284111738205, 0.003222223138436675, 0.015867475420236588, -0.03255852311849594, 0.012470243498682976, 0.002692048903554678, -0.02517383173108101, -0.016636142507195473, 0.019710808992385864, -0.009601470082998276, 0.01643024943768978, -0.003335464047268033, 0.034946877509355545, 0.03706071153283119, -0.014302689582109451, 0.018379367887973785, -0.03939416632056236, -0.015949832275509834, -0.0041556041687726974, -0.006629749666899443, -0.027973974123597145, 0.01321145799010992, -0.007343511562794447, 0.0043306127190589905, -0.04650432989001274, 0.010706428438425064, 0.06907019019126892, -0.03250361606478691, -0.01810484379529953, -0.02695823647081852, -0.04178252071142197, -0.014659570530056953, 0.027095498517155647, -0.044555213302373886, -0.04576311632990837, -0.012079047039151192, 0.030307427048683167, 0.01380168367177248, -0.01789895072579384, -0.006427288521081209, 0.006070407573133707, 0.011179981753230095, -0.04946918785572052, 0.015565498732030392, -0.013582064770162106, -0.006773874629288912, -0.014604666270315647, -0.0060601127333939075, -0.00853082723915577, -0.02942895144224167, -0.037472497671842575, -0.0034521366469562054, -0.04101385548710823, -0.00945048127323389, 0.04683376103639603, -0.01949119009077549, 0.008970065042376518, -0.04482973739504814, -0.008633773773908615, 0.025407176464796066, 0.006152764428406954, 0.0352214016020298, -0.023169808089733124, -0.022483499720692635, -0.04458266496658325, 0.009615195915102959, -0.052214425057172775, -0.01157804112881422, 0.028330855071544647, 0.0328330472111702, -0.004725240636616945, 0.006303752772510052, -0.0033045802265405655, -0.0009891435038298368, 0.005088984966278076, -0.0164165236055851, 0.020369665697216988, 0.016649868339300156, -0.0010389010421931744, -0.023430606350302696, 0.030087808147072792, 0.006640044506639242, -0.009841677732765675, -0.002782984869554639, -0.030883926898241043, -0.0016634425846859813, -0.027342569082975388, -0.04433559253811836, 0.026587629690766335, 0.014906642027199268, 0.02028730884194374, -0.005267425440251827, -0.008613184094429016, -0.039449069648981094, -0.008922023698687553, -0.013568338938057423, -0.0769764706492424, 0.027328843250870705, -0.030581951141357422, 0.0003236378252040595, 0.005565969739109278, 0.037774473428726196, 0.01810484379529953, 0.035742998123168945, -0.008297481574118137, -0.017720511183142662, 0.009011243470013142, 0.004244824405759573, 0.01831073686480522, -0.0009187968098558486, 0.009718142449855804, -0.01953236758708954, 0.005363508593291044, -0.03041723556816578, 0.01190060656517744, 0.03997066617012024, -0.053257618099451065, 0.0451042577624321, -0.07692156732082367, -0.03577044978737831, 0.015743939206004143, 0.0054390025325119495, 0.02473459392786026, 0.0059983450919389725, 0.02240114100277424, 0.00400804728269577, -0.022648213431239128, 0.014906642027199268, -0.0022699686232954264, -0.034644901752471924, 0.007391553372144699, -0.0040389313362538815, -0.011475094594061375, 0.05133594945073128, -0.01785777322947979, -0.07648232579231262, -0.01903822459280491, 0.02325216494500637, -0.02868773601949215, -0.001992013305425644, -0.019450010731816292, -0.029401497915387154, -0.031048640608787537, 0.014920367859303951, 0.05710094794631004, -0.01806366629898548, -0.006660633720457554, 0.010857416316866875, -0.014947820454835892, -0.0026096918154507875, -0.002921962644904852, 0.022195247933268547, 0.029154427349567413, 0.01283398736268282, -0.011440779082477093, -0.02750728465616703, -0.033162474632263184, -0.01008874922990799, -0.02452870085835457, -0.010527987964451313, 0.005583127494901419, -0.010232874192297459, -0.009676964022219181, -0.00020760862389579415, 0.020548105239868164, 0.01914803497493267, 0.007274880539625883, 0.02156384475529194, 0.010836826637387276, -0.04010792821645737, -0.027973974123597145, 0.0011409894796088338, -0.021399129182100296, -0.011097623966634274, -0.03461745008826256, -0.029703475534915924, -0.005658621899783611, -0.018461724743247032, -0.002366052009165287, 0.031185902655124664, 0.018859785050153732, -0.009827951900660992, 0.0266150813549757, 0.01090545766055584, 0.0038673540111631155, -0.008009231649339199, -0.04150799661874771, 0.012744767591357231, 0.02640918828547001, 0.01222317200154066, -0.014508582651615143, -0.04035499691963196, 0.02923678420484066, -0.01603218913078308, 0.0075288149528205395, -0.004196782596409321, 0.011289791204035282, -0.005692937411367893, 0.003788428381085396, 0.028770092874765396, 0.005603717174381018, -0.016347892582416534, 0.00578902056440711, -0.034507639706134796, -0.0012070467928424478, 0.023609045892953873, -0.016059642657637596, -0.025201285257935524, 0.01795385591685772, 0.013067333027720451, 0.02716412954032421, 0.0024775771889835596, 0.02032848633825779, 0.015949832275509834, 0.005202225875109434, 0.014481130056083202, -0.01903822459280491, -0.012113362550735474, 0.0048727975226938725, -0.015510594472289085, -0.021536391228437424, -0.02606603503227234, -0.042770806699991226, -0.01943628489971161, 0.006392973009496927, -0.031542785465717316, -0.043649282306432724, -0.016910666599869728, 6.761220720363781e-05, 0.0011298370081931353, 0.011804522946476936, 0.022771749645471573, -0.011928059160709381, -0.10552694648504257, -0.060230519622564316, 0.017500892281532288, -0.01155058853328228, 0.009038696065545082, -0.029072070494294167, -0.006791032385081053, 0.002456987975165248, 0.00076351931784302, -0.02285410650074482, 0.01692439243197441, -0.022442320361733437, 0.0036580294836312532, -0.00806413684040308, 0.018585260957479477, -0.05836375802755356, 0.0018341621616855264, -0.02112460695207119, 0.06264632940292358, -0.007871969603002071, -0.010747606866061687, 0.0009248020360246301, 0.018777428194880486, 0.023320795968174934, -0.0015476278495043516, 0.009368124417960644, -0.0031947707757353783, 0.02473459392786026, -0.0014275237917900085, 0.0043168868869543076, -0.013348719105124474, -0.01557922549545765, 0.01806366629898548, 0.05907751992344856, -0.031130997464060783, -0.021110879257321358, -0.032915402203798294, -0.007130755577236414, 0.00545272883027792, -0.006633181124925613, -0.025613069534301758, -0.04576311632990837, 0.036237139254808426, -0.016745951026678085, 0.02433653362095356, 0.0012319255620241165, 0.028070058673620224, 0.0020126025192439556, 0.005113005638122559, -0.01666359417140484, 0.007240565028041601, 0.02359532006084919, 0.000612960138823837, 0.0384882353246212, 0.006931725889444351, -0.016155725345015526, 0.016938118264079094, -0.01202414184808731, 0.019724534824490547, 0.0241443682461977, -0.01345166563987732, 0.023361975327134132, -0.0024844403378665447, -0.032970309257507324, -0.030087808147072792, -0.014110523276031017, 0.015153713524341583, 0.012449653819203377, 0.0005717815947718918, -0.05907751992344856, -0.023238439112901688, 0.03752740100026131, 0.002722932957112789, -0.001676310901530087, 0.01751461811363697, 0.007631761487573385, 0.032778140157461166, 0.03813135623931885, -0.03837842494249344, 0.017473438754677773, -0.0002190828527091071, -0.03763721138238907, -0.00977304670959711, -0.01831073686480522, -0.007467047311365604, 0.03220164030790329, 0.03310757130384445, -0.011818249709904194, -0.012731040827929974, 0.046284712851047516, 0.037966642528772354, -0.008221987634897232, 0.03338209167122841, -0.01560667809098959, 0.007748434320092201, -0.01865389198064804, 0.0012516569113358855, 0.023389426991343498, 0.04488464072346687, -0.002146432874724269, 0.04340221360325813, 0.025599343702197075, -0.018516629934310913, -0.046916116029024124, 0.006355226039886475, 0.0024947349447757006, 0.006362088955938816, 0.004536505788564682, 0.0017723942873999476, -0.026203297078609467, -8.691466064192355e-05, 0.029868189245462418, 0.014892916195094585, 0.02769945003092289, 0.028660284355282784, 0.016292987391352654, 0.02844066545367241, 0.021508939564228058, 0.03168004751205444, 0.003139865817502141, 0.00467376783490181, 0.022099165245890617, -0.010335820727050304, -0.006883684080094099, -0.025489535182714462, -0.031185902655124664, 0.037170521914958954, 0.027630820870399475, 0.01914803497493267, 0.003953142557293177, -0.0038845117669552565, -0.010040707886219025, -0.0005734973819926381, -1.8283713870914653e-05, -0.024913033470511436, 0.018777428194880486, 0.003702639602124691, 0.031295713037252426, -0.030554497614502907, 0.036539118736982346, 0.0017509470926597714, 0.0019782870076596737, 0.027685724198818207, -0.027328843250870705, -0.003579104086384177, -0.023169808089733124, -0.00560028525069356, -0.05564597249031067, -0.015949832275509834, 0.0014712759293615818, 0.028028879314661026, -0.014810558408498764, -0.011831975542008877, 0.025118926540017128, 0.017144011333584785, 0.014165427535772324, -0.010294642299413681, -0.028605379164218903, -0.012621231377124786, 0.010706428438425064, 0.021975629031658173, 0.02765827253460884, 0.012058457359671593, -0.009203409776091576, -0.0014789969427511096, -0.012463380582630634, -0.01756952330470085, -0.010226011276245117, -0.04060206934809685, 0.035441022366285324, 0.0022150638978928328, -0.011516273021697998, 0.03807644918560982, 0.04971626028418541, 0.0019113719463348389, -0.0030695192981511354, 0.006221395451575518, 0.007885696366429329, 0.02305999957025051, 0.041480544954538345, 0.014302689582109451, 0.0026148392353206873, 0.0006421282887458801, 0.035742998123168945, 0.03168004751205444, 0.03664892539381981, 0.01994415372610092, 0.024020832031965256, 0.028166141360998154, 0.013918356038630009, -0.016155725345015526, 0.02967602200806141, -0.006883684080094099, 0.02756218984723091, 0.01934020221233368, -0.03774702176451683, 0.040931496769189835, 0.01958727277815342, -0.03332718834280968, -0.02042457088828087, -0.024611057713627815, 0.03299776092171669, -0.0003594545996747911, 0.004128151573240757, -0.037170521914958954, 0.012113362550735474, -0.024967938661575317, -0.005648327060043812, 0.008599458262324333, -0.002216779626905918, -0.004845344927161932, -0.007762160152196884, -0.01632043905556202, 0.016581237316131592, -0.005253699142485857, -0.019806891679763794, 0.010500535368919373, 0.007727844640612602, -0.023663951084017754, -0.03236635401844978, -0.042029593139886856, -0.026134666055440903, -0.009635785594582558, 0.014234058558940887, -0.02855047397315502, 0.00982108898460865, 0.00996521394699812, -0.005850788205862045, -0.01578511856496334, 0.016512606292963028, 0.005370371509343386, 0.003953142557293177, 0.013712463900446892, 0.006842505652457476, -0.016498880460858345, -0.036182235926389694, 0.0018204358639195561, -0.003107266267761588, -0.017226368188858032, 0.013849725015461445, 0.03577044978737831, -0.00945048127323389, 0.006053249817341566, -0.00029425518005155027, -0.017047926783561707, -0.00257880799472332, 0.018955867737531662, 0.029840735718607903, 0.006571413483470678, -0.01894214190542698, 0.0069111366756260395, -0.006399835925549269, 0.004886523354798555, 0.0013914924347773194, 0.006547392345964909, -0.00548018142580986, 0.0250228438526392, 0.028275951743125916, 0.03236635401844978, 0.032229091972112656, -0.02893480844795704, 0.04979861527681351, 0.0022665371652692556, -0.018489178270101547, 0.02023240365087986, -0.007878832519054413, -0.008592594414949417, -0.012332981452345848, 0.021412856876850128, -0.00023634782701265067, -0.027438653632998466, 0.022771749645471573, 0.025805236771702766, 0.030554497614502907, 0.0005070111365057528, 0.007309196051210165, 0.013671284541487694, -0.0074944994412362576, 0.013739915564656258, 0.020067689940333366, -0.03829606994986534, -0.006567982025444508, 0.0053600771352648735, -0.02666998654603958, 0.01268986240029335, -0.008942612446844578, -0.050430022180080414, 0.013410487212240696, 0.03280559182167053, -0.02181091532111168, -0.002239084802567959, 0.03914709389209747, -0.005380666349083185, -0.03077411651611328, -0.024418892338871956, 0.018434273079037666, 0.00481102941557765, 0.0022476636804640293, 0.017198916524648666, -0.036429308354854584, 0.021042248234152794, 0.011880016885697842, 0.022181522101163864, -0.027740629389882088, 0.0043340446427464485, 0.01776168867945671, 0.011680987663567066, -0.05619502067565918, -0.0036614611744880676, 0.014879189431667328, -0.012573190033435822, 0.035742998123168945, 0.010672112926840782, 0.017940130084753036, -0.001140131615102291, -0.000844160676933825, -0.00016685899754520506, -0.03670383244752884, 0.007419005502015352, -0.006327773444354534, -0.005298309028148651, 0.011955510824918747, -0.006423856597393751, -0.010665249079465866, -0.011433916166424751, -0.01666359417140484, 0.015551772899925709, -0.02023240365087986, 0.022593308240175247, 0.02666998654603958, 0.03003290295600891, -0.011529999785125256, -0.02403455786406994, 0.014563486911356449, -0.03939416632056236, -0.0011555736418813467, -0.024514975026249886, -0.010658386163413525, 0.014810558408498764, -0.023567868396639824, 0.031927116215229034, 0.033217377960681915, -0.026930784806609154, 0.0069111366756260395, -0.005727252457290888, 0.00384676456451416, -0.024130642414093018, -0.014549761079251766, 0.005970892496407032, -0.010431904345750809, 0.08136885613203049, -0.03231145069003105, -0.0018822037382051349, 0.01058975514024496, -0.01929902285337448, 0.05509692430496216, -0.028468117117881775, -0.0009411018691025674, -0.006358657497912645, 0.008132767863571644, 0.009011243470013142, 0.015249797143042088, -0.019408833235502243, -0.023856118321418762, 0.0409589484333992, -0.029621116816997528, -0.015757665038108826, 0.0017826888943091035, -0.005284583196043968, 0.02458360604941845, 0.016196904703974724, 0.02226387895643711, -0.035001784563064575, 0.008908296935260296, -0.014920367859303951, 0.007796475663781166, -0.010658386163413525, 0.0037987229879945517, 0.03486452251672745, 0.055481258779764175, -0.0009093600674532354, -0.018489178270101547, -0.0451042577624321, 0.015592951327562332, 0.0014103660359978676, 0.030197616666555405, -0.05273602157831192, 0.015853749588131905, -0.02898971363902092, 0.014947820454835892, 0.020561832934617996, 0.004745830316096544, -0.012923208065330982, 0.013698737137019634, -0.023210987448692322, -0.014110523276031017, -0.014563486911356449, 0.013623243197798729, 0.0012705303961411119, -0.020012784749269485, -0.009107327088713646, -0.01043876726180315, 0.0024020832497626543, -0.024665962904691696, 0.01717146299779415, -0.03305266425013542, 0.002041770610958338, 0.04719064012169838, 0.0022305059246718884, 0.03022507019340992, -0.024062011390924454, -0.022881558164954185, -0.02592877298593521, 0.017349904403090477, -0.02384239248931408, -0.056222472339868546, -0.01618317700922489, -0.014934094622731209, 0.0001609610189916566, 0.02973092719912529, -0.019710808992385864, 0.005013491027057171, 0.009903445839881897, 0.0013297246769070625, 0.020767726004123688, 0.011049582622945309, 0.012614368461072445, 0.02112460695207119, 0.018187200650572777, 0.05210461467504501, -0.01905195228755474, -0.0027366590220481157, -0.018626440316438675, 0.024556154385209084, 0.006413562223315239, 0.007343511562794447, 0.019450010731816292, -0.015538047067821026, -0.01969708316028118, 0.038652949035167694, -0.0011881733080372214, -0.010878005065023899, 0.05125359073281288, 0.01869507133960724, -0.005727252457290888, 0.004519348032772541, -0.02547580748796463, -0.01968335546553135, 0.028907354921102524, -0.003932553343474865, -0.023636499419808388, 0.012312391772866249, -0.015441963449120522, 0.00984854158014059, -0.0006412704242393374, 0.0005100137204863131, -0.04131583124399185, -0.01593610644340515, 0.022620759904384613, 0.013485981151461601, -0.016594963148236275, -0.005885103717446327, 0.02017749845981598, 0.002916815225034952, 0.004745830316096544, 0.017967581748962402, -0.00014905784337315708, 0.017775416374206543, -0.01557922549545765, -0.03884511813521385, 0.02844066545367241, 0.004605136811733246, 0.0368959978222847, 0.01829701103270054, -0.001656579552218318, -0.012154540978372097, -0.002182464115321636, -0.010678975842893124, -0.01461839210242033, -0.006025797221809626, 0.0019765712786465883, -0.01726754754781723, 0.023924749344587326, -0.005414981860667467, 0.0208775345236063, 0.030252521857619286, 0.004618862643837929, -0.006492487620562315, -0.014035029336810112, 0.008070999756455421, 0.00803668424487114, 0.04614745080471039, -0.00034830207005143166, 0.024405164644122124, 0.01607336848974228, -0.019628452137112617, -0.005408118944615126, -0.013815410435199738, 0.007666076999157667, -0.01622435636818409, 0.0004975743941031396, -0.01284085027873516, 0.010562303476035595, 0.009834814816713333, 0.005552243907004595, -0.012346707284450531, -0.004261981695890427, -0.014398773200809956, -0.01449485681951046, -0.004244824405759573, 0.009409302845597267, 0.01789895072579384, 0.01142705325037241, 0.018146023154258728, 0.03571554645895958, -0.03631949797272682, -0.03159768879413605, 0.01157804112881422, 0.014577213674783707, 0.01563413068652153, 0.015524320304393768, 0.0237874872982502, -0.03239380940794945, 0.0016951843863353133, -0.003134718630462885, -0.020301034674048424, -0.019134309142827988, 0.010857416316866875, -0.007192523218691349, 0.0017406524857506156, -0.010534850880503654, -0.01459093950688839, 0.0023214418906718493, 0.006626318208873272, -0.01332813035696745, -0.008819077163934708, -0.014687023125588894, -0.0010148801375180483, -0.009786773473024368, -0.02562679536640644, -0.0005391818704083562, -0.003730091964825988, 0.005806178320199251, -0.007254291325807571, 0.00848278496414423, 0.02295018918812275, 0.007878832519054413, 0.05836375802755356, 0.05273602157831192, 0.0067155384458601475, -0.007563130464404821, -0.030252521857619286, 0.019916702061891556, -0.028660284355282784, -0.019271571189165115, 0.017226368188858032, 0.003285706741735339, 0.011619219556450844, -0.007117029279470444, -0.03132316470146179, 0.027040593326091766, -0.018269559368491173, -0.013698737137019634, -0.0022871263790875673, 0.022318784147500992, -0.024363987147808075, 0.012497696094214916, 0.011941784992814064, -0.026820974424481392, -0.01563413068652153, -0.0007347801001742482, 0.004807597957551479, 0.019175486639142036, 0.00463602039963007, -0.004045794252306223, 0.013835999183356762, 0.003107266267761588, -0.0020640757866203785, -0.0055556753650307655, 0.03535866364836693, -0.0004666904569603503, -0.00851023755967617, 8.884490671334788e-05, -0.01271731499582529, 0.003932553343474865, -0.0013854872668161988, 0.012133951298892498, -0.003795291529968381, 0.009635785594582558, 0.01286143995821476, -0.00868181511759758, 0.015689034014940262, 0.01496154721826315, 0.03453509509563446, -0.030636856332421303, 0.053696855902671814, 0.04109621047973633, 0.024954212829470634, -0.03837842494249344, 0.028962260112166405, -0.01105644553899765, 0.0266150813549757, 0.0052262465469539165, -0.024624783545732498, 0.0032822750508785248, -0.05581068620085716, -0.015030178241431713, -0.009210273623466492, 0.011653535068035126, 0.008572005666792393, -0.013781094923615456, -0.007274880539625883, 0.008613184094429016, 0.005813041236251593, -0.028413211926817894, 0.038268618285655975, -0.03483707085251808, 0.02053437940776348, -0.00305407727137208, -0.0026319969911128283, 0.008009231649339199, -0.003531062277033925, -0.015455689281225204, -0.030444689095020294, 0.0028447527438402176, 0.03017016500234604, -0.00013640400720760226, 0.0028155846521258354, 0.007295469753444195, -0.020053964108228683, 0.0250228438526392, -0.009491660632193089, -0.006979767698794603, -0.020753998309373856, -0.0075288149528205395, 0.018763700500130653, -0.016004737466573715, -0.0024381144903600216, 0.007727844640612602, 0.002359188860282302, -0.007762160152196884, 0.01865389198064804, 0.03261342644691467, -0.029840735718607903, 0.000778103363700211, 0.019971605390310287, -0.003973731771111488, -0.004931133706122637, -0.02380121313035488, 0.02581896260380745, -0.008860255591571331, -0.027864165604114532, -0.012655546888709068, 0.02562679536640644, 0.0009205125970765948, 0.029593665152788162, -0.017693059518933296, 0.05600285530090332, 0.012085909955203533, 0.04076678305864334, -0.010006392374634743, 0.008105315268039703, -0.02973092719912529, 0.017432261258363724, 0.0011324106017127633, -0.000651136098895222, 0.012545737437903881, 0.008674952201545238, -0.016855761408805847, 0.025997404009103775, -0.007775886449962854, -0.0006211100844666362, 0.01612827368080616, -0.0011006688000634313, 0.022222701460123062, 0.0076111722737550735, 0.0013425928773358464, 0.036978356540203094, 0.0141242491081357, -0.018173474818468094, 0.005205657333135605, -0.0029545624274760485, 0.01831073686480522, 0.001179594430141151, -0.009855404496192932, 0.003477873280644417, 0.008777898736298084, 0.02424045093357563, 0.025736605748534203, -0.04161780700087547, -0.03953142464160919, 0.007789612747728825, -0.015743939206004143, -0.012799671851098537, -0.0083867022767663, -0.0141242491081357, -0.0033577692229300737, 0.012133951298892498, -0.035688094794750214, -0.004224234726279974, 0.04279825836420059, 0.03151533007621765, 0.03472726047039032, 0.0011547156609594822, 0.02581896260380745, 0.0335468091070652, 0.011729029007256031, -0.011488820426166058, -0.03719797357916832, -0.014439951628446579, -0.017638154327869415, -0.015565498732030392, 0.043951258063316345, 0.0128888925537467, 0.023224713280797005, 0.017294999212026596, -0.015524320304393768, -0.029566213488578796, -0.02978583239018917, -0.035633187741041183, -0.017995035275816917, 0.021289320662617683, 0.009265177883207798, 0.03670383244752884, -0.04293552041053772, -0.03489197418093681, -0.012449653819203377, -0.018571535125374794, 0.02157757058739662, -0.028907354921102524, 0.033464450389146805, -0.02196190319955349, -0.011118213646113873, -0.014947820454835892, -0.017185188829898834, -0.006073839031159878, -0.017089106142520905, 0.032229091972112656, -0.00691456813365221]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
" 7B
16 MB 32 MB 64 MB0.50.60.70.8Mistral 7B
128 MB 256 MB 512 MB0.40.50.60.70.8TriviaQA Accuracy
64 MB 128 MB 256 MB0.40.50.60.70.8
16 MB 32 MB 64 MB0.50.60.70.8
64 MB 128 MB 256 MB 512 MB0.120.150.180.21CNN/DailyMail ROUGE-L
64 MB 128 MB 256 MB0.120.150.180.21
16 MB 32 MB 64 MB0.120.150.180.210.24
64 MB 128 MB 256 MB 512 MB0.60
0.65
0.70
0.75WikiText-103 BPC
64 MB 128 MB 256 MB0.65
0.70
0.75
0.80
16 MB 32 MB 64 MB0.65
0.70
0.75
128 MB 256 MB 512 MB
Attention transfers per token0100200Repetition match length
64 MB 128 MB 256 MB 512 MB
Attention transfers per token050100150200
16 MB 32 MB 64 MB 128 MB
Attention transfers per token0100200
Dense
SparQ AttentionH2O
LM-InﬁniteFlexGen (16-bit)
Figure A1: Compression versus performance trade-off curves over all tasks and multiple models. The y-axis minimum is set
to (0.5,0.5,0.5,1.25,0.0)×the dense baseline for the tasks, reading top-to-bottom, in order to give a consistent view of the
performance loss across models. Vertical dotted lines show ( 1/2), (1/4) and ( 1/8) compression versus dense. Shaded lines
show±1standard error of the mean.
11
SparQ Attention: Bandwidth-Efficient LLM Inference
64 MB 128 MB 256 MB0.30.40.50.6SQuAD AccuracyPythia 6.9B
32 MB 64 MB 128 MB0.30.40.5Pythia 2.8B
16 MB 32 MB 64 MB 128 MB0.250.300.350.400.45Pythia 1.4B
64 MB 128 MB 256 MB0.30.40.5TriviaQA Accuracy
32 MB 64 MB 128 MB0.30.40.5
16 MB 32 MB 64 MB 128 MB0.250.300.350.400.45
32 MB 64 MB 128 MB 256 MB0.120.150.180.21CNN/DailyMail ROUGE-L
32 MB 64 MB 128 MB0.120.150.180.21
16 MB 32 MB 64 MB0.100.120.140.160.18
64 MB 128 MB 256 MB0.70
0.75
0.80
0.85WikiText-103 BPC
32 MB 64 MB 128 MB0.70
0.75
0.80
0.85
16 MB 32 MB 64 MB 128 MB0.75
0.80
0.85
0.90
64 MB 128 MB 256 MB
Attention transfers per token050100150Repetition match length
32 MB 64 MB 128 MB 256 MB
Attention transfers per token050100150
32 MB 64 MB 128 MB
Attention transfers per token050100150
Dense
SparQ AttentionH2O
LM-InﬁniteFlexGen (16-bit)
Figure A2: Compression versus performance trade-off curves for Pythia models (see Figure A1).
12
SparQ Attention: Bandwidth-Efficient LLM Inference
B. Code
from torch import softmax, sqrt, tensor, topk
defgather(t, dim, i):
dim += (dim < 0) *t.ndim
returnt.gather(dim, i.expand( *t.shape[:dim], i.shape[dim], *t.shape[dim + 1 :]))
defattn(Q, K, V, M):
s = (Q @ K.transpose(-1, -2)) / sqrt(tensor(Q.shape[-1])) + M
y = softmax(s, dim=-1) @ V
returny
defsparq_attn(Q, K, V, V_mean, M, r, k):
# Q -- (batch_size, n_kv_heads, n","[0.026913614943623543, 0.013810364529490471, 0.03151706978678703, 0.008074084296822548, -0.010628352873027325, -0.0015801828121766448, -0.0003163522342219949, 0.007734958548098803, -0.025441663339734077, 0.026711583137512207, -0.00557032460346818, -0.002020325046032667, -0.028919508680701256, 0.02561483532190323, 0.023147152736783028, -0.00700259068980813, 0.02238231524825096, -0.007035060320049524, -0.021790647879242897, 0.024647966027259827, -0.018038615584373474, -0.04031991586089134, 0.013658840209245682, -0.012316767126321793, 0.03160365670919418, 0.014770018868148327, 0.016393493860960007, 0.004098373465240002, 0.06378454715013504, -0.04332154244184494, 0.03293129801750183, -0.03642357513308525, -0.01792316883802414, -0.06216828525066376, 0.006923221051692963, 0.022973980754613876, -0.005494562443345785, 0.05599186569452286, -0.03688536211848259, 0.020968087017536163, -0.018384957686066628, -0.04456259682774544, -0.08341056108474731, 0.017475811764597893, 0.028385566547513008, -0.011126218363642693, 0.018211787566542625, -0.018283940851688385, 0.013261990621685982, 0.0504504032433033, -0.02482113614678383, 0.04309064522385597, -0.0283134113997221, 0.04796828702092171, 0.011948779225349426, 0.01855812780559063, 0.008081300184130669, 0.00537189980968833, 0.0363369882106781, -1.345849909739627e-06, 0.009026523679494858, -0.04935365542769432, 0.010303657501935959, -0.011465344578027725, -0.006439785938709974, -0.007395832799375057, -0.04320609197020531, 0.03044918365776539, -0.021530892699956894, 0.010296442545950413, -0.035182517021894455, 0.03977154195308685, 0.043263815343379974, -0.016754265874624252, 0.022468900308012962, 1.8348655430600047e-05, 0.0007080156938172877, 0.07815771549940109, 0.03783779963850975, -0.028284549713134766, 0.02411402203142643, 0.010101624764502048, 0.057954467833042145, 0.010953047312796116, -0.010202641598880291, -0.034374386072158813, -0.03575975447893143, -0.0023035313934087753, -0.04029105231165886, 0.008355487138032913, -0.0629764199256897, 0.025254063308238983, -0.02769288420677185, 0.005256452597677708, 0.03815528005361557, -0.010599491186439991, 0.059455279260873795, -0.020607315003871918, -0.010714937932789326, 0.02492215298116207, 0.017879877239465714, 0.04450487345457077, 0.008499795570969582, 0.007713312283158302, 0.018861176446080208, -0.02046300657093525, -0.041993897408246994, 0.0009344003046862781, -0.01839938759803772, 0.02301727421581745, -0.06874877214431763, 0.019092071801424026, -0.015296746045351028, 0.04395649954676628, 0.012901218608021736, -0.07296259701251984, -0.03267154097557068, 0.016855282709002495, 0.000811286736279726, 0.032642681151628494, -0.04011788219213486, 0.004480792209506035, 0.017749998718500137, -0.01705731637775898, 0.023695526644587517, -0.03524024039506912, 0.04124349355697632, -0.05674226954579353, -0.002574110636487603, -0.004397814627736807, 0.048199184238910675, 0.0005614519468508661, 0.06482356786727905, -0.00852144230157137, 0.002682342194020748, -0.016783127561211586, -0.005869765765964985, 0.026293087750673294, -0.010541766881942749, 0.005519816651940346, -0.021545322611927986, 0.023421339690685272, -0.012691969983279705, 0.03705853223800659, -0.02720223367214203, 0.041301216930150986, -0.035990647971630096, 0.04031991586089134, -0.029843086376786232, -0.0008306782692670822, 0.0008139925776049495, -0.012547661550343037, -0.05737723037600517, -0.00935843400657177, -0.026235362514853477, -0.06309186667203903, -0.006216106936335564, 0.06309186667203903, 0.03682763874530792, -0.044620320200920105, -0.0018300176598131657, 0.011486990377306938, 0.005137397907674313, -0.013889734633266926, -0.013730994425714016, 0.024532517418265343, -0.0691528394818306, 0.023378046229481697, -0.08773983269929886, -0.06840243190526962, 0.029785363003611565, -0.012071441859006882, 0.004534908104687929, -0.04453373700380325, -0.005902235396206379, -0.01896219328045845, -0.026682721450924873, -0.016855282709002495, -0.05330771952867508, -0.05281706899404526, -0.037578046321868896, -0.01704288460314274, -0.011450913734734058, 0.027332110330462456, -0.02975650131702423, -0.022310160100460052, -0.03371056541800499, 0.019149795174598694, 0.00955325085669756, 0.006439785938709974, 0.00048027816228568554, 0.021314429119229317, 0.05148942768573761, 0.006519156042486429, -0.007168545853346586, -0.03662560507655144, 0.03443210944533348, 0.013666055165231228, -0.03532682731747627, 0.01391859631985426, 0.009170832112431526, 0.042888615280389786, 0.005905842874199152, -0.06424633413553238, 0.025326216593384743, -0.05226869508624077, -0.010938616469502449, -0.037491459399461746, -0.0626300722360611, -0.013406299985945225, 0.050334952771663666, 0.009632620960474014, 0.047477636486291885, -0.011328251101076603, -0.028529874980449677, 0.03642357513308525, -0.03726056590676308, 0.0038277944549918175, -0.019380688667297363, 0.0791967436671257, 0.001721785869449377, 0.02603333070874214, 0.03310446813702583, 0.04600568488240242, -0.08381462842226028, 0.0379243865609169, 0.03838617354631424, -0.01920751854777336, 0.016624389216303825, -0.017475811764597893, 0.010491259396076202, 0.0003966240619774908, -0.006735619157552719, 0.02173292450606823, 0.010700507089495659, -0.05515487119555473, 0.004830741323530674, -0.011523067951202393, -0.015902843326330185, -0.06661300361156464, 0.006944867316633463, 0.011241666041314602, 0.020823778584599495, 0.02291625738143921, -0.005296137649565935, 0.02132885903120041, -0.020823778584599495, -0.03460527956485748, 0.022079266607761383, -0.024864427745342255, -0.0008956172969192266, -0.006952082738280296, -0.04020446911454201, -0.007821544073522091, -0.02720223367214203, -0.013146543875336647, -0.022988412529230118, 0.032325200736522675, -0.032556094229221344, 0.008579165674746037, 0.00420660525560379, 0.00825447030365467, -0.021372152492403984, 0.0014521086122840643, 0.016624389216303825, 0.006681503262370825, -0.011876625008881092, 0.01114786509424448, -0.025759143754839897, -0.028746338561177254, 0.014062904752790928, -0.015989430248737335, 0.021141258999705315, 0.009257418103516102, -0.019322965294122696, -0.02381097339093685, -0.004964227322489023, -0.008730689994990826, -0.04736218973994255, 0.004015395883470774, 0.010303657501935959, 0.015051421709358692, 0.03267154097557068, 0.01880345307290554, 0.018976625055074692, -0.034403249621391296, 0.01800975389778614, 0.029540037736296654, -0.023421339690685272, -0.04320609197020531, 0.04672723263502121, -0.020131096243858337, 0.04488007724285126, -0.01910650171339512, -0.0015269689029082656, -0.013738210313022137, -0.015368901193141937, -0.033681705594062805, -0.002723830984905362, -0.023305892944335938, 0.029006095603108406, 0.002682342194020748, 0.020015647634863853, -0.024864427745342255, -0.021227844059467316, 0.028905078768730164, 0.020722761750221252, 0.012872356921434402, -0.01714390143752098, -0.004080335143953562, -0.008737905882298946, 0.030045118182897568, -0.005588363390415907, 0.03131503611803055, -0.07573332637548447, -0.03212316706776619, 0.0036383888218551874, -0.017634551972150803, 0.05068129673600197, -0.04222479090094566, 0.0066273873671889305, -0.082544706761837, -0.019149795174598694, -0.002942098304629326, 0.032642681151628494, -0.024056298658251762, -0.05974389612674713, 0.0031585616525262594, -0.006493901833891869, -0.0299873948097229, 0.01926524192094803, 0.012201320379972458, 0.025513818487524986, 0.0034417679999023676, -0.04955568537116051, -0.02460467256605625, -0.019698169082403183, 0.024647966027259827, -0.03275812789797783, 0.05290365219116211, -0.07405934482812881, -0.030564630404114723, -0.023204876109957695, -0.0013438769383355975, 0.009077032096683979, -0.01635020226240158, 0.07117316126823425, 0.00777103565633297, 0.060494303703308105, 0.01297337282449007, 0.008730689994990826, 0.00035400784690864384, 0.04401422291994095, -0.023911990225315094, 0.039944712072610855, -0.03734714910387993, 0.020506298169493675, -0.034056905657052994, -0.026134347543120384, 0.025484956800937653, -0.04681381583213806, -0.005119359120726585, 0.033364225178956985, -0.028111379593610764, 0.020838208496570587, 0.004596239421516657, 0.0004929052083753049, 0.027664022520184517, 0.0002545699826441705, -0.028342273086309433, -0.011717884801328182, 0.05789674073457718, -0.012042580172419548, -0.04020446911454201, -0.04124349355697632, -0.029150404036045074, -0.007475202437490225, 0.04436056315898895, 0.0012121950276196003, 0.007626726757735014, 0.010209856554865837, 0.019698169082403183, 0.0037231703754514456, 0.005555893760174513, 0.03218089044094086, -0.039627231657505035, 0.029727639630436897, 0.006887143477797508, -0.07417479157447815, 0.0023865089751780033, 0.004401422571390867, 0.008932722732424736, -0.011169510893523693, 0.007323678117245436, 0.03365284204483032, 0.021155688911676407, -0.011494206264615059, 0.02450365573167801, 0.019626013934612274, 0.04063739627599716, -0.01984247751533985, 0.01839938759803772, -0.035817477852106094, -0.037953250110149384, -0.014474185183644295, -0.003079191781580448, 0.02515304647386074, 0.05749267712235451, 0.014820527285337448, -0.01090253982692957, 0.05648251622915268, -0.06592031568288803, 0.016783127561211586, -0.03601950779557228, -0.014964835718274117, -0.041676416993141174, -0.002106910338625312, 0.03674105182290077, -0.0033173016272485256, 0.05431788042187691, -0.07209674268960953, -0.04531300440430641, -0.036769915372133255, -0.026596136391162872, -0.06234145909547806, -0.017648981884121895, 0.010217072442173958, -0.055010564625263214, 0.024691257625818253, 0.010895323939621449, -0.018774591386318207, 0.016624389216303825, 0.035961784422397614, -0.003719562664628029, -0.023594509810209274, -0.04309064522385597, -0.0038494407199323177, 0.04785284027457237, -0.010779877193272114, -0.021227844059467316, -0.0023558433167636395, -0.01889003813266754, 0.00995010044425726, -0.0011238057631999254, -0.039858125150203705, -0.010166564024984837, 0.018110770732164383, -0.021675201132893562, 0.05879145860671997, -0.05411584675312042, -0.011205588467419147, -0.03682763874530792, 0.017317071557044983, 0.009293494746088982, -0.02157418429851532, -0.0664975568652153, 0.10176665335893631, 0.0033407516311854124, 0.03220975399017334, -0.03561544418334961, 0.06228373572230339, -0.007038667798042297, -0.027721745893359184, 0.0033948675263673067, -0.009394511580467224, 0.01777886040508747, 0.022815242409706116, 0.022699793800711632, 0.022468900308012962, 0.031113004311919212, -0.007496848702430725, -0.04499552398920059, 0.014308230020105839, -0.03945406153798103, 0.014149490743875504, -0.014820527285337448, 0.026379672810435295, 0.01762012019753456, -0.00678612757474184, -0.03607723116874695, 0.03379715234041214, -0.018442681059241295, -0.01864471286535263, 0.034720730036497116, -0.002119537442922592, 0.07134633511304855, 0.07111544162034988, -0.026365241035819054, 0.029410159215331078, -0.019178656861186028, -0.05928210914134979, -0.010303657501935959, 0.039713818579912186, -0.01800975389778614, 0.0539715401828289, 0.029958533123135567, 0.004202997777611017, -0.009791361168026924, 0.010563413612544537, -0.048112597316503525, -0.004264329094439745, 0.004949796479195356, 0.02776503749191761, -0.0036275656893849373, 0.006807773839682341, 0.00259756064042449, 0.01642235554754734, 0.02577357552945614, -0.03855934739112854, 0.037808939814567566, 0.010996340773999691, -0.0028464936185628176, -0.005389938596636057, 0.04626544192433357, -0.005144613329321146, 0.03945406153798103, 0.015368901193141937, 0.01714390143752098, -0.00199326709844172, 0.02150203101336956, -0.025369510054588318, -0.014777234755456448, -0.026610566303133965, 0.015614226460456848, -0.011328251101076603, -0.040175605565309525, -0.03093983419239521, -0.10753901302814484, 0.0010218876414000988, -0.0696723535656929, 0.004318444523960352, -0.03980040177702904, -0.019654875621199608, -0.02157418429851532, -0.03821300342679024, 0.03469186648726463, 0.011847763322293758, -0.010714937932789326, -0.018197355791926384, 0.05163373425602913, 0.002999821910634637, 0.01396188884973526, 0.0062269303016364574, 0.012518799863755703, 0.021473169326782227, -0.02078048512339592, 0.0391654446721077, -0.003008841071277857, -0.0299873948097229, -0.010043901391327381, 0.04173414409160614, -0.010801522992551327, 0.03039146028459072, -0.015412193723022938, -0.02688475325703621, 0.0033840443938970566, -0.004372560419142246, 0.03134389966726303, -0.0020473829936236143, 0.006764480844140053, 0.041676416993141174, 0.005458485335111618, -0.019553860649466515, -0.03284471109509468, -0.04412966966629028, 0.013348575681447983, -0.0028248473536223173, -0.02021768130362034, 0.006198068615049124, -0.002958333119750023, -0.03160365670919418, -0.015282315202057362, -0.00239913584664464, -0.03659674525260925, -0.0017993520013988018, -0.024215038865804672, 0.032411783933639526, 0.03832845017313957, -0.013500100001692772, -0.02158861607313156, -0.05198007449507713, -0.013464023359119892, 0.003932418301701546, -0.00916361715644598, -0.051056500524282455, 0.006447001360356808, 0.0025903452187776566, -0.0020960872061550617, -0.04349471256136894, 0.010541766881942749, 0.04135894030332565, -0.005285314749926329, 0.02078048512339592, -0.01531117781996727, -0.028125809505581856, -0.0041091968305408955, -0.025037599727511406, -0.0488630048930645, -0.020838208496570587, 0.01896219328045845, 0.01984247751533985, -0.014481401070952415, -0.020592885091900826, -0.007085568271577358, -0.02863089181482792, 0.023926420137286186, -0.037231702357530594, 0.041445523500442505, 0.011869409121572971, 0.0025903452187776566, 0.011883839964866638, -0.032325200736522675, -0.02578800544142723, -0.02079491689801216, -0.02547052688896656, 0.003658231347799301, -0.026379672810435295, -0.012035364285111427, 0.055183734744787216, -0.005407976917922497, -0.01730263978242874, -0.01889003813266754, -0.006241361144930124, 0.02261320874094963, -0.001612652326002717, 0.02894837036728859, 0.0020726369693875313, -0.04173414409160614, -0.006104267667979002, 0.010866462253034115, -0.07238535583019257, 0.006641818676143885, 0.02245446853339672, 0.01912093348801136, -0.03301788121461868, -0.0020004825200885534, -0.00497865816578269, 0.01237449049949646, 0.04355243593454361, -0.022800810635089874, 0.03529796376824379, 0.022887395694851875, 0.022959550842642784, -0.029540037736296654, 0.01792316883802414, 0.01601829193532467, -0.04034877568483353, 0.0014223449397832155, -0.02610548585653305, -0.017172763124108315, -0.0012924668844789267, -0.036769915372133255, 0.008846137672662735, 0.019698169082403183, 0.013940242119133472, -0.03855934739112854, -0.030506907030940056, -0.03977154195308685, -0.020260972902178764, -0.014741157181560993, -0.05864714831113815, 0.0020437752828001976, -0.008947153575718403, -0.04306178539991379, 0.01601829193532467, 0.024936582893133163, 0.01808190904557705, 0.0011851370800286531, 0.006493901833891869, -0.014575202018022537, 0.02737540379166603, 0.011494206264615059, 0.02871747687458992, -0.002087067812681198, 6.849037163192406e-05, -0.047477636486291885, -0.015729673206806183, -0.03674105182290077, -0.02942459098994732, 0.03062235563993454, -0.015989430248737335, -0.005361076910048723, -0.06343820691108704, 0.014661787077784538, 0.007922559976577759, 0.0006227832054719329, 0.040983736515045166, 0.00792977586388588, 0.004148881882429123, -0.0071036070585250854, 0.02039085142314434, 0.0014530104817822576, 0.008478149771690369, -0.029063818976283073, -0.008088515140116215, 0.009769714437425137, -0.007348932325839996, 0.03151706978678703, -0.0070242369547486305, 0.0010056528262794018, -0.009416157379746437, 0.04513983428478241, -0.001252781949006021, -0.012367275543510914, -0.02101138047873974, -0.017807722091674805, -0.007648373022675514, 0.013752641156315804, 0.052095524966716766, -0.020809346809983253, -0.02848658338189125, 0.016537804156541824, -0.027332110330462456, -0.016566665843129158, 0.00277614314109087, -0.010325304232537746, -0.008615243248641491, 0.0347495898604393, 0.004982265643775463, 0.014834958128631115, -0.006663464941084385, 0.025095323100686073, -0.02966991625726223, -0.0005213160184212029, -0.0005614519468508661, -0.020246542990207672, 0.008196746930480003, 0.0009876142721623182, 0.027231095358729362, 0.022266868501901627, 0.0025109753478318453, 0.04329267889261246, -0.007352539803832769, -0.007605080492794514, -0.02023211121559143, -0.005700202658772469, -0.022728655487298965, 0.029410159215331078, -0.03841503709554672, -0.022151419892907143, 0.0021159297320991755, -0.03275812789797783, -0.007359755225479603, 0.04161869361996651, -0.012150811962783337, 0.014834958128631115, -0.0018453504890203476, 0.015845119953155518, 0.004314837045967579, 0.00029357848688960075, -0.02451808750629425, 0.013882518745958805, 0.020361989736557007, 0.0026931653264909983, 0.021848371252417564, -0.016783127561211586, 0.026466257870197296, -0.03293129801750183, -0.003506707027554512, 0.013413514941930771, 0.011256096884608269, -0.00218988792039454, 0.0039432416670024395, 0.008737905882298946, -0.012655893340706825, -0.006591310258954763, 0.0010092605371028185, -0.007013414055109024, 0.019250812008976936, -0.02222357504069805, -0.018601421266794205, 0.0015161456540226936, -0.009098677895963192, 0.02435934729874134, 0.05166259780526161, -0.033999182283878326, 0.028140241280198097, -0.015239022672176361, 0.010909754782915115, 0.02871747687458992, -0.027259957045316696, -0.006533586885780096, 0.002768927486613393, -0.02379654161632061, -0.008081300184130669, -0.03402804583311081, -0.039309751242399216, -0.032873574644327164, -0.01831280253827572, -0.017807722091674805, -0.026451826095581055, 0.005054420325905085, -0.028818493708968163, -0.010267579928040504, 0.028544306755065918, -0.006912397686392069, -0.002936686621978879, -0.0942048653960228, -0.03982926532626152, 0.02482113614678383, -0.02079491689801216, 0.031286176294088364, 0.015224591828882694, 0.016941867768764496, -7.237994577735662e-05, 0.03552885726094246, -0.003564430633559823, 0.005411584861576557, 0.0006615662714466453, -0.003663643030449748, 0.0073381089605391026, -0.006602133624255657, -0.05330771952867508, 0.01198485679924488, 0.01435873843729496, 0.048430077731609344, -0.057319507002830505, -0.026841461658477783, 0.017418088391423225, -0.004000965040177107, 0.03691422566771507, -0.02142987586557865, -0.029727639630436897, 0.007835974916815758, 0.016162600368261337, 0.023623371496796608, -0.00029064720729365945, 0.002566894982010126, -0.003035899018868804, 0.0076195113360881805, 0.0598016194999218, -0.04583251476287842, 0.017749998718500137, -0.023118291050195694, -0.004282367415726185, 0.03347967192530632, -0.0022872965782880783, -0.01114064920693636, -0.06545852869749069, 0.005148221272975206, 0.011652946472167969, 0.019019916653633118, -0.032411783933639526, 0.016855282709002495, -0.01396910473704338, -0.004325659945607185, -0.014409246854484081, -0.013658840209245682, 0.0006060975138098001, -0.011220019310712814, 0.020506298169493675, -0.004076727200299501, 0.004156097304075956, -0.010476828552782536, -0.008701828308403492, 0.013305283151566982, -0.0038277944549918175, -0.03131503611803055, 0.04135894030332565, 0.027736175805330276, -0.03394145891070366, -0.029410159215331078, -0.024951014667749405, 0.019871339201927185, -0.002359451027587056, 0.017172763124108315, -0.012165242806077003, -0.01015213318169117, -0.003950457088649273, -0.012792986817657948, -0.019799185916781425, 0.0028194356709718704, 0.016220323741436005, 0.011270527727901936, 0.010375811718404293, -0.05402926355600357, 0.021530892699956894, -0.00738140195608139, -0.02689918503165245, -0.003616742556914687, -0.003604115452617407, -0.007734958548098803, 0.018356095999479294, 0.03189227357506752, -0.033826012164354324, 0.012085872702300549, 0.05324999615550041, 0.02656727470457554, -0.00517708295956254, 0.008788413368165493, -0.017648981884121895, -0.010931401513516903, -0.01050569023936987, -0.0061475601978600025, -0.00460345484316349, 0.026321949437260628, 0.014964835718274117, 0.02444593235850334, 0.006493901833891869, 0.02388312853872776, -0.04955568537116051, -0.011068494990468025, -0.007114430423825979, -0.015845119953155518, -0.019019916653633118, 0.04496666416525841, -0.028760770335793495, 0.006511940620839596, 0.009221340529620647, -0.0011183941969648004, 0.020823778584599495, -0.0037664631381630898, 0.010476828552782536, 0.021516460925340652, 0.01070772297680378, 0.01039024256169796, -0.03786666318774223, -0.014632925391197205, 0.035817477852106094, 0.025254063308238983, -0.010570629499852657, -0.020333128049969673, -0.022959550842642784, 0.004300406202673912, 0.056684546172618866, 0.004718902055174112, 0.022569917142391205, -0.012129165232181549, 0.009748068638145924, -0.018817884847521782, 0.025196339935064316, -0.009286279790103436, 0.0022241612896323204, 0.022108128294348717, 0.007309247273951769, -0.02697133831679821, 0.010678860358893871, 0.002754496643319726, 0.02443150244653225, 0.03555772081017494, 0.0011562752770259976, -0.036769915372133255, -0.004408637993037701, 0.009098677895963192, -0.02150203101336956, 0.005851726979017258, 0.008276117034256458, 0.015974998474121094, -0.04245568811893463, -0.002844689879566431, 0.013103250414133072, -0.0007706998731009662, 0.0023450201842933893, -0.02545609511435032, -0.01313211303204298, 0.013709348626434803, 0.03489390015602112, -0.009834653697907925, 0.02753414399921894, 0.025715850293636322, 0.004935365170240402, 0.023031705990433693, -0.014301015064120293, -0.004365344997495413, -0.029164833948016167, -0.006125913932919502, 0.03832845017313957, 0.013110466301441193, -0.018745729699730873, 0.02806808613240719, 0.005606401711702347, 0.018053047358989716, 0.050017476081848145, 0.013160974718630314, -0.019856909289956093, -0.00064984115306288, 0.014387600123882294, 1.4409753930522129e-05, 0.017014022916555405, -0.007799897808581591, 0.005047204904258251, 0.038357313722372055, 0.007778251077979803, 0.011061279103159904, 0.02951117604970932, 0.0061439527198672295, 0.02943902090191841, 0.021458737552165985, 0.007749389391392469, -0.01617703028023243, 0.04773739352822304, 0.012684755027294159, -0.00971199106425047, 0.02222357504069805, 0.016754265874624252, 0.0007188388262875378, 0.014301015064120293, 0.03394145891070366, 0.0058625503443181515, 0.006995375268161297, -0.011436482891440392, -0.027721745893359184, 0.02642296440899372, -0.011609653010964394, -0.013427945785224438, -0.0003867028281092644, 0.01357225514948368, -0.015816258266568184, -0.004188566468656063, 0.0034706296864897013, 0.01209308858960867, -0.02966991625726223, -0.005328607279807329, 0.006796950474381447, 0.002613795455545187, -0.037231702357530594, 0.004347306676208973, -0.012562092393636703, -0.011198372580111027, -0.00458180857822299, -0.0033118899445980787, -0.006317123305052519, -0.018298372626304626, 0.018659144639968872, 0.0012753301998600364, -0.002696773037314415, 0.02443150244653225, 0.007327286060899496, 0.019149795174598694, -0.027707314118742943, 0.011862194165587425, 0.018457112833857536, -0.018154064193367958, -0.010188210755586624, -0.03529796376824379, -0.0029926064889878035, 0.012865141034126282, 0.012583738192915916, 0.010361380875110626, -0.006677895784378052, 0.00259756064042449, -0.0030918188858777285, -0.018702438101172447, -0.0017064530402421951, 0.065978042781353, 0.010217072442173958, 0.0022872965782880783, -0.006161991506814957, -0.009748068638145924, 0.003167581046000123, -0.0282268263399601, 0.01619146205484867, -0.013875303789973259, 0.019698169082403183, 0.030737802386283875, 0.04291747510433197, 0.019077640026807785, -0.020275404676795006, 0.03451869636774063, -0.01059227529913187, -0.004156097304075956, 0.024460364133119583, -0.03319105505943298, 0.006876320578157902, -0.006288261618465185, 0.00010879540059249848, 0.004397814627736807, -0.05711747333407402, 0.002462271135300398, 0.011162295937538147, 0.004116412252187729, 0.0010778072755783796, 0.0017154724337160587, 0.007363363169133663, -0.004282367415726185, 0.04086828976869583, -0.008081300184130669, -0.028197964653372765, -0.01839938759803772, 0.011912701651453972, -0.004055080935359001, 0.008737905882298946, 0.0007129763253033161, -0.018933331593871117, -0.013889734633266926, 0.050969913601875305, -0.0074174790643155575, -0.013456807471811771, 0.024142883718013763, 0.007655588909983635, -0.013146543875336647, 0.0031441308092325926, 0.003016056725755334, -0.014705079607665539, 0.028890646994113922, 0.011573576368391514, -0.02806808613240719, 0.010462397709488869, -0.016407925635576248, 0.03062235563993454, -0.006778912153095007, 0.026827029883861542, 0.02372438833117485, 0.019727030768990517, -0.030968695878982544, -0.039136581122875214, 0.01746137998998165, -0.01800975389778614, 0.016624389216303825, 0.027332110330462456, 0.01990020088851452, -0.00036753679160028696, 0.022396745160222054, 0.021934958174824715, -0.03746259957551956, 0.007132468745112419, 0.007363363169133663, -0.008341056294739246, 0.038674794137477875, -0.00479827169328928, -0.020650608465075493, 0.0017199820140376687, -0.030131705105304718, -0.020044511184096336, -0.028342273086309433, 0.00832662545144558, 0.020131096243858337, 0.024417070671916008, 3.903669130522758e-05, -0.0008279724861495197, 0.027822760865092278, -0.028529874980449677, 0.01375985611230135, -0.032325200736522675, -0.034230079501867294, -0.017158331349492073, -0.003831402165815234, 0.007388617377728224, 0.010686076246201992, -0.002489329082891345, -0.020405283197760582, -0.014618494547903538, 0.03425893932580948, 0.0037592477165162563, 0.0054657007567584515, -0.002207926707342267, -0.0073850094340741634, 0.08566178381443024, -0.03567316755652428, -0.010166564024984837, -0.02117012068629265, 0.001018279930576682, 0.03818414360284805, -0.004545731469988823, -0.002029344206675887, -0.020766055211424828, 0.014286584220826626, -0.010231503285467625, 0.011436482891440392, -0.013096035458147526, 0.008838921785354614, 0.008737905882298946, 0.0028771592769771814, -0.0014656375860795379, 0.017360365018248558, 0.008622458204627037, -0.0021267528645694256, 0.04681381583213806, 0.005169867537915707, -0.004899288062006235, -0.00976249948143959, -0.021213412284851074, 0.0034038869198411703, -0.027303248643875122, 0.0018904469907283783, 0.01920751854777336, 0.03861707076430321, 0.008846137672662735, -0.05111422389745712, -0.03904999792575836, -0.01015213318169117, 0.019698169082403183, 0.020203249529004097, -0.048516660928726196, 0.030910972505807877, -0.002529013901948929, -0.000764386379159987, -0.00359148858115077, 0.015974998474121094, -0.018197355791926384, 0.007269562222063541, -0.013868087902665138, -0.02545609511435032, -0.01659552752971649, 0.020203249529004097, -0.011602438054978848, 0.0069412593729794025, 0.010260364972054958, 0.017086178064346313, -0.002067225519567728, -0.03714511916041374, 0.01142926700413227, -0.021372152492403984, 0.015888413414359093, 0.026783736422657967, -0.003885517828166485, 0.023984143510460854, -0.033508531749248505, -0.03163251653313637, -0.020650608465075493, 0.0023522356059402227, -0.01984247751533985, -0.06413088738918304, -0.006869105156511068, 0.013067173771560192, 0.00258854147978127, 0.028140241280198097, -0.011840547434985638, 0.01792316883802414, 0.010051117278635502, -0.011761177331209183, -0.006212499458342791, 0.02539837174117565, -0.0030918188858777285, 0.020030079409480095, 0.040723979473114014, 0.04750650003552437, -0.027490850538015366, -0.012590954080224037, -0.009639836847782135, -0.001075101550668478, -0.0029348828829824924, -0.02412845380604267, 0.02714451029896736, -0.01182611659169197, 0.0060609751380980015, 0.004570985212922096, -0.017663413658738136, -0.023219306021928787, 0.008470933884382248, -0.008636889047920704, -0.008550303988158703, -0.010447966866195202, 0.0033587904181331396, -0.010823169723153114, 0.01273526344448328, 0.0022728657349944115, 0.0009984374046325684, -0.011790039949119091, -0.004762194585055113, -0.007330893538892269, -0.007756604813039303, 0.0005154534592293203, -0.03411463275551796, -0.0243449155241251, 0.03936747461557388, 0.0022512192372232676, 0.008867783471941948, -0.0026210108771920204, 0.014524693600833416, -0.002426193794235587, 0.002280081156641245, 0.012843494303524494, -0.012612600810825825, 0.017331503331661224, -0.0047044712118804455, -0.036048371344804764, 0.04450487345457077, 0.01202093344181776, 0.029612192884087563, -0.0029871948063373566, -0.0027635160367935896, 0.017071746289730072, 0.008954369463026524, 0.015686379745602608, -0.04918048158288002, -0.005159044172614813, 0.009012092836201191, 0.00865131989121437, 0.03720284253358841, -0.0013736406108364463, 0.031113004311919212, 0.024864427745342255, 0.005920273717492819, -0.0020149133633822203, -0.02037642151117325, -0.0013628174783661962, 0.017749998718500137, 0.03319105505943298, -0.0007400342146866024, 0.018384957686066628, 0.004343698732554913, -0.00581204192712903, 0.01777886040508747, -0.025181908160448074, 0.00876676756888628, -0.020246542990207672, 0.017879877239465714, -0.029727639630436897, 0.009892377071082592, 0.017648981884121895, 0.01015213318169117, -0.01776442863047123, 0.009978962130844593, 0.005642479285597801, -0.028703046962618828, 0.009704775176942348, 0.015585364773869514, 0.01079430803656578, -0.021675201132893562, -0.0007035060552880168, 0.037404876202344894, -0.023132720962166786, -0.018586989492177963, -0.0005515306838788092, 0.006833027582615614, -0.00658770278096199, 0.011458128690719604, 0.007063922006636858, -0.004249897785484791, -0.0006214303430169821, -5.673708437825553e-05, -0.004401422571390867, -0.017576826736330986, 0.013586685992777348, -0.01704288460314274, 0.020015647634863853, -0.007720527704805136, 0.015989430248737335, -0.025643697008490562, 0.005530639551579952, 0.004809095058590174, -0.01535447034984827, -0.0028627284336835146, 0.0009569486137479544, 0.0004252603685017675, -0.009423373267054558, 0.015513209626078606, -0.005819257348775864, 0.026062192395329475, -0.00517708295956254, 0.005588363390415907, 0.043263815343379974, 0.009423373267054558, 0.05939755588769913, 0.045024387538433075, 0.01698516122996807, -0.010837600566446781, -0.004552946891635656, -0.012323983013629913, -0.03619267791509628, -0.0015278707724064589, 0.03443210944533348, -0.008001930080354214, 0.0030304875690490007, 0.015657518059015274, -0.017115039750933647, 0.033277638256549835, -0.009971747174859047, -0.017490241676568985, 0.017490241676568985, -0.009430588223040104, 0.0026805384550243616, 0.005418800283223391, 0.014012397266924381, -0.017490241676568985, -0.028298981487751007, -0.002036559861153364, 0.015960566699504852, 0.01372377946972847, -0.005909450817853212, -0.016682112589478493, 0.008557519875466824, 0.004166920203715563, 0.014690648764371872, 0.02324816770851612, 0.005577540025115013, -0.020491868257522583, -0.00010304559691576287, 0.008882214315235615, -0.020246542990207672, -0.002023932756856084, 0.0034724336583167315, -0.02007337287068367, -0.0017768037505447865, 0.01562865637242794, 0.024243900552392006, -0.008218393661081791, 0.008716259151697159, 0.003972103353589773, -0.003277616575360298, -0.016913006082177162, 0.01688414439558983, 0.013269206508994102, 0.024460364133119583, -0.008867783471941948, 0.03853048384189606, -0.018356095999479294, 0.0015522228786721826, -0.03085324913263321, -0.035269103944301605, 0.025037599727511406, -0.023493492975831032, -0.006486686412245035, -0.00944501906633377, 0.03171910345554352, -0.01610487699508667, -0.014430892653763294, 0.013629978522658348, 0.020131096243858337, -0.020809346809983253, -0.005321391858160496, 0.027563005685806274, -0.005086889956146479, 0.012944511137902737, -0.024013005197048187, -0.013045527040958405, -0.010577844455838203, -0.0026101877447217703, 0.000777464359998703, 0.012439429759979248, 0.009546035900712013, 0.02665385976433754, 0.009069816209375858, 0.03218089044094086, -0.020520729944109917, -0.037000808864831924, 0.028342273086309433, -0.00022052208078093827, 0.0015314784832298756, -0.029150404036045074, 0.013752641156315804, 0.04505324736237526, 0.010693291202187538, 0.009351219050586224, -0.0004856897285208106, 0.0071036070585250854, 0.009214125573635101, 0.002123145153746009, 0.035586580634117126, -0.03489390015602112, -0.014820527285337448, -0.006068190559744835, -0.0011905486462637782, -0.017100607976317406, -0.026379672810435295, 0.014661787077784538, -0.002942098304629326, -0.006555233150720596, -0.00718297716230154, -0.01070772297680378, 0.008312194608151913, 0.010916970670223236, 0.007864836603403091, 0.031459346413612366, 0.02054959163069725, 0.04805487394332886, 0.004982265643775463, 0.008499795570969582, -0.006897966843098402, 0.007320070639252663, -0.00440503004938364, 0.0329890213906765, -0.01635020226240158, 0.04173414409160614, -0.02619207091629505, 0.03448983281850815, -0.01889003813266754, 0.01603272184729576, 0.03480731323361397, -0.012287905439734459, 0.005797611083835363, -0.029063818976283073, 0.0009095972054637969, 0.030824387446045876, 0.0010002412600442767, -0.0298142246901989, 0.012403352186083794, 0.007475202437490225, 0.014185567386448383, -0.008802845142781734, -0.0057831802405416965, 0.0027364580892026424, -0.006129521876573563, 0.05131625384092331, 0.020434144884347916, -0.03402804583311081, -0.026293087750673294, 0.008478149771690369, 0.006306300405412912, -0.0283134113997221, 0.0025903452187776566, -0.006356808356940746, -0.041532110422849655, -0.027101216837763786, -0.013507315889000893, -0.004744156263768673, 0.004488007631152868, 0.031141867861151695, 0.0045385160483419895, -0.006382062565535307, 0.03108414262533188, 0.004278759937733412, -0.010462397709488869, 0.006912397686392069, -0.019698169082403183, -0.006273830775171518, 0.0052997455932199955, -0.005534247495234013, 0.02386869676411152, 0.0012058814754709601, 0.03215203061699867, -0.022728655487298965, -0.018659144639968872, -0.03307560831308365, -0.006602133624255657, -0.019452843815088272, 0.0037520320620387793, 0.03070894069969654, 0.014438108541071415, 0.028284549713134766, -0.017259348183870316, -0.02744755893945694, -0.014264937490224838, -0.016465649008750916, 0.029612192884087563, 0.005314176436513662, 0.027231095358729362, -0.02222357504069805, -0.02141544595360756, -0.014084551483392715, -0.01198485679924488, -0.005804826505482197, -0.010830385610461235, 0.04309064522385597, -0.020419713109731674]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
"_heads // n_kv_heads, 1, head_size)
# K, V -- (batch_size, n_kv_heads, 1, seq_len, head_size)
# 1. Approximate attention scores using r largest components of Q
i1 = topk(abs(Q).sum(dim=2, keepdim= True), r, -1).indices
Q_hat, K_hat = gather(Q, -1, i1), gather(K, -1, i1)
scale = sqrt(
Q.shape[-1]
*abs(Q_hat).sum(dim=-1, keepdim= True)
/ abs(Q).sum(dim=-1, keepdim= True)
)
s_hat = softmax(Q_hat @ K_hat.transpose(-1, -2) / scale + M, dim=-1)
# 2. Gather top k positions based on approximate attention scores & run attention
i2 = topk(s_hat.sum(dim=2, keepdim= True), k, -1).indices
iKV = i2[..., 0, :, None]
K, V, M = gather(K, -2, iKV), gather(V, -2, iKV), gather(M, -1, i2)
y_ = attn(Q, K, V, M)
# 3. Estimate the total score of the top k, and interpolate with V_mean
alpha = gather(s_hat, -1, i2).sum(-1, keepdim= True)
y = alpha *y_ + (1 - alpha) *V_mean
returny
13
SparQ Attention: Bandwidth-Efficient LLM Inference
1 4 16 64 256 1024
B110100Arithmetic intensity
1/641/161/4141664
ρ
(a)
1 4 16 64 256 1024
B110100Arithmetic intensity
1/641/161/4141664
ρ (b)
Figure C1: Relationship between ρ=S/(gdm),Band arithmetic intensity. (a) Multi-head attention, g= 1. (b) Grouped-
query attention, g= 8. This highlights the importance of ρ, even with large batch size and GQA.
C. Arithmetic intensity
Following the framework of Section 2, we provide concrete examples of arithmetic intensity for various models and the
implications for execution modern machine learning hardware. We observe from Equation (2) that the arithmetic intensity
as batch size increases approaches g+ 6/ρ. For example:
Model g d m S ρ =S/(gdm)MaxA/M
Llama 7B 1 4096 4096 1 7
Llama 70B8 8192 4096 1 /16 104
Llama 70B8 8192 16384 1 /4 32
The general relationship between ρand arithmetic intensity is shown in Figure C1.
Hardware Properties of selected machine learning hardware.3Note that rAis the number of multiply-adds per second
andrMthe number of data elements transferred per second.
Name Memory technology rA/1012rM/1012rA/rM
Bow IPU (FP16) SRAM 175 5 .5 32
A10 GPU (INT8) GDDR 125 0 .6 210
H100 SXM GPU (FP8) HBM 990 3 .35 295
Comparing rA/rMfor this hardware to the arithmetic intensity achievable for standard transformer models, it’s clear that
sequence generation will hit a data transfer bottleneck.
D. Attention Sparsity Analysis
In order to understand how to approximate attention in pretrained transformers, we analysed the queries, values and
intermediate scores vector (softmax output). We took 40examples from our SQuAD 1-shot task, and generated the first
completion token using the dense Llama 2 7B model, capturing the qvector and K,Vmatrices from every layer and
attention head, showing derived statistics in Figures 3, D1 and D2.
3For IPU (Graphcore, 2023), we use the exchange memory bandwidth of 11TB/s. A10 (NVIDIA, 2022). H100 (NVIDIA, 2023).
14
SparQ Attention: Bandwidth-Efficient LLM Inference
0 8 16 24
Layer0102030Kurtosis
(a)
0 8 16 24
Layer0
8
16
24Head (sorted)
0510152025
Kurtosis (b)
0 8 16 24
Layer10−1100101qmass (|z|>3) vs Gaussian
(c)
0 8 16 ","[0.01751004159450531, 0.048017505556344986, 0.027859341353178024, 0.0031007365323603153, 0.013281150721013546, -0.024913979694247246, -0.01679396815598011, 0.017064183950424194, -0.05923150107264519, -0.010302011854946613, 0.011599051766097546, -0.011322079226374626, -0.03901929035782814, 0.01886112615466118, 0.01941506937146187, 0.003338865004479885, 0.027224332094192505, -0.03358793631196022, -0.0008824263932183385, -0.00022377319692168385, -0.0353173203766346, -0.0316423736512661, 0.0003145491355098784, 0.032020676881074905, 0.021644357591867447, 0.002730877371504903, -0.00034072637208737433, -0.00784303992986679, 0.035506471991539, -0.03456071391701698, 0.032344937324523926, -0.025940801948308945, -0.033614955842494965, -0.06209579482674599, -0.01710471697151661, 0.028426796197891235, -0.025170685723423958, 0.04007313400506973, -0.053367797285318375, 0.01679396815598011, -0.005394200794398785, -0.019969014450907707, -0.05126010626554489, 0.018982723355293274, 0.011261280626058578, 0.0019590710289776325, 0.01686152257025242, -0.012207039631903172, 0.006285916082561016, 0.05277331918478012, -0.022752245888113976, 0.054881010204553604, -0.04115400090813637, 0.06582478433847427, 0.025170685723423958, 0.014416060410439968, -0.005208426620811224, 0.030588530004024506, 0.044099364429712296, 0.004759191535413265, 0.011693627573549747, -0.04372106119990349, 0.021225521340966225, -0.026116443797945976, -0.03077768161892891, -0.007606599945574999, -0.03864098712801933, 0.01487542875111103, 0.0199960358440876, 0.009268432855606079, -0.004728792235255241, 0.051935650408267975, 0.043694037944078445, -0.015794165432453156, 0.021482227370142937, 0.013119020499289036, -0.015699589625000954, 0.0338851734995842, -0.0030754038598388433, 1.2607033568201587e-05, 0.023454809561371803, -0.02126605436205864, 0.05809658765792847, -0.011301813647150993, -0.031128963455557823, -0.05331375449895859, 0.004529507365077734, -0.06020427867770195, -0.042099762707948685, -0.008086234331130981, -0.036182016134262085, 0.02006359025835991, -0.020212208852171898, 0.010207436047494411, 0.037776295095682144, 0.03507412597537041, 0.0428563691675663, -0.013929670676589012, -0.01147745456546545, 0.01726684719324112, 0.0449100136756897, 0.03639818727970123, 0.014956493861973286, -0.02918340265750885, 0.030426399782299995, -0.02199563942849636, 0.0020604021847248077, -0.0009938908042386174, -0.023400764912366867, -0.012794760055840015, -0.037695229053497314, 0.005742104724049568, -0.028507860377430916, 0.03353389352560043, 0.006583154201507568, -0.02349534071981907, -0.04909837245941162, -0.020833706483244896, -0.032669197767972946, 0.015564481727778912, -0.011808469891548157, 0.020252741873264313, 0.03188557177782059, -0.005715082865208387, 0.007978147827088833, -0.022725224494934082, 0.02469780668616295, -0.0540703609585762, 0.010052060708403587, -0.0011948643950745463, 0.04120804741978645, 0.002452216576784849, 0.038262683898210526, -0.02525174990296364, 0.014389039017260075, -0.033155590295791626, -0.009862909093499184, 0.054881010204553604, -0.03447965160012245, 0.01330817211419344, -0.009761578403413296, 0.0069715906865894794, -1.194732521980768e-05, 0.01991496980190277, -0.006711507216095924, 0.05555655062198639, -0.03739799186587334, 0.018928678706288338, -0.012369168922305107, 0.015132134780287743, 0.005762371234595776, 0.011403144337236881, -0.08311865478754044, -0.028102535754442215, -0.013389237225055695, -0.026562301442027092, -0.01031552255153656, 0.036749470978975296, 0.015132134780287743, -0.052719276398420334, 0.03366899862885475, -0.0010876222513616085, 0.038424812257289886, -0.028805099427700043, -0.013281150721013546, 0.02263064868748188, -0.06641926616430283, -0.004742302931845188, -0.06566265970468521, -0.0734448954463005, -0.011727404780685902, -0.014253930188715458, -0.008660444989800453, -0.0718235969543457, 0.009092791937291622, 0.01314604189246893, -0.021441694349050522, -0.02277926728129387, -0.016969608142971992, -0.043775103986263275, -0.018266648054122925, 0.002185377525165677, -0.022900864481925964, 0.020333806052803993, -0.017469508573412895, 0.010058816522359848, -0.01982039399445057, 0.009957484900951385, 0.0023694627452641726, 0.00615756306797266, -0.011220748536288738, 0.04139719903469086, 0.04518023133277893, 0.016348110511898994, 0.007775485515594482, -0.06587883085012436, 0.03293941542506218, 0.017807280644774437, -0.0021245786920189857, -0.0052320705726742744, 0.017131738364696503, 0.049449656158685684, 0.04088378697633743, -0.06701374053955078, 0.015159156173467636, -0.014591701328754425, 0.005529309157282114, -0.029858944937586784, -0.060798756778240204, -0.012342147529125214, 0.03620903566479683, -0.013125776313245296, 0.04974689334630966, 0.007930859923362732, -0.03366899862885475, 0.03158833086490631, -0.05174649879336357, 0.06355496495962143, 0.008532091975212097, 0.06506817787885666, 0.004708525724709034, 0.03942461684346199, 0.009741311892867088, 0.03269622102379799, -0.07868710160255432, 0.061285145580768585, 0.04199167340993881, -0.025224728509783745, 0.009133324027061462, -0.027629656717181206, 0.0086739556863904, 0.03347984701395035, -0.006150807719677687, -0.012416456826031208, -0.0051814052276313305, -0.050260305404663086, 0.04039739444851875, -0.02183350920677185, -0.01282853726297617, -0.05733998119831085, 0.0030433156061917543, 0.002030002884566784, 0.02142818458378315, 0.027008159086108208, 0.021698400378227234, 0.025765161961317062, -0.018199093639850616, -0.01829366944730282, 0.05098988860845566, 0.023225124925374985, -0.014713299460709095, -0.03158833086490631, -0.08744212239980698, -0.00366819160990417, -0.052178844809532166, -0.006660841405391693, -0.035209234803915024, 0.04485597088932991, -0.010896488092839718, 0.0016761879669502378, -0.041126981377601624, -0.003566860454156995, -0.013247373513877392, -0.007545801345258951, 0.009910196997225285, -0.00013679719995707273, 0.007741708308458328, 0.006353470031172037, -0.042802322655916214, -0.03137215971946716, -0.009140079841017723, -0.003948541358113289, 0.01115319412201643, 0.0040701390244066715, -0.046882595866918564, -0.026346128433942795, 0.0018948945216834545, -0.006100141908973455, -0.030669594183564186, 0.015956295654177666, -0.00787681620568037, -0.00399582926183939, 0.05398929491639137, 0.04155932739377022, -0.0009001593571156263, -0.012686673551797867, 0.0051172287203371525, 0.0018577397568151355, -0.021968618035316467, -0.03710075095295906, 0.04388318955898285, -0.024211416020989418, 0.0516384094953537, -0.022171279415488243, -0.005870457738637924, -0.012585342861711979, -0.016820989549160004, -0.026521768420934677, -0.008180810138583183, -0.004887544550001621, 0.030912790447473526, 0.007113454397767782, 0.039451636373996735, -0.0030264270026236773, -0.012781249359250069, 0.031777482479810715, -0.004651105031371117, 0.023090016096830368, -0.013497323729097843, 0.005384067539125681, -0.004401154350489378, 0.005319891031831503, -0.02783231995999813, 0.0385599210858345, -0.07171551138162613, -0.01226783823221922, 0.016037361696362495, -0.013031200505793095, 0.010207436047494411, -0.01624002307653427, 0.00011368100967956707, -0.07782240957021713, -0.008572624996304512, 0.004195114132016897, 0.03566860407590866, -0.010045305825769901, -0.04699068143963814, 0.007890327833592892, -0.012659652158617973, -0.017874835059046745, 0.035452429205179214, -0.0038978757802397013, 0.0017184092430397868, -0.0037121018394827843, -0.03982993960380554, -0.00955891516059637, -0.020428381860256195, 0.032588131725788116, -0.024765359237790108, 0.02983192354440689, -0.04828772321343422, -0.029372554272413254, -0.024765359237790108, -0.0066338200122118, -0.03472284600138664, 0.026967626065015793, 0.02654878981411457, -0.00967375747859478, 0.05474590137600899, -0.00903874821960926, -0.004384265746921301, -0.003124380484223366, 0.04307254031300545, -0.02526526153087616, 0.012497521936893463, -0.004546395968645811, 0.01467276643961668, -0.03223685175180435, -0.022644158452749252, 0.01630757749080658, -0.017861323431134224, 0.001913471962325275, 0.05923150107264519, -0.040181223303079605, 0.03853290155529976, 0.020658066496253014, -0.011430165730416775, 0.04642322659492493, 0.00020382361253723502, -0.013335193507373333, 0.0016153891338035464, 0.04823368042707443, -0.003141269087791443, -0.07360702753067017, -0.030561508610844612, -0.05031434819102287, 0.0025890136603266, 0.03823566064238548, -0.0019692040514200926, 0.008687466382980347, 0.006012321449816227, 0.0369386225938797, -0.002030002884566784, -0.027886362746357918, 0.036668404936790466, -0.002893007593229413, -0.0016272111097350717, 0.015186178497970104, -0.07295850664377213, 0.012821782380342484, -0.016753435134887695, 0.0053604235872626305, -0.037938423454761505, 0.0029909610748291016, 0.01282853726297617, 0.00751877948641777, 0.041532304137945175, 0.03461476042866707, 0.02381960116326809, 0.0649060532450676, -0.009227899834513664, 0.00047541249659843743, -0.04396425560116768, -0.024927489459514618, 0.021941594779491425, -0.015415862202644348, 0.017550574615597725, 0.03691159933805466, 0.012490767054259777, -0.01815856248140335, 0.07355298101902008, -0.03958674520254135, 0.026751453056931496, -0.009187367744743824, 0.0024066173937171698, -0.028399774804711342, -0.022563094273209572, 0.01736142300069332, -0.0243870560079813, 0.06139323487877846, -0.06841886788606644, -0.029318511486053467, -0.04682855308055878, 0.025684095919132233, -0.07025633752346039, -0.01155851874500513, 0.014280952513217926, -0.06479796022176743, 0.02869701385498047, -0.02167137898504734, -0.032101742923259735, 0.012781249359250069, 0.011430165730416775, 0.0026329238899052143, -0.008579379878938198, -0.028994251042604446, 0.00787681620568037, 0.04636918380856514, -0.002487682504579425, -0.02431950345635414, 0.02958872728049755, -0.03680351376533508, -0.012929868884384632, -0.00019316271936986595, -0.0471528135240078, 0.0040059625171124935, 0.01483489666134119, -0.023725025355815887, 0.008079479448497295, -0.044423624873161316, -0.010403342545032501, 0.0042457799427211285, 0.0265352800488472, 0.00551917590200901, -0.009092791937291622, -0.04485597088932991, 0.09744013845920563, -0.0019641376566141844, 0.0005015897331759334, -0.041289109736680984, 0.038343749940395355, -0.021049881353974342, -0.03347984701395035, 0.010187169536948204, -0.0326421782374382, -0.007559312041848898, 0.0064885783940553665, -0.01503755897283554, 0.038019489496946335, 0.01736142300069332, -0.01855037547647953, -0.03931652754545212, 0.010079083032906055, -0.03272324055433273, -0.0056205070577561855, -0.013713497668504715, 0.03629010170698166, -0.003560104873031378, 0.018658462911844254, -0.020036567002534866, 0.03310154378414154, -0.038343749940395355, -0.002605902263894677, 0.02286033146083355, 0.02032029628753662, 0.06377114355564117, 0.0730665922164917, -0.010882977396249771, 0.037857357412576675, -0.013929670676589012, -0.06263622641563416, -0.027170289307832718, 0.04893624410033226, -0.01546990592032671, 0.04645024985074997, 0.021212009713053703, -0.0006071431562304497, -0.02918340265750885, -0.004637593869119883, -0.043369781225919724, 0.03253408893942833, -0.013652698136866093, 0.057285938411951065, -0.01952315680682659, -0.0016440997133031487, 0.0030500709544867277, 0.03356091305613518, 0.021130945533514023, -0.018131541088223457, 0.04391021281480789, 0.02311703749001026, 0.01871250569820404, -0.008491559885442257, 0.05253012478351593, -0.0034689067397266626, 0.026048889383673668, 0.02430599182844162, 0.023062994703650475, -0.006725017912685871, 0.023616939783096313, -0.010329033248126507, -0.02342778816819191, -0.026981137692928314, -0.007113454397767782, -0.007701175753027201, -0.019874438643455505, -0.02615697681903839, -0.09852100908756256, -0.02552196756005287, -0.07274233549833298, 0.009248166345059872, -0.026927093043923378, -0.024414079263806343, 0.01903676614165306, -0.03256111219525337, 0.014686277136206627, 0.01903676614165306, -0.056799549609422684, -0.044261492788791656, 0.039775896817445755, 0.008234853856265545, 0.006897280924022198, 0.008390228264033794, 0.008329429663717747, 0.015186178497970104, -0.019563687965273857, 0.018590908497571945, -0.02007710002362728, -0.012078686617314816, 0.02094179391860962, 0.015226710587739944, -0.018036965280771255, 0.015253731980919838, 0.01078840158879757, -0.042099762707948685, 0.013064976781606674, -0.019374536350369453, 0.03383113071322441, -0.0162265133112669, -0.004320089239627123, 0.054556749761104584, -0.006785816978663206, -0.015091602690517902, -0.021495738998055458, -0.03591179847717285, 0.027724232524633408, 0.01814505085349083, -0.03910035640001297, 0.027399972081184387, 0.0032138898968696594, -0.010545206256210804, -0.005600241012871265, 0.026211019605398178, -0.04174847900867462, 0.012551565654575825, -0.008086234331130981, 0.0063095600344240665, 0.03215578570961952, -0.01702365092933178, 0.01055871695280075, -0.05517824739217758, -0.008322673849761486, -0.024603230878710747, -0.016888543963432312, -0.037776295095682144, 0.019536666572093964, 0.0015216578030958772, 0.02222532406449318, -0.016969608142971992, 0.021549781784415245, 0.04980093613266945, -0.021847018972039223, 0.0077146864496171474, -0.0012387746246531606, -0.023562895134091377, -0.026967626065015793, -0.028210623189806938, -0.0465313158929348, -0.04836878925561905, 0.009579181671142578, 0.024414079263806343, 0.012497521936893463, -0.008802308700978756, -0.0003455818223301321, -0.024886958301067352, 0.0210228580981493, -0.027332419529557228, 0.01262587495148182, 0.01736142300069332, 0.012484011240303516, -0.022725224494934082, -0.011180215515196323, -0.0449100136756897, -0.01514564547687769, -0.03669542819261551, -0.004624083172529936, -0.043288715183734894, -0.014740320853888988, 0.032263875007629395, -0.0008815819746814668, 0.0003569815889932215, -0.02669741027057171, 0.014051267877221107, 0.04455873370170593, 0.004418042954057455, 0.03720884025096893, 0.016848010942339897, -0.03685755655169487, -0.019928481429815292, -0.002185377525165677, -0.07285042107105255, 0.0018881391733884811, 0.01514564547687769, 0.03447965160012245, -0.020522957667708397, 0.03053448721766472, 0.0026802117936313152, -0.019887948408722878, 0.03347984701395035, -0.011930067092180252, 0.023090016096830368, 0.023968221619725227, -0.0019692040514200926, -0.039532702416181564, 0.02269820310175419, -0.007410692982375622, -0.02487344667315483, -0.005867079831659794, -0.04623407498002052, -0.01773972623050213, -0.023643961176276207, -0.0420457161962986, 0.02791338413953781, 0.0136256767436862, 0.015605013817548752, -0.03588477522134781, -0.038992270827293396, -0.05007115378975868, -0.000746051431633532, 0.0030585152562707663, -0.042802322655916214, -0.009376519359648228, -0.02950766310095787, -0.029318511486053467, 0.016415664926171303, 0.023387255147099495, 0.031696416437625885, 0.006431157235056162, -0.014078290201723576, -0.013645943254232407, 0.013740519061684608, 0.024508655071258545, 0.008011925034224987, 0.004259290639311075, 0.008282141759991646, -0.025130152702331543, -0.014726810157299042, -0.013206840492784977, -0.011781447567045689, 0.02966979332268238, -0.005829925183206797, 0.004607194568961859, -0.05109797790646553, -0.005259092431515455, 0.0052455817349255085, 0.005715082865208387, 0.030885769054293633, 0.00040870276279747486, 0.01614544726908207, -0.004965231753885746, -0.009234655648469925, 0.01147069875150919, 0.033047500997781754, -0.029318511486053467, -0.011288302019238472, -0.006762172561138868, -0.013064976781606674, 0.05858298018574715, -0.01130856852978468, -0.04028930887579918, -0.02350885234773159, 0.029291490092873573, -0.007485002279281616, 0.00046443493920378387, -0.009504872374236584, -0.030642572790384293, -0.0028828743379563093, 0.008667200803756714, 0.049773916602134705, -0.023238636553287506, -0.02023923024535179, 0.010045305825769901, -0.02453567646443844, 0.0021144456695765257, 0.0009896686533465981, 0.015024048276245594, 0.008660444989800453, 0.010106104426085949, -0.01952315680682659, 0.005819791927933693, -0.02687305025756359, 0.016334598883986473, -0.030642572790384293, -0.03472284600138664, 0.0031142474617809057, -0.023076506331562996, -0.008072723634541035, 0.005978544242680073, 0.020374339073896408, 0.0013882382772862911, 0.034425605088472366, 0.042018696665763855, 0.007086433004587889, -0.037073731422424316, -0.0277512539178133, 0.008782042190432549, -0.031237049028277397, 0.011531497351825237, -0.03334474191069603, -0.01886112615466118, 0.008822575211524963, -0.02263064868748188, -0.00022377319692168385, 0.025535477325320244, -0.004786213394254446, 0.01957719959318638, 0.003321976400911808, -0.004363999702036381, -0.004255912732332945, -0.025886759161949158, -0.02215776965022087, 0.012294859625399113, 0.035533495247364044, 0.007707931101322174, 0.013335193507373333, -0.0232656579464674, 0.011761181987822056, -0.029561705887317657, 0.014389039017260075, -0.001086777774617076, 0.015726611018180847, -0.021333608776330948, -0.020185187458992004, 0.02581920474767685, 0.0061812070198357105, -0.020806685090065002, 0.016294065862894058, -0.004725414328277111, 0.026724431663751602, 0.018036965280771255, -0.005059807561337948, 0.0026177242398262024, 0.016834499314427376, 0.028048492968082428, 0.038424812257289886, -0.029561705887317657, 0.012335391715168953, -0.03772225230932236, -0.011693627573549747, 0.03356091305613518, -0.0051780273206532, -0.01910432055592537, -0.005026030354201794, -0.000940691854339093, -0.023846622556447983, -0.007755219005048275, -0.03453369438648224, 0.0008798931376077235, -0.013781051151454449, -0.015105113387107849, -0.023171082139015198, -0.007120209746062756, -0.010214190930128098, -0.053205668926239014, 0.007701175753027201, 0.008363206870853901, -0.010700580663979053, -0.1224622055888176, -0.03828970715403557, 0.040100157260894775, -0.0207121092826128, 0.02022572048008442, 0.005981922149658203, 0.003110869787633419, 0.005944767501205206, 0.03537136688828468, -0.008944172412157059, -0.005394200794398785, -0.00931572075933218, -0.010180413722991943, 0.02440056763589382, 0.03556051850318909, -0.0722559466958046, 0.003391219535842538, 0.020441893488168716, 0.019239429384469986, -0.030426399782299995, -0.0002949161862488836, -0.0006206539692357183, 0.02599484659731388, 0.03331771865487099, -0.0046815043315291405, -0.02352236397564411, -0.005981922149658203, -0.01894219033420086, 0.039127375930547714, 0.009234655648469925, 0.015942785888910294, -0.006066364701837301, 0.02845381759107113, 0.05134117230772972, -0.033074524253606796, 6.502088945126161e-05, -0.028480838984251022, 0.028805099427700043, 0.02375204674899578, -0.0007122743409126997, -0.002860919339582324, -0.06458178907632828, 0.026602834463119507, -0.014942983165383339, 0.016591304913163185, -0.0037999222986400127, 0.027535080909729004, -0.0012489077635109425, 0.02567058615386486, -0.0004965231637470424, -0.0170371625572443, -0.00820107664912939, 0.0017834302270784974, 0.023049484938383102, -0.006353470031172037, 0.00025712806382216513, -0.017158759757876396, -0.018334202468395233, 0.009802110493183136, -0.008079479448497295, -0.017307380214333534, 0.01599682867527008, 0.042261891067028046, -0.024751849472522736, -0.025603031739592552, -0.03142620250582695, 0.013119020499289036, 0.002734255278483033, 0.017334401607513428, -0.01678045652806759, -0.008937417529523373, 0.004357244353741407, -0.00868071150034666, -0.006079875864088535, -0.013362215831875801, 0.0116801168769598, 0.008741510100662708, 0.017942387610673904, -0.015861719846725464, 0.012281348928809166, 0.022333409637212753, -0.03688457980751991, 0.00763362180441618, -0.0026802117936313152, 0.011396389454603195, 0.03399325907230377, 0.026481235399842262, -0.02311703749001026, -0.000153474640683271, 0.049125395715236664, 0.02637314982712269, -0.009214389137923717, 0.02926446869969368, -0.004482219461351633, 0.010599249973893166, -0.0006548532983288169, 0.021847018972039223, 0.0023846623953431845, 0.0518275611102581, 0.014970004558563232, 0.04704472795128822, 0.0008672266849316657, 0.011018085293471813, -0.05044945701956749, -0.019496135413646698, 0.0013358837459236383, -0.007444469723850489, -0.02702166885137558, 0.050800736993551254, -0.026981137692928314, -0.003151402110233903, 0.013524345122277737, 0.010720847174525261, 0.02550845593214035, 0.026332616806030273, 0.03269622102379799, 0.016510240733623505, 0.006285916082561016, 0.0383707694709301, -0.0242924802005291, -0.006012321449816227, 0.011301813647150993, -0.01752355322241783, -0.0008216276182793081, -0.005238826386630535, -0.03437156230211258, 0.0038640988059341908, 0.04164039343595505, 0.02950766310095787, 0.006066364701837301, 0.01299066748470068, 0.026562301442027092, 0.003968807868659496, 0.0010335788829252124, -0.010862710885703564, 0.004965231753885746, 0.029615750536322594, -0.0076538878493011, -0.051449257880449295, 0.021955106407403946, -0.01135585643351078, 0.014213398098945618, 0.05131414905190468, 0.0012446856126189232, -0.024657273665070534, -0.0009440695866942406, 0.015226710587739944, -0.015159156173467636, 0.0034283744171261787, 0.020090611651539803, 0.029561705887317657, -0.03134513646364212, 0.0162265133112669, 0.034506671130657196, 0.004502485506236553, 0.017699193209409714, -0.022373942658305168, -0.02807551436126232, 0.012686673551797867, 0.028913186863064766, 0.01130856852978468, 0.007066166494041681, 0.03861396387219429, -0.008322673849761486, 0.0051780273206532, -0.003151402110233903, -0.010207436047494411, -0.007349893916398287, -0.007012123242020607, 0.036182016134262085, 0.010362810455262661, -0.011943577788770199, 0.03318260982632637, 0.05477292463183403, 0.026481235399842262, 0.017239825800061226, 0.003418241161853075, -0.018996233120560646, 0.019874438643455505, 0.025278771296143532, -0.00914683472365141, 0.009545404464006424, -0.00028879407909698784, 0.021401161327958107, 0.03874907270073891, 0.02845381759107113, 0.01403775718063116, 0.01351759023964405, 0.02654878981411457, 0.00787681620568037, 0.0026481235399842262, 0.013058221898972988, -0.028832120820879936, 0.02245500683784485, 0.0013122397940605879, -0.023616939783096313, 0.041126981377601624, 0.0299940537661314, -0.023373743519186974, 0.0024910601787269115, 0.021630845963954926, 0.04334275797009468, 0.007978147827088833, -0.002903140615671873, -0.02783231995999813, 0.02695411443710327, -0.007903838530182838, -0.036830537021160126, -0.004536262713372707, 0.011916556395590305, -0.00281700911000371, -0.001358683337457478, -0.016131937503814697, 0.006394002586603165, -0.018753038719296455, -0.01757759600877762, 7.95608684711624e-06, 0.019090808928012848, -0.010565472766757011, -0.015848208218812943, -0.047368988394737244, -0.03556051850318909, -0.029129359871149063, -0.007025633938610554, 0.006461556535214186, 0.005127361975610256, 0.007957881316542625, -0.013227107003331184, -0.016037361696362495, 0.03204770013689995, 0.01638864167034626, 0.024562697857618332, -0.009538649581372738, 0.0006231872248463333, -0.014159354381263256, -0.01387562695890665, -0.006306182127445936, -0.021293075755238533, 0.003502683946862817, 0.01871250569820404, 0.009275187738239765, 0.0030162937473505735, 0.026994647458195686, -0.0015883675077930093, -0.016820989549160004, -0.02654878981411457, 0.01934751495718956, 0.05190862715244293, 0.00023073972261045128, -0.011882779188454151, -0.008619912900030613, -0.005715082865208387, 0.016577795147895813, 0.0026396792382001877, 0.003056826302781701, -0.0028423417825251818, 0.016199490055441856, 0.03261515498161316, 0.022725224494934082, 0.004803101532161236, -0.008079479448497295, 0.039532702416181564, -0.014064778573811054, -0.032182808965444565, 0.026819007471203804, -0.030885769054293633, 0.001898272312246263, -0.0026329238899052143, -0.0017260091844946146, 0.0169425867497921, -0.038181617856025696, -0.002138089621439576, 0.0030551375821232796, 0.005968411453068256, -0.006505466997623444, -0.0038370771799236536, -0.005573219154030085, -0.010842445306479931, 0.0306155513972044, -0.011463942937552929, -0.025319304317235947, -0.013206840492784977, -0.007640377152711153, -0.03580371290445328, 0.003732368117198348, 0.006025832146406174, -0.03658733889460564, 0.0028693636413663626, 0.05625911429524422, -0.007059411145746708, 0.0070526557974517345, 0.03137215971946716, 0.005303002428263426, -0.033371761441230774, 0.012450234033167362, 0.012004376389086246, -0.02612995356321335, 0.010072327218949795, 0.038668010383844376, -0.04115400090813637, 0.0103087667375803, -0.004610572475939989, 0.03947865962982178, -0.007491758093237877, 0.020847218111157417, 0.03645223379135132, -0.00043445779010653496, -0.043612975627183914, -0.011909800581634045, 0.011977354995906353, -0.015118624083697796, 0.027967428788542747, 0.01430797390639782, 0.02269820310175419, 0.01957719959318638, 0.018536865711212158, 0.02918340265750885, -0.023792579770088196, -0.0015326353022828698, -0.008923905901610851, 0.006353470031172037, 0.03139917925000191, -0.026981137692928314, -0.012619120068848133, -0.00020287363440729678, -0.04107293859124184, -0.027278374880552292, -0.029534684494137764, 0.001363749848678708, 0.028399774804711342, 0.005002386402338743, 0.02487344667315483, -0.010349299758672714, 0.017077695578336716, -0.046261098235845566, 0.006407513283193111, -0.023873645812273026, -0.02022572048008442, -0.0009398474358022213, 0.0016744991298764944, 0.004762569442391396, 0.01068031508475542, -0.01871250569820404, -0.012119218707084656, -0.0033371762838214636, 0.020522957667708397, -0.011943577788770199, -0.016902053728699684, -0.015969807282090187, -0.003445262787863612, 0.06674352288246155, -0.027372950688004494, -0.012923113070428371, -0.00665746396407485, -0.009302210062742233, 0.035236258059740067, -0.003281444078311324, -0.012004376389086246, -0.03620903566479683, -0.01830718107521534, 0.0022833310067653656, 0.016037361696362495, -0.01773972623050213, 0.02246851846575737, 0.016753435134887695, -0.00534015754237771, -0.020198697224259377, 0.032020676881074905, 0.007397181820124388, 0.01718578115105629, 0.02783231995999813, 0.008775287307798862, -0.02471131645143032, 0.005022652912884951, -0.00026113909552805126, 0.003262866521254182, -0.007822773419320583, 0.01702365092933178, 0.003938408102840185, 0.039451636373996735, -0.0008114945376291871, -0.04236997663974762, -0.021495738998055458, 0.008775287307798862, -0.009018482640385628, 0.020050078630447388, -0.026737941429018974, 0.01965826377272606, 0.0017378311604261398, 0.006718262564390898, 0.011207237839698792, 0.006431157235056162, -0.017861323431134224, 0.02638665959239006, -0.037289902567863464, -0.016185980290174484, 0.001908405451104045, 0.02677847445011139, 0.0018205849919468164, -0.006755417212843895, -0.024765359237790108, 0.01679396815598011, 0.01757759600877762, -0.027062201872467995, 0.0266298558562994, -0.034101348370313644, 0.013260884210467339, 0.04301849752664566, 0.012402946129441261, 0.01383509486913681, -0.03691159933805466, -0.02141467295587063, -0.029804902151226997, 0.011869268491864204, -0.033939216285943985, -0.03661436215043068, -0.0033371762838214636, 0.0071810088120400906, -0.007214785553514957, 0.016172468662261963, -0.013443280942738056, 0.001586678670719266, 0.0023424408864229918, 0.008505070582032204, 0.00701887859031558, 0.005367178935557604, 0.014618723653256893, 0.020644554868340492, 0.019239429384469986, 0.03404730185866356, -0.01347030233591795, -0.015875231474637985, -0.0149970268830657, -0.000972780107986182, -0.00863342359662056, 0.005904234945774078, 0.014956493861973286, -0.021144457161426544, -0.03502008318901062, 0.02503557689487934, -0.017374932765960693, 0.002202266128733754, 0.019401559606194496, -0.01111266203224659, -0.010923509486019611, -0.02029327303171158, -0.024414079263806343, -0.015523948706686497, 0.028480838984251022, -0.007491758093237877, -0.03015618398785591, -0.002190444152802229, -0.008863107301294804, -0.030210226774215698, -0.011261280626058578, 0.01111266203224659, -0.03447965160012245, -0.017942387610673904, 0.025805694982409477, -0.0026464348193258047, 0.004012717865407467, 0.002423505997285247, -0.0003578260075300932, 0.000829227501526475, -0.00501927500590682, 0.0046848817728459835, -0.003982318565249443, 0.03412836790084839, -0.009363008663058281, -0.029399575665593147, 0.048422832041978836, 0.008741510100662708, 0.031074920669198036, -0.004978742450475693, -0.011423410847783089, -0.006171073764562607, -0.008687466382980347, -0.006529110949486494, -0.02032029628753662, -0.023765558376908302, 0.01687503233551979, 0.015726611018180847, 0.03423645347356796, -0.008457782678306103, 0.032507069408893585, 0.03988398239016533, -0.003921519964933395, -0.011801714077591896, -0.002605902263894677, -0.01514564547687769, -0.0009854465024545789, 0.02423843741416931, -0.0051206061616539955, 0.01019392441958189, 0.01718578115105629, -0.00417822552844882, 0.013598655350506306, -0.0036546809133142233, -0.00903874821960926, -0.0036918355617672205, 0.011619318276643753, -0.025967825204133987, -0.002762965625151992, 0.01183549128472805, -0.009667002595961094, -0.005661039613187313, 0.010707336477935314, 0.005579974967986345, -0.0036175260320305824, -0.0048740338534116745, 0.0031868680380284786, 0.006039343308657408, -0.002322174608707428, -0.008694222196936607, 0.05782637372612953, -0.02430599182844162, -0.02583271637558937, -0.0007823617779649794, 0.016929075121879578, 0.009099546819925308, 0.024265458807349205, 0.01973932981491089, -0.04101889580488205, -0.008984705433249474, -0.0340743251144886, -0.002408306347206235, -0.008863107301294804, 0.015388840809464455, -0.04515320807695389, 0.02446812205016613, -0.028832120820879936, -0.0010665114969015121, -0.01686152257025242, -0.00883608590811491, 0.0026464348193258047, 0.016334598883986473, 0.005590107757598162, 0.010572228580713272, 0.0002985050086863339, 0.013889137655496597, 0.008025435730814934, -0.04028930887579918, 0.03188557177782059, -0.008552358485758305, 0.029967032372951508, 0.050179239362478256, 0.006248760968446732, 0.03799246624112129, 0.046963661909103394, 0.013760785572230816, -0.018901657313108444, 0.0007266295724548399, -0.002561992034316063, -0.030831724405288696, 5.467666051117703e-05, 0.015118624083697796, -0.008410494774580002, 0.013362215831875801, 0.014389039017260075, 0.0041816034354269505, 0.019158363342285156, -0.028805099427700043, -0.011686871759593487, 0.008727999404072762, -0.014091800898313522, 0.011328835040330887, 0.006407513283193111, 0.03029129095375538, -0.018374735489487648, -0.013781051151454449, 0.00549890985712409, 0.031696416437625885, 0.022725224494934082, -0.008451026864349842, -0.017550574615597725, 0.006799327675253153, 0.0005319890915416181, 0.012740717269480228, -0.012011132203042507, 0.024197904393076897, -0.01015339232981205, -0.01919889636337757, -0.0005889879539608955, -0.005299624986946583, 0.030426399782299995, 0.00029533839551731944, -0.007309361826628447, -0.028805099427700043, -0.02175244316458702, 0.005715082865208387, 0.013956692069768906, 0.025049088522791862, -0.0018678728956729174, 0.00795112643390894, -0.0007135409396141768, 0.019374536350369453, 0.028399774804711342, -0.004043117165565491, -0.020847218111157417, 0.006201473064720631, -0.011740915477275848, 0.022333409637212753, -0.01114643830806017, -0.04166741296648979, -0.004164714831858873, -0.029453620314598083, -0.005715082865208387, -0.02094179391860962, 0.04326169192790985, 0.011936822906136513, -0.03464177995920181, 0.009207634255290031, 0.02983192354440689, -0.001749653136357665, -0.0196852870285511, 0.024441100656986237, -0.02685953862965107, 0.013983714394271374, 0.0011002885876223445, -0.028588926419615746, -0.0103087667375803, -0.01295013539493084, -0.024346524849534035, -0.014551169238984585, 0.004728792235255241, 0.034587737172842026, 0.005090206861495972, 0.011065373197197914, -0.02549494430422783, -0.0003343931457493454, 0.023373743519186974, 0.0007743397145532072, 0.013159552589058876, -0.02183350920677185, 0.015496927313506603, 0.02453567646443844, -0.012098952196538448, 0.010592494159936905, 0.024603230878710747, -0.0038032999727874994, 0.00784303992986679, 0.009261677041649818, 0.012301615439355373, -0.02222532406449318, -0.025062598288059235, -0.007437714375555515, -0.0076673985458910465, -0.020185187458992004, -0.007917349226772785, 0.005509042646735907, 0.011490965262055397, -0.018536865711212158, -0.028507860377430916, -0.0058603244833648205, 0.014064778573811054, 0.015523948706686497, -0.014942983165383339, 0.04055952653288841, 0.02231989987194538, 0.03334474191069603, 0.004191736690700054, 0.013605410233139992, -0.011504475958645344, 0.0069715906865894794, -0.01303795538842678, -0.00022398430155590177, -0.009059014730155468, 0.009018482640385628, -0.014888939447700977, 0.04296445474028587, -0.004725414328277111, -0.015199689194560051, 0.018982723355293274, -0.016496729105710983, 0.042802322655916214, -0.014551169238984585, 0.017212802544236183, 0.03007511794567108, 0.006650708615779877, -0.03285834938287735, 0.008457782678306103, 0.014064778573811054, 0.035695623606443405, -0.0072282967157661915, -0.018199093639850616, 0.025467922911047935, -0.001576545531861484, 0.04334275797009468, 0.002104312414303422, -0.03715479373931885, -0.036182016134262085, -0.010761380195617676, -0.015767144039273262, -0.032101742923259735, 0.0023627071641385555, 0.005627262871712446, -0.01447010412812233, -0.01103835180401802, -0.015064580366015434, -0.006772305816411972, 0.0310208760201931, 0.03720884025096893, 0.005701572168618441, -0.0004711903748102486, 0.02829168736934662, 0.020036567002534866, -0.006748661864548922, 0.009295454248785973, -0.0199960358440876, -0.012781249359250069, -0.017239825800061226, -0.015199689194560051, 0.025440901517868042, -0.012294859625399113, -0.007505268789827824, -0.016969608142971992, 0.006593287456780672, -0.02240096405148506, -0.0086739556863904, -0.04915241524577141, -0.011801714077591896, 0.04466681927442551, 0.01957719959318638, 0.040748678147792816, -0.04999008774757385, -0.03710075095295906, -0.018847614526748657, -0.025805694982409477, 0.021144457161426544, 0.0014389038551598787, 0.02453567646443844, -0.028832120820879936, -0.018982723355293274, -0.014564679935574532, 0.00795112643390894, -0.009646736085414886, -0.003291577100753784, 0.047125790268182755, -0.0062284949235618114]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
"24
Layer0
8
16
24Head (sorted)
1×2×4×8×16×
qmass (|z|>3) vs Gaussian (d)
Figure D1: Statistics of components of qfor each head, as a function of layer. (Top) Kurtosis (Fisher), indicating that most
heads have heavy-tailed q. (Bottom) z-value mass, normalised by that of a Gaussian ( 0.3%), showing that most heads are
outlier-heavy. All Llama 2 7B, measured over 40SQuAD examples.
In Figures 3c and 3d we show that elements of the query vectors are not normally distributed, but have high sample kurtosis
values. If compared to a normal distribution, the combined mass of the elements with absolute z-score exceeding 3.0is up to
20×higher. This leads us to theorise that query vectors in a pre-trained model inherently encode information sparsely using
the tails. Therefore, the magnitude based sparsity we induce in the first stage of the algorithm does not significantly harm
the approximation of the attention mappings.
We validate this claim by comparing the correspondence between the exact and approximated attention scores. SparQ
Attention uses the approximate attention scores to only choose the tokens that are important for the next generation step. The
actual values of the approximate scores are not relevant, as these scores are not multiplied with value vectors and thus the
property of interest to us is whether the top- kindices in the approximate scores match those of the exact counterpart. This
can be measured on a scale from 0to1, where 1means top- kindices are identical between the approximation and the exact
scores and 0means these sets do not overlap. We call this measure top-kcorrespondence . Figure D2 provides an overview
how the choice of rank and kaffects the top-k correspondence aggregated over all attention heads of the model. We see
that the query vector sparsity of 50% and75% maintain high top-k correspondence to the exact attention scores, which is
consistently maintained over various values of k. Further analysis and a more detailed examination of top-k correspondence
is presented in Appendix D.
It is useful to drop positions in Vgiven attention scores, but this can save at most half of the data transfers, since the whole
ofKis needed to calculate these scores. We propose approximating these scores using a subset of the components of K.
To test such an approximation, we measure the proportion of overlap between the top 32positions in the approximated
15
SparQ Attention: Bandwidth-Efficient LLM Inference
and true scores. If overlap is high, we can use the approximation to avoid transferring the whole Kmatrix, instead only
transferring some components of Kfor all positions, then all components of Kfor some positions.
Our hypothesis is that the rlargest-magnitude components of qare most useful to predicting the score, qK⊤. The coverage
of this technique against an arbitrary-component baseline is shown in Figure D2. These results show that it is possible
to achieve reasonably high overlap even using r=dh/8, but that some later layers are harder to predict. Using the top- r
components outperforms the first rbaseline considerably.
0.0 0.2 0.4 0.6 0.8 1.0
Top-32 agreement012345678DensityTop-r|q|
First-r
Last-r
Random projection
Figure D2: Top- kagreement between approximate and true scores (Llama 2 7B, measured over 40SQuAD examples).
Top-kagreement is the proportion of the top- kpositions that are correctly predicted by an approximated softmax, using a
projection of q, either component-wise or a random low-rank projection.
E. Benchmarking Detail
Benchmarking code is made available from:
https://github.com/graphcore-research/llm-inference-research/tree/2024-01-paper .
IPU measurements We tested custom fully-fused Poplar implementations of both dense attention and SparQ Attention,
compiled using Poplar SDK 3.3.0+1403. On initialisation, we fill large KandVtensors with values ∼N(0,1)in
streaming memory. On each benchmarking (outer) iteration, we first randomise the contents of a qin local memory, then
perform multiple inner repeats of the attention op being profiled. We use 4inner repeats for dense attention, otherwise
1024/batch size, chosen because dense attention is much slower, and we swept a wide range of settings. We ran an outer
loop of 2warm-up iterations followed","[0.020261161029338837, 0.041620563715696335, 0.05429258942604065, -0.021443882957100868, 0.010876821354031563, -0.0180787555873394, -0.01875459775328636, 0.007032974157482386, -0.04074760153889656, 0.006434572860598564, -0.00018513036775402725, -0.014396828599274158, -0.019050277769565582, 0.026878774166107178, 0.01881091669201851, 0.00771585525944829, 0.029596218839287758, -0.04559113085269928, -0.025161009281873703, -0.011425943113863468, -0.03779079392552376, -0.04269064590334892, 0.030215740203857422, 0.01543171051889658, 0.025203250348567963, -0.018472997471690178, 0.020556841045618057, -0.009806739166378975, 0.038185037672519684, -0.032919105142354965, 0.044126808643341064, -0.030976060777902603, -0.045225050300359726, -0.04854793846607208, -0.028540216386318207, 0.04519689083099365, -0.004459849093109369, 0.04469000920653343, -0.05891083553433418, 0.004699209239333868, -0.014685469679534435, -0.03750919550657272, -0.044464729726314545, -0.0033932868391275406, 0.008511376567184925, -0.007969295606017113, 0.016586273908615112, -0.005357450805604458, -0.009370259009301662, 0.05637643113732338, -0.042211923748254776, 0.03666439279913902, -0.04761865362524986, 0.04550664871931076, 0.017642274498939514, 0.0046604895032942295, -0.008863377384841442, 0.04114184156060219, 0.05102602019906044, 0.008166416548192501, 0.01698051393032074, -0.012622744776308537, 0.02300676517188549, -0.014488348737359047, -0.027441974729299545, -0.01824771612882614, -0.060206200927495956, 0.019092518836259842, 0.04657673090696335, 0.0066070533357560635, -0.029737019911408424, 0.060206200927495956, 0.0365799143910408, -0.017797155305743217, 0.02157060243189335, 0.0021542443428188562, 0.00618817238137126, 0.03263750672340393, 0.005712971556931734, -0.010637461207807064, 0.033679425716400146, 0.0020028839353471994, 0.04581641033291817, -0.011095061898231506, -0.027667254209518433, -0.059868279844522476, -0.006635213270783424, -0.028244536370038986, -0.03925511986017227, -0.028469815850257874, -0.03373574838042259, 0.03255302459001541, -0.009884179569780827, -0.006969613954424858, 0.03455238789319992, 0.019303718581795692, 0.052743785083293915, -0.016741152852773666, -0.00800449587404728, 0.03227142244577408, 0.03624199330806732, 0.04649225249886513, 0.001255762530490756, -0.050575461238622665, 0.04542217031121254, 0.008117136545479298, -0.026456372812390327, -0.004301448352634907, 0.012474904768168926, -0.000740521471016109, -0.03263750672340393, 0.011756823398172855, -0.03418630734086037, 0.02288004569709301, 0.012953625991940498, -0.05054730176925659, -0.06223372370004654, -0.01790979504585266, -0.01613571122288704, 0.026414131745696068, -0.013474586419761181, -0.008229776285588741, 0.02159876376390457, 0.02041603997349739, 0.01476994901895523, -0.045225050300359726, 0.025710131973028183, -0.05412362888455391, -0.009440658614039421, -0.006427532993257046, 0.019965479150414467, 0.00719489436596632, 0.05654539167881012, 0.007673615124076605, 0.0005966412136331201, -0.008926738053560257, -0.020176680758595467, 0.040268879383802414, -0.04339464753866196, -0.028286775574088097, -0.01990916021168232, 0.004625289235264063, -0.0036080072168260813, 0.00218592444434762, -0.032412223517894745, 0.04038152098655701, -0.023964207619428635, 0.024457009509205818, -0.02492165006697178, 0.04226824268698692, -0.008145296014845371, -0.02725893445312977, -0.08234000205993652, 0.012580504640936852, -0.047308895736932755, -0.033425986766815186, 0.011475223116576672, 0.002143684308975935, 0.01349570695310831, -0.034411586821079254, 0.031482942402362823, -0.0016526433173567057, 0.04668937250971794, -0.03528454899787903, -0.017839396372437477, 0.012735385447740555, -0.06133260205388069, -0.014671389013528824, -0.08211472630500793, -0.06189580261707306, -0.011855383403599262, -0.018177315592765808, 0.006448653060942888, -0.05753099545836449, 0.014685469679534435, -0.01315778587013483, -0.006688013207167387, -0.012939545325934887, -0.011306262575089931, -0.04240904375910759, -0.021964844316244125, -0.008532497100532055, 0.010876821354031563, 0.04511240869760513, -0.018557477742433548, 0.01859971694648266, -0.021457962691783905, 0.014101147651672363, -0.006314892787486315, 0.01076418161392212, 0.010595221072435379, 0.04147976264357567, 0.042380884289741516, 0.018627876415848732, -0.008983057923614979, -0.06054412201046944, 0.031595584005117416, 0.03027206100523472, -0.021978924050927162, 0.006079052109271288, -0.007448334712535143, 0.02627333253622055, 0.04812553524971008, -0.06347276270389557, 0.002321444684639573, 0.027399733662605286, -0.0006802413263358176, -0.03387654572725296, -0.06454284489154816, -0.03272198513150215, 0.02856837771832943, 0.006849933415651321, 0.05547530949115753, -0.0001849103718996048, -0.022725164890289307, 0.025372210890054703, -0.05539083108305931, 0.04364808648824692, 0.010721941478550434, 0.07422991096973419, 0.02631557174026966, 0.020683560520410538, 0.019176997244358063, 0.04485896974802017, -0.06792205572128296, 0.04485896974802017, 0.060600440949201584, -0.029230138286948204, 0.016234273090958595, -0.029089337214827538, 0.004674569237977266, 0.018458915874361992, 0.003240166464820504, -0.02368260733783245, -0.0005645211203955114, -0.04846345633268356, 0.02071172185242176, -0.022908205166459084, 0.008370576426386833, -0.055250030010938644, 0.0014141628053039312, -0.006913293618708849, 0.02640005201101303, -0.005269450601190329, 0.027371574193239212, 0.019219238311052322, -0.01041922066360712, -0.03703047335147858, 0.041029199957847595, 0.010447381064295769, -0.032327745109796524, -0.015333150513470173, -0.05263114348053932, -0.013291546143591404, -0.05710859224200249, -0.004241608548909426, -0.02338692732155323, 0.04029703885316849, -0.013516826555132866, -0.01778307557106018, -0.034918468445539474, -0.010855701752007008, -0.024597808718681335, 0.0015769631136208773, -0.003085286123678088, -0.0006402012659236789, 0.00150480295997113, 0.008884497918188572, -0.03897351771593094, -0.028469815850257874, -0.023781167343258858, 0.0018233635928481817, -0.0029004858806729317, -0.016529953107237816, -0.03370758891105652, -0.026597172021865845, -0.0006050012307241559, -0.03705863282084465, -0.00855361670255661, -0.016670752316713333, 0.007736975327134132, 0.015009310096502304, 0.04350728541612625, 0.023358765989542007, 0.01041922066360712, -0.01116546243429184, 0.0016253632493317127, -0.00031372063676826656, -0.018698276951909065, -0.001353442668914795, 0.03973383828997612, -0.028540216386318207, 0.06488076597452164, 0.0008716417360119522, 0.014291228726506233, -0.005723531357944012, -0.010123539716005325, -0.04316936433315277, -0.0046604895032942295, 0.004216968547552824, 0.04122632369399071, 0.003593927249312401, 0.03781895712018013, -0.006026252172887325, -0.004544328898191452, 0.022471724078059196, 0.04477448761463165, 0.021289002150297165, -0.04640777409076691, 0.00679009361192584, -0.01292546559125185, 0.0297088585793972, -0.02224644459784031, 0.0365799143910408, -0.050744421780109406, -0.039621200412511826, 0.011102101765573025, 0.002034564036875963, 0.01373506709933281, 0.011580822989344597, -0.01790979504585266, -0.07969295978546143, -0.018627876415848732, 0.01927555911242962, 0.02759685553610325, -0.040437839925289154, -0.06324748694896698, -0.008131216280162334, 0.0026347253005951643, -0.031764544546604156, 0.04024071991443634, 0.00329472660087049, -0.011700503528118134, -0.010630421340465546, -0.05294090509414673, 0.017585955560207367, -0.01381954737007618, 0.0072864145040512085, -0.02104964107275009, 0.04950537905097008, -0.06200844421982765, -0.013784347102046013, -0.0041113682091236115, -0.007265294436365366, -0.013122586533427238, 0.039761997759342194, 0.004762569442391396, -0.004980809986591339, 0.04333832487463951, -0.011848343536257744, -0.011017621494829655, -0.007560974918305874, 0.059023477137088776, -0.042211923748254776, 0.05035018175840378, -0.03688967227935791, 0.024696368724107742, -0.05153290182352066, -0.018529316410422325, 0.018740518018603325, -0.0065964930690824986, 0.005712971556931734, 0.01782531477510929, -0.021443882957100868, 0.026076212525367737, 0.01165122352540493, 0.002539684996008873, 0.011594902724027634, -0.0011642422759905457, -0.027695415541529655, 0.0024094448890537024, 0.018233636394143105, -0.015319070778787136, -0.07017485797405243, -0.021021481603384018, -0.029004856944084167, -0.0034566468093544245, 0.04570377245545387, 0.0031416062265634537, 0.024119088426232338, 0.01035586092621088, 0.009694099426269531, -0.0073568145744502544, -0.013932188041508198, 0.03272198513150215, 0.017008673399686813, 0.02351364679634571, 0.01643139310181141, -0.08188944309949875, 0.00532929040491581, -0.025879090651869774, -0.0039283279329538345, -0.04908297583460808, -0.02342916652560234, 0.028117815032601357, 0.014326428063213825, 0.01317890640348196, 0.03472134843468666, 0.031595584005117416, 0.05727755278348923, -0.011918744072318077, -0.020148519426584244, -0.01476994901895523, -0.016121631488204002, 0.023541806265711784, -0.012566424906253815, 0.017416995018720627, 0.009130897931754589, 0.0058748917654156685, 9.674519242253155e-05, 0.045394010841846466, -0.028005175292491913, 0.019965479150414467, -0.012362265028059483, 0.014319388195872307, -0.02117636241018772, 0.012108824215829372, 0.007814415730535984, 0.0021841642446815968, 0.062290042638778687, -0.022598445415496826, -0.03857927769422531, -0.019205158576369286, 0.0073990547098219395, -0.028892217203974724, -0.014615069143474102, 0.02725893445312977, -0.07265294343233109, 0.024949809536337852, -0.038945358246564865, -0.050068579614162445, 0.016839712858200073, 0.023612206801772118, -0.019641639664769173, -0.04519689083099365, -0.037847116589546204, -0.0019747240003198385, 0.04815369471907616, -0.009525138884782791, -0.02173956297338009, 0.009595539420843124, -0.03812871500849724, -0.01672707311809063, 0.011031702160835266, -0.03883271664381027, 0.007497614715248346, 0.003314086701720953, -0.026709813624620438, 0.034270789474248886, -0.021105961874127388, -0.03612935170531273, -0.01464322954416275, 0.05336330458521843, 0.002752645406872034, -0.004579529166221619, -0.07130125910043716, 0.07299086451530457, -0.01526274997740984, 0.0004571609024424106, -0.05285642668604851, 0.026878774166107178, -0.00906049832701683, -0.05353226512670517, 0.028920376673340797, -0.019458599388599396, -7.810015813447535e-05, 0.011960984207689762, -0.004625289235264063, 0.048745058476924896, 0.028751417994499207, -0.013481627218425274, -0.05310986563563347, 0.0034601669758558273, -0.05237770453095436, -0.0271744541823864, 0.013087386265397072, 0.010144660249352455, -0.007300494704395533, 0.022359084337949753, -0.0409165620803833, 0.013108505867421627, -0.05167370289564133, 0.0006186412065289915, 0.03570695221424103, 0.042042963206768036, 0.06150156259536743, 0.05102602019906044, 0.01820547692477703, 0.025780530646443367, 0.013678747229278088, -0.051082342863082886, -0.029173817485570908, 0.059023477137088776, -0.016741152852773666, 0.026217011734843254, 0.011207702569663525, 0.01689603365957737, 0.009687059558928013, -0.0008377616759389639, -0.03137030079960823, 0.050744421780109406, 0.001802243641577661, 0.03204614296555519, 0.0034566468093544245, 0.0025995252653956413, 0.049730658531188965, 0.023316526785492897, 0.024259887635707855, -0.010046100243926048, 0.04080392047762871, 0.020444201305508614, 0.03035654127597809, 0.007990416139364243, 0.031989824026823044, -0.007349774707108736, 0.026076212525367737, 0.016206111758947372, 0.010179860517382622, -0.026202932000160217, 0.022359084337949753, -0.020049959421157837, -0.01600899174809456, -0.05164554342627525, -4.805634489457589e-06, -0.02165508270263672, -0.00756801525130868, -0.05488394945859909, -0.09028113633394241, -0.02313348650932312, -0.06668300926685333, 0.0018867237959057093, -0.04074760153889656, -0.015558430925011635, -0.013601306825876236, -0.03170822188258171, 0.0047203293070197105, 0.01076418161392212, -0.03511558845639229, -0.04071944206953049, 0.01710723340511322, 0.007905935868620872, 0.008778897114098072, 0.01600899174809456, 0.0100179398432374, 0.016248352825641632, -0.015473950654268265, 0.042127445340156555, -0.009328018873929977, -0.0090393777936697, 0.013291546143591404, 0.012242584489285946, -0.020852521061897278, 0.014080028049647808, 0.014699549414217472, -0.02644229307770729, 0.004769609309732914, -0.03365126624703407, 0.029765179380774498, -0.038185037672519684, -0.00825793668627739, 0.046295132488012314, 0.010320660658180714, -0.021063722670078278, -0.006075532175600529, -0.03303174674510956, 0.008708497509360313, 0.02368260733783245, -0.038691915571689606, 0.02050052024424076, 0.03933959826827049, -0.007772175595164299, -0.0073568145744502544, 0.015361310914158821, -0.041113682091236115, 0.03570695221424103, -0.004128968343138695, 0.0035411270800977945, 0.007645455189049244, 0.012594585306942463, 0.010616340674459934, -0.0564609132707119, -0.016966434195637703, -0.008581777103245258, -0.00024596048751845956, -0.03156742453575134, 0.016783393919467926, 0.0034320068079978228, 0.01889539696276188, -0.019458599388599396, 0.03514375165104866, 0.043619927018880844, -0.036945994943380356, 0.028216376900672913, 0.0012751225149258971, -0.022302763536572456, -0.011017621494829655, -0.02433028817176819, -0.03703047335147858, -0.039930958300828934, 0.017642274498939514, 0.026132531464099884, 0.008729617111384869, -0.014417949132621288, -0.005808011628687382, -0.027202613651752472, 0.03596039116382599, -0.0200358796864748, 0.037086792290210724, 0.018909478560090065, -0.0018286436097696424, -0.005061769858002663, -0.014291228726506233, -0.04846345633268356, -0.0038192076608538628, -0.02233092486858368, 0.009236498735845089, -0.03289094567298889, -0.027920695021748543, 0.028582457453012466, -0.006564813200384378, -0.011320342309772968, -0.024386608973145485, -0.013861787505447865, 0.053588587790727615, -0.009905300103127956, 0.017684515565633774, 0.02279556542634964, -0.04342280700802803, -0.025738291442394257, -0.0026224052999168634, -0.058685556054115295, 0.006149452179670334, 0.013235226273536682, 0.02563973143696785, -0.0200358796864748, 0.011756823398172855, 0.007898896001279354, 0.0033404866699129343, 0.046379610896110535, 0.0013525626854971051, 0.050153058022260666, 0.0273293349891901, 0.008166416548192501, -0.03289094567298889, 0.011939863674342632, -0.018867237493395805, -0.023020844906568527, 0.0038508877623826265, -0.02033155970275402, -0.01995139941573143, -0.029511738568544388, -0.032834626734256744, 0.028709176927804947, 0.016149792820215225, 0.02283780463039875, -0.03170822188258171, -0.01965571939945221, -0.023696687072515488, 0.011088022030889988, 0.017163554206490517, -0.0629095658659935, 0.000608521222602576, -0.027625015005469322, -0.0348903089761734, 0.010116499848663807, 0.024203568696975708, 0.011644182726740837, 0.00391424773260951, -0.005287050735205412, -0.005206090398132801, 0.012418584898114204, 0.02165508270263672, 0.02071172185242176, -0.01885315775871277, 0.006378252524882555, -0.027019573375582695, -0.03545350953936577, -0.03077894076704979, -0.01893763802945614, 0.03449606895446777, -0.02075396105647087, 0.013171866536140442, -0.05637643113732338, -0.016360992565751076, -0.009694099426269531, -0.01872643642127514, 0.017346594482660294, -0.007258254569023848, 0.019078437238931656, -0.011503382585942745, -0.005927691701799631, -0.0030307259876281023, 0.033932868391275406, -0.027230774983763695, -0.03590407222509384, 0.018881317228078842, -0.011658263392746449, 0.03764999657869339, -0.020359721034765244, -0.025400370359420776, -0.025076529011130333, 0.02134532295167446, 0.0016561632510274649, -0.012404504232108593, -0.0182899571955204, -0.027399733662605286, 0.016797473654150963, 0.0024552049580961466, 0.053335145115852356, -0.00013508026313502342, 0.006684493273496628, 0.01961347833275795, -0.008842257782816887, -0.020599080249667168, -0.020049959421157837, 0.021190442144870758, -0.005779851693660021, 0.002414724789559841, -0.01843075640499592, 0.009426578879356384, -0.02831493690609932, 0.007342734839767218, -0.04105736315250397, -0.034918468445539474, 0.02962437830865383, -0.01212290395051241, -0.011454102583229542, -0.007772175595164299, 0.014798109419643879, 0.0077088153921067715, 0.021359402686357498, 0.03311622515320778, 0.01672707311809063, -0.02742789499461651, -0.029568059369921684, -0.011003541760146618, -0.026371892541646957, 0.0008668017107993364, -0.040606800466775894, -0.020683560520410538, 0.017557794228196144, -0.04066311940550804, 0.017008673399686813, 0.022936366498470306, 0.0029515258502215147, 0.001034882036037743, 0.02016260102391243, -0.010236180387437344, -0.011827223934233189, -0.007156174164265394, -0.021190442144870758, 0.013594266958534718, 0.028540216386318207, 0.028371255844831467, -0.010306580923497677, -0.02351364679634571, 0.0009724019328132272, -0.03069446049630642, 0.010531861335039139, 0.02441476844251156, 0.008835217915475368, 0.0016060031484812498, -0.0032208063639700413, 0.016290592029690742, -0.001081522204913199, -0.01990916021168232, 0.016952354460954666, -0.014347548596560955, 0.03680519387125969, 0.005779851693660021, 0.01058818120509386, 0.004755529575049877, 0.022021163254976273, 0.028624696657061577, 0.05913611873984337, -0.034411586821079254, 0.009025298058986664, -0.022176044061779976, -0.005927691701799631, 0.05054730176925659, 0.0009680018993094563, -0.03196166455745697, -0.008433937095105648, -0.026540853083133698, -0.020401960238814354, -0.01396738737821579, -0.03260934352874756, -0.0017644035397097468, -0.015361310914158821, -0.001729203388094902, -0.013896987773478031, 0.005114570260047913, -0.03255302459001541, -0.020064039155840874, 0.02690693363547325, 0.021162282675504684, -0.010637461207807064, -0.11050006002187729, -0.03424263000488281, 0.027287093922495842, -0.01859971694648266, 0.035763271152973175, 0.03412998840212822, 0.0215142834931612, 0.0021296043414622545, 0.03674887493252754, 0.011925783939659595, 0.007701775524765253, -0.019458599388599396, 0.012073623947799206, 0.011355542577803135, 0.011475223116576672, -0.07248398661613464, -0.010327700525522232, 0.0315111018717289, 0.01914883777499199, -0.03382022678852081, -0.009011218324303627, -0.0059769717045128345, 0.007040014024823904, 0.006522573065012693, 0.003400326706469059, -0.036945994943380356, -0.009539218619465828, -0.042549844831228256, 0.020824361592531204, 0.015192350372672081, 0.013256346806883812, -0.0058044916950166225, 0.022387243807315826, 0.03995911777019501, -0.02397828735411167, -0.015980832278728485, -0.009898259304463863, 0.00874369777739048, 0.008736656978726387, -0.008243856020271778, -0.005128649994730949, -0.056432753801345825, 0.009574418887495995, -0.014572829008102417, 0.021063722670078278, -0.009743379428982735, 0.035171911120414734, 0.003549927147105336, 0.015797792002558708, -0.002698085270822048, -0.015896352007985115, -0.037086792290210724, 0.019683878868818283, 0.026259252801537514, -0.007015374023467302, 0.015994912013411522, -0.0036115271504968405, -0.01513603050261736, -0.0008549217018298805, 0.016417313367128372, -0.026245173066854477, 0.022978605702519417, 0.03480583056807518, -0.028540216386318207, -0.036354631185531616, -0.026217011734843254, -0.0018286436097696424, 0.005829131696373224, 0.021331243216991425, -0.023865647614002228, -0.024569649249315262, 0.00610017217695713, -0.0015356030780822039, 0.011665303260087967, -0.013798427768051624, -0.0008474416681565344, 0.025118770077824593, 0.026540853083133698, -0.027456054463982582, 0.012024343945086002, 0.0018075235420837998, -0.03981832042336464, 0.02334468625485897, -0.004495048895478249, 0.00763137498870492, 0.023710766807198524, 0.036354631185531616, -0.04125448316335678, -0.016037151217460632, 0.04784393683075905, 0.02945541776716709, -0.020176680758595467, 0.009074578061699867, 0.008448016829788685, -0.003124006325379014, -0.014058907516300678, 0.02054276131093502, 0.00359744718298316, 0.036777034401893616, 0.011960984207689762, 0.03494662791490555, -0.008264976553618908, 0.014586908742785454, -0.04880137741565704, -0.03027206100523472, 0.0007550414884462953, 0.015333150513470173, -0.002865285612642765, 0.03590407222509384, -0.023161645978689194, 0.022260524332523346, 0.010721941478550434, 0.00039028076571412385, 0.02763909474015236, 0.013228186406195164, 0.0234714075922966, 0.0076806554570794106, 0.00019316039106342942, 0.03891719877719879, -0.0018990437965840101, 0.022218285128474236, 0.024175407364964485, -0.0266957338899374, -0.009356178343296051, -0.007469454780220985, -0.03229958564043045, 0.011960984207689762, 0.022471724078059196, 0.00802561640739441, 0.021500201895833015, -0.006367692723870277, 0.052405864000320435, -0.0019201638642698526, 0.008349456824362278, -0.006828813813626766, -0.0012232024455443025, 0.022471724078059196, 0.004530249163508415, -0.020810281857848167, 0.023105325177311897, -0.006642253138124943, 0.02058500051498413, 0.06262796372175217, 0.040775761008262634, -0.001205602427944541, 0.01284098532050848, 0.011440022848546505, -0.015234590508043766, -0.0033968067727983, 0.03018758073449135, 0.014812189154326916, -0.02423172816634178, 0.006839373614639044, 0.022274604067206383, -0.004568968899548054, 0.018529316410422325, -0.005269450601190329, -0.006828813813626766, 0.024640049785375595, 0.046717531979084015, -0.0025484850630164146, -0.0031152062583714724, 0.029230138286948204, -0.017050914466381073, 0.03412998840212822, -0.008166416548192501, -0.006360652856528759, -0.013164825737476349, -0.002096164273098111, 0.03990279883146286, 0.006167052313685417, -0.015023389831185341, 0.042296405881643295, 0.06099468097090721, 0.025062449276447296, 0.03624199330806732, -0.006040331907570362, -0.03646727278828621, 0.027625015005469322, -0.00043516088044270873, -0.002576645230874419, 0.005850251764059067, -0.02589317224919796, 0.0323559045791626, 0.03370758891105652, 0.029765179380774498, 0.021443882957100868, 0.011207702569663525, 0.02823045663535595, 0.003629127284511924, 0.0310323815792799, 0.02126084268093109, -0.0015540830790996552, 0.010989462025463581, 0.005632011219859123, -0.03069446049630642, 0.01613571122288704, 0.02317572571337223, -0.021035561338067055, 0.01769859530031681, -0.010088340379297733, 0.05195530503988266, 0.007603215053677559, 0.017290273681282997, -0.03170822188258171, 0.012904345989227295, -0.015994912013411522, -0.026132531464099884, 0.0007458014879375696, 0.00512513006106019, -0.016614433377981186, 0.020232999697327614, -0.016544032841920853, -0.0033792066387832165, -0.01685379445552826, -0.03449606895446777, -0.004910409916192293, 0.033510465174913406, -0.04559113085269928, -0.014488348737359047, -0.01982467994093895, -0.005389130674302578, -0.007377934642136097, -0.007934095337986946, 0.0049878498539328575, -0.02509061060845852, 0.008898577652871609, -0.03407366946339607, -0.009567379020154476, 0.03897351771593094, -0.0038121675606817007, 0.03311622515320778, -0.008307216688990593, -0.0006758413510397077, -0.043282005935907364, -0.021626923233270645, -0.032074302434921265, -0.031595584005117416, -0.006522573065012693, 0.03128582239151001, 0.017036834731698036, 0.007912975735962391, 0.012876185588538647, 0.029145658016204834, 4.5485088776331395e-05, -0.013460506685078144, 0.005688331089913845, 0.023837488144636154, -0.018641958013176918, -0.019768359139561653, -0.0006388812907971442, -0.0036185672506690025, 0.022781485691666603, 0.005424330942332745, -0.004716809373348951, 0.0003361606795806438, 0.012911385856568813, 0.034411586821079254, 0.03086342103779316, -0.008609937503933907, -0.024865329265594482, 0.010320660658180714, -0.03060998022556305, -0.038522955030202866, 0.023288365453481674, -0.020021799951791763, 0.011841303668916225, 0.0026188851334154606, -0.023569967597723007, 0.015586591325700283, -0.03914247825741768, 0.009137937799096107, 0.013291546143591404, 0.025217330083251, 0.004484489094465971, 0.010686741210520267, 0.0011387222912162542, -0.024119088426232338, 0.023654447868466377, -0.004530249163508415, -0.008680337108671665, 0.012249624356627464, -0.03353862836956978, -0.03286278620362282, -0.003359846770763397, -0.007905935868620872, -0.036917831748723984, 0.004340168554335833, 0.021978924050927162, -0.022485805675387383, 0.018233636394143105, 0.04784393683075905, 0.015276830643415451, -0.010623381473124027, 0.03128582239151001, 0.002977925818413496, -0.02886405773460865, 0.03297542408108711, 0.04542217031121254, -0.04660489410161972, 0.025527091696858406, 0.003671367419883609, 0.04257800430059433, -0.0033563266042619944, 0.028512056916952133, 0.006198732182383537, 0.00497729005292058, -0.03621383383870125, -0.028300857171416283, -0.012833945453166962, -0.002643525367602706, 0.017937956377863884, 0.003893127664923668, 0.008046736009418964, 0.013291546143591404, 0.01812099665403366, 0.006526092998683453, -0.021274922415614128, 0.005751691292971373, -5.192010212340392e-05, -0.014826269820332527, 0.032834626734256744, -0.02713221311569214, -0.01885315775871277, 0.00800449587404728, -0.019289638847112656, -0.016234273090958595, -0.012869145721197128, 0.0007695615058764815, 0.020148519426584244, 0.008567697368562222, 0.02016260102391243, 0.001833923626691103, 0.0180787555873394, -0.04975881800055504, 0.0017723235068842769, 0.00621985225006938, -0.021964844316244125, -0.01551619078963995, -0.009708179160952568, 0.013059225864708424, 0.0132422661408782, 4.8620095185469836e-05, -0.030328379943966866, -0.022640684619545937, 0.02178180404007435, 0.012242584489285946, -0.012411545030772686, -0.015586591325700283, -0.01315778587013483, 0.06876685470342636, 0.00532929040491581, -0.018712356686592102, -0.026554932817816734, -0.0018656037282198668, 0.03866375610232353, -0.004414088558405638, -0.004702729173004627, -0.026005811989307404, 0.004139528144150972, -0.016403231769800186, 0.00047564093256369233, -0.007469454780220985, 0.016023071482777596, 0.009489938616752625, -0.011264022439718246, 0.0023249646183103323, 0.03472134843468666, 0.002391844755038619, 0.015797792002558708, 0.032158784568309784, -0.0006032412056811154, -0.0033510467037558556, 0.01923331804573536, -0.012144024483859539, -0.004076167941093445, -0.025414450094103813, 0.019754279404878616, -0.005248330533504486, 0.03455238789319992, 0.0034953670110553503, -0.041113682091236115, -0.04466184973716736, 0.0008940817788243294, 0.005456010811030865, 0.009482898749411106, -0.009672978892922401, 0.024471089243888855, 0.029905978590250015, -0.009278738871216774, -0.00044286088086664677, 0.004019848071038723, 0.015769630670547485, 0.014312348328530788, -0.035594310611486435, -0.022682925686240196, 0.015488030388951302, 0.032496705651283264, -0.004713289439678192, 0.003864967729896307, -0.02037380076944828, 0.005167370196431875, 0.02920197881758213, -0.008567697368562222, 0.011158422566950321, -0.03511558845639229, 0.01146114245057106, 0.05251850560307503, 0.011369622312486172, -0.007610254921019077, -0.03339782729744911, -0.019289638847112656, -0.04207112267613411, 0.002972645917907357, -0.020768040791153908, -0.03311622515320778, 0.003120486158877611, 0.02041603997349739, 0.009595539420843124, 0.019514918327331543, -0.01647363230586052, 0.011869464069604874, -0.006079052109271288, 0.007546895183622837, 0.013918107375502586, 0.01124994270503521, 0.019388198852539062, 0.0340455062687397, 0.019641639664769173, 0.008215696550905704, 0.001969443866983056, 0.006462732795625925, -0.010982422158122063, 0.005758731625974178, 0.003632647218182683, -0.003217286430299282, 0.01765635423362255, -0.019036198034882545, -0.01415746845304966, 0.041874002665281296, -0.025231409817934036, -0.0036608073860406876, 0.033003587275743484, -0.004695689305663109, -0.016290592029690742, -0.0014828029088675976, -0.01605123281478882, -0.01398850791156292, 0.04381704702973366, -0.016924193128943443, -0.04074760153889656, 0.014812189154326916, -0.013115545734763145, 0.009180177934467793, 0.0020574440713971853, 0.007560974918305874, -0.04052232205867767, -0.02279556542634964, 0.04040968045592308, -0.009398418478667736, -0.008476177230477333, 0.007377934642136097, -0.006659853272140026, 0.0009856019169092178, -0.003449606942012906, 0.019627559930086136, -0.01931779831647873, 0.05271562561392784, -0.023992367088794708, -0.015178270637989044, 0.03812871500849724, 0.03421446681022644, 0.008145296014845371, 0.015797792002558708, 0.003345766570419073, -0.010376980528235435, 0.0015065630432218313, -0.011658263392746449, -0.023330606520175934, -0.006533132866024971, 0.011552662588655949, 0.01740291528403759, 0.0297088585793972, 0.005888971500098705, 0.027047734707593918, 0.02873733639717102, -0.014812189154326916, 0.0007537215133197606, 0.003175046294927597, -0.022978605702519417, 0.00593121163547039, 0.011017621494829655, -0.010736021213233471, 0.01761411502957344, 0.0014326428063213825, 0.0003612407308537513, 0.021584682166576385, -0.004695689305663109, -0.003085286123678088, 0.006835853680968285, 0.0027280054055154324, -0.010961301624774933, 0.01748739555478096, 0.012580504640936852, -0.0009011218207888305, 0.01630467176437378, 0.004949129652231932, 0.006279692519456148, -0.0003762007399927825, 0.012869145721197128, 0.009187218733131886, -0.007870735600590706, -0.004044488072395325, -0.00023232046805787832, 0.047055453062057495, -0.02228868380188942, -0.032919105142354965, -0.017290273681282997, -0.0010093620512634516, 0.0148544292896986, 0.022725164890289307, 0.010222100652754307, -0.023865647614002228, -0.012320024892687798, -0.03401734679937363, 0.005860811565071344, -0.02471044845879078, 0.037114955484867096, -0.031060541048645973, 0.016248352825641632, -0.023696687072515488, 0.007043533958494663, -0.011348502710461617, -0.027089973911643028, 0.026681652292609215, -0.0058326516300439835, 0.003629127284511924, 0.011010581627488136, -0.002984965918585658, 0.017332514747977257, 0.013742106966674328, -0.01931779831647873, 0.05094154179096222, 0.002069764072075486, 0.026540853083133698, 0.03984647989273071, 0.015544351190328598, 0.02987781912088394, 0.02504836954176426, 0.026174772530794144, -0.009271698072552681, -0.029089337214827538, 0.008616977371275425, -0.03077894076704979, 0.006416972726583481, 0.009053458459675312, -0.014981149695813656, -0.0032612865325063467, -0.008018575608730316, 0.014882589690387249, 0.036270152777433395, -0.004072648007422686, -0.013143706135451794, 0.023316526785492897, -0.0016341631999239326, 0.007948176003992558, 0.008652177639305592, 0.03497479110956192, -0.011580822989344597, -0.013861787505447865, 0.019303718581795692, 0.015473950654268265, 0.04224008321762085, -0.0034689668100327253, -0.01025026012212038, -0.009806739166378975, 0.0208806823939085, 0.006434572860598564, -0.016459552571177483, -0.019472679123282433, -0.02793477475643158, 0.0023548847530037165, -0.004621769301593304, 0.002742085373029113, 0.013284506276249886, 0.005825611762702465, 0.010834581218659878, -0.03184902295470238, -0.00613537197932601, 0.012312984094023705, 0.01803651638329029, 0.018824998289346695, 0.012151064351201057, -0.004797769710421562, 0.004966729786247015, 0.03449606895446777, 0.037678156048059464, 0.020007720217108727, -0.020134439691901207, -0.006195212248712778, -0.04733705520629883, 0.009229457937180996, -0.015459870919585228, -0.024597808718681335, -0.0001055452084983699, -0.012298904359340668, -0.003549927147105336, 0.00650497293099761, 0.019669799134135246, -0.006853453814983368, -0.02449924871325493, 0.017374753952026367, 0.013798427768051624, 0.01177794300019741, -0.005910091567784548, 0.013939227908849716, -0.020134439691901207, 0.028089655563235283, -0.018402596935629845, -0.018135076388716698, -0.02979333885014057, -0.012453785166144371, -0.017684515565633774, 0.009081617929041386, -0.004252168349921703, 0.03438342735171318, -0.0021683243103325367, 0.014122268185019493, -0.0187686774879694, 0.012664984911680222, 0.02827269583940506, -0.0090393777936697, 0.029821500182151794, -0.008785937912762165, -0.009264658205211163, 0.02113412134349346, -0.014615069143474102, 0.003264806466177106, 0.006459212861955166, 0.0016896033193916082, 0.010454420931637287, 0.012425624765455723, 0.017248034477233887, -0.019979558885097504, -0.04809737578034401, -0.021669162437319756, -0.006980173755437136, -0.014319388195872307, -0.03339782729744911, 0.006371212657541037, -0.009440658614039421, -0.002682245336472988, -0.03156742453575134, -0.0008184016332961619, 0.019078437238931656, 0.010327700525522232, 0.0039987280033528805, 0.039367757737636566, -0.002652325201779604, 0.031004222109913826, -0.0020257639698684216, -0.022345004603266716, 0.006177612114697695, -5.0847600505221635e-05, 0.016403231769800186, 0.014812189154326916, -0.007230094168335199, 0.0001680803397903219, -0.03238406404852867, 0.029342778027057648, -0.017980195581912994, 0.007870735600590706, 0.01093314215540886, -0.01710723340511322, 0.002131364308297634, -0.016881953924894333, -0.0015144830103963614, 0.013636507093906403, 0.011256982572376728, -0.02903301827609539, 0.004667529370635748, 0.0018216036260128021, 0.02614661119878292, 0.014094107784330845, -0.021472042426466942, 0.022570284083485603, 0.014354588463902473, 0.033510465174913406, 0.00025784052559174597, -0.045957211405038834, -0.021246762946248055, 0.003458406776189804, -0.02441476844251156, -0.018177315592765808, -0.0064697726629674435, 0.007208974566310644, -0.025400370359420776, 0.011193621903657913, 0.0031433661933988333, 0.0014520029071718454, 0.032665666192770004, 0.02330244705080986, 0.004160648211836815, 0.0076384153217077255, 0.028413496911525726, 0.01534723024815321, -0.005234250333160162, 0.005096970126032829, -0.03914247825741768, -0.003516487078741193, -0.021246762946248055, -0.008814097382128239, 0.025696050375699997, 0.00895489752292633, -0.009511059150099754, -0.016375072300434113, -0.022401325404644012, -0.021387562155723572, -0.012700185179710388, -0.05280010402202606, -0.0017820035573095083, 0.0348903089761734, 0.03596039116382599, 0.03683335334062576, -0.030328379943966866, -0.042549844831228256, -0.02211972326040268, -0.03587591275572777, 0.02776581607758999, 0.0020398441702127457, 0.027441974729299545, -0.0067619336768984795, -0.018543396145105362, -0.044380247592926025, -0.010890902020037174, -0.011623063124716282, 0.009982739575207233, 0.037678156048059464, -0.028976697474718094]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
" by 10timed iterations, reporting the mean and standard error. The sweep covered
S∈[1024 ,2048, . . . , 65536] ,batch size∈[1,4,16,64], SparQ Attention r∈[16,32,64]andk∈[64,128,256,512].
GPU measurements All experiments use PyTorch 2.1.2+cu121 on Ubuntu AWS instances. To set up the experi-
ment, we initialise the large KandVtensors with values ∼N(0,1). On each step, we draw q∼N(0,1), run
torch.cuda.synchronize before starting a host-side wall-clock timer, run the op, and synchronize again before
stopping the timer. We run 20warm-up iterations followed by 200timed iterations, reporting mean and standard error.
For dense baseline implementations, we tested a vanilla PyTorch implementation, with/without torch.compile and
torch.nn.functional.scaled dotproduct attention , selecting each backend (math, flash, mem efficient)
manually. For SparQ Attention implementations, we tested vanilla PyTorch (lightly hand-optimised from Appendix B),
with/without torch.compile . We also toggled fused gather-matmul kernels written in Triton, and whether Kwas
stored twice in S-contiguous (for Step 1 ) and dh-contiguous (for Step 2 ) layouts, or only once in dh-contiguous lay-
out. We tested S∈[1024 ,2048,4096,8192,16384] ,batch size∈[1,4,16,64], SparQ Attention r∈[16,32,64]and
k∈[64,128,256,512].
Additional results In addition to the headline results shared in Section 6 and Figure 5, we give an aggregate picture of the
trends in Figure E1. Since the number and dimension of heads is fixed, the x-axis is proportional to the size of the input
16
SparQ Attention: Bandwidth-Efficient LLM Inference
103104105106
Batch size×Sequence length1×10×Speedupr
16
32
64
Device
M2000
A10G
A100-40GB
Figure E1: SparQ speedup over the dense baseline, across a range of batch size ( 1-64), sequence length ( 1024 -65536 ) and k
(64-512), for different devices. We note that for both GPUs, the number of KV elements is a limiting factor for the achieved
speedup, and that this could be improved by writing a fully fused SparQ Attention kernel.
tensors. On IPU (M 2000 ), strong speedups are available across a range of input sizes, principally depending on r, but also
onk(not shown). On GPU, sufficient input size is required to observe a speedup over the dense baseline, with the more
bandwidth-limited A10G reaching speedups sooner. While part of this effect can be linked to the fundamental additional
complexity of SparQ Attention, we anticipate that small input sizes could be accelerated considerably with additional kernel
fusion. With an appropriate limit to sequence length, SparQ Attention could even be fused into a single CUDA kernel.
Storing Ktwice One limitation of a theoretical model of data transfer is that it does not account for the granularity
of memory access. Since the Kmatrix is indexed on different axes in Step 1 andStep 2 of SparQ Attention, a naive
implementation would fetch non-contiguous elements in one of the two steps. To mitigate this, we propose storing Ktwice,
once in S-major format and once in dh-major format. This increases KV cache memory usage by 50%, but uses only a small
amount of extra bandwidth to write ktwice. This extra write is non-contiguous, but small, so should not form a bottleneck.
17
SparQ Attention: Bandwidth-Efficient LLM Inference
F. Methodology
We provide a comprehensive set of hyperparameters for reference in Table F1. Typical compression ratios for settings of
(r, k)are given in Table F2.
We use our own implementation of H 2O (Zhang et al., 2023), which differs from the authors’ implementation in that it
uses a fixed cache size k, rather than a ratio of the current sequence length. To validate that these implementations are
sufficiently similar, we ran their implementation through our harness on a small model and sample size. On SQuAD
1-shot, with Pythia- 1.4B, using k= 256 ,l= 64 , our","[0.024760276079177856, 0.008084846660494804, 0.04943741858005524, -0.023125294595956802, 0.006345946341753006, -0.0009776983642950654, -0.013211484998464584, 0.006501824129372835, -0.03325386717915535, 0.014382298104465008, 0.015116654336452484, -0.01490881759673357, -0.045142125338315964, 0.01953664794564247, 0.014437721110880375, 0.0033149949740618467, 0.027739267796278, -0.04888318479061127, -0.026284411549568176, 0.002906249603256583, -0.033724963665008545, -0.039405833929777145, 0.012054527178406715, 0.017513703554868698, 0.0022740797139704227, -0.011999104171991348, 0.012671109288930893, -0.0021268620621412992, 0.04633372277021408, -0.06539927423000336, 0.04068056493997574, -0.03189600259065628, -0.052485689520835876, -0.05182060971856117, -0.01178433932363987, 0.06268354505300522, -0.0036336779594421387, 0.03039957769215107, -0.06251727044582367, 0.016031134873628616, -0.002894125645980239, -0.07060904800891876, -0.07315851002931595, 0.02143489010632038, 0.01707031950354576, -0.006474112626165152, -0.010197852738201618, -0.02712961472570896, -0.00893697701394558, 0.04577949270606041, -0.03965523838996887, 0.058970194309949875, -0.05450863391160965, 0.001106730313040316, 0.018331194296479225, 0.006785867270082235, 0.004939584992825985, 0.023069871589541435, 0.0384359285235405, 0.004194837063550949, 0.03613587096333504, -0.035221390426158905, 0.01432687509804964, -0.029152557253837585, -0.015199788846075535, -0.008417385630309582, -0.023651814088225365, 0.035997312515974045, 0.02887544222176075, 0.02183670736849308, -0.020021600648760796, 0.06129796430468559, 0.02032642625272274, -0.01975833997130394, 0.011271676048636436, -0.019037839025259018, 0.007101086433976889, 0.05370499566197395, 0.028930865228176117, -0.010225564241409302, 0.03355869650840759, -0.0049499766901135445, 0.03707806393504143, 0.0004102609527762979, -0.018081791698932648, -0.04713735729455948, -0.028404345735907555, -0.015684740617871284, -0.02067282237112522, 0.021739715710282326, -0.03117550164461136, 0.03566477447748184, -0.017749251797795296, 0.006300915032625198, 0.04802412912249565, 0.023637957870960236, 0.0301778856664896, -0.02923569269478321, -0.004011247772723436, 0.05891476944088936, 0.03965523838996887, 0.041290219873189926, 0.013550951145589352, -0.0399046428501606, 0.044366203248500824, -0.012283147312700748, -0.014687125571072102, 0.01100148819386959, -0.006377121899276972, 0.009304155595600605, -0.04544695466756821, -0.0024923081509768963, -0.0319514237344265, 0.037521447986364365, 0.021698148921132088, -0.06528842449188232, -0.040735989809036255, 0.0034241091925650835, -0.019301099702715874, 0.035609349608421326, -0.013606374152004719, 0.03222854062914848, 0.011354810558259487, -0.0038172670174390078, 0.017569126561284065, -0.023236140608787537, 0.04009862244129181, -0.0486614927649498, 0.016820915043354034, -0.0013180308742448688, 0.018331194296479225, -0.005760539788752794, 0.04214927926659584, 0.007828515022993088, 0.02489883452653885, -0.029706789180636406, -0.04677710682153702, 0.028986288234591484, -0.027586854994297028, -0.0006373657961376011, -0.02183670736849308, 0.009650549851357937, 0.00967826135456562, 0.019827619194984436, -0.03283819556236267, 0.030815251171588898, -0.05096155405044556, 0.03297675400972366, -0.029706789180636406, 0.015324491076171398, -0.010031583718955517, -0.002688020933419466, -0.06196304038167, 0.017042607069015503, -0.012338570319116116, -0.011029199697077274, -0.03688408061861992, 0.012788883410394192, 0.010308698751032352, -0.022557206451892853, 0.005944129079580307, -0.0013370825909078121, 0.01693176105618477, -0.008715284988284111, -0.011389450170099735, 0.0036336779594421387, -0.055007439106702805, 0.001634115818887949, -0.08130570501089096, -0.04278664290904999, 0.019023984670639038, -0.02618742175400257, -0.00949813611805439, -0.014700980857014656, 0.021795138716697693, -0.004153269808739424, -0.054619479924440384, -0.0311477892100811, -0.042675796896219254, -0.0626281201839447, -0.02581331506371498, 0.00045291075366549194, -0.005126637872308493, 0.016626933589577675, -0.01044032908976078, -0.016266683116555214, -0.03247794508934021, -0.01111926231533289, 0.019065551459789276, -0.005736292339861393, 0.011292459443211555, 0.024566294625401497, 0.026713941246271133, 0.0006529535748995841, 0.0038484425749629736, -0.03946125879883766, 0.03059355914592743, 0.0072188605554401875, 0.002026407513767481, 0.016044991090893745, 0.007800803054124117, 0.024372315034270287, 0.022487929090857506, -0.05506286397576332, 0.05389897897839546, -0.02981763519346714, -0.019453512504696846, -0.03175744414329529, -0.042814355343580246, -0.015199788846075535, 0.02356867864727974, 0.049077168107032776, 0.04838437959551811, 0.006907105445861816, -0.02618742175400257, 0.010246348567306995, -0.05182060971856117, -0.0002654247509781271, 0.00044230243656784296, 0.04788557067513466, 0.010391834191977978, 0.017541415989398956, -0.0012418241240084171, 0.023887362331151962, -0.06950058788061142, 0.051571208983659744, 0.025494633242487907, -0.03214540705084801, 0.0201185904443264, -0.02603500708937645, -0.010578886605799198, 0.028792306780815125, 0.00881920289248228, -0.01578173227608204, 0.007142653688788414, -0.05797257646918297, 0.026284411549568176, -0.023873506113886833, -0.02524522878229618, -0.0658426582813263, -0.0026533815544098616, 0.008500520139932632, 0.018345050513744354, 0.0064775762148201466, -0.005292907357215881, 0.01150029618293047, -0.005133565980941057, -0.04120708629488945, 0.013634085655212402, 0.018317339941859245, -0.02923569269478321, -0.033918946981430054, -0.059579845517873764, -0.013717221096158028, -0.056309882551431656, -0.0066473097540438175, -0.003290747292339802, 0.028764596208930016, -0.023707237094640732, 0.00941500160843134, -0.05714122951030731, -0.013751859776675701, -0.0263675469905138, -0.003914257511496544, -0.010107790119946003, -0.004496200010180473, -0.002838702639564872, 0.010246348567306995, -0.031230924651026726, -0.01998003199696541, 0.0008768109837546945, -0.0036475337110459805, 0.013419321738183498, -0.004232940264046192, -0.02394278533756733, 0.004721356555819511, 0.024843411520123482, -0.027254316955804825, -0.04198300838470459, 0.005919881165027618, 0.014936529099941254, 0.018178781494498253, 0.06041119247674942, -0.0021268620621412992, -0.0066680931486189365, 0.0006988508393988013, 0.024497015401721, 0.0024767203722149134, 0.006616134196519852, -0.01749984733760357, 0.027462152764201164, -0.02543920837342739, 0.041096240282058716, 0.01178433932363987, -0.00320068490691483, 0.011701204814016819, -0.027628421783447266, -0.010405689477920532, 0.018178781494498253, -0.022737331688404083, 0.024649430066347122, 0.0337526760995388, 0.04497585818171501, -0.019689060747623444, 0.011056911200284958, 0.0231945738196373, -0.007184220943599939, 0.00542107317596674, -0.028542904183268547, 0.030732115730643272, -0.022072255611419678, 0.020257148891687393, -0.013848850503563881, 0.0433131642639637, -0.030510423704981804, -0.03416835144162178, 0.030455000698566437, -0.016474520787596703, 0.023056015372276306, -0.02542535401880741, -0.02356867864727974, -0.10397376120090485, 0.004558551125228405, 0.006349410396069288, 0.05301220715045929, -0.028182653710246086, -0.04126250743865967, 0.018691444769501686, 0.00019214068015571684, -0.014853394590318203, 0.024178333580493927, -0.018497463315725327, 0.0042571877129375935, -0.024441592395305634, -0.055755652487277985, 0.009740612469613552, -0.01616969332098961, -0.010994560085237026, -0.011618070304393768, 0.027850113809108734, -0.06512215733528137, -0.028903154656291008, -0.017222732305526733, 0.02049269713461399, -0.013911201618611813, 0.02561933360993862, 0.028764596208930016, -0.012234652414917946, 0.08706971257925034, -0.003966216463595629, 0.005195917095988989, 0.008292683400213718, 0.025203660130500793, -0.03247794508934021, 0.04577949270606041, -0.02548077702522278, 0.010779795236885548, -0.05617132410407066, -0.012775028124451637, 0.0033461705315858126, -0.008770707994699478, 0.03513825312256813, 0.03095380961894989, -0.02164272591471672, 0.041678182780742645, 0.006661165505647659, -0.04048658534884453, 0.03630213811993599, 0.010211708955466747, -0.008770707994699478, 0.03419606015086174, 0.045280683785676956, -0.00039488967740908265, -0.04181673750281334, -0.04916030168533325, -0.010779795236885548, 0.011230108328163624, 0.05852680653333664, 0.008646005764603615, 0.02584102749824524, 0.0023364305961877108, 0.025522343814373016, -0.010786723345518112, -0.00987916998565197, 0.05179290100932121, -0.0072535001672804356, 0.04580720514059067, 0.04181673750281334, -0.07925505191087723, -0.01708417572081089, -0.019661350175738335, 0.020021600648760796, -0.02884773164987564, 0.0011344418162479997, 0.007509831804782152, 0.034473177045583725, 0.007731524296104908, 0.024067487567663193, 0.04048658534884453, 0.03785398602485657, -0.001452258788049221, -0.00432646693661809, -0.029540520161390305, -0.0007386861834675074, 0.002267151838168502, 0.006737372372299433, 0.017818531021475792, 0.05567251890897751, 0.0298453476279974, 0.007572182919830084, 0.028432058170437813, -0.04242639243602753, 0.030122462660074234, -0.037299755960702896, 0.014770260080695152, -0.03660696744918823, -0.03516596555709839, 0.00931801088154316, -0.011521079577505589, 0.07703813165426254, -0.051765188574790955, -0.03760458156466484, -0.05475803464651108, -0.019495081156492233, -0.04722049459815025, -0.0032716956920921803, 0.0025269475299865007, -0.052319418638944626, 0.0444493368268013, -0.004627829883247614, -0.04314689338207245, 0.02833506651222706, 0.04142877832055092, -0.023319276049733162, -0.03608044609427452, -0.0205204077064991, -0.009283371269702911, 0.04173360392451286, 0.01197832077741623, -0.046250589191913605, -0.004177517257630825, -0.01747213676571846, 0.016668502241373062, 0.013675653375685215, -0.055533960461616516, -0.011160829104483128, -0.003910793457180262, -0.0011716792359948158, 0.0436457023024559, -0.04780243709683418, -0.007156509440392256, -0.01176355592906475, 0.034888848662376404, 0.014396153390407562, 0.010114718228578568, -0.07570797204971313, 0.07803574204444885, -0.02791939303278923, 0.03189600259065628, -0.013135277666151524, 0.05545082688331604, -0.027254316955804825, -0.04140106588602066, 0.0019120974466204643, 0.016086557880043983, 0.014257595874369144, 0.04253723844885826, 0.01937037892639637, 0.0319514237344265, 0.0168763380497694, 0.0069244252517819405, -0.02681093104183674, 0.006491432432085276, -0.034306906163692474, -0.03627442941069603, -0.01366872526705265, 0.012969008646905422, -0.009491208009421825, -0.00041567336302250624, -0.007613750174641609, 0.022252380847930908, -0.04123479500412941, 0.006626525893807411, 0.045474663376808167, 0.016945617273449898, 0.06118711829185486, 0.07620678097009659, -0.014603990130126476, -0.009913809597492218, -0.009027039632201195, -0.04195529595017433, -0.013620230369269848, 0.016751635819673538, -0.0161419827491045, 0.030676692724227905, 0.0154907600954175, -0.010779795236885548, 0.01726429909467697, 0.009990015998482704, -0.02204454317688942, 0.04780243709683418, 0.01575401984155178, 0.04802412912249565, 0.009124030359089375, -0.00580210704356432, 0.016820915043354034, 0.03039957769215107, 0.013072926551103592, -0.0360250249505043, 0.02143489010632038, 0.011472584679722786, 0.0029304970521479845, 0.013294619508087635, 0.035415370017290115, 0.0017709416570141912, 0.044504761695861816, 0.015172077342867851, -0.015435337089002132, -0.009657477959990501, 0.04395052790641785, -0.024455448612570763, -0.024178333580493927, -0.0266030952334404, 0.0036544615868479013, 0.01956435851752758, -0.017153453081846237, -0.04763616621494293, -0.15618233382701874, -0.03281048312783241, -0.07199462503194809, 0.003216272685676813, -0.009186381474137306, -0.021933697164058685, -0.0012011227663606405, -0.0444493368268013, -0.008798419497907162, 0.012137661688029766, -0.01376571599394083, -0.05389897897839546, 0.008015567436814308, 0.0039004015270620584, -0.005008863750845194, -0.00978217925876379, 0.004160197451710701, -0.0020749028772115707, -0.013093710877001286, 0.054425496608018875, -0.001173411263152957, -0.0044650244526565075, 0.004430385306477547, 0.005940665025264025, -0.010447257198393345, -0.00022558939235750586, -0.001272999681532383, -0.017721541225910187, 0.03192371502518654, -0.016779348254203796, 0.027448296546936035, -0.03361411765217781, -0.011424089781939983, 0.03724433109164238, 0.024413881823420525, -0.025134382769465446, -0.029679076746106148, -0.022945169359445572, 0.0262012779712677, 0.01368258148431778, -0.038075678050518036, 0.009061679244041443, 0.021531879901885986, -0.023443976417183876, -0.005382969975471497, 0.016058847308158875, -0.02694948948919773, 0.005798643454909325, -0.025882594287395477, -0.012795811519026756, 0.027877826243638992, -0.028224220499396324, 0.018857713788747787, -0.046666260808706284, -0.022474072873592377, 0.010800579562783241, 0.0011725452495738864, -0.023014448583126068, 0.008445097133517265, 0.014784115366637707, 0.024053631350398064, -0.02354096807539463, 0.031785156577825546, 0.0421769879758358, -0.012532551772892475, 0.03225625306367874, -0.0123662818223238, -0.016474520787596703, -0.03760458156466484, -0.004565478768199682, -0.05376042053103447, -0.023430122062563896, 0.003195488825440407, 0.01729201152920723, 0.01490881759673357, 0.02446930482983589, -0.0161419827491045, -0.049880802631378174, 0.03802025690674782, 0.005895633716136217, 0.013848850503563881, 0.04040345177054405, -0.00308637460693717, 0.0050712148658931255, -0.011361738666892052, -0.03328157961368561, 0.004163661506026983, -0.037687718868255615, -0.002132057910785079, -0.024372315034270287, -0.024025918915867805, 0.052485689520835876, -0.0074474806897342205, 0.0004059310012962669, -0.024621717631816864, -0.005448784679174423, 0.03907329589128494, -0.0025408032815903425, 0.019689060747623444, -0.012885874137282372, -0.045502375811338425, -0.00881920289248228, 0.02067282237112522, -0.04145649075508118, -0.00827882718294859, 0.00978217925876379, 0.01054424699395895, -0.047386761754751205, 0.03344785049557686, 0.010135501623153687, 0.0026828250847756863, 0.017915520817041397, 0.013031359761953354, 0.0205204077064991, 0.005310227163136005, 0.005462640430778265, -0.020589686930179596, 0.009809890761971474, 0.01786009781062603, -0.029540520161390305, 0.00039034325163811445, -0.012006032280623913, -0.02491268888115883, -0.03472258150577545, -0.03782627359032631, 0.05107240006327629, 0.020187869668006897, 0.03547079116106033, -0.019647493958473206, -0.03555392846465111, -0.04309147223830223, 0.0025477311573922634, -0.004198300652205944, -0.04564093425869942, 0.0018029832281172276, -0.019453512504696846, -0.04295291379094124, 0.023776516318321228, 0.012581046670675278, -0.0023901218082755804, 0.015213645063340664, -0.0021580373868346214, -0.025397641584277153, 0.0387684665620327, -0.009906881488859653, 0.02239093743264675, 0.004004320129752159, 0.005008863750845194, -0.03344785049557686, -0.01138252206146717, -0.011361738666892052, -0.001372588099911809, 0.04821810871362686, -0.03907329589128494, 0.012200012803077698, -0.055339980870485306, -0.0009716364438645542, -0.009886098094284534, -0.002694948809221387, 0.027863970026373863, 0.026533816009759903, 0.028764596208930016, -0.0016886730445548892, 0.009040895849466324, 0.001622858108021319, 0.02106078341603279, -0.02390121854841709, -0.008646005764603615, 0.004423457197844982, 0.002218656474724412, 0.036773234605789185, -0.04048658534884453, -0.05561709403991699, -0.013453960418701172, 0.028598327189683914, -0.005143957678228617, -0.01693176105618477, 0.0029772603884339333, -0.03508283197879791, -0.017167309299111366, 0.010017727501690388, 0.06118711829185486, -0.039821505546569824, -0.0205204077064991, 0.006003016140311956, -0.02149031311273575, -0.00258583459071815, -0.00789779331535101, -0.0041498057544231415, 0.006643845699727535, 0.0010244615841656923, -0.03217311576008797, 0.019093262031674385, -0.027683844789862633, 0.0008339446503669024, -0.022501783445477486, -0.02510667033493519, 0.017236588522791862, -0.009269515983760357, 0.00239531765691936, 0.0004879831976722926, 0.03339242562651634, 0.04098539426922798, 0.028542904183268547, 0.034667156636714935, 0.007205004803836346, -0.028376635164022446, -0.02262648567557335, -0.00959512684494257, -0.03932270035147667, 0.013931985013186932, -0.0364961214363575, -0.003987000323832035, 0.004319538827985525, -0.03984921798110008, 0.008445097133517265, 0.06462334841489792, -0.01338468212634325, -0.003928113263100386, -0.0007386861834675074, 0.01939808949828148, -0.014056687243282795, -0.0097752520814538, -0.01404975913465023, 0.01348860003054142, 0.02485726587474346, 0.011313242837786674, 0.00698331231251359, -0.025785604491829872, 0.01348167285323143, -0.028459768742322922, 0.006342482753098011, 0.02870917320251465, -0.0011760091874748468, -0.009692116640508175, -0.008860770612955093, 0.010710516944527626, -0.00163844577036798, 0.0046728611923754215, 0.028820019215345383, -0.01707031950354576, 0.005819426849484444, 0.016100414097309113, -0.005951056722551584, 0.003872690023854375, 0.0041705891489982605, 0.01730586774647236, 0.04461560770869255, -0.030870674178004265, -0.007786947302520275, -0.004399209748953581, 0.015643173828721046, 0.035221390426158905, -0.00787700992077589, -0.009248731657862663, -0.024067487567663193, -0.015116654336452484, -0.0199523214250803, -0.02833506651222706, -0.026672372594475746, 0.00827882718294859, -0.030538136139512062, -0.01500580832362175, -0.03494427353143692, -0.0018514783587306738, -0.01826191507279873, 0.002235976280644536, 0.014964240603148937, 0.015352202579379082, -0.006886322051286697, -0.12292846292257309, -0.02696334570646286, 0.047054223716259, -0.008992400020360947, 0.024441592395305634, -0.005164741538465023, -0.007939361035823822, -0.005296371411532164, 0.023776516318321228, 0.006287059281021357, 0.02467714063823223, -0.006747764069586992, -0.006993704009801149, 0.00046416858094744384, 0.013045215047895908, -0.06251727044582367, 0.004212156869471073, 0.015698596835136414, 0.02200297638773918, -0.028348922729492188, -0.009144813753664494, -0.004645149689167738, 0.01596185751259327, 0.050989266484975815, -0.020963793620467186, -0.032200828194618225, -0.005815962795168161, -0.003983536269515753, 0.009969232603907585, 0.014603990130126476, -0.009179453365504742, -0.004988080356270075, 0.006023799534887075, 0.04874463006854057, -0.04658312723040581, 0.005580414552241564, -0.015421481803059578, 0.027863970026373863, 0.029124846681952477, -0.004156733397394419, -0.028930865228176117, -0.048550646752119064, 0.018539031967520714, -0.019799906760454178, 0.034639447927474976, -0.0247325636446476, 0.021407177671790123, 0.019439656287431717, 0.015878722071647644, 0.013419321738183498, -0.0014687124639749527, -0.004963832441717386, 0.022141534835100174, 0.02923569269478321, 0.002608350245282054, 0.0029235691763460636, -0.022543352097272873, -0.02506510354578495, 0.006681949365884066, -0.0015847546746954322, -0.015047375112771988, 0.05220857262611389, 0.048328954726457596, -0.006176213268190622, -0.03932270035147667, -0.04198300838470459, 0.01262261439114809, 0.009920737706124783, 0.027476008981466293, -0.03347555920481682, 0.010350266471505165, 0.004489272367209196, 0.011534935794770718, -0.0014384030364453793, 0.0011612874222919345, -0.0021996048744767904, -0.01064123772084713, 0.01121625304222107, -0.044560182839632034, 0.007142653688788414, 0.0033842739649116993, -0.04090225696563721, -0.003858834272250533, -0.01368950866162777, -0.008181837387382984, 0.011278603225946426, 0.021143916994333267, -0.020437274128198624, -0.022113822400569916, 0.04652770236134529, 0.02998390421271324, -0.027406729757785797, -0.006903641391545534, -0.028903154656291008, -0.003834586590528488, 0.0035384194925427437, 0.01186747383326292, -0.007142653688788414, 0.04575178027153015, 0.03003932721912861, 0.02222466841340065, 0.025730181485414505, 0.021005360409617424, -0.05392669141292572, -0.014576278626918793, -0.0005702518974430859, -0.0034015935380011797, -0.012012959457933903, 0.05151578411459923, -0.026852497830986977, -0.006768547929823399, 0.01786009781062603, -0.002331234747543931, 0.021947553381323814, 0.017056463286280632, -0.0008755120215937495, 0.021379465237259865, 0.01033641118556261, 0.036357562988996506, -0.02470485307276249, 0.005784787703305483, 0.010121646337211132, 0.002028139540925622, 0.020991504192352295, -0.029180269688367844, -0.02219695784151554, -0.008992400020360947, 0.006633454002439976, -0.013031359761953354, 0.02355482429265976, -0.0006880260189063847, 0.04195529595017433, 0.011431016959249973, 0.015615462325513363, 0.00047456042375415564, 0.0034639446530491114, 0.03705035150051117, -0.010987631976604462, -0.023277707397937775, 0.019508935511112213, -0.007821586914360523, 0.016432953998446465, 0.04367341473698616, 0.019855329766869545, -0.0172781553119421, -0.004478880204260349, 0.008749923668801785, -0.004710964858531952, -0.001691270968876779, 0.010565031319856644, 0.001312835025601089, -0.03666238859295845, 0.016252828761935234, -0.001699930871836841, -0.005854066461324692, -0.004007783718407154, -0.043202318251132965, -0.012213869020342827, 0.010398761369287968, 0.03893473744392395, -0.0201185904443264, 0.002618742175400257, 0.03156346455216408, 0.014645557850599289, 0.005351794417947531, -0.014881106093525887, -0.014216029085218906, 0.010426472872495651, 0.0008252848056145012, 0.03857448697090149, 0.015269068069756031, -0.014853394590318203, 0.02487112209200859, 0.03283819556236267, 0.0311477892100811, 0.012463272549211979, -0.0023017912171781063, -0.04242639243602753, 0.028986288234591484, 0.02031257189810276, -0.011708132922649384, 0.010662021115422249, 0.002530411584302783, 0.02489883452653885, 0.03746602311730385, 0.018095646053552628, 0.0062316362746059895, 0.014368441887199879, 0.02602115273475647, 0.00703180767595768, 0.003365222131833434, 0.02372109331190586, -0.02833506651222706, 0.0014410009607672691, 0.023069871589541435, -0.03627442941069603, 0.02219695784151554, -0.007101086433976889, -0.025910304859280586, -0.004939584992825985, -0.014534711837768555, 0.01140330545604229, -0.016668502241373062, 0.00969904474914074, -0.028764596208930016, 0.015393770299851894, -0.017333578318357468, -0.020825235173106194, -0.018178781494498253, 0.01729201152920723, -0.008715284988284111, -0.004773315507918596, -0.007586038671433926, 0.01111926231533289, 0.012504840269684792, -0.0018151069525629282, 0.007433624938130379, 0.0009776983642950654, -0.05525684356689453, -0.028432058170437813, -0.03378038853406906, -0.015837155282497406, -0.018926993012428284, -0.005909489467740059, 0.012026815675199032, -0.015823299065232277, 0.015809442847967148, -0.023596391081809998, -0.016779348254203796, 0.032755061984062195, 0.02107463963329792, 0.008507448248565197, -0.007440553046762943, -0.0002387956774327904, -0.013883490115404129, -0.005254804156720638, -0.012082238681614399, -0.015366057865321636, -0.010883714072406292, 0.01920410804450512, 0.011188541539013386, -0.0031314059160649776, 0.005895633716136217, -0.0011985248420387506, 0.003841514466330409, -0.0028750740457326174, 0.005372578278183937, 0.04095768183469772, 0.01082136295735836, -0.0022723476868122816, -0.0028352385852485895, -0.027614565566182137, 0.02848748117685318, -0.014645557850599289, 0.02168429270386696, -0.0017605498433113098, 0.010287915356457233, 0.05165434256196022, 0.0376322939991951, 0.01636367477476597, -0.023014448583126068, 0.021905986592173576, -0.011424089781939983, -0.01672392524778843, 0.02147645689547062, -0.015684740617871284, -0.004281435627490282, -0.011756627820432186, -0.012331643141806126, 0.019259532913565636, -0.023485545068979263, -0.0015596410958096385, -0.00891619361937046, 0.031424906104803085, -0.012698820792138577, 0.009865314699709415, -0.0008187899366021156, 0.014673269353806973, 0.023402409628033638, -0.01242863293737173, -0.014181389473378658, -0.0011110602645203471, -0.01481182686984539, -0.01786009781062603, 0.005885242018848658, -0.021504167467355728, -0.035831041634082794, 0.005074678920209408, 0.04395052790641785, -0.011514151468873024, 0.01650223135948181, 0.013925056904554367, -0.005441857036203146, -0.007378201931715012, 0.021185485646128654, -0.0011075963266193867, -0.018677588552236557, 0.025965729728341103, 0.04098539426922798, -0.047968704253435135, 0.0013388146180659533, 0.0025962265208363533, 0.040514297783374786, -0.012227724306285381, 0.03691179305315018, 0.041151661425828934, -0.004004320129752159, -0.04990851506590843, -0.027489865198731422, 0.017208876088261604, 0.0014557227259501815, 0.0007023147772997618, 0.00332538690418005, 0.026145853102207184, -0.007135726045817137, 0.0011231839889660478, 0.026062719523906708, -0.027462152764201164, 0.00403895927593112, -0.010052367113530636, -0.001722446409985423, 0.03660696744918823, 0.0027590319514274597, 0.003372150007635355, -0.0027313202153891325, -0.04730362817645073, -0.025563910603523254, -0.021781284362077713, -0.007683028932660818, 0.021559590473771095, 0.007108014542609453, 0.022751187905669212, -0.006817042827606201, 0.02755914255976677, -0.03358640521764755, 0.0033686861861497164, -0.015227500349283218, -0.027822403237223625, -0.0006594484439119697, 0.007932432927191257, 0.0002450740721542388, 0.019065551459789276, -0.004277971573174, -0.030288731679320335, 0.012705748900771141, 0.004932657349854708, 0.007076838985085487, 0.0018514783587306738, -0.020395705476403236, -0.001523269689641893, 0.06595350801944733, -0.003292479319497943, -0.021407177671790123, -0.017818531021475792, -0.022266235202550888, 0.028432058170437813, -0.0014288771199062467, -0.01366872526705265, -0.023624101653695107, 0.002114738104864955, 0.005188988987356424, 0.013038287870585918, -0.0082719000056386, 0.024053631350398064, 0.02337469905614853, -0.002213460626080632, -0.022363226860761642, 0.003389469813555479, 0.025369931012392044, -0.007676101289689541, 0.033364713191986084, 0.010364122688770294, -0.011209324933588505, 0.015546183101832867, -0.014978096820414066, 0.0039800722151994705, -0.02258491888642311, 0.008126414380967617, 0.018317339941859245, 0.05276280269026756, 0.03461173549294472, -0.03347555920481682, -0.036773234605789185, -0.0237626601010561, 0.015061231330037117, 0.006997168064117432, -0.018843859434127808, 0.027268171310424805, 0.013031359761953354, -0.008687573485076427, -0.001527599524706602, -0.005632373970001936, -0.010530391708016396, 0.024497015401721, -0.019120974466204643, -0.02282046712934971, 0.01899627223610878, 0.015670886263251305, 0.0019675204530358315, 0.002656845608726144, 0.00461051007732749, -0.012941297143697739, 0.006165821570903063, -0.006965992506593466, 0.018857713788747787, -0.04117937386035919, -0.0027243923395872116, 0.037521447986364365, 0.016058847308158875, 0.020367994904518127, -0.04622287675738335, -0.03303217515349388, -0.013218412175774574, 0.006740836426615715, -0.027240460738539696, -0.05924730747938156, -0.011084622703492641, 0.026104286313056946, 0.007918577641248703, 0.014673269353806973, -0.011167757213115692, 0.006796259433031082, 0.00522016454488039, -0.0012279683724045753, 0.0300116166472435, 0.027101902291178703, 0.01840047352015972, 0.0379648320376873, 0.009130957536399364, 0.037909410893917084, -0.025411497801542282, -0.018926993012428284, -0.012636469677090645, 0.003928113263100386, 0.011361738666892052, -0.003834586590528488, 0.02870917320251465, -0.017236588522791862, -0.012463272549211979, 0.053289324045181274, -0.007987855933606625, -0.01084214635193348, 0.02013244666159153, -0.0030898386612534523, -0.00040766297024674714, 0.004513519816100597, -0.04295291379094124, -0.03020559623837471, 0.017582982778549194, -0.030455000698566437, -0.013578662648797035, -0.003308067098259926, 0.004163661506026983, -0.009823746979236603, -0.011687349528074265, 0.003502048086374998, -0.05071214959025383, -0.039627525955438614, 0.048328954726457596, 0.011070767417550087, -0.008978544734418392, 0.01396662462502718, 0.0009430589270778, -0.00015533626719843596, -0.001206318731419742, 0.014687125571072102, -0.026644662022590637, 0.037161197513341904, -0.007599894423037767, -0.018483608961105347, 0.05891476944088936, 0.017111886292696, -0.0006352008203975856, -0.02129633165895939, -0.00684129074215889, 0.0020090879406780005, -0.012463272549211979, -0.004700572695583105, -0.02868146076798439, -0.0035141718108206987, 0.027060335502028465, 3.769746035686694e-05, 0.027974816039204597, -0.00145052676089108, 0.02772541344165802, 0.04029260203242302, -0.02086680196225643, -0.01138252206146717, 0.018940849229693413, -0.02395664155483246, -0.010980704799294472, 0.024386169388890266, -0.02034028246998787, 0.01878843642771244, 0.006328627001494169, 0.00969904474914074, -0.004974224604666233, -0.014077470637857914, 0.005102390423417091, 0.008909265510737896, 0.005687796976417303, -0.012560263276100159, 0.01282352302223444, 0.02945738472044468, -0.004870306234806776, 0.011174685321748257, 0.010218637064099312, -0.012574118562042713, 0.012747316621243954, 0.004510055761784315, 0.02072824537754059, -0.002703608712181449, -0.02316686138510704, 0.00021140887110959738, 0.0356924869120121, -0.021961409598588943, -0.02467714063823223, -0.017014896497130394, 0.006879393942654133, 0.014091326855123043, 0.03743831440806389, 0.01898241601884365, -0.022543352097272873, 0.01707031950354576, -0.033143021166324615, 0.006671557202935219, -0.022557206451892853, 0.02755914255976677, -0.04145649075508118, 0.013890418224036694, -0.010987631976604462, 0.0015648369444534183, 0.0011318438919261098, -0.0031210139859467745, -0.0013829799136146903, -0.004953440744429827, -0.010371049866080284, 0.012913585640490055, 0.004094382748007774, 0.008112558163702488, 0.011631925590336323, -0.01802636869251728, 0.027392873540520668, -0.0026135460939258337, 0.03208998218178749, 0.030344154685735703, 0.00474213995039463, 0.042287833988666534, 0.017569126561284065, 0.01840047352015972, -0.02031257189810276, -0.022889746353030205, 0.0014349390985444188, -0.026519959792494774, 0.015435337089002132, 0.017929377034306526, -0.013017503544688225, -0.002339894650503993, 0.012380138039588928, -0.008410457521677017, 0.028764596208930016, -0.01840047352015972, -0.019896898418664932, -0.012650325894355774, -0.011396377347409725, -0.0007923773373477161, -0.0002691051922738552, 0.02753143198788166, -0.03397436812520027, -0.012269292026758194, 0.0047386763617396355, 0.009802963584661484, 0.03075982816517353, -0.0013665261212736368, -0.020949937403202057, -0.0035851825959980488, 0.01921796426177025, 0.02050655148923397, -0.007627605926245451, -0.011250891722738743, -0.03741060197353363, -0.003150457516312599, 0.003983536269515753, -0.017181165516376495, -5.074137732208328e-08, -0.010114718228578568, 0.012234652414917946, -0.004090918693691492, 0.003564398968592286, 0.021143916994333267, 0.006754692178219557, 0.0004050650168210268, -0.0017241784371435642, -0.0027954033575952053, 0.002816186985000968, 0.03394665569067001, 0.025577766820788383, 0.02124090865254402, -0.025522343814373016, 0.00903396774083376, -0.038103390485048294, 0.00893697701394558, -0.008167981170117855, -0.02451087161898613, -0.003507243935018778, -0.012290075421333313, 0.018746867775917053, -0.012317786924540997, 0.02887544222176075, 0.01672392524778843, -0.010225564241409302, 0.008708356879651546, 0.020423417910933495, -0.01691790483891964, -0.01197832077741623, 0.01878843642771244, -0.03075982816517353, 0.024940401315689087, -0.01302443165332079, -0.0024645966477692127, -0.0030257555190473795, -0.01499195210635662, -0.018843859434127808, -0.0031314059160649776, 0.018539031967520714, 0.02165658213198185, 0.001884385826997459, 0.012082238681614399, -0.034279197454452515, 0.0035262955352663994, 0.045862626284360886, -0.016072703525424004, 0.019661350175738335, -0.01062045432627201, 0.009304155595600605, 0.04389510676264763, -0.011715061031281948, 0.01672392524778843, 0.0008594912360422313, 0.0005594270769506693, 0.030067039653658867, -0.001363928196951747, 0.02259877510368824, -0.014084398746490479, -0.019342666491866112, 0.006598814390599728, 0.010786723345518112, -0.016432953998446465, -0.02923569269478321, 0.007586038671433926, -0.009671333245933056, 0.00541068147867918, -0.010114718228578568, -0.012657254002988338, 0.03364183008670807, 0.021171629428863525, 0.003876154078170657, 0.047054223716259, 0.011770484037697315, 0.02906942367553711, -0.00213378993794322, -0.002703608712181449, -0.0030673230066895485, 0.00789779331535101, -0.000259579363046214, 0.01366872526705265, -0.008209548890590668, 0.0478578582406044, -0.02694948948919773, 0.03860219940543175, -0.013294619508087635, 0.017929377034306526, 0.018871570006012917, -0.0100592952221632, 0.017901666462421417, -0.018317339941859245, -0.012955152429640293, 0.013828067108988762, 0.02679707482457161, -0.010128574445843697, 0.006893249694257975, 0.007565254811197519, 0.04769159108400345, -0.004870306234806776, -0.0028127229306846857, 0.024206044152379036, 0.0020333353895694017, 0.027198893949389458, 0.03117550164461136, -0.04087454825639725, -0.02244636043906212, 0.017596838995814323, 0.0073227789252996445, -0.037687718868255615, -0.002696680836379528, 0.021171629428863525, -0.016848627477884293, -0.010689732618629932, -0.011063839308917522, -0.01102227158844471, 0.01938423328101635, 0.023984352126717567, 0.020548120141029358, 0.019910752773284912, 0.027323594316840172, 0.03743831440806389, -2.141962613677606e-05, -0.004970760550349951, -0.0016349818324670196, 0.007094158791005611, 0.009532775729894638, 0.013911201618611813, 0.019633637741208076, 0.013502456247806549, 0.01264339778572321, -0.024635573849081993, 0.003493388183414936, -0.002050655195489526, -0.0047559961676597595, -0.060023233294487, -0.0033461705315858126, 0.04176131635904312, 0.021518023684620857, 0.024538584053516388, -0.03358640521764755, -0.028930865228176117, -0.012982864864170551, -0.0013457424938678741, 0.01463170163333416, 0.008479736745357513, 0.021504167467355728, -0.025744035840034485, -0.024400025606155396, -0.02282046712934971, -0.01612812653183937, -0.003030951600521803, -0.0037583799567073584, 0.027628421783447266, -0.033530984073877335]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
" implementation was correct for 60of200examples, theirs for 57
(the dense baseline achieved 74). Perhaps more importantly, we found that of the 79times that either output differed from
dense, 41occurrences showed a 20-character prefix match between our implementation and theirs. The fact that the two
implementations often generate the same errors (despite minor implementation differences) reassures us that our results
should be a fair representation of H 2O.
Group Hyperparameter Value or range
Dense modelFamilyLlama 2(13B,7B), Mistral ( 7B),
Pythia ( 6.9B,2.8B,1.4B)
dh{80,128}
MaxS{2048,4096}
TasksQuestion AnsweringSQuAD 1-shot ( 4000 samples)
TriviaQA 0-shot ( 2992 samples)
Summarisation CNN/DailyMail 0-shot ( 500samples)
Language Modelling WikiText- 103LM (500samples)
Artificial Repetition ( 1000 samples)
BaselinesEvictionkeep (k−l)tokens with highest score( n) =P
isinand the most recent l=k/4
k∈ {192,256,384,512,768}
LM-Infinitetake the first 16tokens, and most recent k−16
k∈ {192,256,384,512,768}
SparQ AttentionRank r{16,32,64}
Number of values k128
Local window lk/4
Table F1: Experiment hyperparameters
18
SparQ Attention: Bandwidth-Efficient LLM Inference
Method k r Compression
SparQ Attention 12816 0.13-0.17
32 0.19-0.23
64 0.31-0.36
H2O192
–0.10-0.17
256 0.13-0.22
384 0.20-0.33
512 0.26-0.43
768 0.39-0.65
Table F2: Range of compression ratios for different settings of (r, k), for Llama 2 7B and Pythia 6.9B. The compression
ratio achieved varies across models and tasks, based on the sequence length and head size.
19
SparQ Attention: Bandwidth-Efficient LLM Inference
F.1. Examples
We illustrate the task setup with a single example per task, showing the prompt formatting and a cherry-picked example. In
each case, we show outputs from a dense Llama 2 13B model, SparQ Attention ( r= 8, k= 128 ), H2O and LM-Infinite
(k= 192 ). Where “...” appears, we have truncated the line of text for brevity.
F.1.1. Q UESTION ANSWERING (SQ UAD1-SHOT )
### PROMPT (5725e1c4271a42140099d2d9)
Title: University of Chicago. Background: Current ...
Title: Harvard University. Background: Harvard has...
Title: Oxygen. Background: In one experiment, Lavo...
Title: Oxygen. Background: Oxygen storage methods ...
Title: Fresno, California. Background: This vibran...
Title: Fresno, California. Background: Before Worl...
Title: Steam engine. Background: The working fluid...
Title: Sky (United Kingdom). Background: While BSk...
From what you've just read about Fresno, California, please answer the following questions.
Question: Where is Audra McDonald from?
Answer: Fresno
Question: In what year did Roger Rocka's Dinner Theater & Good Company Players open?
Answer:
### OUTPUT
DENSE: 1978
SPARQ: 1978
H2O: 1979
LM-INFINITE: 1975 (Roger Rock
F.1.2. Q UESTION ANSWERING (TRIVIA QA 0- SHOT )
### PROMPT (dpql_5685)
Ap´eritifs and digestifs ( and) are drinks, typical...
Ap´eritifs
An ap´eritif is an alcoholic beverage usually serve...
""Ap´eritif"" may also refer to a snack that precedes...
""Ap´eritif"" is a French word derived from the Latin...
...
...
*Distilled liquors (ouzo, tequila, whisky or akva...
*Liquor cocktails (Black Russian, Rusty Nail, etc...
In certain areas, it is not uncommon for a digesti...
Bitter digestifs typically contain carminative her...
In many countries, people drink alcoholic beverage","[0.013669468462467194, 0.0024911456275731325, 0.01344766840338707, 0.011714340187609196, -0.004920680075883865, 0.008757003583014011, -0.016454294323921204, 0.033056456595659256, -0.012297593057155609, 0.02862044982612133, 0.03732816502451897, -0.01661037653684616, -0.05983678251504898, 0.006962064187973738, 0.014047350734472275, 0.0140227060765028, 0.023543687537312508, -0.007500134874135256, -0.0436042919754982, 0.06361560523509979, -0.005943425931036472, -0.03483085706830025, -0.07833656668663025, 0.02122710831463337, 0.008822722360491753, 0.0038609676994383335, -0.03486371785402298, 0.031577788293361664, 0.021292826160788536, -0.031084896996617317, 0.06141402944922447, -0.04557584971189499, 0.000838425534311682, -0.013965202495455742, -0.0019161079544574022, 0.02425016276538372, 0.012042933143675327, 0.014704536646604538, -0.03992404788732529, -0.004739954136312008, -0.024315882474184036, -0.06443708389997482, -0.02962265908718109, -0.042947106063365936, 0.007245475426316261, -0.003251016838476062, -0.01452381070703268, 0.02617243118584156, 0.031528498977422714, 0.034929435700178146, -0.05911387875676155, 0.040318358689546585, -0.011451466009020805, 0.03353291377425194, 0.006321307737380266, -0.06496283411979675, -0.03216925263404846, 0.030707014724612236, 0.05149052292108536, -0.03473227843642235, 0.02012632042169571, -0.022640056908130646, 0.017366139218211174, 0.0015022860607132316, -0.02050420269370079, 0.010441042482852936, -0.04304568096995354, 0.020586350932717323, 0.02449660748243332, 0.034797996282577515, -0.009249893017113209, 0.06700011342763901, 0.016922539100050926, -0.021769285202026367, -0.04212562367320061, -0.005894136615097523, 0.0070524271577596664, 0.015197426080703735, -0.030477000400424004, -0.04117270186543465, -0.0011018133955076337, 0.005618940107524395, 0.010966790840029716, -0.010580694302916527, 0.013036927208304405, -0.023461539298295975, -0.03601379320025444, 0.017875459045171738, -0.05336350202560425, -0.030707014724612236, -0.06266268342733383, -0.005696981213986874, -0.012856201268732548, -0.004604409448802471, 0.04518153518438339, -0.05168767645955086, 0.03506087139248848, 0.002205680590122938, -0.013628394342958927, 0.03322075307369232, 0.01820405200123787, -0.02669818140566349, -0.004871391225606203, -0.016363931819796562, 0.03420653194189072, 0.02002774365246296, -0.017218273133039474, 0.0247759111225605, -0.008773433044552803, -0.02886689454317093, -0.05165481939911842, -0.005462858360260725, -0.03274429216980934, 0.016823960468173027, 0.01715255342423916, 0.008325724862515926, -0.02646816521883011, -0.0676901564002037, -0.03601379320025444, -0.0071099307388067245, -0.029261205345392227, 0.013965202495455742, -0.000731632811948657, -0.02540023811161518, 0.026928195729851723, 0.0018452550284564495, 0.013028712011873722, -0.009102026000618935, 0.003086720360442996, -0.04570728540420532, 0.07117324322462082, 0.0032325335778295994, 0.009036307223141193, -0.04547727108001709, -0.0008717983146198094, -0.01642964966595173, -0.03831394389271736, -0.003220211248844862, -0.03384507820010185, 0.0019428060622885823, 0.019863447174429893, -0.00850234366953373, 0.013472313061356544, 0.038149647414684296, -0.027355367317795753, -0.03828108310699463, -0.031479209661483765, -0.01102429535239935, -0.035422325134277344, -0.011467895470559597, -0.010326034389436245, -0.016002478078007698, -0.05398782715201378, 0.03149563819169998, -0.016651449725031853, -0.0558936670422554, 0.009052736684679985, 0.021489981561899185, 0.0007193105993792415, -0.012346881441771984, -0.043439995497465134, -0.006875808350741863, 0.008338047191500664, -0.028850464150309563, -0.024562327191233635, -0.012034718878567219, -0.045510128140449524, 0.02862044982612133, -0.08168821781873703, -0.012880844995379448, -0.041567012667655945, 0.025712402537465096, -0.008338047191500664, -0.01003851555287838, -0.008863796480000019, -0.05858813226222992, 0.012297593057155609, -0.011755414307117462, -0.026911765336990356, -0.05106335133314133, 0.0072824424132704735, 0.04643018916249275, 0.018236910924315453, -0.02847258374094963, -0.01327515672892332, -0.06259696185588837, -0.05162195861339569, 0.013316230848431587, 0.030329132452607155, 0.026911765336990356, 0.019649861380457878, 0.04159987345337868, 0.07537923008203506, 0.025137364864349365, -0.03558662161231041, -0.06088828295469284, 0.051260508596897125, 0.007705505937337875, 0.028111129999160767, 0.009110241197049618, 0.008342154324054718, 0.01983058638870716, 0.023609407246112823, -0.07347339391708374, 0.014244506135582924, 0.022935790941119194, 0.023642266169190407, -0.0016419381136074662, -0.026583172380924225, -0.03006625920534134, 0.06368131935596466, -0.012921919114887714, 0.05701088532805443, 0.018713371828198433, -0.07334195822477341, 0.032497845590114594, -0.023313673213124275, 0.01205114834010601, -0.006009144242852926, 0.050931915640830994, -0.0075329942628741264, 0.04304568096995354, 0.05099763348698616, 0.018499786034226418, -0.019847016781568527, 0.018532644957304, -0.0023597085382789373, -0.01685682125389576, 0.009028092958033085, 0.005356065928936005, 0.04482008516788483, 0.009603130631148815, -0.025153793394565582, -0.03683527559041977, -0.02569597214460373, -0.04866462200880051, 0.01690610870718956, 0.013874839060008526, -0.02035633660852909, -0.03144634887576103, -0.02492377907037735, -0.014573099091649055, 0.058949582278728485, 0.018664082512259483, 0.02165427803993225, 0.03515945002436638, -0.0220978781580925, -0.03644096478819847, 0.023215094581246376, -0.005984500050544739, -0.0016984150279313326, -0.05474359169602394, -0.015665670856833458, -0.06499569118022919, -0.05674801021814346, -0.03144634887576103, -0.05027472972869873, -0.026878906413912773, -0.028965473175048828, 0.006037896499037743, 0.01102429535239935, 0.027700388804078102, -0.02214716747403145, 0.04866462200880051, -0.028028981760144234, -0.028258997946977615, 0.020734217017889023, 0.02737179584801197, -0.010564264841377735, -0.038773972541093826, -0.05339636281132698, 0.0140227060765028, 0.012864415533840656, 0.0035488044377416372, -0.014417017810046673, -0.006058433558791876, -0.0023884603288024664, -0.04629875347018242, -0.023362962529063225, 0.02232789434492588, -0.013258727267384529, -0.013702328316867352, 0.011960784904658794, 0.0020608941558748484, 0.007643894758075476, 0.04426147788763046, 0.036178089678287506, 0.029228346422314644, 0.016207849606871605, -0.004127949476242065, 0.055006466805934906, -0.04827031120657921, 0.02602456510066986, -0.018746230751276016, 0.030624866485595703, -0.002040357096120715, -0.014950981363654137, -0.029984110966324806, -0.010169953107833862, -0.03496229276061058, 0.06736156344413757, 0.027306078001856804, 0.007434416562318802, -0.01173898484557867, -0.013176579028367996, 0.03463369980454445, -0.01301228255033493, 0.027453944087028503, -0.02199930138885975, -0.024808771908283234, 0.009332041256129742, 0.03281001001596451, 0.02669818140566349, 0.014655247330665588, -0.03274429216980934, -0.07899375259876251, 0.0220485907047987, -0.007372805383056402, 0.02507164515554905, -0.03499515354633331, 0.030477000400424004, -0.03975975140929222, -0.0004507885023485869, -0.0031257409136742353, 0.01858193427324295, -0.052279144525527954, -0.005980392452329397, 0.002608206821605563, -0.02405300736427307, -0.009175959043204784, -0.00691688247025013, 0.020684929564595222, -0.01795760728418827, 0.02400371804833412, -0.057405196130275726, -0.008773433044552803, 0.011369317770004272, 0.02554810605943203, 0.022771494463086128, 0.061019718647003174, -0.04577300325036049, -0.03211996704339981, -0.008420195430517197, -0.004485294222831726, -0.005836633034050465, -0.00485085416585207, 0.07859944552183151, 0.016076412051916122, 0.024743052199482918, 0.032925017178058624, -0.025958847254514694, 0.05027472972869873, 0.016363931819796562, -0.010186382569372654, 0.017349710687994957, 0.01238795556128025, 0.017086835578083992, -0.027766108512878418, -0.026402447372674942, 0.030559148639440536, -0.01710326597094536, -0.025515245273709297, 0.01661037653684616, -0.005302669480443001, 0.03394365683197975, -0.012552252039313316, 0.007019567769020796, -0.013735187239944935, 0.03136420249938965, -0.03315503150224686, -0.0030210018157958984, 0.04383430629968643, -0.016257138922810555, -0.01718541420996189, -0.024595186114311218, 0.026780329644680023, -0.04265137016773224, 0.036670979112386703, -0.011566473171114922, 0.02954051084816456, -0.004994613584131002, -0.0024480177089571953, -0.023182235658168793, -0.016347501426935196, 0.05973820760846138, -0.011246095411479473, 0.005413569509983063, -0.013283371925354004, -0.028176849707961082, 0.0017251132521778345, 0.008625566028058529, -0.014967410825192928, -0.01553423423320055, 0.012839770875871181, 0.005183554254472256, 0.03607951104640961, 0.0368681326508522, 0.05996822193264961, 0.028160419315099716, 0.022065019235014915, 0.013694113120436668, -0.02214716747403145, -0.06325414776802063, 0.012026503682136536, -0.02410229668021202, 0.032875727862119675, 0.011328243650496006, 0.019091252237558365, 0.0008435597992502153, -0.006152903661131859, 0.027010343968868256, -0.04836888983845711, 0.0314134918153286, 0.005121943075209856, 0.015337077900767326, -0.04297996312379837, 0.041994184255599976, -0.0037911415565758944, 0.03400937467813492, 0.04205990210175514, 0.016109270974993706, -0.02963908761739731, -0.024595186114311218, -0.0435057133436203, -0.04304568096995354, 0.03759104013442993, 0.04025264084339142, -0.08694570511579514, 0.028324715793132782, -0.021013522520661354, -0.03430510684847832, 0.04159987345337868, 0.04025264084339142, -0.010638197883963585, -0.02544952742755413, -0.03165993466973305, -0.027404656633734703, 0.027831826359033585, -0.040121205151081085, -0.02722392976284027, -0.03591521456837654, -0.00881450716406107, 0.01825334131717682, 0.013595535419881344, -0.10449257493019104, 0.01777688041329384, 0.021391404792666435, 0.0023658694699406624, 0.03847824037075043, -0.03952973708510399, 0.0002013915654970333, -0.05402068793773651, 0.028981901705265045, 0.04255279153585434, -0.000685937877278775, -0.021457122638821602, 0.08431696146726608, 0.0215557012706995, 0.04182988777756691, -0.035126589238643646, 0.005639477167278528, -0.004822102375328541, -0.016396790742874146, 0.010966790840029716, -0.026353158056735992, 0.013907698914408684, -0.006682760082185268, 0.03535660728812218, 0.024036576971411705, -0.024020148441195488, -0.007134575396776199, -0.025630254298448563, -0.007483705412596464, -0.03353291377425194, -0.041271280497312546, -0.025367379188537598, 0.029786955565214157, 0.024644475430250168, 0.013110860250890255, 0.008945944719016552, 0.024792341515421867, -0.03341790661215782, -0.01111465785652399, 0.017826169729232788, -0.0008918219245970249, 0.031282052397727966, 0.03811678662896156, -0.008929514326155186, -0.02213073894381523, -0.015632811933755875, -0.03650668263435364, -0.009381329640746117, 0.006423993036150932, -0.021933581680059433, 0.012815127149224281, 0.010416397824883461, 0.012133296579122543, 0.007927305996418, 0.03923400491476059, -0.04827031120657921, 0.00806695781648159, -0.027913974598050117, -0.0072660124860703945, 0.005212306510657072, 0.034929435700178146, 0.013193008489906788, 0.026583172380924225, -0.021243536844849586, -0.00977564137428999, -0.03318789228796959, 0.001478668418712914, -0.032054245471954346, 0.006341844797134399, 0.006838841829448938, -0.024463748559355736, 0.018187621608376503, -0.00039431158802472055, 0.005672336556017399, -0.020816367119550705, 0.00404785480350256, -0.013036927208304405, 0.009471693076193333, -0.010728561319410801, 0.02252504974603653, -0.0019089198904111981, -0.008001239039003849, -0.022968649864196777, -0.07702219486236572, 0.005655907094478607, -0.04777742177248001, 0.004113573580980301, -0.02075064741075039, -0.005508040077984333, 0.005343743599951267, -0.021933581680059433, -0.0065718600526452065, -0.01978129893541336, -0.01248653419315815, 0.004460650030523539, -0.021259967237710953, 0.002823845949023962, 0.017612583935260773, -0.028127560392022133, -0.004399038851261139, 0.02824256755411625, -0.009233463555574417, 0.03244855999946594, -0.024168014526367188, -0.013956987299025059, -0.016692524775862694, 0.01459774374961853, -0.01452381070703268, 0.02199930138885975, -0.0031852982938289642, 0.014219861477613449, 0.0216049887239933, -0.010022086091339588, 0.003842484438791871, -0.011591117829084396, -0.022968649864196777, 0.007007245440036058, -0.005121943075209856, -0.028702598065137863, 0.00033244368387386203, -0.022163597866892815, 0.022442901507019997, 0.017974037677049637, -0.006087185349315405, 0.02310008741915226, 0.020438484847545624, -0.010605338960886002, -0.010794280096888542, 0.008436624892055988, -0.042947106063365936, 0.016068197786808014, -0.023083657026290894, 0.008477699011564255, 0.03535660728812218, -0.025186652317643166, -0.013998061418533325, -0.021440692245960236, -0.047185953706502914, 0.001790831796824932, 0.0013595535419881344, -0.03860967606306076, -0.013127289712429047, 0.032579995691776276, 0.0497489795088768, -0.032826438546180725, -0.01541101187467575, 0.037196725606918335, 0.0018247179687023163, -0.0034871932584792376, 0.012864415533840656, -0.05037330463528633, -0.011804703623056412, 0.05037330463528633, -0.031183475628495216, -0.02564668282866478, -0.0022713991347700357, -0.0031524391379207373, -0.00881450716406107, -0.010030301287770271, -0.003133955644443631, -0.015690315514802933, 0.024644475430250168, -0.016495367512106895, 0.013250512070953846, 0.011755414307117462, -0.02632029913365841, 0.0026205291505903006, 0.018039755523204803, -0.008079280145466328, -0.020044172182679176, -0.04629875347018242, 0.015517803840339184, -0.02972123585641384, -0.031002748757600784, 0.029786955565214157, -0.022985080257058144, -0.018844807520508766, -5.374934062274406e-07, 0.004489401821047068, 0.0031996741890907288, -8.59347710502334e-05, 0.04327569901943207, -0.01407199539244175, -0.020832795649766922, -0.007327623665332794, -0.011665050871670246, -0.025416668504476547, 0.004670127760618925, 0.006419885437935591, -0.0005596349365077913, -0.03188994899392128, 0.02530166134238243, -0.031035607680678368, 0.021194247528910637, 0.005980392452329397, -0.021062811836600304, 0.04205990210175514, 0.020290616899728775, 0.048763200640678406, -0.02617243118584156, 0.026156002655625343, -0.004649590700864792, -0.040844108909368515, 0.005877707153558731, -0.007352268323302269, -0.020142750814557076, -0.005783236585557461, -0.037755336612463, 0.020422054454684258, 0.018549075350165367, 0.025433097034692764, -0.010096020065248013, -0.0367695577442646, -0.019633430987596512, -0.05142480507493019, -0.0024048900231719017, -0.031807802617549896, -0.0074508460238575935, 0.008469484746456146, -0.050110433250665665, -0.02012632042169571, 0.030674155801534653, 0.02774967812001705, -0.0047276318073272705, -0.005117835942655802, -0.007902661338448524, 0.0435057133436203, -0.022442901507019997, 0.05799666419625282, 0.0005064953002147377, 0.02314937673509121, -0.025580964982509613, 0.007832835428416729, -0.024513037875294685, -0.020438484847545624, 0.018532644957304, -0.037196725606918335, -0.01604355312883854, -0.03975975140929222, 0.02285364270210266, 0.01960057206451893, -0.005405354779213667, 0.059771064668893814, 0.011057154275476933, 0.0035159450490027666, 0.03034556284546852, -0.007459060754626989, 0.006723834201693535, 0.00408071419224143, -0.01479489915072918, 0.017448287457227707, -0.020060602575540543, 0.0050685470923781395, 0.03274429216980934, -0.006727941334247589, -0.06654008477926254, -0.022607197985053062, -0.002421319717541337, -0.018811948597431183, -0.03211996704339981, -0.00637470418587327, -0.004604409448802471, 0.024283021688461304, 0.01753043569624424, 0.058620989322662354, 0.005158910062164068, -0.008633781224489212, 0.011656836606562138, -0.03670383617281914, 0.017037546262145042, 0.0006130313267931342, 0.003920525312423706, -0.0065554301254451275, 0.0021543377079069614, -0.013932342641055584, 0.002786879427731037, -0.009816715493798256, 0.03231712058186531, -0.03463369980454445, 0.0011100282426923513, 0.013176579028367996, -0.036046650260686874, 0.023280814290046692, -0.010424613021314144, 0.02222931571304798, 0.04064695164561272, 0.0003504136111587286, 0.03650668263435364, 0.015665670856833458, -0.014260935597121716, -0.025580964982509613, 0.0022262176498770714, -0.03535660728812218, -0.002037276513874531, -0.004563335329294205, -0.03703242912888527, 0.023839421570301056, -0.04347285255789757, -0.0016624751733615994, 0.005187661852687597, 0.016725383698940277, 4.444348451215774e-05, -0.021358544006943703, 0.00807106588035822, -0.05178625509142876, 0.01728399097919464, -0.028209708631038666, 0.0186805110424757, -0.008062850683927536, 0.0011736931046471, 0.029786955565214157, -0.02704320289194584, 0.015016700141131878, -0.019074823707342148, -0.0018544966587796807, 0.015304218977689743, 0.01780974119901657, 0.02799612283706665, -0.01136110257357359, 0.009364900179207325, -0.025991706177592278, 0.005150695331394672, 0.018089044839143753, -0.02102995105087757, 0.01579710841178894, -0.022393612191081047, -0.020898515358567238, -0.010506761260330677, -0.008600921370089054, 0.023313673213124275, 0.05986964330077171, -0.023083657026290894, 0.015813536942005157, 0.0020875923801213503, -0.01604355312883854, 0.02199930138885975, -0.0054382141679525375, -0.008921300061047077, -0.011903281323611736, -0.004111520014703274, 0.012732978910207748, -0.04265137016773224, -0.010252101346850395, -0.009570270776748657, -0.03995690867304802, -0.01027674600481987, -0.007565853651612997, -0.011607547290623188, -0.0439986027777195, -0.01685682125389576, 0.02944193221628666, 0.005680551286786795, 0.018286200240254402, -0.1377461850643158, -0.011328243650496006, 0.03798535093665123, -0.02564668282866478, 0.019271979108452797, 0.027486804872751236, 0.005618940107524395, 0.022032160311937332, 0.023806562647223473, 0.001924322685226798, 0.04873033985495567, -0.01262618601322174, -0.015090633183717728, -0.046758782118558884, -0.00631309300661087, -0.024135155603289604, 0.020783506333827972, 0.021489981561899185, 0.028899753466248512, -0.050406165421009064, -0.031429920345544815, -0.015838181599974632, 0.01800689660012722, 0.014950981363654137, -0.0020567867904901505, -0.026681751012802124, -0.021457122638821602, 0.021917153149843216, 0.02852187119424343, -0.011459680274128914, -0.0009447048651054502, -0.003088774159550667, -0.019962023943662643, 0.032251402735710144, -0.02035633660852909, -0.03515945002436638, -0.015501374378800392, 0.004768705926835537, 0.032481417059898376, -0.00710582360625267, 0.01080249436199665, -0.07091037184000015, 0.0067402636632323265, -0.012026503682136536, 0.049584683030843735, -0.03982546925544739, 0.017546866089105606, 0.033877938985824585, -0.0069415271282196045, 0.001492017530836165, -0.019814157858490944, -0.003216103883460164, 0.031134186312556267, 0.03073987551033497, -0.05362637713551521, 0.023543687537312508, -0.005327314138412476, -0.021982870995998383, -0.029852673411369324, 0.008485914207994938, -0.025219513103365898, 0.0030764518305659294, 0.0009318692027591169, -0.03693385422229767, -0.031331341713666916, -0.032300692051649094, -0.013308016583323479, 0.021670708432793617, 0.0052533806301653385, 0.009274537675082684, -0.025712402537465096, 0.017201842740178108, -0.004781028255820274, -0.015279574319720268, -0.0002975306997541338, 0.02540023811161518, -0.0028608127031475306, 0.003930793609470129, -0.04245421662926674, -0.005154802463948727, 0.020865654572844505, -0.023116517812013626, -0.030904171988368034, -0.002501414157450199, 0.00173743546474725, 0.006284341216087341, 0.024118725210428238, -0.02958979830145836, -0.019189830869436264, 0.022245746105909348, 0.06279411911964417, -0.005713410675525665, 0.03054271824657917, -0.008872010745108128, -0.036670979112386703, 0.02972123585641384, -0.02222931571304798, -0.0021481767762452364, 0.001369822071865201, 0.015764249488711357, 0.026681751012802124, 0.0252688005566597, -0.0007475490565411747, -0.03294144943356514, 0.010046730749309063, 0.020192040130496025, -0.014195217750966549, 0.035028014332056046, 0.00216049887239933, 0.0002155107940779999, 0.014006276614964008, -0.012010074220597744, -0.020044172182679176, 0.021112099289894104, -0.012010074220597744, 0.0005147101473994553, 0.017316849902272224, 0.012790482491254807, 0.010022086091339588, -0.019567713141441345, -0.005861277692019939, 0.056550852954387665, -0.028932612389326096, 0.012765837833285332, -0.0053642806597054005, -0.03982546925544739, -0.02612314373254776, 0.02324795350432396, 0.02689533680677414, 0.03116704523563385, -0.01142682135105133, 0.01800689660012722, -0.02809470146894455, 0.026928195729851723, 0.0048672836273908615, 0.015690315514802933, -0.0032222650479525328, 0.05349493771791458, -0.02084922604262829, 0.013488742522895336, 0.005775021854788065, 0.03169279545545578, 0.053560659289360046, 0.00035349419340491295, -0.015624596737325191, -0.027503233402967453, 0.012084007263183594, 0.006929204799234867, -0.040942687541246414, -0.0374596007168293, -0.009504551999270916, -0.010301390662789345, -0.003647382138296962, 0.02617243118584156, 0.004337427671998739, -0.006744371261447668, -0.02602456510066986, -0.04317712038755417, 0.0038301621098071337, 0.018746230751276016, -0.004255279432982206, -0.021457122638821602, 0.021342115476727486, -0.004908357746899128, 0.02035633660852909, -0.00508086895570159, -0.00648149661719799, -0.015862826257944107, 0.00371515448205173, 0.033056456595659256, 0.022344322875142097, 0.009586700238287449, 0.01534529309719801, -0.0027232144493609667, 0.017842600122094154, 0.05796380341053009, 0.036572400480508804, -0.0038055176846683025, 0.023379391059279442, 0.023740842938423157, -0.0016799316508695483, 0.005310884211212397, 0.0010751151712611318, 0.034403685480356216, 0.016988256946206093, 0.01604355312883854, 0.031906381249427795, 0.01008780486881733, 0.022262174636125565, 0.01262618601322174, 0.012732978910207748, 0.04836888983845711, 0.003850699169561267, 0.02347796969115734, -0.004099197685718536, 0.02055349200963974, 0.028012553229928017, -0.0014160304563120008, 0.006727941334247589, 0.016150346025824547, -0.0012989691458642483, 0.030756304040551186, 0.009356685914099216, 0.018861237913370132, -0.012338667176663876, 0.01656108722090721, -0.027601812034845352, 0.009586700238287449, -0.0005760645726695657, 0.014187002554535866, -0.03116704523563385, -0.013299801386892796, -0.024562327191233635, 0.037295304238796234, 0.0025157900527119637, -0.003111365018412471, -0.018811948597431183, -0.007824620231986046, -0.05586080998182297, -0.025580964982509613, -0.013373734429478645, -0.039299722760915756, -0.03456798195838928, 0.020914943888783455, -0.0001680188433965668, -0.006645793095231056, 0.019896306097507477, -0.00023745978251099586, -0.013045141473412514, 0.020241327583789825, -0.0029142091516405344, 0.017744021490216255, 0.008962374180555344, 0.02669818140566349, -0.002010578289628029, -0.008301080204546452, 0.026106713339686394, -0.002575347665697336, 0.01800689660012722, 0.009512767195701599, 0.01968272030353546, 0.014170573092997074, 0.002793040359392762, -0.00907738134264946, 0.005499825347214937, -0.0246280450373888, 0.02771681919693947, 0.03634238615632057, 0.011344673112034798, -0.01077785063534975, 0.0053190989419817924, 0.0013338822172954679, 0.047185953706502914, -0.01066284254193306, -0.003934901207685471, 0.0011398069327697158, 0.025038786232471466, 0.013792690820991993, 0.023395821452140808, 0.0006289475131779909, -0.007951950654387474, 0.05454643815755844, -0.00797248724848032, -0.018417637795209885, 0.009159529581665993, -0.019074823707342148, -0.028965473175048828, -0.00032833628938533366, -0.00970170833170414, -0.010671057738363743, -0.01825334131717682, 0.007352268323302269, 0.057799506932497025, 0.021457122638821602, 0.006206300109624863, -0.008715929463505745, 0.008822722360491753, -0.012010074220597744, 0.021917153149843216, -0.011180376634001732, -0.02525237202644348, 0.0009852655930444598, 0.007138682994991541, 0.008904870599508286, -0.001200391328893602, -0.003446119138970971, 0.005618940107524395, -0.04202704504132271, 0.0035960394889116287, -0.02227860502898693, 0.014729181304574013, 0.02646816521883011, -0.006892238277941942, -0.023938000202178955, -0.003959545399993658, -0.0019356181146577, -0.017612583935260773, 0.011418606154620647, 0.02352725900709629, -0.0440971814095974, 0.00663757836446166, 0.021440692245960236, 0.05924531817436218, 0.002979927696287632, 0.024644475430250168, 0.04173130914568901, 0.00946347787976265, -0.04212562367320061, 0.007705505937337875, 0.007352268323302269, 0.012420815415680408, 0.027076061815023422, 0.024644475430250168, 0.015526019036769867, -0.037098150700330734, 0.007339945994317532, -0.020060602575540543, 0.020389195531606674, -0.018499786034226418, -0.00907738134264946, -0.019469134509563446, -0.0010781957535073161, 0.017119694501161575, -0.010046730749309063, -0.009282751940190792, -0.02137497439980507, 0.017891889438033104, 0.01472096610814333, 0.013883054256439209, 0.01776045188307762, 0.024660903960466385, -0.017119694501161575, -0.0075329942628741264, 0.01409663911908865, -0.021572129800915718, 0.012765837833285332, -0.06387847661972046, 0.0065718600526452065, 0.005668228957802057, -0.0038835585583001375, -0.02842329442501068, 0.009635989554226398, -0.005536791868507862, -0.001095652231015265, 0.0020947803277522326, 0.02137497439980507, 0.013225868344306946, -0.006448637694120407, 0.011615762487053871, 0.011747199110686779, 0.1010752022266388, -0.004772813059389591, -0.027634670957922935, -0.02449660748243332, -0.021473553031682968, 0.02295222133398056, 0.006058433558791876, 0.007031890098005533, -0.02079993672668934, -0.024940207600593567, -0.008896655403077602, 0.011131087318062782, 0.0010586855933070183, 0.00398624362424016, -0.006193977780640125, -0.015090633183717728, -0.00326539296656847, 0.025104504078626633, 0.02280435338616371, -0.0093895448371768, 0.016462508589029312, 0.002602045889943838, 0.014868833124637604, 0.00637470418587327, -0.017448287457227707, -0.0247759111225605, -0.0006407563341781497, 0.01181291788816452, 0.039694033563137054, 0.009611344896256924, 0.02165427803993225, -0.021161388605833054, -0.024660903960466385, 0.012396170757710934, -0.010498546063899994, 0.016643235459923744, -0.011213235557079315, 0.003372185630723834, 0.007175649516284466, 0.006222730036824942, -0.00398624362424016, 0.0188776683062315, -0.016536442562937737, 0.022640056908130646, -0.0024089973885565996, 0.020438484847545624, 0.033500056713819504, 0.011944355443120003, -0.00202392740175128, 0.016840390861034393, -0.027404656633734703, 0.016002478078007698, 0.026353158056735992, -0.025219513103365898, 0.0007901634671725333, -0.04997899383306503, 0.0003108797827735543, 0.00021628093963954598, 0.02517022378742695, 0.012272948399186134, -0.035652339458465576, -0.015476729720830917, -0.005146587733179331, 0.0027786644641309977, -0.011188591830432415, -0.047514546662569046, -0.019518423825502396, 0.010498546063899994, -0.00819018017500639, -0.015082417987287045, -0.01477025542408228, -0.014564884826540947, 0.0027807182632386684, 0.014367728494107723, 0.0026800865307450294, 0.01633107103407383, 0.017793310806155205, 0.012092222459614277, 0.041895605623722076, 0.03159421682357788, -0.0071551124565303326, -0.02122710831463337, -0.01800689660012722, -0.018844807520508766, 0.027864685282111168, -0.021161388605833054, 0.02324795350432396, -0.008658424951136112, -0.012716548517346382, -0.01534529309719801, -0.015961404889822006, -0.027355367317795753, 0.03304002434015274, 0.0057791294530034065, -0.01274940837174654, -0.007290657144039869, 0.006161118857562542, 0.021884294226765633, -0.005926996003836393, -0.03281001001596451, -0.006378811318427324, 0.005466965958476067, -0.00558197358623147, 0.002398728858679533, -0.019666289910674095, -0.01978129893541336, -0.05421784520149231, -0.03304002434015274, 0.0065554301254451275, 0.027634670957922935, 0.02607385441660881, -0.007828728295862675, 0.018039755523204803, 0.026435306295752525, 0.01785902865231037, 0.0074220942333340645, -0.01344766840338707, 0.0219500120729208, 0.011254309676587582, -0.03864253684878349, 0.007734257727861404, 0.04659448564052582, 0.02060278132557869, 0.01003851555287838, -0.0011511023622006178, 0.01670895330607891, -0.009496337734162807, -0.008658424951136112, -0.0433085560798645, 0.025630254298448563, -0.0071099307388067245, 0.010999650694429874, 0.0281932782381773, -0.009660634212195873, 0.02747037447988987, 0.005516254808753729, -0.004666020628064871, 0.015772463753819466, 0.00021923314488958567, -0.009603130631148815, -0.01920626126229763, 0.02218002639710903, -0.010835354216396809, 8.529298793291673e-05, 0.055827949196100235, -0.03331932798027992, -0.026583172380924225, -0.007417986635118723, 0.010531405918300152, 0.02237718366086483, 0.0022200564853847027, -0.0024151585530489683, 0.016700739040970802, 0.04695593938231468, 0.022163597866892815, 0.020964233204722404, -0.002017766470089555, 0.022837212309241295, -0.003850699169561267, -0.009586700238287449, 0.0053190989419817924, -0.003873290028423071, -0.028209708631038666, -0.002213895320892334, 0.02467733435332775, 0.03703242912888527, 0.0052081989124417305, -0.014556669630110264, 0.004801565315574408, -0.010909287258982658, 0.005499825347214937, -0.023806562647223473, -0.009857789613306522, 0.013669468462467194, -0.01293834950774908, -0.000632541486993432, -0.012420815415680408, 0.05149052292108536, -0.019288409501314163, 0.02357654646039009, 0.001003748970106244, -0.015517803840339184, 0.018844807520508766, 0.01472096610814333, 0.005015150643885136, -0.014745610766112804, 0.02482520043849945, 0.0012414654484018683, -0.0010299336863681674, 0.0013041034108027816, 0.03975975140929222, 0.014187002554535866, 0.0157067459076643, 0.0054875030182302, 0.036572400480508804, 0.04393288493156433, 0.008177857846021652, 0.02847258374094963, 0.031627073884010315, 0.030033400282263756, -0.00845305435359478, -0.0109750060364604, -0.00881450716406107, -0.02756895311176777, -0.028784746304154396, 0.017464717850089073, -0.03126562386751175, -0.022607197985053062, 0.009044522419571877, -0.010744990780949593, 0.006994923576712608, 0.01001387182623148, -0.0018123957561329007, 0.02549881674349308, -0.003251016838476062, 0.016889680176973343, -0.003086720360442996, 0.050734758377075195, -0.007845157757401466, 0.0016984150279313326, -0.006933312397450209, 0.004748168867081404, 0.047514546662569046, -0.016396790742874146, 0.001977719133719802, 0.007031890098005533, 0.021867863833904266, -0.0018390938639640808, 0.005302669480443001, 0.007089393679052591, 0.009455263614654541, 0.029688376933336258, -0.014203432016074657, -0.011755414307117462, 0.022820783779025078, 0.0051630171947181225, 0.00631309300661087, -0.02632029913365841, -0.018335489556193352, 0.02262362837791443, 0.0010473901638761163, 0.034797996282577515, -0.019863447174429893, -0.0008959293481893837, -0.020964233204722404, -0.0028834035620093346, 0.014622388407588005, -0.005150695331394672, -0.01700468733906746, 0.009939937852323055, -0.004920680075883865, 0.03394365683197975, 0.016988256946206093, -0.03808392956852913, 0.046265892684459686, -0.02747037447988987, -0.01128716953098774, -0.015903901308774948, 0.019419845193624496, 0.008272328414022923, -0.05898244306445122, -0.009159529581665993, -0.020389195531606674, 0.011870421469211578, -0.021309256553649902, 0.041468434035778046, -0.010827139019966125, -0.010301390662789345, 3.613239459809847e-05, 0.0109750060364604, -0.007997131906449795, 0.026303868740797043, 0.01205114834010601, -0.02372441440820694, -0.007348160725086927, 0.023609407246112823, 0.027404656633734703, 0.015254929661750793, -0.0065266783349215984, 0.0018277985509485006, 0.05914673954248428, 0.0064445300959050655, -0.006115937139838934, -0.017990466207265854, 0.009750996716320515, 0.010268530808389187, -0.013406594283878803, 0.0033824541606009007, 0.00010473901784280315, -0.011377532035112381, 0.014540240168571472, 0.025383809581398964, 0.0247759111225605, -0.0022200564853847027, -0.029655518010258675, 0.015468515455722809, 0.012100436724722385, -0.03269500285387039, -0.0492560900747776, 0.004427790641784668, -0.02214716747403145, -0.003647382138296962, -0.004337427671998739, -0.014006276614964008, 0.0032612853683531284, 0.016289997845888138, -0.005241058301180601, 0.04580586403608322, -0.004316890612244606, 0.033877938985824585, 0.022755064070224762, 0.014729181304574013, -0.01111465785652399, -0.004657805897295475, 0.004134110640734434, 0.022032160311937332, 0.01656108722090721, 0.025613823905587196, -0.04472150653600693, 0.009496337734162807, -0.00023322401102632284, 0.016199635341763496, 0.02694462612271309, -0.011270740069448948, 0.009332041256129742, 0.007894447073340416, -0.013160149566829205, 0.03187352046370506, -0.015263144858181477, -0.026517454534769058, 0.003910256549715996, -0.01762901432812214, 0.016010694205760956, 0.016733597964048386, -0.013299801386892796, 0.021342115476727486, 0.0006094372947700322, 0.02766752988100052, -0.002474715933203697, -0.02362583577632904, -0.03318789228796959, -0.006966171320527792, -0.0007290656794793904, -0.006132366601377726, -0.0006530786049552262, 0.003737745340913534, -0.024381600320339203, -0.0014180841390043497, 0.0065266783349215984, -0.0015823806170374155, 0.03476513922214508, 0.03146277740597725, 0.008038206025958061, 0.018039755523204803, 0.006165225990116596, -0.012617970816791058, 0.015961404889822006, -0.006994923576712608, -0.010424613021314144, 0.008083387278020382, 0.018023325130343437, -0.013628394342958927, 0.006087185349315405, 0.03995690867304802, 0.005996821913868189, 0.00567644415423274, -0.01142682135105133, -0.043768588453531265, -0.0017056029755622149, -0.005569651257246733, -0.021046381443738937, -0.007947842590510845, 0.04288138449192047, -0.031002748757600784, 0.0036206841468811035, -0.03016483597457409, -0.020241327583789825, -0.01308621559292078, 0.007146897725760937, -0.00403553294017911, 0.008227147161960602, -0.02319866605103016, 0.00015839209663681686, -0.039266861975193024, 0.027404656633734703, -0.019633430987596512, -0.018138334155082703, 0.0376567579805851, -0.022870073094964027]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
"...
Question: Which aperitif is named for the Paris chemist who created it in 1846?
Answer:
### OUTPUT
DENSE: Dubonnet
SPARQ: Dubonnet
H2O: Dubonnet
LM-INFINITE: Byrrh
Note that for Pythia, the prompt “Single-word answer:” was used in place of “Answer:”, as this helped prevent the model
from restating the question in the answer (often qualitatively correct, but not a regex match).
F.1.3. S UMMARISATION (CNN/D AILY MAIL)
### PROMPT (a62bbf503be06e8b1f8baa4f3cd537310d5aa3bc)
Article: Prince William arrived in China tonight for one of the most high-profil...
Summary:
### OUTPUT
DENSE: Prince William arrived in China tonight for one of the most high-profile { ...
20
SparQ Attention: Bandwidth-Efficient LLM Inference
SPARQ: Prince William arrived in China tonight for one of the most high-profile { ...
H2O: Prince William arrived in China tonight for a high-profile visit that will ...
LM-INFINITE: Prince William and Kate Middleton are in Japan for a three-day tour. The ro...
F.1.4. R EPETITION (SHAKESPEARE )
### PROMPT (210496)
you mistake me much;
I do lament the sickness of the king.
...
...
Peace, children, peace! the king doth love you well:
Incapable and shallow innocents,
You cannot guess who caused your father's death.
Boy:
Grandam, we can; for my good uncle Gloucester
Told me, the king, provoked by the queen,
Devised impeachments to imprison him :
And when my uncle told me so, he wept,
And hugg'd me in his arm, and kindly kiss'd my cheek;
...
...
the king doth love you well:
Incapable and shallow innocents,
You cannot guess who caused your father's death.
Boy:
Grandam, we
### OUTPUT
DENSE: can; for my good uncle Gloucester
SPARQ: can; for my good uncle Gloucester
H2O: can;
LM-INFINITE: 'll not stand to prate, but to the purpose.
F.1.5. L ANGUAGE MODELLING (WIKITEXT-103)
### QUERY (2)
= Mellor hill fort =
Mellor hill fort is a prehistoric site in North West England , that dates from ...
= = Location = =
Mellor lies on the western edge of the Peak District in the Metropolitan Boroug...
= = Background = =
Until the 19th century little was known about hill forts ; none had been excava...
The study of hill forts was popular in the 19th century , with a revival in the...
= = History = =
There is evidence of human activity on the site pre @-@ dating the Iron Age , a...
A flint dagger was discovered on the site . This type of artefact is rare in Gr...
The hill fort was built in and used throughout the Iron Age , as demonstrated b...
Fragments of glass , possibly Roman in origin , and shards of pottery which date to the 1st and
2nd centuries AD , indicate the site was used in the Romano @-@ British period . However no Roman
structures have been discovered , and the nature of Roman activity at the site is a source of
speculation . The position of the hilltop indicate that it was easily defended ; however , local finds
indicate it was a high @-@ status settlement rather than a military outpost unless a similar feature
was located nearby . One reason that Roman structures have not been identified is that the Romano
21
SparQ Attention: Bandwidth-Efficient LLM Inference
### BPC
DENSE: 0.669
SPARQ: 0.673
H2O: 0.685
LM-INFINITE: 0.692
22
","[0.019796546548604965, 0.014193087816238403, 0.014772756025195122, 0.02452171966433525, -0.01728465035557747, -0.0032233064994215965, -0.02835104428231716, -0.023801526054739952, -0.019374970346689224, 0.005256536416709423, -0.0013174277264624834, -0.017372479662299156, -0.02139502577483654, 0.022413836792111397, 0.02638368494808674, 0.03355049341917038, 0.0056517645716667175, 0.017600834369659424, -0.04416017606854439, 0.057615503668785095, 0.022273311391472816, -0.013595853932201862, -0.024433892220258713, -0.011417706497013569, -0.004404599778354168, 0.014974761754274368, -0.025891846045851707, 0.00796604622155428, 0.02671743370592594, -0.030318401753902435, 0.05884510278701782, -0.04180637001991272, -0.0009084761841222644, -0.015949657186865807, -0.010398895479738712, 0.013341151177883148, 0.012216946110129356, -0.016599588096141815, -0.021166671067476273, -0.02979143150150776, -0.007597166113555431, -0.03945256769657135, -0.030441362410783768, -0.03421798720955849, 0.02195712737739086, -0.03681771084666252, 0.011575797572731972, 0.015624692663550377, 0.011672409251332283, 0.014553184621036053, -0.060671936720609665, 0.0005475558573380113, -0.02445145696401596, 0.042052291333675385, -0.03435851261019707, -0.03709876164793968, -0.018162935972213745, 0.009028770960867405, 0.03730955347418785, -0.01630975492298603, 0.022712452337145805, -0.032250627875328064, 0.0028697967063635588, 0.01076777558773756, -0.06348244845867157, -0.0021023950539529324, -0.04458175227046013, 0.029967088252305984, 0.008971682749688625, 0.04380886256694794, -0.015053806826472282, 0.04363320395350456, 0.026980919763445854, -0.006521266885101795, -0.016924554482102394, -0.02466224692761898, -0.012594608590006828, 0.006648618262261152, -0.03246141970157623, -0.023924486711621284, 0.018110239878296852, -0.004255291540175676, 0.013446545228362083, -0.0554373562335968, 0.03449903801083565, -0.03534219413995743, -0.03360318765044212, 0.04841107502579689, -0.054840121418237686, -0.021851733326911926, -0.023292120546102524, -0.00824709702283144, 0.0006696924101561308, 0.0011615321272984147, 0.0405416414141655, -0.014254567213356495, 0.012067637406289577, 0.013569504953920841, -0.035588111728429794, 0.055542752146720886, 0.03889046609401703, -0.03427068516612053, -0.007996786385774612, -0.019322272390127182, 0.06783874332904816, 0.0076586464419960976, 0.018004845827817917, 0.007280983496457338, 0.026049936190247536, -0.005752767436206341, -0.12176544964313507, -0.003592186141759157, -0.05315381661057472, 0.07121136039495468, -0.0023230642545968294, 0.026471514254808426, -0.02757815271615982, -0.02132476307451725, 0.002307694172486663, 0.029088802635669708, -0.03263707458972931, 0.023063767701387405, -0.00029202981386333704, -0.028192952275276184, 0.04236847534775734, 0.0015293139731511474, 0.023731263354420662, 0.0018795301439240575, 0.00618751859292388, -0.042122554033994675, 0.0405065082013607, 0.00597233884036541, 0.009792879223823547, -0.036782581359148026, -0.003194762161001563, -0.014781538397073746, -0.03405989706516266, 0.007768431678414345, -0.02388935536146164, 0.008286620490252972, -0.009617222473025322, -0.010548204183578491, 0.026541776955127716, 0.015501732006669044, 0.007996786385774612, 0.01898852363228798, -0.03228576108813286, 0.043317023664712906, 0.04134966433048248, 0.0015864025335758924, 0.016924554482102394, 0.022009825333952904, -0.0295103807002306, 0.0017192431259900331, -0.027420060709118843, -0.09106060117483139, 0.0027117053978145123, 0.005559545010328293, -0.0036800147499889135, 0.01510650385171175, -0.046900425106287, 0.02211521938443184, 0.008809199556708336, -0.008914593607187271, -0.013104014098644257, 0.03428824990987778, -0.04222794994711876, -0.009696267545223236, -0.10434027016162872, -0.03755547106266022, -0.04082269221544266, -0.005199447739869356, -0.016696199774742126, 0.02792946621775627, -0.020797790959477425, -0.04363320395350456, -0.024837903678417206, -0.04394938796758652, -0.0004989757435396314, -0.04960554465651512, 0.0011060903780162334, 0.04166584461927414, 0.04314136505126953, -0.04644371569156647, 0.021711207926273346, -0.02438119426369667, -0.036712318658828735, 0.06270955502986908, 0.014140390790998936, 0.05599945783615112, 0.02204495668411255, 0.02302863635122776, 0.10855603963136673, 0.03235602378845215, -0.010135410353541374, -0.07047359645366669, 0.07152754068374634, -0.006455395836383104, 0.03938230499625206, 0.008282228372991085, 0.0036273174919188023, 0.02039378136396408, 0.0011159710120409727, -0.046022139489650726, 0.03794191777706146, 0.010679947212338448, 0.031179122626781464, 0.015326075255870819, -0.017328565940260887, -0.025435136631131172, 0.050870273262262344, -0.025487834587693214, 0.04644371569156647, 0.039417434483766556, -0.045178987085819244, 0.028965843841433525, -0.012866877019405365, 0.002597528276965022, -0.012849311344325542, 0.021799037232995033, -0.007013106718659401, 0.05438341572880745, 0.04542490467429161, 0.02680526115000248, -0.051291849464178085, 0.053926706314086914, 0.02972116880118847, 0.003194762161001563, 0.0010797417489811778, 0.02260705828666687, 0.032162800431251526, -0.0191817469894886, -0.024504154920578003, -0.05673721805214882, -0.020499175414443016, -0.009801661595702171, 0.042544130235910416, 0.02487303502857685, -0.020885620266199112, -0.034305818378925323, -0.0003548820677679032, -0.004057677462697029, 0.04099835082888603, 0.022835412994027138, -0.012638523243367672, 0.022642189636826515, 0.0040466985665261745, -0.02935228869318962, 0.016037486493587494, 0.007070195395499468, 0.007210720796138048, -0.031741224229335785, 0.014254567213356495, -0.026260724291205406, -0.053715918213129044, -0.014210653491318226, -0.051783692091703415, -0.035078708082437515, -0.010012450627982616, -0.022800281643867493, -0.005256536416709423, -0.0037524732761085033, -0.035447586327791214, 0.03156556561589241, -0.02778894081711769, -0.028667226433753967, 0.027191707864403725, 0.02025325410068035, -0.024082578718662262, -0.045951876789331436, -0.01891826093196869, 0.005673721898347139, 0.017864318564534187, -0.03268977254629135, -0.04015519469976425, -0.013297236524522305, -0.007513729389756918, -0.017486656084656715, -0.028245650231838226, 0.011022478342056274, -0.004821785259991884, -0.02815782092511654, 0.0050545306876301765, -0.008791633881628513, -0.0341125950217247, 0.03973361849784851, 0.010732644237577915, 0.032250627875328064, 0.004408991429954767, -0.022712452337145805, 0.02729710191488266, -0.035148970782756805, 0.05055409297347069, -0.016415148973464966, -0.0055200220085680485, -0.02174633927643299, -0.0412442684173584, -0.035869162529706955, 0.025786451995372772, 0.004488036967813969, 0.04394938796758652, 0.0369582362473011, 0.023871788755059242, 0.005102836526930332, 0.009441564790904522, 0.06495796889066696, -0.006003079004585743, -0.04208742454648018, -0.03147773817181587, 0.020428912714123726, 0.011523100547492504, 0.008286620490252972, -0.026770129799842834, -0.007952871732413769, -0.07925645262002945, -0.057404715567827225, 0.016652286052703857, 0.04391425475478172, 0.019673585891723633, 0.013973516412079334, 0.03363832086324692, -0.028755055740475655, -0.003510944778099656, 0.009617222473025322, -0.012313557788729668, -0.022080088034272194, 0.009318605065345764, -0.013385064899921417, 0.0032035449985414743, 0.008905811235308647, -0.021763905882835388, 0.004147701431065798, -0.0016061639180406928, 0.024187972769141197, -0.021869299933314323, -0.030107613652944565, -0.014500487595796585, 0.054910384118556976, 0.033023521304130554, 0.035939428955316544, -0.04784897342324257, -0.012779048644006252, 0.006543224211782217, -0.01673133112490177, -0.01663471944630146, 0.015220681205391884, 0.012120334431529045, -0.018321027979254723, 0.035658374428749084, 0.03446390852332115, -0.023836657404899597, 0.04152531921863556, 0.0046109966933727264, 0.0008837744244374335, 0.024293366819620132, -0.01969115249812603, 0.04208742454648018, -0.05318894609808922, -0.02424066886305809, 0.05276736989617348, 0.00708776107057929, 0.0017960930708795786, 0.028948277235031128, -0.02332725189626217, -0.018496684730052948, 0.028895581141114235, -0.02027082070708275, 0.02438119426369667, -0.0074434662237763405, 0.0057395934127271175, -0.03818783536553383, 0.06246363744139671, -0.0008727958193048835, -0.014860584400594234, 0.019866809248924255, 0.0008903615525923669, -0.018795302137732506, 0.01941010169684887, -0.021992258727550507, 0.0051072281785309315, 0.03161826357245445, 0.015255812555551529, 0.012594608590006828, -0.054137494415044785, 0.06636322289705276, -0.039066120982170105, 0.013595853932201862, 0.012945923022925854, -0.05304842069745064, 0.003478009020909667, 0.02842130698263645, -0.008269054815173149, -0.013991082087159157, -0.011742671951651573, 0.01009149570018053, 0.012805396690964699, 0.04644371569156647, 0.06601191312074661, 0.022765150293707848, 0.0348503552377224, -0.021711207926273346, -0.018321027979254723, -0.06562546640634537, -0.0005928424652665854, 0.01726708561182022, 0.007601557765156031, -0.0045495168305933475, 0.00487009109929204, -0.0006098592421039939, -0.0056473733857274055, 0.0036207304801791906, -0.05283763259649277, 0.060812462121248245, -0.019093917682766914, 0.04784897342324257, -0.04180637001991272, 0.041771240532398224, -0.0038908030837774277, 0.04201716184616089, 0.04022545740008354, -0.017556918784976006, -0.049078572541475296, -0.004720782395452261, -0.026893090456724167, 0.039347171783447266, 0.06639835238456726, 0.028474003076553345, -0.0653795450925827, 0.018162935972213745, -0.05410236492753029, -0.03546515479683876, 0.038995858281850815, 0.06948991864919662, 0.010214456357061863, -0.017504222691059113, -0.004318966995924711, -0.00036778190406039357, 0.01705629751086235, -0.01745152473449707, -0.03158313408493996, 0.009292257018387318, -0.03435851261019707, -0.02424066886305809, 0.04416017606854439, -0.04366833716630936, 0.006358784157782793, 0.0295103807002306, -0.008967290632426739, 0.02302863635122776, -0.02822808362543583, -0.01570373773574829, -0.03492061793804169, 0.03808244317770004, 0.04862186312675476, 0.0040115672163665295, -0.014114041812717915, 0.04314136505126953, 0.03418285772204399, 0.0024262627121061087, 0.019796546548604965, 0.016485411673784256, 0.015668606385588646, 0.0369582362473011, -0.012717568315565586, -0.02160581387579441, 0.02475007437169552, -0.017179256305098534, 0.017829187214374542, 0.0001393591519445181, -0.037204157561063766, -0.010688729584217072, -0.013499242253601551, 0.010750209912657738, -0.031670961529016495, 0.008255880326032639, 0.014948412775993347, 3.677819040603936e-05, 0.020235689356923103, 0.011900763027369976, -0.0034340948332101107, 0.048305682837963104, -0.027332233265042305, 0.0010232022032141685, 0.00290712364949286, -0.04542490467429161, 0.03938230499625206, 0.04173610731959343, 0.0362556092441082, -0.08080223202705383, -0.007272200658917427, -0.04444122686982155, -0.042825181037187576, 0.022800281643867493, -0.024363629519939423, 0.04461688548326492, 0.019515495747327805, 0.0305643230676651, -0.007482989225536585, 0.036290742456912994, -0.024152841418981552, -0.01656445674598217, 0.00949426181614399, -0.00611286424100399, 0.022448968142271042, 0.0063412184827029705, 0.02510138787329197, 0.009503045119345188, 0.018162935972213745, -0.013209408149123192, -0.06787387281656265, 0.0062489984557032585, 0.006398307159543037, 0.014790321700274944, 0.002716096816584468, 0.015528080984950066, 0.00927469041198492, -0.00913416501134634, 0.050940535962581635, -0.014632229693233967, -0.019445233047008514, -0.011681192554533482, -0.007048238068819046, -0.02438119426369667, -0.0012669262941926718, -0.025926977396011353, -0.011848066002130508, -0.04616266489028931, -0.07588383555412292, -0.03353292495012283, -0.02900097519159317, 0.014280916191637516, -0.04271978884935379, 0.01684550940990448, 0.01628340594470501, -0.01593209244310856, 0.0003150847915094346, -0.003548271954059601, -0.02139502577483654, 0.0058362046256661415, -0.005915250163525343, 0.017574485391378403, 0.008282228372991085, -0.01619557850062847, 0.0050501395016908646, 0.0013404826167970896, 0.005660547409206629, 0.03142504021525383, 0.005344364792108536, -0.021553117781877518, 0.02445145696401596, 0.031108858063817024, 0.00516870804131031, -0.006306087132543325, -0.03618534654378891, -0.010065147653222084, 0.010662381537258625, -0.026401251554489136, 0.02025325410068035, -0.02636612020432949, 0.005339973606169224, 0.00655639823526144, 0.0154666006565094, 0.01584426313638687, -0.021711207926273346, -0.02216791734099388, -0.0022198655642569065, 0.022659756243228912, 0.018162935972213745, -0.0023735654540359974, 0.021658511832356453, -0.004051090218126774, 0.013806642033159733, -0.006191910244524479, 0.012120334431529045, 0.03801218047738075, -0.009986101649701595, 0.024908166378736496, 0.02032351680099964, -0.006604704074561596, -0.016248274594545364, -0.011935894377529621, -0.03846888989210129, -0.010758992284536362, -0.006468569859862328, -0.011646060273051262, -0.038504019379615784, 0.04036598280072212, 0.00016207105363719165, -0.027261970564723015, 0.015088938176631927, 0.017205605283379555, -0.005713244900107384, 0.004048894625157118, 0.012287208810448647, -0.00383810605853796, -0.024065012112259865, 0.016204360872507095, -0.005265319254249334, -0.017881885170936584, 0.03028327040374279, -0.020657265558838844, -0.0005456346552819014, -0.020797790959477425, 0.021869299933314323, -0.01674889773130417, 0.01868990808725357, 0.03186418488621712, -0.013543156906962395, 0.026699867099523544, -0.020165426656603813, -0.011145438067615032, 0.014237001538276672, 0.011066392064094543, -0.021939562633633614, -0.04521411657333374, 0.020130295306444168, -0.006837449502199888, 0.00582742178812623, 0.007175589445978403, 0.005392670631408691, -0.013165494427084923, 0.044792540371418, -0.0023735654540359974, 0.011848066002130508, 0.0016358060529455543, 0.03727442026138306, 0.010073930025100708, -0.010679947212338448, -0.0002881872933357954, 0.0041059828363358974, -0.007021889556199312, -0.033936936408281326, 0.0014491704059764743, 0.0017422981327399611, -0.013595853932201862, 0.011909546330571175, -0.010794124566018581, 0.003126695053651929, 0.015018675476312637, -0.036642055958509445, 0.03121425397694111, 0.03175878897309303, 0.03702849894762039, -0.02041134610772133, 0.02573375403881073, -0.02787677012383938, -0.010249587707221508, 0.001616044668480754, -0.011408924125134945, -0.02069239690899849, 0.024346062913537025, -0.016573240980505943, 0.0426495261490345, 0.011180569417774677, 0.0266647357493639, 0.0007739887805655599, -0.011769020929932594, 0.0028258822858333588, -0.05596432834863663, 0.017179256305098534, -0.015431469306349754, -0.008989248424768448, 0.030107613652944565, -0.029036106541752815, 0.00166105676908046, 0.012164249084889889, 0.04085782542824745, -0.011285963468253613, -0.003100346541032195, 0.025294611230492592, 0.08803930133581161, -0.03326943889260292, 0.05793168768286705, 0.01870747283101082, 0.014280916191637516, -0.015580778010189533, 0.006227041594684124, -0.05297815799713135, -0.015826698392629623, 0.014772756025195122, 0.01708264648914337, -0.010152976028621197, -0.04029572010040283, 0.018075108528137207, 0.0031508479733020067, 0.009819227270781994, 0.05276736989617348, 0.013666116632521152, -0.006754012778401375, 0.029036106541752815, 0.002997148083522916, 0.012278426438570023, 0.03618534654378891, -0.015730086714029312, 0.024785205721855164, -0.05339973419904709, -0.007698168978095055, 0.025118954479694366, -0.003616339061409235, -0.1030755415558815, -0.009766530245542526, 0.004558299668133259, -0.005361930467188358, -0.005585893522948027, -0.013674899004399776, -0.03578133508563042, 0.004307988565415144, -0.019884375855326653, 0.053715918213129044, 0.0027578151784837246, -0.004668085370212793, -0.03938230499625206, -0.021851733326911926, 0.006674966774880886, -0.007583992090076208, 0.016063835471868515, -0.0019256401574239135, 0.027753809466958046, 0.015255812555551529, -0.007781606167554855, -0.01524702925235033, 0.027543021366000175, -0.018883129581809044, -0.030476493760943413, 0.02922932803630829, -0.017047513276338577, 0.02246653288602829, 0.009652353823184967, 0.03815270587801933, 0.02814025618135929, -0.0018641601782292128, 0.0015315096825361252, 0.010416461154818535, 0.0054234107956290245, -0.00024029331689234823, 0.0051116193644702435, -0.026963353157043457, 0.026840392500162125, -0.013270888477563858, -0.03439364582300186, 0.02615533024072647, -0.036220479756593704, -0.017925798892974854, 0.030388664454221725, 0.02174633927643299, 0.02828078158199787, -0.01187441498041153, 0.008857505396008492, -0.057756029069423676, 0.00379419163800776, -0.015853045508265495, 0.021517984569072723, 0.007513729389756918, -0.03291812539100647, 0.04173610731959343, -0.00988070759922266, 0.00016001256881281734, 0.011163003742694855, -0.007548860739916563, 0.005840596277266741, 0.014737624675035477, -0.00020818102348130196, 0.01584426313638687, -0.0016226317966356874, 0.013174276798963547, 0.010126627050340176, -0.016125313937664032, -0.02402988076210022, -0.002516286913305521, -0.014526835642755032, 0.006266564130783081, 0.01912904903292656, -0.02566349133849144, 0.016063835471868515, 0.06144482642412186, -0.005379496142268181, 0.003488987684249878, -0.0009820325067266822, 0.0021474070381373167, -0.006104081403464079, -0.010706295259296894, 0.007092152256518602, -0.02204495668411255, -0.027982164174318314, 0.01656445674598217, -0.01616922952234745, -0.008405189029872417, -0.02785920351743698, -0.04630319029092789, -0.03688797354698181, 0.0025096996687352657, 0.012787831015884876, -0.045811351388692856, -0.0044572968035936356, 0.01997220329940319, 0.010284719057381153, -0.011092741042375565, -0.1868990808725357, 0.0001998098596232012, 0.02459198422729969, -0.0165205430239439, 0.010890735313296318, -0.010363764129579067, 0.020938316360116005, 0.0009919132571667433, 0.017758924514055252, -0.012700002640485764, 0.05793168768286705, 0.010539421811699867, -0.03483278676867485, -0.011496752500534058, -0.00294884224422276, -0.02053430676460266, 0.007768431678414345, -0.003361636307090521, 0.02083292230963707, -0.025505399331450462, -0.05986391380429268, 0.004659302532672882, -0.03156556561589241, -0.021553117781877518, 0.004747130908071995, -0.010846821591258049, -0.030300837010145187, 0.009784095920622349, 0.036712318658828735, -0.002173755783587694, 0.013753945007920265, -0.014298481866717339, -0.007952871732413769, 0.010319850407540798, -0.032742470502853394, -0.05273224040865898, -0.03618534654378891, -0.00641587283462286, 0.02958064340054989, -0.013832991011440754, 0.0015391947235912085, -0.039768751710653305, 0.0040115672163665295, 0.02814025618135929, 0.06232311204075813, -0.022431401535868645, 0.010232022032141685, 0.036361005157232285, -0.00044078935752622783, -0.019937071949243546, -0.05631564185023308, 0.019603323191404343, 0.02757815271615982, 0.0004954076721332967, -0.04092808812856674, 0.022080088034272194, -0.03265463933348656, 0.0021913214586675167, 0.014922063797712326, -0.01173388957977295, -0.0010215553920716047, 0.01777649112045765, 0.0005513983778655529, -0.017952147871255875, -0.01172510627657175, -0.01738126203417778, -0.007013106718659401, 0.004909613635390997, 0.004191615618765354, 0.003005930921062827, -0.036009691655635834, -0.006240215618163347, -0.005208230577409267, -0.017135342583060265, 0.01254191156476736, 0.029088802635669708, -0.03611508384346962, 0.00885311421006918, -0.03832836449146271, -0.0009858750272542238, 0.00472517404705286, -0.019357403740286827, -0.002038719365373254, -0.008440320380032063, -0.0259445421397686, 0.003697580425068736, 0.02729710191488266, 0.010890735313296318, -0.011918328702449799, -0.0022440184839069843, 0.03328700736165047, -0.01898852363228798, 0.006046993192285299, 0.017837971448898315, -0.00019555566541384906, -0.0035197276156395674, -0.022940807044506073, -0.017952147871255875, 0.022571926936507225, 0.03179392218589783, 0.022062521427869797, 0.016248274594545364, -0.023204293102025986, -0.045460037887096405, -0.006508092861622572, 0.02657690830528736, 0.011233266443014145, 0.021061277016997337, 0.02018299140036106, -0.024855468422174454, 0.004075243137776852, 0.016107749193906784, -0.020358650013804436, 0.004450710024684668, -0.017794055864214897, 0.0013964733807370067, 0.050518959760665894, 0.01656445674598217, -0.021359894424676895, -0.009986101649701595, 0.015598343685269356, 0.033005956560373306, 0.0113737927749753, -0.033796411007642746, -0.010117844678461552, -0.021078843623399734, 0.02211521938443184, 0.04384399205446243, -0.012129117734730244, -0.012050071731209755, -0.02039378136396408, 0.028948277235031128, -0.02631342224776745, 0.036642055958509445, 0.008848723024129868, -0.02473250962793827, 0.0014370940625667572, 0.02694578841328621, -0.02237870544195175, 0.010706295259296894, 0.016687417402863503, 0.03783652186393738, 0.05638590455055237, -0.014957195147871971, -0.021799037232995033, -0.006661792751401663, -0.013226973824203014, -0.013894470408558846, -0.028878014534711838, 0.006380741484463215, 0.006828666664659977, -0.005717636086046696, 0.008304186165332794, 0.02260705828666687, 0.004391425754874945, -0.006775969639420509, -0.010082713328301907, -0.02615533024072647, 0.010732644237577915, 0.02806999161839485, -0.03172365948557854, 0.0017192431259900331, 0.018461553379893303, -0.034095026552677155, 0.028105122968554497, -0.01911148428916931, -0.021570682525634766, -0.02787677012383938, -0.01976141519844532, 0.029668470844626427, -0.002483351156115532, 0.008659890852868557, 0.040049802511930466, -0.0016423931811004877, 0.02034108340740204, 0.039417434483766556, 0.034709829837083817, -0.015229463577270508, -0.0030015395022928715, 0.04387912526726723, 0.007737691979855299, -0.022343574091792107, -0.016415148973464966, 0.020657265558838844, 0.048305682837963104, 0.005282884929329157, 0.003368223551660776, 0.0025206783320754766, 0.01570373773574829, 0.026401251554489136, 0.0199019405990839, 0.044195305556058884, 0.012858093716204166, 0.004966702312231064, -0.0005648471415042877, 0.01019689068198204, 0.023573173210024834, 0.01863721013069153, -0.014263350516557693, 0.01773257739841938, 0.025575662031769753, 0.039066120982170105, -0.0008019841043278575, 0.00020694592967629433, -0.006016253028064966, 0.005656156223267317, -0.03193444758653641, -3.7155576137593016e-05, -0.017258303239941597, -0.005761550273746252, -0.01598478853702545, 0.008001177571713924, -0.016740113496780396, 0.014228219166398048, 0.016538109630346298, -0.011259615421295166, -0.027244403958320618, 0.006490527186542749, -0.027753809466958046, -0.042122554033994675, -0.002443828387185931, -0.049078572541475296, -0.012981054373085499, 0.009125382639467716, 0.0025799626018851995, -0.007654254790395498, -0.0021232543513178825, -0.00949426181614399, -0.021781470626592636, 0.0009677603957243264, -0.007540077902376652, 0.004477058537304401, 0.0006169952685013413, 0.028772620484232903, -0.004349707160145044, 0.014070128090679646, 0.020024901255965233, -0.02559322863817215, -0.010293501429259777, 0.01969115249812603, -0.014254567213356495, -0.029018539935350418, 0.0111981350928545, 0.010302284732460976, -0.01861964538693428, -2.727486935327761e-05, -0.007223895285278559, 0.03276003524661064, 0.009283473715186119, 0.01754813641309738, 0.003313330700621009, 0.008374448865652084, 0.024346062913537025, -0.0036712319124490023, 0.01898852363228798, 0.005326799117028713, 0.02482033707201481, 0.0316358283162117, -0.0044221654534339905, 0.007096543908119202, -0.02359073795378208, 0.023801526054739952, -0.0009869729401543736, -0.01076777558773756, 0.0056122420355677605, -0.032250627875328064, -0.01524702925235033, -0.006126038730144501, 0.02475007437169552, 0.005410236306488514, -0.02160581387579441, -0.002143015619367361, 0.060882724821567535, 0.008589628152549267, 0.0095908734947443, -0.00276440242305398, 0.008655499666929245, -0.004839350935071707, 0.022782716900110245, 0.02318672649562359, -0.02190443128347397, 0.005199447739869356, 0.05343486741185188, 0.013692464679479599, -0.010117844678461552, 0.0077333003282547, -0.029545512050390244, -0.05238092318177223, 0.02190443128347397, -0.04127940163016319, -0.026682302355766296, 0.0145795326679945, -0.007860652171075344, 0.0026414424646645784, 0.021412590518593788, -0.027701113373041153, -0.02309889905154705, 0.029738733544945717, 0.03276003524661064, -0.02048160880804062, -0.017152909189462662, 0.038644544780254364, 0.03170609101653099, -0.014658578671514988, 0.0074434662237763405, 0.029756300151348114, 0.009476696141064167, -0.045389775186777115, -0.007900174707174301, -0.009705050848424435, 0.005379496142268181, 0.022203048691153526, 0.008286620490252972, -0.029668470844626427, -0.031319648027420044, 0.026980919763445854, -0.004029132891446352, 0.012164249084889889, -0.007575209252536297, -0.00831735972315073, -0.024363629519939423, 0.01710021123290062, 0.006595921237021685, -0.020446477457880974, -0.001545781851746142, -0.005401453468948603, -0.012840528041124344, 0.007465423550456762, 0.02295837365090847, -0.004646128509193659, 0.018233198672533035, -0.009072685614228249, 0.015835480764508247, 0.025821583345532417, -0.036361005157232285, 0.0027446409221738577, -0.038398627191782, 0.004615388344973326, -0.014184304513037205, 0.010223238728940487, 0.008949724957346916, -0.002529461169615388, 0.01645028032362461, 0.007452249061316252, -0.028105122968554497, 0.013376282528042793, 0.013367499224841595, -0.01151431817561388, -0.0038117573130875826, 0.008431537076830864, 0.11438785493373871, 0.006705706939101219, -0.004347511567175388, -0.009915838949382305, 0.0025140910875052214, 0.015326075255870819, 0.01763596571981907, -0.017723793163895607, -0.027560587972402573, -0.001498574041761458, -0.011777803301811218, 0.012287208810448647, -0.014140390790998936, -0.0017126559978350997, -0.0005083075375296175, -0.009643570519983768, -0.03460443392395973, 0.0013887883396819234, 0.005432193633168936, 0.023766394704580307, -0.0010500996140763164, 0.015326075255870819, -0.004004979971796274, -0.005344364792108536, -0.04201716184616089, -0.009748964570462704, 0.01261217426508665, -0.005910858977586031, 0.03787165507674217, 0.036642055958509445, -0.003196957753971219, -0.010232022032141685, -0.027121445164084435, 0.030107613652944565, -0.013551939278841019, 0.005994296167045832, 0.0043277498334646225, 0.0005214817938394845, -0.006587138399481773, -0.001321819145232439, -0.0038117573130875826, -0.00813292060047388, -0.007750866003334522, 0.030546756461262703, 0.021588249132037163, -0.003139869309961796, 0.008365665562450886, 0.006393915507942438, -0.004501211456954479, 0.01728465035557747, -0.015080155804753304, 0.0051555335521698, 0.001078094937838614, 0.012067637406289577, -0.003234284929931164, -0.05357539281249046, 0.0034802048467099667, -0.012058855034410954, 0.024714943021535873, 0.011848066002130508, -0.036642055958509445, -0.0025118954945355654, -0.003032279433682561, -0.010609684512019157, 0.021131539717316628, -0.05304842069745064, 0.013420196250081062, 0.03251411393284798, -0.04630319029092789, 0.04001466929912567, -0.0066222697496414185, -0.010302284732460976, 0.014201870188117027, 0.00913416501134634, -0.013701247982680798, 0.0011604342143982649, 0.02237870544195175, -0.005893293302506208, 0.05125671997666359, 0.03318161144852638, 0.01496597845107317, -0.04078756272792816, -0.0051555335521698, 0.021026145666837692, -0.0016588610596954823, -0.0419468991458416, 0.019919507205486298, -0.002058480866253376, -0.012216946110129356, -0.0031310864724218845, -0.012050071731209755, -0.01645028032362461, 0.01528216153383255, 0.0027095095720142126, -0.023151595145463943, 0.015273378230631351, 0.0006362078129313886, 0.03219793364405632, 0.010548204183578491, -0.019866809248924255, 0.018039977177977562, 0.0038600631523877382, -0.009986101649701595, 0.0009276886703446507, -0.0011933698551729321, 0.0009057315182872117, -0.022765150293707848, -0.05501578003168106, -0.007100935094058514, 0.012252077460289001, -0.01898852363228798, 0.013060099445283413, 0.014913281425833702, 0.011856849305331707, 0.03383154422044754, 0.021359894424676895, 0.0010034407023340464, 0.023801526054739952, 0.04071730002760887, -0.04300083965063095, 0.014851801097393036, 0.0287901870906353, -0.020920751616358757, 0.0027073139790445566, 0.004997442476451397, -0.0111981350928545, 0.030476493760943413, -0.011646060273051262, -0.016906987875699997, 0.021992258727550507, -0.00478226225823164, 0.0071624149568378925, 0.006380741484463215, 0.028491569682955742, 0.016467846930027008, 0.003451660508289933, 0.004624171182513237, -0.013420196250081062, 0.010820472612977028, -0.006407089997082949, -0.02778894081711769, 0.017952147871255875, -0.001440387568436563, -0.0023472169414162636, 0.01009149570018053, -0.027420060709118843, -0.00465491134673357, 0.001274611335247755, -0.006881363689899445, -0.0048305680975317955, -0.017416393384337425, -0.0053311907686293125, 0.018391290679574013, -0.0014843018725514412, 0.005137967877089977, -0.015686172991991043, -0.00598551332950592, 0.026067502796649933, -0.023801526054739952, 0.01283174566924572, -0.01126839779317379, -0.019462797790765762, -0.02842130698263645, -0.0030125179328024387, 0.023661000654101372, 0.020868053659796715, 0.005656156223267317, -0.003234284929931164, 0.000667496700771153, -0.01680159382522106, 0.001463442575186491, -0.0016423931811004877, -0.006090907379984856, -0.02139502577483654, -0.004215768538415432, -0.002659008139744401, -0.009889490902423859, 0.022852979600429535, -0.02942255139350891, -0.013306019827723503, -0.021272065117955208, -0.04394938796758652, 0.009415216743946075, -0.021553117781877518, -0.012629739940166473, -0.021412590518593788, 0.018075108528137207, -0.006095298565924168, 0.005366322118788958, -0.011681192554533482, 0.030739979818463326, -0.01033741608262062, 0.021078843623399734, 0.003502161940559745, 0.010469158180058002, 0.019673585891723633, -0.0010226531885564327, 0.03284786269068718, 0.03548271954059601, 0.009467913769185543, -0.02332725189626217, -0.03463956341147423, -0.006240215618163347, -0.0073468550108373165, 0.004387034103274345, 0.005976730026304722, -0.02566349133849144, 0.001486497581936419, -0.011163003742694855, -0.026893090456724167, 0.012322340160608292, -0.004411187022924423, -0.010275935754179955, 0.016011137515306473, -0.003550467547029257, 0.03745007887482643, -0.030441362410783768, 0.039066120982170105, -0.042754918336868286, 0.007096543908119202, -0.011900763027369976, 0.013639767654240131, 0.00393691286444664, -0.0012350884499028325, -0.004997442476451397, -0.008431537076830864, 0.010082713328301907, 0.007851868867874146, -0.002729271072894335, 0.014614664018154144, -0.017767708748579025, -0.014544401317834854, 0.008321751840412617, -0.010100279003381729, 0.02302863635122776, -0.010372547432780266, 0.0001891057618195191, 0.006446612998843193, -0.023134030401706696, 0.022694887593388557, -0.008370056748390198, 0.02643638290464878, -0.02230844274163246, -0.037063632160425186, -0.049008309841156006, -0.00037519243778660893, 0.011839283630251884, 0.0113737927749753, 0.0006241313531063497, 0.02032351680099964, -0.0023735654540359974, -0.002296715509146452, -0.012348689138889313, 0.0020046858116984367, 0.022501664236187935, -0.005199447739869356, 0.00892337691038847, -0.035078708082437515, 0.026102634146809578, -0.005041356664150953, -0.04725173860788345, -0.005217013414949179, -0.022659756243228912, 0.0025206783320754766, -0.013991082087159157, 0.03973361849784851, -0.0028302737046033144, -0.019023654982447624, 0.03161826357245445, -0.022009825333952904, -0.01570373773574829, 0.013385064899921417, -0.016863074153661728, 0.0007317212875932455, -0.0014700297033414245, 0.01877773553133011, 0.014070128090679646, 0.003925934433937073, 0.006692532449960709, 0.008110962808132172, 0.024837903678417206, 0.005058922339230776, -0.04307110235095024, 0.0036251218989491463, -0.00664422707632184, 0.04384399205446243, -0.0017236345447599888, 0.005041356664150953, 0.007926522754132748, 0.012954705394804478, 0.02174633927643299, 0.012146683409810066, 0.0094239991158247, -0.03205740824341774, -0.0012899813009425998, 0.030265705659985542, -0.003592186141759157, -0.024574417620897293, -0.045670825988054276, 0.004204790107905865, -0.03348022699356079, -0.011672409251332283, -0.01656445674598217, -0.014114041812717915, 0.007908957079052925, 0.025909410789608955, -0.01126839779317379, 0.02857939712703228, -0.00906390231102705, 0.028263214975595474, 0.029615774750709534, -0.012735133990645409, 0.013437761925160885, 0.01890069618821144, -0.008804808370769024, -0.003056432120501995, 0.021500419825315475, 0.016757680103182793, -0.023801526054739952, 0.003557054791599512, 0.020815357565879822, 0.01763596571981907, 0.043598074465990067, -0.00885311421006918, 0.024995993822813034, -0.0035899903159588575, -0.014052561484277248, 0.023625869303941727, -0.022571926936507225, -0.009230776689946651, -0.015659824013710022, 0.005212622229009867, -0.008523756638169289, -0.012304774485528469, -0.017003599554300308, -0.011487969197332859, 0.010126627050340176, 0.008949724957346916, 0.01854938082396984, -0.011233266443014145, 0.010258370079100132, -0.035447586327791214, 0.0039017817471176386, -0.01076777558773756, -0.010258370079100132, 0.01017054170370102, -0.017047513276338577, -0.001944303628988564, 0.025768885388970375, 0.001849888009019196, 0.012594608590006828, 0.007364420685917139, 0.0011769020929932594, -0.023046201094985008, 0.011145438067615032, -0.01261217426508665, 0.0034143333323299885, -0.017486656084656715, 0.007715734653174877, 0.022870544344186783, 0.018496684730052948, -0.007698168978095055, -0.009863141924142838, 0.03228576108813286, 0.00421137735247612, 0.030160311609506607, -0.0017269281670451164, -0.0066574010998010635, -0.017469091340899467, -0.013051317073404789, -0.00945034809410572, 0.0074785975739359856, 0.0028258822858333588, -0.04300083965063095, 0.019989769905805588, 0.002632659627124667, -0.024187972769141197, -0.038574282079935074, -0.035728637129068375, -0.01467614434659481, 0.017574485391378403, 0.009107816964387894, 0.007684994954615831, -0.016617154702544212, -0.005045747850090265, -0.009301039390265942, -0.03504357486963272, 0.038574282079935074, 0.0065651810728013515]",SparQ Attention: Bandwidth-Efficient LLM Inference.pdf
